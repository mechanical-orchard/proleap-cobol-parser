000100 IDENTIFICATION DIVISION.                                         00010058
000200 PROGRAM-ID.    APKRP282.                                         00020058
000300 AUTHOR.        JILL JUEL.                                        00030058
000400 DATE-WRITTEN.  APRIL 2000.                                       00040058
000500 DATE-COMPILED.                                                   00050058
000600***************************************************************** 00060058
000700*                TRANS INTERNATIONAL FREIGHT REPORT             * 00070093
000800***************************************************************** 00080058
000900*    COBOL II WITH DB2                                          * 00090058
001000***************************************************************** 00100058
001100*                                                               * 00110058
001200*    THE PURPOSE OF THIS PROGRAM IS TO CREATE A REPORT FROM     * 00120058
001300*    THE TRANS INTERNATIONAL FREIGHT FILE.                      * 00130058
001400*                                                               * 00140058
001500*    INPUT:  TRANS INTERNATIONAL FILE   LRECL 264   APRD023     * 00150079
001600*    OUTPUT: REPORT                                             * 00160058
001700*                                                               * 00170058
001800*    TABLE:  AP CONTROL TABLE                       TAPCNTL     * 00180058
001900***************************************************************** 00190058
002000* CHANGE RECORD:                                                * 00200058
002100*   08/31/2000                                                  * 00210058
002200*      ADDED PROBILL FILE TO CREATE A PAGE ON THE REPORT THAT   * 00220058
002300*      GIVES THE TOTAL NUMBER OF PROBILLS FOR EACH DESTINATION. * 00230058
002400*      ALSO CHANGED THE REPORT TO INCLUDE THE 'STATE CITY' AS   * 00240058
002500*      THE DESTINATION, ADDED PIECES AND CHECK NUMBER FROM THE  * 00250058
002600*      DEPARTMENT DETAIL GREEN BAR REPORT, AND ADDED THE BOL    * 00260058
002700*      NUMBER, KEYREC, AND BATCH NUMBER FROM THE CARRIER DETAIL * 00270058
002800*      REPORT.                                                  * 00280058
002900*   MADE BY: JILL JUEL                         WR# 20741        * 00290058
003000*                                                               * 00300058
003100*   09/28/2000                                                  * 00310058
003200*      ADDED THE TOTALS FOR EACH DESTINATION TO APKRP282-2,     * 00320058
003300*      THE PROBILL REPORT.                                      * 00330058
003400*   MADE BY: JILL JUEL                         WR# 20741        * 00340058
003500*                                                               * 00350058
003600*   05/01/2001                                                  * 00360058
003700*      ADDED 16 BYTES TO EACH INPUT FILE (FREIGHT-FILE AND      * 00370058
003800*      PROBILL-FILE).  THIS IS TO MAKE ROOM FOR ADDITIONAL      * 00380058
003900*      FIELDS ADDED TO THE FILE TRANSMITTED FROM TRANS          * 00390058
004000*      INTERNATIONAL.                                           * 00400058
004100*   MADE BY: KEVIN CATLIN                      WR# 22119        * 00410058
004200*                                                               * 00420058
004300*   08/06/2001                                                  * 00430058
004400*      CHANGED PAGE BREAK CONDITIONAL IN PARAGRAPH W300 TO      * 00440058
004500*      GREATER THAN OR EQUAL TO.                                * 00450058
004600*   MADE BY: MARK BURNSIDE                     WR#              * 00460058
004700*                                                               * 00470058
004800*   09/05/2001                                                  * 00480059
004900*      CHANGED DEPT AND DEPT/CLASS TOTAL LINE TO INCLUDE WHAT   * 00490059
005000*      DEPT OR DEPT/CLASS THE TOTAL IS FOR.  THIS IS NECESSARY  * 00500059
005100*      BECAUSE IF THE TOTAL PRINTS ON A SEPARATE PAGE RDS       * 00510059
005200*      BREAKS CORRECTLY.                                        * 00520059
005300*   MADE BY: L SCHALLHORN                      WR#              * 00530059
005400*                                                               * 00540059
005500*   09/10/2001                                                  * 00550061
005600*      FORCE PRINT OF DEPT/CLASS TOTAL ON NEW PAGE AT FIRST     * 00560061
005700*      LINE.                                                    * 00570061
005800*   MADE BY: L SCHALLHORN                      WR#              * 00580061
005900*                                                               * 00590061
006000*   10/29/2001                                                  * 00600064
006100*      ADDED DC'S MIDDLETOWN, OHIO; CORSICANA, TEXAS; AND       * 00610064
006200*      MAMAKATING, NEW YORK TO THIS PROGRAM.                    * 00620064
006300*   MADE BY: ALEXIS KEIKER                     WR#22788         * 00630064
006400*                                                               * 00640064
006500*   DATE  01/09/2003                                            * 00650065
006600*       CHANGE MADE: EXPANDED TL1-AMT-PAID, TL1-BILL-AMT,       * 00660065
006700*       TL2-AMT-PAID, AND TL2-BILL-AMT BY ONE BYTE TO PREVENT   * 00670065
006800*       TRUNCATION OF THESE FIELDS ON THE REPORT.               * 00680065
006900*       MADE BY: KEVIN CATLIN            WR/IR #: PM00518570    * 00690067
007000*                                                               * 00700065
007100*   DATE  03/27/2003                                            * 00710078
007200*       CHANGE MADE: EXPANDED LRECL ON INPUT FILES TO BE 263    * 00720072
007300*       TO ACCOMMODATE ADDITION OF CAN ON FILES, EXPANSION OF   * 00730072
007400*       PO-NBR TO 9 BYTES, AND ADDITION OF AP023-RECV-UNT-QTY.  * 00740072
007500*       MADE BY: KEVIN CATLIN            WR/IR #: WR24278       * 00750068
007600*                                                               * 00760068
007700*   DATE  05/06/2004                                            * 00770079
007800*       CHANGE MADE: EXPANDED LRECL ON INPUT FILES TO BE 264    * 00780080
007900*       FOR THE EXPANSION OF THE STORE NUMBER FROM 3 TO 4       * 00790079
008000*       CHARACTERS.                                             * 00800079
008100*       MADE BY: MIKE BESKE              WR/IR #: WR25805       * 00810080
008200*                                                               * 00820079
008210*   DATE  01/11/2011                                            * 00821094
008220*       CHANGE MADE: IMPORT REPLENISHMENT PROJECT.  ADDED TRIP  * 00822089
008230*       ID TO THE REPORT AND INCREASED THE FREIGHT RECORD FROM  * 00823089
008240*       264 TO 273.  THE WORKING STORAGE CHANGES WERE MADE IN   * 00824089
008241*       THE FOLLOWING AREAS:  DC-COUNTERS, PROGRAM-CONSTANTS,   * 00824192
008242*       DESTINATION-TOTALS, HDR-LINE-4A, HDR-LINE-4B,           * 00824289
008243*       HDR-LINE-4C, HDR-LINE-5, DASH-LINE-1, DETAIL-LINE-1,    * 00824389
008244*       TOTAL-LINE-1, AND TOTAL-LINE-2.  CHANGES TO THE PROGRAM * 00824489
008245*       WERE MADE IN THE FOLLOWING PARAGRAPHS; B200-, C100-,    * 00824589
008246*       AND D100-.                                              * 00824689
008250*       MADE BY: ROLF NOHE               WR/IR #: WR38804       * 00825089
008260*                                                               * 00826089
008300***************************************************************** 00830079
008400 ENVIRONMENT DIVISION.                                            00840058
008500                                                                  00850058
008600 INPUT-OUTPUT SECTION.                                            00860058
008700 FILE-CONTROL.                                                    00870058
008800                                                                  00880058
008900     SELECT FREIGHT-FILE         ASSIGN TO UT-S-INP01.            00890058
009000     SELECT PROBILL-FILE         ASSIGN TO UT-S-INP02.            00900058
009100     SELECT DETAIL-REPORT-FILE   ASSIGN TO UT-S-RPT01.            00910058
009200     SELECT PROBILL-REPORT-FILE  ASSIGN TO UT-S-RPT02.            00920058
009300 EJECT                                                            00930058
009400 DATA DIVISION.                                                   00940058
009500                                                                  00950058
009600 FILE SECTION.                                                    00960058
009700                                                                  00970058
009800 FD  FREIGHT-FILE                                                 00980058
009900     LABEL RECORDS ARE OMITTED                                    00990058
010000     RECORDING MODE IS F                                          01000058
010101     RECORD CONTAINS 273 CHARACTERS                               01010185
010200     BLOCK CONTAINS 0 RECORDS.                                    01020058
010310 01  FREIGHT-RECORD                 PIC X(273).                   01031085
010400                                                                  01040058
010500 FD  PROBILL-FILE                                                 01050058
010600     LABEL RECORDS ARE OMITTED                                    01060058
010700     RECORDING MODE IS F                                          01070058
010801     RECORD CONTAINS 273 CHARACTERS                               01080185
010900     BLOCK CONTAINS 0 RECORDS.                                    01090058
011001 01  PROBILL-RECORD                 PIC X(273).                   01100185
011100                                                                  01110058
011200 FD  DETAIL-REPORT-FILE                                           01120058
011300     LABEL RECORDS ARE STANDARD                                   01130058
011400     RECORDING MODE IS F                                          01140058
011500     BLOCK CONTAINS 0 RECORDS.                                    01150058
011600 01  DETAIL-REPORT-RECORD.                                        01160058
011700     05  FILLER                     PIC  X(200).                  01170058
011800 EJECT                                                            01180058
011900                                                                  01190058
012000 FD  PROBILL-REPORT-FILE                                          01200058
012100     LABEL RECORDS ARE STANDARD                                   01210058
012200     RECORDING MODE IS F                                          01220058
012300     BLOCK CONTAINS 0 RECORDS.                                    01230058
012400 01  PROBILL-REPORT-RECORD.                                       01240058
012500     05  FILLER                     PIC  X(150).                  01250058
012600 EJECT                                                            01260058
012700                                                                  01270058
012800 WORKING-STORAGE SECTION.                                         01280058
012900                                                                  01290058
013000 01  PROGRAM-COUNTERS.                                            01300058
013100     05  FREIGHT-RECORDS-IN         PIC S9(09) COMP-3 VALUE +0.   01310058
013200     05  PROBILL-RECORDS-IN         PIC S9(09) COMP-3 VALUE +0.   01320058
013300     05  DETAIL-LINE-OUT            PIC S9(09) COMP-3 VALUE +0.   01330058
013400     05  TOTALS-LINE-OUT            PIC S9(09) COMP-3 VALUE +0.   01340058
013500     05  PRT-FREIGHT-RECORDS-IN     PIC  Z(09) VALUE ZERO.        01350058
013600     05  PRT-PROBILL-RECORDS-IN     PIC  Z(09) VALUE ZERO.        01360058
013700     05  PRT-DETAIL-LINE-OUT        PIC  Z(09) VALUE ZERO.        01370058
013800     05  PRT-TOTALS-LINE-OUT        PIC  Z(09) VALUE ZERO.        01380058
013900     05  PRT-PROBILL-EXCEPTIONS     PIC  Z(09) VALUE ZERO.        01390058
014000                                                                  01400058
014100 01  DC-COUNTERS.                                                 01410058
014200     05  COUNT-MEN-FALLS-WI         PIC  9(06) VALUE ZERO.        01420058
014300     05  COUNT-FINDLAY-OH           PIC  9(06) VALUE ZERO.        01430058
014400     05  COUNT-GRAIN-VALLEY-MO      PIC  9(06) VALUE ZERO.        01440058
014500     05  COUNT-WINCHESTER-VA        PIC  9(06) VALUE ZERO.        01450058
014600     05  COUNT-TRI-STATE-NJ         PIC  9(06) VALUE ZERO.        01460058
014700     05  COUNT-MIDDLETOWN-OH        PIC  9(06) VALUE ZERO.        01470063
014800     05  COUNT-CORSICANA-TX         PIC  9(06) VALUE ZERO.        01480063
014900     05  COUNT-MAMAKATING-NY        PIC  9(06) VALUE ZERO.        01490063
014920     05  COUNT-SAN-BERNARDINO-CA    PIC  9(06) VALUE ZERO.        01492088
014921     05  COUNT-SAN-BERNARDINO-EC    PIC  9(06) VALUE ZERO.        01492191
014930     05  COUNT-MACON-GA             PIC  9(06) VALUE ZERO.        01493088
014940     05  COUNT-PATTERSON-CA         PIC  9(06) VALUE ZERO.        01494088
014950     05  COUNT-OTTAWA-IL            PIC  9(06) VALUE ZERO.        01495088
015000     05  COUNT-INVALID-DC           PIC  9(06) VALUE ZERO.        01500058
015100                                                                  01510058
015200 01  PROGRAM-SWITCHES.                                            01520058
015300     05  PS-FREIGHT-EOF-SW          PIC X  VALUE 'N'.             01530058
015400         88  PROCESSING-FREIGHT            VALUE 'N'.             01540058
015500         88  FREIGHT-EOF                   VALUE 'Y'.             01550058
015600     05  PS-PROBILL-EOF-SW          PIC X  VALUE 'N'.             01560058
015700         88  PROCESSING-PROBILL            VALUE 'N'.             01570058
015800         88  PROBILL-EOF                   VALUE 'Y'.             01580058
015900                                                                  01590058
016000 01  PROGRAM-CONSTANTS.                                           01600058
016100     05  PC-PROGRAM-NAME            PIC X(08) VALUE 'APKRP282'.   01610058
016200     05  PC-MEN-FALLS-WI            PIC X(20)                     01620058
016300                                    VALUE 'WI MENOMONEE FALLS  '. 01630058
016400     05  PC-FINDLAY-OH              PIC X(20)                     01640058
016500                                    VALUE 'OH FINDLAY          '. 01650058
016600     05  PC-GRAIN-VALLEY-MO         PIC X(20)                     01660058
016700                                    VALUE 'MO GRAIN VALLEY     '. 01670058
016800     05  PC-WINCHESTER-VA           PIC X(20)                     01680058
016900                                    VALUE 'VA WINCHESTER       '. 01690058
017000     05  PC-TRI-STATE-NJ-1          PIC X(20)                     01700058
017100                                    VALUE 'NJ TRI STATE        '. 01710058
017200     05  PC-TRI-STATE-NJ-2          PIC X(20)                     01720058
017300                                    VALUE 'NJ TRI-STATE        '. 01730058
017400     05  PC-MIDDLETOWN-OH           PIC X(20)                     01740062
017500                                    VALUE 'OH MIDDLETOWN       '. 01750062
017600     05  PC-CORSICANA-TX            PIC X(20)                     01760062
017700                                    VALUE 'TX CORSICANA        '. 01770062
017800     05  PC-MAMAKATING-NY           PIC X(20)                     01780062
017900                                    VALUE 'NY MAMAKATING       '. 01790062
017911     05  PC-MACON-GA                PIC X(20)                     01791188
017920                                    VALUE 'GA MACON            '. 01792088
017921     05  PC-PATTERSON-CA            PIC X(20)                     01792188
017922                                    VALUE 'CA PATTERSON        '. 01792288
017923     05  PC-OTTAWA-IL               PIC X(20)                     01792388
017924                                    VALUE 'IL OTTAWA           '. 01792488
017925     05  PC-SAN-BERNARDINO-CA       PIC X(20)                     01792588
017926                                    VALUE 'CA SAN BERNARDINO   '. 01792688
017927     05  PC-SAN-BERNARDINO-EC       PIC X(20)                     01792791
017928                                    VALUE 'CA SAN BERNARDINO-EC'. 01792891
018000                                                                  01800058
018100 01  HOLD-FIELDS.                                                 01810058
018200     05  HOLD-DEPT-NBR              PIC X(03) VALUE ZERO.         01820058
018300     05  HOLD-CLASSNO               PIC X(02) VALUE ZERO.         01830058
018400                                                                  01840058
018500 01  PROGRAM-VARIABLES.                                           01850058
018600     05  PV-BILL-AMT                PIC S9(05)V99 COMP-3 VALUE 0. 01860058
018700     05  PV-HASH-COUNT              PIC S9(07)    COMP-3 VALUE 0. 01870058
018800     05  PV-REC-SEQ-NBR             PIC  9(07)           VALUE 0. 01880058
018900                                                                  01890058
019000 01  DEPT-CLASS-TOTALS.                                           01900058
019100     05  DEPTCL-TOTAL-PIECES        PIC S9(09)    COMP-3 VALUE 0. 01910058
019200     05  DEPTCL-TOTAL-WEIGHT        PIC S9(09)    COMP-3 VALUE 0. 01920058
019300     05  DEPTCL-TOTAL-AMT-PAID      PIC S9(13)V99 COMP-3 VALUE 0. 01930058
019400     05  DEPTCL-TOTAL-BILL-AMT      PIC S9(13)V99 COMP-3 VALUE 0. 01940058
019500                                                                  01950058
019600 01  DEPARTMENT-TOTALS.                                           01960058
019700     05  DEPT-TOTAL-PIECES          PIC S9(09)    COMP-3 VALUE 0. 01970058
019800     05  DEPT-TOTAL-WEIGHT          PIC S9(09)    COMP-3 VALUE 0. 01980058
019900     05  DEPT-TOTAL-AMT-PAID        PIC S9(09)V99 COMP-3 VALUE 0. 01990058
020000     05  DEPT-TOTAL-BILL-AMT        PIC S9(09)V99 COMP-3 VALUE 0. 02000058
020100                                                                  02010058
020200 01  DESTINATION-TOTALS.                                          02020058
020300     05  DEST-TOTAL-MEN-FALLS-WI    PIC S9(09)V99 COMP-3 VALUE 0. 02030058
020400     05  DEST-TOTAL-FINDLAY-OH      PIC S9(09)V99 COMP-3 VALUE 0. 02040058
020500     05  DEST-TOTAL-GRAIN-VALLEY-MO PIC S9(09)V99 COMP-3 VALUE 0. 02050058
020600     05  DEST-TOTAL-WINCHESTER-VA   PIC S9(09)V99 COMP-3 VALUE 0. 02060058
020700     05  DEST-TOTAL-TRI-STATE-NJ    PIC S9(09)V99 COMP-3 VALUE 0. 02070058
020800     05  DEST-TOTAL-INVALID-DC      PIC S9(09)V99 COMP-3 VALUE 0. 02080058
020900     05  DEST-TOTAL-MIDDLETOWN-OH   PIC S9(09)V99 COMP-3 VALUE 0. 02090063
021000     05  DEST-TOTAL-CORSICANA-TX    PIC S9(09)V99 COMP-3 VALUE 0. 02100063
021100     05  DEST-TOTAL-MAMAKATING-NY   PIC S9(09)V99 COMP-3 VALUE 0. 02110063
021120     05  DEST-TOTAL-SBERNARDINO-CA  PIC S9(09)V99 COMP-3 VALUE 0. 02112088
021121     05  DEST-TOTAL-SBERNARDINO-EC  PIC S9(09)V99 COMP-3 VALUE 0. 02112191
021122     05  DEST-TOTAL-MACON-GA        PIC S9(09)V99 COMP-3 VALUE 0. 02112291
021123     05  DEST-TOTAL-PATTERSON-CA    PIC S9(09)V99 COMP-3 VALUE 0. 02112391
021124     05  DEST-TOTAL-OTTAWA-IL       PIC S9(09)V99 COMP-3 VALUE 0. 02112491
021200     05  DEST-TOTAL-ALL-DC          PIC S9(09)V99 COMP-3 VALUE 0. 02120058
021300                                                                  02130058
021400 01  ACCUMULATED-AMOUNTS.                                         02140058
021500     05  ACCUM-AMT-PAID             PIC S9(07)V99 COMP-3 VALUE 0. 02150058
021600                                                                  02160058
021700*--------------------------------------------------------------*  02170058
021800*  RECORD LAYOUT FOR TRANS INTERNATION FREIGHT FILE            *  02180058
021900*--------------------------------------------------------------*  02190058
022000     COPY APRD023.                                                02200058
022100 EJECT                                                            02210058
022200                                                                  02220058
022300*--------------------------------------------------------------*  02230058
022400* REPORT STANDARD HEADER COPYBOOK                              *  02240058
022500*--------------------------------------------------------------*  02250058
022600     COPY DPWS150O.                                               02260068
022700 EJECT                                                            02270058
022800                                                                  02280058
022900*--------------------------------------------------------------*  02290058
023000* REPORT STANDARD HEADER COPYBOOK                              *  02300058
023100*--------------------------------------------------------------*  02310058
023200     COPY DPWS200O.                                               02320068
023300 EJECT                                                            02330058
023400                                                                  02340058
023500 01  REPORT-CONTROLS.                                             02350058
023600     05  PAGE-COUNT           PIC S9(4)  COMP-3 VALUE +0.         02360058
023700     05  LINE-COUNT           PIC S9(4)  COMP-3 VALUE +0.         02370058
023800                                                                  02380058
023900 01  BLANK-LINE-150           PIC X(150) VALUE SPACES.            02390058
024000 01  BLANK-LINE-200           PIC X(200) VALUE SPACES.            02400058
024100                                                                  02410058
024200 01  HDR-LINE-1A.                                                 02420058
024300     05  FILLER               PIC X(92) VALUE SPACES.             02430058
024400     05  FILLER               PIC X(16) VALUE                     02440058
024500         'ACCOUNTS PAYABLE'.                                      02450058
024600     05  FILLER               PIC X(92) VALUE SPACES.             02460058
024700                                                                  02470058
024800 01  HDR-LINE-1B.                                                 02480058
024900     05  FILLER               PIC X(67) VALUE SPACES.             02490058
025000     05  FILLER               PIC X(16) VALUE                     02500058
025100         'ACCOUNTS PAYABLE'.                                      02510058
025200     05  FILLER               PIC X(67) VALUE SPACES.             02520058
025300                                                                  02530058
025400 01  HDR-LINE-2.                                                  02540058
025500     05  FILLER               PIC X(83) VALUE SPACES.             02550058
025600     05  FILLER               PIC X(34) VALUE                     02560058
025700        'TRANS INTERNATIONAL FREIGHT REPORT'.                     02570058
025800     05  FILLER               PIC X(83) VALUE SPACES.             02580058
025900                                                                  02590058
026000 01  HDR-LINE-3A.                                                 02600058
026100     05  FILLER               PIC X(95) VALUE SPACES.             02610058
026200     05  HL3A-DATE            PIC X(10) VALUE SPACES.             02620058
026300     05  FILLER               PIC X(95) VALUE SPACES.             02630058
026400                                                                  02640058
026500 01  HDR-LINE-3B.                                                 02650058
026600     05  FILLER               PIC X(70) VALUE SPACES.             02660058
026700     05  HL3B-DATE            PIC X(10) VALUE SPACES.             02670058
026800     05  FILLER               PIC X(70) VALUE SPACES.             02680058
026900                                                                  02690058
027000 01  HDR-LINE-4A.                                                 02700058
027100     05  FILLER               PIC X(66) VALUE SPACES.             02710058
027200     05  FILLER               PIC X(17) VALUE 'DEPARTMENT DETAIL'.02720058
027311     05  FILLER               PIC X(91) VALUE SPACES.             02731184
027400     05  FILLER               PIC X(14) VALUE 'CARRIER DETAIL'.   02740058
027500     05  FILLER               PIC X(14) VALUE SPACES.             02750058
027600                                                                  02760058
027700 01  HDR-LINE-4B.                                                 02770058
027800     05  FILLER               PIC X(66) VALUE SPACES.             02780058
027900     05  FILLER               PIC X(17) VALUE '-----------------'.02790058
028001     05  FILLER               PIC X(91) VALUE SPACES.             02800184
028100     05  FILLER               PIC X(14) VALUE '--------------'.   02810058
028200     05  FILLER               PIC X(14) VALUE SPACES.             02820058
028300                                                                  02830058
028400 01  HDR-LINE-4C.                                                 02840058
028411     05  FILLER               PIC X(07) VALUE 'TRIP ID'.          02841181
028412     05  FILLER               PIC X(03) VALUE SPACES.             02841284
028500     05  FILLER               PIC X(04) VALUE 'DEPT'.             02850058
028600     05  FILLER               PIC X(02) VALUE SPACES.             02860058
028700     05  FILLER               PIC X(06) VALUE 'PO NBR'.           02870058
028800     05  FILLER               PIC X(04) VALUE SPACES.             02880069
028900     05  FILLER               PIC X(03) VALUE 'SEQ'.              02890058
029000     05  FILLER               PIC X(01) VALUE SPACES.             02900058
029100     05  FILLER               PIC X(07) VALUE 'CARRIER'.          02910058
029200     05  FILLER               PIC X(14) VALUE SPACES.             02920058
029300     05  FILLER               PIC X(10) VALUE 'PRO NUMBER'.       02930058
029400     05  FILLER               PIC X(03) VALUE SPACES.             02940058
029500     05  FILLER               PIC X(04) VALUE 'DATE'.             02950058
029600     05  FILLER               PIC X(03) VALUE SPACES.             02960058
029700     05  FILLER               PIC X(09) VALUE 'VEND/CONS'.        02970058
029800     05  FILLER               PIC X(02) VALUE SPACES.             02980058
029900     05  FILLER               PIC X(06) VALUE 'ORIGIN'.           02990058
030000     05  FILLER               PIC X(08) VALUE SPACES.             03000058
030100     05  FILLER               PIC X(04) VALUE 'DEST'.             03010058
030200     05  FILLER               PIC X(11) VALUE SPACES.             03020058
030300     05  FILLER               PIC X(06) VALUE 'PIECES'.           03030058
030400     05  FILLER               PIC X(04) VALUE SPACES.             03040058
030500     05  FILLER               PIC X(06) VALUE 'WEIGHT'.           03050058
030600     05  FILLER               PIC X(04) VALUE SPACES.             03060058
030700     05  FILLER               PIC X(08) VALUE 'PAID AMT'.         03070058
030810     05  FILLER               PIC X(04) VALUE SPACES.             03081086
030900     05  FILLER               PIC X(08) VALUE 'BILL AMT'.         03090058
031000     05  FILLER               PIC X(03) VALUE SPACES.             03100086
031100     05  FILLER               PIC X(07) VALUE 'CHECK #'.          03110058
031201     05  FILLER               PIC X(08) VALUE SPACES.             03120184
031300     05  FILLER               PIC X(07) VALUE 'BOL NBR'.          03130058
031401     05  FILLER               PIC X(03) VALUE SPACES.             03140181
031500     05  FILLER               PIC X(07) VALUE 'KEY-REC'.          03150058
031600     05  FILLER               PIC X(03) VALUE SPACES.             03160058
031700     05  FILLER               PIC X(09) VALUE 'BATCH NBR'.        03170058
031811     05  FILLER               PIC X(02) VALUE SPACES.             03181181
031900                                                                  03190058
032000 01  HDR-LINE-5.                                                  03200058
032101     05  FILLER               PIC X(161) VALUE ALL '='.           03210186
032201     05  FILLER               PIC X(005) VALUE SPACES.            03220186
032301     05  FILLER               PIC X(032) VALUE ALL '='.           03230184
032400     05  FILLER               PIC X(005) VALUE SPACES.            03240058
032500                                                                  03250058
032600 01  HDR-LINE-6.                                                  03260058
032700     05  FILLER               PIC X(60) VALUE SPACES.             03270058
032800     05  FILLER               PIC X(30) VALUE                     03280058
032900        'FREIGHT BILLS PROCESSED REPORT'.                         03290058
033000     05  FILLER               PIC X(60) VALUE SPACES.             03300058
033100                                                                  03310058
033200 01  HDR-LINE-7.                                                  03320058
033300     05  FILLER               PIC X(31) VALUE SPACES.             03330058
033400     05  FILLER               PIC X(10) VALUE 'PRO NUMBER'.       03340058
033500     05  FILLER               PIC X(02) VALUE SPACES.             03350058
033600     05  FILLER               PIC X(09) VALUE 'VEND/CONS'.        03360058
033700     05  FILLER               PIC X(03) VALUE SPACES.             03370058
033800     05  FILLER               PIC X(06) VALUE 'ORIGIN'.           03380058
033900     05  FILLER               PIC X(16) VALUE SPACES.             03390058
034000     05  FILLER               PIC X(04) VALUE 'DEST'.             03400058
034100     05  FILLER               PIC X(18) VALUE SPACES.             03410058
034200     05  FILLER               PIC X(07) VALUE 'CARRIER'.          03420058
034300     05  FILLER               PIC X(44) VALUE SPACES.             03430058
034400                                                                  03440058
034500 01  HDR-LINE-8.                                                  03450058
034600     05  FILLER               PIC X(31) VALUE SPACES.             03460058
034700     05  FILLER               PIC X(88) VALUE ALL '='.            03470058
034800     05  FILLER               PIC X(31) VALUE SPACES.             03480058
034900                                                                  03490058
035000 01  HDR-LINE-9.                                                  03500058
035100     05  FILLER               PIC X(39) VALUE SPACES.             03510058
035200     05  FILLER               PIC X(11) VALUE 'DESTINATION'.      03520058
035300     05  FILLER               PIC X(24) VALUE SPACES.             03530058
035400     05  FILLER               PIC X(07) VALUE '# BILLS'.          03540058
035500     05  FILLER               PIC X(19) VALUE SPACES.             03550058
035600     05  FILLER               PIC X(11) VALUE 'AMOUNT PAID'.      03560058
035700     05  FILLER               PIC X(39) VALUE SPACES.             03570058
035800                                                                  03580058
035900 01  HDR-LINE-10.                                                 03590058
036000     05  FILLER               PIC X(39) VALUE SPACES.             03600058
036100     05  FILLER               PIC X(72) VALUE ALL '='.            03610058
036200     05  FILLER               PIC X(39) VALUE SPACES.             03620058
036300                                                                  03630058
036400 01  DASH-LINE-1.                                                 03640058
036501     05  FILLER               PIC X(161) VALUE ALL '-'.           03650186
036503     05  FILLER               PIC X(005) VALUE SPACES.            03650386
036505     05  FILLER               PIC X(032) VALUE ALL '-'.           03650586
036800     05  FILLER               PIC X(005) VALUE SPACES.            03680058
036900                                                                  03690058
037000 01  DASH-LINE-2.                                                 03700058
037100     05  FILLER               PIC X(39) VALUE SPACES.             03710058
037200     05  FILLER               PIC X(72) VALUE ALL '-'.            03720058
037300     05  FILLER               PIC X(39) VALUE SPACES.             03730058
037400                                                                  03740058
037500 01  DETAIL-LINE-1.                                               03750058
037601     05  DL1-FR-TRIP-ID       PIC X(09)           VALUE SPACES.   03760181
037602     05  FILLER               PIC X(01)           VALUE SPACES.   03760281
037610     05  DL1-FR-DEPT          PIC X(05)           VALUE SPACES.   03761081
037700     05  FILLER REDEFINES DL1-FR-DEPT.                            03770058
037800         10  DL1-DEPT         PIC X(03).                          03780058
037900         10  DL1-CLASS        PIC X(02).                          03790058
038000     05  FILLER               PIC X(01)           VALUE SPACES.   03800058
038100     05  DL1-PO-NBR           PIC X(09)           VALUE SPACES.   03810069
038200     05  FILLER               PIC X(01)           VALUE SPACES.   03820058
038300     05  DL1-SEQ              PIC X(03)           VALUE SPACES.   03830058
038400     05  FILLER               PIC X(01)           VALUE SPACES.   03840058
038500     05  DL1-CARRIER          PIC X(20)           VALUE SPACES.   03850058
038600     05  FILLER               PIC X(01)           VALUE SPACES.   03860058
038700     05  DL1-PRO-NBR          PIC X(10)           VALUE SPACES.   03870058
038800     05  FILLER               PIC X(01)           VALUE SPACES.   03880058
038900     05  DL1-DATE             PIC X(08)           VALUE SPACES.   03890058
039000     05  FILLER               PIC X(01)           VALUE SPACES.   03900058
039100     05  DL1-VEND-NAME        PIC X(10)           VALUE SPACES.   03910058
039200     05  FILLER               PIC X(01)           VALUE SPACES.   03920058
039300     05  DL1-ORIGIN           PIC X(13)           VALUE SPACES.   03930058
039400     05  FILLER REDEFINES DL1-ORIGIN.                             03940058
039500         10  DL1-ORIG-STATE   PIC X(02).                          03950058
039600         10  FILLER           PIC X(01).                          03960058
039700         10  DL1-ORIG-CITY    PIC X(10).                          03970058
039800     05  FILLER               PIC X(01)           VALUE SPACES.   03980058
039900     05  DL1-DEST             PIC X(13)           VALUE SPACES.   03990058
040000     05  FILLER REDEFINES DL1-DEST.                               04000058
040100         10  DL1-DEST-STATE   PIC X(02).                          04010058
040200         10  FILLER           PIC X(01).                          04020058
040300         10  DL1-DEST-CITY    PIC X(10).                          04030058
040400     05  FILLER               PIC X(02)           VALUE SPACES.   04040058
040500     05  DL1-PIECES           PIC ZZZZZ9          VALUE ZEROES.   04050058
040600     05  FILLER               PIC X(02)           VALUE SPACES.   04060058
040700     05  DL1-WEIGHT           PIC ZZZZZZZ9        VALUE ZEROES.   04070058
040800     05  FILLER               PIC X(02)           VALUE SPACES.   04080058
040900     05  DL1-AMT-PAID         PIC ---,--9.99      BLANK WHEN ZERO.04090058
041001     05  FILLER               PIC X(02)           VALUE SPACES.   04100186
041100     05  DL1-BILL-AMT         PIC ---,--9.99      BLANK WHEN ZERO.04110058
041200     05  FILLER               PIC X(03)           VALUE SPACES.   04120086
041300     05  DL1-CHECK-NBR        PIC X(08)           VALUE SPACES.   04130058
041401     05  FILLER               PIC X(07)           VALUE SPACES.   04140182
041500     05  DL1-BOL-NO           PIC X(10)           VALUE SPACES.   04150058
041601     05  FILLER               PIC X(01)           VALUE SPACES.   04160182
041700     05  DL1-KEYREC           PIC X(08)           VALUE SPACES.   04170058
041801     05  FILLER               PIC X(01)           VALUE SPACES.   04180182
041900     05  DL1-BATCH-NO         PIC X(09)           VALUE SPACES.   04190058
042011     05  FILLER               PIC X(02)           VALUE SPACES.   04201181
042100                                                                  04210058
042200 01  DETAIL-LINE-2.                                               04220058
042300     05  FILLER               PIC X(31)           VALUE SPACES.   04230058
042400     05  DL2-PRO-NBR          PIC X(10)           VALUE SPACES.   04240058
042500     05  FILLER               PIC X(02)           VALUE SPACES.   04250058
042600     05  DL2-VEND-NAME        PIC X(10)           VALUE ZEROES.   04260058
042700     05  FILLER               PIC X(02)           VALUE SPACES.   04270058
042800     05  DL2-ORIGIN           PIC X(20)           VALUE ZEROES.   04280058
042900     05  FILLER               PIC X(02)           VALUE SPACES.   04290058
043000     05  DL2-DEST             PIC X(20)           VALUE ZEROES.   04300058
043100     05  FILLER               PIC X(02)           VALUE SPACES.   04310058
043200     05  DL2-CARRIER          PIC X(20)           VALUE ZEROES.   04320058
043300     05  FILLER               PIC X(31)           VALUE SPACES.   04330058
043400                                                                  04340058
043500 01  DETAIL-LINE-3.                                               04350058
043600     05  FILLER               PIC X(39)           VALUE SPACES.   04360058
043700     05  DL3-DEST             PIC X(25)           VALUE SPACES.   04370058
043800     05  FILLER               PIC X(10)           VALUE SPACES.   04380058
043900     05  DL3-TOTAL-BILLS      PIC ZZZ,ZZ9         VALUE ZEROES.   04390058
044000     05  FILLER               PIC X(15)           VALUE SPACES.   04400058
044100     05  DL3-DEST-TOTAL-PAID  PIC ZZZ,ZZZ,ZZ9.99  VALUE ZEROES.   04410058
044200     05  FILLER               PIC X(39)           VALUE SPACES.   04420058
044300                                                                  04430058
044400 01  TOTAL-LINE-1.                                                04440058
044500     05  TL1-TRIP-ID          PIC X(09)           VALUE SPACES.   04450086
044501     05  FILLER               PIC X(01)           VALUE SPACES.   04450186
044510     05  TL1-DEPT             PIC X(05)           VALUE SPACES.   04451086
044600     05  FILLER               PIC X(03)           VALUE SPACES.   04460059
044700     05  FILLER               PIC X(22)           VALUE           04470059
044800        '*** DEPT/CLASS TOTALS:'.                                 04480058
044900     05  FILLER               PIC X(71)           VALUE SPACES.   04490086
045000     05  TL1-PIECES           PIC ZZZZZ9          VALUE ZEROES.   04500058
045100     05  FILLER               PIC X(02)           VALUE SPACES.   04510058
045200     05  TL1-WEIGHT           PIC ZZZZZZZ9        VALUE ZEROES.   04520058
045300     05  FILLER               PIC X(01)           VALUE SPACES.   04530065
045400     05  TL1-AMT-PAID         PIC ----,--9.99     BLANK WHEN ZERO.04540065
045511     05  FILLER               PIC X(01)           VALUE SPACES.   04551186
045600     05  TL1-BILL-AMT         PIC ----,--9.99     BLANK WHEN ZERO.04560065
045700                                                                  04570058
045800 01  TOTAL-LINE-2.                                                04580058
045901     05  TL2-TRIP-ID          PIC X(09)           VALUE SPACES.   04590186
045902     05  FILLER               PIC X(01)           VALUE SPACES.   04590286
045910     05  TL2-DEPT             PIC X(03)           VALUE SPACES.   04591086
046000     05  FILLER               PIC X(05)           VALUE SPACES.   04600060
046100     05  FILLER               PIC X(22)           VALUE           04610059
046200        '*** DEPARTMENT TOTALS:'.                                 04620058
046310     05  FILLER               PIC X(71)           VALUE SPACES.   04631086
046400     05  TL2-PIECES           PIC ZZZZZ9          VALUE ZEROES.   04640058
046500     05  FILLER               PIC X(02)           VALUE SPACES.   04650058
046600     05  TL2-WEIGHT           PIC ZZZZZZZ9        VALUE ZEROES.   04660058
046700     05  FILLER               PIC X(01)           VALUE SPACES.   04670065
046800     05  TL2-AMT-PAID         PIC ----,--9.99     BLANK WHEN ZERO.04680065
046900     05  FILLER               PIC X(01)           VALUE SPACES.   04690086
047000     05  TL2-BILL-AMT         PIC ----,--9.99     BLANK WHEN ZERO.04700065
047100                                                                  04710058
047200*--------------------------------------------------------------*  04720058
047300*  COMMUNICATIONS AREA2 FOR DB2                                *  04730058
047400*--------------------------------------------------------------*  04740058
047500     COPY SQLCA2.                                                 04750058
047600*--------------------------------------------------------------*  04760058
047700*     SQL COMMUNICATIONS AREA DCLGEN                           *  04770058
047800*--------------------------------------------------------------*  04780058
047900     EXEC SQL                                                     04790058
048000         INCLUDE SQLCA                                            04800058
048100     END-EXEC.                                                    04810058
048200*--------------------------------------------------------------*  04820074
048300*     AP CONTROL TABLE                                         *  04830074
048400*--------------------------------------------------------------*  04840074
048500     EXEC SQL                                                     04850074
048600         INCLUDE TAPCNTL                                          04860074
048700     END-EXEC.                                                    04870074
048800 EJECT                                                            04880058
048900                                                                  04890058
049000                                                                  04900058
049100** WORKING STORAGE FOR ABEND PROCESSING                           04910058
049200 01  ABEND-CODE                PIC S9(04)  VALUE ZEROS COMP SYNC. 04920058
049300     88  AC-DB2-ERROR                        VALUE +4013.         04930058
049400     88  AC-UNSUCCESSFUL-SELECT              VALUE +4015.         04940058
049500                                                                  04950058
049600 01  ABEND-AREAS.                                                 04960058
049700     05  AA-ABEND-LIT          PIC  X(40)  VALUE                  04970058
049800             '*****       ABEND'.                                 04980058
049900     05  AA-PROGRAM-LIT        PIC  X(40)  VALUE                  04990058
050000             '*****   PROGRAM: APKRP282'.                         05000058
050100     05  AA-PARAGRAPH-LIT.                                        05010058
050200         10  FILLER            PIC  X(17)  VALUE                  05020058
050300             '***** PARAGRAPH: '.                                 05030058
050400         10  AA-PARAGRAPH-NAME PIC  X(35)  VALUE SPACES.          05040058
050500     05  AA-MESSAGE-LINE.                                         05050058
050600         10  FILLER            PIC  X(06)  VALUE '*****'.         05060058
050700         10  AA-MESSAGE        PIC  X(127) VALUE SPACES.          05070058
050800         10  FILLER REDEFINES AA-MESSAGE.                         05080058
050900             15 AA-MESSAGE-1   PIC  X(43).                        05090058
051000             15 AA-MESSAGE-2   PIC  X(45).                        05100058
051100             15 AA-MESSAGE-3   PIC  X(39).                        05110058
051200     05  AA-DB2-ERROR-LIT      PIC  X(40)  VALUE                  05120058
051300             '*****    DB2 ERROR'.                                05130058
051400     05  AA-DB2-OPERATION-LIT.                                    05140058
051500         10  FILLER            PIC  X(17)  VALUE                  05150058
051600             '***** OPERATION: '.                                 05160058
051700         10  AA-DB2-OPERATION.                                    05170058
051800             15  AA-DB2-OP-1   PIC  X(25)  VALUE SPACES.          05180058
051900             15  AA-DB2-OP-2   PIC  X(25)  VALUE SPACES.          05190058
052000     05  AA-DB2-TABLE-1        PIC  X(08)  VALUE SPACES.          05200058
052100     05  AA-DB2-TABLE-2        PIC  X(08)  VALUE SPACES.          05210058
052200     05  AA-DB2-TABLE-3        PIC  X(08)  VALUE SPACES.          05220058
052300 EJECT                                                            05230058
052400                                                                  05240058
052500     COPY DPWS004.                                                05250068
052600 EJECT                                                            05260058
052700                                                                  05270058
052800************************                                          05280058
052900 PROCEDURE DIVISION.                                              05290058
053000************************                                          05300058
053100 A100-MAINLINE-ROUTINE.                                           05310058
053200     PERFORM B100-INITIALIZATION.                                 05320058
053300                                                                  05330058
053400     PERFORM B200-CREATE-FREIGHT-REPORT                           05340058
053500         UNTIL  FREIGHT-EOF.                                      05350058
053600                                                                  05360058
053700     PERFORM B300-TERMINATION.                                    05370058
053800     GOBACK.                                                      05380058
053900                                                                  05390058
054000*--------------------------------------------------------------*  05400058
054100*    INITIALIZATION PROCESSING                                 *  05410058
054200*--------------------------------------------------------------*  05420058
054300 B100-INITIALIZATION.                                             05430058
054400                                                                  05440058
054500     MOVE FUNCTION CURRENT-DATE(3:2)  TO DP150O-RUN-YEAR          05450058
054600                                         DP200O-RUN-YEAR.         05460058
054700     MOVE FUNCTION CURRENT-DATE(5:2)  TO DP150O-RUN-MONTH         05470058
054800                                         DP200O-RUN-MONTH.        05480058
054900     MOVE FUNCTION CURRENT-DATE(7:2)  TO DP150O-RUN-DAY           05490058
055000                                         DP200O-RUN-DAY.          05500058
055100     MOVE FUNCTION CURRENT-DATE(9:2)  TO DP150O-RUN-HOUR          05510058
055200                                         DP200O-RUN-HOUR.         05520058
055300     MOVE FUNCTION CURRENT-DATE(11:2) TO DP150O-RUN-MINUTE        05530058
055400                                         DP200O-RUN-MINUTE.       05540058
055500     MOVE PC-PROGRAM-NAME             TO DP150O-PROGRAM-NAME      05550058
055600                                         DP200O-PROGRAM-NAME.     05560058
055700                                                                  05570058
055800     DISPLAY '*------------ PROGRAM:  APKRP282 ------------*'     05580058
055900     DISPLAY '  RUN DATE = ' FUNCTION CURRENT-DATE(1:8)           05590058
056000             '  RUN TIME = ' FUNCTION CURRENT-DATE(9:6)           05600058
056100                                                                  05610058
056200     OPEN INPUT FREIGHT-FILE                                      05620058
056300                PROBILL-FILE                                      05630058
056400         OUTPUT DETAIL-REPORT-FILE                                05640058
056500                PROBILL-REPORT-FILE.                              05650058
056600                                                                  05660058
056700     INITIALIZE DEPT-CLASS-TOTALS                                 05670058
056800                DEPARTMENT-TOTALS                                 05680058
056900                FREIGHT-RECORD                                    05690058
057000                PROBILL-RECORD                                    05700058
057100                DESTINATION-TOTALS.                               05710058
057200                                                                  05720058
057300     MOVE 0  TO PAGE-COUNT.                                       05730058
057400     MOVE 0  TO LINE-COUNT.                                       05740058
057500                                                                  05750058
057600     PERFORM S100-SELECT-BATCH-PROCESS-DATE.                      05760058
057700                                                                  05770058
057800     PERFORM W100-WRITE-REPORT-HEADERS.                           05780058
057900                                                                  05790058
058000     PERFORM R100-READ-FREIGHT-FILE.                              05800058
058100     IF AP023-TOTAL-INDICATOR = '***************'                 05810058
058200        MOVE AP023-HASH-COUNT   TO PV-HASH-COUNT                  05820058
058300     ELSE                                                         05830058
058400        MOVE 'B100-INITIALIZATION' TO AA-PARAGRAPH-NAME           05840058
058500        MOVE 'FIRST RECORD NOT TOTAL RECORD; VERIFY THAT '        05850058
058600                                   TO AA-MESSAGE-1                05860058
058700        MOVE 'ALL THE RECORDS WERE RECEIVED FROM FTP '            05870058
058800                                   TO AA-MESSAGE-2                05880058
058900        PERFORM Z999-ABEND                                        05890058
059000     END-IF.                                                      05900058
059100                                                                  05910058
059200     PERFORM R100-READ-FREIGHT-FILE.                              05920058
059300     MOVE AP023-FR-DEPT    TO HOLD-DEPT-NBR.                      05930058
059400     MOVE AP023-FR-CLASSNO TO HOLD-CLASSNO.                       05940058
059500 EJECT                                                            05950058
059600                                                                  05960058
059700*--------------------------------------------------------------*  05970058
059800*  THIS ROUTINE WILL CREATE THE FREIGHT REPORT                 *  05980058
059900*--------------------------------------------------------------*  05990058
060000 B200-CREATE-FREIGHT-REPORT.                                      06000058
060100                                                                  06010058
060200     MOVE AP023-FR-PO-NBR        TO DL1-PO-NBR                    06020058
060300     MOVE AP023-FR-PB-FRST10     TO DL1-PRO-NBR                   06030058
060400     MOVE AP023-REC-SEQ-NBR      TO PV-REC-SEQ-NBR                06040058
060500     MOVE PV-REC-SEQ-NBR(5:3)    TO DL1-SEQ                       06050058
060600     COMPUTE PV-BILL-AMT =                                        06060058
060700             AP023-FR-AMT-PAID + AP023-FR-CORR-AMT                06070058
060800     MOVE PV-BILL-AMT            TO DL1-BILL-AMT                  06080058
060900     MOVE AP023-FR-CARRIER-NAME  TO DL1-CARRIER                   06090058
061000     MOVE AP023-FR-CHECK-NBR     TO DL1-CHECK-NBR                 06100058
061100     MOVE AP023-FR-AMT-PAID      TO DL1-AMT-PAID                  06110058
061200     MOVE AP023-FR-DEPT          TO DL1-DEPT                      06120058
061300     MOVE AP023-FR-CLASSNO       TO DL1-CLASS                     06130058
061400     MOVE AP023-FR-ORIG          TO DL1-ORIGIN                    06140058
061500     MOVE AP023-FR-DEST          TO DL1-DEST                      06150058
061600     MOVE AP023-FR-WEIGHT        TO DL1-WEIGHT                    06160058
061700     MOVE AP023-FR-PIECES        TO DL1-PIECES                    06170058
061800     MOVE AP023-FR-PRO-DATE      TO DL1-DATE                      06180058
061900     MOVE AP023-FR-VEND-NAME     TO DL1-VEND-NAME                 06190058
062000     MOVE AP023-FR-BOL-NO        TO DL1-BOL-NO                    06200058
062100     MOVE AP023-FR-KEYREC        TO DL1-KEYREC                    06210058
062200     MOVE AP023-FR-BATCH-NO      TO DL1-BATCH-NO                  06220058
062220     MOVE AP023-FR-TRIP-ID       TO DL1-FR-TRIP-ID                06222085
062300                                                                  06230058
062400     IF HOLD-DEPT-NBR = AP023-FR-DEPT                             06240058
062500         IF HOLD-CLASSNO = AP023-FR-CLASSNO                       06250058
062600            ADD AP023-FR-PIECES     TO DEPTCL-TOTAL-PIECES        06260058
062700            ADD AP023-FR-WEIGHT     TO DEPTCL-TOTAL-WEIGHT        06270058
062800            ADD PV-BILL-AMT         TO DEPTCL-TOTAL-BILL-AMT      06280058
062900            ADD AP023-FR-AMT-PAID   TO DEPTCL-TOTAL-AMT-PAID      06290058
063000            ADD AP023-FR-PIECES     TO DEPT-TOTAL-PIECES          06300058
063100            ADD AP023-FR-WEIGHT     TO DEPT-TOTAL-WEIGHT          06310058
063200            ADD PV-BILL-AMT         TO DEPT-TOTAL-BILL-AMT        06320058
063300            ADD AP023-FR-AMT-PAID   TO DEPT-TOTAL-AMT-PAID        06330058
063400            ADD AP023-FR-AMT-PAID   TO ACCUM-AMT-PAID             06340058
063500         ELSE                                                     06350058
063600            PERFORM W300-WRITE-DEPT-CLASS-TOTAL                   06360058
063700            PERFORM W100-WRITE-REPORT-HEADERS                     06370058
063800            MOVE AP023-FR-PIECES     TO DEPTCL-TOTAL-PIECES       06380058
063900            MOVE AP023-FR-WEIGHT     TO DEPTCL-TOTAL-WEIGHT       06390058
064000            MOVE PV-BILL-AMT         TO DEPTCL-TOTAL-BILL-AMT     06400058
064100            MOVE AP023-FR-AMT-PAID   TO DEPTCL-TOTAL-AMT-PAID     06410058
064200            ADD AP023-FR-PIECES      TO DEPT-TOTAL-PIECES         06420058
064300            ADD AP023-FR-WEIGHT      TO DEPT-TOTAL-WEIGHT         06430058
064400            ADD PV-BILL-AMT          TO DEPT-TOTAL-BILL-AMT       06440058
064500            ADD AP023-FR-AMT-PAID    TO DEPT-TOTAL-AMT-PAID       06450058
064600            ADD AP023-FR-AMT-PAID    TO ACCUM-AMT-PAID            06460058
064700         END-IF                                                   06470058
064800     ELSE                                                         06480058
064900        PERFORM W300-WRITE-DEPT-CLASS-TOTAL                       06490058
065000        PERFORM W400-WRITE-DEPARTMENT-TOTAL                       06500058
065100        PERFORM W100-WRITE-REPORT-HEADERS                         06510058
065200        MOVE AP023-FR-PIECES     TO DEPTCL-TOTAL-PIECES           06520058
065300        MOVE AP023-FR-WEIGHT     TO DEPTCL-TOTAL-WEIGHT           06530058
065400        MOVE PV-BILL-AMT         TO DEPTCL-TOTAL-BILL-AMT         06540058
065500        MOVE AP023-FR-AMT-PAID   TO DEPTCL-TOTAL-AMT-PAID         06550058
065600        MOVE AP023-FR-PIECES     TO DEPT-TOTAL-PIECES             06560058
065700        MOVE AP023-FR-WEIGHT     TO DEPT-TOTAL-WEIGHT             06570058
065800        MOVE PV-BILL-AMT         TO DEPT-TOTAL-BILL-AMT           06580058
065900        MOVE AP023-FR-AMT-PAID   TO DEPT-TOTAL-AMT-PAID           06590058
066000        ADD  AP023-FR-AMT-PAID   TO ACCUM-AMT-PAID                06600058
066100     END-IF.                                                      06610058
066200                                                                  06620058
066300     PERFORM W200-WRITE-REPORT-DETAILS.                           06630058
066400                                                                  06640058
066500     MOVE AP023-FR-DEPT    TO HOLD-DEPT-NBR.                      06650058
066600     MOVE AP023-FR-CLASSNO TO HOLD-CLASSNO.                       06660058
066700     PERFORM R100-READ-FREIGHT-FILE.                              06670058
066800 EJECT                                                            06680058
066900                                                                  06690058
067000*---------------------------------------------------------------* 06700058
067100*  END OF PROGRAM PROCESSING:                                   * 06710058
067200*---------------------------------------------------------------* 06720058
067300 B300-TERMINATION.                                                06730058
067400                                                                  06740058
067500     PERFORM W300-WRITE-DEPT-CLASS-TOTAL.                         06750058
067600     PERFORM W400-WRITE-DEPARTMENT-TOTAL.                         06760058
067700                                                                  06770058
067800     IF (FREIGHT-RECORDS-IN - 1) = PV-HASH-COUNT                  06780058
067900         CONTINUE                                                 06790058
068000     ELSE                                                         06800058
068100        DISPLAY 'RECORDS IN ' FREIGHT-RECORDS-IN                  06810058
068200        DISPLAY 'HASH COUNT ' PV-HASH-COUNT                       06820058
068300        MOVE 'B300-TERMINATION   ' TO AA-PARAGRAPH-NAME           06830058
068400        MOVE 'HASH COUNT NOT EQUAL TO RECORDS READ'               06840058
068500                                   TO AA-MESSAGE-LINE             06850058
068600        PERFORM Z999-ABEND                                        06860058
068700     END-IF.                                                      06870058
068800                                                                  06880058
068900     PERFORM C100-PROCESS-PROBILL-FILE.                           06890058
069000                                                                  06900058
069100     MOVE FREIGHT-RECORDS-IN   TO PRT-FREIGHT-RECORDS-IN.         06910058
069200     MOVE PROBILL-RECORDS-IN   TO PRT-PROBILL-RECORDS-IN.         06920058
069300     MOVE DETAIL-LINE-OUT      TO PRT-DETAIL-LINE-OUT.            06930058
069400     MOVE TOTALS-LINE-OUT      TO PRT-TOTALS-LINE-OUT.            06940058
069500     MOVE COUNT-INVALID-DC     TO PRT-PROBILL-EXCEPTIONS.         06950058
069600     DISPLAY '************************************************'.  06960058
069700     DISPLAY '****              APKRP282                  ****'.  06970058
069800     DISPLAY '************************************************'.  06980058
069900     DISPLAY 'FREIGHT RECORDS IN   = ' PRT-FREIGHT-RECORDS-IN     06990058
070000     DISPLAY 'FREIGHT DETAIL LINES = ' PRT-DETAIL-LINE-OUT        07000058
070100     DISPLAY 'FREIGHT TOTALS LINES = ' PRT-TOTALS-LINE-OUT        07010058
070200     DISPLAY ' '                                                  07020058
070300     DISPLAY 'PROBILL RECORDS IN   = ' PRT-PROBILL-RECORDS-IN     07030058
070400     DISPLAY 'PROBILL EXCEPTIONS   = ' PRT-PROBILL-EXCEPTIONS     07040058
070500     DISPLAY '************************************************'.  07050058
070600     DISPLAY '************************************************'.  07060058
070700                                                                  07070058
070800     CLOSE FREIGHT-FILE                                           07080058
070900           PROBILL-FILE                                           07090058
071000           DETAIL-REPORT-FILE                                     07100058
071100           PROBILL-REPORT-FILE.                                   07110058
071200 EJECT                                                            07120058
071300                                                                  07130058
071400*---------------------------------------------------------------* 07140058
071500*  THIS ROUTINE WILL PROCESS THE PROBILL FILE                   * 07150058
071600*---------------------------------------------------------------* 07160058
071700 C100-PROCESS-PROBILL-FILE.                                       07170058
071800                                                                  07180058
071900     INITIALIZE AP023-FREIGHT-RECORD                              07190058
072000                DC-COUNTERS                                       07200058
072100                PAGE-COUNT.                                       07210058
072200                                                                  07220058
072300     PERFORM W500-WRITE-PROBILL-HEADERS.                          07230058
072400                                                                  07240058
072500     PERFORM R200-READ-PROBILL-FILE.                              07250058
072600                                                                  07260058
072700     PERFORM D100-PROCESS-PROBILL-REPORT                          07270058
072800       UNTIL PROBILL-EOF.                                         07280058
072900                                                                  07290058
073000     PERFORM W700-WRITE-PROBILL-DC-HEADERS.                       07300058
073100                                                                  07310058
073200     MOVE PC-MEN-FALLS-WI         TO DL3-DEST.                    07320058
073300     MOVE COUNT-MEN-FALLS-WI      TO DL3-TOTAL-BILLS.             07330058
073400     MOVE DEST-TOTAL-MEN-FALLS-WI TO DL3-DEST-TOTAL-PAID.         07340058
073500     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07350058
073600                                                                  07360058
073700     MOVE PC-FINDLAY-OH         TO DL3-DEST.                      07370058
073800     MOVE COUNT-FINDLAY-OH      TO DL3-TOTAL-BILLS.               07380058
073900     MOVE DEST-TOTAL-FINDLAY-OH TO DL3-DEST-TOTAL-PAID.           07390058
074000     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07400058
074100                                                                  07410058
074200     MOVE PC-GRAIN-VALLEY-MO    TO DL3-DEST.                      07420058
074300     MOVE COUNT-GRAIN-VALLEY-MO TO DL3-TOTAL-BILLS.               07430058
074400     MOVE DEST-TOTAL-GRAIN-VALLEY-MO TO DL3-DEST-TOTAL-PAID.      07440058
074500     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07450058
074600                                                                  07460058
074700     MOVE PC-WINCHESTER-VA      TO DL3-DEST.                      07470058
074800     MOVE COUNT-WINCHESTER-VA   TO DL3-TOTAL-BILLS.               07480058
074900     MOVE DEST-TOTAL-WINCHESTER-VA TO DL3-DEST-TOTAL-PAID.        07490058
075000     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07500058
075100                                                                  07510058
075200     MOVE PC-TRI-STATE-NJ-1     TO DL3-DEST.                      07520058
075300     MOVE COUNT-TRI-STATE-NJ    TO DL3-TOTAL-BILLS.               07530058
075400     MOVE DEST-TOTAL-TRI-STATE-NJ TO DL3-DEST-TOTAL-PAID.         07540058
075500     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07550058
075600                                                                  07560063
075700     MOVE PC-MIDDLETOWN-OH      TO DL3-DEST.                      07570063
075800     MOVE COUNT-MIDDLETOWN-OH   TO DL3-TOTAL-BILLS.               07580063
075900     MOVE DEST-TOTAL-MIDDLETOWN-OH TO DL3-DEST-TOTAL-PAID.        07590063
076000     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07600063
076100                                                                  07610063
076200     MOVE PC-CORSICANA-TX       TO DL3-DEST.                      07620063
076300     MOVE COUNT-CORSICANA-TX    TO DL3-TOTAL-BILLS.               07630063
076400     MOVE DEST-TOTAL-CORSICANA-TX  TO DL3-DEST-TOTAL-PAID.        07640063
076500     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07650063
076600                                                                  07660063
076700     MOVE PC-MAMAKATING-NY      TO DL3-DEST.                      07670063
076800     MOVE COUNT-MAMAKATING-NY   TO DL3-TOTAL-BILLS.               07680063
076900     MOVE DEST-TOTAL-MAMAKATING-NY TO DL3-DEST-TOTAL-PAID.        07690063
077000     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07700063
077100                                                                  07710058
077111     MOVE PC-SAN-BERNARDINO-CA  TO DL3-DEST.                      07711188
077120     MOVE COUNT-SAN-BERNARDINO-CA  TO DL3-TOTAL-BILLS.            07712088
077130     MOVE DEST-TOTAL-SBERNARDINO-CA TO DL3-DEST-TOTAL-PAID.       07713088
077140     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07714088
077150                                                                  07715088
077151     MOVE PC-SAN-BERNARDINO-EC  TO DL3-DEST.                      07715191
077152     MOVE COUNT-SAN-BERNARDINO-EC  TO DL3-TOTAL-BILLS.            07715291
077153     MOVE DEST-TOTAL-SBERNARDINO-EC TO DL3-DEST-TOTAL-PAID.       07715391
077154     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07715491
077155                                                                  07715591
077156     MOVE PC-MACON-GA           TO DL3-DEST.                      07715691
077157     MOVE COUNT-MACON-GA        TO DL3-TOTAL-BILLS.               07715791
077158     MOVE DEST-TOTAL-MACON-GA   TO DL3-DEST-TOTAL-PAID.           07715891
077159     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07715991
077160                                                                  07716091
077161     MOVE PC-PATTERSON-CA       TO DL3-DEST.                      07716191
077162     MOVE COUNT-PATTERSON-CA    TO DL3-TOTAL-BILLS.               07716291
077163     MOVE DEST-TOTAL-PATTERSON-CA TO DL3-DEST-TOTAL-PAID.         07716391
077164     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07716491
077165                                                                  07716591
077166     MOVE PC-OTTAWA-IL          TO DL3-DEST.                      07716691
077167     MOVE COUNT-OTTAWA-IL       TO DL3-TOTAL-BILLS.               07716791
077168     MOVE DEST-TOTAL-OTTAWA-IL  TO DL3-DEST-TOTAL-PAID.           07716891
077169     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07716991
077170                                                                  07717091
077200     MOVE 'INVALID DC        '  TO DL3-DEST.                      07720058
077300     MOVE COUNT-INVALID-DC      TO DL3-TOTAL-BILLS.               07730058
077400     MOVE DEST-TOTAL-INVALID-DC TO DL3-DEST-TOTAL-PAID.           07740058
077500     PERFORM W800-WRITE-PROBILL-DC-TOTALS.                        07750058
077600                                                                  07760058
077700     MOVE 'TOTAL PRO BILLS   '  TO DL3-DEST.                      07770058
077800     MOVE PROBILL-RECORDS-IN    TO DL3-TOTAL-BILLS.               07780058
077900     MOVE DEST-TOTAL-ALL-DC     TO DL3-DEST-TOTAL-PAID.           07790058
078000     PERFORM W900-WRITE-PROBILL-TOTAL.                            07800058
078100                                                                  07810058
078200 EJECT                                                            07820058
078300                                                                  07830058
078400*--------------------------------------------------------------*  07840058
078500*  THIS ROUTINE WILL CREATE THE PROBILL REPORT                 *  07850058
078600*--------------------------------------------------------------*  07860058
078700 D100-PROCESS-PROBILL-REPORT.                                     07870058
078800                                                                  07880058
078900     EVALUATE TRUE                                                07890058
079000       WHEN AP023-FR-DEST = PC-MEN-FALLS-WI                       07900058
079100            ADD 1 TO COUNT-MEN-FALLS-WI                           07910058
079200            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-MEN-FALLS-WI      07920058
079300       WHEN AP023-FR-DEST = PC-FINDLAY-OH                         07930058
079400            ADD 1 TO COUNT-FINDLAY-OH                             07940058
079500            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-FINDLAY-OH        07950058
079600       WHEN AP023-FR-DEST = PC-GRAIN-VALLEY-MO                    07960058
079700            ADD 1 TO COUNT-GRAIN-VALLEY-MO                        07970058
079800            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-GRAIN-VALLEY-MO   07980058
079900       WHEN AP023-FR-DEST = PC-WINCHESTER-VA                      07990058
080000            ADD 1 TO COUNT-WINCHESTER-VA                          08000058
080100            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-WINCHESTER-VA     08010058
080200       WHEN AP023-FR-DEST = PC-TRI-STATE-NJ-1                     08020058
080300            ADD 1 TO COUNT-TRI-STATE-NJ                           08030058
080400            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-TRI-STATE-NJ      08040058
080500       WHEN AP023-FR-DEST = PC-TRI-STATE-NJ-2                     08050058
080600            ADD 1 TO COUNT-TRI-STATE-NJ                           08060058
080700            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-TRI-STATE-NJ      08070058
080800       WHEN AP023-FR-DEST = PC-MIDDLETOWN-OH                      08080063
080900            ADD 1 TO COUNT-MIDDLETOWN-OH                          08090063
081000            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-MIDDLETOWN-OH     08100063
081100       WHEN AP023-FR-DEST = PC-CORSICANA-TX                       08110063
081200            ADD 1 TO COUNT-CORSICANA-TX                           08120063
081300            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-CORSICANA-TX      08130063
081400       WHEN AP023-FR-DEST = PC-MAMAKATING-NY                      08140063
081500            ADD 1 TO COUNT-MAMAKATING-NY                          08150063
081600            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-MAMAKATING-NY     08160063
081611       WHEN AP023-FR-DEST = PC-SAN-BERNARDINO-CA                  08161188
081620            ADD 1 TO COUNT-SAN-BERNARDINO-CA                      08162088
081630            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-SBERNARDINO-CA    08163088
081631       WHEN AP023-FR-DEST = PC-SAN-BERNARDINO-EC                  08163191
081632            ADD 1 TO COUNT-SAN-BERNARDINO-EC                      08163291
081633            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-SBERNARDINO-EC    08163391
081634       WHEN AP023-FR-DEST = PC-MACON-GA                           08163491
081635            ADD 1 TO COUNT-MACON-GA                               08163591
081636            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-MACON-GA          08163691
081637       WHEN AP023-FR-DEST = PC-PATTERSON-CA                       08163791
081638            ADD 1 TO COUNT-PATTERSON-CA                           08163891
081639            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-PATTERSON-CA      08163991
081640       WHEN AP023-FR-DEST = PC-OTTAWA-IL                          08164091
081641            ADD 1 TO COUNT-OTTAWA-IL                              08164191
081650            ADD AP023-FR-AMT-PAID TO DEST-TOTAL-OTTAWA-IL         08165091
081700       WHEN OTHER                                                 08170058
081800            EVALUATE TRUE                                         08180058
081900              WHEN AP023-FR-ORIG = PC-MEN-FALLS-WI                08190058
082000                   ADD 1 TO COUNT-MEN-FALLS-WI                    08200058
082100                   ADD AP023-FR-AMT-PAID                          08210058
082200                         TO DEST-TOTAL-MEN-FALLS-WI               08220058
082300              WHEN AP023-FR-ORIG = PC-FINDLAY-OH                  08230058
082400                   ADD 1 TO COUNT-FINDLAY-OH                      08240058
082500                   ADD AP023-FR-AMT-PAID                          08250058
082600                         TO DEST-TOTAL-FINDLAY-OH                 08260058
082700              WHEN AP023-FR-ORIG = PC-GRAIN-VALLEY-MO             08270058
082800                   ADD 1 TO COUNT-GRAIN-VALLEY-MO                 08280058
082900                   ADD AP023-FR-AMT-PAID                          08290058
083000                         TO DEST-TOTAL-GRAIN-VALLEY-MO            08300058
083100              WHEN AP023-FR-ORIG = PC-WINCHESTER-VA               08310058
083200                   ADD 1 TO COUNT-WINCHESTER-VA                   08320058
083300                   ADD AP023-FR-AMT-PAID                          08330058
083400                         TO DEST-TOTAL-WINCHESTER-VA              08340058
083500              WHEN AP023-FR-ORIG = PC-TRI-STATE-NJ-1              08350058
083600                   ADD 1 TO COUNT-TRI-STATE-NJ                    08360058
083700                   ADD AP023-FR-AMT-PAID                          08370058
083800                         TO DEST-TOTAL-TRI-STATE-NJ               08380058
083900              WHEN AP023-FR-ORIG = PC-TRI-STATE-NJ-2              08390058
084000                   ADD 1 TO COUNT-TRI-STATE-NJ                    08400058
084100                   ADD AP023-FR-AMT-PAID                          08410058
084200                         TO DEST-TOTAL-TRI-STATE-NJ               08420058
084300              WHEN AP023-FR-ORIG = PC-MIDDLETOWN-OH               08430063
084400                   ADD 1 TO COUNT-MIDDLETOWN-OH                   08440063
084500                   ADD AP023-FR-AMT-PAID                          08450063
084600                         TO DEST-TOTAL-MIDDLETOWN-OH              08460063
084700              WHEN AP023-FR-ORIG = PC-CORSICANA-TX                08470063
084800                   ADD 1 TO COUNT-CORSICANA-TX                    08480063
084900                   ADD AP023-FR-AMT-PAID                          08490063
085000                         TO DEST-TOTAL-CORSICANA-TX               08500063
085100              WHEN AP023-FR-ORIG = PC-MAMAKATING-NY               08510063
085200                   ADD 1 TO COUNT-MAMAKATING-NY                   08520063
085300                   ADD AP023-FR-AMT-PAID                          08530063
085400                         TO DEST-TOTAL-MAMAKATING-NY              08540063
085411              WHEN AP023-FR-ORIG = PC-SAN-BERNARDINO-CA           08541188
085420                   ADD 1 TO COUNT-SAN-BERNARDINO-CA               08542088
085430                   ADD AP023-FR-AMT-PAID                          08543088
085440                         TO DEST-TOTAL-SBERNARDINO-CA             08544088
085441              WHEN AP023-FR-ORIG = PC-SAN-BERNARDINO-EC           08544191
085442                   ADD 1 TO COUNT-SAN-BERNARDINO-EC               08544291
085443                   ADD AP023-FR-AMT-PAID                          08544391
085444                         TO DEST-TOTAL-SBERNARDINO-EC             08544491
085445              WHEN AP023-FR-ORIG = PC-MACON-GA                    08544591
085446                   ADD 1 TO COUNT-MACON-GA                        08544691
085447                   ADD AP023-FR-AMT-PAID                          08544791
085448                         TO DEST-TOTAL-MACON-GA                   08544891
085449              WHEN AP023-FR-ORIG = PC-PATTERSON-CA                08544991
085450                   ADD 1 TO COUNT-PATTERSON-CA                    08545091
085451                   ADD AP023-FR-AMT-PAID                          08545191
085452                         TO DEST-TOTAL-PATTERSON-CA               08545291
085453              WHEN AP023-FR-ORIG = PC-OTTAWA-IL                   08545391
085454                   ADD 1 TO COUNT-OTTAWA-IL                       08545491
085455                   ADD AP023-FR-AMT-PAID                          08545591
085456                         TO DEST-TOTAL-OTTAWA-IL                  08545691
085500              WHEN OTHER                                          08550058
085600                   MOVE AP023-FR-PB-FRST10    TO DL2-PRO-NBR      08560058
085700                   MOVE AP023-FR-VEND-NAME    TO DL2-VEND-NAME    08570058
085800                   MOVE AP023-FR-ORIG         TO DL2-ORIGIN       08580058
085900                   MOVE AP023-FR-DEST         TO DL2-DEST         08590058
086000                   MOVE AP023-FR-CARRIER-NAME TO DL2-CARRIER      08600058
086100                   PERFORM W600-WRITE-PROBILL-DETAILS             08610058
086200                   ADD 1 TO COUNT-INVALID-DC                      08620058
086300                   ADD AP023-FR-AMT-PAID                          08630058
086400                         TO DEST-TOTAL-INVALID-DC                 08640058
086500         END-EVALUATE                                             08650058
086600     END-EVALUATE.                                                08660058
086700                                                                  08670058
086800     ADD AP023-FR-AMT-PAID TO DEST-TOTAL-ALL-DC.                  08680058
086900                                                                  08690058
087000     PERFORM R200-READ-PROBILL-FILE.                              08700058
087100                                                                  08710058
087200 EJECT                                                            08720058
087300                                                                  08730058
087400*--------------------------------------------------------------*  08740058
087500*  READS THE TRANS INTERNATIONAL FILE                          *  08750058
087600*--------------------------------------------------------------*  08760058
087700 R100-READ-FREIGHT-FILE.                                          08770058
087800     READ FREIGHT-FILE INTO AP023-FREIGHT-RECORD                  08780058
087900        AT END                                                    08790058
088000            SET FREIGHT-EOF TO TRUE                               08800058
088100        NOT AT END                                                08810058
088200            ADD 1 TO FREIGHT-RECORDS-IN                           08820058
088300     END-READ.                                                    08830058
088400 EJECT                                                            08840058
088500                                                                  08850058
088600*--------------------------------------------------------------*  08860058
088700*  READS THE TRANS INTERNATIONAL PRO BILL FILE                 *  08870058
088800*--------------------------------------------------------------*  08880058
088900 R200-READ-PROBILL-FILE.                                          08890058
089000     READ PROBILL-FILE INTO AP023-FREIGHT-RECORD                  08900058
089100        AT END                                                    08910058
089200            SET PROBILL-EOF TO TRUE                               08920058
089300        NOT AT END                                                08930058
089400            ADD 1 TO PROBILL-RECORDS-IN                           08940058
089500     END-READ.                                                    08950058
089600 EJECT                                                            08960058
089700                                                                  08970058
089800*--------------------------------------------------------------*  08980058
089900* THIS ROUTINE DOES A DB2 CALL TO THE APCNTL TABLE TO RETRIEVE *  08990058
090000* THE BATCH PROCESS DATE.                                      *  09000058
090100*--------------------------------------------------------------*  09010058
090200 S100-SELECT-BATCH-PROCESS-DATE.                                  09020058
090300     EXEC SQL                                                     09030058
090400         SELECT CHAR(BTCH_PRC_DTE,USA)                            09040058
090500           INTO :HL3A-DATE                                        09050058
090600           FROM TAPCNTL                                           09060058
090700     END-EXEC.                                                    09070058
090800                                                                  09080058
090900     EVALUATE TRUE                                                09090058
091000         WHEN SQLCODE = ZERO                                      09100058
091100             MOVE HL3A-DATE TO HL3B-DATE                          09110058
091200         WHEN OTHER                                               09120058
091300             SET AC-UNSUCCESSFUL-SELECT TO TRUE                   09130058
091400             MOVE 'S100-SELECT-BATCH-PROCESS-DATE'                09140058
091500                                        TO AA-PARAGRAPH-NAME      09150058
091600             MOVE 'UNSUCCESSFUL SELECT' TO AA-DB2-OPERATION       09160058
091700             MOVE 'TAPCNTL'             TO AA-DB2-TABLE-1         09170058
091800             MOVE SPACES                TO AA-DB2-TABLE-2         09180058
091900             MOVE SPACES                TO AA-DB2-TABLE-3         09190058
092000             PERFORM Z998-DB2-ABEND                               09200058
092100     END-EVALUATE.                                                09210058
092200 EJECT                                                            09220058
092300                                                                  09230058
092400*--------------------------------------------------------------*  09240058
092500*  WRITES THE REPORT HEADERS                                   *  09250058
092600*--------------------------------------------------------------*  09260058
092700 W100-WRITE-REPORT-HEADERS.                                       09270058
092800     ADD  1           TO PAGE-COUNT.                              09280058
092900     MOVE 1           TO DP200O-REPORT-NUMBER.                    09290058
093000     MOVE PAGE-COUNT  TO DP200O-PAGE-NUMBER.                      09300058
093100                                                                  09310058
093200     WRITE DETAIL-REPORT-RECORD                                   09320058
093300           FROM DP200O-STANDRD-HEADER-200-COLS                    09330058
093400           AFTER PAGE.                                            09340058
093500     WRITE DETAIL-REPORT-RECORD FROM HDR-LINE-1A    AFTER 1.      09350058
093600     WRITE DETAIL-REPORT-RECORD FROM HDR-LINE-2     AFTER 1.      09360058
093700     WRITE DETAIL-REPORT-RECORD FROM HDR-LINE-3A    AFTER 1.      09370058
093800     WRITE DETAIL-REPORT-RECORD FROM BLANK-LINE-200 AFTER 1.      09380058
093900     WRITE DETAIL-REPORT-RECORD FROM HDR-LINE-4A    AFTER 1.      09390058
094000     WRITE DETAIL-REPORT-RECORD FROM HDR-LINE-4B    AFTER 1.      09400058
094100     WRITE DETAIL-REPORT-RECORD FROM HDR-LINE-4C    AFTER 1.      09410058
094200     WRITE DETAIL-REPORT-RECORD FROM HDR-LINE-5     AFTER 1.      09420058
094300     WRITE DETAIL-REPORT-RECORD FROM BLANK-LINE-200 AFTER 1.      09430058
094400     MOVE +10 TO LINE-COUNT.                                      09440058
094500 EJECT                                                            09450058
094600                                                                  09460058
094700*--------------------------------------------------------------*  09470058
094800*  WRITES THE DETAIL LINES FOR DEPARTMENT DETAIL REPORT        *  09480058
094900*--------------------------------------------------------------*  09490058
095000 W200-WRITE-REPORT-DETAILS.                                       09500058
095100     IF LINE-COUNT > 77                                           09510059
095200        PERFORM W100-WRITE-REPORT-HEADERS                         09520058
095300     END-IF.                                                      09530058
095400                                                                  09540058
095500     WRITE DETAIL-REPORT-RECORD FROM DETAIL-LINE-1 AFTER 1.       09550058
095600     ADD  +1 TO DETAIL-LINE-OUT.                                  09560058
095700                                                                  09570058
095800     INITIALIZE DETAIL-LINE-1.                                    09580058
095900     ADD +1 TO LINE-COUNT.                                        09590058
096000 EJECT                                                            09600058
096100                                                                  09610058
096200*--------------------------------------------------------------*  09620058
096300*  WRITES THE REPORT TOTAL LINE FOR DEPARTMENT/CLASS           *  09630058
096400*--------------------------------------------------------------*  09640058
096500 W300-WRITE-DEPT-CLASS-TOTAL.                                     09650058
096600     IF LINE-COUNT >= 77                                          09660058
096700        PERFORM W100-WRITE-REPORT-HEADERS                         09670058
096800     ELSE                                                         09680061
096900        WRITE DETAIL-REPORT-RECORD FROM DASH-LINE-1 AFTER 1       09690061
097000        ADD  +1 TO TOTALS-LINE-OUT                                09700061
097100     END-IF.                                                      09710058
097200                                                                  09720058
097300     MOVE HOLD-DEPT-NBR         TO TL1-DEPT(1:3).                 09730059
097400     MOVE HOLD-CLASSNO          TO TL1-DEPT(4:2).                 09740059
097500     MOVE DEPTCL-TOTAL-PIECES   TO TL1-PIECES.                    09750058
097600     MOVE DEPTCL-TOTAL-WEIGHT   TO TL1-WEIGHT.                    09760058
097700     MOVE DEPTCL-TOTAL-AMT-PAID TO TL1-AMT-PAID.                  09770058
097800     MOVE DEPTCL-TOTAL-BILL-AMT TO TL1-BILL-AMT.                  09780058
097900                                                                  09790058
098000     WRITE DETAIL-REPORT-RECORD FROM TOTAL-LINE-1 AFTER 1.        09800058
098100     ADD  +1 TO TOTALS-LINE-OUT.                                  09810061
098200                                                                  09820058
098300 EJECT                                                            09830058
098400                                                                  09840058
098500*--------------------------------------------------------------*  09850058
098600*  WRITES THE REPORT TOTAL LINE FOR DEPARTMENT                 *  09860058
098700*--------------------------------------------------------------*  09870058
098800 W400-WRITE-DEPARTMENT-TOTAL.                                     09880058
098900     IF LINE-COUNT >= 77                                          09890061
099000        PERFORM W100-WRITE-REPORT-HEADERS                         09900058
099100     ELSE                                                         09910061
099200        WRITE DETAIL-REPORT-RECORD FROM BLANK-LINE-200 AFTER 1    09920061
099300        ADD +1 TO TOTALS-LINE-OUT                                 09930061
099400     END-IF.                                                      09940058
099500                                                                  09950058
099600     MOVE HOLD-DEPT-NBR       TO TL2-DEPT.                        09960059
099700     MOVE DEPT-TOTAL-PIECES   TO TL2-PIECES.                      09970058
099800     MOVE DEPT-TOTAL-WEIGHT   TO TL2-WEIGHT.                      09980058
099900     MOVE DEPT-TOTAL-AMT-PAID TO TL2-AMT-PAID.                    09990058
100000     MOVE DEPT-TOTAL-BILL-AMT TO TL2-BILL-AMT.                    10000058
100100                                                                  10010058
100200     WRITE DETAIL-REPORT-RECORD FROM TOTAL-LINE-2   AFTER 1.      10020058
100300     ADD  +1 TO TOTALS-LINE-OUT.                                  10030061
100400                                                                  10040058
100500 EJECT                                                            10050058
100600                                                                  10060058
100700*--------------------------------------------------------------*  10070058
100800*  WRITES THE PROBILL REPORT HEADERS                           *  10080058
100900*--------------------------------------------------------------*  10090058
101000 W500-WRITE-PROBILL-HEADERS.                                      10100058
101100     ADD  1           TO PAGE-COUNT.                              10110058
101200     MOVE 2           TO DP150O-REPORT-NUMBER.                    10120058
101300     MOVE PAGE-COUNT  TO DP150O-PAGE-NUMBER.                      10130058
101400                                                                  10140058
101500     WRITE PROBILL-REPORT-RECORD                                  10150058
101600           FROM DP150O-STANDRD-HEADER-150-COLS                    10160058
101700           AFTER PAGE.                                            10170058
101800     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-1B    AFTER 1.     10180058
101900     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-6     AFTER 1.     10190058
102000     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-3B    AFTER 1.     10200058
102100     WRITE PROBILL-REPORT-RECORD FROM BLANK-LINE-150 AFTER 1.     10210058
102200     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-7     AFTER 1.     10220058
102300     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-8     AFTER 1.     10230058
102400     WRITE PROBILL-REPORT-RECORD FROM BLANK-LINE-150 AFTER 1.     10240058
102500     MOVE +8 TO LINE-COUNT.                                       10250058
102600 EJECT                                                            10260058
102700                                                                  10270058
102800*--------------------------------------------------------------*  10280058
102900*  WRITES THE DETAIL LINES FOR THE PROBILL REPORT              *  10290058
103000*--------------------------------------------------------------*  10300058
103100 W600-WRITE-PROBILL-DETAILS.                                      10310058
103200     IF LINE-COUNT > 64                                           10320058
103300        PERFORM W500-WRITE-PROBILL-HEADERS                        10330058
103400     END-IF.                                                      10340058
103500                                                                  10350058
103600     WRITE PROBILL-REPORT-RECORD FROM DETAIL-LINE-2 AFTER 1.      10360058
103700                                                                  10370058
103800     INITIALIZE DETAIL-LINE-2.                                    10380058
103900     ADD +1 TO LINE-COUNT.                                        10390058
104000 EJECT                                                            10400058
104100                                                                  10410058
104200*--------------------------------------------------------------*  10420058
104300*  WRITES THE PROBILL DC REPORT HEADERS                        *  10430058
104400*--------------------------------------------------------------*  10440058
104500 W700-WRITE-PROBILL-DC-HEADERS.                                   10450058
104600     ADD  1           TO PAGE-COUNT.                              10460058
104700     MOVE 2           TO DP150O-REPORT-NUMBER.                    10470058
104800     MOVE PAGE-COUNT  TO DP150O-PAGE-NUMBER.                      10480058
104900                                                                  10490058
105000     WRITE PROBILL-REPORT-RECORD                                  10500058
105100           FROM DP150O-STANDRD-HEADER-150-COLS                    10510058
105200           AFTER PAGE.                                            10520058
105300     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-1B    AFTER 1.     10530058
105400     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-6     AFTER 1.     10540058
105500     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-3B    AFTER 1.     10550058
105600     WRITE PROBILL-REPORT-RECORD FROM BLANK-LINE-150 AFTER 1.     10560058
105700     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-9     AFTER 1.     10570058
105800     WRITE PROBILL-REPORT-RECORD FROM HDR-LINE-10    AFTER 1.     10580058
105900     WRITE PROBILL-REPORT-RECORD FROM BLANK-LINE-150 AFTER 1.     10590058
106000     MOVE +8 TO LINE-COUNT.                                       10600058
106100 EJECT                                                            10610058
106200                                                                  10620058
106300*--------------------------------------------------------------*  10630058
106400*  WRITES THE DETAIL LINES FOR THE PROBILL REPORT              *  10640058
106500*--------------------------------------------------------------*  10650058
106600 W800-WRITE-PROBILL-DC-TOTALS.                                    10660058
106700     IF LINE-COUNT > 64                                           10670058
106800        PERFORM W500-WRITE-PROBILL-HEADERS                        10680058
106900     END-IF.                                                      10690058
107000                                                                  10700058
107100     WRITE PROBILL-REPORT-RECORD FROM DETAIL-LINE-3 AFTER 1.      10710058
107200                                                                  10720058
107300     INITIALIZE DETAIL-LINE-3.                                    10730058
107400     ADD +1 TO LINE-COUNT.                                        10740058
107500 EJECT                                                            10750058
107600                                                                  10760058
107700*--------------------------------------------------------------*  10770058
107800*  WRITES THE TOTAL LINE FOR THE PROBILL REPORT                *  10780058
107900*--------------------------------------------------------------*  10790058
108000 W900-WRITE-PROBILL-TOTAL.                                        10800058
108100                                                                  10810058
108200     WRITE PROBILL-REPORT-RECORD FROM DASH-LINE-2   AFTER 1.      10820058
108300     WRITE PROBILL-REPORT-RECORD FROM DETAIL-LINE-3 AFTER 1.      10830058
108400                                                                  10840058
108500 EJECT                                                            10850058
108600                                                                  10860058
108700*---------------------------------------------------------------  10870058
108800*     DB2 ABEND ROUTINE                                           10880058
108900*---------------------------------------------------------------  10890058
109000 Z998-DB2-ABEND.                                                  10900058
109100                                                                  10910058
109200     DISPLAY AA-ABEND-LIT.                                        10920058
109300     DISPLAY AA-DB2-ERROR-LIT.                                    10930058
109400     DISPLAY AA-PROGRAM-LIT.                                      10940058
109500     DISPLAY AA-PARAGRAPH-LIT.                                    10950058
109600     DISPLAY AA-DB2-OPERATION-LIT.                                10960058
109700     DISPLAY AA-DB2-TABLE-1.                                      10970058
109800     DISPLAY AA-DB2-TABLE-2.                                      10980058
109900     DISPLAY AA-DB2-TABLE-3.                                      10990058
110000     SET AC-DB2-ERROR TO TRUE.                                    11000058
110100                                                                  11010058
110200     COPY DPPD004.                                                11020058
110300                                                                  11030058
110400     CALL 'ILBOABN0' USING ABEND-CODE.                            11040058
110500 EJECT                                                            11050058
110600                                                                  11060058
110700*---------------------------------------------------------------  11070058
110800*     ABEND ROUTINE                                               11080058
110900*---------------------------------------------------------------  11090058
111000                                                                  11100058
111100 Z999-ABEND.                                                      11110058
111200                                                                  11120058
111300     DISPLAY AA-ABEND-LIT.                                        11130058
111400     DISPLAY AA-PROGRAM-LIT.                                      11140058
111500     DISPLAY AA-PARAGRAPH-LIT.                                    11150058
111600     DISPLAY AA-MESSAGE-LINE.                                     11160058
111700     CALL 'ILBOABN0' USING ABEND-CODE.                            11170058
111800                                                                  11180058
