000100***************************************************************** 00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300***************************************************************** 00030099
000400                                                                  00040099
000500 PROGRAM-ID.             SUKRP012.                                00050099
000600 AUTHOR.                 DAN HINTZ.                               00060099
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070099
000800 DATE-WRITTEN            OCTOBER 1997.                            00080099
000900 DATE-COMPILED.                                                   00090099
001000***************************************************************** 00100099
001100***************************************************************** 00110099
001200*  THIS PROGRAM WILL CREATE THE VENDOR ACCURACY CARTON AUDIT    * 00120099
001300*  REPORT.  IT IS PRODUCED FOLLOWING THE AUDIT OF SELECTED      * 00130099
001400*  PO/RECEIVERS IN A CARTON WHICH IS DONE USING LRT TERMINALS.  * 00140099
001500***************************************************************** 00150099
001600*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00160099
001700*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00170099
001800*                                                               * 00180099
001900***************************************************************** 00190099
002000******************************************************************00200099
002100* 02/06/14 DRW BEG                                                00210099
002200* 02/06/2014 DAVE WELLER CHG0068598 TKID: TKMA602                 00220099
002300*            CHANGES FOR RFID AUDIT PROJECT.                      00230099
002301* 02/06/14 DRW END                                                00230199
002302***************************************************************** 00230299
002303* 03/20/2014 JIM ARENDT  CHG0077565                               00230399
002304*            CHANGED PROGRAM HEADINGS AND DATA FIELDS IN SUKRP009,00230499
002305*            SUKRP010, SUKRP011 AND SUKRP012 SO THAT THEY ARE     00230599
002306*            CONSISTENT ACROSS THE 4 REPORTS.  ADDED CALLS TO     00230699
002307*            DETERMINE IF THE AUDIT IS A COMBO.                   00230799
002308******************************************************************00230899
002309* 03/28/2014 JIM ARENDT  CHG0078145                               00230999
002310*            CHANGED PROGRAM TO RESOLVE ERROR COUNT TOTALS.       00231099
002320******************************************************************00232099
002330* 04/01/2014 JIM ARENDT  CHG0079586                               00233099
002340*            ADDED NEW 3200- PARAGRAPH TO OPEN NEW CURSOR         00234099
002350*            (RFID_CURSOR) TO RETRIEVE THE RFID EXCEPTIONS WHICH  00235099
002360*            IS USED TO DETERMINE THE "TOTAL ERRORS" COUNT IN THE 00236099
002370*            HEADING.  ALSO, ADDED NEW PARAGRAPH 3300- TO RETRIEVE00237099
002380*            THE QA EXCEPTIONS COUNT.                             00238099
002390******************************************************************00239099
002400* 04/22/2014 JIM ARENDT  CHG0080352                               00240099
002500*            ADDED NEW PARAGRAPH 3400-RETRIEVE-UNIT-COUNT TO      00250099
002600*            RETRIEVE THE NUMBER OF UNITS IN ERROR FOR QC AUDITS. 00260099
002700******************************************************************00270099
002800* 04/28/2014 JIM ARENDT  CHG0080734                               00280099
002900*             ADDED PARA 3185-CHECK-FOR-RFID-DEPT TO CHECK IF     00290099
003000*             PO IS FOR DEPT WE'RE PROCESSING IS RFID. PERFORM    00300099
003100*             OF THIS PARA WAS ADDED TO PARA 3170-CHECK-COMBO.    00310099
003101******************************************************************00310199
003102 ENVIRONMENT DIVISION.                                            00310299
003103***************************************************************** 00310399
003104                                                                  00310499
003105 CONFIGURATION SECTION.                                           00310599
003106                                                                  00310699
003107 SOURCE-COMPUTER.        IBM-3090.                                00310799
003108 OBJECT-COMPUTER.        IBM-3090.                                00310899
003109                                                                  00310999
003110 INPUT-OUTPUT SECTION.                                            00311099
003111                                                                  00311199
003112 FILE-CONTROL.                                                    00311299
003200*                                                                 00320099
003300     SELECT PRINT-CONTROL-FILE                                    00330099
003400         ASSIGN TO PRTIN.                                         00340099
003500                                                                  00350099
003600* 02/06/14 DRW BEG                                                00360099
003700     SELECT CARDIN-AUDIT-NBR-FILE                                 00370099
003800         ASSIGN TO CARDIN.                                        00380099
003900* 02/06/14 DRW END                                                00390099
003901                                                                  00390199
003902     SELECT AUDIT-CART-EXTRACT-FILE                               00390299
003903         ASSIGN TO INP01.                                         00390399
003904*                                                                 00390499
003905     SELECT AUDIT-UPC-EXTRACT-FILE                                00390599
004000         ASSIGN TO INP02.                                         00400099
004100*                                                                 00410099
004200     SELECT OS-SKUTOT-OVER-SHORT-FILE                             00420099
004300         ASSIGN TO INP03.                                         00430099
004400*                                                                 00440099
004500     SELECT CARTON-AUDIT-RPT-FILE                                 00450099
004600         ASSIGN TO RPT01.                                         00460099
004700*                                                                 00470099
004800***************************************************************** 00480099
004900 DATA DIVISION.                                                   00490099
005000***************************************************************** 00500099
005100*                                                                 00510099
005200 FILE SECTION.                                                    00520099
005300*                                                                 00530099
005400*                                                                 00540099
005500 FD  CARDIN-AUDIT-NBR-FILE                                        00550099
005600     LABEL RECORDS ARE STANDARD                                   00560099
005700     RECORDING MODE IS F                                          00570099
005800     BLOCK CONTAINS 0 RECORDS                                     00580099
005900     RECORD CONTAINS 80 CHARACTERS.                               00590099
005901 01  CC-RECORD                       PIC X(80).                   00590199
005902*                                                                 00590299
005903 FD  AUDIT-CART-EXTRACT-FILE                                      00590399
005904     RECORDING MODE IS F                                          00590499
005905     LABEL RECORDS ARE STANDARD                                   00590599
005906     BLOCK CONTAINS 0 RECORDS                                     00590699
005907     RECORD CONTAINS 200 CHARACTERS.                              00590799
006000                                                                  00600099
006100 01  AUDIT-CART-EXTRACT-RECORD       PIC  X(200).                 00610099
006200*                                                                 00620099
006300*                                                                 00630099
006400 FD  AUDIT-UPC-EXTRACT-FILE                                       00640099
006500     RECORDING MODE IS F                                          00650099
006600     LABEL RECORDS ARE STANDARD                                   00660099
006700     BLOCK CONTAINS 0 RECORDS                                     00670099
006800     RECORD CONTAINS 200 CHARACTERS.                              00680099
006900                                                                  00690099
007000 01  AUDIT-UPC-EXTRACT-RECORD        PIC  X(200).                 00700099
007100*                                                                 00710099
007200*                                                                 00720099
007300 FD  CARTON-AUDIT-RPT-FILE                                        00730099
007400     RECORDING MODE IS F                                          00740099
007500     BLOCK CONTAINS 0  RECORDS.                                   00750099
007600 01  CARTON-AUDIT-RPT-RECORD      PIC  X(132).                    00760099
007700*                                                                 00770099
007800 FD  PRINT-CONTROL-FILE                                           00780099
007900     RECORDING MODE IS F                                          00790099
008000     BLOCK CONTAINS 0  RECORDS.                                   00800099
008100 01  PRINT-CONTROL-CARD              PIC  X(080).                 00810099
008200*                                                                 00820099
008300 FD  OS-SKUTOT-OVER-SHORT-FILE                                    00830099
008400     RECORDING MODE IS F                                          00840099
008500     LABEL RECORDS ARE STANDARD                                   00850099
008600     BLOCK CONTAINS 0 RECORDS.                                    00860099
008700 01  OS-SKUTOT-OVER-SHORT-RECORD         PIC  X(200).             00870099
008800*                                                                 00880099
008900                                                                  00890099
009000 WORKING-STORAGE SECTION.                                         00900099
009100*                                                                 00910099
009200 01  DK-DB2-KEY-VALUE.                                            00920099
009300     05  DK-AUD-CNTL-NBR                 PIC S9(09)  COMP.        00930099
009400     05  DK-SHIPT-UNT-ID                 PIC S9(18)V COMP-3.      00940099
009410     05  DK-RCVR-SEQ                     PIC S9(09)  COMP.        00941099
009500     05  DK-UPC-NBR                      PIC S9(15)  COMP-3.      00950099
009600     05  DK-PO-NBR                       PIC S9(09)  COMP.        00960099
009700     05  DK-OPER-UNT-ID                  PIC S9(04)  COMP.        00970099
009800     05  DK-REC-SEQ-NBR                  PIC S9(09)  COMP.        00980099
009801     05  DK-DEPT-NBR                     PIC S9(04)V COMP-3.      00980199
009802     05  DK-SKU-NBR                      PIC S9(08)V COMP-3.      00980299
009803*                                                                 00980399
009804 01  PA-PROGRAM-ACCUMULATORS.                                     00980499
009805     05  PA-PIC-ERROR-SUMMARY-TABLE.                              00980599
009900       07 FILLER OCCURS 25 TIMES.                                 00990099
010000         10 PA-PIC-ERROR-DESC.                                    01000099
010100             15 FILLER                 PIC   X(08) VALUE SPACES.  01010099
010200             15 PA-PIC-ERROR           PIC   X(15).               01020099
010300         10 PA-PIC-ERROR-QTY           PIC  S9(04) COMP.          01030099
010400                                                                  01040099
010500     05  PA-TIC-ERROR-SUMMARY-TABLE.                              01050099
010600       07 FILLER OCCURS 25 TIMES.                                 01060099
010700         10 PA-TIC-ERROR-DESC.                                    01070099
010800             15 FILLER                 PIC   X(08) VALUE SPACES.  01080099
010900             15 PA-TIC-ERROR           PIC   X(15).               01090099
011000         10 PA-TIC-ERROR-QTY           PIC  S9(04) COMP.          01100099
011100                                                                  01110099
011101* 02/06/14 DRW BEG                                                01110199
011102     05  PA-RFID-ERROR-SUMMARY-TABLE.                             01110299
011103       07 FILLER OCCURS 25 TIMES.                                 01110399
011104         10 PA-RFID-ERROR-DESC.                                   01110499
011105             15 FILLER                 PIC   X(08) VALUE SPACES.  01110599
011106             15 PA-RFID-ERROR          PIC   X(15).               01110699
011107         10 PA-RFID-ERROR-QTY          PIC  S9(04) COMP.          01110799
011108* 02/06/14 DRW END                                                01110899
011109                                                                  01110999
011200     05  PA-OTH-ERROR-SUMMARY-TABLE.                              01120099
011300       07 FILLER OCCURS 25 TIMES.                                 01130099
011400         10 PA-OTH-ERROR-DESC.                                    01140099
011500             15 FILLER                 PIC   X(08) VALUE SPACES.  01150099
011600             15 PA-OTH-ERROR           PIC   X(15).               01160099
011700         10 PA-OTH-ERROR-QTY           PIC  S9(04) COMP.          01170099
011800                                                                  01180099
011900* 02/04/14 DRW BEG                                                01190099
012000 01  PC-EXCEPTIONS.                                               01200099
012100     05  PC-STYLE-SUB                    PIC S9(04)  VALUE +09.   01210099
012200     05  PC-UPC-MISDIRECT                PIC S9(04)  VALUE +12.   01220099
012300     05  PC-WRONG-TICKET-DEPT            PIC S9(04)  VALUE +13.   01230099
012400     05  PC-WRONG-TICKET-RETAIL          PIC S9(04)  VALUE +14.   01240099
012500     05  PC-WRONG-TICKET-COLOR           PIC S9(04)  VALUE +15.   01250099
012600     05  PC-WRONG-TICKET-SIZE            PIC S9(04)  VALUE +16.   01260099
012700     05  PC-WRONG-MDSE-LBL-RETAIL        PIC S9(04)  VALUE +17.   01270099
012800     05  PC-WRONG-MDSE-LBL-COLOR         PIC S9(04)  VALUE +18.   01280099
012900     05  PC-WRONG-MDSE-LBL-SIZE          PIC S9(04)  VALUE +19.   01290099
013000     05  PC-WRONG-TICKET-MAJ-CLS         PIC S9(04)  VALUE +21.   01300099
013100     05  PC-WRONG-TICKET-SUB-CLS         PIC S9(04)  VALUE +22.   01310099
013200     05  PC-WRONG-TICKET-STYLE           PIC S9(4)   VALUE +24.   01320099
013300     05  PC-WRONG-MDSE-LBL-STYLE         PIC S9(4)   VALUE +25.   01330099
013400     05  PC-WRONG-BOX-ID                 PIC S9(4)   VALUE +26.   01340099
013500     05  PC-WRONG-TKT-MDSE-OK            PIC S9(4)   VALUE +27.   01350099
013600     05  PC-NO-MDSE-TAG                  PIC S9(4)   VALUE +28.   01360099
013700     05  PC-RFID-UPC-MISPCK              PIC S9(4)   VALUE +38.   01370099
013800     05  PC-WRG-RFD-TGS-CLR              PIC S9(4)   VALUE +39.   01380099
013900     05  PC-WRG-RFD-TGS-SIZ              PIC S9(4)   VALUE +40.   01390099
014000     05  PC-WRG-RFD-TGS-STL              PIC S9(4)   VALUE +41.   01400099
014100     05  PC-VA-NO-EPC-LOGO               PIC S9(4)   VALUE +42.   01410099
014101* 02/04/14 DRW END                                                01410199
014102                                                                  01410299
014103 01  PROGRAM-SWITCHES.                                            01410399
014104* 02/04/14 DRW END                                                01410499
014105     05  PS-END-OF-CARDIN-SW         PIC  X(01)    VALUE 'N'.     01410599
014106         88  PS-END-OF-CARDIN-FILE                 VALUE 'Y'.     01410699
014107         88  PS-NOT-END-OF-CARDIN-FILE             VALUE 'N'.     01410799
014108     05  PS-MANUAL-COMBO-SW          PIC  X(01)    VALUE 'N'.     01410899
014109         88  PS-MANUAL-COMBO-AUDIT                 VALUE 'Y'.     01410999
014110         88  PS-NOT-MANUAL-COMBO-AUDIT             VALUE 'N'.     01411099
014120     05  PS-PO-EXCEPTION-SW          PIC  X(01)  VALUE SPACE.     01412099
014130         88 PS-PO-EXCEPTION                        VALUE 'Y'.     01413099
014140         88 PS-NO-PO-EXCEPTION                     VALUE 'N'.     01414099
014150     05  PS-VENDOR-RFID-AGRMNT-SW    PIC  X(01)  VALUE SPACE.     01415099
014160         88 PS-VENDOR-TAGGING                      VALUE 'T'.     01416099
014170         88 PS-VENDOR-COMPLIANT                    VALUE 'C'.     01417099
014180         88 PS-VENDOR-NOT-TAGGING                  VALUE 'N'.     01418099
014181* 02/04/14 DRW END                                                01418199
014182     05  PS-END-OF-CART-EXT-FILE-SW  PIC  X(01)    VALUE 'N'.     01418299
014183         88  PS-END-OF-CART-EXT-FILE               VALUE 'Y'.     01418399
014184         88  PS-NOT-END-OF-CART-EXT-FILE           VALUE 'N'.     01418499
014185     05  PS-END-OF-UPC-EXT-FILE-SW   PIC  X(01)    VALUE 'N'.     01418599
014186         88  PS-END-OF-UPC-EXT-FILE                VALUE 'Y'.     01418699
014187         88  PS-NOT-END-OF-UPC-EXT-FILE            VALUE 'N'.     01418799
014188     05  PS-END-OF-EXCEPTIONS-CSR-SW PIC  X(01)    VALUE 'N'.     01418899
014189         88  PS-END-OF-EXCEPTIONS-CSR              VALUE 'Y'.     01418999
014190         88  PS-NOT-END-OF-EXCEPTIONS-CSR          VALUE 'N'.     01419099
014191     05  PS-END-OF-CART-EXCEP-CSR-SW PIC  X(01)    VALUE 'N'.     01419199
014192         88  PS-END-OF-CART-EXCEP-CSR              VALUE 'Y'.     01419299
014193         88  PS-NOT-END-OF-CART-EXCEP-CSR          VALUE 'N'.     01419399
014194     05  PS-PRINT-UPC-INFO-SW        PIC  X(01)    VALUE 'Y'.     01419499
014195         88  PS-PRINT-UPC-INFO                     VALUE 'Y'.     01419599
014196         88  PS-DO-NOT-PRINT-UPC-INFO              VALUE 'N'.     01419699
014197     05  PS-PRINT-SKU-INFO-SW        PIC  X(01)    VALUE 'Y'.     01419799
014198         88  PS-PRINT-SKU-INFO                     VALUE 'Y'.     01419899
014199         88  PS-DO-NOT-PRINT-SKU-INFO              VALUE 'N'.     01419999
014200     05  PS-PRINT-SKU-ORD-SW         PIC  X(01)    VALUE 'Y'.     01420099
014201         88  PS-PRINT-SKU-ORD                      VALUE 'Y'.     01420199
014202         88  PS-DO-NOT-PRINT-SKU-ORD               VALUE 'N'.     01420299
014203     05  PS-CART-EXCEP-SW            PIC  X(01)    VALUE 'N'.     01420399
014300         88  PS-CART-EXCEP-FOUND                   VALUE 'Y'.     01430099
014400         88  PS-CART-EXCEP-NOT-FOUND               VALUE 'N'.     01440099
014500     05  PS-ERROR-FOUND-SW           PIC  X(01)    VALUE 'N'.     01450099
014600         88  PS-ERROR-FOUND                        VALUE 'Y'.     01460099
014700         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     01470099
014800     05  PS-VENDOR-OVER-SW           PIC  X(01)    VALUE 'N'.     01480099
014900         88  PS-VENDOR-OVER                        VALUE 'Y'.     01490099
015000         88  PS-NOT-VENDOR-OVER                    VALUE 'N'.     01500099
015100     05  PS-DETAIL-FROM-TSUAUPC-SW   PIC  X(01)    VALUE 'Y'.     01510099
015200         88  PS-DETAIL-FROM-TSUAUPC                VALUE 'Y'.     01520099
015300         88  PS-DETAIL-NOT-FROM-TSUAUPC            VALUE 'N'.     01530099
015400     05  PS-DATA-TO-REPORT-SW        PIC  X(01)    VALUE 'N'.     01540099
015500         88  NO-DATA-TO-REPORT                     VALUE 'Y'.     01550099
015600         88  DATA-TO-REPORT                        VALUE 'N'.     01560099
015700     05  PS-SKU-MATCH-IND                PIC  X(01)  VALUE 'N'.   01570099
015800         88  PS-SKU-MATCH                            VALUE 'Y'.   01580099
015900         88  PS-SKU-NOT-MATCH                        VALUE 'N'.   01590099
016000         88  PS-SKU-SEARCH-PROCESS                   VALUE 'S'.   01600099
016100     05  PS-EOF-SKU-TOTAL-FILE-IND       PIC  X(01)  VALUE 'N'.   01610099
016200         88  PS-EOF-SKU-TOTAL-FILE                   VALUE 'Y'.   01620099
016300         88  PS-NOT-EOF-SKU-TOTAL-FILE               VALUE 'N'.   01630099
016400     05  PS-FIRST-DETAIL-PRINT-SW        PIC  X(01)  VALUE 'Y'.   01640099
016500         88  PS-FIRST-DETAIL-PRINT                   VALUE 'Y'.   01650099
016600         88  PS-NOT-FIRST-DETAIL-PRINT               VALUE 'N'.   01660099
016700* 02/06/14 DRW BEG                                                01670099
016800     05  PS-EOC-QC-ERR-CSR-IND           PIC  X(01)  VALUE 'N'.   01680099
016900         88  PS-EOC-QC-ERR-CSR                       VALUE 'Y'.   01690099
017000         88  PS-NOT-EOC-QC-ERR-CSR                   VALUE 'N'.   01700099
017100     05  PS-EOC-RFID-ERR-CSR-LT42-IND    PIC X(01)   VALUE 'N'.   01710099
017200         88  PS-EOC-RFID-ERR-CSR-LT42                VALUE 'Y'.   01720099
017300         88  PS-NOT-EOC-RFID-ERR-CSR-LT42            VALUE 'N'.   01730099
017400     05  PS-EOC-RFID-ERR-CSR-EQ42-IND    PIC  X(01)  VALUE 'N'.   01740099
017500         88  PS-EOC-RFID-ERR-CSR-EQ42                VALUE 'Y'.   01750099
017600         88  PS-NOT-EOC-RFID-ERR-CSR-EQ42            VALUE 'N'.   01760099
017700     05  PS-END-OF-RFID-CURSOR-IND       PIC  X(01)  VALUE 'N'.   01770099
017800         88  PS-END-OF-RFID-CURSOR                   VALUE 'Y'.   01780099
017900         88  PS-NOT-END-OF-RFID-CURSOR               VALUE 'N'.   01790099
018000* 02/06/14 DRW END                                                01800099
018100*JA 04/28/14 - BEGIN                                              01810099
018200     05  PS-RFID-DEPT-IND                PIC  X(01)  VALUE 'N'.   01820099
018300         88  PS-RFID-DEPT-YES                        VALUE 'Y'.   01830099
018400         88  PS-RFID-DEPT-NO                         VALUE 'N'.   01840099
018401*JA 04/28/14 - END                                                01840199
018402*                                                                 01840299
018403 01  PC-CONSTANTS.                                                01840399
018404     05  PC-1                        PIC S9(03)    VALUE +1       01840499
018405                                                   COMP-3.        01840599
018406     05  PC-2                        PIC S9(03)    VALUE +2       01840699
018407                                                   COMP-3.        01840799
018408     05  PC-3                        PIC S9(03)    VALUE +3       01840899
018409                                                   COMP-3.        01840999
018410     05  PC-5                        PIC S9(01)    VALUE +5       01841099
018411                                                   COMP-3.        01841199
018412     05  PC-15                       PIC S9(03)    VALUE +15      01841299
018413                                                   COMP-3.        01841399
018414     05  PC-MAX-REPORT-LINES         PIC S9(03)    VALUE +60      01841499
018415                                                   COMP-3.        01841599
018416     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01841699
018417     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01841799
018418     05  PC-00                       PIC  X(02)    VALUE '00'.    01841899
018419     05  PC-LONG-NAME                PIC  X(02)    VALUE '01'.    01841999
018500     05  PC-ACTIVE-STATUS            PIC  X(01)    VALUE 'A'.     01850099
018600     05  PC-E                        PIC  X(01)    VALUE 'E'.     01860099
018601     05  PC-R                        PIC  X(01)    VALUE 'R'.     01860199
018602     05  PC-S                        PIC  X(01)    VALUE 'S'.     01860299
018603     05  PC-VA                       PIC  X(02)    VALUE 'VA'.    01860399
018700     05  PC-SUKRP012                 PIC  X(08)    VALUE          01870099
018800         'SUKRP012'.                                              01880099
018900     05  PC-100-PCT-CHECK            PIC  X(10)    VALUE          01890099
019000         '100% CHECK'.                                            01900099
019100     05  PC-SPOT-CHECK               PIC  X(10)    VALUE          01910099
019200         'SPOT CHECK'.                                            01920099
019300     05  PC-REWORK                   PIC  X(10)    VALUE          01930099
019400         'REWORK    '.                                            01940099
019500     05  PC-IN-PROCESS               PIC  X(10)    VALUE          01950099
019600         'IN PROCESS'.                                            01960099
019700     05  PC-COMPLETE                 PIC  X(10)    VALUE          01970099
019800         'COMPLETE  '.                                            01980099
019900     05  PC-POSTPONED                PIC  X(10)    VALUE          01990099
020000         'POSTPONED '.                                            02000099
020100     05  PC-UNKNOWN                  PIC  X(10)    VALUE          02010099
020200         'UNKNOWN   '.                                            02020099
020300     05  PC-DEFAULT-TMST             PIC  X(26)    VALUE          02030099
020400         '9999-09-09-09.09.09.999999'.                            02040099
020500     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACES.  02050099
020600     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       02060099
020700     05  PC-PICKING-VILNS.                                        02070099
020800         10  PC-STYLE-SUB-VILN       PIC S9(4)   COMP             02080099
020900                                                 VALUE 9.         02090099
021000         10  PC-NO-DC-OTR-VILN       PIC S9(4)   COMP             02100099
021100                                                 VALUE 10.        02110099
021200         10  PC-NO-PBS-ALLOC-VILN    PIC S9(4)   COMP             02120099
021300                                                 VALUE 11.        02130099
021400         10  PC-DMGD-MDSE-VILN       PIC S9(4)   COMP             02140099
021500                                                 VALUE 20.        02150099
021600     05  PC-TICKETING-VILNS.                                      02160099
021700         10  PC-NO-BARCODE-VILN      PIC S9(4)   COMP             02170099
021800                                                 VALUE 3.         02180099
021900         10  PC-DMGD-BARCODE-VILN    PIC S9(4)   COMP             02190099
022000                                                 VALUE 4.         02200099
022100         10  PC-NO-UPC-VILN          PIC S9(4)   COMP             02210099
022200                                                 VALUE 5.         02220099
022300         10  PC-WRONG-UPC-VILN       PIC S9(4)   COMP             02230099
022400                                                 VALUE 6.         02240099
022500         10  PC-SKU-NOT-FOUND-VILN   PIC S9(4)   COMP             02250099
022600                                                 VALUE 7.         02260099
022700         10  PC-NO-TAG-TICKET-VILN   PIC S9(4)   COMP             02270099
022800                                                 VALUE 8.         02280099
022900         10  PC-WRONG-DEPT-TKT-VILN  PIC S9(4)   COMP             02290099
023000                                                 VALUE 13.        02300099
023100         10  PC-WRONG-RETAIL-TKT-VILN                             02310099
023200                                     PIC S9(4)   COMP             02320099
023300                                                 VALUE 14.        02330099
023400         10  PC-WRONG-COLOR-TKT-VILN PIC S9(4)   COMP             02340099
023500                                                 VALUE 15.        02350099
023600         10  PC-WRONG-SIZE-TKT-VILN  PIC S9(4)   COMP             02360099
023700                                                 VALUE 16.        02370099
023800         10  PC-WRONG-RETAIL-MDSE-VILN                            02380099
023900                                     PIC S9(4)   COMP             02390099
024000                                                 VALUE 17.        02400099
024100         10  PC-WRONG-COLOR-MDSE-VILN                             02410099
024200                                     PIC S9(4)   COMP             02420099
024300                                                 VALUE 18.        02430099
024400         10  PC-WRONG-SIZE-MDSE-VILN PIC S9(4)   COMP             02440099
024500                                                 VALUE 19.        02450099
024600         10  PC-WRONG-MAJ-CL-TKT-VILN PIC S9(4)  COMP             02460099
024700                                                 VALUE 21.        02470099
024800         10  PC-WRONG-SUB-CLS-TKT-VILN PIC S9(4) COMP             02480099
024900                                                 VALUE 22.        02490099
025000         10  PC-SIZE-STRIP-MDSE-VILN PIC S9(4)   COMP             02500099
025100                                                 VALUE 23.        02510099
025200         10  PC-WRONG-STYLE-TKT-VILN PIC S9(4)   COMP             02520099
025300                                                 VALUE 24.        02530099
025400         10  PC-MDSE-STYLE-TKT-VILN  PIC S9(4)   COMP             02540099
025500                                                 VALUE 25.        02550099
025600         10  PC-WRONG-BOX-ID-VILN    PIC S9(4)   COMP             02560099
025700                                                 VALUE 26.        02570099
025800         10  PC-WRONG-TKT-TKT-VILN   PIC S9(4)   COMP             02580099
025900                                                 VALUE 27.        02590099
026000         10  PC-NO-MDSE-TAG-VILN     PIC S9(4)   COMP             02600099
026100                                                 VALUE 28.        02610099
026101* 02/06/14 DRW BEG                                                02610199
026102     05  PC-RFID-VILNS.                                           02610299
026103         10  PC-RFID-UPC-MISPK-VILN  PIC S9(4)   COMP             02610399
026104                                                 VALUE 38.        02610499
026105         10  PC-WRG-RFID-STYLE-VILN  PIC S9(4)   COMP             02610599
026106                                                 VALUE 39.        02610699
026107         10  PC-WRG-RFID-SIZE-VILN   PIC S9(4)   COMP             02610799
026108                                                 VALUE 40.        02610899
026109         10  PC-WRG-RFID-CLR-VILN    PIC S9(4)   COMP             02610999
026110                                                 VALUE 41.        02611099
026111         10  PC-NO-RFID-TKT-VILN     PIC S9(4)   COMP             02611199
026112                                                 VALUE 42.        02611299
026113* 02/06/14 DRW END                                                02611399
026200     05  PC-OTHER-VILNS.                                          02620099
026300         10  PC-PO-DIFF-ON-CART-VILN PIC S9(4)   COMP             02630099
026400                                                 VALUE 1.         02640099
026500         10  PC-STR-DIF-ON-CART-VILN                              02650099
026600                                     PIC S9(4)   COMP             02660099
026700                                                 VALUE 2.         02670099
026800*                                                                 02680099
026900 01  PV-MISC-FIELDS.                                              02690099
027000     05  PV-DISP-COMP                PIC ZZZZZ,ZZ9.               02700099
027100     05  PV-SUB-CL-NBR               PIC S9(04)V    VALUE +0      02710099
027200                                                    COMP-3.       02720099
027300     05  PV-SUB-CL-NBR-9             PIC  9(04)     VALUE  0.     02730099
027400     05  PV-SUB-CL-NBR-X REDEFINES PV-SUB-CL-NBR-9.               02740099
027500         10  FILLER                  PIC X(02).                   02750099
027600         10  PV-SUB-CL-3-4           PIC X(02).                   02760099
027700     05  PV-COUNT                    PIC S9(04)    COMP.          02770099
027800     05  PV-SUM-LINE-COUNT           PIC S9(04)    VALUE +0       02780099
027900                                                   COMP SYNC.     02790099
028000     05  PV-DETAIL-LINE-COUNT        PIC S9(04)    VALUE +0       02800099
028100                                                   COMP SYNC.     02810099
028200     05  PV-DB2-RFID-EXCP-COUNT      PIC S9(09)    COMP VALUE +0. 02820099
028300     05  PV-SCND-UNT-QTY             PIC S9(09)    COMP VALUE +0. 02830099
028400     05  PV-RFID-TGD-QTY             PIC S9(09)    COMP VALUE +0. 02840099
028500     05  PV-TOT-UNITS-DIFF           PIC S9(09)    COMP VALUE +0. 02850099
028600     05  PV-TOT-UNITS-AUDITED        PIC S9(09)    COMP VALUE +0. 02860099
028601     05  PV-TOTAL-ERROR-QTY          PIC S9(09)    COMP VALUE +0. 02860199
028602     05  PV-DISPLAY-PREPK-ID         PIC  9(04)    VALUE ZERO.    02860299
028603     05  PV-HOLD-TMST                PIC  X(26)    VALUE SPACES.  02860399
028604     05  PV-DISP-DEC                 PIC ZZ,ZZ9.99.               02860499
028605     05  PV-ERROR-QTY                PIC S9(04)    COMP VALUE +0. 02860599
028606     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     02860699
028607                                                   COMP-3.        02860799
028608     05  PV-SUM-LINE-CNT             PIC S9(03)    VALUE ZERO     02860899
028609                                                   COMP-3.        02860999
028610     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     02861099
028611                                                   COMP-3.        02861199
028612     05  DN-EXP-UNTS                 PIC S9(04) COMP VALUE +0.    02861299
028613     05  DN-AUD-UNTS                 PIC S9(04) COMP VALUE +0.    02861399
028614     05  DN-RFID-AUD-UNTS            PIC S9(04) COMP VALUE +0.    02861499
028615     05  PV-UNITS-IN-ERROR           PIC S9(04)    VALUE ZERO     02861599
028616                                                   COMP SYNC.     02861699
028617     05  PV-RFID-UNITS-IN-ERROR      PIC S9(09) COMP VALUE +0.    02861799
028618     05  PV-DB2-EXCEPTION-COUNT      PIC S9(09) COMP VALUE +0.    02861899
028619     05  PV-DL-EXCEPTION-COUNT       PIC S9(09) COMP VALUE +0.    02861999
028620     05  PV-RFID-TGD-COUNT           PIC S9(09) COMP VALUE +0.    02862099
028630     05  PV-SCND-UNT-COUNT           PIC S9(09) COMP VALUE +0.    02863099
028640     05  PV-HL-UNITS-IN-ERROR        PIC S9(09) COMP VALUE +0.    02864099
028641     05  PV-HL-TOTAL-ERRORS          PIC S9(09) COMP VALUE +0.    02864199
028642     05  PV-LINE-TOTAL               PIC S9(04)    VALUE ZERO     02864299
028643                                                   COMP SYNC.     02864399
028644     05  PV-EXPTED-QTY               PIC S9(04)    VALUE ZERO     02864499
028645                                                   COMP SYNC.     02864599
028646     05  PV-ERROR-IDX                PIC S9(04)    VALUE ZERO     02864699
028647                                                   COMP SYNC.     02864799
028648     05  PV-AUDIT-DURATION-TIME      PIC S9(09)    VALUE ZERO     02864899
028700                                                   COMP SYNC.     02870099
028800     05  PV-AUDIT-DURATION-HOURS     PIC S9(09)    VALUE ZERO     02880099
028900                                                   COMP SYNC.     02890099
029000     05  PV-AUDIT-DURATION-MINUTES   PIC S9(09)    VALUE ZERO     02900099
029100                                                   COMP SYNC.     02910099
029200     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     02920099
029300                                                   COMP SYNC.     02930099
029400     05  PV-DB2-ROW-COUNT            PIC S9(09)    COMP.          02940099
029500*JA  BEG                                                          02950099
029600     05  PV-RF-ERRORS                PIC S9(09)    VALUE ZERO     02960099
029700                                                   COMP.          02970099
029800     05  PV-QC-ERRORS                PIC S9(09)    VALUE ZERO     02980099
029900                                                   COMP.          02990099
030000     05  PV-RFID-COUNT               PIC S9(09)    VALUE +0       03000099
030001                                                   COMP.          03000199
030002     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     03000299
030003                                                   COMP SYNC.     03000399
030004     05  PV-AUDITED-UNITS            PIC S9(09)    VALUE ZERO     03000499
030005                                                   COMP SYNC.     03000599
030006     05  PV-RFID-AUDITED-UNITS       PIC S9(09)    VALUE ZERO     03000699
030007                                                   COMP SYNC.     03000799
030008*    05  PV-HL-AUDITED-UNITS         PIC S9(09)    VALUE ZERO     03000899
030009*                                                  COMP SYNC.     03000999
030010     05  PV-CTN-LVL-ERRORS           PIC S9(09)    VALUE ZERO     03001099
030011                                                   COMP SYNC.     03001199
030012     05  PV-TOTAL-ERRORS             PIC S9(09)    VALUE ZERO     03001299
030100                                                   COMP SYNC.     03010099
030200     05  PV-OVER-SHORT-AMT           PIC S9(09)    VALUE ZERO     03020099
030300                                                   COMP SYNC.     03030099
030400     05  PV-SCAN-COUNT               PIC S9(09)    VALUE +0       03040099
030401                                                   COMP.          03040199
030402                                                                  03040299
030500     05  PV-EXPECTED-UNITS           PIC S9(09)    VALUE ZERO     03050099
030600                                                   COMP-3.        03060099
030700* 02/06/14 DRW BEG                                                03070099
030800*    Expanded digits to right of decimal so they print:           03080099
030801*    33.33 instead of 33.00                                       03080199
030802     05  PV-PCT-UNITS-IN-ERROR       PIC S9(03)V9(4) VALUE ZERO   03080299
030803                                                   COMP-3.        03080399
030804* 02/06/14 DRW END                                                03080499
030805*    05  PV-HL-PCT-UNITS-IN-ERROR    PIC S9(03)V99 VALUE ZERO     03080599
030806*                                                  COMP-3.        03080699
030900     05  PV-PREV-UPC                 PIC S9(15)    VALUE ZERO     03090099
031000                                                   COMP-3.        03100099
031100     05  PV-QTY-ORD-RCVD-X.                                       03110099
031200         10  PV-QTY-ORD-RCVD         PIC  ZZZZ9    VALUE ZEROS.   03120099
031300     05  PV-UPC-RTL-AMT-X.                                        03130099
031400         10  PV-UPC-RTL-AMT          PIC  ZZZZZ9.99               03140099
031500                                                   VALUE ZEROS.   03150099
031600     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  03160099
031610     05  PV-UNION-TYPE               PIC  X(01).                  03161099
031700     05  DN-EXP-UNT                  PIC S9(04) COMP VALUE +0.    03170099
031800     05  PV-ERROR-DESC               PIC  X(15)    VALUE SPACES.  03180099
031900         88 PV-TICKETING-ERROR       VALUE 'NO BARCODE     ',     03190099
032000                                           'DMG BARCODE    ',     03200099
032100                                           'NO UPC         ',     03210099
032200                                           'UPC NOT IN SYS ',     03220099
032300                                           'SKU NOT IN SYST',     03230099
032400                                           'NO TKT ON MDSE ',     03240099
032500                                           'WRG TKT - DPT  ',     03250099
032600                                           'WRG TKT - RTL  ',     03260099
032700                                           'WRG TKT - CLR  ',     03270099
032800                                           'WRG TKT - SIZE ',     03280099
032900                                           'WRG MDSE - RTL ',     03290099
033000                                           'WRG MDSE - CLR ',     03300099
033100                                           'WRG MDSE - SIZE',     03310099
033200                                           'WRG TKT - CLASS',     03320099
033300                                           'WRG TKT - SKU  ',     03330099
033400                                           'SIZE STRIP ERR ',     03340099
033500                                           'WRG TKT - STYLE',     03350099
033600                                           'WRG MDSE- STYLE',     03360099
033800                                           'WRG TKT/MDSE OK',     03380099
033900                                           'VA Wrg UPC     ',     03390099
033901                                           'VA WRG UPC     ',     03390199
033902                                           'WRG BOX ID     ',     03390299
033903*JA BEG                                                           03390399
033904                                           'VA No Tick     ',     03390499
033905*JA END                                                           03390599
033906                                           'NO MDSE TAG    '.     03390699
034000                                                                  03400099
034100         88 PV-PICKING-ERROR         VALUE 'STYLE SUB      ',     03410099
034200                                           'NO DC OTR      ',     03420099
034300                                           'NO ALLOC       ',     03430099
034400                                           'DMG MDSE       ',     03440099
034500                                           'VENDOR OVER    ',     03450099
034600                                           'VENDOR SHORT   ',     03460099
034700                                           'RCVR OVER      ',     03470099
034800                                           'VND OVER/MISPCK',     03480099
034900                                           'RCVR SHORT     '.     03490099
035000                                                                  03500099
035100         88 PV-RFID-ERROR            VALUE 'WRG TAGS-NO EPC',     03510099
035200                                           'WRG RFD TGS-CLR',     03520099
035300                                           'WRG RFD TGS-SIZ',     03530099
035400                                           'WRG RFD TGS-STL',     03540099
035500                                           'VA NO RF TAGS  ',     03550099
035600                                           'RFID UPC MISPCK',     03560099
035700*JA BEG                                                           03570099
035800                                           'VA NO EPC LOGO '.     03580099
035801*JA END                                                           03580199
035802                                                                  03580299
035803         88 PV-OTHER-ERROR           VALUE 'PO DIFF ON CART',     03580399
035804                                           'STR DIF ON CART'.     03580499
035805                                                                  03580599
035806     05  PV-AUD-CNTL-NBR             PIC  9(09)    VALUE ZERO.    03580699
035807     05  PV-OPER-UNT-ID              PIC  9(04)    VALUE ZERO.    03580799
035808     05  PV-SHIPT-UNT-ID             PIC  9(18)    VALUE ZERO.    03580899
035809     05  PV-SHIPT-UNT-ID-R           REDEFINES                    03580999
035810         PV-SHIPT-UNT-ID.                                         03581099
035900         10  PV-SHIPT-UNT-ID-18      PIC  9(01).                  03590099
036000         10  PV-SHIPT-UNT-ID-11-17   PIC  9(07).                  03600099
036100         10  PV-SHIPT-UNT-ID-2-10    PIC  9(09).                  03610099
036200         10  PV-SHIPT-UNT-ID-1       PIC  9(01).                  03620099
036300     05  PV-FMT-SHIPT-UNT-ID.                                     03630099
036400         10  PV-FMT-SHIPT-UNT-ID-18                               03640099
036500                                     PIC  9(01)    VALUE ZERO.    03650099
036600         10  FILLER                  PIC  X(01)    VALUE SPACE.   03660099
036700         10  PV-FMT-SHIPT-UNT-ID-11-17                            03670099
036800                                     PIC  9(07)    VALUE ZERO.    03680099
036900         10  FILLER                  PIC  X(01)    VALUE SPACE.   03690099
037000         10  PV-FMT-SHIPT-UNT-ID-2-10                             03700099
037100                                     PIC  9(09)    VALUE ZERO.    03710099
037200         10  FILLER                  PIC  X(01)    VALUE SPACE.   03720099
037300         10  PV-FMT-SHIPT-UNT-ID-1   PIC  9(01)    VALUE ZERO.    03730099
037400     05  PV-TODAYS-DATE.                                          03740099
037500         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    03750099
037600         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    03760099
037700         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    03770099
037800     05  PV-TODAYS-TIME.                                          03780099
037900         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    03790099
038000         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    03800099
038100         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    03810099
038200         10  FILLER                  PIC  9(02)    VALUE ZERO.    03820099
038300     05  PV-DB2-DATE.                                             03830099
038400         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    03840099
038500         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    03850099
038600         10  FILLER                  PIC  X(01)    VALUE ZERO.    03860099
038700         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    03870099
038800         10  FILLER                  PIC  X(01)    VALUE ZERO.    03880099
038900         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    03890099
039000     05  PV-DB2-TMST.                                             03900099
039100         10 PV-DB2-TMST-CCYY          PIC  9(04).                 03910099
039200         10 FILLER                    PIC  X(01).                 03920099
039300         10 PV-DB2-TMST-MM            PIC  9(02).                 03930099
039400         10 FILLER                    PIC  X(01).                 03940099
039500         10 PV-DB2-TMST-DD            PIC  9(02).                 03950099
039600         10 FILLER                    PIC  X(01).                 03960099
039700         10 PV-DB2-TMST-HH            PIC  9(02).                 03970099
039800         10 FILLER                    PIC  X(01).                 03980099
039900         10 PV-DB2-TMST-MN            PIC  9(02).                 03990099
040000         10 FILLER                    PIC  X(01).                 04000099
040100         10 PV-DB2-TMST-SS            PIC  9(02).                 04010099
040200         10 FILLER                    PIC  X(07).                 04020099
040300     05  PV-FORMAT-DATE.                                          04030099
040400         10 PV-FORMAT-DATE-MM         PIC  9(02).                 04040099
040500         10 FILLER                    PIC  X(01) VALUE '/'.       04050099
040600         10 PV-FORMAT-DATE-DD         PIC  9(02).                 04060099
040700         10 FILLER                    PIC  X(01) VALUE '/'.       04070099
040800         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 04080099
040900     05  PV-FORMAT-TIME.                                          04090099
041000         10 PV-FORMAT-TIME-HH         PIC  9(02).                 04100099
041100         10 FILLER                    PIC  X(01) VALUE ':'.       04110099
041200         10 PV-FORMAT-TIME-MN         PIC  9(02).                 04120099
041300                                                                  04130099
041400     05  PV-HOLD-QTY-AUD                 PIC S9(09)    COMP-3     04140099
041500                                                       VALUE ZERO.04150099
041600     05  PV-HOLD-QTY-EXP                 PIC S9(09)    COMP-3     04160099
041700                                                       VALUE ZERO.04170099
041800                                                                  04180099
041900******************************************************************04190099
042000*   REPLACED THE ARIABLE PV-HOLD-SKU-SEQ WITH 8 DIGIT PV-HOLD-SKU*04200099
042100*   NMBR.                                                        *04210099
042200*   REPLACED 3 DIGIT PV-OSF-SKU-SEQ-NBR WITH 8 DIGIT PV-OSF-SKU- *04220099
042300*   -NBR.                                                        *04230099
042400*   REPLACED 3 DIGIT PV-OSS-SKU-SEQ-NBR WITH 8 DIGIT PV-OSS-SKU- *04240099
042500*   -NBR.                                                        *04250099
042600*   ADDED TWO PROGRAM VARIABLES PV-CLASS-NBR AND PV-SKU-NBR.     *04260099
042700*                                            WR # 21361          *04270099
042800******************************************************************04280099
042900     05  PV-HOLD-SKU-NBR.                                         04290099
042920         10  PV-HOLD-SKU-CL              PIC  X(02)  VALUE SPACES.04292099
042930         10  PV-HOLD-SKU-NMBR            PIC  9(08)  VALUE ZEROES.04293099
042940     05  PV-HOLD-UPC-NBR                 PIC S9(15)  VALUE ZERO   04294099
042941                                                     COMP-3.      04294199
042950     05  PV-OS-FILE-HOLD-KEY.                                     04295099
042960         10  PV-OSF-AUD-CNTL-NBR         PIC  9(09)  VALUE ZERO.  04296099
042970         10  PV-OSF-PO-NBR               PIC  9(09)  VALUE ZERO.  04297099
042980         10  PV-OSF-REC-SEQ-NBR          PIC  9(09)  VALUE ZERO.  04298099
042990         10  PV-OSF-SHIPT-UNT-ID         PIC  9(18)  VALUE ZERO.  04299099
043000         10  PV-OSF-SKU-DEPT-NBR         PIC  9(03)  VALUE ZERO.  04300099
043100         10  PV-OSF-SKU-CL-NBR           PIC  9(02)  VALUE ZERO.  04310099
043200         10  PV-OSF-SKU-NBR              PIC  9(08)  VALUE ZERO.  04320099
043300     05  PV-OS-SKU-FILE-HOLD-KEY.                                 04330099
043400         10  PV-OSS-AUD-CNTL-NBR         PIC  9(09)  VALUE ZERO.  04340099
043500         10  PV-OSS-PO-NBR               PIC  9(09)  VALUE ZERO.  04350099
043600         10  PV-OSS-REC-SEQ-NBR          PIC  9(09)  VALUE ZERO.  04360099
043700         10  PV-OSS-SHIPT-UNT-ID         PIC  9(18)  VALUE ZERO.  04370099
043800         10  PV-OSS-SKU-DEPT-NBR         PIC  9(03)  VALUE ZERO.  04380099
043900         10  PV-OSS-SKU-CL-NBR           PIC  9(02)  VALUE ZERO.  04390099
044000         10  PV-OSS-SKU-NBR              PIC  9(08)  VALUE ZERO.  04400099
044100     05  PV-CLASS-NBR                    PIC  9(02)  VALUE ZERO.  04410099
044200     05  PV-SKU-NBR                      PIC  9(08)  VALUE ZERO.  04420099
044210     05  PV-SKU-DEPT-NBR                 PIC  9(03)  VALUE ZERO.  04421099
044300******************************************************************04430099
044400*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *04440099
044500******************************************************************04450099
044600*                                                                 04460099
044700*                                                                 04470099
044800******************************************************************04480099
044900* COPY BOOK FOR OVER/SHORT EXCEPTIONS.                            04490099
045000******************************************************************04500099
045100 01  SU003-COPYBOOK.                                              04510099
045200     COPY SURD003.                                                04520099
045300                                                                  04530099
045400*                                                                 04540099
045500******************************************************************04550099
045600* COPY BOOK FOR OVER/SHORT SKU TOTAL FILE.                        04560099
045700******************************************************************04570099
045800 01  OS-SKU-FILE.                                                 04580099
045900     COPY SURD003.                                                04590099
046000                                                                  04600099
046100*                                                                 04610099
046200******************************************************************04620099
046300* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                     04630099
046400******************************************************************04640099
046500     COPY DSWS004.                                                04650099
046600******************************************************************04660099
046700*  NUMERIC EDIT ROUTINE COMMAREA                                  04670099
046800******************************************************************04680099
046801     COPY DPWS010I.                                               04680199
046802                                                                  04680299
046803******************************************************************04680399
046804*  DB2 FORMATTED MESSAGE AREA                                     04680499
046900******************************************************************04690099
047000     COPY DPWS004.                                                04700099
047100*                                                                 04710099
047200******************************************************************04720099
047300*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               04730099
047400******************************************************************04740099
047500     COPY DPWS132O.                                               04750099
047600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04760099
047700*  COPYBOOK FOR XLKUT001.                             WR # 21361  04770099
047800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04780099
047900     COPY XLWS001.                                                04790099
048000******************************************************************04800099
048100*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *04810099
048200******************************************************************04820099
048300/                                                                 04830099
048301*  LOGISTICS DOMAIN LOCATION MODULE                               04830199
048302     COPY XLWS071.                                                04830299
048303/                                                                 04830399
048304 01  BLANK-LINE.                                                  04830499
048305     05  FILLER                          PIC  X(132) VALUE SPACE. 04830599
048306                                                                  04830699
048400/                                                                 04840099
048500 01  HEADING-LINES.                                               04850099
048600     05  HEADING-LINE-0.                                          04860099
048700         10  FILLER                  PIC  X(52)    VALUE SPACES.  04870099
048800         10  FILLER                  PIC  X(28)    VALUE          04880099
048900             'VENDOR ACCURACY CARTON AUDIT'.                      04890099
049000         10  FILLER                  PIC  X(52)    VALUE SPACES.  04900099
049100*                                                                 04910099
049200     05  HEADING-LINE-1.                                          04920099
049300         10  FILLER                  PIC  X(57)    VALUE SPACES.  04930099
049400         10  FILLER                  PIC  X(19)    VALUE          04940099
049500             'CARTON AUDIT DETAIL'.                               04950099
049600         10  FILLER                  PIC  X(56)    VALUE SPACES.  04960099
049700                                                                  04970099
050200******************************************************************05020099
050300     05  HEADING-LINE-2.                                          05030099
050400         10  FILLER                  PIC  X(03)    VALUE SPACE.   05040099
056400         10  FILLER                  PIC  X(16)    VALUE          05640099
056500             'AUDIT CONTROL #:'.                                  05650099
056510         10  FILLER                  PIC  X(01)    VALUE SPACE.   05651099
056600         10  HL2-AUD-CNTL-NBR        PIC  9(09)    VALUE ZERO.    05660099
056700         10  FILLER                  PIC  X(15)    VALUE SPACE.   05670099
057200         10  FILLER                  PIC  X(18)    VALUE          05720099
057300             'AUDIT STATUS.....:'.                                05730099
057310         10  FILLER                  PIC  X(01)    VALUE SPACE.   05731099
057400         10  HL2-AUDIT-STATUS        PIC  X(10)    VALUE SPACE.   05740099
057401         10  FILLER                  PIC  X(21)    VALUE SPACE.   05740199
057402         10  FILLER                  PIC  X(19)    VALUE          05740299
057403             'FACILITY..........:'.                               05740399
057404         10  FILLER                  PIC  X(01)    VALUE SPACE.   05740499
057405         10  HL2-AUDIT-FCLTY-PRINT.                               05740599
057406             15  HL2-AUDIT-FCLTY-ID  PIC  ZZZ9     VALUE ZERO.    05740699
057407             15  FILLER              PIC  X(01)    VALUE '-'.     05740799
057408             15  HL2-AUDIT-FCLTY-NAME                             05740899
057409                                     PIC  X(25)    VALUE SPACE.   05740999
057410                                                                  05741099
057411******************************************************************05741199
057412     05  HEADING-LINE-3.                                          05741299
057413         10  FILLER                  PIC  X(03)    VALUE SPACE.   05741399
057414         10  FILLER                  PIC  X(16)    VALUE          05741499
057415             'VENDOR NAME....:'.                                  05741599
057416         10  FILLER                  PIC  X(01)    VALUE SPACE.   05741699
057417         10  HL3-VENDOR-NAME         PIC  X(20)    VALUE SPACE.   05741799
057418         10  FILLER                  PIC  X(04)    VALUE SPACE.   05741899
057419         10  FILLER                  PIC  X(18)    VALUE          05741999
057420             'DEPT.............:'.                                05742099
057421         10  FILLER                  PIC  X(01)    VALUE SPACE.   05742199
057422         10  HL3-DEPT-NBR            PIC  9(03)    VALUE ZERO.    05742299
057423         10  FILLER                  PIC  X(13)    VALUE SPACE.   05742399
057424         10  FILLER                  PIC  X(08)    VALUE          05742499
057425             'PBS IND:'.                                          05742599
057426         10  FILLER                  PIC  X(01)    VALUE SPACE.   05742699
057427         10  HL3-PACKED-BY-STR-IND   PIC  X(01)    VALUE SPACE.   05742799
057428         10  FILLER                  PIC  X(43)    VALUE SPACE.   05742899
057429                                                                  05742999
057430******************************************************************05743099
057431     05  HEADING-LINE-4.                                          05743199
057432         10  FILLER                  PIC  X(03)    VALUE SPACE.   05743299
057433         10  FILLER                  PIC  X(16)    VALUE          05743399
057434             'PO/RECEIVER....:'.                                  05743499
057435         10  FILLER                  PIC  X(01)    VALUE SPACE.   05743599
057436         10  HL4-PO-NBR              PIC  Z(07)9   VALUE ZERO.    05743699
057437         10  FILLER                  PIC  X(01)    VALUE '-'.     05743799
057438         10  HL4-REC-SEQ-NBR         PIC  9(03)    VALUE ZERO.    05743899
057439         10  FILLER                  PIC  X(12)    VALUE SPACE.   05743999
057440         10  FILLER                  PIC  X(18)    VALUE          05744099
057441             'DESTINATION STORE:'.                                05744199
057442         10  FILLER                  PIC  X(01)    VALUE SPACE.   05744299
057443         10  HL4-DEST-STORE-NBR      PIC  9(04)    VALUE ZERO.    05744399
057444         10  FILLER                  PIC  X(03)    VALUE ' - '.   05744499
057445         10  HL4-DEST-STORE-NAME     PIC  X(10)    VALUE SPACE.   05744599
057446         10  FILLER                  PIC  X(52)    VALUE SPACE.   05744699
057447                                                                  05744799
057448******************************************************************05744899
057449     05  HEADING-LINE-5.                                          05744999
057450         10  FILLER                  PIC  X(03)    VALUE SPACE.   05745099
057451         10  FILLER                  PIC  X(16)    VALUE          05745199
057452             'AUDIT TYPE.....:'.                                  05745299
057453         10  FILLER                  PIC  X(01)    VALUE SPACE.   05745399
057454         10  HL5-AUDIT-TYPE          PIC  X(10)    VALUE SPACE.   05745499
057455         10  FILLER                  PIC  X(14)    VALUE SPACE.   05745599
057456         10  FILLER                  PIC  X(24)    VALUE          05745699
057457             'SERIAL SHIP CODE.: (00) '.                          05745799
057458         10  HL5-SHIPT-UNT-ID        PIC  X(21)    VALUE SPACE.   05745899
057459         10  FILLER                  PIC  X(05)    VALUE SPACE.   05745999
062800         10  FILLER                  PIC  X(19)    VALUE          06280099
062900             'CTN EXP UNITS.....:'.                               06290099
062910         10  FILLER                  PIC  X(01)    VALUE SPACE.   06291099
063000         10  HL5-EXPECTED-UNITS      PIC  ZZZZZZ9.                06300099
063100         10  FILLER                  PIC  X(11)    VALUE SPACE.   06310099
063101                                                                  06310199
063102******************************************************************06310299
063103     05  HEADING-LINE-6.                                          06310399
063104         10  FILLER                  PIC  X(03)    VALUE SPACE.   06310499
063105         10  FILLER                  PIC  X(16)    VALUE          06310599
063106             'RECEIPT DATE...:'.                                  06310699
063107         10  FILLER                  PIC  X(01)    VALUE SPACE.   06310799
063108         10  HL6-DATE-RCVD.                                       06310899
063109             15  HL6-DATE-RCVD-MM    PIC  X(02)    VALUE SPACE.   06310999
063110             15  FILLER              PIC  X(01)    VALUE '/'.     06311099
063111             15  HL6-DATE-RCVD-DD    PIC  X(02)    VALUE SPACE.   06311199
063112             15  FILLER              PIC  X(01)    VALUE '/'.     06311299
063113             15  HL6-DATE-RCVD-CCYY  PIC  X(04)    VALUE SPACE.   06311399
063114         10  FILLER                  PIC  X(64)    VALUE SPACE.   06311499
063200         10  FILLER                  PIC  X(19)    VALUE          06320099
063300             'CTN AUDIT UNITS...:'.                               06330099
063310         10  FILLER                  PIC  X(01)    VALUE SPACE.   06331099
063400         10  HL6-AUDITED-UNITS       PIC  ZZZZZZ9.                06340099
063500         10  FILLER                  PIC  X(11)    VALUE SPACE.   06350099
063501                                                                  06350199
063502******************************************************************06350299
063503     05  HEADING-LINE-7.                                          06350399
063504         10  FILLER                  PIC  X(44)    VALUE SPACE.   06350499
063505         10  FILLER                  PIC  X(18)    VALUE          06350599
063506             'AUDIT AREA.......:'.                                06350699
063507         10  FILLER                  PIC  X(01)    VALUE SPACE.   06350799
063508         10  HL7-AUDIT-PRC-AREA      PIC  X(06)    VALUE SPACE.   06350899
063509         10  FILLER                  PIC  X(63)    VALUE SPACE.   06350999
063510                                                                  06351099
063511******************************************************************06351199
063512     05  HEADING-LINE-8A.                                         06351299
063513         10  FILLER                  PIC  X(03)    VALUE SPACE.   06351399
063514         10  FILLER                  PIC  X(16)    VALUE          06351499
063515             'AUDIT CATEGORY.:'.                                  06351599
063516         10  FILLER                  PIC  X(01)    VALUE SPACE.   06351699
063517         10  HL8A-QC-RFID-IND        PIC  X(04)    VALUE SPACE.   06351799
063518         10  FILLER                  PIC  X(20)    VALUE SPACE.   06351899
063519         10  FILLER                  PIC  X(18)    VALUE          06351999
063520             'DURATION (HH:MM).:'.                                06352099
063521         10  FILLER                  PIC  X(01)    VALUE SPACE.   06352199
063522         10  HL8A-CARTON-DURATION.                                06352299
063523             15  HL8A-CARTON-DURATION-HH                          06352399
063524                                     PIC  ZZ9      VALUE ZERO.    06352499
063525             15  FILLER              PIC  X(01)    VALUE ':'.     06352599
063526             15  HL8A-CARTON-DURATION-MM                          06352699
063527                                     PIC  9(02)    VALUE ZERO.    06352799
063528         10  FILLER                  PIC  X(25)    VALUE SPACE.   06352899
064300         10  FILLER                  PIC  X(19)    VALUE          06430099
064400             'UNITS IN ERROR....:'.                               06440099
064600         10  FILLER                  PIC  X(01)    VALUE SPACE.   06460099
064601         10  HL8A-UNITS-IN-ERROR     PIC  ZZZZZZ9.                06460199
064602         10  FILLER                  PIC  X(11)    VALUE SPACE.   06460299
064603                                                                  06460399
064604******************************************************************06460499
064605     05  HEADING-LINE-9A.                                         06460599
064606         10  FILLER                  PIC  X(03)    VALUE SPACE.   06460699
064607         10  FILLER                  PIC  X(16)    VALUE          06460799
064608             'AUDIT..........:'.                                  06460899
064609         10  FILLER                  PIC  X(01)    VALUE SPACE.   06460999
064610         10  HL9A-AUDIT-TYPE         PIC  X(08)    VALUE SPACE.   06461099
064620             88 HL9A-PROMPTED-AUDIT              VALUE 'PROMPTED'.06462099
064621             88 HL9A-MANUAL-AUDIT                VALUE 'MANUAL  '.06462199
064622         10  FILLER                  PIC  X(16)    VALUE SPACE.   06462299
064623         10  FILLER                  PIC  X(18)    VALUE          06462399
064624             'CARTON START.....:'.                                06462499
064625         10  FILLER                  PIC  X(01)    VALUE SPACE.   06462599
064626         10  HL9A-CARTON-START-DATE.                              06462699
064627             15  HL9A-CARTON-START-DATE-MM                        06462799
064628                                     PIC  X(02)    VALUE SPACE.   06462899
064629             15  FILLER              PIC  X(01)    VALUE '/'.     06462999
064630             15  HL9A-CARTON-START-DATE-DD                        06463099
064631                                     PIC  X(02)    VALUE SPACE.   06463199
064632             15  FILLER              PIC  X(01)    VALUE '/'.     06463299
064633             15  HL9A-CARTON-START-DATE-CCYY                      06463399
064634                                     PIC  X(04)    VALUE SPACE.   06463499
064635         10  FILLER                  PIC  X(02)    VALUE SPACE.   06463599
064636         10  HL9A-CARTON-START-TIME.                              06463699
064637             15  HL9A-CARTON-START-TIME-HH                        06463799
064638                                     PIC  X(02)    VALUE SPACE.   06463899
064639             15  FILLER              PIC  X(01)    VALUE ':'.     06463999
064640             15  HL9A-CARTON-START-TIME-MN                        06464099
064641                                     PIC  X(02)    VALUE SPACE.   06464199
064642         10  FILLER                  PIC  X(14)    VALUE SPACE.   06464299
064643         10  FILLER                  PIC  X(19)    VALUE          06464399
064644             'TOTAL ERRORS......:'.                               06464499
064645         10  FILLER                  PIC  X(01)    VALUE SPACE.   06464599
064646         10  HL9A-TOTAL-ERRORS       PIC  ZZZZZZ9.                06464699
064647         10  FILLER                  PIC  X(11)    VALUE SPACE.   06464799
064648                                                                  06464899
064649******************************************************************06464999
064650     05  HEADING-LINE-10A.                                        06465099
064651         10  FILLER                  PIC  X(03)    VALUE SPACE.   06465199
064652         10  FILLER                  PIC  X(16)    VALUE          06465299
064653             'DESIGNATION....:'.                                  06465399
064654         10  FILLER                  PIC  X(01)    VALUE SPACE.   06465499
064655         10  HL10A-COMBO-IND         PIC  X(05)    VALUE SPACE.   06465599
064656             88 HL10A-COMBO                        VALUE 'COMBO'. 06465699
064657             88 HL10A-NOT-COMBO                    VALUE '     '. 06465799
064658         10  FILLER                  PIC  X(19)    VALUE SPACE.   06465899
064659         10  FILLER                  PIC  X(18)    VALUE          06465999
064660             'CARTON STOP......:'.                                06466099
064661         10  FILLER                  PIC  X(01)    VALUE SPACE.   06466199
064662         10  HL10A-CARTON-STOP-DATE.                              06466299
064663             15  HL10A-CARTON-STOP-DATE-MM                        06466399
064664                                     PIC  X(02)    VALUE SPACE.   06466499
064665             15  FILLER              PIC  X(01)    VALUE '/'.     06466599
064666             15  HL10A-CARTON-STOP-DATE-DD                        06466699
064667                                     PIC  X(02)    VALUE SPACE.   06466799
064668             15  FILLER              PIC  X(01)    VALUE '/'.     06466899
064669             15  HL10A-CARTON-STOP-DATE-CCYY                      06466999
064670                                     PIC  X(04)    VALUE SPACE.   06467099
064671         10  FILLER                  PIC  X(02)    VALUE SPACE.   06467199
064672         10  HL10A-CARTON-STOP-TIME.                              06467299
064673             15  HL10A-CARTON-STOP-TIME-HH                        06467399
064674                                     PIC  X(02)    VALUE SPACE.   06467499
064675             15  FILLER              PIC  X(01)    VALUE ':'.     06467599
064676             15  HL10A-CARTON-STOP-TIME-MN                        06467699
064677                                     PIC  X(02)    VALUE SPACE.   06467799
065100         10  FILLER                  PIC  X(14)    VALUE SPACE.   06510099
065101         10  FILLER                  PIC  X(21)    VALUE          06510199
065102             'CARTON ERROR RATIO:  '.                             06510299
065103         10  HL10A-PCT-UNITS-IN-ERROR PIC  ZZ9.99.                06510399
065104         10  FILLER                  PIC  X(01)    VALUE '%'.     06510499
065105         10  FILLER                  PIC  X(10)    VALUE SPACE.   06510599
065200                                                                  06520099
065210******************************************************************06521099
065300     05  HEADING-LINE-8.                                          06530099
065310* DMH 06/16/03 - BEGIN                                            06531099
065400         10  FILLER                  PIC  X(03)    VALUE SPACES.  06540099
065410         10  HL8-PREPACK-ID          PIC  X(11)    VALUE SPACES.  06541099
065420         10  FILLER                  PIC  X(03)    VALUE SPACES.  06542099
065430* DMH 06/16/03 - AFTER                                            06543099
065500         10  FILLER                  PIC  X(46)    VALUE          06550099
065600             '                - PURCHASE ORDER LINE DETAIL -'.    06560099
065700         10  FILLER                  PIC  X(05)    VALUE SPACES.  06570099
065800         10  FILLER                  PIC  X(44)    VALUE          06580099
065900             '------------ ERROR INFORMATION -------------'.      06590099
066000         10  FILLER                  PIC  X(20)    VALUE SPACES.  06600099
066100*                                                                 06610099
066200     05  HEADING-LINE-9.                                          06620099
066300         10  FILLER                  PIC  X(97)    VALUE SPACES.  06630099
066400         10  FILLER                  PIC  X(08)    VALUE          06640099
066500             'RECEIVED'.                                          06650099
066600         10  FILLER                  PIC  X(03)    VALUE SPACES.  06660099
066700         10  FILLER                  PIC  X(07)    VALUE          06670099
066800             'ORDERED'.                                           06680099
066900         10  FILLER                  PIC  X(17)    VALUE SPACES.  06690099
067000*                                                                 06700099
067100******************************************************************06710099
067200*    CHANGED THE HEADING STRUCTURE TO DISPLAY 'CL SKU' INSTEAD   *06720099
067300*    OF 'DPT CL SKU' AND CHANGED FILLER ACCORDINGLY.             *06730099
067400*                                              WR # 21361        *06740099
067500******************************************************************06750099
067600     05  HEADING-LINE-10.                                         06760099
067700         10  FILLER                  PIC  X(03)    VALUE SPACES.  06770099
067800         10  FILLER                  PIC  X(11)    VALUE          06780099
067900             'CL SKU    '.                                        06790099
068000         10  FILLER                  PIC  X(03)    VALUE SPACES.  06800099
068100         10  FILLER                  PIC  X(03)    VALUE          06810099
068200             'UPC'.                                               06820099
068300         10  FILLER                  PIC  X(13)    VALUE SPACES.  06830099
068400         10  FILLER                  PIC  X(09)    VALUE          06840099
068500             'STYLE NBR'.                                         06850099
068600         10  FILLER                  PIC  X(03)    VALUE SPACES.  06860099
068700         10  FILLER                  PIC  X(05)    VALUE          06870099
068800             'COLOR'.                                             06880099
068900         10  FILLER                  PIC  X(07)    VALUE SPACES.  06890099
069000         10  FILLER                  PIC  X(04)    VALUE          06900099
069100             'SIZE'.                                              06910099
069200         10  FILLER                  PIC  X(08)    VALUE SPACES.  06920099
069300         10  FILLER                  PIC  X(11)    VALUE          06930099
069400             'DESCRIPTION'.                                       06940099
069500         10  FILLER                  PIC  X(07)    VALUE SPACES.  06950099
069600         10  FILLER                  PIC  X(07)    VALUE          06960099
069700             'QTY TYP'.                                           06970099
069800         10  FILLER                  PIC  X(09)    VALUE SPACES.  06980099
069900         10  FILLER                  PIC  X(02)    VALUE          06990099
070000             'AS'.                                                07000099
070100         10  FILLER                  PIC  X(08)    VALUE SPACES.  07010099
070200         10  FILLER                  PIC  X(02)    VALUE          07020099
070300             'AS'.                                                07030099
070400         10  FILLER                  PIC  X(17)    VALUE SPACES.  07040099
070500******************************************************************07050099
070600*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *07060099
070700******************************************************************07070099
070800*                                                                 07080099
070900*                                                                 07090099
071000 01  MISCELLANEOUS-LINES.                                         07100099
071100     05  NO-DATA-LINE.                                            07110099
071200         10  FILLER                  PIC  X(44)    VALUE SPACES.  07120099
071300         10  FILLER                  PIC  X(46)    VALUE          07130099
071400             '**** NO INFORMATION EXISTS FOR THIS AUDIT ****'.    07140099
071500         10  FILLER                  PIC  X(42)    VALUE SPACES.  07150099
071600     05  END-OF-REPORT-LINE.                                      07160099
071700         10  FILLER                  PIC  X(44)    VALUE SPACES.  07170099
071800         10  FILLER                  PIC  X(45)    VALUE          07180099
071900             '*******   E N D   O F   R E P O R T   *******'.     07190099
072000         10  FILLER                  PIC  X(43)    VALUE SPACES.  07200099
072100*                                                                 07210099
072200******************************************************************07220099
072300*     TOTAL FOOTERS        TOTAL FOOTERS         TOTAL FOOTERS   *07230099
072400******************************************************************07240099
072500******************************************************************07250099
072600 01  FH-FOOTER-HEADING-LINE.                                      07260099
072700     05  FILLER                          PIC  X(03) VALUE SPACES. 07270099
072800     05  FILLER                          PIC  X(37) VALUE         07280099
072900         '----------- ERROR SUMMARY -----------'.                 07290099
073000     05  FILLER                          PIC  X(92) VALUE SPACES. 07300099
073100                                                                  07310099
073200******************************************************************07320099
073300 01  FD-FOOTER-DETAIL-LINE.                                       07330099
073400     05  FILLER                          PIC  X(03) VALUE SPACES. 07340099
073500     05  FD-FOOTER-DETAIL-DESC           PIC  X(25) VALUE SPACES. 07350099
073600     05  FILLER                          PIC  X(01) VALUE SPACES. 07360099
073700     05  FD-FOOTER-DETAIL-QTY            PIC  ZZ,ZZ9 VALUE ZEROS. 07370099
073800     05  FD-FOOTER-DETAIL-QTY-X REDEFINES                         07380099
073900         FD-FOOTER-DETAIL-QTY            PIC  X(06).              07390099
074000     05  FILLER                          PIC  X(97) VALUE SPACES. 07400099
074100*                                                                 07410099
074200******************************************************************07420099
074300*  CHANGED THE DL1-SKU  STRUCTURE TO HAVE CLASS AND 8 DIGIT SKU  *07430099
074400*  INSTEAD OF DEPT, CLASS AND SEQ NUMBER AND REDUCED FILLER BY 1.*07440099
074500******************************************************************07450099
074600 01  DETAIL-LINES.                                                07460099
074700     05  DETAIL-LINE1.                                            07470099
074800         10  FILLER                  PIC  X(03)    VALUE SPACES.  07480099
074900         10  DL1-SKU.                                             07490099
075000             15  DL1-SKU-CL-NBR      PIC  X(02)    VALUE SPACES.  07500099
075100             15  FILLER              PIC  X(01)    VALUE SPACE.   07510099
075200             15  DL1-SKU-NBR         PIC  X(08)    VALUE SPACES.  07520099
075300         10  FILLER                  PIC  X(03)    VALUE SPACES.  07530099
075400         10  DL1-UPC-NBR-X.                                       07540099
075500             15  DL1-UPC-NBR         PIC  9(15)    VALUE ZEROS.   07550099
075600         10  FILLER                  PIC  X(01)    VALUE SPACES.  07560099
075700         10  DL1-VND-STYL-DESC       PIC  X(10)    VALUE SPACES.  07570099
075800         10  FILLER                  PIC  X(02)    VALUE SPACES.  07580099
075900         10  DL1-UPC-CLOR-DESC       PIC  X(10)    VALUE SPACES.  07590099
076000         10  FILLER                  PIC  X(02)    VALUE SPACES.  07600099
076100         10  DL1-UPC-SIZE-DESC       PIC  X(10)    VALUE SPACES.  07610099
076200         10  FILLER                  PIC  X(02)    VALUE SPACES.  07620099
076300         10  DL1-VILN-CDE-SHRT-DESC  PIC  X(15)    VALUE SPACES.  07630099
076400         10  FILLER                  PIC  X(01)    VALUE SPACE.   07640099
076500         10  DL1-QTY-IN-ERROR        PIC  ZZZZ9    VALUE ZEROES.  07650099
076600         10  FILLER                  PIC  X(01)    VALUE SPACES.  07660099
076700         10  DL1-ERROR-TYPE          PIC  X(03)    VALUE SPACES.  07670099
076800         10  FILLER                  PIC  X(03)    VALUE SPACES.  07680099
076900         10  DL1-RECEIVED-AS-INFO    PIC  X(10)    VALUE SPACES.  07690099
077000         10  FILLER                  PIC  X(01)    VALUE SPACES.  07700099
077100         10  DL1-ORDERED-AS-INFO     PIC  X(10)    VALUE SPACES.  07710099
077200         10  DL1-ORDERED-AS-INFO-9   REDEFINES                    07720099
077300             DL1-ORDERED-AS-INFO     PIC  9(10).                  07730099
077400         10  FILLER                  PIC  X(14)    VALUE SPACES.  07740099
077500                                                                  07750099
077600 01  CC-CARDIN.                                                   07760099
077700     05  CC-AUDIT-CNTL-NBR           PIC 9(09).                   07770099
077800     05  CC-CARTON-ID                PIC 9(18).                   07780099
077900     05  CC-SYSTEM-MANUAL-AUDIT      PIC X(01).                   07790099
078000         88  CC-SYSTEM-GENERATED-AUDIT    VALUE 'S'.              07800099
078100         88  CC-MANUAL-GENERATED-AUDIT    VALUE 'M'.              07810099
078200     05  CC-RFID-QC-AUDIT-IND        PIC X(01).                   07820099
078300         88  CC-RFID-AUDIT                VALUE 'R'.              07830099
078400         88  CC-QC-AUDIT                  VALUE 'S'.              07840099
078500     05  CC-RFID-QC-AUD-CMB-IND      PIC X(01).                   07850099
078600         88  CC-RFID-AUD-ONLY             VALUE 'R'.              07860099
078700         88  CC-QC-AUD-ONLY               VALUE 'S'.              07870099
078800         88  CC-QC-AND-RFID-AUD           VALUE 'B'.              07880099
078801*                                                                 07880199
078802*01  CC-CONTROL-CARD.                                             07880299
078803*    05  CC-AUD-CNTL-NBR             PIC S9(09)    VALUE ZEROES.  07880399
078804                                                                  07880499
078805 01  CC-PRINT-CARD.                                               07880599
078806     05  CC-PRINTER-ID               PIC  X(08)    VALUE SPACES.  07880699
078807     05  CC-PRTR-CNTL-IND            PIC  X(01)    VALUE SPACE.   07880799
078808     05  CC-TRACK-NBR                PIC  9(01)    VALUE ZERO.    07880899
078809*DMB 9/18/01                                                      07880999
078810     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    07881099
078811     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    07881199
078812                                                                  07881299
078813*                                                                 07881399
078814*  COPY BOOK FOR THE SHIPPING UNIT AUDIT TABLE (TSUNAUD)          07881499
078900*                                                                 07890099
079000     EXEC SQL                                                     07900099
079100          INCLUDE TSUNAUD                                         07910099
079200     END-EXEC.                                                    07920099
079300*                                                                 07930099
079400*  COPY BOOK FOR SHIPPING UNIT AUDIT TRANSACTIONS TABLE           07940099
079500*  (TSUATRN)                                                      07950099
079600*                                                                 07960099
079700     EXEC SQL                                                     07970099
079800          INCLUDE TSUATRN                                         07980099
079900     END-EXEC.                                                    07990099
080000*                                                                 08000099
080100*  COPY BOOK FOR THE SHIPPING UNIT AUDIT CONTENT TABLE            08010099
080200*  (TSUAUPC)                                                      08020099
080300*                                                                 08030099
080400     EXEC SQL                                                     08040099
080500          INCLUDE TSUAUPC                                         08050099
080600     END-EXEC.                                                    08060099
080700*                                                                 08070099
080800*  COPY BOOK FOR THE SHIPPING UNIT AUDIT EXCEPTION TABLE          08080099
080900*  (TSUEXCP)                                                      08090099
081000*                                                                 08100099
081100     EXEC SQL                                                     08110099
081200          INCLUDE TSUEXCP                                         08120099
081300     END-EXEC.                                                    08130099
081400*                                                                 08140099
081500*  COPY BOOK FOR THE VIOLATIONS MASTER TABLE (TVILNCD)            08150099
081600*                                                                 08160099
081700     EXEC SQL                                                     08170099
081800          INCLUDE TVILNCD                                         08180099
081900     END-EXEC.                                                    08190099
082000*                                                                 08200099
082100*  COPY BOOK FOR THE SHIPPING UNIT UPC ASSOCIATION TABLE          08210099
082200*  (TSHUUPC).  THIS TABLE WILL PROVIDE THE NUMBER OF UNITS        08220099
082300*  THAT WERE EXPECTED FOR A SPECIFIED CARTON.                     08230099
082400*                                                                 08240099
082500     EXEC SQL                                                     08250099
082600          INCLUDE TSHUUPC                                         08260099
082700     END-EXEC.                                                    08270099
082800*                                                                 08280099
082900*  COPY BOOK FOR RECEIVER TABLE (TRECEIV)                         08290099
083000*                                                                 08300099
083100     EXEC SQL                                                     08310099
083200          INCLUDE TRECEIV                                         08320099
083300     END-EXEC.                                                    08330099
083310*                                                                 08331099
083320*  COPY BOOK FOR RECEIVER ITEM TABLE (TRECITM)                    08332099
083330*                                                                 08333099
083340     EXEC SQL                                                     08334099
083350          INCLUDE TRECITM                                         08335099
083360     END-EXEC.                                                    08336099
083400*                                                                 08340099
083500*  COPY BOOK FOR THE PURCHASE ORDER TABLE (TPURCHS)               08350099
083600*                                                                 08360099
083700     EXEC SQL                                                     08370099
083800          INCLUDE TPURCHS                                         08380099
083900     END-EXEC.                                                    08390099
084000*                                                                 08400099
084100*  COPY BOOK FOR THE PURCHASE ORDER TABLE AGREEMENT TABLE         08410099
084200*  (TPOAGMT)                                                      08420099
084300*                                                                 08430099
084400     EXEC SQL                                                     08440099
084500          INCLUDE TPOAGMT                                         08450099
084600     END-EXEC.                                                    08460099
085900*                                                                 08590099
086000*  COPY BOOK FOR THE ENTITY NAME TABLE (TENTNME)                  08600099
086100*                                                                 08610099
086200     EXEC SQL                                                     08620099
086300          INCLUDE TENTNME                                         08630099
086400     END-EXEC.                                                    08640099
086500*                                                                 08650099
086600*  COPY BOOK FOR THE CARTON LEVEL EXCEPTION TABLE                 08660099
086700*                                                                 08670099
086800     EXEC SQL                                                     08680099
086900          INCLUDE TCTEXCP                                         08690099
087000     END-EXEC.                                                    08700099
087100*                                                                 08710099
087200*JA 03/19/14 - BEGIN PR#5148D                                     08720099
087300*----------------------------------------------------------------*08730099
087400*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             08740099
087500*    (SUT_PO_AUD_REQ)                                             08750099
087600*----------------------------------------------------------------*08760099
087700     EXEC SQL                                                     08770099
087800          INCLUDE SUT00015                                        08780099
087900     END-EXEC.                                                    08790099
088000                                                                  08800099
088100*----------------------------------------------------------------*08810099
088200*    DB2 DCLGEN FOR THE VENDOR PO AUDIT EXCEPTION TABLE           08820099
088300*    (SUT_PO_AUD_EXC)                                             08830099
088400*----------------------------------------------------------------*08840099
088500     EXEC SQL                                                     08850099
088600          INCLUDE SUT00014                                        08860099
088700     END-EXEC.                                                    08870099
088800                                                                  08880099
088900*----------------------------------------------------------------*08890099
089000*    DB2 DCLGEN FOR THE VENDOR AGREEMENT TABLE                    08900099
089100*    (TVNDAGR)                                                    08910099
089200*----------------------------------------------------------------*08920099
089300     EXEC SQL                                                     08930099
089400          INCLUDE TVNDAGR                                         08940099
089500     END-EXEC.                                                    08950099
089501*JA 03/19/14 - END PR#5148D                                       08950199
089502*                                                                 08950299
089503*JA 04/28/14 - BEGIN                                              08950399
089504*----------------------------------------------------------------*08950499
089505*    DB2 DCLGEN FOR THE RF VERIFICATION TABLE                     08950599
089506*    RIT_RFID_VRFN                                                08950699
089507*----------------------------------------------------------------*08950799
089508     EXEC SQL                                                     08950899
089509          INCLUDE RIT00000                                        08950999
089510     END-EXEC.                                                    08951099
089511*----------------------------------------------------------------*08951199
089512*    DB2 DCLGEN FOR THE PO ITEM TABLE                             08951299
089514*----------------------------------------------------------------*08951499
089515     EXEC SQL                                                     08951599
089516          INCLUDE TPURITM                                         08951699
089517     END-EXEC.                                                    08951799
089518*JA 04/28/14 - END                                                08951899
089519******************************************************************08951999
089520*  REMOVED REFERENCES FOR DB2 TABLES TUPC, TSIZE AND TVNDSTL.    *08952099
089521*                                                   WR # 21361   *08952199
089522******************************************************************08952299
089523******************************************************************08952399
089524*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *08952499
089525******************************************************************08952599
089526***************************************************************** 08952699
089527*    DECLARE PICKING CURSOR -- THIS CURSOR WILL RETRIEVE ALL      08952799
089528*    THE PICKING EXCEPTIONS FOR A CERTAIN AUDIT/RECEIVER/STORE    08952899
089529***************************************************************** 08952999
089530*GB 2/25/02 CHANGED CURSOR TO SUM(SCND_UNT_QTY) RATHER THAN   *** 08953099
089531**COUNT THE TOTAL ROWS, ALSO IGNORE 'E' TYPE CODE             *** 08953199
089532** ************************************************************** 08953299
089533                                                                  08953399
089534     EXEC SQL                                                     08953499
089535         DECLARE QC_ERR_CSR CURSOR                                08953599
089536         FOR SELECT                                               08953699
089537                 A.VILN_GP_SEQ_NBR                                08953799
089540               , B.VILN_CDE_SHRT_DESC                             08954099
089550               , A.OVRRID_SYS_DAT_TXT                             08955099
089560               , SUM(SCND_UNT_QTY)                                08956099
089570         FROM                                                     08957099
089580                 TSUEXCP A                                        08958099
089590              ,  TVILNCD B                                        08959099
089600              ,  TSUAUPC C                                        08960099
089700         WHERE                                                    08970099
089800             A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR              08980099
089900         AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              08990099
090000         AND A.UPC_NBR            = :DK-UPC-NBR                   09000099
090100         AND A.AUD_CNTL_NBR       =  C.AUD_CNTL_NBR               09010099
090200         AND A.SHIPT_UNT_ID       =  C.SHIPT_UNT_ID               09020099
090300         AND A.UPC_NBR            =  C.UPC_NBR                    09030099
090400         AND A.SCN_TMST           =  C.SCN_TMST                   09040099
090500         AND A.VILN_GP_CDE        =  'VA'                         09050099
090600         AND C.SCN_TYP_CDE       <> :PC-E                         09060099
090700         AND B.VILN_CTG_CDE      <> :PC-R                         09070099
090800         AND A.VILN_GP_SEQ_NBR   <> 12                            09080099
090900         AND A.VILN_GP_SEQ_NBR    = B.VILN_GP_SEQ_NBR             09090099
091000         AND A.VILN_GP_CDE        = B.VILN_GP_CDE                 09100099
091100         GROUP BY                                                 09110099
091200                 A.VILN_GP_SEQ_NBR                                09120099
091300               , B.VILN_CDE_SHRT_DESC                             09130099
091400               , A.OVRRID_SYS_DAT_TXT                             09140099
091500         ORDER BY                                                 09150099
091600                 A.VILN_GP_SEQ_NBR                                09160099
091700               , B.VILN_CDE_SHRT_DESC                             09170099
091800               , A.OVRRID_SYS_DAT_TXT                             09180099
091900     END-EXEC.                                                    09190099
092000                                                                  09200099
092100     EXEC SQL                                                     09210099
092200         DECLARE RFID_ERR_CSR_LT42 CURSOR                         09220099
092300         FOR SELECT                                               09230099
092400                 A.VILN_GP_SEQ_NBR                                09240099
092500               , B.VILN_CDE_SHRT_DESC                             09250099
092600               , A.OVRRID_SYS_DAT_TXT                             09260099
092700               , SUM(SCND_UNT_QTY)                                09270099
092800               , SUM(RFID_TGD_QTY)                                09280099
092900         FROM                                                     09290099
093000                 TSUEXCP A                                        09300099
093100              ,  TVILNCD B                                        09310099
093200              ,  TSUAUPC C                                        09320099
093300         WHERE                                                    09330099
093400             A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR              09340099
093500         AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              09350099
093600         AND A.UPC_NBR            = :DK-UPC-NBR                   09360099
093700         AND A.AUD_CNTL_NBR       =  C.AUD_CNTL_NBR               09370099
093800         AND A.SHIPT_UNT_ID       =  C.SHIPT_UNT_ID               09380099
093900         AND A.UPC_NBR            =  C.UPC_NBR                    09390099
094000         AND A.SCN_TMST           =  C.SCN_TMST                   09400099
094100         AND A.VILN_GP_CDE        =  'VA'                         09410099
094200         AND C.SCN_TYP_CDE        <> :PC-E                        09420099
094300         AND A.VILN_GP_SEQ_NBR    IN (38, 39, 40, 41)             09430099
094400         AND A.VILN_GP_SEQ_NBR    = B.VILN_GP_SEQ_NBR             09440099
094500         AND A.VILN_GP_CDE        = B.VILN_GP_CDE                 09450099
094600         GROUP BY                                                 09460099
094700                 A.VILN_GP_SEQ_NBR                                09470099
094800               , B.VILN_CDE_SHRT_DESC                             09480099
094900               , A.OVRRID_SYS_DAT_TXT                             09490099
095000         ORDER BY                                                 09500099
095100                 A.VILN_GP_SEQ_NBR                                09510099
095200               , B.VILN_CDE_SHRT_DESC                             09520099
095300               , A.OVRRID_SYS_DAT_TXT                             09530099
095400     END-EXEC.                                                    09540099
095500                                                                  09550099
095600     EXEC SQL                                                     09560099
095700         DECLARE RFID_ERR_CSR_EQ42 CURSOR                         09570099
095800         FOR SELECT                                               09580099
095900                 A.VILN_GP_SEQ_NBR                                09590099
096000               , B.VILN_CDE_SHRT_DESC                             09600099
096100               , A.OVRRID_SYS_DAT_TXT                             09610099
096200               , SUM(SCND_UNT_QTY)                                09620099
096300               , SUM(RFID_TGD_QTY)                                09630099
096400         FROM                                                     09640099
096500                 TSUEXCP A                                        09650099
096600              ,  TVILNCD B                                        09660099
096700              ,  TSUAUPC C                                        09670099
096800         WHERE                                                    09680099
096900             A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR              09690099
097000         AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              09700099
097100         AND A.UPC_NBR            = :DK-UPC-NBR                   09710099
097200         AND A.AUD_CNTL_NBR       =  C.AUD_CNTL_NBR               09720099
097300         AND A.SHIPT_UNT_ID       =  C.SHIPT_UNT_ID               09730099
097400         AND A.UPC_NBR            =  C.UPC_NBR                    09740099
097500         AND A.SCN_TMST           =  C.SCN_TMST                   09750099
097600         AND A.VILN_GP_CDE        =  'VA'                         09760099
097700         AND C.SCN_TYP_CDE        =  :PC-E                        09770099
097800         AND A.VILN_GP_SEQ_NBR    =  42                           09780099
097900         AND A.VILN_GP_SEQ_NBR    = B.VILN_GP_SEQ_NBR             09790099
098000         AND A.VILN_GP_CDE        = B.VILN_GP_CDE                 09800099
098100         GROUP BY                                                 09810099
098200                 A.VILN_GP_SEQ_NBR                                09820099
098300               , B.VILN_CDE_SHRT_DESC                             09830099
098400               , A.OVRRID_SYS_DAT_TXT                             09840099
098500         ORDER BY                                                 09850099
098600                 A.VILN_GP_SEQ_NBR                                09860099
098700               , B.VILN_CDE_SHRT_DESC                             09870099
098800               , A.OVRRID_SYS_DAT_TXT                             09880099
098801     END-EXEC.                                                    09880199
098802                                                                  09880299
098803***************************************************************** 09880399
098804*    DECLARE THE CARTON ERROR CURSOR WHICH WILL RETRIEVE ALL      09880499
098805*    THE CARTON LEVEL EXCEPTIONS FOR A GIVEN AUDIT/SHIPT ID       09880599
098806***************************************************************** 09880699
098807     EXEC SQL                                                     09880799
098808         DECLARE CARTON_ERR_CSR CURSOR FOR                        09880899
098809         SELECT                                                   09880999
098810                 VILN_GP_CDE                                      09881099
098811              ,  VILN_GP_SEQ_NBR                                  09881199
098812              ,  OVRRID_SYS_DAT_TXT                               09881299
098813         FROM                                                     09881399
098814                TCTEXCP                                           09881499
098815         WHERE                                                    09881599
098816             AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                  09881699
098817         AND SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID                  09881799
098818         ORDER BY 2                                               09881899
098819     END-EXEC.                                                    09881999
098820                                                                  09882099
098830     EXEC SQL                                                     09883099
098840         DECLARE UPC_CURSOR CURSOR                                09884099
098850         FOR SELECT                                               09885099
098860               A.SKU_NBR                                          09886099
098870            ,  A.ITM_DESC                                         09887099
098880            ,  A.VND_STYL_DESC                                    09888099
098890            ,  A.UPC_CLOR_DESC                                    09889099
098900            ,  A.UPC_SIZE_DESC                                    09890099
099000            ,  A.UPC_RTL_AMT                                      09900099
099100         FROM                                                     09910099
099200               TSUAUPC A                                          09920099
099300         WHERE                                                    09930099
099400               A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR            09940099
099500           AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID            09950099
099600           AND A.UPC_NBR            = :DK-UPC-NBR                 09960099
099700           AND A.SCN_TYP_CDE      <>  :PC-E                       09970099
099800         GROUP BY                                                 09980099
099900               A.SKU_NBR                                          09990099
100000            ,  A.ITM_DESC                                         10000099
100100            ,  A.VND_STYL_DESC                                    10010099
100200            ,  A.UPC_CLOR_DESC                                    10020099
100300            ,  A.UPC_SIZE_DESC                                    10030099
100400            ,  A.UPC_RTL_AMT                                      10040099
100401     END-EXEC.                                                    10040199
100402                                                                  10040299
100403* 02/06/14 DRW BEG                                                10040399
100404*    EXEC SQL                                                     10040499
100405*        DECLARE EXCEPTIONS_CSR CURSOR FOR                        10040599
100406*        SELECT                                                   10040699
100407*                B.UPC_NBR                                        10040799
100408*             ,  B.VILN_GP_CDE                                    10040899
100409*             ,  B.VILN_GP_SEQ_NBR                                10040999
100410*             ,  B.OVRRID_SYS_DAT_TXT                             10041099
100411*             ,  SUM(SCND_UNT_QTY)                                10041199
100412*        FROM                                                     10041299
100413*               TSUAUPC A                                         10041399
100414*            ,  TSUEXCP B                                         10041499
100415*        WHERE                                                    10041599
100416*            A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                10041699
100417*        AND A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID                10041799
100418*        AND A.UPC_NBR          = :DK-UPC-NBR                     10041899
100419*        AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  10041999
100420*        AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  10042099
100421*        AND A.UPC_NBR          = B.UPC_NBR                       10042199
100422*        AND A.SCN_TMST         = B.SCN_TMST                      10042299
100423*        AND A.SCN_TYP_CDE     <> :PC-E                           10042399
100424*       GROUP BY B.UPC_NBR                                        10042499
100425*             ,  B.VILN_GP_CDE                                    10042599
100426*             ,  B.VILN_GP_SEQ_NBR                                10042699
100427*             ,  B.OVRRID_SYS_DAT_TXT                             10042799
100428*    END-EXEC.                                                    10042899
100429* 02/06/2014                                                      10042999
100430                                                                  10043099
100440*JA 04/01/14 - BEGIN                                              10044099
100450***************************************************************** 10045099
100460*    DECLARE RFID CURSOR -- THIS CURSOR WILL RETRIEVE ALL THE     10046099
100470*    RFID EXCEPTIONS FOR A CERTAIN AUDIT/RCVR/STORE               10047099
100480***************************************************************** 10048099
100490     EXEC SQL                                                     10049099
100500         DECLARE RFID_CURSOR CURSOR FOR                           10050099
100600         SELECT                                                   10060099
100700                 C.UPC_NBR                                        10070099
100800              ,  C.SCN_TMST                                       10080099
100900              ,  C.VILN_GP_SEQ_NBR                                10090099
101000              ,  SUM(SCND_UNT_QTY)                                10100099
101100              ,  SUM(RFID_TGD_QTY)                                10110099
101200         FROM                                                     10120099
101300                TSUATRN A                                         10130099
101400             ,  TSUAUPC B                                         10140099
101500             ,  TSUEXCP C                                         10150099
101600         WHERE                                                    10160099
101601             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                10160199
101602         AND A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID                10160299
101603         AND A.TRN_NBR          = :DK-PO-NBR                      10160399
101604         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 10160499
101605         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  10160599
101606         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  10160699
101607         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  10160799
101608         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  10160899
101609         AND B.UPC_NBR          = C.UPC_NBR                       10160999
101610         AND B.SCN_TMST         = C.SCN_TMST                      10161099
101620         AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST            10162099
101630         AND B.SCN_TYP_CDE     <> :PC-E                           10163099
101640         AND C.VILN_GP_SEQ_NBR IN  (                              10164099
101650              :PC-RFID-UPC-MISPK-VILN                             10165099
101660             ,:PC-WRG-RFID-CLR-VILN                               10166099
101670             ,:PC-WRG-RFID-SIZE-VILN                              10167099
101680             ,:PC-WRG-RFID-STYLE-VILN)                            10168099
101690        GROUP BY C.VILN_GP_SEQ_NBR                                10169099
101700              ,  C.UPC_NBR                                        10170099
101800              ,  C.SCN_TMST                                       10180099
101900                                                                  10190099
102000        UNION                                                     10200099
102100                                                                  10210099
102200        (SELECT                                                   10220099
102300                 C.UPC_NBR                                        10230099
102400              ,  C.SCN_TMST                                       10240099
102500              ,  C.VILN_GP_SEQ_NBR                                10250099
102600              ,  SUM(SCND_UNT_QTY)                                10260099
102700              ,  SUM(RFID_TGD_QTY)                                10270099
102800         FROM                                                     10280099
102900                TSUATRN A                                         10290099
103000             ,  TSUAUPC B                                         10300099
103100             ,  TSUEXCP C                                         10310099
103200         WHERE                                                    10320099
103201             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                10320199
103202         AND A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID                10320299
103203         AND A.TRN_NBR          = :DK-PO-NBR                      10320399
103204         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 10320499
103205         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  10320599
103206         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  10320699
103207         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  10320799
103208         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  10320899
103209         AND B.UPC_NBR          = C.UPC_NBR                       10320999
103210         AND B.SCN_TMST         = C.SCN_TMST                      10321099
103220         AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST            10322099
103221         AND B.SCN_TYP_CDE      = :PC-E                           10322199
103222         AND C.VILN_GP_SEQ_NBR  = :PC-NO-RFID-TKT-VILN            10322299
103223        GROUP BY C.VILN_GP_SEQ_NBR                                10322399
103224              ,  C.UPC_NBR                                        10322499
103225              ,  C.SCN_TMST                                       10322599
103226          )                                                       10322699
103227     END-EXEC.                                                    10322799
103228*JA 04/01/14 - END                                                10322899
103229                                                                  10322999
103230*  DB2 COMMUNICATION AREA                                         10323099
103231*                                                                 10323199
103232     EXEC SQL                                                     10323299
103233         INCLUDE SQLCA                                            10323399
103234     END-EXEC.                                                    10323499
103235 EJECT                                                            10323599
103236*  DB2 COMMUNICATION AREA2                                        10323699
103237*                                                                 10323799
103238     COPY SQLCA2.                                                 10323899
103239                                                                  10323999
103240 EJECT                                                            10324099
103241                                                                  10324199
103242 PROCEDURE DIVISION.                                              10324299
103243*                                                                 10324399
103244 0000-MAINLINE-PROCESSING.                                        10324499
103245******************************************************************10324599
103246**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      10324699
103247******************************************************************10324799
103248* 02/06/14 DRW BEG                                                10324899
103249     PERFORM 0500-CHECK-FOR-MANUAL-COMBO.                         10324999
103250     IF PS-MANUAL-COMBO-AUDIT                                     10325099
103260                                                                  10326099
103270         DISPLAY 'MANUAL COMBO QC PROCESSING'                     10327099
103271         PERFORM 1000-INITIALIZATION                              10327199
103272*                                                                 10327299
103273         PERFORM 7050-READ-AUD-UPC-EXTRACT                        10327399
103274         SET PS-NOT-EOF-SKU-TOTAL-FILE      TO TRUE               10327499
103275         PERFORM 7060-READ-SKU-TOTAL-FILE                         10327599
103276*                                                                 10327699
103277*        SET PS-NO-ERROR-FOUND              TO TRUE               10327799
103278         PERFORM 2000-PROCESS-SU                                  10327899
103279             UNTIL PS-END-OF-UPC-EXT-FILE                         10327999
103280*                                                                 10328099
103281*        IF  PS-ERROR-FOUND                                       10328199
103282*            PERFORM 8300-PRINT-ERROR-SUMMARY                     10328299
103283             PERFORM 8500-PRINT-ERROR-SUMMARY                     10328399
103284*        ELSE                                                     10328499
103285*            DISPLAY '*** NO ERROR FOUND ***'                     10328599
103286*        END-IF                                                   10328699
103287*                                                                 10328799
103288         WRITE CARTON-AUDIT-RPT-RECORD                            10328899
103289           FROM END-OF-REPORT-LINE                                10328999
103290             AFTER ADVANCING 2 LINES                              10329099
103291*                                                                 10329199
103292*DMB 9/18/01    IF CC-PRTR-CNTL-IND = 'P'                         10329299
103293         IF CC-PRTR-CUT-IND = 'Y'                                 10329399
103294             WRITE CARTON-AUDIT-RPT-RECORD                        10329499
103295                 FROM DS004-PLC-CUT-FORM                          10329599
103296         AFTER ADVANCING 1 LINE                                   10329699
103297         END-IF                                                   10329799
103298                                                                  10329899
103299         CLOSE AUDIT-CART-EXTRACT-FILE                            10329999
103300               AUDIT-UPC-EXTRACT-FILE                             10330099
103301               OS-SKUTOT-OVER-SHORT-FILE                          10330199
103302*                                                                 10330299
103303***                                                               10330399
103304*        PREPARE FOR THE RFID REPORT OF THE MANUAL COMBO AUDIT    10330499
103305***                                                               10330599
103306         SET CC-RFID-AUDIT      TO TRUE                           10330699
103307         SET CC-RFID-AUD-ONLY   TO TRUE                           10330799
103308         MOVE +0                TO PV-PAGE-CNT                    10330899
103309         MOVE +0                TO PV-DETAIL-LINE-COUNT           10330999
103310         INITIALIZE PS-END-OF-UPC-EXT-FILE-SW                     10331099
103311                    PS-END-OF-CART-EXT-FILE-SW                    10331199
103312                    PS-END-OF-EXCEPTIONS-CSR-SW                   10331299
103313                    PS-END-OF-CART-EXCEP-CSR-SW                   10331399
103314         DISPLAY 'MANUAL COMBO RFID PROCESSING SET'               10331499
103315                                                                  10331599
103316     END-IF.                                                      10331699
103317* 02/06/14 DRW END                                                10331799
103318*                                                                 10331899
103319     PERFORM 1000-INITIALIZATION.                                 10331999
103320*                                                                 10332099
103321     PERFORM 7050-READ-AUD-UPC-EXTRACT.                           10332199
103322     SET PS-NOT-EOF-SKU-TOTAL-FILE      TO TRUE.                  10332299
103323     PERFORM 7060-READ-SKU-TOTAL-FILE.                            10332399
103324*                                                                 10332499
103325*    SET PS-NO-ERROR-FOUND              TO TRUE.                  10332599
103326     PERFORM 2000-PROCESS-SU                                      10332699
103327         UNTIL PS-END-OF-UPC-EXT-FILE.                            10332799
103328*                                                                 10332899
103329     PERFORM 8500-PRINT-ERROR-SUMMARY                             10332999
103330*                                                                 10333099
103331     WRITE CARTON-AUDIT-RPT-RECORD                                10333199
103332       FROM END-OF-REPORT-LINE                                    10333299
103333         AFTER ADVANCING 2 LINES.                                 10333399
103334*                                                                 10333499
103335*DMB 9/18/01    IF CC-PRTR-CNTL-IND = 'P'                         10333599
103336     IF CC-PRTR-CUT-IND = 'Y'                                     10333699
103337         WRITE CARTON-AUDIT-RPT-RECORD                            10333799
103338             FROM DS004-PLC-CUT-FORM                              10333899
103339         AFTER ADVANCING 1 LINE                                   10333999
103340     END-IF.                                                      10334099
103350                                                                  10335099
103351     CLOSE CARDIN-AUDIT-NBR-FILE.                                 10335199
103352     CLOSE AUDIT-CART-EXTRACT-FILE                                10335299
103353           AUDIT-UPC-EXTRACT-FILE                                 10335399
103354           OS-SKUTOT-OVER-SHORT-FILE                              10335499
103355           PRINT-CONTROL-FILE                                     10335599
103356           CARTON-AUDIT-RPT-FILE.                                 10335699
103357*                                                                 10335799
103358     GOBACK.                                                      10335899
103359*                                                                 10335999
103360* 02/06/14 DRW BEG                                                10336099
103370******************************************************************10337099
103380*  0500-CHECK-FOR-MANUAL-COMBO.                                   10338099
103390*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.          10339099
103400******************************************************************10340099
103500******************************************************************10350099
103600*  ADDED 'MOVE SU003-SKU-DEPT-NBR  OF OS-FILE TO AH1-DEPT' BEFORE*10360099
103700*  PERFORM 1100-SET-UP-HEADER.                   WR # 21361      *10370099
103800******************************************************************10380099
103900 0500-CHECK-FOR-MANUAL-COMBO.                                     10390099
104000                                                                  10400099
104100     OPEN INPUT  CARDIN-AUDIT-NBR-FILE                            10410099
104200                 PRINT-CONTROL-FILE                               10420099
104300          OUTPUT CARTON-AUDIT-RPT-FILE.                           10430099
104400                                                                  10440099
104500     PERFORM 7000-READ-CARDIN-FILE.                               10450099
104600                                                                  10460099
104700     IF PS-END-OF-CARDIN-FILE                                     10470099
104800         DISPLAY '** SUKRP012 ABEND **'                           10480099
104900         DISPLAY '** CARDIN (AUDIT NUMBER) FILE IS EMPTY **'      10490099
105000         MOVE +4019                  TO PV-ABEND-CODE             10500099
105100         CALL 'ILBOABN0' USING PV-ABEND-CODE                      10510099
105200     END-IF.                                                      10520099
120684                                                                  12068499
120685     IF CC-MANUAL-GENERATED-AUDIT AND CC-QC-AND-RFID-AUD          12068599
120686***                                                               12068699
120687*    PREPARE FOR THE QC REPORT OF THE MANUAL COMBO AUDIT          12068799
120688***                                                               12068899
120689         DISPLAY 'MANUAL COMBO AUDIT QC'                          12068999
120690         SET PS-MANUAL-COMBO-AUDIT      TO TRUE                   12069099
120700         SET CC-QC-AUDIT                TO TRUE                   12070099
120800         SET CC-QC-AUD-ONLY             TO TRUE                   12080099
120900     END-IF.                                                      12090099
121000* 02/06/14 DRW END                                                12100099
121001                                                                  12100199
121002*                                                                 12100299
121003******************************************************************12100399
121004*  ADDED 'MOVE SU003-SKU-DEPT-NBR  OF SU003-COPYBOOK TO HL2-DEPT-*12100499
121005*  NBR AFTER PERFORM 7000-READ-AUD-CART-EXTRACT.    WR # 31261   *12100599
121006******************************************************************12100699
121007 1000-INITIALIZATION.                                             12100799
121008******************************************************************12100899
121009**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               12100999
121010******************************************************************12101099
121011     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          12101199
121012*                                                                 12101299
121013*    ACCEPT CC-CONTROL-CARD FROM SYSIN.                           12101399
121014*    DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   12101499
121015     OPEN INPUT  AUDIT-CART-EXTRACT-FILE                          12101599
121016                 AUDIT-UPC-EXTRACT-FILE                           12101699
121017                 OS-SKUTOT-OVER-SHORT-FILE.                       12101799
121018                                                                  12101899
121019                                                                  12101999
121020     READ PRINT-CONTROL-FILE INTO CC-PRINT-CARD                   12102099
121021     DISPLAY 'PRINTER CARD = ' CC-PRINT-CARD.                     12102199
121022                                                                  12102299
121023     ACCEPT PV-TODAYS-DATE                                        12102399
121024       FROM DATE.                                                 12102499
121025*                                                                 12102599
121026     ACCEPT PV-TODAYS-TIME                                        12102699
121027       FROM TIME.                                                 12102799
121028*                                                                 12102899
121029     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             12102999
121030     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 12103099
121031     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   12103199
121032     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  12103299
121033*                                                                 12103399
121034     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  12103499
121035     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                12103599
121036     MOVE PC-SUKRP012        TO DP132O-PROGRAM-NAME.              12103699
121037                                                                  12103799
121038     PERFORM 7000-READ-AUD-CART-EXTRACT.                          12103899
121039                                                                  12103999
121040     IF NOT PS-END-OF-CART-EXT-FILE                               12104099
121041         MOVE SU003-AUD-CNTL-NBR OF SU003-COPYBOOK                12104199
121042                                 TO DK-AUD-CNTL-NBR               12104299
121043         MOVE SU003-SHIPT-UNT-ID OF SU003-COPYBOOK                12104399
121044                                 TO DK-SHIPT-UNT-ID               12104499
121045         MOVE SU003-SKU-DEPT-NBR OF SU003-COPYBOOK                12104599
121046                                 TO HL3-DEPT-NBR                  12104699
121047                                    PV-SKU-DEPT-NBR               12104799
121048         MOVE PV-SKU-DEPT-NBR    TO DK-DEPT-NBR                   12104899
121049                                                                  12104999
121050         MOVE SU003-SKU-NMBR     OF SU003-COPYBOOK                12105099
121051                                 TO DK-SKU-NBR                    12105199
121052         PERFORM 7135-CHECK-FOR-CART-ERRORS                       12105299
121053     END-IF.                                                      12105399
121060                                                                  12106099
121070     PERFORM 1250-SELECT-AUDIT-TYPE.                              12107099
121071                                                                  12107199
121072     IF PS-END-OF-CART-EXT-FILE AND PS-CART-EXCEP-NOT-FOUND       12107299
121073        MOVE CC-AUDIT-CNTL-NBR     TO PV-AUD-CNTL-NBR             12107399
121074        MOVE PV-AUD-CNTL-NBR       TO HL2-AUD-CNTL-NBR            12107499
121075     ELSE                                                         12107599
121076        MOVE SU003-UPC          OF SU003-COPYBOOK                 12107699
121077                                TO DK-UPC-NBR                     12107799
121078        PERFORM 1100-SELECT-TSUATRN                               12107899
121079        MOVE SUATRN-TRN-NBR     TO HL4-PO-NBR                     12107999
121080                                   DK-PO-NBR                      12108099
121081        MOVE SUATRN-REC-SEQ-NBR TO HL4-REC-SEQ-NBR                12108199
121082                                   DK-REC-SEQ-NBR                 12108299
121083                                                                  12108399
121084        SET HL10A-NOT-COMBO TO TRUE                               12108499
121085        PERFORM 3170-CHECK-COMBO                                  12108599
121086                                                                  12108699
121087        PERFORM 1200-FETCH-TENTNME-INFO                           12108799
121088        MOVE ENTNME-ENT-NAME-DESC TO HL3-VENDOR-NAME              12108899
121089                                                                  12108999
121090        PERFORM 1300-STORE-NAME                                   12109099
121091        MOVE SUATRN-DEST-OPER-UNT-ID  TO HL4-DEST-STORE-NBR       12109199
121092        MOVE XL071-LOC-10-ABBR-NM     TO HL4-DEST-STORE-NAME      12109299
121093                                                                  12109399
121094        PERFORM 1400-SELECT-LOCATION                              12109499
121095        MOVE SUNAUD-OPER-UNT-ID       TO HL2-AUDIT-FCLTY-ID       12109599
121096                                         DK-OPER-UNT-ID           12109699
121097        MOVE XL071-LOC-NM             TO HL2-AUDIT-FCLTY-NAME     12109799
121098        MOVE SUNAUD-PRC-FCLTY-AREA-ID TO HL7-AUDIT-PRC-AREA       12109899
121099                                                                  12109999
121100        IF  SUATRN-REC-SEQ-NBR > 0                                12110099
121101            PERFORM 1500-FETCH-TRECEIV-INFO                       12110199
121102            MOVE RECEIV-REC-TMST       TO PV-DB2-TMST             12110299
121103            MOVE PV-DB2-TMST-MM        TO HL6-DATE-RCVD-MM        12110399
121104            MOVE PV-DB2-TMST-DD        TO HL6-DATE-RCVD-DD        12110499
121105            MOVE PV-DB2-TMST-CCYY      TO HL6-DATE-RCVD-CCYY      12110599
121106            MOVE RECEIV-PACK-BY-ST-IND TO HL3-PACKED-BY-STR-IND   12110699
121107        ELSE                                                      12110799
121108            PERFORM 1550-FETCH-TPOAGMT-INFO                       12110899
121109            MOVE SPACES                TO HL6-DATE-RCVD           12110999
121110            IF  PV-DB2-COUNT > +0                                 12111099
121111                MOVE 'Y'               TO HL3-PACKED-BY-STR-IND   12111199
121112            ELSE                                                  12111299
121113                MOVE 'N'               TO HL3-PACKED-BY-STR-IND   12111399
121114            END-IF                                                12111499
121115        END-IF                                                    12111599
121116                                                                  12111699
121117        MOVE SU003-SHIPT-UNT-ID    OF SU003-COPYBOOK              12111799
121118                                   TO PV-SHIPT-UNT-ID             12111899
121119        MOVE PV-SHIPT-UNT-ID-1     TO PV-FMT-SHIPT-UNT-ID-1       12111999
121120        MOVE PV-SHIPT-UNT-ID-2-10  TO PV-FMT-SHIPT-UNT-ID-2-10    12112099
121121        MOVE PV-SHIPT-UNT-ID-11-17 TO PV-FMT-SHIPT-UNT-ID-11-17   12112199
121122        MOVE PV-SHIPT-UNT-ID-18    TO PV-FMT-SHIPT-UNT-ID-18      12112299
121123        MOVE PV-FMT-SHIPT-UNT-ID   TO HL5-SHIPT-UNT-ID            12112399
121124                                                                  12112499
121125                                                                  12112599
121126        MOVE SU003-AUD-CNTL-NBR    OF SU003-COPYBOOK              12112699
121127                                   TO PV-AUD-CNTL-NBR             12112799
121128        MOVE PV-AUD-CNTL-NBR       TO HL2-AUD-CNTL-NBR            12112899
121129                                                                  12112999
121130        EVALUATE SUNAUD-AUD-TYP-CDE                               12113099
121131            WHEN '01'                                             12113199
121132                MOVE PC-100-PCT-CHECK TO HL5-AUDIT-TYPE           12113299
121133            WHEN '02'                                             12113399
121134                MOVE PC-SPOT-CHECK    TO HL5-AUDIT-TYPE           12113499
121135            WHEN '03'                                             12113599
121136                MOVE PC-REWORK        TO HL5-AUDIT-TYPE           12113699
121137            WHEN OTHER                                            12113799
121138                MOVE PC-UNKNOWN       TO HL5-AUDIT-TYPE           12113899
121139        END-EVALUATE                                              12113999
121140                                                                  12114099
121141* 02/06/14 DRW BEG POPULATE AUDIT CATEGORY IN HEADER              12114199
121142        MOVE 'QC'                  TO HL8A-QC-RFID-IND            12114299
121143        IF CC-RFID-AUDIT                                          12114399
121144            MOVE 'RFID'            TO HL8A-QC-RFID-IND            12114499
121145            PERFORM 1850-COUNT-RFID-ERRORS                        12114599
121146        END-IF                                                    12114699
121147* 02/06/14 DRW END                                                12114799
121148                                                                  12114899
121149        EVALUATE SUNAUD-AUD-STAT-CDE                              12114999
121150            WHEN 'IP'                                             12115099
121151                MOVE PC-IN-PROCESS TO HL2-AUDIT-STATUS            12115199
121152            WHEN 'CM'                                             12115299
121153                MOVE PC-COMPLETE   TO HL2-AUDIT-STATUS            12115399
121154            WHEN 'PP'                                             12115499
121155                MOVE PC-POSTPONED  TO HL2-AUDIT-STATUS            12115599
121156            WHEN OTHER                                            12115699
121157                MOVE PC-UNKNOWN    TO HL2-AUDIT-STATUS            12115799
121158        END-EVALUATE                                              12115899
121159                                                                  12115999
121160        MOVE SUATRN-UNT-AUD-STRT-TMST                             12116099
121161                                  TO PV-DB2-TMST                  12116199
121162        MOVE PV-DB2-TMST-MM       TO HL9A-CARTON-START-DATE-MM    12116299
121163        MOVE PV-DB2-TMST-DD       TO HL9A-CARTON-START-DATE-DD    12116399
121164        MOVE PV-DB2-TMST-CCYY     TO HL9A-CARTON-START-DATE-CCYY  12116499
121165        MOVE PV-DB2-TMST-HH       TO HL9A-CARTON-START-TIME-HH    12116599
121166        MOVE PV-DB2-TMST-MN       TO HL9A-CARTON-START-TIME-MN    12116699
121167                                                                  12116799
121168        IF  SUATRN-UNT-AUD-STP-TMST = PC-DEFAULT-TMST             12116899
121169            MOVE SPACES TO HL10A-CARTON-STOP-DATE                 12116999
121170                           HL10A-CARTON-STOP-TIME                 12117099
121171                           HL8A-CARTON-DURATION                   12117199
121172        ELSE                                                      12117299
121173            MOVE SUATRN-UNT-AUD-STP-TMST                          12117399
121174                                  TO PV-DB2-TMST                  12117499
121175            MOVE PV-DB2-TMST-MM   TO HL10A-CARTON-STOP-DATE-MM    12117599
121176            MOVE PV-DB2-TMST-DD   TO HL10A-CARTON-STOP-DATE-DD    12117699
121177            MOVE PV-DB2-TMST-CCYY TO HL10A-CARTON-STOP-DATE-CCYY  12117799
121178            MOVE PV-DB2-TMST-HH   TO HL10A-CARTON-STOP-TIME-HH    12117899
121179            MOVE PV-DB2-TMST-MN   TO HL10A-CARTON-STOP-TIME-MN    12117999
121180                                                                  12118099
121181            PERFORM 1600-CALC-DURATION                            12118199
121182                                                                  12118299
121183*  SUBTRACT OUT THE MINUTES THAT THE AUDIT WAS EITHER             12118399
121184*  CLOSED, POSTPONED, OR IN A RESTART MODE -- THIS TIME           12118499
121185*  SHOULD NOT COUNT AGAINST THE TIME OF THE AUDIT.                12118599
121186                                                                  12118699
121187            COMPUTE PV-AUDIT-DURATION-TIME =                      12118799
121188                PV-AUDIT-DURATION-TIME -                          12118899
121189                    SUATRN-UNT-PSPND-MNIT-QTY -                   12118999
121190                        SUATRN-UNT-CLO-MNIT-QTY -                 12119099
121191                            SUATRN-UNT-RSTRT-MNIT-QTY             12119199
121192                                                                  12119299
121193            DIVIDE PV-AUDIT-DURATION-TIME BY 60                   12119399
121194                GIVING PV-AUDIT-DURATION-HOURS                    12119499
121195             REMAINDER PV-AUDIT-DURATION-MINUTES                  12119599
121196                                                                  12119699
121197            MOVE PV-AUDIT-DURATION-HOURS                          12119799
121198                                  TO HL8A-CARTON-DURATION-HH      12119899
121199            MOVE PV-AUDIT-DURATION-MINUTES                        12119999
121200                                  TO HL8A-CARTON-DURATION-MM      12120099
121201        END-IF                                                    12120199
121202                                                                  12120299
121203        PERFORM 1700-COUNT-EXPECTED-UNITS                         12120399
121204        MOVE PV-EXPECTED-UNITS    TO HL5-EXPECTED-UNITS           12120499
121205                                                                  12120599
121206        MOVE ZEROS                     TO PV-TOT-UNITS-AUDITED    12120699
121207        MOVE ZEROS                     TO PV-SCND-UNT-QTY         12120799
121208        MOVE ZEROS                     TO PV-RFID-TGD-QTY         12120899
121209        PERFORM 1160-GET-UNITS-AUDITED                            12120999
121210        MOVE PV-TOT-UNITS-AUDITED      TO HL6-AUDITED-UNITS       12121099
121211                                                                  12121199
121212        PERFORM 1900-COUNT-CTN-LVL-ERRORS                         12121299
121213        IF CC-RFID-AUDIT                                          12121399
121214* 04/01/14 JA  BEG                                                12121499
121215            MOVE ZERO  TO PV-HL-UNITS-IN-ERROR                    12121599
121216                          PV-HL-TOTAL-ERRORS                      12121699
121217            PERFORM 3200-CHECK-RFID-ERRORS                        12121799
121218*JA         PERFORM 1170-GET-RFID-TOT-ERRORS                      12121899
121219*JA         PERFORM 1172-GET-RFID42-TOT-ERRORS                    12121999
121220* 04/01/14 JA  END                                                12122099
121230            MOVE PV-HL-TOTAL-ERRORS  TO HL9A-TOTAL-ERRORS         12123099
121240        ELSE                                                      12124099
121241           PERFORM 3300-CHECK-QC-ERRORS                           12124199
121242           MOVE PV-HL-TOTAL-ERRORS   TO HL9A-TOTAL-ERRORS         12124299
121243           PERFORM 3400-RETRIEVE-UNIT-COUNT                       12124399
121244           MOVE PV-HL-UNITS-IN-ERROR TO HL8A-UNITS-IN-ERROR       12124499
121245*JA        PERFORM 1172-GET-QC-ERRORS                             12124599
121246*          IF  PV-CTN-LVL-ERRORS > 0                              12124699
121247*           COMPUTE HL9A-TOTAL-ERRORS =                           12124799
121248*                SU003-TOT-ERR-QTY OF SU003-COPYBOOK              12124899
121249*                                  + PV-CTN-LVL-ERRORS            12124999
121250*         ELSE                                                    12125099
121251*           MOVE SU003-TOT-ERR-QTY   OF SU003-COPYBOOK            12125199
121252*                                    TO HL9A-TOTAL-ERRORS         12125299
121253*         END-IF                                                  12125399
121254        END-IF                                                    12125499
121255        IF CC-RFID-AUDIT                                          12125599
121256*JA       PERFORM 1180-GET-RFID-UNITS-IN-ERROR                    12125699
121257*JA       PERFORM 1181-GET-RFID42-UNITS-IN-ERROR                  12125799
121258          MOVE PV-HL-UNITS-IN-ERROR    TO HL8A-UNITS-IN-ERROR     12125899
121259          IF PV-TOT-UNITS-AUDITED > 0                             12125999
121260            COMPUTE PV-PCT-UNITS-IN-ERROR =                       12126099
121261              (PV-HL-UNITS-IN-ERROR / PV-TOT-UNITS-AUDITED) * 100 12126199
121262            MOVE PV-PCT-UNITS-IN-ERROR                            12126299
121263                                  TO HL10A-PCT-UNITS-IN-ERROR     12126399
121264          ELSE                                                    12126499
121265*           IF THERE ARE NO EXPECT UNITS, MOVE 100% IF THERE      12126599
121266*           ARE ERRORS, OR 0% IF AREN'T ERRORS                    12126699
121267            IF PV-HL-UNITS-IN-ERROR > 0                           12126799
121268                MOVE 100          TO HL10A-PCT-UNITS-IN-ERROR     12126899
121269            ELSE                                                  12126999
121270                MOVE 000          TO HL10A-PCT-UNITS-IN-ERROR     12127099
121271            END-IF                                                12127199
121272          END-IF                                                  12127299
121273        ELSE                                                      12127399
121274*JA       MOVE SU003-UNT-ERR-CNT-COMBO OF SU003-COPYBOOK          12127499
121275*JA                                    TO HL8A-UNITS-IN-ERROR     12127599
121276                                                                  12127699
121277          IF PV-EXPECTED-UNITS > 0                                12127799
121278            COMPUTE PV-PCT-UNITS-IN-ERROR =                       12127899
121279              (SU003-UNT-ERR-CNT-COMBO OF SU003-COPYBOOK /        12127999
121280                                         PV-EXPECTED-UNITS) * 100 12128099
121281            MOVE PV-PCT-UNITS-IN-ERROR                            12128199
121282                                  TO HL10A-PCT-UNITS-IN-ERROR     12128299
121283          ELSE                                                    12128399
121284*           IF THERE ARE NOT EXPECT UNITS, MOVE 100% IF THERE     12128499
121285*           ARE ERRORS, OR 0% IF AREN'T ERRORS                    12128599
121286            IF SU003-UNT-ERR-CNT-COMBO OF SU003-COPYBOOK > 0      12128699
121287                MOVE 100          TO HL10A-PCT-UNITS-IN-ERROR     12128799
121288            ELSE                                                  12128899
121289                MOVE 000          TO HL10A-PCT-UNITS-IN-ERROR     12128999
121290            END-IF                                                12129099
121300          END-IF                                                  12130099
121301        END-IF                                                    12130199
121302     END-IF.                                                      12130299
121303                                                                  12130399
121304*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  12130499
121305     IF CC-PRTR-CNTL-IND = 'P'                                    12130599
121306         MOVE CC-TRACK-NBR        TO DS004-PLC-LF-FORM-NBR        12130699
121307         MOVE DS004-PES-8LPI      TO DS004-PLC-LF-LPI             12130799
121308                                                                  12130899
121309         WRITE CARTON-AUDIT-RPT-RECORD                            12130999
121310             FROM DS004-PLC-LOAD-FORM                             12131099
121311         AFTER ADVANCING 1 LINE                                   12131199
121312     END-IF.                                                      12131299
121313                                                                  12131399
121314     PERFORM 8000-WRITE-REPORT-HEADERS.                           12131499
121315*                                                                 12131599
121316* DMH 06/16/03 - BEGIN                                            12131699
121317     IF  PS-END-OF-CART-EXT-FILE                                  12131799
121318         MOVE SPACES   TO  HL8-PREPACK-ID                         12131899
121319     ELSE                                                         12131999
121320         PERFORM 1010-CHECK-PREPACK                               12132099
121321     END-IF.                                                      12132199
121322* DMH 06/16/03 - END                                              12132299
121323*                                                                 12132399
121324     PERFORM 8200-WRITE-DETAIL-HEADERS.                           12132499
121325                                                                  12132599
121326     IF PS-CART-EXCEP-FOUND                                       12132699
121327        PERFORM 7130-GET-CARTON-LEVEL-ERR                         12132799
121328     ELSE                                                         12132899
121329        IF PS-END-OF-CART-EXT-FILE                                12132999
121330            WRITE CARTON-AUDIT-RPT-RECORD                         12133099
121331                FROM NO-DATA-LINE                                 12133199
121332            AFTER ADVANCING 2 LINE                                12133299
121333        END-IF                                                    12133399
121334     END-IF.                                                      12133499
121335                                                                  12133599
121336                                                                  12133699
121337* DMH 06/16/03 - BEGIN                                            12133799
121338******************************************************************12133899
121339 1010-CHECK-PREPACK.                                              12133999
121340                                                                  12134099
121341     MOVE '1010-CHECK-PREPACK  ' TO PV-PARAGRAPH-NAME.            12134199
121342                                                                  12134299
121343     MOVE  SU003-SHIPT-UNT-ID    OF SU003-COPYBOOK                12134399
121344                                 TO DK-SHIPT-UNT-ID.              12134499
121345     MOVE  SU003-REC-SEQ-NBR     OF SU003-COPYBOOK                12134599
121346                                 TO DK-RCVR-SEQ.                  12134699
121347     EXEC SQL                                                     12134799
121348          SELECT DISTINCT B.PREPK_ID                              12134899
121349            INTO :RECITM-PREPK-ID                                 12134999
121350            FROM TSHUUPC   A                                      12135099
121351               , TRECITM   B                                      12135199
121352           WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                12135299
121353             AND B.ORD_NBR      =  A.TRN_NBR                      12135399
121354             AND B.ORD_LNE_NBR  =  A.TRN_LNE_NBR                  12135499
121355             AND B.REC_SEQ_NBR  = :DK-RCVR-SEQ                    12135599
121356     END-EXEC.                                                    12135699
121357                                                                  12135799
121358     EVALUATE TRUE                                                12135899
121359       WHEN SQLCODE = ZEROS                                       12135999
121360       WHEN SQLCODE = -811                                        12136099
121361            MOVE  RECITM-PREPK-ID  TO  PV-DISPLAY-PREPK-ID        12136199
121362            IF  RECITM-PREPK-ID  = ZEROES                         12136299
121363                MOVE SPACES   TO  HL8-PREPACK-ID                  12136399
121364            ELSE                                                  12136499
121365                STRING '(PACK-'                                   12136599
121366                       PV-DISPLAY-PREPK-ID                        12136699
121367                       ')'             DELIMITED BY SIZE          12136799
121368                                 INTO  HL8-PREPACK-ID             12136899
121369            END-IF                                                12136999
121370                                                                  12137099
121371       WHEN SQLCODE = +100                                        12137199
121372            MOVE  SPACES  TO  HL8-PREPACK-ID                      12137299
121373                                                                  12137399
121374       WHEN OTHER                                                 12137499
121375         DISPLAY PV-PARAGRAPH-NAME                                12137599
121376         DISPLAY 'AUD CNTL NUMBER ' SU003-AUD-CNTL-NBR OF         12137699
121377                                    SU003-COPYBOOK                12137799
121378         DISPLAY 'SHIPT UNIT ID   ' DK-SHIPT-UNT-ID               12137899
121379         DISPLAY 'SEQ NUMBER      ' DK-RCVR-SEQ                   12137999
121380         PERFORM 9999-SQL-ABEND                                   12138099
121381     END-EVALUATE.                                                12138199
121382                                                                  12138299
121383* DMH 06/16/03 - END                                              12138399
121384*                                                                 12138499
121385******************************************************************12138599
121386**  SELECT INFORMATION FROM THE SHIPPING UNIT AUDIT TABLE AND THE 12138699
121387**  SHIPPING UNIT AUDIT TRANSACTIONS TABLE FOR THE HEADER PART OF 12138799
121388**  THE REPORT.                                                   12138899
121400******************************************************************12140099
121401 1100-SELECT-TSUATRN.                                             12140199
121402                                                                  12140299
121500     INITIALIZE DCLTSUNAUD                                        12150099
121600                DCLTSUATRN.                                       12160099
121700                                                                  12170099
121800     MOVE '1100-SELECT-TSUATRN ' TO PV-PARAGRAPH-NAME.            12180099
121900                                                                  12190099
122000     EXEC SQL                                                     12200099
122100       SELECT  A.UNT_AUD_STRT_TMST                                12210099
122200              ,A.UNT_AUD_STP_TMST                                 12220099
122300              ,A.UNT_PSPND_MNIT_QTY                               12230099
122400              ,A.UNT_CLO_MNIT_QTY                                 12240099
122500              ,A.TRN_NBR                                          12250099
122600              ,A.REC_SEQ_NBR                                      12260099
122700              ,A.DEST_OPER_UNT_ID                                 12270099
122800              ,A.DEST_FCLTY_ID                                    12280099
122900              ,A.UNT_RSTRT_MNIT_QTY                               12290099
123000              ,B.OPER_UNT_ID                                      12300099
123100              ,B.FCLTY_ID                                         12310099
123200              ,B.PRC_FCLTY_AREA_ID                                12320099
123300              ,B.AUD_STAT_CDE                                     12330099
123400              ,B.AUD_TYP_CDE                                      12340099
123500         INTO  :SUATRN-UNT-AUD-STRT-TMST                          12350099
123600              ,:SUATRN-UNT-AUD-STP-TMST                           12360099
123700              ,:SUATRN-UNT-PSPND-MNIT-QTY                         12370099
123800              ,:SUATRN-UNT-CLO-MNIT-QTY                           12380099
123900              ,:SUATRN-TRN-NBR                                    12390099
124000              ,:SUATRN-REC-SEQ-NBR                                12400099
124100              ,:SUATRN-DEST-OPER-UNT-ID                           12410099
124200              ,:SUATRN-DEST-FCLTY-ID                              12420099
124300              ,:SUATRN-UNT-RSTRT-MNIT-QTY                         12430099
124400              ,:SUNAUD-OPER-UNT-ID                                12440099
124500              ,:SUNAUD-FCLTY-ID                                   12450099
124600              ,:SUNAUD-PRC-FCLTY-AREA-ID                          12460099
124700              ,:SUNAUD-AUD-STAT-CDE                               12470099
124800              ,:SUNAUD-AUD-TYP-CDE                                12480099
124900         FROM  TSUATRN A                                          12490099
125000              ,TSUNAUD B                                          12500099
125100        WHERE  A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                  12510099
125200          AND  A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                  12520099
125300          AND  A.AUD_CNTL_NBR = B.AUD_CNTL_NBR                    12530099
125400     END-EXEC.                                                    12540099
125500                                                                  12550099
125600     EVALUATE TRUE                                                12560099
125700       WHEN SQLCODE = ZEROS                                       12570099
125800         CONTINUE                                                 12580099
125810                                                                  12581099
125900       WHEN OTHER                                                 12590099
126400         DISPLAY PV-PARAGRAPH-NAME                                12640099
126401         DISPLAY 'AUD CNTL NUMBER ' SU003-AUD-CNTL-NBR OF         12640199
126402                                    SU003-COPYBOOK                12640299
126403         DISPLAY 'SHIPT UNIT ID   ' SU003-SHIPT-UNT-ID OF         12640399
126404                                    SU003-COPYBOOK                12640499
126500         PERFORM 9999-SQL-ABEND                                   12650099
126600     END-EVALUATE.                                                12660099
126700                                                                  12670099
126800                                                                  12680099
126900******************************************************************12690099
127000*  1160-GET-UNITS-AUDITED.                                        12700099
127100******************************************************************12710099
127200 1160-GET-UNITS-AUDITED.                                          12720099
127201                                                                  12720199
127202     MOVE '1160-GET-UNITS-AUDITED' TO PV-PARAGRAPH-NAME.          12720299
127203                                                                  12720399
127204     EXEC SQL                                                     12720499
127205         SELECT                                                   12720599
127206               SUM(SCND_UNT_QTY)                                  12720699
127207         INTO                                                     12720799
127208               :PV-SCND-UNT-QTY                                   12720899
127209         FROM                                                     12720999
127210               TSUAUPC A                                          12721099
127220         WHERE                                                    12722099
127230               A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                12723099
127240           AND A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                12724099
127250           AND A.SCN_TYP_CDE   <> :PC-E                           12725099
127260     END-EXEC.                                                    12726099
127270                                                                  12727099
127280     EVALUATE TRUE                                                12728099
127290         WHEN SQLCODE = ZERO                                      12729099
127300              IF PV-SCND-UNT-QTY < 0                              12730099
127400                  COMPUTE PV-SCND-UNT-QTY =                       12740099
127500                      PV-SCND-UNT-QTY * -1                        12750099
127600              END-IF                                              12760099
127700              MOVE PV-SCND-UNT-QTY                                12770099
127800                               TO PV-TOT-UNITS-AUDITED            12780099
127900                                                                  12790099
128000         WHEN SQLCODE = -305                                      12800099
128100              MOVE ZEROES TO PV-SCND-UNT-QTY                      12810099
128200              MOVE ZEROES TO PV-TOT-UNITS-AUDITED                 12820099
128300                                                                  12830099
128400         WHEN SQLWARN0 NOT EQUAL SPACE                            12840099
128401         WHEN SQLCODE NOT EQUAL ZERO                              12840199
128402              DISPLAY PV-PARAGRAPH-NAME                           12840299
128403              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             12840399
128404*             DISPLAY 'SHIPT UNT ID ' DK-SHIPT-UNT-ID             12840499
128405              PERFORM 9999-SQL-ABEND                              12840599
128406     END-EVALUATE.                                                12840699
128407                                                                  12840799
128408******************************************************************12840899
128409*  1170-GET-RFID-TOT-ERRORS.                                      12840999
128410******************************************************************12841099
128420 1170-GET-RFID-TOT-ERRORS.                                        12842099
128430                                                                  12843099
128440     EXEC SQL                                                     12844099
128450         SELECT SUM(B.RFID_TGD_QTY)                               12845099
128460         INTO                                                     12846099
128470               :PV-TOTAL-ERROR-QTY                                12847099
128480         FROM (SELECT                                             12848099
128490                   A.AUD_CNTL_NBR                                 12849099
128500                 , A.SHIPT_UNT_ID                                 12850099
128600                 , A.UPC_NBR                                      12860099
128700                 , A.SCN_TMST                                     12870099
128800                 FROM TSUEXCP A                                   12880099
128900                WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR           12890099
129000                  AND VILN_GP_SEQ_NBR IN (38, 39, 40, 41)) C      12900099
129100            ,  TSUAUPC B                                          12910099
129200            ,  TSUATRN D                                          12920099
129300         WHERE                                                    12930099
129400               B.AUD_CNTL_NBR       =  :DK-AUD-CNTL-NBR           12940099
129500           AND C.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             12950099
129600           AND C.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             12960099
129700           AND C.UPC_NBR            =  B.UPC_NBR                  12970099
129800           AND D.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             12980099
129900           AND D.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             12990099
130000           AND C.SCN_TMST           =  B.SCN_TMST                 13000099
130100           AND C.SCN_TMST          >=  D.UNT_AUD_STRT_TMST        13010099
130200     END-EXEC.                                                    13020099
130300                                                                  13030099
130400     EVALUATE TRUE                                                13040099
130500         WHEN SQLCODE = ZERO                                      13050099
130600             MOVE PV-TOTAL-ERROR-QTY     TO PV-HL-TOTAL-ERRORS    13060099
130700         WHEN SQLCODE = -305                                      13070099
130800               MOVE ZEROES               TO PV-HL-TOTAL-ERRORS    13080099
130900         WHEN SQLWARN0 NOT EQUAL SPACE                            13090099
131000         WHEN SQLCODE NOT EQUAL ZERO                              13100099
131100              MOVE '1170-GET-RFID-TOT-ERRORS'                     13110099
131200                               TO  PV-PARAGRAPH-NAME              13120099
131300              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             13130099
131400              PERFORM 9999-SQL-ABEND                              13140099
131500     END-EVALUATE.                                                13150099
131600                                                                  13160099
131700******************************************************************13170099
131800*  1172-GET-QC-ERRORS.                                            13180099
131900******************************************************************13190099
132000 1172-GET-QC-ERRORS.                                              13200099
132100                                                                  13210099
132200     EXEC SQL                                                     13220099
132300         SELECT COUNT(*)                                          13230099
132400           INTO :PV-QC-ERRORS                                     13240099
132500           FROM TSUEXCP A                                         13250099
132600               ,TVILNCD B                                         13260099
132700          WHERE A.AUD_CNTL_NBR    = :DK-AUD-CNTL-NBR              13270099
132800            AND A.VILN_GP_CDE     = :PC-VA                        13280099
132900            AND A.VILN_GP_CDE     = B.VILN_GP_CDE                 13290099
133000            AND B.VILN_CTG_CDE   <> :PC-R                         13300099
133100            AND A.VILN_GP_SEQ_NBR = B.VILN_GP_SEQ_NBR             13310099
133200     END-EXEC.                                                    13320099
133300                                                                  13330099
133400     EVALUATE TRUE                                                13340099
133500         WHEN SQLCODE = ZERO                                      13350099
133600              MOVE PV-QC-ERRORS  TO PV-HL-TOTAL-ERRORS            13360099
133700                                                                  13370099
133800         WHEN SQLCODE = -305                                      13380099
133900               MOVE ZEROES       TO PV-HL-TOTAL-ERRORS            13390099
134000                                                                  13400099
134100         WHEN SQLWARN0 NOT EQUAL SPACE                            13410099
134200         WHEN SQLCODE NOT EQUAL ZERO                              13420099
134300              MOVE '1172-GET-QC-ERRORS'                           13430099
134400                                 TO PV-PARAGRAPH-NAME             13440099
134500              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             13450099
134600              PERFORM 9999-SQL-ABEND                              13460099
134700     END-EVALUATE.                                                13470099
134800                                                                  13480099
134900******************************************************************13490099
135000*  1172-GET-RFID42-TOT-ERRORS.                                    13500099
135100******************************************************************13510099
135200 1172-GET-RFID42-TOT-ERRORS.                                      13520099
135300                                                                  13530099
135400     EXEC SQL                                                     13540099
135500         SELECT SUM(B.SCND_UNT_QTY - B.RFID_TGD_QTY)              13550099
135600         INTO                                                     13560099
135700               :PV-TOTAL-ERROR-QTY                                13570099
135800         FROM (SELECT                                             13580099
135900                   A.AUD_CNTL_NBR                                 13590099
136000                 , A.SHIPT_UNT_ID                                 13600099
136100                 , A.UPC_NBR                                      13610099
136200                 , A.SCN_TMST                                     13620099
136300                 FROM TSUEXCP A                                   13630099
136400                WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR           13640099
136500                  AND VILN_GP_SEQ_NBR = 42) C                     13650099
136600            ,  TSUAUPC B                                          13660099
136700            ,  TSUATRN D                                          13670099
136800         WHERE                                                    13680099
136900               B.AUD_CNTL_NBR       =  :DK-AUD-CNTL-NBR           13690099
137000           AND C.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             13700099
137100           AND C.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             13710099
137200           AND C.UPC_NBR            =  B.UPC_NBR                  13720099
137300           AND D.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             13730099
137400           AND D.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             13740099
137500           AND C.SCN_TMST           =  B.SCN_TMST                 13750099
137600           AND C.SCN_TMST          >=  D.UNT_AUD_STRT_TMST        13760099
137700     END-EXEC.                                                    13770099
137800                                                                  13780099
137900     EVALUATE TRUE                                                13790099
138000         WHEN SQLCODE = ZERO                                      13800099
138100             ADD PV-TOTAL-ERROR-QTY     TO PV-HL-TOTAL-ERRORS     13810099
138200         WHEN SQLCODE = -305                                      13820099
138300             MOVE ZEROS                 TO PV-TOTAL-ERROR-QTY     13830099
138400         WHEN SQLWARN0 NOT EQUAL SPACE                            13840099
138500         WHEN SQLCODE NOT EQUAL ZERO                              13850099
138600              MOVE '1172-GET-RFID42-TOT-ERRORS'                   13860099
138700                               TO  PV-PARAGRAPH-NAME              13870099
138800              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             13880099
138900              PERFORM 9999-SQL-ABEND                              13890099
138901     END-EVALUATE.                                                13890199
138902                                                                  13890299
138903******************************************************************13890399
138904*  1180-GET-RFID-UNITS-IN-ERROR.                                  13890499
138905******************************************************************13890599
138906 1180-GET-RFID-UNITS-IN-ERROR.                                    13890699
138907                                                                  13890799
138908     EXEC SQL                                                     13890899
138909         SELECT SUM(B.RFID_TGD_QTY)                               13890999
138910         INTO                                                     13891099
138920               :PV-RFID-UNITS-IN-ERROR                            13892099
138930         FROM (SELECT DISTINCT                                    13893099
138940                   A.AUD_CNTL_NBR                                 13894099
138950                 , A.SHIPT_UNT_ID                                 13895099
138960                 , A.UPC_NBR                                      13896099
138970                 , A.SCN_TMST                                     13897099
138980                 FROM TSUEXCP A                                   13898099
138990                WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR           13899099
139000                  AND VILN_GP_SEQ_NBR IN (38, 39, 40, 41)) C      13900099
139100            ,  TSUAUPC B                                          13910099
139200            ,  TSUATRN D                                          13920099
139300         WHERE                                                    13930099
139400               B.AUD_CNTL_NBR       =  :DK-AUD-CNTL-NBR           13940099
139500           AND C.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             13950099
139600           AND C.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             13960099
139700           AND C.UPC_NBR            =  B.UPC_NBR                  13970099
139800           AND D.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             13980099
139900           AND D.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             13990099
140000           AND C.SCN_TMST           =  B.SCN_TMST                 14000099
140100           AND C.SCN_TMST          >=  D.UNT_AUD_STRT_TMST        14010099
140200     END-EXEC.                                                    14020099
140300                                                                  14030099
140400     EVALUATE TRUE                                                14040099
140500         WHEN SQLCODE = ZERO                                      14050099
140600             MOVE PV-RFID-UNITS-IN-ERROR TO PV-HL-UNITS-IN-ERROR  14060099
140700                                                                  14070099
140800         WHEN SQLCODE = +100                                      14080099
140900         WHEN SQLCODE = -305                                      14090099
141000               MOVE ZEROES               TO PV-HL-UNITS-IN-ERROR  14100099
141100                                                                  14110099
141200         WHEN SQLWARN0 NOT EQUAL SPACE                            14120099
141300         WHEN SQLCODE NOT EQUAL ZERO                              14130099
141400              MOVE '1180-GET-RFID-UNITS-IN-ERROR'                 14140099
141500                               TO  PV-PARAGRAPH-NAME              14150099
141600              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             14160099
141700              PERFORM 9999-SQL-ABEND                              14170099
141800     END-EVALUATE.                                                14180099
141900                                                                  14190099
142000******************************************************************14200099
142100*  1181-GET-RFID42-UNITS-IN-ERROR.                                14210099
142200******************************************************************14220099
142300 1181-GET-RFID42-UNITS-IN-ERROR.                                  14230099
142400                                                                  14240099
142500     EXEC SQL                                                     14250099
142600         SELECT SUM(B.SCND_UNT_QTY - B.RFID_TGD_QTY)              14260099
142700         INTO                                                     14270099
142800               :PV-RFID-UNITS-IN-ERROR                            14280099
142900         FROM (SELECT DISTINCT                                    14290099
143000                   A.AUD_CNTL_NBR                                 14300099
143100                 , A.SHIPT_UNT_ID                                 14310099
143200                 , A.UPC_NBR                                      14320099
143300                 , A.SCN_TMST                                     14330099
143400                 FROM TSUEXCP A                                   14340099
143500                WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR           14350099
143600                  AND VILN_GP_SEQ_NBR = 42) C                     14360099
143700            ,  TSUAUPC B                                          14370099
143800            ,  TSUATRN D                                          14380099
143900         WHERE                                                    14390099
144000               B.AUD_CNTL_NBR       =  :DK-AUD-CNTL-NBR           14400099
144100           AND C.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             14410099
144200           AND C.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             14420099
144300           AND C.UPC_NBR            =  B.UPC_NBR                  14430099
144400           AND D.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             14440099
144500           AND D.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             14450099
144600           AND C.SCN_TMST           =  B.SCN_TMST                 14460099
144700           AND C.SCN_TMST          >=  D.UNT_AUD_STRT_TMST        14470099
144800     END-EXEC.                                                    14480099
144900                                                                  14490099
145000     EVALUATE TRUE                                                14500099
145100         WHEN SQLCODE = ZERO                                      14510099
145200             ADD  PV-RFID-UNITS-IN-ERROR TO PV-HL-UNITS-IN-ERROR  14520099
145300                                                                  14530099
145400         WHEN SQLCODE = +100                                      14540099
145500         WHEN SQLCODE = -305                                      14550099
145600               MOVE ZEROES               TO PV-RFID-UNITS-IN-ERROR14560099
145700                                                                  14570099
145800         WHEN SQLWARN0 NOT EQUAL SPACE                            14580099
145900         WHEN SQLCODE NOT EQUAL ZERO                              14590099
146000              MOVE '1181-GET-RFID42-UNITS-IN-ERROR'               14600099
146100                               TO  PV-PARAGRAPH-NAME              14610099
146200              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             14620099
146300              PERFORM 9999-SQL-ABEND                              14630099
146400     END-EVALUATE.                                                14640099
146500                                                                  14650099
146600                                                                  14660099
146700* 02/06/14 DRW BEG                                                14670099
146800******************************************************************14680099
146900*  1190-GET-HEADER-INFO.                                          14690099
147000******************************************************************14700099
147100*1190-GET-HEADER-INFO.                                            14710099
147200*                                                                 14720099
147300*    EXEC SQL                                                     14730099
147400*        SELECT                                                   14740099
147500*               SUM(SCND_UNT_QTY)                                 14750099
147600*             , SUM(B.RFID_TGD_QTY)                               14760099
147700*        INTO                                                     14770099
147800*               :PV-SCND-UNT-COUNT                                14780099
147900*             , :PV-RFID-TGD-COUNT                                14790099
148000*        FROM                                                     14800099
148100*              TSUNAUD A                                          14810099
148200*           ,  TSUAUPC B                                          14820099
148300*           ,  TSUATRN C                                          14830099
148400*        WHERE                                                    14840099
148500*              A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                  14850099
148600*          AND A.AUD_CNTL_NBR = B.AUD_CNTL_NBR                    14860099
148700*          AND A.AUD_CNTL_NBR = C.AUD_CNTL_NBR                    14870099
148800*          AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    14880099
148900**         AND C.TRN_NBR      = :SUATRN-TRN-NBR                   14890099
149000**         AND C.REC_SEQ_NBR  = :DK-RCVR-SEQ                      14900099
149100*        WITH UR                                                  14910099
149200*    END-EXEC.                                                    14920099
149300*                                                                 14930099
149400*    EVALUATE TRUE                                                14940099
149500*        WHEN SQLCODE = ZERO                                      14950099
149600*            COMPUTE PV-HL-AUDITED-UNITS =                        14960099
149700*                PV-RFID-TGD-COUNT                                14970099
149800*        WHEN SQLCODE = 100                                       14980099
149900*            MOVE ZEROS             TO PV-HL-AUDITED-UNITS        14990099
150000*        WHEN SQLWARN0 NOT EQUAL SPACE                            15000099
150100*        WHEN SQLCODE NOT EQUAL ZERO                              15010099
150200*             MOVE '1190-GET-HEADER-INFO'                         15020099
150300*                              TO  PV-PARAGRAPH-NAME              15030099
150400*             DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             15040099
150500*             PERFORM 9999-SQL-ABEND                              15050099
150600*    END-EVALUATE.                                                15060099
150700*                                                                 15070099
150701* 02/06/14 DRW END                                                15070199
150702                                                                  15070299
150703******************************************************************15070399
150704*  FETCH THE VENDOR NAME                                         *15070499
150705******************************************************************15070599
150706 1200-FETCH-TENTNME-INFO.                                         15070699
150707                                                                  15070799
150708     INITIALIZE DCLTPURCHS                                        15070899
150709                DCLTENTNME.                                       15070999
150710                                                                  15071099
150711     MOVE '1200-FETCH-TENTNME-INFO'                               15071199
150712                                 TO PV-PARAGRAPH-NAME.            15071299
150713                                                                  15071399
150714     EXEC SQL                                                     15071499
150715       SELECT  B.ENT_NAME_DESC                                    15071599
150716         INTO  :ENTNME-ENT-NAME-DESC                              15071699
150717         FROM  TPURCHS A                                          15071799
150718              ,TENTNME B                                          15071899
150719        WHERE  A.PO_NBR         = :SUATRN-TRN-NBR                 15071999
150720          AND  A.VER_STATUS_CDE = :PC-ACTIVE-STATUS               15072099
150721          AND  A.ENT_ID         = B.ENT_ID                        15072199
150722          AND  B.TYPE_CDE       = :PC-LONG-NAME                   15072299
150723     END-EXEC.                                                    15072399
150724                                                                  15072499
150725     EVALUATE TRUE                                                15072599
150726       WHEN SQLCODE = ZEROS                                       15072699
150727         CONTINUE                                                 15072799
150728       WHEN SQLCODE = +100                                        15072899
150729         MOVE 'UNKNOWN VENDOR' TO ENTNME-ENT-NAME-DESC            15072999
150730       WHEN OTHER                                                 15073099
150731         DISPLAY PV-PARAGRAPH-NAME                                15073199
150732         DISPLAY 'PO NUMBER '     SUATRN-TRN-NBR                  15073299
150733         PERFORM 9999-SQL-ABEND                                   15073399
150734     END-EVALUATE.                                                15073499
150735                                                                  15073599
150736*JA 03/19/14 - BEGIN PR#5148D                                     15073699
150737******************************************************************15073799
150738* 1250-SELECT-AUDIT-TYPE                                          15073899
150739*    THIS PARAGRAPH WILL SELECT FROM SUT_PO_AUD_REQ TO CHECK IF   15073999
150740*    THE AUDIT IS PROMPTED OR MANUAL                              15074099
150750******************************************************************15075099
150760 1250-SELECT-AUDIT-TYPE.                                          15076099
150770                                                                  15077099
150780     INITIALIZE DCLSUT00015.                                      15078099
150790                                                                  15079099
150800     EXEC SQL                                                     15080099
150900         SELECT PKGNG_TYP_CDE                                     15090099
151000               ,VALUE(RWRK_AUD_CNTL_NBR,0)                        15100099
151100         INTO  :SUT00015-PKGNG-TYP-CDE                            15110099
151200              ,:SUT00015-RWRK-AUD-CNTL-NBR                        15120099
151300         FROM   SUT_PO_AUD_REQ                                    15130099
151400         WHERE  AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                 15140099
151500     END-EXEC.                                                    15150099
151600                                                                  15160099
151700     EVALUATE TRUE                                                15170099
151800       WHEN SQLCODE = +0                                          15180099
151900            SET HL9A-PROMPTED-AUDIT TO TRUE                       15190099
152000                                                                  15200099
152100       WHEN SQLCODE = +100                                        15210099
152200            SET HL9A-MANUAL-AUDIT   TO TRUE                       15220099
152300                                                                  15230099
152400       WHEN OTHER                                                 15240099
152500            DISPLAY 'AUDIT NUMBER '    DK-AUD-CNTL-NBR            15250099
152600            MOVE '1250-SELECT-AUDIT-TYPE'                         15260099
152700                                   TO  PV-PARAGRAPH-NAME          15270099
152800            PERFORM 9999-SQL-ABEND                                15280099
152900     END-EVALUATE.                                                15290099
153000*JA 03/19/14 - END PR#5148D                                       15300099
153100                                                                  15310099
153101******************************************************************15310199
153102 1300-STORE-NAME.                                                 15310299
153103                                                                  15310399
153104     MOVE '1300-STORE-NAME'      TO PV-PARAGRAPH-NAME.            15310499
153105     INITIALIZE XL071-COMMAREA-REC.                               15310599
153106     MOVE SUATRN-DEST-OPER-UNT-ID TO XL071-LOCATION-NUMBER        15310699
153107                                                                  15310799
153108     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         15310899
153109                                                                  15310999
153110     EVALUATE TRUE                                                15311099
153120     WHEN XL071-NO-ERRORS                                         15312099
153121         CONTINUE                                                 15312199
153122     WHEN XL071-LOC-NOT-FOUND                                     15312299
153123     WHEN XL071-DC-ASGMT-NOT-FND                                  15312399
153124         MOVE 'UNKNOWN'               TO XL071-LOC-10-ABBR-NM     15312499
153125     WHEN XL071-BAD-DB2-RETURN                                    15312599
153126         DISPLAY 'CALL LOCATION MOD '                             15312699
153127         DISPLAY PV-PARAGRAPH-NAME                                15312799
153128         DISPLAY 'XLT00010'                                       15312899
153129         MOVE XL071-SQLCA             TO SQLCA                    15312999
153130         PERFORM 9999-SQL-ABEND                                   15313099
153131     END-EVALUATE.                                                15313199
153132/                                                                 15313299
153133******************************************************************15313399
153134 1400-SELECT-LOCATION.                                            15313499
153135                                                                  15313599
153136     MOVE '1400-SELECT-LOCATION' TO PV-PARAGRAPH-NAME.            15313699
153137                                                                  15313799
153138     INITIALIZE XL071-COMMAREA-REC.                               15313899
153139     MOVE SUNAUD-OPER-UNT-ID    TO XL071-LOCATION-NUMBER          15313999
153140                                                                  15314099
153141     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         15314199
153142                                                                  15314299
153143     EVALUATE TRUE                                                15314399
153144     WHEN XL071-NO-ERRORS                                         15314499
153145         CONTINUE                                                 15314599
153146     WHEN XL071-LOC-NOT-FOUND                                     15314699
153147     WHEN XL071-DC-ASGMT-NOT-FND                                  15314799
153148         MOVE 'UNKNOWN FACILITY'    TO XL071-LOC-NM               15314899
153149     WHEN XL071-BAD-DB2-RETURN                                    15314999
153150         DISPLAY 'CALL LOCATION MOD '                             15315099
153151         DISPLAY PV-PARAGRAPH-NAME                                15315199
153152         DISPLAY 'XLT00010'                                       15315299
153153         MOVE XL071-SQLCA             TO SQLCA                    15315399
153154         PERFORM 9999-SQL-ABEND                                   15315499
153155     END-EVALUATE.                                                15315599
153156/                                                                 15315699
153157******************************************************************15315799
153158*  FETCH RECEIVER RELATED INFORMATION                            *15315899
153159******************************************************************15315999
153160 1500-FETCH-TRECEIV-INFO.                                         15316099
153161                                                                  15316199
153162     INITIALIZE DCLTRECEIV.                                       15316299
153163                                                                  15316399
153164     MOVE '1500-FETCH-TRECEIV-INFO'                               15316499
153165                                 TO PV-PARAGRAPH-NAME.            15316599
153166                                                                  15316699
153167     EXEC SQL                                                     15316799
153168       SELECT  PACK_BY_ST_IND                                     15316899
153169              ,REC_TMST                                           15316999
153170         INTO  :RECEIV-PACK-BY-ST-IND                             15317099
153171              ,:RECEIV-REC-TMST                                   15317199
153172         FROM  TRECEIV                                            15317299
153173        WHERE  ORD_NBR        = :SUATRN-TRN-NBR                   15317399
153174          AND  REC_SEQ_NBR    = :SUATRN-REC-SEQ-NBR               15317499
153175     END-EXEC.                                                    15317599
153176                                                                  15317699
153177     EVALUATE TRUE                                                15317799
153178       WHEN SQLCODE = ZEROS                                       15317899
153179         CONTINUE                                                 15317999
153180                                                                  15318099
153181       WHEN OTHER                                                 15318199
153182         DISPLAY PV-PARAGRAPH-NAME                                15318299
153183         DISPLAY 'TRAN NUMBER '  SUATRN-TRN-NBR                   15318399
153184         DISPLAY 'SEQ NUMBER  '  SUATRN-REC-SEQ-NBR               15318499
153185         PERFORM 9999-SQL-ABEND                                   15318599
153186     END-EVALUATE.                                                15318699
153187                                                                  15318799
153188******************************************************************15318899
153189*  CHECK THE PO AGREEMENT TABLE (TPOAGMT) TO SEE IF THIS IS A    *15318999
153190*  PACKED BY STORE ORDER.                                        *15319099
153191******************************************************************15319199
153192 1550-FETCH-TPOAGMT-INFO.                                         15319299
153193                                                                  15319399
153194     INITIALIZE PV-DB2-COUNT.                                     15319499
153195                                                                  15319599
153196     MOVE '1550-FETCH-TPOAGMT-INFO'                               15319699
153197                                 TO PV-PARAGRAPH-NAME.            15319799
153198                                                                  15319899
153199     EXEC SQL                                                     15319999
153200       SELECT  COUNT(*)                                           15320099
153201         INTO  :PV-DB2-COUNT                                      15320199
153202         FROM  TPOAGMT                                            15320299
153203        WHERE  PO_NBR         = :SUATRN-TRN-NBR                   15320399
153204          AND  AGRMT_TYP_ID   = '4'                               15320499
153205          AND  VER_STATUS_CDE = 'A'                               15320599
153206          AND  TYP_CDE        = 4                                 15320699
153207     END-EXEC.                                                    15320799
153208                                                                  15320899
153209     EVALUATE TRUE                                                15320999
153210       WHEN SQLCODE = ZEROS                                       15321099
153211         CONTINUE                                                 15321199
153212                                                                  15321299
153213       WHEN OTHER                                                 15321399
153214         DISPLAY PV-PARAGRAPH-NAME                                15321499
153215         DISPLAY 'TRAN NUMBER '  SUATRN-TRN-NBR                   15321599
153216         PERFORM 9999-SQL-ABEND                                   15321699
153217     END-EVALUATE.                                                15321799
153218                                                                  15321899
153219******************************************************************15321999
153220**  CALCULATE THE DURATION OF THE AUDIT                           15322099
153221******************************************************************15322199
153222 1600-CALC-DURATION.                                              15322299
153223                                                                  15322399
153224     INITIALIZE PV-AUDIT-DURATION-TIME.                           15322499
153225                                                                  15322599
153226     MOVE '1600-CALC-DURATION  ' TO PV-PARAGRAPH-NAME.            15322699
153227                                                                  15322799
153228     EXEC SQL                                                     15322899
153229       SELECT                                                     15322999
153230           ((DAY(UNT_AUD_STP_TMST) -                              15323099
153231                   DAY(UNT_AUD_STRT_TMST)) * 1440) +              15323199
153232           ((HOUR(UNT_AUD_STP_TMST) -                             15323299
153233                   HOUR(UNT_AUD_STRT_TMST)) * 60) +               15323399
153234            (MINUTE(UNT_AUD_STP_TMST) -                           15323499
153235                   MINUTE(UNT_AUD_STRT_TMST))                     15323599
153236         INTO                                                     15323699
153237             :PV-AUDIT-DURATION-TIME                              15323799
153238         FROM                                                     15323899
153239             TSUATRN                                              15323999
153240        WHERE                                                     15324099
153241             AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                      15324199
153242         AND SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                      15324299
153243     END-EXEC.                                                    15324399
153244                                                                  15324499
153245     EVALUATE TRUE                                                15324599
153246       WHEN SQLCODE = ZEROS                                       15324699
153247         CONTINUE                                                 15324799
153248       WHEN OTHER                                                 15324899
153249         DISPLAY PV-PARAGRAPH-NAME                                15324999
153250         DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR                  15325099
153251         DISPLAY 'SHIPT UNT ID ' DK-SHIPT-UNT-ID                  15325199
153252         PERFORM 9999-SQL-ABEND                                   15325299
153253     END-EVALUATE.                                                15325399
153254*                                                                 15325499
153255******************************************************************15325599
153256*  CALCULATE THE NUMBER OF EXPECTED UNITS FOR A SPECIFIED CARTON.*15325699
153257******************************************************************15325799
153258 1700-COUNT-EXPECTED-UNITS.                                       15325899
153259*                                                                 15325999
153260     INITIALIZE PV-EXPECTED-UNITS.                                15326099
153261                                                                  15326199
153262     MOVE '1700-COUNT-EXPECTED-UNITS'                             15326299
153263                                 TO PV-PARAGRAPH-NAME.            15326399
153264                                                                  15326499
153265     EXEC SQL                                                     15326599
153266       SELECT  SUM(SHPD_QTY)                                      15326699
153267         INTO  :PV-EXPECTED-UNITS :DN-EXP-UNTS                    15326799
153268         FROM  TSHUUPC                                            15326899
153269        WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                  15326999
153270     END-EXEC.                                                    15327099
153271                                                                  15327199
153272     EVALUATE TRUE                                                15327299
153273       WHEN SQLCODE = ZEROS                                       15327399
153274         IF DN-EXP-UNTS = -1                                      15327499
153275            MOVE ZEROES TO PV-EXPECTED-UNITS                      15327599
153276         END-IF                                                   15327699
153277       WHEN OTHER                                                 15327799
153278         DISPLAY PV-PARAGRAPH-NAME                                15327899
153279         DISPLAY 'SHIPT UNIT ID ' DK-SHIPT-UNT-ID                 15327999
153280         PERFORM 9999-SQL-ABEND                                   15328099
153281     END-EVALUATE.                                                15328199
153282                                                                  15328299
153283* 02/06/14 DRW BEG                                                15328399
153284******************************************************************15328499
153285*  CALCULATE THE NUMBER OF UNITS THAT WERE AUDITED FOR A         *15328599
153286*  SPECIFIED CARTON.                                             *15328699
153287******************************************************************15328799
153288*1800-COUNT-AUDITED-UNITS.                                        15328899
153289                                                                  15328999
153290*    INITIALIZE PV-AUDITED-UNITS.                                 15329099
153291*                                                                 15329199
153292*    MOVE '1800-COUNT-AUDITED-UNITS'                              15329299
153293*                                TO PV-PARAGRAPH-NAME.            15329399
153294*                                                                 15329499
153295*    EXEC SQL                                                     15329599
153296*      SELECT  SUM(SCND_UNT_QTY)                                  15329699
153297*        INTO  :PV-AUDITED-UNITS                                  15329799
153298*        FROM  TSUAUPC                                            15329899
153299*       WHERE  AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                  15329999
153300*         AND  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                  15330099
153301*         AND  SCN_TYP_CDE   <> :PC-E                             15330199
153302*    END-EXEC.                                                    15330299
153303*                                                                 15330399
153304*    EVALUATE TRUE                                                15330499
153305*      WHEN SQLCODE = ZEROS                                       15330599
153306*        MOVE PV-AUDITED-UNITS  TO PV-HL-AUDITED-UNITS            15330699
153307*      WHEN SQLCODE = -305                                        15330799
153308*        MOVE ZEROES            TO PV-HL-AUDITED-UNITS            15330899
153309*      WHEN OTHER                                                 15330999
153310*        DISPLAY PV-PARAGRAPH-NAME                                15331099
153311*        DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR                  15331199
153312*        DISPLAY 'SHIPT UNT ID ' DK-SHIPT-UNT-ID                  15331299
153313*        PERFORM 9999-SQL-ABEND                                   15331399
153314*    END-EVALUATE.                                                15331499
153315* 02/06/14 DRW END                                                15331599
153316                                                                  15331699
153317* 02/06/14 DRW BEG                                                15331799
153318******************************************************************15331899
153319*  CALCULATE THE NUMBER OF ROWS IN ERROR FOR A SPECIFIED CARTON. *15331999
153320******************************************************************15332099
153321 1850-COUNT-RFID-ERRORS.                                          15332199
153322                                                                  15332299
153323     INITIALIZE PV-AUDITED-UNITS.                                 15332399
153324                                                                  15332499
153325     MOVE '1850-COUNT-RFID-ERRORS'                                15332599
153326                                 TO PV-PARAGRAPH-NAME.            15332699
153327                                                                  15332799
153328     EXEC SQL                                                     15332899
153329       SELECT  COUNT(*)                                           15332999
153330         INTO  :PV-DB2-ROW-COUNT                                  15333099
153340         FROM  TSUAUPC A                                          15334099
153341              ,TSUEXCP B                                          15334199
153342        WHERE  A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                15334299
153343          AND  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                15334399
153344          AND  A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR                  15334499
153345          AND  A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  15334599
153346          AND  A.SCN_TMST       = B.SCN_TMST                      15334699
153347          AND  SCN_TYP_CDE     <> :PC-E                           15334799
153348     END-EXEC.                                                    15334899
153349                                                                  15334999
153350     EVALUATE TRUE                                                15335099
153351       WHEN SQLCODE = ZEROS                                       15335199
153352         CONTINUE                                                 15335299
153353       WHEN OTHER                                                 15335399
153354         DISPLAY PV-PARAGRAPH-NAME                                15335499
153355         DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR                  15335599
153356         DISPLAY 'SHIPT UNT ID ' DK-SHIPT-UNT-ID                  15335699
153357         PERFORM 9999-SQL-ABEND                                   15335799
153358     END-EVALUATE.                                                15335899
153359* 02/06/14 DRW END                                                15335999
153360                                                                  15336099
153361******************************************************************15336199
153362*  COUNT THE NUMBER OF CARTON LEVEL EXCEPTIONS THAT MAY EXIST    *15336299
153363*  FOR THIS CARTON.  CARTON LEVEL EXCEPTIONS ARE A VIOLATION     *15336399
153364*  CODE 1 (PO DIFF ON CARTON) AND VIOLATION CODE 2 (STR DIF ON   *15336499
153365*  CARTON).  IF ANY EXIST, THIS COUNT WILL BE ADDED TO THE TOTAL *15336599
153366*  ERRORS FIELD IN THE HEADING OF THE REPORT.                    *15336699
153367******************************************************************15336799
153368 1900-COUNT-CTN-LVL-ERRORS.                                       15336899
153369                                                                  15336999
153370     INITIALIZE PV-CTN-LVL-ERRORS.                                15337099
153371                                                                  15337199
153372     MOVE '1900-COUNT-CTN-LVL-ERRORS'                             15337299
153373                                 TO PV-PARAGRAPH-NAME.            15337399
153374                                                                  15337499
153375     EXEC SQL                                                     15337599
153376       SELECT  COUNT(*)                                           15337699
153377         INTO  :PV-CTN-LVL-ERRORS                                 15337799
153378         FROM  TSUEXCP                                            15337899
153379        WHERE  AUD_CNTL_NBR    = :DK-AUD-CNTL-NBR                 15337999
153380          AND  SHIPT_UNT_ID    = :DK-SHIPT-UNT-ID                 15338099
153381          AND  VILN_GP_CDE     = :PC-VA                           15338199
153382          AND  VILN_GP_SEQ_NBR IN (:PC-PO-DIFF-ON-CART-VILN       15338299
153383                                 , :PC-STR-DIF-ON-CART-VILN)      15338399
153384     END-EXEC.                                                    15338499
153385                                                                  15338599
153400     EVALUATE TRUE                                                15340099
153500       WHEN SQLCODE = ZEROS                                       15350099
153600       WHEN SQLCODE = +100                                        15360099
153700         CONTINUE                                                 15370099
153800       WHEN OTHER                                                 15380099
153900         DISPLAY PV-PARAGRAPH-NAME                                15390099
154000         DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR                  15400099
154100         DISPLAY 'SHIPT UNT ID ' DK-SHIPT-UNT-ID                  15410099
154200         PERFORM 9999-SQL-ABEND                                   15420099
154300     END-EVALUATE.                                                15430099
154400                                                                  15440099
154500                                                                  15450099
154700******************************************************************15470099
154800*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *15480099
154900*  VENDOR ACCURACY CARTON AUDIT -- CARTON AUDIT DETAIL REPORT    *15490099
155000******************************************************************15500099
155100 2000-PROCESS-SU.                                                 15510099
155400                                                                  15540099
155500     DISPLAY 'HOLD SKU NBR:     ' PV-HOLD-SKU-NBR.                15550099
155600                                                                  15560099
155700     IF  SU003-SKU-NBR OF SU003-COPYBOOK = PV-HOLD-SKU-NBR        15570099
155800             AND PV-HOLD-SKU-NBR NOT = ZERO                       15580099
155900         DISPLAY 'WENT IN HERE #1'                                15590099
156000         SET PS-DO-NOT-PRINT-SKU-INFO TO TRUE                     15600099
156100     ELSE                                                         15610099
156200         DISPLAY 'WENT IN HERE #2'                                15620099
156300         SET PS-PRINT-SKU-INFO                                    15630099
156400             PS-PRINT-SKU-ORD TO TRUE                             15640099
156500         MOVE SU003-SKU-NBR OF SU003-COPYBOOK TO                  15650099
156600              PV-HOLD-SKU-NBR                                     15660099
156610     END-IF.                                                      15661099
156700                                                                  15670099
156800     MOVE SU003-AUD-CNTL-NBR OF SU003-COPYBOOK                    15680099
156900                             TO DK-AUD-CNTL-NBR.                  15690099
157000     MOVE SU003-SHIPT-UNT-ID OF SU003-COPYBOOK                    15700099
157100                             TO DK-SHIPT-UNT-ID.                  15710099
157200     MOVE SU003-UPC          OF SU003-COPYBOOK                    15720099
157300                             TO DK-UPC-NBR.                       15730099
157400     SET PS-NO-ERROR-FOUND   TO TRUE.                             15740099
157500     SET PS-NOT-VENDOR-OVER                                       15750099
157600         PS-PRINT-UPC-INFO   TO TRUE.                             15760099
157700                                                                  15770099
157800     PERFORM 3200-FETCH-TSUAUPC-INFO.                             15780099
157900                                                                  15790099
158000**************************************************************    15800099
158100*    -CHECK IF THE QTY-EXPECTED > QTY-AUDITED -- THIS IS A   *    15810099
158200*     VENDOR SHORTAGE EXCEPTION                              *    15820099
158300*                                                            *    15830099
158400*    -CHECK IF THE QTY-EXPECTED < QTY-AUDITED AND THE        *    15840099
158500*     QTY-EXPECTED IS > 0 -- THIS IS A VENDOR OVERAGE        *    15850099
158600*     EXCEPTION.  IF THE QTY EXPECTED IS 0, THIS IS A        *    15860099
158700*     UPC MISPACK EXCEPTION WHICH HAS ALREADY BEEN NOTED     *    15870099
158800*     WHEN THE UNIT WAS SCANNED.                             *    15880099
158900**************************************************************    15890099
159000     IF  SU003-QTY-EXP OF SU003-COPYBOOK >                        15900099
159100         SU003-QTY-AUD OF SU003-COPYBOOK                          15910099
159110         AND CC-QC-AUDIT                                          15911099
159200         SET PS-ERROR-FOUND        TO TRUE                        15920099
159300         COMPUTE PV-OVER-SHORT-AMT =                              15930099
159400                     SU003-QTY-EXP OF SU003-COPYBOOK -            15940099
159500                     SU003-QTY-AUD OF SU003-COPYBOOK              15950099
159600         MOVE 'VENDOR SHORT'       TO DL1-VILN-CDE-SHRT-DESC      15960099
159700                                      PV-ERROR-DESC               15970099
159800         MOVE PV-OVER-SHORT-AMT    TO DL1-QTY-IN-ERROR            15980099
159900                                      PV-UNITS-IN-ERROR           15990099
160000                                      PV-ERROR-QTY                16000099
160100                                      PV-DL-EXCEPTION-COUNT       16010099
160101         MOVE ZERO                 TO SUEXCP-VILN-GP-SEQ-NBR      16010199
160102         MOVE 'UNT'                TO DL1-ERROR-TYPE              16010299
160103         IF  PS-PRINT-SKU-ORD                                     16010399
160200             PERFORM 2100-CHECK-SKU                               16020099
160300             MOVE PV-HOLD-QTY-AUD      TO PV-QTY-ORD-RCVD         16030099
160400             MOVE PV-QTY-ORD-RCVD-X    TO DL1-RECEIVED-AS-INFO    16040099
160500             MOVE PV-HOLD-QTY-EXP      TO PV-QTY-ORD-RCVD         16050099
160600             MOVE PV-QTY-ORD-RCVD-X    TO DL1-ORDERED-AS-INFO     16060099
160700             SET  PS-DO-NOT-PRINT-SKU-ORD TO TRUE                 16070099
160800         ELSE                                                     16080099
160900             MOVE SPACES               TO DL1-RECEIVED-AS-INFO    16090099
161000             MOVE SPACES               TO DL1-ORDERED-AS-INFO     16100099
161100         END-IF                                                   16110099
161200*        PERFORM 3100-SETUP-DETAIL-LINES                          16120099
161400     ELSE                                                         16140099
161500         IF  SU003-QTY-EXP OF SU003-COPYBOOK <                    16150099
161600             SU003-QTY-AUD OF SU003-COPYBOOK                      16160099
161610             AND CC-QC-AUDIT                                      16161099
161700             IF  SU003-QTY-EXP OF SU003-COPYBOOK > 0              16170099
161800                 SET PS-ERROR-FOUND                               16180099
161900                                   TO TRUE                        16190099
162000                 COMPUTE PV-OVER-SHORT-AMT =                      16200099
162100                             SU003-QTY-AUD OF SU003-COPYBOOK -    16210099
162200                             SU003-QTY-EXP OF SU003-COPYBOOK      16220099
162300                 MOVE 'VENDOR OVER'                               16230099
162400                                   TO DL1-VILN-CDE-SHRT-DESC      16240099
162500                                      PV-ERROR-DESC               16250099
162600                 MOVE PV-OVER-SHORT-AMT                           16260099
162700                                   TO DL1-QTY-IN-ERROR            16270099
162800                                      PV-UNITS-IN-ERROR           16280099
162900                                      PV-ERROR-QTY                16290099
163000                                      PV-DL-EXCEPTION-COUNT       16300099
163001                 MOVE ZERO         TO SUEXCP-VILN-GP-SEQ-NBR      16300199
163002                 MOVE 'UNT'        TO DL1-ERROR-TYPE              16300299
163003                 IF  PS-PRINT-SKU-ORD                             16300399
163100                     PERFORM 2100-CHECK-SKU                       16310099
163200                     MOVE PV-HOLD-QTY-AUD                         16320099
163300                                       TO PV-QTY-ORD-RCVD         16330099
163400                     MOVE PV-QTY-ORD-RCVD-X                       16340099
163500                                       TO DL1-RECEIVED-AS-INFO    16350099
163600                     MOVE PV-HOLD-QTY-EXP                         16360099
163700                                       TO PV-QTY-ORD-RCVD         16370099
163800                     MOVE PV-QTY-ORD-RCVD-X                       16380099
163900                                       TO DL1-ORDERED-AS-INFO     16390099
164000                     SET  PS-DO-NOT-PRINT-SKU-ORD TO TRUE         16400099
164100                 ELSE                                             16410099
164200                     MOVE SPACES    TO DL1-RECEIVED-AS-INFO       16420099
164300                     MOVE SPACES    TO DL1-ORDERED-AS-INFO        16430099
164400                 END-IF                                           16440099
164500*                PERFORM 3100-SETUP-DETAIL-LINES                  16450099
164700             ELSE                                                 16470099
164800                 SET PS-ERROR-FOUND                               16480099
164900                                   TO TRUE                        16490099
165000                 COMPUTE PV-OVER-SHORT-AMT =                      16500099
165100                             SU003-QTY-AUD OF SU003-COPYBOOK -    16510099
165200                             SU003-QTY-EXP OF SU003-COPYBOOK      16520099
165300                 MOVE 'VND OVER/MISPCK'                           16530099
165400                                   TO DL1-VILN-CDE-SHRT-DESC      16540099
165500                                      PV-ERROR-DESC               16550099
165600                 MOVE PV-OVER-SHORT-AMT                           16560099
165700                                   TO DL1-QTY-IN-ERROR            16570099
165800                                      PV-UNITS-IN-ERROR           16580099
165900                                      PV-ERROR-QTY                16590099
166000                                      PV-DL-EXCEPTION-COUNT       16600099
166001                 MOVE ZERO         TO SUEXCP-VILN-GP-SEQ-NBR      16600199
166002                 MOVE 'UNT'        TO DL1-ERROR-TYPE              16600299
166003                 IF  PS-PRINT-SKU-ORD                             16600399
166100                     PERFORM 2100-CHECK-SKU                       16610099
166200                     IF  DL1-VILN-CDE-SHRT-DESC =                 16620099
166300                         'VND OVER/MISPCK'                        16630099
166400                     AND PV-HOLD-QTY-EXP > 0                      16640099
166500                         MOVE 'VENDOR OVER    '                   16650099
166600                              TO DL1-VILN-CDE-SHRT-DESC           16660099
166700                                 PV-ERROR-DESC                    16670099
166800                         MOVE PV-HOLD-QTY-EXP TO PV-ERROR-QTY     16680099
166900                                      PV-DL-EXCEPTION-COUNT       16690099
166901                         MOVE ZERO TO SUEXCP-VILN-GP-SEQ-NBR      16690199
166902                     END-IF                                       16690299
166903                     MOVE PV-HOLD-QTY-AUD                         16690399
167000                              TO PV-QTY-ORD-RCVD                  16700099
167100                     MOVE PV-QTY-ORD-RCVD-X                       16710099
167200                              TO DL1-RECEIVED-AS-INFO             16720099
167300                     MOVE PV-HOLD-QTY-EXP                         16730099
167400                              TO PV-QTY-ORD-RCVD                  16740099
167500                     MOVE PV-QTY-ORD-RCVD-X                       16750099
167600                              TO DL1-ORDERED-AS-INFO              16760099
167700                     SET  PS-DO-NOT-PRINT-SKU-ORD TO TRUE         16770099
167800                 ELSE                                             16780099
167900                     MOVE SPACES    TO DL1-RECEIVED-AS-INFO       16790099
168000                     MOVE SPACES    TO DL1-ORDERED-AS-INFO        16800099
168100                     PERFORM 2100-CHECK-SKU                       16810099
168200                     IF  DL1-VILN-CDE-SHRT-DESC =                 16820099
168300                         'VND OVER/MISPCK'                        16830099
168400                     AND PV-HOLD-QTY-EXP > 0                      16840099
168500                         MOVE 'VENDOR OVER    '                   16850099
168600                              TO DL1-VILN-CDE-SHRT-DESC           16860099
168700                                 PV-ERROR-DESC                    16870099
168800                         MOVE PV-HOLD-QTY-EXP TO PV-ERROR-QTY     16880099
168900                                      PV-DL-EXCEPTION-COUNT       16890099
168901                         MOVE ZERO TO SUEXCP-VILN-GP-SEQ-NBR      16890199
168902                     END-IF                                       16890299
168903                 END-IF                                           16890399
169000*                PERFORM 3100-SETUP-DETAIL-LINES                  16900099
169200             END-IF                                               16920099
169300         END-IF                                                   16930099
169400     END-IF.                                                      16940099
169500     IF PS-ERROR-FOUND AND CC-QC-AUDIT                            16950099
169600         PERFORM 3100-SETUP-DETAIL-LINES                          16960099
169700         PERFORM 4100-WRITE-EXCEPTIONS                            16970099
169800     END-IF.                                                      16980099
169900                                                                  16990099
169901     PERFORM 4000-CHECK-EXCEPTIONS.                               16990199
169902                                                                  16990299
169903*    PERFORM 7100-OPEN-EXCEPTIONS-CSR.                            16990399
169904*    PERFORM 7120-FETCH-EXCEPTIONS-CSR.                           16990499
169905                                                                  16990599
169906*    PERFORM 3000-PROCESS-UPC-EXCEPTIONS                          16990699
170000*        UNTIL PS-END-OF-EXCEPTIONS-CSR.                          17000099
170100                                                                  17010099
170200*    PERFORM 7110-CLOSE-EXCEPTIONS-CSR.                           17020099
170300     PERFORM 7050-READ-AUD-UPC-EXTRACT.                           17030099
170400                                                                  17040099
170500                                                                  17050099
170700******************************************************************17070099
170800*  CHECK THE SKU TO DETERMINE IF THE SKU IS EQUAL TO ZERO.  IF   *17080099
170900*  IT IS, USE THE EXPECTED AND AUDITED QUANTITIES FROM THE       *17090099
171000*  VENDOR OVER/SHORT FILE, OTHERWISE WORK WITH THE SKU SUMMARY   *17100099
171100*  FILE TO TRY TO GET THE EXPECTED AND AUDITED FOR THE SKU.      *17110099
171200******************************************************************17120099
171210 2100-CHECK-SKU.                                                  17121099
171300                                                                  17130099
171400     IF  SU003-SKU-DEPT-NBR OF SU003-COPYBOOK = '000'             17140099
171500         MOVE SU003-QTY-AUD OF SU003-COPYBOOK                     17150099
171600                                  TO PV-HOLD-QTY-AUD              17160099
171700         MOVE SU003-QTY-EXP OF SU003-COPYBOOK                     17170099
171800                                  TO PV-HOLD-QTY-EXP              17180099
171900     ELSE                                                         17190099
172000         PERFORM 2200-FIND-SKU                                    17200099
172100     END-IF.                                                      17210099
172200                                                                  17220099
172300                                                                  17230099
172500******************************************************************17250099
172600*  REPLACED SU003-SKU-SEQ-NBR OF SU003-COPYBOOK WITH SU003-SKU-  *17260099
172700*  NMBR OF SU003-COPYBOOK AND PV-OSF-SKU-SEQ-NBR WITH PV-OSF-SKU-*17270099
172800*  NBR.                                            WR # 21361    *17280099
172900******************************************************************17290099
173000******************************************************************17300099
173100* 2200-FIND-SKU                                                   17310099
173200*  THIS PARAGRAPH WILL ATTEMPT TO GET THE AUDITED AND EXPECTED    17320099
173300*  QUANTITY FOR THE SKU FOR THE ASSOCIATED UPC BEING PROCESSED    17330099
173400*  FROM THE DRIVER FILE.                                          17340099
173500******************************************************************17350099
173510 2200-FIND-SKU.                                                   17351099
173600                                                                  17360099
173700     IF  PS-EOF-SKU-TOTAL-FILE                                    17370099
173800         MOVE SU003-QTY-AUD  OF SU003-COPYBOOK                    17380099
173900                                  TO PV-HOLD-QTY-AUD              17390099
174000         MOVE SU003-QTY-EXP  OF SU003-COPYBOOK                    17400099
174100                                  TO PV-HOLD-QTY-EXP              17410099
174200     ELSE                                                         17420099
174300         IF  SU003-AUD-CNTL-NBR  OF SU003-COPYBOOK =              17430099
174400             SU003-AUD-CNTL-NBR  OF OS-SKU-FILE                   17440099
174500         AND SU003-PO-NBR        OF SU003-COPYBOOK =              17450099
174600             SU003-PO-NBR        OF OS-SKU-FILE                   17460099
174700         AND SU003-REC-SEQ-NBR   OF SU003-COPYBOOK =              17470099
174800             SU003-REC-SEQ-NBR   OF OS-SKU-FILE                   17480099
174900         AND SU003-SHIPT-UNT-ID  OF SU003-COPYBOOK =              17490099
175000             SU003-SHIPT-UNT-ID  OF OS-SKU-FILE                   17500099
175100         AND SU003-SKU-NBR       OF SU003-COPYBOOK =              17510099
175200             SU003-SKU-NBR       OF OS-SKU-FILE                   17520099
175300             MOVE SU003-QTY-AUD  OF OS-SKU-FILE                   17530099
175400                                      TO PV-HOLD-QTY-AUD          17540099
175500             MOVE SU003-QTY-EXP  OF OS-SKU-FILE                   17550099
175600                                      TO PV-HOLD-QTY-EXP          17560099
175700         ELSE                                                     17570099
175800             SET PS-SKU-SEARCH-PROCESS TO TRUE                    17580099
175900             MOVE SU003-AUD-CNTL-NBR  OF SU003-COPYBOOK           17590099
176000               TO PV-OSF-AUD-CNTL-NBR                             17600099
176100             MOVE SU003-PO-NBR        OF SU003-COPYBOOK           17610099
176200               TO PV-OSF-PO-NBR                                   17620099
176300             MOVE SU003-REC-SEQ-NBR   OF SU003-COPYBOOK           17630099
176400               TO PV-OSF-REC-SEQ-NBR                              17640099
176500             MOVE SU003-SHIPT-UNT-ID  OF SU003-COPYBOOK           17650099
176600               TO PV-OSF-SHIPT-UNT-ID                             17660099
176700             MOVE SU003-SKU-DEPT-NBR  OF SU003-COPYBOOK           17670099
176800               TO PV-OSF-SKU-DEPT-NBR                             17680099
176900             MOVE SU003-SKU-CL-NBR    OF SU003-COPYBOOK           17690099
177000               TO PV-OSF-SKU-CL-NBR                               17700099
177100             MOVE SU003-SKU-NMBR      OF SU003-COPYBOOK           17710099
177200               TO PV-OSF-SKU-NBR                                  17720099
177300             PERFORM 5300-PROCESS-SKU-TOT-FILE                    17730099
177400                 UNTIL PS-SKU-MATCH.                              17740099
177500******************************************************************17750099
177600*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *17760099
177700******************************************************************17770099
177800                                                                  17780099
177900* 02/06/14 DRW BEG ADDED                                          17790099
178000******************************************************************17800099
178100* 3170-CHECK-COMBO                                                17810099
178200*    THIS PARAGRAPH WILL CHECK IF THE AUDIT WAS PART OF A COMBO   17820099
178300*    AUDIT OR NOT.                                                17830099
178400******************************************************************17840099
178500 3170-CHECK-COMBO.                                                17850099
178600                                                                  17860099
178700     IF HL9A-PROMPTED-AUDIT                                       17870099
178800*       SYSTEM GENERATED AUDIT                                    17880099
178900        IF SUT00015-PKGNG-TYP-CDE = 'RF'                          17890099
179000*          RFID AUDIT                                             17900099
179100           INITIALIZE PV-COUNT                                    17910099
179200           PERFORM 3180-CHECK-REWORK-AUD                          17920099
179300           IF PV-COUNT > 0                                        17930099
179400*             AUDIT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT     17940099
179500              SET HL10A-COMBO   TO TRUE                           17950099
179600           ELSE                                                   17960099
179700*             AUDIT NOT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT 17970099
179800              SET HL10A-NOT-COMBO TO TRUE                         17980099
179900           END-IF                                                 17990099
180000        ELSE                                                      18000099
180100*          QC AUDIT                                               18010099
180200           IF SUT00015-RWRK-AUD-CNTL-NBR > 0                      18020099
180300*             PART OF COMBO                                       18030099
180400              SET HL10A-COMBO   TO TRUE                           18040099
180500           ELSE                                                   18050099
180600*             NOT PART OF COMBO                                   18060099
180700              SET HL10A-NOT-COMBO TO TRUE                         18070099
180800           END-IF                                                 18080099
180900        END-IF                                                    18090099
181000     ELSE                                                         18100099
181100*       MANUAL AUDIT                                              18110099
181200        PERFORM 3190-CHECK-PO-EXCEPTION                           18120099
181300        PERFORM 3195-CHECK-VENDOR-TAGGING                         18130099
181400        IF PS-VENDOR-TAGGING                                      18140099
181500        OR PS-VENDOR-COMPLIANT                                    18150099
181600          PERFORM 3185-CHECK-FOR-RFID-DEPT                        18160099
181700        END-IF                                                    18170099
181800        IF PS-PO-EXCEPTION                                        18180099
181900*          THERE ARE PO EXCEPTIONS DEFINED FOR PO/DC              18190099
182000           EVALUATE SUT00014-AUD-TYP-CDE                          18200099
182100             WHEN 'Q'                                             18210099
182200             WHEN 'R'                                             18220099
182300*                 QC/RF ONLY EXCEPTION DEFINED                    18230099
182400                  SET HL10A-NOT-COMBO   TO TRUE                   18240099
182500             WHEN 'A'                                             18250099
182600*                 100% EXCEPTION DEFINED                          18260099
182700                  IF (PS-VENDOR-TAGGING                           18270099
182800                  OR  PS-VENDOR-COMPLIANT) AND PS-RFID-DEPT-YES   18280099
182900*                    VENDOR IS RFID TAGGING OR COMPLIANT          18290099
183000                     SET HL10A-COMBO   TO TRUE                    18300099
183100                  ELSE                                            18310099
183200*                    VENDOR IS NOT RFID TAGGING OR COMPLIANT      18320099
183300                     SET HL10A-NOT-COMBO   TO TRUE                18330099
183400                  END-IF                                          18340099
183500             WHEN 'N'                                             18350099
183600*                 NONE EXCEPTION DEFINED                          18360099
183700                  IF  PS-VENDOR-TAGGING                           18370099
183800                  AND PS-RFID-DEPT-YES                            18380099
183900*                    VENDOR IS RFID TAGGING                       18390099
184000                     SET HL10A-COMBO   TO TRUE                    18400099
184100                  ELSE                                            18410099
184200*                    VENDOR IS NOT RFID TAGGING                   18420099
184300                     SET HL10A-NOT-COMBO   TO TRUE                18430099
184400                  END-IF                                          18440099
184500           END-EVALUATE                                           18450099
184600        ELSE                                                      18460099
184700*          THERE ARE NO PO EXCEPTIONS DEFINED FOR PO/DC           18470099
184800           IF  PS-VENDOR-TAGGING                                  18480099
184900           AND PS-RFID-DEPT-YES                                   18490099
185000*             VENDOR IS RFID TAGGING                              18500099
185100              SET HL10A-COMBO   TO TRUE                           18510099
185200           ELSE                                                   18520099
185300*             VENDOR IS NOT RFID TAGGING                          18530099
185400              SET HL10A-NOT-COMBO   TO TRUE                       18540099
185500           END-IF                                                 18550099
185600        END-IF                                                    18560099
185700     END-IF.                                                      18570099
185800                                                                  18580099
185900******************************************************************18590099
186000* 3180-CHECK-REWORK-AUD.                                          18600099
186100*    THIS PARAGRAPH WILL CHECK IF THE RFID AUDIT IS PRESENT IN THE18610099
186200*    REWORK AUDIT CONTROL NUMBER FOR ANY OTHER AUDIT. IF SO, IT   18620099
186300*    WILL BE A COMBO.                                             18630099
186400******************************************************************18640099
186500 3180-CHECK-REWORK-AUD.                                           18650099
186600                                                                  18660099
186700     EXEC SQL                                                     18670099
186800         SELECT VALUE(COUNT(*), 0)                                18680099
186900           INTO :PV-COUNT                                         18690099
187000           FROM SUT_PO_AUD_REQ                                    18700099
187100          WHERE RWRK_AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              18710099
187200     END-EXEC.                                                    18720099
187300                                                                  18730099
187400     EVALUATE TRUE                                                18740099
187500         WHEN SQLCODE = ZERO                                      18750099
187600         WHEN SQLCODE = +100                                      18760099
187700         WHEN SQLCODE = -811                                      18770099
187800              CONTINUE                                            18780099
187900                                                                  18790099
188000         WHEN SQLWARN0 NOT = SPACES                               18800099
188100         WHEN SQLCODE < +0                                        18810099
188200         WHEN SQLCODE > ZERO                                      18820099
188300            MOVE '3180-CHECK-REWORK-AUD'                          18830099
188400                                   TO  PV-PARAGRAPH-NAME          18840099
188500            DISPLAY 'DK-AUD-CNTL-NBR=' DK-AUD-CNTL-NBR            18850099
188600            PERFORM 9999-SQL-ABEND                                18860099
188700     END-EVALUATE.                                                18870099
188800                                                                  18880099
188900*JA 04/28/14 - BEGIN                                              18890099
189000******************************************************************18900099
189100 3185-CHECK-FOR-RFID-DEPT.                                        18910099
189200                                                                  18920099
189300     EXEC SQL                                                     18930099
189400          SELECT 'Y'                                              18940099
189500            INTO :PS-RFID-DEPT-IND                                18950099
189600            FROM RIT_RFID_VRFN                                    18960099
189700           WHERE RFID_LVL_CDE = 'STRDPT'                          18970099
189800             AND DEPT_NBR     = :DK-DEPT-NBR                      18980099
189900             AND (CURRENT TIMESTAMP BETWEEN EFF_STRT_TMST         18990099
190000                                        AND EFF_END_TMST)         19000099
190100           FETCH FIRST ROW ONLY                                   19010099
190200     END-EXEC.                                                    19020099
190300                                                                  19030099
190400     EVALUATE TRUE                                                19040099
190500         WHEN SQLCODE = +0                                        19050099
190600         WHEN SQLCODE = -811                                      19060099
190700             SET PS-RFID-DEPT-YES TO TRUE                         19070099
190800                                                                  19080099
190900         WHEN SQLCODE = +100                                      19090099
191000             SET PS-RFID-DEPT-NO  TO TRUE                         19100099
191100                                                                  19110099
191200         WHEN SQLWARN0 NOT = SPACES                               19120099
191300         WHEN SQLCODE NOT EQUAL ZERO                              19130099
191400             MOVE '3185-CHECK-FOR-RFID-DEPT'                      19140099
191500                             TO PV-PARAGRAPH-NAME                 19150099
191600             DISPLAY ' DEPT-NBR= ' DK-DEPT-NBR                    19160099
191700            PERFORM 9999-SQL-ABEND                                19170099
191800     END-EVALUATE.                                                19180099
191900*JA 04/28/14 - END                                                19190099
192000                                                                  19200099
192100******************************************************************19210099
192200 3190-CHECK-PO-EXCEPTION.                                         19220099
192300                                                                  19230099
192508     EXEC SQL                                                     19250899
192509       SELECT X.SQL_ID                                            19250999
192510            , X.AUD_TYP_CDE                                       19251099
192511            , X.PO_LNE_NBR                                        19251199
192512            , X.PO_PREPK_ID                                       19251299
192513         INTO     :PV-UNION-TYPE                                  19251399
192514                , :SUT00014-AUD-TYP-CDE                           19251499
192515                , :PURITM-PO-LNE-NBR                              19251599
192516                , :PURITM-PO-PREPK-ID                             19251699
192517         FROM                                                     19251799
192518                                                                  19251899
192519        (SELECT 'A' as SQL_ID                                     19251999
192520                  , C.AUD_TYP_CDE                                 19252099
192521                  , 0 AS PO_LNE_NBR                               19252199
192522                  , B.PO_PREPK_ID                                 19252299
192523           FROM  TPURCHS A                                        19252399
192524               , TPURITM B                                        19252499
192525               , SUT_PO_AUD_EXC C                                 19252599
192526           WHERE A.PO_NBR = :DK-PO-NBR                            19252699
192527             AND A.VER_STATUS_CDE = 'A'                           19252799
192528             AND A.PKGNG_CDE = 'M'                                19252899
192529             AND B.PO_NBR = A.PO_NBR                              19252999
192530             AND B.VER_STATUS_CDE = 'A'                           19253099
192531             AND B.RMS_PO_SKU_NBR = :DK-SKU-NBR                   19253199
192532             AND B.PO_PREPK_ID > 0                                19253299
192533             AND C.PO_NBR = A.PO_NBR                              19253399
192534             AND C.PO_PREPK_ID = B.PO_PREPK_ID                    19253499
192535             AND C.OPER_UNT_ID = :SUNAUD-OPER-UNT-ID              19253599
192536           UNION ALL                                              19253699
192537             SELECT 'B' as SQL_ID                                 19253799
192538               , C.AUD_TYP_CDE                                    19253899
192539               , B.PO_LNE_NBR                                     19253999
192540               , 0 AS PO_PREPK_ID                                 19254099
192541           FROM  TPURCHS A                                        19254199
192542               , TPURITM B                                        19254299
192543               , SUT_PO_AUD_EXC C                                 19254399
192544           WHERE A.PO_NBR = :DK-PO-NBR                            19254499
192545             AND A.VER_STATUS_CDE = 'A'                           19254599
192546             AND NOT A.PKGNG_CDE = 'M'                            19254699
192547             AND B.PO_NBR = A.PO_NBR                              19254799
192548             AND B.VER_STATUS_CDE = 'A'                           19254899
192549             AND B.RMS_PO_SKU_NBR = :DK-SKU-NBR                   19254999
192550             AND C.PO_NBR = A.PO_NBR                              19255099
192551             AND C.PO_LNE_NBR = B.PO_LNE_NBR                      19255199
192552             AND C.OPER_UNT_ID = :SUNAUD-OPER-UNT-ID              19255299
192553           UNION ALL                                              19255399
192554             SELECT 'C'  as SQL_ID                                19255499
192555                 , C.AUD_TYP_CDE                                  19255599
192556                 , 0 AS PO_LNE_NBR                                19255699
192557                 , 0 AS PO_PREPK_ID                               19255799
192558             FROM TPURCHS A                                       19255899
192559             ,    SUT_PO_AUD_EXC C                                19255999
192560             WHERE A.PO_NBR = :DK-PO-NBR                          19256099
192561               AND A.VER_STATUS_CDE = 'A'                         19256199
192562               AND C.PO_NBR = A.PO_NBR                            19256299
192563               AND C.PO_LNE_NBR = 0                               19256399
192564               AND C.PO_PREPK_ID = 0                              19256499
192565               AND C.OPER_UNT_ID = :SUNAUD-OPER-UNT-ID            19256599
192566           ORDER BY 1, 2, 3, 4                                    19256699
192567          FETCH FIRST 1 ROW ONLY ) AS X                           19256799
192568     END-EXEC.                                                    19256899
192574                                                                  19257499
192575     EVALUATE SQLCODE                                             19257599
192576         WHEN 0                                                   19257699
192577             SET PS-PO-EXCEPTION    TO TRUE                       19257799
192578                                                                  19257899
192590         WHEN 100                                                 19259099
192600             SET PS-NO-PO-EXCEPTION TO TRUE                       19260099
192700                                                                  19270099
192800         WHEN OTHER                                               19280099
192900            MOVE '3190-CHECK-PO-EXCEPTION'                        19290099
193000                                    TO PV-PARAGRAPH-NAME          19300099
193100            DISPLAY 'AUDIT NUMBER=        '                       19310099
193200                                       DK-AUD-CNTL-NBR            19320099
193300            DISPLAY 'PO-NBR=     '                                19330099
193400                                       DK-PO-NBR                  19340099
193700            DISPLAY 'DEST-OPER-UNT-ID'                            19370099
193800                                       SUATRN-DEST-OPER-UNT-ID    19380099
193810            DISPLAY 'DK-SKU-NBR      '                            19381099
193820                                       DK-SKU-NBR                 19382099
193900            PERFORM 9999-SQL-ABEND                                19390099
194000     END-EVALUATE.                                                19400099
194100                                                                  19410099
194200******************************************************************19420099
194300 3195-CHECK-VENDOR-TAGGING.                                       19430099
194400                                                                  19440099
194500     INITIALIZE DCLTPURCHS                                        19450099
194600                DCLTVNDAGR.                                       19460099
194700                                                                  19470099
194800     MOVE SUATRN-TRN-NBR  TO PURCHS-PO-NBR.                       19480099
194900                                                                  19490099
195000     EXEC SQL                                                     19500099
195100         SELECT  DEPT_NBR                                         19510099
195200                ,ENT_ID                                           19520099
195300           INTO :PURCHS-DEPT-NBR                                  19530099
195400               ,:PURCHS-ENT-ID                                    19540099
195500           FROM TPURCHS                                           19550099
195600          WHERE PO_NBR = :PURCHS-PO-NBR                           19560099
195700            AND VER_STATUS_CDE = 'A'                              19570099
195800     END-EXEC.                                                    19580099
195900                                                                  19590099
196000     EVALUATE SQLCODE                                             19600099
196100        WHEN 0                                                    19610099
196200             MOVE PURCHS-DEPT-NBR TO VNDAGR-DEPT-NBR              19620099
196300             MOVE PURCHS-ENT-ID   TO VNDAGR-ENT-ID                19630099
196400             EXEC SQL                                             19640099
196500                  SELECT TYP_CDE                                  19650099
196600                    INTO :VNDAGR-TYP-CDE                          19660099
196700                    FROM TVNDAGR                                  19670099
196800                   WHERE ENT_ID          = :VNDAGR-ENT-ID         19680099
196900                     AND DEPT_NBR        = :VNDAGR-DEPT-NBR       19690099
197000                     AND AGRMT_TYP_ID    = '4'                    19700099
197100                     AND TYP_CDE         IN (11,12)               19710099
197200                     AND EFFECTIVE_DATE <= CURRENT DATE           19720099
197300                     AND EXPIRATION_DATE > CURRENT DATE           19730099
197400                   ORDER BY TYP_CDE                               19740099
197500                   FETCH FIRST 1 ROW ONLY                         19750099
197600             END-EXEC                                             19760099
197700                                                                  19770099
197800             EVALUATE SQLCODE                                     19780099
197900                WHEN 0                                            19790099
198000                     IF VNDAGR-TYP-CDE = 11                       19800099
198100                        SET PS-VENDOR-TAGGING     TO TRUE         19810099
198200                     ELSE                                         19820099
198300                        SET PS-VENDOR-COMPLIANT   TO TRUE         19830099
198400                     END-IF                                       19840099
198500                                                                  19850099
198600                WHEN 100                                          19860099
198700                     SET PS-VENDOR-NOT-TAGGING    TO TRUE         19870099
198800                                                                  19880099
198900                WHEN OTHER                                        19890099
199000                     MOVE '3195-CHECK-VENDOR-TAGGING'             19900099
199100                                    TO  PV-PARAGRAPH-NAME         19910099
199200                     DISPLAY 'AUDIT NUMBER= ' DK-AUD-CNTL-NBR     19920099
199300                     PERFORM 9999-SQL-ABEND                       19930099
199400             END-EVALUATE                                         19940099
199500                                                                  19950099
199600        WHEN 100                                                  19960099
199700             SET PS-VENDOR-NOT-TAGGING TO TRUE                    19970099
199800                                                                  19980099
199900        WHEN OTHER                                                19990099
200000            MOVE '3195-CHECK-VENDOR-TAGGING'                      20000099
200100                                   TO PV-PARAGRAPH-NAME           20010099
200200            DISPLAY 'AUDIT NUMBER= '  DK-AUD-CNTL-NBR             20020099
200300            DISPLAY 'PURCHS-PO-NBR=' PURCHS-PO-NBR                20030099
200400            PERFORM 9999-SQL-ABEND                                20040099
200500     END-EVALUATE.                                                20050099
200600*JA 03/19/14 - END PR#5148D                                       20060099
200700                                                                  20070099
200800*JA 04/01/14 - BEGIN                                              20080099
200900******************************************************************20090099
201000* 3200-CHECK-RFID-ERRORS.                                        *20100099
201100******************************************************************20110099
201200 3200-CHECK-RFID-ERRORS.                                          20120099
201300                                                                  20130099
201400     INITIALIZE PV-HOLD-TMST.                                     20140099
201500     PERFORM 3210-OPEN-RFID-CURSOR.                               20150099
201600                                                                  20160099
201700     PERFORM 3220-FETCH-RFID-CURSOR.                              20170099
201800                                                                  20180099
201900     PERFORM UNTIL PS-END-OF-RFID-CURSOR                          20190099
202000         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          20200099
202100*         ADD THE QUANTITY TO THE TOTAL ERROR BUCKET              20210099
202200           WHEN PC-RFID-UPC-MISPK-VILN                            20220099
202300               COMPUTE PV-HL-TOTAL-ERRORS =                       20230099
202400                       PV-HL-TOTAL-ERRORS + 1                     20240099
202500                                                                  20250099
202600           WHEN PC-WRG-RFID-CLR-VILN                              20260099
202700               COMPUTE PV-HL-TOTAL-ERRORS =                       20270099
202800                       PV-HL-TOTAL-ERRORS + PV-RFID-COUNT         20280099
202900               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    20290099
203000               END-COMPUTE                                        20300099
203100                                                                  20310099
203200           WHEN PC-WRG-RFID-SIZE-VILN                             20320099
203300               COMPUTE PV-HL-TOTAL-ERRORS =                       20330099
203400                       PV-HL-TOTAL-ERRORS + PV-RFID-COUNT         20340099
203500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    20350099
203600               END-COMPUTE                                        20360099
203700                                                                  20370099
203800           WHEN PC-WRG-RFID-STYLE-VILN                            20380099
203900               COMPUTE PV-HL-TOTAL-ERRORS =                       20390099
204000                       PV-HL-TOTAL-ERRORS + PV-RFID-COUNT         20400099
204100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    20410099
204200               END-COMPUTE                                        20420099
204201                                                                  20420199
204202           WHEN PC-NO-RFID-TKT-VILN                               20420299
204203               COMPUTE PV-DB2-COUNT =                             20420399
204204                       PV-DB2-COUNT - PV-RFID-COUNT               20420499
204205               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    20420599
204206               END-COMPUTE                                        20420699
204207               COMPUTE PV-HL-TOTAL-ERRORS =                       20420799
204208                       PV-HL-TOTAL-ERRORS + PV-DB2-COUNT          20420899
204209               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    20420999
204210               END-COMPUTE                                        20421099
204220                                                                  20422099
204230         END-EVALUATE                                             20423099
204240                                                                  20424099
204250         IF SUEXCP-SCN-TMST NOT EQUAL PV-HOLD-TMST                20425099
204260            EVALUATE SUEXCP-VILN-GP-SEQ-NBR                       20426099
204270*           ADD THE QUANTITY TO THE UNITS IN ERROR BUCKET         20427099
204280             WHEN PC-VA-NO-EPC-LOGO                               20428099
204290                  ADD PV-DB2-COUNT   TO PV-HL-UNITS-IN-ERROR      20429099
204300                                                                  20430099
204400*            WHEN PC-RFID-UPC-MISPCK                              20440099
204500*                 ADD  1             TO PV-HL-UNITS-IN-ERROR      20450099
204600                                                                  20460099
204700             WHEN OTHER                                           20470099
204800                  ADD PV-RFID-COUNT  TO PV-HL-UNITS-IN-ERROR      20480099
204900            END-EVALUATE                                          20490099
205000            MOVE SUEXCP-SCN-TMST     TO PV-HOLD-TMST              20500099
205100         END-IF                                                   20510099
205200                                                                  20520099
205300         PERFORM 3220-FETCH-RFID-CURSOR                           20530099
205400                                                                  20540099
205500     END-PERFORM.                                                 20550099
205600                                                                  20560099
205700     PERFORM 3225-CLOSE-RFID-CURSOR.                              20570099
205800*                                                                 20580099
205900******************************************************************20590099
206000* 3210-OPEN-RFID-CURSOR.                                         *20600099
206100*  THIS PROCEDURE WILL OPEN THE RFID CURSOR.                     *20610099
206200******************************************************************20620099
206300 3210-OPEN-RFID-CURSOR.                                           20630099
206400                                                                  20640099
206500     EXEC SQL                                                     20650099
206600          OPEN RFID_CURSOR                                        20660099
206700     END-EXEC.                                                    20670099
206800                                                                  20680099
206900     EVALUATE TRUE                                                20690099
207000         WHEN SQLCODE = ZERO                                      20700099
207100              SET PS-NOT-END-OF-RFID-CURSOR TO TRUE               20710099
207200                                                                  20720099
207300         WHEN SQLWARN0 NOT EQUAL SPACE                            20730099
207400         WHEN SQLCODE NOT EQUAL ZERO                              20740099
207500              MOVE '3210-OPEN-RFID-CURSOR'                        20750099
207600                               TO  PV-PARAGRAPH-NAME              20760099
207601              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            20760199
207602              DISPLAY 'SHIP UNIT-ID: ' DK-SHIPT-UNT-ID            20760299
207603              DISPLAY 'PO NBR:       ' DK-PO-NBR                  20760399
207604              DISPLAY 'REC SEQ NBR:  ' DK-REC-SEQ-NBR             20760499
207605              PERFORM 9999-SQL-ABEND                              20760599
207606     END-EVALUATE.                                                20760699
207607                                                                  20760799
207608******************************************************************20760899
207609* 3220-FETCH-RFID-CURSOR                                         *20760999
207610*  THIS PROCEDURE WILL FETCH THE RFID-CURSOR.                    *20761099
207620******************************************************************20762099
207630 3220-FETCH-RFID-CURSOR.                                          20763099
207640                                                                  20764099
207650     EXEC SQL                                                     20765099
207660          FETCH RFID_CURSOR                                       20766099
207670          INTO   :SUEXCP-UPC-NBR                                  20767099
207680               , :SUEXCP-SCN-TMST                                 20768099
207690               , :SUEXCP-VILN-GP-SEQ-NBR                          20769099
207700               , :PV-DB2-COUNT                                    20770099
207800               , :PV-RFID-COUNT                                   20780099
207900     END-EXEC.                                                    20790099
208000                                                                  20800099
208100     EVALUATE TRUE                                                20810099
208200         WHEN SQLCODE = ZERO                                      20820099
208300              CONTINUE                                            20830099
208400                                                                  20840099
208500         WHEN SQLCODE = +100                                      20850099
208600         WHEN SQLCODE = -305                                      20860099
208700              SET PS-END-OF-RFID-CURSOR TO TRUE                   20870099
208800                                                                  20880099
208900         WHEN SQLWARN0 NOT EQUAL SPACE                            20890099
209000         WHEN SQLCODE NOT EQUAL ZERO                              20900099
209100              MOVE '3220-FETCH-RFID-CURSOR'                       20910099
209200                               TO  PV-PARAGRAPH-NAME              20920099
209201              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            20920199
209202              DISPLAY 'SHIP UNIT ID: ' DK-SHIPT-UNT-ID            20920299
209203              DISPLAY 'PO NBR:       ' DK-PO-NBR                  20920399
209204              DISPLAY 'REC SEQ NBR:  ' DK-REC-SEQ-NBR             20920499
209205              PERFORM 9999-SQL-ABEND                              20920599
209206     END-EVALUATE.                                                20920699
209207                                                                  20920799
209208******************************************************************20920899
209209* 3225-CLOSE-RFID-CURSOR                                         *20920999
209210*  THIS PROCEDURE WILL CLOSE THE RFID_CURSOR.                    *20921099
209220******************************************************************20922099
209230 3225-CLOSE-RFID-CURSOR.                                          20923099
209240                                                                  20924099
209250     EXEC SQL                                                     20925099
209260         CLOSE RFID_CURSOR                                        20926099
209270     END-EXEC.                                                    20927099
209280                                                                  20928099
209290     EVALUATE TRUE                                                20929099
209300         WHEN SQLWARN0 NOT EQUAL SPACE                            20930099
209400         WHEN SQLCODE NOT EQUAL ZERO                              20940099
209500              MOVE '3225-CLOSE-RFID-CURSOR'                       20950099
209600                               TO  PV-PARAGRAPH-NAME              20960099
209700              PERFORM 9999-SQL-ABEND                              20970099
209800     END-EVALUATE.                                                20980099
209900                                                                  20990099
210000******************************************************************21000099
210100* 3300-CHECK-QC-ERRORS.                                          *21010099
210200*  THIS PROCEDURE WILL GET ALL THE UNITS WITH A QC EXCEPTION.    *21020099
210300******************************************************************21030099
210400 3300-CHECK-QC-ERRORS.                                            21040099
210500                                                                  21050099
210600     EXEC SQL                                                     21060099
210700        SELECT SUM(SCND_UNT_QTY)                                  21070099
210800          INTO :PV-SCAN-COUNT                                     21080099
210900          FROM  TSUEXCP A                                         21090099
211000              , TVILNCD B                                         21100099
211100              , TSUAUPC C                                         21110099
211200         WHERE A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR              21120099
211300           AND A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID              21130099
211400           AND A.AUD_CNTL_NBR     =  C.AUD_CNTL_NBR               21140099
211500           AND A.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID               21150099
211600           AND A.UPC_NBR          =  C.UPC_NBR                    21160099
211700           AND A.SCN_TMST         =  C.SCN_TMST                   21170099
211800           AND A.VILN_GP_CDE      = :PC-VA                        21180099
211900           AND B.VILN_CTG_CDE    <> :PC-R                         21190099
212000           AND A.VILN_GP_SEQ_NBR  = B.VILN_GP_SEQ_NBR             21200099
212100           AND A.VILN_GP_CDE      = B.VILN_GP_CDE                 21210099
212200     END-EXEC.                                                    21220099
212300                                                                  21230099
212400     EVALUATE TRUE                                                21240099
212500         WHEN SQLCODE = ZERO                                      21250099
212600              COMPUTE PV-HL-TOTAL-ERRORS =                        21260099
212700                      PV-HL-TOTAL-ERRORS + PV-SCAN-COUNT          21270099
212800                                                                  21280099
212900         WHEN SQLCODE = +100                                      21290099
213000         WHEN SQLCODE = -305                                      21300099
213100              MOVE ZEROES               TO PV-HL-TOTAL-ERRORS     21310099
213200                                                                  21320099
213300         WHEN SQLWARN0 NOT EQUAL SPACE                            21330099
213400         WHEN SQLCODE NOT EQUAL ZERO                              21340099
213500              MOVE '3300-CHECK-QC-ERRORS'                         21350099
213600                                        TO PV-PARAGRAPH-NAME      21360099
213700              DISPLAY 'AUD CNTL NBR: '     DK-AUD-CNTL-NBR        21370099
213800              DISPLAY 'SHIP UNIT ID: '     DK-SHIPT-UNT-ID        21380099
213900              PERFORM 9999-SQL-ABEND                              21390099
214000     END-EVALUATE.                                                21400099
214100*JA 04/01/14 - END                                                21410099
214200                                                                  21420099
214300*JA 04/22/14 - BEG                                                21430099
214400******************************************************************21440099
214500* 3400-RETRIEVE-UNIT-COUNT.                                      *21450099
214600*  FOR A QC AUDIT RETRIEVE THE COUNT OF THE UNITS IN ERROR.      *21460099
214700******************************************************************21470099
214800 3400-RETRIEVE-UNIT-COUNT.                                        21480099
214900                                                                  21490099
215000     EXEC SQL                                                     21500099
215100        SELECT SUM(SCND_UNT_QTY)                                  21510099
215200          INTO :PV-SCND-UNT-COUNT                                 21520099
215300          FROM  TSUEXCP A                                         21530099
215400              , TVILNCD B                                         21540099
215500              , TSUAUPC C                                         21550099
215600         WHERE A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR              21560099
215700           AND A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID              21570099
215800           AND A.AUD_CNTL_NBR     =  C.AUD_CNTL_NBR               21580099
215900           AND A.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID               21590099
216000           AND A.UPC_NBR          =  C.UPC_NBR                    21600099
216100           AND A.SCN_TMST         =  C.SCN_TMST                   21610099
216200           AND C.SCN_TYP_CDE      = :PC-E                         21620099
216300           AND A.VILN_GP_CDE      = :PC-VA                        21630099
216400           AND B.VILN_CTG_CDE    <> :PC-R                         21640099
216500           AND A.VILN_GP_SEQ_NBR  = B.VILN_GP_SEQ_NBR             21650099
216600           AND A.VILN_GP_CDE      = B.VILN_GP_CDE                 21660099
216700     END-EXEC.                                                    21670099
216800                                                                  21680099
216900     EVALUATE TRUE                                                21690099
217000         WHEN SQLCODE = ZERO                                      21700099
217100              MOVE PV-SCND-UNT-COUNT    TO PV-HL-UNITS-IN-ERROR   21710099
217200                                                                  21720099
217300         WHEN SQLCODE = +100                                      21730099
217400         WHEN SQLCODE = -305                                      21740099
217500              MOVE ZEROES               TO PV-HL-UNITS-IN-ERROR   21750099
217600                                                                  21760099
217700         WHEN SQLWARN0 NOT EQUAL SPACE                            21770099
217800         WHEN SQLCODE NOT EQUAL ZERO                              21780099
217900              MOVE '3400-RETRIEVE-UNIT-COUNT'                     21790099
218000                                        TO PV-PARAGRAPH-NAME      21800099
218100              DISPLAY 'AUD CNTL NBR: '     DK-AUD-CNTL-NBR        21810099
218200              DISPLAY 'SHIP UNIT ID: '     DK-SHIPT-UNT-ID        21820099
218300              PERFORM 9999-SQL-ABEND                              21830099
218400     END-EVALUATE.                                                21840099
218500*JA 04/22/14 - END                                                21850099
218600                                                                  21860099
218700******************************************************************21870099
218800* 4200-ACCUM-SUM-TABLES  --  ADD THE QUANTITY TO THE ACCUMULATOR  21880099
218900* SUMMARY TABLES.                                                 21890099
219000******************************************************************21900099
219100 4200-ACCUM-SUM-TABLES.                                           21910099
219200                                                                  21920099
219300     MOVE DL1-VILN-CDE-SHRT-DESC                                  21930099
219400                              TO PV-ERROR-DESC.                   21940099
219500     MOVE PV-DL-EXCEPTION-COUNT                                   21950099
219600                              TO PV-ERROR-QTY.                    21960099
219700     IF PV-PICKING-ERROR                                          21970099
219800         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 21980099
219900         UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES               21990099
220000            OR PA-PIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC        22000099
220100            OR PV-ERROR-IDX > 25                                  22010099
220200         END-PERFORM                                              22020099
220300                                                                  22030099
220400         IF PA-PIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC           22040099
220500             ADD PV-ERROR-QTY                                     22050099
220600                              TO PA-PIC-ERROR-QTY (PV-ERROR-IDX)  22060099
220700         ELSE                                                     22070099
220800             IF PA-PIC-ERROR (PV-ERROR-IDX) = SPACES              22080099
220900                 MOVE PV-ERROR-DESC                               22090099
221000                              TO PA-PIC-ERROR (PV-ERROR-IDX)      22100099
221100                 MOVE PV-ERROR-QTY                                22110099
221200                              TO PA-PIC-ERROR-QTY (PV-ERROR-IDX)  22120099
221300             ELSE                                                 22130099
221400                 DISPLAY '** ABEND                             **'22140099
221500                 DISPLAY '** PROGRAM   = SUKRP012              **'22150099
221600                 DISPLAY '** PARAGRAPH = 4200-ACCUM-SUM-TABLES **'22160099
221700                 DISPLAY '** SUMMARY TABLE OVERFLOW ERROR      **'22170099
221800                 DISPLAY '** PICKING ERROR TABLE SET AT 25 --  **'22180099
221900                 DISPLAY '** MUST BE INCREASED                 **'22190099
222000                 MOVE +4004 TO PV-ABEND-CODE                      22200099
222100                 CALL 'ILBOABN0' USING PV-ABEND-CODE              22210099
222200             END-IF                                               22220099
222300         END-IF                                                   22230099
222400     END-IF.                                                      22240099
222500                                                                  22250099
222600     IF PV-TICKETING-ERROR                                        22260099
222700         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 22270099
222800         UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES               22280099
222900            OR PA-TIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC        22290099
223000            OR PV-ERROR-IDX > 25                                  22300099
223100         END-PERFORM                                              22310099
223200                                                                  22320099
223300         IF PA-TIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC           22330099
223400             ADD PV-ERROR-QTY                                     22340099
223500                              TO PA-TIC-ERROR-QTY (PV-ERROR-IDX)  22350099
223600         ELSE                                                     22360099
223700             IF PA-TIC-ERROR (PV-ERROR-IDX) = SPACES              22370099
223800                 MOVE PV-ERROR-DESC                               22380099
223900                              TO PA-TIC-ERROR (PV-ERROR-IDX)      22390099
224000                 MOVE PV-ERROR-QTY                                22400099
224100                              TO PA-TIC-ERROR-QTY (PV-ERROR-IDX)  22410099
224200             ELSE                                                 22420099
224300                 DISPLAY '** ABEND                             **'22430099
224400                 DISPLAY '** PROGRAM   = SUKRP012              **'22440099
224500                 DISPLAY '** PARAGRAPH = 4200-ACCUM-SUM-TABLES **'22450099
224600                 DISPLAY '** SUMMARY TABLE OVERFLOW ERROR      **'22460099
224700                 DISPLAY '** TICKETING ERROR TABLE SET AT 25 - **'22470099
224800                 DISPLAY '** MUST BE INCREASED                 **'22480099
224900                 MOVE +4004 TO PV-ABEND-CODE                      22490099
225000                 CALL 'ILBOABN0' USING PV-ABEND-CODE              22500099
225100             END-IF                                               22510099
225200         END-IF                                                   22520099
225300     END-IF.                                                      22530099
225400                                                                  22540099
225500     IF PV-RFID-ERROR                                             22550099
225600         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 22560099
225700         UNTIL PA-RFID-ERROR (PV-ERROR-IDX) = SPACES              22570099
225800            OR PA-RFID-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC       22580099
225900            OR PV-ERROR-IDX > 25                                  22590099
226000         END-PERFORM                                              22600099
226100                                                                  22610099
226200         IF PA-RFID-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC          22620099
226300             ADD PV-ERROR-QTY                                     22630099
226400                              TO PA-RFID-ERROR-QTY (PV-ERROR-IDX) 22640099
226500         ELSE                                                     22650099
226600             IF PA-RFID-ERROR (PV-ERROR-IDX) = SPACES             22660099
226700                 MOVE PV-ERROR-DESC                               22670099
226800                              TO PA-RFID-ERROR (PV-ERROR-IDX)     22680099
226900                 MOVE PV-ERROR-QTY                                22690099
227000                              TO PA-RFID-ERROR-QTY (PV-ERROR-IDX) 22700099
227100             ELSE                                                 22710099
227200                 DISPLAY '** ABEND                             **'22720099
227300                 DISPLAY '** PROGRAM   = SUKRP012              **'22730099
227400                 DISPLAY '** PARAGRAPH = 4200-ACCUM-SUM-TABLES **'22740099
227500                 DISPLAY '** SUMMARY TABLE OVERFLOW ERROR      **'22750099
227600                 DISPLAY '** RFID ERROR TABLE SET AT 25 -      **'22760099
227700                 DISPLAY '** MUST BE INCREASED                 **'22770099
227800                 MOVE +4004 TO PV-ABEND-CODE                      22780099
227900                 CALL 'ILBOABN0' USING PV-ABEND-CODE              22790099
228000             END-IF                                               22800099
228100         END-IF                                                   22810099
228200     END-IF.                                                      22820099
228300* 02/06/14 DRW END                                                22830099
228400                                                                  22840099
228500*                                                                 22850099
228600******************************************************************22860099
228700* 4300-INIT-SUM-TBLS - INITIALIZES THE ERROR SUMMARY TABLES FOR   22870099
228800* THE NEXT PO/RECEIVER.                                           22880099
228900******************************************************************22890099
229000*4300-INIT-SUM-TBLS.                                              22900099
229100*                                                                 22910099
229200*     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                    22920099
229300*     UNTIL PV-ERROR-IDX > 25                                     22930099
229400*           MOVE SPACES  TO PA-PIC-ERROR (PV-ERROR-IDX)           22940099
229500*           MOVE ZEROES  TO PA-PIC-ERROR-QTY (PV-ERROR-IDX)       22950099
229600*     END-PERFORM.                                                22960099
229700*                                                                 22970099
229800*     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                    22980099
229900*     UNTIL PV-ERROR-IDX > 25                                     22990099
230000*           MOVE SPACES  TO PA-TIC-ERROR (PV-ERROR-IDX)           23000099
230100*           MOVE ZEROES  TO PA-TIC-ERROR-QTY (PV-ERROR-IDX)       23010099
230200*     END-PERFORM.                                                23020099
230300*                                                                 23030099
230400*     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                    23040099
230500*     UNTIL PV-ERROR-IDX > 25                                     23050099
230600*           MOVE SPACES  TO PA-RFID-ERROR (PV-ERROR-IDX)          23060099
230700*           MOVE ZEROES  TO PA-RFID-ERROR-QTY (PV-ERROR-IDX)      23070099
230800*     END-PERFORM.                                                23080099
230801*                                                                 23080199
230802                                                                  23080299
230803******************************************************************23080399
230804* 5300-PROCESS-SKU-TOT-FILE                                       23080499
230805*  CONTROL THE READ OF THE SKU TOTAL FILE UNTIL END OF FILE, A    23080599
230806*  MATCH IS FOUND OR NO MATCH IS FOUND.                           23080699
230807******************************************************************23080799
230808 5300-PROCESS-SKU-TOT-FILE.                                       23080899
230809******************************************************************23080999
230810*  REPLACED SU003-SKU-SEQ-NBR OF OS-SKU-FILE WITH SU003-SKU-NMBR *23081099
230811*  OF OS-SKU-FILE AND PV-OSS-SKU-SEQ-NBR WITH PV-OSS-SKU-NBR.    *23081199
230812*                                                   WR # 21361   *23081299
230813******************************************************************23081399
230814                                                                  23081499
230815                                                                  23081599
230816     PERFORM 7060-READ-SKU-TOTAL-FILE.                            23081699
230817                                                                  23081799
230818     IF  PS-EOF-SKU-TOTAL-FILE                                    23081899
230819         MOVE SU003-QTY-AUD  OF SU003-COPYBOOK                    23081999
230820                                  TO PV-HOLD-QTY-AUD              23082099
230821         MOVE SU003-QTY-EXP  OF SU003-COPYBOOK                    23082199
230822                                  TO PV-HOLD-QTY-EXP              23082299
230823         SET PS-SKU-MATCH         TO TRUE                         23082399
230824     ELSE                                                         23082499
230825         MOVE SU003-AUD-CNTL-NBR  OF OS-SKU-FILE                  23082599
230826           TO PV-OSS-AUD-CNTL-NBR                                 23082699
230827         MOVE SU003-PO-NBR        OF OS-SKU-FILE                  23082799
230828           TO PV-OSS-PO-NBR                                       23082899
230829         MOVE SU003-REC-SEQ-NBR   OF OS-SKU-FILE                  23082999
230830           TO PV-OSS-REC-SEQ-NBR                                  23083099
230831         MOVE SU003-SHIPT-UNT-ID  OF OS-SKU-FILE                  23083199
230832           TO PV-OSS-SHIPT-UNT-ID                                 23083299
230833         MOVE SU003-SKU-DEPT-NBR  OF OS-SKU-FILE                  23083399
230834           TO PV-OSS-SKU-DEPT-NBR                                 23083499
230835         MOVE SU003-SKU-CL-NBR    OF OS-SKU-FILE                  23083599
230836           TO PV-OSS-SKU-CL-NBR                                   23083699
230837         MOVE SU003-SKU-NMBR      OF OS-SKU-FILE                  23083799
230838           TO PV-OSS-SKU-NBR.                                     23083899
230839******************************************************************23083999
230840*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *23084099
230841******************************************************************23084199
230842                                                                  23084299
230843                                                                  23084399
230844     IF  PS-SKU-MATCH                                             23084499
230845         NEXT SENTENCE                                            23084599
230846     ELSE                                                         23084699
230847                                                                  23084799
230848         IF  PV-OS-FILE-HOLD-KEY = PV-OS-SKU-FILE-HOLD-KEY        23084899
230849             MOVE SU003-QTY-AUD  OF OS-SKU-FILE                   23084999
230850                                      TO PV-HOLD-QTY-AUD          23085099
230851             MOVE SU003-QTY-EXP  OF OS-SKU-FILE                   23085199
230852                                      TO PV-HOLD-QTY-EXP          23085299
230853             SET PS-SKU-MATCH         TO TRUE                     23085399
230854         ELSE                                                     23085499
230855             IF  PV-OS-FILE-HOLD-KEY < PV-OS-SKU-FILE-HOLD-KEY    23085599
230856                 MOVE SU003-QTY-AUD  OF SU003-COPYBOOK            23085699
230857                                          TO PV-HOLD-QTY-AUD      23085799
230858                 MOVE SU003-QTY-EXP  OF SU003-COPYBOOK            23085899
230859                                          TO PV-HOLD-QTY-EXP      23085999
230860                 SET PS-SKU-MATCH         TO TRUE                 23086099
230861             ELSE                                                 23086199
230862                 NEXT SENTENCE.                                   23086299
230863                                                                  23086399
230864*3000-PROCESS-UPC-EXCEPTIONS.                                     23086499
230865******************************************************************23086599
230866*  REPLACED SUAUPC-SKU-SEQ-NBR WITH SUAUPC-SKU-NBR, SUAUPC-SKU-  *23086699
230867*  DEPT-NBR WITH XL001-DEPT-NBR-3CH AND SUAUPC-SKU-CL-NBR WITH   *23086799
230868*  XL001-SUB-CL-NBR-2CH.                            WR # 21361   *23086899
230869******************************************************************23086999
230870******************************************************************23087099
230871*  PROCESS ALL OF THE EXCEPTIONS ASSOCIATED WITH THIS UPC.       *23087199
230872*  WE ARE IGNORING EXCEPTION CODE 12 (UPC MISPACK).  THAT        *23087299
230873*  EXCEPTION IS BEING HANDLED AS PART OF THE VENDOR OVER/SHORT   *23087399
230874*  PROCESSING.                                                   *23087499
230875******************************************************************23087599
230876*                                                                 23087699
230877*    SET PS-ERROR-FOUND             TO TRUE.                      23087799
230878*    PERFORM 3700-FETCH-VILNCD-DESC.                              23087899
230879*    MOVE VILNCD-VILN-CDE-SHRT-DESC TO DL1-VILN-CDE-SHRT-DESC     23087999
230880*                                      PV-ERROR-DESC.             23088099
230881*    IF CC-RFID-AUDIT                                             23088199
230882*        MOVE PV-RFID-UNITS-IN-ERROR                              23088299
230883*                                   TO DL1-QTY-IN-ERROR           23088399
230884*    ELSE                                                         23088499
230885*        MOVE PV-UNITS-IN-ERROR     TO DL1-QTY-IN-ERROR           23088599
230886*    END-IF.                                                      23088699
230887*    MOVE SPACES                    TO DL1-ERROR-TYPE             23088799
230888*                                      DL1-RECEIVED-AS-INFO       23088899
230889*                                      DL1-ORDERED-AS-INFO.       23088999
230890*                                                                 23089099
230891*                                                                 23089199
230892*    EVALUATE SUEXCP-VILN-GP-SEQ-NBR                              23089299
230893*                                                                 23089399
230894*   PICKING EXCEPTIONS                                            23089499
230895*                                                                 23089599
230896*        WHEN PC-STYLE-SUB-VILN                                   23089699
230897*            MOVE 'STY'            TO DL1-ERROR-TYPE              23089799
230898*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23089899
230899*                                  TO DL1-RECEIVED-AS-INFO        23089999
230900*            MOVE SUAUPC-VND-STYL-DESC                            23090099
230901*                                  TO DL1-ORDERED-AS-INFO         23090199
230902*            PERFORM 3100-SETUP-DETAIL-LINES                      23090299
230903*                                                                 23090399
230904*        WHEN PC-NO-DC-OTR-VILN                                   23090499
230905*        WHEN PC-NO-PBS-ALLOC-VILN                                23090599
230906*        WHEN PC-DMGD-MDSE-VILN                                   23090699
230907*            PERFORM 3100-SETUP-DETAIL-LINES                      23090799
230908*                                                                 23090899
230909*   TICKETING EXCEPTIONS                                          23090999
230910*                                                                 23091099
230911*        WHEN PC-NO-BARCODE-VILN                                  23091199
230912*        WHEN PC-DMGD-BARCODE-VILN                                23091299
230913*        WHEN PC-NO-UPC-VILN                                      23091399
230914*        WHEN PC-WRONG-UPC-VILN                                   23091499
230915*        WHEN PC-SKU-NOT-FOUND-VILN                               23091599
230916*        WHEN PC-NO-TAG-TICKET-VILN                               23091699
230917*        WHEN PC-SIZE-STRIP-MDSE-VILN                             23091799
230918*        WHEN PC-WRONG-BOX-ID-VILN                                23091899
230919*        WHEN PC-WRONG-TKT-TKT-VILN                               23091999
230920*        WHEN PC-NO-MDSE-TAG-VILN                                 23092099
230921*            PERFORM 3100-SETUP-DETAIL-LINES                      23092199
230922*                                                                 23092299
230923*   RFID EXCEPTIONS                                               23092399
230924*                                                                 23092499
230925*        WHEN PC-RFID-UPC-MISPK-VILN                              23092599
230926*        WHEN PC-WRG-RFID-STYLE-VILN                              23092699
230927*        WHEN PC-WRG-RFID-SIZE-VILN                               23092799
230928*        WHEN PC-WRG-RFID-CLR-VILN                                23092899
230929*        WHEN PC-NO-RFID-TKT-VILN                                 23092999
230930*            PERFORM 3100-SETUP-DETAIL-LINES                      23093099
230931*                                                                 23093199
230932*        WHEN PC-WRONG-DEPT-TKT-VILN                              23093299
230933*            MOVE 'DPT'            TO DL1-ERROR-TYPE              23093399
230934*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23093499
230935*                                  TO DL1-RECEIVED-AS-INFO        23093599
230936*            MOVE XL001-DEPT-NBR-3CH                              23093699
230937*                                  TO DL1-ORDERED-AS-INFO         23093799
230938*            PERFORM 3100-SETUP-DETAIL-LINES                      23093899
230939*                                                                 23093999
230940*        WHEN PC-WRONG-RETAIL-TKT-VILN                            23094099
230941*        WHEN PC-WRONG-RETAIL-MDSE-VILN                           23094199
230942*            MOVE 'RTL'            TO DL1-ERROR-TYPE              23094299
230943*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23094399
230944*                                  TO DL1-RECEIVED-AS-INFO        23094499
230945*            MOVE SUAUPC-UPC-RTL-AMT                              23094599
230946*                                  TO PV-UPC-RTL-AMT              23094699
230947*            MOVE PV-UPC-RTL-AMT-X TO DL1-ORDERED-AS-INFO         23094799
230948*            PERFORM 3100-SETUP-DETAIL-LINES                      23094899
230949*                                                                 23094999
230950*        WHEN PC-WRONG-COLOR-TKT-VILN                             23095099
230951*        WHEN PC-WRONG-COLOR-MDSE-VILN                            23095199
230952*            MOVE 'CLR'            TO DL1-ERROR-TYPE              23095299
230953*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23095399
230954*                                  TO DL1-RECEIVED-AS-INFO        23095499
230955*            MOVE SUAUPC-UPC-CLOR-DESC                            23095599
230956*                                  TO DL1-ORDERED-AS-INFO         23095699
230957*            PERFORM 3100-SETUP-DETAIL-LINES                      23095799
230958*                                                                 23095899
230959*        WHEN PC-WRONG-SIZE-TKT-VILN                              23095999
230960*        WHEN PC-WRONG-SIZE-MDSE-VILN                             23096099
230961*            MOVE 'SZE'            TO DL1-ERROR-TYPE              23096199
230962*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23096299
230963*                                  TO DL1-RECEIVED-AS-INFO        23096399
230964*            MOVE SUAUPC-UPC-SIZE-DESC                            23096499
230965*                                  TO DL1-ORDERED-AS-INFO         23096599
230966*            PERFORM 3100-SETUP-DETAIL-LINES                      23096699
230967*                                                                 23096799
230968*        WHEN PC-WRONG-MAJ-CL-TKT-VILN                            23096899
230969*            MOVE 'MCLS'           TO DL1-ERROR-TYPE              23096999
230970*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23097099
230971*                                  TO DL1-RECEIVED-AS-INFO        23097199
230972*            MOVE XL001-MAJ-CL-NBR-2CH                            23097299
230973*                                  TO DL1-ORDERED-AS-INFO         23097399
230974*            PERFORM 3100-SETUP-DETAIL-LINES                      23097499
230975*                                                                 23097599
230976*        WHEN PC-WRONG-STYLE-TKT-VILN                             23097699
230977*        WHEN PC-MDSE-STYLE-TKT-VILN                              23097799
230978*            MOVE 'STY'            TO DL1-ERROR-TYPE              23097899
230979*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23097999
230980*                                  TO DL1-RECEIVED-AS-INFO        23098099
230981*            MOVE SUAUPC-VND-STYL-DESC                            23098199
230982*                                  TO DL1-ORDERED-AS-INFO         23098299
230983*            PERFORM 3100-SETUP-DETAIL-LINES                      23098399
230984*                                                                 23098499
230985*        WHEN PC-WRONG-SUB-CLS-TKT-VILN                           23098599
230986*            MOVE 'SCLS'           TO DL1-ERROR-TYPE              23098699
230987*            MOVE SUEXCP-OVRRID-SYS-DAT-TXT                       23098799
230988*                                  TO DL1-RECEIVED-AS-INFO        23098899
230989*            MOVE XL001-SUB-CL-NBR-2CH                            23098999
230990*                                  TO DL1-ORDERED-AS-INFO-9       23099099
230991*            PERFORM 3100-SETUP-DETAIL-LINES                      23099199
230992******************************************************************23099299
230993*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *23099399
230994******************************************************************23099499
230995*                                                                 23099599
230996*   OTHER EXCEPTIONS                                              23099699
230997*   WHICH ARE ONLY INCLUDED IN THE SUMMARY TOTALS ARE             23099799
230998*             PC-PO-DIFF-ON-CART-VILN                             23099899
230999*             PC-STR-DIF-ON-CART-VILN                             23099999
231000*                                                                 23100099
231001*    END-EVALUATE.                                                23100199
231002*                                                                 23100299
231003*    PERFORM 7120-FETCH-EXCEPTIONS-CSR.                           23100399
231004*                                                                 23100499
231005*                                                                 23100599
231006******************************************************************23100699
231007*  DELETED MOVE STATEMENT FOR SU003-SKU-DEPT-NBR OF SU003-       *23100799
231008*  COPYBOOK TO DL1-SKU-DEPT-NBR AND REPLACED SU003-SKU-SEQ-NBR   *23100899
231009*  OF SU003-COPYBOOK WITH SU003-SKU-NMBR OF SU003-COPYBOOK.      *23100999
231010*  REPLACED UPC-CSTM-CLOR-DESC WITH XL001-CSTM-CLOR-DESC, VNDSTL-*23101099
231011*  VS-NBR WITH XL001-VS-NBR AND SIZE-KOHLS-DESC WITH XL001-SIZE- *23101199
231012*  DESC.                                             WR # 21361  *23101299
231013******************************************************************23101399
231014 3100-SETUP-DETAIL-LINES.                                         23101499
231015******************************************************************23101599
231016*  SET UP THE DETAIL LINES OF THE REPORT.                        *23101699
231017******************************************************************23101799
231018     PERFORM 3200-FETCH-TSUAUPC-INFO.                             23101899
231019     IF  PS-FIRST-DETAIL-PRINT                                    23101999
231020         SET PS-PRINT-SKU-INFO                                    23102099
231021             PS-NOT-FIRST-DETAIL-PRINT TO TRUE                    23102199
231022     END-IF.                                                      23102299
231023                                                                  23102399
231024     IF  PS-PRINT-SKU-INFO                                        23102499
231025         SET PS-DO-NOT-PRINT-SKU-INFO                             23102599
231026                                   TO TRUE                        23102699
231027*        DISPLAY 'WENT IN SKU PRINT'                              23102799
231028         WRITE CARTON-AUDIT-RPT-RECORD                            23102899
231029           FROM PC-BLANK-LINE                                     23102999
231030             AFTER ADVANCING 1 LINE                               23103099
231031         ADD 1                         TO PV-LINE-CNT             23103199
231032         MOVE SU003-SKU-CL-NBR   OF SU003-COPYBOOK TO             23103299
231033              DL1-SKU-CL-NBR                                      23103399
231034         MOVE SU003-SKU-NMBR     OF SU003-COPYBOOK TO             23103499
231035              DL1-SKU-NBR                                         23103599
231036*    ELSE                                                         23103699
231037*        MOVE SPACES TO DL1-SKU                                   23103799
231038     END-IF                                                       23103899
231039     IF  PS-PRINT-UPC-INFO                                        23103999
231040         SET PS-DO-NOT-PRINT-UPC-INFO                             23104099
231041                                   TO TRUE                        23104199
231042         WRITE CARTON-AUDIT-RPT-RECORD                            23104299
231043           FROM PC-BLANK-LINE                                     23104399
231044             AFTER ADVANCING 1 LINE                               23104499
231045         ADD 1                         TO PV-LINE-CNT             23104599
231046         MOVE SU003-UPC OF SU003-COPYBOOK TO DL1-UPC-NBR          23104699
231047         IF  PS-DETAIL-FROM-TSUAUPC                               23104799
231048*            MOVE SUAUPC-SKU-DEPT-NBR  TO DL1-SKU-DEPT-NBR        23104899
231049             MOVE SUAUPC-SUB-CL-NBR    TO PV-SUB-CL-NBR           23104999
231050             MOVE PV-SUB-CL-NBR        TO PV-SUB-CL-NBR-9         23105099
231060             MOVE PV-SUB-CL-3-4        TO DL1-SKU-CL-NBR          23106099
231070             MOVE SUAUPC-SKU-NBR       TO DL1-SKU-NBR             23107099
231071             MOVE SUAUPC-UPC-NBR       TO DL1-UPC-NBR             23107199
231072*            MOVE SUAUPC-SKU-SEQ-NBR   TO DL1-SKU-SEQ-NBR         23107299
231073             MOVE SUAUPC-VND-STYL-DESC TO DL1-VND-STYL-DESC       23107399
231074             MOVE SUAUPC-UPC-CLOR-DESC TO DL1-UPC-CLOR-DESC       23107499
231075             MOVE SUAUPC-UPC-SIZE-DESC TO DL1-UPC-SIZE-DESC       23107599
231076         ELSE                                                     23107699
231077             MOVE XL001-VS-NBR         TO DL1-VND-STYL-DESC       23107799
231078             MOVE XL001-CSTM-CLOR-DESC TO DL1-UPC-CLOR-DESC       23107899
231079             MOVE XL001-SIZE-DESC      TO DL1-UPC-SIZE-DESC       23107999
231080         END-IF                                                   23108099
231081*    ELSE                                                         23108199
231082*        MOVE SPACES                   TO DL1-UPC-NBR-X           23108299
231083*                                         DL1-VND-STYL-DESC       23108399
231084*                                         DL1-UPC-CLOR-DESC       23108499
231085*                                         DL1-UPC-SIZE-DESC       23108599
231086*                                         DL1-SKU                 23108699
231087     END-IF.                                                      23108799
231088******************************************************************23108899
231089*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *23108999
231090******************************************************************23109099
231091                                                                  23109199
231092                                                                  23109299
231093*    PERFORM 8400-WRITE-DETAIL-LINES.                             23109399
231094*    ADD 1                         TO PV-LINE-CNT.                23109499
231095                                                                  23109599
231096                                                                  23109699
231097******************************************************************23109799
231098*  CHANGED THE SQL TO SELECT 8 DIGIT SKU INSTEAD OF DEPT,CLASS   *23109899
231099*  AND SEQ NBR FROM TSUAUPC TABLE AND CHANGED THE HOST VARIABLES *23109999
231100*  ACCORDINGLY.                                                  *23110099
231101*  DELETED THE PERFORM STATEMENTS FOR 3400-FETCH-UPC-INFO, 3500- *23110199
231102*  FETCH-SIZE-INFO AND 3600-FETCH-VENDOR-STYLE. AND ADDED THE    *23110299
231103*  PERFORM 3400-CALL-XLKUT-DOMAIN-PGM.               WR # 21361  *23110399
231104******************************************************************23110499
231105 3200-FETCH-TSUAUPC-INFO.                                         23110599
231106******************************************************************23110699
231107*  FETCH THE INFORMATION ON THE UNITS IN THE CARTON FOR A        *23110799
231108*  SPECIFIED UPC.                                                *23110899
231109******************************************************************23110999
231110     INITIALIZE DCLTSUAUPC.                                       23111099
231111                                                                  23111199
231112     MOVE '3200-FETCH-TSUAUPC-INFO    ' TO PV-PARAGRAPH-NAME.     23111299
231113                                                                  23111399
231114     EXEC SQL                                                     23111499
231115       SELECT DISTINCT                                            23111599
231116               SUB_CL_NBR                                         23111699
231117              ,SKU_NBR                                            23111799
231118              ,UPC_NBR                                            23111899
231119              ,ITM_DESC                                           23111999
231120              ,VND_STYL_DESC                                      23112099
231121              ,UPC_CLOR_DESC                                      23112199
231122              ,UPC_SIZE_DESC                                      23112299
231123              ,UPC_RTL_AMT                                        23112399
231124         INTO  :SUAUPC-SUB-CL-NBR                                 23112499
231125              ,:SUAUPC-SKU-NBR                                    23112599
231126              ,:SUAUPC-UPC-NBR                                    23112699
231127              ,:SUAUPC-ITM-DESC                                   23112799
231128              ,:SUAUPC-VND-STYL-DESC                              23112899
231129              ,:SUAUPC-UPC-CLOR-DESC                              23112999
231130              ,:SUAUPC-UPC-SIZE-DESC                              23113099
231131              ,:SUAUPC-UPC-RTL-AMT                                23113199
231132         FROM  TSUAUPC                                            23113299
231133        WHERE  AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                  23113399
231134          AND  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                  23113499
231135          AND  UPC_NBR        = :DK-UPC-NBR                       23113599
231136          AND  SCN_TYP_CDE   <> :PC-E                             23113699
231137     END-EXEC.                                                    23113799
231138                                                                  23113899
231139     EVALUATE TRUE                                                23113999
231140       WHEN SQLCODE = ZEROS                                       23114099
231141       WHEN SQLCODE = -811                                        23114199
231142         SET PS-DETAIL-FROM-TSUAUPC     TO TRUE                   23114299
231143                                                                  23114399
231144       WHEN SQLCODE = +100                                        23114499
231145         SET PS-DETAIL-NOT-FROM-TSUAUPC TO TRUE                   23114599
231146         PERFORM 3400-CALL-XLKUT-DOMAIN-PGM                       23114699
231147                                                                  23114799
231148       WHEN OTHER                                                 23114899
231149         DISPLAY PV-PARAGRAPH-NAME                                23114999
231150         DISPLAY 'AUDIT NBR '    DK-AUD-CNTL-NBR                  23115099
231151         DISPLAY 'SHIP UNIT '    DK-SHIPT-UNT-ID                  23115199
231152         DISPLAY 'UPC NBR   '    DK-UPC-NBR                       23115299
231153         PERFORM 9999-SQL-ABEND                                   23115399
231154     END-EVALUATE.                                                23115499
231155                                                                  23115599
231156******************************************************************23115699
231157*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *23115799
231158******************************************************************23115899
231159                                                                  23115999
231160******************************************************************23116099
231161* 3400-CALL-XLKUT-DOMAIN-PGM.                                    *23116199
231162* ADDED THIS NEW PARAGRAPH TO REPLACE THE 3400-FETCH-UPC-INFO,   *23116299
231163* 3500-FETCH-SIZE-INFO AND 3600-FETCH-VENDOR-STYLE PARAGRAPHS.   *23116399
231164*                                            WR # 21361          *23116499
231165******************************************************************23116599
231166 3400-CALL-XLKUT-DOMAIN-PGM.                                      23116699
231167                                                                  23116799
231168     MOVE '3400-CALL-XLKUT-DOMAIN-PGM ' TO PV-PARAGRAPH-NAME.     23116899
231169                                                                  23116999
231170     INITIALIZE XL001-ITEM-COMMAREA.                              23117099
231171                                                                  23117199
231172     MOVE DK-UPC-NBR            TO XL001-KEY-UPC-NBR.             23117299
231173     SET  XL001-BY-UPC-NBR      TO TRUE.                          23117399
231174     SET  XL001-SELECT-UPC                                        23117499
231175          XL001-SELECT-SKU                                        23117599
231176          XL001-SELECT-VND-STYL TO TRUE.                          23117699
231177                                                                  23117799
231178     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                23117899
231179                                                                  23117999
231180     MOVE XL001-UPC-SQLCODE     TO SQLCODE.                       23118099
231181                                                                  23118199
231182     EVALUATE TRUE                                                23118299
231183         WHEN XL001-UPC-SQLCODE = ZEROES                          23118399
231184              PERFORM 3410-INTERROGATE-SKU-SQLCODE                23118499
231185         WHEN XL001-UPC-NOT-FOUND                                 23118599
231186              CONTINUE                                            23118699
231187         WHEN XL001-UPC-CONTENTION                                23118799
231188              DISPLAY PV-PARAGRAPH-NAME                           23118899
231189              PERFORM 9999-SQL-ABEND                              23118999
231190         WHEN OTHER                                               23119099
231191              DISPLAY PV-PARAGRAPH-NAME                           23119199
231192              PERFORM 9999-SQL-ABEND                              23119299
231193     END-EVALUATE.                                                23119399
231194******************************************************************23119499
231195* 3410-INTERROGATE-SKU-SQLCODE.                                  *23119599
231196* ADDED THIS NEW PARAGRAPH TO CHECK THE RETURN CODE FROM XLV_SKU *23119699
231197* VIEW.                                      WR # 21361          *23119799
231198******************************************************************23119899
231199 3410-INTERROGATE-SKU-SQLCODE.                                    23119999
231200                                                                  23120099
231201     MOVE '3410-INTERROGATE-SKU-SQLCODE'                          23120199
231202                                 TO PV-PARAGRAPH-NAME.            23120299
231203                                                                  23120399
231204     MOVE XL001-SKU-SQLCODE      TO SQLCODE.                      23120499
231205                                                                  23120599
231206     EVALUATE TRUE                                                23120699
231207         WHEN XL001-SKU-SQLCODE = ZEROES                          23120799
231208              PERFORM 3420-INTERROGATE-VND-SQLCODE                23120899
231209         WHEN XL001-SKU-NOT-FOUND                                 23120999
231210              MOVE 'NOT FOUND' TO XL001-CSTM-CLOR-DESC            23121099
231211                                  XL001-SIZE-DESC                 23121199
231212         WHEN XL001-SKU-CONTENTION                                23121299
231213              DISPLAY PV-PARAGRAPH-NAME                           23121399
231214              PERFORM 9999-SQL-ABEND                              23121499
231215         WHEN OTHER                                               23121599
231216              DISPLAY PV-PARAGRAPH-NAME                           23121699
231217              PERFORM 9999-SQL-ABEND                              23121799
231218     END-EVALUATE.                                                23121899
231219                                                                  23121999
231220******************************************************************23122099
231221* 3420-INTERROGATE-VND-SQLCODE.                                  *23122199
231222* ADDED THIS NEW PARAGRAPH TO CHECK THE RETURN CODE FROM XLV_VND_*23122299
231223* STYL VIEW.                                 WR # 21361          *23122399
231224******************************************************************23122499
231225 3420-INTERROGATE-VND-SQLCODE.                                    23122599
231226                                                                  23122699
231227     MOVE '3420-INTERROGATE-VND-SQLCODE'                          23122799
231228                                 TO PV-PARAGRAPH-NAME.            23122899
231229                                                                  23122999
231230     MOVE XL001-VND-STYL-SQLCODE TO SQLCODE.                      23123099
231231                                                                  23123199
231232     EVALUATE TRUE                                                23123299
231233         WHEN XL001-VND-STYL-SQLCODE = ZEROES                     23123399
231234              CONTINUE                                            23123499
231235         WHEN XL001-VND-STYL-NOT-FOUND                            23123599
231236              MOVE 'NOT FOUND' TO XL001-VS-NBR                    23123699
231237         WHEN XL001-VND-STYL-CONTENTION                           23123799
231238              DISPLAY PV-PARAGRAPH-NAME                           23123899
231239              PERFORM 9999-SQL-ABEND                              23123999
231240         WHEN OTHER                                               23124099
231241              DISPLAY PV-PARAGRAPH-NAME                           23124199
231242              PERFORM 9999-SQL-ABEND                              23124299
231243     END-EVALUATE.                                                23124399
231244                                                                  23124499
231245******************************************************************23124599
231246*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *23124699
231247******************************************************************23124799
231248                                                                  23124899
231249******************************************************************23124999
231250*  SELECT THE VIOLATION EXCEPTION SHORT DESCRIPTION FROM THE     *23125099
231251*  VIOLATION MASTER FILE (TVILNCD).                              *23125199
231252******************************************************************23125299
231253 3700-FETCH-VILNCD-DESC.                                          23125399
231254                                                                  23125499
231255     INITIALIZE DCLTVILNCD.                                       23125599
231256                                                                  23125699
231257     MOVE '3700-FETCH-VILNCD-DESC     ' TO PV-PARAGRAPH-NAME.     23125799
231258                                                                  23125899
231259     EXEC SQL                                                     23125999
231260         SELECT                                                   23126099
231261                 VILN_CDE_SHRT_DESC                               23126199
231262         INTO                                                     23126299
231263                 :VILNCD-VILN-CDE-SHRT-DESC                       23126399
231264         FROM                                                     23126499
231265                 TVILNCD                                          23126599
231266         WHERE                                                    23126699
231267                 VILN_GP_CDE     = :SUEXCP-VILN-GP-CDE            23126799
231268           AND   VILN_GP_SEQ_NBR = :SUEXCP-VILN-GP-SEQ-NBR        23126899
231269     END-EXEC.                                                    23126999
231270                                                                  23127099
231271     EVALUATE TRUE                                                23127199
231272       WHEN SQLCODE = ZEROS                                       23127299
231273       WHEN SQLCODE = +100                                        23127399
231274         CONTINUE                                                 23127499
231275                                                                  23127599
231276       WHEN OTHER                                                 23127699
231277         DISPLAY PV-PARAGRAPH-NAME                                23127799
231278         DISPLAY 'VILN GP CDE     ' SUEXCP-VILN-GP-CDE            23127899
231279         DISPLAY 'VILN GP SEQ NBR ' SUEXCP-VILN-GP-SEQ-NBR        23127999
231280         PERFORM 9999-SQL-ABEND                                   23128099
231281     END-EVALUATE.                                                23128199
231282                                                                  23128299
231283*                                                                 23128399
231284* 02/06/14 DRW BEG                                                23128499
231285******************************************************************23128599
231286* 4000-CHECK-EXCEPTIONS. -- READ THE EXCEPTION TABLE TO DETERMINE 23128699
231287* IF ANY OTHER EXCEPTIONS OCCURRED FOR THIS ITEM.                 23128799
231288******************************************************************23128899
231289 4000-CHECK-EXCEPTIONS.                                           23128999
231290                                                                  23129099
231300***                                                               23130099
231400* USE QC-ERR-CSR FOR FOLLOWING COMBINATIONS OF                    23140099
231500* CC-SYSTEM-MANUAL-AUDIT          S/M                             23150099
231600*  CC-RFID-QC-AUDIT-IND           R/S                             23160099
231700*   CC-RFID-QC-AUD-CMB-IND        R/S/B                           23170099
231800* **S WHERE '*' REPRESENTS ANY POSSIBLE VALUE                     23180099
231900* SSB                                                             23190099
232000***                                                               23200099
232100     IF CC-QC-AUD-ONLY                                            23210099
232200             OR (CC-SYSTEM-GENERATED-AUDIT                        23220099
232300                 AND CC-QC-AUDIT                                  23230099
232400                 AND CC-QC-AND-RFID-AUD)                          23240099
232500         PERFORM 4011-OPEN-QC-ERR-CSR                             23250099
232600         PERFORM 4012-FETCH-QC-ERR-CSR                            23260099
232700                                                                  23270099
232800         PERFORM UNTIL PS-EOC-QC-ERR-CSR                          23280099
232900             PERFORM 3100-SETUP-DETAIL-LINES                      23290099
233000             PERFORM 4100-WRITE-EXCEPTIONS                        23300099
233100             PERFORM 4012-FETCH-QC-ERR-CSR                        23310099
233200         END-PERFORM                                              23320099
233300                                                                  23330099
233400         PERFORM 4013-CLOSE-QC-ERR-CSR                            23340099
233500                                                                  23350099
233600     END-IF.                                                      23360099
233700***                                                               23370099
233800* USE RFID-ERR-CSR-LT42 FOR FOLLOWING COMBINATIONS OF             23380099
233900* CC-SYSTEM-MANUAL-AUDIT          S/M                             23390099
234000*  CC-RFID-QC-AUDIT-IND           R/S                             23400099
234100*   CC-RFID-QC-AUD-CMB-IND        R/S/B                           23410099
234200* **R WHERE '*' REPRESENTS ANY POSSIBLE VALUE                     23420099
234300* SRB                                                             23430099
234400***                                                               23440099
234500     IF CC-RFID-AUD-ONLY                                          23450099
234600         OR (CC-SYSTEM-GENERATED-AUDIT                            23460099
234700             AND CC-RFID-AUDIT                                    23470099
234800             AND CC-QC-AND-RFID-AUD)                              23480099
234900         PERFORM 4021-OPEN-RFID-ERR-CSR-LT42                      23490099
235000         PERFORM 4022-FETCH-RFID-ERR-CSR-LT42                     23500099
235100                                                                  23510099
235200         PERFORM UNTIL PS-EOC-RFID-ERR-CSR-LT42                   23520099
235300             PERFORM 3100-SETUP-DETAIL-LINES                      23530099
235400             PERFORM 4100-WRITE-EXCEPTIONS                        23540099
235500             PERFORM 4022-FETCH-RFID-ERR-CSR-LT42                 23550099
235600         END-PERFORM                                              23560099
235700                                                                  23570099
235800         PERFORM 4023-CLOSE-RFID-ERR-CSR-LT42                     23580099
235900     END-IF.                                                      23590099
236000                                                                  23600099
236100***                                                               23610099
236200* USE RFID-ERR-CSR-EQ42 FOR FOLLOWING COMBINATIONS OF             23620099
236300* CC-SYSTEM-MANUAL-AUDIT          S/M                             23630099
236400*  CC-RFID-QC-AUDIT-IND           R/S                             23640099
236500*   CC-RFID-QC-AUD-CMB-IND        R/S/B                           23650099
236600* **R WHERE '*' REPRESENTS ANY POSSIBLE VALUE                     23660099
236700* SRB                                                             23670099
236800***                                                               23680099
236900     IF CC-RFID-AUD-ONLY                                          23690099
237000             OR (CC-SYSTEM-GENERATED-AUDIT                        23700099
237100                 AND CC-RFID-AUDIT                                23710099
237200                 AND CC-QC-AND-RFID-AUD)                          23720099
237300         PERFORM 4031-OPEN-RFID-ERR-CSR-EQ42                      23730099
237400         PERFORM 4032-FETCH-RFID-ERR-CSR-EQ42                     23740099
237500                                                                  23750099
237600         PERFORM UNTIL PS-EOC-RFID-ERR-CSR-EQ42                   23760099
237700             PERFORM 3100-SETUP-DETAIL-LINES                      23770099
237800             PERFORM 4100-WRITE-EXCEPTIONS                        23780099
237900             PERFORM 4032-FETCH-RFID-ERR-CSR-EQ42                 23790099
238000         END-PERFORM                                              23800099
238100                                                                  23810099
238200         PERFORM 4033-CLOSE-RFID-ERR-CSR-EQ42                     23820099
238300     END-IF.                                                      23830099
238400* 02/06/14 DRW END                                                23840099
238500                                                                  23850099
238600                                                                  23860099
238700* 02/06/14 DRW BEG                                                23870099
238800******************************************************************23880099
238900* 4011-OPEN-QC-ERR-CSR.                                          *23890099
239000******************************************************************23900099
239100 4011-OPEN-QC-ERR-CSR.                                            23910099
239200                                                                  23920099
239300     EXEC SQL                                                     23930099
239400         OPEN QC_ERR_CSR                                          23940099
239500     END-EXEC.                                                    23950099
239600                                                                  23960099
239700     EVALUATE TRUE                                                23970099
239800         WHEN SQLCODE = ZERO                                      23980099
239900             SET PS-NOT-EOC-QC-ERR-CSR TO TRUE                    23990099
240000                                                                  24000099
240100         WHEN SQLWARN0 NOT EQUAL SPACE                            24010099
240200         WHEN SQLCODE NOT EQUAL ZERO                              24020099
240300             DISPLAY 'AUDIT CNTL NBR: '                           24030099
240400                                     DK-AUD-CNTL-NBR              24040099
240500             DISPLAY 'SHIPT UNT ID:   '                           24050099
240600                                     DK-SHIPT-UNT-ID              24060099
240700             DISPLAY 'UPC NBR:        '                           24070099
240800                                     DK-UPC-NBR                   24080099
240900             MOVE '4011-OPEN-QC-ERR-CSR'                          24090099
241000                               TO  PV-PARAGRAPH-NAME              24100099
241100             PERFORM 9999-SQL-ABEND                               24110099
241200     END-EVALUATE.                                                24120099
241300                                                                  24130099
241400******************************************************************24140099
241500* 4012-FETCH-QC-ERR-CSR.                                         *24150099
241600*  FETCH THE NEXT OCCURANCE OF THE EXCEPTION_CURSOR              *24160099
241700******************************************************************24170099
241800 4012-FETCH-QC-ERR-CSR.                                           24180099
241900                                                                  24190099
242000     EXEC SQL                                                     24200099
242100         FETCH QC_ERR_CSR                                         24210099
242200         INTO    :SUEXCP-VILN-GP-SEQ-NBR                          24220099
242300               , :VILNCD-VILN-CDE-SHRT-DESC                       24230099
242400               , :SUEXCP-OVRRID-SYS-DAT-TXT                       24240099
242500               , :PV-DB2-EXCEPTION-COUNT                          24250099
242600     END-EXEC.                                                    24260099
242700                                                                  24270099
242800     EVALUATE TRUE                                                24280099
242900         WHEN SQLCODE = ZERO                                      24290099
243000*            COMPUTE PV-DL-EXCEPTION-COUNT =                      24300099
243100*                PV-DB2-EXCEPTION-COUNT                           24310099
243200*            IF PV-DL-EXCEPTION-COUNT < 0                         24320099
243300*                COMPUTE PV-DL-EXCEPTION-COUNT =                  24330099
243400*                    PV-DL-EXCEPTION-COUNT * -1                   24340099
243500*            END-IF                                               24350099
243600*            MOVE PV-DL-EXCEPTION-COUNT                           24360099
243700*                               TO DL1-QTY-IN-ERROR               24370099
243800             MOVE VILNCD-VILN-CDE-SHRT-DESC                       24380099
243900                                TO DL1-VILN-CDE-SHRT-DESC         24390099
244000             IF PV-DB2-EXCEPTION-COUNT > 0                        24400099
244100                MOVE PV-DB2-EXCEPTION-COUNT                       24410099
244200                                    TO DL1-QTY-IN-ERROR           24420099
244300                                       PV-DL-EXCEPTION-COUNT      24430099
244400             ELSE                                                 24440099
244500                MOVE ZERO           TO DL1-QTY-IN-ERROR           24450099
244600                                       PV-DL-EXCEPTION-COUNT      24460099
244700             END-IF                                               24470099
244800                                                                  24480099
244900         WHEN SQLCODE = +100                                      24490099
245000             MOVE ZEROS                  TO PV-DL-EXCEPTION-COUNT 24500099
245100             SET PS-EOC-QC-ERR-CSR       TO TRUE                  24510099
245200                                                                  24520099
245300         WHEN SQLWARN0 NOT EQUAL SPACE                            24530099
245400         WHEN SQLCODE NOT EQUAL ZERO                              24540099
245500             DISPLAY 'AUDIT CNTL NBR:  '                          24550099
245600                                     DK-AUD-CNTL-NBR              24560099
245700             DISPLAY 'SHIPT UNT ID:    '                          24570099
245800                                     DK-SHIPT-UNT-ID              24580099
245900             DISPLAY 'UPC NBR:         '                          24590099
246000                                     DK-UPC-NBR                   24600099
246100             MOVE '4012-FETCH-QC-ERR-CSR'                         24610099
246200                               TO  PV-PARAGRAPH-NAME              24620099
246300             PERFORM 9999-SQL-ABEND                               24630099
246400     END-EVALUATE.                                                24640099
246500                                                                  24650099
246600******************************************************************24660099
246700* 4013-CLOSE-QC-ERR-CSR.                                         *24670099
246800******************************************************************24680099
246900 4013-CLOSE-QC-ERR-CSR.                                           24690099
247000                                                                  24700099
247100     EXEC SQL                                                     24710099
247200         CLOSE QC_ERR_CSR                                         24720099
247300     END-EXEC.                                                    24730099
247400                                                                  24740099
247500     EVALUATE TRUE                                                24750099
247600         WHEN SQLCODE = ZERO                                      24760099
247700             CONTINUE                                             24770099
247800                                                                  24780099
247900         WHEN SQLWARN0 NOT EQUAL SPACE                            24790099
248000         WHEN SQLCODE NOT EQUAL ZERO                              24800099
248100             DISPLAY 'AUDIT CNTL NBR:  '                          24810099
248200                                     DK-AUD-CNTL-NBR              24820099
248300             DISPLAY 'SHIPT UNT ID:    '                          24830099
248400                                     DK-SHIPT-UNT-ID              24840099
248500             DISPLAY 'UPC NBR:         '                          24850099
248600                                     DK-UPC-NBR                   24860099
248700             MOVE '4013-CLOSE-QC-ERR-CSR'                         24870099
248800                               TO  PV-PARAGRAPH-NAME              24880099
248900             PERFORM 9999-SQL-ABEND                               24890099
249000     END-EVALUATE.                                                24900099
249100                                                                  24910099
249200******************************************************************24920099
249300* 4021-OPEN-RFID-ERR-CSR-LT42                                    *24930099
249400******************************************************************24940099
249500 4021-OPEN-RFID-ERR-CSR-LT42.                                     24950099
249600                                                                  24960099
249700     EXEC SQL                                                     24970099
249800         OPEN RFID_ERR_CSR_LT42                                   24980099
249900     END-EXEC.                                                    24990099
250000                                                                  25000099
250100     EVALUATE TRUE                                                25010099
250200         WHEN SQLCODE = ZERO                                      25020099
250300             SET PS-NOT-EOC-RFID-ERR-CSR-LT42 TO TRUE             25030099
250400                                                                  25040099
250500         WHEN SQLWARN0 NOT EQUAL SPACE                            25050099
250600         WHEN SQLCODE NOT EQUAL ZERO                              25060099
250700             DISPLAY 'AUDIT CNTL NBR:  '                          25070099
250800                                     DK-AUD-CNTL-NBR              25080099
250900             DISPLAY 'SHIPT UNT ID:    '                          25090099
251000                                     DK-SHIPT-UNT-ID              25100099
251100             DISPLAY 'UPC NBR:         '                          25110099
251200                                     DK-UPC-NBR                   25120099
251300             MOVE '4021-OPEN-RFID-ERR-CSR-LT42'                   25130099
251400                               TO  PV-PARAGRAPH-NAME              25140099
251500             PERFORM 9999-SQL-ABEND                               25150099
251600     END-EVALUATE.                                                25160099
251700                                                                  25170099
251800******************************************************************25180099
251900* 4022-FETCH-RFID-ERR-CSR-LT42                                   *25190099
252000******************************************************************25200099
252100 4022-FETCH-RFID-ERR-CSR-LT42.                                    25210099
252200                                                                  25220099
252300     EXEC SQL                                                     25230099
252400         FETCH RFID_ERR_CSR_LT42                                  25240099
252500         INTO    :SUEXCP-VILN-GP-SEQ-NBR                          25250099
252600               , :VILNCD-VILN-CDE-SHRT-DESC                       25260099
252700               , :SUEXCP-OVRRID-SYS-DAT-TXT                       25270099
252800               , :PV-DB2-EXCEPTION-COUNT                          25280099
252900               , :PV-DB2-RFID-EXCP-COUNT                          25290099
253000     END-EXEC.                                                    25300099
253100                                                                  25310099
253200     EVALUATE TRUE                                                25320099
253300         WHEN SQLCODE = ZERO                                      25330099
253400*            COMPUTE PV-DL-EXCEPTION-COUNT =                      25340099
253500*                PV-DB2-EXCEPTION-COUNT - PV-DB2-RFID-EXCP-COUNT  25350099
253600*            IF PV-DL-EXCEPTION-COUNT < 0                         25360099
253700*                COMPUTE PV-DL-EXCEPTION-COUNT =                  25370099
253800*                    PV-DL-EXCEPTION-COUNT * -1                   25380099
253900*            END-IF                                               25390099
254000*            MOVE PV-DL-EXCEPTION-COUNT                           25400099
254100*                               TO DL1-QTY-IN-ERROR               25410099
254200             MOVE VILNCD-VILN-CDE-SHRT-DESC                       25420099
254300                                TO DL1-VILN-CDE-SHRT-DESC         25430099
254400             IF SUEXCP-VILN-GP-SEQ-NBR = 38                       25440099
254500                MOVE 1              TO DL1-QTY-IN-ERROR           25450099
254600                                       PV-DL-EXCEPTION-COUNT      25460099
254700             ELSE                                                 25470099
254800                IF PV-DB2-RFID-EXCP-COUNT > 0                     25480099
254900                   MOVE PV-DB2-RFID-EXCP-COUNT                    25490099
255000                                    TO DL1-QTY-IN-ERROR           25500099
255100                                       PV-DL-EXCEPTION-COUNT      25510099
255200                ELSE                                              25520099
255300                  IF PV-DB2-EXCEPTION-COUNT > 0                   25530099
255400                     MOVE PV-DB2-EXCEPTION-COUNT                  25540099
255500                                    TO DL1-QTY-IN-ERROR           25550099
255600                                       PV-DL-EXCEPTION-COUNT      25560099
255700                  ELSE                                            25570099
255800                     MOVE ZERO      TO DL1-QTY-IN-ERROR           25580099
255900                                       PV-DL-EXCEPTION-COUNT      25590099
256000                  END-IF                                          25600099
256100                END-IF                                            25610099
256200             END-IF                                               25620099
256300                                                                  25630099
256400         WHEN SQLCODE = +100                                      25640099
256500             SET PS-EOC-RFID-ERR-CSR-LT42 TO TRUE                 25650099
256600                                                                  25660099
256700         WHEN SQLWARN0 NOT EQUAL SPACE                            25670099
256800         WHEN SQLCODE NOT EQUAL ZERO                              25680099
256900             DISPLAY 'AUDIT CNTL NBR:  '                          25690099
257000                                     DK-AUD-CNTL-NBR              25700099
257100             DISPLAY 'SHIPT UNT ID:    '                          25710099
257200                                     DK-SHIPT-UNT-ID              25720099
257300             DISPLAY 'UPC NBR:         '                          25730099
257400                                     DK-UPC-NBR                   25740099
257500             MOVE '4022-FETCH-RFID-ERR-CSR-LT42'                  25750099
257600                               TO  PV-PARAGRAPH-NAME              25760099
257700             PERFORM 9999-SQL-ABEND                               25770099
257800     END-EVALUATE.                                                25780099
257900                                                                  25790099
258000******************************************************************25800099
258100* 4023-CLOSE-RFID-ERR-CSR-LT42                                   *25810099
258200******************************************************************25820099
258300 4023-CLOSE-RFID-ERR-CSR-LT42.                                    25830099
258400                                                                  25840099
258500     EXEC SQL                                                     25850099
258600         CLOSE RFID_ERR_CSR_LT42                                  25860099
258700     END-EXEC.                                                    25870099
258800                                                                  25880099
258900     EVALUATE TRUE                                                25890099
259000         WHEN SQLCODE = ZERO                                      25900099
259100             CONTINUE                                             25910099
259200                                                                  25920099
259300         WHEN SQLWARN0 NOT EQUAL SPACE                            25930099
259400         WHEN SQLCODE NOT EQUAL ZERO                              25940099
259500             DISPLAY 'AUDIT CNTL NBR:  '                          25950099
259600                                     DK-AUD-CNTL-NBR              25960099
259700             DISPLAY 'SHIPT UNT ID:    '                          25970099
259800                                     DK-SHIPT-UNT-ID              25980099
259900             DISPLAY 'UPC NBR:         '                          25990099
260000                                     DK-UPC-NBR                   26000099
260100             MOVE '4023-CLOSE-RFID-ERR-CSR-LT42'                  26010099
260200                               TO  PV-PARAGRAPH-NAME              26020099
260300             PERFORM 9999-SQL-ABEND                               26030099
260400     END-EVALUATE.                                                26040099
260500                                                                  26050099
260600******************************************************************26060099
260700* 4031-OPEN-RFID-ERR-CSR-EQ42                                    *26070099
260800******************************************************************26080099
260900 4031-OPEN-RFID-ERR-CSR-EQ42.                                     26090099
261000                                                                  26100099
261100     EXEC SQL                                                     26110099
261200         OPEN RFID_ERR_CSR_EQ42                                   26120099
261300     END-EXEC.                                                    26130099
261400                                                                  26140099
261500     EVALUATE TRUE                                                26150099
261600         WHEN SQLCODE = ZERO                                      26160099
261700             SET PS-NOT-EOC-RFID-ERR-CSR-EQ42 TO TRUE             26170099
261800                                                                  26180099
261900         WHEN SQLWARN0 NOT EQUAL SPACE                            26190099
262000         WHEN SQLCODE NOT EQUAL ZERO                              26200099
262100             DISPLAY 'AUDIT CNTL NBR:  '                          26210099
262200                                     DK-AUD-CNTL-NBR              26220099
262300             DISPLAY 'SHIPT UNT ID:    '                          26230099
262400                                     DK-SHIPT-UNT-ID              26240099
262500             DISPLAY 'UPC NBR:         '                          26250099
262600                                     DK-UPC-NBR                   26260099
262700             MOVE '4031-OPEN-RFID-ERR-CSR-EQ42'                   26270099
262800                               TO  PV-PARAGRAPH-NAME              26280099
262900              PERFORM 9999-SQL-ABEND                              26290099
263000     END-EVALUATE.                                                26300099
263100                                                                  26310099
263200******************************************************************26320099
263300* 4032-FETCH-RFID-ERR-CSR-EQ42                                   *26330099
263400******************************************************************26340099
263500 4032-FETCH-RFID-ERR-CSR-EQ42.                                    26350099
263600                                                                  26360099
263700     EXEC SQL                                                     26370099
263800         FETCH RFID_ERR_CSR_EQ42                                  26380099
263900         INTO    :SUEXCP-VILN-GP-SEQ-NBR                          26390099
264000               , :VILNCD-VILN-CDE-SHRT-DESC                       26400099
264100               , :SUEXCP-OVRRID-SYS-DAT-TXT                       26410099
264200               , :PV-DB2-EXCEPTION-COUNT                          26420099
264300               , :PV-DB2-RFID-EXCP-COUNT                          26430099
264400     END-EXEC.                                                    26440099
264500                                                                  26450099
264600     EVALUATE TRUE                                                26460099
264700         WHEN SQLCODE = ZERO                                      26470099
264800             COMPUTE PV-DL-EXCEPTION-COUNT =                      26480099
264900                 PV-DB2-EXCEPTION-COUNT - PV-DB2-RFID-EXCP-COUNT  26490099
265000             IF PV-DL-EXCEPTION-COUNT < 0                         26500099
265100                 COMPUTE PV-DL-EXCEPTION-COUNT =                  26510099
265200                     PV-DL-EXCEPTION-COUNT * -1                   26520099
265300             END-IF                                               26530099
265400             MOVE PV-DL-EXCEPTION-COUNT                           26540099
265500                                TO DL1-QTY-IN-ERROR               26550099
265600             MOVE VILNCD-VILN-CDE-SHRT-DESC                       26560099
265700                                TO DL1-VILN-CDE-SHRT-DESC         26570099
265800                                                                  26580099
265900         WHEN SQLCODE = +100                                      26590099
266000             SET PS-EOC-RFID-ERR-CSR-EQ42    TO TRUE              26600099
266100                                                                  26610099
266200         WHEN SQLWARN0 NOT EQUAL SPACE                            26620099
266300         WHEN SQLCODE NOT EQUAL ZERO                              26630099
266400             DISPLAY 'AUDIT CNTL NBR:  '                          26640099
266500                                     DK-AUD-CNTL-NBR              26650099
266600             DISPLAY 'SHIPT UNT ID:    '                          26660099
266700                                     DK-SHIPT-UNT-ID              26670099
266800             DISPLAY 'UPC NBR:         '                          26680099
266900                                     DK-UPC-NBR                   26690099
267000             MOVE '4032-FETCH-RFID-ERR-CSR-EQ42'                  26700099
267100                               TO  PV-PARAGRAPH-NAME              26710099
267200             PERFORM 9999-SQL-ABEND                               26720099
267300     END-EVALUATE.                                                26730099
267400                                                                  26740099
267500******************************************************************26750099
267600* 4033-CLOSE-RFID-ERR-CSR-EQ42                                   *26760099
267700******************************************************************26770099
267800 4033-CLOSE-RFID-ERR-CSR-EQ42.                                    26780099
267900                                                                  26790099
268000     EXEC SQL                                                     26800099
268100         CLOSE RFID_ERR_CSR_EQ42                                  26810099
268200     END-EXEC.                                                    26820099
268300                                                                  26830099
268400     EVALUATE TRUE                                                26840099
268500         WHEN SQLCODE = ZERO                                      26850099
268600             CONTINUE                                             26860099
268700                                                                  26870099
268800         WHEN SQLWARN0 NOT EQUAL SPACE                            26880099
268900         WHEN SQLCODE NOT EQUAL ZERO                              26890099
269000             DISPLAY 'AUDIT CNTL NBR:  '                          26900099
269100                                     DK-AUD-CNTL-NBR              26910099
269200             DISPLAY 'SHIPT UNT ID:    '                          26920099
269300                                     DK-SHIPT-UNT-ID              26930099
269400             DISPLAY 'UPC NBR:         '                          26940099
269500                                     DK-UPC-NBR                   26950099
269600             MOVE '4033-CLOSE-RFID-ERR-CSR-EQ42'                  26960099
269700                               TO  PV-PARAGRAPH-NAME              26970099
269800             PERFORM 9999-SQL-ABEND                               26980099
269900     END-EVALUATE.                                                26990099
270000* 02/06/14 DRW END                                                27000099
270100                                                                  27010099
270200* 02/06/14 DRW BEG                                                27020099
270300******************************************************************27030099
270400* 4100-WRITE-EXCEPTIONS                                          *27040099
270500*  FOR EACH EXCEPTION FETCHED FROM THE CURSOR, WRITE A DETAIL    *27050099
270600*  LINE                                                          *27060099
270700******************************************************************27070099
270800 4100-WRITE-EXCEPTIONS.                                           27080099
270801                                                                  27080199
270802     PERFORM 3200-FETCH-TSUAUPC-INFO.                             27080299
270803                                                                  27080399
270804     IF  PS-DETAIL-FROM-TSUAUPC                                   27080499
270805*        MOVE SUAUPC-SKU-DEPT-NBR  TO DL1-SKU-DEPT-NBR            27080599
270806         MOVE SUAUPC-SUB-CL-NBR    TO PV-SUB-CL-NBR               27080699
270807         MOVE PV-SUB-CL-NBR        TO PV-SUB-CL-NBR-9             27080799
270808         MOVE PV-SUB-CL-3-4        TO DL1-SKU-CL-NBR              27080899
270809         MOVE SUAUPC-SKU-NBR       TO DL1-SKU-NBR                 27080999
270810         MOVE SUAUPC-UPC-NBR       TO DL1-UPC-NBR                 27081099
270811*        MOVE SUAUPC-SKU-SEQ-NBR   TO DL1-SKU-SEQ-NBR             27081199
270812         MOVE SUAUPC-VND-STYL-DESC TO DL1-VND-STYL-DESC           27081299
270813         MOVE SUAUPC-UPC-CLOR-DESC TO DL1-UPC-CLOR-DESC           27081399
270814         MOVE SUAUPC-UPC-SIZE-DESC TO DL1-UPC-SIZE-DESC           27081499
270815     ELSE                                                         27081599
270816         MOVE XL001-VS-NBR         TO DL1-VND-STYL-DESC           27081699
270817         MOVE XL001-CSTM-CLOR-DESC TO DL1-UPC-CLOR-DESC           27081799
270818         MOVE XL001-SIZE-DESC      TO DL1-UPC-SIZE-DESC           27081899
270819     END-IF                                                       27081999
270820                                                                  27082099
270830**gb PERFORM 5100-FILL-IN-DETAIL-LINE.                            27083099
270840                                                                  27084099
270850     EVALUATE SUEXCP-VILN-GP-SEQ-NBR                              27085099
270860                                                                  27086099
270870       WHEN PC-STYLE-SUB                                          27087099
270880       WHEN PC-WRONG-TICKET-STYLE                                 27088099
270890       WHEN PC-WRONG-MDSE-LBL-STYLE                               27089099
270900           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27090099
271000                                      TO DL1-RECEIVED-AS-INFO     27100099
271100           MOVE 'STY'                 TO DL1-ERROR-TYPE           27110099
271200           MOVE SUAUPC-VND-STYL-DESC  TO DL1-ORDERED-AS-INFO      27120099
271300                                                                  27130099
271400       WHEN PC-WRONG-TICKET-DEPT                                  27140099
271500           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27150099
271600                                      TO DL1-RECEIVED-AS-INFO     27160099
271700           MOVE 'DPT'                 TO DL1-ERROR-TYPE           27170099
271800           MOVE XL001-DEPT-NBR-3CH    TO DL1-ORDERED-AS-INFO      27180099
271900                                                                  27190099
272000       WHEN PC-WRONG-TICKET-RETAIL                                27200099
272100       WHEN PC-WRONG-MDSE-LBL-RETAIL                              27210099
272200           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27220099
272300                                      TO DL1-RECEIVED-AS-INFO     27230099
272400           MOVE 'RTL'                 TO DL1-ERROR-TYPE           27240099
272500           MOVE SUAUPC-UPC-RTL-AMT    TO PV-DISP-DEC              27250099
272600           MOVE PV-DISP-DEC           TO DL1-ORDERED-AS-INFO      27260099
272700                                                                  27270099
272800       WHEN PC-WRONG-TICKET-COLOR                                 27280099
272900       WHEN PC-WRONG-MDSE-LBL-COLOR                               27290099
273000           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27300099
273100                                      TO DL1-RECEIVED-AS-INFO     27310099
273200           MOVE 'CLR'                 TO DL1-ERROR-TYPE           27320099
273300           MOVE SUAUPC-UPC-CLOR-DESC  TO DL1-ORDERED-AS-INFO      27330099
273400                                                                  27340099
273500       WHEN PC-WRONG-TICKET-SIZE                                  27350099
273600       WHEN PC-WRONG-MDSE-LBL-SIZE                                27360099
273700           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27370099
273800                                      TO DL1-RECEIVED-AS-INFO     27380099
273900           MOVE 'SZE'                 TO DL1-ERROR-TYPE           27390099
274000           MOVE SUAUPC-UPC-SIZE-DESC  TO DL1-ORDERED-AS-INFO      27400099
274100                                                                  27410099
274200                                                                  27420099
274300                                                                  27430099
274400       WHEN PC-WRONG-TICKET-MAJ-CLS                               27440099
274500           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27450099
274600                                      TO DL1-RECEIVED-AS-INFO     27460099
274700           MOVE 'MCLS'                TO DL1-ERROR-TYPE           27470099
274800           MOVE XL001-MAJ-CL-NBR-2CH  TO DL1-ORDERED-AS-INFO      27480099
274900                                                                  27490099
275000       WHEN PC-WRONG-TICKET-SUB-CLS                               27500099
275100           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27510099
275200                                      TO DL1-RECEIVED-AS-INFO     27520099
275300           MOVE 'SCLS'                TO DL1-ERROR-TYPE           27530099
275400           MOVE XL001-SUB-CL-NBR-2CH  TO DL1-ORDERED-AS-INFO      27540099
275500                                                                  27550099
275600       WHEN PC-WRONG-BOX-ID                                       27560099
275700       WHEN PC-WRONG-TKT-MDSE-OK                                  27570099
275800       WHEN PC-RFID-UPC-MISPCK                                    27580099
275900           MOVE SPACES                TO DL1-RECEIVED-AS-INFO     27590099
276000           MOVE 'UNT'                 TO DL1-ERROR-TYPE           27600099
276100           MOVE SPACES                TO DL1-ORDERED-AS-INFO      27610099
276200       WHEN PC-WRG-RFD-TGS-CLR                                    27620099
276300           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27630099
276400                                      TO DL1-RECEIVED-AS-INFO     27640099
276500           MOVE 'CLR'                 TO DL1-ERROR-TYPE           27650099
276600           MOVE SUAUPC-UPC-CLOR-DESC  TO DL1-ORDERED-AS-INFO      27660099
276700       WHEN PC-WRG-RFD-TGS-SIZ                                    27670099
276800           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27680099
276900                                      TO DL1-RECEIVED-AS-INFO     27690099
277000           MOVE 'SZE'                 TO DL1-ERROR-TYPE           27700099
277100           MOVE SUAUPC-UPC-SIZE-DESC  TO DL1-ORDERED-AS-INFO      27710099
277200       WHEN PC-WRG-RFD-TGS-STL                                    27720099
277300           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         27730099
277400                                      TO DL1-RECEIVED-AS-INFO     27740099
277500           MOVE 'STL'                 TO DL1-ERROR-TYPE           27750099
277600           MOVE SUAUPC-VND-STYL-DESC  TO DL1-ORDERED-AS-INFO      27760099
277700       WHEN PC-VA-NO-EPC-LOGO                                     27770099
277800           MOVE SPACES                TO DL1-RECEIVED-AS-INFO     27780099
277900           MOVE 'UNT'                 TO DL1-ERROR-TYPE           27790099
278000           MOVE SPACES                TO DL1-ORDERED-AS-INFO      27800099
278100                                                                  27810099
278200       WHEN OTHER                                                 27820099
278300           PERFORM 4110-PROCESS-OTHER                             27830099
278400                                                                  27840099
278500     END-EVALUATE.                                                27850099
278600                                                                  27860099
278700     IF PV-DL-EXCEPTION-COUNT > 0                                 27870099
278701         PERFORM 8400-WRITE-DETAIL-LINES                          27870199
278702         ADD 1                         TO PV-LINE-CNT             27870299
278703                                                                  27870399
278704         PERFORM 4200-ACCUM-SUM-TABLES                            27870499
278705     END-IF.                                                      27870599
278706                                                                  27870699
278707*                                                                 27870799
278708******************************************************************27870899
278709* 4110-PROCESS-OTHER.                                             27870999
278710******************************************************************27871099
278720 4110-PROCESS-OTHER.                                              27872099
278730                                                                  27873099
278740     IF DL1-VILN-CDE-SHRT-DESC = 'VENDOR OVER'                    27874099
278750         OR DL1-VILN-CDE-SHRT-DESC = 'VENDOR SHORT'               27875099
278760         OR DL1-VILN-CDE-SHRT-DESC = 'VND OVER/MISPCK'            27876099
278770         MOVE SU003-QTY-EXP OF SU003-COPYBOOK                     27877099
278780                                  TO PV-DISP-COMP                 27878099
278790         MOVE PV-DISP-COMP        TO DL1-ORDERED-AS-INFO          27879099
278800         MOVE SU003-QTY-AUD OF SU003-COPYBOOK                     27880099
278900                                  TO PV-DISP-COMP                 27890099
279000         MOVE PV-DISP-COMP        TO DL1-RECEIVED-AS-INFO         27900099
279100         IF SU003-QTY-AUD OF SU003-COPYBOOK = ZEROS               27910099
279200             MOVE ZEROS           TO PV-DISP-COMP                 27920099
279300             MOVE PV-DISP-COMP    TO DL1-RECEIVED-AS-INFO         27930099
279400             MOVE SU003-QTY-EXP OF SU003-COPYBOOK                 27940099
279500                                  TO PV-DISP-COMP                 27950099
279600             MOVE PV-DISP-COMP    TO DL1-ORDERED-AS-INFO          27960099
279700         END-IF                                                   27970099
279800     END-IF.                                                      27980099
279900                                                                  27990099
280000******************************************************************28000099
280100* 5100-FILL-IN-DETAIL-LINE                                        28010099
280200*  MOVE THE APPROPRIATE FILE FIELDS TO THE DETAIL LINE -- FETCH   28020099
280300*  ANY OTHER DATA FROM DB2 AND MOVE TO THE DETAIL LINE.           28030099
280400******************************************************************28040099
280500 5100-FILL-IN-DETAIL-LINE.                                        28050099
280600                                                                  28060099
280700******************************************************************28070099
280800*   REMOVED MOVE STATEMENT FOR DEPT AND REPLACED THE MOVE STATE- *28080099
280900*   MENT FOR SEQ NBR WITH SKU NBR. ALSO REPLACED SU003-SKU-SEQ-  *28090099
281000*   -NBR WITH SU003-SKU-NMBR AND DL-SKU-NBR-SEQ WITH DL-SKU-NBR- *28100099
281100*   8DGT AND PV-HOLD-SKU-SEQ WITH PV-HOLD-SKU-NMBR.              *28110099
281200*   REPLACE PERFORM 5300-GET-UPC-INFO-FROM-VSM STATEMENT WITH    *28120099
281300*   PERFORM 5300-CALL-XLKUT-DOMAIN-PGM. ALSO REPLACE UPC-CSTM-   *28130099
281400*   CLOR-DESC WITH XL001-CSTM-CLOR-DESC, VNDSTL-VS-NBR WITH      *28140099
281500*   XL001-VS-NBR AND SIZE-KOHLS-DESC WITH XL001-SIZE-DESC.       *28150099
281600*                                              WR # 21361        *28160099
281700******************************************************************28170099
281800*    IF SU003-SKU-NBR OF OS-SKU-FILE = PV-HOLD-SKU-NBR            28180099
281900*    AND PV-HOLD-SKU-NBR NOT EQUAL '00000000'                     28190099
282000*        MOVE SPACES                  TO DL1-SKU-CL-NBR           28200099
282100*                                        DL1-SKU-NBR              28210099
282200*    ELSE                                                         28220099
282300         MOVE SU003-SKU-CL-NBR OF OS-SKU-FILE                     28230099
282400                                      TO DL1-SKU-CL-NBR           28240099
282500                                         PV-HOLD-SKU-CL           28250099
282600         MOVE SU003-SKU-NMBR   OF OS-SKU-FILE                     28260099
282700                                      TO DL1-SKU-NBR              28270099
282800                                         PV-HOLD-SKU-NMBR         28280099
282900         SET PS-PRINT-SKU-ORD TO TRUE                             28290099
283000*    END-IF.                                                      28300099
283100*                                                                 28310099
283200     IF SU003-UPC OF OS-SKU-FILE = PV-HOLD-UPC-NBR                28320099
283300     AND PV-HOLD-UPC-NBR > 0                                      28330099
283400         MOVE SPACES                  TO DL1-UPC-NBR-X            28340099
283500         MOVE SPACES                  TO DL1-SKU-CL-NBR           28350099
283600                                         DL1-SKU-NBR              28360099
283700     ELSE                                                         28370099
283800*        WRITE CARTON-AUDIT-RPT-RECORD                            28380099
283900*            FROM PC-BLANK-LINE                                   28390099
284000*            AFTER ADVANCING 1 LINES                              28400099
284100*        ADD +1 TO PV-LINE-CNT                                    28410099
284200         MOVE SU003-UPC OF OS-SKU-FILE TO DL1-UPC-NBR             28420099
284300                                          DK-UPC-NBR              28430099
284400                                          PV-HOLD-UPC-NBR         28440099
284500*        IF SOMETHING WAS AUDITED, GET THE UPC INFO FROM THE      28450099
284600*        AUDIT TABLES, OTHERWISE GET THEM FROM VSM                28460099
284700         IF SU003-QTY-AUD OF OS-SKU-FILE > 0                      28470099
284800             PERFORM 5210-GET-UPC-INFO-FROM-AUDIT                 28480099
284900             MOVE SUAUPC-UPC-CLOR-DESC    TO DL1-UPC-CLOR-DESC    28490099
285000             MOVE SUAUPC-VND-STYL-DESC    TO DL1-VND-STYL-DESC    28500099
285100             MOVE SUAUPC-UPC-SIZE-DESC    TO DL1-UPC-SIZE-DESC    28510099
285200             PERFORM 5300-CALL-XLKUT-DOMAIN-PGM                   28520099
285300         ELSE                                                     28530099
285400             PERFORM 5300-CALL-XLKUT-DOMAIN-PGM                   28540099
285500             MOVE XL001-CSTM-CLOR-DESC    TO DL1-UPC-CLOR-DESC    28550099
285600             MOVE XL001-VS-NBR            TO DL1-VND-STYL-DESC    28560099
285700             MOVE XL001-SIZE-DESC         TO DL1-UPC-SIZE-DESC    28570099
285800         END-IF                                                   28580099
285900                                                                  28590099
286000     END-IF.                                                      28600099
286100                                                                  28610099
286200******************************************************************28620099
286300*  5210-GET-UPC-INFO-FROM-AUDIT.                                  28630099
286400*  SELECT THE COLOR CODE FROM THE UPC TABLE                       28640099
286500******************************************************************28650099
286600 5210-GET-UPC-INFO-FROM-AUDIT.                                    28660099
286700                                                                  28670099
286800     INITIALIZE DCLTSUAUPC.                                       28680099
286900                                                                  28690099
287000     EXEC SQL                                                     28700099
287100         OPEN UPC_CURSOR                                          28710099
287200     END-EXEC.                                                    28720099
287300                                                                  28730099
287400     EVALUATE TRUE                                                28740099
287500         WHEN SQLCODE = ZERO                                      28750099
287600              CONTINUE                                            28760099
287700         WHEN SQLWARN0 NOT EQUAL SPACE                            28770099
287800         WHEN SQLCODE NOT EQUAL ZERO                              28780099
287900              DISPLAY 'AUD CNTL NBR '  SUAUPC-AUD-CNTL-NBR        28790099
288000              DISPLAY 'SHIPT UNT ID '  SUAUPC-SHIPT-UNT-ID        28800099
288100              DISPLAY 'UPC NBR: '      SUAUPC-UPC-NBR             28810099
288200              MOVE '5210-GET-UPC-INFO-FROM-AUDIT'                 28820099
288300                               TO  PV-PARAGRAPH-NAME              28830099
288400              PERFORM 9999-SQL-ABEND                              28840099
288500     END-EVALUATE.                                                28850099
288600                                                                  28860099
288700******************************************************************28870099
288800*  FETCHED SKU NBR INSTEAD OF DEPT, CLASS AND SEQ NBR.           *28880099
288900*                                                  WR # 21361    *28890099
289000******************************************************************28900099
289100     EXEC SQL                                                     28910099
289200         FETCH UPC_CURSOR                                         28920099
289300         INTO                                                     28930099
289400               :SUAUPC-SKU-NBR                                    28940099
289500             , :SUAUPC-ITM-DESC                                   28950099
289600             , :SUAUPC-VND-STYL-DESC                              28960099
289700             , :SUAUPC-UPC-CLOR-DESC                              28970099
289800             , :SUAUPC-UPC-SIZE-DESC                              28980099
289900             , :SUAUPC-UPC-RTL-AMT                                28990099
290000     END-EXEC.                                                    29000099
290100                                                                  29010099
290200     EVALUATE TRUE                                                29020099
290300         WHEN SQLCODE = ZERO                                      29030099
290400              CONTINUE                                            29040099
290500         WHEN SQLCODE = +100                                      29050099
290600              MOVE ZEROES TO SUAUPC-SKU-NBR                       29060099
290700              MOVE SPACES TO SUAUPC-ITM-DESC                      29070099
290800                             SUAUPC-VND-STYL-DESC                 29080099
290900                             SUAUPC-UPC-CLOR-DESC                 29090099
291000                             SUAUPC-UPC-SIZE-DESC                 29100099
291100              MOVE ZEROES TO SUAUPC-UPC-RTL-AMT                   29110099
291200         WHEN SQLWARN0 NOT EQUAL SPACE                            29120099
291300         WHEN SQLCODE NOT EQUAL ZERO                              29130099
291400              DISPLAY 'AUD CNTL NBR '  SUAUPC-AUD-CNTL-NBR        29140099
291500              DISPLAY 'SHIPT UNT ID '  SUAUPC-SHIPT-UNT-ID        29150099
291600              DISPLAY 'UPC NBR: '      SUAUPC-UPC-NBR             29160099
291700              MOVE '5210-GET-UPC-INFO-FROM-AUDIT'                 29170099
291800                               TO  PV-PARAGRAPH-NAME              29180099
291900              PERFORM 9999-SQL-ABEND                              29190099
292000     END-EVALUATE.                                                29200099
292100                                                                  29210099
292200     EXEC SQL                                                     29220099
292300         CLOSE UPC_CURSOR                                         29230099
292400     END-EXEC.                                                    29240099
292500                                                                  29250099
292600     EVALUATE TRUE                                                29260099
292700         WHEN SQLCODE = ZERO                                      29270099
292800              CONTINUE                                            29280099
292900         WHEN SQLWARN0 NOT EQUAL SPACE                            29290099
293000         WHEN SQLCODE NOT EQUAL ZERO                              29300099
293100              DISPLAY 'AUD CNTL NBR '  DK-AUD-CNTL-NBR            29310099
293200              DISPLAY 'SHIPT UNT ID '  DK-SHIPT-UNT-ID            29320099
293300              DISPLAY 'UPC NBR: '      DK-UPC-NBR                 29330099
293400              MOVE '5210-GET-UPC-INFO-FROM-AUDIT'                 29340099
293500                               TO  PV-PARAGRAPH-NAME              29350099
293600              PERFORM 9999-SQL-ABEND                              29360099
293700     END-EVALUATE.                                                29370099
293800                                                                  29380099
293900******************************************************************29390099
294000*  5300-CALL-XLKUT-DOMAIN-PGM.                                    29400099
294100*  ADDED NEW PARAGRAPH TO FETCH VALUES FROM XLKUT001 USING UPC   *29410099
294200*  NBR AS KEY. AND TO REPLACE THE 5300-GET-UPC-INFO-FROM-VSM     *29420099
294300*  PARAGRAPH. ALSO DELETED 2310-GET-COLOR, 2320-GET-SIZE AND     *29430099
294400*  2330-GET-VENDOR-STYLE PARAGRAPHS.               WR # 21361    *29440099
294500******************************************************************29450099
294600 5300-CALL-XLKUT-DOMAIN-PGM.                                      29460099
294700                                                                  29470099
294800     INITIALIZE XL001-ITEM-COMMAREA.                              29480099
294900                                                                  29490099
295000     MOVE DK-UPC-NBR             TO XL001-KEY-UPC-NBR.            29500099
295100     SET  XL001-BY-UPC-NBR       TO TRUE.                         29510099
295200     SET  XL001-SELECT-UPC                                        29520099
295300          XL001-SELECT-SKU                                        29530099
295400          XL001-SELECT-VND-STYL  TO TRUE.                         29540099
295500                                                                  29550099
295600     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                29560099
295700                                                                  29570099
295800     MOVE XL001-UPC-SQLCODE      TO SQLCODE.                      29580099
295900                                                                  29590099
296000     EVALUATE TRUE                                                29600099
296100         WHEN XL001-UPC-SQLCODE = ZEROES                          29610099
296200              PERFORM 5310-INTERROGATE-SKU-SQLCODE                29620099
296300         WHEN XL001-UPC-NOT-FOUND                                 29630099
296400              CONTINUE                                            29640099
296500         WHEN XL001-UPC-CONTENTION                                29650099
296600              DISPLAY 'UPC NBR: '                                 29660099
296700                       XL001-KEY-UPC-NBR                          29670099
296800              MOVE '5300-CALL-XLKUT-DOMAIN-PGM.'                  29680099
296900                               TO  PV-PARAGRAPH-NAME              29690099
297000              PERFORM 9999-SQL-ABEND                              29700099
297100         WHEN OTHER                                               29710099
297200              DISPLAY 'UPC NBR: '                                 29720099
297300                       XL001-KEY-UPC-NBR                          29730099
297400              MOVE '5300-CALL-XLKUT-DOMAIN-PGM.'                  29740099
297500                               TO  PV-PARAGRAPH-NAME              29750099
297600              PERFORM 9999-SQL-ABEND                              29760099
297700     END-EVALUATE.                                                29770099
297800                                                                  29780099
297900******************************************************************29790099
298000* 5310-INTERROGATE-SKU-SQLCODE.                                  *29800099
298100* ADDED THIS NEW PARAGRAPH TO CHECK THE RETURN CODE FROM XLV_SKU *29810099
298200* VIEW.                                      WR # 21361          *29820099
298300******************************************************************29830099
298400 5310-INTERROGATE-SKU-SQLCODE.                                    29840099
298500                                                                  29850099
298600     MOVE XL001-SKU-SQLCODE      TO SQLCODE.                      29860099
298700                                                                  29870099
298800     EVALUATE TRUE                                                29880099
298900         WHEN XL001-SKU-SQLCODE = ZEROES                          29890099
299000              PERFORM 5320-INTERROGATE-VND-SQLCODE                29900099
299100         WHEN XL001-SKU-NOT-FOUND                                 29910099
299200              MOVE 'NOT FOUND' TO XL001-CSTM-CLOR-DESC            29920099
299300                                  XL001-SIZE-DESC                 29930099
299400         WHEN XL001-SKU-CONTENTION                                29940099
299500              DISPLAY 'COLOR DESC: ' XL001-CSTM-CLOR-DESC         29950099
299600              DISPLAY 'SIZE  DESC: ' XL001-SIZE-DESC              29960099
299700              MOVE '5310-INTERROGATE-SKU-SQLCODE.'                29970099
299800                               TO  PV-PARAGRAPH-NAME              29980099
299900              PERFORM 9999-SQL-ABEND                              29990099
300000         WHEN OTHER                                               30000099
300100              DISPLAY 'COLOR DESC: ' XL001-CSTM-CLOR-DESC         30010099
300200              DISPLAY 'SIZE  DESC: ' XL001-SIZE-DESC              30020099
300300              MOVE '5310-INTERROGATE-SKU-SQLCODE.'                30030099
300400                               TO  PV-PARAGRAPH-NAME              30040099
300500              PERFORM 9999-SQL-ABEND                              30050099
300600     END-EVALUATE.                                                30060099
300700                                                                  30070099
300800******************************************************************30080099
300900* 5320-INTERROGATE-VND-SQLCODE.                                  *30090099
301000* ADDED THIS NEW PARAGRAPH TO CHECK THE RETURN CODE FROM XLV_VND_*30100099
301100* STYL VIEW.                                 WR # 21361          *30110099
301200******************************************************************30120099
301300 5320-INTERROGATE-VND-SQLCODE.                                    30130099
301400                                                                  30140099
301500     MOVE XL001-VND-STYL-SQLCODE    TO SQLCODE.                   30150099
301600                                                                  30160099
301700     EVALUATE TRUE                                                30170099
301800         WHEN XL001-VND-STYL-SQLCODE = ZEROES                     30180099
301900              CONTINUE                                            30190099
302000         WHEN XL001-VND-STYL-NOT-FOUND                            30200099
302100              MOVE 'NOT FOUND' TO XL001-VS-NBR                    30210099
302200         WHEN XL001-VND-STYL-CONTENTION                           30220099
302300              DISPLAY 'VND STYL NBR: ' XL001-VS-NBR               30230099
302400              DISPLAY 'DEPT NBR: ' XL001-DEPT-NBR-3CH             30240099
302500              DISPLAY 'SUB CL NBR: ' XL001-SUB-CL-NBR-2CH         30250099
302600              MOVE '5320-INTERROGATE-VND-SQLCODE.'                30260099
302700                               TO  PV-PARAGRAPH-NAME              30270099
302800              PERFORM 9999-SQL-ABEND                              30280099
302900         WHEN OTHER                                               30290099
303000              DISPLAY 'VND STYL NBR: ' XL001-VS-NBR               30300099
303100              DISPLAY 'DEPT NBR: ' XL001-DEPT-NBR-3CH             30310099
303200              DISPLAY 'SUB CL NBR: ' XL001-SUB-CL-NBR-2CH         30320099
303300              MOVE '5320-INTERROGATE-VND-SQLCODE.'                30330099
303400                               TO  PV-PARAGRAPH-NAME              30340099
303500              PERFORM 9999-SQL-ABEND                              30350099
303501     END-EVALUATE.                                                30350199
303502                                                                  30350299
303503                                                                  30350399
303504******************************************************************30350499
303505 7000-READ-CARDIN-FILE.                                           30350599
303506                                                                  30350699
303507     READ CARDIN-AUDIT-NBR-FILE INTO CC-CARDIN                    30350799
303508        AT END                                                    30350899
303509           SET PS-END-OF-CARDIN-FILE TO TRUE.                     30350999
303510                                                                  30351099
303520     IF PS-END-OF-CARDIN-FILE                                     30352099
303530         CONTINUE                                                 30353099
303540     ELSE                                                         30354099
303550         DISPLAY ' '                                              30355099
303560         DISPLAY 'AUDIT NBR IS : ' CC-AUDIT-CNTL-NBR              30356099
303570         DISPLAY 'CARTON ID IS : ' CC-CARTON-ID                   30357099
303580          '    '  CC-SYSTEM-MANUAL-AUDIT                          30358099
303590                  CC-RFID-QC-AUDIT-IND                            30359099
303600                  CC-RFID-QC-AUD-CMB-IND                          30360099
303700*                                                                 30370099
303800         PERFORM 7100-VALIDATE-CONTROL-CARD                       30380099
303900     END-IF.                                                      30390099
304000                                                                  30400099
304100******************************************************************30410099
304200* 7100-VALIDATE-CONTROL-CARD - VERIFIES THAT THE AUDIT CONTROL    30420099
304300* NUMBER AND THE SHIPPING UNIT ID ARE BOTH NUMBERIC               30430099
304400******************************************************************30440099
304500 7100-VALIDATE-CONTROL-CARD.                                      30450099
304600                                                                  30460099
304700*NUMERIC EDIT OF AUDIT CONTROL NBR                                30470099
304800     MOVE CC-AUDIT-CNTL-NBR          TO DP010I-UNEDITED-FIELD.    30480099
304900     MOVE +9                         TO DP010I-MAXIMUM-DIGITS.    30490099
305000     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  30500099
305100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     30510099
305200     CALL DP010I-NUMERIC-EDIT-ROUTINE                             30520099
305300         USING DP010I-NUMERIC-EDIT-AREA.                          30530099
305400                                                                  30540099
305500     IF DP010I-NO-ERROR-DETECTED                                  30550099
305600         MOVE DP010I-NUMERIC-FIELD  TO DK-AUD-CNTL-NBR            30560099
305700     ELSE                                                         30570099
305800         DISPLAY '** SUKRP012 ABEND **'                           30580099
305900         DISPLAY '** AUDIT NUMBER IS NOT NUMERIC **'              30590099
306000         MOVE +4019                  TO PV-ABEND-CODE             30600099
306100         CALL 'ILBOABN0' USING PV-ABEND-CODE                      30610099
306200     END-IF.                                                      30620099
306300*                                                                 30630099
306400                                                                  30640099
306500*NUMERIC EDIT OF CARTON ID                                        30650099
306600*    IF CC-CTN-FIRST-DIGIT = 0                                    30660099
306700*    MOVE CC-CTN-LAST-17         TO DP010I-UNEDITED-FIELD.        30670099
306800*    MOVE +17                    TO DP010I-MAXIMUM-DIGITS.        30680099
306900*    MOVE 0                      TO DP010I-MAXIMUM-DECIMALS.      30690099
307000*    SET DP010I-NEGATIVE-NOT-ALLOWED                              30700099
307100*                                TO TRUE.                         30710099
307200*    CALL DP010I-NUMERIC-EDIT-ROUTINE                             30720099
307300*        USING DP010I-NUMERIC-EDIT-AREA.                          30730099
307400*                                                                 30740099
307500*    IF DP010I-NO-ERROR-DETECTED                                  30750099
307600*        MOVE DP010I-NUM-FIELD-17-DIG-0-DEC                       30760099
307700*                                TO DK-SHIPT-UNT-ID               30770099
307800*        CONTINUE                                                 30780099
307900*    ELSE                                                         30790099
308000*        DISPLAY '** SUKRP012 ABEND **'                           30800099
308100*        DISPLAY '** CARTON NUMBER MUST BE NUMERIC **'            30810099
308200*        MOVE +4019              TO PV-ABEND-CODE                 30820099
308300*        CALL 'ILBOABN0' USING PV-ABEND-CODE                      30830099
308400*    END-IF.                                                      30840099
308500*    ELSE                                                         30850099
308600*        DISPLAY '** SUKRP012 ABEND **'                           30860099
308700*        DISPLAY '** FIRST DIGIT OF CARTON NBR MUST BE 0 OR 4 ***'30870099
308800*        MOVE +4019              TO PV-ABEND-CODE                 30880099
308900*        CALL 'ILBOABN0' USING PV-ABEND-CODE                      30890099
309000*    END-IF.                                                      30900099
309100                                                                  30910099
309200     MOVE CC-CARTON-ID           TO DK-SHIPT-UNT-ID.              30920099
309300*    IF DK-SHIPT-UNT-ID > 0                                       30930099
309400*       SET PS-USE-CARTON-CURSORS TO TRUE                         30940099
309500*       DISPLAY 'USING CARTON CURSOR'                             30950099
309600*    ELSE                                                         30960099
309700*       SET PS-USE-AUDIT-CURSORS  TO TRUE                         30970099
309800*       DISPLAY 'USING AUDIT CURSOR'                              30980099
309900*    END-IF.                                                      30990099
309901                                                                  30990199
309902******************************************************************30990299
309903*  READ A RECORD FROM THE AUDIT CARTON EXTRACT FILE.             *30990399
309904******************************************************************30990499
309905 7000-READ-AUD-CART-EXTRACT.                                      30990599
309906                                                                  30990699
309907     READ AUDIT-CART-EXTRACT-FILE                                 30990799
309908     INTO SU003-EXTRACT-RECORD OF SU003-COPYBOOK                  30990899
309909        AT END                                                    30990999
309910           SET PS-END-OF-CART-EXT-FILE TO TRUE.                   30991099
309911                                                                  30991199
309912                                                                  30991299
309913******************************************************************30991399
309914*  READ A RECORD FROM THE AUDIT UPC EXTRACT FILE.                *30991499
309915******************************************************************30991599
309916 7050-READ-AUD-UPC-EXTRACT.                                       30991699
309917                                                                  30991799
309918     READ AUDIT-UPC-EXTRACT-FILE                                  30991899
309919     INTO SU003-EXTRACT-RECORD OF SU003-COPYBOOK                  30991999
309920        AT END                                                    30992099
309921           SET PS-END-OF-UPC-EXT-FILE TO TRUE.                    30992199
309922                                                                  30992299
309923                                                                  30992399
309924******************************************************************30992499
309925* 7060-READ-SKU-TOTAL-FILE       READ THE NEXT RECORD FROM THE    30992599
309926* SKU TOTAL FILE.                                                 30992699
309927******************************************************************30992799
309928 7060-READ-SKU-TOTAL-FILE.                                        30992899
309929                                                                  30992999
309930     READ OS-SKUTOT-OVER-SHORT-FILE                               30993099
309931         INTO SU003-EXTRACT-RECORD OF OS-SKU-FILE                 30993199
309932     AT END                                                       30993299
309933         SET PS-EOF-SKU-TOTAL-FILE     TO TRUE                    30993399
309934     END-READ.                                                    30993499
309935                                                                  30993599
309936                                                                  30993699
309937* 02/06/14 DRW BEG EXCEPTIONS_CSR commented out                   30993799
309938******************************************************************30993899
309939* 7100-OPEN-EXCEPTIONS-CSR.                                      *30993999
309940*  THIS PROCEDURE WILL OPEN THE EXCEPTIONS CURSOR.               *30994099
309941******************************************************************30994199
309942*7100-OPEN-EXCEPTIONS-CSR.                                        30994299
309943*    MOVE '7100-OPEN-EXCEPTIONS-CSR'                              30994399
309944*                              TO  PV-PARAGRAPH-NAME.             30994499
309945*    EXEC SQL                                                     30994599
309946*         OPEN EXCEPTIONS_CSR                                     30994699
309947*    END-EXEC.                                                    30994799
309948*                                                                 30994899
309949*    EVALUATE TRUE                                                30994999
309950*        WHEN SQLCODE = ZERO                                      30995099
309951*             SET PS-NOT-END-OF-EXCEPTIONS-CSR                    30995199
309952*                              TO  TRUE                           30995299
309953*        WHEN SQLWARN0 NOT EQUAL SPACE                            30995399
309954*        WHEN SQLCODE NOT EQUAL ZERO                              30995499
309955*             DISPLAY PV-PARAGRAPH-NAME                           30995599
309956*             PERFORM 9999-SQL-ABEND                              30995699
309957*    END-EVALUATE.                                                30995799
309958*                                                                 30995899
309959******************************************************************30995999
309960* 7110-CLOSE-EXCEPTIONS-CSR.                                     *30996099
309961*  THIS PROCEDURE WILL CLOSE THE EXCEPTIONS_CSR.                  30996199
309962******************************************************************30996299
309963*7110-CLOSE-EXCEPTIONS-CSR.                                       30996399
309964*    MOVE '7110-CLOSE-EXCEPTIONS-CSR' TO  PV-PARAGRAPH-NAME.      30996499
309965*                                                                 30996599
309966*    EXEC SQL                                                     30996699
309967*        CLOSE EXCEPTIONS_CSR                                     30996799
309968*    END-EXEC.                                                    30996899
309969*                                                                 30996999
309970*    EVALUATE TRUE                                                30997099
309971*        WHEN SQLWARN0 NOT EQUAL SPACE                            30997199
309972*        WHEN SQLCODE NOT EQUAL ZERO                              30997299
309973*             DISPLAY PV-PARAGRAPH-NAME                           30997399
309974*             PERFORM 9999-SQL-ABEND                              30997499
309975*    END-EVALUATE.                                                30997599
309976*                                                                 30997699
309977*                                                                 30997799
309978******************************************************************30997899
309979* 7120-FETCH-EXCEPTIONS-CSR                                      *30997999
309980*  THIS PROCEDURE WILL FETCH THE EXCEPTIONS_CSR.                 *30998099
309981******************************************************************30998199
309982*7120-FETCH-EXCEPTIONS-CSR.                                       30998299
309983*    MOVE '7120-FETCH-EXCEPTIONS-CSR'                             30998399
309984*                              TO  PV-PARAGRAPH-NAME.             30998499
309985*                                                                 30998599
309986*    INITIALIZE DCLTSUEXCP                                        30998699
309987*               DCLTVILNCD                                        30998799
309988*               PV-UNITS-IN-ERROR.                                30998899
309989*                                                                 30998999
309990*    EXEC SQL                                                     30999099
309991*         FETCH EXCEPTIONS_CSR                                    30999199
309992*         INTO                                                    30999299
309993*               :SUEXCP-UPC-NBR                                   30999399
309994*             , :SUEXCP-VILN-GP-CDE                               30999499
309995*             , :SUEXCP-VILN-GP-SEQ-NBR                           30999599
309996*             , :SUEXCP-OVRRID-SYS-DAT-TXT                        30999699
309997*             , :PV-UNITS-IN-ERROR :DN-AUD-UNTS                   30999799
309998*             , :PV-RFID-UNITS-IN-ERROR :DN-RFID-AUD-UNTS         30999899
309999*    END-EXEC.                                                    30999999
310000*                                                                 31000099
310001*    EVALUATE TRUE                                                31000199
310002*        WHEN SQLCODE = ZERO                                      31000299
310003*             IF DN-RFID-AUD-UNTS = -1                            31000399
310004*                MOVE ZEROES TO PV-RFID-UNITS-IN-ERROR            31000499
310005*             END-IF                                              31000599
310006*             IF DN-AUD-UNTS = -1                                 31000699
310007*                MOVE ZEROES TO PV-UNITS-IN-ERROR                 31000799
310008*             END-IF                                              31000899
310009*        WHEN SQLCODE = +100                                      31000999
310010*        WHEN SQLCODE = -305                                      31001099
310011*             SET PS-END-OF-EXCEPTIONS-CSR                        31001199
310012*                              TO  TRUE                           31001299
310013*                                                                 31001399
310014*        WHEN SQLWARN0 NOT EQUAL SPACE                            31001499
310015*        WHEN SQLCODE NOT EQUAL ZERO                              31001599
310016*             DISPLAY PV-PARAGRAPH-NAME                           31001699
310017*             PERFORM 9999-SQL-ABEND                              31001799
310018*    END-EVALUATE.                                                31001899
310019* 02/06/14 DRW END                                                31001999
310020*                                                                 31002099
310021******************************************************************31002199
310022* 7130-GET-CARTON-LEVEL-ERR                                      *31002299
310023*  THIS PROCEDURE WILL GET THE CARTON LEVEL EXCEPTIONS FROM      *31002399
310024*  TCTEXCP                                                        31002499
310025******************************************************************31002599
310026 7130-GET-CARTON-LEVEL-ERR.                                       31002699
310027                                                                  31002799
310028     MOVE '7130-GET-CARTON-LEVEL-ERR'                             31002899
310029                               TO  PV-PARAGRAPH-NAME.             31002999
310030     EXEC SQL                                                     31003099
310031          OPEN CARTON_ERR_CSR                                     31003199
310032     END-EXEC.                                                    31003299
310033                                                                  31003399
310034     EVALUATE TRUE                                                31003499
310035         WHEN SQLCODE = ZERO                                      31003599
310036              CONTINUE                                            31003699
310037         WHEN SQLWARN0 NOT EQUAL SPACE                            31003799
310038         WHEN SQLCODE NOT EQUAL ZERO                              31003899
310039              DISPLAY PV-PARAGRAPH-NAME                           31003999
310040              DISPLAY 'ERROR OPENING CURSOR'                      31004099
310041              PERFORM 9999-SQL-ABEND                              31004199
310042     END-EVALUATE.                                                31004299
310043                                                                  31004399
310044     PERFORM 7140-FETCH-CARTON-ERR.                               31004499
310045                                                                  31004599
310046     PERFORM UNTIL PS-END-OF-CART-EXCEP-CSR                       31004699
310047         MOVE CTEXCP-VILN-GP-CDE TO SUEXCP-VILN-GP-CDE            31004799
310048         MOVE CTEXCP-VILN-GP-SEQ-NBR TO SUEXCP-VILN-GP-SEQ-NBR    31004899
310049         PERFORM 3700-FETCH-VILNCD-DESC                           31004999
310050         IF VILNCD-VILN-CDE-SHRT-DESC NOT = SPACES                31005099
310051             MOVE VILNCD-VILN-CDE-SHRT-DESC                       31005199
310052                                     TO DL1-VILN-CDE-SHRT-DESC    31005299
310053                                        PV-ERROR-DESC             31005399
310054         END-IF                                                   31005499
310055         MOVE PV-UNITS-IN-ERROR      TO DL1-QTY-IN-ERROR          31005599
310056         MOVE SPACES                 TO DL1-ERROR-TYPE            31005699
310057         IF CTEXCP-VILN-GP-SEQ-NBR = 1                            31005799
310058            MOVE SUATRN-TRN-NBR      TO DL1-ORDERED-AS-INFO       31005899
310059         ELSE                                                     31005999
310060            MOVE SUATRN-DEST-OPER-UNT-ID                          31006099
310061                                     TO DL1-ORDERED-AS-INFO       31006199
310062         END-IF                                                   31006299
310063         MOVE CTEXCP-OVRRID-SYS-DAT-TXT                           31006399
310064                                     TO DL1-RECEIVED-AS-INFO      31006499
310065         WRITE CARTON-AUDIT-RPT-RECORD                            31006599
310066           FROM DETAIL-LINE1                                      31006699
310067             AFTER ADVANCING 1 LINE                               31006799
310068         ADD 1                         TO PV-LINE-CNT             31006899
310069         PERFORM 7140-FETCH-CARTON-ERR                            31006999
310070     END-PERFORM.                                                 31007099
310071                                                                  31007199
310072                                                                  31007299
310073     EXEC SQL                                                     31007399
310074         CLOSE CARTON_ERR_CSR                                     31007499
310075     END-EXEC.                                                    31007599
310076                                                                  31007699
310077     EVALUATE TRUE                                                31007799
310078         WHEN SQLCODE = ZERO                                      31007899
310079              CONTINUE                                            31007999
310080         WHEN SQLWARN0 NOT EQUAL SPACE                            31008099
310081         WHEN SQLCODE NOT EQUAL ZERO                              31008199
310082              DISPLAY PV-PARAGRAPH-NAME                           31008299
310083              DISPLAY 'ERROR CLOSEING CURSOR'                     31008399
310084              PERFORM 9999-SQL-ABEND                              31008499
310085     END-EVALUATE.                                                31008599
310086                                                                  31008699
310087******************************************************************31008799
310088 7135-CHECK-FOR-CART-ERRORS.                                      31008899
310089                                                                  31008999
310090     MOVE '7135-CHECK-FOR-CART-ERRORS'                            31009099
310091                               TO  PV-PARAGRAPH-NAME.             31009199
310092     EXEC SQL                                                     31009299
310093          SELECT AUD_CNTL_NBR                                     31009399
310094            INTO :CTEXCP-AUD-CNTL-NBR                             31009499
310095            FROM TCTEXCP                                          31009599
310096           WHERE AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR              31009699
310097             AND SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID              31009799
310098     END-EXEC.                                                    31009899
310099                                                                  31009999
310100     EVALUATE TRUE                                                31010099
310101         WHEN SQLCODE = ZERO                                      31010199
310102         WHEN SQLCODE = -811                                      31010299
310103              SET PS-CART-EXCEP-FOUND TO TRUE                     31010399
310104         WHEN SQLCODE = +100                                      31010499
310105              SET PS-CART-EXCEP-NOT-FOUND TO TRUE                 31010599
310106         WHEN SQLWARN0 NOT EQUAL SPACE                            31010699
310107         WHEN SQLCODE NOT EQUAL ZERO                              31010799
310108              DISPLAY PV-PARAGRAPH-NAME                           31010899
310109              DISPLAY 'AUD CNTL NUMBER ' DK-AUD-CNTL-NBR          31010999
310110              DISPLAY 'SHIPT UNT ID ' DK-SHIPT-UNT-ID             31011099
310111              PERFORM 9999-SQL-ABEND                              31011199
310112     END-EVALUATE.                                                31011299
310113                                                                  31011399
310114******************************************************************31011499
310115* 7140-FETCH-CARTON-ERR                                           31011599
310116******************************************************************31011699
310117 7140-FETCH-CARTON-ERR.                                           31011799
310118                                                                  31011899
310119     MOVE '7140-FETCH-CARTON-ERR'                                 31011999
310120                               TO  PV-PARAGRAPH-NAME.             31012099
310121                                                                  31012199
310122     EXEC SQL                                                     31012299
310123          FETCH CARTON_ERR_CSR                                    31012399
310124          INTO                                                    31012499
310125                :CTEXCP-VILN-GP-CDE                               31012599
310126              , :CTEXCP-VILN-GP-SEQ-NBR                           31012699
310127              , :CTEXCP-OVRRID-SYS-DAT-TXT                        31012799
310128     END-EXEC.                                                    31012899
310129                                                                  31012999
310130     EVALUATE TRUE                                                31013099
310131         WHEN SQLCODE = ZERO                                      31013199
310132              CONTINUE                                            31013299
310133         WHEN SQLCODE = +100                                      31013399
310134              SET PS-END-OF-CART-EXCEP-CSR                        31013499
310135                               TO  TRUE                           31013599
310136         WHEN SQLWARN0 NOT EQUAL SPACE                            31013699
310137         WHEN SQLCODE NOT EQUAL ZERO                              31013799
310138              DISPLAY 'ERROR FETCHING CURSOR'                     31013899
310139              DISPLAY PV-PARAGRAPH-NAME                           31013999
310140              PERFORM 9999-SQL-ABEND                              31014099
310141     END-EVALUATE.                                                31014199
310142                                                                  31014299
310143******************************************************************31014399
310144*  PRINT THE HEADING FOR THE REPORT.                             *31014499
310145******************************************************************31014599
310146 8000-WRITE-REPORT-HEADERS.                                       31014699
310147                                                                  31014799
310148     PERFORM 8100-WRITE-TOP-LINE.                                 31014899
310149*                                                                 31014999
310150     WRITE CARTON-AUDIT-RPT-RECORD                                31015099
310151       FROM HEADING-LINE-0                                        31015199
310152         AFTER ADVANCING 2 LINES.                                 31015299
310153*                                                                 31015399
310154     WRITE CARTON-AUDIT-RPT-RECORD                                31015499
310155       FROM HEADING-LINE-1                                        31015599
310156         AFTER ADVANCING 1 LINE.                                  31015699
310157*                                                                 31015799
310158     WRITE CARTON-AUDIT-RPT-RECORD                                31015899
310159       FROM HEADING-LINE-2                                        31015999
310160         AFTER ADVANCING 2 LINES.                                 31016099
310161*                                                                 31016199
310162     WRITE CARTON-AUDIT-RPT-RECORD                                31016299
310163       FROM HEADING-LINE-3                                        31016399
310164         AFTER ADVANCING 1 LINE.                                  31016499
310165*                                                                 31016599
310166     WRITE CARTON-AUDIT-RPT-RECORD                                31016699
310167       FROM HEADING-LINE-4                                        31016799
310168         AFTER ADVANCING 1 LINE.                                  31016899
310169*                                                                 31016999
310170     WRITE CARTON-AUDIT-RPT-RECORD                                31017099
310171       FROM HEADING-LINE-5                                        31017199
310172         AFTER ADVANCING 1 LINE.                                  31017299
310173                                                                  31017399
310174     WRITE CARTON-AUDIT-RPT-RECORD                                31017499
310175       FROM HEADING-LINE-6                                        31017599
310176         AFTER ADVANCING 1 LINE.                                  31017699
310177*                                                                 31017799
310178     WRITE CARTON-AUDIT-RPT-RECORD                                31017899
310179       FROM HEADING-LINE-7                                        31017999
310180         AFTER ADVANCING 1 LINE.                                  31018099
310181*                                                                 31018199
310182     WRITE CARTON-AUDIT-RPT-RECORD                                31018299
310183       FROM HEADING-LINE-8A                                       31018399
310184         AFTER ADVANCING 1 LINE.                                  31018499
310185*                                                                 31018599
310186     WRITE CARTON-AUDIT-RPT-RECORD                                31018699
310187       FROM HEADING-LINE-9A                                       31018799
310188         AFTER ADVANCING 1 LINE.                                  31018899
310189*                                                                 31018999
310190     WRITE CARTON-AUDIT-RPT-RECORD                                31019099
310191       FROM HEADING-LINE-10A                                      31019199
310192         AFTER ADVANCING 1 LINE.                                  31019299
310193*                                                                 31019399
310194     WRITE CARTON-AUDIT-RPT-RECORD                                31019499
310195       FROM PC-BLANK-LINE                                         31019599
310196         AFTER ADVANCING 1 LINE.                                  31019699
310197*                                                                 31019799
310198     MOVE PC-15                   TO PV-LINE-CNT.                 31019899
310199*                                                                 31019999
310200******************************************************************31020099
310201*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *31020199
310202*     NEEDED FOR AN ASN NUMBER.                                  *31020299
310203******************************************************************31020399
310204 8100-WRITE-TOP-LINE.                                             31020499
310205                                                                  31020599
310206     ADD 1                        TO PV-PAGE-CNT.                 31020699
310207*                                                                 31020799
310208     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          31020899
310209*                                                                 31020999
310210     WRITE CARTON-AUDIT-RPT-RECORD                                31021099
310211       FROM DP132O-STANDRD-HEADER-132-COLS                        31021199
310212         AFTER ADVANCING PAGE.                                    31021299
310213*                                                                 31021399
310214******************************************************************31021499
310215*  PRINT THE COLUMN HEADERS FOR THE DETAIL PART OF THE REPORT    *31021599
310216******************************************************************31021699
310217 8200-WRITE-DETAIL-HEADERS.                                       31021799
310218*                                                                 31021899
310219     WRITE CARTON-AUDIT-RPT-RECORD                                31021999
310220       FROM HEADING-LINE-8                                        31022099
310221         AFTER ADVANCING 2 LINES.                                 31022199
310222*                                                                 31022299
310223     WRITE CARTON-AUDIT-RPT-RECORD                                31022399
310224       FROM HEADING-LINE-9                                        31022499
310225         AFTER ADVANCING 1 LINE.                                  31022599
310226*                                                                 31022699
310227     WRITE CARTON-AUDIT-RPT-RECORD                                31022799
310228       FROM HEADING-LINE-10                                       31022899
310229         AFTER ADVANCING 1 LINE.                                  31022999
310230*                                                                 31023099
310231     WRITE CARTON-AUDIT-RPT-RECORD                                31023199
310232       FROM PC-BLANK-LINE                                         31023299
310233         AFTER ADVANCING 1 LINE.                                  31023399
310234*                                                                 31023499
310235     ADD  PC-5                    TO PV-LINE-CNT.                 31023599
310236*                                                                 31023699
310237*                                                                 31023799
310238******************************************************************31023899
310239*  THIS PARAGRAPH WILL PRNT THE ERROR SUMMARY SECTION             31023999
310240******************************************************************31024099
310241*8300-PRINT-ERROR-SUMMARY.                                        31024199
310242*                                                                 31024299
310243*    INITIALIZE PV-TOTAL-ERRORS.                                  31024399
310244*                                                                 31024499
310245*    FIRST DETERMINE IF THE SUMMARY SECTION WILL FIT ON THE PAGE  31024599
310246*                                                                 31024699
310247*    PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31024799
310248*    UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES                   31024899
310249*       OR PV-ERROR-IDX > 25                                      31024999
310250*       ADD +1 TO PV-SUM-LINE-CNT                                 31025099
310251*    END-PERFORM.                                                 31025199
310252*                                                                 31025299
310253*    PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31025399
310254*    UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES                   31025499
310255*       OR PV-ERROR-IDX > 25                                      31025599
310256*       ADD +1 TO PV-SUM-LINE-CNT                                 31025699
310257*    END-PERFORM.                                                 31025799
310258*                                                                 31025899
310259*    PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31025999
310260*    UNTIL PA-RFID-ERROR (PV-ERROR-IDX) = SPACES                  31026099
310261*       OR PV-ERROR-IDX > 25                                      31026199
310262*       ADD +1 TO PV-SUM-LINE-CNT                                 31026299
310263*    END-PERFORM.                                                 31026399
310264*                                                                 31026499
310265*    PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31026599
310266*    UNTIL PA-OTH-ERROR (PV-ERROR-IDX) = SPACES                   31026699
310267*       OR PV-ERROR-IDX > 25                                      31026799
310268*       ADD +1 TO PV-SUM-LINE-CNT                                 31026899
310269*    END-PERFORM.                                                 31026999
310270*                                                                 31027099
310271*    IF (PV-LINE-CNT +                                            31027199
310272*        PV-SUM-LINE-CNT) > PC-MAX-REPORT-LINES                   31027299
310273*        PERFORM 8000-WRITE-REPORT-HEADERS                        31027399
310274*    END-IF.                                                      31027499
310275*                                                                 31027599
310276*    ADD PV-SUM-LINE-CNT       TO PV-LINE-CNT.                    31027699
310277*                                                                 31027799
310278*    WRITE THE ERROR SUMMARY HEADING LINE                         31027899
310279*    WRITE CARTON-AUDIT-RPT-RECORD                                31027999
310280*        FROM FH-FOOTER-HEADING-LINE                              31028099
310281*        AFTER ADVANCING 3 LINES.                                 31028199
310282*                                                                 31028299
310283*    WRITE THE PICKING ERROR HEADING LINE                         31028399
310284*    IF CC-QC-AUDIT                                               31028499
310285*        MOVE 'PICKING ERRORS'        TO FD-FOOTER-DETAIL-DESC    31028599
310286*        MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   31028699
310287*        WRITE CARTON-AUDIT-RPT-RECORD                            31028799
310288*            FROM FD-FOOTER-DETAIL-LINE                           31028899
310289*            AFTER ADVANCING 2 LINES                              31028999
310290*                                                                 31029099
310291*        WRITE CARTON-AUDIT-RPT-RECORD                            31029199
310292*            FROM PC-BLANK-LINE                                   31029299
310293*            AFTER ADVANCING 1 LINE                               31029399
310294*                                                                 31029499
310295*    WRITE THE PICKING ERRORS                                     31029599
310296*        PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 31029699
310297*        UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES               31029799
310298*           OR PV-ERROR-IDX > 25                                  31029899
310299*            MOVE PA-PIC-ERROR-DESC (PV-ERROR-IDX)                31029999
310300*                                     TO FD-FOOTER-DETAIL-DESC    31030099
310301*            MOVE PA-PIC-ERROR-QTY (PV-ERROR-IDX)                 31030199
310302*                                     TO FD-FOOTER-DETAIL-QTY     31030299
310303*            ADD  PA-PIC-ERROR-QTY (PV-ERROR-IDX)                 31030399
310304*                                     TO PV-TOTAL-ERRORS          31030499
310305*            WRITE CARTON-AUDIT-RPT-RECORD                        31030599
310306*                FROM FD-FOOTER-DETAIL-LINE                       31030699
310307*                AFTER ADVANCING 1 LINE                           31030799
310308*        END-PERFORM                                              31030899
310309*                                                                 31030999
310310*    WRITE THE TICKETING ERROR HEADING LINE                       31031099
310311*        MOVE 'TICKETING ERRORS'      TO FD-FOOTER-DETAIL-DESC    31031199
310312*        MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   31031299
310313*        WRITE CARTON-AUDIT-RPT-RECORD                            31031399
310314*            FROM FD-FOOTER-DETAIL-LINE                           31031499
310315*            AFTER ADVANCING 2 LINES                              31031599
310316*                                                                 31031699
310317*        WRITE CARTON-AUDIT-RPT-RECORD                            31031799
310318*            FROM PC-BLANK-LINE                                   31031899
310319*            AFTER ADVANCING 1 LINE                               31031999
310320*                                                                 31032099
310321*    WRITE THE TICKETING ERRORS                                   31032199
310322*        PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 31032299
310323*        UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES               31032399
310324*           OR PV-ERROR-IDX > 25                                  31032499
310325*            MOVE PA-TIC-ERROR-DESC (PV-ERROR-IDX)                31032599
310326*                                     TO FD-FOOTER-DETAIL-DESC    31032699
310327*            MOVE PA-TIC-ERROR-QTY (PV-ERROR-IDX)                 31032799
310328*                                     TO FD-FOOTER-DETAIL-QTY     31032899
310329*            ADD  PA-TIC-ERROR-QTY (PV-ERROR-IDX)                 31032999
310330*                                     TO PV-TOTAL-ERRORS          31033099
310331*            WRITE CARTON-AUDIT-RPT-RECORD                        31033199
310332*                FROM FD-FOOTER-DETAIL-LINE                       31033299
310333*                AFTER ADVANCING 1 LINE                           31033399
310334*        END-PERFORM                                              31033499
310335*    END-IF.                                                      31033599
310336*                                                                 31033699
310337*                                                                 31033799
310338*    WRITE THE RFID ERROR HEADING LINE                            31033899
310339*    IF CC-RFID-AUDIT                                             31033999
310340*        MOVE 'RFID ERRORS'           TO FD-FOOTER-DETAIL-DESC    31034099
310341*        MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   31034199
310342*        WRITE CARTON-AUDIT-RPT-RECORD                            31034299
310343*            FROM FD-FOOTER-DETAIL-LINE                           31034399
310344*            AFTER ADVANCING 2 LINES                              31034499
310345*                                                                 31034599
310346*        WRITE CARTON-AUDIT-RPT-RECORD                            31034699
310347*            FROM PC-BLANK-LINE                                   31034799
310348*            AFTER ADVANCING 1 LINE                               31034899
310349*                                                                 31034999
310350*    WRITE THE RFID ERRORS                                        31035099
310351*        PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 31035199
310352*        UNTIL PA-RFID-ERROR (PV-ERROR-IDX) = SPACES              31035299
310353*           OR PV-ERROR-IDX > 25                                  31035399
310354*            DISPLAY 'PA-RFID-ERROR-DESC: '                       31035499
310355*                PA-RFID-ERROR-DESC (PV-ERROR-IDX)                31035599
310356*            MOVE PA-RFID-ERROR-DESC (PV-ERROR-IDX)               31035699
310357*                                     TO FD-FOOTER-DETAIL-DESC    31035799
310358*            DISPLAY 'PA-RFID-ERROR-QTY: '                        31035899
310359*                PA-RFID-ERROR-QTY (PV-ERROR-IDX)                 31035999
310360*            MOVE PA-RFID-ERROR-QTY (PV-ERROR-IDX)                31036099
310361*                                     TO FD-FOOTER-DETAIL-QTY     31036199
310362*            ADD  PA-RFID-ERROR-QTY (PV-ERROR-IDX)                31036299
310363*                                     TO PV-TOTAL-ERRORS          31036399
310364*            WRITE CARTON-AUDIT-RPT-RECORD                        31036499
310365*                FROM FD-FOOTER-DETAIL-LINE                       31036599
310366*                AFTER ADVANCING 1 LINE                           31036699
310367*        END-PERFORM                                              31036799
310368*    END-IF.                                                      31036899
310369*                                                                 31036999
310370*    WRITE THE OTHER ERRORS HEADING LINE                          31037099
310371*    MOVE 'OTHER ERRORS'              TO FD-FOOTER-DETAIL-DESC    31037199
310372*    MOVE SPACES                      TO FD-FOOTER-DETAIL-QTY-X   31037299
310373*    WRITE CARTON-AUDIT-RPT-RECORD                                31037399
310374*        FROM FD-FOOTER-DETAIL-LINE                               31037499
310375*        AFTER ADVANCING 2 LINES.                                 31037599
310376*                                                                 31037699
310377*    WRITE CARTON-AUDIT-RPT-RECORD                                31037799
310378*        FROM PC-BLANK-LINE                                       31037899
310379*        AFTER ADVANCING 1 LINE.                                  31037999
310380*                                                                 31038099
310381*    WRITE THE OTHER ERRORS                                       31038199
310382*    PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31038299
310383*    UNTIL PA-OTH-ERROR (PV-ERROR-IDX) = SPACES                   31038399
310384*       OR PV-ERROR-IDX > 25                                      31038499
310385*        MOVE PA-OTH-ERROR-DESC (PV-ERROR-IDX)                    31038599
310386*                                     TO FD-FOOTER-DETAIL-DESC    31038699
310387*        MOVE PA-OTH-ERROR-QTY (PV-ERROR-IDX)                     31038799
310388*                                     TO FD-FOOTER-DETAIL-QTY     31038899
310389*        ADD  PA-OTH-ERROR-QTY (PV-ERROR-IDX)                     31038999
310390*                                     TO PV-TOTAL-ERRORS          31039099
310391*        WRITE CARTON-AUDIT-RPT-RECORD                            31039199
310392*            FROM FD-FOOTER-DETAIL-LINE                           31039299
310393*            AFTER ADVANCING 1 LINE                               31039399
310394*    END-PERFORM.                                                 31039499
310395*                                                                 31039599
310396*    WRITE THE TOTAL ERROR SUMMARY FOOTER LINE                    31039699
310397*    MOVE 'TOTAL ERRORS    '          TO FD-FOOTER-DETAIL-DESC    31039799
310398*    MOVE PV-TOTAL-ERRORS             TO FD-FOOTER-DETAIL-QTY     31039899
310399*    WRITE CARTON-AUDIT-RPT-RECORD                                31039999
310400*        FROM FD-FOOTER-DETAIL-LINE                               31040099
310401*        AFTER ADVANCING 2 LINES.                                 31040199
310402*                                                                 31040299
310403******************************************************************31040399
310404*     WRITES THE DETAIL LINE INFORMATION.                        *31040499
310405******************************************************************31040599
310406 8400-WRITE-DETAIL-LINES.                                         31040699
310407*                                                                 31040799
310408     WRITE CARTON-AUDIT-RPT-RECORD                                31040899
310409       FROM DETAIL-LINE1                                          31040999
310410         AFTER ADVANCING 1 LINE.                                  31041099
310411     DISPLAY DETAIL-LINE1.                                        31041199
310412*                                                                 31041299
310413     ADD +1                          TO PV-LINE-CNT.              31041399
310414*                                                                 31041499
310415                                                                  31041599
310416******************************************************************31041699
310417* 8500-PRINT-ERROR-SUMMARY.                                       31041799
310418*  THIS PARAGRAPH WILL PRNT THE ERROR SUMMARY SECTION             31041899
310419******************************************************************31041999
310420 8500-PRINT-ERROR-SUMMARY.                                        31042099
310430                                                                  31043099
310440     INITIALIZE PV-TOTAL-ERROR-QTY.                               31044099
310450                                                                  31045099
310460*    FIRST DETERMINE IF THE SUMMARY SECTION WILL FIT ON THE PAGE  31046099
310470     MOVE +11                TO PV-SUM-LINE-COUNT.                31047099
310480                                                                  31048099
310490     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31049099
310500     UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES                   31050099
310600        OR PV-ERROR-IDX > 25                                      31060099
310700        ADD +1 TO PV-SUM-LINE-COUNT                               31070099
310800     END-PERFORM.                                                 31080099
310900                                                                  31090099
311000     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31100099
311100     UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES                   31110099
311200        OR PV-ERROR-IDX > 25                                      31120099
311300        ADD +1 TO PV-SUM-LINE-COUNT                               31130099
311400     END-PERFORM.                                                 31140099
311500                                                                  31150099
311600     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     31160099
311700     UNTIL PA-RFID-ERROR (PV-ERROR-IDX) = SPACES                  31170099
311800        OR PV-ERROR-IDX > 25                                      31180099
311900        ADD +1 TO PV-SUM-LINE-COUNT                               31190099
312000     END-PERFORM.                                                 31200099
312100                                                                  31210099
312200     IF (PV-DETAIL-LINE-COUNT +                                   31220099
312300         PV-SUM-LINE-COUNT )  > PC-MAX-REPORT-LINES               31230099
312400*        PERFORM 3000-PRINT-PAGE-HEADING                          31240099
312500         PERFORM 8000-WRITE-REPORT-HEADERS                        31250099
312600     END-IF.                                                      31260099
312700                                                                  31270099
312800     ADD PV-SUM-LINE-COUNT     TO PV-DETAIL-LINE-COUNT            31280099
312900                                                                  31290099
313000*    WRITE THE ERROR SUMMARY HEADING LINE                         31300099
313100     WRITE CARTON-AUDIT-RPT-RECORD                                31310099
313200         FROM FH-FOOTER-HEADING-LINE                              31320099
313300         AFTER ADVANCING 3 LINES.                                 31330099
313400                                                                  31340099
313500*    WRITE THE PICKING ERROR HEADING LINE                         31350099
313600     IF CC-QC-AUDIT                                               31360099
313700         MOVE 'PICKING ERRORS'        TO FD-FOOTER-DETAIL-DESC    31370099
313800         MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   31380099
313900         WRITE CARTON-AUDIT-RPT-RECORD                            31390099
314000             FROM FD-FOOTER-DETAIL-LINE                           31400099
314100             AFTER ADVANCING 2 LINES                              31410099
314200                                                                  31420099
314300         WRITE CARTON-AUDIT-RPT-RECORD                            31430099
314400             FROM BLANK-LINE                                      31440099
314500             AFTER ADVANCING 1 LINE                               31450099
314600                                                                  31460099
314700*    WRITE THE PICKING ERRORS                                     31470099
314800         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 31480099
314900         UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES               31490099
315000            OR PV-ERROR-IDX > 25                                  31500099
315100             MOVE PA-PIC-ERROR-DESC (PV-ERROR-IDX)                31510099
315200                                      TO FD-FOOTER-DETAIL-DESC    31520099
315300             MOVE PA-PIC-ERROR-QTY (PV-ERROR-IDX)                 31530099
315400                                      TO FD-FOOTER-DETAIL-QTY     31540099
315500             ADD  PA-PIC-ERROR-QTY (PV-ERROR-IDX)                 31550099
315600                                      TO PV-TOTAL-ERROR-QTY       31560099
315700             WRITE CARTON-AUDIT-RPT-RECORD                        31570099
315800                 FROM FD-FOOTER-DETAIL-LINE                       31580099
315900                 AFTER ADVANCING 1 LINE                           31590099
316000         END-PERFORM                                              31600099
316100                                                                  31610099
316200                                                                  31620099
316300*    WRITE THE TICKETING ERROR HEADING LINE                       31630099
316400         MOVE 'TICKETING ERRORS'      TO FD-FOOTER-DETAIL-DESC    31640099
316500         MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   31650099
316600         WRITE CARTON-AUDIT-RPT-RECORD                            31660099
316700             FROM FD-FOOTER-DETAIL-LINE                           31670099
316800             AFTER ADVANCING 2 LINES                              31680099
316900                                                                  31690099
317000         WRITE CARTON-AUDIT-RPT-RECORD                            31700099
317100             FROM BLANK-LINE                                      31710099
317200             AFTER ADVANCING 1 LINE                               31720099
317300                                                                  31730099
317400*    WRITE THE TICKETING ERRORS                                   31740099
317500         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 31750099
317600         UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES               31760099
317700            OR PV-ERROR-IDX > 25                                  31770099
317800             MOVE PA-TIC-ERROR-DESC (PV-ERROR-IDX)                31780099
317900                                      TO FD-FOOTER-DETAIL-DESC    31790099
318000             MOVE PA-TIC-ERROR-QTY (PV-ERROR-IDX)                 31800099
318100                                      TO FD-FOOTER-DETAIL-QTY     31810099
318200             ADD  PA-TIC-ERROR-QTY (PV-ERROR-IDX)                 31820099
318300                                      TO PV-TOTAL-ERROR-QTY       31830099
318400             WRITE CARTON-AUDIT-RPT-RECORD                        31840099
318500                 FROM FD-FOOTER-DETAIL-LINE                       31850099
318600                 AFTER ADVANCING 1 LINE                           31860099
318700         END-PERFORM                                              31870099
318800     END-IF.                                                      31880099
318900                                                                  31890099
319000* 02/06/14 DRW BEG                                                31900099
319100*    WRITE THE RFID ERROR HEADING LINE                            31910099
319200     IF CC-RFID-AUDIT                                             31920099
319300         MOVE 'RFID ERRORS'           TO FD-FOOTER-DETAIL-DESC    31930099
319400         MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   31940099
319500         WRITE CARTON-AUDIT-RPT-RECORD                            31950099
319600             FROM FD-FOOTER-DETAIL-LINE                           31960099
319700             AFTER ADVANCING 2 LINES                              31970099
319800                                                                  31980099
319900         WRITE CARTON-AUDIT-RPT-RECORD                            31990099
320000             FROM BLANK-LINE                                      32000099
320100             AFTER ADVANCING 1 LINE                               32010099
320200                                                                  32020099
320300*    WRITE THE RFID ERRORS                                        32030099
320400         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 32040099
320500         UNTIL PA-RFID-ERROR (PV-ERROR-IDX) = SPACES              32050099
320600            OR PV-ERROR-IDX > 25                                  32060099
320700             MOVE PA-RFID-ERROR-DESC (PV-ERROR-IDX)               32070099
320800                                      TO FD-FOOTER-DETAIL-DESC    32080099
320900             MOVE PA-RFID-ERROR-QTY (PV-ERROR-IDX)                32090099
321000                                      TO FD-FOOTER-DETAIL-QTY     32100099
321100             ADD  PA-RFID-ERROR-QTY (PV-ERROR-IDX)                32110099
321200                                      TO PV-TOTAL-ERROR-QTY       32120099
321300             WRITE CARTON-AUDIT-RPT-RECORD                        32130099
321400                 FROM FD-FOOTER-DETAIL-LINE                       32140099
321500                 AFTER ADVANCING 1 LINE                           32150099
321600         END-PERFORM                                              32160099
321700     END-IF.                                                      32170099
321800* 02/06/14 DRW END                                                32180099
321900                                                                  32190099
322000*    WRITE THE TOTAL ERROR SUMMARY FOOTER LINE                    32200099
322100     MOVE 'TOTAL ERRORS    '          TO FD-FOOTER-DETAIL-DESC    32210099
322200     MOVE PV-TOTAL-ERROR-QTY          TO FD-FOOTER-DETAIL-QTY     32220099
322300     WRITE CARTON-AUDIT-RPT-RECORD                                32230099
322400         FROM FD-FOOTER-DETAIL-LINE                               32240099
322500         AFTER ADVANCING 2 LINES.                                 32250099
322501                                                                  32250199
322502*                                                                 32250299
322503******************************************************************32250399
322504* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *32250499
322505* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *32250599
322506* WILL ABEND THE PROGRAM                                         *32250699
322507******************************************************************32250799
322508 9100-FIELD-OVERFLOW-ERROR.                                       32250899
322509                                                                  32250999
322510     DISPLAY '** ABEND     **'.                                   32251099
322520     DISPLAY '** PROGRAM   ** = SUKRP012'.                        32252099
322530     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          32253099
322540     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   32254099
322550     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.'.                 32255099
322560                                                                  32256099
322570     MOVE +4004 TO PV-ABEND-CODE.                                 32257099
322580     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         32258099
322581                                                                  32258199
322582******************************************************************32258299
322583*     SQL WARNING OR ERROR PROCESSING                            *32258399
322584******************************************************************32258499
322585 9999-SQL-ABEND.                                                  32258599
322586*---------------                                                  32258699
322587                                                                  32258799
322588     MOVE SQLCODE    TO SQLCODE2.                                 32258899
322589     MOVE SQLERRD(3) TO SQLERRD3.                                 32258999
322590     DISPLAY '** ABEND **       ** = SQLERROR'.                   32259099
322591     DISPLAY '** PROGRAM        ** = SUKRP012'.                   32259199
322592     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  32259299
322593     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  32259399
322594     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   32259499
322595     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  32259599
322596*                                                                 32259699
322597******************************************************************32259799
322598* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    32259899
322599* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         32259999
322600* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     32260099
322601* FORMAT.                                                         32260199
322602******************************************************************32260299
322603     COPY DPPD004.                                                32260399
322604                                                                  32260499
322605     MOVE +4013 TO PV-ABEND-CODE.                                 32260599
322606     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         32260699
322607                                                                  32260799
