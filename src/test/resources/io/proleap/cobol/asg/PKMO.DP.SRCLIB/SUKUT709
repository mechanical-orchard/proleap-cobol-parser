000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             SUKUT709.                                00040000
000500 AUTHOR.                 OMAN.                                    00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN            NOVEMBER 2008.                           00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*  12/26  7600- PARAGRAPH SWITCH WAS BEING SET INCORRECTLY IN 750000100000
001100*         7500- INTO FIELDS SHOULD HAVE INCLUDED ASGD-STRT-TMST   00110000
001200*               IT WAS ASGD-END-TMST                              00120000
001300*                                                                 00130000
001400*  12/2   CHANGE TO 7500 SELECT                                   00140000
001500*                                                                 00150000
001600*                                                                 00160000
001700*                                                                 00170000
001800*                                                                 00180000
001900* 06/18/2010   MADE BY: MONIKA SACHDEVA     TKID: TKMAW78         00190000
002000*              MODIFIED THE PROGRAM TO SCAN THE IR CARTONS (0042) 00200000
002100*              (ALONG WITH VENDOR CARTONS) AND DETERMINE THE TRIP 00210000
002200*              ID AND DOOR ID.                                    00220000
002210*              ADDED A CURSOR PULL-CSR TO GET THE PULL NUMBER AND 00221000
002211*              DCLGEN FOR SUT_OTBND_UPC, SUT_OTBND_LOC,           00221100
002212*              SUT_OTBND_CART AND SUT_TRLR_RPLN_CART.             00221200
002213*              ALSO ADDED SOME NEW PARAGRAPHS 4500-READ-TRIP-TABLE00221300
002214*              2500-PROCESS-BAR-CODE-1-OR-2,                      00221400
002215*              3300-SELECT-TRLR-RPLN-CART,                        00221500
002216*              3500-CHECK-FOR-PULL-NUMBER,                        00221600
002217*              3700-GET-INBOUND-TRIP,7400-SELECT-OTBND-CART,      00221700
002218*              7450-SELECT-OTBND-LOC.                             00221800
002219*              CHANGES TAGGED AS MS 06/18/2010                    00221900
002220******************************************************************00222000
002230                                                                  00223000
002240******************************************************************00224000
002250*  THIS PROGRAM WILL BE CALLED BY PROGRAM SUKCS770 TO DETERMINE   00225000
002260*  WHAT TRAILER THE CARTON HAS COME FROM FOR DUAL FEED PRINT      00226000
002270*  AND APPLY.                                                     00227000
002280*                                                                 00228000
002290******************************************************************00229000
002300 ENVIRONMENT DIVISION.                                            00230000
002400 DATA DIVISION.                                                   00240000
002500******************************************************************00250000
002600                                                                  00260000
002700 WORKING-STORAGE SECTION.                                         00270000
002800                                                                  00280000
002900 01  DK-DB2-KEYS.                                                 00290000
003000     05  DK-OPER-UNT-ID             PIC S9(04) COMP VALUE 0.      00300000
003100     05  DK-ACM-LBL-STA-NBR         PIC S9(09) COMP VALUE 0.      00310000
003200     05  DK-PNA-STA-NBR             PIC S9(09) COMP VALUE 0.      00320000
003300     05  DK-OTBND-SHIPT-UNT-ID      PIC S9(18) COMP-3 VALUE 0.    00330000
003400     05  DK-CARTON                  PIC S9(18) COMP-3 VALUE 0.    00340000
003500     05  DK-SHIPT-UNT-ID            PIC S9(18) COMP-3 VALUE 0.    00350000
003600     05  DK-BAR-CODE-20             PIC  X(20) VALUE SPACES.      00360000
003700     05  DK-BAR-CODE-22             PIC  X(22) VALUE SPACES.      00370000
003800     05  DK-PO-NBR                  PIC S9(09) COMP SYNC VALUE 0. 00380000
003900     05  SAVE-PO-NBR                PIC S9(09) COMP SYNC VALUE 0. 00390000
004000     05  DK-ENT-ID                  PIC S9(09) COMP SYNC VALUE 0. 00400000
004100     05  SAVE-ENT-ID                PIC S9(09) COMP SYNC VALUE 0. 00410000
004200     05  DK-TRIP-ID                 PIC S9(09) COMP SYNC VALUE 0. 00420000
004300     05  DK-NULL                    PIC S9(04) COMP SYNC VALUE 0. 00430000
004400* MS 06/18/2010 BEG                                               00440000
004500     05  DK-PULL-NUMBER             PIC S9(09) COMP.              00450000
004600* MS 06/18/2010 END                                               00460000
004700                                                                  00470000
004800 01  DN-DB2-NULL-INDICATORS.                                      00480000
004900     05  DN-AUDIT-IND               PIC S9(04) COMP VALUE ZEROES. 00490000
005000     05  DN-SHIPT-IND               PIC S9(04) COMP VALUE ZEROES. 00500000
005100     05  DN-PROB-IND                PIC S9(04) COMP VALUE ZEROES. 00510000
005200     05  DN-ADJ-IND                 PIC S9(04) COMP VALUE ZEROES. 00520000
005300                                                                  00530000
005400 01  PC-PROGRAM-CONSTANTS.                                        00540000
005500     05  PC-SUKUT702               PIC X(08)  VALUE 'SUKUT702'.   00550000
005600     05  PC-RECV                   PIC X(04)  VALUE 'RECV'.       00560000
005700     05  PC-A                      PIC X(01)  VALUE 'A'.          00570000
005800     05  PC-Y                      PIC X(01)  VALUE 'Y'.          00580000
005900     05  PC-N                      PIC X(01)  VALUE 'N'.          00590000
006000     05  PC-ALL                    PIC X(03)  VALUE 'ALL'.        00600000
006100     05  PC-POL                    PIC X(03)  VALUE 'POL'.        00610000
006200     05  PC-VND                    PIC X(03)  VALUE 'VND'.        00620000
006300     05  PC-FST                    PIC X(03)  VALUE 'FST'.        00630000
006400     05  PC-NNE                    PIC X(03)  VALUE 'NNE'.        00640000
006500     05  PC-KHL                    PIC X(03)  VALUE 'KHL'.        00650000
006510     05  PC-ACM                    PIC X(03)  VALUE 'ACM'.        00651028
006600     05  PC-PACEXC                 PIC X(06)  VALUE 'PACEXC'.     00660000
006610     05  PC-PACRT3                 PIC X(06)  VALUE 'PACRT3'.     00661017
006620     05  PC-PATIM3                 PIC X(06)  VALUE 'PATIM3'.     00662026
006700     05  PC-DEFAULT-TMST           PIC X(26)  VALUE               00670000
006800                    '9999-09-09-09.09.09.999999'.                 00680000
006900                                                                  00690000
007000 01  PS-PROGRAM-SWITCHES.                                         00700000
007100     05  PS-BAR-CODE-1-FOUND-SW       PIC X(01)  VALUE 'N'.       00710000
007200         88  PS-BAR-CODE-1-FOUND                 VALUE 'Y'.       00720000
007300         88  PS-BAR-CODE-1-NOT-FOUND             VALUE 'N'.       00730000
007400     05  PS-BAR-CODE-2-FOUND-SW       PIC X(01)  VALUE 'N'.       00740000
007500         88  PS-BAR-CODE-2-FOUND                 VALUE 'Y'.       00750000
007600         88  PS-BAR-CODE-2-NOT-FOUND             VALUE 'N'.       00760000
007700     05  PS-BAR-CODE-3-FOUND-SW       PIC X(01)  VALUE 'N'.       00770000
007800         88  PS-BAR-CODE-3-FOUND                 VALUE 'Y'.       00780000
007900         88  PS-BAR-CODE-3-NOT-FOUND             VALUE 'N'.       00790000
008000     05  PS-BAR-CODE-PROCESS-DONE-SW  PIC X(01)  VALUE 'N'.       00800000
008100         88  PS-BAR-CODE-PROCESS-DONE            VALUE 'Y'.       00810000
008200         88  PS-BAR-CODE-PROCESS-NOT-DONE        VALUE 'N'.       00820000
008300     05  PS-TSHUNLO-TRIP-FOUND-SW     PIC X(01)  VALUE 'N'.       00830000
008400         88  PS-TSHUNLO-TRIP-FOUND               VALUE 'Y'.       00840000
008500         88  PS-TSHUNLO-TRIP-NOT-FOUND           VALUE 'N'.       00850000
008600     05  PS-TSULBXF-TRIP-FOUND-SW     PIC X(01)  VALUE 'N'.       00860000
008700         88  PS-TSULBXF-TRIP-FOUND               VALUE 'Y'.       00870000
008800         88  PS-TSULBXF-TRIP-NOT-FOUND           VALUE 'N'.       00880000
008900     05  PS-LOG-MESSAGE-SW            PIC X(01)  VALUE 'N'.       00890000
009000         88  PS-LOG-MESSAGE                      VALUE 'Y'.       00900000
009100         88  PS-NO-LOG-MESSAGE                   VALUE 'N'.       00910000
009200     05  PS-FIRST-ROW-FOUND-SW        PIC X(01)  VALUE 'N'.       00920000
009300         88  PS-FIRST-ROW-FOUND                  VALUE 'Y'.       00930000
009400         88  PS-FIRST-ROW-NOT-FOUND              VALUE 'N'.       00940000
009500     05  PS-END-SUT110-CURSOR-SW      PIC X(01)  VALUE 'N'.       00950000
009600         88  PS-END-SUT110-CURSOR                VALUE 'Y'.       00960000
009700         88  PS-NOT-END-SUT110-CURSOR            VALUE 'N'.       00970000
009800     05  PS-TRIP-SUT110-FOUND-SW      PIC X(01)  VALUE 'N'.       00980000
009900         88  PS-TRIP-SUT110-FOUND                VALUE 'Y'.       00990000
010000         88  PS-TRIP-SUT110-NOT-FOUND            VALUE 'N'.       01000000
010100     05  PS-WRKR-SUT111-FOUND-SW      PIC X(01)  VALUE 'N'.       01010000
010200         88  PS-WRKR-SUT111-FOUND                VALUE 'Y'.       01020000
010300         88  PS-WRKR-SUT111-NOT-FOUND            VALUE 'N'.       01030000
010400     05  PS-128-CARTON-FOUND-SW       PIC X(01)  VALUE 'N'.       01040000
010500         88  PS-128-CARTON-FOUND                 VALUE 'Y'.       01050000
010600         88  PS-128-CARTON-NOT-FOUND             VALUE 'N'.       01060000
010601* DMH - 9/21/11                                                   01060100
010610     05  PS-VENDOR-SSCC-SW            PIC X(01)  VALUE 'N'.       01061000
010611         88  PS-VENDOR-SSCC-YES                  VALUE 'Y'.       01061100
010612         88  PS-VENDOR-SSCC-NO                   VALUE 'N'.       01061200
010620     05  PS-MULT-VNDR-SSCC-SW         PIC X(01)  VALUE 'N'.       01062000
010621         88  PS-MULT-VNDR-SSCC-YES               VALUE 'Y'.       01062100
010622         88  PS-MULT-VNDR-SSCC-NO                VALUE 'N'.       01062200
010630     05  PS-VENDOR-SSCC-1-SW          PIC X(01)  VALUE 'N'.       01063000
010631         88  PS-VENDOR-SSCC-1-YES                VALUE 'Y'.       01063100
010632         88  PS-VENDOR-SSCC-1-NO                 VALUE 'N'.       01063200
010640     05  PS-VENDOR-SSCC-2-SW          PIC X(01)  VALUE 'N'.       01064000
010641         88  PS-VENDOR-SSCC-2-YES                VALUE 'Y'.       01064100
010642         88  PS-VENDOR-SSCC-2-NO                 VALUE 'N'.       01064200
010650*                                                                 01065000
010700     05  PS-TSHPUNT-TRIP-SW           PIC X(01)  VALUE 'N'.       01070000
010800         88  PS-TSHPUNT-TRIP-FOUND               VALUE 'Y'.       01080000
010900         88  PS-TSHPUNT-TRIP-NOT-FOUND           VALUE 'N'.       01090000
011000     05  PS-TSHPTPO-PO-SW             PIC X(01)  VALUE 'N'.       01100000
011100         88  PS-TSHPTPO-PO-FOUND                 VALUE 'Y'.       01110000
011200         88  PS-TSHPTPO-PO-NOT-FOUND             VALUE 'N'.       01120000
011300     05  PS-TPURCHS-ENT-SW            PIC X(01)  VALUE 'N'.       01130000
011400         88  PS-TPURCHS-ENT-FOUND                VALUE 'Y'.       01140000
011500         88  PS-TPURCHS-ENT-NOT-FOUND            VALUE 'N'.       01150000
011600     05  PS-SEARCH-COMPLETE-SW        PIC X(01)  VALUE 'N'.       01160000
011700         88  PS-SEARCH-COMPLETE                  VALUE 'Y'.       01170000
011800         88  PS-SEARCH-NOT-COMPLETE              VALUE 'N'.       01180000
011900     05  PS-TRIP-DOOR-UID-FOUND-SW    PIC X(01)  VALUE 'N'.       01190000
012000         88  PS-TRIP-DOOR-UID-FND                VALUE 'Y'.       01200000
012100         88  PS-TRIP-DOOR-UID-NOT-FND            VALUE 'N'.       01210000
012200     05  PS-INSERT-FIRST-SW           PIC X(01)  VALUE ' '.       01220000
012300         88  PS-INSERT-TBL-1                     VALUE '1'.       01230000
012400         88  PS-INSERT-TBL-SU092                 VALUE 'O'.       01240000
012500     05  PS-PARAGRAPH-SW              PIC X(01)  VALUE ' '.       01250000
012600         88  PS-4200-PARA                        VALUE '4'.       01260000
012700         88  PS-7500-PARA                        VALUE '7'.       01270000
012800     05  PS-LOG-LEVEL-SW              PIC X(01)  VALUE 'N'.       01280000
012900         88  PS-LOG-LEVEL-ALL                    VALUE 'A'.       01290000
013000         88  PS-LOG-LEVEL-PO                     VALUE 'P'.       01300000
013100         88  PS-LOG-LEVEL-VENDOR                 VALUE 'V'.       01310000
013200         88  PS-LOG-LEVEL-FIRST                  VALUE 'F'.       01320000
013300         88  PS-LOG-LEVEL-NONE                   VALUE 'N'.       01330000
013400* MS 06/18/2010 BEG                                               01340000
013500     05  PS-WHSE-TRIP-FOUND-SW        PIC X(01)  VALUE 'N'.       01350000
013600         88  PS-WHSE-TRIP-FOUND                  VALUE 'Y'.       01360000
013700         88  PS-WHSE-TRIP-NOT-FOUND              VALUE 'N'.       01370000
013800     05  PS-WHSE-OTBND-CART-SW        PIC X(01)  VALUE 'N'.       01380000
013900         88  PS-WHSE-OTBND-CART-YES              VALUE 'Y'.       01390000
014000         88  PS-WHSE-OTBND-CART-NO               VALUE 'N'.       01400000
014100     05  PS-END-SUT028-CURSOR-SW      PIC X(01)  VALUE 'N'.       01410000
014200         88  PS-END-SUT028-CURSOR                VALUE 'Y'.       01420000
014210         88  PS-NOT-END-SUT028-CURSOR            VALUE 'N'.       01421000
014220* MS 06/18/2010 END                                               01422000
014221     05  PS-BLD-INTERNAL-TABLE-SW     PIC  X(01) VALUE 'N'.       01422126
014222         88  PS-BLD-INTERNAL-TABLE-YES           VALUE 'Y'.       01422226
014223         88  PS-BLD-INTERNAL-TABLE-NO            VALUE 'N'.       01422326
014230                                                                  01423000
014240 01  PV-PROGRAM-VARIABLES.                                        01424000
014250     05  PV-TBL-SUB                      PIC   9(5) VALUE 0.      01425000
014260     05  PV-TBL-SUB-MAX                  PIC   9(5) VALUE 4.      01426000
014270     05  PV-CICS-MSG-AREA                PIC  X(120) VALUE SPACE. 01427014
014280     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01428000
014290                                                COMP SYNC.        01429000
014300     05  PV-CICS-RESPONSE                PIC S9(04)  VALUE +0     01430000
014400                                                COMP SYNC.        01440000
014500     05  PV-DISP-OPER                    PIC 9(04)  VALUE ZEROES. 01450011
014510     05  PV-DISP-PNA-STA                 PIC 9(04)  VALUE ZEROES. 01451011
014511     05  PV-DISP-PULL                    PIC 9(09)  VALUE ZEROES. 01451112
014520     05  PV-DISPLAY-SQLCODE              PIC -999   VALUE ZEROES. 01452018
014600     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               01460000
014700     05  PV-DISP-UPC-NBR                 PIC 9(15).               01470000
014800     05  PV-DISP-OPER-UNT-ID             PIC 9(04).               01480000
014900     05  PV-DISP-PO                      PIC 9(09).               01490000
014910     05  PV-DISP-ENTID                   PIC 9(09).               01491022
015000     05  PV-TRIP-ID-WORK                 PIC 9(11) VALUE 0.       01500000
015100     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(04).               01510000
015110     05  PV-DISP-TRIP                    PIC 9(09).               01511018
015120     05  PV-DISP-SSCC                    PIC 9(18).               01512025
015200     05  PV-DISPLAY-CICS-RESP            PIC 999999999-           01520000
015300                                                 VALUE ZEROS.     01530000
015400     05  PV-CART-MTCH-CDE                PIC X(03) VALUE SPACES.  01540000
015500* MS 06/18/2010 BEG                                               01550000
015600     05  PV-WHSE-OTBND-CART              PIC X(01) VALUE 'Y'.     01560000
015700     05  PV-TRIP-ID                      PIC S9(09) COMP VALUE 0. 01570000
015800     05  PV-WHSE-RPLN-TRIP-ID            PIC S9(09) COMP VALUE 0. 01580000
015900     05  PV-WHSE-TRIP-ID                 PIC S9(09) COMP VALUE 0. 01590000
016000* MS 06/18/2010 END                                               01600000
016010     05  PV-SSCC-UNCHKIN                 PIC S9(18)V COMP-3.      01601001
016020     05  PV-VENDOR-SSCC                  PIC S9(18)V COMP-3.      01602003
016021                                                                  01602130
016030     05  PV-CSSL-PARA                    PIC  X(04) VALUE SPACES. 01603026
016040     05  PV-PARM-SECONDS                 PIC S9(09) COMP VALUE 0. 01604028
016050     05  PV-RECEIVE-RQST-TMST            PIC X(26).               01605030
016060     05  PV-RECEIVE-RQST-TMST-R REDEFINES PV-RECEIVE-RQST-TMST.   01606032
016070         10  FILLER                      PIC  X(11).              01607030
016080         10  PV-INIT-HH                  PIC  9(02).              01608030
016090         10  FILLER                      PIC  X(01).              01609030
016091         10  PV-INIT-MM                  PIC  9(02).              01609130
016092         10  FILLER                      PIC  X(01).              01609230
016093         10  PV-INIT-SS                  PIC  9(02).              01609330
016094         10  FILLER                      PIC  X(07).              01609430
016095     05  PV-INIT-TIME-KEY.                                        01609530
016096         10  PV-INIT-KEY-HH              PIC  9(02).              01609630
016097         10  PV-INIT-KEY-MM              PIC  9(02).              01609730
016098         10  PV-INIT-KEY-SS              PIC  9(02).              01609830
016099     05  PV-DURATION-SEC                 PIC S9(09) COMP VALUE 0. 01609930
016100     05  PV-DISP-DURATION                PIC  9(09)   VALUE ZEROS.01610032
016101     05  PV-DISP-PARM-SECONDS            PIC  9(09)   VALUE ZEROS.01610130
016102     05  PV-DURATION-NANO-SEC            PIC S9(10) COMP VALUE 0. 01610232
016103     05  PV-WORK-NANO-SEC                PIC  9(10) VALUE ZEROES. 01610332
016104     05  PV-WORK-NANO-SEC-REDEF REDEFINES PV-WORK-NANO-SEC.       01610432
016105         10  PV-WORK-NANO-MIN-1-2        PIC  9(02).              01610532
016106         10  PV-WORK-NANO-SEC-3-4        PIC  9(02).              01610632
016107         10  PV-WORK-NANO-MICRO-5-10     PIC  9(06).              01610732
016108     05  PV-DISP-NANO-SEC                PIC  X(12).              01610832
016109     05  PV-DISP-NANO-SEC-REDEF REDEFINES PV-DISP-NANO-SEC.       01610932
016110         10  PV-DISP-NANO-MIN-1-2        PIC  9(02).              01611032
016111         10  PV-DISP-NANO-DASH-1         PIC  X(01).              01611132
016112         10  PV-DISP-NANO-SEC-3-4        PIC  9(02).              01611232
016113         10  PV-DISP-NANO-DASH-2         PIC  X(01).              01611332
016114         10  PV-DISP-NANO-MICRO-5-10     PIC  9(06).              01611432
016115     05  PV-CURRENT-PARA-TMST            PIC  X(26).              01611532
016116     05  PV-ASSOC-ASGND                  PIC  X(01).              01611633
016117     05  PV-NULL-IND                     PIC S9(04) VALUE ZEROS   01611733
016118                                                    COMP SYNC.    01611833
016119                                                                  01611932
016120                                                                  01612032
016121*----------------------------------------------------------------*01612128
016130* PARAGRAPH TRACKING TABLE - USED FOR DEBUGGING                  *01613028
016140* WILL TRACK PARAGRAPHS IN THIS TABLE - IF WE SEE TRANSACTION    *01614028
016150* IF TAKING LONGER THEN X SECONDS TO RESPOND, WILL DUMP THE      *01615028
016160* TABLE TO CSSL                                                  *01616028
016170* PARM PATIM1                                                    *01617028
016180*----------------------------------------------------------------*01618028
016190 01  PT-PARA-TRACKING-TABLE.                                      01619028
016191     05  PT-ENTRIES               OCCURS 1500 TIMES               01619128
016192                                  INDEXED BY PT-TRACK-IDX.        01619228
016193         10 FILLER                PIC  X(01) VALUE SPACE.         01619328
016194         10 PT-PROGRAM            PIC  X(08) VALUE 'SUKCS771'.    01619428
016195         10 FILLER                PIC  X(01) VALUE SPACE.         01619528
016196         10 pt-dc                 PIC  9(04) VALUE zeroes.        01619628
016197         10 filler                PIC  X(01) VALUE '-'.           01619728
016198         10 pt-pna-sta            PIC  9(03) VALUE zeroes.        01619828
016199         10 filler                PIC  X(01) VALUE '-'.           01619928
016200         10 pt-start-hhmmss       PIC  9(06) VALUE zeroes.        01620028
016201         10 FILLER                PIC  X(01) VALUE SPACE.         01620128
016202         10 PT-INDEX-NBR          PIC  9(05) VALUE ZEROES.        01620228
016203         10 FILLER                PIC  X(01) VALUE SPACE.         01620328
016204         10 PT-paragraph          PIC  X(04) VALUE SPACE.         01620428
016205         10 FILLER                PIC  X(01) VALUE SPACE.         01620528
016206         10 PT-TIMESTAMP          PIC  X(26) VALUE SPACE.         01620628
016207         10 FILLER                PIC  X(01) VALUE SPACE.         01620728
016208         10 PT-DURATION           PIC  9(09) VALUE ZEROES.        01620828
016209         10 FILLER                PIC  X(01) VALUE SPACE.         01620928
016210         10 PT-nano-sec           PIC  x(12) VALUE ZEROES.        01621028
016211     05  PT-MAX-PARA-ENTRIES      PIC  9(04) VALUE 1500.          01621128
016212     05  PT-CURR-ENTRIES          PIC  9(04) VALUE ZEROES.        01621228
016213     05  PT-CURR-PARA             PIC  X(04) VALUE SPACES.        01621328
016214                                                                  01621428
016215*                                                                 01621528
016216*                                                                 01621628
016217 01  PT-MSG-TABLE.                                                01621728
016218     05  PT-MESSAGES OCCURS 40 TIMES INDEXED BY PT-MSG-IDX.       01621828
016219         10  PT-MSG.                                              01621928
016220             15 PT-MESSAGE               PIC X(52).               01622028
016221             15 FILLER                   PIC X(1).                01622128
016222             15 PT-TASK                  PIC 9(07).               01622228
016223             15 FILLER                   PIC X(1).                01622328
016224                                                                  01622428
016225                                                                  01622528
016230                                                                  01623000
016300******************************************************************01630000
016400*  DCLGEN FOR THE PRINT AND APPLY STATION                         01640000
016500******************************************************************01650000
016600     EXEC SQL                                                     01660000
016700         INCLUDE SUT00107                                         01670000
016800     END-EXEC.                                                    01680000
016900                                                                  01690000
017000******************************************************************01700000
017100*  DCLGEN FOR THE PRINT AND APPLY STATION TRIP ASSIGNMENT         01710000
017200******************************************************************01720000
017300     EXEC SQL                                                     01730000
017400         INCLUDE SUT00110                                         01740000
017500     END-EXEC.                                                    01750000
017600                                                                  01760000
017700******************************************************************01770000
017800*  DCLGEN FOR THE STATION WORKER                                  01780000
017900******************************************************************01790000
018000     EXEC SQL                                                     01800000
018100         INCLUDE SUT00111                                         01810000
018200     END-EXEC.                                                    01820000
018300                                                                  01830000
018400******************************************************************01840000
018500*  DCLGEN FOR THE TRIP CARTON MATCH LEVEL                         01850000
018600******************************************************************01860000
018700     EXEC SQL                                                     01870000
018800         INCLUDE SUT00112                                         01880000
018900     END-EXEC.                                                    01890000
019000                                                                  01900000
019100******************************************************************01910000
019200*  DCLGEN FOR SHIPMENT UNIT LOCATION                              01920000
019300******************************************************************01930000
019400     EXEC SQL                                                     01940000
019500          INCLUDE TSHUNLO                                         01950000
019600     END-EXEC.                                                    01960000
019700                                                                  01970000
019800******************************************************************01980000
019900*  DCLGEN FOR LABEL CROSS REFERENCE                               01990000
020000******************************************************************02000000
020100     EXEC SQL                                                     02010000
020200          INCLUDE TSULBXF                                         02020000
020300     END-EXEC.                                                    02030000
020400                                                                  02040000
020500******************************************************************02050000
020600*  DCLGEN FOR SHIPMENT UNIT / UPC ASSOCIATION                     02060000
020700******************************************************************02070000
020800     EXEC SQL                                                     02080000
020900          INCLUDE TSHUUPC                                         02090000
021000     END-EXEC.                                                    02100000
021100                                                                  02110000
021200******************************************************************02120000
021300*  DCLGEN FOR PURCHASE TABLE                                      02130000
021400******************************************************************02140000
021500     EXEC SQL                                                     02150000
021600          INCLUDE TPURCHS                                         02160000
021700     END-EXEC.                                                    02170000
021800                                                                  02180000
021900******************************************************************02190000
022000*  DCLGEN FOR TRIP                                                02200000
022100******************************************************************02210000
022200     EXEC SQL                                                     02220000
022300          INCLUDE TVHTRIP                                         02230000
022400     END-EXEC.                                                    02240000
022500                                                                  02250000
022600******************************************************************02260000
022700*  DCLGEN FOR SHIPMENT                                            02270000
022800******************************************************************02280000
022900     EXEC SQL                                                     02290000
023000          INCLUDE TSHIPMT                                         02300000
023100     END-EXEC.                                                    02310000
023200                                                                  02320000
023300******************************************************************02330000
023400*  DCLGEN FOR SHIPMENT / PO ASSOCIATION                           02340000
023500******************************************************************02350000
023600     EXEC SQL                                                     02360000
023700          INCLUDE TSHPTPO                                         02370000
023800     END-EXEC.                                                    02380000
023900                                                                  02390000
024000******************************************************************02400000
024100*  DCLGEN FOR RECEIVER                                            02410000
024200******************************************************************02420000
024300     EXEC SQL                                                     02430000
024400          INCLUDE TRECEIV                                         02440000
024500     END-EXEC.                                                    02450000
024600                                                                  02460000
024700******************************************************************02470000
024800*  DCLGEN FOR INBOUND EDI PACKLIST / VENDOR SHIPMENT UNIT ASSOC.  02480000
024900******************************************************************02490000
025000     EXEC SQL                                                     02500000
025100          INCLUDE TINPKSU                                         02510000
025200     END-EXEC.                                                    02520000
025300                                                                  02530000
025400******************************************************************02540000
025500*  DCLGEN FOR SHIPMENT UNIT                                       02550000
025600******************************************************************02560000
025700     EXEC SQL                                                     02570000
025800          INCLUDE TSHPUNT                                         02580000
025900     END-EXEC.                                                    02590000
026000                                                                  02600000
026100******************************************************************02610000
026200*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 02620000
026300******************************************************************02630000
026400     EXEC SQL                                                     02640000
026500          INCLUDE TKRPRPM                                         02650000
026600     END-EXEC.                                                    02660000
026700                                                                  02670000
026800*----------------------------------------------------------------*02680000
026900*    DB2 PACK SLIP  TABLE (TPKSLIP)                               02690000
027000*----------------------------------------------------------------*02700000
027100     EXEC SQL                                                     02710000
027200          INCLUDE TPKSLIP                                         02720000
027300     END-EXEC.                                                    02730000
027400                                                                  02740000
027500* MS 06/18/2010 BEG                                               02750000
027600******************************************************************02760000
027700*  DCLGEN FOR OUTBOUND SHIP CARTON UPC TABLE SUT_OTBND_UPC        02770000
027800******************************************************************02780000
027900     EXEC SQL                                                     02790000
028000          INCLUDE SUT00028                                        02800000
028100     END-EXEC.                                                    02810000
028200                                                                  02820000
028300******************************************************************02830000
028400*  DCLGEN FOR OUTBOUND LOCATION TABLE SUT_OTBND_LOC               02840000
028500******************************************************************02850000
028600     EXEC SQL                                                     02860000
028700          INCLUDE SUT00027                                        02870000
028800     END-EXEC.                                                    02880000
028900                                                                  02890000
029000******************************************************************02900000
029100*  DCLGEN FOR OUTBOUND CARTON TABLE SUT_OTBND_CART                02910000
029200******************************************************************02920000
029300     EXEC SQL                                                     02930000
029400          INCLUDE SUT00024                                        02940000
029500     END-EXEC.                                                    02950000
029600                                                                  02960000
029700******************************************************************02970000
029800*  DCLGEN FOR TRAILER REPLENISHMENT TABLE SUT_TRLR_RPLN_CART      02980000
029900******************************************************************02990000
030000     EXEC SQL                                                     03000000
030100          INCLUDE SUT00113                                        03010000
030200     END-EXEC.                                                    03020000
030300                                                                  03030000
030400* MS 06/18/2010 END                                               03040000
030500******************************************************************03050000
030600*    CURSOR FOR SUT00110 PRINT AND APPLY TRIP ASSIGNMENT          03060000
030700******************************************************************03070000
030800***                                                               03080032
030900***  EXEC SQL                                                     03090032
031000***     DECLARE DOOR-TRIP-CSR CURSOR FOR                          03100032
031100***      SELECT                                                   03110032
031200***              DOOR_ID                                          03120032
031300***             ,INBD_TRIP_ID                                     03130032
031400***             ,ASGD_STRT_TMST                                   03140032
031500***             ,CRE_BY_USR_ID                                    03150032
031600***                                                               03160032
031700***        FROM  SUT_PNA_TRIP_ASGMT                               03170032
031800***       WHERE  OPER_UNT_ID      = :DK-OPER-UNT-ID               03180032
031900***         AND  ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR           03190032
032000***         AND  ASGD_END_TMST     = :PC-DEFAULT-TMST             03200032
032100***    ORDER BY  ASGD_STRT_TMST   ASC                             03210032
032200***  END-EXEC.                                                    03220032
032300***                                                               03230032
032301*                                                                 03230132
032302*** CHANGED DOOR-TRIP-CSR TO BRING BACK THE TRAILER THAT HAVE     03230232
032303*** ASSOCIATES ASSIGNED FIRST                                     03230332
032304*** THE 1ST PART OF THE sql (T1) BRINGS BACK THE ASSIGNED TRIPS   03230432
032305*** THE 2ND PART OF THE sql (T2) BRINGS BACK 1 IF AN ASSOCIATE    03230532
032306*** IS CURRENTLY ASSIGNED TO THE TRAILER                          03230632
032307*                                                                 03230732
032308     EXEC SQL                                                     03230832
032309        DECLARE DOOR-TRIP-CSR CURSOR FOR                          03230932
032310         SELECT                                                   03231032
032311                 T1.DOOR_ID                                       03231132
032312               , T1.INBD_TRIP_ID                                  03231232
032313               , T1.ASGD_STRT_TMST                                03231332
032314               , T1.CRE_BY_USR_ID                                 03231432
032315               , T2.ASSOC_ASGND                                   03231532
032316           FROM                                                   03231632
032317                (SELECT                                           03231732
032318                        A.DOOR_ID                                 03231832
032319                      , A.INBD_TRIP_ID                            03231932
032320                      , A.ASGD_STRT_TMST                          03232032
032321                      , A.CRE_BY_USR_ID                           03232132
032322                   FROM SUT_PNA_TRIP_ASGMT A                      03232232
032323                  WHERE                                           03232332
032324                       A.OPER_UNT_ID      = :DK-OPER-UNT-ID       03232432
032325                   AND A.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR   03232532
032326                   AND A.ASGD_END_TMST    = :PC-DEFAULT-TMST      03232632
032327                ) AS T1                                           03232732
032328         LEFT OUTER JOIN                                          03232832
032329                (SELECT                                           03232932
032330                        B.DOOR_ID                                 03233032
032331                      , B.INBD_TRIP_ID                            03233132
032332                      , B.ASGD_STRT_TMST                          03233232
032333                      , '1' AS ASSOC_ASGND                        03233332
032334                   FROM SUT_PNA_STA_WRKR B                        03233432
032335                  WHERE                                           03233532
032336                       B.OPER_UNT_ID     = :DK-OPER-UNT-ID        03233632
032337                   AND B.ACM_LBL_STA_NBR = :DK-ACM-LBL-STA-NBR    03233732
032338                   AND B.WRKR_END_TMST   = :PC-DEFAULT-TMST       03233832
032339                 GROUP BY B.DOOR_ID                               03233932
032340                         ,B.INBD_TRIP_ID                          03234032
032341                         ,B.ASGD_STRT_TMST                        03234132
032342                ) AS T2                                           03234232
032343            ON T1.DOOR_ID         =  T2.DOOR_ID                   03234332
032344           AND T1.INBD_TRIP_ID    =  T2.INBD_TRIP_ID              03234432
032345           AND T1.ASGD_STRT_TMST  =  T2.ASGD_STRT_TMST            03234532
032346         ORDER BY T2.ASSOC_ASGND                                  03234632
032347                , T1.ASGD_STRT_TMST                               03234732
032348          WITH UR                                                 03234838
032360     END-EXEC.                                                    03236032
032370                                                                  03237032
032400*                                                                 03240032
032500******************************************************************03250000
032600* CURSOR TO GET THE PULL NUMBER FROM SUT_OTBND_UPC TABLE          03260000
032700******************************************************************03270000
032800     EXEC SQL                                                     03280000
032900        DECLARE PULL-CSR CURSOR FOR                               03290000
033000         SELECT                                                   03300000
033100                 TRN_NBR                                          03310000
033200           FROM  SUT_OTBND_UPC                                    03320000
033300          WHERE  SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                  03330000
033310           WITH UR                                                03331038
033400     END-EXEC.                                                    03340000
033500                                                                  03350000
033600* MS 06/18/2010 END                                               03360000
033700******************************************************************03370000
033800*  COMMUNICATIONS AREA FOR DB2                                    03380000
033900******************************************************************03390000
034000     EXEC SQL                                                     03400000
034100         INCLUDE SQLCA                                            03410000
034200     END-EXEC.                                                    03420000
034300                                                                  03430016
034400******************************************************************03440000
034500                                                                  03450000
034600 01  PV-TRIP-TABLE.                                               03460000
034700     05  TRIP-ENTRIES  OCCURS 4 TIMES.                            03470000
034800         10  TBL-TRIP-ID          PIC S9(09) COMP.                03480000
034900         10  TBL-DOOR-ID          PIC  X(04).                     03490000
035000         10  TBL-USER-ID          PIC  X(08).                     03500000
035100         10  TBL-ASGD-STRT-TMST   PIC  X(26).                     03510000
035200         10  TBL-WRKR-FOUND       PIC  X(01).                     03520000
035300                                                                  03530000
035400******************************************************************03540000
035500                                                                  03550000
035600                                                                  03560000
035700******************************************************************03570000
035800 LINKAGE SECTION.                                                 03580000
035900     COPY SUWS092.                                                03590000
036000                                                                  03600000
036100******************************************************************03610000
036200 PROCEDURE DIVISION  USING SU092-ITEM-COMMAREA.                   03620000
036300******************************************************************03630000
036400 0000-PROGRAM-MAINLINE.                                           03640000
036500                                                                  03650000
036510     SET PS-NO-LOG-MESSAGE                                        03651037
036520         PS-BLD-INTERNAL-TABLE-NO  to  true.                      03652037
036530                                                                  03653037
036600     PERFORM 1000-INITIALIZE-VARIABLES.                           03660000
036700                                                                  03670000
036800******************************************************************03680000
036900*    CARTON LOOKUP - PREVIOUSLY SCANNED CARTON                    03690000
037000*        THIS AREA DETERMINES IF THE CARTON HAS BEEN PREVIOUSLY   03700000
037100*        CHECKED-IN. IF A MATCH IS FOUND THE PREVIOUSLY           03710000
037200*        DETERMINED TRIP AND RELATED INFORMATION WILL BE USED     03720000
037300*        AND RETURNED TO THE CALLING PROGRAM.                     03730000
037400******************************************************************03740000
037410                                                                  03741006
037500     PERFORM 2000-BAR-CODE-LOOKUP.                                03750000
037600                                                                  03760000
037601******************************************************************03760106
037610*                                                                 03761000
037620* DMH 9/21/11 BEGIN                                               03762000
037621* IF CARTON NOT PREVIOUSLY CHECKED IN                             03762100
037622*    AND HAVE MULTIPLE BARCODES                                   03762200
037623*    AND NOT WHSE OUTBOUND                                        03762300
037624*        CHECK TO SEE IF MULTIPLE SSCC                            03762400
037625*        IF MULTIPLE SSCC'S ERROR LABEL - MULT BRCDE              03762500
037626*                                                                 03762600
037627     IF PS-BAR-CODE-PROCESS-NOT-DONE                              03762700
037630        IF  PS-BAR-CODE-1-FOUND  AND                              03763000
037640            PS-BAR-CODE-2-FOUND  AND                              03764000
037650            PS-WHSE-OTBND-CART-NO                                 03765000
037700            SET PS-VENDOR-SSCC-NO                                 03770000
037701                PS-MULT-VNDR-SSCC-NO                              03770100
037702                PS-VENDOR-SSCC-1-NO                               03770200
037703                PS-VENDOR-SSCC-2-NO  TO TRUE                      03770300
037704                                                                  03770406
037705            MOVE SU092-KEY-BAR-CODE-1 TO PV-SSCC-UNCHKIN          03770500
037706            PERFORM 2900-CHECK-VNDR-SSCC                          03770601
037707            IF  PS-VENDOR-SSCC-YES                                03770700
037708                SET PS-VENDOR-SSCC-1-YES  TO TRUE                 03770800
037709            END-IF                                                03770900
037710                                                                  03771006
037711            SET PS-VENDOR-SSCC-NO TO TRUE                         03771100
037712            MOVE SU092-KEY-BAR-CODE-2 TO PV-SSCC-UNCHKIN          03771200
037713            PERFORM 2900-CHECK-VNDR-SSCC                          03771301
037714            IF  PS-VENDOR-SSCC-YES                                03771400
037715                SET PS-VENDOR-SSCC-2-YES  TO TRUE                 03771500
037716            END-IF                                                03771600
037717                                                                  03771706
037718            IF  PS-VENDOR-SSCC-1-YES  AND                         03771800
037719                PS-VENDOR-SSCC-2-YES                              03771900
037720                SET PS-BAR-CODE-PROCESS-DONE                      03772002
037721                    PS-MULT-VNDR-SSCC-YES                         03772105
037722                    SU092-MULT-SSCC-YES  TO  TRUE                 03772202
037723            END-IF                                                03772302
037724     END-IF                                                       03772400
037725*** DMH 9/21/11 END                                               03772500
037726*                                                                 03772600
037730                                                                  03773000
037800*    *************************************************************03780000
037900*       CARTON LOOKUP - THE CARTON WASN'T PREVIOUSLY CHECKED-IN   03790000
038000*           SO WE NEED TO PERFORM A SEPARATE SET OF CHECKS TO     03800000
038100*           DETERMINE THE TRIP AND RELATED INFORMATION.           03810000
038200*    *************************************************************03820000
038210* MS 06/18/2010 BEG                                               03821000
038211*                                                                 03821100
038212* TO CHECK FOR THE PROCESSED FREIGHT CARTON IF IT IS NOT          03821200
038213* PREVIOUSLY SCANNED                                              03821300
038214*                                                                 03821400
038218        IF PS-WHSE-OTBND-CART-YES                                 03821800
038219           PERFORM 3100-CARTON-LOOKUP                             03821900
038220        ELSE                                                      03822000
038221           PERFORM 3000-CARTON-LOOKUP                             03822100
038222        END-IF                                                    03822200
038223*       PERFORM 3000-CARTON-LOOKUP                                03822300
038230     END-IF.                                                      03823000
038240* MS 06/18/2010 END                                               03824000
038250                                                                  03825000
038260     IF PS-LOG-MESSAGE                                            03826000
038261         MOVE  SPACES                TO PV-CICS-MSG-AREA          03826122
038262         MOVE  SU092-KEY-ACM-STN-NBR TO PV-DISP-PNA-STA           03826222
038263         MOVE  SU092-KEY-DC-LOC      TO PV-DISP-OPER              03826322
038270         STRING   ' SUKUT709 PROGRAM ENDED -'                     03827000
038300                  ' DC:'                PV-DISP-OPER              03830022
038500                  ' STA:'               PV-DISP-PNA-STA           03850022
038700                  ' BC1:'               SU092-KEY-BAR-CODE-1      03870022
038800                  ' BC2:'               SU092-KEY-BAR-CODE-2      03880022
038900                  DELIMITED BY SIZE                               03890000
039000                                  INTO PV-CICS-MSG-AREA           03900000
039100         PERFORM 9999-WRITE-TO-CSSL                               03910000
039101                                                                  03910122
039102         MOVE  SPACES                TO PV-CICS-MSG-AREA          03910239
039103         MOVE  SU092-KEY-ACM-STN-NBR TO PV-DISP-PNA-STA           03910339
039104         MOVE  SU092-KEY-DC-LOC      TO PV-DISP-OPER              03910439
039105         STRING   ' SUKUT709 PROGRAM ENDED -'                     03910539
039110                  ' BC3:'               SU092-KEY-BAR-CODE-3      03911039
039111                  ' FLAGS:'             SU092-FLAGS               03911139
039112                  DELIMITED BY SIZE                               03911239
039113                                  INTO PV-CICS-MSG-AREA           03911339
039114         PERFORM 9999-WRITE-TO-CSSL                               03911439
039115                                                                  03911539
039116         MOVE  SPACES                 TO PV-CICS-MSG-AREA         03911639
039120         MOVE  SU092-TRIP-ID          TO PV-DISP-TRIP             03912022
039170         STRING   ' SUKUT709 PROGRAM ENDED -'                     03917022
039190                  ' TRIP:'               PV-DISP-TRIP             03919022
039191                  ' USER:'               SU092-USER-ID            03919122
039192                  ' DOOR:'               SU092-DOOR-ID            03919222
039193                  ' ERR#:'               SU092-ERROR-NBR          03919322
039194                  ' PARA:'               SU092-ERROR-PARA         03919422
039195                  DELIMITED BY SIZE                               03919522
039196                                  INTO PV-CICS-MSG-AREA           03919622
039197         PERFORM 9999-WRITE-TO-CSSL                               03919722
039200     END-IF.                                                      03920000
039300                                                                  03930000
039400     MOVE SU092-ITEM-COMMAREA TO DFHCOMMAREA.                     03940000
039401                                                                  03940129
039402                                                                  03940229
039410* DMH 1/29/15 - BEGIN                                             03941029
039420     IF  PS-BLD-INTERNAL-TABLE-YES  and                           03942029
039430         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  03943029
039440                                                                  03944029
039450         move spaces to  pv-ciCS-MSG-AREA                         03945029
039460         PERFORM 9999-WRITE-TO-CSSL                               03946031
039470                                                                  03947029
039480         INITIALIZE PV-CICS-MSG-AREA                              03948029
039491         MOVE SU092-KEY-DC-LOC      TO PV-DISP-OPER               03949131
039492         MOVE SU092-KEY-ACM-STN-NBR TO PV-DISP-PNA-STA            03949231
039493         STRING ' SUKUT709-DID NOT MEET SLA'                      03949329
039494                ' DC:'        PV-DISP-OPER                        03949431
039495                ' STA:'       PV-DISP-PNA-STA                     03949531
039496                ' KEY:'       PV-INIT-TIME-KEY                    03949629
039499                              DELIMITED BY SIZE                   03949929
039500                         INTO PV-CICS-MSG-AREA                    03950029
039501         PERFORM 9999-WRITE-TO-CSSL                               03950131
039503                                                                  03950334
039504         INITIALIZE PV-CICS-MSG-AREA                              03950434
039508         STRING ' SUKUT709 '                                      03950835
039509                ' START:'     PV-RECEIVE-RQST-TMST                03950935
039512                ' END:'       PV-CURRENT-PARA-TMST                03951235
039513                ' DURATION:'  PV-DISP-NANO-SEC                    03951335
039514                              DELIMITED BY SIZE                   03951434
039515                         INTO PV-CICS-MSG-AREA                    03951534
039516         PERFORM 9999-WRITE-TO-CSSL                               03951634
039517                                                                  03951734
039518         INITIALIZE PV-CICS-MSG-AREA                              03951829
039519         STRING ' SUKUT770-'                                      03951929
039520                ' KEY:'       PV-INIT-TIME-KEY                    03952029
039521                ' INIT:'      PV-RECEIVE-RQST-TMST                03952129
039522                ' CURR:'      PV-CURRENT-PARA-TMST                03952229
039523                              DELIMITED BY SIZE                   03952329
039524                         INTO PV-CICS-MSG-AREA                    03952429
039525                                                                  03952529
039526         PERFORM 6100-WRITE-SUWS092-TO-CSSL                       03952629
039527                                                                  03952729
039528         move spaces to  pv-ciCS-MSG-AREA                         03952829
039529         PERFORM 9999-WRITE-TO-CSSL                               03952931
039530                                                                  03953029
039531         PERFORM 1630-DUMP-TABLE-TO-CSSL                          03953129
039532         VARYING PT-TRACK-IDX                                     03953229
039533            FROM 1 BY 1                                           03953329
039534           UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                 03953429
039535              OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES             03953529
039536                                                                  03953629
039537         PERFORM 1640-CLEAR-TABLE                                 03953729
039538         VARYING PT-TRACK-IDX                                     03953829
039539            FROM 1 BY 1                                           03953929
039540            UNTIL PT-TRACK-IDX >=  PT-CURR-ENTRIES                03954029
039541               OR PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES            03954129
039542                                                                  03954229
039543         MOVE ZEROES TO PT-CURR-ENTRIES                           03954329
039544         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   03954429
039545                                                                  03954529
039546         INITIALIZE PV-CICS-MSG-AREA                              03954629
039547         MOVE SU092-KEY-DC-LOC      TO PV-DISP-OPER               03954731
039548         MOVE SU092-KEY-ACM-STN-NBR TO PV-DISP-PNA-STA            03954831
039549         MOVE PV-DURATION-SEC TO  PV-DISP-DURATION                03954929
039550         STRING ' SUKUT709-DID NOT MEET SLA'                      03955029
039551                ' DC:'        PV-DISP-OPER                        03955131
039552                ' STA:'       PV-DISP-PNA-STA                     03955231
039553                ' KEY:'       PV-INIT-TIME-KEY                    03955329
039554                ' DONE'                                           03955429
039555                              DELIMITED BY SIZE                   03955529
039556                         INTO PV-CICS-MSG-AREA                    03955629
039557         PERFORM 9999-WRITE-TO-CSSL                               03955731
039558                                                                  03955829
039559         move spaces to  pv-ciCS-MSG-AREA                         03955929
039560         PERFORM 9999-WRITE-TO-CSSL                               03956031
039561                                                                  03956129
039562     END-IF.                                                      03956229
039563                                                                  03956329
039564* DMH 1/19/15 - BEGIN                                             03956429
039565                                                                  03956529
039570     GOBACK.                                                      03957000
039600                                                                  03960000
039700 1000-INITIALIZE-VARIABLES.                                       03970000
039710                                                                  03971013
039717     IF PS-LOG-MESSAGE                                            03971728
039718         MOVE  SPACES              TO  PV-CICS-MSG-AREA           03971828
039719         STRING   ' SUKUT709 1000 '                               03971928
039721                                       DELIMITED BY SIZE          03972113
039722                                  INTO PV-CICS-MSG-AREA           03972213
039723         PERFORM 9999-WRITE-TO-CSSL                               03972313
039724     END-IF.                                                      03972413
039795                                                                  03979513
039796     EXEC SQL                                                     03979628
039797          SET :PV-RECEIVE-RQST-TMST = CURRENT TIMESTAMP           03979728
039798     END-EXEC.                                                    03979828
039799                                                                  03979928
039800     MOVE  PV-INIT-HH    TO  PV-INIT-KEY-HH.                      03980028
039801     MOVE  PV-INIT-MM    TO  PV-INIT-KEY-MM.                      03980128
039802     MOVE  PV-INIT-SS    TO  PV-INIT-KEY-SS.                      03980228
039803                                                                  03980328
039810     MOVE ZEROES TO TBL-TRIP-ID(1)                                03981000
039900                    TBL-TRIP-ID(2)                                03990000
040000                    TBL-TRIP-ID(3)                                04000000
040100                    TBL-TRIP-ID(4)                                04010000
040200     MOVE SPACES TO TBL-DOOR-ID (1)                               04020000
040300                    TBL-DOOR-ID (2)                               04030000
040400                    TBL-DOOR-ID (3)                               04040000
040500                    TBL-DOOR-ID (4)                               04050000
040600                    TBL-USER-ID (1)                               04060000
040700                    TBL-USER-ID (2)                               04070000
040800                    TBL-USER-ID (3)                               04080000
040900                    TBL-USER-ID (4)                               04090000
041000                    TBL-ASGD-STRT-TMST(1)                         04100000
041100                    TBL-ASGD-STRT-TMST(2)                         04110000
041200                    TBL-ASGD-STRT-TMST(3)                         04120000
041300                    TBL-ASGD-STRT-TMST(4)                         04130000
041400                    TBL-WRKR-FOUND (1)                            04140000
041500                    TBL-WRKR-FOUND (2)                            04150000
041600                    TBL-WRKR-FOUND (3)                            04160000
041700                    TBL-WRKR-FOUND (4)                            04170000
041800                                                                  04180000
041900     MOVE SPACES  TO SU092-USER-ID                                04190000
042000                     SU092-DOOR-ID                                04200000
042100                     SUT00110-DOOR-ID                             04210000
042200                     SUT00110-ASGD-STRT-TMST                      04220000
042300                     SUT00110-CRE-BY-USR-ID.                      04230000
042400                                                                  04240000
042500     MOVE ZEROES  TO SU092-TRIP-ID                                04250000
042600                     PV-WHSE-OTBND-CART                           04260000
042700                     PV-TRIP-ID                                   04270000
042800                     PV-WHSE-RPLN-TRIP-ID                         04280000
042900                     SUT00110-INBD-TRIP-ID                        04290000
043000                     PV-WHSE-TRIP-ID.                             04300000
043100                                                                  04310000
043200     MOVE  'N'  TO PS-BAR-CODE-1-FOUND-SW                         04320000
043300                   PS-BAR-CODE-2-FOUND-SW                         04330000
043400                   PS-BAR-CODE-3-FOUND-SW                         04340000
043500                   PS-WHSE-TRIP-FOUND-SW                          04350000
043600                   PS-WHSE-OTBND-CART-SW                          04360000
043700                   PS-END-SUT028-CURSOR-SW.                       04370000
043800                                                                  04380000
043900     IF SU092-KEY-DC-LOC > 0                                      04390000
044000        MOVE SU092-KEY-DC-LOC      TO DK-OPER-UNT-ID              04400000
044100        MOVE SU092-KEY-ACM-STN-NBR TO DK-PNA-STA-NBR              04410000
044200     END-IF.                                                      04420000
044300                                                                  04430000
044301*                                                                 04430114
044302*** DMH 1/26/2015                                                 04430214
044310     PERFORM 5120-CHECK-CSSL-LOGGING.                             04431014
044311     PERFORM 5130-CHECK-PARA-TRACK-SEC.                           04431126
044312*** DMH 1/26/2015                                                 04431226
044313*                                                                 04431326
044320                                                                  04432014
044330                                                                  04433014
044400******************************************************************04440000
044500*    CARTON LOOKUP - PREVIOUSLY SCANNED CARTON                    04450000
044600*                                                                 04460000
044700*                                                                 04470000
044800******************************************************************04480000
044900                                                                  04490000
045000 2000-BAR-CODE-LOOKUP.                                            04500000
045001                                                                  04500113
045002     IF  PS-BLD-INTERNAL-TABLE-YES                                04500228
045003         MOVE  '2000'  TO  PT-CURR-PARA                           04500328
045004         PERFORM 6110-INTERNAL-TABLE                              04500428
045005     END-IF.                                                      04500528
045006                                                                  04500628
045010     IF PS-LOG-MESSAGE                                            04501013
045020         MOVE  SPACES              TO  PV-CICS-MSG-AREA           04502013
045030         STRING   ' SUKUT709 2000 '                               04503013
045040                                       DELIMITED BY SIZE          04504013
045050                                  INTO PV-CICS-MSG-AREA           04505013
045060         PERFORM 9999-WRITE-TO-CSSL                               04506013
045070     END-IF.                                                      04507013
045080                                                                  04508013
045100                                                                  04510000
045200     SET PS-BAR-CODE-PROCESS-NOT-DONE TO TRUE.                    04520000
045300                                                                  04530000
045400     IF SU092-KEY-BAR-CODE-1 > SPACES                             04540000
045410         IF PS-LOG-MESSAGE                                        04541021
045420             MOVE  SPACES          TO  PV-CICS-MSG-AREA           04542021
045430             STRING   ' SUKUT709 2000 '                           04543021
045431                      'BARCODE 1:'     SU092-KEY-BAR-CODE-1       04543124
045440                                       DELIMITED BY SIZE          04544021
045450                                  INTO PV-CICS-MSG-AREA           04545021
045460             PERFORM 9999-WRITE-TO-CSSL                           04546021
045470         END-IF                                                   04547021
045500        SET PS-BAR-CODE-1-FOUND TO TRUE                           04550000
045600        MOVE SU092-KEY-BAR-CODE-1 TO DK-BAR-CODE-20               04560000
045700        PERFORM 2400-PROCESS-BAR-CODE-1-OR-2                      04570000
045800* MS 06/18/2010 BEG                                               04580000
045900* TO CHECK IF THE WAREHOUSE REPLENISHMENT CARTON HAS BEEN         04590000
046000* PREVIOUSLY CHECKED IN                                           04600000
046100        IF PS-BAR-CODE-PROCESS-NOT-DONE                           04610000
046200          PERFORM 2500-PROCESS-BAR-CODE-1-OR-2                    04620000
046300        END-IF                                                    04630000
046400* MS 06/18/2010 END                                               04640000
046500     END-IF.                                                      04650000
046600                                                                  04660000
046700     IF PS-BAR-CODE-PROCESS-NOT-DONE                              04670000
046800        IF SU092-KEY-BAR-CODE-2 > SPACES                          04680000
046810           IF PS-LOG-MESSAGE                                      04681021
046820               MOVE  SPACES          TO  PV-CICS-MSG-AREA         04682021
046830               STRING   ' SUKUT709 2000 '                         04683021
046840                        'BARCODE 2:'     SU092-KEY-BAR-CODE-2     04684024
046850                                       DELIMITED BY SIZE          04685021
046860                                    INTO PV-CICS-MSG-AREA         04686021
046870               PERFORM 9999-WRITE-TO-CSSL                         04687021
046880           END-IF                                                 04688021
046900           SET PS-BAR-CODE-2-FOUND TO TRUE                        04690000
047000           MOVE SU092-KEY-BAR-CODE-2 TO DK-BAR-CODE-20            04700000
047100           PERFORM 2400-PROCESS-BAR-CODE-1-OR-2                   04710000
047200* MS 06/18/2010 BEG                                               04720000
047210* TO CHECK IF THE WAREHOUSE REPLENISHMENT CARTON HAS BEEN         04721000
047220* PREVIOUSLY CHECKED IN                                           04722000
047230           IF PS-BAR-CODE-PROCESS-NOT-DONE                        04723000
047240             PERFORM 2500-PROCESS-BAR-CODE-1-OR-2                 04724000
047250           END-IF                                                 04725000
047260* MS 06/18/2010 END                                               04726000
047270        END-IF                                                    04727000
047280     END-IF.                                                      04728000
047290                                                                  04729000
047300     IF PS-BAR-CODE-PROCESS-NOT-DONE                              04730000
047400        IF SU092-KEY-BAR-CODE-3 > SPACES                          04740000
047410           IF PS-LOG-MESSAGE                                      04741021
047420               MOVE  SPACES          TO  PV-CICS-MSG-AREA         04742021
047430               STRING   ' SUKUT709 2000 '                         04743021
047440                        'BARCODE 3:'     SU092-KEY-BAR-CODE-3     04744025
047450                                       DELIMITED BY SIZE          04745021
047460                                    INTO PV-CICS-MSG-AREA         04746021
047470               PERFORM 9999-WRITE-TO-CSSL                         04747021
047480           END-IF                                                 04748021
047500           SET PS-BAR-CODE-3-FOUND TO TRUE                        04750000
047600           MOVE SU092-KEY-BAR-CODE-3 TO DK-BAR-CODE-22            04760000
047700           PERFORM 2800-PROCESS-BAR-CODE-3                        04770000
047800        END-IF                                                    04780000
047900     END-IF.                                                      04790000
048000                                                                  04800000
048100                                                                  04810000
048200 2400-PROCESS-BAR-CODE-1-OR-2.                                    04820000
048201                                                                  04820128
048202     IF  PS-BLD-INTERNAL-TABLE-YES                                04820228
048203         MOVE  '2400'  TO  PT-CURR-PARA                           04820328
048204         PERFORM 6110-INTERNAL-TABLE                              04820428
048205     END-IF.                                                      04820528
048210                                                                  04821013
048220     IF PS-LOG-MESSAGE                                            04822013
048230         MOVE  SPACES              TO  PV-CICS-MSG-AREA           04823013
048240         STRING   ' SUKUT709 2400 '                               04824013
048250                                       DELIMITED BY SIZE          04825013
048260                                  INTO PV-CICS-MSG-AREA           04826013
048270         PERFORM 9999-WRITE-TO-CSSL                               04827013
048280     END-IF.                                                      04828013
048290                                                                  04829013
048300                                                                  04830000
048400     PERFORM 7300-SELECT-TSHUNLO.                                 04840000
048500     IF PS-TSHUNLO-TRIP-FOUND                                     04850000
048600        PERFORM 7500-SELECT-TRIP-ASSIGMENT                        04860000
048700        IF PS-TRIP-SUT110-FOUND                                   04870000
048800           PERFORM 2600-FORMAT-TRIP-FOUND                         04880000
048900           SET PS-BAR-CODE-PROCESS-DONE TO TRUE                   04890000
049000**??       MOVE SUT00110-DOOR-ID       TO SU092-DOOR-ID           04900000
049100**??       MOVE SUT00110-CRE-BY-USR-ID TO SU092-USER-ID           04910000
049200**??       MOVE SUT00111-WRKR-USR-ID   TO SU092-USER-ID           04920000
049300**??       MOVE SHUNLO-TRIP-ID         TO SU092-TRIP-ID           04930000
049400        END-IF                                                    04940000
049500     ELSE                                                         04950040
049600        MOVE DK-BAR-CODE-20 TO DK-BAR-CODE-22                     04960000
049700        PERFORM 7700-SELECT-TSULBXF                               04970000
049800        IF PS-TSULBXF-TRIP-FOUND                                  04980000
049900           PERFORM 7500-SELECT-TRIP-ASSIGMENT                     04990000
050000           IF PS-TRIP-SUT110-FOUND                                05000000
050100              PERFORM 2600-FORMAT-TRIP-FOUND                      05010000
050200              SET PS-BAR-CODE-PROCESS-DONE TO TRUE                05020000
050300**??          MOVE SUT00110-DOOR-ID  TO  SU092-DOOR-ID            05030000
050400**??          MOVE SUT00110-CRE-BY-USR-ID TO  SU092-USER-ID       05040000
050500**??          MOVE SUT00111-WRKR-USR-ID   TO SU092-USER-ID        05050000
050600**??          MOVE SHUNLO-TRIP-ID    TO  SU092-TRIP-ID            05060000
050700           END-IF                                                 05070000
050710***                                                               05071040
050720*** DMH - START 11/6/2023                                         05072040
050730        ELSE                                                      05073040
050740            PERFORM  7510-SELECT-TRIP-WORKER                      05074040
050760*** DMH - END 11/6/2023                                           05076040
050770***                                                               05077040
050800        END-IF                                                    05080000
050870                                                                  05087040
050900     END-IF.                                                      05090000
051000                                                                  05100000
051100                                                                  05110000
051200* MS 06/18/2010 BEG                                               05120000
051300* TO CHECK IF THE WAREHOUSE REPLENISHMENT CARTON HAS BEEN         05130000
051400* PREVIOUSLY CHECKED IN                                           05140000
051500 2500-PROCESS-BAR-CODE-1-OR-2.                                    05150000
051501                                                                  05150128
051502     IF  PS-BLD-INTERNAL-TABLE-YES                                05150228
051503         MOVE  '2500'  TO  PT-CURR-PARA                           05150328
051504         PERFORM 6110-INTERNAL-TABLE                              05150428
051505     END-IF.                                                      05150528
051510                                                                  05151013
051520     IF PS-LOG-MESSAGE                                            05152013
051530         MOVE  SPACES              TO  PV-CICS-MSG-AREA           05153013
051540         STRING   ' SUKUT709 2500 '                               05154013
051550                                       DELIMITED BY SIZE          05155013
051560                                  INTO PV-CICS-MSG-AREA           05156013
051570         PERFORM 9999-WRITE-TO-CSSL                               05157013
051580     END-IF.                                                      05158013
051590                                                                  05159013
051600                                                                  05160000
051700     PERFORM 7400-SELECT-OTBND-CART                               05170000
051800       IF PS-WHSE-OTBND-CART-YES                                  05180000
051900         PERFORM 7450-SELECT-OTBND-LOC                            05190000
052000           IF PS-WHSE-TRIP-FOUND                                  05200000
052100              PERFORM 7500-SELECT-TRIP-ASSIGMENT                  05210000
052200                IF PS-TRIP-SUT110-FOUND                           05220000
052300                   PERFORM 2600-FORMAT-TRIP-FOUND                 05230000
052400                   SET PS-BAR-CODE-PROCESS-DONE TO TRUE           05240000
052500                END-IF                                            05250000
052600           END-IF                                                 05260000
052700       END-IF.                                                    05270000
052800                                                                  05280000
052900* MS 06/18/2010 END                                               05290000
053000 2600-FORMAT-TRIP-FOUND.                                          05300000
053001                                                                  05300128
053002     IF  PS-BLD-INTERNAL-TABLE-YES                                05300228
053003         MOVE  '2600'  TO  PT-CURR-PARA                           05300328
053004         PERFORM 6110-INTERNAL-TABLE                              05300428
053005     END-IF.                                                      05300528
053010                                                                  05301013
053020     IF PS-LOG-MESSAGE                                            05302013
053030         MOVE  SPACES              TO  PV-CICS-MSG-AREA           05303013
053040         STRING   ' SUKUT709 2600 '                               05304013
053050                                       DELIMITED BY SIZE          05305013
053060                                  INTO PV-CICS-MSG-AREA           05306013
053070         PERFORM 9999-WRITE-TO-CSSL                               05307013
053080     END-IF.                                                      05308013
053090                                                                  05309013
053100                                                                  05310000
053200     IF PS-WRKR-SUT111-FOUND                                      05320000
053300        MOVE SUT00110-DOOR-ID       TO SU092-DOOR-ID              05330000
053400**??    MOVE SUT00110-CRE-BY-USR-ID TO SU092-USER-ID              05340000
053500        MOVE SUT00111-WRKR-USR-ID   TO SU092-USER-ID              05350000
053600        IF PS-WHSE-OTBND-CART-YES                                 05360000
053700           MOVE PV-WHSE-RPLN-TRIP-ID   TO SU092-TRIP-ID           05370000
053800        ELSE                                                      05380000
053900           IF SHUNLO-TRIP-ID > 0                                  05390000
054000              MOVE SHUNLO-TRIP-ID         TO SU092-TRIP-ID        05400000
054100           ELSE                                                   05410000
054200              MOVE SUT00110-INBD-TRIP-ID  TO SU092-TRIP-ID        05420000
054210           END-IF                                                 05421000
054220        END-IF                                                    05422000
054230     ELSE                                                         05423000
054240**      TRIP WAS FOUND BUT USER ID WASN"T                         05424000
054250**           SET SWITCH TO RETURN ERROR                           05425000
054260        SET SU092-NO-USER-ID-FOUND TO TRUE                        05426000
054270     END-IF.                                                      05427000
054280                                                                  05428000
054281                                                                  05428122
054282     IF PS-LOG-MESSAGE                                            05428222
054283         MOVE  SPACES             TO  PV-CICS-MSG-AREA            05428325
054284         MOVE  SU092-TRIP-ID      TO  PV-DISP-TRIP                05428425
054285         STRING   ' SUKUT709 2600 '                               05428522
054286                  ' WRKR FND:'        PS-WRKR-SUT111-FOUND-SW     05428625
054287                  ' DOOR:'            SU092-DOOR-ID               05428725
054288                  ' USER:'            SU092-USER-ID               05428825
054289                  ' TRIP:'            PV-DISP-TRIP                05428925
054290                  ' NO USR:'          SU092-PRNT-N-APP-USER-IND   05429025
054291                                      DELIMITED BY SIZE           05429125
054292                                 INTO PV-CICS-MSG-AREA            05429225
054293         PERFORM 9999-WRITE-TO-CSSL                               05429322
054294     END-IF.                                                      05429422
054295                                                                  05429522
054296                                                                  05429622
054300 2800-PROCESS-BAR-CODE-3.                                         05430000
054310                                                                  05431013
054312     IF  PS-BLD-INTERNAL-TABLE-YES                                05431228
054313         MOVE  '2800'  TO  PT-CURR-PARA                           05431328
054314         PERFORM 6110-INTERNAL-TABLE                              05431428
054315     END-IF.                                                      05431528
054316                                                                  05431628
054320     IF PS-LOG-MESSAGE                                            05432013
054330         MOVE  SPACES              TO  PV-CICS-MSG-AREA           05433013
054340         STRING   ' SUKUT709 2800 '                               05434013
054350                                       DELIMITED BY SIZE          05435013
054360                                  INTO PV-CICS-MSG-AREA           05436013
054370         PERFORM 9999-WRITE-TO-CSSL                               05437013
054380     END-IF.                                                      05438013
054390                                                                  05439013
054400                                                                  05440000
054500     MOVE SU092-KEY-BAR-CODE-3 TO DK-BAR-CODE-22.                 05450000
054600     PERFORM 7700-SELECT-TSULBXF.                                 05460000
054700     IF PS-TSULBXF-TRIP-FOUND                                     05470000
054800        PERFORM 7500-SELECT-TRIP-ASSIGMENT                        05480000
054900        IF PS-TRIP-SUT110-FOUND                                   05490000
055000           PERFORM 2600-FORMAT-TRIP-FOUND                         05500000
055100           SET PS-BAR-CODE-PROCESS-DONE TO TRUE                   05510000
055200**??       MOVE SUT00110-DOOR-ID  TO  SU092-DOOR-ID               05520000
055300**??       MOVE SUT00110-CRE-BY-USR-ID TO  SU092-USER-ID          05530000
055400**??       MOVE SUT00111-WRKR-USR-ID   TO SU092-USER-ID           05540000
055500**??       MOVE SHUNLO-TRIP-ID    TO  SU092-TRIP-ID               05550000
055600        END-IF                                                    05560000
055700     END-IF.                                                      05570000
055800                                                                  05580000
055801******************************************************************05580100
055802* THIS PARAGRAPH IS USED IF MULTIPLE BARCODES ARE SCANNED AND    *05580200
055803* NEITHER IS A CHECKED IN SSCC, AND NEITHER IS AN SML            *05580300
055804* THIS IS TO CHECK IF THE BARCODE IS A VALID SSCC                *05580400
055805* DMH - 9/21/11 ADDED                                            *05580500
055806******************************************************************05580600
055807 2900-CHECK-VNDR-SSCC.                                            05580700
055808                                                                  05580828
055809     IF  PS-BLD-INTERNAL-TABLE-YES                                05580928
055810         MOVE  '2900'  TO  PT-CURR-PARA                           05581028
055811         PERFORM 6110-INTERNAL-TABLE                              05581128
055812     END-IF.                                                      05581228
055813                                                                  05581313
055814     IF PS-LOG-MESSAGE                                            05581413
055815         MOVE  SPACES              TO  PV-CICS-MSG-AREA           05581513
055816         STRING   ' SUKUT709 2900 '                               05581613
055817                                       DELIMITED BY SIZE          05581713
055818                                  INTO PV-CICS-MSG-AREA           05581813
055819         PERFORM 9999-WRITE-TO-CSSL                               05581913
055820     END-IF.                                                      05582013
055821                                                                  05582113
055822                                                                  05582200
055823     EXEC SQL                                                     05582300
055824        SELECT  SHIPT_UNT_ID                                      05582400
055830          INTO :PV-VENDOR-SSCC                                    05583003
055840          FROM  TSHPUNT                                           05584004
055841         WHERE  SHIPT_UNT_ID   = :PV-SSCC-UNCHKIN                 05584104
055842          WITH UR                                                 05584215
055843     END-EXEC.                                                    05584300
055844                                                                  05584400
055845     EVALUATE TRUE                                                05584500
055846         WHEN SQLCODE = ZERO                                      05584600
055847              SET PS-VENDOR-SSCC-YES  TO TRUE                     05584701
055848         WHEN SQLCODE = +100                                      05584800
055849              SET PS-VENDOR-SSCC-NO   TO TRUE                     05584901
055850         WHEN SQLWARN0 NOT = SPACES                               05585000
055851         WHEN SQLCODE NOT EQUAL ZERO                              05585100
055852              MOVE '2900'  TO  PV-CSSL-PARA                       05585226
055853              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  05585326
055854                                                                  05585426
055855             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       05585500
055856             MOVE  PV-SSCC-UNCHKIN    TO PV-DISP-SHIPT-UNT-ID     05585611
055857             STRING   ' SUKUT709-2900-'                           05585701
055858                      ' CALLED BY-'  SU092-VSM-PGM                05585811
055859                      '  SQL:'       PV-DISPLAY-SQLCODE           05585911
055860                      ' '            PV-DISP-SHIPT-UNT-ID         05586011
055861                      DELIMITED BY SIZE                           05586100
055862                                      INTO PV-CICS-MSG-AREA       05586200
055863             PERFORM 9999-WRITE-TO-CSSL                           05586300
055890                                                                  05589011
055891             PERFORM 9998-RETURN                                  05589111
055892     END-EVALUATE.                                                05589211
055893                                                                  05589311
055894                                                                  05589400
055900******************************************************************05590000
056000*    5100- DETERMINES LOGGING LEVEL - THIS DETERMINES AT WHEN     05600000
056100*          ROWS WILL BE INSERTED BY 8700-.                        05610000
056200*                                                                 05620000
056300*    7900- LOOKS FOR CARTON ON THE SHIPMENT UNIT / UPC ASSOCIATION05630000
056400*          TABLE                                                  05640000
056500*    4200- SEARCHES CURRENTLY ASSIGNED TRIPS                      05650000
056600*                                                                 05660000
056700******************************************************************05670000
056800                                                                  05680000
056900 3000-CARTON-LOOKUP.                                              05690000
056901                                                                  05690128
056902     IF  PS-BLD-INTERNAL-TABLE-YES                                05690228
056903         MOVE  '3000'  TO  PT-CURR-PARA                           05690328
056904         PERFORM 6110-INTERNAL-TABLE                              05690428
056905     END-IF.                                                      05690528
056910                                                                  05691013
056920     IF PS-LOG-MESSAGE                                            05692013
056930         MOVE  SPACES              TO  PV-CICS-MSG-AREA           05693013
056940         STRING   ' SUKUT709 3000 '                               05694013
056950                                       DELIMITED BY SIZE          05695013
056960                                  INTO PV-CICS-MSG-AREA           05696013
056970         PERFORM 9999-WRITE-TO-CSSL                               05697013
056980     END-IF.                                                      05698013
056990                                                                  05699013
057000                                                                  05700000
057001*** 9/28/11 - DMH BEGIN                                           05700107
057010     IF  PS-BAR-CODE-1-FOUND  AND                                 05701007
057020         PS-BAR-CODE-2-FOUND  AND                                 05702007
057030         PS-WHSE-OTBND-CART-NO                                    05703007
057031         IF  PS-VENDOR-SSCC-1-YES AND                             05703108
057032             PS-VENDOR-SSCC-2-NO                                  05703208
057033             MOVE SU092-KEY-BAR-CODE-1 TO DK-BAR-CODE-20          05703308
057034         ELSE                                                     05703408
057035             IF  PS-VENDOR-SSCC-2-YES AND                         05703508
057036                 PS-VENDOR-SSCC-1-NO                              05703608
057037             MOVE SU092-KEY-BAR-CODE-2 TO DK-BAR-CODE-20          05703708
057038             END-IF                                               05703808
057039         END-IF                                                   05703908
057040     END-IF.                                                      05704008
057041*** 9/28/11 - DMH END                                             05704108
057042                                                                  05704207
057050                                                                  05705007
057100     PERFORM 5100-SELECT-TKRPRPM.                                 05710000
057200                                                                  05720000
057300     PERFORM 7900-SELECT-TSHUUPC.                                 05730000
057400     MOVE 'N'  TO PS-END-SUT110-CURSOR-SW.                        05740000
057500*GB BEG                                                           05750000
057600     MOVE 'N'  TO                                                 05760000
057700                  PS-FIRST-ROW-FOUND-SW                           05770000
057800                  PS-TRIP-DOOR-UID-FOUND-SW.                      05780000
057900*GB END                                                           05790000
058000*                 PS-FIRST-ROW-FOUND-SW                           05800000
058100*                 PS-TRIP-DOOR-UID-FOUND-SW.                      05810000
058200     MOVE 0  TO PV-TBL-SUB.                                       05820000
058300     MOVE 4  TO PV-TBL-SUB-MAX.                                   05830000
058400                                                                  05840000
058500     PERFORM 4000-OPEN-TRIP-CURSOR.                               05850000
058600     PERFORM 4200-FETCH-TRIP.                                     05860000
058700                                                                  05870000
058701*                                                                 05870100
058702*** DMH - 9/19/2011 - BEGIN                                       05870200
058703     IF PS-FIRST-ROW-NOT-FOUND                                    05870310
058705        SET SU092-NO-TRIP-ID-FOUND TO TRUE                        05870509
058706     ELSE                                                         05870609
058707*** DMH - 9/19/2011 - END                                         05870709
058708*                                                                 05870809
058709     IF PS-128-CARTON-NOT-FOUND                                   05870909
058710        PERFORM 4400-CLOSE-TRIP-CURSOR                            05871009
058711        IF PS-FIRST-ROW-NOT-FOUND                                 05871109
058720**         IF NO ROWS WERE FOUND, SET SWITCH FOR ERROR AND EXIT   05872000
058730           SET SU092-NO-TRIP-ID-FOUND TO TRUE                     05873010
058740        ELSE                                                      05874000
058750           PERFORM 3900-POPULATE-SUWS092                          05875000
058760*GB 9/22   PERFORM 2600-FORMAT-TRIP-FOUND                         05876000
058770        END-IF                                                    05877000
058780     ELSE                                                         05878000
058790        SET PS-SEARCH-COMPLETE  TO TRUE                           05879000
058800        PERFORM 3200-SEARCH-FOR-CARTON-MATCH                      05880000
058900        IF PS-TRIP-DOOR-UID-NOT-FND                               05890000
059000           PERFORM 3400-SEARCH-FOR-PO-MATCH                       05900000
059100        END-IF                                                    05910000
059200        IF PS-TRIP-DOOR-UID-NOT-FND                               05920000
059300           PERFORM 3600-SEARCH-FOR-VENDOR-MATCH                   05930000
059400        END-IF                                                    05940000
059500        IF PS-TRIP-DOOR-UID-NOT-FND                               05950000
059600           IF PS-LOG-LEVEL-ALL    OR                              05960000
059700              PS-LOG-LEVEL-PO     OR                              05970000
059800              PS-LOG-LEVEL-VENDOR OR                              05980000
059900              PS-LOG-LEVEL-FIRST                                  05990000
060000              SET PS-INSERT-TBL-1 TO TRUE                         06000000
060100              MOVE PC-FST TO PV-CART-MTCH-CDE                     06010000
060200              PERFORM 8700-INSERT-TRIP-MATCH-LEVEL                06020000
060300           END-IF                                                 06030000
060400        END-IF                                                    06040000
060500     END-IF                                                       06050000
060600     END-IF.                                                      06060000
060700                                                                  06070000
060800* MS 06/18/2010 BEG                                               06080000
060900*                                                                 06090000
061000* TO DETERMINE THE TRIP ID AND RELATED INFORMATION FOR THE        06100000
061100* WAREHOUSE REPLENISHMENT CARTON,WHEN THE CARTON WAS NOT          06110000
061200* PREVIOUSLY SCANNED.                                             06120000
061300*                                                                 06130000
061400 3100-CARTON-LOOKUP.                                              06140000
061401                                                                  06140128
061402     IF  PS-BLD-INTERNAL-TABLE-YES                                06140228
061403         MOVE  '3100'  TO  PT-CURR-PARA                           06140328
061404         PERFORM 6110-INTERNAL-TABLE                              06140428
061405     END-IF.                                                      06140528
061410                                                                  06141013
061420     IF PS-LOG-MESSAGE                                            06142013
061430         MOVE  SPACES              TO  PV-CICS-MSG-AREA           06143013
061440         STRING   ' SUKUT709 3100 '                               06144013
061450                                       DELIMITED BY SIZE          06145013
061460                                  INTO PV-CICS-MSG-AREA           06146013
061470         PERFORM 9999-WRITE-TO-CSSL                               06147013
061480     END-IF.                                                      06148013
061490                                                                  06149013
061500                                                                  06150000
061600     PERFORM 3300-SELECT-TRLR-RPLN-CART.                          06160000
061700     MOVE 'N' TO PS-END-SUT110-CURSOR-SW                          06170000
061800                 PS-TRIP-DOOR-UID-FOUND-SW.                       06180000
061900     MOVE 0   TO PV-TBL-SUB.                                      06190000
062000     MOVE 4   TO PV-TBL-SUB-MAX.                                  06200000
062100                                                                  06210000
062200     PERFORM 4000-OPEN-TRIP-CURSOR.                               06220000
062300     PERFORM 4210-FETCH-TRIP                                      06230000
062400             UNTIL PS-END-SUT110-CURSOR                           06240000
062500     PERFORM 4400-CLOSE-TRIP-CURSOR                               06250000
062600                                                                  06260000
062700     IF PS-128-CARTON-NOT-FOUND                                   06270000
062800          PERFORM 3500-CHECK-FOR-PULL-NUMBER                      06280000
062900     END-IF                                                       06290000
063000                                                                  06300000
063100     IF PS-128-CARTON-FOUND                                       06310000
063200*GB     PERFORM 7500-SELECT-TRIP-ASSIGMENT                        06320000
063300        PERFORM 2600-FORMAT-TRIP-FOUND                            06330000
063400*       PERFORM 3900-POPULATE-SUWS092                             06340000
063500     ELSE                                                         06350000
063600        PERFORM 4500-READ-TRIP-TABLE                              06360000
063700        MOVE PC-FST TO PV-CART-MTCH-CDE                           06370000
063800        PERFORM 8700-INSERT-TRIP-MATCH-LEVEL                      06380000
063900     END-IF.                                                      06390000
064000                                                                  06400000
064100* MS 06/18/2010 END                                               06410000
064200 3200-SEARCH-FOR-CARTON-MATCH.                                    06420000
064201                                                                  06420128
064202     IF  PS-BLD-INTERNAL-TABLE-YES                                06420228
064203         MOVE  '3200'  TO  PT-CURR-PARA                           06420328
064204         PERFORM 6110-INTERNAL-TABLE                              06420428
064205     END-IF.                                                      06420528
064210                                                                  06421013
064220     IF PS-LOG-MESSAGE                                            06422013
064230         MOVE  SPACES              TO  PV-CICS-MSG-AREA           06423013
064240         STRING   ' SUKUT709 3200 '                               06424013
064250                                       DELIMITED BY SIZE          06425013
064260                                  INTO PV-CICS-MSG-AREA           06426013
064270         PERFORM 9999-WRITE-TO-CSSL                               06427013
064280     END-IF.                                                      06428013
064290                                                                  06429013
064300                                                                  06430000
064400     SET PS-SEARCH-NOT-COMPLETE TO TRUE.                          06440000
064500                                                                  06450000
064600     PERFORM UNTIL PS-END-SUT110-CURSOR                           06460000
064700                OR PS-TRIP-DOOR-UID-FND                           06470000
064800                                                                  06480044
064900         PERFORM 8100-SELECT-TSHPUNT                              06490000
065000         IF PS-TSHPUNT-TRIP-FOUND                                 06500000
065100            SET PS-TRIP-DOOR-UID-FND  TO TRUE                     06510000
065200            PERFORM 3900-POPULATE-SUWS092                         06520000
065300            IF SU092-NO-USER-ID-FOUND                             06530000
065400               SET PS-TRIP-DOOR-UID-FND  TO TRUE                  06540000
065500            ELSE                                                  06550000
065600               IF PS-LOG-LEVEL-ALL                                06560000
065700                  SET PS-INSERT-TBL-SU092 TO TRUE                 06570000
065800                  MOVE PC-ALL TO PV-CART-MTCH-CDE                 06580000
065900                  PERFORM 8700-INSERT-TRIP-MATCH-LEVEL            06590000
066000               END-IF                                             06600000
066100            END-IF                                                06610000
066200         ELSE                                                     06620000
066300                                                                  06630000
066400            PERFORM 4200-FETCH-TRIP                               06640000
066500         END-IF                                                   06650000
066600     END-PERFORM.                                                 06660000
066700                                                                  06670000
066800     PERFORM 4400-CLOSE-TRIP-CURSOR.                              06680000
066900                                                                  06690000
067000* MS 06/18/2010 BEG                                               06700000
067100*                                                                 06710000
067200* TO DETERMINE THE TRIP ID FOR THE WAREHOUSE REPLENISHMENT CARTON.06720000
067300                                                                  06730000
067400 3300-SELECT-TRLR-RPLN-CART.                                      06740000
067401                                                                  06740128
067402     IF  PS-BLD-INTERNAL-TABLE-YES                                06740228
067403         MOVE  '3300'  TO  PT-CURR-PARA                           06740328
067404         PERFORM 6110-INTERNAL-TABLE                              06740428
067405     END-IF.                                                      06740528
067410                                                                  06741013
067420     IF PS-LOG-MESSAGE                                            06742013
067430         MOVE  SPACES              TO  PV-CICS-MSG-AREA           06743013
067440         STRING   ' SUKUT709 3300 '                               06744013
067450                                       DELIMITED BY SIZE          06745013
067460                                  INTO PV-CICS-MSG-AREA           06746013
067470         PERFORM 9999-WRITE-TO-CSSL                               06747013
067480     END-IF.                                                      06748013
067490                                                                  06749013
067500                                                                  06750000
067600     MOVE DK-BAR-CODE-20      TO DK-SHIPT-UNT-ID.                 06760000
067700     MOVE SU092-KEY-DC-LOC    TO DK-OPER-UNT-ID.                  06770000
067800                                                                  06780000
067900     EXEC SQL                                                     06790000
068000           SELECT INBND_TRIP_ID                                   06800000
068100             INTO                                                 06810000
068200                  :SUT00113-INBND-TRIP-ID                         06820000
068300             FROM SUT_TRLR_RPLN_CART                              06830000
068400            WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                 06840000
068500            AND   OPER_UNT_ID  = :DK-OPER-UNT-ID                  06850000
068510             WITH UR                                              06851015
068600     END-EXEC.                                                    06860000
068700                                                                  06870000
068800     EVALUATE TRUE                                                06880000
068900                                                                  06890000
069000         WHEN SQLCODE = ZERO                                      06900000
069100              MOVE SUT00113-INBND-TRIP-ID TO PV-WHSE-RPLN-TRIP-ID 06910000
069200         WHEN SQLCODE = +100                                      06920000
069300              MOVE ZERO                   TO PV-WHSE-RPLN-TRIP-ID 06930000
069400         WHEN SQLWARN0 NOT = SPACES                               06940000
069500         WHEN SQLCODE NOT EQUAL ZERO                              06950000
069510              MOVE '3300'  TO  PV-CSSL-PARA                       06951026
069520              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  06952026
069530                                                                  06953026
069600              MOVE  SQLCODE               TO PV-DISPLAY-SQLCODE   06960000
069610              MOVE  DK-SHIPT-UNT-ID       TO PV-DISP-SHIPT-UNT-ID 06961011
069700              SET SU092-SQL-ERROR         TO TRUE                 06970000
069710              STRING   ' SUKUT709-3300-'                          06971000
069720                       ' CALLED BY-'  SU092-VSM-PGM               06972011
069740                       '  SQL:'       PV-DISPLAY-SQLCODE          06974011
069760                       ' '            PV-DISP-SHIPT-UNT-ID        06976011
069770                       DELIMITED BY SIZE                          06977000
069780                                       INTO PV-CICS-MSG-AREA      06978000
069790              PERFORM 9999-WRITE-TO-CSSL                          06979000
069791                                                                  06979111
069819              PERFORM 9998-RETURN                                 06981900
069820                                                                  06982000
069821     END-EVALUATE.                                                06982100
069830                                                                  06983000
069840* MS 06/18/2010 END                                               06984000
069850******************************************************************06985000
069860*    3400- SEARCH FOR A SHIPMENT TO PO MATCH                      06986000
069870*                                                                 06987000
069880******************************************************************06988000
069890                                                                  06989000
069900 3400-SEARCH-FOR-PO-MATCH.                                        06990000
069901                                                                  06990128
069902     IF  PS-BLD-INTERNAL-TABLE-YES                                06990228
069903         MOVE  '3400'  TO  PT-CURR-PARA                           06990328
069904         PERFORM 6110-INTERNAL-TABLE                              06990428
069905     END-IF.                                                      06990528
069910                                                                  06991013
069920     IF PS-LOG-MESSAGE                                            06992013
069930         MOVE  SPACES              TO  PV-CICS-MSG-AREA           06993013
069940         STRING   ' SUKUT709 3400 '                               06994013
069950                                       DELIMITED BY SIZE          06995013
069960                                  INTO PV-CICS-MSG-AREA           06996013
069970         PERFORM 9999-WRITE-TO-CSSL                               06997013
069980     END-IF.                                                      06998013
069990                                                                  06999013
070000                                                                  07000000
070100     MOVE 1  TO PV-TBL-SUB.                                       07010000
070200     PERFORM 8300-SELECT-TSHPTPO.                                 07020000
070300                                                                  07030000
070400     PERFORM UNTIL PV-TBL-SUB  > PV-TBL-SUB-MAX                   07040000
070500          OR PS-TRIP-DOOR-UID-FND                                 07050000
070600                                                                  07060000
070700         IF PS-TSHPTPO-PO-FOUND                                   07070000
070800            SET PS-TRIP-DOOR-UID-FND TO TRUE                      07080000
070900            PERFORM 3900-POPULATE-SUWS092                         07090000
071000            IF PS-LOG-LEVEL-ALL  OR                               07100000
071100               PS-LOG-LEVEL-PO                                    07110000
071200               SET PS-INSERT-TBL-SU092 TO TRUE                    07120000
071300               MOVE PC-POL TO PV-CART-MTCH-CDE                    07130000
071400               PERFORM 8700-INSERT-TRIP-MATCH-LEVEL               07140000
071500            END-IF                                                07150000
071600         ELSE                                                     07160000
071700            ADD  1  TO PV-TBL-SUB                                 07170000
071800            PERFORM 8300-SELECT-TSHPTPO                           07180000
071900         END-IF                                                   07190000
072000                                                                  07200000
072100     END-PERFORM.                                                 07210000
072200                                                                  07220000
072300* MS 06/18/2010 BEG                                               07230000
072400*                                                                 07240000
072500* TO DETERMINE THE PULL NUMBERS ON THE PROCESSED FREIGHT CARTON   07250000
072600* AND TO CHECK IF THE PULL NUMBER IS THERE ON ANY TRIP.           07260000
072700*                                                                 07270000
072800 3500-CHECK-FOR-PULL-NUMBER.                                      07280000
072801                                                                  07280128
072802     IF  PS-BLD-INTERNAL-TABLE-YES                                07280228
072803         MOVE  '3500'  TO  PT-CURR-PARA                           07280328
072804         PERFORM 6110-INTERNAL-TABLE                              07280428
072805     END-IF.                                                      07280528
072810                                                                  07281013
072820     IF PS-LOG-MESSAGE                                            07282013
072830         MOVE  SPACES              TO  PV-CICS-MSG-AREA           07283013
072840         STRING   ' SUKUT709 3500 '                               07284013
072850                                       DELIMITED BY SIZE          07285013
072860                                  INTO PV-CICS-MSG-AREA           07286013
072870         PERFORM 9999-WRITE-TO-CSSL                               07287013
072880     END-IF.                                                      07288013
072890                                                                  07289013
072900                                                                  07290000
073000     PERFORM 3525-OPEN-PULL-CURSOR.                               07300000
073100     PERFORM 3550-FETCH-PULL-CURSOR                               07310000
073200             UNTIL PS-128-CARTON-FOUND                            07320000
073300             OR PS-END-SUT028-CURSOR.                             07330000
073400     PERFORM 3575-CLOSE-PULL-CURSOR.                              07340000
073500                                                                  07350000
073600 3525-OPEN-PULL-CURSOR.                                           07360000
073601                                                                  07360128
073602     IF  PS-BLD-INTERNAL-TABLE-YES                                07360228
073603         MOVE  '3525'  TO  PT-CURR-PARA                           07360328
073604         PERFORM 6110-INTERNAL-TABLE                              07360428
073605     END-IF.                                                      07360528
073610                                                                  07361013
073620     IF PS-LOG-MESSAGE                                            07362013
073630         MOVE  SPACES              TO  PV-CICS-MSG-AREA           07363013
073640         STRING   ' SUKUT709 3525 '                               07364013
073650                                       DELIMITED BY SIZE          07365013
073660                                  INTO PV-CICS-MSG-AREA           07366013
073670         PERFORM 9999-WRITE-TO-CSSL                               07367013
073680     END-IF.                                                      07368013
073690                                                                  07369013
073700                                                                  07370000
073800     EXEC SQL                                                     07380000
073900         OPEN PULL-CSR                                            07390000
074000     END-EXEC.                                                    07400000
074100                                                                  07410000
074101     EVALUATE TRUE                                                07410100
074102                                                                  07410200
074103         WHEN SQLCODE = ZERO                                      07410300
074104              CONTINUE                                            07410400
074105         WHEN SQLWARN0 NOT = SPACES                               07410500
074106         WHEN SQLCODE  NOT EQUAL ZERO                             07410600
074107              MOVE '3525'  TO  PV-CSSL-PARA                       07410726
074108              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  07410826
074109                                                                  07410926
074110              MOVE SQLCODE        TO PV-DISPLAY-SQLCODE           07411000
074111              STRING   ' SUKUT709-3525-'                          07411100
074112                       ' CALLED BY-'                              07411200
074113                       SU092-VSM-PGM                              07411300
074120                       '  SQL:'                                   07412014
074130                       PV-DISPLAY-SQLCODE                         07413000
074140                       ' SSCC:'                                   07414014
074150                       PV-DISP-SHIPT-UNT-ID                       07415000
074151                       DELIMITED BY SIZE                          07415100
074152                                     INTO PV-CICS-MSG-AREA        07415200
074153              PERFORM 9999-WRITE-TO-CSSL                          07415300
074154                                                                  07415411
074182              PERFORM 9998-RETURN                                 07418200
074183                                                                  07418300
074184     END-EVALUATE.                                                07418400
074185                                                                  07418500
074186 3550-FETCH-PULL-CURSOR.                                          07418600
074187                                                                  07418728
074188     IF  PS-BLD-INTERNAL-TABLE-YES                                07418828
074189         MOVE  '3550'  TO  PT-CURR-PARA                           07418928
074190         PERFORM 6110-INTERNAL-TABLE                              07419028
074191     END-IF.                                                      07419128
074192                                                                  07419213
074193     IF PS-LOG-MESSAGE                                            07419313
074194         MOVE  SPACES              TO  PV-CICS-MSG-AREA           07419413
074195         STRING   ' SUKUT709 3550 '                               07419513
074196                                       DELIMITED BY SIZE          07419613
074197                                  INTO PV-CICS-MSG-AREA           07419713
074198         PERFORM 9999-WRITE-TO-CSSL                               07419813
074199     END-IF.                                                      07419913
074200                                                                  07420013
074201                                                                  07420100
074202     EXEC SQL                                                     07420200
074203          FETCH   PULL-CSR                                        07420300
074204           INTO  :SUT00028-TRN-NBR                                07420400
074205     END-EXEC.                                                    07420500
074210                                                                  07421000
074300     EVALUATE TRUE                                                07430000
074400                                                                  07440000
074500         WHEN SQLCODE = ZERO                                      07450000
074600              MOVE SUT00028-TRN-NBR       TO DK-PULL-NUMBER       07460000
074700              PERFORM 3700-GET-INBOUND-TRIP                       07470000
074800         WHEN SQLCODE = +100                                      07480000
074900              SET PS-128-CARTON-NOT-FOUND                         07490000
075000                  SU092-UCC128-NOT-FOUND                          07500000
075100                  PS-END-SUT028-CURSOR    TO TRUE                 07510000
075200         WHEN OTHER                                               07520000
075210              MOVE '3550'  TO  PV-CSSL-PARA                       07521026
075220              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  07522026
075230                                                                  07523026
075300              MOVE SQLCODE                TO PV-DISPLAY-SQLCODE   07530000
075400              SET SU092-SQL-ERROR         TO TRUE                 07540000
075500              STRING   ' SUKUT709-3550-'                          07550000
075510                       ' CALLED BY-'                              07551000
075520                       SU092-VSM-PGM                              07552000
075530                       '  SQL:'                                   07553014
075540                       PV-DISPLAY-SQLCODE                         07554000
075541                       ' '                                        07554100
075542                       DELIMITED BY SIZE                          07554200
075543                                       INTO PV-CICS-MSG-AREA      07554300
075544              PERFORM 9999-WRITE-TO-CSSL                          07554400
075545                                                                  07554511
075563              PERFORM 9998-RETURN                                 07556300
075564                                                                  07556400
075565     END-EVALUATE.                                                07556500
075566                                                                  07556600
075567 3575-CLOSE-PULL-CURSOR.                                          07556700
075568                                                                  07556828
075569     IF  PS-BLD-INTERNAL-TABLE-YES                                07556928
075570         MOVE  '3575'  TO  PT-CURR-PARA                           07557028
075571         PERFORM 6110-INTERNAL-TABLE                              07557128
075572     END-IF.                                                      07557228
075573                                                                  07557313
075574     IF PS-LOG-MESSAGE                                            07557413
075575         MOVE  SPACES              TO  PV-CICS-MSG-AREA           07557513
075576         STRING   ' SUKUT709 3575 '                               07557613
075577                                       DELIMITED BY SIZE          07557713
075578                                  INTO PV-CICS-MSG-AREA           07557813
075579         PERFORM 9999-WRITE-TO-CSSL                               07557913
075580     END-IF.                                                      07558013
075581                                                                  07558113
075582                                                                  07558200
075583     EXEC SQL                                                     07558300
075584         CLOSE PULL-CSR                                           07558400
075585     END-EXEC.                                                    07558500
075590                                                                  07559000
075600     EVALUATE TRUE                                                07560000
075700                                                                  07570000
075800         WHEN SQLCODE = ZERO                                      07580000
075900              CONTINUE                                            07590000
076000         WHEN SQLWARN0 NOT = SPACES                               07600000
076100         WHEN SQLCODE  NOT EQUAL ZERO                             07610000
076110              MOVE '3575'  TO  PV-CSSL-PARA                       07611026
076120              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  07612026
076130                                                                  07613026
076200              MOVE SQLCODE        TO PV-DISPLAY-SQLCODE           07620000
076300              STRING   ' SUKUT709-3575-'                          07630011
076400                       ' CALLED BY-'                              07640000
076500                       SU092-VSM-PGM                              07650000
076600                       '  SQL:'                                   07660014
076601                       PV-DISPLAY-SQLCODE                         07660100
076602                       ' SSCC:'                                   07660214
076603                       PV-DISP-SHIPT-UNT-ID                       07660300
076604                       DELIMITED BY SIZE                          07660400
076605                                   INTO PV-CICS-MSG-AREA          07660500
076606              PERFORM 9999-WRITE-TO-CSSL                          07660600
076607                                                                  07660726
076635              PERFORM 9998-RETURN                                 07663500
076636                                                                  07663600
076637     END-EVALUATE.                                                07663700
076638                                                                  07663800
076639* MS 06/18/2010 END                                               07663900
076640                                                                  07664000
076641 3600-SEARCH-FOR-VENDOR-MATCH.                                    07664100
076642                                                                  07664228
076643     IF  PS-BLD-INTERNAL-TABLE-YES                                07664328
076644         MOVE  '3600'  TO  PT-CURR-PARA                           07664428
076645         PERFORM 6110-INTERNAL-TABLE                              07664528
076646     END-IF.                                                      07664628
076647                                                                  07664713
076648     IF PS-LOG-MESSAGE                                            07664813
076649         MOVE  SPACES              TO  PV-CICS-MSG-AREA           07664913
076650         STRING   ' SUKUT709 3600 '                               07665013
076651                                       DELIMITED BY SIZE          07665113
076652                                  INTO PV-CICS-MSG-AREA           07665213
076653         PERFORM 9999-WRITE-TO-CSSL                               07665313
076654     END-IF.                                                      07665413
076655                                                                  07665513
076656                                                                  07665600
076660     MOVE 1  TO PV-TBL-SUB.                                       07666000
076670     PERFORM 8500-SELECT-TPURCHS.                                 07667000
076680                                                                  07668000
076690     PERFORM UNTIL PV-TBL-SUB  > PV-TBL-SUB-MAX                   07669000
076700          OR PS-TRIP-DOOR-UID-FND                                 07670000
076800                                                                  07680000
076900         IF PS-TPURCHS-ENT-FOUND                                  07690000
077000            SET PS-TRIP-DOOR-UID-FND TO TRUE                      07700000
077100            PERFORM 3900-POPULATE-SUWS092                         07710000
077200            IF PS-LOG-LEVEL-ALL  OR                               07720000
077300               PS-LOG-LEVEL-PO   OR                               07730000
077400               PS-LOG-LEVEL-VENDOR                                07740000
077500               SET PS-INSERT-TBL-SU092 TO TRUE                    07750000
077600               MOVE PC-VND TO PV-CART-MTCH-CDE                    07760000
077700               PERFORM 8700-INSERT-TRIP-MATCH-LEVEL               07770000
077800            END-IF                                                07780000
077900         ELSE                                                     07790000
078000            ADD  1  TO PV-TBL-SUB                                 07800000
078100            PERFORM 8500-SELECT-TPURCHS                           07810000
078200         END-IF                                                   07820000
078300                                                                  07830000
078400     END-PERFORM.                                                 07840000
078500                                                                  07850000
078600                                                                  07860000
078700* MS 06/18/2010 BEG                                               07870000
078800*                                                                 07880000
078900* FETCH THE INBOUND TRIP ID FROM THE OUTBOUND CARTON,             07890000
079000* OUTBOUND LOCATION AND OUTBOUND UPC USING THE PULL NUMBER.       07900000
079100                                                                  07910000
079200 3700-GET-INBOUND-TRIP.                                           07920000
079201                                                                  07920128
079202     IF  PS-BLD-INTERNAL-TABLE-YES                                07920228
079203         MOVE  '3700'  TO  PT-CURR-PARA                           07920328
079204         PERFORM 6110-INTERNAL-TABLE                              07920428
079205     END-IF.                                                      07920528
079210                                                                  07921013
079220     IF PS-LOG-MESSAGE                                            07922013
079230         MOVE  SPACES              TO  PV-CICS-MSG-AREA           07923013
079240         STRING   ' SUKUT709 3700 '                               07924013
079250                                       DELIMITED BY SIZE          07925013
079260                                  INTO PV-CICS-MSG-AREA           07926013
079270         PERFORM 9999-WRITE-TO-CSSL                               07927013
079280     END-IF.                                                      07928013
079290                                                                  07929013
079300                                                                  07930000
079400     MOVE SU092-KEY-DC-LOC      TO DK-OPER-UNT-ID                 07940000
079500                                                                  07950000
079600     EXEC SQL                                                     07960000
079700        SELECT INBD_TRIP_ID                                       07970000
079800          INTO                                                    07980000
079900                :SUT00027-INBD-TRIP-ID                            07990000
080000          FROM   SUT_OTBND_CART A                                 08000000
080100                ,SUT_OTBND_UPC  B                                 08010000
080200                ,SUT_OTBND_LOC  C                                 08020000
080300          WHERE  B.TRN_NBR       = :DK-PULL-NUMBER                08030000
080400            AND  A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                 08040000
080500            AND  A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                 08050000
080600            AND  A.CART_SRC_CDE  = 'RDM'                          08060000
080700            AND  A.ORGN_LOC_NBR  = :DK-OPER-UNT-ID                08070000
080710           WITH UR                                                08071015
080800     END-EXEC.                                                    08080000
080900                                                                  08090000
081000     EVALUATE TRUE                                                08100000
081100                                                                  08110000
081200         WHEN SQLCODE = ZERO                                      08120000
081300         WHEN SQLCODE = -811                                      08130000
081400              SET PS-WHSE-TRIP-FOUND TO TRUE                      08140000
081410              MOVE SUT00027-INBD-TRIP-ID TO  PV-WHSE-RPLN-TRIP-ID 08141000
081420              PERFORM 7500-SELECT-TRIP-ASSIGMENT                  08142000
081430              IF PS-TRIP-SUT110-FOUND                             08143000
081440                 SET PS-128-CARTON-FOUND                          08144000
081450                     SU092-UCC128-FOUND     TO TRUE               08145000
081460              END-IF                                              08146000
081470         WHEN SQLCODE = +100                                      08147000
081480              CONTINUE                                            08148000
081490         WHEN SQLWARN0 NOT = SPACES                               08149000
081500         WHEN SQLCODE  NOT EQUAL ZERO                             08150000
081510              MOVE '3700'  TO  PV-CSSL-PARA                       08151026
081520              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  08152026
081530                                                                  08153026
081600              MOVE SQLCODE               TO PV-DISPLAY-SQLCODE    08160000
081601              MOVE DK-PULL-NUMBER        TO PV-DISP-PULL          08160111
081610              STRING   ' SUKUT709-3700-'                          08161000
081620                       ' CALLED BY-'  SU092-VSM-PGM               08162011
081640                       '  SQL:'       PV-DISPLAY-SQLCODE          08164011
081660                       ' CRTN:'       PV-DISP-SHIPT-UNT-ID        08166011
081670                       ' PULL:'       PV-DISP-PULL                08167011
081680                       DELIMITED BY SIZE                          08168000
081690                                     INTO PV-CICS-MSG-AREA        08169000
081691              PERFORM 9999-WRITE-TO-CSSL                          08169100
081692                                                                  08169211
081720              PERFORM 9998-RETURN                                 08172000
081721                                                                  08172100
081722     END-EVALUATE.                                                08172200
081723                                                                  08172300
081724* MS 06/18/2010 END                                               08172400
081725                                                                  08172500
081726 3900-POPULATE-SUWS092.                                           08172600
081727                                                                  08172728
081728     IF  PS-BLD-INTERNAL-TABLE-YES                                08172828
081729         MOVE  '3900'  TO  PT-CURR-PARA                           08172928
081730         PERFORM 6110-INTERNAL-TABLE                              08173028
081731     END-IF.                                                      08173128
081732                                                                  08173213
081733     IF PS-LOG-MESSAGE                                            08173313
081734         MOVE  SPACES              TO  PV-CICS-MSG-AREA           08173413
081735         STRING   ' SUKUT709 3900 '                               08173513
081736                                       DELIMITED BY SIZE          08173613
081737                                  INTO PV-CICS-MSG-AREA           08173713
081738         PERFORM 9999-WRITE-TO-CSSL                               08173813
081739     END-IF.                                                      08173913
081740                                                                  08174013
081741                                                                  08174100
081750     IF TBL-WRKR-FOUND (PV-TBL-SUB) = PC-Y                        08175000
081800        MOVE TBL-DOOR-ID (PV-TBL-SUB)   TO  SU092-DOOR-ID         08180000
081900        MOVE TBL-TRIP-ID (PV-TBL-SUB)   TO  SU092-TRIP-ID         08190000
082000        MOVE TBL-USER-ID (PV-TBL-SUB)   TO  SU092-USER-ID         08200000
082100     ELSE                                                         08210000
082200**      TRIP WAS FOUND BUT USER ID WASN"T                         08220000
082300**           SET SWITCH TO RETURN ERROR                           08230000
082400                                                                  08240000
082500*                                                                 08250000
082600*** DMH - 9/14/11 - BEGIN                                         08260000
082700*                                                                 08270000
082710        IF  PS-128-CARTON-NOT-FOUND                               08271000
082720            SET SU092-UCC128-NOT-FOUND  TO  TRUE                  08272000
082730        ELSE                                                      08273000
082740*                                                                 08274000
082750*** DMH - 9/14/11 - END                                           08275000
082760*                                                                 08276000
082770            SET SU092-NO-USER-ID-FOUND TO TRUE                    08277000
082780        END-IF                                                    08278000
082790     END-IF.                                                      08279000
082791                                                                  08279122
082792                                                                  08279222
082793     IF PS-LOG-MESSAGE                                            08279322
082794         MOVE  SPACES         TO  PV-CICS-MSG-AREA                08279422
082795         MOVE  SU092-TRIP-ID  TO  PV-DISP-TRIP                    08279522
082796         STRING   ' SUKUT709 3900 '                               08279622
082797                  ' FOUND:'       TBL-WRKR-FOUND (PV-TBL-SUB)     08279722
082798                  ' UCC128:'      SU092-UCC128-FOUND-IND          08279825
082799                  ' USER:'        SU092-PRNT-N-APP-USER-IND       08279925
082800                  ' DOOR:'        SU092-DOOR-ID                   08280022
082801                  ' TRIP:'        PV-DISP-TRIP                    08280122
082802                  ' USER:'        SU092-USER-ID                   08280222
082803                                  DELIMITED BY SIZE               08280322
082804                             INTO PV-CICS-MSG-AREA                08280422
082805         PERFORM 9999-WRITE-TO-CSSL                               08280522
082806     END-IF.                                                      08280622
082807                                                                  08280722
082810                                                                  08281022
082900 4000-OPEN-TRIP-CURSOR.                                           08290000
082901                                                                  08290128
082902     IF  PS-BLD-INTERNAL-TABLE-YES                                08290228
082903         MOVE  '4000'  TO  PT-CURR-PARA                           08290328
082904         PERFORM 6110-INTERNAL-TABLE                              08290428
082905     END-IF.                                                      08290528
082910                                                                  08291013
082920     IF PS-LOG-MESSAGE                                            08292013
082930         MOVE  SPACES              TO  PV-CICS-MSG-AREA           08293013
082940         STRING   ' SUKUT709 4000 - OPEN DOOR-TRIP-CSR'           08294022
082950                                       DELIMITED BY SIZE          08295013
082960                                  INTO PV-CICS-MSG-AREA           08296013
082970         PERFORM 9999-WRITE-TO-CSSL                               08297013
082980     END-IF.                                                      08298013
082990                                                                  08299013
083000                                                                  08300000
083100     MOVE SU092-KEY-DC-LOC      TO DK-OPER-UNT-ID.                08310000
083200     MOVE SU092-KEY-ACM-STN-NBR TO DK-ACM-LBL-STA-NBR.            08320000
083300                                                                  08330000
083400     EXEC SQL                                                     08340000
083500         OPEN DOOR-TRIP-CSR                                       08350000
083600     END-EXEC.                                                    08360000
083700                                                                  08370000
083800     EVALUATE TRUE                                                08380000
083900       WHEN SQLCODE = ZERO                                        08390000
084000            CONTINUE                                              08400000
084100       WHEN SQLWARN0 NOT = SPACES                                 08410000
084200       WHEN SQLCODE  NOT = ZERO                                   08420000
084210            MOVE '4000'  TO  PV-CSSL-PARA                         08421026
084220            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    08422026
084230                                                                  08423026
084300           MOVE DK-OTBND-SHIPT-UNT-ID                             08430000
084400                               TO PV-DISP-SHIPT-UNT-ID            08440000
084500           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              08450000
084600           STRING   ' SUKUT709-4000-'                             08460000
084700                      ' CALLED BY-'                               08470000
084800                      SU092-VSM-PGM                               08480000
084900                      '  SQL:'                                    08490014
085000                      PV-DISPLAY-SQLCODE                          08500000
085100                      ' SSCC:'                                    08510014
085200                      PV-DISP-SHIPT-UNT-ID                        08520000
085300                      DELIMITED BY SIZE                           08530000
085400                                      INTO PV-CICS-MSG-AREA       08540000
085500           PERFORM 9999-WRITE-TO-CSSL                             08550000
085510                                                                  08551011
085800           PERFORM 9998-RETURN                                    08580000
085900     END-EVALUATE.                                                08590000
086000                                                                  08600000
086100                                                                  08610000
086200 4200-FETCH-TRIP.                                                 08620000
086201                                                                  08620128
086202     IF  PS-BLD-INTERNAL-TABLE-YES                                08620228
086203         MOVE  '4200'  TO  PT-CURR-PARA                           08620328
086204         PERFORM 6110-INTERNAL-TABLE                              08620428
086205     END-IF.                                                      08620528
086210                                                                  08621013
086220     IF PS-LOG-MESSAGE                                            08622013
086230         MOVE  SPACES              TO  PV-CICS-MSG-AREA           08623013
086240         STRING   ' SUKUT709 4200 FETCH DOOR-TRIP-CSR'            08624022
086250                                       DELIMITED BY SIZE          08625013
086260                                  INTO PV-CICS-MSG-AREA           08626013
086270         PERFORM 9999-WRITE-TO-CSSL                               08627013
086280     END-IF.                                                      08628013
086290                                                                  08629013
086300                                                                  08630000
086400     EXEC SQL                                                     08640000
086500          FETCH   DOOR-TRIP-CSR                                   08650000
086600           INTO  :SUT00110-DOOR-ID                                08660000
086700                ,:SUT00110-INBD-TRIP-ID                           08670000
086800                ,:SUT00110-ASGD-STRT-TMST                         08680000
086900                ,:SUT00110-CRE-BY-USR-ID                          08690000
086901                ,:PV-ASSOC-ASGND :PV-NULL-IND                     08690133
087000                                                                  08700000
087100     END-EXEC.                                                    08710000
087200                                                                  08720000
087300     EVALUATE TRUE                                                08730000
087400       WHEN SQLCODE = ZERO                                        08740000
087500            SET PS-FIRST-ROW-FOUND     TO TRUE                    08750000
087600            SET PS-4200-PARA           TO TRUE                    08760000
087610            IF  PV-NULL-IND  = -1                                 08761033
087620                MOVE SPACE  TO  PV-ASSOC-ASGND                    08762033
087621                SET  PS-WRKR-SUT111-NOT-FOUND  TO  TRUE           08762133
087640            ELSE                                                  08764033
087700                PERFORM 7600-SELECT-WORKER                        08770033
087710            END-IF                                                08771033
087800            ADD  1  TO PV-TBL-SUB                                 08780000
087900            PERFORM 4300-MOVE-TO-TABLE                            08790000
087901                                                                  08790144
087910     IF PS-LOG-MESSAGE                                            08791044
087991         MOVE  SPACES              TO  PV-CICS-MSG-AREA           08799144
087992         STRING   ' SUKUT709 4200 '                               08799244
087993                  ' PNA TRIP:'         SU092-PRNT-N-APP-TRIP-IND  08799344
087994                  ' PNA USER:'         SU092-PRNT-N-APP-USER-IND  08799444
087995                                       DELIMITED BY SIZE          08799544
087996                                  INTO PV-CICS-MSG-AREA           08799644
087997         PERFORM 9999-WRITE-TO-CSSL                               08799744
087998     END-IF                                                       08799844
087999                                                                  08799944
088000       WHEN SQLCODE = +100                                        08800000
088100            SET PS-END-SUT110-CURSOR                              08810000
088200                PS-128-CARTON-NOT-FOUND TO TRUE                   08820000
088300            MOVE PV-TBL-SUB TO PV-TBL-SUB-MAX                     08830000
088310                                                                  08831044
088320     IF PS-LOG-MESSAGE                                            08832044
088330         MOVE  SPACES              TO  PV-CICS-MSG-AREA           08833044
088340         STRING   ' SUKUT709 4200 '                               08834044
088350                  ' PNA TRIP:'         SU092-PRNT-N-APP-TRIP-IND  08835044
088360                  ' PNA USER:'         SU092-PRNT-N-APP-USER-IND  08836044
088370                                       DELIMITED BY SIZE          08837044
088380                                  INTO PV-CICS-MSG-AREA           08838044
088390         PERFORM 9999-WRITE-TO-CSSL                               08839044
088391     END-IF                                                       08839144
088392                                                                  08839244
088400       WHEN SQLWARN0 NOT = SPACES                                 08840000
088500       WHEN SQLCODE  NOT = ZERO                                   08850000
088510            MOVE '4200'  TO  PV-CSSL-PARA                         08851026
088520            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    08852026
088530                                                                  08853026
088600           MOVE DK-OTBND-SHIPT-UNT-ID                             08860000
088700                               TO PV-DISP-SHIPT-UNT-ID            08870000
088800           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              08880000
088900           STRING   ' SUKUT709-4200-'                             08890000
089000                      ' CALLED BY-'                               08900000
089100                      SU092-VSM-PGM                               08910000
089200                      '  SQL:'                                    08920014
089300                      PV-DISPLAY-SQLCODE                          08930000
089400                      ' SSCC:'                                    08940014
089500                      PV-DISP-SHIPT-UNT-ID                        08950000
089600                      DELIMITED BY SIZE                           08960000
089700                                      INTO PV-CICS-MSG-AREA       08970000
089710                                                                  08971011
089810           PERFORM 9999-WRITE-TO-CSSL                             08981000
089820                                                                  08982026
090100           PERFORM 9998-RETURN                                    09010000
090200     END-EVALUATE.                                                09020000
090300                                                                  09030000
090301                                                                  09030122
090310     IF PS-LOG-MESSAGE                                            09031022
090320         MOVE SPACES                TO PV-CICS-MSG-AREA           09032022
090321         MOVE SUT00110-INBD-TRIP-ID TO PV-DISP-TRIP               09032122
090322         MOVE SQLCODE               TO PV-DISPLAY-SQLCODE         09032222
090330         STRING   ' SUKUT709 4200 '                               09033022
090331                  ' SQL:'              PV-DISPLAY-SQLCODE         09033125
090332                  ' DOOR:'             SUT00110-DOOR-ID           09033222
090333                  ' TRIP:'             PV-DISP-TRIP               09033322
090334                  ' ASGD:'             SUT00110-ASGD-STRT-TMST    09033422
090335                  ' CRE USR:'          SUT00110-CRE-BY-USR-ID     09033523
090340                                       DELIMITED BY SIZE          09034022
090350                                  INTO PV-CICS-MSG-AREA           09035022
090360         PERFORM 9999-WRITE-TO-CSSL                               09036022
090370     END-IF.                                                      09037022
090380                                                                  09038022
090390                                                                  09039022
090400* MS 06/18/2010 BEG                                               09040000
090500                                                                  09050000
090600 4210-FETCH-TRIP.                                                 09060000
090601                                                                  09060128
090602     IF  PS-BLD-INTERNAL-TABLE-YES                                09060228
090603         MOVE  '4210'  TO  PT-CURR-PARA                           09060328
090604         PERFORM 6110-INTERNAL-TABLE                              09060428
090605     END-IF.                                                      09060528
090610                                                                  09061013
090620     IF PS-LOG-MESSAGE                                            09062013
090630         MOVE  SPACES              TO  PV-CICS-MSG-AREA           09063013
090640         STRING   ' SUKUT709 4210 '                               09064013
090650                                       DELIMITED BY SIZE          09065013
090660                                  INTO PV-CICS-MSG-AREA           09066013
090670         PERFORM 9999-WRITE-TO-CSSL                               09067013
090680     END-IF.                                                      09068013
090690                                                                  09069013
090700                                                                  09070000
090800     EXEC SQL                                                     09080000
090900          FETCH   DOOR-TRIP-CSR                                   09090000
091000           INTO  :SUT00110-DOOR-ID                                09100000
091010                ,:SUT00110-INBD-TRIP-ID                           09101000
091020                ,:SUT00110-ASGD-STRT-TMST                         09102000
091030                ,:SUT00110-CRE-BY-USR-ID                          09103000
091031                ,:PV-ASSOC-ASGND :PV-NULL-IND                     09103133
091040                                                                  09104000
091050     END-EXEC.                                                    09105000
091060                                                                  09106000
091070     EVALUATE TRUE                                                09107000
091080       WHEN SQLCODE = ZERO                                        09108000
091090            IF  SUT00110-INBD-TRIP-ID = PV-WHSE-RPLN-TRIP-ID      09109033
091091                SET PS-128-CARTON-FOUND                           09109133
091092                    SU092-UCC128-FOUND                            09109233
091093                    PS-FIRST-ROW-FOUND                            09109333
091094                    PS-END-SUT110-CURSOR   TO TRUE                09109433
091095            ELSE                                                  09109533
091096                SET PS-128-CARTON-NOT-FOUND                       09109633
091097                    SU092-UCC128-NOT-FOUND TO TRUE                09109733
091098            END-IF                                                09109833
091099            SET PS-4200-PARA               TO TRUE                09109933
091100                                                                  09110033
091101            IF  PV-NULL-IND  = -1                                 09110133
091102                MOVE SPACE  TO  PV-ASSOC-ASGND                    09110233
091103                SET  PS-WRKR-SUT111-NOT-FOUND  TO  TRUE           09110333
091104            ELSE                                                  09110433
091105                PERFORM 7600-SELECT-WORKER                        09110533
091106            END-IF                                                09110633
091107                                                                  09110733
091108            ADD  1  TO PV-TBL-SUB                                 09110800
091109            PERFORM 4300-MOVE-TO-TABLE                            09110900
091110       WHEN SQLCODE = +100                                        09111000
091111            SET PS-END-SUT110-CURSOR                              09111100
091112                PS-128-CARTON-NOT-FOUND                           09111200
091113                SU092-UCC128-NOT-FOUND  TO TRUE                   09111300
091114            MOVE PV-TBL-SUB TO PV-TBL-SUB-MAX                     09111400
091115       WHEN SQLWARN0 NOT = SPACES                                 09111500
091116       WHEN SQLCODE  NOT = ZERO                                   09111600
091117            MOVE '4210'  TO  PV-CSSL-PARA                         09111726
091118            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    09111826
091119                                                                  09111926
091120           MOVE DK-OTBND-SHIPT-UNT-ID                             09112000
091121                               TO PV-DISP-SHIPT-UNT-ID            09112100
091122           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              09112200
091123           STRING   ' SUKUT709-4210-'                             09112300
091124                      ' CALLED BY-'                               09112400
091125                      SU092-VSM-PGM                               09112500
091126                      '  SQL:'                                    09112614
091127                      PV-DISPLAY-SQLCODE                          09112700
091128                      ' SSCC:'                                    09112814
091129                      PV-DISP-SHIPT-UNT-ID                        09112900
091130                      DELIMITED BY SIZE                           09113000
091131                                      INTO PV-CICS-MSG-AREA       09113100
091132           PERFORM 9999-WRITE-TO-CSSL                             09113200
091140                                                                  09114011
091153           PERFORM 9998-RETURN                                    09115300
091154     END-EVALUATE.                                                09115400
091155                                                                  09115500
091156* MS 06/18/2010 END                                               09115600
091157                                                                  09115700
091158 4300-MOVE-TO-TABLE.                                              09115800
091159                                                                  09115928
091160     IF  PS-BLD-INTERNAL-TABLE-YES                                09116028
091161         MOVE  '4300'  TO  PT-CURR-PARA                           09116128
091162         PERFORM 6110-INTERNAL-TABLE                              09116228
091163     END-IF.                                                      09116328
091164                                                                  09116413
091165     IF PS-LOG-MESSAGE                                            09116513
091166         MOVE  SPACES              TO  PV-CICS-MSG-AREA           09116613
091167         STRING   ' SUKUT709 4300 '                               09116713
091168                                       DELIMITED BY SIZE          09116813
091169                                  INTO PV-CICS-MSG-AREA           09116913
091170         PERFORM 9999-WRITE-TO-CSSL                               09117013
091171     END-IF.                                                      09117113
091172                                                                  09117213
091173                                                                  09117300
091174     IF PV-TBL-SUB  >  PV-TBL-SUB-MAX                             09117400
091175        SET PS-END-SUT110-CURSOR  TO TRUE                         09117500
091176                                                                  09117600
091177        DISPLAY ' 4300-MOVE-TO-TABLE'                             09117700
091178        DISPLAY 'SUKUT709 -  4300-MOVE-TO-TABLE'                  09117800
091180        DISPLAY ' TRIP ID   '  PV-TRIP-ID-WORK                    09118000
091190        DISPLAY ' USER ID   '  SUT00110-CRE-BY-USR-ID             09119000
091200        DISPLAY ' BARCODE-1 '  SU092-KEY-BAR-CODE-1               09120000
091300        DISPLAY ' BARCODE-2 '  SU092-KEY-BAR-CODE-2               09130000
091400        DISPLAY ' BARCODE-3 '  SU092-KEY-BAR-CODE-3               09140000
091500        DISPLAY ' ASSG STRT  TMST'  SUT00110-ASGD-STRT-TMST       09150000
091600        DISPLAY ' PV-TBL-SUB   '  PV-TBL-SUB                      09160000
091700        DISPLAY ' PV-TBL-SUB-MAX ' PV-TBL-SUB-MAX                 09170000
091800                                                                  09180000
091900     ELSE                                                         09190000
092000        MOVE SUT00110-DOOR-ID      TO                             09200000
092100                             TBL-DOOR-ID (PV-TBL-SUB)             09210000
092200        MOVE SUT00110-INBD-TRIP-ID TO                             09220000
092300                             TBL-TRIP-ID (PV-TBL-SUB)             09230000
092400**??    MOVE SUT00110-CRE-BY-USR-ID TO                            09240000
092500        MOVE SUT00111-WRKR-USR-ID   TO                            09250000
092600                             TBL-USER-ID (PV-TBL-SUB)             09260000
092700        MOVE SUT00110-ASGD-STRT-TMST TO                           09270000
092800                             TBL-ASGD-STRT-TMST (PV-TBL-SUB)      09280000
092900        IF PS-WRKR-SUT111-FOUND                                   09290000
093000           MOVE PC-Y  TO   TBL-WRKR-FOUND (PV-TBL-SUB)            09300000
093100        ELSE                                                      09310000
093200           MOVE PC-N  TO   TBL-WRKR-FOUND (PV-TBL-SUB)            09320000
093300        END-IF                                                    09330000
093400     END-IF.                                                      09340000
093500                                                                  09350000
093501                                                                  09350122
093502     IF PS-LOG-MESSAGE                                            09350222
093510         MOVE  SPACES               TO PV-CICS-MSG-AREA           09351022
093520         STRING   ' SUKUT709 4300 '                               09352022
093521                  ' DOOR:'             SUT00110-DOOR-ID           09352122
093522                  ' TRIP:'             PV-DISP-TRIP               09352222
093523                  ' USR:'              SUT00111-WRKR-USR-ID       09352322
093524                  ' ASGD:'             SUT00110-ASGD-STRT-TMST    09352422
093525                  ' WRKR:'             PS-WRKR-SUT111-FOUND-SW    09352525
093530                                       DELIMITED BY SIZE          09353022
093540                                  INTO PV-CICS-MSG-AREA           09354022
093550         PERFORM 9999-WRITE-TO-CSSL                               09355022
093560     END-IF.                                                      09356022
093570                                                                  09357022
093580                                                                  09358022
093600 4400-CLOSE-TRIP-CURSOR.                                          09360000
093601                                                                  09360128
093602     IF  PS-BLD-INTERNAL-TABLE-YES                                09360228
093603         MOVE  '4400'  TO  PT-CURR-PARA                           09360328
093604         PERFORM 6110-INTERNAL-TABLE                              09360428
093605     END-IF.                                                      09360528
093610                                                                  09361013
093620     IF PS-LOG-MESSAGE                                            09362013
093630         MOVE  SPACES              TO  PV-CICS-MSG-AREA           09363013
093640         STRING   ' SUKUT709 4400 - CLOSE DOOR-TRIP-CSR'          09364022
093650                                       DELIMITED BY SIZE          09365013
093660                                  INTO PV-CICS-MSG-AREA           09366013
093670         PERFORM 9999-WRITE-TO-CSSL                               09367013
093680     END-IF.                                                      09368013
093690                                                                  09369013
093700                                                                  09370000
093800     EXEC SQL                                                     09380000
093900         CLOSE DOOR-TRIP-CSR                                      09390000
094000     END-EXEC.                                                    09400000
094100                                                                  09410000
094200     EVALUATE TRUE                                                09420000
094300       WHEN SQLCODE = ZERO                                        09430000
094400           CONTINUE                                               09440000
094500                                                                  09450000
094600       WHEN SQLWARN0 NOT = SPACES                                 09460000
094700       WHEN SQLCODE  NOT = ZERO                                   09470000
094710            MOVE '4400'  TO  PV-CSSL-PARA                         09471026
094720            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    09472026
094730                                                                  09473026
094800           MOVE DK-OTBND-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID     09480000
094900           MOVE SQLCODE               TO PV-DISPLAY-SQLCODE       09490000
095000           STRING   ' SUKUT709-4400-'                             09500000
095100                      ' CALLED BY-'                               09510000
095200                      SU092-VSM-PGM                               09520000
095300                      '  SQL:'                                    09530014
095400                      PV-DISPLAY-SQLCODE                          09540000
095500                      ' SSCC:'                                    09550014
095600                      PV-DISP-SHIPT-UNT-ID                        09560000
095700                      DELIMITED BY SIZE                           09570000
095800                                      INTO PV-CICS-MSG-AREA       09580000
095900           PERFORM 9999-WRITE-TO-CSSL                             09590000
095910                                                                  09591011
096200           PERFORM 9998-RETURN                                    09620000
096300     END-EVALUATE.                                                09630000
096400                                                                  09640000
096500                                                                  09650000
096600* MS 06/18/2010 BEG                                               09660000
096700*                                                                 09670000
096800* TO READ THE FIRST RECORD FROM THE PV-TRIP-TABLE.IT WILL SEND    09680000
096900* THE DETAILS OF THE FIRST TRAILER TO THE CALLING PROGRAM         09690000
097000* SUKCS770 IN CASE THE PROCESSED FREIGHT CARTON IS NOT THERE ON   09700000
097100* ANY TRAILER.                                                    09710000
097200                                                                  09720000
097300 4500-READ-TRIP-TABLE.                                            09730000
097301                                                                  09730128
097302     IF  PS-BLD-INTERNAL-TABLE-YES                                09730228
097303         MOVE  '4500'  TO  PT-CURR-PARA                           09730328
097304         PERFORM 6110-INTERNAL-TABLE                              09730428
097305     END-IF.                                                      09730528
097310                                                                  09731013
097320     IF PS-LOG-MESSAGE                                            09732013
097330         MOVE  SPACES              TO  PV-CICS-MSG-AREA           09733013
097340         STRING   ' SUKUT709 4500 '                               09734013
097350                                       DELIMITED BY SIZE          09735013
097360                                  INTO PV-CICS-MSG-AREA           09736013
097370         PERFORM 9999-WRITE-TO-CSSL                               09737013
097380     END-IF.                                                      09738013
097390                                                                  09739013
097400                                                                  09740000
097500        MOVE 1 TO PV-TBL-SUB.                                     09750000
097600        MOVE TBL-DOOR-ID (PV-TBL-SUB)   TO  SU092-DOOR-ID.        09760000
097700        MOVE TBL-TRIP-ID (PV-TBL-SUB)   TO  SU092-TRIP-ID.        09770000
097800        MOVE TBL-USER-ID (PV-TBL-SUB)   TO  SU092-USER-ID.        09780000
097900                                                                  09790000
098000                                                                  09800000
098010* MS 06/18/2010 END                                               09801000
098020                                                                  09802000
098030 5100-SELECT-TKRPRPM.                                             09803000
098040                                                                  09804028
098041     IF  PS-BLD-INTERNAL-TABLE-YES                                09804128
098042         MOVE  '5100'  TO  PT-CURR-PARA                           09804228
098043         PERFORM 6110-INTERNAL-TABLE                              09804328
098044     END-IF.                                                      09804428
098045                                                                  09804513
098046     IF PS-LOG-MESSAGE                                            09804613
098047         MOVE  SPACES              TO  PV-CICS-MSG-AREA           09804713
098048         STRING   ' SUKUT709 5100 '                               09804813
098049                                       DELIMITED BY SIZE          09804913
098050                                  INTO PV-CICS-MSG-AREA           09805013
098051         PERFORM 9999-WRITE-TO-CSSL                               09805113
098052     END-IF.                                                      09805213
098053                                                                  09805313
098054     MOVE SU092-KEY-DC-LOC  TO DK-OPER-UNT-ID.                    09805400
098060                                                                  09806000
098070     EXEC SQL                                                     09807000
098080          SELECT FUNC_TXT                                         09808000
098090            INTO :KRPRPM-FUNC-TXT                                 09809000
098100            FROM TKRPRPM                                          09810000
098200           WHERE LOC_ID           = :DK-OPER-UNT-ID               09820000
098300             AND INTFC_SYS_CDE    = :PC-KHL                       09830000
098400             AND SYS_PRC_FUNC_CDE = :PC-PACEXC                    09840000
098410            WITH UR                                               09841015
098500     END-EXEC.                                                    09850000
098600                                                                  09860000
098700     EVALUATE TRUE                                                09870000
098800         WHEN SQLCODE = ZERO                                      09880000
098900              EVALUATE KRPRPM-FUNC-TXT                            09890000
099000                  WHEN PC-ALL                                     09900000
099100                       SET PS-LOG-LEVEL-ALL TO TRUE               09910000
099200                                                                  09920000
099300                  WHEN PC-POL                                     09930000
099400                       SET PS-LOG-LEVEL-PO  TO TRUE               09940000
099500                                                                  09950000
099600                  WHEN PC-VND                                     09960000
099700                       SET PS-LOG-LEVEL-VENDOR TO TRUE            09970000
099800                                                                  09980000
099900                  WHEN PC-FST                                     09990000
100000                       SET PS-LOG-LEVEL-FIRST TO TRUE             10000000
100100                                                                  10010000
100200                  WHEN PC-NNE                                     10020000
100300                       SET PS-LOG-LEVEL-NONE  TO TRUE             10030000
100400                                                                  10040000
100500              END-EVALUATE                                        10050000
100600         WHEN SQLCODE = +100                                      10060000
100700             SET PS-LOG-LEVEL-NONE  TO TRUE                       10070000
100800         WHEN SQLWARN0 NOT = SPACES                               10080000
100900         WHEN SQLCODE NOT EQUAL ZERO                              10090000
100910            MOVE '5100'  TO  PV-CSSL-PARA                         10091026
100920            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    10092026
100930                                                                  10093026
101000             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       10100000
101100             STRING   ' SUKUT709-5100-'                           10110000
101200                      ' CALLED BY-'                               10120000
101300                      SU092-VSM-PGM                               10130000
101400                      '  SQL:'                                    10140014
101500                      PV-DISPLAY-SQLCODE                          10150000
101600                      ' '                                         10160000
101700                      DELIMITED BY SIZE                           10170000
101800                                      INTO PV-CICS-MSG-AREA       10180000
101900             PERFORM 9999-WRITE-TO-CSSL                           10190000
101910                                                                  10191011
102010             PERFORM 9998-RETURN                                  10201000
102100     END-EVALUATE.                                                10210000
102101                                                                  10210122
102102                                                                  10210222
102110     IF PS-LOG-MESSAGE                                            10211022
102120         MOVE  SPACES              TO  PV-CICS-MSG-AREA           10212022
102121         MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE         10212122
102130         STRING   ' SUKUT709 5100 '                               10213022
102131                  ' SQL:'              PV-DISPLAY-SQLCODE         10213122
102132                  ' TKRPRPM: PACEXC '  KRPRPM-FUNC-TXT            10213222
102140                                       DELIMITED BY SIZE          10214022
102150                                  INTO PV-CICS-MSG-AREA           10215022
102160         PERFORM 9999-WRITE-TO-CSSL                               10216022
102170     END-IF.                                                      10217022
102200                                                                  10220000
102201                                                                  10220114
102202 5120-CHECK-CSSL-LOGGING.                                         10220214
102203                                                                  10220328
102204     IF  PS-BLD-INTERNAL-TABLE-YES                                10220428
102205         MOVE  '5120'  TO  PT-CURR-PARA                           10220528
102206         PERFORM 6110-INTERNAL-TABLE                              10220628
102207     END-IF.                                                      10220728
102208                                                                  10220814
102212     MOVE SU092-KEY-DC-LOC  TO DK-OPER-UNT-ID.                    10221214
102213                                                                  10221314
102214     EXEC SQL                                                     10221414
102215          SELECT FUNC_TXT                                         10221514
102216            INTO :PS-LOG-MESSAGE-SW                               10221614
102217            FROM TKRPRPM                                          10221714
102218           WHERE LOC_ID            = :DK-OPER-UNT-ID              10221820
102219             AND INTFC_SYS_CDE     = :PC-KHL                      10221920
102220             AND SYS_PRC_FUNC_CDE  = :PC-PACRT3                   10222020
102221             AND FUNC_PRC_STAT_CDE = 'AC'                         10222120
102222            WITH UR                                               10222219
102223     END-EXEC.                                                    10222319
102224                                                                  10222419
102225     EVALUATE TRUE                                                10222519
102226         WHEN SQLCODE = ZERO                                      10222619
102227              IF  PS-LOG-MESSAGE                                  10222719
102228                  MOVE SU092-KEY-DC-LOC      TO PV-DISP-OPER      10222819
102229                  MOVE SU092-KEY-ACM-STN-NBR TO PV-DISP-PNA-STA   10222919
102230                  MOVE SU092-TRIP-ID         TO PV-TRIP-ID-WORK   10223019
102231                  MOVE  SQLCODE              TO PV-DISPLAY-SQLCODE10223119
102232                  MOVE SPACES TO PV-CICS-MSG-AREA                 10223219
102233                  STRING   ' SUKUT709-5120'                       10223319
102234                           ' DC:'   PV-DISP-OPER                  10223419
102235                           ' STA:'  PV-DISP-PNA-STA               10223519
102236                           ' DOOR:' SU092-DOOR-ID                 10223619
102237                           ' TRIP:' PV-TRIP-ID-WORK               10223719
102238                           ' SQL:'  PV-DISPLAY-SQLCODE            10223819
102239                           ' PARA:' PS-PARAGRAPH-SW               10223919
102240                           ' USER:' SU092-USER-ID                 10224019
102241                                     DELIMITED BY SIZE            10224119
102242                                INTO PV-CICS-MSG-AREA             10224219
102243                  PERFORM 9999-WRITE-TO-CSSL                      10224319
102244                                                                  10224419
102245                  MOVE SPACES TO PV-CICS-MSG-AREA                 10224519
102246                  STRING   ' SUKUT709-5120'                       10224619
102247                           ' SSCC 1:' SU092-KEY-BAR-CODE-1        10224719
102248                           ' SSCC 2:' SU092-KEY-BAR-CODE-2        10224819
102249                           ' SSCC 3:' SU092-KEY-BAR-CODE-3        10224919
102251                                     DELIMITED BY SIZE            10225115
102252                                INTO PV-CICS-MSG-AREA             10225215
102253                  PERFORM 9999-WRITE-TO-CSSL                      10225315
102254              END-IF                                              10225418
102256                                                                  10225614
102257         WHEN SQLCODE = +100                                      10225714
102258             SET PS-NO-LOG-MESSAGE  TO TRUE                       10225814
102259                                                                  10225914
102260         WHEN SQLWARN0 NOT = SPACES                               10226014
102261         WHEN SQLCODE NOT EQUAL ZERO                              10226114
102262            MOVE '5120'  TO  PV-CSSL-PARA                         10226226
102263            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    10226326
102264                                                                  10226426
102265             SET PS-NO-LOG-MESSAGE  TO TRUE                       10226514
102266             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       10226614
102267             STRING   ' SUKUT709-5120-'                           10226714
102268                      ' CALLED BY-'                               10226814
102269                      SU092-VSM-PGM                               10226914
102270                      '  SQL:'                                    10227014
102271                      PV-DISPLAY-SQLCODE                          10227114
102272                      ' '                                         10227214
102273                      DELIMITED BY SIZE                           10227314
102274                                      INTO PV-CICS-MSG-AREA       10227414
102275             PERFORM 9999-WRITE-TO-CSSL                           10227514
102276                                                                  10227614
102303     END-EVALUATE.                                                10230314
102304                                                                  10230414
102305                                                                  10230522
102306     IF PS-LOG-MESSAGE                                            10230622
102307         MOVE  SPACES              TO  PV-CICS-MSG-AREA           10230722
102308         MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE         10230822
102309         STRING   ' SUKUT709 5120 '                               10230922
102310                  ' SQL:'              PV-DISPLAY-SQLCODE         10231022
102311                  ' TKRPRPM: PACRT3'   PS-LOG-MESSAGE-SW          10231126
102312                                       DELIMITED BY SIZE          10231222
102313                                  INTO PV-CICS-MSG-AREA           10231322
102314         PERFORM 9999-WRITE-TO-CSSL                               10231422
102315     END-IF.                                                      10231522
102316                                                                  10231622
102317                                                                  10231714
102318*---------------------------------------------------------------* 10231826
102319* check parm table (TKRPRPM) to check for logging to CSSL       * 10231926
102320* IF PROGRAM IS TAKING TOO LONG TO RESPOND.  THE VALUE WILL     * 10232026
102321* BE seconds AND WILL BE USED TO DETERMINE IF WE SHOULD WRITE   * 10232126
102322* pt-pARA-tRACKING TABLE TO CSSL                                * 10232226
102323* check parm table (TKRPRPM) to check if will be building the   * 10232326
102324* internal table during processing.  this will be used when     * 10232426
102325* dc's report long resonse times                                * 10232526
102326*  2015-01-29 - DMH                                             * 10232626
102327*---------------------------------------------------------------* 10232726
102328 5130-CHECK-PARA-TRACK-SEC.                                       10232826
102329                                                                  10232928
102330     IF  PS-BLD-INTERNAL-TABLE-YES                                10233028
102331         MOVE  '5130'  TO  PT-CURR-PARA                           10233128
102332         PERFORM 6110-INTERNAL-TABLE                              10233228
102333     END-IF.                                                      10233328
102334                                                                  10233426
102335     MOVE SU092-KEY-DC-LOC  TO DK-OPER-UNT-ID.                    10233526
102336                                                                  10233626
102337     EXEC SQL                                                     10233726
102338          SELECT  FUNC_QTY                                        10233826
102339               ,  FUNC_txt                                        10233926
102340            INTO :PV-PARM-seconds                                 10234026
102341               , :PS-BLD-INTERNAL-TABLE-SW                        10234126
102342            FROM  TKRPRPM                                         10234226
102343           WHERE  LOC_ID            = :DK-OPER-UNT-ID             10234326
102344             AND  INTFC_SYS_CDE     = :PC-ACM                     10234426
102345             AND  SYS_PRC_FUNC_CDE  = :PC-PATIM3                  10234526
102346             AND  FUNC_PRC_STAT_CDE = 'AC'                        10234626
102347             AND  fUNC_BEG_TMST    <=  current timestamp          10234726
102348             AND  fUNC_END_TMST    >=  current timestamp          10234826
102349            WITH UR                                               10234926
102350     END-EXEC.                                                    10235026
102351                                                                  10235126
102352     EVALUATE TRUE                                                10235226
102353         WHEN SQLCODE = ZERO                                      10235326
102354              IF  PS-LOG-MESSAGE                                  10235426
102355                  MOVE SU092-KEY-DC-LOC      TO PV-DISP-OPER      10235526
102356                  MOVE SU092-KEY-ACM-STN-NBR TO PV-DISP-PNA-STA   10235626
102357                  MOVE SU092-TRIP-ID         TO PV-TRIP-ID-WORK   10235726
102358                  MOVE  SQLCODE              TO PV-DISPLAY-SQLCODE10235826
102359                  MOVE SPACES TO PV-CICS-MSG-AREA                 10235926
102360                  STRING   ' SUKUT709-5130'                       10236026
102361                           ' DC:'   PV-DISP-OPER                  10236126
102362                           ' STA:'  PV-DISP-PNA-STA               10236226
102363                           ' DOOR:' SU092-DOOR-ID                 10236326
102364                           ' TRIP:' PV-TRIP-ID-WORK               10236426
102365                           ' SQL:'  PV-DISPLAY-SQLCODE            10236526
102366                           ' PARA:' PS-PARAGRAPH-SW               10236626
102367                           ' USER:' SU092-USER-ID                 10236726
102368                                     DELIMITED BY SIZE            10236826
102369                                INTO PV-CICS-MSG-AREA             10236926
102370                  PERFORM 9999-WRITE-TO-CSSL                      10237026
102371                                                                  10237126
102372                  MOVE SPACES TO PV-CICS-MSG-AREA                 10237226
102373                  STRING   ' SUKUT709-5130'                       10237326
102374                           ' SSCC 1:' SU092-KEY-BAR-CODE-1        10237426
102375                           ' SSCC 2:' SU092-KEY-BAR-CODE-2        10237526
102376                           ' SSCC 3:' SU092-KEY-BAR-CODE-3        10237626
102377                                     DELIMITED BY SIZE            10237726
102378                                INTO PV-CICS-MSG-AREA             10237826
102379                  PERFORM 9999-WRITE-TO-CSSL                      10237926
102380                                                                  10238026
102381                  MOVE SPACES TO PV-CICS-MSG-AREA                 10238126
102382                  MOVE PV-PARM-SECONDS TO PV-DISP-PARM-SECONDS    10238231
102383                  STRING   ' SUKUT709-5130'                       10238326
102384                           ' QTY:'    PV-DISP-PARM-SECONDS        10238431
102385                           ' TXT:'    PS-BLD-INTERNAL-TABLE-SW    10238526
102386                                     DELIMITED BY SIZE            10238626
102387                                INTO PV-CICS-MSG-AREA             10238726
102388                  PERFORM 9999-WRITE-TO-CSSL                      10238826
102390              END-IF                                              10239026
102391                                                                  10239126
102392         WHEN SQLCODE = +100                                      10239226
102393              MOVE 999999999  TO  PV-PARM-SECONDS                 10239326
102394              SET  PS-BLD-INTERNAL-TABLE-NO   TO TRUE             10239426
102395                                                                  10239526
102396         WHEN SQLWARN0 NOT = SPACES                               10239626
102397         WHEN SQLCODE NOT EQUAL ZERO                              10239726
102398            MOVE '5130'  TO  PV-CSSL-PARA                         10239826
102399            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    10239926
102400                                                                  10240026
102401             SET PS-BLD-INTERNAL-TABLE-NO   TO  TRUE              10240126
102402             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       10240226
102403             STRING   ' SUKUT709-5130-'                           10240326
102404                      ' CALLED BY-'                               10240426
102405                      SU092-VSM-PGM                               10240526
102406                      '  SQL:'                                    10240626
102407                      PV-DISPLAY-SQLCODE                          10240726
102408                      ' '                                         10240826
102409                      DELIMITED BY SIZE                           10240926
102410                                      INTO PV-CICS-MSG-AREA       10241026
102411             PERFORM 9999-WRITE-TO-CSSL                           10241126
102412                                                                  10241226
102439     END-EVALUATE.                                                10243926
102440                                                                  10244026
102441                                                                  10244126
102442     IF PS-LOG-MESSAGE                                            10244226
102443         MOVE  SPACES              TO  PV-CICS-MSG-AREA           10244326
102444         MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE         10244426
102445         STRING   ' SUKUT709 5130 '                               10244526
102446                  ' SQL:'              PV-DISPLAY-SQLCODE         10244626
102447                  ' TKRPRPM: PATIM3 '  PS-LOG-MESSAGE-SW          10244734
102448                                       DELIMITED BY SIZE          10244826
102449                                  INTO PV-CICS-MSG-AREA           10244926
102450         PERFORM 9999-WRITE-TO-CSSL                               10245026
102451     END-IF.                                                      10245126
102452                                                                  10245226
102453                                                                  10245336
102457*---------------------------------------------------------------* 10245736
102458* WRITE COMMAREA TO CSSL                                        * 10245836
102459* DMH - 01/29/15                                                * 10245936
102460*---------------------------------------------------------------* 10246036
102461 6100-WRITE-SUWS092-TO-CSSL.                                      10246136
102462                                                                  10246236
102463     IF  PS-BLD-INTERNAL-TABLE-YES                                10246336
102464         MOVE  '6100'  TO  PT-CURR-PARA                           10246436
102465         PERFORM 6110-INTERNAL-TABLE                              10246536
102466     END-IF.                                                      10246636
102467                                                                  10246736
102468     INITIALIZE PV-CICS-MSG-AREA                                  10246836
102469     MOVE SU092-KEY-DC-LOC      TO PV-DISP-OPER                   10246936
102470     MOVE SU092-KEY-ACM-STN-NBR TO PV-DISP-PNA-STA                10247036
102471     MOVE SU092-TRIP-ID         TO PV-TRIP-ID-WORK                10247136
102472     MOVE SQLCODE               TO PV-DISPLAY-SQLCODE             10247236
102480                                                                  10248036
102506     STRING  ' SUKUT709 ' PV-CSSL-PARA                            10250626
102507             ' METH:'     SU092-ACCESS-METHOD                     10250727
102508             ' RC:'       SU092-RETURN-CODE                       10250826
102509             ' TRIP:'     SU092-PRNT-N-APP-TRIP-IND               10250927
102510             ' USR:'      SU092-PRNT-N-APP-USER-IND               10251026
102511             ' ERR:'      SU092-ERROR-NBR                         10251126
102512             '-'          SU092-ERROR-PARA                        10251226
102513             ' OPER:'     PV-DISP-OPER                            10251326
102514             ' STA:'      PV-DISP-PNA-STA                         10251426
102516                          DELIMITED BY SIZE                       10251626
102517                     INTO PV-CICS-MSG-AREA                        10251726
102518                                                                  10251826
102519     PERFORM 9999-WRITE-TO-CSSL                                   10251931
102520                                                                  10252026
102521     INITIALIZE PV-CICS-MSG-AREA                                  10252126
102522     STRING  ' SUKUT709 '                                         10252226
102523             ' BC1:'     SU092-KEY-BAR-CODE-1                     10252326
102524             ' BC2:'     SU092-KEY-BAR-CODE-2                     10252426
102525             ' BC3:'     SU092-KEY-BAR-CODE-3                     10252526
102527             ' SQL:'     PV-DISPlay-sQLCODE                       10252731
102528                         DELIMITED BY SIZE                        10252826
102529                    INTO PV-CICS-MSG-AREA                         10252926
102530                                                                  10253026
102531     PERFORM 9999-WRITE-TO-CSSL                                   10253131
102532                                                                  10253226
102533     INITIALIZE PV-CICS-MSG-AREA                                  10253326
102534     STRING  ' SUKUT709 '                                         10253426
102535             ' TRIP:'      PV-TRIP-ID-WORK                        10253526
102536             ' USER:'      SU092-USER-ID                          10253626
102537             ' DOOR:'      SU092-DOOR-ID                          10253726
102538             ' UCC128:'    SU092-UCC128-FOUND-IND                 10253826
102539             ' MULT SSCC:' SU092-MULT-SSCC-IND                    10253926
102540                           DELIMITED BY SIZE                      10254026
102541                      INTO PV-CICS-MSG-AREA                       10254126
102542                                                                  10254226
102543     PERFORM 9999-WRITE-TO-CSSL.                                  10254331
102544                                                                  10254426
102545                                                                  10254528
102546*---------------------------------------------------------------* 10254628
102547* BUILD INTERNAL TABLE WITN PARAGRAPH TRACKING                  * 10254728
102548* DMH - 01/29/15                                                * 10254828
102549*---------------------------------------------------------------* 10254928
102550 6110-INTERNAL-TABLE.                                             10255028
102551                                                                  10255128
102552     PERFORM 6120-GET-CURRENT-TMST.                               10255228
102553     ADD  +1  TO  PT-CURR-ENTRIES.                                10255328
102554     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         10255428
102555                                                                  10255528
102556     MOVE 'SUKUT709'           TO PT-PROGRAM(PT-TRACK-IDX).       10255628
102557     MOVE PT-CURR-ENTRIES      TO PT-INDEX-NBR(PT-TRACK-IDX).     10255728
102558     MOVE PT-CURR-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     10255828
102559     MOVE PV-CURRENT-PARA-TMST TO PT-TIMESTAMP(PT-TRACK-IDX).     10255928
102560     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      10256028
102561                                                                  10256128
102562     MOVE PV-DURATION-NANO-SEC    TO PV-WORK-NANO-SEC.            10256228
102563     MOVE PV-WORK-NANO-MIN-1-2    TO PV-DISP-NANO-MIN-1-2.        10256328
102564     MOVE '-'                     TO PV-DISP-NANO-DASH-1.         10256428
102565     MOVE PV-WORK-NANO-SEC-3-4    TO PV-DISP-NANO-SEC-3-4.        10256528
102566     MOVE '-'                     TO PV-DISP-NANO-DASH-2.         10256628
102567     MOVE PV-WORK-NANO-MICRO-5-10 TO PV-DISP-NANO-MICRO-5-10.     10256728
102568     MOVE PV-DISP-NANO-SEC     TO PT-NANO-SEC(PT-TRACK-IDX).      10256828
102569                                                                  10256928
102570     MOVE SU092-KEY-DC-LOC      TO PT-DC(PT-TRACK-IDX).           10257028
102571     MOVE SU092-KEY-ACM-STN-NBR TO PT-PNA-STA(PT-TRACK-IDX).      10257128
102572     MOVE PV-INIT-TIME-KEY      TO PT-START-HHMMSS(PT-TRACK-IDX). 10257228
102573                                                                  10257328
102580     IF  PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES                     10258028
102581         MOVE ZEROES TO PT-CURR-ENTRIES                           10258128
102582         SET  PT-TRACK-IDX  TO PT-CURR-ENTRIES                    10258228
102583     END-IF.                                                      10258328
102584                                                                  10258428
102585                                                                  10258528
102586*---------------------------------------------------------------* 10258628
102587*                                                               * 10258728
102588* DMH - 01/29/15                                                * 10258828
102589*---------------------------------------------------------------* 10258928
102590 6120-GET-CURRENT-TMST.                                           10259028
102591     EXEC SQL                                                     10259128
102592          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           10259228
102593     END-EXEC.                                                    10259328
102594                                                                  10259428
102595     EXEC SQL                                                     10259528
102596          SELECT                                                  10259628
102597                 TIMESTAMPDIFF( 2 ,CHAR(:PV-CURRENT-PARA-TMST     10259728
102598                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           10259828
102599               , TIMESTAMPDIFF( 1 ,CHAR(:PV-CURRENT-PARA-TMST     10259928
102600                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           10260028
102601            INTO :PV-DURATION-SEC                                 10260128
102602               , :PV-DURATION-nano-sec                            10260228
102603            FROM  SYSIBM.SYSDUMMY1                                10260328
102604     END-EXEC.                                                    10260428
102605                                                                  10260528
102606                                                                  10260628
102607*---------------------------------------------------------------* 10260728
102608*                                                               * 10260828
102609* DMH - 01/29/15                                                * 10260928
102610*---------------------------------------------------------------* 10261028
102611 1630-DUMP-TABLE-TO-CSSL.                                         10261128
102612                                                                  10261228
102613     INITIALIZE PV-CICS-MSG-AREA                                  10261328
102614                                                                  10261428
102615     MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA           10261528
102616                                                                  10261628
102617     PERFORM 9999-WRITE-TO-CSSL.                                  10261731
102618                                                                  10261828
102619                                                                  10261928
102620*---------------------------------------------------------------* 10262028
102621*                                                               * 10262128
102622* DMH - 01/29/15                                                * 10262228
102623*---------------------------------------------------------------* 10262328
102624 1640-CLEAR-TABLE.                                                10262428
102625                                                                  10262528
102626     MOVE  SPACES  TO  PT-PROGRAM(PT-TRACK-IDX).                  10262628
102627     MOVE  ZEROES  TO  PT-INDEX-NBR(PT-TRACK-IDX).                10262728
102628     MOVE  SPACES  TO  PT-PARAGRAPH(PT-TRACK-IDX).                10262828
102629     MOVE  SPACES  TO  PT-TIMESTAMP(PT-TRACK-IDX).                10262928
102630     MOVE  ZEROES  TO  PT-DURATION(PT-TRACK-IDX).                 10263028
102631                                                                  10263128
102632                                                                  10263228
102636*---------------------------------------------------------------* 10263628
102637*                                                               * 10263728
102638*                                                               * 10263828
102639*---------------------------------------------------------------* 10263928
102640 7300-SELECT-TSHUNLO.                                             10264028
102641                                                                  10264128
102642     IF  PS-BLD-INTERNAL-TABLE-YES                                10264228
102643         MOVE  '7300'  TO  PT-CURR-PARA                           10264328
102644         PERFORM 6110-INTERNAL-TABLE                              10264428
102645     END-IF.                                                      10264528
102646                                                                  10264628
102647     IF PS-LOG-MESSAGE                                            10264728
102648         MOVE  SPACES              TO  PV-CICS-MSG-AREA           10264828
102649         STRING   ' SUKUT709 7300 '                               10264928
102650                                       DELIMITED BY SIZE          10265028
102651                                  INTO PV-CICS-MSG-AREA           10265128
102652         PERFORM 9999-WRITE-TO-CSSL                               10265228
102653     END-IF.                                                      10265328
102654                                                                  10265428
102655                                                                  10265528
102656     MOVE DK-BAR-CODE-20      TO DK-SHIPT-UNT-ID.                 10265628
102660                                                                  10266000
102700     EXEC SQL                                                     10270000
102800        SELECT                                                    10280000
102900                TRIP_ID                                           10290000
103000          INTO                                                    10300000
103100                :SHUNLO-TRIP-ID                                   10310000
103200          FROM  TSHUNLO                                           10320000
103300          WHERE SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID              10330000
103400            AND SCN_LOC_ID        = :PC-RECV                      10340000
103410           WITH UR                                                10341038
103500     END-EXEC.                                                    10350000
103600                                                                  10360000
103700     EVALUATE TRUE                                                10370000
103800         WHEN SQLCODE = ZERO                                      10380000
103900              SET PS-TSHUNLO-TRIP-FOUND TO TRUE                   10390000
104000         WHEN SQLCODE = +100                                      10400000
104100              SET PS-TSHUNLO-TRIP-NOT-FOUND TO TRUE               10410000
104200         WHEN SQLWARN0 NOT = SPACES                               10420000
104300         WHEN SQLCODE NOT EQUAL ZERO                              10430000
104310            MOVE '7300'  TO  PV-CSSL-PARA                         10431026
104320            PERFORM 6100-WRITE-SUWS092-TO-CSSL                    10432026
104330                                                                  10433026
104400             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       10440000
104410             MOVE  DK-SHIPT-UNT-ID    TO PV-DISP-SHIPT-UNT-ID     10441011
104500             STRING   ' SUKUT709-7300-'                           10450000
104600                      ' CALLED BY-'  SU092-VSM-PGM                10460011
104800                      '  SQL:'       PV-DISPLAY-SQLCODE           10480011
105000                      ' CART:'       PV-DISP-SHIPT-UNT-ID         10500011
105100                      DELIMITED BY SIZE                           10510000
105200                                      INTO PV-CICS-MSG-AREA       10520000
105300             PERFORM 9999-WRITE-TO-CSSL                           10530000
105310                                                                  10531011
105410             PERFORM 9998-RETURN                                  10541000
105500     END-EVALUATE.                                                10550000
105600                                                                  10560000
105601                                                                  10560121
105610     IF PS-LOG-MESSAGE                                            10561021
105620         MOVE  SPACES             TO  PV-CICS-MSG-AREA            10562021
105621         MOVE  SHUNLO-TRIP-ID     TO  PV-DISP-TRIP                10562121
105622         MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE           10562221
105630         STRING   ' SUKUT709 7300 '                               10563021
105631                  ' TRIP:'             PV-DISP-TRIP               10563121
105632                  ' SQL:'              PV-DISPLAY-SQLCODE         10563221
105640                                       DELIMITED BY SIZE          10564021
105650                                  INTO PV-CICS-MSG-AREA           10565021
105660         PERFORM 9999-WRITE-TO-CSSL                               10566021
105670     END-IF.                                                      10567021
105700                                                                  10570000
105710                                                                  10571021
105800* MS 06/18/2010 BEG                                               10580000
105900*                                                                 10590000
106000* TO CHECK IF THE PROCESSED FREIGHT CARTON IS PRESENT ON THE      10600000
106100* OUTBOUND CARTON TABLE AND THE SOURCE CODE IS 'RDM'              10610000
106200                                                                  10620000
106300 7400-SELECT-OTBND-CART.                                          10630000
106301                                                                  10630128
106302     IF  PS-BLD-INTERNAL-TABLE-YES                                10630228
106303         MOVE  '7400'  TO  PT-CURR-PARA                           10630328
106304         PERFORM 6110-INTERNAL-TABLE                              10630428
106305     END-IF.                                                      10630528
106310                                                                  10631013
106320     IF PS-LOG-MESSAGE                                            10632013
106330         MOVE  SPACES              TO  PV-CICS-MSG-AREA           10633013
106340         STRING   ' SUKUT709 7400 '                               10634013
106350                                       DELIMITED BY SIZE          10635013
106360                                  INTO PV-CICS-MSG-AREA           10636013
106370         PERFORM 9999-WRITE-TO-CSSL                               10637013
106380     END-IF.                                                      10638013
106390                                                                  10639013
106400                                                                  10640000
106500     MOVE DK-BAR-CODE-20     TO DK-SHIPT-UNT-ID.                  10650000
106600     MOVE 'N'                TO PV-WHSE-OTBND-CART.               10660000
106700                                                                  10670000
106800     EXEC SQL                                                     10680000
106900         SELECT 'Y'                                               10690000
107000           INTO                                                   10700000
107100                :PV-WHSE-OTBND-CART                               10710000
107200           FROM SUT_OTBND_CART                                    10720000
107300          WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                   10730000
107400          AND   ACTV_IND     = 'Y'                                10740000
107500          AND   CART_SRC_CDE = 'RDM'                              10750000
107510           WITH UR                                                10751015
107600     END-EXEC.                                                    10760000
107700                                                                  10770000
107800     EVALUATE TRUE                                                10780000
107900         WHEN SQLCODE = ZERO                                      10790000
108000              SET PS-WHSE-OTBND-CART-YES TO TRUE                  10800000
108100         WHEN SQLCODE = +100                                      10810000
108110              SET PS-WHSE-OTBND-CART-NO  TO TRUE                  10811000
108120         WHEN SQLWARN0 NOT = SPACES                               10812000
108121         WHEN SQLCODE  NOT EQUAL ZERO                             10812100
108122              MOVE '7400'  TO  PV-CSSL-PARA                       10812226
108123              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  10812326
108124                                                                  10812426
108125              MOVE  SQLCODE              TO PV-DISPLAY-SQLCODE    10812500
108126              MOVE  DK-SHIPT-UNT-ID      TO PV-DISP-SHIPT-UNT-ID  10812611
108127              SET SU092-SQL-ERROR        TO TRUE                  10812700
108128              STRING   ' SUKUT709-7400-'                          10812800
108129                       ' CALLED BY-'  SU092-VSM-PGM               10812911
108130                       '  SQL:'       PV-DISPLAY-SQLCODE          10813011
108131                       ' CART:'       PV-DISP-SHIPT-UNT-ID        10813111
108132                       DELIMITED BY SIZE                          10813200
108140                                       INTO PV-CICS-MSG-AREA      10814000
108150              PERFORM 9999-WRITE-TO-CSSL                          10815000
108151                                                                  10815111
108179              PERFORM 9998-RETURN                                 10817900
108180     END-EVALUATE.                                                10818000
108181                                                                  10818122
108182                                                                  10818222
108183     IF PS-LOG-MESSAGE                                            10818322
108184         MOVE  SPACES             TO  PV-CICS-MSG-AREA            10818422
108186         MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE           10818622
108187         STRING   ' SUKUT709 7400 '                               10818722
108188                  ' RDM:'              PV-WHSE-OTBND-CART         10818822
108189                  ' SQL:'              PV-DISPLAY-SQLCODE         10818922
108190                                       DELIMITED BY SIZE          10819022
108191                                  INTO PV-CICS-MSG-AREA           10819122
108192         PERFORM 9999-WRITE-TO-CSSL                               10819222
108193     END-IF.                                                      10819322
108194                                                                  10819422
108195                                                                  10819522
108196* TO DETERMINE THE TRIP ID FROM THE OUTBOUND LOCATION TABLE FOR   10819622
108200* THE PROCESSED FREIGHT.                                          10820000
108300*                                                                 10830000
108310 7450-SELECT-OTBND-LOC.                                           10831000
108311                                                                  10831128
108312     IF  PS-BLD-INTERNAL-TABLE-YES                                10831228
108313         MOVE  '7450'  TO  PT-CURR-PARA                           10831328
108314         PERFORM 6110-INTERNAL-TABLE                              10831428
108315     END-IF.                                                      10831528
108316                                                                  10831613
108317     IF PS-LOG-MESSAGE                                            10831713
108318         MOVE  SPACES              TO  PV-CICS-MSG-AREA           10831813
108319         STRING   ' SUKUT709 7450 '                               10831913
108320                                       DELIMITED BY SIZE          10832013
108321                                  INTO PV-CICS-MSG-AREA           10832113
108322         PERFORM 9999-WRITE-TO-CSSL                               10832213
108323     END-IF.                                                      10832313
108324                                                                  10832413
108325                                                                  10832500
108330     MOVE DK-BAR-CODE-20      TO DK-SHIPT-UNT-ID.                 10833000
108340     MOVE SU092-KEY-DC-LOC    TO DK-OPER-UNT-ID.                  10834000
108350                                                                  10835000
108360     EXEC SQL                                                     10836000
108370         SELECT INBD_TRIP_ID                                      10837000
108380           INTO                                                   10838000
108390                :SUT00027-INBD-TRIP-ID                            10839000
108400           FROM SUT_OTBND_LOC                                     10840000
108500          WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                   10850000
108600          AND   LOC_NBR      = :DK-OPER-UNT-ID                    10860000
108700          AND   SCN_CDE      = 'RECV'                             10870000
108800       WITH UR                                                    10880000
108900     END-EXEC.                                                    10890000
109000                                                                  10900000
109100     EVALUATE TRUE                                                10910000
109200         WHEN SQLCODE = ZERO                                      10920000
109300              SET PS-WHSE-TRIP-FOUND TO TRUE                      10930000
109400              MOVE SUT00027-INBD-TRIP-ID TO PV-WHSE-RPLN-TRIP-ID  10940000
109500*                                           PV-WHSE-TRIP-ID       10950000
109600         WHEN SQLCODE = +100                                      10960000
109700              SET PS-WHSE-TRIP-NOT-FOUND TO TRUE                  10970000
109800         WHEN SQLWARN0 NOT = SPACES                               10980000
109900         WHEN SQLCODE  NOT EQUAL ZERO                             10990000
109910              MOVE '7450'  TO  PV-CSSL-PARA                       10991026
109920              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  10992026
109930                                                                  10993026
110000              MOVE  SQLCODE              TO PV-DISPLAY-SQLCODE    11000000
110001              MOVE  DK-SHIPT-UNT-ID      TO PV-DISP-SHIPT-UNT-ID  11000111
110010              SET SU092-SQL-ERROR        TO TRUE                  11001000
110020              STRING   ' SUKUT709-7450-'                          11002000
110030                       ' CALLED BY-'  SU092-VSM-PGM               11003011
110050                       '  SQL:'       PV-DISPLAY-SQLCODE          11005011
110070                       ' CART:'       PV-DISP-SHIPT-UNT-ID        11007011
110080                       DELIMITED BY SIZE                          11008000
110090                                       INTO PV-CICS-MSG-AREA      11009000
110091              PERFORM 9999-WRITE-TO-CSSL                          11009100
110092                                                                  11009211
110120              PERFORM 9998-RETURN                                 11012000
110121     END-EVALUATE.                                                11012100
110122                                                                  11012200
110123* MS 06/18/2010 END                                               11012300
110124                                                                  11012400
110125 7500-SELECT-TRIP-ASSIGMENT.                                      11012500
110126                                                                  11012628
110127     IF  PS-BLD-INTERNAL-TABLE-YES                                11012728
110128         MOVE  '7500'  TO  PT-CURR-PARA                           11012828
110129         PERFORM 6110-INTERNAL-TABLE                              11012928
110130     END-IF.                                                      11013028
110131                                                                  11013113
110132     IF PS-LOG-MESSAGE                                            11013213
110133         MOVE  SPACES              TO  PV-CICS-MSG-AREA           11013313
110134         STRING   ' SUKUT709 7500 '                               11013413
110135                                       DELIMITED BY SIZE          11013513
110136                                  INTO PV-CICS-MSG-AREA           11013613
110137         PERFORM 9999-WRITE-TO-CSSL                               11013713
110138     END-IF.                                                      11013813
110139                                                                  11013913
110140                                                                  11014000
110141* MS 06/18/2010 BEG                                               11014100
110150*                                                                 11015000
110200* TO MOVE THE OUTBOUND TRIP ID TO DK-TRIP-ID TO FETCH THE DOOR ID 11020000
110300* FOR THE PROCESSED FREIGHT.                                      11030000
110400                                                                  11040000
110410     IF PS-WHSE-TRIP-FOUND                                        11041000
110420        MOVE PV-WHSE-RPLN-TRIP-ID  TO DK-TRIP-ID                  11042000
110430*GB     MOVE PV-WHSE-TRIP-ID  TO DK-TRIP-ID                       11043000
110440     ELSE                                                         11044000
110450        MOVE SHUNLO-TRIP-ID   TO  DK-TRIP-ID                      11045000
110460     END-IF.                                                      11046000
110470*    MOVE SHUNLO-TRIP-ID   TO  DK-TRIP-ID.                        11047000
110480* MS 06/18/2010 END                                               11048000
110490                                                                  11049000
110491                                                                  11049122
110492     IF PS-LOG-MESSAGE                                            11049222
110493         MOVE  SPACES              TO  PV-CICS-MSG-AREA           11049322
110494         MOVE  DK-OPER-UNT-ID      TO  PV-DISP-OPER               11049422
110495         MOVE  DK-PNA-STA-NBR      TO  PV-DISP-PNA-STA            11049522
110496         MOVE  DK-TRIP-ID          TO  PV-DISP-TRIP               11049622
110497         STRING   ' SUKUT709 7500 '                               11049722
110498                  ' OPER:'             PV-DISP-OPER               11049822
110499                  ' STA:'              PV-DISP-PNA-STA            11049922
110500                  ' TRIP:'             PV-DISP-TRIP               11050022
110501                  ' DEFLT:'            PC-DEFAULT-TMST            11050122
110502                                       DELIMITED BY SIZE          11050222
110503                                  INTO PV-CICS-MSG-AREA           11050322
110504         PERFORM 9999-WRITE-TO-CSSL                               11050422
110505     END-IF                                                       11050522
110506                                                                  11050622
110507                                                                  11050722
110510     EXEC SQL                                                     11051022
110600         SELECT                                                   11060000
110700                 DOOR_ID                                          11070000
110800                ,CRE_BY_USR_ID                                    11080000
110900                ,ASGD_STRT_TMST                                   11090000
111000                                                                  11100000
111100           INTO                                                   11110000
111200                 :SUT00110-DOOR-ID                                11120000
111300                ,:SUT00110-CRE-BY-USR-ID                          11130000
111400                ,:SUT00110-ASGD-STRT-TMST                         11140000
111500                                                                  11150000
111600           FROM  SUT_PNA_TRIP_ASGMT                               11160000
111700          WHERE  OPER_UNT_ID          = :DK-OPER-UNT-ID           11170000
111800            AND  ACM_LBL_STA_NBR      = :DK-PNA-STA-NBR           11180000
111900            AND  INBD_TRIP_ID         = :DK-TRIP-ID               11190000
112000            AND  ASGD_END_TMST        = :PC-DEFAULT-TMST          11200000
112010           WITH UR                                                11201038
112100     END-EXEC.                                                    11210000
112200                                                                  11220000
112300     EVALUATE TRUE                                                11230000
112400         WHEN SQLCODE = ZERO                                      11240000
112500              SET PS-TRIP-SUT110-FOUND TO TRUE                    11250000
112600              SET PS-7500-PARA         TO TRUE                    11260000
112700              PERFORM 7600-SELECT-WORKER                          11270000
112800         WHEN SQLCODE = +100                                      11280000
112900              SET PS-TRIP-SUT110-NOT-FOUND TO TRUE                11290000
113000              MOVE SPACES TO SUT00111-WRKR-USR-ID                 11300000
113100         WHEN SQLWARN0 NOT = SPACES                               11310000
113200         WHEN SQLCODE NOT EQUAL ZERO                              11320000
113210              MOVE '7500'  TO  PV-CSSL-PARA                       11321026
113220              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  11322026
113230                                                                  11323026
113300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       11330000
113400             STRING   ' SUKUT709-7500-'                           11340000
113500                      ' CALLED BY-'                               11350000
113600                      SU092-VSM-PGM                               11360000
113700                      '  SQL:'                                    11370014
113800                      PV-DISPLAY-SQLCODE                          11380000
113900                      ' '                                         11390000
114000                      DELIMITED BY SIZE                           11400000
114100                                      INTO PV-CICS-MSG-AREA       11410000
114200             PERFORM 9999-WRITE-TO-CSSL                           11420000
114210                                                                  11421011
114310             PERFORM 9998-RETURN                                  11431000
114400     END-EVALUATE.                                                11440000
114510                                                                  11451022
114520     IF PS-LOG-MESSAGE                                            11452022
114530         MOVE  SPACES              TO  PV-CICS-MSG-AREA           11453022
114570         STRING   ' SUKUT709 7500 '                               11457022
114580                  ' DOOR:'             SUT00110-DOOR-ID           11458022
114590                  ' CRE:'              SUT00110-CRE-BY-USR-ID     11459022
114591                  ' ASGD:'             SUT00110-ASGD-STRT-TMST    11459122
114593                                       DELIMITED BY SIZE          11459322
114594                                  INTO PV-CICS-MSG-AREA           11459422
114595         PERFORM 9999-WRITE-TO-CSSL                               11459522
114596     END-IF.                                                      11459622
114597                                                                  11459722
114598                                                                  11459822
114599****************************************************************  11459940
114600* to see if there is an associate signed into the dual feed    *  11460040
114601* pna station in cics                                          *  11460140
114602* There is a trip assigned to at least 1 of the dual feed doors*  11460240
114603* but the sscc is not on either trailer                        *  11460340
114604* need to check if there is an associate assigned to one of    *  11460440
114605* of the doors at the dual feed pna station                    *  11460540
114606****************************************************************  11460640
114607 7510-SELECT-TRIP-WORKER.                                         11460740
114608                                                                  11460840
114609     IF  PS-BLD-INTERNAL-TABLE-YES                                11460940
114610         MOVE  '7510'  TO  PT-CURR-PARA                           11461040
114611         PERFORM 6110-INTERNAL-TABLE                              11461140
114612     END-IF.                                                      11461240
114613                                                                  11461340
114614     IF PS-LOG-MESSAGE                                            11461440
114615         MOVE  SPACES              TO  PV-CICS-MSG-AREA           11461540
114616         STRING   ' SUKUT709 7510 '                               11461640
114617                                       DELIMITED BY SIZE          11461740
114618                                  INTO PV-CICS-MSG-AREA           11461840
114619         PERFORM 9999-WRITE-TO-CSSL                               11461940
114620     END-IF.                                                      11462040
114621                                                                  11462140
114629                                                                  11462940
114630     IF PS-LOG-MESSAGE                                            11463040
114631         MOVE  SPACES              TO  PV-CICS-MSG-AREA           11463140
114632         MOVE  DK-OPER-UNT-ID      TO  PV-DISP-OPER               11463240
114633         MOVE  DK-PNA-STA-NBR      TO  PV-DISP-PNA-STA            11463340
114635         STRING   ' SUKUT709 7510 '                               11463540
114636                  ' OPER:'             PV-DISP-OPER               11463640
114637                  ' STA:'              PV-DISP-PNA-STA            11463740
114639                  ' DEFLT:'            PC-DEFAULT-TMST            11463940
114640                                       DELIMITED BY SIZE          11464040
114641                                  INTO PV-CICS-MSG-AREA           11464140
114642         PERFORM 9999-WRITE-TO-CSSL                               11464240
114643     END-IF                                                       11464340
114644                                                                  11464440
114645                                                                  11464540
114646     EXEC SQL                                                     11464640
114647         SELECT B.WRKR_USR_ID                                     11464740
114648           INTO :SUT00111-WRKR-USR-ID                             11464840
114649           FROM SUT_PNA_TRIP_ASGMT A                              11464940
114650              , SUT_PNA_STA_WRKR B                                11465040
114651          WHERE  A.OPER_UNT_ID          = :DK-OPER-UNT-ID         11465140
114652            AND  A.ACM_LBL_STA_NBR      = :DK-PNA-STA-NBR         11465241
114653            AND  A.ASGD_END_TMST        = :PC-DEFAULT-TMST        11465340
114654            AND  A.OPER_UNT_ID          = B.OPER_UNT_ID           11465440
114655            AND  A.ACM_LBL_STA_NBR      = B.ACM_LBL_STA_NBR       11465540
114656            AND  A.DOOR_ID              = B.DOOR_ID               11465640
114657            AND  A.INBD_TRIP_ID         = B.INBD_TRIP_ID          11465740
114658            AND  A.ASGD_STRT_TMST       = B.ASGD_STRT_TMST        11465840
114659            AND  B.WRKR_END_TMST        = :PC-DEFAULT-TMST        11465940
114662           ORDER BY A.ASGD_END_TMST DESC                          11466240
114663           FETCH FIRST 1 ROW ONLY                                 11466340
114664           WITH UR                                                11466440
114665     END-EXEC.                                                    11466540
114666                                                                  11466640
114667     EVALUATE TRUE                                                11466740
114668         WHEN SQLCODE = ZERO                                      11466840
114669              SET PS-WRKR-SUT111-FOUND TO TRUE                    11466940
114672         WHEN SQLCODE = +100                                      11467240
114673              SET PS-WRKR-SUT111-NOT-FOUND                        11467343
114674                  SU092-NO-USER-ID-FOUND   to TRUE                11467443
114675              MOVE SPACES TO SUT00111-WRKR-USR-ID                 11467543
114676         WHEN SQLWARN0 NOT = SPACES                               11467643
114677         WHEN SQLCODE NOT EQUAL ZERO                              11467743
114678              MOVE '7510'  TO  PV-CSSL-PARA                       11467843
114679              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  11467943
114680                                                                  11468043
114681             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       11468143
114682             STRING   ' SUKUT709-7510-'                           11468243
114683                      ' CALLED BY-'                               11468343
114684                      SU092-VSM-PGM                               11468443
114685                      '  SQL:'                                    11468543
114686                      PV-DISPLAY-SQLCODE                          11468643
114687                      ' '                                         11468743
114688                      DELIMITED BY SIZE                           11468843
114689                                      INTO PV-CICS-MSG-AREA       11468943
114690             PERFORM 9999-WRITE-TO-CSSL                           11469043
114691                                                                  11469143
114692             PERFORM 9998-RETURN                                  11469243
114693     END-EVALUATE.                                                11469343
114694                                                                  11469443
114695                                                                  11469546
114696     IF PS-LOG-MESSAGE                                            11469647
114697         MOVE  SPACES              TO  PV-CICS-MSG-AREA           11469743
114698         MOVE  DK-OPER-UNT-ID      TO  PV-DISP-OPER               11469846
114699         MOVE  DK-PNA-STA-NBR      TO  PV-DISP-PNA-STA            11469946
114700         STRING   ' SUKUT709 7510 '                               11470046
114701                  ' OPER:'             PV-DISP-OPER               11470146
114702                  ' STA:'              PV-DISP-PNA-STA            11470246
114703                  ' USER:'             SUT00111-WRKR-USR-ID       11470346
114704                                       DELIMITED BY SIZE          11470446
114705                                  INTO PV-CICS-MSG-AREA           11470546
114706         PERFORM 9999-WRITE-TO-CSSL                               11470646
114707                                                                  11470746
114715     END-IF.                                                      11471546
114716                                                                  11471646
114717                                                                  11471746
114718 7600-SELECT-WORKER.                                              11471846
114719                                                                  11471946
114720     IF  PS-BLD-INTERNAL-TABLE-YES                                11472046
114721         MOVE  '7600'  TO  PT-CURR-PARA                           11472146
114722         PERFORM 6110-INTERNAL-TABLE                              11472246
114723     END-IF.                                                      11472346
114724                                                                  11472446
114725     IF PS-LOG-MESSAGE                                            11472546
114726         MOVE  SPACES                 TO  PV-CICS-MSG-AREA        11472646
114727         EVALUATE TRUE                                            11472746
114728             WHEN PS-4200-PARA                                    11472846
114729                  MOVE SUT00110-INBD-TRIP-ID TO PV-DISP-TRIP      11472946
114730             WHEN PS-7500-PARA                                    11473046
114731                  MOVE DK-TRIP-ID            TO PV-DISP-TRIP      11473146
114732         END-EVALUATE                                             11473246
114733                                                                  11473346
114734         STRING   ' SUKUT709 7600 '                               11473446
114735                  ' TRIP:'             PV-DISP-TRIP               11473546
114736                  ' TMST:'             SUT00110-ASGD-STRT-TMST    11473646
114737                  ' DFLT:'             PC-DEFAULT-TMST            11473746
114738                  ' PARA:'             PS-PARAGRAPH-SW            11473846
114739                                       DELIMITED BY SIZE          11473946
114740                                  INTO PV-CICS-MSG-AREA           11474046
114741         PERFORM 9999-WRITE-TO-CSSL                               11474146
114742     END-IF.                                                      11474246
114743                                                                  11474346
114750                                                                  11475000
114800     EVALUATE TRUE                                                11480000
114900         WHEN PS-4200-PARA                                        11490000
115000              EXEC SQL                                            11500000
115100                  SELECT  WRKR_USR_ID                             11510000
115200                                                                  11520000
115300                    INTO  :SUT00111-WRKR-USR-ID                   11530000
115400                                                                  11540000
115500                    FROM  SUT_PNA_STA_WRKR                        11550000
115600                   WHERE  OPER_UNT_ID     = :DK-OPER-UNT-ID       11560000
115700                     AND  ACM_LBL_STA_NBR = :DK-PNA-STA-NBR       11570000
115800                     AND  DOOR_ID         = :SUT00110-DOOR-ID     11580000
115900                     AND  INBD_TRIP_ID    =                       11590000
116000                                        :SUT00110-INBD-TRIP-ID    11600000
116100                     AND ASGD_STRT_TMST   =                       11610000
116200                                        :SUT00110-ASGD-STRT-TMST  11620000
116300                     AND  WRKR_END_TMST   =                       11630000
116400                                        :PC-DEFAULT-TMST          11640000
116410                    WITH UR                                       11641038
116500              END-EXEC                                            11650000
116600              MOVE SUT00110-INBD-TRIP-ID TO PV-TRIP-ID-WORK       11660000
116700                                                                  11670000
116800         WHEN PS-7500-PARA                                        11680000
116900              EXEC SQL                                            11690000
117000                  SELECT  WRKR_USR_ID                             11700000
117100                                                                  11710000
117200                    INTO  :SUT00111-WRKR-USR-ID                   11720000
117300                                                                  11730000
117400                    FROM  SUT_PNA_STA_WRKR                        11740000
117500                   WHERE  OPER_UNT_ID     = :DK-OPER-UNT-ID       11750000
117600                     AND  ACM_LBL_STA_NBR = :DK-PNA-STA-NBR       11760000
117700                     AND  DOOR_ID         = :SUT00110-DOOR-ID     11770000
117800                     AND  INBD_TRIP_ID    = :DK-TRIP-ID           11780000
117900                     AND ASGD_STRT_TMST   =                       11790000
118000                                        :SUT00110-ASGD-STRT-TMST  11800000
118100                     AND  WRKR_END_TMST   =                       11810000
118200                                        :PC-DEFAULT-TMST          11820000
118210                    WITH UR                                       11821038
118300              END-EXEC                                            11830000
118400              MOVE DK-TRIP-ID            TO PV-TRIP-ID-WORK       11840000
118500     END-EVALUATE                                                 11850000
118600                                                                  11860000
118700     EVALUATE TRUE                                                11870000
118800         WHEN SQLCODE = ZERO                                      11880000
118900         WHEN SQLCODE = -811                                      11890000
119000              SET PS-WRKR-SUT111-FOUND TO TRUE                    11900000
119100         WHEN SQLCODE = +100                                      11910000
119200              SET PS-WRKR-SUT111-NOT-FOUND TO TRUE                11920000
120190                                                                  12019011
120200         WHEN SQLWARN0 NOT = SPACES                               12020000
120300         WHEN SQLCODE NOT EQUAL ZERO                              12030000
120310              MOVE '7600'  TO  PV-CSSL-PARA                       12031026
120320              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  12032026
120330                                                                  12033026
120400             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12040000
120410              MOVE DK-OPER-UNT-ID  TO  PV-DISP-OPER               12041011
120420              MOVE DK-PNA-STA-NBR  TO  PV-DISP-PNA-STA            12042011
120500             STRING   ' SUKUT709-7600-'                           12050000
120600                      ' CALLED BY-'                               12060000
120700                      SU092-VSM-PGM                               12070000
120800                      '  SQL:'                                    12080014
120900                      PV-DISPLAY-SQLCODE                          12090000
121000                      ' '                                         12100000
121100                      DELIMITED BY SIZE                           12110000
121200                                      INTO PV-CICS-MSG-AREA       12120000
121300             PERFORM 9999-WRITE-TO-CSSL                           12130000
121310                                                                  12131011
121320              MOVE SPACES TO PV-CICS-MSG-AREA                     12132011
121400             STRING   ' SUKUT709-7600-'                           12140000
121500                      '  STRT-'                                   12150000
121600                       SUT00110-ASGD-STRT-TMST                    12160000
121700                      ' '                                         12170000
121800                      DELIMITED BY SIZE                           12180000
121900                                      INTO PV-CICS-MSG-AREA       12190000
122000             PERFORM 9999-WRITE-TO-CSSL                           12200000
122010                                                                  12201011
122110             PERFORM 9998-RETURN                                  12211000
122200     END-EVALUATE.                                                12220000
122210                                                                  12221013
122220     IF PS-LOG-MESSAGE                                            12222013
122230         MOVE  SPACES              TO  PV-CICS-MSG-AREA           12223013
122231         MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE         12223116
122232         EVALUATE TRUE                                            12223222
122233             WHEN PS-4200-PARA                                    12223322
122234                  MOVE SUT00110-INBD-TRIP-ID                      12223422
122235                                    TO PV-DISP-TRIP               12223522
122236             WHEN PS-7500-PARA                                    12223622
122237                  MOVE DK-TRIP-ID   TO PV-DISP-TRIP               12223722
122238         END-EVALUATE                                             12223826
122239                                                                  12223922
122270         STRING   ' SUKUT709 7600 '                               12227013
122280                  ' TRIP:'             PV-DISP-TRIP               12228013
122281                  ' WRKR:'             SUT00111-WRKR-USR-ID       12228116
122282                  ' PARA:'             PS-PARAGRAPH-SW            12228216
122283                  ' SQL:'              PV-DISPLAY-SQLCODE         12228317
122290                  ' TMST:'             SUT00110-ASGD-STRT-TMST    12229013
122291                  ' DFLT:'             PC-DEFAULT-TMST            12229113
122295                                       DELIMITED BY SIZE          12229516
122296                                  INTO PV-CICS-MSG-AREA           12229616
122297         PERFORM 9999-WRITE-TO-CSSL                               12229716
122298     END-IF.                                                      12229816
122300                                                                  12230000
122400                                                                  12240000
122500 7700-SELECT-TSULBXF.                                             12250000
122501                                                                  12250128
122502     IF  PS-BLD-INTERNAL-TABLE-YES                                12250228
122503         MOVE  '7700'  TO  PT-CURR-PARA                           12250328
122504         PERFORM 6110-INTERNAL-TABLE                              12250428
122505     END-IF.                                                      12250528
122510                                                                  12251013
122520     IF PS-LOG-MESSAGE                                            12252013
122530         MOVE  SPACES              TO  PV-CICS-MSG-AREA           12253013
122540         STRING   ' SUKUT709 7700 '                               12254013
122550                                       DELIMITED BY SIZE          12255013
122560                                  INTO PV-CICS-MSG-AREA           12256013
122570         PERFORM 9999-WRITE-TO-CSSL                               12257013
122580     END-IF.                                                      12258013
122590                                                                  12259013
122600                                                                  12260000
122700     EXEC SQL                                                     12270000
122800        SELECT                                                    12280000
122900                A.TRIP_ID                                         12290000
123000          INTO                                                    12300000
123100                :SHUNLO-TRIP-ID                                   12310000
123200          FROM  TSHUNLO   A                                       12320000
123300               ,TSULBXF   B                                       12330000
123400         WHERE  B.BRCDE_NBR    = :DK-BAR-CODE-22                  12340000
123500           AND  A.SHIPT_UNT_ID =  B.SHIPT_UNT_ID                  12350000
123600           AND  A.SCN_LOC_ID   = :PC-RECV                         12360000
123610          WITH UR                                                 12361038
123700     END-EXEC.                                                    12370000
123800                                                                  12380000
123900     EVALUATE TRUE                                                12390000
124000         WHEN SQLCODE = ZERO                                      12400000
124100              SET PS-TSULBXF-TRIP-FOUND     TO TRUE               12410000
124200         WHEN SQLCODE = +100                                      12420000
124300              SET PS-TSULBXF-TRIP-NOT-FOUND TO TRUE               12430000
124400         WHEN SQLWARN0 NOT = SPACES                               12440000
124500         WHEN SQLCODE NOT EQUAL ZERO                              12450000
124501              MOVE '7700'  TO  PV-CSSL-PARA                       12450126
124502              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  12450226
124503                                                                  12450326
124504              MOVE SU092-KEY-DC-LOC      TO  PV-DISP-OPER         12450426
124505              MOVE SU092-KEY-ACM-STN-NBR TO  PV-DISP-PNA-STA      12450526
124506             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12450626
124507             STRING   ' SUKUT709-7700-'                           12450726
124508                      ' CALLED BY:'  SU092-VSM-PGM                12450826
124509                      '  SQL:'       PV-DISPLAY-SQLCODE           12450926
124510                      ' '  DK-BAR-CODE-22                         12451026
124520                      ' '  PV-DISP-OPER                           12452026
124530                      ' '  PV-DISP-PNA-STA                        12453026
124540                      DELIMITED BY SIZE                           12454026
124550                                      INTO PV-CICS-MSG-AREA       12455026
124560             PERFORM 9999-WRITE-TO-CSSL                           12456026
124570                                                                  12457026
125610             PERFORM 9998-RETURN                                  12561000
125700     END-EVALUATE.                                                12570000
125800                                                                  12580000
125801                                                                  12580122
125810     IF PS-LOG-MESSAGE                                            12581022
125820         MOVE  SPACES             TO  PV-CICS-MSG-AREA            12582022
125830         MOVE  SHUNLO-TRIP-ID     TO  PV-DISP-TRIP                12583022
125840         MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE           12584022
125850         STRING   ' SUKUT709 7700 '                               12585022
125860                  ' TRIP:'             PV-DISP-TRIP               12586022
125870                  ' SQL:'              PV-DISPLAY-SQLCODE         12587022
125880                                       DELIMITED BY SIZE          12588022
125890                                  INTO PV-CICS-MSG-AREA           12589022
125891         PERFORM 9999-WRITE-TO-CSSL                               12589122
125892     END-IF.                                                      12589222
125900                                                                  12590000
125910                                                                  12591022
126000 7900-SELECT-TSHUUPC.                                             12600000
126001                                                                  12600128
126002     IF  PS-BLD-INTERNAL-TABLE-YES                                12600228
126003         MOVE  '7900'  TO  PT-CURR-PARA                           12600328
126004         PERFORM 6110-INTERNAL-TABLE                              12600428
126005     END-IF.                                                      12600528
126010                                                                  12601013
126020     IF PS-LOG-MESSAGE                                            12602013
126030         MOVE  SPACES              TO  PV-CICS-MSG-AREA           12603013
126040         STRING   ' SUKUT709 7900 '                               12604013
126050                                       DELIMITED BY SIZE          12605013
126060                                  INTO PV-CICS-MSG-AREA           12606013
126070         PERFORM 9999-WRITE-TO-CSSL                               12607013
126080     END-IF.                                                      12608013
126090                                                                  12609013
126100                                                                  12610000
126200     MOVE DK-BAR-CODE-20      TO DK-SHIPT-UNT-ID.                 12620000
126300                                                                  12630000
126400     EXEC SQL                                                     12640000
126500        SELECT  DISTINCT                                          12650000
126600                B.PO_NBR                                          12660000
126700               ,B.ENT_ID                                          12670000
126800          INTO                                                    12680000
126900                :PURCHS-PO-NBR                                    12690000
127000               ,:PURCHS-ENT-ID                                    12700000
127100          FROM  TSHUUPC  A                                        12710000
127200               ,TPURCHS  B                                        12720000
127300         WHERE  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID               12730000
127400           AND  A.TRN_NBR        =  B.PO_NBR                      12740000
127500           AND  B.VER_STATUS_CDE = :PC-A                          12750000
127510          WITH UR                                                 12751015
127600     END-EXEC.                                                    12760000
127700                                                                  12770000
127800     EVALUATE TRUE                                                12780000
127900         WHEN SQLCODE = ZERO                                      12790000
128000              SET PS-128-CARTON-FOUND     TO TRUE                 12800000
128100              SET SU092-UCC128-FOUND      TO TRUE                 12810000
128200         WHEN SQLCODE = +100                                      12820000
128300              SET PS-128-CARTON-NOT-FOUND TO TRUE                 12830000
128400              SET SU092-UCC128-NOT-FOUND  TO TRUE                 12840000
128500         WHEN SQLWARN0 NOT = SPACES                               12850000
128600         WHEN SQLCODE NOT EQUAL ZERO                              12860000
128610              MOVE '7900'  TO  PV-CSSL-PARA                       12861026
128620              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  12862026
128630                                                                  12863026
128700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12870000
128710             MOVE  DK-SHIPT-UNT-ID    TO PV-DISP-SHIPT-UNT-ID     12871011
128800             STRING   ' SUKUT709-7900-'                           12880000
128900                      ' CALLED BY-'  SU092-VSM-PGM                12890011
129100                      '  SQL:'       PV-DISPLAY-SQLCODE           12910011
129300                      ' CART:'       PV-DISP-SHIPT-UNT-ID         12930011
129400                      DELIMITED BY SIZE                           12940000
129500                                      INTO PV-CICS-MSG-AREA       12950000
129600             PERFORM 9999-WRITE-TO-CSSL                           12960000
129610                                                                  12961011
129710             PERFORM 9998-RETURN                                  12971000
129800     END-EVALUATE.                                                12980000
129900                                                                  12990000
129910                                                                  12991022
129920     IF PS-LOG-MESSAGE                                            12992022
129930         MOVE  SPACES              TO  PV-CICS-MSG-AREA           12993022
129931         MOVE  SQLCODE             TO PV-DISPLAY-SQLCODE          12993122
129932         MOVE  DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID        12993222
129933         MOVE  PURCHS-PO-NBR       TO PV-DISP-PO                  12993322
129934         MOVE  PURCHS-ENT-ID       TO PV-DISP-ENTID               12993422
129940         STRING   ' SUKUT709 7900 '                               12994022
129950                                       DELIMITED BY SIZE          12995022
129960                                  INTO PV-CICS-MSG-AREA           12996022
129970         PERFORM 9999-WRITE-TO-CSSL                               12997022
129980     END-IF.                                                      12998022
129990                                                                  12999022
130000                                                                  13000000
130100 8100-SELECT-TSHPUNT.                                             13010000
130101                                                                  13010128
130102     IF  PS-BLD-INTERNAL-TABLE-YES                                13010228
130103         MOVE  '8100'  TO  PT-CURR-PARA                           13010328
130104         PERFORM 6110-INTERNAL-TABLE                              13010428
130105     END-IF.                                                      13010528
130110                                                                  13011013
130120     IF PS-LOG-MESSAGE                                            13012013
130130         MOVE  SPACES                TO  PV-CICS-MSG-AREA         13013022
130131         MOVE  PURCHS-PO-NBR         TO  PV-DISP-PO               13013122
130132         MOVE  SUT00110-INBD-TRIP-ID TO  PV-DISP-TRIP             13013222
130133         MOVE  DK-SHIPT-UNT-ID       TO  PV-DISP-SSCC             13013322
130140         STRING   ' SUKUT709 8100 '                               13014013
130141                  ' PO:'                 PV-DISP-TRIP             13014122
130142                  ' TRIP:'               PV-DISP-TRIP             13014222
130143                  ' SSCC:'               PV-DISP-SSCC             13014322
130150                                         DELIMITED BY SIZE        13015022
130160                                   INTO  PV-CICS-MSG-AREA         13016022
130170         PERFORM 9999-WRITE-TO-CSSL                               13017013
130180     END-IF.                                                      13018013
130190                                                                  13019013
130200                                                                  13020000
130300     MOVE PURCHS-PO-NBR   TO DK-PO-NBR.                           13030000
130400                                                                  13040000
130500     EXEC SQL                                                     13050000
130600        SELECT  DISTINCT                                          13060000
130700                A.TRIP_ID                                         13070000
130800          INTO                                                    13080000
130900                :VHTRIP-TRIP-ID                                   13090000
131000          FROM   TVHTRIP    A                                     13100000
131100                ,TSHIPMT    B                                     13110000
131200                ,TSHPTPO    C                                     13120000
131300                ,TRECEIV    D                                     13130000
131400                ,TPKSLIP    E                                     13140000
131500                ,TINPKSU    F                                     13150000
131600                ,TSHPUNT    G                                     13160000
131800          WHERE  A.TRIP_ID        = :SUT00110-INBD-TRIP-ID        13180000
131900            AND  A.TRIP_ID        =  B.TRIP_ID                    13190000
132000            AND  C.SHIPT_ID       =  B.SHIPT_ID                   13200000
132100            AND  C.PO_NBR         = :DK-PO-NBR                    13210000
132200            AND  C.PO_NBR         =  D.ORD_NBR                    13220000
132300            AND  C.REC_SEQ_NBR    =  D.REC_SEQ_NBR                13230000
132400            AND  D.VER_STATUS_CDE = :PC-A                         13240000
132500            AND  E.VER_STAT_CDE   = :PC-A                         13250000
132600            AND  C.PO_NBR         =  E.PO_NBR                     13260000
132700            AND  C.REC_SEQ_NBR    =  E.REC_SEQ_NBR                13270000
132800            AND  E.PO_NBR         =  F.PO_NBR                     13280000
132900            AND  E.SEQ_NBR        =  F.SEQ_NBR                    13290000
133000            AND  F.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID              13300000
133100            AND  F.SHIPT_UNT_ID   =  G.SHIPT_UNT_ID               13310000
133110           WITH UR                                                13311038
133200     END-EXEC.                                                    13320000
133300                                                                  13330000
133400     EVALUATE TRUE                                                13340000
133500         WHEN SQLCODE = ZERO                                      13350000
133600              SET PS-TSHPUNT-TRIP-FOUND TO TRUE                   13360000
133700         WHEN SQLCODE = +100                                      13370000
133800              SET PS-TSHPUNT-TRIP-NOT-FOUND TO TRUE               13380000
133900         WHEN SQLWARN0 NOT = SPACES                               13390000
134000         WHEN SQLCODE NOT EQUAL ZERO                              13400000
134010              MOVE '8100'  TO  PV-CSSL-PARA                       13401026
134020              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  13402026
134030                                                                  13403026
134100             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       13410000
134200             STRING   ' SUKUT709-8100-'                           13420000
134300                      ' CALLED BY-'                               13430000
134400                      SU092-VSM-PGM                               13440000
134500                      '  SQL:'                                    13450014
134600                      PV-DISPLAY-SQLCODE                          13460000
134700                      ' '                                         13470000
134800                      DELIMITED BY SIZE                           13480000
134900                                      INTO PV-CICS-MSG-AREA       13490000
135000             PERFORM 9999-WRITE-TO-CSSL                           13500000
135010                                                                  13501011
135110             PERFORM 9998-RETURN                                  13511000
135200     END-EVALUATE.                                                13520000
135300                                                                  13530000
135310                                                                  13531022
135320     IF PS-LOG-MESSAGE                                            13532022
135330         MOVE  SPACES                TO  PV-CICS-MSG-AREA         13533022
135340         MOVE  SQLCODE               TO  PV-DISPLAY-SQLCODE       13534022
135370         STRING   ' SUKUT709 8100 '                               13537022
135380                  ' SQL:'                PV-DISPLAY-SQLCODE       13538022
135390                  ' FOUND:'              PS-TSHPUNT-TRIP-SW       13539026
135392                                         DELIMITED BY SIZE        13539222
135393                                   INTO  PV-CICS-MSG-AREA         13539322
135394         PERFORM 9999-WRITE-TO-CSSL                               13539422
135395     END-IF.                                                      13539522
135396                                                                  13539622
135400                                                                  13540000
135500 8300-SELECT-TSHPTPO.                                             13550000
135501                                                                  13550128
135502     IF  PS-BLD-INTERNAL-TABLE-YES                                13550228
135503         MOVE  '8300'  TO  PT-CURR-PARA                           13550328
135504         PERFORM 6110-INTERNAL-TABLE                              13550428
135505     END-IF.                                                      13550528
135510                                                                  13551013
135520     IF PS-LOG-MESSAGE                                            13552013
135530         MOVE  SPACES              TO  PV-CICS-MSG-AREA           13553013
135540         STRING   ' SUKUT709 8300 '                               13554013
135550                                       DELIMITED BY SIZE          13555013
135560                                  INTO PV-CICS-MSG-AREA           13556013
135570         PERFORM 9999-WRITE-TO-CSSL                               13557013
135580     END-IF.                                                      13558013
135590                                                                  13559013
135600                                                                  13560000
135700     MOVE TBL-TRIP-ID (PV-TBL-SUB) TO DK-TRIP-ID.                 13570000
135800     MOVE PURCHS-PO-NBR            TO DK-PO-NBR.                  13580000
135900                                                                  13590000
136000     EXEC SQL                                                     13600000
136100        SELECT   DISTINCT                                         13610000
136200                 C.PO_NBR                                         13620000
136300          INTO                                                    13630000
136400                :SHPTPO-PO-NBR                                    13640000
136500          FROM   TVHTRIP  A                                       13650000
136600                ,TSHIPMT  B                                       13660000
136700                ,TSHPTPO  C                                       13670000
136800                ,TPKSLIP  D                                       13680000
136900          WHERE  A.TRIP_ID        = :DK-TRIP-ID                   13690000
137000            AND  A.TRIP_ID        =  B.TRIP_ID                    13700000
137100            AND  C.SHIPT_ID       =  B.SHIPT_ID                   13710000
137200            AND  C.PO_NBR         = :DK-PO-NBR                    13720000
137300            AND  C.PO_NBR         =  D.PO_NBR                     13730000
137400            AND  C.REC_SEQ_NBR    =  D.REC_SEQ_NBR                13740000
137500            AND  D.VER_STAT_CDE   = 'A'                           13750000
137600            AND  D.PKSL_STAT_CDE  = 'AC'                          13760000
137610           WITH UR                                                13761038
137700     END-EXEC.                                                    13770000
137800                                                                  13780000
137900     EVALUATE TRUE                                                13790000
138000         WHEN SQLCODE = ZERO                                      13800000
138100              SET PS-TSHPTPO-PO-FOUND TO TRUE                     13810000
138200         WHEN SQLCODE = +100                                      13820000
138300              SET PS-TSHPTPO-PO-NOT-FOUND TO TRUE                 13830000
138400         WHEN SQLWARN0 NOT = SPACES                               13840000
138500         WHEN SQLCODE NOT EQUAL ZERO                              13850000
138510              MOVE '8300'  TO  PV-CSSL-PARA                       13851026
138520              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  13852026
138530                                                                  13853026
138600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       13860000
138700             STRING   ' SUKUT709-8300-'                           13870000
138800                      ' CALLED BY-'                               13880000
138900                      SU092-VSM-PGM                               13890000
139000                      '  SQL:'                                    13900014
139100                      PV-DISPLAY-SQLCODE                          13910000
139200                      ' '                                         13920000
139300                      DELIMITED BY SIZE                           13930000
139400                                      INTO PV-CICS-MSG-AREA       13940000
139500             PERFORM 9999-WRITE-TO-CSSL                           13950000
139510                                                                  13951011
139600             PERFORM 9998-RETURN                                  13960000
139700     END-EVALUATE.                                                13970000
139800                                                                  13980000
139900                                                                  13990000
140000 8500-SELECT-TPURCHS.                                             14000000
140100                                                                  14010028
140101     IF  PS-BLD-INTERNAL-TABLE-YES                                14010128
140102         MOVE  '8500'  TO  PT-CURR-PARA                           14010228
140103         PERFORM 6110-INTERNAL-TABLE                              14010328
140104     END-IF.                                                      14010428
140110                                                                  14011013
140120     IF PS-LOG-MESSAGE                                            14012013
140130         MOVE  SPACES              TO  PV-CICS-MSG-AREA           14013013
140140         STRING   ' SUKUT709 8500 '                               14014013
140150                                       DELIMITED BY SIZE          14015013
140160                                  INTO PV-CICS-MSG-AREA           14016013
140170         PERFORM 9999-WRITE-TO-CSSL                               14017013
140180     END-IF.                                                      14018013
140190                                                                  14019013
140200     MOVE TBL-TRIP-ID (PV-TBL-SUB) TO DK-TRIP-ID.                 14020000
140300     MOVE PURCHS-ENT-ID            TO DK-ENT-ID.                  14030000
140400                                                                  14040000
140500     EXEC SQL                                                     14050000
140600        SELECT  DISTINCT                                          14060000
140700                D.ENT_ID                                          14070000
140800          INTO                                                    14080000
140900                :PURCHS-ENT-ID                                    14090000
141000          FROM   TVHTRIP   A                                      14100000
141100                ,TSHIPMT   B                                      14110000
141200                ,TSHPTPO   C                                      14120000
141300                ,TPURCHS   D                                      14130000
141400                ,TPKSLIP   E                                      14140000
141500          WHERE  A.TRIP_ID        = :DK-TRIP-ID                   14150000
141600            AND  A.TRIP_ID        =  B.TRIP_ID                    14160000
141700            AND  C.SHIPT_ID       =  B.SHIPT_ID                   14170000
141800            AND  C.PO_NBR         =  D.PO_NBR                     14180000
141900            AND  C.PO_NBR         =  E.PO_NBR                     14190000
142000            AND  C.REC_SEQ_NBR    =  E.REC_SEQ_NBR                14200000
142100            AND  D.ENT_ID         = :DK-ENT-ID                    14210000
142200            AND  D.VER_STATUS_CDE = :PC-A                         14220000
142300            AND  E.VER_STAT_CDE   = :PC-A                         14230000
142400            AND  E.PKSL_STAT_CDE  = 'AC'                          14240000
142410           WITH UR                                                14241038
142500     END-EXEC.                                                    14250000
142600                                                                  14260000
142700     EVALUATE TRUE                                                14270000
142800         WHEN SQLCODE = ZERO                                      14280000
142900              SET PS-TPURCHS-ENT-FOUND     TO TRUE                14290000
143000         WHEN SQLCODE = +100                                      14300000
143100              SET PS-TPURCHS-ENT-NOT-FOUND TO TRUE                14310000
143200         WHEN SQLWARN0 NOT = SPACES                               14320000
143300         WHEN SQLCODE NOT EQUAL ZERO                              14330000
143310              MOVE '8500'  TO  PV-CSSL-PARA                       14331026
143320              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  14332026
143330                                                                  14333026
143400             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       14340000
143500             STRING   ' SUKUT709-8500-'                           14350000
143600                      ' CALLED BY-'                               14360000
143700                      SU092-VSM-PGM                               14370000
143800                      '  SQL:'                                    14380014
143900                      PV-DISPLAY-SQLCODE                          14390000
144000                      ' '                                         14400000
144100                      DELIMITED BY SIZE                           14410000
144200                                      INTO PV-CICS-MSG-AREA       14420000
144300             PERFORM 9999-WRITE-TO-CSSL                           14430000
144310                                                                  14431011
144410             PERFORM 9998-RETURN                                  14441000
144500     END-EVALUATE.                                                14450000
144600                                                                  14460000
144700                                                                  14470000
144800 8700-INSERT-TRIP-MATCH-LEVEL.                                    14480000
144801                                                                  14480128
144802     IF  PS-BLD-INTERNAL-TABLE-YES                                14480228
144803         MOVE  '8700'  TO  PT-CURR-PARA                           14480328
144804         PERFORM 6110-INTERNAL-TABLE                              14480428
144805     END-IF.                                                      14480528
144810                                                                  14481013
144820     IF PS-LOG-MESSAGE                                            14482013
144830         MOVE  SPACES              TO  PV-CICS-MSG-AREA           14483013
144840         STRING   ' SUKUT709 8700 '                               14484013
144850                                       DELIMITED BY SIZE          14485013
144860                                  INTO PV-CICS-MSG-AREA           14486013
144870         PERFORM 9999-WRITE-TO-CSSL                               14487013
144880     END-IF.                                                      14488013
144890                                                                  14489013
144900                                                                  14490000
145000     MOVE DK-SHIPT-UNT-ID         TO SUT00112-SHIPT-UNT-ID.       14500000
145100     MOVE SU092-KEY-DC-LOC        TO SUT00112-OPER-UNT-ID.        14510000
145200     MOVE SU092-KEY-ACM-STN-NBR   TO SUT00112-ACM-LBL-STA-NBR.    14520000
145300                                                                  14530000
145400     IF PS-INSERT-TBL-SU092                                       14540000
145500        MOVE SU092-DOOR-ID           TO SUT00112-DOOR-ID          14550000
145600        MOVE SU092-TRIP-ID           TO SUT00112-INBD-TRIP-ID     14560000
145700        MOVE SU092-USER-ID           TO SUT00112-CRE-BY-USR-ID    14570000
145800        MOVE TBL-ASGD-STRT-TMST (PV-TBL-SUB) TO                   14580000
145900                                        SUT00112-ASGD-STRT-TMST   14590000
146000     ELSE                                                         14600000
146100        MOVE TBL-DOOR-ID (1)         TO SUT00112-DOOR-ID          14610000
146200                                        SU092-DOOR-ID             14620000
146300        MOVE TBL-TRIP-ID (1)         TO SUT00112-INBD-TRIP-ID     14630000
146400                                        SU092-TRIP-ID             14640000
146500        MOVE TBL-USER-ID (1)         TO SUT00112-CRE-BY-USR-ID    14650000
146600                                        SU092-USER-ID             14660000
146700        MOVE TBL-ASGD-STRT-TMST (1)  TO SUT00112-ASGD-STRT-TMST   14670000
146800     END-IF.                                                      14680000
146900                                                                  14690000
147000     MOVE PV-CART-MTCH-CDE  TO SUT00112-CART-MTCH-CDE.            14700000
147100                                                                  14710000
147110                                                                  14711044
147120     IF PS-LOG-MESSAGE                                            14712044
147130         MOVE  SPACES              TO  PV-CICS-MSG-AREA           14713044
147140         STRING   ' SUKUT709 8700 '                               14714044
147150                  ' PNA TRIP:'         SU092-PRNT-N-APP-TRIP-IND  14715044
147160                  ' PNA USER:'         SU092-PRNT-N-APP-USER-IND  14716044
147170                                       DELIMITED BY SIZE          14717044
147180                                  INTO PV-CICS-MSG-AREA           14718044
147190         PERFORM 9999-WRITE-TO-CSSL                               14719044
147191     END-IF                                                       14719144
147192                                                                  14719244
147200                                                                  14720000
147300     EXEC SQL                                                     14730000
147400         INSERT                                                   14740000
147500           INTO  SUT_TRIP_MTCH_LVL                                14750000
147600               (                                                  14760000
147700                 SHIPT_UNT_ID                                     14770000
147800                ,CRE_MTCH_TMST                                    14780000
147900                ,OPER_UNT_ID                                      14790000
148000                ,ACM_LBL_STA_NBR                                  14800000
148100                ,DOOR_ID                                          14810000
148200                ,INBD_TRIP_ID                                     14820000
148300                ,ASGD_STRT_TMST                                   14830000
148400                ,CART_MTCH_CDE                                    14840000
148500                ,CRE_BY_USR_ID                                    14850000
148600                )                                                 14860000
148700                                                                  14870000
148800        VALUES (                                                  14880000
148900                 :SUT00112-SHIPT-UNT-ID                           14890000
149000                , CURRENT TIMESTAMP                               14900000
149100                ,:SUT00112-OPER-UNT-ID                            14910000
149200                ,:SUT00112-ACM-LBL-STA-NBR                        14920000
149300                ,:SUT00112-DOOR-ID                                14930000
149400                ,:SUT00112-INBD-TRIP-ID                           14940000
149500                ,:SUT00112-ASGD-STRT-TMST                         14950000
149600                ,:SUT00112-CART-MTCH-CDE                          14960000
149700                ,:SUT00112-CRE-BY-USR-ID                          14970000
149800                )                                                 14980000
149900                                                                  14990000
150000     END-EXEC.                                                    15000000
150100                                                                  15010000
150200     EVALUATE TRUE                                                15020000
150300         WHEN SQLCODE = ZERO                                      15030000
150400              CONTINUE                                            15040000
150500         WHEN SQLWARN0 NOT = SPACES                               15050000
150600         WHEN SQLCODE NOT EQUAL ZERO                              15060000
150610              MOVE '8700'  TO  PV-CSSL-PARA                       15061026
150620              PERFORM 6100-WRITE-SUWS092-TO-CSSL                  15062026
150630                                                                  15063026
150700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       15070000
150800             STRING   ' SUKUT709-8700-'                           15080000
150900                      ' CALLED BY-'                               15090000
151000                      SU092-VSM-PGM                               15100000
151100                      '  SQL:'                                    15110014
151200                      PV-DISPLAY-SQLCODE                          15120000
151300                      ' '                                         15130000
151400                      DELIMITED BY SIZE                           15140000
151500                                      INTO PV-CICS-MSG-AREA       15150000
151600             PERFORM 9999-WRITE-TO-CSSL                           15160000
151610                                                                  15161011
151710             PERFORM 9998-RETURN                                  15171015
151720                                                                  15172015
151800     END-EVALUATE.                                                15180000
151900                                                                  15190000
152000                                                                  15200000
152100*-----------------------------------------------------------------15210000
152200*  RETURN TO CALLING PROGRAM                                      15220000
152300*-----------------------------------------------------------------15230000
152400 9998-RETURN.                                                     15240000
152500                                                                  15250000
152600     MOVE SQLCA                         TO SU092-SQLCA            15260000
152700                                           PV-CICS-MSG-AREA.      15270000
152800     PERFORM 9999-WRITE-TO-CSSL.                                  15280000
152900     MOVE SU092-ITEM-COMMAREA           TO DFHCOMMAREA.           15290000
153000                                                                  15300000
153100     EXEC CICS                                                    15310000
153200          RETURN                                                  15320000
153300     END-EXEC.                                                    15330000
153400                                                                  15340000
153500*-----------------------------------------------------------------15350000
153600 9999-WRITE-TO-CSSL.                                              15360000
153700*-----------------------------------------------------------------15370000
153800     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      15380000
153900                                                                  15390000
154000     EXEC CICS                                                    15400000
154100          WRITEQ TD                                               15410000
154200           QUEUE   ('CSSL')                                       15420000
154300            FROM   (PV-CICS-MSG-AREA)                             15430000
154400          LENGTH   (PV-COMMAREA-LENGTH)                           15440000
154500            RESP   (PV-CICS-RESPONSE)                             15450000
154600     END-EXEC.                                                    15460000
154700                                                                  15470000
