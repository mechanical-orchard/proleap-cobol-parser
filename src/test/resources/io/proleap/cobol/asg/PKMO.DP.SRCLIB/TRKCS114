000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    TRKCS114.                                         00020000
000300 AUTHOR.        TOM RUSKA.                                        00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  12-22-93.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    Y114 - TRAILER SHIPMENT LIST.                              * 00090000
001000*                                                               * 00100000
001100*    THIS PROGRAM WILL GENERATE A LIST OF SHIPMENTS THAT HAVE   * 00110000
001200*    ALREADY BEEN SET UP FOR A SPECIFIC TRAILER.                * 00120000
001300*                                                               * 00130000
001400*---------------------------------------------------------------* 00140000
001500* CHANGED 12-02-2011 CHRSITINE TWIEHAUS      WR40574            * 00150000
001600*         ADDED CARR_AUTH_ID (CAN)                              * 00160000
001700*                                                               * 00170000
001800*---------------------------------------------------------------* 00180000
001900* CHANGED 10-27-2014 CHERI PARMLEY           CHG0094517         * 00190000
002000*         RE-COMPILE ONLY - TRWS001 CHANGED TO EXPAND PO# TO 9  * 00200000
002100*         DIGITS                                                * 00210000
001900* CHANGED 03-2021    JEAN KURK                                  * 00211012
002000*         REMOVE TABLE TFLSCHD                                  * 00212012
002200*---------------------------------------------------------------* 00220000
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00222013
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00223013
263697* MAKING THE CALL DYNAMIC VS STATIC.                              00224013
263697*---------------------------------------------------------------* 00225013
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00226014
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00227014
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00228014
CICS  *-----------------------------------------------------------------00229014
002300/                                                                 00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500                                                                  00250000
002600 DATA DIVISION.                                                   00260000
002700                                                                  00270000
002800 WORKING-STORAGE SECTION.                                         00280000
002900                                                                  00290000
003000 01  DK-DB2-KEYS.                                                 00300000
003100     05  DK-DEST-OPER-UNT-ID-B     PIC S9(4) COMP VALUE +0.       00310000
003200     05  DK-DEST-FCLTY-ID-B        PIC S9(4) COMP VALUE +0.       00320000
003300     05  DK-OWNER-SCAC-ID-B        PIC X(04) VALUE SPACES.        00330000
003400     05  DK-VEH-NBR-B              PIC X(10) VALUE SPACES.        00340000
003500     05  DK-PRO-SCAC-ID-B          PIC X(04) VALUE SPACES.        00350000
003600     05  DK-PRO-NBR-B              PIC X(16) VALUE SPACES.        00360000
003700     05  DK-BOL-NBR-B              PIC X(16) VALUE SPACES.        00370000
003800     05  DK-SHIPT-ID               PIC S9(9) COMP VALUE +0.       00380000
003900     05  DK-TRIP-ID                PIC S9(9) COMP VALUE +0.       00390000
004000                                                                  00400000
004100 01  DN-NULL-INDICATORS.                                          00410000
004200     05  DN-SUBAREA-OF-ID          PIC S9(4) COMP VALUE +0.       00420000
004300     05  DN-EST-AR-TMST               PIC S9(04) COMP VALUE +0.   00430000
004400     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   00440000
004500     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00450000
004600                                                                  00460000
004700 01  PC-PROGRAM-CONSTANTS.                                        00470000
004800     05  PC-1                           PIC S9(03)  VALUE +1      00480000
004900                                                    COMP-3.       00490000
005000     05  PC-7D                          PIC  X(01)  VALUE X'7D'.  00500000
005100     05  PC-49                          PIC  X(02)  VALUE  '49'.  00510000
005200     05  PC-EN                          PIC  X(02)  VALUE  'EN'.  00520000
005300     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00530000
005400                                                    'TR114A  '.   00540000
005500     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00550000
005600                                                    'TRKM114 '.   00560000
005700     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00570000
005800                                                    'TRKCS114'.   00580000
005900     05  PC-RANDNBR-PGM                 PIC X(08)   VALUE         00590000
005901                                                    'DPKUT902'.   00590109
005902     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00590200
005903     05  PC-WMS-CONTROL-MOD-LENGTH    PIC S9(4) VALUE +125        00590300
005904                                                COMP SYNC.        00590400
005905     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00590500
005906                                                    COMP.         00590600
005907     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00590700
005908     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00590800
005909     05  PC-INTER-APPL-CODES.                                     00590900
005910         10 PC-INTER-APPL-CRIT-SPEC     PIC  X(01)  VALUE '1'.    00591000
005920         10 PC-INTER-APPL-LIST          PIC  X(01)  VALUE '5'.    00592000
005930         10 PC-INTER-APPL-OPEN-SHIP     PIC  X(01)  VALUE '6'.    00593000
005940     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     00594000
005950                                                    COMP SYNC.    00595000
005960     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00596000
005970                                                    COMP SYNC.    00597000
005980     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00598000
005990                                                    +1000000      00599000
006000                                                    COMP-3.       00600000
006100     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00610000
006200                                                    COMP SYNC.    00620000
006300     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00630000
006400                                                    COMP-3.       00640000
006500     05  PC-DEFAULT-TMST                PIC  X(26)  VALUE         00650000
006600                                   '0001-01-01-00.00.00.000000'.  00660000
006700     05  PC-DEFAULT-TMST-9S             PIC  X(26)  VALUE         00670000
006800                                   '9999-09-09-09.09.09.999999'.  00680000
006900     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00690000
007000                                                 '0001-01-01'.    00700000
007100     05  PC-DEFAULT-TIME              PIC X(08)  VALUE            00710000
007200                                                 '00.00.00'.      00720000
007300     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00730000
007400     05  PC-ADD                         PIC  X(03)  VALUE 'ADD'.  00740000
007500     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00750000
007600     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00760000
007700     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00770000
007800     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00780000
007900                                                                  00790000
007910*---------------------------------------------------------------* 00791000
007911* 00005-INVALID VALUE                                           * 00791100
007920* 00007-REQUIRED ENTRY                                          * 00792000
007922* 00008-MUST BE NUMERIC                                         * 00792200
007923* 00014-YOU ARE NOT AUTHORIZED FOR THE SPECIFIED DEPARTMENT     * 00792300
007924* 00017-STORE DOES NOT EXIST                                    * 00792400
007925* 00047-ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION    * 00792500
007926* 00050-NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED     * 00792600
007927* 00051-NO END OF RANGE HAS BEEN SPECIFIED                      * 00792700
007928* 00052-END OF RANGE PRECEDES START OF RANGE                    * 00792800
007929* 00053-NO START OF RANGE HAS BEEN SPECIFIED                    * 00792900
007930* 00054-ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED      * 00793000
007931* 00055-ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED        * 00793100
007932* 00057-A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          * 00793200
007933* 00059-UPDATE(S) SUCCESSFUL                                    * 00793300
007934* 00069-TOP OF LIST                                             * 00793400
007935* 00070-BOTTOM OF LIST                                          * 00793500
007936* 00083-PURCHASE ORDER DOES NOT EXIST                           * 00793600
007937* 00101-VALUE MUST BE GREATER THAN ZERO AND LESS THAN 100,000,0 * 00793700
007938* 00146-SELECTION NOT VALID FOR REQUESTED FUNCTION              * 00793800
007939* 00168-INVALID PURCHASE ORDER STATUS FOR THIS FUNCTION         * 00793900
007941* 00279-MORE ITEMS TO DISPLAY                                   * 00794100
007942* 00310-CLASS IS REQUIRED IF A SKU RANGE IS SPECIFIED           * 00794200
007943* 00330-ENTRY OF A FIELD REQUIRED FOR FUNCTION SELECTED         * 00794300
007944* 00338-STATUS CODE IS REQUIRED                                 * 00794400
007945* 00486-DEPARTMENT NUMBER IS REQUIRED FOR SELECTED FUNCTION     * 00794500
007946* 00587-INVALID PURCHASE ORDER TYPE CODE FOR THIS FUNCTION      * 00794600
007947* 00588-INVALID DEPARTMENT NUMBER                               * 00794700
007948* 00643-SPECIFY EITHER DOCK OR PARKING LOCATION BUT NOT BOTH    * 00794800
007949* 00649-SPECIFY DEL. SCAC OR F/B SCAC BUT NOT BOTH              * 00794900
007950* 00983-OPERATING UNIT, FACILITY ID, AND SCAC ARE REQUIRED      * 00795000
007951* 01061-USER IS NOT AUTHORIZED                                  * 00795100
007952* 03543-RECEIVING HAS BEGUN ON TRAILER, UNABLE TO DETACH SHIPME * 00795200
007953* 03546-ERROR IN WMS DOWNLOAD MODULE - CONTACT HELP DESK        * 00795300
007954* 03561-SHIPMENT DETACHED, UPDATES WILL BE DOWNLOADED TO WMS    * 00795400
007955* 03761-SELECTED SHIPMENT WILL BE DETACHED. PRESS F2 TO CONFIRM * 00795500
007970*---------------------------------------------------------------* 00797000
008000     05  PC-TSYMSG-NUMBERS.                                       00800000
008100         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00810000
008200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00820000
008300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00830000
008400         10  PC-TSYMSG-00014            PIC  9(05)  VALUE 00014.  00840000
008500         10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  00850000
008600         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00860000
008700         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00870000
008800         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00880000
008900         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00890000
009000         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00900000
009100         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00910000
009200         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00920000
009300         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00930000
009400         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  00940000
009500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00950000
009600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00960000
009700         10  PC-TSYMSG-00083            PIC  9(05)  VALUE 00083.  00970000
009800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00980000
009900         10  PC-TSYMSG-00168            PIC  9(05)  VALUE 00168.  00990000
010000         10  PC-TSYMSG-00146            PIC  9(05)  VALUE 00146.  01000000
010100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01010000
010200         10  PC-TSYMSG-00310            PIC  9(05)  VALUE 00310.  01020000
010300         10  PC-TSYMSG-00330            PIC  9(05)  VALUE 00330.  01030000
010400         10  PC-TSYMSG-00338            PIC  9(05)  VALUE 00338.  01040000
010500         10  PC-TSYMSG-00486            PIC  9(05)  VALUE 00486.  01050000
010600         10  PC-TSYMSG-00587            PIC  9(05)  VALUE 00587.  01060000
010700         10  PC-TSYMSG-00588            PIC  9(05)  VALUE 00588.  01070000
010800         10  PC-TSYMSG-00643            PIC  9(05)  VALUE 00643.  01080000
010900         10  PC-TSYMSG-00649            PIC  9(05)  VALUE 00649.  01090000
011000         10  PC-TSYMSG-00983            PIC  9(05)  VALUE 00983.  01100000
011100         10  PC-TSYMSG-01061            PIC  9(05)  VALUE 01061.  01110000
011200         10  PC-TSYMSG-03543            PIC  9(05)  VALUE 03543.  01120000
011300*RECEIVING HAS BEGUN ON TRAILER, UNABLE TO DETACH SHIPMENT        01130000
011400         10  PC-TSYMSG-03546            PIC  9(05)  VALUE 03546.  01140000
011500*ERROR IN WMS DOWNLOAD MODULE - CONTACT HELP DESK                 01150000
011600*JAK 08/2007 - ADD NEW MESSAGE                                    01160000
011700         10  PC-TSYMSG-03561            PIC  9(05)  VALUE 03561.  01170000
011710****PRB0044536 START                                              01171000
011720         10  PC-TSYMSG-03761            PIC  9(05)  VALUE 03761.  01172000
011730****PRB0044536 END                                                01173000
011800                                                                  01180000
011900                                                                  01190000
012000 01  PS-PROGRAM-SWITCHES.                                         01200000
012100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01210000
012200         88  PS-NO-ERROR                            VALUE 'Y'.    01220000
012300         88  PS-ERROR                               VALUE 'N'.    01230000
012400     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01240000
012500         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01250000
012600         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01260000
012700     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01270000
012800         88  PS-DONE                                VALUE 'Y'.    01280000
012900         88  PS-NOT-DONE                            VALUE 'N'.    01290000
013000     05  PS-END-OF-STATUS-CURSOR-SW     PIC  X(01)  VALUE 'N'.    01300000
013100         88  PS-END-OF-STATUS-CURSOR                VALUE 'Y'.    01310000
013200         88  PS-NOT-END-OF-STATUS-CURSOR            VALUE 'N'.    01320000
013300     05  PS-END-OF-CURSOR-SW            PIC  X(01)  VALUE 'N'.    01330000
013400         88  PS-END-OF-CURSOR                       VALUE 'Y'.    01340000
013500         88  PS-NOT-END-OF-CURSOR                   VALUE 'N'.    01350000
013600     05  PS-ASNS-TO-WMS-SW                PIC X(01) VALUE 'N'.    01360000
013700         88  PS-ASNS-TO-WMS-YES                     VALUE 'Y'.    01370000
013800         88  PS-ASNS-TO-WMS-NO                      VALUE 'N'.    01380000
013900     05  PS-INACTIVATE-SW                 PIC X(01) VALUE 'N'.    01390000
014000         88  PS-INACTIVATE-YES                      VALUE 'Y'.    01400000
014100         88  PS-INACTIVATE-NO                       VALUE 'N'.    01410000
014200                                                                  01420000
014300 01  PV-PROGRAM-VARIABLES.                                        01430000
014400     05  PV-ABSTIME                     PIC S9(15)  COMP.         01440000
014500     05  PV-CURRENT-DATE                PIC  9(06).               01450000
014600     05  PV-CURRENT-TIME                PIC  9(06).               01460000
014700     05  PV-CURR-TRIP-ID                PIC S9(09)  VALUE +0      01470000
014800                                                    COMP SYNC.    01480000
014900     05  PV-VHTRIP-COUNT                PIC S9(09)  VALUE +0      01490000
015000                                                    COMP-3.       01500000
015100     05  PV-TRIP-ID                     PIC S9(09)  VALUE +0      01510000
015200                                                    COMP SYNC.    01520000
015300     05  PV-SUB                         PIC S9(04)  VALUE +0      01530000
015400                                                    COMP SYNC.    01540000
015500     05  PV-NUMBER-OF-UPDATES           PIC S9(04)  VALUE +0      01550000
015600                                                    COMP-3.       01560000
015700     05  PV-SUBSCRIPT                   PIC S9(03)  VALUE +0      01570000
015800                                                    COMP-3.       01580000
015900     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01590000
016000                                                    COMP SYNC.    01600000
016100     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01610000
016200                                                    COMP-3.       01620000
016300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01630000
016400                                                    COMP-3.       01640000
016500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01650000
016600                                                    COMP-3.       01660000
016700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01670000
016800                                                    COMP-3.       01680000
016900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01690000
017000                                                    COMP-3.       01700000
017100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01710000
017200                                                    COMP-3.       01720000
017300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01730000
017400                                                    COMP-3.       01740000
017500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01750000
017600                                                    COMP SYNC.    01760000
017700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01770000
017800                                                    COMP SYNC.    01780000
017900     05  PV-ITEM                        PIC S9(04)  VALUE +0      01790000
018000                                                    COMP SYNC.    01800000
018100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01810000
018200                                                    COMP SYNC.    01820000
018300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01830000
018400                                                    COMP SYNC.    01840000
018500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01850000
018600                                                    COMP SYNC.    01860000
018700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01870000
018800                                                    COMP SYNC.    01880000
018900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01890000
019000                                                    COMP SYNC.    01900000
019100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01910000
019200                                                    COMP SYNC.    01920000
019300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01930000
019400                                                    COMP SYNC.    01940000
019500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01950000
019600                                                    COMP SYNC.    01960000
019700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01970000
019800                                                    COMP SYNC.    01980000
019900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01990000
020000                                                    COMP SYNC.    02000000
020100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02010000
020200                                                    COMP SYNC.    02020000
020300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02030000
020400                                                    COMP SYNC.    02040000
020500     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02050000
020600                                                    COMP-3.       02060000
020700     05  PV-EDIT-DATE.                                            02070000
020800         10  PV-EDIT-DATE-CC            PIC X(02).                02080000
020900         10  PV-EDIT-DATE-YY            PIC X(02).                02090000
021000         10  FILLER                     PIC X(01).                02100000
021100         10  PV-EDIT-DATE-MM            PIC X(02).                02110000
021200         10  FILLER                     PIC X(01).                02120000
021300         10  PV-EDIT-DATE-DD            PIC X(02).                02130000
021400     05  PV-EDIT-TIME.                                            02140000
021500         10  PV-EDIT-TIME-HH            PIC X(02).                02150000
021600         10  FILLER                     PIC X(01).                02160000
021700         10  PV-EDIT-TIME-MM            PIC X(02).                02170000
021800         10  FILLER                     PIC X(01).                02180000
021900         10  PV-EDIT-TIME-SS            PIC X(02).                02190000
022000     05  PV-SYSTEM-ID.                                            02200000
022100         10  FILLER                     PIC  X(04)  VALUE SPACE.  02210000
022200         10  PV-REGION-IND              PIC  X(01).               02220000
022300             88  PV-TEST-CICS                 VALUE 'T'.          02230000
022400             88  PV-QA-CICS                   VALUE 'Q'.          02240000
022500             88  PV-PROD-CICS                 VALUE 'P'.          02250000
022600             88  PV-LEARN-CICS                VALUE 'L'.          02260000
022700         10  FILLER                     PIC X(01)    VALUE SPACES.02270000
022800                                                                  02280000
022900     05  PV-MESSAGE.                                              02290000
023000         10  PV-MESSAGE1                PIC X(10).                02300000
023100         10  PV-FILLER                  PIC X(01).                02310000
023200         10  PV-MESSAGE2                PIC X(10).                02320000
023300         10  PV-FILLER                  PIC X(01).                02330000
023400         10  PV-MESSAGE3                PIC X(10).                02340000
023500                                                                  02350000
023600     05  PV-CICS-MSG-AREA               PIC X(75)  VALUE SPACE.   02360000
023700     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      02370000
023800                                                     COMP SYNC.   02380000
023900                                                                  02390000
024000*---------------------------------------------------------------* 02400000
024100*  WORKING STORAGE AREA USED TO BUILD SQL STATEMENTS            * 02410000
024200*---------------------------------------------------------------* 02420000
024300                                                                  02430000
024400 01  PV-SQL-STMT.                                                 02440000
024500     49  PV-SQL-STMT-LEN                PIC S9(04)  COMP  VALUE 0.02450000
024600*        SELECT 430 LENGTH PLUS WHERE LENGTH PLUS  453 JOIN LENGTH02460000
024700     49  PV-SQL-STMT-TEXT               PIC X(1284)  VALUE SPACES.02470000
024800                                                                  02480000
024900 01  PV-BUILD-SELECT-REC.                                         02490000
025000     05  PV-BUILD-SELECT-LEN            PIC S9(04)  COMP  VALUE 0.02500000
025100*        WHERE NOT INCLUDED IN LENGTH                             02510000
025200     05  PV-BUILD-SELECT-STMT.                                    02520000
025300         10  FILLER                     PIC  X(07)                02530000
025400                         VALUE 'SELECT '.                         02540000
025500         10  FILLER                     PIC  X(10)                02550000
025600                         VALUE 'A.TRIP_ID '.                      02560000
025700         10  FILLER                     PIC  X(12)                02570000
025800                         VALUE ',A.SHIPT_ID '.                    02580000
025900         10  FILLER                     PIC  X(15)                02590000
026000                         VALUE ',A.PRO_SCAC_ID '.                 02600000
026100         10  FILLER                     PIC  X(11)                02610000
026200                         VALUE ',A.PRO_NBR '.                     02620000
026300         10  FILLER                     PIC  X(11)                02630000
026400                         VALUE ',A.BOL_NBR '.                     02640000
026500         10  FILLER                     PIC  X(15)                02650000
026600                         VALUE ',A.PKG_TYP_CDE '.                 02660000
026700         10  FILLER                     PIC  X(18)                02670000
026800                         VALUE ',A.EXPTED_PKG_QTY '.              02680000
026900         10  FILLER                     PIC  X(19)                02690000
027000                         VALUE ',A.EXPTED_GRO_WGHT '.             02700000
027100         10  FILLER                     PIC  X(18)                02710000
027200                         VALUE ',A.EXPTED_PLT_QTY '.              02720000
027300         10  FILLER                     PIC  X(16)                02730000
027400                         VALUE ',A.CARR_CART_CT '.                02740000
027500         10  FILLER                     PIC  X(16)                02750000
027600                         VALUE ',A.VEND_CART_CT '.                02760000
027700         10  FILLER                     PIC  X(20)                02770000
027800                         VALUE ',B.SHIPT_STATUS_CDE '.            02780000
027900         10  FILLER                     PIC  X(14)                02790000
028000                         VALUE ',B.STATUS_DTE '.                  02800000
028100         10  FILLER                     PIC  X(14)                02810000
028200                         VALUE ',B.STATUS_TME '.                  02820000
028300         10  FILLER                     PIC  X(17)                02830000
028400                         VALUE ',C.OWNER_SCAC_ID '.               02840000
028500         10  FILLER                     PIC  X(11)                02850000
028600                         VALUE ',C.VEH_NBR '.                     02860000
028700         10  FILLER                     PIC  X(20)                02870000
028800                         VALUE ',C.CURR_OPER_UNT_ID '.            02880000
028900         10  FILLER                     PIC  X(17)                02890000
029000                         VALUE ',C.CURR_FCLTY_ID '.               02900000
029100         10  FILLER                     PIC  X(16)                02910000
029200                         VALUE ',D.MANIFEST_NBR '.                02920000
029300         10  FILLER                     PIC  X(12)                02930000
029400                         VALUE ',E.PRTY_CDE '.                    02940000
029500         10  FILLER                     PIC  X(06)                02950000
029600                                   VALUE 'FROM  '.                02960000
029700         10  FILLER                     PIC  X(03)                02970000
029800                                   VALUE 'DB2'.                   02980000
029900         10  PV-BUILD-QUAL-1            PIC  X(01).               02990000
030000         10  FILLER                     PIC  X(03)                03000000
030100                                   VALUE 'DBA'.                   03010000
030200         10  FILLER                     PIC  X(11)                03020000
030300                                   VALUE '.TSHIPMT A '.           03030000
030400         10  FILLER                     PIC  X(04)                03040000
030500                                   VALUE ',DB2'.                  03050000
030600         10  PV-BUILD-QUAL-2            PIC  X(01).               03060000
030700         10  FILLER                     PIC  X(03)                03070000
030800                                   VALUE 'DBA'.                   03080000
030900         10  FILLER                     PIC  X(11)                03090000
031000                                   VALUE '.TSHIPST B '.           03100000
031100         10  FILLER                     PIC  X(04)                03110000
031200                                   VALUE ',DB2'.                  03120000
031300         10  PV-BUILD-QUAL-3            PIC  X(01).               03130000
031400         10  FILLER                     PIC  X(03)                03140000
031500                                   VALUE 'DBA'.                   03150000
031600         10  FILLER                     PIC  X(11)                03160000
031700                                   VALUE '.TVEHICL C '.           03170000
031800         10  FILLER                     PIC  X(04)                03180000
031900                                   VALUE ',DB2'.                  03190000
032000         10  PV-BUILD-QUAL-4            PIC  X(01).               03200000
032100         10  FILLER                     PIC  X(03)                03210000
032200                                   VALUE 'DBA'.                   03220000
032300         10  FILLER                     PIC  X(11)                03230000
032400                                   VALUE '.TVHTRIP D '.           03240000
032500         10  FILLER                     PIC  X(04)                03250000
032600                                   VALUE ',DB2'.                  03260000
032700         10  PV-BUILD-QUAL-5            PIC  X(01).               03270000
032800         10  FILLER                     PIC  X(03)                03280000
032900                                   VALUE 'DBA'.                   03290000
033000         10  FILLER                     PIC  X(11)                03300000
033100                                   VALUE '.TSHSTYP E '.           03310000
033200         10  FILLER                     PIC  X(04)                03320000
033300                                   VALUE ',DB2'.                  03330000
033400         10  PV-BUILD-QUAL-6            PIC  X(01).               03340000
033500         10  FILLER                     PIC  X(03)                03350000
033600                                   VALUE 'DBA'.                   03360000
033700         10  FILLER                     PIC  X(11)                03370000
033800                                   VALUE '.TTRIPST H '.           03380000
033900                                                                  03390000
034000         10  PVBLDSQL-WHERE             PIC  X(856) VALUE SPACES. 03400000
034100                                                                  03410000
034200 01  PV-WHERE-BYTES                     PIC S9(04)  COMP VALUE 0. 03420000
034300 01  PV-WHERE-SIZE                      PIC S9(04)  COMP VALUE 38.03430000
034400 01  PV-SELECT-BYTES                    PIC S9(04) COMP VALUE 430.03440000
034500 01  PV-JOIN-BYTES                      PIC S9(04) COMP VALUE 453.03450000
034600                                                                  03460000
034700 01  PV-WHERE-LITERALS.                                           03470000
034800     05  PV-BLD-WHERE                   PIC  X(07)                03480000
034900                                             VALUE ' WHERE '.     03490000
035000     05  PV-BLD-AND                     PIC  X(07)                03500000
035100                                             VALUE '  AND  '.     03510000
035200     05  PV-BLD-OPER.                                             03520000
035300         10  FILLER                     PIC  X(16)                03530000
035400                               VALUE 'H.OPER_UNT_ID = '.          03540000
035500         10  PV-BLD-OPER-UNT            PIC  9(04).               03550000
035600     05  PV-BLD-FCLTY.                                            03560000
035700         10  FILLER                     PIC  X(13)                03570000
035800                               VALUE 'H.FCLTY_ID = '.             03580000
035900         10  PV-BLD-FCLTY-ID            PIC  9(04).               03590000
036000     05  PV-BLD-VEH.                                              03600000
036100         10  FILLER                     PIC  X(12)                03610000
036200                               VALUE 'C.VEH_NBR = '.              03620000
036300         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03630000
036400         10  PV-BLD-VEH-NBR             PIC X(10).                03640000
036500     05  PV-BLD-SCAC.                                             03650000
036600         10  FILLER                     PIC  X(18)                03660000
036700                               VALUE 'C.OWNER_SCAC_ID = '.        03670000
036800         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03680000
036900         10  PV-BLD-SCAC-ID             PIC  X(04).               03690000
037000     05  PV-PRO-SCAC.                                             03700000
037100         10  FILLER                     PIC  X(16)                03710000
037200                               VALUE 'A.PRO_SCAC_ID = '.          03720000
037300         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03730000
037400         10  PV-PRO-SCAC-ID             PIC  X(04).               03740000
037500     05  PV-PRO.                                                  03750000
037600         10  FILLER                     PIC  X(12)                03760000
037700                               VALUE 'A.PRO_NBR = '.              03770000
037800         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03780000
037900         10  PV-PRO-NBR                 PIC  X(16).               03790000
038000     05  PV-BOL.                                                  03800000
038100         10  FILLER                     PIC  X(12)                03810000
038200                               VALUE 'A.BOL_NBR = '.              03820000
038300         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03830000
038400         10  PV-BOL-NBR                 PIC  X(16).               03840000
038500     05  PV-TABLE-JOIN-ORDER.                                     03850000
038600         10  PV-SUB-SELECT-1            PIC  X(43)  VALUE         03860000
038700        ' AND  E.PRTY_CDE = (SELECT MAX(G.PRTY_CDE) '.            03870000
038800         10  PV-SUB-SELECT-2            PIC  X(08)  VALUE         03880000
038900        'FROM DB2'.                                               03890000
039000         10  PV-BUILD-QUAL-7            PIC  X(01).               03900000
039100         10  FILLER                     PIC  X(03)                03910000
039200                                   VALUE 'DBA'.                   03920000
039300         10  PV-SUB-SELECT-3            PIC  X(12)  VALUE         03930000
039400       '.TSHIPST F, '.                                            03940000
039500         10  FILLER                     PIC  X(03)  VALUE         03950000
039600        'DB2'.                                                    03960000
039700         10  PV-BUILD-QUAL-8            PIC  X(01).               03970000
039800         10  FILLER                     PIC  X(03)                03980000
039900                                   VALUE 'DBA'.                   03990000
040000         10  PV-SUB-SELECT-3            PIC  X(41)  VALUE         04000000
040100       '.TSHSTYP G WHERE F.SHIPT_ID = A.SHIPT_ID '.               04010000
040200         10  PV-SUB-SELECT-3            PIC  X(44)  VALUE         04020000
040300        'AND F.SHIPT_STATUS_CDE = G.SHIPT_STATUS_CDE)'.           04030000
040400         10  FILLER                     PIC  X(31)  VALUE         04040000
040500        ' AND C.CURR_TRIP_ID IS NOT NULL'.                        04050000
040600         10  FILLER                     PIC  X(27)  VALUE         04060000
040700        ' AND B.SHIPT_STATUS_CDE ^= '.                            04070000
040800         10  FILLER                     PIC  X(01)  VALUE X'7D'.  04080000
040900         10  FILLER                     PIC  X(02)  VALUE 'DE'.   04090000
041000         10  FILLER                     PIC  X(01)  VALUE X'7D'.  04100000
041100         10  FILLER                     PIC  X(25)  VALUE         04110000
041200        ' AND H.TRIP_STATUS_CDE = '.                              04120000
041300         10  FILLER                     PIC  X(01)  VALUE X'7D'.  04130000
041400         10  FILLER                     PIC  X(02)  VALUE 'EN'.   04140000
041500         10  FILLER                     PIC  X(01)  VALUE X'7D'.  04150000
041600         10  PV-TABLE-JOIN-1            PIC  X(32)  VALUE         04160000
041700        ' AND C.CURR_TRIP_ID = D.TRIP_ID '.                       04170000
041800         10  PV-TABLE-JOIN-1            PIC  X(32)  VALUE         04180000
041900        'AND C.CURR_TRIP_ID = A.TRIP_ID '.                        04190000
042000         10  PV-TABLE-JOIN-1            PIC  X(32)  VALUE         04200000
042100        'AND H.TRIP_ID      = A.TRIP_ID '.                        04210000
042200         10  PV-TABLE-JOIN-1            PIC  X(33)  VALUE         04220000
042300        'AND A.SHIPT_ID     = B.SHIPT_ID '.                       04230000
042400         10  PV-TABLE-JOIN-1            PIC  X(44)  VALUE         04240000
042500        'AND B.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE '.           04250000
042600         10  PV-ORDER-BY                PIC  X(29)  VALUE         04260000
042700        'ORDER BY A.PRO_NBR ,A.BOL_NBR'.                          04270000
042800                                                                  04280000
042900 01  PV-BUILD-STATEMENT.                                          04290000
043000     05  PV-BUILD-COMMAND               PIC  X(07)  VALUE SPACES. 04300000
043100     05  PV-BUILD-LITERAL               PIC  X(30)  VALUE SPACES. 04310000
043200                                                                  04320000
043300 01  PV-WHERE-TABLE.                                              04330000
043400     05  PV-WHERE-LINE                  PIC  X(38) OCCURS 7 TIMES.04340000
043500                                                                  04350000
043600*---------------------------------------------------------------* 04360000
043700*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 04370000
043800*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 04380000
043900*   APPLICATION-SPECIFIC COMMAREA.                              * 04390000
044000*---------------------------------------------------------------* 04400000
044100 01  LQW-LIST-QUEUE-WORK-AREA.                                    04410000
044200     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  04420000
044300     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           04430000
044400                                        INDEXED BY LQW-IDX.       04440000
044500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04450000
044600         10  LQW-TEMP-SELECTED-SW       PIC X(01).                04460000
044700         10  LQW-SELECTED-SW            PIC X(01).                04470000
044800             88  LQW-SELECT                         VALUE 'S'.    04480000
044900             88  LQW-DESELECT                       VALUE ' '.    04490000
045000         10  LQW-PRO-SCAC               PIC X(04).                04500000
045100         10  LQW-PRO-NBR                PIC X(14).                04510000
045200         10  LQW-BOL-NBR                PIC X(12).                04520000
045300         10  LQW-STATUS-CODE            PIC X(02).                04530000
045400         10  LQW-STATUS-DTE             PIC X(06).                04540000
045500         10  LQW-STATUS-TME             PIC X(05).                04550000
045600         10  LQW-PO-CNT                 PIC 9(03).                04560000
045700         10  LQW-PKG                    PIC X(03).                04570000
045800         10  LQW-QTY                    PIC 9(04).                04580000
045900         10  LQW-WGT                    PIC 9(05).                04590000
046000         10  LQW-PLT                    PIC 9(03).                04600000
046100         10  LQW-OPER-UNT-ID            PIC S9(04) COMP.          04610000
046200         10  LQW-FCLTY-ID               PIC S9(04) COMP.          04620000
046300         10  LQW-OWNER-SCAC-ID          PIC X(04).                04630000
046400         10  LQW-VEH-NBR                PIC X(10).                04640000
046500         10  LQW-MANIFEST-NBR           PIC X(15).                04650000
046600         10  LQW-TRIP-ID                PIC S9(09) COMP.          04660000
046700         10  LQW-SHIPT-ID               PIC S9(09) COMP.          04670000
046800         10  LQW-STATUS-DTE-ISO         PIC X(10).                04680000
046900                                                                  04690000
047000                                                                  04700000
047100*----------------------------------------------------------------*04710000
047200*  COPYBOOK FOR RANDOM NUMBER GENERATOR DPKUT902                 *04720009
047300*----------------------------------------------------------------*04730000
047400     COPY DPWS902.                                                04740009
047500/                                                                 04750000
047600*---------------------------------------------------------------* 04760000
047700*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 04770000
047800*---------------------------------------------------------------* 04780000
047900                                                                  04790000
048000     COPY TRWS006.                                                04800000
048100                                                                  04810000
048101/                                                                 04810100
048102***************************************************************** 04810200
048103* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 04810300
048104***************************************************************** 04810400
048105     COPY WSWS001.                                                04810500
048106/                                                                 04810600
048107*---------------------------------------------------------------* 04810700
048108*    MAP LAYOUT                                                 * 04810800
048109*---------------------------------------------------------------* 04810900
048110                                                                  04811000
048120     COPY TRKM114.                                                04812000
048130                                                                  04813000
048140 01  MR-OCCURS-LAYOUT                   REDEFINES  TR114AO.       04814000
048150     05  FILLER                         PIC X(140).               04815000
048160                                                                  04816000
048170     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          04817000
048180         10  MR-SELECTL                 PIC S9(04) COMP.          04818000
048190         10  MR-SELECTA                 PIC X(01).                04819000
048200         10  MR-SELECTC                 PIC X(01).                04820000
048300         10  MR-SELECTH                 PIC X(01).                04830000
048400         10  MR-SELECT                  PIC X(01).                04840000
048500                                                                  04850000
048600         10  FILLER                     PIC X(05).                04860000
048700         10  MR-PRO-SCAC                PIC X(04).                04870000
048800                                                                  04880000
048900         10  FILLER                     PIC X(05).                04890000
049000         10  MR-PRO-NBR                 PIC X(14).                04900000
049100                                                                  04910000
049200         10  FILLER                     PIC X(05).                04920000
049300         10  MR-BOL-NBR                 PIC X(12).                04930000
049400                                                                  04940000
049500         10  FILLER                     PIC X(05).                04950000
049600         10  MR-STATUS-CDE              PIC X(02).                04960000
049700                                                                  04970000
049800         10  FILLER                     PIC X(05).                04980000
049900         10  MR-STATUS-DTE              PIC X(06).                04990000
050000                                                                  05000000
050100         10  FILLER                     PIC X(05).                05010000
050200         10  MR-STATUS-TME              PIC X(05).                05020000
050300                                                                  05030000
050400         10  FILLER                     PIC X(05).                05040000
050500         10  MR-PO-CNT-X.                                         05050000
050600             15  MR-PO-CNT              PIC ZZ9.                  05060000
050700                                                                  05070000
050800         10  FILLER                     PIC X(05).                05080000
050900         10  MR-PKG                     PIC X(03).                05090000
051000                                                                  05100000
051100         10  FILLER                     PIC X(05).                05110000
051200         10  MR-QTY-X.                                            05120000
051300             15  MR-QTY                 PIC ZZZ9.                 05130000
051400                                                                  05140000
051500         10  FILLER                     PIC X(05).                05150000
051600         10  MR-WGT-X.                                            05160000
051700             15  MR-WGT                 PIC ZZZZ9.                05170000
051800                                                                  05180000
051900         10  FILLER                     PIC X(05).                05190000
052000         10  MR-PLT-X.                                            05200000
052100             15  MR-PLT                 PIC ZZ9.                  05210000
052200                                                                  05220000
052300/                                                                 05230000
052400*----------------------------------------------------------------*05240000
052500**  SECURITY SUBROUTINE PARAMETERS                                05250000
052600*----------------------------------------------------------------*05260000
052700     COPY DPWS008.                                                05270000
052800/                                                                 05280000
052900*---------------------------------------------------------------* 05290000
053000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05300000
053100*---------------------------------------------------------------* 05310000
053200                                                                  05320000
053300     COPY DPWS015.                                                05330000
053400                                                                  05340000
053500*---------------------------------------------------------------* 05350000
053600*    FUNCTION KEYS COPYBOOK.                                    * 05360000
053700*---------------------------------------------------------------* 05370000
053800                                                                  05380000
053900     COPY DPWS016.                                                05390000
054000                                                                  05400000
054100*---------------------------------------------------------------* 05410000
054200*    NUMERIC EDIT LAYOUT.                                       * 05420000
054300*---------------------------------------------------------------* 05430000
054400                                                                  05440000
054500     COPY DPWS010I.                                               05450000
054600                                                                  05460000
054700/                                                                 05470000
054800*---------------------------------------------------------------* 05480000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 05490014
055000*---------------------------------------------------------------* 05500000
055100                                                                  05510000
055200     COPY DPWS030.                                                05520000
CICS       COPY DPWS930.                                                05530014
055400/                                                                 05540000
055500*---------------------------------------------------------------* 05550000
055600*    STANDARD COMMAREA.                                         * 05560000
055700*---------------------------------------------------------------* 05570000
055800                                                                  05580000
055900     COPY DPWS020.                                                05590000
056000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05600000
056100                                                                  05610000
056200*---------------------------------------------------------------* 05620000
056300* INTER-APPLICATION COMMAREA.                                   * 05630000
056400*---------------------------------------------------------------* 05640000
056500                                                                  05650000
056600         10  INTER-APPL-COMM-AREA       PIC X(200).               05660000
056700     COPY TRWS001.                                                05670000
056800     COPY TRWS005.                                                05680000
056900     COPY TRWS007.                                                05690000
057000*---------------------------------------------------------------* 05700000
057100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05710000
057200*---------------------------------------------------------------* 05720000
057300         10  ASC-SPECIFIC-COMMAREA.                               05730000
057400             15  ASC-LIST-KEYS.                                   05740000
057500                 20  ASC-KEY-DEST-OPER-UNT-ID  PIC S9(4) COMP.    05750000
057600                 20  ASC-KEY-DEST-FCLTY-ID     PIC S9(4) COMP.    05760000
057700                 20  ASC-KEY-OWNER-SCAC-ID     PIC X(04).         05770000
057800                 20  ASC-KEY-VEH-NBR           PIC X(10).         05780000
057900                 20  ASC-KEY-PRO-SCAC-ID       PIC X(04).         05790000
058000                 20  ASC-KEY-PRO-NBR           PIC X(16).         05800000
058100                 20  ASC-KEY-BOL-NBR           PIC X(16).         05810000
058200                 20  ASC-KEY-MANIFEST-NBR      PIC X(15).         05820000
058300                 20  ASC-KEY-TRIP-ID           PIC S9(9) COMP.    05830000
058400             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           05840000
058500                 20  ASC-BLOCK-MODIFIED-SW                        05850000
058600                                        PIC X(01).                05860000
058700                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     05870000
058800                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     05880000
058900                                                                  05890000
059000                 20  ASC-ITEM-ARRAY.                              05900000
059100                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        05910000
059200                         30  ASC-LIST-ITEM-NUMBER                 05920000
059300                                        PIC S9(09) COMP-3.        05930000
059400                         30  ASC-TEMP-SELECTED-SW                 05940000
059500                                        PIC X(01).                05950000
059600                             88  ASC-VALID-SELECT  VALUE ' '      05960000
059700                                                         'S'      05970000
059800                                                         'B'      05980000
059900                                                         'E'.     05990000
060000                             88  ASC-TEMP-NO-SELECT               06000000
060100                                                   VALUE ' '.     06010000
060200                             88  ASC-TEMP-SELECT   VALUE 'S'.     06020000
060300                             88  ASC-TEMP-BEGIN    VALUE 'B'.     06030000
060400                             88  ASC-TEMP-END      VALUE 'E'.     06040000
060500                         30  ASC-SELECTED-SW                      06050000
060600                                        PIC X(01).                06060000
060700                             88  ASC-NO-SELECT     VALUE ' '.     06070000
060800                             88  ASC-SELECT        VALUE 'S'.     06080000
060900                             88  ASC-BEGIN         VALUE 'B'.     06090000
061000                             88  ASC-END           VALUE 'E'.     06100000
061100                         30  ASC-PRO-SCAC       PIC X(04).        06110000
061200                         30  ASC-PRO-NBR        PIC X(14).        06120000
061300                         30  ASC-BOL-NBR        PIC X(12).        06130000
061400                         30  ASC-STATUS-CDE     PIC X(02).        06140000
061500                         30  ASC-STATUS-DTE     PIC X(06).        06150000
061600                         30  ASC-STATUS-TME     PIC X(05).        06160000
061700                         30  ASC-PO-CNT         PIC 9(03).        06170000
061800                         30  ASC-PKG            PIC X(03).        06180000
061900                         30  ASC-QTY            PIC 9(04).        06190000
062000                         30  ASC-WGT            PIC 9(05).        06200000
062100                         30  ASC-PLT            PIC 9(03).        06210000
062200                         30  ASC-OPER-UNT-ID    PIC S9(04) COMP.  06220000
062300                         30  ASC-FCLTY-ID       PIC S9(04) COMP.  06230000
062400                         30  ASC-OWNER-SCAC-ID  PIC X(04).        06240000
062500                         30  ASC-VEH-NBR        PIC X(10).        06250000
062600                         30  ASC-MANIFEST-NBR   PIC X(15).        06260000
062700                         30  ASC-TRIP-ID        PIC S9(09) COMP.  06270000
062800                         30  ASC-SHIPT-ID       PIC S9(09) COMP.  06280000
062900                         30  ASC-STATUS-DTE-ISO PIC X(10).        06290000
063000                                                                  06300000
063100             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     06310000
063200             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     06320000
063300             15  ASC-SEL-SUB            PIC S9(04) COMP.          06330000
063400             15  ASC-SEL-ITEM           PIC S9(04) COMP.          06340000
063500             15  ASC-NUMBER-OF-ITEMS-READ                         06350000
063600                                        PIC S9(09) COMP-3.        06360000
063700             15  ASC-NUMBER-OF-SELECTED-ITEMS                     06370000
063800                                        PIC S9(09) COMP-3.        06380000
063900             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        06390000
064000             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        06400000
064100             15  ASC-ITEM-AT-TOP-OF-PANEL                         06410000
064200                                        PIC S9(09) COMP-3.        06420000
064300             15  ASC-ITEM-AT-BOT-OF-PANEL                         06430000
064400                                        PIC S9(09) COMP-3.        06440000
064500             15  ASC-HIGHEST-BLOCK-WRITTEN                        06450000
064600                                        PIC S9(04) COMP SYNC.     06460000
064700             15  ASC-START-OF-SELECTED-RANGE                      06470000
064800                                        PIC S9(09) COMP-3.        06480000
064900             15  ASC-END-OF-SELECTED-RANGE                        06490000
065000                                        PIC S9(09) COMP-3.        06500000
065100             15  ASC-ITEMS-LEFT-INDICATOR                         06510000
065200                                        PIC X(01).                06520000
065300                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06530000
065400                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06540000
065500             15  ASC-TEMP-QUEUE-UPDATE-SW                         06550000
065600                                        PIC X(01).                06560000
065700                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     06570000
065800                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     06580000
065900             15  ASC-LIST-QUEUE-NAME.                             06590000
066000                 20  ASC-LIST-TERM-ID   PIC X(04).                06600000
066100                 20  ASC-LIST-TASK-NUMBER                         06610000
066200                                        PIC S9(05) COMP-3.        06620000
066300                 20  ASC-LIST-SEQ       PIC 9(01).                06630000
066400             15  ASC-SEL-QUEUE-NAME-IN   PIC X(08).               06640000
066500             15  ASC-SEL-QUEUE-NAME-OUT.                          06650000
066600                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               06660000
066700                 20  ASC-SEL-TASK-NUMBER-OUT                      06670000
066800                                         PIC S9(05) COMP-3.       06680000
066900                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               06690000
067000                                                                  06700000
067100             15  ASC-CURSOR-SW          PIC X(01).                06710000
067200                 88  ASC-DOCK-CURSOR               VALUE 'D'.     06720000
067300                 88  ASC-SCAC-CURSOR               VALUE 'S'.     06730000
067400                 88  ASC-TRLR-CURSOR               VALUE 'T'.     06740000
067500             15  ASC-START-ITEM-REQUEST.                          06750000
067600                 20  ASC-START-ITEM-REQUEST-N  PIC 9(07).         06760000
067700             15  ASC-USE-SELECTION-QUEUE-IND   PIC X(01).         06770000
067800                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         06780000
067900             15  ASC-FCLTY-NME                 PIC X(25).         06790000
067910****PRB0044536 START                                              06791000
067911****1/13/15                                                       06791100
067920             15  ASC-CONFIRM-DETACH-SW         PIC X(01).         06792000
067930                 88  ASC-CONFIRM-DETACH            VALUE 'Y'.     06793000
067940                 88  ASC-CONFIRM-DETACH-NO         VALUE 'N'.     06794002
067950             15  FILLER                        PIC X(25).         06795000
067960****PRB0044536 END                                                06796000
068000/                                                                 06800000
068100*---------------------------------------------------------------* 06810000
068200*    ABEND PROCESSING COPYBOOK.                                 * 06820000
068300*---------------------------------------------------------------* 06830000
068400                                                                  06840000
068500     COPY DPWS013.                                                06850000
068600                                                                  06860000
068700/                                                                 06870000
068800*---------------------------------------------------------------* 06880000
068900*    DB2 AREA FOR THE FACLITY TABLE                             * 06890000
069000*---------------------------------------------------------------* 06900000
069100     EXEC SQL                                                     06910000
069200          INCLUDE TFACLTY                                         06920000
069300     END-EXEC.                                                    06930000
069400                                                                  06940000
069500/                                                                 06950000
069600*---------------------------------------------------------------* 06960000
069700*    DB2 AREA FOR THE SHIPMENT TABLE                            * 06970000
069800*---------------------------------------------------------------* 06980000
069900     EXEC SQL                                                     06990000
070000          INCLUDE TSHIPMT                                         07000000
070100     END-EXEC.                                                    07010000
070200                                                                  07020000
070300                                                                  07030000
070400/                                                                 07040000
070500*---------------------------------------------------------------* 07050000
070600*    DB2 AREA FOR THE AUDIT SHIPMENT TABLE                      * 07060000
070700*---------------------------------------------------------------* 07070000
070800     EXEC SQL                                                     07080000
070900          INCLUDE TAUSHIP                                         07090000
071000     END-EXEC.                                                    07100000
071100                                                                  07110000
071200/                                                                 07120000
071300*---------------------------------------------------------------* 07130000
071400*    DB2 AREA FOR THE   TRIP STATUS TABLE                       * 07140000
071500*---------------------------------------------------------------* 07150000
071600     EXEC SQL                                                     07160000
071700          INCLUDE TTRIPST                                         07170000
071800     END-EXEC.                                                    07180000
071900                                                                  07190000
072000/                                                                 07200000
072100*---------------------------------------------------------------* 07210000
072200*    DB2 AREA FOR THE AUDIT TRIP TABLE                          * 07220000
072300*---------------------------------------------------------------* 07230000
072400     EXEC SQL                                                     07240000
072500          INCLUDE TAUTRIP                                         07250000
072600     END-EXEC.                                                    07260000
072700                                                                  07270000
072800*---------------------------------------------------------------* 07280000
072900*    DB2 AREA FOR THE TRIP STATUS TYPE CODE TABLE                 07290000
073000*---------------------------------------------------------------* 07300000
073100     EXEC SQL                                                     07310000
073200          INCLUDE TTRSTYP                                         07320000
073300     END-EXEC.                                                    07330000
073400                                                                  07340000
073500/                                                                 07350000
073600*---------------------------------------------------------------* 07360000
073700*    DB2 AREA FOR THE SHIPMENT STATUS TABLE                     * 07370000
073800*---------------------------------------------------------------* 07380000
073900     EXEC SQL                                                     07390000
074000          INCLUDE TSHIPST                                         07400000
074100     END-EXEC.                                                    07410000
074200                                                                  07420000
074300/                                                                 07430000
074400*---------------------------------------------------------------* 07440000
074500*    DB2 AREA FOR THE SHIPMENT PO TABLE                         * 07450000
074600*---------------------------------------------------------------* 07460000
074700     EXEC SQL                                                     07470000
074800          INCLUDE TSHPTPO                                         07480000
074900     END-EXEC.                                                    07490000
075000                                                                  07500000
075100/                                                                 07510000
075200*---------------------------------------------------------------* 07520000
075300*    DB2 AREA FOR THE RECEIVER TABLE                            * 07530000
075400*---------------------------------------------------------------* 07540000
075500     EXEC SQL                                                     07550000
075600          INCLUDE TRECEIV                                         07560000
075700     END-EXEC.                                                    07570000
075800                                                                  07580000
075900/                                                                 07590000
076000*---------------------------------------------------------------* 07600000
076100*    DB2 AREA FOR THE SHIPMENT STATUS TYPE CODE TABLE           * 07610000
076200*---------------------------------------------------------------* 07620000
076300     EXEC SQL                                                     07630000
076400          INCLUDE TSHSTYP                                         07640000
076500     END-EXEC.                                                    07650000
076600                                                                  07660000
076700/                                                                 07670000
076800*---------------------------------------------------------------* 07680000
076900*    DB2 AREA FOR THE VEHICLE TABLE                             * 07690000
077000*---------------------------------------------------------------* 07700000
077100     EXEC SQL                                                     07710000
077200          INCLUDE TVEHICL                                         07720000
077300     END-EXEC.                                                    07730000
077400                                                                  07740000
077500/                                                                 07750000
077600*---------------------------------------------------------------* 07760000
077700*    DB2 AREA FOR THE TRIP TABLE                                * 07770000
077800*---------------------------------------------------------------* 07780000
077900     EXEC SQL                                                     07790000
078000          INCLUDE TVHTRIP                                         07800000
078100     END-EXEC.                                                    07810000
078200                                                                  07820000
078300/                                                                 07830000
078400*---------------------------------------------------------------* 07840000
078500*    DB2 AREA FOR THE FACILITY SCHEDULE AREA TABLE              * 07850000
078600*---------------------------------------------------------------* 07860000
078700*    EXEC SQL                                                     07870012
078800*         INCLUDE TFLSCHD                                         07880012
078900*    END-EXEC.                                                    07890012
079000*                                                                 07900012
079001*                                                                 07900112
079002***************************************************************** 07900200
079003*    DB2 AREA FOR THE PARM   TABLE                              * 07900300
079004***************************************************************** 07900400
079005     EXEC SQL                                                     07900500
079006          INCLUDE TKRPRPM                                         07900600
079007     END-EXEC.                                                    07900700
079008/                                                                 07900800
079009******************************************************************07900900
079010*    DB2 DCLGEN FOR THE WST_SHPMT_XREF_HDR TABLE                  07901000
079011******************************************************************07901100
079012     EXEC SQL                                                     07901200
079013          INCLUDE WST00001                                        07901300
079014     END-EXEC.                                                    07901400
079015/                                                                 07901500
079016*---------------------------------------------------------------* 07901600
079017*    DB2 AREA FOR COMMUNICATIONS                                * 07901700
079018*---------------------------------------------------------------* 07901800
079019     EXEC SQL                                                     07901900
079020          INCLUDE SQLCA                                           07902000
079030     END-EXEC.                                                    07903000
079040                                                                  07904000
079050/                                                                 07905000
084900     EXEC SQL                                                     08490000
085000         DECLARE SHIPST-CSR CURSOR FOR                            08500000
085100          SELECT  A.SHIPT_STATUS_CDE                              08510000
085200            FROM   TSHIPST A                                      08520000
085300                  ,TSHSTYP B                                      08530000
085400           WHERE  A.SHIPT_ID = :DK-SHIPT-ID                       08540000
085500             AND  B.PRTY_CDE > :PC-49                             08550000
085600             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         08560000
085700     END-EXEC                                                     08570000
085800                                                                  08580000
085900     EXEC SQL                                                     08590000
086000          DECLARE SHPTPO-CSR CURSOR FOR                           08600000
086100          SELECT PO_NBR                                           08610000
086200               , REC_SEQ_NBR                                      08620000
086300               , EXPTED_CART_CNT                                  08630000
086400               , ACTL_CART_CNT                                    08640000
086500               , VEND_CART_CT                                     08650000
086600            FROM TSHPTPO                                          08660000
086700           WHERE SHIPT_ID = :DK-SHIPT-ID                          08670000
086800     END-EXEC                                                     08680000
086900                                                                  08690000
087000/                                                                 08700000
087100 LINKAGE SECTION.                                                 08710000
087200                                                                  08720000
087300 01  DFHCOMMAREA.                                                 08730000
087400     05  FILLER                         OCCURS  1 TO 4072 TIMES   08740000
087500                                        DEPENDING ON EIBCALEN.    08750000
087600         10  FILLER                     PIC X.                    08760000
087700                                                                  08770000
087800/                                                                 08780000
087900 PROCEDURE DIVISION.                                              08790000
088000*---------------------------------------------------------------* 08800000
088100*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 08810000
088200*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 08820000
088300*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 08830000
088400*---------------------------------------------------------------* 08840000
088500 0000-MAIN-MODULE.                                                08850000
088600                                                                  08860000
088700     INITIALIZE DP030-CICS-API-FIELDS.                            08870000
088800                                                                  08880000
088900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08890000
089000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08900000
089100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08910000
089200                                                                  08920000
089300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08930000
089400                                                                  08940000
089500     MOVE LENGTH OF TR114AI        TO DP030-MAP-LENGTH (1).       08950000
089600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08960000
089700                                                                  08970000
089800     PERFORM 0001-CALL-CICS-ARCH-API.                             08980000
089900     PERFORM 1000-CONTROL-PROCESSING                              08990000
090000                                                                  09000000
090100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09010000
090200     PERFORM 0001-CALL-CICS-ARCH-API.                             09020000
090300                                                                  09030000
090400*---------------------------------------------------------------* 09040000
090500*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 09050000
090600*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 09060000
090700*---------------------------------------------------------------* 09070000
090800 0001-CALL-CICS-ARCH-API.                                         09080000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09090014
091000                                    DFHCOMMAREA                   09100014
091100                                    DP030-CICS-API-FIELDS         09110014
091200                                    DP020-STANDARD-COMMAREA       09120014
091300                                    TR114AI.                      09130014
091400                                                                  09140000
091500     IF  DP030-RC-CALL-SUCCESSFUL                                 09150000
091600         CONTINUE                                                 09160000
091700     ELSE                                                         09170000
091800         SET DP013-NO-ROLLBACK                                    09180000
091900             DP013-XCTL-DISPLAY-RESTART                           09190000
092000             DP013-CICS-ABEND      TO TRUE                        09200000
092100         MOVE '0001-CALL-CICS-ARCH-API'                           09210000
092200                                   TO DP013-PARAGRAPH             09220000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O09230014
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09240014
092500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09250000
092600         PERFORM DP013-0000-PROCESS-ABEND                         09260000
092700     END-IF.                                                      09270000
092800                                                                  09280000
092900*----------------------------------------------------------------*09290000
093000* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09300000
093100* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09310000
093200*                                                                *09320000
093300* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09330000
093400*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09340000
093500*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09350000
093600*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09360000
093700*----------------------------------------------------------------*09370000
093800                                                                  09380000
093900 1000-CONTROL-PROCESSING.                                         09390000
094000                                                                  09400000
094100     EVALUATE TRUE                                                09410000
094200         WHEN DP020-NEXT-ACT-INITIAL                              09420000
094300             INITIALIZE ASC-SPECIFIC-COMMAREA                     09430000
094400             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09440000
094500                                      ASC-SEL-TERM-ID-OUT         09450000
094600             MOVE DP020-SRC-TASK-NUMBER                           09460000
094700                                   TO ASC-LIST-TASK-NUMBER        09470000
094800                                      ASC-SEL-TASK-NUMBER-OUT     09480000
094900             MOVE PC-LIST-QUEUE-SEQ                               09490000
095000                                   TO ASC-LIST-SEQ                09500000
095100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             09510000
095200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09520000
095300             IF  PS-COMMAREA-NOT-VALID                            09530000
095400                 SET DP020-MSG-FATAL                              09540000
095500                     DP020-NEXT-ACT-APPL-ERROR                    09550000
095600                                   TO TRUE                        09560000
095700             ELSE                                                 09570000
095800                 PERFORM 4000-BUILD-INITIAL-PANEL                 09580000
095900             END-IF                                               09590000
096000                                                                  09600000
096100         WHEN DP020-NEXT-ACT-READ-MAP                             09610000
096200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09620000
096300                                   TO PV-TOP-ITEM                 09630000
096400             PERFORM 2000-PROCESS-PANEL                           09640000
096500                                                                  09650000
096600         WHEN DP020-NEXT-ACT-RETURN                               09660000
096700              PERFORM 2050-DELETE-LIST-QUEUE                      09670000
096800              PERFORM 4000-BUILD-INITIAL-PANEL                    09680000
096900                                                                  09690000
097000         WHEN OTHER                                               09700000
097100             SET DP013-LOGIC-ABEND TO TRUE                        09710000
097200             SET DP013-NO-ROLLBACK TO TRUE                        09720000
097300             MOVE '1000-CONTROL-PROCESSING'                       09730000
097400                                   TO DP013-PARAGRAPH             09740000
097500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09750000
097600                                   TO DP013-MESSAGE-TEXT(1)       09760000
097700             PERFORM DP013-0000-PROCESS-ABEND                     09770000
097800     END-EVALUATE.                                                09780000
097900                                                                  09790000
098000/                                                                 09800000
098100*----------------------------------------------------------------*09810000
098200* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *09820000
098300*----------------------------------------------------------------*09830000
098400                                                                  09840000
098500 1100-PROCESS-INTER-APPL-COMM.                                    09850000
098600                                                                  09860000
098700     SET PS-COMMAREA-VALID         TO TRUE.                       09870000
098800     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09880000
098900                                                                  09890000
099000     EVALUATE DP020-INT-APPL-FORMAT-IND                           09900000
099100                                                                  09910000
099200         WHEN PC-INTER-APPL-CRIT-SPEC                             09920000
099300             IF TR005-DEST-OPER-UNT-ID = ZERO OR                  09930000
099400                TR005-DEST-FCLTY-ID = ZERO OR                     09940000
099500                TR005-DELIVERY-SCAC-CDE = SPACES                  09950000
099600                 MOVE PC-TSYMSG-00983                             09960000
099700                                   TO DP020-MSG-NUMBER            09970000
099800                 SET DP020-MSG-FATAL                              09980000
099900                     DP020-NEXT-ACT-APPL-ERROR                    09990000
100000                     PS-ERROR                                     10000000
100100                     PS-COMMAREA-NOT-VALID                        10010000
100200                                   TO TRUE                        10020000
100300             ELSE                                                 10030000
100400                 MOVE TR005-DEST-OPER-UNT-ID                      10040000
100500                              TO ASC-KEY-DEST-OPER-UNT-ID         10050000
100600                 MOVE TR005-DEST-FCLTY-ID                         10060000
100700                              TO ASC-KEY-DEST-FCLTY-ID            10070000
100800                 MOVE TR005-DELIVERY-SCAC-CDE                     10080000
100900                              TO ASC-KEY-OWNER-SCAC-ID            10090000
101000                 MOVE TR005-TRLR-NBR TO ASC-KEY-VEH-NBR           10100000
101100                 MOVE TR005-PRO-NBR-SCAC-CDE                      10110000
101200                                     TO ASC-KEY-PRO-SCAC-ID       10120000
101300                 MOVE TR005-PRO-NBR  TO ASC-KEY-PRO-NBR           10130000
101400                 MOVE TR005-BILL-OF-LADING                        10140000
101500                                     TO ASC-KEY-BOL-NBR           10150000
101600                 MOVE TR005-MANIFEST-NBR                          10160000
101700                                     TO ASC-KEY-MANIFEST-NBR      10170000
101800                 MOVE TR005-TRIP-ID                               10180000
101900                                     TO ASC-KEY-TRIP-ID           10190000
102000             END-IF                                               10200000
102100                                                                  10210000
102200         WHEN PC-INTER-APPL-LIST                                  10220000
102300              SET ASC-USE-SELECTION-QUEUE                         10230000
102400                                   TO TRUE                        10240000
102500              MOVE TR007-NUMBER-OF-SELECTED-ITEMS                 10250000
102600                                   TO ASC-NUMBER-OF-SELECTED-ITEMS10260000
102700              MOVE TR007-NUMBER-OF-TS-ITEMS                       10270000
102800                                   TO ASC-NUMBER-OF-TS-ITEMS      10280000
102900              MOVE TR007-SEL-QUEUE-NAME                           10290000
103000                                   TO ASC-SEL-QUEUE-NAME-IN       10300000
103100              PERFORM 1120-PREPARE-LIST-ENTRY                     10310000
103200                                                                  10320000
103300     END-EVALUATE.                                                10330000
103400                                                                  10340000
103500*----------------------------------------------------------------*10350000
103600*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *10360000
103700*  QUEUE PASSED FROM THE LIST.                                   *10370000
103800*----------------------------------------------------------------*10380000
103900                                                                  10390000
104000 1120-PREPARE-LIST-ENTRY.                                         10400000
104100      MOVE TR006-MAX-ITEMS         TO ASC-SEL-SUB.                10410000
104200      MOVE ZERO                    TO ASC-SEL-ITEM.               10420000
104300      PERFORM 2300-GET-NEXT-RECORD.                               10430000
104400                                                                  10440000
104500/                                                                 10450000
104600*----------------------------------------------------------------*10460000
104700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10470000
104800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10480000
104900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10490000
105000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10500000
105100* FUNCTION KEYS CAN GET THIS FAR.                                *10510000
105200*----------------------------------------------------------------*10520000
105300                                                                  10530000
105400 2000-PROCESS-PANEL.                                              10540000
105500     EVALUATE TRUE                                                10550000
105600         WHEN DP020-SRC-AID = DP016-CLEAR                         10560000
105700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10570000
105800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10580000
105900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10590000
106000                                                                  10600000
106100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10610000
106200             PERFORM 2050-DELETE-LIST-QUEUE                       10620000
106300             PERFORM 4000-BUILD-INITIAL-PANEL                     10630000
106310             SET  ASC-CONFIRM-DETACH-NO  TO  TRUE                 10631000
106400                                                                  10640000
106500         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   10650000
106600             PERFORM 2140-DESELECT-ALL-ITEMS                      10660000
106700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10670000
106710             SET  ASC-CONFIRM-DETACH-NO  TO  TRUE                 10671000
106800                                                                  10680000
106900         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 10690000
107000              PERFORM 2150-SELECT-ALL-ITEMS                       10700000
107100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10710000
107200                                                                  10720000
107300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10730000
107400             IF ASC-USE-SELECTION-QUEUE                           10740000
107500                 PERFORM 6200-DEL-LIST-QUEUE                      10750000
107600                 PERFORM 2300-GET-NEXT-RECORD                     10760000
107700                 PERFORM 4000-BUILD-INITIAL-PANEL                 10770000
107800                 PERFORM 3200-RESET-ATTRIBUTES                    10780000
107900             ELSE                                                 10790000
108000*                --- BOTTOM OF LIST ---                           10800000
108100                 MOVE PC-TSYMSG-00070                             10810000
108200                                   TO DP020-MSG-NUMBER            10820000
108300                 SET DP020-MSG-INFORMATIONAL                      10830000
108400                                   TO TRUE                        10840000
108500             END-IF                                               10850000
108600                                                                  10860000
108700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10870000
108800             IF ASC-USE-SELECTION-QUEUE                           10880000
108900                 PERFORM 6200-DEL-LIST-QUEUE                      10890000
109000                 PERFORM 2310-GET-PREV-RECORD                     10900000
109100                 PERFORM 4000-BUILD-INITIAL-PANEL                 10910000
109200                 PERFORM 3200-RESET-ATTRIBUTES                    10920000
109300             ELSE                                                 10930000
109400*                --- TOP OF LIST ---                              10940000
109500                 MOVE PC-TSYMSG-00069                             10950000
109600                                   TO DP020-MSG-NUMBER            10960000
109700                 SET DP020-MSG-INFORMATIONAL                      10970000
109800                                   TO TRUE                        10980000
109900             END-IF                                               10990000
110000         WHEN OTHER                                               11000000
110100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11010000
110200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11020000
110300             IF  PS-NO-ERROR                                      11030000
110400                 SET DP030-CONTINUE-GO TO TRUE                    11040000
110500                 PERFORM 2100-CHECK-FUNCTION-KEY                  11050000
110600             ELSE                                                 11060000
110700                 SET DP030-OVERRIDE-GO TO TRUE                    11070000
110800             END-IF                                               11080000
110900     END-EVALUATE.                                                11090000
111000                                                                  11100000
111100/                                                                 11110000
111200*----------------------------------------------------------------*11120000
111300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11130000
111400*----------------------------------------------------------------*11140000
111500 2050-DELETE-LIST-QUEUE.                                          11150000
111600                                                                  11160000
111700     EXEC CICS                                                    11170000
111800         DELETEQ TS                                               11180000
111900           QUEUE (ASC-LIST-QUEUE-NAME)                            11190000
112000            RESP (PV-CICS-RESP)                                   11200000
112100     END-EXEC.                                                    11210000
112200                                                                  11220000
112300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11230000
112400        (PV-CICS-RESP = DFHRESP(QIDERR))                          11240000
112500         CONTINUE                                                 11250000
112600     ELSE                                                         11260000
112700         SET DP013-CICS-ABEND      TO TRUE                        11270000
112800         SET DP013-NO-ROLLBACK     TO TRUE                        11280000
112900                                                                  11290000
113000         MOVE '2050-DELETE-LIST-QUEUE'                            11300000
113100                                   TO DP013-PARAGRAPH             11310000
113200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11320000
113300                                   TO DP013-MESSAGE-TEXT (1)      11330000
113400         PERFORM DP013-0000-PROCESS-ABEND                         11340000
113500     END-IF.                                                      11350000
113600                                                                  11360000
113700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11370000
113800                                                                  11380000
113900/                                                                 11390000
114000*----------------------------------------------------------------*11400000
114100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11410000
114200* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11420000
114300* CICS ARCHITECTURE API.                                         *11430000
114400*----------------------------------------------------------------*11440000
114500 2100-CHECK-FUNCTION-KEY.                                         11450000
114600                                                                  11460000
114700     EVALUATE TRUE                                                11470000
114800         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 11480000
114900             IF  ASC-NUMBER-OF-SELECTED-ITEMS = 0                 11490000
115000                 INITIALIZE TR007-INTER-APPL-COMMAREA             11500000
115100                 MOVE ZERO      TO TR007-NUMBER-OF-SELECTED-ITEMS 11510000
115200                 MOVE ASC-KEY-DEST-OPER-UNT-ID                    11520000
115300                                   TO TR007-OPER-UNT-ID           11530000
115400                 MOVE ASC-KEY-DEST-FCLTY-ID                       11540000
115500                                   TO TR007-FCLTY-ID              11550000
115600                 MOVE ASC-KEY-OWNER-SCAC-ID                       11560000
115700                                   TO TR007-OWNER-SCAC-ID         11570000
115800                 MOVE ASC-KEY-VEH-NBR                             11580000
115900                                   TO TR007-VEH-NBR               11590000
116000                 MOVE ASC-KEY-MANIFEST-NBR                        11600000
116100                                   TO TR007-MANIFEST-NBR          11610000
116200                 MOVE ASC-KEY-TRIP-ID                             11620000
116300                                   TO TR007-TRIP-ID               11630000
116400             ELSE                                                 11640000
116500                 INITIALIZE TR007-INTER-APPL-COMMAREA             11650000
116600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11660000
116700                                TO TR007-NUMBER-OF-SELECTED-ITEMS 11670000
116800                 MOVE ASC-KEY-TRIP-ID                             11680000
116900                                   TO TR007-TRIP-ID               11690000
117000                 PERFORM 5000-PREPARE-SEL-QUEUE                   11700000
117100                                                                  11710000
117200*  THE FOLLOWING CODE IS TO SETUP THE COMMAREA FOR THE            11720000
117300*  OPEN SHIPMENT SELECTION CRITERA SCREEN OR THE DELIVERY         11730000
117400*  SHIPMENT FORECAST LIST SCREEN                                  11740000
117500                 MOVE ASC-KEY-OWNER-SCAC-ID                       11750000
117600                                TO TR005-DELIVERY-SCAC-CDE        11760000
117700                 MOVE ASC-KEY-VEH-NBR                             11770000
117800                                TO TR005-TRLR-NBR                 11780000
117900                 PERFORM 6500-FORMAT-COMMAREA                     11790000
118000             END-IF                                               11800000
118100                                                                  11810000
118110*                                                                 11811000
118120*** F14 - DETACH (LOCAL-FUNC-01)                                  11812000
118130*                                                                 11813000
118200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11820000
118300             PERFORM 2170-CHECK-RACF-ACCESS                       11830000
118400             IF DP008-ACCESS-DENIED                               11840000
118500*                -- NO SECURITY CLEARANCE FOR FUNCTION --         11850000
118600                 SET DP030-OVERRIDE-GO                            11860000
118700                                   TO TRUE                        11870000
118800                 MOVE PC-TSYMSG-01061                             11880000
118900                                   TO DP020-MSG-NUMBER            11890000
119000                 SET DP020-MSG-WARNING                            11900000
119100                                    TO TRUE                       11910000
119200             ELSE                                                 11920000
119300             IF  ASC-NUMBER-OF-SELECTED-ITEMS = 0                 11930000
119400                 SET DP030-OVERRIDE-GO                            11940000
119500                                   TO TRUE                        11950000
119510*                     *** LIST ITEM MUST BE SELECTED**            11951000
119600                 MOVE PC-TSYMSG-00057                             11960000
119700                                   TO DP020-MSG-NUMBER            11970000
119800                 SET DP020-MSG-WARNING                            11980000
119900                                   TO TRUE                        11990000
120000             ELSE                                                 12000000
120100                 INITIALIZE TR007-INTER-APPL-COMMAREA             12010000
120200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12020000
120300                                TO TR007-NUMBER-OF-SELECTED-ITEMS 12030000
120400                 MOVE ASC-KEY-TRIP-ID                             12040000
120500                                   TO TR007-TRIP-ID               12050000
120600                 PERFORM 5000-PREPARE-SEL-QUEUE                   12060000
120700                                                                  12070000
120800                 IF PS-ERROR                                      12080000
120900                     CONTINUE                                     12090000
121000                 ELSE                                             12100000
121010                     SET ASC-CONFIRM-DETACH  TO  TRUE             12101000
121020                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12102000
121030                     MOVE PC-TSYMSG-03761  TO DP020-MSG-NUMBER    12103000
121040                     SET DP020-MSG-FATAL   TO TRUE                12104000
121050                     MOVE -1               TO MR-SELECTL (1)      12105000
121060                     SET DP030-SET-CURSOR-APPL-1                  12106000
121070                                           TO  TRUE               12107000
121080                     SET PS-ERROR          TO TRUE                12108000
121090                     SET ASC-NO-TSQ-UPDATE TO TRUE                12109000
123600                 END-IF                                           12360000
123700             END-IF                                               12370000
123800             END-IF                                               12380000
123900                                                                  12390000
123920* F2-CONFIRM DETACH                                               12392008
123930                                                                  12393000
123940         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    12394000
123941             IF  ASC-CONFIRM-DETACH                               12394100
123942                 PERFORM 2170-CHECK-RACF-ACCESS                   12394201
123954                                                                  12395400
123955                 IF DP008-ACCESS-DENIED                           12395500
123956                     SET  ASC-CONFIRM-DETACH-NO  TO  TRUE         12395600
123957                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12395700
123958                     MOVE PC-TSYMSG-01061  TO DP020-MSG-NUMBER    12395800
123959                     SET DP020-MSG-FATAL   TO TRUE                12395900
123960                     MOVE -1               TO MR-SELECTL (1)      12396000
123961                     SET DP030-SET-CURSOR-APPL-1                  12396100
123962                                           TO TRUE                12396200
123963                     SET PS-ERROR          TO TRUE                12396300
123964                     SET ASC-NO-TSQ-UPDATE TO TRUE                12396400
123965                 ELSE                                             12396500
123967                 IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          12396703
123968                     SET  ASC-CONFIRM-DETACH-NO  TO  TRUE         12396801
123970                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    12397003
123971                     SET DP020-MSG-FATAL   TO TRUE                12397104
123972                     MOVE -1               TO MR-SELECTL (1)      12397201
123973                     SET DP030-SET-CURSOR-APPL-1                  12397301
123974                                           TO TRUE                12397401
123975                     SET PS-ERROR          TO TRUE                12397501
123976                         SET ASC-NO-TSQ-UPDATE TO TRUE            12397600
123977                 ELSE                                             12397701
123978*** PERFORM DETACH LOGIC                                          12397801
123979                     PERFORM 2400-WMS-PROCESS                     12397901
123980                     IF  PS-INACTIVATE-NO                         12398001
123981                         SET ASC-NO-TSQ-UPDATE                    12398101
123983                             DP030-OVERRIDE-GO                    12398301
123984                             DP020-MSG-WARNING  TO TRUE           12398401
123986                         MOVE PC-TSYMSG-03543                     12398601
123987                           TO DP020-MSG-NUMBER                    12398701
123988                      ELSE                                        12398801
123989                         PERFORM 4500-DETACH-SHIPMENT             12398901
123990                         VARYING PV-ITEM  FROM 1 BY 1             12399001
123991                           UNTIL PV-ITEM >                        12399101
123992                                       ASC-HIGHEST-BLOCK-WRITTEN  12399201
123994                              OR PS-ERROR                         12399401
123995                                                                  12399501
123996                     END-IF                                       12399604
123997                 END-IF                                           12399704
123998             END-IF                                               12399804
123999             END-IF                                               12399904
124000                                                                  12400004
124003                                                                  12400304
124010         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  12401000
124100             MOVE +1               TO PV-TOP-ITEM                 12410000
124200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12420000
124300             PERFORM 3200-RESET-ATTRIBUTES                        12430000
124310                                                                  12431000
124320             IF  ASC-CONFIRM-DETACH                               12432000
124330                 MOVE  PC-TSYMSG-03761 TO  DP020-MSG-NUMBER       12433000
124340                 SET DP020-MSG-FATAL   TO  TRUE                   12434000
124350                 MOVE -1               TO  MR-SELECTL(1)          12435000
124360                 SET DP030-SET-CURSOR-APPL-1                      12436000
124370                                       TO  TRUE                   12437000
124380                 SET PS-ERROR          TO TRUE                    12438000
124390                 SET ASC-NO-TSQ-UPDATE TO TRUE                    12439000
124391             END-IF                                               12439100
124400                                                                  12440000
124500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12450000
124600             PERFORM 2110-BROWSE-BACKWARD                         12460000
124700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12470000
124800             PERFORM 3200-RESET-ATTRIBUTES                        12480000
124810                                                                  12481000
124820             IF  ASC-CONFIRM-DETACH                               12482000
124830                 MOVE  PC-TSYMSG-03761 TO  DP020-MSG-NUMBER       12483000
124840                 SET DP020-MSG-FATAL   TO  TRUE                   12484000
124850                 MOVE -1               TO  MR-SELECTL(1)          12485000
124860                 SET DP030-SET-CURSOR-APPL-1                      12486000
124870                                       TO  TRUE                   12487000
124880                 SET PS-ERROR          TO TRUE                    12488000
124890                 SET ASC-NO-TSQ-UPDATE TO TRUE                    12489000
124891             END-IF                                               12489100
124900                                                                  12490000
125000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12500000
125100             PERFORM 2120-BROWSE-FORWARD                          12510000
125200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12520000
125300             PERFORM 3200-RESET-ATTRIBUTES                        12530000
125310                                                                  12531000
125320             IF  ASC-CONFIRM-DETACH                               12532000
125330                 MOVE  PC-TSYMSG-03761 TO  DP020-MSG-NUMBER       12533000
125340                 SET DP020-MSG-FATAL   TO  TRUE                   12534000
125350                 MOVE -1               TO  MR-SELECTL(1)          12535000
125360                 SET DP030-SET-CURSOR-APPL-1                      12536000
125370                                       TO  TRUE                   12537000
125380                 SET PS-ERROR          TO TRUE                    12538000
125390                 SET ASC-NO-TSQ-UPDATE TO TRUE                    12539000
125391             END-IF                                               12539100
125400                                                                  12540000
125500         WHEN DP020-SRC-AID = DP016-ENTER                         12550000
125600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12560000
125700             IF  PS-ERROR                                         12570000
125800                 CONTINUE                                         12580000
125900             ELSE                                                 12590000
126000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12600000
126100             END-IF                                               12610000
126110                                                                  12611000
126120             IF  ASC-CONFIRM-DETACH                               12612000
126130                 MOVE  PC-TSYMSG-03761 TO  DP020-MSG-NUMBER       12613000
126140                 SET DP020-MSG-FATAL   TO  TRUE                   12614000
126150                 MOVE -1               TO  MR-SELECTL(1)          12615000
126160                 SET DP030-SET-CURSOR-APPL-1                      12616000
126170                                       TO  TRUE                   12617000
126180                 SET PS-ERROR          TO TRUE                    12618000
126190                 SET ASC-NO-TSQ-UPDATE TO TRUE                    12619000
126191             END-IF                                               12619100
126192                                                                  12619200
126200                                                                  12620000
126300         WHEN OTHER                                               12630000
126400             SET DP013-NO-ROLLBACK                                12640000
126500                 DP013-XCTL-DISPLAY-RESTART                       12650000
126600                 DP013-CICS-ABEND  TO TRUE                        12660000
126700             MOVE '2100-CHECK-FUNCTION-KEY'                       12670000
126800                                   TO DP013-PARAGRAPH             12680000
126900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12690000
127000                                   TO DP013-MESSAGE-TEXT (1)      12700000
127100             PERFORM DP013-0000-PROCESS-ABEND                     12710000
127200     END-EVALUATE.                                                12720000
127300                                                                  12730000
127400/                                                                 12740000
127500*----------------------------------------------------------------*12750000
127600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12760000
127700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12770000
127800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12780000
127900*    MESSAGE.                                                    *12790000
128000*----------------------------------------------------------------*12800000
128100                                                                  12810000
128200 2110-BROWSE-BACKWARD.                                            12820000
128300                                                                  12830000
128400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12840000
128500         GIVING PV-TOP-ITEM.                                      12850000
128600                                                                  12860000
128700     IF  ((PV-TOP-ITEM < +1)                                      12870000
128800       OR (PV-TOP-ITEM = +1))                                     12880000
128900         MOVE +1                   TO PV-TOP-ITEM                 12890000
129000*        -- TOP OF LIST --                                        12900000
129100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12910000
129200         SET DP020-MSG-INFORMATIONAL                              12920000
129300                                   TO TRUE                        12930000
129400     END-IF.                                                      12940000
129500                                                                  12950000
129600/                                                                 12960000
129700*----------------------------------------------------------------*12970000
129800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12980000
129900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12990000
130000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13000000
130100*----------------------------------------------------------------*13010000
130200                                                                  13020000
130300 2120-BROWSE-FORWARD.                                             13030000
130400                                                                  13040000
130500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13050000
130600         GIVING PV-TOP-ITEM.                                      13060000
130700                                                                  13070000
130800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13080000
130900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13090000
131000                                   TO PV-TOP-ITEM                 13100000
131100*        -- BOTTOM OF LIST --                                     13110000
131200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13120000
131300         SET DP020-MSG-INFORMATIONAL                              13130000
131400                                   TO TRUE                        13140000
131500     ELSE                                                         13150000
131600         COMPUTE PV-BOTTOM-ITEM =                                 13160000
131700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13170000
131800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13180000
131900*            -- BOTTOM OF LIST --                                 13190000
132000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13200000
132100             SET DP020-MSG-INFORMATIONAL                          13210000
132200                                   TO TRUE                        13220000
132300         END-IF                                                   13230000
132400     END-IF.                                                      13240000
132500                                                                  13250000
132600/                                                                 13260000
132700*----------------------------------------------------------------*13270000
132800*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13280000
132900*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13290000
133000*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13300000
133100*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13310000
133200*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13320000
133300*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13330000
133400*----------------------------------------------------------------*13340000
133500                                                                  13350000
133600 2130-CHECK-FOR-JUMP-BROWSE.                                      13360000
133700                                                                  13370000
133800     SET PS-NO-ERROR               TO TRUE.                       13380000
133900     IF (ASC-START-ITEM-REQUEST = SPACE)                          13390000
134000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13400000
134100                                   TO PV-TOP-ITEM                 13410000
134200     ELSE                                                         13420000
134300         MOVE ASC-START-ITEM-REQUEST                              13430000
134400                                   TO DP010I-UNEDITED-FIELD       13440000
134500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13450000
134600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13460000
134700         SET DP010I-NEGATIVE-NOT-ALLOWED                          13470000
134800                                   TO TRUE                        13480000
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13491013
263697              USING DP010I-NUMERIC-EDIT-AREA                      13492013
135000                                                                  13500000
135100         IF  NOT DP010I-ERROR-DETECTED                            13510000
135200             MOVE DP010I-NUMERIC-FIELD                            13520000
135300                                   TO ASC-START-ITEM-REQUEST-N    13530000
135400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13540000
135500                 IF  ASC-START-ITEM-REQUEST-N >                   13550000
135600                                          ASC-NUMBER-OF-ITEMS-READ13560000
135700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13570000
135800                     COMPUTE PV-TOP-ITEM =                        13580000
135900                             ASC-NUMBER-OF-ITEMS-READ             13590000
136000                             - PC-ITEMS-PER-PANEL + 1             13600000
136100                     IF  PV-TOP-ITEM < +1                         13610000
136200                         MOVE +1   TO PV-TOP-ITEM                 13620000
136300                         MOVE PC-TSYMSG-00070                     13630000
136400                                   TO DP020-MSG-NUMBER            13640000
136500                         SET DP020-MSG-INFORMATIONAL              13650000
136600                                   TO TRUE                        13660000
136700                     END-IF                                       13670000
136800                 ELSE                                             13680000
136900                     MOVE ASC-START-ITEM-REQUEST-N                13690000
137000                                   TO PV-TOP-ITEM                 13700000
137100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13710000
137200                     COMPUTE PV-BOTTOM-ITEM =                     13720000
137300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13730000
137400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13740000
137500*                        -- BOTTOM OF LIST --                     13750000
137600                         MOVE PC-TSYMSG-00070                     13760000
137700                                   TO DP020-MSG-NUMBER            13770000
137800                         SET DP020-MSG-INFORMATIONAL              13780000
137900                                   TO TRUE                        13790000
138000                     END-IF                                       13800000
138100                 END-IF                                           13810000
138200             ELSE                                                 13820000
138300*                --- VALUE OUT OF RANGE ----                      13830000
138400                 MOVE PC-TSYMSG-00101                             13840000
138500                                   TO DP020-MSG-NUMBER            13850000
138600                 MOVE -1           TO ASTRTITL                    13860000
138700                 SET DP030-SET-CURSOR-APPL-1                      13870000
138800                                   TO TRUE                        13880000
138900                 MOVE DP015-REVERSE                               13890000
139000                                   TO ASTRTITH                    13900000
139100                 MOVE DP015-RED    TO ASTRTITC                    13910000
139200                 MOVE DP015-UNP-NUM-BRT-MDT                       13920000
139300                                   TO ASTRTITA                    13930000
139400                 SET DP020-MSG-FATAL                              13940000
139500                                   TO TRUE                        13950000
139600                 SET PS-ERROR      TO TRUE                        13960000
139700             END-IF                                               13970000
139800                                                                  13980000
139900         ELSE                                                     13990000
140000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14000000
140100             MOVE -1               TO ASTRTITL                    14010000
140200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14020000
140300             MOVE DP015-REVERSE    TO ASTRTITH                    14030000
140400             MOVE DP015-RED        TO ASTRTITC                    14040000
140500             MOVE DP015-UNP-NUM-BRT-MDT                           14050000
140600                                   TO ASTRTITA                    14060000
140700             SET DP020-MSG-FATAL   TO TRUE                        14070000
140800             SET PS-ERROR          TO TRUE                        14080000
140900         END-IF                                                   14090000
141000     END-IF.                                                      14100000
141100                                                                  14110000
141200/                                                                 14120000
141300*----------------------------------------------------------------*14130000
141400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14140000
141500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14150000
141600*----------------------------------------------------------------*14160000
141700 2140-DESELECT-ALL-ITEMS.                                         14170000
141800                                                                  14180000
141900     MOVE +1                       TO ASC-BLK-SUB.                14190000
142000                                                                  14200000
142100     PERFORM 2141-CLEAR-SELECTED-INDS                             14210000
142200         VARYING ASC-ITEM-SUB                                     14220000
142300         FROM 1 BY 1                                              14230000
142400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14240000
142500                                                                  14250000
142600     ADD +1                        TO ASC-BLK-SUB.                14260000
142700                                                                  14270000
142800     PERFORM 2141-CLEAR-SELECTED-INDS                             14280000
142900         VARYING ASC-ITEM-SUB                                     14290000
143000         FROM 1 BY 1                                              14300000
143100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14310000
143200                                                                  14320000
143300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14330000
143400                                   TO PV-LIST-ITEM-NUMBER.        14340000
143500                                                                  14350000
143600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14360000
143700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14370000
143800                                                                  14380000
143900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14390000
144000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      14400000
144100         MOVE +1                   TO ASC-BLK-SUB                 14410000
144200                                                                  14420000
144300         PERFORM 5100-WRITE-TEMP-STORAGE                          14430000
144400                                                                  14440000
144500         MOVE +1                   TO PV-BLOCK-NUMBER             14450000
144600                                                                  14460000
144700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14470000
144800             PV-FIRST-BLOCK-IN-ARRAY - 1                          14480000
144900                                                                  14490000
145000         PERFORM                                                  14500000
145100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14510000
145200                                                                  14520000
145300             PERFORM 4410-READ-TEMP-STORAGE                       14530000
145400                                                                  14540000
145500             PERFORM 2141-CLEAR-SELECTED-INDS                     14550000
145600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 14560000
145700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14570000
145800                                                                  14580000
145900             PERFORM 5100-WRITE-TEMP-STORAGE                      14590000
146000                                                                  14600000
146100             ADD +1                TO PV-BLOCK-NUMBER             14610000
146200                                                                  14620000
146300         END-PERFORM                                              14630000
146400                                                                  14640000
146500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14650000
146600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14660000
146700                                                                  14670000
146800         PERFORM                                                  14680000
146900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14690000
147000                   ASC-HIGHEST-BLOCK-WRITTEN                      14700000
147100                                                                  14710000
147200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14720000
147300                                   TO PV-BLOCK-NUMBER             14730000
147400                                                                  14740000
147500             PERFORM 4410-READ-TEMP-STORAGE                       14750000
147600                                                                  14760000
147700             PERFORM 2141-CLEAR-SELECTED-INDS                     14770000
147800                 VARYING ASC-ITEM-SUB                             14780000
147900                 FROM 1 BY 1                                      14790000
148000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14800000
148100                                                                  14810000
148200             PERFORM 5100-WRITE-TEMP-STORAGE                      14820000
148300                                                                  14830000
148400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14840000
148500                                                                  14850000
148600         END-PERFORM                                              14860000
148700                                                                  14870000
148800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14880000
148900                                   TO PV-BLOCK-NUMBER             14890000
149000                                                                  14900000
149100         PERFORM 4410-READ-TEMP-STORAGE                           14910000
149200     END-IF.                                                      14920000
149300                                                                  14930000
149400                                                                  14940000
149500     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS14950000
149600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.14960000
149700     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  14970000
149800                                                                  14980000
149900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14990000
150000                                                                  15000000
150100/                                                                 15010000
150200*----------------------------------------------------------------*15020000
150300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15030000
150400*----------------------------------------------------------------*15040000
150500                                                                  15050000
150600 2141-CLEAR-SELECTED-INDS.                                        15060000
150700                                                                  15070000
150800     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          15080000
150900             NOT EQUAL ZERO                                       15090000
151000         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15100000
151100             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15110000
151200                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15120000
151300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15130000
151400                                   TO TRUE                        15140000
151500         END-IF                                                   15150000
151600     END-IF.                                                      15160000
151700                                                                  15170000
151800/                                                                 15180000
151900*----------------------------------------------------------------*15190000
152000*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15200000
152100*  FOR ALL ITEMS.                                                *15210000
152200*----------------------------------------------------------------*15220000
152300                                                                  15230000
152400 2150-SELECT-ALL-ITEMS.                                           15240000
152500                                                                  15250000
152600     MOVE +1                       TO ASC-BLK-SUB.                15260000
152700                                                                  15270000
152800     PERFORM 2151-SET-SELECTED-INDS                               15280000
152900         VARYING ASC-ITEM-SUB                                     15290000
153000         FROM 1 BY 1                                              15300000
153100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15310000
153200                                                                  15320000
153300     ADD +1                        TO ASC-BLK-SUB.                15330000
153400                                                                  15340000
153500     PERFORM 2151-SET-SELECTED-INDS                               15350000
153600         VARYING ASC-ITEM-SUB                                     15360000
153700         FROM 1 BY 1                                              15370000
153800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15380000
153900                                                                  15390000
154000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15400000
154100                                   TO PV-LIST-ITEM-NUMBER.        15410000
154200                                                                  15420000
154300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15430000
154400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15440000
154500                                                                  15450000
154600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15460000
154700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15470000
154800         MOVE +1                   TO ASC-BLK-SUB                 15480000
154900                                                                  15490000
155000         PERFORM 5100-WRITE-TEMP-STORAGE                          15500000
155100                                                                  15510000
155200         MOVE +1                   TO PV-BLOCK-NUMBER             15520000
155300                                                                  15530000
155400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15540000
155500             PV-FIRST-BLOCK-IN-ARRAY - 1                          15550000
155600                                                                  15560000
155700         PERFORM                                                  15570000
155800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15580000
155900                                                                  15590000
156000             PERFORM 4410-READ-TEMP-STORAGE                       15600000
156100                                                                  15610000
156200             PERFORM 2151-SET-SELECTED-INDS                       15620000
156300                 VARYING ASC-ITEM-SUB                             15630000
156400                 FROM 1 BY 1                                      15640000
156500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15650000
156600                                                                  15660000
156700             PERFORM 5100-WRITE-TEMP-STORAGE                      15670000
156800                                                                  15680000
156900             ADD +1                TO PV-BLOCK-NUMBER             15690000
157000         END-PERFORM                                              15700000
157100                                                                  15710000
157200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15720000
157300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15730000
157400                                                                  15740000
157500         PERFORM                                                  15750000
157600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15760000
157700                   ASC-HIGHEST-BLOCK-WRITTEN                      15770000
157800                                                                  15780000
157900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15790000
158000                                   TO PV-BLOCK-NUMBER             15800000
158100                                                                  15810000
158200             PERFORM 4410-READ-TEMP-STORAGE                       15820000
158300                                                                  15830000
158400             PERFORM 2151-SET-SELECTED-INDS                       15840000
158500                 VARYING ASC-ITEM-SUB                             15850000
158600                 FROM 1 BY 1                                      15860000
158700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15870000
158800                                                                  15880000
158900             PERFORM 5100-WRITE-TEMP-STORAGE                      15890000
159000                                                                  15900000
159100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15910000
159200         END-PERFORM                                              15920000
159300                                                                  15930000
159400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15940000
159500                                   TO PV-BLOCK-NUMBER             15950000
159600                                                                  15960000
159700         PERFORM 4410-READ-TEMP-STORAGE                           15970000
159800     END-IF.                                                      15980000
159900                                                                  15990000
160000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16000000
160100          ASC-NUMBER-OF-SELECTED-ITEMS.                           16010000
160200                                                                  16020000
160300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16030000
160400                                                                  16040000
160500/                                                                 16050000
160600*----------------------------------------------------------------*16060000
160700*    MARK EACH ITEM AS BEING SELECTED.                           *16070000
160800*----------------------------------------------------------------*16080000
160900                                                                  16090000
161000 2151-SET-SELECTED-INDS.                                          16100000
161100                                                                  16110000
161200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16120000
161300             NOT EQUAL ZERO                                       16130000
161400         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16140000
161500             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16150000
161600                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16160000
161700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16170000
161800                                   TO TRUE                        16180000
161900         END-IF                                                   16190000
162000     END-IF.                                                      16200000
162100                                                                  16210000
162200                                                                  16220000
162300 2170-CHECK-RACF-ACCESS.                                          16230000
162400     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         16240000
162500     MOVE 'RCDETH  '              TO DP008-FUNCTION-NAME          16250000
162600     SET DP008-ACCESS-TYPE-USE    TO TRUE                         16260000
162700                                                                  16270000
162800     EXEC CICS                                                    16280000
162900        LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                  16290000
163000             COMMAREA (DP008-SECURITY-COMMAREA)                   16300000
163100             LENGTH (DP008-SECURITY-COMMAREA-LENGTH)              16310000
163200     END-EXEC                                                     16320000
163300                                                                  16330000
163400     IF DP008-CALL-SUCCESSFUL                                     16340000
163500         CONTINUE                                                 16350000
163600     ELSE                                                         16360000
163700        MOVE '2170-CHECK-RACF-ACCESS'                             16370000
163800                              TO DP013-PARAGRAPH                  16380000
163900         MOVE 'UNABLE TO ACCESS CICS'                             16390000
164000                              TO DP013-MESSAGE-TEXT (1)           16400000
164100         MOVE SQLCA           TO DP013-SQLCA                      16410000
164200         SET DP013-DB2-ABEND                                      16420000
164300             DP013-XCTL-DISPLAY-RESTART                           16430000
164400                              TO TRUE                             16440000
164500         PERFORM DP013-0000-PROCESS-ABEND                         16450000
164600     END-IF.                                                      16460000
164700                                                                  16470000
164800/                                                                 16480000
164900*----------------------------------------------------------------*16490000
165000*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *16500000
165100*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *16510000
165200*----------------------------------------------------------------*16520000
165300 2200-MOVE-SCREEN-TO-COMMAREA.                                    16530000
165400                                                                  16540000
165500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16550000
165600     MOVE +1                       TO PV-SUB.                     16560000
165700                                                                  16570000
165800     PERFORM 3100-SET-SUBSCRIPTS.                                 16580000
165900                                                                  16590000
166000     IF  ASTRTITL > ZERO                                          16600000
166100         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      16610000
166200     ELSE                                                         16620000
166300         IF  ASTRTITF = DP015-ERASE-EOF                           16630000
166400             INITIALIZE ASC-START-ITEM-REQUEST                    16640000
166500         END-IF                                                   16650000
166600     END-IF.                                                      16660000
166700                                                                  16670000
166800     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16680000
166900         VARYING PV-SUB                                           16690000
167000         FROM 1 BY 1                                              16700000
167100         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16710000
167200                                                                  16720000
167300/                                                                 16730000
167400*----------------------------------------------------------------*16740000
167500*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *16750000
167600*----------------------------------------------------------------*16760000
167700 2210-MOVE-LINES-TO-COMMAREA.                                     16770000
167800                                                                  16780000
167900     IF  MR-SELECTL (PV-SUB) > ZERO                               16790000
168000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16800000
168100                                   TO TRUE                        16810000
168200         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        16820000
168300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16830000
168400     ELSE                                                         16840000
168500         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                16850000
168600             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         16860000
168700             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        16870000
168800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16880000
168900         END-IF                                                   16890000
169000     END-IF.                                                      16900000
169100                                                                  16910000
169200     ADD +1                        TO ASC-ITEM-SUB.               16920000
169300                                                                  16930000
169400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16940000
169500         ADD +1                    TO ASC-BLK-SUB                 16950000
169600         MOVE +1                   TO ASC-ITEM-SUB                16960000
169700     END-IF.                                                      16970000
169800                                                                  16980000
169900/                                                                 16990000
170000******************************************************************17000000
170100* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *17010000
170200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *17020000
170300******************************************************************17030000
170400 2300-GET-NEXT-RECORD.                                            17040000
170500                                                                  17050000
170600     ADD +1                        TO ASC-SEL-SUB.                17060000
170700     IF ASC-SEL-SUB > TR006-MAX-ITEMS                             17070000
170800         ADD +1                    TO ASC-SEL-ITEM                17080000
170900         MOVE +1                   TO ASC-SEL-SUB                 17090000
171000     END-IF.                                                      17100000
171100     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 17110000
171200         PERFORM 9100-READ-SEL-QUEUE                              17120000
171300         IF TR006-ITEM (ASC-SEL-SUB) > ZERO                       17130000
171400             MOVE TR006-DEST-OPER-UNT-ID (ASC-SEL-SUB)            17140000
171500                                   TO ASC-KEY-DEST-OPER-UNT-ID    17150000
171600             MOVE TR006-DEST-FCLTY-ID (ASC-SEL-SUB)               17160000
171700                                   TO ASC-KEY-DEST-FCLTY-ID       17170000
171800             MOVE TR006-OWNER-SCAC-ID (ASC-SEL-SUB)               17180000
171900                                   TO ASC-KEY-OWNER-SCAC-ID       17190000
172000             MOVE TR006-VEH-NBR (ASC-SEL-SUB)                     17200000
172100                                   TO ASC-KEY-VEH-NBR             17210000
172200             MOVE TR006-MANIFEST-NBR (ASC-SEL-SUB)                17220000
172300                                   TO ASC-KEY-MANIFEST-NBR        17230000
172400             MOVE TR006-TRIP-ID (ASC-SEL-SUB)                     17240000
172500                                   TO ASC-KEY-TRIP-ID             17250000
172600             SET TR006-INQ (ASC-SEL-SUB)                          17260000
172700                                   TO TRUE                        17270000
172800             PERFORM 9200-REWRITE-LIST-QUEUE                      17280000
172900         ELSE                                                     17290000
173000             SUBTRACT +1 FROM ASC-SEL-SUB                         17300000
173100*            --- BOTTOM OF LIST ---                               17310000
173200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            17320000
173300             SET DP020-MSG-INFORMATIONAL                          17330000
173400                                   TO TRUE                        17340000
173500         END-IF                                                   17350000
173600     ELSE                                                         17360000
173700         SUBTRACT +1 FROM ASC-SEL-ITEM                            17370000
173800         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 17380000
173900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            17390000
174000         SET DP020-MSG-INFORMATIONAL                              17400000
174100                                   TO TRUE                        17410000
174200     END-IF.                                                      17420000
174300                                                                  17430000
174400/                                                                 17440000
174500******************************************************************17450000
174600* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *17460000
174700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *17470000
174800******************************************************************17480000
174900 2310-GET-PREV-RECORD.                                            17490000
175000                                                                  17500000
175100     SUBTRACT +1 FROM ASC-SEL-SUB.                                17510000
175200     IF ASC-SEL-SUB < +1                                          17520000
175300         SUBTRACT +1 FROM ASC-SEL-ITEM                            17530000
175400         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 17540000
175500     END-IF.                                                      17550000
175600                                                                  17560000
175700     IF ASC-SEL-ITEM > ZERO                                       17570000
175800         PERFORM 9100-READ-SEL-QUEUE                              17580000
175900         MOVE TR006-DEST-OPER-UNT-ID (ASC-SEL-SUB)                17590000
176000                                   TO ASC-KEY-DEST-OPER-UNT-ID    17600000
176100         MOVE TR006-DEST-FCLTY-ID (ASC-SEL-SUB)                   17610000
176200                                   TO ASC-KEY-DEST-FCLTY-ID       17620000
176300         MOVE TR006-OWNER-SCAC-ID (ASC-SEL-SUB)                   17630000
176400                                   TO ASC-KEY-OWNER-SCAC-ID       17640000
176500         MOVE TR006-VEH-NBR (ASC-SEL-SUB)                         17650000
176600                                   TO ASC-KEY-VEH-NBR             17660000
176700         MOVE TR006-MANIFEST-NBR (ASC-SEL-SUB)                    17670000
176800                                   TO ASC-KEY-MANIFEST-NBR        17680000
176900     ELSE                                                         17690000
177000         MOVE +1                   TO ASC-SEL-ITEM                17700000
177100                                      ASC-SEL-SUB                 17710000
177200*        --- TOP OF LIST ---                                      17720000
177300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            17730000
177400         SET DP020-MSG-INFORMATIONAL                              17740000
177500                                   TO TRUE                        17750000
177600     END-IF.                                                      17760000
177700                                                                  17770000
177701/                                                                 17770100
177702*----------------------------------------------------------------*17770200
177703*  WMS PROCESS PRIOR TO INACTIVATION.                             17770300
177704*----------------------------------------------------------------*17770400
177705 2400-WMS-PROCESS.                                                17770500
177706                                                                  17770600
177707     SET PS-ASNS-TO-WMS-NO TO TRUE.                               17770700
177708     PERFORM 2450-CHECK-TKRPRPM.                                  17770800
177709     IF PS-ASNS-TO-WMS-YES                                        17770900
177710        PERFORM 2600-SELECT-WST-XREF                              17771000
177711     ELSE                                                         17771100
177712        SET PS-INACTIVATE-YES TO TRUE                             17771200
177713     END-IF.                                                      17771300
177714                                                                  17771400
177715*----------------------------------------------------------------*17771500
177716*  CHECK PARM TABLE TO SEE IF DC IS TURNED ON TO DOWNLOAD ASN'S   17771600
177717*  TO WMS.                                                        17771700
177718*----------------------------------------------------------------*17771800
177719 2450-CHECK-TKRPRPM.                                              17771900
177720                                                                  17772000
177721     EXEC SQL                                                     17772100
177722          SELECT   FUNC_TXT                                       17772200
177723            INTO  :KRPRPM-FUNC-TXT                                17772300
177724            FROM                                                  17772400
177725                  TKRPRPM A                                       17772500
177726            WHERE                                                 17772600
177727                  LOC_ID            = :ASC-KEY-DEST-OPER-UNT-ID   17772700
177728              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    17772800
177729              AND FUNC_PRC_STAT_CDE = 'AC'                        17772900
177730              AND INTFC_SYS_CDE     = 'KHL'                       17773000
177740              AND FUNC_TXT          = 'Y'                         17774000
177750              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            17775000
177760     END-EXEC.                                                    17776000
177770                                                                  17777000
177780     EVALUATE TRUE                                                17778000
177790         WHEN SQLCODE = ZERO                                      17779000
177800              SET PS-ASNS-TO-WMS-YES    TO TRUE                   17780000
177900         WHEN SQLCODE = +100                                      17790000
178000              SET PS-ASNS-TO-WMS-NO  TO TRUE                      17800000
178100         WHEN SQLWARN0 NOT = SPACES                               17810000
178200         WHEN SQLCODE  NOT = ZERO                                 17820000
178300             MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)      17830000
178400             SET DP013-DB2-ABEND                                  17840000
178500                                 TO TRUE                          17850000
178600             SET DP013-XCTL-DISPLAY-RESTART                       17860000
178700                                 TO TRUE                          17870000
178800             PERFORM DP013-0000-PROCESS-ABEND                     17880000
178900     END-EVALUATE.                                                17890000
178901                                                                  17890100
178902*----------------------------------------------------------------*17890200
178903*  CHECK WST_SHPMT_XREF_HDR TABLE TO SEE IF RECEIVING HAS BEGUN   17890300
178904*  WHICH WILL STOP THE PACKSLIP FROM BEING INACTIVATED.           17890400
178905*----------------------------------------------------------------*17890500
178906 2600-SELECT-WST-XREF.                                            17890600
178907                                                                  17890700
178908      MOVE ASC-KEY-TRIP-ID  TO DK-TRIP-ID.                        17890800
178909                                                                  17890900
178910* JAK 08/2007 - CHANGE SQL TO USE DEFAULT-TMST-9S                 17891000
178911         EXEC SQL                                                 17891100
178912            SELECT  A.RCPT_TMST                                   17891200
178913              INTO :WST00001-RCPT-TMST                            17891300
178914              FROM  WST_SHPMT_XREF_HDR A                          17891400
178915          WHERE A.INTR_TRIP_ID = :DK-TRIP-ID                      17891500
178916            AND A.SOR_CDE      = 'RC'                             17891600
178917            AND A.RCPT_TMST    < :PC-DEFAULT-TMST-9S              17891700
178918         END-EXEC                                                 17891800
178919                                                                  17891900
178920         EVALUATE TRUE                                            17892000
178921             WHEN SQLCODE = +0                                    17892100
178922             WHEN SQLCODE = -811                                  17892200
178923                 SET PS-INACTIVATE-NO  TO TRUE                    17892300
178924             WHEN SQLCODE = +100                                  17892400
178925                 SET PS-INACTIVATE-YES TO TRUE                    17892500
178926             WHEN SQLCODE = -904                                  17892600
178927             WHEN SQLCODE = -913                                  17892700
178928                 CONTINUE                                         17892800
178929             WHEN SQLWARN0 NOT = SPACE                            17892900
178930             WHEN SQLCODE < +0                                    17893000
178931             WHEN SQLCODE > +0                                    17893100
178932                 MOVE '2600-SELECT-WST-XREF '                     17893200
178933                                 TO DP013-PARAGRAPH               17893300
178934                 MOVE 'SELECT SHIPMENT TABLE'                     17893400
178935                                 TO DP013-MESSAGE-TEXT (1)        17893500
178936                 MOVE SQLCA      TO DP013-SQLCA                   17893600
178937                 MOVE 'WST_SHPMT_XREF' TO DP013-DB2-TABLE-NAME (1)17893700
178938                 SET DP013-DB2-ABEND                              17893800
178939                                 TO TRUE                          17893900
178940                 SET DP013-XCTL-DISPLAY-RESTART                   17894000
178941                                 TO TRUE                          17894100
178942                 PERFORM DP013-0000-PROCESS-ABEND                 17894200
178943         END-EVALUATE.                                            17894300
178944                                                                  17894400
178945*----------------------------------------------------------------*17894500
178946* CALL TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS005) USING     17894600
178947*  COPYBOOK WSWS001.                                              17894700
178948*----------------------------------------------------------------*17894800
178949 2800-CALL-WMS-MODULE.                                            17894900
178950                                                                  17895000
178960     MOVE ASC-KEY-TRIP-ID       TO WS001-TRIP-ID.                 17896000
178970     MOVE SHIPMT-SHIPT-ID       TO WS001-KOHLS-SHIPT-ID.          17897000
178980     MOVE ASC-KEY-DEST-OPER-UNT-ID   TO WS001-OPER-UNT-ID.        17898000
178990     MOVE 'RC'                  TO WS001-SHIPMENT-SOURCE.         17899000
179000     MOVE DP020-USERID          TO WS001-USER-ID.                 17900000
179100     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         17910000
179200     MOVE ZEROS                 TO WS001-PO-NBR.                  17920000
179300     MOVE ZEROS                 TO WS001-RCVR-NBR.                17930000
179400     MOVE ZEROS                 TO WS001-PO-LNE-NBR.              17940000
179500     MOVE ZEROS                 TO WS001-PREPK-ID.                17950000
179600     MOVE ZEROS                 TO WS001-SKU-NBR.                 17960000
179700     MOVE SPACES                TO WS001-DTL-ASN-LEVEL-IND.       17970000
179800     MOVE 'TRKCS114'            TO WS001-CALLING-PROGRAM-NAME.    17980000
179900                                                                  17990000
180000                                                                  18000000
180100*    CALL PC-WMS-CONTROL-MOD     USING  DFHEIBLK                  18010000
180200*                                       PC-WMS-CONTROL-MOD-LENGTH 18020000
180300*                                       WS001-FIELDS.             18030000
180400                                                                  18040000
180500     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         18050000
180600                                                                  18060000
180700     EXEC CICS                                                    18070000
180800         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       18080000
180900              COMMAREA (WS001-FIELDS)                             18090000
181000              LENGTH   (PV-COMMAREA-LENGTH)                       18100000
181100     END-EXEC.                                                    18110000
181200     EVALUATE TRUE                                                18120000
181300         WHEN WS001-SUCCESSFUL                                    18130000
181400              CONTINUE                                            18140000
181500         WHEN WS001-DATABASE-BUSY OR                              18150000
181600              WS001-INVALID-SQL                                   18160000
181700                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       18170000
181800                  SET DP020-MSG-WARNING TO TRUE                   18180000
181900                  SET DP030-OVERRIDE-GO TO TRUE                   18190000
182000                  SET PS-ERROR          TO TRUE                   18200000
182100                                                                  18210000
182200                                                                  18220000
182300              INITIALIZE PV-CICS-MSG-AREA                         18230000
182400              STRING 'RCKCS213-'                                  18240000
182500                     '2800-CALL-WMS-MODULE - '                    18250000
182600                                           DELIMITED BY SIZE      18260000
182700                                      INTO PV-CICS-MSG-AREA       18270000
182800              PERFORM 9903-WRITE-CICS-LOG                         18280000
182900                                                                  18290000
183000              INITIALIZE PV-CICS-MSG-AREA                         18300000
183100              STRING 'RCKCS213-'                                  18310000
183200                     WS001-CRA-RET-MSG                            18320000
183300                                           DELIMITED BY SIZE      18330000
183400                                      INTO PV-CICS-MSG-AREA       18340000
183500              PERFORM 9903-WRITE-CICS-LOG                         18350000
183600                                                                  18360000
183700                                                                  18370000
183800         WHEN WS001-ERROR                                         18380000
183900                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       18390000
184000                  SET DP020-MSG-WARNING TO TRUE                   18400000
184100                  SET DP030-OVERRIDE-GO TO TRUE                   18410000
184200                  SET PS-ERROR          TO TRUE                   18420000
184300                                                                  18430000
184400              INITIALIZE PV-CICS-MSG-AREA                         18440000
184500              STRING 'TRKCS114-'                                  18450000
184600                     '2800-CALL-WMS-MODULE - '                    18460000
184700                                           DELIMITED BY SIZE      18470000
184800                                      INTO PV-CICS-MSG-AREA       18480000
184900              PERFORM 9903-WRITE-CICS-LOG                         18490000
185000                                                                  18500000
185100              INITIALIZE PV-CICS-MSG-AREA                         18510000
185200              STRING 'TRKCS114-'                                  18520000
185300                     WS001-CRA-RET-MSG                            18530000
185301                                           DELIMITED BY SIZE      18530100
185302                                      INTO PV-CICS-MSG-AREA       18530200
185303              PERFORM 9903-WRITE-CICS-LOG                         18530300
185304                                                                  18530400
185305         WHEN OTHER                                               18530500
185306                                                                  18530600
185307              INITIALIZE PV-CICS-MSG-AREA                         18530700
185308              STRING 'TRKCS114-'                                  18530800
185309                     '2800-CALL-RMS-MODULE - '                    18530900
185310                                           DELIMITED BY SIZE      18531000
185311                                      INTO PV-CICS-MSG-AREA       18531100
185312              PERFORM 9903-WRITE-CICS-LOG                         18531200
185313                                                                  18531300
185314              INITIALIZE PV-CICS-MSG-AREA                         18531400
185315              STRING 'TRKCS114-'                                  18531500
185316                     WS001-CRA-RET-MSG                            18531600
185317                                           DELIMITED BY SIZE      18531700
185318                                      INTO PV-CICS-MSG-AREA       18531800
185319              PERFORM 9903-WRITE-CICS-LOG                         18531900
185320                                                                  18532000
185321             MOVE '2800-CALL-WMS-MODULE' TO DP013-PARAGRAPH       18532100
185322             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 18532200
185323                                         TO DP013-MESSAGE-TEXT (1)18532300
185324             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)18532400
185325*            MOVE WS001-SQLCA            TO DP013-SQLCA           18532500
185326             SET DP013-DB2-ABEND                                  18532600
185327                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              18532700
185328             SET PS-ERROR                    TO TRUE              18532800
185329             PERFORM DP013-0000-PROCESS-ABEND                     18532900
185330                                                                  18533000
185331     END-EVALUATE.                                                18533100
185332/                                                                 18533200
185333*----------------------------------------------------------------*18533300
185334*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *18533400
185335*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *18533500
185336*----------------------------------------------------------------*18533600
185337 3000-EDIT-DATA-IN-COMMAREA.                                      18533700
185338                                                                  18533800
185339     SET PS-NO-ERROR               TO TRUE.                       18533900
185340                                                                  18534000
185350     PERFORM 3200-RESET-ATTRIBUTES.                               18535000
185360                                                                  18536000
185370     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18537000
185380**                                                                18538000
185390* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              18539000
185400* EDITTING IS DONE FROM THE BOTTOM UP.                            18540000
185500**                                                                18550000
185600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       18560000
185700         ASC-ITEMS-DISPLAYED - 1.                                 18570000
185800                                                                  18580000
185900     PERFORM 3100-SET-SUBSCRIPTS.                                 18590000
186000     PERFORM 3300-EDIT-SELECTIONS                                 18600000
186100         VARYING PV-SUB                                           18610000
186200         FROM PV-SUB BY -1                                        18620000
186300         UNTIL PV-SUB < +1                                        18630000
186400                                                                  18640000
186500     IF  PS-NO-ERROR                                              18650000
186600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18660000
186700     END-IF.                                                      18670000
186800                                                                  18680000
186900     IF  ((PS-NO-ERROR)                                           18690000
187000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18700000
187100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18710000
187200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18720000
187300     END-IF.                                                      18730000
187400                                                                  18740000
187500/                                                                 18750000
187600*----------------------------------------------------------------*18760000
187700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18770000
187800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18780000
187900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18790000
188000*                                                                *18800000
188100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18810000
188200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18820000
188300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18830000
188400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18840000
188500*----------------------------------------------------------------*18850000
188600                                                                  18860000
188700 3100-SET-SUBSCRIPTS.                                             18870000
188800                                                                  18880000
188900     COMPUTE ASC-ITEM-SUB =                                       18890000
189000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18900000
189100                                                                  18910000
189200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18920000
189300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18930000
189400                                                                  18940000
189500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              18950000
189600                                   TO ASC-BLK-SUB                 18960000
189700     ELSE                                                         18970000
189800         MOVE +1                   TO ASC-BLK-SUB                 18980000
189900     END-IF.                                                      18990000
190000                                                                  19000000
190100*----------------------------------------------------------------*19010000
190200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *19020000
190300*----------------------------------------------------------------*19030000
190400                                                                  19040000
190500 3200-RESET-ATTRIBUTES.                                           19050000
190600                                                                  19060000
190700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   19070000
190800     MOVE DP015-GREEN              TO ASTRTITC.                   19080000
190900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   19090000
191000                                                                  19100000
191100     IF DP020-NEXT-ACT-RETURN                                     19110000
191200     OR DP020-NEXT-ACT-READ-MAP                                   19120000
191300        PERFORM                                                   19130000
191400            VARYING PV-SUB                                        19140000
191500            FROM 1 BY 1                                           19150000
191600            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    19160000
191700            MOVE DP015-UNP-ALP-NOR-OFF                            19170000
191800                                      TO MR-SELECTA (PV-SUB)      19180000
191900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      19190000
192000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      19200000
192100        END-PERFORM                                               19210000
192200     ELSE                                                         19220000
192300        PERFORM                                                   19230000
192400            VARYING PV-SUB                                        19240000
192500            FROM 1 BY 1                                           19250000
192600            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     19260000
192700            MOVE DP015-UNP-ALP-NOR-OFF                            19270000
192800                                      TO MR-SELECTA (PV-SUB)      19280000
192900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      19290000
193000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      19300000
193100        END-PERFORM                                               19310000
193200     END-IF.                                                      19320000
193300                                                                  19330000
193400/                                                                 19340000
193500*----------------------------------------------------------------*19350000
193600*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *19360000
193700*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *19370000
193800*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *19380000
193900*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *19390000
194000*----------------------------------------------------------------*19400000
194100 3300-EDIT-SELECTIONS.                                            19410000
194200                                                                  19420000
194300     EVALUATE TRUE                                                19430000
194400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19440000
194500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         19450000
194600                 CONTINUE                                         19460000
194700                                                                  19470000
194800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         19480000
194900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19490000
195000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS19500000
195100                 MOVE ASC-TEMP-SELECTED-SW                        19510000
195200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19520000
195300                                   TO ASC-SELECTED-SW             19530000
195400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19540000
195500             END-IF                                               19550000
195600                                                                  19560000
195700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19570000
195800                 = SPACE                                          19580000
195900             EVALUATE TRUE                                        19590000
196000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19600000
196100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19610000
196200                     MOVE SPACE    TO ASC-SELECTED-SW             19620000
196300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19630000
196400                                                                  19640000
196500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19650000
196600                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 19660000
196700                     MOVE SPACE    TO ASC-SELECTED-SW             19670000
196800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19680000
196900                                                                  19690000
197000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19700000
197100                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   19710000
197200                     MOVE SPACE    TO ASC-SELECTED-SW             19720000
197300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19730000
197400             END-EVALUATE                                         19740000
197500                                                                  19750000
197600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19760000
197700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19770000
197800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19780000
197900             END-IF                                               19790000
198000             PERFORM 3310-EDIT-RANGE                              19800000
198100                                                                  19810000
198200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19820000
198300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19830000
198400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19840000
198500             END-IF                                               19850000
198600             PERFORM 3310-EDIT-RANGE                              19860000
198700                                                                  19870000
198800         WHEN OTHER                                               19880000
198900             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            19890000
199000             SET DP020-MSG-FATAL   TO TRUE                        19900000
199100             MOVE -1               TO MR-SELECTL (PV-SUB)         19910000
199200             SET DP030-SET-CURSOR-APPL-1                          19920000
199300                                   TO TRUE                        19930000
199400             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         19940000
199500             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         19950000
199600             SET PS-ERROR          TO TRUE                        19960000
199700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19970000
199800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19980000
199900                 MOVE SPACE        TO ASC-SELECTED-SW             19990000
200000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20000000
200100             END-IF                                               20010000
200200     END-EVALUATE.                                                20020000
200300                                                                  20030000
200400     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             20040000
200500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               20050000
200600                                                                  20060000
200700     IF  ASC-ITEM-SUB < 1                                         20070000
200800         SUBTRACT +1 FROM ASC-BLK-SUB                             20080000
200900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                20090000
201000     END-IF.                                                      20100000
201100                                                                  20110000
201200*----------------------------------------------------------------*20120000
201300*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *20130000
201400*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *20140000
201500*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *20150000
201600*  THE ENDING.                                                   *20160000
201700*----------------------------------------------------------------*20170000
201800 3310-EDIT-RANGE.                                                 20180000
201900                                                                  20190000
202000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20200000
202100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20210000
202200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20220000
202300                                   TO ASC-SELECTED-SW             20230000
202400                                        (ASC-BLK-SUB ASC-ITEM-SUB)20240000
202500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20250000
202600         ELSE                                                     20260000
202700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20270000
202800                 CONTINUE                                         20280000
202900             ELSE                                                 20290000
203000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20300000
203100                 MOVE PC-TSYMSG-00054                             20310000
203200                                   TO DP020-MSG-NUMBER            20320000
203300                 SET DP020-MSG-FATAL                              20330000
203400                                   TO TRUE                        20340000
203500                 MOVE -1           TO MR-SELECTL (PV-SUB)         20350000
203600                 SET DP030-SET-CURSOR-APPL-1                      20360000
203700                                   TO TRUE                        20370000
203800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20380000
203900                 MOVE DP015-UNDERLINE                             20390000
204000                                   TO MR-SELECTH (PV-SUB)         20400000
204100                 SET PS-ERROR      TO TRUE                        20410000
204200             END-IF                                               20420000
204300         END-IF                                                   20430000
204400     ELSE                                                         20440000
204500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20450000
204600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20460000
204700                                   TO ASC-SELECTED-SW             20470000
204800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20480000
204900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20490000
205000         ELSE                                                     20500000
205100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20510000
205200                 CONTINUE                                         20520000
205300             ELSE                                                 20530000
205400*                -- ONLY ONE END-OF-RANGE ALLOWED --              20540000
205500                 MOVE PC-TSYMSG-00055                             20550000
205600                                   TO DP020-MSG-NUMBER            20560000
205700                 SET DP020-MSG-FATAL                              20570000
205800                                   TO TRUE                        20580000
205900                 MOVE -1           TO MR-SELECTL (PV-SUB)         20590000
206000                 SET DP030-SET-CURSOR-APPL-1                      20600000
206100                                   TO TRUE                        20610000
206200                 SET PS-ERROR      TO TRUE                        20620000
206300             END-IF                                               20630000
206400         END-IF                                                   20640000
206500     END-IF.                                                      20650000
206600                                                                  20660000
206700*----------------------------------------------------------------*20670000
206800*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *20680000
206900*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *20690000
207000*----------------------------------------------------------------*20700000
207100 3400-CHECK-RANGE-SEQUENCE.                                       20710000
207200                                                                  20720000
207300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20730000
207400       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20740000
207500       AND  ASC-START-OF-SELECTED-RANGE >                         20750000
207600                                         ASC-END-OF-SELECTED-RANGE20760000
207700*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20770000
207800         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            20780000
207900         SET DP020-MSG-FATAL       TO TRUE                        20790000
208000         SET PS-ERROR              TO TRUE                        20800000
208100         PERFORM 3410-POSITION-AT-ERROR                           20810000
208200     END-IF.                                                      20820000
208300                                                                  20830000
208400*----------------------------------------------------------------*20840000
208500*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *20850000
208600*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *20860000
208700*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *20870000
208800*----------------------------------------------------------------*20880000
208900 3410-POSITION-AT-ERROR.                                          20890000
209000                                                                  20900000
209100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       20910000
209200                                                                  20920000
209300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20930000
209400                    - PV-TOP-ITEM + 1.                            20940000
209500                                                                  20950000
209600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20960000
209700         CONTINUE                                                 20970000
209800     ELSE                                                         20980000
209900         MOVE -1                   TO MR-SELECTL (PV-SUB)         20990000
210000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21000000
210100         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21010000
210200     END-IF.                                                      21020000
210300                                                                  21030000
210400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   21040000
210500                    - PV-TOP-ITEM + 1.                            21050000
210600                                                                  21060000
210700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21070000
210800         CONTINUE                                                 21080000
210900     ELSE                                                         21090000
211000         MOVE -1                   TO MR-SELECTL (PV-SUB)         21100000
211100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21110000
211200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21120000
211300     END-IF.                                                      21130000
211400                                                                  21140000
211500/                                                                 21150000
211600*----------------------------------------------------------------*21160000
211700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21170000
211800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21180000
211900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21190000
212000*----------------------------------------------------------------*21200000
212100                                                                  21210000
212200 3500-MARK-RANGE-AS-SELECTED.                                     21220000
212300                                                                  21230000
212400     MOVE +1                       TO ASC-BLK-SUB.                21240000
212500                                                                  21250000
212600     PERFORM 3510-MARK-SELECTED-INDS                              21260000
212700         VARYING ASC-ITEM-SUB                                     21270000
212800         FROM 1 BY 1                                              21280000
212900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21290000
213000                                                                  21300000
213100     ADD +1                        TO ASC-BLK-SUB.                21310000
213200                                                                  21320000
213300     PERFORM 3510-MARK-SELECTED-INDS                              21330000
213400         VARYING ASC-ITEM-SUB                                     21340000
213500         FROM 1 BY 1                                              21350000
213600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21360000
213700                                                                  21370000
213800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21380000
213900                                   TO PV-LIST-ITEM-NUMBER.        21390000
214000                                                                  21400000
214100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21410000
214200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21420000
214300               PC-ITEMS-PER-PANEL).                               21430000
214400                                                                  21440000
214500     MOVE ASC-START-OF-SELECTED-RANGE                             21450000
214600                                   TO PV-START-OF-SELECTED-RANGE. 21460000
214700                                                                  21470000
214800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21480000
214900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21490000
215000               PC-ITEMS-PER-PANEL).                               21500000
215100                                                                  21510000
215200     MOVE ASC-END-OF-SELECTED-RANGE                               21520000
215300                                   TO PV-END-OF-SELECTED-RANGE.   21530000
215400                                                                  21540000
215500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21550000
215600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21560000
215700               PC-ITEMS-PER-PANEL).                               21570000
215800                                                                  21580000
215900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21590000
216000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21600000
216100                                                                  21610000
216200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21620000
216300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21630000
216400         MOVE +1                   TO ASC-BLK-SUB                 21640000
216500         PERFORM 5100-WRITE-TEMP-STORAGE                          21650000
216600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21660000
216700             PV-FIRST-BLOCK-IN-ARRAY - 1                          21670000
216800                                                                  21680000
216900         PERFORM                                                  21690000
217000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21700000
217100                   PV-PREV-BLOCK-IN-ARRAY                         21710000
217200             MOVE PV-FIRST-BLOCK-IN-RANGE                         21720000
217300                                   TO PV-BLOCK-NUMBER             21730000
217400             PERFORM 4410-READ-TEMP-STORAGE                       21740000
217500             PERFORM 3510-MARK-SELECTED-INDS                      21750000
217600                 VARYING ASC-ITEM-SUB                             21760000
217700                 FROM 1 BY 1                                      21770000
217800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21780000
217900             PERFORM 5100-WRITE-TEMP-STORAGE                      21790000
218000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21800000
218100         END-PERFORM                                              21810000
218200                                                                  21820000
218300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21830000
218400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21840000
218500         PERFORM                                                  21850000
218600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21860000
218700                   PV-LAST-BLOCK-IN-RANGE                         21870000
218800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21880000
218900                                   TO PV-BLOCK-NUMBER             21890000
219000             PERFORM 4410-READ-TEMP-STORAGE                       21900000
219100             PERFORM 3510-MARK-SELECTED-INDS                      21910000
219200                 VARYING ASC-ITEM-SUB                             21920000
219300                 FROM 1 BY 1                                      21930000
219400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21940000
219500             PERFORM 5100-WRITE-TEMP-STORAGE                      21950000
219600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21960000
219700         END-PERFORM                                              21970000
219800                                                                  21980000
219900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21990000
220000                                   TO PV-BLOCK-NUMBER             22000000
220100         PERFORM 4410-READ-TEMP-STORAGE                           22010000
220200     END-IF.                                                      22020000
220300                                                                  22030000
220400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 22040000
220500                                      ASC-END-OF-SELECTED-RANGE.  22050000
220600                                                                  22060000
220700/                                                                 22070000
220800*----------------------------------------------------------------*22080000
220900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *22090000
221000*----------------------------------------------------------------*22100000
221100                                                                  22110000
221200 3510-MARK-SELECTED-INDS.                                         22120000
221300                                                                  22130000
221400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         22140000
221500         ASC-START-OF-SELECTED-RANGE)                             22150000
221600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         22160000
221700         ASC-START-OF-SELECTED-RANGE)                             22170000
221800                                                                  22180000
221900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     22190000
222000             ASC-END-OF-SELECTED-RANGE)                           22200000
222100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     22210000
222200             ASC-END-OF-SELECTED-RANGE)                           22220000
222300                                                                  22230000
222400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22240000
222500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   22250000
222600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   22260000
222700                                   TO TRUE                        22270000
222800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22280000
222900                                   TO TRUE                        22290000
223000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS22300000
223100             END-IF                                               22310000
223200         END-IF                                                   22320000
223300     END-IF.                                                      22330000
223400                                                                  22340000
223500/                                                                 22350000
223600*----------------------------------------------------------------*22360000
223700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22370000
223800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22380000
223900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22390000
224000*    DISPLAY THE PANEL TO USER.                                  *22400000
224100*----------------------------------------------------------------*22410000
224200                                                                  22420000
224300 4000-BUILD-INITIAL-PANEL.                                        22430000
224400                                                                  22440000
224500     INITIALIZE ASC-BLOCK-ENTRIES (1)                             22450000
224600                ASC-BLOCK-ENTRIES (2).                            22460000
224700                                                                  22470000
224800     MOVE +1                       TO ASC-BLK-SUB.                22480000
224900                                                                  22490000
225000     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       22500000
225100                                                                  22510000
225200     MOVE +0                       TO ASC-ITEM-SUB                22520000
225300                                      ASC-NUMBER-OF-ITEMS-READ    22530000
225400                                      ASC-NUMBER-OF-SELECTED-ITEMS22540000
225500                                      ASC-HIGHEST-BLOCK-WRITTEN   22550000
225600                                      ASC-START-OF-SELECTED-RANGE 22560000
225700                                      ASC-END-OF-SELECTED-RANGE   22570000
225800                                      ASC-ITEM-AT-TOP-OF-PANEL.   22580000
225900                                                                  22590000
226000     PERFORM 4100-PREPARE-CURSOR.                                 22600000
226100                                                                  22610000
226200     PERFORM 4210-COMBINE-SQL.                                    22620000
226300     PERFORM 4010-DECLARE-CURSOR.                                 22630000
226400     PERFORM 4020-PREPARE-CURSOR.                                 22640000
226500                                                                  22650000
226600     PERFORM 4030-OPEN-CURSOR.                                    22660000
226700                                                                  22670000
226800     PERFORM 4300-READ-ITEMS-FROM-DB.                             22680000
226900                                                                  22690000
227000     PERFORM 4040-CLOSE-CURSOR.                                   22700000
227100                                                                  22710000
227200     MOVE +1                       TO PV-TOP-ITEM.                22720000
227300                                                                  22730000
227400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          22740000
227500         SET DP030-SET-CURSOR-TRAILER                             22750000
227600                                   TO TRUE                        22760000
227700         PERFORM 4050-GET-TRIP                                    22770000
227800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22780000
227900     ELSE                                                         22790000
228000         MOVE -1                   TO MR-SELECTL (1)              22800000
228100         SET DP030-SET-CURSOR-APPL-1                              22810000
228200                                   TO TRUE                        22820000
228300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22830000
228400     END-IF.                                                      22840000
228500                                                                  22850000
228600/                                                                 22860000
228700*----------------------------------------------------------------*22870000
228800*    DECLARE THE CURSOR FOR DYNAMIC SQL CALL                     *22880000
228900*----------------------------------------------------------------*22890000
229000                                                                  22900000
229100 4010-DECLARE-CURSOR.                                             22910000
229200                                                                  22920000
229300     EXEC SQL                                                     22930000
229400         DECLARE SHIP-CSR CURSOR FOR                              22940000
229500                 SHIPMENT-SELECT                                  22950000
229600     END-EXEC.                                                    22960000
229700                                                                  22970000
229800/                                                                 22980000
229900*----------------------------------------------------------------*22990000
230000*    PREPARE THE CURSOR FOR DYNAMIC SQL CALL                     *23000000
230100*----------------------------------------------------------------*23010000
230200                                                                  23020000
230300 4020-PREPARE-CURSOR.                                             23030000
230400                                                                  23040000
230500     EXEC SQL                                                     23050000
230600         PREPARE SHIPMENT-SELECT FROM :PV-SQL-STMT                23060000
230700     END-EXEC.                                                    23070000
230800                                                                  23080000
230900                                                                  23090000
231000     EVALUATE TRUE                                                23100000
231100         WHEN SQLCODE = +0                                        23110000
231200              CONTINUE                                            23120000
231300         WHEN SQLWARN0 NOT = SPACE                                23130000
231400         WHEN SQLCODE  NOT = +0                                   23140000
231500              MOVE '4020-PREPARE-CURSOR'                          23150000
231600                               TO DP013-PARAGRAPH                 23160000
231700              MOVE 'PREPARE CURSOR'                               23170000
231800                               TO DP013-MESSAGE-TEXT (1)          23180000
231900              MOVE SQLCA       TO DP013-SQLCA                     23190000
232000              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        23200000
232100              MOVE 'TSHIPST'   TO DP013-DB2-TABLE-NAME (2)        23210000
232200              MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (3)        23220000
232300              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)        23230000
232400              SET DP013-DB2-ABEND                                 23240000
232500                               TO TRUE                            23250000
232600              PERFORM DP013-0000-PROCESS-ABEND                    23260000
232700     END-EVALUATE.                                                23270000
232800                                                                  23280000
232900/                                                                 23290000
233000*----------------------------------------------------------------*23300000
233100* OPEN THE SHIPMENT CURSOR                                       *23310000
233200*----------------------------------------------------------------*23320000
233300                                                                  23330000
233400 4030-OPEN-CURSOR.                                                23340000
233500                                                                  23350000
233600     PERFORM                                                      23360000
233700         WITH TEST AFTER                                          23370000
233800         VARYING PV-RETRY-COUNTER                                 23380000
233900         FROM 1 BY 1                                              23390000
234000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23400000
234100            OR (SQLCODE = +0))                                    23410000
234200                                                                  23420000
234300         EXEC SQL                                                 23430000
234400             OPEN SHIP-CSR                                        23440000
234500         END-EXEC                                                 23450000
234600                                                                  23460000
234700                                                                  23470000
234800         EVALUATE TRUE                                            23480000
234900             WHEN SQLCODE = +0                                    23490000
235000                  CONTINUE                                        23500000
235100             WHEN SQLCODE = -904                                  23510000
235200             WHEN SQLCODE = -913                                  23520000
235300                  CONTINUE                                        23530000
235400             WHEN SQLWARN0 NOT = SPACE                            23540000
235500             WHEN SQLCODE  NOT = +0                               23550000
235600                  MOVE '4030-OPEN-CURSOR'                         23560000
235700                                   TO DP013-PARAGRAPH             23570000
235800                  MOVE 'OPEN CURSOR'                              23580000
235900                                   TO DP013-MESSAGE-TEXT (1)      23590000
236000                  MOVE SQLCA       TO DP013-SQLCA                 23600000
236100                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    23610000
236200                  MOVE 'TSHIPST'   TO DP013-DB2-TABLE-NAME (2)    23620000
236300                  MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (3)    23630000
236400                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)    23640000
236500                  SET DP013-DB2-ABEND                             23650000
236600                                   TO TRUE                        23660000
236700                  PERFORM DP013-0000-PROCESS-ABEND                23670000
236800         END-EVALUATE                                             23680000
236900     END-PERFORM.                                                 23690000
237000                                                                  23700000
237100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23710000
237200         MOVE '4030-OPEN-CURSOR'   TO DP013-PARAGRAPH             23720000
237300         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              23730000
237400                                   TO DP013-MESSAGE-TEXT (1)      23740000
237500         MOVE SQLCA                TO DP013-SQLCA                 23750000
237600         SET DP013-DB2-ABEND       TO TRUE                        23760000
237700         PERFORM DP013-0000-PROCESS-ABEND                         23770000
237800     END-IF.                                                      23780000
237900                                                                  23790000
238000/                                                                 23800000
238100*----------------------------------------------------------------*23810000
238200* CLOSE THE SHIPMENT CURSOR                                      *23820000
238300*----------------------------------------------------------------*23830000
238400                                                                  23840000
238500 4040-CLOSE-CURSOR.                                               23850000
238600                                                                  23860000
238700     EXEC SQL                                                     23870000
238800         CLOSE SHIP-CSR                                           23880000
238900     END-EXEC.                                                    23890000
239000                                                                  23900000
239100     EVALUATE TRUE                                                23910000
239200         WHEN SQLCODE = +0                                        23920000
239300              CONTINUE                                            23930000
239400         WHEN SQLWARN0 NOT = SPACE                                23940000
239500         WHEN SQLCODE  NOT = +0                                   23950000
239600              MOVE '4040-CLOSE-CURSOR'                            23960000
239700                                   TO DP013-PARAGRAPH             23970000
239800              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      23980000
239900              MOVE SQLCA           TO DP013-SQLCA                 23990000
240000              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (1)    24000000
240100              MOVE 'TSHIPST'       TO DP013-DB2-TABLE-NAME (2)    24010000
240200              MOVE 'TVEHICL'       TO DP013-DB2-TABLE-NAME (3)    24020000
240300              MOVE 'TVHTRIP'       TO DP013-DB2-TABLE-NAME (4)    24030000
240400              SET DP013-DB2-ABEND  TO TRUE                        24040000
240500              PERFORM DP013-0000-PROCESS-ABEND                    24050000
240600     END-EVALUATE.                                                24060000
240700                                                                  24070000
240800/                                                                 24080000
240900*----------------------------------------------------------------*24090000
241000*    GET THE FACILITY NAME                                       *24100000
241100*----------------------------------------------------------------*24110000
241200 4050-GET-TRIP.                                                   24120000
241300                                                                  24130000
241400     PERFORM                                                      24140000
241500         WITH TEST AFTER                                          24150000
241600         VARYING PV-RETRY-COUNTER                                 24160000
241700         FROM 1 BY 1                                              24170000
241800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24180000
241900             OR (SQLCODE = +0)                                    24190000
242000             OR (SQLCODE = -811)                                  24200000
242100             OR (SQLCODE = +100))                                 24210000
242200                                                                  24220000
242300         EXEC SQL                                                 24230000
242400              SELECT A.TRIP_ID,                                   24240000
242500                     A.MANIFEST_NBR                               24250000
242600                INTO :VHTRIP-TRIP-ID,                             24260000
242700                     :VHTRIP-MANIFEST-NBR                         24270000
242800                FROM TVHTRIP A,                                   24280000
242900                     TTRIPST B,                                   24290000
243000                     TTRSTYP C                                    24300000
243100               WHERE A.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID-B        24310000
243200                 AND A.VEH_NBR       = :DK-VEH-NBR-B              24320000
243300                 AND A.TRIP_ID       = B.TRIP_ID                  24330000
243400                 AND B.TRIP_STATUS_CDE NOT IN                     24340000
243500                                  ('DE', 'ET')                    24350000
243600                 AND  C.PRTY_CDE =                                24360000
243700                    (SELECT MAX(E.PRTY_CDE)                       24370000
243800                       FROM TTRIPST D                             24380000
243900                           ,TTRSTYP E                             24390000
244000                      WHERE D.TRIP_ID         = A.TRIP_ID         24400000
244100                        AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)24410000
244200               AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE         24420000
244300         END-EXEC                                                 24430000
244400                                                                  24440000
244500         EVALUATE TRUE                                            24450000
244600             WHEN SQLCODE = +0                                    24460000
244700                  MOVE VHTRIP-TRIP-ID                             24470000
244800                                  TO ASC-KEY-TRIP-ID              24480000
244900                  MOVE VHTRIP-MANIFEST-NBR                        24490000
245000                                  TO ASC-KEY-MANIFEST-NBR         24500000
245100                                                                  24510000
245200             WHEN SQLCODE = +100                                  24520000
245300             WHEN SQLCODE = -811                                  24530000
245400             WHEN SQLCODE = -904                                  24540000
245500             WHEN SQLCODE = -913                                  24550000
245600                  CONTINUE                                        24560000
245700                                                                  24570000
245800             WHEN SQLWARN0 NOT = SPACES                           24580000
245900             WHEN SQLCODE < +0                                    24590000
246000             WHEN SQLCODE > +0                                    24600000
246100                  MOVE '4050-GET-TRIP'                            24610000
246200                                  TO DP013-PARAGRAPH              24620000
246300                  MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'    24630000
246400                                  TO DP013-MESSAGE-TEXT (1)       24640000
246500                  MOVE SQLCA      TO DP013-SQLCA                  24650000
246600                  MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)     24660000
246700                  MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)     24670000
246800                  SET DP013-DB2-ABEND                             24680000
246900                      DP013-XCTL-DISPLAY-RESTART                  24690000
247000                                  TO TRUE                         24700000
247100                  PERFORM DP013-0000-PROCESS-ABEND                24710000
247200         END-EVALUATE                                             24720000
247300     END-PERFORM.                                                 24730000
247400                                                                  24740000
247500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24750000
247600         MOVE '4050-GET-TRIP'                                     24760000
247700                                  TO DP013-PARAGRAPH              24770000
247800         MOVE 'MAX RETRIES EXCEEDED ON SELECT FACILITY TABLE'     24780000
247900                                  TO DP013-MESSAGE-TEXT (1)       24790000
248000         MOVE SQLCA               TO DP013-SQLCA                  24800000
248100         MOVE 'TVHTRIP'           TO DP013-DB2-TABLE-NAME (1)     24810000
248200         MOVE 'TTRIPST'           TO DP013-DB2-TABLE-NAME (2)     24820000
248300         SET DP013-DB2-ABEND                                      24830000
248400             DP013-XCTL-DISPLAY-RESTART                           24840000
248500                                  TO TRUE                         24850000
248600         PERFORM DP013-0000-PROCESS-ABEND                         24860000
248700     END-IF.                                                      24870000
248800                                                                  24880000
248900/                                                                 24890000
249000*----------------------------------------------------------------*24900000
249100*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *24910000
249200*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *24920000
249300*----------------------------------------------------------------*24930000
249400                                                                  24940000
249500 4100-PREPARE-CURSOR.                                             24950000
249600                                                                  24960000
249700     MOVE ZERO                         TO PV-WHERE-BYTES          24970000
249800                                          PV-SUBSCRIPT.           24980000
249900     INITIALIZE PV-WHERE-TABLE                                    24990000
250000                PV-SQL-STMT.                                      25000000
250100     IF   ASC-KEY-DEST-OPER-UNT-ID > ZEROS                        25010000
250200         MOVE ASC-KEY-DEST-OPER-UNT-ID TO DK-DEST-OPER-UNT-ID-B   25020000
250300                                          PV-BLD-OPER-UNT         25030000
250400         MOVE PV-BLD-OPER              TO PV-BUILD-LITERAL        25040000
250500         PERFORM 4200-INSERT-WHERE                                25050000
250600         MOVE PV-BUILD-STATEMENT TO PV-WHERE-LINE (PV-SUBSCRIPT)  25060000
250700     ELSE                                                         25070000
250800         MOVE ZEROS                    TO DK-DEST-OPER-UNT-ID-B   25080000
250900     END-IF.                                                      25090000
251000                                                                  25100000
251100     IF  ASC-KEY-DEST-FCLTY-ID > ZEROES                           25110000
251200         MOVE ASC-KEY-DEST-FCLTY-ID TO DK-DEST-FCLTY-ID-B         25120000
251300                                       PV-BLD-FCLTY-ID            25130000
251400         MOVE PV-BLD-FCLTY             TO PV-BUILD-LITERAL        25140000
251500         PERFORM 4200-INSERT-WHERE                                25150000
251600         MOVE PV-BUILD-STATEMENT TO PV-WHERE-LINE (PV-SUBSCRIPT)  25160000
251700     ELSE                                                         25170000
251800         MOVE ZEROES              TO DK-DEST-FCLTY-ID-B           25180000
251900     END-IF.                                                      25190000
252000                                                                  25200000
252100     IF  ASC-KEY-VEH-NBR > SPACES                                 25210000
252200         MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR-B               25220000
252300                                       PV-BLD-VEH-NBR             25230000
252400         MOVE PV-BLD-VEH            TO PV-BUILD-LITERAL           25240000
252500         PERFORM 4200-INSERT-WHERE                                25250000
252600         STRING PV-BUILD-STATEMENT DELIMITED BY '    '            25260000
252700                PC-7D              DELIMITED BY SIZE              25270000
252800           INTO PV-WHERE-LINE (PV-SUBSCRIPT)                      25280000
252900         END-STRING                                               25290000
253000     ELSE                                                         25300000
253100         MOVE SPACES                TO DK-VEH-NBR-B               25310000
253200     END-IF.                                                      25320000
253300                                                                  25330000
253400     IF  ASC-KEY-OWNER-SCAC-ID > SPACES                           25340000
253500         MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID-B         25350000
253600                                       PV-BLD-SCAC-ID             25360000
253700         MOVE PV-BLD-SCAC           TO PV-BUILD-LITERAL           25370000
253800         PERFORM 4200-INSERT-WHERE                                25380000
253900         STRING PV-BUILD-STATEMENT DELIMITED BY '    '            25390000
254000                PC-7D              DELIMITED BY SIZE              25400000
254100           INTO PV-WHERE-LINE (PV-SUBSCRIPT)                      25410000
254200         END-STRING                                               25420000
254300     ELSE                                                         25430000
254400         MOVE SPACES                TO DK-OWNER-SCAC-ID-B         25440000
254500     END-IF.                                                      25450000
254600                                                                  25460000
254700     IF  ASC-KEY-PRO-SCAC-ID > SPACES                             25470000
254800         MOVE ASC-KEY-PRO-SCAC-ID   TO DK-PRO-SCAC-ID-B           25480000
254900                                       PV-PRO-SCAC-ID             25490000
255000         MOVE PV-PRO-SCAC           TO PV-BUILD-LITERAL           25500000
255100         PERFORM 4200-INSERT-WHERE                                25510000
255200         STRING PV-BUILD-STATEMENT DELIMITED BY '    '            25520000
255300                PC-7D              DELIMITED BY SIZE              25530000
255400           INTO PV-WHERE-LINE (PV-SUBSCRIPT)                      25540000
255500         END-STRING                                               25550000
255600     ELSE                                                         25560000
255700         MOVE SPACES                TO DK-PRO-SCAC-ID-B           25570000
255800     END-IF.                                                      25580000
255900                                                                  25590000
256000     IF  ASC-KEY-PRO-NBR > SPACES                                 25600000
256100         MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR-B               25610000
256200                                       PV-PRO-NBR                 25620000
256300         MOVE PV-PRO                TO PV-BUILD-LITERAL           25630000
256400         PERFORM 4200-INSERT-WHERE                                25640000
256500         STRING PV-BUILD-STATEMENT DELIMITED BY '    '            25650000
256600                PC-7D              DELIMITED BY SIZE              25660000
256700           INTO PV-WHERE-LINE (PV-SUBSCRIPT)                      25670000
256800         END-STRING                                               25680000
256900     ELSE                                                         25690000
257000         MOVE SPACES                TO DK-PRO-NBR-B               25700000
257100     END-IF.                                                      25710000
257200                                                                  25720000
257300     IF  ASC-KEY-BOL-NBR > SPACES                                 25730000
257400         MOVE ASC-KEY-BOL-NBR       TO DK-BOL-NBR-B               25740000
257500                                       PV-BOL-NBR                 25750000
257600         MOVE PV-BOL                TO PV-BUILD-LITERAL           25760000
257700         PERFORM 4200-INSERT-WHERE                                25770000
257800         STRING PV-BUILD-STATEMENT DELIMITED BY '    '            25780000
257900                PC-7D              DELIMITED BY SIZE              25790000
258000           INTO PV-WHERE-LINE (PV-SUBSCRIPT)                      25800000
258100         END-STRING                                               25810000
258200     ELSE                                                         25820000
258300         MOVE SPACES                TO DK-BOL-NBR-B               25830000
258400     END-IF.                                                      25840000
258500                                                                  25850000
258600     EXEC CICS ASSIGN                                             25860000
258700               APPLID(PV-SYSTEM-ID)                               25870000
258800     END-EXEC.                                                    25880000
258900                                                                  25890000
259000     MOVE PV-REGION-IND             TO PV-BUILD-QUAL-1            25900000
259100                                       PV-BUILD-QUAL-2            25910000
259200                                       PV-BUILD-QUAL-3            25920000
259300                                       PV-BUILD-QUAL-4            25930000
259400                                       PV-BUILD-QUAL-5            25940000
259500                                       PV-BUILD-QUAL-6            25950000
259600                                       PV-BUILD-QUAL-7            25960000
259700                                       PV-BUILD-QUAL-8.           25970000
259800                                                                  25980000
259900/                                                                 25990000
260000*----------------------------------------------------------------*26000000
260100*    PLACE A 'WHERE' OR 'AND' IN FRONT OF EACH STATEMENT AND     *26010000
260200*    PUT THE ENTIRE STATEMENT INTO THE TABLE.                    *26020000
260300*----------------------------------------------------------------*26030000
260400                                                                  26040000
260500 4200-INSERT-WHERE.                                               26050000
260600                                                                  26060000
260700     ADD PC-1 TO PV-SUBSCRIPT.                                    26070000
260800     IF PV-SUBSCRIPT = +1                                         26080000
260900         MOVE PV-BLD-WHERE TO PV-BUILD-COMMAND                    26090000
261000     ELSE                                                         26100000
261100         MOVE PV-BLD-AND   TO PV-BUILD-COMMAND                    26110000
261200     END-IF.                                                      26120000
261300     ADD PV-WHERE-SIZE TO PV-WHERE-BYTES.                         26130000
261400                                                                  26140000
261500/                                                                 26150000
261600*----------------------------------------------------------------*26160000
261700*    PLACE A 'WHERE' OR 'AND' IN FRONT OF EACH STATEMENT AND     *26170000
261800*    PUT THE ENTIRE STATEMENT INTO THE TABLE.                    *26180000
261900*----------------------------------------------------------------*26190000
262000                                                                  26200000
262100 4210-COMBINE-SQL.                                                26210000
262200                                                                  26220000
262300     STRING PV-WHERE-LINE (1) DELIMITED BY '   '                  26230000
262400            PV-WHERE-LINE (2) DELIMITED BY '   '                  26240000
262500            PV-WHERE-LINE (3) DELIMITED BY '   '                  26250000
262600            PV-WHERE-LINE (4) DELIMITED BY '   '                  26260000
262700            PV-WHERE-LINE (5) DELIMITED BY '   '                  26270000
262800            PV-WHERE-LINE (6) DELIMITED BY '   '                  26280000
262900            PV-WHERE-LINE (7) DELIMITED BY '   '                  26290000
263000            PV-TABLE-JOIN-ORDER DELIMITED BY SIZE                 26300000
263100       INTO PVBLDSQL-WHERE.                                       26310000
263200     ADD PV-WHERE-BYTES PV-SELECT-BYTES PV-JOIN-BYTES             26320000
263300                             GIVING PV-BUILD-SELECT-LEN.          26330000
263400     MOVE PV-BUILD-SELECT-LEN TO PV-SQL-STMT-LEN.                 26340000
263500     MOVE PV-BUILD-SELECT-STMT TO PV-SQL-STMT-TEXT.               26350000
263600                                                                  26360000
263700                                                                  26370000
263800/                                                                 26380000
263900*----------------------------------------------------------------*26390000
264000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *26400000
264100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *26410000
264200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *26420000
264300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *26430000
264400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *26440000
264500*                                                                *26450000
264600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *26460000
264700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *26470000
264800*    UPON INITIALIZATION.                                        *26480000
264900*----------------------------------------------------------------*26490000
265000                                                                  26500000
265100 4300-READ-ITEMS-FROM-DB.                                         26510000
265200                                                                  26520000
265300     PERFORM                                                      26530000
265400         VARYING PV-READ-COUNT                                    26540000
265500         FROM 1 BY 1                                              26550000
265600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26560000
265700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         26570000
265800                                                                  26580000
265900         PERFORM 4310-FETCH                                       26590000
266000                                                                  26600000
266100         IF  ASC-ITEMS-LEFT-ON-DB                                 26610000
266200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26620000
266300                 ADD +1            TO ASC-ITEM-SUB                26630000
266400             ELSE                                                 26640000
266500                 ADD +1            TO ASC-BLK-SUB                 26650000
266600                 MOVE +1           TO ASC-ITEM-SUB                26660000
266700                                                                  26670000
266800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26680000
266900                     MOVE +1       TO ASC-BLK-SUB                 26690000
267000                     SET ASC-BLOCK-MODIFIED (1)                   26700000
267100                                   TO TRUE                        26710000
267200                     PERFORM 5100-WRITE-TEMP-STORAGE              26720000
267300                     MOVE ASC-BLOCK-ENTRIES                       26730000
267400                               (PC-MAX-BLOCKS-IN-ARRAY)           26740000
267500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26750000
267600                     ADD +1        TO ASC-BLK-SUB                 26760000
267700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26770000
267800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26780000
267900                                   TO TRUE                        26790000
268000                 END-IF                                           26800000
268100             END-IF                                               26810000
268200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26820000
268300             MOVE ASC-NUMBER-OF-ITEMS-READ                        26830000
268400                                   TO ASC-LIST-ITEM-NUMBER        26840000
268500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26850000
268600             MOVE SHIPMT-PRO-SCAC-ID                              26860000
268700                                   TO ASC-PRO-SCAC                26870000
268800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26880000
268900             MOVE SHIPMT-PRO-NBR   TO ASC-PRO-NBR                 26890000
269000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26900000
269100             MOVE SHIPMT-BOL-NBR   TO ASC-BOL-NBR                 26910000
269200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26920000
269300             EVALUATE TRUE                                        26930000
269400               WHEN SHSTYP-PRTY-CDE < '10'                        26940000
269500               WHEN SHSTYP-PRTY-CDE > '20' AND < '49'             26950000
269600                   MOVE 'EN'       TO ASC-STATUS-CDE              26960000
269700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26970000
269800               WHEN SHSTYP-PRTY-CDE = '49'                        26980000
269900                   MOVE 'AR'       TO ASC-STATUS-CDE              26990000
270000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27000000
270100               WHEN SHSTYP-PRTY-CDE = '70'                        27010000
270200                   MOVE 'UN'       TO ASC-STATUS-CDE              27020000
270300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27030000
270400               WHEN SHSTYP-PRTY-CDE = '20'                        27040000
270500                   MOVE 'LD'       TO ASC-STATUS-CDE              27050000
270600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27060000
270700               WHEN OTHER                                         27070000
270800                   MOVE SHIPST-SHIPT-STATUS-CDE                   27080000
270900                                   TO ASC-STATUS-CDE              27090000
271000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27100000
271100             END-EVALUATE                                         27110000
271200             MOVE SHIPST-STATUS-DTE                               27120000
271300                                   TO PV-EDIT-DATE                27130000
271400             STRING PV-EDIT-DATE-MM DELIMITED BY SIZE             27140000
271500                    PV-EDIT-DATE-DD DELIMITED BY SIZE             27150000
271600                    PV-EDIT-DATE-YY DELIMITED BY SIZE             27160000
271700                                 INTO ASC-STATUS-DTE              27170000
271800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27180000
271900             MOVE SHIPST-STATUS-DTE                               27190000
272000                                   TO ASC-STATUS-DTE-ISO          27200000
272100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27210000
272200             MOVE SHIPST-STATUS-TME                               27220000
272300                                   TO PV-EDIT-TIME                27230000
272400             STRING PV-EDIT-TIME-HH DELIMITED BY SIZE             27240000
272500                    ':'        DELIMITED BY SIZE                  27250000
272600                    PV-EDIT-TIME-MM DELIMITED BY SIZE             27260000
272700                                 INTO ASC-STATUS-TME              27270000
272800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27280000
272900             MOVE SHIPMT-SHIPT-ID  TO DK-SHIPT-ID                 27290000
273000             INITIALIZE PV-DB2-COUNT                              27300000
273100             PERFORM 4330-COUNT-PO                                27310000
273200             MOVE PV-DB2-COUNT     TO ASC-PO-CNT                  27320000
273300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27330000
273400             MOVE SHIPMT-PKG-TYP-CDE                              27340000
273500                                   TO ASC-PKG                     27350000
273600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27360000
273700             IF SHIPMT-EXPTED-PKG-QTY > 0                         27370000
273800                 MOVE SHIPMT-EXPTED-PKG-QTY                       27380000
273900                                   TO ASC-QTY                     27390000
274000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27400000
274100             ELSE                                                 27410000
274200                 IF SHIPMT-CARR-CART-CT > 0                       27420000
274300                     MOVE SHIPMT-CARR-CART-CT                     27430000
274400                                   TO ASC-QTY                     27440000
274500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27450000
274600                 ELSE                                             27460000
274700                     MOVE SHIPMT-VEND-CART-CT                     27470000
274800                                   TO ASC-QTY                     27480000
274900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27490000
275000                 END-IF                                           27500000
275100             END-IF                                               27510000
275200             MOVE SHIPMT-EXPTED-GRO-WGHT                          27520000
275300                                   TO ASC-WGT                     27530000
275400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27540000
275500             MOVE SHIPMT-EXPTED-PLT-QTY                           27550000
275600                                   TO ASC-PLT                     27560000
275700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27570000
275800             MOVE VEHICL-OWNER-SCAC-ID                            27580000
275900                                   TO ASC-OWNER-SCAC-ID           27590000
276000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27600000
276100             MOVE VEHICL-VEH-NBR   TO ASC-VEH-NBR                 27610000
276200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27620000
276300             MOVE VEHICL-CURR-OPER-UNT-ID                         27630000
276400                                   TO ASC-OPER-UNT-ID             27640000
276500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27650000
276600             MOVE VEHICL-CURR-FCLTY-ID                            27660000
276700                                   TO ASC-FCLTY-ID                27670000
276800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27680000
276900             MOVE VHTRIP-MANIFEST-NBR                             27690000
277000                                   TO ASC-MANIFEST-NBR            27700000
277100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27710000
277200             MOVE SHIPMT-TRIP-ID   TO ASC-TRIP-ID                 27720000
277300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27730000
277400                                      ASC-KEY-TRIP-ID             27740000
277500             MOVE SHIPMT-SHIPT-ID  TO ASC-SHIPT-ID                27750000
277600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27760000
277700         END-IF                                                   27770000
277800     END-PERFORM.                                                 27780000
277900                                                                  27790000
278000     MOVE VEHICL-CURR-FCLTY-ID     TO DK-DEST-FCLTY-ID-B.         27800000
278100     PERFORM 4320-GET-FCLTY-NAME.                                 27810000
278200                                                                  27820000
278300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          27830000
278400         MOVE +1                   TO ASC-BLK-SUB                 27840000
278500         PERFORM 5100-WRITE-TEMP-STORAGE                          27850000
278600         ADD +1                    TO ASC-BLK-SUB                 27860000
278700         PERFORM 5100-WRITE-TEMP-STORAGE                          27870000
278800                                                                  27880000
278900         MOVE 1                    TO ASC-BLK-SUB                 27890000
279000                                      PV-BLOCK-NUMBER             27900000
279100         PERFORM 4410-READ-TEMP-STORAGE                           27910000
279200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27920000
279300             MOVE 2                TO ASC-BLK-SUB                 27930000
279400                                      PV-BLOCK-NUMBER             27940000
279500             PERFORM 4410-READ-TEMP-STORAGE                       27950000
279600         END-IF                                                   27960000
279700     END-IF.                                                      27970000
279800                                                                  27980000
279900/                                                                 27990000
280000*----------------------------------------------------------------*28000000
280100*    FETCH A VEHICLE ROW                                         *28010000
280200*----------------------------------------------------------------*28020000
280300                                                                  28030000
280400 4310-FETCH.                                                      28040000
280500                                                                  28050000
280600     EXEC SQL                                                     28060000
280700         FETCH SHIP-CSR                                           28070000
280800          INTO :SHIPMT-TRIP-ID                                    28080000
280900              ,:SHIPMT-SHIPT-ID                                   28090000
281000              ,:SHIPMT-PRO-SCAC-ID                                28100000
281100              ,:SHIPMT-PRO-NBR                                    28110000
281200              ,:SHIPMT-BOL-NBR                                    28120000
281300              ,:SHIPMT-PKG-TYP-CDE                                28130000
281400              ,:SHIPMT-EXPTED-PKG-QTY                             28140000
281500              ,:SHIPMT-EXPTED-GRO-WGHT                            28150000
281600              ,:SHIPMT-EXPTED-PLT-QTY                             28160000
281700              ,:SHIPMT-CARR-CART-CT                               28170000
281800              ,:SHIPMT-VEND-CART-CT                               28180000
281900              ,:SHIPST-SHIPT-STATUS-CDE                           28190000
282000              ,:SHIPST-STATUS-DTE                                 28200000
282100              ,:SHIPST-STATUS-TME                                 28210000
282200              ,:VEHICL-OWNER-SCAC-ID                              28220000
282300              ,:VEHICL-VEH-NBR                                    28230000
282400              ,:VEHICL-CURR-OPER-UNT-ID                           28240000
282500              ,:VEHICL-CURR-FCLTY-ID                              28250000
282600              ,:VHTRIP-MANIFEST-NBR                               28260000
282700              ,:SHSTYP-PRTY-CDE                                   28270000
282800     END-EXEC.                                                    28280000
282900                                                                  28290000
283000     EVALUATE TRUE                                                28300000
283100         WHEN SQLCODE = +0                                        28310000
283200              CONTINUE                                            28320000
283300                                                                  28330000
283400         WHEN SQLCODE = +100                                      28340000
283500              SET ASC-NO-ITEMS-LEFT-ON-DB                         28350000
283600                                   TO TRUE                        28360000
283700                                                                  28370000
283800         WHEN SQLWARN0 NOT = SPACE                                28380000
283900         WHEN SQLCODE < +0                                        28390000
284000         WHEN SQLCODE > +0                                        28400000
284100              MOVE '4310-FETCH-CURSOR'                            28410000
284200                                   TO DP013-PARAGRAPH             28420000
284300              MOVE 'FETCH SHIPMENT CURSOR'                        28430000
284400                                   TO DP013-MESSAGE-TEXT (1)      28440000
284500              MOVE SQLCA           TO DP013-SQLCA                 28450000
284600              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (1)    28460000
284700              MOVE 'TSHIPST'       TO DP013-DB2-TABLE-NAME (2)    28470000
284800              MOVE 'TVEHICL'       TO DP013-DB2-TABLE-NAME (3)    28480000
284900              MOVE 'TVHTRIP'       TO DP013-DB2-TABLE-NAME (4)    28490000
285000              SET DP013-DB2-ABEND  TO TRUE                        28500000
285100              PERFORM DP013-0000-PROCESS-ABEND                    28510000
285200     END-EVALUATE.                                                28520000
285300                                                                  28530000
285400/                                                                 28540000
285500*----------------------------------------------------------------*28550000
285600*    GET THE FACILITY NAME                                       *28560000
285700*----------------------------------------------------------------*28570000
285800 4320-GET-FCLTY-NAME.                                             28580000
285900                                                                  28590000
286000     PERFORM                                                      28600000
286100         WITH TEST AFTER                                          28610000
286200         VARYING PV-RETRY-COUNTER                                 28620000
286300         FROM 1 BY 1                                              28630000
286400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28640000
286500             OR (SQLCODE = +0)                                    28650000
286600             OR (SQLCODE = +100))                                 28660000
286700                                                                  28670000
286800         EXEC SQL                                                 28680000
286900              SELECT FCLTY_NME                                    28690000
287000                INTO :FACLTY-FCLTY-NME                            28700000
287100                FROM TFACLTY                                      28710000
287200               WHERE OPER_UNT_ID = :DK-DEST-OPER-UNT-ID-B         28720000
287300                 AND FCLTY_ID    = :DK-DEST-FCLTY-ID-B            28730000
287400         END-EXEC                                                 28740000
287500                                                                  28750000
287600         EVALUATE TRUE                                            28760000
287700             WHEN SQLCODE = +0                                    28770000
287800                  MOVE FACLTY-FCLTY-NME                           28780000
287900                                  TO ASC-FCLTY-NME                28790000
288000                                                                  28800000
288100             WHEN SQLCODE = +100                                  28810000
288200                  MOVE SPACES     TO ASC-FCLTY-NME                28820000
288300                                                                  28830000
288400             WHEN SQLCODE = -904                                  28840000
288500             WHEN SQLCODE = -913                                  28850000
288600                  CONTINUE                                        28860000
288700                                                                  28870000
288800             WHEN SQLWARN0 NOT = SPACES                           28880000
288900             WHEN SQLCODE < +0                                    28890000
289000             WHEN SQLCODE > +0                                    28900000
289100                  MOVE '4320-GET-FCLTY-NAME'                      28910000
289200                                  TO DP013-PARAGRAPH              28920000
289300                  MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'    28930000
289400                                  TO DP013-MESSAGE-TEXT (1)       28940000
289500                  MOVE SQLCA      TO DP013-SQLCA                  28950000
289600                  MOVE 'TFACLTY ' TO DP013-DB2-TABLE-NAME (1)     28960000
289700                  SET DP013-DB2-ABEND                             28970000
289800                      DP013-XCTL-DISPLAY-RESTART                  28980000
289900                                  TO TRUE                         28990000
290000                  PERFORM DP013-0000-PROCESS-ABEND                29000000
290100         END-EVALUATE                                             29010000
290200     END-PERFORM.                                                 29020000
290300                                                                  29030000
290400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29040000
290500         MOVE '4320-GET-FCLTY-NAME'                               29050000
290600                                  TO DP013-PARAGRAPH              29060000
290700         MOVE 'MAX RETRIES EXCEEDED ON SELECT FACILITY TABLE'     29070000
290800                                  TO DP013-MESSAGE-TEXT (1)       29080000
290900         MOVE SQLCA               TO DP013-SQLCA                  29090000
291000         MOVE 'TFACLTY'           TO DP013-DB2-TABLE-NAME (1)     29100000
291100         SET DP013-DB2-ABEND                                      29110000
291200             DP013-XCTL-DISPLAY-RESTART                           29120000
291300                                  TO TRUE                         29130000
291400         PERFORM DP013-0000-PROCESS-ABEND                         29140000
291500     END-IF.                                                      29150000
291600                                                                  29160000
291700/                                                                 29170000
291800*----------------------------------------------------------------*29180000
291900*    COUNT THE NUMBER OF PO'S FOR THE SHIPMENT                   *29190000
292000*----------------------------------------------------------------*29200000
292100 4330-COUNT-PO.                                                   29210000
292200                                                                  29220000
292300     PERFORM                                                      29230000
292400         WITH TEST AFTER                                          29240000
292500         VARYING PV-RETRY-COUNTER                                 29250000
292600         FROM 1 BY 1                                              29260000
292700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29270000
292800             OR (SQLCODE = +0)                                    29280000
292900             OR (SQLCODE = +100))                                 29290000
293000                                                                  29300000
293100         EXEC SQL                                                 29310000
293200              SELECT COUNT(*)                                     29320000
293300                INTO :PV-DB2-COUNT                                29330000
293400                FROM TSHPTPO                                      29340000
293500               WHERE SHIPT_ID = :DK-SHIPT-ID                      29350000
293600         END-EXEC                                                 29360000
293700                                                                  29370000
293800         EVALUATE TRUE                                            29380000
293900             WHEN SQLCODE = +0                                    29390000
294000             WHEN SQLCODE = +100                                  29400000
294100             WHEN SQLCODE = -904                                  29410000
294200             WHEN SQLCODE = -913                                  29420000
294300                  CONTINUE                                        29430000
294400                                                                  29440000
294500             WHEN SQLWARN0 NOT = SPACES                           29450000
294600             WHEN SQLCODE < +0                                    29460000
294700             WHEN SQLCODE > +0                                    29470000
294800                  MOVE '4330-COUNT-PO'                            29480000
294900                                  TO DP013-PARAGRAPH              29490000
295000                  MOVE 'UNSUCCESSFUL SELECT ON TSHPTPO TABLE'     29500000
295100                                  TO DP013-MESSAGE-TEXT (1)       29510000
295200                  MOVE SQLCA      TO DP013-SQLCA                  29520000
295300                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     29530000
295400                  SET DP013-DB2-ABEND                             29540000
295500                      DP013-XCTL-DISPLAY-RESTART                  29550000
295600                                  TO TRUE                         29560000
295700                  PERFORM DP013-0000-PROCESS-ABEND                29570000
295800         END-EVALUATE                                             29580000
295900     END-PERFORM.                                                 29590000
296000                                                                  29600000
296100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29610000
296200         MOVE '4330-COUNT-PO'     TO DP013-PARAGRAPH              29620000
296300         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHPTPO TABLE'      29630000
296400                                  TO DP013-MESSAGE-TEXT (1)       29640000
296500         MOVE SQLCA               TO DP013-SQLCA                  29650000
296600         MOVE 'TSHPTPO'           TO DP013-DB2-TABLE-NAME (1)     29660000
296700         SET DP013-DB2-ABEND                                      29670000
296800             DP013-XCTL-DISPLAY-RESTART                           29680000
296900                                  TO TRUE                         29690000
297000         PERFORM DP013-0000-PROCESS-ABEND                         29700000
297100     END-IF.                                                      29710000
297200                                                                  29720000
297300/                                                                 29730000
297400*----------------------------------------------------------------*29740000
297500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *29750000
297600*----------------------------------------------------------------*29760000
297700                                                                  29770000
297800 4400-MOVE-COMMAREA-TO-SCREEN.                                    29780000
297900                                                                  29790000
298000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             29800000
298100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          29810000
298200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          29820000
298300             MOVE +1               TO ASC-BLK-SUB                 29830000
298400             PERFORM 5100-WRITE-TEMP-STORAGE                      29840000
298500             ADD +1                TO ASC-BLK-SUB                 29850000
298600             PERFORM 5100-WRITE-TEMP-STORAGE                      29860000
298700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             29870000
298800                 GIVING PV-BLOCK-NUMBER                           29880000
298900                 REMAINDER PV-REMAINDER                           29890000
299000             IF  PV-REMAINDER > ZERO                              29900000
299100                 ADD +1            TO PV-BLOCK-NUMBER             29910000
299200             END-IF                                               29920000
299300             MOVE +1               TO ASC-BLK-SUB                 29930000
299400             PERFORM 4410-READ-TEMP-STORAGE                       29940000
299500             ADD +1                TO ASC-BLK-SUB                 29950000
299600                                      PV-BLOCK-NUMBER             29960000
299700             PERFORM 4410-READ-TEMP-STORAGE                       29970000
299800     END-IF.                                                      29980000
299900                                                                  29990000
300000     MOVE +1                       TO ASC-BLK-SUB.                30000000
300100                                                                  30010000
300200     COMPUTE ASC-ITEM-SUB =                                       30020000
300300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              30030000
300400         + PC-ITEMS-PER-PANEL).                                   30040000
300500                                                                  30050000
300600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30060000
300700         ADD +1                    TO ASC-BLK-SUB                 30070000
300800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30080000
300900     END-IF.                                                      30090000
301000                                                                  30100000
301100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           30110000
301200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                30120000
301300                                                                  30130000
301400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        30140000
301500     PERFORM 4420-FORMAT-LIST-LINES                               30150000
301600         VARYING PV-SUB                                           30160000
301700         FROM PC-ITEMS-PER-PANEL BY -1                            30170000
301800         UNTIL PV-SUB < +1.                                       30180000
301900                                                                  30190000
302000     COMPUTE ASC-ITEMS-DISPLAYED =                                30200000
302100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          30210000
302200                                                                  30220000
302300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    30230000
302400                                      ASTRTITO.                   30240000
302500                                                                  30250000
302600     MOVE ASC-KEY-DEST-OPER-UNT-ID TO AOPERO.                     30260000
302700     MOVE ASC-KEY-DEST-FCLTY-ID    TO AFCLTYO.                    30270000
302800     MOVE ASC-FCLTY-NME            TO AFDESCO.                    30280000
302900     MOVE ASC-KEY-OWNER-SCAC-ID    TO ADSCACO.                    30290000
303000     MOVE ASC-KEY-VEH-NBR          TO ATRLRO.                     30300000
303100     MOVE ASC-KEY-MANIFEST-NBR     TO AMANO.                      30310000
303200                                                                  30320000
303300     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    30330000
303400     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    30340000
303500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30350000
303600                                   TO ASELITO.                    30360000
303700                                                                  30370000
303800     IF  DP020-MSG-NUMBER-X = SPACE                               30380000
303900         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  30390000
304000*            --- MORE ITEMS TO DISPLAY ----                       30400000
304100             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            30410000
304200             SET DP020-MSG-INFORMATIONAL                          30420000
304300                                   TO TRUE                        30430000
304400         END-IF                                                   30440000
304500     END-IF.                                                      30450000
304600                                                                  30460000
304700*----------------------------------------------------------------*30470000
304800*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *30480000
304900*----------------------------------------------------------------*30490000
305000                                                                  30500000
305100 4410-READ-TEMP-STORAGE.                                          30510000
305200                                                                  30520000
305300     EXEC CICS                                                    30530000
305400         READQ TS                                                 30540000
305500             QUEUE (ASC-LIST-QUEUE-NAME)                          30550000
305600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30560000
305700             ITEM  (PV-BLOCK-NUMBER)                              30570000
305800             RESP  (PV-CICS-RESP)                                 30580000
305900     END-EXEC.                                                    30590000
306000                                                                  30600000
306100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       30610000
306200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     30620000
306300         CONTINUE                                                 30630000
306400     ELSE                                                         30640000
306500         SET DP013-CICS-ABEND      TO TRUE                        30650000
306600         SET DP013-NO-ROLLBACK     TO TRUE                        30660000
306700         MOVE '4410-READ-TEMP-STORAGE'                            30670000
306800                                   TO DP013-PARAGRAPH             30680000
306900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      30690000
307000                                   TO DP013-MESSAGE-TEXT(1)       30700000
307100         PERFORM DP013-0000-PROCESS-ABEND                         30710000
307200     END-IF.                                                      30720000
307300                                                                  30730000
307400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      30740000
307500                                   TO TRUE.                       30750000
307600                                                                  30760000
307700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         30770000
307800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               30780000
307900     END-IF.                                                      30790000
308000                                                                  30800000
308100/                                                                 30810000
308200*----------------------------------------------------------------*30820000
308300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *30830000
308400*----------------------------------------------------------------*30840000
308500                                                                  30850000
308600 4420-FORMAT-LIST-LINES.                                          30860000
308700                                                                  30870000
308800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      30880000
308900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                30890000
309000         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         30900000
309100         MOVE ZEROES               TO AOPERO                      30910000
309200                                      AFCLTYO                     30920000
309300         MOVE SPACES               TO AFDESCO                     30930000
309400                                      MR-SELECT  (PV-SUB)         30940000
309500                                      MR-PRO-SCAC (PV-SUB)        30950000
309600                                      MR-PRO-NBR  (PV-SUB)        30960000
309700                                      MR-BOL-NBR  (PV-SUB)        30970000
309800                                      MR-STATUS-CDE (PV-SUB)      30980000
309900                                      MR-STATUS-DTE (PV-SUB)      30990000
310000                                      MR-STATUS-TME (PV-SUB)      31000000
310100                                      MR-PO-CNT-X (PV-SUB)        31010000
310200                                      MR-PKG (PV-SUB)             31020000
310300                                      MR-QTY-X (PV-SUB)           31030000
310400                                      MR-WGT-X (PV-SUB)           31040000
310500                                      MR-PLT-X (PV-SUB)           31050000
310600     ELSE                                                         31060000
310700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      31070000
310800                                                   > SPACE        31080000
310900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 31090000
311000                                   TO MR-SELECT (PV-SUB)          31100000
311100         ELSE                                                     31110000
311200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      31120000
311300                                   TO MR-SELECT (PV-SUB)          31130000
311400         END-IF                                                   31140000
311500                                                                  31150000
311600         IF  DP030-SET-CURSOR-TRAILER                             31160000
311700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)31170000
311800                 > SPACE)                                         31180000
311900               OR (PV-SUB = 1))                                   31190000
312000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               31200000
312100                MOVE -1            TO MR-SELECTL (PV-SUB)         31210000
312200             END-IF                                               31220000
312300         END-IF                                                   31230000
312400                                                                  31240000
312500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           31250000
312600             MOVE ASC-PRO-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)         31260000
312700                                   TO MR-PRO-SCAC (PV-SUB)        31270000
312800             MOVE ASC-PRO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          31280000
312900                                   TO MR-PRO-NBR (PV-SUB)         31290000
313000             MOVE ASC-BOL-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          31300000
313100                                   TO MR-BOL-NBR (PV-SUB)         31310000
313200             MOVE ASC-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)       31320000
313300                                   TO MR-STATUS-CDE (PV-SUB)      31330000
313400             MOVE ASC-STATUS-DTE (ASC-BLK-SUB ASC-ITEM-SUB)       31340000
313500                                   TO MR-STATUS-DTE (PV-SUB)      31350000
313600             MOVE ASC-STATUS-TME (ASC-BLK-SUB ASC-ITEM-SUB)       31360000
313700                                   TO MR-STATUS-TME (PV-SUB)      31370000
313800             MOVE ASC-PO-CNT (ASC-BLK-SUB ASC-ITEM-SUB)           31380000
313900                                   TO MR-PO-CNT (PV-SUB)          31390000
314000             MOVE ASC-PKG (ASC-BLK-SUB ASC-ITEM-SUB)              31400000
314100                                   TO MR-PKG (PV-SUB)             31410000
314200             MOVE ASC-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              31420000
314300                                   TO MR-QTY (PV-SUB)             31430000
314400             MOVE ASC-WGT (ASC-BLK-SUB ASC-ITEM-SUB)              31440000
314500                                   TO MR-WGT (PV-SUB)             31450000
314600             MOVE ASC-PLT (ASC-BLK-SUB ASC-ITEM-SUB)              31460000
314700                                   TO MR-PLT (PV-SUB)             31470000
314800         END-IF                                                   31480000
314900     END-IF.                                                      31490000
315000                                                                  31500000
315100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               31510000
315200                                                                  31520000
315300     IF  ASC-ITEM-SUB < + 1                                       31530000
315400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                31540000
315500         MOVE +1                   TO ASC-BLK-SUB                 31550000
315600     END-IF.                                                      31560000
315700                                                                  31570000
315800*----------------------------------------------------------------*31580000
315900*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *31590000
316000*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *31600000
316100*  ISSUE A WARNING.                                              *31610000
316200*----------------------------------------------------------------*31620000
316300 4430-CHECK-FOR-BEGIN-AND-END.                                    31630000
316400                                                                  31640000
316500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       31650000
316600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     31660000
316700*            -- NO END-OF-RANGE SPECFIED ---                      31670000
316800             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            31680000
316900             SET DP020-MSG-WARNING TO TRUE                        31690000
317000             PERFORM 4431-POSITION-AT-WARNING                     31700000
317100         END-IF                                                   31710000
317200     ELSE                                                         31720000
317300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     31730000
317400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                31740000
317500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            31750000
317600             SET DP020-MSG-WARNING TO TRUE                        31760000
317700             PERFORM 4431-POSITION-AT-WARNING                     31770000
317800         END-IF                                                   31780000
317900     END-IF.                                                      31790000
318000                                                                  31800000
318100*----------------------------------------------------------------*31810000
318200*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *31820000
318300*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *31830000
318400*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *31840000
318500*  POSITION THE CURSOR THERE.                                    *31850000
318600*----------------------------------------------------------------*31860000
318700 4431-POSITION-AT-WARNING.                                        31870000
318800                                                                  31880000
318900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 31890000
319000                    - PV-TOP-ITEM + 1.                            31900000
319100                                                                  31910000
319200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31920000
319300         CONTINUE                                                 31930000
319400     ELSE                                                         31940000
319500         SET DP030-SET-CURSOR-APPL-1                              31950000
319600                                   TO TRUE                        31960000
319700         MOVE -1                   TO MR-SELECTL (PV-SUB)         31970000
319800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31980000
319900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         31990000
320000     END-IF.                                                      32000000
320100                                                                  32010000
320200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   32020000
320300                    - PV-TOP-ITEM + 1.                            32030000
320400                                                                  32040000
320500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32050000
320600         CONTINUE                                                 32060000
320700     ELSE                                                         32070000
320800         SET DP030-SET-CURSOR-APPL-1                              32080000
320900                                   TO TRUE                        32090000
321000         MOVE -1                   TO MR-SELECTL (PV-SUB)         32100000
321100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         32110000
321200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         32120000
321300     END-IF.                                                      32130000
321400                                                                  32140000
321401                                                                  32140101
321402*----------------------------------------------------------------*32140201
321403*                                                                *32140301
321404*  DMH 01/13/15                                                 -*32140401
321405*----------------------------------------------------------------*32140501
321410 4500-DETACH-SHIPMENT.                                            32141001
321411                                                                  32141101
321412     MOVE +1                       TO ASC-BLK-SUB.                32141201
321413     PERFORM 5100-WRITE-TEMP-STORAGE.                             32141301
321414     ADD +1                        TO ASC-BLK-SUB.                32141401
321415     PERFORM 5100-WRITE-TEMP-STORAGE.                             32141501
321416                                                                  32141601
321417     PERFORM 6112-READ-LIST-QUEUE.                                32141701
321418                                                                  32141801
321419     IF PV-CICS-RESP = DFHRESP (NORMAL)                           32141901
321420         PERFORM                                                  32142001
321421         VARYING LQW-IDX  FROM 1 BY 1                             32142101
321422         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL   OR                32142201
321424                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO  OR        32142401
321426                 PS-ERROR                                         32142601
321427             IF  LQW-SELECT (LQW-IDX)                             32142701
321428                 MOVE LQW-SHIPT-ID (LQW-IDX) TO DK-SHIPT-ID       32142801
321429                                                                  32142901
321438                 MOVE ZERO TO PV-DB2-COUNT                        32143801
321439                 PERFORM 5250-COUNT-VERIFIED-RCVRS                32143901
321440                                                                  32144001
321441                 IF  PV-DB2-COUNT = 0                             32144101
321442                     ADD 1 TO PV-NUMBER-OF-UPDATES                32144201
321443                     PERFORM 7000-DETACH-SHIPMENT                 32144301
321444                     IF  PS-ASNS-TO-WMS-YES                       32144401
321445                         SET WS001-SHIPMT-DETACH   TO TRUE        32144501
321446                         PERFORM 2800-CALL-WMS-MODULE             32144601
321447                     END-IF                                       32144701
321448                 ELSE                                             32144803
321449                     SET  ASC-CONFIRM-DETACH-NO  TO  TRUE         32144903
321450                     MOVE PC-TSYMSG-00146  TO DP020-MSG-NUMBER    32145003
321451                     SET DP020-MSG-FATAL   TO TRUE                32145105
321452                     MOVE -1               TO MR-SELECTL (1)      32145203
321453                     SET DP030-SET-CURSOR-APPL-1                  32145303
321454                                           TO TRUE                32145403
321455                     SET PS-ERROR          TO TRUE                32145503
321456                         SET ASC-NO-TSQ-UPDATE TO TRUE            32145603
321457                 END-IF                                           32145701
321458                                                                  32145801
321460                 IF  PS-NO-ERROR                                  32146006
321461                     SET LQW-DESELECT (LQW-IDX)   TO TRUE         32146102
321462                                                                  32146201
321463                     SUBTRACT  1                                  32146301
321464                         FROM  ASC-NUMBER-OF-SELECTED-ITEMS       32146401
321465                     MOVE LQW-SELECTED-SW (LQW-IDX)               32146501
321466                          TO LQW-TEMP-SELECTED-SW (LQW-IDX)       32146601
321467                     MOVE PC-TSYMSG-03561                         32146703
321468                          TO DP020-MSG-NUMBER                     32146801
321469                     SET DP020-MSG-INFORMATIONAL  TO  TRUE        32146901
321470                 END-IF                                           32147001
321471            END-IF                                                32147101
321472            END-PERFORM                                           32147207
321473        END-IF.                                                   32147301
321474                                                                  32147401
321475                                                                  32147501
321476                                                                  32147601
321480                                                                  32148001
321500/                                                                 32150000
321600*----------------------------------------------------------------*32160000
321700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *32170000
321800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *32180000
321900* FOR THE SELECTED ITEMS QUEUE.                                  *32190000
322000*                                                                *32200000
322100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *32210000
322200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *32220000
322300* THE ARRAY IS FULL.                                             *32230000
322400*----------------------------------------------------------------*32240000
322500                                                                  32250000
322600 5000-PREPARE-SEL-QUEUE.                                          32260000
322700                                                                  32270000
322800     MOVE +1                       TO ASC-BLK-SUB.                32280000
322900     PERFORM 5100-WRITE-TEMP-STORAGE.                             32290000
323000     ADD +1                        TO ASC-BLK-SUB.                32300000
323100     PERFORM 5100-WRITE-TEMP-STORAGE.                             32310000
323200                                                                  32320000
323300     MOVE ASC-SEL-QUEUE-NAME-OUT   TO TR007-SEL-QUEUE-NAME.       32330000
323400     PERFORM 6010-DELETE-SEL-QUEUE.                               32340000
323500                                                                  32350000
323600     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      32360000
323700         SET ASC-UPDATE-TSQ        TO TRUE                        32370000
323800     END-IF.                                                      32380000
323900                                                                  32390000
324000     SET TR006-IDX                 TO 1.                          32400000
324100     MOVE ZERO                     TO TR007-NUMBER-OF-TS-ITEMS.   32410000
324200     INITIALIZE TR006-SELECTED-ITEM-ARRAY.                        32420000
324300                                                                  32430000
324400     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           32440000
324500             VARYING PV-ITEM                                      32450000
324600             FROM 1 BY 1                                          32460000
324700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     32470000
324800                                                                  32480000
324900     IF  TR006-IDX > 1                                            32490000
325000         PERFORM 5205-WRITE-SEL-QUEUE                             32500000
325100         ADD +1                    TO TR007-NUMBER-OF-TS-ITEMS    32510000
325200     END-IF.                                                      32520000
325300                                                                  32530000
325400/                                                                 32540000
325500*----------------------------------------------------------------*32550000
325600*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *32560000
325700*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *32570000
325800*----------------------------------------------------------------*32580000
325900                                                                  32590000
326000 5100-WRITE-TEMP-STORAGE.                                         32600000
326100                                                                  32610000
326200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     32620000
326300                                   TO PV-LIST-ITEM-NUMBER.        32630000
326400     COMPUTE PV-BLOCK-NUMBER =                                    32640000
326500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    32650000
326600                                                                  32660000
326700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             32670000
326800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             32680000
326900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      32690000
327000             PERFORM 5105-REWRITE-ASC-LISTQ                       32700000
327100         END-IF                                                   32710000
327200     ELSE                                                         32720000
327300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       32730000
327400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            32740000
327500         PERFORM 5110-WRITE-ASC-LISTQ                             32750000
327600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   32760000
327700     END-IF.                                                      32770000
327800                                                                  32780000
327900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      32790000
328000                                   TO TRUE.                       32800000
328100                                                                  32810000
328200/                                                                 32820000
328300*----------------------------------------------------------------*32830000
328400*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *32840000
328500*  SPECIFIC COMMAREA.                                            *32850000
328600*----------------------------------------------------------------*32860000
328700 5105-REWRITE-ASC-LISTQ.                                          32870000
328800                                                                  32880000
328900     EXEC CICS                                                    32890000
329000         WRITEQ TS                                                32900000
329100             QUEUE (ASC-LIST-QUEUE-NAME)                          32910000
329200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32920000
329300             ITEM  (PV-BLOCK-NUMBER)                              32930000
329400             REWRITE                                              32940000
329500             RESP  (PV-CICS-RESP)                                 32950000
329600     END-EXEC.                                                    32960000
329700                                                                  32970000
329800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           32980000
329900         CONTINUE                                                 32990000
330000     ELSE                                                         33000000
330100         SET DP013-CICS-ABEND      TO TRUE                        33010000
330200         SET DP013-NO-ROLLBACK     TO TRUE                        33020000
330300         MOVE '5105-REWRITE-ASC-LISTQ'                            33030000
330400                                   TO DP013-PARAGRAPH             33040000
330500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     33050000
330600                                   TO DP013-MESSAGE-TEXT(1)       33060000
330700         PERFORM DP013-0000-PROCESS-ABEND                         33070000
330800     END-IF.                                                      33080000
330900                                                                  33090000
331000/                                                                 33100000
331100*----------------------------------------------------------------*33110000
331200*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *33120000
331300*  SPECIFIC COMMAREA.                                            *33130000
331400*----------------------------------------------------------------*33140000
331500 5110-WRITE-ASC-LISTQ.                                            33150000
331600                                                                  33160000
331700     EXEC CICS                                                    33170000
331800         WRITEQ TS                                                33180000
331900             QUEUE (ASC-LIST-QUEUE-NAME)                          33190000
332000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33200000
332100             ITEM  (PV-BLOCK-NUMBER)                              33210000
332200             RESP  (PV-CICS-RESP)                                 33220000
332300     END-EXEC.                                                    33230000
332400                                                                  33240000
332500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      33250000
332600         SET DP013-CICS-ABEND      TO TRUE                        33260000
332700         SET DP013-NO-ROLLBACK     TO TRUE                        33270000
332800         MOVE '5110-WRITE-ASC-LISTQ'                              33280000
332900                                   TO DP013-PARAGRAPH             33290000
333000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           33300000
333100                                   TO DP013-MESSAGE-TEXT(1)       33310000
333200         PERFORM DP013-0000-PROCESS-ABEND                         33320000
333300     END-IF.                                                      33330000
333400                                                                  33340000
333500/                                                                 33350000
333600*----------------------------------------------------------------*33360000
333700* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *33370000
333800* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *33380000
333900*----------------------------------------------------------------*33390000
334000                                                                  33400000
334100 5200-FILL-SEL-QUEUE-RECORD.                                      33410000
334200                                                                  33420000
334300     PERFORM 6112-READ-LIST-QUEUE.                                33430000
334400                                                                  33440000
334500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       33450000
334600         PERFORM                                                  33460000
334700         VARYING LQW-IDX                                          33470000
334800         FROM 1 BY 1                                              33480000
334900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            33490000
335000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          33500000
335100                                                                  33510000
335200             IF  LQW-SELECT (LQW-IDX)                             33520000
335300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              33530000
335400                                   TO TR006-ITEM (TR006-IDX)      33540000
335500                 MOVE LQW-SHIPT-ID (LQW-IDX)                      33550000
335600                           TO TR006-SHIPT-ID (TR006-IDX)          33560000
335700                              DK-SHIPT-ID                         33570000
335710                                                                  33571011
335720                 MOVE ASC-KEY-DEST-OPER-UNT-ID                    33572000
335730                           TO TR006-OPER-UNT-ID (TR006-IDX)       33573000
335731                 MOVE ASC-KEY-DEST-FCLTY-ID                       33573100
335732                           TO TR006-FCLTY-ID (TR006-IDX)          33573200
335733                 MOVE LQW-OWNER-SCAC-ID (LQW-IDX)                 33573300
335734                           TO TR006-OWNER-SCAC-ID (TR006-IDX)     33573400
335735                 MOVE LQW-VEH-NBR (LQW-IDX)                       33573500
335736                           TO TR006-VEH-NBR (TR006-IDX)           33573600
335737                 MOVE LQW-MANIFEST-NBR (LQW-IDX)                  33573700
335738                           TO TR006-MANIFEST-NBR (TR006-IDX)      33573800
335739                 MOVE LQW-PRO-SCAC (LQW-IDX)                      33573900
335740                           TO TR006-PRO-SCAC-ID (TR006-IDX)       33574000
335741                 MOVE LQW-PRO-NBR (LQW-IDX)                       33574100
335742                           TO TR006-PRO-NBR (TR006-IDX)           33574200
335743                 MOVE LQW-BOL-NBR (LQW-IDX)                       33574300
335744                           TO TR006-BOL-NBR (TR006-IDX)           33574400
335745                 MOVE LQW-STATUS-DTE-ISO (LQW-IDX)                33574500
335746                           TO TR006-CALL-IN-DATE (TR006-IDX)      33574600
335747                 MOVE LQW-TRIP-ID (LQW-IDX)                       33574700
335748                           TO TR006-TRIP-ID (TR006-IDX)           33574800
335749                 MOVE SPACE    TO TR006-ACTION-SW (TR006-IDX)     33574900
335750                 SET TR006-IDX UP BY 1                            33575000
335751                 IF  TR006-IDX > TR006-MAX-ITEMS                  33575100
335752                     PERFORM 5205-WRITE-SEL-QUEUE                 33575200
335753                     ADD +1        TO TR007-NUMBER-OF-TS-ITEMS    33575300
335754                     INITIALIZE TR006-SELECTED-ITEM-ARRAY         33575400
335755                     SET TR006-IDX TO 1                           33575500
335756                 END-IF                                           33575600
335757             END-IF                                               33575700
335760                                                                  33576000
341100         END-PERFORM                                              34110000
341200     END-IF.                                                      34120000
341300                                                                  34130000
341400/                                                                 34140000
341500*----------------------------------------------------------------*34150000
341600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *34160000
341700*----------------------------------------------------------------*34170000
341800                                                                  34180000
341900 5205-WRITE-SEL-QUEUE.                                            34190000
342000                                                                  34200000
342100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34210000
342200                                   TO TR006-SELECTED-ITEMS.       34220000
342300                                                                  34230000
342400     EXEC CICS                                                    34240000
342500          WRITEQ TS                                               34250000
342600              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      34260000
342700              FROM  (TR006-DOCK-SCHEDULE-REC)                     34270000
342800              ITEM  (PV-SEL-QUEUE-ITEM)                           34280000
342900              RESP  (PV-CICS-RESP)                                34290000
343000     END-EXEC.                                                    34300000
343100                                                                  34310000
343200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34320000
343300         CONTINUE                                                 34330000
343400     ELSE                                                         34340000
343500         SET DP013-CICS-ABEND      TO TRUE                        34350000
343600         SET DP013-NO-ROLLBACK     TO TRUE                        34360000
343700         MOVE '5205-WRITE-SEL-QUEUE'                              34370000
343800                                   TO DP013-PARAGRAPH             34380000
343900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          34390000
344000                                   TO DP013-MESSAGE-TEXT(1)       34400000
344100         PERFORM DP013-0000-PROCESS-ABEND                         34410000
344200     END-IF.                                                      34420000
344300                                                                  34430000
344400*----------------------------------------------------------------*34440000
344500*    COUNT THE NUMBER OF VERIFIED RECEIVERS                      *34450000
344600*----------------------------------------------------------------*34460000
344700 5250-COUNT-VERIFIED-RCVRS.                                       34470000
344800                                                                  34480000
344900     PERFORM                                                      34490000
345000         WITH TEST AFTER                                          34500000
345100         VARYING PV-RETRY-COUNTER                                 34510000
345200         FROM 1 BY 1                                              34520000
345300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34530000
345400             OR (SQLCODE = +0)                                    34540000
345500             OR (SQLCODE = +100))                                 34550000
345600                                                                  34560000
345700         EXEC SQL                                                 34570000
345800              SELECT COUNT(*)                                     34580000
345900                INTO :PV-DB2-COUNT                                34590000
346000                FROM TSHIPMT A,                                   34600000
346100                     TSHPTPO B,                                   34610000
346200                     TRECEIV C                                    34620000
346300               WHERE A.SHIPT_ID    = :DK-SHIPT-ID                 34630000
346400                 AND A.SHIPT_ID    = B.SHIPT_ID                   34640000
346500                 AND B.REC_SEQ_NBR = C.REC_SEQ_NBR                34650000
346600                 AND B.PO_NBR      = C.ORD_NBR                    34660000
346700                 AND C.VERFYD_TMST   ^= :PC-DEFAULT-TMST-9S       34670000
346800         END-EXEC                                                 34680000
346900                                                                  34690000
347000         EVALUATE TRUE                                            34700000
347100             WHEN SQLCODE = +0                                    34710000
347200             WHEN SQLCODE = +100                                  34720000
347300             WHEN SQLCODE = -904                                  34730000
347400             WHEN SQLCODE = -913                                  34740000
347500                  CONTINUE                                        34750000
347600                                                                  34760000
347700             WHEN SQLWARN0 NOT = SPACES                           34770000
347800             WHEN SQLCODE < +0                                    34780000
347900             WHEN SQLCODE > +0                                    34790000
348000                  MOVE '5250-COUNT-VERIFIED-RCVRS'                34800000
348100                                  TO DP013-PARAGRAPH              34810000
348200                  MOVE 'UNSUCCESSFUL COUNT OF TRECEIV TABLE'      34820000
348300                                  TO DP013-MESSAGE-TEXT (1)       34830000
348400                  MOVE SQLCA      TO DP013-SQLCA                  34840000
348500                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     34850000
348600                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (2)     34860000
348700                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)     34870000
348800                  SET DP013-DB2-ABEND                             34880000
348900                      DP013-XCTL-DISPLAY-RESTART                  34890000
349000                                  TO TRUE                         34900000
349100                  PERFORM DP013-0000-PROCESS-ABEND                34910000
349200         END-EVALUATE                                             34920000
349300     END-PERFORM.                                                 34930000
349400                                                                  34940000
349500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34950000
349600         MOVE '5250-COUNT-VERIFIED-RCVRS'                         34960000
349700                                  TO DP013-PARAGRAPH              34970000
349800         MOVE 'MAX RETRIES EXCEEDED ON COUNT TRECEIV TABLE'       34980000
349900                                  TO DP013-MESSAGE-TEXT (1)       34990000
350000         MOVE SQLCA               TO DP013-SQLCA                  35000000
350100         MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1)     35010000
350200         MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (2)     35020000
350300         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (3)     35030000
350400         SET DP013-DB2-ABEND                                      35040000
350500             DP013-XCTL-DISPLAY-RESTART                           35050000
350600                                  TO TRUE                         35060000
350700         PERFORM DP013-0000-PROCESS-ABEND                         35070000
350800     END-IF.                                                      35080000
350900                                                                  35090000
351000/                                                                 35100000
351100*----------------------------------------------------------------*35110000
351200*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *35120000
351300*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *35130000
351400*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *35140000
351500*  THE USER.                                                     *35150000
351600*----------------------------------------------------------------*35160000
351700 6000-REFRESH-PANEL-FROM-TEMP.                                    35170000
351800                                                                  35180000
351900     IF  ASC-UPDATE-TSQ                                           35190000
352000         SET ASC-NO-TSQ-UPDATE     TO TRUE                        35200000
352100         MOVE ZERO                 TO PV-SAVE-ITEM                35210000
352200                                      PV-SEL-QUEUE-ITEM           35220000
352300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        35230000
352400                                   TO PV-HOLD-SELECTED-ITEMS      35240000
352500         PERFORM 6100-UPDATE-TSQ                                  35250000
352600             UNTIL PV-ITEMS-PROCESSED >                           35260000
352700                                     ASC-NUMBER-OF-SELECTED-ITEMS 35270000
352800         PERFORM 6010-DELETE-SEL-QUEUE                            35280000
352900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         35290000
353000                    ASC-BLOCK-ENTRIES (2)                         35300000
353100     END-IF.                                                      35310000
353200                                                                  35320000
353300/                                                                 35330000
353400*----------------------------------------------------------------*35340000
353500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *35350000
353600*----------------------------------------------------------------*35360000
353700 6010-DELETE-SEL-QUEUE.                                           35370000
353800                                                                  35380000
353900     EXEC CICS                                                    35390000
354000         DELETEQ TS                                               35400000
354100             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       35410000
354200             RESP  (PV-CICS-RESP)                                 35420000
354300     END-EXEC.                                                    35430000
354400                                                                  35440000
354500     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      35450000
354600         (PV-CICS-RESP = DFHRESP(QIDERR)))                        35460000
354700         CONTINUE                                                 35470000
354800     ELSE                                                         35480000
354900         SET DP013-CICS-ABEND      TO TRUE                        35490000
355000         SET DP013-NO-ROLLBACK     TO TRUE                        35500000
355100         MOVE '6010-DELETE-SEL-QUEUE'                             35510000
355200                                   TO DP013-PARAGRAPH             35520000
355300         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         35530000
355400                                   TO DP013-MESSAGE-TEXT (1)      35540000
355500         PERFORM DP013-0000-PROCESS-ABEND                         35550000
355600     END-IF.                                                      35560000
355700                                                                  35570000
355800/                                                                 35580000
355900*----------------------------------------------------------------*35590000
356000*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *35600000
356100*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *35610000
356200*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *35620000
356300*    THE TEMP QUEUE.                                             *35630000
356400*----------------------------------------------------------------*35640000
356500                                                                  35650000
356600 6100-UPDATE-TSQ.                                                 35660000
356700                                                                  35670000
356800     ADD 1                         TO PV-SEL-QUEUE-ITEM.          35680000
356900     PERFORM 6105-READ-SEL-QUEUE.                                 35690000
357000                                                                  35700000
357100     PERFORM                                                      35710000
357200         VARYING TR006-IDX                                        35720000
357300         FROM 1 BY 1                                              35730000
357400         UNTIL ((PV-ITEMS-PROCESSED >                             35740000
357500                              PV-HOLD-SELECTED-ITEMS)             35750000
357600         OR (TR006-IDX GREATER THAN TR006-MAX-ITEMS))             35760000
357700         IF  TR006-ACTION-SW (TR006-IDX) > SPACE                  35770000
357800             PERFORM 6110-PROCESS-ITEMS                           35780000
357900         END-IF                                                   35790000
358000         ADD +1                    TO PV-ITEMS-PROCESSED          35800000
358100     END-PERFORM.                                                 35810000
358200                                                                  35820000
358300     PERFORM 6111-WRITE-LIST-QUEUE.                               35830000
358400                                                                  35840000
358500/                                                                 35850000
358600*----------------------------------------------------------------*35860000
358700*    READ THE LIST QUEUE RECORD.                                 *35870000
358800*----------------------------------------------------------------*35880000
358900                                                                  35890000
359000 6105-READ-SEL-QUEUE.                                             35900000
359100                                                                  35910000
359200     EXEC CICS                                                    35920000
359300          READQ TS                                                35930000
359400              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      35940000
359500              INTO  (TR006-DOCK-SCHEDULE-REC)                     35950000
359600              ITEM  (PV-SEL-QUEUE-ITEM)                           35960000
359700              RESP  (PV-CICS-RESP)                                35970000
359800     END-EXEC.                                                    35980000
359900                                                                  35990000
360000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36000000
360100         CONTINUE                                                 36010000
360200     ELSE                                                         36020000
360300         SET DP013-CICS-ABEND      TO TRUE                        36030000
360400         SET DP013-NO-ROLLBACK     TO TRUE                        36040000
360500         MOVE '6105-READ-SEL-QUEUE'                               36050000
360600                                   TO DP013-PARAGRAPH             36060000
360700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           36070000
360800                                   TO DP013-MESSAGE-TEXT(1)       36080000
360900         PERFORM DP013-0000-PROCESS-ABEND                         36090000
361000     END-IF.                                                      36100000
361100                                                                  36110000
361200/                                                                 36120000
361300*----------------------------------------------------------------*36130000
361400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*36140000
361500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*36150000
361600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *36160000
361700*----------------------------------------------------------------*36170000
361800                                                                  36180000
361900 6110-PROCESS-ITEMS.                                              36190000
362000                                                                  36200000
362100     COMPUTE PV-ITEM = 1 + ((TR006-ITEM (TR006-IDX) - 1)          36210000
362200                     / PC-ITEMS-PER-PANEL).                       36220000
362300                                                                  36230000
362400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           36240000
362500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          36250000
362600             PERFORM 6111-WRITE-LIST-QUEUE                        36260000
362700         END-IF                                                   36270000
362800         MOVE PV-ITEM              TO PV-SAVE-ITEM                36280000
362900                                                                  36290000
363000         PERFORM 6112-READ-LIST-QUEUE                             36300000
363100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               36310000
363200             CONTINUE                                             36320000
363300         END-IF                                                   36330000
363400     END-IF.                                                      36340000
363500                                                                  36350000
363600     COMPUTE PV-SUB = (TR006-ITEM (TR006-IDX)                     36360000
363700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              36370000
363800                                                                  36380000
363900     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       36390000
364000     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        36400000
364100                                     (PV-SUB).                    36410000
364200                                                                  36420000
364300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                36430000
364400                                                                  36440000
364500/                                                                 36450000
364600*----------------------------------------------------------------*36460000
364700*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *36470000
364800*----------------------------------------------------------------*36480000
364900                                                                  36490000
365000 6111-WRITE-LIST-QUEUE.                                           36500000
365100                                                                  36510000
365200     EXEC CICS                                                    36520000
365300         WRITEQ TS                                                36530000
365400             QUEUE (ASC-LIST-QUEUE-NAME)                          36540000
365500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     36550000
365600             ITEM  (PV-SAVE-ITEM)                                 36560000
365700             REWRITE                                              36570000
365800             RESP  (PV-CICS-RESP)                                 36580000
365900     END-EXEC.                                                    36590000
366000                                                                  36600000
366100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36610000
366200         CONTINUE                                                 36620000
366300     ELSE                                                         36630000
366400         SET DP013-CICS-ABEND      TO TRUE                        36640000
366500         SET DP013-NO-ROLLBACK     TO TRUE                        36650000
366600         MOVE '6111-WRITE-LIST-QUEUE'                             36660000
366700                                   TO DP013-PARAGRAPH             36670000
366800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  36680000
366900                                   TO DP013-MESSAGE-TEXT(1)       36690000
367000         PERFORM DP013-0000-PROCESS-ABEND                         36700000
367100     END-IF.                                                      36710000
367200                                                                  36720000
367300/                                                                 36730000
367400*----------------------------------------------------------------*36740000
367500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*36750000
367600*----------------------------------------------------------------*36760000
367700                                                                  36770000
367800 6112-READ-LIST-QUEUE.                                            36780000
367900                                                                  36790000
368000     EXEC CICS                                                    36800000
368100         READQ TS                                                 36810000
368200             QUEUE (ASC-LIST-QUEUE-NAME)                          36820000
368300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     36830000
368400             ITEM  (PV-ITEM)                                      36840000
368500             RESP  (PV-CICS-RESP)                                 36850000
368600     END-EXEC.                                                    36860000
368700                                                                  36870000
368800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36880000
368900         CONTINUE                                                 36890000
369000     ELSE                                                         36900000
369100         SET DP013-CICS-ABEND      TO TRUE                        36910000
369200         SET DP013-NO-ROLLBACK     TO TRUE                        36920000
369300         MOVE '6112-READ-LIST-QUEUE'                              36930000
369400                                   TO DP013-PARAGRAPH             36940000
369500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    36950000
369600                                   TO DP013-MESSAGE-TEXT(1)       36960000
369700         PERFORM DP013-0000-PROCESS-ABEND                         36970000
369800     END-IF.                                                      36980000
369900                                                                  36990000
370000/                                                                 37000000
370100******************************************************************37010000
370200* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *37020000
370300******************************************************************37030000
370400 6200-DEL-LIST-QUEUE.                                             37040000
370500                                                                  37050000
370600     EXEC CICS                                                    37060000
370700         DELETEQ TS                                               37070000
370800             QUEUE (ASC-LIST-QUEUE-NAME)                          37080000
370900             RESP  (PV-CICS-RESP)                                 37090000
371000     END-EXEC.                                                    37100000
371100                                                                  37110000
371200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      37120000
371300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         37130000
371400         CONTINUE                                                 37140000
371500     ELSE                                                         37150000
371600        SET DP013-CICS-ABEND       TO TRUE                        37160000
371700        SET DP013-NO-ROLLBACK      TO TRUE                        37170000
371800        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             37180000
371900        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               37190000
372000                                   TO DP013-MESSAGE-TEXT (1)      37200000
372100        PERFORM DP013-0000-PROCESS-ABEND                          37210000
372200     END-IF.                                                      37220000
372300                                                                  37230000
372400/                                                                 37240000
372500 6500-FORMAT-COMMAREA.                                            37250000
372600                                                                  37260000
372700     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            37270000
372800        MOVE 1                   TO PV-BLOCK-NUMBER               37280000
372900     ELSE                                                         37290000
373000        MOVE 2                   TO PV-BLOCK-NUMBER               37300000
373100     END-IF.                                                      37310000
373200                                                                  37320000
373300     PERFORM VARYING PV-SUB FROM 1 BY 1                           37330000
373400             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    37340000
373500         IF ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'       37350000
373600            MOVE ASC-TRIP-ID (PV-BLOCK-NUMBER PV-SUB)             37360000
373700                                 TO TR005-TRIP-ID                 37370000
373800            MOVE ASC-PRO-SCAC (PV-BLOCK-NUMBER PV-SUB)            37380000
373900                                 TO TR001-SCAC                    37390000
374000            MOVE ASC-PRO-NBR (PV-BLOCK-NUMBER PV-SUB)             37400000
374100                                 TO TR001-PRO-NBR                 37410000
374200            COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1               37420000
374300         END-IF                                                   37430000
374400     END-PERFORM.                                                 37440000
374500                                                                  37450000
374501                                                                  37450101
374510*----------------------------------------------------------------*37451001
374520*  DETACH SHIPMENT                                               *37452001
374530*----------------------------------------------------------------*37453001
374600 7000-DETACH-SHIPMENT.                                            37460000
374700     PERFORM 7010-GET-RANDOM-NUMBER.                              37470000
374800     PERFORM 7020-READ-DUPL-TVHTRIP                               37480000
374900          WITH TEST AFTER                                         37490000
375000          UNTIL PV-VHTRIP-COUNT = 0.                              37500000
375100     MOVE PV-CURR-TRIP-ID TO PV-TRIP-ID.                          37510000
375110                                                                  37511001
375200     PERFORM 7100-INSERT-TVHTRIP.                                 37520000
375300     PERFORM 7500-UPDATE-TSHIPMT.                                 37530000
375400     PERFORM 7600-AUDIT-TSHIPMT.                                  37540000
375500     PERFORM 7200-OPEN-CURSOR.                                    37550000
375600     SET PS-NOT-END-OF-STATUS-CURSOR TO TRUE.                     37560000
375700     PERFORM 7260-FETCH-CURSOR                                    37570000
375800         UNTIL PS-END-OF-STATUS-CURSOR.                           37580000
375900     PERFORM 7230-CLOSE-CURSOR.                                   37590000
376000     MOVE PC-EN TO SHIPST-SHIPT-STATUS-CDE.                       37600000
376100     PERFORM 7300-INSERT-TSHIPST.                                 37610000
376200     PERFORM 7400-UPDATE-RECEIVERS.                               37620000
376210                                                                  37621001
376220                                                                  37622001
376300*----------------------------------------------------------------*37630000
376400*  RETREIVE A RANDOM NUMBER                                      *37640000
376500*----------------------------------------------------------------*37650000
376600 7010-GET-RANDOM-NUMBER.                                          37660000
376700     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     37670009
378000                                                                  37800000
378100     CALL PC-RANDNBR-PGM USING DFHEIBLK                           37810010
378110                               DFHCOMMAREA                        37811010
378120                               DP902-RANDNBR-ROUTINE-FIELDS.      37812010
378200                                                                  37820000
378300     IF  DP902-SUCCESSFUL                                         37830009
378400         NEXT SENTENCE                                            37840000
378500     ELSE                                                         37850000
378600         MOVE '7010-GET-RANDOM-NUMBER'  TO DP013-PARAGRAPH        37860000
378700         MOVE 'CALL TO DPKUT902 FAILED'                           37870009
378800                                   TO DP013-MESSAGE-TEXT(1)       37880000
378900         SET DP013-XCTL-DISPLAY-RESTART                           37890000
379000                                   TO TRUE                        37900000
379100         PERFORM DP013-0000-PROCESS-ABEND                         37910000
379200     END-IF.                                                      37920000
379300  EJECT                                                           37930000
379400                                                                  37940000
379500                                                                  37950000
379600 7020-READ-DUPL-TVHTRIP.                                          37960000
379700                                                                  37970000
379800     MOVE DP902-RANDOM-NUMBER   TO PV-CURR-TRIP-ID.               37980009
379900                                                                  37990000
380000     PERFORM                                                      38000000
380100         WITH TEST AFTER                                          38010000
380200         VARYING PV-RETRY-COUNTER                                 38020000
380300         FROM 1 BY 1                                              38030000
380400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38040000
380500             OR (SQLCODE = +0))                                   38050000
380600                                                                  38060000
380700         EXEC SQL                                                 38070000
380800              SELECT COUNT(*)                                     38080000
380900               INTO :PV-VHTRIP-COUNT                              38090000
381000                FROM  TVHTRIP                                     38100000
381100               WHERE (TRIP_ID         = :PV-CURR-TRIP-ID)         38110000
381200         END-EXEC                                                 38120000
381300                                                                  38130000
381400         EVALUATE TRUE                                            38140000
381500             WHEN SQLCODE = +0                                    38150000
381600             WHEN SQLCODE = -904                                  38160000
381700             WHEN SQLCODE = -913                                  38170000
381800                 CONTINUE                                         38180000
381900                                                                  38190000
382000             WHEN SQLWARN0 NOT = SPACES                           38200000
382100             WHEN SQLCODE < +0                                    38210000
382200             WHEN SQLCODE > +0                                    38220000
382300                 MOVE '7020-READ-DUPL-TVHTRIP'                    38230000
382400                                   TO DP013-PARAGRAPH             38240000
382500                 MOVE 'GET COUNT OF TRIPS'                        38250000
382600                                   TO DP013-MESSAGE-TEXT(1)       38260000
382700                 MOVE PV-CURR-TRIP-ID                             38270000
382800                                   TO DP013-MESSAGE-TEXT(2)       38280000
382900                 MOVE SQLCA        TO DP013-SQLCA                 38290000
383000                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    38300000
383100                 SET DP013-DB2-ABEND                              38310000
383200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38320000
383300                 PERFORM DP013-0000-PROCESS-ABEND                 38330000
383400         END-EVALUATE                                             38340000
383500     END-PERFORM.                                                 38350000
383600                                                                  38360000
383700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38370000
383800         MOVE '7020-READ-DUPL-TVHTRIP'                            38380000
383900                                   TO DP013-PARAGRAPH             38390000
384000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38400000
384100                                   TO DP013-MESSAGE-TEXT (1)      38410000
384200         MOVE 'TO COUNT TVHTRIP ROWS'                             38420000
384300                                   TO DP013-MESSAGE-TEXT (2)      38430000
384400         MOVE SQLCA                TO DP013-SQLCA                 38440000
384500         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    38450000
384600         SET DP013-DB2-ABEND                                      38460000
384700             DP013-XCTL-DISPLAY-RESTART                           38470000
384800                                   TO TRUE                        38480000
384900         PERFORM DP013-0000-PROCESS-ABEND                         38490000
385000     END-IF.                                                      38500000
385100                                                                  38510000
385200     IF PV-VHTRIP-COUNT > 0                                       38520000
385300         PERFORM 7010-GET-RANDOM-NUMBER                           38530000
385400     END-IF.                                                      38540000
385500                                                                  38550000
385600*----------------------------------------------------------------*38560000
385700*  INSERT A ROW TO THE TRIP TABLE                                 38570000
385800*----------------------------------------------------------------*38580000
385900 7100-INSERT-TVHTRIP.                                             38590000
386000                                                                  38600000
386100     INITIALIZE DCLTVHTRIP.                                       38610000
386200                                                                  38620000
386300     MOVE ASC-KEY-OWNER-SCAC-ID    TO VHTRIP-OWNER-SCAC-ID.       38630000
386400                                                                  38640000
386500     MOVE -1               TO DN-VEH-NBR.                         38650000
386600     MOVE SPACES           TO VHTRIP-VEH-NBR.                     38660000
386700                                                                  38670000
386800     MOVE PV-TRIP-ID               TO VHTRIP-TRIP-ID              38680000
386900                                      VHTRIP-REF-TRIP-ID          38690000
387000                                      DK-TRIP-ID.                 38700000
387100     MOVE 'CE'                     TO VHTRIP-CRT-SRC-CDE.         38710000
387200     MOVE SPACES                   TO VHTRIP-MANIFEST-NBR         38720000
387300                                      VHTRIP-PLND-ACTVY-CDE.      38730000
387400     MOVE ZEROES                   TO VHTRIP-PLND-TRIP-SEQ.       38740000
387500     MOVE PC-DEFAULT-TMST          TO VHTRIP-EST-AR-TMST.         38750000
387600                                                                  38760000
387700     PERFORM                                                      38770000
387800         WITH TEST AFTER                                          38780000
387900         VARYING PV-RETRY-COUNTER                                 38790000
388000         FROM 1 BY 1                                              38800000
388100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38810000
388200             OR (SQLCODE = +0))                                   38820000
388300                                                                  38830000
388400         EXEC SQL                                                 38840000
388500             INSERT  INTO TVHTRIP                                 38850000
388600                   ( OWNER_SCAC_ID                                38860000
388700                    ,VEH_NBR                                      38870000
388800                    ,TRIP_ID                                      38880000
388900                    ,CRT_SRC_CDE                                  38890000
389000                    ,LAST_UPD_UID                                 38900000
389100                    ,MANIFEST_NBR                                 38910000
389200                    ,PLND_TRIP_SEQ                                38920000
389300                    ,PLND_ACTVY_CDE                               38930000
389400                    ,OWNR_SCAC_SHIP_DTE                           38940000
389500                    ,REF_TRIP_ID                                  38950000
389600                    ,EST_AR_TMST                                  38960000
389700                    ,SPLT_XMIT_IND                                38970000
389800                    ,SPLT_XMIT_DTE                                38980000
389900                    ,SPLT_XMIT_TM )                               38990000
390000             VALUES                                               39000000
390100                   ( :VHTRIP-OWNER-SCAC-ID                        39010000
390200                    ,:VHTRIP-VEH-NBR :DN-VEH-NBR                  39020000
390300                    ,:VHTRIP-TRIP-ID                              39030000
390400                    ,:VHTRIP-CRT-SRC-CDE                          39040000
390500                    ,:DP020-USERID                                39050000
390600                    ,:VHTRIP-MANIFEST-NBR                         39060000
390700                    ,:VHTRIP-PLND-TRIP-SEQ                        39070000
390800                    ,:VHTRIP-PLND-ACTVY-CDE                       39080000
390900                    ,:PC-DEFAULT-DATE                             39090000
391000                    ,:VHTRIP-REF-TRIP-ID                          39100000
391100                    ,:VHTRIP-EST-AR-TMST                          39110000
391200                    ,:VHTRIP-SPLT-XMIT-IND                        39120000
391300                    ,:PC-DEFAULT-DATE                             39130000
391400                    ,:PC-DEFAULT-TIME)                            39140000
391500         END-EXEC                                                 39150000
391600                                                                  39160000
391700         EVALUATE TRUE                                            39170000
391800             WHEN SQLCODE = +0                                    39180000
391900             WHEN SQLCODE = -904                                  39190000
392000             WHEN SQLCODE = -913                                  39200000
392100                 CONTINUE                                         39210000
392200                                                                  39220000
392300             WHEN SQLWARN0 NOT = SPACES                           39230000
392400             WHEN SQLCODE < +0                                    39240000
392500             WHEN SQLCODE > +0                                    39250000
392600                 MOVE SPACES TO PV-MESSAGE                        39260000
392700                 MOVE VHTRIP-OWNER-SCAC-ID TO PV-MESSAGE1         39270000
392800                 MOVE VHTRIP-VEH-NBR       TO PV-MESSAGE2         39280000
392900                 MOVE VHTRIP-TRIP-ID       TO PV-MESSAGE3         39290000
393000                 MOVE '7100-INSERT-TVHTRIP'                       39300000
393100                                   TO DP013-PARAGRAPH             39310000
393200                 MOVE 'INSERT A ROW ON TVHTRIP'                   39320000
393300                                   TO DP013-MESSAGE-TEXT(1)       39330000
393400                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       39340000
393500                 MOVE SQLCA        TO DP013-SQLCA                 39350000
393600                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    39360000
393700                 SET DP013-DB2-ABEND                              39370000
393800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39380000
393900                 PERFORM DP013-0000-PROCESS-ABEND                 39390000
394000         END-EVALUATE                                             39400000
394100     END-PERFORM.                                                 39410000
394200                                                                  39420000
394300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39430000
394400         MOVE '7100-INSERT-TVHTRIP'                               39440000
394500                                   TO DP013-PARAGRAPH             39450000
394600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              39460000
394700                                   TO DP013-MESSAGE-TEXT (1)      39470000
394800         MOVE 'TO INSERT A TVHTRIP ROW'                           39480000
394900                                   TO DP013-MESSAGE-TEXT (2)      39490000
395000         MOVE SQLCA                TO DP013-SQLCA                 39500000
395100         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    39510000
395200         SET DP013-DB2-ABEND                                      39520000
395300             DP013-XCTL-DISPLAY-RESTART                           39530000
395400                                   TO TRUE                        39540000
395500         PERFORM DP013-0000-PROCESS-ABEND                         39550000
395600     END-IF.                                                      39560000
395700                                                                  39570000
395800     EVALUATE TRUE                                                39580000
395900         WHEN SQLCODE = ZERO                                      39590000
396000              PERFORM 7110-INSERT-TTRIPST                         39600000
396100              PERFORM 7120-INSERT-TAUTRIP                         39610000
396200     END-EVALUATE.                                                39620000
396300                                                                  39630000
396400                                                                  39640000
396500*----------------------------------------------------------------*39650000
396600*  INSERT A ROW TO THE TRIP STATUS TABLE                          39660000
396700*----------------------------------------------------------------*39670000
396800 7110-INSERT-TTRIPST.                                             39680000
396900                                                                  39690000
397000     INITIALIZE DCLTTRIPST.                                       39700000
397100                                                                  39710000
397200     MOVE PV-TRIP-ID               TO TRIPST-TRIP-ID.             39720000
397300     MOVE 'EN'                     TO TRIPST-TRIP-STATUS-CDE.     39730000
397400     MOVE ASC-KEY-DEST-OPER-UNT-ID TO TRIPST-OPER-UNT-ID.         39740000
397500     MOVE ASC-KEY-DEST-FCLTY-ID    TO TRIPST-FCLTY-ID.            39750000
397600     MOVE SPACES                   TO TRIPST-FCLTY-AREA-ID.       39760000
397700                                                                  39770000
397800     PERFORM                                                      39780000
397900         WITH TEST AFTER                                          39790000
398000         VARYING PV-RETRY-COUNTER                                 39800000
398100         FROM 1 BY 1                                              39810000
398200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39820000
398300             OR (SQLCODE = +0))                                   39830000
398400                                                                  39840000
398500         EXEC SQL                                                 39850000
398600             INSERT  INTO TTRIPST                                 39860000
398700                   ( TRIP_ID                                      39870000
398800                    ,TRIP_STATUS_CDE                              39880000
398900                    ,STATUS_UID                                   39890000
399000                    ,OPER_UNT_ID                                  39900000
399100                    ,FCLTY_ID                                     39910000
399200                    ,FCLTY_AREA_ID )                              39920000
399300             VALUES                                               39930000
399400                   ( :TRIPST-TRIP-ID                              39940000
399500                    ,:TRIPST-TRIP-STATUS-CDE                      39950000
399600                    ,:DP020-USERID                                39960000
399700                    ,:TRIPST-OPER-UNT-ID                          39970000
399800                    ,:TRIPST-FCLTY-ID                             39980000
399900                    ,:TRIPST-FCLTY-AREA-ID )                      39990000
400000         END-EXEC                                                 40000000
400100                                                                  40010000
400200         EVALUATE TRUE                                            40020000
400300             WHEN SQLCODE = +0                                    40030000
400400             WHEN SQLCODE = -904                                  40040000
400500             WHEN SQLCODE = -913                                  40050000
400600                 CONTINUE                                         40060000
400700                                                                  40070000
400800             WHEN SQLWARN0 NOT = SPACES                           40080000
400900             WHEN SQLCODE < +0                                    40090000
401000             WHEN SQLCODE > +0                                    40100000
401100                 MOVE SPACES TO PV-MESSAGE                        40110000
401200                 MOVE TRIPST-TRIP-ID TO PV-MESSAGE1               40120000
401300                 MOVE TRIPST-TRIP-STATUS-CDE TO PV-MESSAGE2       40130000
401400                 MOVE '7110-INSERT-TTRIPST'                       40140000
401500                                   TO DP013-PARAGRAPH             40150000
401600                 MOVE 'INSERT A ROW ON TTRIPST'                   40160000
401700                                   TO DP013-MESSAGE-TEXT(1)       40170000
401800                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       40180000
401900                 MOVE SQLCA        TO DP013-SQLCA                 40190000
402000                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    40200000
402100                 SET DP013-DB2-ABEND                              40210000
402200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40220000
402300                 PERFORM DP013-0000-PROCESS-ABEND                 40230000
402400         END-EVALUATE                                             40240000
402500     END-PERFORM.                                                 40250000
402600                                                                  40260000
402700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40270000
402800         MOVE '7110-INSERT-TTRIPST'                               40280000
402900                                   TO DP013-PARAGRAPH             40290000
403000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              40300000
403100                                   TO DP013-MESSAGE-TEXT (1)      40310000
403200         MOVE 'TO INSERT A TTRIPST ROW'                           40320000
403300                                   TO DP013-MESSAGE-TEXT (2)      40330000
403400         MOVE SQLCA                TO DP013-SQLCA                 40340000
403500         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    40350000
403600         SET DP013-DB2-ABEND                                      40360000
403700             DP013-XCTL-DISPLAY-RESTART                           40370000
403800                                   TO TRUE                        40380000
403900         PERFORM DP013-0000-PROCESS-ABEND                         40390000
404000     END-IF.                                                      40400000
404100                                                                  40410000
404200*----------------------------------------------------------------*40420000
404300*  INSERT A ROW TO THE TRIP AUDIT TABLE                           40430000
404400*----------------------------------------------------------------*40440000
404500 7120-INSERT-TAUTRIP.                                             40450000
404600                                                                  40460000
404700                                                                  40470000
404800     INITIALIZE DCLTAUTRIP.                                       40480000
404900                                                                  40490000
405000     PERFORM                                                      40500000
405100         WITH TEST AFTER                                          40510000
405200         VARYING PV-RETRY-COUNTER                                 40520000
405300         FROM 1 BY 1                                              40530000
405400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40540000
405500             OR (SQLCODE = +0))                                   40550000
405600                                                                  40560000
405700         EXEC SQL                                                 40570000
405800             SELECT  OWNER_SCAC_ID                                40580000
405900                    ,VEH_NBR                                      40590000
406000                    ,TRIP_ID                                      40600000
406100                    ,TRIP_BEG_DTE                                 40610000
406200                    ,TRIP_BEG_TME                                 40620000
406300                    ,CRT_SRC_CDE                                  40630000
406400                    ,LAST_UPD_DTE                                 40640000
406500                    ,LAST_UPD_TME                                 40650000
406600                    ,LAST_UPD_UID                                 40660000
406700                    ,MANIFEST_NBR                                 40670000
406800                    ,PLND_TRIP_SEQ                                40680000
406900                    ,PLND_ACTVY_CDE                               40690000
407000                    ,OWNR_SCAC_SHIP_DTE                           40700000
407100                    ,REF_TRIP_ID                                  40710000
407200                    ,EST_AR_TMST                                  40720000
407300                    ,SPLT_XMIT_IND                                40730000
407400                    ,SPLT_XMIT_DTE                                40740000
407500                    ,SPLT_XMIT_TM                                 40750000
407600            INTO     :VHTRIP-OWNER-SCAC-ID                        40760000
407700                    ,:VHTRIP-VEH-NBR                              40770000
407800                       :DN-VEH-NBR                                40780000
407900                    ,:VHTRIP-TRIP-ID                              40790000
408000                    ,:VHTRIP-TRIP-BEG-DTE                         40800000
408100                    ,:VHTRIP-TRIP-BEG-TME                         40810000
408200                    ,:VHTRIP-CRT-SRC-CDE                          40820000
408300                    ,:VHTRIP-LAST-UPD-DTE                         40830000
408400                    ,:VHTRIP-LAST-UPD-TME                         40840000
408500                    ,:VHTRIP-LAST-UPD-UID                         40850000
408600                    ,:VHTRIP-MANIFEST-NBR                         40860000
408700                    ,:VHTRIP-PLND-TRIP-SEQ                        40870000
408800                    ,:VHTRIP-PLND-ACTVY-CDE                       40880000
408900                    ,:VHTRIP-OWNR-SCAC-SHIP-DTE                   40890000
409000                    ,:VHTRIP-REF-TRIP-ID                          40900000
409100                    ,:VHTRIP-EST-AR-TMST                          40910000
409200                           :DN-EST-AR-TMST                        40920000
409300                    ,:VHTRIP-SPLT-XMIT-IND                        40930000
409400                    ,:VHTRIP-SPLT-XMIT-DTE                        40940000
409500                    ,:VHTRIP-SPLT-XMIT-TM                         40950000
409600           FROM   TVHTRIP                                         40960000
409700           WHERE  OWNER_SCAC_ID = :ASC-KEY-OWNER-SCAC-ID          40970000
409800             AND  TRIP_ID       = :DK-TRIP-ID                     40980000
409900         END-EXEC                                                 40990000
410000                                                                  41000000
410100         EVALUATE TRUE                                            41010000
410200             WHEN SQLCODE = +0                                    41020000
410300             WHEN SQLCODE = -904                                  41030000
410400             WHEN SQLCODE = -913                                  41040000
410500                 CONTINUE                                         41050000
410600                                                                  41060000
410700             WHEN SQLWARN0 NOT = SPACES                           41070000
410800             WHEN SQLCODE < +0                                    41080000
410900             WHEN SQLCODE > +0                                    41090000
411000                 MOVE SPACES TO PV-MESSAGE                        41100000
411100                 MOVE VHTRIP-OWNER-SCAC-ID TO PV-MESSAGE1         41110000
411200                 MOVE VHTRIP-VEH-NBR       TO PV-MESSAGE2         41120000
411300                 MOVE VHTRIP-TRIP-ID       TO PV-MESSAGE3         41130000
411400                 MOVE '7120-INSERT-TAUTRIP'                       41140000
411500                                   TO DP013-PARAGRAPH             41150000
411600                 MOVE 'SELECT A ROW ON TVHTRIP'                   41160000
411700                                   TO DP013-MESSAGE-TEXT(1)       41170000
411800                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       41180000
411900                 MOVE SQLCA        TO DP013-SQLCA                 41190000
412000                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    41200000
412100                 SET DP013-DB2-ABEND                              41210000
412200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41220000
412300                 PERFORM DP013-0000-PROCESS-ABEND                 41230000
412400         END-EVALUATE                                             41240000
412500     END-PERFORM.                                                 41250000
412600                                                                  41260000
412700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41270000
412800         MOVE '7120-INSERT-TAUTRIP'                               41280000
412900                                   TO DP013-PARAGRAPH             41290000
413000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              41300000
413100                                   TO DP013-MESSAGE-TEXT (1)      41310000
413200         MOVE 'TO SELECT A TVHTRIP ROW'                           41320000
413300                                   TO DP013-MESSAGE-TEXT (2)      41330000
413400         MOVE SQLCA                TO DP013-SQLCA                 41340000
413500         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    41350000
413600         SET DP013-DB2-ABEND                                      41360000
413700             DP013-XCTL-DISPLAY-RESTART                           41370000
413800                                   TO TRUE                        41380000
413900         PERFORM DP013-0000-PROCESS-ABEND                         41390000
414000     END-IF.                                                      41400000
414100                                                                  41410000
414200     MOVE 'CE'                     TO VHTRIP-CRT-SRC-CDE.         41420000
414300                                                                  41430000
414400     PERFORM                                                      41440000
414500         WITH TEST AFTER                                          41450000
414600         VARYING PV-RETRY-COUNTER                                 41460000
414700         FROM 1 BY 1                                              41470000
414800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41480000
414900             OR (SQLCODE = +0))                                   41490000
415000                                                                  41500000
415100         EXEC SQL                                                 41510000
415200             INSERT  INTO TAUTRIP                                 41520000
415300                    (OWNER_SCAC_ID                                41530000
415400                    ,VEH_NBR                                      41540000
415500                    ,TRIP_ID                                      41550000
415600                    ,TRIP_BEG_DTE                                 41560000
415700                    ,TRIP_BEG_TME                                 41570000
415800                    ,CRT_SRC_CDE                                  41580000
415900                    ,LAST_UPD_DTE                                 41590000
416000                    ,LAST_UPD_TME                                 41600000
416100                    ,LAST_UPD_UID                                 41610000
416200                    ,MANIFEST_NBR                                 41620000
416300                    ,PLND_TRIP_SEQ                                41630000
416400                    ,PLND_ACTVY_CDE                               41640000
416500                    ,OWNR_SCAC_SHIP_DTE                           41650000
416600                    ,REF_TRIP_ID                                  41660000
416700                    ,EST_AR_TMST                                  41670000
416800                    ,AUD_STATUS_CDE                               41680000
416900                    ,SPLT_XMIT_IND                                41690000
417000                    ,SPLT_XMIT_DTE                                41700000
417100                    ,SPLT_XMIT_TM )                               41710000
417200            VALUES  (:VHTRIP-OWNER-SCAC-ID                        41720000
417300                    ,:VHTRIP-VEH-NBR                              41730000
417400                       :DN-VEH-NBR                                41740000
417500                    ,:VHTRIP-TRIP-ID                              41750000
417600                    ,:VHTRIP-TRIP-BEG-DTE                         41760000
417700                    ,:VHTRIP-TRIP-BEG-TME                         41770000
417800                    ,:VHTRIP-CRT-SRC-CDE                          41780000
417900                    ,:VHTRIP-LAST-UPD-DTE                         41790000
418000                    ,:VHTRIP-LAST-UPD-TME                         41800000
418100                    ,:VHTRIP-LAST-UPD-UID                         41810000
418200                    ,:VHTRIP-MANIFEST-NBR                         41820000
418300                    ,:VHTRIP-PLND-TRIP-SEQ                        41830000
418400                    ,:VHTRIP-PLND-ACTVY-CDE                       41840000
418500                    ,:VHTRIP-OWNR-SCAC-SHIP-DTE                   41850000
418600                    ,:VHTRIP-REF-TRIP-ID                          41860000
418700                    ,:VHTRIP-EST-AR-TMST                          41870000
418800                           :DN-EST-AR-TMST                        41880000
418900                    ,:TRIPST-TRIP-STATUS-CDE                      41890000
419000                    ,:VHTRIP-SPLT-XMIT-IND                        41900000
419100                    ,:VHTRIP-SPLT-XMIT-DTE                        41910000
419200                    ,:VHTRIP-SPLT-XMIT-TM )                       41920000
419300         END-EXEC                                                 41930000
419400         EVALUATE TRUE                                            41940000
419500             WHEN SQLCODE = +0                                    41950000
419600             WHEN SQLCODE = -904                                  41960000
419700             WHEN SQLCODE = -913                                  41970000
419800                 CONTINUE                                         41980000
419900                                                                  41990000
420000             WHEN SQLWARN0 NOT = SPACES                           42000000
420100             WHEN SQLCODE < +0                                    42010000
420200             WHEN SQLCODE > +0                                    42020000
420300                 MOVE SPACES TO PV-MESSAGE                        42030000
420400                 MOVE VHTRIP-OWNER-SCAC-ID TO PV-MESSAGE1         42040000
420500                 MOVE VHTRIP-VEH-NBR       TO PV-MESSAGE2         42050000
420600                 MOVE VHTRIP-TRIP-ID       TO PV-MESSAGE3         42060000
420700                 MOVE '7120-INSERT-TAUTRIP'                       42070000
420800                                   TO DP013-PARAGRAPH             42080000
420900                 MOVE 'INSERT A ROW ON TAUTRIP'                   42090000
421000                                   TO DP013-MESSAGE-TEXT(1)       42100000
421100                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       42110000
421200                 MOVE SQLCA        TO DP013-SQLCA                 42120000
421300                 MOVE 'TAUTRIP'    TO DP013-DB2-TABLE-NAME (1)    42130000
421400                 SET DP013-DB2-ABEND                              42140000
421500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42150000
421600                 PERFORM DP013-0000-PROCESS-ABEND                 42160000
421700         END-EVALUATE                                             42170000
421800     END-PERFORM.                                                 42180000
421900                                                                  42190000
422000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42200000
422100         MOVE '7120-INSERT-TAUTRIP'                               42210000
422200                                   TO DP013-PARAGRAPH             42220000
422300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              42230000
422400                                   TO DP013-MESSAGE-TEXT (1)      42240000
422500         MOVE 'TO INSERT A TAUTRIP ROW'                           42250000
422600                                   TO DP013-MESSAGE-TEXT (2)      42260000
422700         MOVE SQLCA                TO DP013-SQLCA                 42270000
422800         MOVE 'TAUTRIP'            TO DP013-DB2-TABLE-NAME (1)    42280000
422900         SET DP013-DB2-ABEND                                      42290000
423000             DP013-XCTL-DISPLAY-RESTART                           42300000
423100                                   TO TRUE                        42310000
423200         PERFORM DP013-0000-PROCESS-ABEND                         42320000
423300     END-IF.                                                      42330000
423400                                                                  42340000
423500*----------------------------------------------------------------*42350000
423600* OPEN THE SHIPST CURSOR.                                        *42360000
423700*----------------------------------------------------------------*42370000
423800                                                                  42380000
423900 7200-OPEN-CURSOR.                                                42390000
424000     PERFORM                                                      42400000
424100         WITH TEST AFTER                                          42410000
424200         VARYING PV-RETRY-COUNTER                                 42420000
424300         FROM 1 BY 1                                              42430000
424400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42440000
424500                   OR (SQLCODE = ZERO))                           42450000
424600                                                                  42460000
424700             EXEC SQL                                             42470000
424800                  OPEN SHIPST-CSR                                 42480000
424900             END-EXEC                                             42490000
425000                                                                  42500000
425100                                                                  42510000
425200         EVALUATE TRUE                                            42520000
425300             WHEN SQLCODE = ZERO                                  42530000
425400             WHEN SQLCODE = -904                                  42540000
425500             WHEN SQLCODE = -913                                  42550000
425600                 CONTINUE                                         42560000
425700             WHEN SQLWARN0 NOT = SPACES                           42570000
425800             WHEN SQLCODE < ZERO                                  42580000
425900             WHEN SQLCODE > ZERO                                  42590000
426000                 MOVE '7200-OPEN-CURSOR'                          42600000
426100                                   TO DP013-PARAGRAPH             42610000
426200                 MOVE 'OPEN SHIPST CURSOR - '                     42620000
426300                                   TO DP013-MESSAGE-TEXT (1)      42630000
426400                 MOVE SQLCA        TO DP013-SQLCA                 42640000
426500                 MOVE 'TSHIPST '   TO DP013-DB2-TABLE-NAME (1)    42650000
426600                 SET DP013-DB2-ABEND                              42660000
426700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42670000
426800                 PERFORM DP013-0000-PROCESS-ABEND                 42680000
426900         END-EVALUATE                                             42690000
427000     END-PERFORM.                                                 42700000
427100                                                                  42710000
427200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42720000
427300         MOVE '7200-OPEN-CURSOR'   TO DP013-PARAGRAPH             42730000
427400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   42740000
427500                                   TO DP013-MESSAGE-TEXT (1)      42750000
427600         MOVE SQLCA                TO DP013-SQLCA                 42760000
427700         MOVE 'TSHIPST '           TO DP013-DB2-TABLE-NAME (1)    42770000
427800         SET DP013-DB2-ABEND                                      42780000
427900             DP013-XCTL-DISPLAY-RESTART                           42790000
428000                                   TO TRUE                        42800000
428100         PERFORM DP013-0000-PROCESS-ABEND                         42810000
428200     END-IF.                                                      42820000
428300                                                                  42830000
428400 EJECT                                                            42840000
428500*----------------------------------------------------------------*42850000
428600* CLOSE THE TMESSAGE CURSOR.                                     *42860000
428700*----------------------------------------------------------------*42870000
428800                                                                  42880000
428900 7230-CLOSE-CURSOR.                                               42890000
429000     EXEC SQL                                                     42900000
429100         CLOSE SHIPST-CSR                                         42910000
429200     END-EXEC.                                                    42920000
429300                                                                  42930000
429400                                                                  42940000
429500     EVALUATE TRUE                                                42950000
429600         WHEN SQLCODE = ZERO                                      42960000
429700             CONTINUE                                             42970000
429800         WHEN SQLWARN0 NOT = SPACES                               42980000
429900         WHEN SQLCODE < ZERO                                      42990000
430000         WHEN SQLCODE > ZERO                                      43000000
430100             MOVE '7230-CLOSE-CURSOR'                             43010000
430200                               TO DP013-PARAGRAPH                 43020000
430300             MOVE 'CLOSE SHPTPO CURSOR '                          43030000
430400                               TO DP013-MESSAGE-TEXT (1)          43040000
430500             MOVE SQLCA        TO DP013-SQLCA                     43050000
430600             MOVE 'TSHIPST '   TO DP013-DB2-TABLE-NAME (1)        43060000
430700             SET DP013-DB2-ABEND                                  43070000
430800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               43080000
430900             PERFORM DP013-0000-PROCESS-ABEND                     43090000
431000     END-EVALUATE.                                                43100000
431100                                                                  43110000
431200 EJECT                                                            43120000
431300 7260-FETCH-CURSOR.                                               43130000
431400     PERFORM                                                      43140000
431500         WITH TEST AFTER                                          43150000
431600         VARYING PV-RETRY-COUNTER                                 43160000
431700         FROM 1 BY 1                                              43170000
431800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43180000
431900             OR (SQLCODE = +0)                                    43190000
432000             OR (SQLCODE = +100))                                 43200000
432100                                                                  43210000
432200         EXEC SQL                                                 43220000
432300              FETCH SHIPST-CSR                                    43230000
432400              INTO  :SHIPST-SHIPT-STATUS-CDE                      43240000
432500         END-EXEC                                                 43250000
432600                                                                  43260000
432700         EVALUATE TRUE                                            43270000
432800             WHEN SQLCODE = +0                                    43280000
432900             WHEN SQLCODE = -904                                  43290000
433000             WHEN SQLCODE = -913                                  43300000
433100                  CONTINUE                                        43310000
433200                                                                  43320000
433300             WHEN SQLCODE = +100                                  43330000
433400                 SET PS-END-OF-STATUS-CURSOR TO TRUE              43340000
433500                                                                  43350000
433600             WHEN SQLWARN0 NOT = SPACES                           43360000
433700             WHEN SQLCODE < +0                                    43370000
433800             WHEN SQLCODE > +0                                    43380000
433900                  MOVE '7260-FETCH-CURSOR'                        43390000
434000                                  TO DP013-PARAGRAPH              43400000
434100                  MOVE 'UNSUCCESSFUL FETCH ON TSHIPST CURSOR'     43410000
434200                                  TO DP013-MESSAGE-TEXT (1)       43420000
434300                  MOVE SQLCA      TO DP013-SQLCA                  43430000
434400                  MOVE 'TSHIPST ' TO DP013-DB2-TABLE-NAME (1)     43440000
434500                  SET DP013-DB2-ABEND                             43450000
434600                      DP013-XCTL-DISPLAY-RESTART                  43460000
434700                                  TO TRUE                         43470000
434800                  PERFORM DP013-0000-PROCESS-ABEND                43480000
434900         END-EVALUATE                                             43490000
435000     END-PERFORM.                                                 43500000
435100                                                                  43510000
435200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43520000
435300         MOVE '7260-FETCH-CURSOR' TO DP013-PARAGRAPH              43530000
435400         MOVE 'MAX RETRIES EXCEEDED ON FETCH TSHIPST CURSOR'      43540000
435500                                  TO DP013-MESSAGE-TEXT (1)       43550000
435600         MOVE SQLCA               TO DP013-SQLCA                  43560000
435700         MOVE 'TSHIPST'           TO DP013-DB2-TABLE-NAME (1)     43570000
435800         SET DP013-DB2-ABEND                                      43580000
435900             DP013-XCTL-DISPLAY-RESTART                           43590000
436000                                  TO TRUE                         43600000
436100         PERFORM DP013-0000-PROCESS-ABEND                         43610000
436200     END-IF.                                                      43620000
436300                                                                  43630000
436400     IF SQLCODE = +0                                              43640000
436500         PERFORM 7290-DELETE-SHIPST                               43650000
436600     END-IF.                                                      43660000
436700                                                                  43670000
436800 7290-DELETE-SHIPST.                                              43680000
436900     PERFORM                                                      43690000
437000         WITH TEST AFTER                                          43700000
437100         VARYING PV-RETRY-COUNTER                                 43710000
437200         FROM 1 BY 1                                              43720000
437300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43730000
437400             OR (SQLCODE = +0))                                   43740000
437500                                                                  43750000
437600         EXEC SQL                                                 43760000
437700           DELETE FROM TSHIPST                                    43770000
437800           WHERE  SHIPT_ID         = :DK-SHIPT-ID                 43780000
437900             AND  SHIPT_STATUS_CDE = :SHIPST-SHIPT-STATUS-CDE     43790000
438000         END-EXEC                                                 43800000
438100                                                                  43810000
438200         EVALUATE TRUE                                            43820000
438300             WHEN SQLCODE = +0                                    43830000
438400             WHEN SQLCODE = -904                                  43840000
438500             WHEN SQLCODE = -913                                  43850000
438600                 CONTINUE                                         43860000
438700                                                                  43870000
438800             WHEN SQLWARN0 NOT = SPACES                           43880000
438900             WHEN SQLCODE < +0                                    43890000
439000             WHEN SQLCODE > +0                                    43900000
439100                 MOVE '7290-DELETE-SHIPST'                        43910000
439200                                   TO DP013-PARAGRAPH             43920000
439300                 MOVE 'DELETE INFO ON TSHIPST     '               43930000
439400                                   TO DP013-MESSAGE-TEXT(1)       43940000
439500                 MOVE SQLCA        TO DP013-SQLCA                 43950000
439600                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    43960000
439700                 SET DP013-DB2-ABEND                              43970000
439800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           43980000
439900                 PERFORM DP013-0000-PROCESS-ABEND                 43990000
440000         END-EVALUATE                                             44000000
440100     END-PERFORM.                                                 44010000
440200                                                                  44020000
440300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        44030000
440400         MOVE '7290-DELETE-SHIPST'                                44040000
440500                                   TO DP013-PARAGRAPH             44050000
440600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              44060000
440700                                   TO DP013-MESSAGE-TEXT (1)      44070000
440800         MOVE 'TO DELETE A TSHIPST ROW'                           44080000
440900                                   TO DP013-MESSAGE-TEXT (2)      44090000
441000         MOVE SQLCA                TO DP013-SQLCA                 44100000
441100         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    44110000
441200         SET DP013-DB2-ABEND                                      44120000
441300             DP013-XCTL-DISPLAY-RESTART                           44130000
441400                                   TO TRUE                        44140000
441500         PERFORM DP013-0000-PROCESS-ABEND                         44150000
441600     END-IF.                                                      44160000
441700                                                                  44170000
441800/                                                                 44180000
441900*----------------------------------------------------------------*44190000
442000*  INSERT A SHIPMENT STATUS ROW                                  *44200000
442100*----------------------------------------------------------------*44210000
442200 7300-INSERT-TSHIPST.                                             44220000
442300     MOVE DK-SHIPT-ID TO SHIPST-SHIPT-ID.                         44230000
442400                                                                  44240000
442500     PERFORM                                                      44250000
442600         WITH TEST AFTER                                          44260000
442700         VARYING PV-RETRY-COUNTER                                 44270000
442800         FROM 1 BY 1                                              44280000
442900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44290000
443000             OR (SQLCODE = +0)                                    44300000
443100             OR (SQLCODE = -803))                                 44310000
443200                                                                  44320000
443300         EXEC SQL                                                 44330000
443400             INSERT  INTO TSHIPST                                 44340000
443500                    (SHIPT_ID                                     44350000
443600                    ,SHIPT_STATUS_CDE                             44360000
443700                    ,STATUS_DTE                                   44370000
443800                    ,STATUS_TME                                   44380000
443900                    ,STATUS_UID)                                  44390000
444000            VALUES  (:SHIPST-SHIPT-ID                             44400000
444100                    ,:SHIPST-SHIPT-STATUS-CDE                     44410000
444200                    ,CURRENT DATE                                 44420000
444300                    ,CURRENT TIME                                 44430000
444400                    ,:DP020-USERID)                               44440000
444500         END-EXEC                                                 44450000
444600                                                                  44460000
444700         EVALUATE TRUE                                            44470000
444800             WHEN SQLCODE = +0                                    44480000
444900             WHEN SQLCODE = -803                                  44490000
445000             WHEN SQLCODE = -904                                  44500000
445100             WHEN SQLCODE = -913                                  44510000
445200                 CONTINUE                                         44520000
445300                                                                  44530000
445400             WHEN SQLWARN0 NOT = SPACES                           44540000
445500             WHEN SQLCODE < +0                                    44550000
445600             WHEN SQLCODE > +0                                    44560000
445700                 MOVE '7300-INSERT-TSHIPST'                       44570000
445800                                   TO DP013-PARAGRAPH             44580000
445900                 MOVE 'INSERT A ROW ON TSHIPST'                   44590000
446000                                   TO DP013-MESSAGE-TEXT(1)       44600000
446100                 MOVE SQLCA        TO DP013-SQLCA                 44610000
446200                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    44620000
446300                 SET DP013-DB2-ABEND                              44630000
446400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           44640000
446500                 PERFORM DP013-0000-PROCESS-ABEND                 44650000
446600         END-EVALUATE                                             44660000
446700     END-PERFORM.                                                 44670000
446800                                                                  44680000
446900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        44690000
447000         MOVE '7300-INSERT-TSHIPST'                               44700000
447100                                   TO DP013-PARAGRAPH             44710000
447200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              44720000
447300                                   TO DP013-MESSAGE-TEXT (1)      44730000
447400         MOVE 'TO INSERT A TSHIPST ROW'                           44740000
447500                                   TO DP013-MESSAGE-TEXT (2)      44750000
447600         MOVE SQLCA                TO DP013-SQLCA                 44760000
447700         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    44770000
447800         SET DP013-DB2-ABEND                                      44780000
447900             DP013-XCTL-DISPLAY-RESTART                           44790000
448000                                   TO TRUE                        44800000
448100         PERFORM DP013-0000-PROCESS-ABEND                         44810000
448200     END-IF.                                                      44820000
448300                                                                  44830000
448400                                                                  44840000
448500 7400-UPDATE-RECEIVERS.                                           44850000
448600     PERFORM 7410-OPEN-CURSOR.                                    44860000
448700     SET PS-NOT-END-OF-CURSOR TO TRUE.                            44870000
448800     PERFORM 7430-FETCH-CURSOR                                    44880000
448900         UNTIL PS-END-OF-CURSOR.                                  44890000
449000     PERFORM 7420-CLOSE-CURSOR.                                   44900000
449100*----------------------------------------------------------------*44910000
449200* OPEN THE SHPTPO CURSOR.                                        *44920000
449300*----------------------------------------------------------------*44930000
449400                                                                  44940000
449500 7410-OPEN-CURSOR.                                                44950000
449600     PERFORM                                                      44960000
449700         WITH TEST AFTER                                          44970000
449800         VARYING PV-RETRY-COUNTER                                 44980000
449900         FROM 1 BY 1                                              44990000
450000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45000000
450100                   OR (SQLCODE = ZERO))                           45010000
450200                                                                  45020000
450300             EXEC SQL                                             45030000
450400                  OPEN SHPTPO-CSR                                 45040000
450500             END-EXEC                                             45050000
450600                                                                  45060000
450700                                                                  45070000
450800         EVALUATE TRUE                                            45080000
450900             WHEN SQLCODE = ZERO                                  45090000
451000             WHEN SQLCODE = -904                                  45100000
451100             WHEN SQLCODE = -913                                  45110000
451200                 CONTINUE                                         45120000
451300             WHEN SQLWARN0 NOT = SPACES                           45130000
451400             WHEN SQLCODE < ZERO                                  45140000
451500             WHEN SQLCODE > ZERO                                  45150000
451600                 MOVE '7410-OPEN-CURSOR'                          45160000
451700                                   TO DP013-PARAGRAPH             45170000
451800                 MOVE 'OPEN SHPTPO CURSOR - '                     45180000
451900                                   TO DP013-MESSAGE-TEXT (1)      45190000
452000                 MOVE SQLCA        TO DP013-SQLCA                 45200000
452100                 MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (1)    45210000
452200                 SET DP013-DB2-ABEND                              45220000
452300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           45230000
452400                 PERFORM DP013-0000-PROCESS-ABEND                 45240000
452500         END-EVALUATE                                             45250000
452600     END-PERFORM.                                                 45260000
452700                                                                  45270000
452800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        45280000
452900         MOVE '7410-OPEN-CURSOR'   TO DP013-PARAGRAPH             45290000
453000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   45300000
453100                                   TO DP013-MESSAGE-TEXT (1)      45310000
453200         MOVE SQLCA                TO DP013-SQLCA                 45320000
453300         MOVE 'TSHPTPO '           TO DP013-DB2-TABLE-NAME (1)    45330000
453400         SET DP013-DB2-ABEND                                      45340000
453500             DP013-XCTL-DISPLAY-RESTART                           45350000
453600                                   TO TRUE                        45360000
453700         PERFORM DP013-0000-PROCESS-ABEND                         45370000
453800     END-IF.                                                      45380000
453900                                                                  45390000
454000 EJECT                                                            45400000
454100*----------------------------------------------------------------*45410000
454200* CLOSE THE TMESSAGE CURSOR.                                     *45420000
454300*----------------------------------------------------------------*45430000
454400                                                                  45440000
454500 7420-CLOSE-CURSOR.                                               45450000
454600     EXEC SQL                                                     45460000
454700         CLOSE SHPTPO-CSR                                         45470000
454800     END-EXEC.                                                    45480000
454900                                                                  45490000
455000                                                                  45500000
455100     EVALUATE TRUE                                                45510000
455200         WHEN SQLCODE = ZERO                                      45520000
455300             CONTINUE                                             45530000
455400         WHEN SQLWARN0 NOT = SPACES                               45540000
455500         WHEN SQLCODE < ZERO                                      45550000
455600         WHEN SQLCODE > ZERO                                      45560000
455700             MOVE '7420-CLOSE-CURSOR'                             45570000
455800                               TO DP013-PARAGRAPH                 45580000
455900             MOVE 'CLOSE SHPTPO CURSOR '                          45590000
456000                               TO DP013-MESSAGE-TEXT (1)          45600000
456100             MOVE SQLCA        TO DP013-SQLCA                     45610000
456200             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        45620000
456300             SET DP013-DB2-ABEND                                  45630000
456400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               45640000
456500             PERFORM DP013-0000-PROCESS-ABEND                     45650000
456600     END-EVALUATE.                                                45660000
456700                                                                  45670000
456800 EJECT                                                            45680000
456900 7430-FETCH-CURSOR.                                               45690000
457000     PERFORM                                                      45700000
457100         WITH TEST AFTER                                          45710000
457200         VARYING PV-RETRY-COUNTER                                 45720000
457300         FROM 1 BY 1                                              45730000
457400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45740000
457500             OR (SQLCODE = +0)                                    45750000
457600             OR (SQLCODE = +100))                                 45760000
457700                                                                  45770000
457800         EXEC SQL                                                 45780000
457900              FETCH SHPTPO-CSR                                    45790000
458000              INTO  :SHPTPO-PO-NBR                                45800000
458100                 ,  :SHPTPO-REC-SEQ-NBR                           45810000
458200                 ,  :SHPTPO-EXPTED-CART-CNT                       45820000
458300                 ,  :SHPTPO-ACTL-CART-CNT                         45830000
458400                 ,  :SHPTPO-VEND-CART-CT                          45840000
458500         END-EXEC                                                 45850000
458600                                                                  45860000
458700         EVALUATE TRUE                                            45870000
458800             WHEN SQLCODE = +0                                    45880000
458900             WHEN SQLCODE = -904                                  45890000
459000             WHEN SQLCODE = -913                                  45900000
459100                  CONTINUE                                        45910000
459200                                                                  45920000
459300             WHEN SQLCODE = +100                                  45930000
459400                 SET PS-END-OF-CURSOR TO TRUE                     45940000
459500                                                                  45950000
459600             WHEN SQLWARN0 NOT = SPACES                           45960000
459700             WHEN SQLCODE < +0                                    45970000
459800             WHEN SQLCODE > +0                                    45980000
459900                  MOVE '7430-FETCH-CURSOR'                        45990000
460000                                  TO DP013-PARAGRAPH              46000000
460100                  MOVE 'UNSUCCESSFUL FETCH ON TSHPTPO CURSOR'     46010000
460200                                  TO DP013-MESSAGE-TEXT (1)       46020000
460300                  MOVE SQLCA      TO DP013-SQLCA                  46030000
460400                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     46040000
460500                  SET DP013-DB2-ABEND                             46050000
460600                      DP013-XCTL-DISPLAY-RESTART                  46060000
460700                                  TO TRUE                         46070000
460800                  PERFORM DP013-0000-PROCESS-ABEND                46080000
460900         END-EVALUATE                                             46090000
461000     END-PERFORM.                                                 46100000
461100                                                                  46110000
461200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46120000
461300         MOVE '7430-FETCH-CURSOR' TO DP013-PARAGRAPH              46130000
461400         MOVE 'MAX RETRIES EXCEEDED ON FETCH TSHPTPO CURSOR'      46140000
461500                                  TO DP013-MESSAGE-TEXT (1)       46150000
461600         MOVE SQLCA               TO DP013-SQLCA                  46160000
461700         MOVE 'TSHPTPO'           TO DP013-DB2-TABLE-NAME (1)     46170000
461800         SET DP013-DB2-ABEND                                      46180000
461900             DP013-XCTL-DISPLAY-RESTART                           46190000
462000                                  TO TRUE                         46200000
462100         PERFORM DP013-0000-PROCESS-ABEND                         46210000
462200     END-IF.                                                      46220000
462300                                                                  46230000
462400     IF SQLCODE = +0                                              46240000
462500         IF SHPTPO-REC-SEQ-NBR > 0                                46250000
462600             MOVE PC-DEFAULT-TMST-9S TO RECEIV-REC-TMST           46260000
462700             PERFORM 7450-UPDATE-RECEIVER                         46270000
462800         END-IF                                                   46280000
462900     END-IF.                                                      46290000
463000                                                                  46300000
463100 7450-UPDATE-RECEIVER.                                            46310000
463200                                                                  46320000
463300     PERFORM                                                      46330000
463400         WITH TEST AFTER                                          46340000
463500         VARYING PV-RETRY-COUNTER                                 46350000
463600         FROM 1 BY 1                                              46360000
463700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46370000
463800             OR (SQLCODE = +0))                                   46380000
463900                                                                  46390000
464000         EXEC SQL                                                 46400000
464100           UPDATE TRECEIV                                         46410000
464200              SET REC_TMST         = :RECEIV-REC-TMST,            46420000
464300                  UPD_TMST         = CURRENT TIMESTAMP,           46430000
464400                  UPD_UID          = :DP020-USERID,               46440000
464500                  UPD_PGM_ID       = :PC-CURRENT-PROGRAM-NAME     46450000
464600           WHERE  ORD_NBR      = :SHPTPO-PO-NBR                   46460000
464700             AND  REC_SEQ_NBR  = :SHPTPO-REC-SEQ-NBR              46470000
464800         END-EXEC                                                 46480000
464900                                                                  46490000
465000         EVALUATE TRUE                                            46500000
465100             WHEN SQLCODE = +0                                    46510000
465200             WHEN SQLCODE = -904                                  46520000
465300             WHEN SQLCODE = -913                                  46530000
465400                 CONTINUE                                         46540000
465500                                                                  46550000
465600             WHEN SQLWARN0 NOT = SPACE                            46560000
465700             WHEN SQLCODE < +0                                    46570000
465800             WHEN SQLCODE > +0                                    46580000
465900                 MOVE '7450-UPDATE-RECEIVER'                      46590000
466000                                 TO DP013-PARAGRAPH               46600000
466100                 MOVE 'UPDATE ON RECEIPTS TABLE'                  46610000
466200                                 TO DP013-MESSAGE-TEXT (1)        46620000
466300                 MOVE SQLCA      TO DP013-SQLCA                   46630000
466400                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      46640000
466500                     SET DP013-DB2-ABEND                          46650000
466600                         DP013-XCTL-DISPLAY-RESTART               46660000
466700                                     TO TRUE                      46670000
466800                 PERFORM DP013-0000-PROCESS-ABEND                 46680000
466900         END-EVALUATE                                             46690000
467000     END-PERFORM.                                                 46700000
467100                                                                  46710000
467200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46720000
467300         MOVE '7450-UPDATE-RECEIVER'                              46730000
467400                                  TO DP013-PARAGRAPH              46740000
467500         MOVE 'MAX RETRIES EXCEEDED ON INSERT ON TRECEIV'         46750000
467600                                  TO DP013-MESSAGE-TEXT (1)       46760000
467700         MOVE SQLCA               TO DP013-SQLCA                  46770000
467800         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     46780000
467900         SET DP013-DB2-ABEND                                      46790000
468000             DP013-XCTL-DISPLAY-RESTART                           46800000
468100                                  TO TRUE                         46810000
468200         PERFORM DP013-0000-PROCESS-ABEND                         46820000
468300     END-IF.                                                      46830000
468400                                                                  46840000
468500 EJECT                                                            46850000
468600*----------------------------------------------------------------*46860000
468700*  UPDATE THE CURRENT TRIP ID ON TSHIPMT                         *46870000
468800*----------------------------------------------------------------*46880000
468900 7500-UPDATE-TSHIPMT.                                             46890000
469000                                                                  46900000
469100     PERFORM                                                      46910000
469200         WITH TEST AFTER                                          46920000
469300         VARYING PV-RETRY-COUNTER                                 46930000
469400         FROM 1 BY 1                                              46940000
469500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46950000
469600             OR (SQLCODE = +0))                                   46960000
469700                                                                  46970000
469800         EXEC SQL                                                 46980000
469900           UPDATE TSHIPMT                                         46990000
470000              SET LAST_UPD_DTE    = CURRENT DATE                  47000000
470100                , LAST_UPD_TME    = CURRENT TIME                  47010000
470200                , LAST_UPD_UID    = :DP020-USERID                 47020000
470300                , TRIP_ID         = :PV-TRIP-ID                   47030000
470400                , LAST_UPD_PGM_ID = :PC-CURRENT-PROGRAM-NAME      47040000
470500           WHERE  SHIPT_ID        = :DK-SHIPT-ID                  47050000
470600         END-EXEC                                                 47060000
470700                                                                  47070000
470800         EVALUATE TRUE                                            47080000
470900             WHEN SQLCODE = +0                                    47090000
471000             WHEN SQLCODE = -904                                  47100000
471100             WHEN SQLCODE = -913                                  47110000
471200                 CONTINUE                                         47120000
471300                                                                  47130000
471400             WHEN SQLWARN0 NOT = SPACES                           47140000
471500             WHEN SQLCODE < +0                                    47150000
471600             WHEN SQLCODE > +0                                    47160000
471700                 MOVE '7500-UPDATE-TSHIPMT'                       47170000
471800                                   TO DP013-PARAGRAPH             47180000
471900                 MOVE 'UPDATE TRIP ID ON TSHIPMT'                 47190000
472000                                   TO DP013-MESSAGE-TEXT(1)       47200000
472100                 MOVE SHIPMT-SHIPT-ID TO DP013-MESSAGE-TEXT(2)    47210000
472200                 MOVE SQLCA        TO DP013-SQLCA                 47220000
472300                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    47230000
472400                 SET DP013-DB2-ABEND                              47240000
472500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47250000
472600                 PERFORM DP013-0000-PROCESS-ABEND                 47260000
472700         END-EVALUATE                                             47270000
472800     END-PERFORM.                                                 47280000
472900                                                                  47290000
473000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47300000
473100         MOVE '7500-UPDATE-TSHIPMT'                               47310000
473200                                   TO DP013-PARAGRAPH             47320000
473300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              47330000
473400                                   TO DP013-MESSAGE-TEXT (1)      47340000
473500         MOVE 'TO UPDATE A TSHIPMT ROW'                           47350000
473600                                   TO DP013-MESSAGE-TEXT (2)      47360000
473700         MOVE SQLCA                TO DP013-SQLCA                 47370000
473800         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    47380000
473900         SET DP013-DB2-ABEND                                      47390000
474000             DP013-XCTL-DISPLAY-RESTART                           47400000
474100                                   TO TRUE                        47410000
474200         PERFORM DP013-0000-PROCESS-ABEND                         47420000
474300     END-IF.                                                      47430000
474400                                                                  47440000
474500                                                                  47450000
474600*----------------------------------------------------------------*47460000
474700*  TAKE A SNAPSHOT OF THE AFTER IMAGE OF TSHIPMT AND WRITE       *47470000
474800*  TO THE AUDIT TABLE.                                           *47480000
474900*----------------------------------------------------------------*47490000
475000 7600-AUDIT-TSHIPMT.                                              47500000
475100                                                                  47510000
475200     INITIALIZE DCLTAUSHIP.                                       47520000
475300                                                                  47530000
475400* CLT 12-02-2011 WR40574 ADDED CARR_AUTH_ID BELOW                 47540000
475500     PERFORM                                                      47550000
475600         WITH TEST AFTER                                          47560000
475700         VARYING PV-RETRY-COUNTER                                 47570000
475800         FROM 1 BY 1                                              47580000
475900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47590000
476000             OR (SQLCODE = +0))                                   47600000
476100                                                                  47610000
476200         EXEC SQL                                                 47620000
476300             SELECT  TRIP_ID                                      47630000
476400                    ,SHIPT_ID                                     47640000
476500                    ,CRT_SRC_CDE                                  47650000
476600                    ,LAST_UPD_DTE                                 47660000
476700                    ,LAST_UPD_TME                                 47670000
476800                    ,LAST_UPD_UID                                 47680000
476900                    ,PRO_SCAC_ID                                  47690000
477000                    ,PRO_NBR                                      47700000
477100                    ,BOL_NBR                                      47710000
477200                    ,SHIPPER_NME                                  47720000
477300                    ,SHIPT_TYP_CDE                                47730000
477400                    ,EXPTED_GRO_WGHT                              47740000
477500                    ,PKG_TYP_CDE                                  47750000
477600                    ,EXPTED_PKG_QTY                               47760000
477700                    ,FRGT_CHG_AMT                                 47770000
477800                    ,FRGT_TERMS_CDE                               47780000
477900                    ,EXPTED_PLT_QTY                               47790000
478000                    ,VEND_SHIP_DTE                                47800000
478100                    ,EST_AR_TMST                                  47810000
478200                    ,ORIG_SCAC_ID                                 47820000
478300                    ,LAST_UPD_PGM_ID                              47830000
478400                    ,CRE_USER_ID                                  47840000
478500                    ,CARR_CART_CT                                 47850000
478600                    ,CARR_LAST_UPD_DTE                            47860000
478700                    ,CARR_LAST_UPD_TIME                           47870000
478800                    ,VEND_CART_CT                                 47880000
478900                    ,VEND_LAST_UPD_DTE                            47890000
479000                    ,VEND_LAST_UPD_TIME                           47900000
479100                    ,VEH_NBR                                      47910000
479200                    ,AUTH_NBR                                     47920000
479300                    ,AUTH_DTE                                     47930000
479400                    ,CONFIRM_DTE                                  47940000
479500                    ,CONFIRM_TIME                                 47950000
479600                    ,COMPLETE_PRO_NBR                             47960000
479700                    ,COMPLETE_BOL_NBR                             47970000
479800                    ,PROCESSED_DTE                                47980000
479900                    ,INVC_NBR                                     47990000
480000                    ,CARR_AUTH_ID                                 48000000
480100            INTO     :SHIPMT-TRIP-ID                              48010000
480200                       :DN-TRIP-ID                                48020000
480300                    ,:SHIPMT-SHIPT-ID                             48030000
480400                    ,:SHIPMT-CRT-SRC-CDE                          48040000
480500                    ,:SHIPMT-LAST-UPD-DTE                         48050000
480600                    ,:SHIPMT-LAST-UPD-TME                         48060000
480700                    ,:SHIPMT-LAST-UPD-UID                         48070000
480800                    ,:SHIPMT-PRO-SCAC-ID                          48080000
480900                    ,:SHIPMT-PRO-NBR                              48090000
481000                    ,:SHIPMT-BOL-NBR                              48100000
481100                    ,:SHIPMT-SHIPPER-NME                          48110000
481200                    ,:SHIPMT-SHIPT-TYP-CDE                        48120000
481300                    ,:SHIPMT-EXPTED-GRO-WGHT                      48130000
481400                    ,:SHIPMT-PKG-TYP-CDE                          48140000
481500                    ,:SHIPMT-EXPTED-PKG-QTY                       48150000
481600                    ,:SHIPMT-FRGT-CHG-AMT                         48160000
481700                    ,:SHIPMT-FRGT-TERMS-CDE                       48170000
481800                    ,:SHIPMT-EXPTED-PLT-QTY                       48180000
481900                    ,:SHIPMT-VEND-SHIP-DTE                        48190000
482000                    ,:SHIPMT-EST-AR-TMST                          48200000
482100                       :DN-EST-AR-TMST                            48210000
482200                    ,:SHIPMT-ORIG-SCAC-ID                         48220000
482300                    ,:SHIPMT-LAST-UPD-PGM-ID                      48230000
482400                    ,:SHIPMT-CRE-USER-ID                          48240000
482500                    ,:SHIPMT-CARR-CART-CT                         48250000
482600                    ,:SHIPMT-CARR-LAST-UPD-DTE                    48260000
482700                    ,:SHIPMT-CARR-LAST-UPD-TIME                   48270000
482800                    ,:SHIPMT-VEND-CART-CT                         48280000
482900                    ,:SHIPMT-VEND-LAST-UPD-DTE                    48290000
483000                    ,:SHIPMT-VEND-LAST-UPD-TIME                   48300000
483100                    ,:SHIPMT-VEH-NBR                              48310000
483200                    ,:SHIPMT-AUTH-NBR                             48320000
483300                    ,:SHIPMT-AUTH-DTE                             48330000
483400                    ,:SHIPMT-CONFIRM-DTE                          48340000
483500                    ,:SHIPMT-CONFIRM-TIME                         48350000
483600                    ,:SHIPMT-COMPLETE-PRO-NBR                     48360000
483700                    ,:SHIPMT-COMPLETE-BOL-NBR                     48370000
483800                    ,:SHIPMT-PROCESSED-DTE                        48380000
483900                    ,:SHIPMT-INVC-NBR                             48390000
484000                    ,:SHIPMT-CARR-AUTH-ID                         48400000
484100           FROM   TSHIPMT                                         48410000
484200           WHERE  SHIPT_ID = :DK-SHIPT-ID                         48420000
484300         END-EXEC                                                 48430000
484400                                                                  48440000
484500         EVALUATE TRUE                                            48450000
484600             WHEN SQLCODE = +0                                    48460000
484700             WHEN SQLCODE = -904                                  48470000
484800             WHEN SQLCODE = -913                                  48480000
484900                 CONTINUE                                         48490000
485000                                                                  48500000
485100             WHEN SQLWARN0 NOT = SPACES                           48510000
485200             WHEN SQLCODE < +0                                    48520000
485300             WHEN SQLCODE > +0                                    48530000
485400                 MOVE '7600-AUDIT-TSHIPMT'                        48540000
485500                                   TO DP013-PARAGRAPH             48550000
485600                 MOVE 'SELECT A TSHIPMT ROW   '                   48560000
485700                                   TO DP013-MESSAGE-TEXT(1)       48570000
485800                 MOVE SQLCA        TO DP013-SQLCA                 48580000
485900                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    48590000
486000                 SET DP013-DB2-ABEND                              48600000
486100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48610000
486200                 PERFORM DP013-0000-PROCESS-ABEND                 48620000
486300         END-EVALUATE                                             48630000
486400     END-PERFORM.                                                 48640000
486500                                                                  48650000
486600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48660000
486700         MOVE '7600-AUDIT-TSHIPMT '                               48670000
486800                                   TO DP013-PARAGRAPH             48680000
486900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              48690000
487000                                   TO DP013-MESSAGE-TEXT (1)      48700000
487100         MOVE 'TO SELECT A TSHIPMT ROW'                           48710000
487200                                   TO DP013-MESSAGE-TEXT (2)      48720000
487300         MOVE SQLCA                TO DP013-SQLCA                 48730000
487400         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    48740000
487500         SET DP013-DB2-ABEND                                      48750000
487600             DP013-XCTL-DISPLAY-RESTART                           48760000
487700                                   TO TRUE                        48770000
487800         PERFORM DP013-0000-PROCESS-ABEND                         48780000
487900     END-IF.                                                      48790000
488000                                                                  48800000
488100     PERFORM                                                      48810000
488200         WITH TEST AFTER                                          48820000
488300         VARYING PV-RETRY-COUNTER                                 48830000
488400         FROM 1 BY 1                                              48840000
488500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48850000
488600             OR (SQLCODE = +0))                                   48860000
488700                                                                  48870000
488800* CLT 12-02-2011 WR40574 ADDED CARR_AUTH_ID BELOW                 48880000
488900         EXEC SQL                                                 48890000
489000             INSERT  INTO TAUSHIP                                 48900000
489100                    (TRIP_ID                                      48910000
489200                    ,SHIPT_ID                                     48920000
489300                    ,CRT_SRC_CDE                                  48930000
489400                    ,LAST_UPD_DTE                                 48940000
489500                    ,LAST_UPD_TME                                 48950000
489600                    ,LAST_UPD_UID                                 48960000
489700                    ,PRO_SCAC_ID                                  48970000
489800                    ,PRO_NBR                                      48980000
489900                    ,BOL_NBR                                      48990000
490000                    ,SHIPPER_NME                                  49000000
490100                    ,SHIPT_TYP_CDE                                49010000
490200                    ,EXPTED_GRO_WGHT                              49020000
490300                    ,PKG_TYP_CDE                                  49030000
490400                    ,EXPTED_PKG_QTY                               49040000
490500                    ,FRGT_CHG_AMT                                 49050000
490600                    ,FRGT_TERMS_CDE                               49060000
490700                    ,EST_AR_TMST                                  49070000
490800                    ,VEND_SHIP_DTE                                49080000
490900                    ,EXPTED_PLT_QTY                               49090000
491000                    ,ORIG_SCAC_ID                                 49100000
491100                    ,LAST_UPD_PGM_ID                              49110000
491200                    ,CRE_USER_ID                                  49120000
491300                    ,CARR_CART_CT                                 49130000
491400                    ,CARR_LAST_UPD_DTE                            49140000
491500                    ,CARR_LAST_UPD_TIME                           49150000
491600                    ,VEND_CART_CT                                 49160000
491700                    ,VEND_LAST_UPD_DTE                            49170000
491800                    ,VEND_LAST_UPD_TIME                           49180000
491900                    ,VEH_NBR                                      49190000
492000                    ,AUTH_NBR                                     49200000
492100                    ,AUTH_DTE                                     49210000
492200                    ,CONFIRM_DTE                                  49220000
492300                    ,CONFIRM_TIME                                 49230000
492400                    ,PROCESSED_DTE                                49240000
492500                    ,INVC_NBR                                     49250000
492600                    ,AUD_STATUS_CDE                               49260000
492700                    ,CARR_AUTH_ID  )                              49270000
492800            VALUES  (:SHIPMT-TRIP-ID                              49280000
492900                       :DN-TRIP-ID                                49290000
493000                    ,:SHIPMT-SHIPT-ID                             49300000
493100                    ,:SHIPMT-CRT-SRC-CDE                          49310000
493200                    ,:SHIPMT-LAST-UPD-DTE                         49320000
493300                    ,:SHIPMT-LAST-UPD-TME                         49330000
493400                    ,:SHIPMT-LAST-UPD-UID                         49340000
493500                    ,:SHIPMT-PRO-SCAC-ID                          49350000
493600                    ,:SHIPMT-COMPLETE-PRO-NBR                     49360000
493700                    ,:SHIPMT-COMPLETE-BOL-NBR                     49370000
493800                    ,:SHIPMT-SHIPPER-NME                          49380000
493900                    ,:SHIPMT-SHIPT-TYP-CDE                        49390000
494000                    ,:SHIPMT-EXPTED-GRO-WGHT                      49400000
494100                    ,:SHIPMT-PKG-TYP-CDE                          49410000
494200                    ,:SHIPMT-EXPTED-PKG-QTY                       49420000
494300                    ,:SHIPMT-FRGT-CHG-AMT                         49430000
494400                    ,:SHIPMT-FRGT-TERMS-CDE                       49440000
494500                    ,:SHIPMT-EST-AR-TMST                          49450000
494600                       :DN-EST-AR-TMST                            49460000
494700                    ,:SHIPMT-VEND-SHIP-DTE                        49470000
494800                    ,:SHIPMT-EXPTED-PLT-QTY                       49480000
494900                    ,:SHIPMT-ORIG-SCAC-ID                         49490000
495000                    ,:SHIPMT-LAST-UPD-PGM-ID                      49500000
495100                    ,:SHIPMT-CRE-USER-ID                          49510000
495200                    ,:SHIPMT-CARR-CART-CT                         49520000
495300                    ,:SHIPMT-CARR-LAST-UPD-DTE                    49530000
495400                    ,:SHIPMT-CARR-LAST-UPD-TIME                   49540000
495500                    ,:SHIPMT-VEND-CART-CT                         49550000
495600                    ,:SHIPMT-VEND-LAST-UPD-DTE                    49560000
495700                    ,:SHIPMT-VEND-LAST-UPD-TIME                   49570000
495800                    ,:SHIPMT-VEH-NBR                              49580000
495900                    ,:SHIPMT-AUTH-NBR                             49590000
496000                    ,:SHIPMT-AUTH-DTE                             49600000
496100                    ,:SHIPMT-CONFIRM-DTE                          49610000
496200                    ,:SHIPMT-CONFIRM-TIME                         49620000
496300                    ,:SHIPMT-PROCESSED-DTE                        49630000
496400                    ,:SHIPMT-INVC-NBR                             49640000
496500                    ,:SHIPST-SHIPT-STATUS-CDE                     49650000
496600                    ,:SHIPMT-CARR-AUTH-ID     )                   49660000
496700         END-EXEC                                                 49670000
496800                                                                  49680000
496900         EVALUATE TRUE                                            49690000
497000             WHEN SQLCODE = +0                                    49700000
497100             WHEN SQLCODE = -904                                  49710000
497200             WHEN SQLCODE = -913                                  49720000
497300                 CONTINUE                                         49730000
497400                                                                  49740000
497500             WHEN SQLWARN0 NOT = SPACES                           49750000
497600             WHEN SQLCODE < +0                                    49760000
497700             WHEN SQLCODE > +0                                    49770000
497800                 MOVE '7600-AUDIT-TSHIPMT '                       49780000
497900                                   TO DP013-PARAGRAPH             49790000
498000                 MOVE 'INSERT A ROW ON TAUSHIP'                   49800000
498100                                   TO DP013-MESSAGE-TEXT(1)       49810000
498200                 MOVE SQLCA        TO DP013-SQLCA                 49820000
498300                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    49830000
498400                 SET DP013-DB2-ABEND                              49840000
498500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           49850000
498600                 PERFORM DP013-0000-PROCESS-ABEND                 49860000
498700         END-EVALUATE                                             49870000
498800     END-PERFORM.                                                 49880000
498900                                                                  49890000
499000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49900000
499100         MOVE '7600-AUDIT-TSHIPMT'                                49910000
499200                                   TO DP013-PARAGRAPH             49920000
499300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              49930000
499400                                   TO DP013-MESSAGE-TEXT (1)      49940000
499500         MOVE 'TO INSERT A TAUSHIP ROW'                           49950000
499600                                   TO DP013-MESSAGE-TEXT (2)      49960000
499700         MOVE SQLCA                TO DP013-SQLCA                 49970000
499800         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    49980000
499900         SET DP013-DB2-ABEND                                      49990000
500000             DP013-XCTL-DISPLAY-RESTART                           50000000
500100                                   TO TRUE                        50010000
500200         PERFORM DP013-0000-PROCESS-ABEND                         50020000
500300     END-IF.                                                      50030000
500400                                                                  50040000
500500/                                                                 50050000
500600******************************************************************50060000
500700* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *50070000
500800******************************************************************50080000
500900 9100-READ-SEL-QUEUE.                                             50090000
501000     EXEC CICS                                                    50100000
501100         READQ TS                                                 50110000
501200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        50120000
501300             INTO  (TR006-DOCK-SCHEDULE-REC)                      50130000
501400             ITEM  (ASC-SEL-ITEM)                                 50140000
501500             RESP  (PV-CICS-RESP)                                 50150000
501600     END-EXEC.                                                    50160000
501700                                                                  50170000
501800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        50180000
501900         CONTINUE                                                 50190000
502000     ELSE                                                         50200000
502100         SET DP013-LOGIC-ABEND                                    50210000
502200             DP013-NO-ROLLBACK     TO TRUE                        50220000
502300         MOVE '9100-READ-SEL-QUEUE'                               50230000
502400                                   TO DP013-PARAGRAPH             50240000
502500         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    50250000
502600                                   TO DP013-MESSAGE-TEXT (1)      50260000
502700         PERFORM DP013-0000-PROCESS-ABEND                         50270000
502800     END-IF.                                                      50280000
502900                                                                  50290000
503000/                                                                 50300000
503100******************************************************************50310000
503200* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *50320000
503300******************************************************************50330000
503400 9200-REWRITE-LIST-QUEUE.                                         50340000
503500     EXEC CICS                                                    50350000
503600          WRITEQ TS                                               50360000
503700              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     50370000
503800              FROM    (TR006-DOCK-SCHEDULE-REC)                   50380000
503900              ITEM    (ASC-SEL-ITEM)                              50390000
504000              RESP    (PV-CICS-RESP)                              50400000
504100              REWRITE                                             50410000
504200     END-EXEC.                                                    50420000
504300                                                                  50430000
504400     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    50440000
504500         SET DP013-CICS-ABEND                                     50450000
504600             DP013-NO-ROLLBACK     TO TRUE                        50460000
504700         MOVE '9200-REWRITE-LIST-QUEUE'                           50470000
504800                                   TO DP013-PARAGRAPH             50480000
504900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   50490000
505000                                   TO DP013-MESSAGE-TEXT (1)      50500000
505100         PERFORM DP013-0000-PROCESS-ABEND                         50510000
505200     END-IF.                                                      50520000
505300                                                                  50530000
505400/                                                                 50540000
505401******************************************************************50540100
505402 9903-WRITE-CICS-LOG.                                             50540200
505403                                                                  50540300
505404     EXEC CICS                                                    50540400
505405         WRITEQ TD                                                50540500
505406             QUEUE  ('CSSL')                                      50540600
505407             FROM   (PV-CICS-MSG-AREA)                            50540700
505408             RESP   (PV-CICS-RESP)                                50540800
505409     END-EXEC.                                                    50540900
505410     MOVE SPACES                  TO PV-CICS-MSG-AREA.            50541000
505420/                                                                 50542000
505430*----------------------------------------------------------------*50543000
505440*    ABEND PROCESSOR MODULE                                      *50544000
505450*----------------------------------------------------------------*50545000
505460                                                                  50546000
505470     COPY DPPD013.                                                50547000
