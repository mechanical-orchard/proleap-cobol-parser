000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.             PCKRF864.                                00030000
000400 AUTHOR.                 LYNN MCADAMS.                            00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            MARCH, 2001.                             00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000* * * *  COMPILE USING SOCKET OPTION ON 2ND COMPILE PANEL  * * * *00100000
001100*                                                                 00110000
001200* THIS PROGRAM DISPLAYS THE MASTER CONTAINER ID SCREEN ON THE LRT 00120000
001300* (LASER RADIO TERMINAL) WHEN #2 BUILD MASTER IS SELECTED         00130000
001400* FROM THE CARTON FUNCTIONS MENU.  IT WILL ACCEPT THE ENTRY OF    00140000
001500* A MASTER CONTAINER ID ONLY.  IF THE MASTER CONTAINER ID FIELD   00150000
001600* IS LEFT BLANK, THE SYSTEM WILL GENERATE A MASTER CONTAINER ID.  00160000
001700*                                                                 00170000
001800* IF THE CARTON KEYED/SCANNED EXISTS, THE DEST STR AND SML PRTR   00180000
001900* NBR WILL APPEAR. THE ASSOCIATE WILL BE ABLE TO PRESS ENTER TO   00190000
002000* GET TO THE BARCODE ENTRY SCREEN WHERE CARTONS CAN BE ADDED      00200000
002100* UNDER THAT MASTER CONTAINER ID.                                 00210000
002200*                                                                 00220000
002300* IF THE CARTON KEYED/SCANNED DOES NOT EXIST, THE DEST STR AND    00230000
002400* SML PRTR NBR MUST BE ENTERED.  THE ASSOCIATE WILL BE ABLE TO    00240000
002500* PRESS F4-CREATE/PRINT LBL AND THE SYSTEM WILL GENERATE A        00250000
002600* MASTER CONTAINER ID AND PRINT A LABEL.                          00260000
002700******************************************************************00270000
002700* CHANGE LOG:                                                    *00271016
002700* 07/17/2023  JEAN KURK  REMOVE TABLE TSUCTSL  CHG0290390        *00271117
002700******************************************************************00272016
002800*                                                                 00280000
002900*                                                                 00290000
003000 ENVIRONMENT DIVISION.                                            00300000
003100 DATA DIVISION.                                                   00310000
003200 WORKING-STORAGE SECTION.                                         00320000
003300*                                                                 00330000
003400*                                                                 00340000
003500                                                                  00350000
003600 01  DK-DB2-KEYS.                                                 00360000
003700     05  DK-SHIPT-UNT-ID                 PIC  S9(18)V COMP-3.     00370000
003800     05  DK-BARCODE-NBR                  PIC  X(22) VALUE SPACES. 00380000
003900     05  DK-STORE-NBR                    PIC S9(04) COMP.         00390000
004000     05  DK-OPER-UNT-ID                  PIC S9(04)  COMP-3.      00400000
004100                                                                  00410000
004200* PROGRAM CONSTANTS                                               00420000
004300 01  PC-PROGRAM-CONSTANTS.                                        00430000
004400     05  PC-TRANID                       PIC  X(04)  VALUE 'E864'.00440000
004500     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00450000
004600                                                     COMP SYNC.   00460000
004700     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00470000
004800                                                     COMP SYNC.   00480000
004900     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00490000
005000                                                     COMP SYNC.   00500000
005100     05  PC-MST                          PIC  X(03)  VALUE 'MST'. 00510000
005200     05  PC-ACTIVE                       PIC  X(01)  VALUE 'Y'.   00520000
005300     05  PC-MASTER-CONTAINER             PIC  X(20)               00530000
005400                                   VALUE '* MASTER CONTAINER *'.  00540000
005500     05  PC-OPER-UNT-ID                  PIC S9(04)  VALUE +0     00550000
005600                                                     COMP.        00560000
005700     05  PC-0                            PIC  X(01)  VALUE '0'.   00570000
005800     05  PC-00                           PIC  X(02)  VALUE '00'.  00580000
005900     05  PC-0-9                          PIC  9(01)  VALUE 0.     00590000
006000     05  PC-1                            PIC  X(01)  VALUE '1'.   00600000
006100     05  PC-4                            PIC  X(01)  VALUE '4'.   00610000
006200     05  PC-01                           PIC  X(02)  VALUE '01'.  00620000
006300     05  PC-18                           PIC S9(04)  VALUE 18     00630000
006400                                                     COMP SYNC.   00640000
006500*** BEGIN - AHP 02/18/08                                          00650000
006600     05  PC-19                           PIC S9(04)  VALUE 19     00660000
006700                                                     COMP SYNC.   00670000
006800*** END   - AHP 02/18/08                                          00680000
006900     05  PC-20                           PIC S9(04)  VALUE 20     00690000
007000                                                     COMP SYNC.   00700000
007100     05  PC-41                           PIC  X(02)  VALUE '41'.  00710000
007200     05  PC-49                           PIC  X(02)  VALUE '49'.  00720000
007300     05  PC-50                           PIC  X(02)  VALUE '50'.  00730000
007400     05  PC-95                           PIC  X(02)  VALUE '95'.  00740000
007500     05  PC-A                            PIC  X(01)  VALUE 'A'.   00750000
007600     05  PC-B                            PIC  X(01)  VALUE 'B'.   00760000
007700     05  PC-C                            PIC  X(01)  VALUE 'C'.   00770000
007800     05  PC-D                            PIC  X(01)  VALUE 'D'.   00780000
007900     05  PC-E                            PIC  X(01)  VALUE 'E'.   00790000
008000     05  PC-F                            PIC  X(01)  VALUE 'F'.   00800000
008100     05  PC-G                            PIC  X(01)  VALUE 'G'.   00810000
008200     05  PC-H                            PIC  X(01)  VALUE 'H'.   00820000
008300     05  PC-I                            PIC  X(01)  VALUE 'I'.   00830000
008400     05  PC-MGMX                         PIC  X(04)  VALUE 'MGMX'.00840000
008500     05  PC-UG                           PIC  X(02)  VALUE 'UG'.  00850000
008600     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   00860000
008700     05  PC-90                           PIC  X(02)  VALUE '90'.  00870000
008800                                                                  00880000
008900     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'PCKRF864'.   00890000
009000     05  PC-MANIFEST-MENU-PGM       PIC X(08) VALUE 'PCKRF850'.   00900000
009100     05  PC-DC-RF-APPL-PGM          PIC X(08) VALUE 'MPKCS027'.   00910000
009200     05  PC-ERROR-SCREEN-PGM        PIC X(08) VALUE 'PCKRF852'.   00920000
009300     05  PC-MASTER-CONTAINER-PGM    PIC X(08) VALUE 'PCKRF864'.   00930000
009400     05  PC-BARCODE-ENTRY-PGM       PIC X(08) VALUE 'PCKRF865'.   00940000
009600     05  PC-CARTON-FUNC-PGM         PIC X(08) VALUE 'PCKRF884'.   00960000
009700     05  PC-MSTR-CONTAINER-TYP-PGM  PIC X(08) VALUE 'PCKRF886'.   00970000
009800     05  PC-PRTR-VALIDATION-PGM     PIC X(08) VALUE 'DPKCS060'.   00980000
009900     05  PC-REPORT-PGM-1            PIC X(08) VALUE 'PCKCS126'.   00990000
010000     05  PC-PCKCS721                PIC X(08) VALUE 'PCKCS721'.   01000000
010100     05  PC-SHIPPING                PIC X(08) VALUE 'SHIPPING'.   01010000
010200                                                                  01020000
010300* ERROR MESSAGES                                                  01030000
010400     05  PC-UNRECOGNIZED-MASTER-MSG PIC X(19) VALUE               01040000
010500                                           'USE 41 SML FOR MSTR'. 01050000
010510     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               01051000
010520                                           'UNRECOGNIZED PF KEY'. 01052000
010600     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               01060000
010700                                           'ENTER THROUGH MENU '. 01070000
010800     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               01080000
010900                                           'TRANS NOT AVAILABLE'. 01090000
011000     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               01100000
011100                                           'PLEASE ENTER FIELD '. 01110000
011200     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               01120000
011300                                           'MUST BE NUMERIC    '. 01130000
011400     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               01140000
011500                                           'MUST BE > ZERO     '. 01150000
011600     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               01160000
011700                                           'FIRST DIGIT NOT 0  '. 01170000
011800     05  PC-TOO-MANY-DIGITS         PIC X(19) VALUE               01180000
011900                                           'TOO MANY DIGITS    '. 01190000
012000     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               01200000
012100                                           'MORE DIGITS REQUIRD'. 01210000
012200     05  PC-INVALID-STORE-NBR       PIC X(19) VALUE               01220000
012300                                           'INVALID STORE NBR  '. 01230000
012400     05  PC-INVALID-PRINTER-ID      PIC X(19) VALUE               01240000
012500                                           'INVALID PRINTER ID '. 01250000
012600     05  PC-PRINTER-ID-REQUIRED     PIC X(19) VALUE               01260000
012700                                           'PRINTER ID REQUIRED'. 01270000
012800     05  PC-MUST-BE-KOHLS-BARCODE   PIC X(19) VALUE               01280000
012900                                           'MUST BE KOHLS BRCDE'. 01290000
013000     05  PC-PRESS-F4-CREATE-PRT     PIC X(19) VALUE               01300000
013100                                           'PRESS F4-CREATE/PRT'. 01310000
013200     05  PC-LABEL-PRINTED           PIC X(19) VALUE               01320000
013300                                           'LABEL PRINTED      '. 01330000
013400     05  PC-LABEL-PRINT-FAIL        PIC X(19) VALUE               01340000
013500                                           'LABEL PRINT FAILED '. 01350000
013600     05  PC-CARTON-INACTIVATED      PIC X(19) VALUE               01360000
013700                                           'CARTON INACTIVATED '. 01370000
013710*CHG0144243 - START                                               01371013
013720     05  PC-ENTER-NEW-SML           PIC X(19) VALUE               01372011
013730                                           'SML EXISTS.TRY NEW '. 01373011
013740*CHG0144243 - END                                                 01374012
013800     05  PC-CICS-ABEND-MSG          PIC  X(19)  VALUE             01380000
013900                                           'CICS ABEND -CALL DP'. 01390000
014000     05  PC-CARTON-STATUS-ERROR     PIC  X(19)  VALUE             01400000
014100                                           'CARTON STATUS ERROR'. 01410000
014200     05  PC-DATABASE-ERROR          PIC  X(19)  VALUE             01420000
014300                                           'DATABASE ER-CALL DP'. 01430000
014400     05  PC-DATABASE-BUSY           PIC  X(19)  VALUE             01440000
014500                                           'DB BUSY - TRY AGAIN'. 01450000
014600     05  PC-INVALID-MST-TYPE        PIC  X(19).                   01460000
014700     05  PC-INVALID-MST-TYPE-R REDEFINES PC-INVALID-MST-TYPE.     01470000
014800         10 PC-INVALID-TYPE-TEXT    PIC  X(7).                    01480000
014900         10 PC-INVALID-TYPE-N       PIC  X(12).                   01490000
015000                                                                  01500000
015100* PROGRAM SWITCHES                                                01510000
015200 01  PS-PROGRAM-SWITCHES.                                         01520000
015300     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01530000
015400         88  PS-ERROR-YES                            VALUE 'Y'.   01540000
015500         88  PS-ERROR-NO                             VALUE 'N'.   01550000
015600*    05  PS-END-OF-CURSOR-SW             PIC  X(01)  VALUE 'N'.   01560016
015700*        88  PS-END-OF-CURSOR                        VALUE 'Y'.   01570016
015800*        88  PS-NOT-END-OF-CURSOR                    VALUE 'N'.   01580016
015900     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01590000
016000         88  PS-VALID-INPUT                          VALUE 'Y'.   01600000
016100         88  PS-INVALID-INPUT                        VALUE 'N'.   01610000
016200     05  PS-MASTER-CTN-IND               PIC  X(01)  VALUE 'Y'.   01620000
016300         88  PS-MASTER-CTN                           VALUE 'Y'.   01630000
016400         88  PS-NOT-MASTER-CTN                       VALUE 'N'.   01640000
016500     05  PS-SCANNED-DATA-IND             PIC  X(01)  VALUE 'Y'.   01650000
016600         88  PS-NOT-SCANNED-DATA                     VALUE 'N'.   01660000
016700         88  PS-SCANNED-DATA                         VALUE 'Y'.   01670000
016800     05  PS-CARTON-EXISTS-SW             PIC  X(01)  VALUE 'Y'.   01680000
016900         88  PS-CARTON-EXISTS                        VALUE 'Y'.   01690000
017000         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   01700000
017100     05  PS-PRINTER-ID-SW                PIC  X(01)  VALUE 'Y'.   01710000
017200         88  PS-VALID-PRINTER-ID                     VALUE 'Y'.   01720000
017300         88  PS-INVALID-PRINTER-ID                   VALUE 'N'.   01730000
017400     05  PS-STORE-NBR-SW                 PIC  X(01)  VALUE 'Y'.   01740000
017500         88  PS-VALID-STORE-NBR                      VALUE 'Y'.   01750000
017600         88  PS-INVALID-STORE-NBR                    VALUE 'N'.   01760000
017700     05  PS-MASTER-ID-CREATED-SW         PIC  X(01)  VALUE 'Y'.   01770000
017800         88  PS-MASTER-ID-CREATED                    VALUE 'Y'.   01780000
017900         88  PS-MASTER-ID-NOT-CREATED                VALUE 'N'.   01790000
018000     05  PS-DONE-PROCESSING-SW           PIC X(01)   VALUE 'N'.   01800000
018100         88  PS-DONE-PROCESSING                      VALUE 'Y'.   01810000
018200     05  PS-PROTECT-FIELD-SW             PIC  X(01)  VALUE 'Y'.   01820000
018300         88  PS-PROTECT-FIELD                        VALUE 'Y'.   01830000
018400         88  PS-UNPROTECT-FIELD                      VALUE 'N'.   01840000
018500     05  PS-XCTL-SW                      PIC X(04)  VALUE SPACES. 01850000
018600         88  PS-XCTL-E852                           VALUE 'E852'. 01860000
018700                                                                  01870000
018800     05  PS-UPDATE-COMMIT-SW             PIC X      VALUE 'N'.    01880000
018900         88  PS-UPDATE-COMMIT                       VALUE 'Y'.    01890000
019000         88  PS-UPDATE-ROLLBACK                     VALUE 'N'.    01900000
019100*                                                                 01910000
019200                                                                  01920000
019300* PROGRAM VARIABLES                                               01930000
019400 01  PV-PROGRAM-VARIABLES.                                        01940000
019500     05  PV-NULL-IND                    PIC S9(04)  VALUE ZEROS   01950000
019600                                                    COMP SYNC.    01960000
019700     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01970000
019800                                                     COMP SYNC.   01980000
019900     05  PV-CURRENT-TIMESTAMP            PIC X(26)  VALUE SPACE.  01990000
020000     05  PV-CICS-MSG-AREA.                                        02000000
020100         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 02010000
020200         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 02020000
020300         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 02030000
020400         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 02040000
020500         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 02050000
020600         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 02060000
020700     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02070000
020800     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 02080000
020900     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  02090000
021000                                                     COMP SYNC.   02100000
021100     05  PV-CARTON-MSG.                                           02110000
021200         10  FILLER                   PIC X(01) VALUE SPACE.      02120000
021300         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 02130000
021400         10  FILLER                   PIC X(01) VALUE '-'.        02140000
021500         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     02150000
021600         10  FILLER                   PIC X(05) VALUE ' REC='.    02160000
021700         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     02170000
021800         10  FILLER                   PIC X(10)                   02180000
021900                             VALUE ' CTN STAT='.                  02190000
022000         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     02200000
022100         10  FILLER                   PIC X(01) VALUE '/'.        02210000
022200         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     02220000
022300         10  FILLER                   PIC X(05) VALUE ' SER='.    02230000
022400         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     02240000
022500         10  FILLER                   PIC X(06) VALUE ' TRIP='.   02250000
022600         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     02260000
022700         10  FILLER                   PIC X(06) VALUE ' STAT='.   02270000
022800         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     02280000
022900         10  FILLER                   PIC X(06) VALUE ' USER='.   02290000
023000         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     02300000
023100                                                                  02310000
023200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02320000
023300     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  02330000
023400                                                     COMP SYNC.   02340000
023500     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  02350000
023600                                                     COMP SYNC.   02360000
023700     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  02370000
023800                                                     COMP SYNC.   02380000
023900     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  02390000
024000                                                     COMP SYNC.   02400000
024100     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  02410000
024200                                                     COMP SYNC.   02420000
024300     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 02430000
024400     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 02440000
024500     05  PV-TOTAL                        PIC  9(04).              02450000
024600     05  FILLER REDEFINES PV-TOTAL.                               02460000
024700         10  FILLER                      PIC  9(03).              02470000
024800         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              02480000
024900     05  PV-MST-TOTAL-CARTONS            PIC  9(05).              02490000
025000     05  PV-MST-TOTAL-UNITS              PIC  9(07).              02500000
025100     05  PV-DISPLAY-SEQ-NBR              PIC  S9(9).              02510000
025200     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    02520000
025300                                                     COMP SYNC.   02530000
025400     05  PV-CTN-X                        PIC  X(18).              02540000
025500     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              02550000
025600     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          02560000
025700         10  PV-CTN-9-1                  PIC  9(01).              02570000
025800         10  PV-CTN-9-2                  PIC  9(01).              02580000
025900         10  PV-CTN-9-3                  PIC  9(01).              02590000
026000         10  PV-CTN-9-4                  PIC  9(01).              02600000
026100         10  PV-CTN-9-5                  PIC  9(01).              02610000
026200         10  PV-CTN-9-6                  PIC  9(01).              02620000
026300         10  PV-CTN-9-7                  PIC  9(01).              02630000
026400         10  PV-CTN-9-8                  PIC  9(01).              02640000
026500         10  PV-CTN-9-9                  PIC  9(01).              02650000
026600         10  PV-CTN-9-10                 PIC  9(01).              02660000
026700         10  PV-CTN-9-11                 PIC  9(01).              02670000
026800         10  PV-CTN-9-12                 PIC  9(01).              02680000
026900         10  PV-CTN-9-13                 PIC  9(01).              02690000
027000         10  PV-CTN-9-14                 PIC  9(01).              02700000
027100         10  PV-CTN-9-15                 PIC  9(01).              02710000
027200         10  PV-CTN-9-16                 PIC  9(01).              02720000
027300         10  PV-CTN-9-17                 PIC  9(01).              02730000
027400         10  PV-CTN-9-18                 PIC  9(01).              02740000
027500                                                                  02750000
027600                                                                  02760000
027700     05  PV-OPER-UNT-ID-X                PIC X(03).               02770000
027800     05  PV-OPER-UNT-ID  REDEFINES PV-OPER-UNT-ID-X               02780000
027900                                         PIC 9(03).               02790000
028000                                                                  02800000
028100     05  PV-MFST-NBR                     PIC S9(09)   VALUE ZERO  02810000
028200                                                      COMP SYNC.  02820000
028300                                                                  02830000
028400     05  PV-MANIFEST-NBR                 PIC 9(08).               02840000
028500     05  PV-MANIFEST-NBR-R REDEFINES PV-MANIFEST-NBR.             02850000
028600         10  PV-MANF-9-11                PIC  9(01).              02860000
028700         10  PV-MANF-9-12                PIC  9(01).              02870000
028800         10  PV-MANF-9-13                PIC  9(01).              02880000
028900         10  PV-MANF-9-14                PIC  9(01).              02890000
029000         10  PV-MANF-9-15                PIC  9(01).              02900000
029100         10  PV-MANF-9-16                PIC  9(01).              02910000
029200         10  PV-MANF-9-17                PIC  9(01).              02920000
029300         10  PV-MANF-9-18                PIC  9(01).              02930000
029400                                                                  02940000
029500     05  PV-PRINTER-ID                   PIC  X(03) VALUE SPACES. 02950000
029600     05  PV-SHIPT-UNT-ID                 PIC S9(18)V COMP-3.      02960000
029700                                                                  02970000
029800     05  PV-PROGRAM-DATA.                                         02980000
029900*        10  PV-SEAL-FUNC-CDE            PIC  X(01)  VALUE SPACE. 02990016
030000         10  PV-STORE                    PIC  X(04)  VALUE SPACE. 03000000
030100         10  PV-STORE-N REDEFINES PV-STORE PIC 9(04).             03010000
030200         10  PV-STORE-NUMBER             PIC  ZZZ9.               03020000
030300*                                                                 03030000
030400*GET STORE NUMBER ONLY FROM GENERIC SML LABEL                     03040000
030500         10  PV-STORE-NBR-ONLY           PIC  X(04) VALUE SPACES. 03050000
030600         10  PV-STORE-NBR-ONLY-N REDEFINES PV-STORE-NBR-ONLY.     03060000
030700             15  PV-STORE-1              PIC  X(01).              03070000
030800             15  PV-STORE-2              PIC  X(01).              03080000
030900             15  PV-STORE-3              PIC  X(01).              03090000
031000             15  PV-STORE-4              PIC  X(01).              03100000
031100                                                                  03110000
031200         10  PV-LBL-STORE-NBR            PIC  9(04) VALUE ZEROES. 03120000
031300         10  PV-LBL-STORE-NBR-R REDEFINES PV-LBL-STORE-NBR.       03130000
031400             15  PV-LBL-STORE-1          PIC  X(01).              03140000
031500             15  PV-LBL-STORE-2          PIC  X(01).              03150000
031600             15  PV-LBL-STORE-3          PIC  X(01).              03160000
031700             15  PV-LBL-STORE-4          PIC  X(01).              03170000
031800                                                                  03180000
031900                                                                  03190000
032000         10  PV-STR-NAME-CHAR10-ABBR     PIC  X(10).              03200000
032100                                                                  03210000
032200         10  PV-DC-5-CHAR-ABBR           PIC  X(05) VALUE SPACES. 03220000
032300         10  PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.     03230000
032400             15 FILLER                   PIC  X(03).              03240000
032500             15 PV-2-DIGIT-DC-ABBR       PIC  X(02).              03250000
032600                                                                  03260000
032700         10  PV-CTN.                                              03270000
032800             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              03280000
032900             15  PV-CTN-LAST-17          PIC  X(17).              03290000
033000             15  PV-CTN-FILLER           PIC  X(02).              03300000
033100*** BEGIN - AHP 02/18/08                                          03310000
033200         10  FILLER REDEFINES PV-CTN.                             03320000
033300             15  PV-CTN-ONE-DIGIT        PIC  X(01).              03330000
033400             15  PV-CTN-TWO-DIGIT        PIC  X(01).              03340000
033500             15  PV-CTN-LST-17           PIC  X(17).              03350000
033600             15  PV-CTN-FILL1            PIC  X(01).              03360000
033700         10  FILLER REDEFINES PV-CTN.                             03370000
033800             15  PV-CTN-FILLA            PIC  X(01).              03380000
033900             15  PV-CTN-LST-18           PIC  X(18).              03390000
034000             15  PV-CTN-FILLB            PIC  X(01).              03400000
034100*** END   - AHP 02/18/08                                          03410000
034200         10  FILLER REDEFINES PV-CTN.                             03420000
034300             15  PV-CTN-SCAN-00          PIC  X(02).              03430000
034400             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              03440000
034500             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              03450000
034600         10  FILLER REDEFINES PV-CTN.                             03460000
034700             15  PV-CTN-SCAN-00          PIC  X(02).              03470000
034800             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              03480000
034900         10  FILLER REDEFINES PV-CTN.                             03490000
035000             15  FILLER                  PIC  X(05).              03500000
035100             15  PV-CTN-SCAN-STORE       PIC  9(04).              03510000
035200             15  FILLER                  PIC  X(03).              03520000
035300             15  PV-CTN-MNFST           PIC  9(08).               03530000
035400                                                                  03540000
035500         10  PV-BARCODE                  PIC  X(20).              03550000
035600         10  PV-BARCODE-R REDEFINES PV-BARCODE.                   03560000
035700             15  PV-BARCODE-00           PIC  X(02).              03570000
035800             15  PV-BARCODE-LAST-18      PIC  X(18).              03580000
035900                                                                  03590000
036000                                                                  03600000
036100         10  PV-SYSTEM-ASSIGN-MASTER-ID.                          03610000
036200*            15  PV-1-2                  PIC  9(02).              03620000
036300             15  PV-3-4                  PIC  9(02).              03630000
036400             15  PV-5                    PIC  9(01).              03640000
036500             15  PV-6-9                  PIC  9(04).              03650000
036600             15  PV-10-12                PIC  9(03).              03660000
036700             15  PV-13-20                PIC  9(08).              03670000
036800         10  PV-SYSTEM-ASSIGN-MASTER-ID-N                         03680000
036900               REDEFINES PV-SYSTEM-ASSIGN-MASTER-ID               03690000
037000                                         PIC S9(18)V.             03700000
037100                                                                  03710000
037200         10  PV-SKU-IN-CTN               PIC S9(09)   VALUE +0    03720000
037300                                                      COMP-3.     03730000
037400         10  PV-UNT-IN-CTN               PIC S9(09)   VALUE +0    03740000
037500                                                      COMP-3.     03750000
037600                                                                  03760000
037700     05  PV-EAI-WK-AREA-DESC             PIC X(12) VALUE SPACES.  03770000
037800                                                                  03780000
037900 01  PV-LOG-MSG.                                                  03790000
038000     05  FILLER                       PIC X(12) VALUE             03800000
038100         ' E864 ERROR '.                                          03810000
038200     05  FILLER                       PIC X(09) VALUE             03820000
038300         'SQLCODE= '.                                             03830000
038400     05  PV-SQLCODE                   PIC -9(03).                 03840000
038500     05  FILLER                       PIC X(06) VALUE             03850000
038600         ' ERR= '.                                                03860000
038700     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       03870000
038800     05  FILLER                       PIC X(07) VALUE             03880000
038900         ' SML= '.                                                03890000
039000     05  PV-DISPLAY-SML               PIC X(12) VALUE ZEROS.      03900000
039100                                                                  03910000
039200                                                                  03920000
039300* COMMAREA LAYOUT                                                 03930000
039400 01  CA-COMMAREA.                                                 03940000
039500     COPY PCWS033.                                                03950000
039600                                                                  03960000
039700* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    03970014
039800     COPY PCWS046.                                                03980000
039900                                                                  03990000
040000* STORE MANIFEST LAYOUT                                           04000000
040100     COPY PCWS187.                                                04010000
040200                                                                  04020000
040300* MAP LAYOUT                                                      04030000
040400     COPY PCKM864.                                                04040000
040500                                                                  04050000
040600* HELP SCREEN COMMAREA                                            04060000
040700     COPY PCWS192.                                                04070000
040800                                                                  04080000
040900* HELP SCREEN WORK AREA                                           04090000
041000     COPY PCWS188.                                                04100000
041100                                                                  04110000
041200*                                                                 04120000
041300*  SENDING/RECEIVING AREA FOR THE                                 04130000
041400*  PRINTER VALIDATION ROUTINE (DPKCS060)                          04140000
041500     COPY DPWS072.                                                04150000
041600                                                                  04160000
041700* SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100)  04170000
041800     COPY DPWS010I.                                               04180000
041900                                                                  04190000
042000* LABEL COMMUNICATION AREA USING SOCKETS - PCKCS707               04200000
042100     COPY PCWS140.                                                04210000
042200                                                                  04220000
042300* LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.                04230000
042400     COPY DPWS013.                                                04240000
042500                                                                  04250000
042600* KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST    04260000
042700     COPY DPWS015.                                                04270000
042800                                                                  04280000
042900* COMMUNICATION AREA FOR CALLING PROGRAM DLKCS410                 04290000
043000     COPY DLWS011.                                                04300000
043100                                                                  04310000
043200* COMMUNICATION AREA FOR CALLING PROGRAM DLKCS410                 04320000
043300     COPY DLWS001.                                                04330000
043400     COPY DLWS016.                                                04340000
043500                                                                  04350000
043600* COMMUNICATION AREA FOR CALLING PROGRAM XLKUP033                 04360000
043700     COPY XLWS072.                                                04370000
043800                                                                  04380000
043900* COMMUNICATION AREA FOR CALLING PROGRAM XLKUP033                 04390000
044000     COPY PCWS242.                                                04400000
044100                                                                  04410000
044200* KOHL'S STANDARD ATTENTION IDENTIFIER LIST                       04420000
044300     COPY DFHAID.                                                 04430000
044400                                                                  04440000
044500* DB2 AREA FOR THE SU-SHIPMENT UNIT LOCATION TABLE                04450000
044600     EXEC SQL                                                     04460000
044700          INCLUDE SUT00027                                        04470000
044800     END-EXEC.                                                    04480000
044900                                                                  04490000
045000* DB2 AREA FOR THE SHIPMENT UNIT TABLE                            04500000
045100     EXEC SQL                                                     04510000
045200          INCLUDE SUT00024                                        04520000
045300     END-EXEC.                                                    04530000
045400                                                                  04540000
046000* DB2 AREA FOR THE SU - OUTBOUND TRAILER TRIP TABLE               04600000
046100     EXEC SQL                                                     04610000
046200          INCLUDE TSUOBTR                                         04620000
046300     END-EXEC.                                                    04630000
046400                                                                  04640000
046500* DB2 AREA FOR THE CN - TRAILER DEFINITION TABLE                  04650000
046600     EXEC SQL                                                     04660000
046700          INCLUDE TCNTRID                                         04670000
046800     END-EXEC.                                                    04680000
046900                                                                  04690000
047000* DB2 AREA FOR THE LOGISTICS DOMAIN LOCATION MASTER TABLE         04700000
047100     EXEC SQL                                                     04710000
047200          INCLUDE XLT00010                                        04720000
047300     END-EXEC.                                                    04730000
047400                                                                  04740000
047500* DB2 AREA FOR THE SU - MASTER SHIPMENT UNIT TABLE                04750000
047600     EXEC SQL                                                     04760000
047700          INCLUDE SUT00098                                        04770000
047800     END-EXEC.                                                    04780000
047900                                                                  04790000
048000* DB2 AREA FOR THE TKRPRPM TABLE -                                04800000
048100     EXEC SQL                                                     04810000
048200          INCLUDE TKRPRPM                                         04820000
048300     END-EXEC.                                                    04830000
048400                                                                  04840000
048500* COMMUNICATIONS AREA FOR DB2                                     04850000
048600     EXEC SQL                                                     04860000
048700         INCLUDE SQLCA                                            04870000
048800     END-EXEC.                                                    04880000
048900*                                                                 04890000
049000*                                                                 04900000
050100*                                                                 05010000
050200 LINKAGE SECTION.                                                 05020000
050300 01  DFHCOMMAREA.                                                 05030000
050400     05  FILLER                       OCCURS 1 TO 4072 TIMES      05040000
050500                                      DEPENDING ON EIBCALEN.      05050000
050600         10  FILLER                   PIC X.                      05060000
050700*                                                                 05070000
050800*                                                                 05080000
050900 PROCEDURE DIVISION.                                              05090000
051000 0000-PROGRAM-MAINLINE.                                           05100000
051100                                                                  05110000
051200     INITIALIZE CA-COMMAREA                                       05120000
051300     MOVE DFHCOMMAREA TO CA-COMMAREA                              05130000
051400                                                                  05140000
051500     EVALUATE TRUE                                                05150000
051600         WHEN EIBCALEN = ZERO                                     05160000
051700              MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA   05170000
051800              PERFORM 8110-RETURN                                 05180000
051900                                                                  05190000
052000         WHEN EIBTRNID = 'Z278'                                   05200000
052100              MOVE DFHCOMMAREA         TO PC192-COMMAREA          05210000
052200              MOVE PC192-HOST-SAVE-AREA                           05220000
052300                                       TO CA-COMMAREA             05230000
052400              SET PC033-PROCESS-SCREEN TO TRUE                    05240000
052500              MOVE PC192-HOST-SAVE-MAP TO PC864AO                 05250000
052600              MOVE -1                  TO ACARTNL                 05260000
052700                IF PC033-CARTON > ZEROS                           05270000
052800                   MOVE DP015-PRO-NOR-MDT     TO ASTRA            05280000
052900                ELSE                                              05290000
053000                   MOVE DP015-UNP-ALP-NOR-MDT TO ASTRA            05300000
053100                END-IF                                            05310000
053200              PERFORM 8000-SEND-MAP                               05320000
053300              PERFORM 8100-RETURN-TRANID                          05330000
053400                                                                  05340000
053500         WHEN EIBAID = DFHCLEAR                                   05350000
053600         WHEN PC033-INITIALIZE-SCREEN                             05360000
053700              SET PC033-PROCESS-SCREEN TO TRUE                    05370000
053800              PERFORM 1000-INITIALIZE                             05380000
053900              IF PC033-LAST-PROGRAM = PC-BARCODE-ENTRY-PGM        05390000
054000                 CONTINUE                                         05400000
054100              ELSE                                                05410000
054200                 MOVE PC-CURRENT-PROGRAM-NAME                     05420000
054300                                    TO PC033-LAST-PROGRAM         05430000
054400              END-IF                                              05440000
054500              MOVE -1       TO ACARTNL                            05450000
054600              PERFORM 8000-SEND-MAP                               05460000
054700              PERFORM 8100-RETURN-TRANID                          05470000
054800                                                                  05480000
054900         WHEN EIBAID = DFHENTER                                   05490000
055000             IF PC033-ROOT-PROGRAM = PC-ERROR-SCREEN-PGM          05500000
055100                MOVE ZEROS TO PC033-STR-NBR                       05510000
055200                MOVE PC-CURRENT-PROGRAM-NAME TO                   05520000
055300                                     PV-TRANSFER-PROGRAM          05530000
055400                                     PC033-ROOT-PROGRAM           05540000
055500                PERFORM 4000-XCTL-TO-SELECTED-PROGRAM             05550000
055600             ELSE                                                 05560000
055700                CONTINUE                                          05570000
055800             END-IF                                               05580000
055900                                                                  05590000
056000             IF PC033-LAST-PROGRAM = PC-BARCODE-ENTRY-PGM         05600000
056100                MOVE PC033-CARTON TO ACARTNO                      05610000
056200                MOVE ZEROS TO PC033-STR-NBR                       05620000
056300             END-IF                                               05630000
056400                                                                  05640000
056500             PERFORM 2000-PROCESS-SCREEN-FIELDS                   05650000
056600                                                                  05660000
056700             IF PC033-CARTON > ZEROS                              05670000
056800                SET PS-MASTER-ID-NOT-CREATED TO TRUE              05680000
056900             END-IF                                               05690000
057000                                                                  05700000
057010           IF (PC033-CARTON >= 00410000000000000000 AND           05701000
057020               PC033-CARTON <= 00419999999999999999) OR           05702000
057030               PC033-CARTON = +0                                  05703000
057100              EVALUATE TRUE                                       05710000
057200*IF CARTON ENTERED DISPLAY DEST STORE FOR THAT CARTON             05720000
057300                WHEN PC033-CARTON > ZEROS AND                     05730000
057400                     PC033-STR-NBR = ZEROS                        05740000
057500                        MOVE PC033-CARTON       TO PV-CTN         05750000
057600                                                   PV-CTN-N       05760000
057700                        PERFORM 2252-GET-DEST-STORE               05770000
057800                                                                  05780000
057900                        SET PS-PROTECT-FIELD    TO TRUE           05790000
058000                        MOVE DP015-HL-OFF       TO ASTRH          05800000
058100                        MOVE DP015-PRO-NOR-MDT  TO ASTRA          05810000
058200                        MOVE PC033-STR-NBR      TO PV-STORE-N     05820000
058300                        MOVE PV-STORE-N         TO PV-STORE-NUMBER05830000
058400                        MOVE PV-STORE-NUMBER    TO ASTRO          05840000
058500                        MOVE -1                 TO APRTRL         05850000
058600                        PERFORM 8000-SEND-MAP                     05860000
058700                        PERFORM 8100-RETURN-TRANID                05870000
058800                                                                  05880000
058900*AFTER CARTON & STORE DISPLAYED, GO TO NEXT SCREEN TO ADD CHILDREN05890000
059000                WHEN PC033-CARTON > ZEROS AND                     05900000
059100                     PC033-STR-NBR > ZEROS AND                    05910000
059200                     PC033-SML-PRTR-ID = SPACES                   05920000
059300                        MOVE PC033-STR-NBR       TO ASTRO         05930000
059400                        MOVE ZEROS TO PC033-CHILD-CARTON          05940000
059500                        MOVE PC033-CARTON TO PC033-MASTER-CARTON  05950000
059600                        MOVE PC-BARCODE-ENTRY-PGM TO              05960000
059700                             PV-TRANSFER-PROGRAM                  05970000
059800                        PERFORM 4000-XCTL-TO-SELECTED-PROGRAM     05980000
059900                                                                  05990000
060000                WHEN PC033-CARTON > ZEROS AND                     06000000
060100                     PC033-STR-NBR > ZEROS AND                    06010000
060200                     PC033-SML-PRTR-ID > SPACES                   06020000
060300                        IF PS-PROTECT-FIELD                       06030000
060400                          MOVE DP015-PRO-NOR-MDT     TO ASTRA     06040000
060500                        ELSE                                      06050000
060600                          MOVE DP015-UNP-ALP-NOR-MDT TO ASTRA     06060000
060700                        END-IF                                    06070000
060800                        MOVE DP015-UNP-ALP-NOR-MDT TO APRTRA      06080000
060900                        MOVE PC033-CARTON                         06090000
061000                                        TO PC033-MASTER-CARTON    06100000
061100                        MOVE PC-BARCODE-ENTRY-PGM                 06110000
061200                                        TO PV-TRANSFER-PROGRAM    06120000
061300                        PERFORM 4000-XCTL-TO-SELECTED-PROGRAM     06130000
061400                                                                  06140000
061500                        MOVE DP015-UNP-ALP-NOR-MDT                06150000
061600                                               TO APRTRA          06160000
061700                        MOVE -1                TO APRTRL          06170000
061800                        MOVE PC-PRESS-F4-CREATE-PRT               06180000
061900                                               TO AMSGLNO         06190000
062000                        PERFORM 8010-SEND-DATA-ONLY               06200000
062100                        PERFORM 8100-RETURN-TRANID                06210000
062200                                                                  06220000
062300***CARTON ID LEFT BLANK                                           06230000
062400                WHEN PC033-CARTON = ZEROS AND                     06240000
062500                     PC033-STR-NBR > ZEROS                        06250000
062600                                                                  06260000
062700                   IF  PS-VALID-INPUT                             06270000
062800                        IF PC033-SML-PRTR-ID = SPACES             06280000
062900                          MOVE DP015-UNP-ALP-BRT-MDT  TO ASTRA    06290000
063000                          MOVE -1                     TO ASTRL    06300000
063100                          MOVE PV-STORE-N                         06310000
063200                                   TO PV-STORE-NUMBER             06320000
063300                          MOVE PV-STORE-NUMBER        TO ASTRO    06330000
063400                          MOVE PC-PRINTER-ID-REQUIRED TO AMSGLNO  06340000
063500                          PERFORM 8010-SEND-DATA-ONLY             06350000
063600                          PERFORM 8100-RETURN-TRANID              06360000
063700                       ELSE                                       06370000
063800*STORE ALREADY VALID.  PERFORM 2240-VALIDATE-STORE                06380000
063900                         IF PS-VALID-STORE-NBR                    06390000
064000                            MOVE DP015-UNP-ALP-NOR-MDT TO ASTRA   06400000
064100                            MOVE PV-STORE-N                       06410000
064200                                     TO PV-STORE-NUMBER           06420000
064300                            MOVE PV-STORE-NUMBER       TO ASTRO   06430000
064400                         ELSE                                     06440000
064500                            MOVE DP015-UNP-ALP-BRT-MDT  TO ASTRA  06450000
064600                            MOVE -1                     TO ASTRL  06460000
064700                            MOVE PV-STORE-N                       06470000
064800                                     TO PV-STORE-NUMBER           06480000
064900                            MOVE PV-STORE-NUMBER        TO ASTRO  06490000
065000                            MOVE PC-INVALID-STORE-NBR   TO AMSGLNO06500000
065100                            PERFORM 8010-SEND-DATA-ONLY           06510000
065200                            PERFORM 8100-RETURN-TRANID            06520000
065300                         END-IF                                   06530000
065400                       END-IF                                     06540000
065500                                                                  06550000
065600                       MOVE DP072-PRTR-IP-ADDRESS                 06560000
065700                                TO PC140-SML-IP-ADDRESS           06570000
065800                       MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE        06580000
065900                                TO PC140-SML-OS-RLSE-CDE          06590000
066000                       MOVE DP072-PRTR-DATA-XFER-MODE-ID          06600000
066100                                TO PC140-SML-XFER-MODE-ID         06610000
066200                       MOVE DP072-XMIT-INTFC-CDE                  06620000
066300                                TO PC140-XMIT-INTFC-CDE           06630000
066400                       MOVE DP072-PRTR-TYP-CDE                    06640000
066500                                TO PC140-SML-PRTR-TYPE            06650000
066600                       MOVE DP072-PRTR-OPER-UNT-ID                06660000
066700                                TO PC-OPER-UNT-ID                 06670000
066800                       IF PS-VALID-PRINTER-ID                     06680000
066900                           MOVE DP015-UNP-ALP-NOR-MDT             06690000
067000                                                   TO APRTRA      06700000
067100                           MOVE -1                TO APRTRL       06710000
067200                       ELSE                                       06720000
067300                           MOVE DP015-UNP-ALP-BRT-MDT             06730000
067400                                              TO APRTRA           06740000
067500                           MOVE -1            TO APRTRL           06750000
067600                           MOVE PV-PRINTER-ID TO APRTRO           06760000
067700                           MOVE PC-INVALID-PRINTER-ID             06770000
067800                                              TO AMSGLNO          06780000
067900                           PERFORM 8010-SEND-DATA-ONLY            06790000
068000                           PERFORM 8100-RETURN-TRANID             06800000
068100                       END-IF                                     06810000
068200                       MOVE DP015-UNP-ALP-NOR-MDT TO ASTRA        06820000
068300                       MOVE DP015-UNP-ALP-NOR-MDT TO APRTRA       06830000
068400                       MOVE PC-PRESS-F4-CREATE-PRT                06840000
068500                                                  TO AMSGLNO      06850000
068600                       MOVE -1  TO ACARTNL                        06860000
068700                       PERFORM 8010-SEND-DATA-ONLY                06870000
068800                       PERFORM 8100-RETURN-TRANID                 06880000
068900                   END-IF                                         06890000
069000                                                                  06900000
069100                WHEN PC033-CARTON = ZEROS AND                     06910000
069200                     PC033-STR-NBR = ZEROS                        06920000
069300                     MOVE DP015-UNP-ALP-BRT-MDT  TO ASTRA         06930000
069400                     MOVE -1                     TO ASTRL         06940000
069500                     MOVE LOW-VALUES             TO ASTRO         06950000
069600                     MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO       06960000
069700                     PERFORM 8010-SEND-DATA-ONLY                  06970000
069800                     PERFORM 8100-RETURN-TRANID                   06980000
069900              END-EVALUATE                                        06990000
069910           ELSE                                                   06991000
069911             MOVE PC-UNRECOGNIZED-MASTER-MSG TO AMSGLNO           06991100
069912             PERFORM 8010-SEND-DATA-ONLY                          06991200
069913             PERFORM 8100-RETURN-TRANID                           06991300
069930           END-IF                                                 06993000
070000                                                                  07000000
070100         WHEN EIBAID = DFHPF1                                     07010000
070200             PERFORM 8020-RECEIVE-MAP                             07020000
070300             MOVE PC864AO             TO PC192-HOST-SAVE-MAP      07030000
070400             PERFORM 1200-HELP-SCREEN                             07040000
070500                                                                  07050000
070600         WHEN EIBAID = DFHPF3                                     07060000
070700*** RETURN TO THE MASTER CONTAINER TYPE PROGRAM FROM HERE         07070000
070800              MOVE PC-MSTR-CONTAINER-TYP-PGM TO                   07080000
070900                          PV-TRANSFER-PROGRAM                     07090000
071000              PERFORM 4000-XCTL-TO-SELECTED-PROGRAM               07100000
071100                                                                  07110000
071200         WHEN EIBAID = DFHPF4                                     07120000
071300              PERFORM 2000-PROCESS-SCREEN-FIELDS                  07130000
071400              IF PS-VALID-INPUT                                   07140000
071410               IF (PC033-CARTON >= 00410000000000000000 AND       07141000
071420                   PC033-CARTON <= 00419999999999999999) OR       07142000
071430                   PC033-CARTON = +0                              07143000
071500*IF CARTON ENTERED AND YOU WANT TO PRINT ANOTHER LABEL            07150000
071600                EVALUATE TRUE                                     07160000
071700                  WHEN PC033-CARTON > ZEROS AND                   07170000
071800                     PC033-STR-NBR = ZEROS                        07180000
071900                        SET PS-MASTER-ID-NOT-CREATED TO TRUE      07190000
072000                        MOVE -1                 TO ACARTNL        07200000
072100                        MOVE PC033-CARTON       TO PV-CTN         07210000
072200                                                   PV-CTN-N       07220000
072300                        PERFORM 2252-GET-DEST-STORE               07230000
072400                        MOVE PC033-STR-NBR      TO PV-STORE-N     07240000
072500                        MOVE PV-STORE-N         TO PV-STORE-NUMBER07250000
072600                        MOVE PV-STORE-NUMBER    TO ASTRO          07260000
072700                        PERFORM 8000-SEND-MAP                     07270000
072800                        PERFORM 8100-RETURN-TRANID                07280000
072900                                                                  07290000
073000                  WHEN PC033-CARTON > ZEROS AND                   07300000
073100                     PC033-STR-NBR > ZEROS                        07310000
073200                      SET PS-MASTER-ID-NOT-CREATED TO TRUE        07320000
073300                      MOVE DP072-PRTR-IP-ADDRESS                  07330000
073400                               TO PC140-SML-IP-ADDRESS            07340000
073500                      MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE         07350000
073600                               TO PC140-SML-OS-RLSE-CDE           07360000
073700                      MOVE DP072-PRTR-DATA-XFER-MODE-ID           07370000
073800                               TO PC140-SML-XFER-MODE-ID          07380000
073900                      MOVE DP072-XMIT-INTFC-CDE                   07390000
074000                               TO PC140-XMIT-INTFC-CDE            07400000
074100                      MOVE DP072-PRTR-TYP-CDE                     07410000
074200                               TO PC140-SML-PRTR-TYPE             07420000
074300                      MOVE DP072-PRTR-OPER-UNT-ID                 07430000
074400                               TO PC-OPER-UNT-ID                  07440000
074500                      MOVE DP015-UNP-ALP-NOR-MDT                  07450000
074600                                              TO APRTRA           07460000
074700                      MOVE -1                 TO APRTRL           07470000
074800                      PERFORM 4500-SETUP-COM-LABEL                07480000
074900                      PERFORM 8010-SEND-DATA-ONLY                 07490000
075000                      PERFORM 8100-RETURN-TRANID                  07500000
075100                                                                  07510000
075200                  WHEN PC033-CARTON = ZEROS AND                   07520000
075300                       PC033-STR-NBR = ZEROS                      07530000
075400                        MOVE DP015-UNP-ALP-BRT-MDT  TO ASTRA      07540000
075500                        MOVE -1                     TO ASTRL      07550000
075600                        MOVE ZEROS                  TO ASTRO      07560000
075700                        MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO    07570000
075800                        PERFORM 8010-SEND-DATA-ONLY               07580000
075900                        PERFORM 8100-RETURN-TRANID                07590000
076000                                                                  07600000
076100                  WHEN PC033-CARTON = ZEROS AND                   07610000
076200                       PV-STORE      > SPACES                     07620000
076300                    IF  PS-VALID-INPUT                            07630000
076400                        MOVE DP015-UNP-ALP-NOR-MDT  TO ASTRA      07640000
076500                        MOVE PV-STORE-N                           07650000
076600                                 TO PV-STORE-NUMBER               07660000
076700                        MOVE PV-STORE-NUMBER        TO ASTRO      07670000
076800                        MOVE DP072-PRTR-IP-ADDRESS                07680000
076900                                 TO PC140-SML-IP-ADDRESS          07690000
077000                        MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE       07700000
077100                                 TO PC140-SML-OS-RLSE-CDE         07710000
077200                        MOVE DP072-PRTR-DATA-XFER-MODE-ID         07720000
077300                                 TO PC140-SML-XFER-MODE-ID        07730000
077400                        MOVE DP072-XMIT-INTFC-CDE                 07740000
077500                                 TO PC140-XMIT-INTFC-CDE          07750000
077600                        MOVE DP072-PRTR-TYP-CDE                   07760000
077700                                 TO PC140-SML-PRTR-TYPE           07770000
077800                        MOVE DP072-PRTR-OPER-UNT-ID               07780000
077900                                 TO PC-OPER-UNT-ID                07790000
078000                                                                  07800000
078100                        MOVE DP015-UNP-ALP-NOR-MDT                07810000
078200                                              TO APRTRA           07820000
078300                        MOVE -1               TO APRTRL           07830000
078400                        PERFORM 2300-CREATE-MASTER-ID             07840000
078500                        PERFORM 0500-MOVE-TO-SHPUNT               07850000
078600                        PERFORM 2290-INSERT-OTBND-CART            07860000
078700                        IF PC033-NEW-VERSION                      07870000
078800*** ADDED DMH - 2/16/09 - BEGIN                                   07880000
078900                           PERFORM 2235-CALL-ASGMT-SEQ            07890000
079000*** ADDED DMH - 2/16/09 - END                                     07900000
079100                           PERFORM 2400-MSTR-SHIPT-UNT            07910000
079200                        END-IF                                    07920000
079300                        PERFORM 4500-SETUP-COM-LABEL              07930000
079400                        PERFORM 8010-SEND-DATA-ONLY               07940000
079500                        PERFORM 8100-RETURN-TRANID                07950000
079600                    END-IF                                        07960000
079700                END-EVALUATE                                      07970000
079710               ELSE                                               07971000
079730                 MOVE PC-UNRECOGNIZED-MASTER-MSG TO AMSGLNO       07973000
079740                 PERFORM 8010-SEND-DATA-ONLY                      07974000
079750                 PERFORM 8100-RETURN-TRANID                       07975000
079800               END-IF                                             07980000
079810              END-IF                                              07981000
079900                                                                  07990000
080000         WHEN OTHER                                               08000000
080100              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          08010000
080200              PERFORM 8010-SEND-DATA-ONLY                         08020000
080300              PERFORM 8100-RETURN-TRANID                          08030000
080400     END-EVALUATE.                                                08040000
080500     GOBACK.                                                      08050000
080600*                                                                 08060000
080700 0500-MOVE-TO-SHPUNT.                                             08070000
080800                                                                  08080000
080900     MOVE PC033-CARTON            TO SUT00024-SHIPT-UNT-ID.       08090000
081000     MOVE PC033-OPER-UNT-ID       TO SUT00024-ORGN-LOC-NBR.       08100000
081100     MOVE PC033-STR-NBR           TO SUT00024-DEST-LOC-NBR.       08110000
081200     MOVE PC-MST                  TO SUT00024-CART-SRC-CDE.       08120000
081300     MOVE PC-Y                    TO SUT00024-MSTR-CART-IND.      08130000
081400     MOVE PC033-CARTON            TO SUT00024-PRNT-CART-ID.       08140000
081500     MOVE PC-0-9                  TO SUT00024-ORIG-CART-ID.       08150000
081600     MOVE PC-ACTIVE               TO SUT00024-ACTV-IND.           08160000
081700     MOVE PC033-USER-ID           TO SUT00024-CRE-USR-ID.         08170000
081800     MOVE PC-CURRENT-PROGRAM-NAME TO SUT00024-CRE-PGM-NM.         08180000
081900                                                                  08190000
082000*                                                                 08200000
082100 1000-INITIALIZE.                                                 08210000
082200                                                                  08220000
082300     PERFORM 8400-GET-TIMESTAMP.                                  08230000
082400                                                                  08240000
082500     SET PC033-OLD-VERSION TO TRUE.                               08250000
082600     MOVE PC033-OPER-UNT-ID TO KRPRPM-LOC-ID.                     08260000
082700                                                                  08270000
082800     EXEC SQL                                                     08280000
082900         SELECT FUNC_BEG_TMST,                                    08290000
083000                FUNC_END_TMST                                     08300000
083100            INTO :KRPRPM-FUNC-BEG-TMST,                           08310000
083200                 :KRPRPM-FUNC-END-TMST                            08320000
083300              FROM TKRPRPM                                        08330000
083400              WHERE LOC_ID = :KRPRPM-LOC-ID AND                   08340000
083500                    INTFC_SYS_CDE = 'MST' AND                     08350000
083600                    SYS_PRC_FUNC_CDE = 'MASTCO'                   08360000
083700     END-EXEC.                                                    08370000
083800                                                                  08380000
083900     EVALUATE TRUE                                                08390000
084000         WHEN SQLCODE = ZERO                                      08400000
084100              CONTINUE                                            08410000
084200         WHEN SQLCODE = +100                                      08420000
084300         WHEN SQLWARN0 NOT = SPACES                               08430000
084400         WHEN SQLCODE NOT EQUAL ZERO                              08440000
084500             MOVE 2                   TO PV-ERROR-NBR             08450000
084600                                         PC033-ERROR-NBR          08460000
084700             PERFORM 9903-WRITE-CICS-LOG                          08470000
084800             MOVE '1000-INITIALIZE'                               08480000
084900                        TO PC033-PARAGRAPH                        08490000
085000             MOVE 'PCKRF864 - INITIALIZE'                         08500000
085100                              TO PC033-MESSAGE-TEXT(1)            08510000
085200             MOVE PV-CTN-N            TO PC033-MESSAGE-TEXT(2)    08520000
085300             MOVE SQLCA               TO PC033-SQLCA              08530000
085400             MOVE 'TKRPRPM'           TO PC033-DB2-TABLE-NAME(1)  08540000
085500             SET PC033-ABEND          TO TRUE                     08550000
085600             MOVE 99                  TO PC033-PGM-MSG-NBR        08560000
085700             PERFORM 8210-XCTL-ERROR-SCREEN                       08570000
085800     END-EVALUATE.                                                08580000
085900                                                                  08590000
086000     IF KRPRPM-FUNC-BEG-TMST <= PV-CURRENT-TIMESTAMP AND          08600000
086100        KRPRPM-FUNC-END-TMST >= PV-CURRENT-TIMESTAMP              08610000
086200         SET PC033-NEW-VERSION TO TRUE                            08620000
086300     END-IF.                                                      08630000
086400                                                                  08640000
086500     EVALUATE TRUE                                                08650000
086600        WHEN PC033-LAST-PROGRAM = PC-MASTER-CONTAINER-PGM         08660000
086700           INITIALIZE PV-PROGRAM-DATA                             08670000
086800           MOVE PC033-CARTON TO ACARTNO                           08680000
086900           MOVE -1                TO  ACARTNL                     08690000
087000                                                                  08700000
087600        WHEN PC033-LAST-PROGRAM = PC-MANIFEST-MENU-PGM OR         08760000
087700             PC033-LAST-PROGRAM = PC-MSTR-CONTAINER-TYP-PGM OR    08770000
087800             PC033-LAST-PROGRAM = PC-BARCODE-ENTRY-PGM            08780000
087900                INITIALIZE PV-PROGRAM-DATA                        08790000
088000                MOVE SPACES            TO  ACARTNO                08800000
088100                MOVE -1                TO  ACARTNL                08810000
088200                                                                  08820000
089100        WHEN OTHER                                                08910000
089200                MOVE DP015-PRO-NOR-OFF  TO  ACARTNA               08920000
089300                MOVE -1                 TO  ACARTNL               08930000
089400                COMPUTE PV-CTN-N      = PC033-CARTON * 1          08940000
089500                MOVE PV-CTN-N           TO  ACARTNO               08950000
089600     END-EVALUATE.                                                08960000
089700                                                                  08970000
089800                                                                  08980000
089900     IF PC033-LAST-PROGRAM = PC-BARCODE-ENTRY-PGM                 08990000
090000        CONTINUE                                                  09000000
090100     ELSE                                                         09010000
090200        MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM        09020000
090300     END-IF.                                                      09030000
090400*                                                                 09040000
090500*                                                                 09050000
090600 1200-HELP-SCREEN.                                                09060000
090700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM.     09070000
090800     MOVE 'PCKRF864'                  TO PC192-PROGRAM-NAME.      09080000
090900     COPY PCPD188.                                                09090000
091000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      09100000
091100     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    09110000
091200     PERFORM 8220-XCTL-TO-HELP.                                   09120000
091300*                                                                 09130000
091400*                                                                 09140000
091500 2000-PROCESS-SCREEN-FIELDS.                                      09150000
091600     PERFORM 8020-RECEIVE-MAP.                                    09160000
091700     PERFORM 2100-EDIT-INPUT.                                     09170000
091800                                                                  09180000
091900     IF PS-VALID-INPUT                                            09190000
092000         SET PS-ERROR-NO              TO TRUE                     09200000
092100     ELSE                                                         09210000
092200         PERFORM 8010-SEND-DATA-ONLY                              09220000
092300         PERFORM 8100-RETURN-TRANID                               09230000
092400     END-IF.                                                      09240000
092500*                                                                 09250000
092600*                                                                 09260000
092700 2100-EDIT-INPUT.                                                 09270000
092800     PERFORM 2210-INITIALIZE-ATTRIBUTES.                          09280000
092900     IF EIBAID = DFHPF4                                           09290000
093000         IF PC033-SML-PRTR-ID = SPACES                            09300000
093100             MOVE DP015-UNP-ALP-BRT-MDT  TO APRTRA                09310000
093200             MOVE -1                     TO APRTRL                09320000
093300             MOVE SPACES                 TO APRTRO                09330000
093400             MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO               09340000
093500             SET PS-INVALID-INPUT  TO TRUE                        09350000
093600     END-IF.                                                      09360000
093700                                                                  09370000
093800     IF PC033-SML-PRTR-ID NOT = SPACES                            09380000
093900         PERFORM 3010-VALIDATE-PRINTER                            09390000
094000     END-IF.                                                      09400000
094100     IF PS-VALID-INPUT                                            09410000
094200         PERFORM 2220-EDIT-STORE                                  09420000
094300     END-IF.                                                      09430000
094400     IF PS-VALID-INPUT                                            09440000
094500         PERFORM 2230-EDIT-CTN                                    09450000
094600     END-IF.                                                      09460000
094700                                                                  09470000
094800     IF EIBAID = DFHPF4                                           09480000
094900         IF  PV-LBL-STORE-NBR  = PV-STORE-N                       09490000
095000             CONTINUE                                             09500000
095100         ELSE                                                     09510000
095200             MOVE ZEROES  TO  PV-CTN                              09520000
095300                              PV-MANIFEST-NBR                     09530000
095400                              PC033-CARTON                        09540000
095500     END-IF.                                                      09550000
095600                                                                  09560000
095700***************************************************************** 09570000
095800* 2105-VALIDATE-MASTER-TYPE                                       09580000
095900***************************************************************** 09590000
096000 2105-VALIDATE-MASTER-TYPE.                                       09600000
096100                                                                  09610000
096200     EXEC SQL                                                     09620000
096300         SELECT MSTR_SHIPT_TYP_CDE                                09630000
096400                INTO :SUT00098-MSTR-SHIPT-TYP-CDE                 09640000
096500              FROM SUT_MSTR_SHIPT_UNT                             09650000
096600              WHERE MSTR_SHIPT_UNT_ID = :DK-SHIPT-UNT-ID          09660000
096700     END-EXEC.                                                    09670000
096800                                                                  09680000
096900     EVALUATE TRUE                                                09690000
097000         WHEN SQLCODE = ZERO                                      09700000
097100           IF (SUT00098-MSTR-SHIPT-TYP-CDE NOT EQUAL              09710000
097200                     PC033-MASTER-TYPE-SELECTION) AND             09720000
097300               (SUT00098-MSTR-SHIPT-TYP-CDE NOT EQUAL LOW-VALUES) 09730000
097400             MOVE SUT00098-MSTR-SHIPT-TYP-CDE TO                  09740000
097500                                 PC033-MASTER-TYPE-SELECTION      09750000
097600           END-IF                                                 09760000
097700           EVALUATE PC033-MASTER-TYPE-SELECTION                   09770000
097800             WHEN 'FJ '                                           09780000
097900                MOVE 'FINE JEWELRY' TO PV-EAI-WK-AREA-DESC        09790000
098000             WHEN 'BJ '                                           09800000
098100                MOVE 'BULK JEWELRY' TO PV-EAI-WK-AREA-DESC        09810000
098200             WHEN 'PJ '                                           09820000
098300                MOVE 'PBS JEWELRY ' TO PV-EAI-WK-AREA-DESC        09830000
098400             WHEN 'NCL'                                           09840000
098500                MOVE 'LRGE NON-CON' TO PV-EAI-WK-AREA-DESC        09850000
098600             WHEN 'NCS'                                           09860000
098700                MOVE 'SML NON-CON ' TO PV-EAI-WK-AREA-DESC        09870000
098800             WHEN 'O  '                                           09880000
098900                MOVE 'OTHER       ' TO PV-EAI-WK-AREA-DESC        09890000
099000           END-EVALUATE                                           09900000
099100                                                                  09910000
099200          IF (AMSGLNO = SPACES OR AMSGLNO = LOW-VALUES)           09920000
099300           MOVE 'TYPE = ' TO PC-INVALID-TYPE-TEXT                 09930000
099400           MOVE PV-EAI-WK-AREA-DESC                               09940000
099500                    TO PC-INVALID-TYPE-N                          09950000
099600           MOVE PC-INVALID-MST-TYPE TO AMSGLNO                    09960000
099700          END-IF                                                  09970000
099800                                                                  09980000
099900         WHEN SQLCODE = 100                                       09990000
100000           MOVE PC033-MASTER-TYPE-SELECTION TO                    10000000
100100                           PC033-MSTR-TYP-ORIGINAL                10010000
100200           MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID          10020000
100300           PERFORM 2410-INS-MSTR-SHIPT-UNT                        10030000
100400           IF PS-UPDATE-ROLLBACK                                  10040000
100500            PERFORM 9000-SOFT-ABORT                               10050000
100600           END-IF                                                 10060000
100700           EVALUATE PC033-MASTER-TYPE-SELECTION                   10070000
100800             WHEN 'FJ '                                           10080000
100900                MOVE 'FINE JEWELRY' TO PV-EAI-WK-AREA-DESC        10090000
101000             WHEN 'BJ '                                           10100000
101100                MOVE 'BULK JEWELRY' TO PV-EAI-WK-AREA-DESC        10110000
101200             WHEN 'PJ '                                           10120000
101300                MOVE 'PBS JEWELRY ' TO PV-EAI-WK-AREA-DESC        10130000
101400             WHEN 'NCL'                                           10140000
101500                MOVE 'LRGE NON-CON' TO PV-EAI-WK-AREA-DESC        10150000
101600             WHEN 'NCS'                                           10160000
101700                MOVE 'SML NON-CON ' TO PV-EAI-WK-AREA-DESC        10170000
101800             WHEN 'O  '                                           10180000
101900                MOVE 'OTHER       ' TO PV-EAI-WK-AREA-DESC        10190000
102000           END-EVALUATE                                           10200000
102100                                                                  10210000
102200           IF (AMSGLNO = SPACES OR AMSGLNO = LOW-VALUES)          10220000
102300             MOVE 'TYPE = ' TO PC-INVALID-TYPE-TEXT               10230000
102400             MOVE PV-EAI-WK-AREA-DESC                             10240000
102500                      TO PC-INVALID-TYPE-N                        10250000
102600             MOVE PC-INVALID-MST-TYPE TO AMSGLNO                  10260000
102700           END-IF                                                 10270000
102800                                                                  10280000
102900         WHEN SQLCODE = -904                                      10290000
103000         WHEN SQLCODE = -913                                      10300000
103100         WHEN SQLCODE = -911                                      10310000
103200             MOVE 8              TO PV-ERROR-NBR                  10320000
103300             SET PS-UPDATE-ROLLBACK TO TRUE                       10330000
103400             PERFORM 9903-WRITE-CICS-LOG                          10340000
103500             PERFORM 9000-SOFT-ABORT                              10350000
103600         WHEN SQLWARN0 NOT = SPACES                               10360000
103700         WHEN SQLCODE NOT EQUAL ZERO                              10370000
103800             SET PS-UPDATE-ROLLBACK TO TRUE                       10380000
103900             MOVE 7                   TO PV-ERROR-NBR             10390000
104000                                         PC033-ERROR-NBR          10400000
104100             PERFORM 9903-WRITE-CICS-LOG                          10410000
104200             MOVE '2105-VALIDATE-MASTER-TYPE'                     10420000
104300                                      TO PC033-PARAGRAPH          10430000
104400             MOVE 'PCKRF864 - SELECT SHIPPING UNIT'               10440000
104500                                      TO PC033-MESSAGE-TEXT(1)    10450000
104600             MOVE SUT00024-SHIPT-UNT-ID                           10460000
104700                                      TO PC033-MESSAGE-TEXT(2)    10470000
104800             MOVE SQLCA               TO PC033-SQLCA              10480000
104900             MOVE 'SUT00098'          TO PC033-DB2-TABLE-NAME(1)  10490000
105000             SET PC033-ABEND          TO TRUE                     10500000
105100             MOVE 99                  TO PC033-PGM-MSG-NBR        10510000
105200             PERFORM 8210-XCTL-ERROR-SCREEN                       10520000
105300     END-EVALUATE.                                                10530000
105400                                                                  10540000
105500*                                                                 10550000
105600 2110-RECEIVE-SCREEN-FIELDS.                                      10560000
105700     IF  ACARTNL > ZERO                                           10570000
105800         MOVE ACARTNI TO PV-CTN                                   10580000
105900     ELSE                                                         10590000
106000         IF ACARTNA = DP015-ERASE-EOF                             10600000
106100             MOVE SPACES TO PV-CTN                                10610000
106200         END-IF                                                   10620000
106300     END-IF.                                                      10630000
106400                                                                  10640000
106500     IF  ASTRL > ZERO                                             10650000
106600         MOVE ASTRI TO PV-STORE                                   10660000
106700         MOVE PV-STORE-N                                          10670000
106800                    TO PC033-STR-NBR                              10680000
106900     ELSE                                                         10690000
107000         IF ASTRA = DP015-ERASE-EOF                               10700000
107100             MOVE SPACES TO PV-STORE                              10710000
107200         END-IF                                                   10720000
107300     END-IF.                                                      10730000
107400                                                                  10740000
107500     IF  APRTRL > ZERO                                            10750000
107600         MOVE APRTRI TO PV-PRINTER-ID                             10760000
107700                        PC033-SML-PRTR-ID                         10770000
107800     ELSE                                                         10780000
107900         IF APRTRA = DP015-ERASE-EOF                              10790000
108000             MOVE SPACES TO PV-PRINTER-ID                         10800000
108100                            PC033-SML-PRTR-ID                     10810000
108200         END-IF                                                   10820000
108300     END-IF.                                                      10830000
108400*                                                                 10840000
108500*                                                                 10850000
108600 2200-CHECK-TABLES.                                               10860000
108700                                                                  10870000
108800     PERFORM 2250-SELECT-OTBND-CART.                              10880000
108900                                                                  10890000
109000     IF PS-CARTON-EXISTS                                          10900000
109100        MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID             10910000
109200     ELSE                                                         10920000
109300        IF PS-CARTON-DOESNT-EXIST                                 10930000
109400           SET PS-INVALID-INPUT TO TRUE                           10940000
109500           MOVE SQLCA             TO PC033-SQLCA                  10950000
109600           SET PC033-INITIALIZE-SCREEN TO TRUE                    10960000
109700           MOVE 14                TO PC033-PGM-MSG-NBR            10970000
109800           PERFORM 8210-XCTL-ERROR-SCREEN                         10980000
109900        END-IF                                                    10990000
110000     END-IF.                                                      11000000
110100*                                                                 11010000
110200     IF PC033-NEW-VERSION                                         11020000
110300           PERFORM 2105-VALIDATE-MASTER-TYPE.                     11030000
110400                                                                  11040000
110500*                                                                 11050000
110600 2210-INITIALIZE-ATTRIBUTES.                                      11060000
110700     MOVE DP015-UNP-ALP-NOR-MDT      TO ACARTNA.                  11070000
110800                                                                  11080000
110900     MOVE PV-CTN                     TO ACARTNO.                  11090000
111000     MOVE SPACES                     TO AMSGLNO.                  11100000
111100*                                                                 11110000
111200*                                                                 11120000
111300 2220-EDIT-STORE.                                                 11130000
111400     MOVE 0 TO PV-CHAR-COUNT.                                     11140000
111500     INSPECT PV-STORE TALLYING PV-CHAR-COUNT FOR CHARACTERS       11150000
111600                 BEFORE INITIAL SPACE.                            11160000
111700                                                                  11170000
111800     IF (PV-STORE = SPACES OR                                     11180000
111900         PV-STORE = LOW-VALUES) AND                               11190000
112000         PV-CTN = SPACES                                          11200000
112100         SET PS-INVALID-INPUT        TO TRUE                      11210000
112200         MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                   11220000
112300         MOVE -1                     TO ACARTNL                   11230000
112400         MOVE ZEROS                  TO ASTRO                     11240000
112500         MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO                   11250000
112600     ELSE                                                         11260000
112700*CHECK TO MAKE SURE THE STORE IS NUMERIC                          11270000
112800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11280000
112900         MOVE PV-STORE               TO DP010I-UNEDITED-FIELD     11290000
113000         MOVE LENGTH OF PV-STORE     TO DP010I-MAXIMUM-DIGITS     11300000
113100         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   11310000
113200                                                                  11320000
113310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11331015
113320                         USING DP010I-NUMERIC-EDIT-AREA           11332015
113400         IF  DP010I-ERROR-DETECTED                                11340000
113500             SET PS-INVALID-INPUT        TO TRUE                  11350000
113600             MOVE DP015-UNP-ALP-BRT-MDT  TO ASTRA                 11360000
113700             MOVE -1                     TO ASTRL                 11370000
113800             MOVE PC-MUST-BE-NUM-MSG TO AMSGLNO                   11380000
113900         ELSE                                                     11390000
114000             SET PS-VALID-INPUT          TO TRUE                  11400000
114100             MOVE DP010I-NUMERIC-FIELD   TO PV-STORE-N            11410000
114200                                            PC033-STR-NBR         11420000
114300         END-IF                                                   11430000
114400     END-IF.                                                      11440000
114500                                                                  11450000
114600     IF  PS-VALID-INPUT                                           11460000
114700         PERFORM 2240-VALIDATE-STORE                              11470000
114800                                                                  11480000
114900         IF PS-VALID-STORE-NBR                                    11490000
115000             MOVE DP015-UNP-ALP-NOR-MDT  TO ASTRA                 11500000
115100             MOVE PV-STORE-N             TO PV-STORE-NUMBER       11510000
115200             MOVE PV-STORE-NUMBER        TO ASTRO                 11520000
115300         ELSE                                                     11530000
115400             MOVE DP015-UNP-ALP-BRT-MDT  TO ASTRA                 11540000
115500             MOVE -1                     TO ASTRL                 11550000
115600             MOVE PV-STORE-N             TO PV-STORE-NUMBER       11560000
115700             MOVE PV-STORE-NUMBER        TO ASTRO                 11570000
115800             MOVE PC-INVALID-STORE-NBR   TO AMSGLNO               11580000
115900             SET PS-INVALID-INPUT TO TRUE                         11590000
116000         END-IF                                                   11600000
116100     END-IF.                                                      11610000
116200                                                                  11620000
116300 2230-EDIT-CTN.                                                   11630000
116400     MOVE 0 TO PV-CHAR-COUNT.                                     11640000
116500     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         11650000
116600                 BEFORE INITIAL SPACE.                            11660000
116700     EVALUATE TRUE                                                11670000
116800         WHEN PV-CTN = SPACES OR LOW-VALUES                       11680000
116900             MOVE 0 TO PV-CHAR-COUNT                              11690000
117000                                                                  11700000
117100         WHEN PV-CTN = SPACES OR LOW-VALUES AND                   11710000
117200             EIBAID = DFHENTER                                    11720000
117300             SET PS-INVALID-INPUT        TO TRUE                  11730000
117400             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               11740000
117500             MOVE -1                     TO ACARTNL               11750000
117600             MOVE ZEROS                  TO ASTRO                 11760000
117700             MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO               11770000
117800                                                                  11780000
117900         WHEN PV-CHAR-COUNT = PC-18 AND                           11790000
118000             (PV-CTN-FIRST-DIGIT NOT =  PC-4)                     11800000
118100             SET PS-INVALID-INPUT        TO TRUE                  11810000
118200             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               11820000
118300             MOVE -1                     TO ACARTNL               11830000
118400             MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             11840000
118500                                                                  11850000
118600*** BEGIN - AHP 02/18/08                                          11860000
118700         WHEN PV-CHAR-COUNT = PC-19 AND                           11870000
118800            ((PV-CTN-ONE-DIGIT NOT = PC-0) OR                     11880000
118900             (PV-CTN-TWO-DIGIT NOT = PC-4))                       11890000
119000             SET PS-INVALID-INPUT        TO TRUE                  11900000
119100             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               11910000
119200             MOVE -1                     TO ACARTNL               11920000
119300             MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             11930000
119400*** END   - AHP 02/18/08                                          11940000
119500                                                                  11950000
119600         WHEN PV-CHAR-COUNT = PC-20 AND                           11960000
119700            ((PV-CTN-FIRST-DIGIT NOT =  PC-0) AND                 11970000
119800             (PV-CTN-SCAN-THIRD-DGT NOT =  PC-4))                 11980000
119900             SET PS-INVALID-INPUT        TO TRUE                  11990000
120000             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               12000000
120100             MOVE -1                     TO ACARTNL               12010000
120200             MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             12020000
120300                                                                  12030000
120400         WHEN PV-CHAR-COUNT = PC-20 AND                           12040000
120500            ((PV-CTN-FIRST-DIGIT =  PC-0) AND                     12050000
120600             (PV-CTN-SCAN-THIRD-DGT NOT =  PC-4))                 12060000
120700             SET PS-INVALID-INPUT        TO TRUE                  12070000
120800             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               12080000
120900             MOVE -1                     TO ACARTNL               12090000
121000             MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             12100000
121100                                                                  12110000
121200         WHEN PV-CHAR-COUNT < PC-18                               12120000
121300             SET PS-INVALID-INPUT        TO TRUE                  12130000
121400             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               12140000
121500             MOVE -1                     TO ACARTNL               12150000
121600             MOVE PC-MORE-DIGITS-REQD    TO AMSGLNO               12160000
121700             PERFORM 8010-SEND-DATA-ONLY                          12170000
121800             PERFORM 8100-RETURN-TRANID                           12180000
121900         WHEN OTHER                                               12190000
122000             SET DP010I-NEGATIVE-NOT-ALLOWED                      12200000
122100                 PS-NOT-SCANNED-DATA TO TRUE                      12210000
122200*** BEGIN - AHP 02/18/08                                          12220000
122300             IF PV-CHAR-COUNT = PC-19                             12230000
122400                 MOVE PV-CTN-LST-17  TO DP010I-UNEDITED-FIELD     12240000
122500             ELSE                                                 12250000
122600*** END   - AHP 02/18/08                                          12260000
122700               IF PV-CHAR-COUNT = PC-18                           12270000
122800                 MOVE PV-CTN-LAST-17 TO DP010I-UNEDITED-FIELD     12280000
122900               ELSE                                               12290000
123000                  IF PV-CHAR-COUNT < PC-18                        12300000
123100                    MOVE PV-CTN     TO DP010I-UNEDITED-FIELD      12310000
123200                  ELSE                                            12320000
123300                    MOVE PV-CTN-SCAN-LAST-17                      12330000
123400                                    TO DP010I-UNEDITED-FIELD      12340000
123500                    SET PS-SCANNED-DATA TO TRUE                   12350000
123600                  END-IF                                          12360000
123700*** BEGIN - AHP 02/18/08                                          12370000
123800               END-IF                                             12380000
123900*** END   - AHP 02/18/08                                          12390000
124000             END-IF                                               12400000
124100             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 12410000
124200             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               12420000
124300                                                                  12430000
124410             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12441015
124420                         USING DP010I-NUMERIC-EDIT-AREA           12442015
124500             IF  DP010I-ERROR-DETECTED                            12450000
124600                 SET PS-INVALID-INPUT        TO TRUE              12460000
124700                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           12470000
124800                 MOVE -1                     TO ACARTNL           12480000
124900                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           12490000
125000             ELSE                                                 12500000
125100                 IF DP010I-NUMERIC-FIELD = ZEROS                  12510000
125200                     SET PS-INVALID-INPUT        TO TRUE          12520000
125300                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       12530000
125400                     MOVE -1                     TO ACARTNL       12540000
125500                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       12550000
125600                 ELSE                                             12560000
125700                      COMPUTE PC033-CARTON      ROUNDED =         12570000
125800                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         12580000
125900                      COMPUTE PV-CTN-N          ROUNDED =         12590000
126000                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         12600000
126100                       EVALUATE TRUE                              12610000
126200                          WHEN PV-CHAR-COUNT = PC-20              12620000
126300                             IF PV-CTN-SCAN-THIRD-DGT  = PC-4     12630000
126400                                MOVE PV-CTN TO DK-BARCODE-NBR     12640000
126500                                MOVE PV-CTN-SCAN-LAST-18 TO       12650000
126600                                                  PV-CTN-N        12660000
126700                                                  PC033-CARTON    12670000
126800                             END-IF                               12680000
126900                          WHEN PV-CHAR-COUNT = PC-18              12690000
127000                             IF PV-CTN-FIRST-DIGIT  = PC-4        12700000
127100                                MOVE PV-CTN  TO PV-CTN-N          12710000
127200                                MOVE PV-CTN-N TO PC033-CARTON     12720000
127300                             END-IF                               12730000
127400*** BEGIN - AHP 02/18/08                                          12740000
127500                          WHEN PV-CHAR-COUNT = PC-19              12750000
127600                             IF PV-CTN-TWO-DIGIT = PC-4           12760000
127700                                MOVE PV-CTN-LST-18  TO PV-CTN-N   12770000
127800                                MOVE PV-CTN-N TO PC033-CARTON     12780000
127900                             END-IF                               12790000
128000*** END   - AHP 02/18/08                                          12800000
128100                          END-EVALUATE                            12810000
128200                     MOVE PV-CTN-N              TO ACARTNO        12820000
128300                     PERFORM 2200-CHECK-TABLES                    12830000
128400                 END-IF                                           12840000
128500             END-IF                                               12850000
128600     END-EVALUATE.                                                12860000
128700                                                                  12870000
128800     MOVE ZEROES             TO  PV-LBL-STORE-NBR.                12880000
128900     EVALUATE TRUE                                                12890000
129000*** BEGIN - AHP 02/18/08                                          12900000
129100        WHEN PV-CHAR-COUNT = PC-18 OR                             12910000
129200                  PV-CHAR-COUNT = PC-19                           12920000
129300*** END   - AHP 01/30/08                                          12930000
129400           MOVE PV-CTN-N TO DK-SHIPT-UNT-ID                       12940000
129500                                                                  12950000
129600           MOVE PV-CTN TO PV-CTN-X                                12960000
129700           MOVE PV-CTN-9-11 TO PV-MANF-9-11                       12970000
129800           MOVE PV-CTN-9-12 TO PV-MANF-9-12                       12980000
129900           MOVE PV-CTN-9-13 TO PV-MANF-9-13                       12990000
130000           MOVE PV-CTN-9-14 TO PV-MANF-9-14                       13000000
130100           MOVE PV-CTN-9-15 TO PV-MANF-9-15                       13010000
130200           MOVE PV-CTN-9-16 TO PV-MANF-9-16                       13020000
130300           MOVE PV-CTN-9-17 TO PV-MANF-9-17                       13030000
130400           MOVE PV-CTN-9-18 TO PV-MANF-9-18                       13040000
130500                                                                  13050000
130600           MOVE PV-CTN-9-4  TO PV-LBL-STORE-1                     13060000
130700           MOVE PV-CTN-9-5  TO PV-LBL-STORE-2                     13070000
130800           MOVE PV-CTN-9-6  TO PV-LBL-STORE-3                     13080000
130900           MOVE PV-CTN-9-7  TO PV-LBL-STORE-4                     13090000
131000                                                                  13100000
131100        WHEN PV-CHAR-COUNT = PC-20                                13110000
131200           MOVE PV-CTN             TO  DK-BARCODE-NBR             13120000
131300                                                                  13130000
131400           MOVE PV-CTN-MNFST       TO  PV-MANIFEST-NBR            13140000
131500           MOVE PV-CTN-SCAN-STORE  TO  PV-LBL-STORE-NBR           13150000
131600     END-EVALUATE.                                                13160000
131700                                                                  13170000
131800*                                                                 13180000
131900*                                                                 13190000
132000 2235-CALL-ASGMT-SEQ.                                             13200000
132100***************************************************************** 13210000
132200* -- CALL DLKCS410 - LABOR ASSIGNMENT CONTROL MODULE              13220000
132300*                                                                 13230000
132400* -- CALL DLKUP001 - SECURE THE REQUIRED NUMBER OF SEQUENCE       13240000
132500*                    NUMBERS.                                     13250000
132600***************************************************************** 13260000
132700                                                                  13270000
132800     SET PS-UPDATE-COMMIT TO TRUE.                                13280000
132900                                                                  13290000
133000***** PREPARE TO CALL DLKCS410                                    13300000
133100      PERFORM 2420-CALL-DLKCS410                                  13310000
133200                                                                  13320000
133300      IF PS-UPDATE-ROLLBACK                                       13330000
133400        PERFORM 9000-SOFT-ABORT.                                  13340000
133500                                                                  13350000
133600*  PREPARE TO CALL DLKUP001                                       13360000
133700      INITIALIZE DL001-ASGMT-COMMAREA.                            13370000
133800                                                                  13380000
133900      MOVE PC033-ASGMT-STRT-DTE   TO                              13390000
134000                                 DL001-KEY-START-DTE.             13400000
134100      MOVE PC033-ASGMT-NBR-TXT    TO                              13410000
134200                                 DL001-KEY-NBR-TXT.               13420000
134300      MOVE PC033-ASGMT-NBR-SEQ-NBR TO                             13430000
134400                                 DL001-KEY-NBR-SEQ-NBR.           13440000
134500      PERFORM 4800-CALL-DLKUP001.                                 13450000
134600                                                                  13460000
134700      IF DL001-ASGMT-CLOSED-RETURN                                13470000
134800         PERFORM 2420-CALL-DLKCS410                               13480000
134900         PERFORM 4800-CALL-DLKUP001                               13490000
135000      END-IF.                                                     13500000
135100                                                                  13510000
135200      IF PS-UPDATE-ROLLBACK                                       13520000
135300        PERFORM 9000-SOFT-ABORT.                                  13530000
135400*                                                                 13540000
135500 2240-VALIDATE-STORE.                                             13550000
135600     MOVE PV-STORE-N TO DK-STORE-NBR                              13560000
135700                                                                  13570000
135800     EXEC SQL                                                     13580000
135900        SELECT LOC_10_ABBR_NM                                     13590000
136000         INTO  :XLT00010-LOC-10-ABBR-NM :PV-NULL-IND              13600000
136100         FROM XLT_LOC                                             13610000
136200        WHERE LOC_NBR = :DK-STORE-NBR                             13620000
136300     END-EXEC                                                     13630000
136400     EVALUATE TRUE                                                13640000
136500         WHEN SQLCODE = ZERO                                      13650000
136600             IF  PV-NULL-IND  =  -1                               13660000
136700                 MOVE SPACES  TO  XLT00010-LOC-10-ABBR-NM         13670000
136800             END-IF                                               13680000
136900             SET PS-VALID-STORE-NBR   TO TRUE                     13690000
137000             MOVE XLT00010-LOC-10-ABBR-NM                         13700000
137100                                      TO PV-STR-NAME-CHAR10-ABBR  13710000
137200             MOVE -1                  TO APRTRL                   13720000
137300         WHEN SQLCODE = +100                                      13730000
137400             SET PS-INVALID-STORE-NBR TO TRUE                     13740000
137500             SET PS-ERROR-YES         TO TRUE                     13750000
137600         WHEN SQLCODE = -904                                      13760000
137700         WHEN SQLCODE = -913                                      13770000
137800         WHEN SQLCODE = -911                                      13780000
137900             MOVE 1                   TO PV-ERROR-NBR             13790000
138000             PERFORM 9903-WRITE-CICS-LOG                          13800000
138100             PERFORM 9000-SOFT-ABORT                              13810000
138200         WHEN SQLWARN0 NOT = SPACES                               13820000
138300         WHEN SQLCODE NOT EQUAL ZERO                              13830000
138400             MOVE 1                   TO PV-ERROR-NBR             13840000
138500                                         PC033-ERROR-NBR          13850000
138600             PERFORM 9903-WRITE-CICS-LOG                          13860000
138700             MOVE '2240-VALIDATE-STORE'                           13870000
138800                                      TO PC033-PARAGRAPH          13880000
138900             MOVE 'PCKRF864 - VALIDATE STORE NBR'                 13890000
139000                                      TO PC033-MESSAGE-TEXT(1)    13900000
139100             MOVE PV-STORE-N          TO PC033-MESSAGE-TEXT(2)    13910000
139200             MOVE SQLCA               TO PC033-SQLCA              13920000
139300             MOVE 'XLT_LOC '          TO PC033-DB2-TABLE-NAME(1)  13930000
139400             SET PC033-ABEND          TO TRUE                     13940000
139500             MOVE 99                  TO PC033-PGM-MSG-NBR        13950000
139600             PERFORM 8210-XCTL-ERROR-SCREEN                       13960000
139700                                                                  13970000
139800     END-EVALUATE.                                                13980000
139900*                                                                 13990000
140000*                                                                 14000000
140100*NOTE:  MERCHANDISE CARTONS - HIER_LVL_CDE=0                      14010000
140200*FIRST CHECK TO SEE IF SHIPT-UNT-ID IS ON SUT_OTBND_CART.         14020000
140300*IF NOT, CHECK TO SEE IF IT IS ON ORIG-CART-ID.                   14030000
140400 2250-SELECT-OTBND-CART.                                          14040000
140500     MOVE PV-CTN-N      TO DK-SHIPT-UNT-ID                        14050000
140600     EXEC SQL                                                     14060000
140700         SELECT  CART_SRC_CDE                                     14070000
140800                ,SHIPT_UNT_ID                                     14080000
140900                ,MSTR_CART_IND                                    14090000
141000                ,ACTV_IND                                         14100000
141100                ,DEST_LOC_NBR                                     14110000
141200         INTO    :SUT00024-CART-SRC-CDE                           14120000
141300                ,:SUT00024-SHIPT-UNT-ID                           14130000
141400                ,:SUT00024-MSTR-CART-IND                          14140000
141500                ,:SUT00024-ACTV-IND                               14150000
141600                ,:SUT00024-DEST-LOC-NBR                           14160000
141700         FROM   SUT_OTBND_CART                                    14170000
141800         WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 14180000
141900     END-EXEC.                                                    14190000
142000     EVALUATE TRUE                                                14200000
142100         WHEN SQLCODE = ZERO                                      14210000
142200             SET PS-CARTON-EXISTS TO TRUE                         14220000
142300                                                                  14230000
142400             IF SUT00024-ACTV-IND = 'N'                           14240000
142500                PERFORM 2254-SELECT-OTBND-LOC                     14250000
142600                IF SUT00027-ACTV-CDE = 'I'                        14260000
142700                   MOVE SQLCA               TO PC033-SQLCA        14270000
142800                   SET PC033-INITIALIZE-SCREEN TO TRUE            14280000
142900                   MOVE 17                  TO PC033-PGM-MSG-NBR  14290000
143000                   MOVE CNTRID-SCAC-CDE     TO PC033-OWNER-SCAC-ID14300000
143100                   MOVE CNTRID-TRLR-SRL-NBR TO PC033-VEH-NBR      14310000
143200                   PERFORM 8210-XCTL-ERROR-SCREEN                 14320000
143300                ELSE                                              14330000
143400                   MOVE PC-CARTON-INACTIVATED TO AMSGLNO          14340000
143500                   MOVE DP015-UNP-ALP-BRT-MDT                     14350000
143600                                           TO ACARTNL             14360000
143700                   MOVE -1                 TO ACARTNL             14370000
143800                   PERFORM 8000-SEND-MAP                          14380000
143900                   PERFORM 8100-RETURN-TRANID                     14390000
144000                END-IF                                            14400000
144100             END-IF                                               14410000
144200                                                                  14420000
144300             IF SUT00024-MSTR-CART-IND = 'Y'                      14430000
144400                AND SUT00024-CART-SRC-CDE = 'MST'                 14440000
144500                SET PS-MASTER-CTN TO TRUE                         14450000
144600                MOVE SUT00024-SHIPT-UNT-ID                        14460000
144700                             TO SUT00024-PRNT-CART-ID             14470000
144800                MOVE SUT00024-SHIPT-UNT-ID    TO DK-SHIPT-UNT-ID  14480000
144900*CHECK IF CONTAINER ALREADY SEALED*                               14490000
145000*               PERFORM 2260-OPEN-CURSOR                          14500016
145100*               PERFORM 2270-FETCH-CURSOR                         14510016
145200*               PERFORM 2280-CLOSE-CURSOR                         14520016
145300             ELSE                                                 14530000
145400                IF SUT00024-MSTR-CART-IND = 'N'                   14540000
145500                     MOVE SQLCA             TO PC033-SQLCA        14550000
145600                     SET PC033-INITIALIZE-SCREEN TO TRUE          14560000
145700                     MOVE 9                 TO PC033-PGM-MSG-NBR  14570000
145800                     PERFORM 8210-XCTL-ERROR-SCREEN               14580000
145900                END-IF                                            14590000
146000             END-IF                                               14600000
146100             IF PC033-NEW-VERSION                                 14610000
146200                 PERFORM 2235-CALL-ASGMT-SEQ                      14620000
146300             END-IF                                               14630000
146400             PERFORM 3000-DETERMINE-LAST-ACTIVITY                 14640000
146500         WHEN SQLCODE = +100                                      14650000
146600             PERFORM 2251-SELECT-OTBND-CART                       14660000
146700         WHEN SQLCODE = -904                                      14670000
146800         WHEN SQLCODE = -913                                      14680000
146900         WHEN SQLCODE = -911                                      14690000
147000             MOVE 2                   TO PV-ERROR-NBR             14700000
147100             PERFORM 9903-WRITE-CICS-LOG                          14710000
147200             PERFORM 9000-SOFT-ABORT                              14720000
147300         WHEN SQLWARN0 NOT = SPACES                               14730000
147400         WHEN SQLCODE NOT EQUAL ZERO                              14740000
147500             MOVE 2                   TO PV-ERROR-NBR             14750000
147600                                         PC033-ERROR-NBR          14760000
147700             PERFORM 9903-WRITE-CICS-LOG                          14770000
147800             MOVE '2250-SELECT-OTBND-CART'                        14780000
147900                                      TO PC033-PARAGRAPH          14790000
148000             MOVE 'PCKRF864 - CHECK VALID CARTON'                 14800000
148100                                      TO PC033-MESSAGE-TEXT(1)    14810000
148200             MOVE PV-CTN-N            TO PC033-MESSAGE-TEXT(2)    14820000
148300             MOVE SQLCA               TO PC033-SQLCA              14830000
148400             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  14840000
148500             SET PC033-ABEND          TO TRUE                     14850000
148600             MOVE 99                  TO PC033-PGM-MSG-NBR        14860000
148700             PERFORM 8210-XCTL-ERROR-SCREEN                       14870000
148800                                                                  14880000
148900     END-EVALUATE.                                                14890000
149000*                                                                 14900000
149100*                                                                 14910000
149200 2251-SELECT-OTBND-CART.                                          14920000
149300                                                                  14930000
149400     EXEC SQL                                                     14940000
149500         SELECT  CART_SRC_CDE                                     14950000
149600                ,SHIPT_UNT_ID                                     14960000
149700                ,MSTR_CART_IND                                    14970000
149800                ,ACTV_IND                                         14980000
149900                ,DEST_LOC_NBR                                     14990000
150000                ,ORIG_CART_ID                                     15000000
150100         INTO    :SUT00024-CART-SRC-CDE                           15010000
150200                ,:SUT00024-SHIPT-UNT-ID                           15020000
150300                ,:SUT00024-MSTR-CART-IND                          15030000
150400                ,:SUT00024-ACTV-IND                               15040000
150500                ,:SUT00024-DEST-LOC-NBR                           15050000
150600                ,:SUT00024-ORIG-CART-ID                           15060000
150700         FROM   SUT_OTBND_CART                                    15070000
150800         WHERE  ORIG_CART_ID   = :DK-SHIPT-UNT-ID                 15080000
150900     END-EXEC.                                                    15090000
151000                                                                  15100000
151100     EVALUATE TRUE                                                15110000
151200         WHEN SQLCODE = ZERO                                      15120000
151300             MOVE SUT00024-ORIG-CART-ID                           15130000
151400                                     TO SUT00024-SHIPT-UNT-ID     15140000
151500             SET PS-CARTON-EXISTS TO TRUE                         15150000
151600                                                                  15160000
151700             IF SUT00024-ACTV-IND = 'N'                           15170000
151800                PERFORM 2254-SELECT-OTBND-LOC                     15180000
151900                IF SUT00027-ACTV-CDE = 'I'                        15190000
152000                   MOVE SQLCA               TO PC033-SQLCA        15200000
152100                   SET PC033-INITIALIZE-SCREEN TO TRUE            15210000
152200                   MOVE 17                  TO PC033-PGM-MSG-NBR  15220000
152300                   MOVE CNTRID-SCAC-CDE     TO PC033-OWNER-SCAC-ID15230000
152400                   MOVE CNTRID-TRLR-SRL-NBR TO PC033-VEH-NBR      15240000
152500                   PERFORM 8210-XCTL-ERROR-SCREEN                 15250000
152600                ELSE                                              15260000
152700                   MOVE PC-CARTON-INACTIVATED TO AMSGLNO          15270000
152800                   MOVE DP015-UNP-ALP-BRT-MDT                     15280000
152900                                           TO ACARTNL             15290000
153000                   MOVE -1                 TO ACARTNL             15300000
153100                   PERFORM 8000-SEND-MAP                          15310000
153200                   PERFORM 8100-RETURN-TRANID                     15320000
153300                END-IF                                            15330000
153400             END-IF                                               15340000
153500                                                                  15350000
153600             IF SUT00024-MSTR-CART-IND = 'Y'                      15360000
153700                AND SUT00024-CART-SRC-CDE = 'MST'                 15370000
153800                SET PS-MASTER-CTN TO TRUE                         15380000
153900                MOVE SUT00024-SHIPT-UNT-ID                        15390000
154000                             TO SUT00024-PRNT-CART-ID             15400000
154100                MOVE SUT00024-SHIPT-UNT-ID    TO DK-SHIPT-UNT-ID  15410000
154200*CHECK IF CONTAINER ALREADY SEALED*                               15420000
154300*               PERFORM 2260-OPEN-CURSOR                          15430016
154400*               PERFORM 2270-FETCH-CURSOR                         15440016
154500*               PERFORM 2280-CLOSE-CURSOR                         15450016
154600             ELSE                                                 15460000
154700                IF SUT00024-MSTR-CART-IND = 'N'                   15470000
154800                     MOVE SQLCA             TO PC033-SQLCA        15480000
154900                     SET PC033-INITIALIZE-SCREEN TO TRUE          15490000
155000                     MOVE 9                 TO PC033-PGM-MSG-NBR  15500000
155100                     PERFORM 8210-XCTL-ERROR-SCREEN               15510000
155200                END-IF                                            15520000
155300             END-IF                                               15530000
155400             IF PC033-NEW-VERSION                                 15540000
155500                 PERFORM 2235-CALL-ASGMT-SEQ                      15550000
155600             END-IF                                               15560000
155700             PERFORM 3000-DETERMINE-LAST-ACTIVITY                 15570000
155800         WHEN SQLCODE = +100                                      15580000
155900             IF PC033-NEW-VERSION                                 15590000
156000                PERFORM 2235-CALL-ASGMT-SEQ                       15600000
156100             END-IF                                               15610000
156200*FILL THESE VALUES FOR 2290-INSERT-OTBND-CART                     15620000
156300              MOVE PC033-CARTON       TO SUT00024-SHIPT-UNT-ID    15630000
156400              MOVE PC033-OPER-UNT-ID  TO SUT00024-ORGN-LOC-NBR    15640000
156500*GET STORE NUMBER ONLY FROM THE GENERIC SML LABEL                 15650000
156600              MOVE PV-CTN-9-4         TO PV-STORE-1               15660000
156700              MOVE PV-CTN-9-5         TO PV-STORE-2               15670000
156800              MOVE PV-CTN-9-6         TO PV-STORE-3               15680000
156900              MOVE PV-CTN-9-7         TO PV-STORE-4               15690000
157000                                                                  15700000
157100              MOVE PV-STORE-NBR-ONLY TO SUT00024-DEST-LOC-NBR     15710000
157200              MOVE PC-MST             TO SUT00024-CART-SRC-CDE    15720000
157300              MOVE PC-Y               TO SUT00024-MSTR-CART-IND   15730000
157400              MOVE PC033-CARTON       TO SUT00024-PRNT-CART-ID    15740000
157500              MOVE PC-0-9             TO SUT00024-ORIG-CART-ID    15750000
157600              MOVE PC-ACTIVE          TO SUT00024-ACTV-IND        15760000
157700              MOVE PC033-USER-ID      TO SUT00024-CRE-USR-ID      15770000
157800              MOVE PC-CURRENT-PROGRAM-NAME TO SUT00024-CRE-PGM-NM 15780000
157900              PERFORM 2290-INSERT-OTBND-CART                      15790000
158000              IF PC033-NEW-VERSION                                15800000
158100                 PERFORM 2400-MSTR-SHIPT-UNT                      15810000
158200              END-IF                                              15820000
158300         WHEN SQLCODE = -904                                      15830000
158400         WHEN SQLCODE = -913                                      15840000
158500         WHEN SQLCODE = -911                                      15850000
158600             MOVE 2                   TO PV-ERROR-NBR             15860000
158700             PERFORM 9903-WRITE-CICS-LOG                          15870000
158800             PERFORM 9000-SOFT-ABORT                              15880000
158900         WHEN SQLWARN0 NOT = SPACES                               15890000
159000         WHEN SQLCODE NOT EQUAL ZERO                              15900000
159100             MOVE 2                   TO PV-ERROR-NBR             15910000
159200                                         PC033-ERROR-NBR          15920000
159300             PERFORM 9903-WRITE-CICS-LOG                          15930000
159400             MOVE '2251-SELECT-OTBND-CART'                        15940000
159500                                      TO PC033-PARAGRAPH          15950000
159600             MOVE 'PCKRF864 - CHECK VALID CARTON'                 15960000
159700                                      TO PC033-MESSAGE-TEXT(1)    15970000
159800             MOVE PV-CTN-N            TO PC033-MESSAGE-TEXT(2)    15980000
159900             MOVE SQLCA               TO PC033-SQLCA              15990000
160000             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  16000000
160100             SET PC033-ABEND          TO TRUE                     16010000
160200             MOVE 99                  TO PC033-PGM-MSG-NBR        16020000
160300             PERFORM 8210-XCTL-ERROR-SCREEN                       16030000
160400     END-EVALUATE.                                                16040000
160500*                                                                 16050000
160600*                                                                 16060000
160700*GET DEST STORE FOR MASTER CARTON ID SCANNED                      16070000
160800 2252-GET-DEST-STORE.                                             16080000
160900     MOVE PV-CTN-N      TO DK-SHIPT-UNT-ID                        16090000
161000     EXEC SQL                                                     16100000
161100         SELECT  ORGN_LOC_NBR                                     16110000
161200                ,DEST_LOC_NBR                                     16120000
161300         INTO    :SUT00024-ORGN-LOC-NBR                           16130000
161400                ,:SUT00024-DEST-LOC-NBR                           16140000
161500         FROM   SUT_OTBND_CART                                    16150000
161600         WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 16160000
161700     END-EXEC.                                                    16170000
161800     EVALUATE TRUE                                                16180000
161900         WHEN SQLCODE = ZERO                                      16190000
162000             IF SUT00024-DEST-LOC-NBR = 0                         16200000
162100                   MOVE SUT00024-ORGN-LOC-NBR TO                  16210000
162200                                        SUT00024-DEST-LOC-NBR     16220000
162300                                        PV-STORE-N                16230000
162400                                        PC033-STR-NBR             16240000
162500             ELSE                                                 16250000
162600                   MOVE SUT00024-DEST-LOC-NBR TO PV-STORE-N       16260000
162700                                                 PC033-STR-NBR    16270000
162800             END-IF                                               16280000
162900         WHEN SQLCODE = +100                                      16290000
163000             CONTINUE                                             16300000
163100         WHEN SQLCODE = -904                                      16310000
163200         WHEN SQLCODE = -913                                      16320000
163300         WHEN SQLCODE = -911                                      16330000
163400             MOVE 4                   TO PV-ERROR-NBR             16340000
163500             PERFORM 9903-WRITE-CICS-LOG                          16350000
163600             PERFORM 9000-SOFT-ABORT                              16360000
163700         WHEN SQLWARN0 NOT = SPACES                               16370000
163800         WHEN SQLCODE NOT EQUAL ZERO                              16380000
163900             MOVE 4                   TO PV-ERROR-NBR             16390000
164000                                         PC033-ERROR-NBR          16400000
164100             PERFORM 9903-WRITE-CICS-LOG                          16410000
164200             MOVE '2252-GET-DEST-STORE'                           16420000
164300                                      TO PC033-PARAGRAPH          16430000
164400             MOVE 'PCKRF864 - GET DEST STORE FOR CTN'             16440000
164500                                      TO PC033-MESSAGE-TEXT(1)    16450000
164600             MOVE PV-CTN-N            TO PC033-MESSAGE-TEXT(2)    16460000
164700             MOVE SQLCA               TO PC033-SQLCA              16470000
164800             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  16480000
164900             SET PC033-ABEND          TO TRUE                     16490000
165000             MOVE 99                  TO PC033-PGM-MSG-NBR        16500000
165100             PERFORM 8210-XCTL-ERROR-SCREEN                       16510000
165200     END-EVALUATE.                                                16520000
165300*                                                                 16530000
165400*                                                                 16540000
165500 2253-GET-DC-LOCATION.                                            16550000
165600     EXEC SQL                                                     16560000
165700          SELECT LOC_5_ABBR_NM                                    16570000
165800          INTO  :PV-DC-5-CHAR-ABBR                                16580000
165900          FROM   XLT_LOC                                          16590000
166000          WHERE  LOC_TYP_CDE = 'DC'                               16600000
166100          AND    LOC_NBR   = :PC-OPER-UNT-ID                      16610000
166200     END-EXEC.                                                    16620000
166300                                                                  16630000
166400     EVALUATE TRUE                                                16640000
166500         WHEN SQLCODE = ZERO                                      16650000
166600              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       16660000
166700              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 16670000
166800         WHEN SQLCODE = +100                                      16680000
166900              MOVE  PC-90   TO  PC140-CRA-DC-ID                   16690000
167000                                PC140-CRA-OPER-UNT-ID             16700000
167100         WHEN SQLCODE = -904                                      16710000
167200         WHEN SQLCODE = -913                                      16720000
167300         WHEN SQLCODE = -911                                      16730000
167400             MOVE 5                   TO PV-ERROR-NBR             16740000
167500             PERFORM 9903-WRITE-CICS-LOG                          16750000
167600             PERFORM 9000-SOFT-ABORT                              16760000
167700         WHEN SQLWARN0 NOT = SPACES                               16770000
167800         WHEN SQLCODE NOT EQUAL ZERO                              16780000
167900             MOVE 5                   TO PV-ERROR-NBR             16790000
168000                                         PC033-ERROR-NBR          16800000
168100             PERFORM 9903-WRITE-CICS-LOG                          16810000
168200             MOVE '2253-GET-DC-LOCATION'                          16820000
168300                                      TO PC033-PARAGRAPH          16830000
168400             MOVE 'PCKRF864 - GET DC LOCATION'                    16840000
168500                                      TO PC033-MESSAGE-TEXT(1)    16850000
168600             MOVE SQLCA               TO PC033-SQLCA              16860000
168700             MOVE 'XLT_LOC '          TO PC033-DB2-TABLE-NAME(1)  16870000
168800             SET PC033-ABEND          TO TRUE                     16880000
168900             MOVE 99                  TO PC033-PGM-MSG-NBR        16890000
169000             PERFORM 8210-XCTL-ERROR-SCREEN                       16900000
169100     END-EVALUATE.                                                16910000
169200*                                                                 16920000
169300*LMM                                                              16930000
169400 2254-SELECT-OTBND-LOC.                                           16940000
169500     MOVE SUT00024-SHIPT-UNT-ID    TO DK-SHIPT-UNT-ID             16950000
169600     MOVE SUT00024-DEST-LOC-NBR    TO DK-OPER-UNT-ID              16960000
169700                                                                  16970000
169800     EXEC SQL                                                     16980000
169900        SELECT   ACTV_CDE                                         16990000
170000        INTO   :SUT00027-ACTV-CDE                                 17000000
170100        FROM SUT_OTBND_LOC                                        17010000
170200        WHERE SHIPT_UNT_ID      =   :DK-SHIPT-UNT-ID              17020000
170300          AND LOC_NBR           =   :DK-OPER-UNT-ID               17030000
170400          AND SCN_CDE           =   'SHON'                        17040000
170500     END-EXEC                                                     17050000
170600                                                                  17060000
170700     EVALUATE TRUE                                                17070000
170800         WHEN SQLCODE = ZERO                                      17080000
170900             CONTINUE                                             17090000
171000         WHEN SQLCODE = +100                                      17100000
171100             CONTINUE                                             17110000
171200         WHEN SQLCODE = -904                                      17120000
171300         WHEN SQLCODE = -913                                      17130000
171400         WHEN SQLCODE = -911                                      17140000
171500             MOVE 6                   TO PV-ERROR-NBR             17150000
171600             PERFORM 9903-WRITE-CICS-LOG                          17160000
171700             PERFORM 9000-SOFT-ABORT                              17170000
171800         WHEN SQLWARN0 NOT = SPACES                               17180000
171900         WHEN SQLCODE NOT EQUAL ZERO                              17190000
172000             MOVE 6                   TO PV-ERROR-NBR             17200000
172100                                         PC033-ERROR-NBR          17210000
172200             PERFORM 9903-WRITE-CICS-LOG                          17220000
172300             MOVE '2254-SELECT-OTBND-LOC'                         17230000
172400                                      TO PC033-PARAGRAPH          17240000
172500             MOVE 'PCKRF864 - CHECK IF INACTIVE CARTON'           17250000
172600                                      TO PC033-MESSAGE-TEXT(1)    17260000
172700             MOVE SUT00027-SHIPT-UNT-ID                           17270000
172800                                      TO PC033-MESSAGE-TEXT(2)    17280000
172900             MOVE SQLCA               TO PC033-SQLCA              17290000
173000             MOVE 'SUT00027'          TO PC033-DB2-TABLE-NAME(1)  17300000
173100             SET PC033-ABEND          TO TRUE                     17310000
173200             MOVE 99                  TO PC033-PGM-MSG-NBR        17320000
173300             PERFORM 8210-XCTL-ERROR-SCREEN                       17330000
173400     END-EVALUATE.                                                17340000
173500*                                                                 17350000
173600*                                                                 17360000
182800 2290-INSERT-OTBND-CART.                                          18280000
182900     EXEC SQL                                                     18290000
183000         INSERT INTO SUT_OTBND_CART                               18300000
183100               (SHIPT_UNT_ID,                                     18310000
183200                ORGN_LOC_NBR,                                     18320000
183300                DEST_LOC_NBR,                                     18330000
183400                CART_SRC_CDE,                                     18340000
183500                MSTR_CART_IND,                                    18350000
183600                PRNT_CART_ID,                                     18360000
183700                ORIG_CART_ID,                                     18370000
183800                ACTV_IND,                                         18380000
183900                CRE_DTE,                                          18390000
184000                CRE_TM,                                           18400000
184100                CRE_USR_ID,                                       18410000
184200                CRE_PGM_NM,                                       18420000
184300                CART_TYP_CDE)                                     18430000
184400         VALUES                                                   18440000
184500               (:SUT00024-SHIPT-UNT-ID,                           18450000
184600                :SUT00024-ORGN-LOC-NBR,                           18460000
184700                :SUT00024-DEST-LOC-NBR,                           18470000
184800                :SUT00024-CART-SRC-CDE,                           18480000
184900                :SUT00024-MSTR-CART-IND,                          18490000
185000                :SUT00024-PRNT-CART-ID,                           18500000
185100                :SUT00024-ORIG-CART-ID,                           18510000
185200                :SUT00024-ACTV-IND,                               18520000
185300                CURRENT DATE,                                     18530000
185400                CURRENT TIME,                                     18540000
185500                :SUT00024-CRE-USR-ID,                             18550000
185600                :SUT00024-CRE-PGM-NM,                             18560000
185700                'S')                                              18570000
185800     END-EXEC.                                                    18580000
185900                                                                  18590000
186000     EVALUATE TRUE                                                18600000
186100         WHEN SQLCODE = ZERO                                      18610000
186200             CONTINUE                                             18620000
186300         WHEN SQLCODE = -904                                      18630000
186400         WHEN SQLCODE = -913                                      18640000
186500         WHEN SQLCODE = -911                                      18650000
186600             MOVE 8                   TO PV-ERROR-NBR             18660000
186700             PERFORM 9903-WRITE-CICS-LOG                          18670000
186800             PERFORM 9000-SOFT-ABORT                              18680000
186900         WHEN SQLWARN0 NOT = SPACES                               18690000
187000         WHEN SQLCODE NOT EQUAL ZERO                              18700000
187100             MOVE 7                   TO PV-ERROR-NBR             18710000
187200                                         PC033-ERROR-NBR          18720000
187300             PERFORM 9903-WRITE-CICS-LOG                          18730000
187400             MOVE '2290-INSERT-OTBND-CART'                        18740000
187500                                      TO PC033-PARAGRAPH          18750000
187600             MOVE 'PCKRF864 - INSERT SHIPPING UNIT'               18760000
187700                                      TO PC033-MESSAGE-TEXT(1)    18770000
187800             MOVE SUT00024-SHIPT-UNT-ID                           18780000
187900                                      TO PC033-MESSAGE-TEXT(2)    18790000
188000             MOVE SQLCA               TO PC033-SQLCA              18800000
188100             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  18810000
188200             SET PC033-ABEND          TO TRUE                     18820000
188300             MOVE 99                  TO PC033-PGM-MSG-NBR        18830000
188400             PERFORM 8210-XCTL-ERROR-SCREEN                       18840000
188500     END-EVALUATE.                                                18850000
188600*                                                                 18860000
188700*                                                                 18870000
188800 2300-CREATE-MASTER-ID.                                           18880000
188900*LMM MOVE PC-00             TO PV-1-2.                            18890000
189000     MOVE PC-41             TO PV-3-4.                            18900000
189100     MOVE PC-0              TO PV-5.                              18910000
189200     MOVE PV-STORE-N        TO PV-6-9.                            18920000
189300     MOVE PC033-OPER-UNT-ID TO PV-OPER-UNT-ID.                    18930000
189400     MOVE PV-OPER-UNT-ID    TO PV-10-12.                          18940000
189500                                                                  18950000
189600     MOVE ZEROS TO PV-13-20.                                      18960000
189700     MOVE PV-STORE-N        TO PC187-STR-NBR                      18970000
189800     MOVE  +1               TO PC187-NO-OF-LBLS                   18980000
189900     PERFORM 7250-LINK-PCKCS721                                   18990000
190000     MOVE PC187-START-MFST-NBR TO PV-MFST-NBR                     19000000
190100                                  PC033-MANIFEST                  19010000
190200     MOVE PV-MFST-NBR          TO PV-13-20.                       19020000
190300     MOVE PV-SYSTEM-ASSIGN-MASTER-ID-N TO ACARTNO                 19030000
190400                                          PC033-CARTON.           19040000
190500     MOVE SPACES                       TO PC033-BRCDE-NBR.        19050000
190600     MOVE '00'                         TO PC033-BRCDE-NBR (1:2).  19060000
190700     MOVE PV-SYSTEM-ASSIGN-MASTER-ID   TO PC033-BRCDE-NBR (3:18). 19070000
190800     SET PS-MASTER-ID-CREATED TO TRUE.                            19080000
190900                                                                  19090000
191000***************************************************************** 19100000
191100* THIS PARAGRAPH WILL DO MULTIPLE THINGS.  IF THERE IS A FAILURE  19110000
191200*   AT ANY POINT IT WILL DO A SYNCPOINT ROLLBACK.                 19120000
191300* -- INSERT INTO MASTER SHIPMENT UNIT TABLE. THE TYPE CODEWILL    19130000
191400*    INDICATE WHAT TYPE OF MASTER IT IS.                          19140000
191500* -- CALL XLKUP033 - WRITE DATA TO THE EAI EXPORT TABLES          19150000
191600*                                                                 19160000
191700***************************************************************** 19170000
191800 2400-MSTR-SHIPT-UNT.                                             19180000
191900                                                                  19190000
192000     SET PS-UPDATE-COMMIT TO TRUE.                                19200000
192100     PERFORM 2410-INS-MSTR-SHIPT-UNT.                             19210000
192200                                                                  19220000
192300     IF PS-UPDATE-ROLLBACK                                        19230000
192400        PERFORM 9000-SOFT-ABORT.                                  19240000
192500                                                                  19250000
192600***** PREPARE TO CALL XLKUP033                                    19260000
192700     PERFORM 2430-CALL-XLKUP033.                                  19270000
192800                                                                  19280000
192900     IF PS-UPDATE-COMMIT                                          19290000
193000        PERFORM 9010-COMMIT-POINT                                 19300000
193100     ELSE                                                         19310000
193200        PERFORM 9000-SOFT-ABORT.                                  19320000
193300                                                                  19330000
193400***************************************************************** 19340000
193500* 2410-INS-MSTR-SHIPT-UNT                                         19350000
193600***************************************************************** 19360000
193700 2410-INS-MSTR-SHIPT-UNT.                                         19370000
193800     IF (PC033-MASTER-TYPE-SELECTION NOT EQUAL                    19380000
193900           PC033-MSTR-TYP-ORIGINAL) AND                           19390000
194000        (PC033-MSTR-TYP-ORIGINAL NOT EQUAL SPACES)                19400000
194100        MOVE PC033-MSTR-TYP-ORIGINAL TO                           19410000
194200               PC033-MASTER-TYPE-SELECTION                        19420000
194300     END-IF                                                       19430000
194400     IF PC033-MSTR-TYP-ORIGINAL EQUAL SPACES                      19440000
194500         MOVE PC033-MASTER-TYPE-SELECTION TO                      19450000
194600             PC033-MSTR-TYP-ORIGINAL                              19460000
194700     END-IF                                                       19470000
194800                                                                  19480000
194900                                                                  19490000
195000     MOVE PC033-MASTER-TYPE-SELECTION                             19500000
195100          TO SUT00098-MSTR-SHIPT-TYP-CDE.                         19510000
195200     MOVE PC033-USER-ID           TO SUT00024-CRE-USR-ID.         19520000
195300                                                                  19530000
195400     EXEC SQL                                                     19540000
195500         INSERT INTO SUT_MSTR_SHIPT_UNT                           19550000
195600               (MSTR_SHIPT_UNT_ID,                                19560000
195700                CRE_TMST,                                         19570000
195800                MSTR_SHIPT_TYP_CDE,                               19580000
195900                CRE_BY_USR_ID)                                    19590000
196000         VALUES                                                   19600000
196100               (:SUT00024-SHIPT-UNT-ID,                           19610000
196200                CURRENT TIMESTAMP,                                19620000
196300                :SUT00098-MSTR-SHIPT-TYP-CDE,                     19630000
196400                :SUT00024-CRE-USR-ID)                             19640000
196500*               :SUT00024-CRE-PGM-NM)                             19650000
196600     END-EXEC.                                                    19660000
196700                                                                  19670000
196800     EVALUATE TRUE                                                19680000
196900         WHEN SQLCODE = ZERO                                      19690000
197000             CONTINUE                                             19700000
197100         WHEN SQLCODE = -904                                      19710000
197200         WHEN SQLCODE = -913                                      19720000
197300         WHEN SQLCODE = -911                                      19730000
197400             MOVE 8                   TO PV-ERROR-NBR             19740000
197500             SET PS-UPDATE-ROLLBACK TO TRUE                       19750000
197600             PERFORM 9903-WRITE-CICS-LOG                          19760000
197700             PERFORM 9000-SOFT-ABORT                              19770000
197710*CHG0144243 - START                                               19771012
197720         WHEN SQLCODE = -803                                      19772011
197770             PERFORM 9005-ROLLBACK                                19777011
197790             MOVE DP015-UNP-ALP-BRT-MDT                           19779011
197791                                TO ACARTNA                        19779111
197792             MOVE -1            TO ACARTNL                        19779211
197793             MOVE PV-CTN        TO ACARTNO                        19779311
197794             MOVE PC-ENTER-NEW-SML                                19779411
197795                                TO AMSGLNO                        19779511
197796             PERFORM 8010-SEND-DATA-ONLY                          19779611
197797             PERFORM 8100-RETURN-TRANID                           19779711
197798*CHG0144243 - END                                                 19779812
197800         WHEN SQLWARN0 NOT = SPACES                               19780000
197900         WHEN SQLCODE NOT EQUAL ZERO                              19790000
198000             SET PS-UPDATE-ROLLBACK TO TRUE                       19800000
198100             MOVE 7                   TO PV-ERROR-NBR             19810000
198200                                         PC033-ERROR-NBR          19820000
198300             PERFORM 9903-WRITE-CICS-LOG                          19830000
198400             MOVE '2410-INS-MSTR-SHIPT-UNT'                       19840000
198500                                      TO PC033-PARAGRAPH          19850000
198600             MOVE 'PCKRF864 - INSERT SHIPPING UNIT'               19860000
198700                                      TO PC033-MESSAGE-TEXT(1)    19870000
198800             MOVE SUT00024-SHIPT-UNT-ID                           19880000
198900                                      TO PC033-MESSAGE-TEXT(2)    19890000
199000             MOVE SQLCA               TO PC033-SQLCA              19900000
199100             MOVE 'SUT00098'          TO PC033-DB2-TABLE-NAME(1)  19910000
199200             SET PC033-ABEND          TO TRUE                     19920000
199300             MOVE 99                  TO PC033-PGM-MSG-NBR        19930000
199400             PERFORM 8210-XCTL-ERROR-SCREEN                       19940000
199500     END-EVALUATE.                                                19950000
199600*                                                                 19960000
199700*                                                                 19970000
199800 2420-CALL-DLKCS410.                                              19980000
199900     INITIALIZE  DL016-PGM-COMMAREA.                              19990000
200000     SET DL016-ESTABLISH-ASGMT TO TRUE.                           20000000
200100*VML SHOULD THIS BE DO NOT COMMIT IN CASE PROBLEM WITH XLKUP033   20010000
200200     SET DL016-COMMIT-UPDATE   TO TRUE.                           20020000
200300                                                                  20030000
200400     MOVE PC-CURRENT-PROGRAM-NAME TO DL016-CALLING-PGM-NM.        20040000
200500     MOVE PC033-USER-ID TO DL016-SIGN-ON-USR-ID.                  20050000
200600                                                                  20060000
200700     MOVE 'SHIP  '                    TO DL016-ASGMT-NBR-WRK-TYP  20070000
200800     MOVE 'MASTCON'                   TO DL016-EAI-WK-TYP-DESC.   20080000
200900                                                                  20090000
201000     EVALUATE PC033-MASTER-TYPE-SELECTION                         20100000
201100         WHEN 'FJ '                                               20110000
201200          STRING 'FINEMC '                                        20120000
201300                 '-'                                              20130000
201400                 PC033-USER-ID                                    20140000
201500               DELIMITED BY SIZE                                  20150000
201600                 INTO DL016-EAI-WK-AREA-DESC                      20160000
201700                                                                  20170000
201800         WHEN 'BJ '                                               20180000
201900          STRING 'BULKMC '                                        20190000
202000                 '-'                                              20200000
202100                 PC033-USER-ID                                    20210000
202200               DELIMITED BY SIZE                                  20220000
202300                 INTO DL016-EAI-WK-AREA-DESC                      20230000
202400                                                                  20240000
202500         WHEN 'PJ '                                               20250000
202600          STRING 'CPBSMC '                                        20260000
202700                 '-'                                              20270000
202800                 PC033-USER-ID                                    20280000
202900               DELIMITED BY SIZE                                  20290000
203000                 INTO DL016-EAI-WK-AREA-DESC                      20300000
203100                                                                  20310000
203200         WHEN 'NCL'                                               20320000
203300          STRING 'LNONCON'                                        20330000
203400                 '-'                                              20340000
203500                 PC033-USER-ID                                    20350000
203600               DELIMITED BY SIZE                                  20360000
203700                 INTO DL016-EAI-WK-AREA-DESC                      20370000
203800                                                                  20380000
203900         WHEN 'NCS'                                               20390000
204000          STRING 'SNONCON'                                        20400000
204100                 '-'                                              20410000
204200                 PC033-USER-ID                                    20420000
204300               DELIMITED BY SIZE                                  20430000
204400                 INTO DL016-EAI-WK-AREA-DESC                      20440000
204500                                                                  20450000
204600         WHEN 'O  '                                               20460000
204700          STRING 'OTHERMC'                                        20470000
204800                 '-'                                              20480000
204900                 PC033-USER-ID                                    20490000
205000               DELIMITED BY SIZE                                  20500000
205100                 INTO DL016-EAI-WK-AREA-DESC                      20510000
205200                                                                  20520000
205300     END-EVALUATE.                                                20530000
205400                                                                  20540000
205500     MOVE PC033-OPER-UNT-ID TO DL016-EAI-DC-NBR.                  20550000
205600     MOVE PC033-USER-ID     TO DL016-EAI-CRE-BY-USR-ID.           20560000
205700     SET  DL016-EAI-USR-IS-UNKNOWN TO TRUE.                       20570000
205800                                                                  20580000
205900     MOVE LENGTH OF DL016-PGM-COMMAREA TO PV-COMMAREA-LENGTH.     20590000
206000                                                                  20600000
206100     PERFORM 2421-CALL-DLKCS410.                                  20610000
206200                                                                  20620000
206300****************************************************************  20630000
206400* 2421-CALL-DLKCS410 -- LABOR MANAGEMENT CONTROL MODULE        *  20640000
206500*                                                              *  20650000
206600****************************************************************  20660000
206700 2421-CALL-DLKCS410.                                              20670000
206800     EXEC CICS LINK                                               20680000
206900         PROGRAM  (DL016-USER-PGM)                                20690000
207000         COMMAREA (DL016-PGM-COMMAREA)                            20700000
207100         LENGTH   (PV-COMMAREA-LENGTH)                            20710000
207200         RESP     (PV-CICS-RESPONSE)                              20720000
207300     END-EXEC.                                                    20730000
207400                                                                  20740000
207500     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      20750000
207600         EVALUATE TRUE                                            20760000
207700             WHEN DL016-SUCCESSFUL                                20770000
207800                  MOVE DL016-ESO-ASGMT-START-DTE TO               20780000
207900                                 PC033-ASGMT-STRT-DTE             20790000
208000                  MOVE DL016-ESO-ASGMT-NBR-TXT TO                 20800000
208100                                 PC033-ASGMT-NBR-TXT              20810000
208200                  MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO             20820000
208300                                 PC033-ASGMT-NBR-SEQ-NBR          20830000
208400             WHEN DL016-SQL-ERROR                                 20840000
208500                  SET PS-UPDATE-ROLLBACK TO TRUE                  20850000
208600                  STRING ' DLKCS410 SQL ERROR FOR USER ID-'       20860000
208700                          PC033-USER-ID                           20870000
208800                          DELIMITED BY SIZE                       20880000
208900                          INTO PV-MESSAGE-AREA                    20890000
209000                  PERFORM 2425-FORMAT-ERROR-MESSAGE               20900000
209100             WHEN DL016-CALLED-MODULE-FAILURE                     20910000
209200                  SET PS-UPDATE-ROLLBACK TO TRUE                  20920000
209300                  STRING ' DLKCS410 CALLED MODULE FAILURE FOR '   20930000
209400                          PC033-USER-ID                           20940000
209500                          DELIMITED BY SIZE                       20950000
209600                          INTO PV-MESSAGE-AREA                    20960000
209700                  PERFORM 2425-FORMAT-ERROR-MESSAGE               20970000
209800             WHEN DL016-INVALID-ACCESS                            20980000
209900                  SET PS-UPDATE-ROLLBACK TO TRUE                  20990000
210000                  STRING ' DLKCS410 INVALID ACCESS FAILURE FOR '  21000000
210100                          PC033-USER-ID                           21010000
210200                          DELIMITED BY SIZE                       21020000
210300                          INTO PV-MESSAGE-AREA                    21030000
210400                  PERFORM 2425-FORMAT-ERROR-MESSAGE               21040000
210500             WHEN OTHER                                           21050000
210600                  STRING ' DLKCS410 OTHER TYPE FAILURE FOR '      21060000
210700                          PC033-USER-ID                           21070000
210800                          DELIMITED BY SIZE                       21080000
210900                          INTO PV-MESSAGE-AREA                    21090000
211000                  PERFORM 2425-FORMAT-ERROR-MESSAGE               21100000
211100         END-EVALUATE                                             21110000
211200     ELSE                                                         21120000
211300         SET PS-UPDATE-ROLLBACK TO TRUE                           21130000
211400         MOVE '2421-CALL-DLKCS410' TO PC033-PARAGRAPH             21140000
211500         MOVE PV-CICS-RESPONSE     TO PC033-MESSAGE-TEXT (1)      21150000
211600         MOVE 'BAD RETURN FROM DLKCS410' TO                       21160000
211700                                      PC033-MESSAGE-TEXT (2)      21170000
211800         MOVE 2                    TO PC033-ERROR-NBR             21180000
211900         SET PC033-ABEND           TO TRUE                        21190000
212000         MOVE 99                   TO PC033-PGM-MSG-NBR           21200000
212100         PERFORM 8210-XCTL-ERROR-SCREEN                           21210000
212200     END-IF.                                                      21220000
212300                                                                  21230000
212400****************************************************************  21240000
212500* 2425-FORMAT-ERROR-MESSAGE                                    *  21250000
212600*                                                              *  21260000
212700****************************************************************  21270000
212800 2425-FORMAT-ERROR-MESSAGE.                                       21280000
212900                                                                  21290000
213000     MOVE DL016-ASGMT-SQLCODE    TO PV-SQLCODE.                   21300000
213100     MOVE PC033-OPER-UNT-ID      TO PV-OPER-UNT-ID-X.             21310000
213200                                                                  21320000
213300     INITIALIZE PV-CICS-MSG-AREA2.                                21330000
213400     STRING ' PCKRF864-2425- '                                    21340000
213500             PV-OPER-UNT-ID-X  '-'                                21350000
213600             PV-MESSAGE-AREA                                      21360000
213700            ' SQLCODE=' PV-SQLCODE                                21370000
213800             DELIMITED BY SIZE                                    21380000
213900             INTO PV-CICS-MSG-AREA2.                              21390000
214000     PERFORM 999A-WRITE-CSSL-MSG.                                 21400000
214100                                                                  21410000
214200     INITIALIZE PV-CICS-MSG-AREA2.                                21420000
214300     STRING ' PCKRF864-' DL016-USER-PGM                           21430000
214400            ' -- ' DL016-CALL-MOD-FAIL-SQL-PARA                   21440000
214500            ' -- ' DL016-CALL-MOD-FAIL-NM                         21450000
214600            ' -- ' DL016-CALL-MOD-FAIL-ERR-CDE                    21460000
214700             DELIMITED BY SIZE                                    21470000
214800             INTO PV-CICS-MSG-AREA2.                              21480000
214900     PERFORM 999A-WRITE-CSSL-MSG.                                 21490000
215000                                                                  21500000
215100****************************************************************  21510000
215200*    FORMAT BUSINESS EVENTS (PALLET MANUAL) OR (CARTON MANUAL) *  21520000
215300*    BOTH EVENTS GO TO THE PCT00011 AND PCT00012 BUSINESS      *  21530000
215400*    EVENT TABLES.                                             *  21540000
215500*                                                              *  21550000
215600****************************************************************  21560000
215700 2430-CALL-XLKUP033.                                              21570000
215800                                                                  21580000
215900     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        21590000
216000                                                                  21600000
216100     SET  XL072-PC-APP-ID   TO TRUE.                              21610000
216200     MOVE PC-SHIPPING       TO XL072-EVNT-OBJ-TXT.                21620000
216300                                                                  21630000
216400     MOVE 'ADD MASTER'     TO XL072-EVNT-OBJ-ACTN-TXT.            21640000
216500                                                                  21650000
216600*    END-EVALUATE.                                                21660000
216700                                                                  21670000
216800     MOVE PC033-USER-ID TO XL072-CRE-BY-USR-ID.                   21680000
216900     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            21690000
217000     SET  XL072-PC-APP-ID   TO TRUE.                              21700000
217100                                                                  21710000
217200     PERFORM 8400-GET-TIMESTAMP.                                  21720000
217300                                                                  21730000
217400     MOVE PV-CURRENT-TIMESTAMP TO XL072-EVNT-KY-1-TMST.           21740000
217500                                                                  21750000
217600     INITIALIZE PC242-DTL-TXT-AREA.                               21760000
217700                                                                  21770000
217800     SET PC242-ADD-MASTER TO TRUE.                                21780000
217900     MOVE PC033-ASGMT-STRT-DTE                                    21790000
218000                         TO PC242-AN-ASGMT-STRT-DTE.              21800000
218100     MOVE PC033-ASGMT-NBR-TXT                                     21810000
218200                         TO PC242-AN-ASGMT-NBR-TXT.               21820000
218300     MOVE PC033-ASGMT-NBR-SEQ-NBR                                 21830000
218400                         TO PC242-AN-ASGMT-NBR-SEQ-NBR.           21840000
218500     MOVE DL001-SEQ-START-NBR                                     21850000
218600                         TO PC242-AN-ASGMT-SEQ-DTL-NBR.           21860000
218700                                                                  21870000
218800     SET  XL072-PCWS242-COPYBOOK   TO TRUE.                       21880000
218900     SET  XL072-COMMIT-UPDATE      TO TRUE.                       21890000
219000     MOVE PC242-DTL-TXT-AREA       TO XL072-DTL-TXT.              21900000
219100                                                                  21910000
219200     CALL XL072-USER-PGM USING DFHEIBLK                           21920000
219300                              XL072-COMMAREA                      21930000
219400                              XL072-EAI-EXPORT-COMMAREA.          21940000
219500                                                                  21950000
219600     EVALUATE TRUE                                                21960000
219700         WHEN XL072-SUCCESSFUL                                    21970000
219800              CONTINUE                                            21980000
219900         WHEN OTHER                                               21990000
220000              SET PS-UPDATE-ROLLBACK TO TRUE                      22000000
220100              MOVE PC033-OPER-UNT-ID TO  PV-OPER-UNT-ID-X         22010000
220200              MOVE PC033-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-SEQ-NBR  22020000
220300              MOVE XL072-EAI-DB-SQLCODE                           22030000
220400                                     TO  PV-SQLCODE               22040000
220500              INITIALIZE PV-CICS-MSG-AREA2                        22050000
220600              STRING ' PCKRF864-2430- '                           22060000
220700                      PV-OPER-UNT-ID-X  '-'                       22070000
220800                      PC033-ASGMT-STRT-DTE  ' - '                 22080000
220900                      PC033-ASGMT-NBR-TXT   ' - '                 22090000
221000                      PV-DISPLAY-SEQ-NBR ' - '                    22100000
221100                      PC033-USER-ID ' - '                         22110000
221200                     'SQLCODE=' PV-SQLCODE                        22120000
221300                     ' - RETURN CODE=' XL072-RETURN-CODE          22130000
221400                                                DELIMITED BY SIZE 22140000
221500                                           INTO PV-CICS-MSG-AREA2 22150000
221600               MOVE LENGTH OF PV-CICS-MSG-AREA2                   22160000
221700                                             TO PV-COMMAREA-LENGTH22170000
221800               PERFORM 999A-WRITE-CSSL-MSG                        22180000
221900                                                                  22190000
222000              INITIALIZE PV-CICS-MSG-AREA2                        22200000
222100              STRING ' PCKRF864-' XL072-USER-PGM                  22210000
222200                      ' -- ' XL072-SQL-ERROR-PARA                 22220000
222300                      ' -- ' XL072-CALL-MOD-FAIL-NM               22230000
222400                      ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE          22240000
222500                                                DELIMITED BY SIZE 22250000
222600                                           INTO PV-CICS-MSG-AREA2 22260000
222700               MOVE LENGTH OF PV-CICS-MSG-AREA2                   22270000
222800                                             TO PV-COMMAREA-LENGTH22280000
222900               PERFORM 999A-WRITE-CSSL-MSG                        22290000
223000                                                                  22300000
223100              INITIALIZE PV-CICS-MSG-AREA2                        22310000
223200              STRING ' PCKRF864-' XL072-USER-PGM                  22320000
223300                      ' -- ' XL072-SQLCA                          22330000
223400                                                DELIMITED BY SIZE 22340000
223500                                           INTO PV-CICS-MSG-AREA2 22350000
223600               MOVE LENGTH OF PV-CICS-MSG-AREA2                   22360000
223700                                             TO PV-COMMAREA-LENGTH22370000
223800               PERFORM 999A-WRITE-CSSL-MSG                        22380000
223900                                                                  22390000
224000               MOVE 4                   TO PV-ERROR-NBR           22400000
224100                                           PC033-ERROR-NBR        22410000
224200               PERFORM 9903-WRITE-CICS-LOG                        22420000
224300               MOVE '2430-CALL-XLKUP033'                          22430000
224400                                        TO PC033-PARAGRAPH        22440000
224500               MOVE 'PCKRF864 - CALL XLKUP033 ERROR'              22450000
224600                                        TO PC033-MESSAGE-TEXT(1)  22460000
224700               MOVE SQLCA               TO PC033-SQLCA            22470000
224800               SET PC033-ABEND          TO TRUE                   22480000
224900               MOVE 99                  TO PC033-PGM-MSG-NBR      22490000
225000               PERFORM 8210-XCTL-ERROR-SCREEN                     22500000
225100                                                                  22510000
225200     END-EVALUATE.                                                22520000
225300                                                                  22530000
225400*                                                                 22540000
225500*-----------------------------------------------------------------22550000
225600* DETERMINE LAST ACTIVITY FOR CARTON (CHECK IN REVERSE ORDER)     22560000
225700* THIS WILL CALL PCKUT713 WHICH BRINGS BACK ALL INFORMATION ON    22570014
225800* THE CARTON ENTERED.                                             22580000
225900*-----------------------------------------------------------------22590000
226000 3000-DETERMINE-LAST-ACTIVITY.                                    22600000
226100                                                                  22610000
226200     INITIALIZE  PC046-COMMAREA-REC.                              22620000
226300     SET   PC046-FROM-CRTN-STAT  TO  TRUE.                        22630000
226400     MOVE  SUT00024-SHIPT-UNT-ID TO  PC046-CARTON-ID.             22640000
226500                                                                  22650000
226600                                                                  22660000
226700     CALL PC046-CARTON-STATUS-MODULE                              22670000
226800             USING DFHEIBLK                                       22680000
226900             PC046-COMMAREA                                       22690000
227000             PC046-COMMAREA-REC                                   22700000
227100     END-CALL                                                     22710000
227200                                                                  22720000
227300     PERFORM 3005-VALIDATE-STATUS-CALL.                           22730000
227400                                                                  22740000
227500*----------------------------------------------------------------*22750000
227600* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*22760000
227700*----------------------------------------------------------------*22770000
227800 3005-VALIDATE-STATUS-CALL.                                       22780000
227900                                                                  22790000
228000     IF  PC046-ERROR                                              22800000
228100         SET  PS-ERROR-YES           TO  TRUE                     22810000
228200         MOVE PC-CICS-ABEND-MSG      TO  AMSGLNO                  22820000
228300         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       22830000
228400                                                                  22840000
228500     ELSE                                                         22850000
228600     IF  PC046-INVALID-SQL                                        22860000
228700         SET  PS-ERROR-YES           TO  TRUE                     22870000
228800         MOVE PC-DATABASE-ERROR      TO  AMSGLNO                  22880000
228900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       22890000
229000                                                                  22900000
229100     ELSE                                                         22910000
229200     IF  PC046-DATABASE-BUSY                                      22920000
229300         SET  PS-ERROR-YES           TO  TRUE                     22930000
229400         MOVE PC-DATABASE-BUSY       TO  AMSGLNO                  22940000
229500         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       22950000
229600                                                                  22960000
229700     ELSE                                                         22970000
229800     IF  PC046-CRTN-STAT-ERROR                                    22980000
229900         SET  PS-ERROR-YES           TO  TRUE                     22990000
230000         MOVE PC-CARTON-STATUS-ERROR TO  AMSGLNO                  23000000
230100                                                                  23010000
230200     ELSE                                                         23020000
230300     IF  PC046-SUCCESSFUL                                         23030000
230400         MOVE  PC046-OTBD-TRIP-ID    TO  PC033-OTBD-TRIP-ID       23040000
230500         MOVE  PC046-TRLR-ID         TO  PC033-VEH-NBR            23050000
230600         MOVE  PC046-SCAC            TO  PC033-OWNER-SCAC-ID      23060000
230700         IF PC033-OTBD-TRIP-ID  > SPACES AND                      23070000
230800            PC033-VEH-NBR       > SPACES AND                      23080000
230900            PC033-OWNER-SCAC-ID > SPACES                          23090000
231000               MOVE SQLCA               TO PC033-SQLCA            23100000
231100               SET PC033-INITIALIZE-SCREEN TO TRUE                23110000
231200               MOVE 17                   TO PC033-PGM-MSG-NBR     23120000
231300               PERFORM 8210-XCTL-ERROR-SCREEN                     23130000
231400         ELSE                                                     23140000
231500            CONTINUE                                              23150000
231600         END-IF                                                   23160000
231700     ELSE                                                         23170000
231800         SET  PS-ERROR-YES           TO  TRUE                     23180000
231900         MOVE  PC-CICS-ABEND-MSG     TO  AMSGLNO                  23190000
232000                                                                  23200000
232100     END-IF                                                       23210000
232200     END-IF                                                       23220000
232300     END-IF                                                       23230000
232400     END-IF                                                       23240000
232500     END-IF.                                                      23250000
232600*                                                                 23260000
232700*                                                                 23270000
232800******************************************************************23280000
232900* VALIDATE PRINTER ID                                             23290000
233000* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                       23300000
233100******************************************************************23310000
233200 3010-VALIDATE-PRINTER.                                           23320000
233300                                                                  23330000
233400     MOVE PV-PRINTER-ID      TO  DP072-PRINTER-ID.                23340000
233500     MOVE PC-REPORT-PGM-1    TO  DP072-RPT-PGM-NME.               23350000
233600     MOVE PC-01              TO  DP072-RPT-PGM-TYP-ID.            23360000
233700     MOVE PC033-OPER-UNT-ID  TO  DP072-ORIGIN-OPER-UNT-ID.        23370000
233800     MOVE PC033-OPER-UNT-ID  TO  DP072-OPER-UNT-ID.               23380000
233900     MOVE 1                  TO  DP072-ORIGIN-FCLTY-ID            23390000
234000                                 DP072-FCLTY-ID.                  23400000
234100     SET DP072-VALIDATE      TO  TRUE.                            23410000
234200                                                                  23420000
234300     EXEC CICS                                                    23430000
234400          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  23440000
234500               COMMAREA (DP072-COMM-AREA)                         23450000
234600               RESP     (PV-CICS-RESPONSE)                        23460000
234700     END-EXEC                                                     23470000
234800                                                                  23480000
234900     EVALUATE TRUE                                                23490000
235000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 23500000
235100              PERFORM 3020-VALIDATE-PRINTER-ID-SML                23510000
235200              IF PS-VALID-PRINTER-ID                              23520000
235300                  SET PS-VALID-INPUT         TO TRUE              23530000
235400                  MOVE PV-PRINTER-ID         TO PC033-SML-PRTR-ID 23540000
235500              ELSE                                                23550000
235600                  SET PS-INVALID-INPUT       TO TRUE              23560000
235700                  MOVE DP015-UNP-ALP-BRT-MDT                      23570000
235800                                     TO APRTRA                    23580000
235900                  MOVE -1            TO APRTRL                    23590000
236000                  MOVE PV-PRINTER-ID TO APRTRO                    23600000
236100                  MOVE PC-INVALID-PRINTER-ID                      23610000
236200                                     TO AMSGLNO                   23620000
236300              END-IF                                              23630000
236400         WHEN OTHER                                               23640000
236500             SET PS-INVALID-PRINTER-ID  TO  TRUE                  23650000
236600             SET PS-INVALID-INPUT       TO TRUE                   23660000
236700             MOVE DP015-UNP-ALP-BRT-MDT                           23670000
236800                                TO APRTRA                         23680000
236900             MOVE -1            TO APRTRL                         23690000
237000             MOVE PV-PRINTER-ID TO APRTRO                         23700000
237100             MOVE PC-INVALID-PRINTER-ID                           23710000
237200                                TO AMSGLNO                        23720000
237300     END-EVALUATE.                                                23730000
237400                                                                  23740000
237500                                                                  23750000
237600******************************************************************23760000
237700*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *23770000
237800*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *23780000
237900*  CAN BE PRINTED ON THIS PRINTER.                               *23790000
238000******************************************************************23800000
238100 3020-VALIDATE-PRINTER-ID-SML.                                    23810000
238200*SHIPPING MANIFEST LABELS CAN BE PRINTED ON THIS PRINTER IF       23820000
238300*CLUSTR-OS-RLSE-CDE ON TPRTRCL IS NOT EQUAL TO 'MGMX' AND         23830000
238400*PRTR-TRK-STAT-CDE ON TPRTRTK = 'A'.                              23840000
238500                                                                  23850000
238600     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               23860000
238700         SET  PS-INVALID-PRINTER-ID   TO TRUE                     23870000
238800     END-IF.                                                      23880000
238900                                                                  23890000
239000     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  23900000
239100         SET  PS-VALID-PRINTER-ID     TO TRUE                     23910000
239200     ELSE                                                         23920000
239300         SET  PS-INVALID-PRINTER-ID   TO TRUE                     23930000
239400     END-IF.                                                      23940000
239500*                                                                 23950000
239600*                                                                 23960000
239700 4000-XCTL-TO-SELECTED-PROGRAM.                                   23970000
239800     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     23980000
239900     MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM.          23990000
240000                                                                  24000000
240100     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             24010000
240200     EXEC CICS                                                    24020000
240300         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    24030000
240400               COMMAREA  (CA-COMMAREA)                            24040000
240500               LENGTH    (PC-COMMAREA-LENGTH)                     24050000
240600               RESP      (PV-CICS-RESPONSE)                       24060000
240700     END-EXEC.                                                    24070000
240800                                                                  24080000
240900     EVALUATE TRUE                                                24090000
241000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 24100000
241100             CONTINUE                                             24110000
241200         WHEN OTHER                                               24120000
241300             MOVE '4000-XCTL-TO-SELECTED-PROGRAM'                 24130000
241400                 TO DP013-PARAGRAPH                               24140000
241500             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   24150000
241600                 TO DP013-MESSAGE-TEXT (1)                        24160000
241700             MOVE PV-TRANSFER-PROGRAM                             24170000
241800                 TO DP013-MESSAGE-TEXT (2)                        24180000
241900             SET DP013-CICS-ABEND  TO TRUE                        24190000
242000             SET DP013-NO-ROLLBACK TO TRUE                        24200000
242100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               24210000
242200             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             24220000
242300             SET PC033-PROCESS-SCREEN TO TRUE                     24230000
242400             PERFORM 8000-SEND-MAP                                24240000
242500             PERFORM 8100-RETURN-TRANID                           24250000
242600     END-EVALUATE.                                                24260000
242700*                                                                 24270000
242800*                                                                 24280000
242900* SET THE COMMON SHIP MANIFEST LABEL FORMAT TO TRUE,              24290000
243000* AND FILL IN THE GENERIC INFORMATION                             24300000
243100*                                                                 24310000
243200 4500-SETUP-COM-LABEL.                                            24320000
243300                                                                  24330000
243400     PERFORM 2240-VALIDATE-STORE.                                 24340000
243500     PERFORM 2253-GET-DC-LOCATION.                                24350000
243600                                                                  24360000
243700     SET PC140-COMMON-MFST-LBL-NBR TO TRUE.                       24370000
243800                                                                  24380000
243900     IF PS-MASTER-ID-NOT-CREATED                                  24390000
244000        SET PC140-SML-REPRINT         TO TRUE                     24400000
244100     ELSE                                                         24410000
244200        IF PS-MASTER-ID-CREATED                                   24420000
244300           SET PC140-SML-NO-REPRINT   TO TRUE                     24430000
244400        END-IF                                                    24440000
244500     END-IF                                                       24450000
244600                                                                  24460000
244700     MOVE PC-Y                     TO PC140-CRA-DC-SSCC-18-IND.   24470000
244800                                                                  24480000
244900     MOVE PV-STR-NAME-CHAR10-ABBR  TO PC140-SML-STR-NAME.         24490000
245000     MOVE PC-MASTER-CONTAINER      TO PC140-SML-ZNE-LINE-1.       24500000
245100     MOVE SPACES                   TO PC140-SML-ZNE-LINE-2        24510000
245200                                      PC140-SML-ZNE-LINE-3.       24520000
245300                                                                  24530000
245400     MOVE PC-0                     TO PC140-SML-DIVERT-PFX.       24540000
245500     MOVE PV-STORE                 TO PC140-SML-STR-NBR.          24550000
245600     MOVE PC033-OPER-UNT-ID        TO PC140-SML-ORIGIN-DC.        24560000
245700                                                                  24570000
245800     IF PS-MASTER-ID-CREATED                                      24580000
245900        MOVE PC033-MANIFEST        TO PC140-SML-STRT-MFST-NBR     24590000
246000     ELSE                                                         24600000
246100        IF PS-MASTER-ID-NOT-CREATED                               24610000
246200           MOVE PV-MANIFEST-NBR    TO PC140-SML-STRT-MFST-NBR     24620000
246300        END-IF                                                    24630000
246400     END-IF                                                       24640000
246500                                                                  24650000
246600     MOVE 'MC-'                    TO PC140-SML-TYPE.             24660000
246700     MOVE PV-PRINTER-ID            TO PC140-SML-PRTR-ID.          24670000
246800     MOVE PC-1                     TO PC140-SML-TOT-CART.         24680000
246900                                                                  24690000
247000     PERFORM 4600-PRINT-SML-LABEL.                                24700000
247100*                                                                 24710000
247200*                                                                 24720000
247300 4600-PRINT-SML-LABEL.                                            24730000
247400                                                                  24740000
247500     MOVE PC033-USER-ID          TO PC140-CRA-USERID.             24750000
247600     MOVE 400                    TO PC-COMMAREA-LENGTH.           24760000
247700                                                                  24770000
247800     EXEC CICS                                                    24780000
247900          LINK PROGRAM  ('PCKCS707')                              24790000
248000               COMMAREA (PC140-LABELMST)                          24800000
248100               LENGTH   (PC-COMMAREA-LENGTH)                      24810000
248200               RESP     (PV-CICS-RESPONSE)                        24820000
248300     END-EXEC.                                                    24830000
248400                                                                  24840000
248500     EVALUATE TRUE                                                24850000
248600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 24860000
248700              CONTINUE                                            24870000
248800         WHEN OTHER                                               24880000
248900              MOVE 8                   TO PV-ERROR-NBR            24890000
249000                                          PC033-ERROR-NBR         24900000
249100              PERFORM 9903-WRITE-CICS-LOG                         24910000
249200              MOVE '4600-PRINT-SML-LABEL'                         24920000
249300                                       TO PC033-PARAGRAPH         24930000
249400              MOVE 'PCKRF864 - PRINT LABEL'                       24940000
249500                                       TO PC033-MESSAGE-TEXT(1)   24950000
249600              MOVE PV-CICS-RESPONSE    TO PC033-SQLCA             24960000
249700              SET PC033-ABEND          TO TRUE                    24970000
249800              MOVE 99                  TO PC033-PGM-MSG-NBR       24980000
249900              PERFORM 8210-XCTL-ERROR-SCREEN                      24990000
250000     END-EVALUATE.                                                25000000
250100     IF PC140-CRA-SOCKET-COMM-ERROR                               25010000
250200         SET PS-ERROR-YES        TO TRUE                          25020000
250300         MOVE PC-LABEL-PRINT-FAIL TO AMSGLNO                      25030000
250400         MOVE DP015-UNP-ALP-BRT-MDT                               25040000
250500                                 TO APRTRA                        25050000
250600         MOVE -1                 TO APRTRL                        25060000
250700     ELSE                                                         25070000
250800     IF PC140-CRA-INVALID-PRT-FMT                                 25080000
250900         SET PS-ERROR-YES        TO TRUE                          25090000
251000         MOVE DP015-UNP-ALP-BRT-MDT                               25100000
251100                                 TO APRTRA                        25110000
251200         MOVE -1                 TO APRTRL                        25120000
251300*        MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                25130000
251400*        MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                25140000
251500     ELSE                                                         25150000
251600         MOVE PC-LABEL-PRINTED   TO AMSGLNO                       25160000
251700         MOVE -1                 TO APRTRL                        25170000
251800     END-IF.                                                      25180000
251900*                                                                 25190000
252000****************************************************************  25200000
252100*    SECURE THE REQUIRED NUMBER OF SEQUENCE NUMBERS.           *  25210000
252200*                                                              *  25220000
252300****************************************************************  25230000
252400 4800-CALL-DLKUP001.                                              25240000
252500                                                                  25250000
252600     SET DL001-BY-ASGMT-KEY                                       25260000
252700         DL001-COMMIT-UPDATE                                      25270000
252800         DL001-FIND-NEXT-ASGMT    TO TRUE.                        25280000
252900                                                                  25290000
253000     IF SUT00024-CART-SRC-CDE = 'MST'                             25300000
253100        MOVE +2 TO DL001-NBR-OF-NBRS-NEED-QTY                     25310000
253200     ELSE                                                         25320000
253300        MOVE +1 TO DL001-NBR-OF-NBRS-NEED-QTY                     25330000
253400     END-IF.                                                      25340000
253500                                                                  25350000
253600     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   25360000
253700                                                                  25370000
253800     CALL DL001-USER-PGM USING DFHEIBLK                           25380000
253900                              DL001-COMMAREA                      25390000
254000                              DL001-ASGMT-COMMAREA.               25400000
254100                                                                  25410000
254200     EVALUATE TRUE                                                25420000
254300         WHEN DL001-SUCCESSFUL                                    25430000
254400              IF DL001-ASGMT-NEXT-USED                            25440000
254500                 MOVE DL001-NXT-START-DTE                         25450000
254600                               TO PC033-ASGMT-STRT-DTE            25460000
254700                 MOVE DL001-NXT-NBR-TXT                           25470000
254800                               TO PC033-ASGMT-NBR-TXT             25480000
254900                 MOVE DL001-NXT-NBR-SEQ-NBR                       25490000
255000                               TO PC033-ASGMT-NBR-SEQ-NBR         25500000
255100              END-IF                                              25510000
255200                                                                  25520000
255300         WHEN DL001-ASGMT-CLOSED-RETURN                           25530000
255400              CONTINUE                                            25540000
255500                                                                  25550000
255600         WHEN OTHER                                               25560000
255700              SET PS-UPDATE-ROLLBACK TO TRUE                      25570000
255800              MOVE DL001-ASGMT-SQLCODE TO  PV-SQLCODE             25580000
255900              INITIALIZE PV-CICS-MSG-AREA2                        25590000
256000              STRING ' PCKRF864-4800- '                           25600000
256100                     'SQLCODE=' PV-SQLCODE                        25610000
256200                     ' - RETURN CODE=' DL001-RETURN-CODE          25620000
256300                      DELIMITED BY SIZE                           25630000
256400                      INTO PV-CICS-MSG-AREA2                      25640000
256500               MOVE LENGTH OF PV-CICS-MSG-AREA2                   25650000
256600                                             TO PV-COMMAREA-LENGTH25660000
256700               PERFORM 999A-WRITE-CSSL-MSG                        25670000
256800                                                                  25680000
256900               INITIALIZE PV-CICS-MSG-AREA2                       25690000
257000               STRING ' PCKRF864-' DL001-USER-PGM                 25700000
257100                      ' -- ' DL001-SQL-ERROR-PARA                 25710000
257200                      ' -- ' DL001-CALL-MOD-FAIL-NM               25720000
257300                      ' -- ' DL001-CALL-MOD-FAIL-ERR-CDE          25730000
257400                       DELIMITED BY SIZE                          25740000
257500                       INTO PV-CICS-MSG-AREA2                     25750000
257600               MOVE LENGTH OF PV-CICS-MSG-AREA2                   25760000
257700                                             TO PV-COMMAREA-LENGTH25770000
257800               PERFORM 999A-WRITE-CSSL-MSG                        25780000
257900                                                                  25790000
258000     END-EVALUATE.                                                25800000
258100                                                                  25810000
258200*                                                                 25820000
258300 7250-LINK-PCKCS721.                                              25830000
258400     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PC-COMMAREA-LENGTH.   25840000
258500                                                                  25850000
258600     EXEC CICS                                                    25860000
258700         LINK PROGRAM  (PC-PCKCS721)                              25870000
258800              COMMAREA (PC187-COMMAREA-REC)                       25880000
258900              LENGTH   (PC-COMMAREA-LENGTH)                       25890000
259000              RESP     (PV-CICS-RESPONSE)                         25900000
259100     END-EXEC.                                                    25910000
259200                                                                  25920000
259300     EVALUATE TRUE                                                25930000
259400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 25940000
259500              IF  PC187-CRA-SUCCESSFUL                            25950000
259600                  CONTINUE                                        25960000
259700              ELSE                                                25970000
259800                  SET PS-DONE-PROCESSING          TO TRUE         25980000
259900                  MOVE SQLCODE              TO PV-SQLCODE         25990000
260000                  STRING ' PCKRF864 - '        DELIMITED BY SIZE  26000000
260100                         '7250-LINK-PCKCS721 ' DELIMITED BY SIZE  26010000
260200                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  26020000
260300                         PC187-CRA-RET-MSG     DELIMITED BY SIZE  26030000
260400                         '  PARA-'             DELIMITED BY SIZE  26040000
260500                         PC187-CRA-REQ-ID      DELIMITED BY SIZE  26050000
260600                                          INTO PV-CICS-MSG-AREA   26060000
260700                  MOVE LENGTH OF PV-CICS-MSG-AREA                 26070000
260800                                            TO PC-COMMAREA-LENGTH 26080000
260801*                                                                 26080101
260802*** DMH 12/7/12 - BEGIN                                           26080201
260803                  SET  PC046-DATABASE-BUSY  TO  TRUE              26080302
260810                  MOVE 4                 TO PV-ERROR-NBR          26081010
260811                                            PC033-ERROR-NBR       26081106
260812                                            PC033-PGM-MSG-NBR     26081209
260813***               SET PC033-ABEND        TO TRUE                  26081309
260820                  SET PS-UPDATE-ROLLBACK TO TRUE                  26082001
260830                  PERFORM 9903-WRITE-CICS-LOG                     26083001
260831                  PERFORM 9005-ROLLBACK                           26083103
260832                  PERFORM 8210-XCTL-ERROR-SCREEN                  26083203
260833***           PERFORM 9000-SOFT-ABORT                             26083303
260834*** DMH 12/7/12 - END                                             26083401
260835*                                                                 26083501
260900              END-IF                                              26090000
261000         WHEN OTHER                                               26100000
261100              SET PS-DONE-PROCESSING          TO TRUE             26110000
261200              MOVE SQLCODE              TO PV-SQLCODE             26120000
261300              STRING ' PCKRF864 (OTHER) -' DELIMITED BY SIZE      26130000
261400                     '7250-LINK-PCKCS721 ' DELIMITED BY SIZE      26140000
261500                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      26150000
261600                     PC187-CRA-RET-MSG     DELIMITED BY SIZE      26160000
261700                     '  PARA-'             DELIMITED BY SIZE      26170000
261800                     PC187-CRA-REQ-ID      DELIMITED BY SIZE      26180000
261900                                      INTO PV-CICS-MSG-AREA       26190000
262000              MOVE LENGTH OF PV-CICS-MSG-AREA                     26200000
262100                                        TO PC-COMMAREA-LENGTH     26210000
262110*                                                                 26211001
262120*** DMH 12/7/12 - BEGIN                                           26212001
262121                  SET  PC046-DATABASE-BUSY  TO  TRUE              26212102
262130                  MOVE 8              TO PV-ERROR-NBR             26213001
262140                  SET PS-UPDATE-ROLLBACK TO TRUE                  26214001
262150                  PERFORM 9903-WRITE-CICS-LOG                     26215001
262160*** DMH 12/7/12 - END                                             26216001
262170*                                                                 26217001
262200     END-EVALUATE.                                                26220000
262300*                                                                 26230000
262400*                                                                 26240000
262500 8000-SEND-MAP.                                                   26250000
262600     EXEC CICS                                                    26260000
262700         SEND MAP       ('PC864A')                                26270000
262800              MAPSET    ('PCKM864')                               26280000
262900              ERASE                                               26290000
263000              CURSOR                                              26300000
263100              RESP      (PV-CICS-RESPONSE)                        26310000
263200     END-EXEC.                                                    26320000
263300                                                                  26330000
263400     EVALUATE TRUE                                                26340000
263500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 26350000
263600             CONTINUE                                             26360000
263700         WHEN OTHER                                               26370000
263800             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         26380000
263900             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  26390000
264000             SET DP013-CICS-ABEND      TO TRUE                    26400000
264100             SET DP013-NO-ROLLBACK     TO TRUE                    26410000
264200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               26420000
264300     END-EVALUATE.                                                26430000
264400*                                                                 26440000
264500*                                                                 26450000
264600 8010-SEND-DATA-ONLY.                                             26460000
264700     EXEC CICS                                                    26470000
264800         SEND MAP       ('PC864A')                                26480000
264900              MAPSET    ('PCKM864')                               26490000
265000              CURSOR                                              26500000
265100              DATAONLY                                            26510000
265200              RESP      (PV-CICS-RESPONSE)                        26520000
265300     END-EXEC.                                                    26530000
265400                                                                  26540000
265500     EVALUATE TRUE                                                26550000
265600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 26560000
265700             CONTINUE                                             26570000
265800         WHEN OTHER                                               26580000
265900             MOVE '8010-SEND-DATA-ONLY' TO DP013-PARAGRAPH        26590000
266000             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 26600000
266100             SET DP013-CICS-ABEND       TO TRUE                   26610000
266200             SET DP013-NO-ROLLBACK      TO TRUE                   26620000
266300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               26630000
266400     END-EVALUATE.                                                26640000
266500*                                                                 26650000
266600*                                                                 26660000
266700 8020-RECEIVE-MAP.                                                26670000
266800     EXEC CICS                                                    26680000
266900         RECEIVE MAP    ('PC864A')                                26690000
267000                 MAPSET ('PCKM864')                               26700000
267100                 RESP   (PV-CICS-RESPONSE)                        26710000
267200     END-EXEC.                                                    26720000
267300                                                                  26730000
267400     EVALUATE TRUE                                                26740000
267500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 26750000
267600             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   26760000
267700         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                26770000
267800             CONTINUE                                             26780000
267900         WHEN OTHER                                               26790000
268000            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       26800000
268100            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)26810000
268200            SET DP013-LOGIC-ABEND        TO TRUE                  26820000
268300            SET DP013-NO-ROLLBACK        TO TRUE                  26830000
268400            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                26840000
268500     END-EVALUATE.                                                26850000
268600*                                                                 26860000
268700*                                                                 26870000
268800 8100-RETURN-TRANID.                                              26880000
268900     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             26890000
269000     EXEC CICS                                                    26900000
269100         RETURN TRANSID  (PC-TRANID)                              26910000
269200                COMMAREA (CA-COMMAREA)                            26920000
269300                LENGTH   (PC-COMMAREA-LENGTH)                     26930000
269400                RESP     (PV-CICS-RESPONSE)                       26940000
269500     END-EXEC.                                                    26950000
269600                                                                  26960000
269700     EVALUATE TRUE                                                26970000
269800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 26980000
269900             CONTINUE                                             26990000
270000         WHEN OTHER                                               27000000
270100             MOVE '8100-RETURN-TRANID'  TO DP013-PARAGRAPH        27010000
270200             MOVE 'UNABLE TO RETURN TO TRANID'                    27020000
270300                 TO DP013-MESSAGE-TEXT (1)                        27030000
270400             SET DP013-CICS-ABEND       TO TRUE                   27040000
270500             SET DP013-NO-ROLLBACK      TO TRUE                   27050000
270600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27060000
270700     END-EVALUATE.                                                27070000
270800*                                                                 27080000
270900*                                                                 27090000
271000 8110-RETURN.                                                     27100000
271100     EXEC CICS                                                    27110000
271200         SEND FROM (PV-MESSAGE-AREA)                              27120000
271300              LENGTH (19)                                         27130000
271400              ERASE                                               27140000
271500     END-EXEC.                                                    27150000
271600                                                                  27160000
271700     EXEC CICS                                                    27170000
271800         RETURN                                                   27180000
271900     END-EXEC.                                                    27190000
272000*                                                                 27200000
272100*                                                                 27210000
272200 8210-XCTL-ERROR-SCREEN.                                          27220000
272300     IF NOT PC033-ABEND                                           27230000
272400         SET PC033-INITIALIZE-SCREEN  TO TRUE                     27240000
272500     END-IF                                                       27250000
272600     MOVE DFHEIBLK                    TO PC033-DFHEIBLK.          27260000
272700     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      27270000
272800     MOVE LENGTH OF CA-COMMAREA       TO PC-COMMAREA-LENGTH       27280000
272900     MOVE 'PCKRF852'                  TO PV-TRANSFER-PROGRAM      27290000
273000     IF PC033-PGM-MSG-NBR = ZERO                                  27300000
273100         MOVE 3                       TO PC033-PGM-MSG-NBR        27310000
273200     END-IF                                                       27320000
273300                                                                  27330000
273400     EXEC CICS                                                    27340000
273500         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    27350000
273600               COMMAREA  (CA-COMMAREA)                            27360000
273700               LENGTH    (PC-COMMAREA-LENGTH)                     27370000
273800               RESP      (PV-CICS-RESPONSE)                       27380000
273900     END-EXEC.                                                    27390000
274000                                                                  27400000
274100     EVALUATE TRUE                                                27410000
274200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 27420000
274300             CONTINUE                                             27430000
274400         WHEN OTHER                                               27440000
274500             MOVE '8210-XCTL-ERROR-SCREEN'                        27450000
274600                                      TO DP013-PARAGRAPH          27460000
274700             MOVE 'PCKRF864 - UNABLE TO XCTL TO PROGRAM: '        27470000
274800                                      TO DP013-MESSAGE-TEXT (1)   27480000
274900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   27490000
275000             SET DP013-CICS-ABEND                                 27500000
275100                 DP013-ROLLBACK       TO TRUE                     27510000
275200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27520000
275300             MOVE PC-TRANS-UNAVAILABLE-MSG                        27530000
275400                                      TO AMSGLNO                  27540000
275500             SET PC033-PROCESS-SCREEN TO TRUE                     27550000
275600             MOVE -1                  TO ACARTNL                  27560000
275700             PERFORM 8000-SEND-MAP                                27570000
275800             PERFORM 8100-RETURN-TRANID                           27580000
275900     END-EVALUATE.                                                27590000
276000*                                                                 27600000
276100*                                                                 27610000
276200 8220-XCTL-TO-HELP.                                               27620000
276300     MOVE LENGTH OF PC192-COMMAREA    TO PC-COMMAREA-LENGTH       27630000
276400                                                                  27640000
276500     EXEC CICS                                                    27650000
276600         XCTL                                                     27660000
276700             PROGRAM   (PV-TRANSFER-PROGRAM)                      27670000
276800             COMMAREA  (PC192-COMMAREA)                           27680000
276900             LENGTH    (PC-COMMAREA-LENGTH)                       27690000
277000             RESP      (PV-CICS-RESPONSE)                         27700000
277100     END-EXEC.                                                    27710000
277200                                                                  27720000
277300     EVALUATE TRUE                                                27730000
277400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 27740000
277500              CONTINUE                                            27750000
277600         WHEN OTHER                                               27760000
277700             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          27770000
277800             MOVE 'PCKRF864 - UNABLE TO XCTL TO PROGRAM: '        27780000
277900                                      TO DP013-MESSAGE-TEXT (1)   27790000
278000             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   27800000
278100             SET DP013-CICS-ABEND                                 27810000
278200                 DP013-ROLLBACK       TO TRUE                     27820000
278300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27830000
278400             MOVE PC-TRANS-UNAVAILABLE-MSG                        27840000
278500                                      TO AMSGLNO                  27850000
278600             SET PC033-PROCESS-SCREEN TO TRUE                     27860000
278700             MOVE -1                  TO ACARTNL                  27870000
278800             PERFORM 8000-SEND-MAP                                27880000
278900             PERFORM 8100-RETURN-TRANID                           27890000
279000     END-EVALUATE.                                                27900000
279100*                                                                 27910000
279200****************************************************************  27920000
279300*    RETRIEVE THE CURRENT TIMESTAMP TO USE WHEN UPDATING ROWS. *  27930000
279400*                                                              *  27940000
279500****************************************************************  27950000
279600                                                                  27960000
279700 8400-GET-TIMESTAMP.                                              27970000
279800                                                                  27980000
279900     EXEC SQL                                                     27990000
280000                                                                  28000000
280100         SET :PV-CURRENT-TIMESTAMP  = CURRENT TIMESTAMP           28010000
280200                                                                  28020000
280300     END-EXEC.                                                    28030000
280400                                                                  28040000
280500     EVALUATE SQLCODE                                             28050000
280600         WHEN 0                                                   28060000
280700              CONTINUE                                            28070000
280800         WHEN OTHER                                               28080000
280900             MOVE '8400-GET-TIMESTAMP' TO DP013-PARAGRAPH         28090000
281000             MOVE 'UNABLE TO GET TIMESTAMP'                       28100000
281100                   TO DP013-MESSAGE-TEXT (1)                      28110000
281200             SET DP013-CICS-ABEND       TO TRUE                   28120000
281300             SET DP013-NO-ROLLBACK      TO TRUE                   28130000
281400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               28140000
281500     END-EVALUATE.                                                28150000
281600                                                                  28160000
281700 9000-SOFT-ABORT.                                                 28170000
281800                                                                  28180000
281900     EXEC CICS                                                    28190000
282000         SYNCPOINT ROLLBACK                                       28200000
282100     END-EXEC                                                     28210000
282200                                                                  28220000
282300     MOVE 4                           TO PC033-PGM-MSG-NBR        28230000
282400     MOVE SQLCODE                     TO PC033-SQLCODE            28240000
282500     PERFORM 4000-XCTL-TO-SELECTED-PROGRAM.                       28250000
282600*                                                                 28260000
282610 9005-ROLLBACK.                                                   28261003
282620                                                                  28262003
282630     EXEC CICS                                                    28263003
282640         SYNCPOINT ROLLBACK                                       28264003
282650     END-EXEC.                                                    28265004
282660                                                                  28266003
282700 9010-COMMIT-POINT.                                               28270000
282800                                                                  28280000
282900     EXEC CICS                                                    28290000
283000         SYNCPOINT                                                28300000
283100     END-EXEC.                                                    28310000
283200*                                                                 28320000
283300 9903-WRITE-CICS-LOG.                                             28330000
283400                                                                  28340000
283500     MOVE SQLCODE                     TO PV-SQLCODE               28350000
283600     MOVE PC033-CARTON                TO PV-DISPLAY-SML           28360000
283700                                                                  28370000
283800     EXEC CICS                                                    28380000
283900         WRITEQ TD                                                28390000
284000             QUEUE  ('CSSL')                                      28400000
284100             FROM   (PV-LOG-MSG)                                  28410000
284200             RESP   (PV-CICS-RESPONSE)                            28420000
284300     END-EXEC.                                                    28430000
284400*                                                                 28440000
284500                                                                  28450000
284600 9904-WRITE-CRTN-MODULE-MSG.                                      28460000
284700                                                                  28470000
284800                                                                  28480000
284900     MOVE '3000'                      TO  PV-CTN-PARA             28490000
285000     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          28500000
285100     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           28510000
285200     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        28520000
285300     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      28530000
285400     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             28540000
285500     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        28550000
285600     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      28560000
285700                                                                  28570000
285800     EXEC CICS                                                    28580000
285900         WRITEQ TD                                                28590000
286000             QUEUE  ('CSSL')                                      28600000
286100             FROM   (PV-CARTON-MSG)                               28610000
286200             RESP   (PV-CICS-RESPONSE)                            28620000
286300     END-EXEC.                                                    28630000
286400                                                                  28640000
286500     EXEC CICS                                                    28650000
286600         WRITEQ TD                                                28660000
286700             QUEUE  ('CSSL')                                      28670000
286800             FROM   (PC046-CRA-RET-MSG)                           28680000
286900             RESP   (PV-CICS-RESPONSE)                            28690000
287000     END-EXEC.                                                    28700000
287100                                                                  28710000
287200 999A-WRITE-CSSL-MSG.                                             28720000
287300     MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH.      28730000
287400                                                                  28740000
287500     EXEC CICS                                                    28750000
287600         WRITEQ TD                                                28760000
287700             QUEUE  ('CSSL')                                      28770000
287800             FROM   (PV-CICS-MSG-AREA2)                           28780000
287900           LENGTH   (PV-COMMAREA-LENGTH)                          28790000
288000             RESP   (PV-CICS-RESPONSE)                            28800000
288100     END-EXEC.                                                    28810000
288200                                                                  28820000
288300*                                                                 28830000
288400 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  28840000
288500     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              28850000
288600     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             28860000
288700     INITIALIZE DP013-SRC-TASK-NUMBER                             28870000
288800                DP013-STACK.                                      28880000
288900     SET DP013-LINK-RETURN TO TRUE.                               28890000
289000                                                                  28900000
289100     EXEC CICS                                                    28910000
289200         LINK                                                     28920000
289300             PROGRAM   (DP013-NAME)                               28930000
289400             COMMAREA  (DP013-PARAMETERS)                         28940000
289500             LENGTH    (DP013-LENGTH)                             28950000
289600     END-EXEC.                                                    28960000
289700                                                                  28970000
289800* ABEND PROCESSOR MODULE                                          28980000
289900     COPY DPPD014.                                                28990000
