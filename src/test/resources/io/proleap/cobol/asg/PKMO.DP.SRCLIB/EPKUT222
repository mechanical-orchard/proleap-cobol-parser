000100*------------------------------------------------------------     00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*------------------------------------------------------------     00030000
000400 PROGRAM-ID.    EPKUT222.                                         00040001
000500 AUTHOR.        MEDHA CHOUDHURY.                                  00050000
000600 DATE-WRITTEN.  APR 21, 2009.                                     00060001
000700                                                                  00070000
000800*-------------------------------------------------------------*   00080001
000900*    MERCHANDISE HIERARCHY DELETE TRIGGER CHECK               *   00090001
001000*-------------------------------------------------------------*   00100001
001100*    THIS PROGRAM WILL READ IN THE DELETE TRIGGER FILE        *   00110001
001200*    AND CHECK IF THE KEYS ARE DELETED BEFORE SENDING IT      *   00120001
001300*    TO THE STORES.                                           *   00130001
001400*    POS 2009 FALL - PRICING INFRASTRUCTURE PROJECT WR# 35484 *   00140000
001500*                                                             *   00150000
001600*-------------------------------------------------------------*   00160001
001700*  INPUT:                                                     *   00170000
001800*        DEPT-FILE                        EPRD224             *   00180000
001900*        MAJ-CL-FILE                      EPRD226             *   00190000
002000*        SUB-CL-FILE                      EPRD227             *   00200000
002100*        VND-STYLE-FILE                   EPRD228             *   00210000
002200*                                                             *   00220000
002300*  OUTPUT:                                                    *   00230000
002400*        DEPT-FILE                        EPRD224             *   00240001
002500*        MAJ-CL-FILE                      EPRD226             *   00250001
002600*        SUB-CL-FILE                      EPRD227             *   00260001
002700*        VND-STYLE-FILE                   EPRD228             *   00270001
002800*-------------------------------------------------------------*   00280000
002900* HISTORY LOG:                                                *   00290000
003000*                                                             *   00300000
003100*-------------------------------------------------------------*   00310000
003200* DATE: APR 21 2009                                           *   00320001
003300* WR/IR#: WR #35484                                           *   00330000
003400* PROGRAMMER: MEDHA CHOUDHURY                                 *   00340000
003500* DESCRIPTION: INITIAL PROGRAM CREATION                       *   00350000
003600*-------------------------------------------------------------*   00360000
003700* DATE:                                                       *   00370000
003800* WR/IR#:                                                     *   00380000
003900* PROGRAMMER:                                                 *   00390000
004000* DESCRIPTION:                                                *   00400000
004100*                                                             *   00410000
004200*-------------------------------------------------------------*   00420000
004300 ENVIRONMENT DIVISION.                                            00430000
004400*-------------------------------------------------------------*   00440000
004500 CONFIGURATION SECTION.                                           00450000
004600 SOURCE-COMPUTER. IBM-3090.                                       00460000
004700 OBJECT-COMPUTER. IBM-3090.                                       00470000
004800                                                                  00480000
004900 INPUT-OUTPUT SECTION.                                            00490000
005000                                                                  00500000
005100 FILE-CONTROL.                                                    00510000
005200*  INPUT:                                                     *   00520000
005300           SELECT DEPT-FILE-INP                                   00530001
005400             ASSIGN TO INP01.                                     00540000
005500                                                                  00550000
005600           SELECT MAJ-CL-FILE-INP                                 00560001
005700             ASSIGN TO INP02.                                     00570000
005800                                                                  00580000
005900           SELECT SUB-CL-FILE-INP                                 00590001
006000             ASSIGN TO INP03.                                     00600000
006100                                                                  00610000
006200           SELECT VND-STYLE-FILE-INP                              00620001
006300             ASSIGN TO INP04.                                     00630000
006400                                                                  00640000
006500*  OUTOUT:                                                    *   00650000
006600                                                                  00660000
006700           SELECT DEPT-FILE-OUT                                   00670001
006800             ASSIGN TO OUT01.                                     00680001
006900                                                                  00690001
007000           SELECT MAJ-CL-FILE-OUT                                 00700001
007100             ASSIGN TO OUT02.                                     00710001
007200                                                                  00720001
007300           SELECT SUB-CL-FILE-OUT                                 00730001
007400             ASSIGN TO OUT03.                                     00740001
007500                                                                  00750001
007600           SELECT VND-STYLE-FILE-OUT                              00760001
007700             ASSIGN TO OUT04.                                     00770001
007800                                                                  00780001
007900*-------------------------------------------------------------*   00790000
008000 DATA DIVISION.                                                   00800000
008100*----------------------------------------------------------       00810000
008200 FILE SECTION.                                                    00820000
008300                                                                  00830000
008400 FD  DEPT-FILE-INP                                                00840001
008500     RECORDING MODE IS F                                          00850000
008600     LABEL RECORDS ARE STANDARD                                   00860000
008700     RECORD CONTAINS 120 CHARACTERS                               00870000
008800     BLOCK CONTAINS 0 RECORDS                                     00880000
008900     DATA RECORD IS DEPT-RECORD-IN.                               00890001
009000                                                                  00900000
009100 01  DEPT-RECORD-IN          PIC X(120).                          00910001
009200                                                                  00920000
009300 FD  MAJ-CL-FILE-INP                                              00930001
009400     RECORDING MODE IS F                                          00940000
009500     LABEL RECORDS ARE STANDARD                                   00950000
009600     RECORD CONTAINS 50 CHARACTERS                                00960000
009700     BLOCK CONTAINS 0 RECORDS                                     00970000
009800     DATA RECORD IS MAJ-CL-RECORD-IN.                             00980001
009900                                                                  00990000
010000 01  MAJ-CL-RECORD-IN        PIC X(50).                           01000001
010100                                                                  01010000
010200 FD  SUB-CL-FILE-INP                                              01020001
010300     RECORDING MODE IS F                                          01030000
010400     LABEL RECORDS ARE STANDARD                                   01040000
010500     RECORD CONTAINS 85 CHARACTERS                                01050000
010600     BLOCK CONTAINS 0 RECORDS                                     01060000
010700     DATA RECORD IS SUB-CL-RECORD-IN.                             01070001
010800                                                                  01080000
010900 01  SUB-CL-RECORD-IN        PIC X(85).                           01090001
011000                                                                  01100000
011100 FD  VND-STYLE-FILE-INP                                           01110001
011200     RECORDING MODE IS F                                          01120000
011300     LABEL RECORDS ARE STANDARD                                   01130000
011400     RECORD CONTAINS 185 CHARACTERS                               01140000
011500     BLOCK CONTAINS 0 RECORDS                                     01150000
011600     DATA RECORD IS VND-STYLE-RECORD-IN.                          01160001
011700                                                                  01170000
011800 01  VND-STYLE-RECORD-IN     PIC X(185).                          01180001
011900                                                                  01190000
012000***  OUTPUT                                                       01200001
012100                                                                  01210001
012200 FD  DEPT-FILE-OUT                                                01220001
012300     RECORDING MODE IS F                                          01230001
012400     LABEL RECORDS ARE STANDARD                                   01240001
012500     RECORD CONTAINS 120 CHARACTERS                               01250001
012600     BLOCK CONTAINS 0 RECORDS                                     01260001
012700     DATA RECORD IS DEPT-RECORD-OUT.                              01270001
012800                                                                  01280001
012900 01  DEPT-RECORD-OUT         PIC X(120).                          01290001
013000                                                                  01300001
013100 FD  MAJ-CL-FILE-OUT                                              01310001
013200     RECORDING MODE IS F                                          01320001
013300     LABEL RECORDS ARE STANDARD                                   01330001
013400     RECORD CONTAINS 50 CHARACTERS                                01340001
013500     BLOCK CONTAINS 0 RECORDS                                     01350001
013600     DATA RECORD IS MAJ-CL-RECORD-OUT.                            01360001
013700                                                                  01370001
013800 01  MAJ-CL-RECORD-OUT       PIC X(50).                           01380001
013900                                                                  01390001
014000 FD  SUB-CL-FILE-OUT                                              01400001
014100     RECORDING MODE IS F                                          01410001
014200     LABEL RECORDS ARE STANDARD                                   01420001
014300     RECORD CONTAINS 85 CHARACTERS                                01430001
014400     BLOCK CONTAINS 0 RECORDS                                     01440001
014500     DATA RECORD IS SUB-CL-RECORD-OUT.                            01450001
014600                                                                  01460001
014700 01  SUB-CL-RECORD-OUT       PIC X(85).                           01470001
014800                                                                  01480001
014900 FD  VND-STYLE-FILE-OUT                                           01490001
015000     RECORDING MODE IS F                                          01500001
015100     LABEL RECORDS ARE STANDARD                                   01510001
015200     RECORD CONTAINS 185 CHARACTERS                               01520001
015300     BLOCK CONTAINS 0 RECORDS                                     01530001
015400     DATA RECORD IS VND-STYLE-RECORD-OUT.                         01540001
015500                                                                  01550001
015600 01  VND-STYLE-RECORD-OUT    PIC X(185).                          01560001
015700                                                                  01570001
015800*----------------------------------------------------------       01580001
015900 WORKING-STORAGE SECTION.                                         01590000
016000                                                                  01600000
016100 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01610000
016200                                                  COMP SYNC.      01620000
016400     88  AC-DB2-ERROR                             VALUE +4013.    01640000
016800*----------------------------------------------------------       01680000
016900* PC- PROGRAM CONSTANTS                                           01690000
017000*----------------------------------------------------------       01700000
017100 01  PC-PROGRAM-CONSTANTS.                                        01710000
017200     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'EPKUT222'. 01720001
019200*----------------------------------------------------------       01920000
019300* PV- PROGRAM VARIABLES                                           01930000
019400*----------------------------------------------------------       01940000
019500 01  PV-PROGRAM-STATUS.                                           01950000
019600     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     01960000
019700     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACES.     01970000
019800     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACES.     01980000
019900     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      01990000
020100*                                                                 02010000
020200 01  PV-PROGRAM-VARIABLES.                                        02020000
020610     05  PV-DPT-NBR                PIC S9(4)V VALUE +0 COMP-3.    02061007
020620     05  PV-MAJ-CL-NBR             PIC S9(4)V VALUE +0 COMP-3.    02062007
020630     05  PV-SUB-CL-NBR             PIC S9(4)V VALUE +0 COMP-3.    02063007
020640     05  PV-STYLE-ID               PIC S9(8)V VALUE +0 COMP-3.    02064007
020641                                                                  02064106
020650     05  PV-DB2-FIELDS.                                           02065006
020660         10  PV-DB2-DEPT-NBR       PIC S9(4)V VALUE +0 COMP-3.    02066006
020670         10  PV-DB2-MAJ-CL-NBR     PIC S9(4)V VALUE +0 COMP-3.    02067006
020680         10  PV-DB2-SUB-CL-NBR     PIC S9(4)V VALUE +0 COMP-3.    02068006
020690         10  PV-DB2-STYL-ID        PIC S9(8)V VALUE +0 COMP-3.    02069006
020691                                                                  02069106
020700*----------------------------------------------------------       02070000
020800* PV- PROGRAM COUNT VARIABLES                                     02080000
020900*----------------------------------------------------------       02090000
021000 01  PV-PROGRAM-COUNTERS.                                         02100000
021100     05  PV-DEPT-REC-READ             PIC 9(09) VALUE 0.          02110000
021200     05  PV-MJCL-REC-READ             PIC 9(09) VALUE 0.          02120000
021300     05  PV-SBCL-REC-READ             PIC 9(09) VALUE 0.          02130000
021400     05  PV-VSTY-REC-READ             PIC 9(09) VALUE 0.          02140000
021600     05  PV-DEPT-REC-WRITEN           PIC 9(09) VALUE 0.          02160001
021700     05  PV-MJCL-REC-WRITEN           PIC 9(09) VALUE 0.          02170001
021800     05  PV-SBCL-REC-WRITEN           PIC 9(09) VALUE 0.          02180001
021900     05  PV-VSTY-REC-WRITEN           PIC 9(09) VALUE 0.          02190001
022000                                                                  02200000
022100*----------------------------------------------------------------*02210000
022200* PS- PROGRAM SWITCHES                                           *02220000
022300*----------------------------------------------------------------*02230000
022400 01  PS-PROGRAM-SWITCHES.                                         02240000
022500     05  PS-END-OF-DEPT-SW            PIC  X(01) VALUE 'N'.       02250000
022600         88  PS-END-OF-DEPT-FILE                 VALUE 'Y'.       02260000
022700         88  PS-NOT-END-DEPT-FILE                VALUE 'N'.       02270000
022800     05  PS-END-OF-MAJ-CL-SW          PIC  X(01) VALUE 'N'.       02280000
022900         88  PS-END-OF-MAJ-CL-FILE               VALUE 'Y'.       02290000
023000         88  PS-NOT-END-MAJ-CL-FILE              VALUE 'N'.       02300000
023100     05  PS-END-OF-SUB-CL-SW          PIC  X(01) VALUE 'N'.       02310000
023200         88  PS-END-OF-SUB-CL-FILE               VALUE 'Y'.       02320000
023300         88  PS-NOT-END-SUB-CL-FILE              VALUE 'N'.       02330000
023400     05  PS-END-OF-VND-ST-SW          PIC  X(01) VALUE 'N'.       02340000
023500         88  PS-END-OF-VND-ST-FILE               VALUE 'Y'.       02350000
023600         88  PS-NOT-END-VND-ST-FILE              VALUE 'N'.       02360000
023700*                                                                 02370001
023800     05  PS-END-OF-PROCES-SW          PIC  X(01) VALUE 'N'.       02380000
023900         88  PS-END-OF-PROCESSING                VALUE 'Y'.       02390000
024000         88  PS-NOT-END-OF-PROCESSING            VALUE 'N'.       02400000
024110*                                                                 02411013
024120     05  PS-DEPT-FOUND-SW             PIC  X(01) VALUE 'N'.       02412013
024130         88  PS-DEPT-FOUND                       VALUE 'Y'.       02413013
024140         88  PS-DEPT-NOT-FOUND                   VALUE 'N'.       02414013
024141     05  PS-MJCL-FOUND-SW             PIC  X(01) VALUE 'N'.       02414113
024142         88  PS-MJCL-FOUND                       VALUE 'Y'.       02414213
024143         88  PS-MJCL-NOT-FOUND                   VALUE 'N'.       02414313
024144     05  PS-SBCL-FOUND-SW             PIC  X(01) VALUE 'N'.       02414413
024145         88  PS-SBCL-FOUND                       VALUE 'Y'.       02414513
024146         88  PS-SBCL-NOT-FOUND                   VALUE 'N'.       02414613
024147     05  PS-STYL-FOUND-SW             PIC  X(01) VALUE 'N'.       02414713
024148         88  PS-STYL-FOUND                       VALUE 'Y'.       02414813
024149         88  PS-STYL-NOT-FOUND                   VALUE 'N'.       02414913
024150                                                                  02415013
024200*----------------------------------------------------------       02420000
024300* COPYBOOK  EPRD224 LAYOUT (READ DEPARTMENT FILE)                 02430000
024400*----------------------------------------------------------       02440000
024500     COPY EPRD224.                                                02450000
024600                                                                  02460000
024700*----------------------------------------------------------       02470000
024800* COPYBOOK  EPRD226 LAYOUT (READ MAJOR CLASS FILE)                02480000
024900*----------------------------------------------------------       02490000
025000     COPY EPRD226.                                                02500000
025100                                                                  02510000
025200*----------------------------------------------------------       02520000
025300* COPYBOOK  EPRD227 LAYOUT (READ SUB CLASS FILE)                  02530000
025400*----------------------------------------------------------       02540000
025500     COPY EPRD227.                                                02550000
025600                                                                  02560000
025700*----------------------------------------------------------       02570000
025800* COPYBOOK  EPRD228 LAYOUT (READ VENDOR STYLE FILE)               02580000
025900*----------------------------------------------------------       02590000
026000     COPY EPRD228.                                                02600000
026100                                                                  02610000
026200*------------------------------------------------------------     02620000
026300* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         02630000
026400*------------------------------------------------------------     02640000
026500     COPY DPWS004.                                                02650000
026600                                                                  02660000
026700*-----------------------------------------------------------      02670000
026800* DB2 MESSAGE AREA                                                02680000
026900*-----------------------------------------------------------      02690000
027000     COPY SQLCA2.                                                 02700000
027100                                                                  02710000
027200*-----------------------------------------------------------      02720000
027300* DB2 COMMUNICATIONS AREA                                         02730000
027400*-----------------------------------------------------------      02740000
027500     EXEC SQL                                                     02750000
027600          INCLUDE SQLCA                                           02760000
027700     END-EXEC.                                                    02770000
027800                                                                  02780000
027900*--------------------------------------------------------------*  02790001
028000* DB2 TABLE XST00013 (XST_VND_STYL) - VENDOR                      02800001
028100*--------------------------------------------------------------*  02810001
028200     EXEC SQL                                                     02820001
028300       INCLUDE XST00013                                           02830001
028400     END-EXEC.                                                    02840001
028500                                                                  02850001
028600*--------------------------------------------------------------*  02860001
028700* DB2 TABLE XST00014 (XST_SUB_CL) - SUB CLASS                     02870001
028800*--------------------------------------------------------------*  02880001
028900     EXEC SQL                                                     02890001
029000       INCLUDE XST00014                                           02900001
029100     END-EXEC.                                                    02910001
029200                                                                  02920001
029300*--------------------------------------------------------------*  02930001
029400* DB2 TABLE XST00015 (XST_DEPT) - DEPARTMENT                      02940001
029500*--------------------------------------------------------------*  02950001
029600     EXEC SQL                                                     02960001
029700       INCLUDE XST00015                                           02970001
029800     END-EXEC.                                                    02980001
029900                                                                  02990001
030000*--------------------------------------------------------------*  03000001
030100* DB2 TABLE XST00071 (XST_MAJ_CL) - MAJOR CLASS                   03010001
030200*--------------------------------------------------------------*  03020001
030300     EXEC SQL                                                     03030001
030400       INCLUDE XST00071                                           03040001
030500     END-EXEC.                                                    03050001
030600                                                                  03060001
030700                                                                  03070000
030800*----------------------------------------------------------       03080000
030900 PROCEDURE DIVISION.                                              03090000
031000*----------------------------------------------------------       03100000
031100 0000-MAINLINE.                                                   03110000
031200                                                                  03120000
031300     PERFORM 1000-INITIALIZATION.                                 03130000
031400                                                                  03140000
031500     PERFORM 2000-PROCESS-MERCH-HIER                              03150000
031600             UNTIL PS-END-OF-PROCESSING.                          03160000
031700                                                                  03170000
031800     PERFORM 9200-WRAPUP.                                         03180000
031900                                                                  03190000
032000     GOBACK.                                                      03200000
032100                                                                  03210000
032200*0000-EXIT.                                                       03220000
032500*----------------------------------------------------------       03250000
032600* 1000-INITIALIZATION.                                            03260000
032700*     INITIALIZES VARIABLES, OPENS ANY FILES, AND READS           03270000
032800*     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT      03280000
032900*     FILES.                                                      03290000
033000*----------------------------------------------------------       03300000
033100 1000-INITIALIZATION.                                             03310000
033200                                                                  03320000
033300     DISPLAY '****************************************'.          03330000
033400     DISPLAY '**          EPKUT222 STARTED          **'.          03340001
033500     DISPLAY '****************************************'.          03350000
033600                                                                  03360000
033700     INITIALIZE PV-PROGRAM-VARIABLES.                             03370000
033800     INITIALIZE PS-PROGRAM-SWITCHES.                              03380000
033900                                                                  03390000
034000     SET PS-NOT-END-DEPT-FILE      TO TRUE.                       03400000
034100     SET PS-NOT-END-MAJ-CL-FILE    TO TRUE.                       03410000
034200     SET PS-NOT-END-SUB-CL-FILE    TO TRUE.                       03420000
034300     SET PS-NOT-END-VND-ST-FILE    TO TRUE.                       03430000
034400                                                                  03440000
034500     PERFORM 1100-OPEN-FILES.                                     03450000
034600                                                                  03460000
034700     PERFORM 6000-READ-DEPT-FILE.                                 03470000
034800                                                                  03480000
034900     IF PS-END-OF-DEPT-FILE                                       03490000
035000        DISPLAY ' ****  DEPARTMENT FILE IS EMPTY *****'           03500000
035100     END-IF.                                                      03510000
035200                                                                  03520000
035300     PERFORM 6100-READ-MAJ-CL-FILE.                               03530000
035400                                                                  03540000
035500     IF PS-END-OF-MAJ-CL-FILE                                     03550000
035600        DISPLAY ' ****  MAJOR CLASS FILE IS EMPTY *****'          03560000
035700     END-IF.                                                      03570000
035800                                                                  03580000
035900     PERFORM 6200-READ-SUB-CL-FILE.                               03590000
036000                                                                  03600000
036100     IF PS-END-OF-SUB-CL-FILE                                     03610000
036200        DISPLAY ' ****  SUB CLASS FILE IS EMPTY *****'            03620000
036300     END-IF.                                                      03630000
036400                                                                  03640000
036500     PERFORM 6300-READ-VND-ST-FILE.                               03650000
036600                                                                  03660000
036700     IF PS-END-OF-VND-ST-FILE                                     03670000
036800        DISPLAY ' ****  VENDOR STYLE FILE IS EMPTY *****'         03680000
036900     END-IF.                                                      03690000
037000                                                                  03700000
037100     EVALUATE TRUE                                                03710001
037200         WHEN PS-END-OF-DEPT-FILE                                 03720001
037300          AND PS-END-OF-MAJ-CL-FILE                               03730001
037400          AND PS-END-OF-SUB-CL-FILE                               03740001
037500          AND PS-END-OF-VND-ST-FILE                               03750001
037600             SET PS-END-OF-PROCESSING TO TRUE                     03760001
037700         WHEN OTHER                                               03770001
037800             SET PS-NOT-END-OF-PROCESSING TO TRUE                 03780001
037900     END-EVALUATE.                                                03790001
038000                                                                  03800000
038100*1000-EXIT.                                                       03810000
038400*----------------------------------------------------------       03840000
038500* 1100-OPEN-FILES.                                                03850000
038600*     THIS PARAGRAPH OPENS ALL THE FILES IN MODE REQUIRED         03860000
038700*----------------------------------------------------------       03870000
038800 1100-OPEN-FILES.                                                 03880000
038900                                                                  03890000
039000     OPEN INPUT DEPT-FILE-INP                                     03900001
039100                MAJ-CL-FILE-INP                                   03910001
039200                SUB-CL-FILE-INP                                   03920001
039300                VND-STYLE-FILE-INP.                               03930001
039400                                                                  03940000
039500     OPEN OUTPUT DEPT-FILE-OUT                                    03950001
039600                 MAJ-CL-FILE-OUT                                  03960001
039700                 SUB-CL-FILE-OUT                                  03970001
039800                 VND-STYLE-FILE-OUT.                              03980001
039900                                                                  03990000
040000*1100-EXIT.                                                       04000000
040300*----------------------------------------------------------       04030000
040400*  2000-PROCESS-MERCH-HIER                                        04040000
040500*                                                                 04050001
040600*     1) IF THERE ARE DEPARTMENT TABLE DELETE TRIGGERS CHECK      04060001
040700*     IF THE DEPARTMENT IS REALLY DELETED                         04070001
040800*     2) FOLLOW THE SAME STEPS FOR MAJOR CLASS FILE               04080000
040900*     3) SUB-CLASS FILE                                           04090001
041000*     4) VENDOR STYLE                                             04100000
041100*----------------------------------------------------------       04110000
041200 2000-PROCESS-MERCH-HIER.                                         04120000
041300                                                                  04130000
041310     INITIALIZE PV-DPT-NBR                                        04131004
041320                PV-MAJ-CL-NBR                                     04132004
041330                PV-SUB-CL-NBR                                     04133004
041340                PV-STYLE-ID.                                      04134004
041350                                                                  04135004
041400     PERFORM 2100-CHECK-DEPT-FILE                                 04140001
041500       UNTIL PS-END-OF-DEPT-FILE.                                 04150000
041600                                                                  04160000
041700     PERFORM 2200-CHECK-MJCL-FILE                                 04170001
041800       UNTIL PS-END-OF-MAJ-CL-FILE.                               04180000
041900                                                                  04190000
042000     PERFORM 2300-CHECK-SBCL-FILE                                 04200001
042100       UNTIL PS-END-OF-SUB-CL-FILE.                               04210000
042200                                                                  04220000
042300     PERFORM 2400-CHECK-VSTY-FILE                                 04230001
042400       UNTIL PS-END-OF-VND-ST-FILE.                               04240000
042500                                                                  04250000
042600     EVALUATE TRUE                                                04260000
042700         WHEN PS-END-OF-DEPT-FILE                                 04270000
042800          AND PS-END-OF-MAJ-CL-FILE                               04280000
042900          AND PS-END-OF-SUB-CL-FILE                               04290000
043000          AND PS-END-OF-VND-ST-FILE                               04300000
043100             SET PS-END-OF-PROCESSING TO TRUE                     04310000
043200     END-EVALUATE.                                                04320000
043300                                                                  04330000
043400*2000-EXIT.                                                       04340000
043700*----------------------------------------------------------       04370001
043800*  2100-CHECK-DEPT-FILE                                           04380001
043900*   CHECK TO SEE THAT THE DELETED TRIGGER DOES NOT EXIST          04390001
044000*   IN TABLE XST_DEPT                                             04400001
044100*----------------------------------------------------------       04410001
044200 2100-CHECK-DEPT-FILE.                                            04420001
044300                                                                  04430001
044310     MOVE EP224-DPT-NBR TO PV-DPT-NBR.                            04431004
044320                                                                  04432004
044330     PERFORM 3100-GET-DEPT-FROM-DB.                               04433013
044340                                                                  04434013
045100     EVALUATE TRUE                                                04510001
045200         WHEN PS-DEPT-FOUND                                       04520013
045300            DISPLAY '---- DEPT DELETE RECORD DROPPED ----- '      04530011
045310            DISPLAY '  DEPT NO : ' EP224-DPT-NBR                  04531011
045400         WHEN PS-DEPT-NOT-FOUND                                   04540013
045500            PERFORM 4000-DPT-REC-WRITE                            04550001
045800     END-EVALUATE.                                                04580001
045900                                                                  04590001
046000     PERFORM 6000-READ-DEPT-FILE.                                 04600001
046100                                                                  04610001
046200*2100-EXIT.                                                       04620001
046400                                                                  04640001
046410*----------------------------------------------------------       04641001
046420*  2200-CHECK-MJCL-FILE                                           04642001
046430*   CHECK TO SEE THAT THE DELETED TRIGGER DOES NOT EXIST          04643001
046440*   IN TABLE XST_MAJ_CL                                           04644001
046450*----------------------------------------------------------       04645001
046460 2200-CHECK-MJCL-FILE.                                            04646001
046470                                                                  04647001
046471     MOVE EP226-DPT-NBR TO PV-DPT-NBR.                            04647104
046472     MOVE EP226-MAJ-CL-NBR  TO PV-MAJ-CL-NBR.                     04647204
046473                                                                  04647304
046474     PERFORM 3200-GET-MJCL-FROM-DB.                               04647413
046475                                                                  04647513
046500     EVALUATE TRUE                                                04650001
046501         WHEN PS-MJCL-FOUND                                       04650113
046502            DISPLAY '---- MAJOR CLASS DELETE RECORD DROPPED ----' 04650211
046503            DISPLAY ' DEPT:   ' EP226-DPT-NBR                     04650302
046504                    ' MAJ-CL: ' EP226-MAJ-CL-NBR                  04650401
046505         WHEN PS-MJCL-NOT-FOUND                                   04650513
046506            PERFORM 4100-MCL-REC-WRITE                            04650601
046509     END-EVALUATE.                                                04650901
046510                                                                  04651001
046511     PERFORM 6100-READ-MAJ-CL-FILE.                               04651101
046512                                                                  04651201
046513*2200-EXIT.                                                       04651301
046515                                                                  04651501
046516*----------------------------------------------------------       04651601
046517*  2300-CHECK-SBCL-FILE                                           04651701
046518*   CHECK TO SEE THAT THE DELETED TRIGGER DOES NOT EXIST          04651801
046519*   IN TABLE XST_SUB_CL                                           04651901
046520*----------------------------------------------------------       04652001
046521 2300-CHECK-SBCL-FILE.                                            04652101
046522                                                                  04652201
046523     MOVE EP227-DPT-NBR TO PV-DPT-NBR.                            04652304
046524     MOVE EP227-MAJ-CL-NBR  TO PV-MAJ-CL-NBR.                     04652404
046525     MOVE EP227-SUB-CL-NBR  TO PV-SUB-CL-NBR.                     04652504
046526                                                                  04652604
046527     PERFORM 3300-GET-SBCL-FROM-DB.                               04652713
046528                                                                  04652813
046543     EVALUATE TRUE                                                04654306
046544         WHEN PS-SBCL-FOUND                                       04654413
046545            DISPLAY '---- SUB CLASS DELETE RECORD DROPPED ---- '  04654511
046546            DISPLAY ' DEPT:   ' EP227-DPT-NBR                     04654606
046547                    ' MAJ-CL: ' EP227-MAJ-CL-NBR                  04654706
046548                    ' SUB-CL: ' EP227-SUB-CL-NBR                  04654806
046549         WHEN PS-SBCL-NOT-FOUND                                   04654913
046550            PERFORM 4200-SCL-REC-WRITE                            04655006
046553     END-EVALUATE.                                                04655306
046554                                                                  04655406
046555     PERFORM 6200-READ-SUB-CL-FILE.                               04655506
046556                                                                  04655606
046557*2300-EXIT.                                                       04655706
046559                                                                  04655906
046560*----------------------------------------------------------       04656006
046561*  2400-CHECK-VSTY-FILE                                           04656106
046562*   CHECK TO SEE THAT THE DELETED TRIGGER DOES NOT EXIST          04656206
046563*   IN TABLE XST_VND_STYL                                         04656306
046564*----------------------------------------------------------       04656406
046565 2400-CHECK-VSTY-FILE.                                            04656506
046566                                                                  04656606
046567     MOVE EP228-DPT-NBR     TO PV-DPT-NBR.                        04656706
046568     MOVE EP228-MAJ-CL-NBR  TO PV-MAJ-CL-NBR.                     04656806
046569     MOVE EP228-SUB-CL-NBR  TO PV-SUB-CL-NBR.                     04656906
046570     MOVE EP228-STYLE-ID    TO PV-STYLE-ID.                       04657006
046571                                                                  04657106
046572     PERFORM 3400-GET-STYL-FROM-DB.                               04657213
046573                                                                  04657313
046591     EVALUATE TRUE                                                04659106
046592         WHEN PS-STYL-FOUND                                       04659213
046593            DISPLAY '--- VENDOR STYLE DELETE RECORD DROPPED ---- '04659311
046594            DISPLAY ' DEPT:   ' EP228-DPT-NBR                     04659406
046595                    ' MAJ-CL: ' EP228-MAJ-CL-NBR                  04659506
046596                    ' SUB-CL: ' EP228-SUB-CL-NBR                  04659606
046597                    ' STYLE : ' EP228-STYLE-ID                    04659706
046598         WHEN PS-STYL-NOT-FOUND                                   04659813
046599            PERFORM 4300-VST-REC-WRITE                            04659906
046602     END-EVALUATE.                                                04660206
046603                                                                  04660306
046604     PERFORM 6300-READ-VND-ST-FILE.                               04660411
046605                                                                  04660506
046606*2400-EXIT.                                                       04660613
046607                                                                  04660706
046608*----------------------------------------------------------       04660813
046609*  3100-GET-DEPT-FROM-DB                                          04660913
046610*   SELECT THE DEPARTMENT FROM THE XST_DEPT TABLE.                04661013
046611*----------------------------------------------------------       04661113
046612 3100-GET-DEPT-FROM-DB.                                           04661213
046613                                                                  04661313
046616     EXEC SQL                                                     04661613
046617         SELECT DEPT_NBR                                          04661713
046618           INTO :PV-DB2-DEPT-NBR                                  04661813
046619           FROM XST_DEPT                                          04661913
046620          WHERE DEPT_NBR = :PV-DPT-NBR                            04662013
046621          WITH UR                                                 04662113
046622     END-EXEC.                                                    04662213
046623                                                                  04662313
046624     EVALUATE TRUE                                                04662413
046625         WHEN SQLCODE = 0                                         04662513
046626            SET PS-DEPT-FOUND TO TRUE                             04662613
046628         WHEN SQLCODE = 100                                       04662813
046629            SET PS-DEPT-NOT-FOUND TO TRUE                         04662913
046631         WHEN OTHER                                               04663113
046633              DISPLAY 'SQLCODE: ' SQLCODE                         04663314
046634              MOVE '3100-GET-DEPT-FROM-DB'                        04663414
046635                            TO  PV-PARAGRAPH-NAME                 04663514
046636              MOVE 'SELECT XS-DEPT DATA'                          04663614
046637                            TO  PV-DB2-OPERATION                  04663714
046638              SET AC-DB2-ERROR TO TRUE                            04663815
046639              PERFORM 9800-SQL-ABEND                              04663914
046640     END-EVALUATE.                                                04664013
046641                                                                  04664113
046642*3100-EXIT.                                                       04664213
046643*----------------------------------------------------------       04664313
046644*  3200-GET-MJCL-FROM-DB                                          04664413
046645*   SELECT THE DATA FROM THE XST_MAJ_CL TABLE FOR A GIVEN         04664513
046646*   DEPT AND MAJOR CLASS READ FROM THE INPUT FILE                 04664613
046647*----------------------------------------------------------       04664713
046648 3200-GET-MJCL-FROM-DB.                                           04664813
046649                                                                  04664913
046650     EXEC SQL                                                     04665013
046651         SELECT DEPT_NBR                                          04665113
046652               ,MAJ_CL_NBR                                        04665213
046653           INTO :PV-DB2-DEPT-NBR                                  04665313
046654               ,:PV-DB2-MAJ-CL-NBR                                04665413
046655           FROM XST_MAJ_CL                                        04665513
046656          WHERE DEPT_NBR = :PV-DPT-NBR                            04665613
046657            AND MAJ_CL_NBR = :PV-MAJ-CL-NBR                       04665713
046658          WITH UR                                                 04665813
046659     END-EXEC.                                                    04665913
046660                                                                  04666013
046661     EVALUATE TRUE                                                04666113
046662         WHEN SQLCODE = 0                                         04666213
046663            SET PS-MJCL-FOUND TO TRUE                             04666313
046664         WHEN SQLCODE = 100                                       04666413
046665            SET PS-MJCL-NOT-FOUND TO TRUE                         04666513
046666         WHEN OTHER                                               04666613
046667            DISPLAY 'SQLCODE: ' SQLCODE                           04666714
046668            MOVE '3200-GET-MJCL-FROM-DB'                          04666814
046669                          TO  PV-PARAGRAPH-NAME                   04666914
046670            MOVE 'SELECT XS-MAJ-CL DATA'                          04667014
046671                          TO  PV-DB2-OPERATION                    04667114
046672            SET AC-DB2-ERROR TO TRUE                              04667215
046673            PERFORM 9800-SQL-ABEND                                04667314
046674     END-EVALUATE.                                                04667413
046675                                                                  04667513
046676*3200-EXIT.                                                       04667613
046677*----------------------------------------------------------       04667713
046678*  3300-GET-SBCL-FROM-DB                                          04667813
046679*   SELECT THE DATA FROM THE XST_SUB_CL TABLE FOR A GIVEN         04667913
046680*   DEPT, MAJOR CLASS AND SUB CLASS READ FROM THE INPUT FILE      04668013
046681*----------------------------------------------------------       04668113
046682 3300-GET-SBCL-FROM-DB.                                           04668213
046683                                                                  04668313
046684     EXEC SQL                                                     04668413
046685         SELECT DEPT_NBR                                          04668513
046686               ,MAJ_CL_NBR                                        04668613
046687               ,SUB_CL_NBR                                        04668713
046688           INTO :PV-DB2-DEPT-NBR                                  04668813
046689               ,:PV-DB2-MAJ-CL-NBR                                04668913
046690               ,:PV-DB2-SUB-CL-NBR                                04669013
046691           FROM XST_SUB_CL                                        04669113
046692          WHERE DEPT_NBR = :PV-DPT-NBR                            04669213
046693            AND MAJ_CL_NBR = :PV-MAJ-CL-NBR                       04669313
046694            AND SUB_CL_NBR = :PV-SUB-CL-NBR                       04669413
046695          WITH UR                                                 04669513
046696     END-EXEC.                                                    04669613
046697                                                                  04669713
046698     EVALUATE TRUE                                                04669813
046699         WHEN SQLCODE = 0                                         04669913
046700            SET PS-SBCL-FOUND TO TRUE                             04670013
046701         WHEN SQLCODE = 100                                       04670113
046702            SET PS-SBCL-NOT-FOUND TO TRUE                         04670213
046703         WHEN OTHER                                               04670313
046704            DISPLAY 'SQLCODE: ' SQLCODE                           04670414
046705            MOVE '3300-GET-SBCL-FROM-DB'                          04670514
046706                          TO  PV-PARAGRAPH-NAME                   04670614
046707            MOVE 'SELECT XS-SUB-CL DATA'                          04670714
046708                          TO  PV-DB2-OPERATION                    04670814
046709            SET AC-DB2-ERROR TO TRUE                              04670915
046710            PERFORM 9800-SQL-ABEND                                04671014
046711     END-EVALUATE.                                                04671113
046712                                                                  04671213
046713*3300-EXIT.                                                       04671313
046714*----------------------------------------------------------       04671413
046715*  3400-GET-STYL-FROM-DB                                          04671513
046716*   SELECT THE DATA FROM THE XST_VND_STYL TABLE FOR A GIVEN       04671613
046717*   DEPT, MAJOR CLASS AND SUB CLASS READ FROM THE INPUT FILE      04671713
046718*----------------------------------------------------------       04671813
046719 3400-GET-STYL-FROM-DB.                                           04671913
046720                                                                  04672013
046721     EXEC SQL                                                     04672113
046722         SELECT STYL_ID                                           04672213
046723               ,DEPT_NBR                                          04672313
046724               ,MAJ_CL_NBR                                        04672413
046725               ,SUB_CL_NBR                                        04672513
046726           INTO :PV-DB2-STYL-ID                                   04672613
046727               ,:PV-DB2-DEPT-NBR                                  04672713
046728               ,:PV-DB2-MAJ-CL-NBR                                04672813
046729               ,:PV-DB2-SUB-CL-NBR                                04672913
046730           FROM XST_VND_STYL                                      04673013
046731          WHERE STYL_ID = :PV-STYLE-ID                            04673113
046732            AND DEPT_NBR = :PV-DPT-NBR                            04673213
046733            AND MAJ_CL_NBR = :PV-MAJ-CL-NBR                       04673313
046734            AND SUB_CL_NBR = :PV-SUB-CL-NBR                       04673413
046735          WITH UR                                                 04673513
046736     END-EXEC.                                                    04673613
046737                                                                  04673713
046738     EVALUATE TRUE                                                04673813
046739         WHEN SQLCODE = 0                                         04673913
046740            SET PS-STYL-FOUND TO TRUE                             04674013
046741         WHEN SQLCODE = 100                                       04674113
046742            SET PS-STYL-NOT-FOUND TO TRUE                         04674213
046743         WHEN OTHER                                               04674313
046744            DISPLAY 'SQLCODE: ' SQLCODE                           04674414
046745            MOVE '3400-GET-STYL-FROM-DB'                          04674514
046746                          TO  PV-PARAGRAPH-NAME                   04674614
046747            MOVE 'SELECT XS-VND-STYL DATA'                        04674714
046748                          TO  PV-DB2-OPERATION                    04674814
046749            SET AC-DB2-ERROR TO TRUE                              04674915
046750            PERFORM 9800-SQL-ABEND                                04675014
046751     END-EVALUATE.                                                04675113
046752                                                                  04675213
046753*3400-EXIT.                                                       04675313
046754*----------------------------------------------------------       04675413
046755* 4000-DPT-REC-WRITE                                              04675513
046760*     THIS PARAGRAPH WRITES THE DEPARTMENT REC TO THE             04676001
046800*     DELETE FILE                                                 04680001
046900*----------------------------------------------------------       04690000
047000 4000-DPT-REC-WRITE.                                              04700001
047100                                                                  04710000
047200     WRITE DEPT-RECORD-OUT                                        04720001
047300         FROM EP224-MH-DEPT-RECORD.                               04730001
047700                                                                  04770000
047800     ADD +1 TO PV-DEPT-REC-WRITEN.                                04780001
047900                                                                  04790000
048000*4000-EXIT.                                                       04800001
048110*----------------------------------------------------------       04811001
048120* 4100-MCL-REC-WRITE                                              04812001
048130*     THIS PARAGRAPH WRITES THE MAJOR CLASS REC TO THE            04813001
048140*     DELETE FILE                                                 04814001
048150*----------------------------------------------------------       04815001
048160 4100-MCL-REC-WRITE.                                              04816001
048170                                                                  04817001
048180     WRITE MAJ-CL-RECORD-OUT                                      04818001
048190         FROM EP226-MH-MAJ-CL-RECORD.                             04819001
048194                                                                  04819401
048195     ADD +1 TO PV-MJCL-REC-WRITEN.                                04819501
048196                                                                  04819601
048197*4100-EXIT.                                                       04819701
048199                                                                  04819901
048201*----------------------------------------------------------       04820101
048202* 4200-SCL-REC-WRITE                                              04820201
048203*     THIS PARAGRAPH WRITES THE SUB CLASS REC TO THE              04820301
048204*     DELETE FILE                                                 04820401
048205*----------------------------------------------------------       04820501
048206 4200-SCL-REC-WRITE.                                              04820601
048207                                                                  04820701
048208     WRITE SUB-CL-RECORD-OUT                                      04820801
048209         FROM EP227-MH-SUB-CL-RECORD.                             04820901
048213                                                                  04821301
048214     ADD +1 TO PV-SBCL-REC-WRITEN.                                04821401
048215                                                                  04821501
048216*4200-EXIT.                                                       04821601
048220*----------------------------------------------------------       04822001
048221* 4300-VST-REC-WRITE                                              04822101
048222*     THIS PARAGRAPH WRITES THE VENDOR STYLE REC TO THE           04822201
048223*     DELETE FILE                                                 04822301
048224*----------------------------------------------------------       04822401
048225 4300-VST-REC-WRITE.                                              04822501
048226                                                                  04822601
048227     WRITE VND-STYLE-RECORD-OUT                                   04822701
048228         FROM EP228-MH-VND-STYL-RECORD.                           04822801
048232                                                                  04823201
048233     ADD +1 TO PV-VSTY-REC-WRITEN.                                04823301
048234                                                                  04823401
048235*4300-EXIT.                                                       04823501
048239*----------------------------------------------------------       04823901
048240* 6000-READ-DEPT-FILE                                             04824001
048241*     THIS PARAGRAPH READS DATA THE DEPT-FILE (INP01)             04824101
048242*     INTO COPYBOOK EPRD224                                       04824201
048250*----------------------------------------------------------       04825001
048260 6000-READ-DEPT-FILE.                                             04826001
048270                                                                  04827001
048280     READ DEPT-FILE-INP                                           04828001
048290         INTO EP224-MH-DEPT-RECORD                                04829001
048291       AT END                                                     04829101
048292          SET PS-END-OF-DEPT-FILE TO TRUE                         04829201
048293     END-READ.                                                    04829301
048294                                                                  04829401
048295     IF PS-NOT-END-DEPT-FILE                                      04829517
048296        ADD +1 TO PV-DEPT-REC-READ                                04829617
048297     END-IF.                                                      04829717
048298                                                                  04829801
048299*6000-EXIT.                                                       04829901
048300                                                                  04830000
048400*----------------------------------------------------------       04840000
048500* 6100-READ-MAJ-CL-FILE                                           04850000
048600*     THIS PARAGRAPH READS DATA THE MAJ-CL-FILE (INP02)           04860000
048700*     INTO COPYBOOK EPRD226                                       04870000
048800*----------------------------------------------------------       04880000
048900 6100-READ-MAJ-CL-FILE.                                           04890000
049000                                                                  04900000
049100     READ MAJ-CL-FILE-INP                                         04910001
049200         INTO EP226-MH-MAJ-CL-RECORD                              04920000
049300       AT END                                                     04930000
049400          SET PS-END-OF-MAJ-CL-FILE TO TRUE                       04940000
049500     END-READ.                                                    04950000
049600                                                                  04960000
049610     IF PS-NOT-END-MAJ-CL-FILE                                    04961017
049700        ADD +1 TO PV-MJCL-REC-READ                                04970017
049710     END-IF.                                                      04971017
049800                                                                  04980000
049900*6100-EXIT.                                                       04990000
050200                                                                  05020000
050300*----------------------------------------------------------       05030000
050400* 6200-READ-SUB-CL-FILE                                           05040000
050500*     THIS PARAGRAPH READS DATA THE SUB-CL-FILE (INP03)           05050000
050600*     INTO COPYBOOK EPRD227                                       05060000
050700*----------------------------------------------------------       05070000
050800 6200-READ-SUB-CL-FILE.                                           05080000
050900                                                                  05090000
051000     READ SUB-CL-FILE-INP                                         05100001
051100         INTO EP227-MH-SUB-CL-RECORD                              05110000
051200       AT END                                                     05120000
051300          SET PS-END-OF-SUB-CL-FILE TO TRUE                       05130000
051400     END-READ.                                                    05140000
051500                                                                  05150000
051510     IF PS-NOT-END-SUB-CL-FILE                                    05151017
051600        ADD +1 TO PV-SBCL-REC-READ                                05160017
051610     END-IF.                                                      05161017
051700                                                                  05170000
051800*6200-EXIT.                                                       05180000
052100                                                                  05210000
052200*----------------------------------------------------------       05220000
052300* 6300-READ-VND-ST-FILE                                           05230000
052400*     THIS PARAGRAPH READS DATA THE VND-ST-FILE (INP04)           05240000
052500*     INTO COPYBOOK EPRD228                                       05250000
052600*----------------------------------------------------------       05260000
052700 6300-READ-VND-ST-FILE.                                           05270000
052800                                                                  05280000
052900     READ VND-STYLE-FILE-INP                                      05290002
053000         INTO EP228-MH-VND-STYL-RECORD                            05300000
053100       AT END                                                     05310000
053200          SET PS-END-OF-VND-ST-FILE TO TRUE                       05320000
053300     END-READ.                                                    05330000
053400                                                                  05340000
053410     IF PS-NOT-END-VND-ST-FILE                                    05341017
053500        ADD +1 TO PV-VSTY-REC-READ                                05350017
053510     END-IF.                                                      05351017
053600                                                                  05360000
053700*6300-EXIT.                                                       05370000
053900                                                                  05390000
054000******************************************************************05400000
054100*     CLOSES ALL FILES AND DISPLAYS ANY NEEDED INFORMATION.      *05410000
054200******************************************************************05420000
054300 9200-WRAPUP.                                                     05430000
054400     MOVE '9200-WRAPUP                     ' TO PV-PARAGRAPH-NAME.05440000
054500                                                                  05450000
054600     PERFORM 9920-DISPLAY-TOTALS.                                 05460000
054700                                                                  05470000
054800     DISPLAY '****************************************'.          05480000
054900     DISPLAY '**          EPKUT222 END              **'.          05490001
055000     DISPLAY '****************************************'.          05500000
055100                                                                  05510000
055200     CLOSE DEPT-FILE-INP                                          05520001
055300           MAJ-CL-FILE-INP                                        05530001
055400           SUB-CL-FILE-INP                                        05540001
055500           VND-STYLE-FILE-INP.                                    05550001
055600                                                                  05560000
055700     CLOSE DEPT-FILE-OUT                                          05570001
055800           MAJ-CL-FILE-OUT                                        05580001
055900           SUB-CL-FILE-OUT                                        05590001
056000           VND-STYLE-FILE-OUT.                                    05600001
056100                                                                  05610000
056200*9200-EXIT.  EXIT.                                                05620000
056300*---------------------------------------------------------        05630000
056400* 9800-SQL-ABEND.                                                 05640000
056500*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.05650000
056600*---------------------------------------------------------        05660000
056700 9800-SQL-ABEND.                                                  05670000
056800                                                                  05680000
056900     SET AC-DB2-ERROR TO TRUE.                                    05690000
057000                                                                  05700000
057100     DISPLAY '** ABEND     **'.                                   05710000
057200     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                05720000
057300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              05730000
057400     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               05740000
057500                                                                  05750000
057600     COPY DPPD004.                                                05760000
057700     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05770000
057800                                                                  05780000
057900*9800-EXIT.                                                       05790000
058100                                                                  05810000
058200******************************************************************05820000
058300*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.              *   05830000
058400******************************************************************05840000
058500 9910-ABEND.                                                      05850000
058600                                                                  05860000
058900     DISPLAY '** ABEND           **'.                             05890000
059000     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          05900000
059100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        05910000
059200     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       05920000
059300     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       05930000
059400                                                                  05940000
059410     PERFORM 9920-DISPLAY-TOTALS.                                 05941016
059420                                                                  05942016
059500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05950000
059600                                                                  05960000
059700*9910-EXIT.  EXIT.                                                05970000
059800******************************************************************05980000
059900*     DISPLAY END OF JOB TOTALS                                  *05990000
060000******************************************************************06000000
060100 9920-DISPLAY-TOTALS.                                             06010000
060200                                                                  06020000
060300     DISPLAY '************************************************'.  06030000
060400     DISPLAY '** STATISTICS FOR MERCHANDISE HIERARCHY FILES **'.  06040000
060500     DISPLAY '************************************************'.  06050000
060600                                                                  06060000
060700     DISPLAY '**   DEPARTMENT RECORDS READ  ====> '               06070000
060800             PV-DEPT-REC-READ                                     06080000
060900             ' **'.                                               06090000
061000     DISPLAY '**  MAJOR CLASS RECORDS READ  ====> '               06100000
061100             PV-MJCL-REC-READ                                     06110000
061200             ' **'.                                               06120000
061300     DISPLAY '**   SUB  CLASS RECORDS READ  ====> '               06130000
061400             PV-SBCL-REC-READ                                     06140000
061500             ' **'.                                               06150000
061600     DISPLAY '** VENDOR STYLE RECORDS READ  ====> '               06160000
061700             PV-VSTY-REC-READ                                     06170000
061800             ' **'.                                               06180000
062500     DISPLAY '                                     '.             06250000
062600     DISPLAY '**   DEPARTMENT RECORDS WRITEN ===> '               06260001
062700             PV-DEPT-REC-WRITEN                                   06270001
062800             ' **'.                                               06280001
062900     DISPLAY '**  MAJOR CLASS RECORDS WRITEN ===> '               06290001
063000             PV-MJCL-REC-WRITEN                                   06300001
063100             ' **'.                                               06310001
063110     DISPLAY '**   SUB  CLASS RECORDS WRITEN ===> '               06311001
063120             PV-SBCL-REC-WRITEN                                   06312001
063130             ' **'.                                               06313001
063140     DISPLAY '** VENDOR STYLE RECORDS WRITEN ===> '               06314001
063150             PV-VSTY-REC-WRITEN                                   06315001
063160             ' **'.                                               06316001
063200     DISPLAY '****************************************'.          06320000
063300                                                                  06330000
063400*9920-EXIT.  EXIT.                                                06340000
063500                                                                  06350000
