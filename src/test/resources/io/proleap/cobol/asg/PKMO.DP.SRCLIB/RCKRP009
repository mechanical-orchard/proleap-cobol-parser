000100*****************************************************************         
000200 IDENTIFICATION DIVISION.                                                 
000500 PROGRAM-ID.             RCKRP009.                                        
000600 AUTHOR.                 STEPHANIE HERON.                                 
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000800 DATE-WRITTEN            11-30-95.                                        
000900 DATE-COMPILED.                                                           
001000                                                                          
001100*****************************************************************         
001200*                                                               *         
001300*  THIS PROGRAM WILL CREATE THE MONTHLY UNITS VERIFIED REPORT   *         
001400*  FROM THE DAILY EXTRACT FILE.                                 *         
001500*                                                               *         
001600*****************************************************************         
001700*                                                               *         
001800*  CHANGED 10/27/98 BY DAVE MUSKAT - COMPUWARE                  *         
001900*   WR# 4650  CHANGES FOR PRODUCT PACKAGING PROJECT:            *         
001700*                                                               *         
001900*    MODIFIED REPORT DESIGN TO SHOW A BREAKDOWN OF VERIFIED     *         
001900*    QUANTITIES BY PREPACK CODE AND WHAT PERCENT OF THE TOTAL   *         
001900*    THESE QUANTITIES REPRESENT. ALSO, THE REPORT WAS CHANGED   *         
001900*    TO SHOW ONLY UNITS VERIFIED WITHIN THE CURRENT SEASON.     *         
001700*                                                               *         
002000*    PROGRAMMING LOGIC WAS ADDED TO DETERMINE THE CURRENT       *         
002000*    SEASON (EITHER AUGUST THRU JANUARY OR FEBRUARY THRU JULY,  *         
002000*    BASED ON THE MONTH FROM THE SYSTEM DATE) SO THAT ONLY      *         
002000*    INPUT RECORDS WITH A VERIFY DATE WITHIN THE CURRENT SEASON *         
002000*    WILL BE SELECTED FOR THE REPORT.  THE RECORD LAYOUT USED   *         
002000*    FOR THE INPUT FILE (COPYBOOK RCRD010) WAS CHANGED TO       *         
002000*    INCLUDE THE VERFIFY DATE FOR THIS PURPOSE.  IF NO INPUT    *         
002100*    RECORD IS FOUND TO HAVE A VERIFY DATE WITHIN THE CURRENT   *         
002100*    SEASON, A MESSAGE SAYING THERE WAS NO DATA WITHIN THE DATE *         
002100*    RANGE IS PRINTED ON THE REPORT DETAIL LINE.                *         
002100*                                                               *         
002000*    AN OUTPUT FILE CONTAINING DMM SUMMARY DATA WAS ADDED SO    *         
002000*    THAT A SUMMARY REPORT CAN BE PRINTED BY ANOTHER PROGRAM.   *         
002100*    IF NO INPUT RECORD IS FOUND TO HAVE A VERIFY DATE WITHIN   *         
002100*    THE CURRENT SEASON, NO OUTPUT RECORD IS WRITTEN.           *         
002200*****************************************************************         
001900*  CHANGED 12/10/98 BY PAUL JORGENSEN                                     
002000*   WR# 4650 DROP SELECTION BASED ON CURRENT SEASON. THE INPUT            
002100*   COMES FROM A MONTHLY FILE AND IT TURNS OUT THE USER IS                
002200*   HAPPY WITH IT BEING A MONTHLY REPORT.  ALSO CHANGED TO                
      *   ACCEPT A CONTROL CARD FOR A NEW WEEKLY REPORT OPTION.                 
002200*****************************************************************         
LF0114*  CHANGED 01/02/14 BY LINDA FRIESS                                       
LF0114*   CHG0081355 PACKAGING CODE MODIFICATIONS TO ADD CROSS-DOCK &           
LF0114*   NON-CROSS-DOCK QUANTITIES TO INPUT & OUTPUT FILES. CHANGED            
LF0114*   OUTPUT FILE RECORD LENGTH FROM 100 TO 135.                            
LF0114*****************************************************************         
002300 ENVIRONMENT DIVISION.                                                    
002600 CONFIGURATION SECTION.                                                   
002700                                                                          
002800 SOURCE-COMPUTER.        IBM-3090.                                        
002900 OBJECT-COMPUTER.        IBM-3090.                                        
003100 INPUT-OUTPUT SECTION.                                                    
003200                                                                          
003300 FILE-CONTROL.                                                            
003400                                                                          
003500     SELECT STORE-SUMMED-EXTRACT-FILE                                     
003600         ASSIGN TO INP01.                                                 
003700                                                                          
003800     SELECT RECV-REPORT-FILE                                              
003900         ASSIGN TO RPT01.                                                 
004000                                                                          
003800     SELECT DMM-SUMMARY-FILE                                              
003900         ASSIGN TO OUT01.                                                 
004000                                                                          
004200******************************************************************        
004300 DATA DIVISION.                                                           
004600 FILE SECTION.                                                            
004700                                                                          
004800 FD  STORE-SUMMED-EXTRACT-FILE                                            
004900     RECORDING MODE IS F                                                  
005000     LABEL RECORDS ARE STANDARD                                           
005100     BLOCK CONTAINS 0 RECORDS.                                            
005200                                                                          
005300 01  RC010-INPUT-RECORD               PIC  X(150).                        
005400                                                                          
005500 FD  RECV-REPORT-FILE                                                     
005600     RECORDING MODE IS F                                                  
005700     BLOCK CONTAINS 0  RECORDS.                                           
005800 01  RECV-REPORT-RECORD              PIC  X(132).                         
005900                                                                          
005500 FD  DMM-SUMMARY-FILE                                                     
005600     RECORDING MODE IS F                                                  
005700     BLOCK CONTAINS 0 RECORDS                                             
005800     LABEL RECORDS ARE STANDARD.                                          
LF0114 01  DMM-SUMMARY-RECORD              PIC X(135).                          
005900                                                                          
005900                                                                          
006000 WORKING-STORAGE SECTION.                                                 
006100                                                                          
006200 01  FILLER.                                                              
006300     05  FILLER                      PIC  X(36)    VALUE                  
006400         ' ***** WORKING STORAGE PGM=RCKRP009 '.                          
006500     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.           
006600     05  FILLER                      PIC  X(10)    VALUE                  
006700         ' LOCATION='.                                                    
006800     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.           
006900     05  FILLER                      PIC  X(06)    VALUE                  
007000         ' *****'.                                                        
007100                                                                          
       01  CC-CONTROL-CARD.                                                     
           05  CC-REPORT-TYPE                  PIC  X.                          
               88  CC-VALID-REPORT-TYPE        VALUE                            
                   'W' 'M'.                                                     
               88  CC-WEEKLY-REPORT            VALUE                            
                   'W'.                                                         
               88  CC-MONTHLY-REPORT           VALUE                            
                   'M'.                                                         
      *                                                                         
      *  WORK AREA FOR FISCAL CALENDAR ROUTINE.                                 
      *                                                                         
           COPY DPWS500.                                                        
                                                                                
007200 01  PROGRAM-SWITCHES.                                                    
007300     05  PS-NO-MORE-RECV-RECS-IND    PIC  X(01)    VALUE 'Y'.             
007400         88  PS-MORE-RECV-RECS                     VALUE 'Y'.             
007500         88  PS-NO-MORE-RECV-RECS                  VALUE 'N'.             
007300     05  PS-DATE-WITHIN-RANGE-SW     PIC  X(01)    VALUE 'N'.             
007400         88  PS-DATE-WITHIN-RANGE                  VALUE 'Y'.             
007500         88  PS-DATE-OUT-OF-RANGE                  VALUE 'N'.             
007600                                                                          
007700 01  PC-CONSTANTS.                                                        
007800     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60.             
008500     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE                  
008600                                                   'RCKRP009'.            
008700     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.               
009500                                                                          
009600 01  PV-ACCUMULATOR-FIELDS.                                               
009700     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO             
009800                                                   COMP-3.                
009900     05  PV-LINE-CNT                 PIC S9(04)    VALUE ZERO             
010000                                                   COMP SYNC.             
009900     05  PV-VALID-DATE-CNT           PIC S9(09)    VALUE ZERO             
010000                                                   COMP SYNC.             
010100     05  PV-DPT-ACCUM-FIELDS.                                             
010200         10  PV-DPT-VRFYD-QTY        PIC S9(09)    VALUE ZERO             
010300                                                   COMP-3.                
010400         10  PV-DPT-GOH-QTY          PIC S9(09)    VALUE ZERO             
010500                                                   COMP-3.                
010600         10  PV-DPT-PRETKT-QTY       PIC S9(09)    VALUE ZERO             
010700                                                   COMP-3.                
010800         10  PV-DPT-SINGLE-QTY       PIC S9(09)    VALUE ZERO             
010900                                                   COMP-3.                
011000         10  PV-DPT-MULTI-QTY        PIC S9(09)    VALUE ZERO             
011100                                                   COMP-3.                
011200         10  PV-DPT-INNER-QTY        PIC S9(09)    VALUE ZERO             
011300                                                   COMP-3.                
011400         10  PV-DPT-BULK-QTY         PIC S9(09)    VALUE ZERO             
011500                                                   COMP-3.                
011600         10  PV-DPT-CASE-QTY         PIC S9(09)    VALUE ZERO             
011700                                                   COMP-3.                
011800         10  PV-DPT-PBS-QTY          PIC S9(09)    VALUE ZERO             
011900                                                   COMP-3.                
LF0114         10  PV-DPT-CROSS-DOCK-QTY   PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
LF0114         10  PV-DPT-NON-CROSS-DK-QTY PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
012000     05  PV-BYR-ACCUM-FIELDS.                                             
012100         10  PV-BYR-VRFYD-QTY        PIC S9(09)    VALUE ZERO             
012200                                                   COMP-3.                
012300         10  PV-BYR-GOH-QTY          PIC S9(09)    VALUE ZERO             
012400                                                   COMP-3.                
012500         10  PV-BYR-PRETKT-QTY       PIC S9(09)    VALUE ZERO             
012600                                                   COMP-3.                
012700         10  PV-BYR-SINGLE-QTY       PIC S9(09)    VALUE ZERO             
012800                                                   COMP-3.                
012900         10  PV-BYR-MULTI-QTY        PIC S9(09)    VALUE ZERO             
013000                                                   COMP-3.                
013100         10  PV-BYR-INNER-QTY        PIC S9(09)    VALUE ZERO             
013200                                                   COMP-3.                
013300         10  PV-BYR-BULK-QTY         PIC S9(09)    VALUE ZERO             
013400                                                   COMP-3.                
013500         10  PV-BYR-CASE-QTY         PIC S9(09)    VALUE ZERO             
013600                                                   COMP-3.                
013700         10  PV-BYR-PBS-QTY          PIC S9(09)    VALUE ZERO             
013800                                                   COMP-3.                
LF0114         10  PV-BYR-CROSS-DOCK-QTY   PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
LF0114         10  PV-BYR-NON-CROSS-DK-QTY PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
013900     05  PV-DMM-ACCUM-FIELDS.                                             
014000         10  PV-DMM-VRFYD-QTY        PIC S9(09)    VALUE ZERO             
014100                                                   COMP-3.                
014200         10  PV-DMM-GOH-QTY          PIC S9(09)    VALUE ZERO             
014300                                                   COMP-3.                
014400         10  PV-DMM-PRETKT-QTY       PIC S9(09)    VALUE ZERO             
014500                                                   COMP-3.                
014600         10  PV-DMM-SINGLE-QTY       PIC S9(09)    VALUE ZERO             
014700                                                   COMP-3.                
014800         10  PV-DMM-MULTI-QTY        PIC S9(09)    VALUE ZERO             
014900                                                   COMP-3.                
015000         10  PV-DMM-INNER-QTY        PIC S9(09)    VALUE ZERO             
015100                                                   COMP-3.                
015200         10  PV-DMM-BULK-QTY         PIC S9(09)    VALUE ZERO             
015300                                                   COMP-3.                
015400         10  PV-DMM-CASE-QTY         PIC S9(09)    VALUE ZERO             
015500                                                   COMP-3.                
015600         10  PV-DMM-PBS-QTY          PIC S9(09)    VALUE ZERO             
015700                                                   COMP-3.                
LF0114         10  PV-DMM-CROSS-DOCK-QTY   PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
LF0114         10  PV-DMM-NON-CROSS-DK-QTY PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
015800     05  PV-COR-ACCUM-FIELDS.                                             
015900         10  PV-COR-VRFYD-QTY        PIC S9(09)    VALUE ZERO             
016000                                                   COMP-3.                
016100         10  PV-COR-GOH-QTY          PIC S9(09)    VALUE ZERO             
016200                                                   COMP-3.                
016300         10  PV-COR-PRETKT-QTY       PIC S9(09)    VALUE ZERO             
016400                                                   COMP-3.                
016500         10  PV-COR-SINGLE-QTY       PIC S9(09)    VALUE ZERO             
016600                                                   COMP-3.                
016700         10  PV-COR-MULTI-QTY        PIC S9(09)    VALUE ZERO             
016800                                                   COMP-3.                
016900         10  PV-COR-INNER-QTY        PIC S9(09)    VALUE ZERO             
017000                                                   COMP-3.                
017100         10  PV-COR-BULK-QTY         PIC S9(09)    VALUE ZERO             
017200                                                   COMP-3.                
017300         10  PV-COR-CASE-QTY         PIC S9(09)    VALUE ZERO             
017400                                                   COMP-3.                
017500         10  PV-COR-PBS-QTY          PIC S9(09)    VALUE ZERO             
017600                                                   COMP-3.                
LF0114         10  PV-COR-CROSS-DOCK-QTY   PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
LF0114         10  PV-COR-NON-CROSS-DK-QTY PIC S9(09)    VALUE ZERO             
LF0114                                                   COMP-3.                
017700 01  PV-CALC-WORK-FIELDS.                                                 
017800     05  PV-PERCENT-SHIFTED          PIC S9(03)V9  VALUE ZERO             
017900                                                   COMP-3.                
018000     05  PV-PERCENT-DECIMAL          PIC S9V999    VALUE ZERO             
018100                                                   COMP-3.                
018200     05  PV-PARTIAL-QTY              PIC S9(09)    VALUE ZERO             
018300                                                   COMP-3.                
018400     05  PV-WRK-PRETKT-QTY           PIC S9(09)    VALUE ZERO             
018500                                                   COMP-3.                
018400     05  PV-WRK-GOH-QTY              PIC S9(09)    VALUE ZERO             
018500                                                   COMP-3.                
018600     05  PV-WRK-SINGLE-QTY           PIC S9(09)    VALUE ZERO             
018700                                                   COMP-3.                
018800     05  PV-WRK-MULTI-QTY            PIC S9(09)    VALUE ZERO             
018900                                                   COMP-3.                
019000     05  PV-WRK-INNER-QTY            PIC S9(09)    VALUE ZERO             
019100                                                   COMP-3.                
019200     05  PV-WRK-BULK-QTY             PIC S9(09)    VALUE ZERO             
019300                                                   COMP-3.                
019400     05  PV-WRK-CASE-QTY             PIC S9(09)    VALUE ZERO             
019500                                                   COMP-3.                
019600     05  PV-WRK-PBS-QTY              PIC S9(09)    VALUE ZERO             
019700                                                   COMP-3.                
019800     05  PV-WRK-TOTAL-QTY            PIC S9(09)    VALUE ZERO             
019900                                                   COMP-3.                
020000                                                                          
020100                                                                          
020200 01  SAVE-FIELDS.                                                         
020300     05  SAVE-GMM-NBR                PIC  X(02)    VALUE SPACES.          
020300     05  SAVE-DMM-NBR                PIC  X(02)    VALUE SPACES.          
020400     05  SAVE-BYR-NBR                PIC  X(03)    VALUE SPACES.          
020500     05  SAVE-DPT-NBR                PIC  X(03)    VALUE SPACES.          
020600     05  SAVE-GMM-NAME               PIC  X(25)    VALUE SPACES.          
020600     05  SAVE-DMM-NAME               PIC  X(25)    VALUE SPACES.          
020700     05  SAVE-BYR-NAME               PIC  X(25)    VALUE SPACES.          
020800                                                                          
020900 01  PV-MISC-FIELDS.                                                      
021000     05  PV-PRINT-RECORD             PIC X(132)    VALUE SPACES.          
021100     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO             
021200                                                   COMP SYNC.             
021300     05  PV-LINE-CNT-AHEAD           PIC S9(04)    VALUE ZERO             
021400                                                   COMP SYNC.             
021500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO             
021600                                                   COMP SYNC.             
021700     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.          
021800                                                                          
020900 01  PV-DATE-FIELDS.                                                      
021900     05  PV-TEST-DATE-CCYYMMDD.                                           
022000         10  PV-TEST-DATE-CC         PIC  9(02).                          
022000         10  PV-TEST-DATE-YYMMDD.                                         
022000             15  PV-TEST-DATE-YY     PIC  9(02).                          
022100             15  PV-TEST-DATE-MM     PIC  9(02).                          
022200             15  PV-TEST-DATE-DD     PIC  9(02).                          
022300                                                                          
021900     05  PV-START-DATE-CCYYMMDD.                                          
022000         10  PV-START-DATE-CC        PIC  9(02).                          
022000         10  PV-START-DATE-YY        PIC  9(02).                          
022100         10  PV-START-DATE-MM        PIC  9(02).                          
022200         10  PV-START-DATE-DD        PIC  9(02).                          
021900     05  FILLER REDEFINES PV-START-DATE-CCYYMMDD.                         
022000         10  PV-START-DATE-CCYY      PIC  9(04).                          
022000         10  FILLER                  PIC  9(04).                          
022300                                                                          
021900     05  PV-END-DATE-CCYYMMDD.                                            
022000         10  PV-END-DATE-CC          PIC  9(02).                          
022000         10  PV-END-DATE-YY          PIC  9(02).                          
022100         10  PV-END-DATE-MM          PIC  9(02).                          
022200         10  PV-END-DATE-DD          PIC  9(02).                          
021900     05  FILLER REDEFINES PV-END-DATE-CCYYMMDD.                           
022000         10  PV-END-DATE-CCYY        PIC  9(04).                          
022000         10  FILLER                  PIC  9(04).                          
022300                                                                          
021900     05  PV-VERIFY-DATE-CCYYMMDD.                                         
022000         10  PV-VERIFY-DATE-CC       PIC  9(02).                          
021900         10  PV-VERIFY-DATE-YYMMDD.                                       
022000             15  PV-VERIFY-DATE-YY   PIC  9(02).                          
022100             15  PV-VERIFY-DATE-MM   PIC  9(02).                          
022200             15  PV-VERIFY-DATE-DD   PIC  9(02).                          
021900     05  FILLER REDEFINES PV-VERIFY-DATE-CCYYMMDD.                        
022000         10  PV-VERIFY-DATE-CCYY     PIC  9(04).                          
022000         10  FILLER                  PIC  9(04).                          
022300                                                                          
021900     05  PV-CURR-DATE-CCYYMMDD.                                           
022000         10  PV-CURR-DATE-CC         PIC  9(02).                          
021900         10  PV-CURR-DATE-YYMMDD.                                         
022000             15  PV-CURR-DATE-YY     PIC  9(02).                          
022100             15  PV-CURR-DATE-MM     PIC  9(02).                          
022200             15  PV-CURR-DATE-DD     PIC  9(02).                          
021900     05  FILLER REDEFINES PV-CURR-DATE-CCYYMMDD.                          
022000         10  PV-CURR-DATE-CCYY       PIC  9(04).                          
022000         10  FILLER                  PIC  9(04).                          
022300                                                                          
016520     05  PV-FISCAL-PRD-CCYYPP.                                            
016530         10  PV-FISCAL-PRD-CCYY      PIC  9(04).                          
016530         10  PV-FISCAL-PRD-PP        PIC  9(02).                          
016550                                                                          
022400     05  PV-CURR-TIME.                                                    
022500         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.            
022600         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.            
022700         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.            
023500                                                                          
024400                                                                          
024500******************************************************************        
024600*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.                       
024700******************************************************************        
024800     COPY DPWS132O.                                                       
024900                                                                          
025000 01  HEADING-LINES.                                                       
025100     05  HEADING-LINE-0.                                                  
025200         10  FILLER                  PIC  X(45)    VALUE SPACES.          
025300         10  FILLER                  PIC  X(42)    VALUE                  
025400             'TOTAL NUMBER OF UNITS VERIFIED - CORPORATE'.                
025500         10  FILLER                  PIC  X(45)    VALUE SPACES.          
025600                                                                          
025100     05  HEADING-LINE-1.                                                  
               10  FILLER                  PIC  X(42)    VALUE SPACES.          
               10  FILLER                  PIC  X(24)    VALUE                  
                  'ITEMS VERIFIED BETWEEN: '.                                   
               10  HL1-START-DATE.                                              
                   15  HL1-START-CCYY      PIC  X(04).                          
                   15  FILLER              PIC  X(01)    VALUE '-'.             
                   15  HL1-START-MM        PIC  X(02).                          
                   15  FILLER              PIC  X(01)    VALUE '-'.             
                   15  HL1-START-DD        PIC  X(02).                          
               10  FILLER                  PIC  X(05)    VALUE ' AND '.         
               10  HL1-END-DATE.                                                
                   15  HL1-END-CCYY        PIC  X(04).                          
                   15  FILLER              PIC  X(01)    VALUE '-'.             
                   15  HL1-END-MM          PIC  X(02).                          
                   15  FILLER              PIC  X(01)    VALUE '-'.             
                   15  HL1-END-DD          PIC  X(02).                          
025600         10  FILLER                  PIC  X(41)    VALUE SPACES.          
025700     05  HEADING-LINE-2.                                                  
025800         10  FILLER                  PIC X(04)     VALUE                  
025900             ' DMM'.                                                      
026000         10  FILLER                  PIC X(03)     VALUE SPACES.          
026100         10  HL2-DMM-NBR             PIC X(02)     VALUE SPACES.          
026200         10  FILLER                  PIC X(03)     VALUE SPACES.          
026300         10  HL2-DMM-NAME            PIC X(25)     VALUE SPACES.          
026400         10  FILLER                  PIC X(98)     VALUE SPACES.          
026500                                                                          
026600     05  HEADING-LINE-3.                                                  
026700         10  FILLER                  PIC X(06)     VALUE                  
026800             ' BUYER'.                                                    
026900         10  FILLER                  PIC X(01)     VALUE SPACES.          
027000         10  HL3-BYR-NBR             PIC X(03)     VALUE SPACES.          
027100         10  FILLER                  PIC X(02)     VALUE SPACES.          
027200         10  HL3-BYR-NAME            PIC X(25)     VALUE SPACES.          
027300         10  FILLER                  PIC X(98)     VALUE SPACES.          
027400                                                                          
027500     05  HEADING-LINE-4.                                                  
027600         10  FILLER                  PIC X(53)     VALUE SPACES.          
027800         10  FILLER                  PIC X(29)     VALUE                  
027900             '*--------------------------- '.                             
027800         10  FILLER                  PIC X(18)     VALUE                  
027900             'P A C K A G I N G '.                                        
027800         10  FILLER                  PIC X(29)     VALUE                  
027900             '----------------------------*'.                             
028000         10  FILLER                  PIC X(03)     VALUE SPACES.          
028400                                                                          
028500                                                                          
027500     05  HEADING-LINE-5.                                                  
027600         10  FILLER                  PIC X(06)     VALUE SPACES.          
027700         10  FILLER                  PIC X(11)     VALUE SPACES.          
027800         10  FILLER                  PIC X(05)     VALUE                  
027900             'VRFYD'.                                                     
028000         10  FILLER                  PIC X(11)     VALUE SPACES.          
028100         10  FILLER                  PIC X(03)     VALUE                  
028200             'PRE'.                                                       
028300         10  FILLER                  PIC X(96)     VALUE SPACES.          
028400                                                                          
028500                                                                          
028600     05  HEADING-LINE-6.                                                  
028700         10  FILLER                  PIC X(06)     VALUE SPACES.          
028800         10  FILLER                  PIC X(04)     VALUE                  
028900             'DEPT'.                                                      
029000         10  FILLER                  PIC X(08)     VALUE SPACES.          
029100         10  FILLER                  PIC X(03)     VALUE                  
029200             'QTY'.                                                       
029300         10  FILLER                  PIC X(12)     VALUE SPACES.          
029400         10  FILLER                  PIC X(03)     VALUE                  
029500             'TKT'.                                                       
029600         10  FILLER                  PIC X(10)     VALUE SPACES.          
029700         10  FILLER                  PIC X(03)     VALUE                  
029800             'GOH'.                                                       
029600         10  FILLER                  PIC X(06)     VALUE SPACES.          
029700         10  FILLER                  PIC X(07)     VALUE                  
029800             '    PBS'.                                                   
029600         10  FILLER                  PIC X(06)     VALUE SPACES.          
029700         10  FILLER                  PIC X(07)     VALUE                  
029800             ' SINGLE'.                                                   
029600         10  FILLER                  PIC X(06)     VALUE SPACES.          
029700         10  FILLER                  PIC X(07)     VALUE                  
029800             '  MULTI'.                                                   
029600         10  FILLER                  PIC X(06)     VALUE SPACES.          
029700         10  FILLER                  PIC X(07)     VALUE                  
029800             '   CASE'.                                                   
029600         10  FILLER                  PIC X(06)     VALUE SPACES.          
029700         10  FILLER                  PIC X(07)     VALUE                  
029800             '  INNER'.                                                   
029600         10  FILLER                  PIC X(06)     VALUE SPACES.          
029700         10  FILLER                  PIC X(07)     VALUE                  
029800             '   BULK'.                                                   
029900         10  FILLER                  PIC X(05)     VALUE SPACES.          
030000                                                                          
030100                                                                          
030200 01  MISCELLANEOUS-LINES.                                                 
030300     05  END-OF-REPORT-LINE.                                              
030400         10  FILLER                  PIC  X(44)    VALUE SPACES.          
030500         10  FILLER                  PIC  X(45)    VALUE                  
030600             '*******   E N D   O F   R E P O R T   *******'.             
030700         10  FILLER                  PIC  X(43)    VALUE SPACES.          
030800                                                                          
030800     05  EMPTY-REPORT-LINE.                                               
030800         10  FILLER                  PIC  X(20)    VALUE SPACES.          
030800         10  FILLER                  PIC  X(46)    VALUE                  
030800             ' ***  N O   D A T A   W I T H I N   D A T E   '.            
030800         10  FILLER                  PIC  X(46)    VALUE                  
030800             'R A N G E   F O R   T H I S   R E P O R T  ***'.            
030800         10  FILLER                  PIC  X(20)    VALUE SPACES.          
030800                                                                          
030800                                                                          
031100     05  BYR-TOTAL-LINE1.                                                 
031200         10  FILLER                  PIC  X(10)    VALUE                  
031300             ' BYR TOTAL'.                                                
031400         10  FILLER                  PIC  X(02)    VALUE SPACES.          
031500         10  T1-VRFYD-QTY            PIC  ZZZ,ZZZ,ZZ9                     
031600                                                   VALUE ZEROES.          
031700         10  FILLER                  PIC  X(02)    VALUE SPACES.          
031800         10  T1-PRETKT-QTY           PIC  ZZZ,ZZZ,ZZ9                     
031900                                                   VALUE ZEROES.          
032000         10  FILLER                  PIC  X(02)    VALUE SPACES.          
032100         10  T1-GOH-QTY              PIC  ZZZ,ZZZ,ZZ9                     
032200                                                   VALUE ZEROES.          
032300         10  FILLER                  PIC  X(02)    VALUE SPACES.          
032400         10  T1-PBS-QTY              PIC  ZZZ,ZZZ,ZZ9                     
032500                                                   VALUE ZEROES.          
032600         10  FILLER                  PIC  X(02)    VALUE SPACES.          
032700         10  T1-SINGLE-QTY           PIC  ZZZ,ZZZ,ZZ9                     
032800                                                   VALUE ZEROES.          
032900         10  FILLER                  PIC  X(02)    VALUE SPACES.          
033600         10  T1-MULTI-QTY            PIC  ZZZ,ZZZ,ZZ9                     
033700                                                   VALUE ZEROES.          
033800         10  FILLER                  PIC  X(02)    VALUE SPACES.          
033000         10  T1-CASE-QTY             PIC  ZZZ,ZZZ,ZZ9                     
033100                                                   VALUE ZEROES.          
033200         10  FILLER                  PIC  X(02)    VALUE SPACES.          
033300         10  T1-INNER-QTY            PIC  ZZZ,ZZZ,ZZ9                     
033400                                                   VALUE ZEROES.          
033500         10  FILLER                  PIC  X(02)    VALUE SPACES.          
033900         10  T1-BULK-QTY             PIC  ZZZ,ZZZ,ZZ9                     
034000                                                   VALUE ZEROES.          
034100         10  FILLER                  PIC  X(05)    VALUE SPACES.          
034200                                                                          
034300     05  DMM-TOTAL-LINE2.                                                 
034400         10  FILLER                  PIC  X(05)    VALUE                  
034500             ' DMM '.                                                     
034600         10  T2-DMM-NBR              PIC  X(02)    VALUE SPACES.          
034700         10  FILLER                  PIC  X(04)    VALUE                  
034800             ' TOT'.                                                      
034900         10  FILLER                  PIC  X(01)    VALUE SPACES.          
035000         10  T2-VRFYD-QTY            PIC  ZZZ,ZZZ,ZZ9                     
035100                                                   VALUE ZEROES.          
035200         10  FILLER                  PIC  X(02)    VALUE SPACES.          
035300         10  T2-PRETKT-QTY           PIC  ZZZ,ZZZ,ZZ9                     
035400                                                   VALUE ZEROES.          
035500         10  FILLER                  PIC  X(02)    VALUE SPACES.          
035600         10  T2-GOH-QTY              PIC  ZZZ,ZZZ,ZZ9                     
035700                                                   VALUE ZEROES.          
035800         10  FILLER                  PIC  X(02)    VALUE SPACES.          
035900         10  T2-PBS-QTY              PIC  ZZZ,ZZZ,ZZ9                     
036000                                                   VALUE ZEROES.          
036100         10  FILLER                  PIC  X(02)    VALUE SPACES.          
036200         10  T2-SINGLE-QTY           PIC  ZZZ,ZZZ,ZZ9                     
036300                                                   VALUE ZEROES.          
036400         10  FILLER                  PIC  X(02)    VALUE SPACES.          
037100         10  T2-MULTI-QTY            PIC  ZZZ,ZZZ,ZZ9                     
037200                                                   VALUE ZEROES.          
037300         10  FILLER                  PIC  X(02)    VALUE SPACES.          
036500         10  T2-CASE-QTY             PIC  ZZZ,ZZZ,ZZ9                     
036600                                                   VALUE ZEROES.          
036700         10  FILLER                  PIC  X(02)    VALUE SPACES.          
036800         10  T2-INNER-QTY            PIC  ZZZ,ZZZ,ZZ9                     
036900                                                   VALUE ZEROES.          
037000         10  FILLER                  PIC  X(02)    VALUE SPACES.          
037400         10  T2-BULK-QTY             PIC  ZZZ,ZZZ,ZZ9                     
037500                                                   VALUE ZEROES.          
037600         10  FILLER                  PIC  X(05)    VALUE SPACES.          
037700                                                                          
037800     05  COR-TOTAL-LINE3.                                                 
037900         10  FILLER                  PIC  X(12)    VALUE                  
038000             ' GRAND TOTAL'.                                              
038100         10  FILLER                  PIC  X(01)    VALUE SPACES.          
038200         10  T3-VRFYD-QTY            PIC  ZZZ,ZZZ,ZZ9                     
038300                                                   VALUE ZEROES.          
038400         10  FILLER                  PIC  X(02)    VALUE SPACES.          
038500         10  T3-PRETKT-QTY           PIC  ZZZ,ZZZ,ZZ9                     
038600                                                   VALUE ZEROES.          
038700         10  FILLER                  PIC  X(02)    VALUE SPACES.          
038800         10  T3-GOH-QTY              PIC  ZZZ,ZZZ,ZZ9                     
038900                                                   VALUE ZEROES.          
039000         10  FILLER                  PIC  X(02)    VALUE SPACES.          
039100         10  T3-PBS-QTY              PIC  ZZZ,ZZZ,ZZ9                     
039200                                                   VALUE ZEROES.          
039300         10  FILLER                  PIC  X(02)    VALUE SPACES.          
039400         10  T3-SINGLE-QTY           PIC  ZZZ,ZZZ,ZZ9                     
039500                                                   VALUE ZEROES.          
039600         10  FILLER                  PIC  X(02)    VALUE SPACES.          
040300         10  T3-MULTI-QTY            PIC  ZZZ,ZZZ,ZZ9                     
040400                                                   VALUE ZEROES.          
040500         10  FILLER                  PIC  X(02)    VALUE SPACES.          
039700         10  T3-CASE-QTY             PIC  ZZZ,ZZZ,ZZ9                     
039800                                                   VALUE ZEROES.          
039900         10  FILLER                  PIC  X(02)    VALUE SPACES.          
040000         10  T3-INNER-QTY            PIC  ZZZ,ZZZ,ZZ9                     
040100                                                   VALUE ZEROES.          
040200         10  FILLER                  PIC  X(02)    VALUE SPACES.          
040600         10  T3-BULK-QTY             PIC  ZZZ,ZZZ,ZZ9                     
040700                                                   VALUE ZEROES.          
040800         10  FILLER                  PIC  X(04)    VALUE SPACES.          
040900                                                                          
           05  GROUP-TOTAL-LINE4.                                               
               10  FILLER                  PIC  X(53)    VALUE SPACES.          
               10  FILLER                  PIC  X(16)    VALUE                  
                   'X-DOCK TOTAL -->'.                                          
               10  T4-GROUP-TOTAL-1        PIC  ZZZ,ZZZ,ZZ9.                    
               10  FILLER                  PIC  X        VALUE SPACES.          
               10  T4-GROUP-PCNT-1         PIC  ZZ9.9.                          
               10  FILLER                  PIC  X(26)    VALUE                  
                   ' %    NON X-DOCK TOTAL -->'.                                
               10  T4-GROUP-TOTAL-2        PIC  ZZZ,ZZZ,ZZ9.                    
               10  FILLER                  PIC  X        VALUE SPACES.          
               10  T4-GROUP-PCNT-2         PIC  ZZ9.9.                          
               10  FILLER                  PIC  X(03)    VALUE                  
                  ' % '.                                                        
041000     05  PL-PERCENT-LINE.                                                 
041100         10  FILLER                  PIC  X(31)    VALUE SPACES.          
041200         10  PL-PRE-TKT-PCNT         PIC  ZZ9.9    VALUE ZEROES.          
041300         10  FILLER                  PIC  X(08)    VALUE                  
041400             ' %      '.                                                  
041200         10  PL-GOH-PCNT             PIC  ZZ9.9    VALUE ZEROES.          
041300         10  FILLER                  PIC  X(08)    VALUE                  
041400             ' %      '.                                                  
041500         10  PL-PBS-PCNT             PIC  ZZ9.9    VALUE ZEROES.          
041600         10  FILLER                  PIC  X(08)    VALUE                  
041700             ' %      '.                                                  
041800         10  PL-SINGLE-PCNT          PIC  ZZ9.9    VALUE ZEROES.          
041900         10  FILLER                  PIC  X(08)    VALUE                  
042000             ' %      '.                                                  
042100         10  PL-MULTI-PCNT           PIC  ZZ9.9    VALUE ZEROES.          
042200         10  FILLER                  PIC  X(08)    VALUE                  
042300             ' %      '.                                                  
042400         10  PL-CASE-PCNT            PIC  ZZ9.9    VALUE ZEROES.          
042500         10  FILLER                  PIC  X(08)    VALUE                  
042600             ' %      '.                                                  
042700         10  PL-INNER-PCNT           PIC  ZZ9.9    VALUE ZEROES.          
042800         10  FILLER                  PIC  X(08)    VALUE                  
042900             ' %      '.                                                  
043000         10  PL-BULK-PCNT            PIC  ZZ9.9    VALUE ZEROES.          
043100         10  FILLER                  PIC  X(05)    VALUE                  
043200             ' %   '.                                                     
043300                                                                          
043500 01  DETAIL-LINES.                                                        
043600     05  DETAIL-LINE1.                                                    
043700         10  FILLER                  PIC  X(07)    VALUE SPACES.          
043800         10  DL1-DPT-NBR             PIC  X(03)    VALUE SPACES.          
043900         10  FILLER                  PIC  X(03)    VALUE SPACES.          
044000         10  DL1-VRFYD-QTY           PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
044100         10  FILLER                  PIC  X(03)    VALUE SPACES.          
044200         10  DL1-PRETKT-QTY          PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
044300         10  FILLER                  PIC  X(03)    VALUE SPACES.          
044400         10  DL1-GOH-QTY             PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
044500         10  FILLER                  PIC  X(03)    VALUE SPACES.          
044600         10  DL1-PBS-QTY             PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
044700         10  FILLER                  PIC  X(03)    VALUE SPACES.          
044800         10  DL1-SINGLE-QTY          PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
044900         10  FILLER                  PIC  X(03)    VALUE SPACES.          
045400         10  DL1-MULTI-QTY           PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
045500         10  FILLER                  PIC  X(03)    VALUE SPACES.          
045000         10  DL1-CASE-QTY            PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
045100         10  FILLER                  PIC  X(03)    VALUE SPACES.          
045200         10  DL1-INNER-QTY           PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
045300         10  FILLER                  PIC  X(03)    VALUE SPACES.          
045600         10  DL1-BULK-QTY            PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES.        
045700         10  FILLER                  PIC  X(05)    VALUE SPACES.          
045800                                                                          
045900******************************************************************        
046000*    STORE SUMMED EXTRACT FILE LAYOUT                                     
046100******************************************************************        
046200     COPY RCRD010.                                                        
046300                                                                          
045900******************************************************************        
046000*    DMM SUMMARY FILE LAYOUT                                              
046100******************************************************************        
046200     COPY RCRD044.                                                        
046300                                                                          
046400*****************************************************************         
046500* PROCEDURE DIVISION.                                           *         
046600*****************************************************************         
046700 PROCEDURE DIVISION.                                                      
046800                                                                          
046900 0000-MAINLINE-PROCESSING.                                                
047000                                                                          
047100     PERFORM 1000-INITIALIZATION.                                         
047200                                                                          
047300     PERFORM 2000-PROCESS-RECV-RPT-RECS                                   
047400       UNTIL PS-NO-MORE-RECV-RECS.                                        
047500                                                                          
072700     IF PV-VALID-DATE-CNT > ZERO                                          
047600         PERFORM 2200-PRINT-DPT-LNE                                       
047800         PERFORM 2300-PRINT-BYR-LNE                                       
048000         PERFORM 2400-PRINT-DMM-LNE                                       
048200         PERFORM 2600-PRINT-COR-LNE                                       
072700     END-IF.                                                              
048300                                                                          
048400     MOVE END-OF-REPORT-LINE     TO PV-PRINT-RECORD.                      
048500     MOVE +2                     TO PV-LINE-SPACING.                      
048600     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
048700                                                                          
048800     CLOSE STORE-SUMMED-EXTRACT-FILE                                      
048900           RECV-REPORT-FILE                                               
048900           DMM-SUMMARY-FILE.                                              
049000                                                                          
049100     STOP RUN.                                                            
049200                                                                          
049300                                                                          
049400******************************************************************        
049500** READ THE DB2 CONTROL TABLE AND READ THE FIRST ASN EXTRACT REC *        
049600******************************************************************        
049700 1000-INITIALIZATION.                                                     
049800                                                                          
049900     OPEN INPUT  STORE-SUMMED-EXTRACT-FILE                                
050000          OUTPUT RECV-REPORT-FILE                                         
050000          OUTPUT DMM-SUMMARY-FILE.                                        
050100                                                                          
121098     ACCEPT CC-CONTROL-CARD.                                              
050200     ACCEPT PV-CURR-DATE-YYMMDD FROM DATE.                                
050200     MOVE PV-CURR-DATE-YYMMDD   TO PV-TEST-DATE-YYMMDD.                   
050600     PERFORM 3000-DETERMINE-CENTURY.                                      
050200     MOVE PV-TEST-DATE-CCYYMMDD TO PV-CURR-DATE-CCYYMMDD.                 
050600                                                                          
050700     ACCEPT PV-CURR-TIME FROM TIME.                                       
050800                                                                          
050900     MOVE PV-CURR-DATE-MM        TO DP132O-RUN-MONTH.                     
051000     MOVE PV-CURR-DATE-DD        TO DP132O-RUN-DAY.                       
051100     MOVE PV-CURR-DATE-YY        TO DP132O-RUN-YEAR.                      
051200                                                                          
051300     MOVE PV-CURR-TIME-HH        TO DP132O-RUN-HOUR.                      
051400     MOVE PV-CURR-TIME-MM        TO DP132O-RUN-MINUTE.                    
051500     MOVE PC-CURRENT-PROGRAM-NAME                                         
051600                                 TO DP132O-PROGRAM-NAME.                  
051800                                                                          
121098     PERFORM 1200-FORMAT-HEADING.                                         
050600                                                                          
051700     PERFORM 2050-GET-RECV-RECORD                                         
051800                                                                          
047400     IF PS-NO-MORE-RECV-RECS                                              
052300         PERFORM 8000-PRINT-HEADINGS                                      
048400         MOVE EMPTY-REPORT-LINE  TO PV-PRINT-RECORD                       
048500         MOVE +2                 TO PV-LINE-SPACING                       
048600         PERFORM 8200-WRITE-RECV-RPT-LINE                                 
048700     ELSE                                                                 
051900         MOVE RC010-GMM-NBR      TO SAVE-GMM-NBR                          
051900         MOVE RC010-DMM-NBR      TO SAVE-DMM-NBR                          
052000         MOVE RC010-BUYER-NBR    TO SAVE-BYR-NBR                          
052100         MOVE RC010-DEPT-NBR     TO SAVE-DPT-NBR                          
052200         MOVE RC010-BUYER-NAME   TO SAVE-BYR-NAME                         
052300         MOVE RC010-DMM-NAME     TO SAVE-DMM-NAME                         
052300         MOVE RC010-GMM-NAME     TO SAVE-GMM-NAME                         
052300         PERFORM 8000-PRINT-HEADINGS                                      
048700     END-IF.                                                              
052400                                                                          
052400                                                                          
121498 1200-FORMAT-HEADING.                                                     
035620******************************************************************        
035630*    DETERMINE DATE RANGE AND FORMAT HEADING.                             
035640******************************************************************        
           IF CC-VALID-REPORT-TYPE                                              
               CONTINUE                                                         
           ELSE                                                                 
               DISPLAY '** ABEND **'                                            
               DISPLAY '** PROGRAM = RCKRP009 **'                               
               DISPLAY '** PARAGRAPH = 1200-FORMAT-HEADING. **'                 
               DISPLAY '** INVALID REPORT TYPE ***'                             
               DISPLAY '** REPORT TYPE= ' CC-REPORT-TYPE                        
               MOVE +4003 TO PV-ABEND-CODE                                      
               CALL 'ILBOABN0' USING PV-ABEND-CODE                              
           END-IF.                                                              
           SET DPG51-FISCAL-454-CALENDAR                                        
                                        TO TRUE                                 
           MOVE PV-CURR-DATE-CCYYMMDD   TO DPG52-LK-DATE-INPUT                  
           SET DPG52-LK-DTE-ISO         TO TRUE                                 
           IF CC-WEEKLY-REPORT                                                  
               SET DPG51-DECREMENT-DATE TO TRUE                                 
               MOVE 7                   TO DPG51-INCR-DECR-DAYS-9               
           ELSE                                                                 
               SET DPG51-DO-NOT-INCR-DECR-DATE                                  
                                        TO TRUE                                 
           END-IF.                                                              
                                                                                
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53            
                                                   DPG54 DPG55 DPG56            
                                                                                
           EVALUATE TRUE                                                        
               WHEN DPG54-NO-ERROR                                              
                   CONTINUE                                                     
               WHEN DPG54-DATE-INVALID                                          
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   DISPLAY '** ABEND **'                                        
                   DISPLAY '** PROGRAM = RCKRP009 -- CALLED MODULE '            
                           'DPKUT500 **'                                        
                   DISPLAY '** PARAGRAPH = 1200-FORMAT-HEADING **'              
                   DISPLAY '** DATE INVALID: ' PV-CURR-DATE-CCYYMMDD            
                   DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '            
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   MOVE +4003 TO PV-ABEND-CODE                                  
                   CALL 'ILBOABN0' USING PV-ABEND-CODE                          
               WHEN OTHER                                                       
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   DISPLAY '** ABEND **'                                        
                   DISPLAY '** PROGRAM = RCKRP009 -- CALLED MODULE '            
                           'DPKUT500 **'                                        
                   DISPLAY '** PARAGRAPH = 1200-FORMAT HEADING **'              
                   DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '            
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   MOVE +4003 TO PV-ABEND-CODE                                  
                   CALL 'ILBOABN0' USING PV-ABEND-CODE                          
           END-EVALUATE.                                                        
                                                                                
           IF CC-WEEKLY-REPORT                                                  
               MOVE DPG55-1ST-DAY-OF-WEEK      TO HL1-START-DATE                
               MOVE DPG55-LAST-DAY-OF-WEEK     TO HL1-END-DATE                  
           ELSE                                                                 
               PERFORM 1210-PREVIOUS-FISCAL-PRD                                 
           END-IF.                                                              
                                                                                
       1210-PREVIOUS-FISCAL-PRD.                                                
           MOVE DPG56-FISCAL-YEAR-CCYY  TO PV-FISCAL-PRD-CCYY                   
           MOVE DPG56-FISCAL-PERIOD-NBR TO PV-FISCAL-PRD-PP                     
           MOVE PV-FISCAL-PRD-CCYYPP    TO DPG52-LK-DATE-INPUT                  
           SET DPG52-LK-DTE-FISC-PRD-CC TO TRUE                                 
           MOVE 1                       TO DPG51-INCR-DECR-FISCAL-PRD-9         
           MOVE 0                       TO DPG51-INCR-DECR-DAYS-9               
           SET DPG51-DECREMENT-DATE     TO TRUE                                 
                                                                                
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53            
                                                   DPG54 DPG55 DPG56            
                                                                                
           EVALUATE TRUE                                                        
               WHEN DPG54-NO-ERROR                                              
                   CONTINUE                                                     
               WHEN DPG54-DATE-INVALID                                          
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   DISPLAY '** ABEND **'                                        
                   DISPLAY '** PROGRAM = RCKRP009 -- CALLED MODULE '            
                           'DPKUT500 **'                                        
                   DISPLAY '** PARAGRAPH = 1210-PREVIOUS-FISCAL-PRD **'         
                   DISPLAY '** DATE INVALID: ' PV-CURR-DATE-CCYYMMDD            
                   DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '            
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   MOVE +4003 TO PV-ABEND-CODE                                  
                   CALL 'ILBOABN0' USING PV-ABEND-CODE                          
               WHEN OTHER                                                       
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   DISPLAY '** ABEND **'                                        
                   DISPLAY '** PROGRAM = RCKRP009 -- CALLED MODULE '            
                           'DPKUT500 **'                                        
                   DISPLAY '** PARAGRAPH = 1210-PREVIOUS-FISCAL-PRD **'         
                   DISPLAY '** ERROR MESSAGE FROM CALLED MODULE: '              
                   DISPLAY DPG54-ERROR-MESSAGE                                  
                   MOVE +4003 TO PV-ABEND-CODE                                  
                   CALL 'ILBOABN0' USING PV-ABEND-CODE                          
               END-EVALUATE.                                                    
           MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO HL1-START-DATE                    
           MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO HL1-END-DATE.                     
                                                                                
                                                                                
052400                                                                          
052700******************************************************************        
052800*  PROCESS THE RECEIVING REPORT FILE.                            *        
052900*                                                                *        
053000******************************************************************        
053100 2000-PROCESS-RECV-RPT-RECS.                                              
053200                                                                          
053300     IF RC010-DMM-NBR        =   SAVE-DMM-NBR                             
053400         IF RC010-BUYER-NBR   =   SAVE-BYR-NBR                            
053500             IF RC010-DEPT-NBR =   SAVE-DPT-NBR                           
053600                 CONTINUE                                                 
053700             ELSE                                                         
053800                 PERFORM 2200-PRINT-DPT-LNE                               
053900                 MOVE RC010-DEPT-NBR TO SAVE-DPT-NBR                      
054000             END-IF                                                       
054100         ELSE                                                             
054200             PERFORM 2010-PROCESS-BREAK-ON-BYR                            
055500         END-IF                                                           
055600     ELSE                                                                 
054200         PERFORM 2020-PROCESS-BREAK-ON-DMM                                
121098     END-IF.                                                              
056800     PERFORM 2100-ACCUM-FIELDS                                            
057000     PERFORM 2050-GET-RECV-RECORD.                                        
057100                                                                          
053100 2010-PROCESS-BREAK-ON-BYR.                                               
057300******************************************************************        
057400*  PROCESS CONTROL BREAK ON BUYER NUMBER:                        *        
057400*    PRINT DETAIL LINE OF LAST DEPT TOTALS FOR LAST BUYER.       *        
057400*    PRINT SUB TOTAL LINE FOR LAST BUYER.                        *        
057400*    PRINT HEADING LINE FOR NEW BUYER.                           *        
057500******************************************************************        
057100                                                                          
054200     PERFORM 2200-PRINT-DPT-LNE.                                          
054300     PERFORM 2300-PRINT-BYR-LNE.                                          
057100                                                                          
054700     MOVE RC010-DEPT-NBR   TO SAVE-DPT-NBR.                               
054800     MOVE RC010-BUYER-NBR  TO SAVE-BYR-NBR.                               
054900     MOVE RC010-BUYER-NAME TO SAVE-BYR-NAME.                              
057100                                                                          
062700*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062600*** IS THERE ROOM FOR BYR HEADING AND 1ST DPT LINE ON SAME PAGE?          
062600*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062800     MOVE PV-LINE-CNT      TO PV-LINE-CNT-AHEAD.                          
062800     ADD +5                TO PV-LINE-CNT-AHEAD.                          
062800     IF PV-LINE-CNT-AHEAD > PC-LINE-LIMIT                                 
062900        PERFORM 8000-PRINT-HEADINGS                                       
063000     ELSE                                                                 
054500        MOVE +3            TO PV-LINE-SPACING                             
055100        PERFORM 8010-PRINT-BYR-HEAD                                       
063000     END-IF.                                                              
057100                                                                          
053100 2020-PROCESS-BREAK-ON-DMM.                                               
057300******************************************************************        
057400*  PROCESS CONTROL BREAK ON BUYER NUMBER:                        *        
057400*    PRINT DETAIL LINE OF LAST DEPT OF LAST BUYER FOR LAST DMM.  *        
057400*    PRINT SUB TOTAL LINE OF LAST BUYER FOR LAST DMM.            *        
057400*    PRINT HEADINGS FOR NEW DMM ON NEW PAGE.                     *        
 57500******************************************************************        
055700     PERFORM 2200-PRINT-DPT-LNE.                                          
055800     PERFORM 2300-PRINT-BYR-LNE.                                          
055900     PERFORM 2400-PRINT-DMM-LNE.                                          
056000     MOVE RC010-DEPT-NBR      TO SAVE-DPT-NBR.                            
056100     MOVE RC010-BUYER-NBR     TO SAVE-BYR-NBR.                            
056200     MOVE RC010-GMM-NBR       TO SAVE-GMM-NBR.                            
056200     MOVE RC010-DMM-NBR       TO SAVE-DMM-NBR.                            
056300     MOVE RC010-BUYER-NAME    TO SAVE-BYR-NAME.                           
056400     MOVE RC010-GMM-NAME      TO SAVE-GMM-NAME.                           
056400     MOVE RC010-DMM-NAME      TO SAVE-DMM-NAME.                           
056500     PERFORM 8000-PRINT-HEADINGS.                                         
057100                                                                          
057100 2050-GET-RECV-RECORD.                                                    
057300******************************************************************        
057400*  READ AN INPUT REC                                                      
 57500******************************************************************        
051700     PERFORM 7000-READ-INPUT                                              
057100                                                                          
121098     IF PS-MORE-RECV-RECS                                                 
121098         ADD +1                 TO PV-VALID-DATE-CNT                      
121098     END-IF.                                                              
057100                                                                          
057200 2100-ACCUM-FIELDS.                                                       
057300******************************************************************        
057400*  ADD QUANTITIES FROM CURRENT INPUT REC TO ALL RUNNING TOTALS.  *        
057500******************************************************************        
057600                                                                          
057700     ADD RC010-VRFYD-CNT        TO PV-DPT-VRFYD-QTY                       
057800                                   PV-BYR-VRFYD-QTY                       
057900                                   PV-DMM-VRFYD-QTY                       
058000                                   PV-COR-VRFYD-QTY.                      
058100                                                                          
058200     IF RC010-GOH-IND = 'Y'                                               
058300        ADD RC010-VRFYD-CNT     TO PV-DPT-GOH-QTY                         
058400                                   PV-BYR-GOH-QTY                         
058500                                   PV-DMM-GOH-QTY                         
058600                                   PV-COR-GOH-QTY                         
058700     END-IF.                                                              
058800                                                                          
058900     IF RC010-PRE-TKT-IND = 'Y'                                           
059000        ADD RC010-VRFYD-CNT     TO PV-DPT-PRETKT-QTY                      
059100                                   PV-BYR-PRETKT-QTY                      
059200                                   PV-DMM-PRETKT-QTY                      
059300                                   PV-COR-PRETKT-QTY                      
059400     END-IF.                                                              
059500                                                                          
059600     EVALUATE RC010-PKGNG-CDE                                             
059700         WHEN 'S'                                                         
059800             ADD RC010-VRFYD-CNT   TO PV-DPT-SINGLE-QTY                   
059800                                      PV-BYR-SINGLE-QTY                   
059900                                      PV-DMM-SINGLE-QTY                   
060000                                      PV-COR-SINGLE-QTY                   
060100         WHEN 'M'                                                         
060200             ADD RC010-VRFYD-CNT   TO PV-DPT-MULTI-QTY                    
060200                                      PV-BYR-MULTI-QTY                    
060300                                      PV-DMM-MULTI-QTY                    
060400                                      PV-COR-MULTI-QTY                    
060500         WHEN 'I'                                                         
060600             ADD RC010-VRFYD-CNT   TO PV-DPT-INNER-QTY                    
060600                                      PV-BYR-INNER-QTY                    
060700                                      PV-DMM-INNER-QTY                    
060800                                      PV-COR-INNER-QTY                    
060900         WHEN 'B'                                                         
061000             ADD RC010-VRFYD-CNT   TO PV-DPT-BULK-QTY                     
061000                                      PV-BYR-BULK-QTY                     
061100                                      PV-DMM-BULK-QTY                     
061200                                      PV-COR-BULK-QTY                     
061300         WHEN 'C'                                                         
061400             ADD RC010-VRFYD-CNT   TO PV-DPT-CASE-QTY                     
061400                                      PV-BYR-CASE-QTY                     
061500                                      PV-DMM-CASE-QTY                     
061600                                      PV-COR-CASE-QTY                     
061700         WHEN 'P'                                                         
061800             ADD RC010-VRFYD-CNT   TO PV-DPT-PBS-QTY                      
061800                                      PV-BYR-PBS-QTY                      
061900                                      PV-DMM-PBS-QTY                      
062000                                      PV-COR-PBS-QTY                      
062100     END-EVALUATE.                                                        
062200                                                                          
LF0114     ADD RC010-CROSS-DOCK-QTY     TO PV-DPT-CROSS-DOCK-QTY                
LF0114                                     PV-BYR-CROSS-DOCK-QTY                
LF0114                                     PV-DMM-CROSS-DOCK-QTY                
LF0114                                     PV-COR-CROSS-DOCK-QTY.               
LF0114                                                                          
LF0114     ADD RC010-NON-CROSS-DOCK-QTY TO PV-DPT-NON-CROSS-DK-QTY              
LF0114                                     PV-BYR-NON-CROSS-DK-QTY              
LF0114                                     PV-DMM-NON-CROSS-DK-QTY              
LF0114                                     PV-COR-NON-CROSS-DK-QTY.             
LF0114                                                                          
                                                                                
062300 2200-PRINT-DPT-LNE.                                                      
062400******************************************************************        
062500*  THIS PARAGRAPH WILL PRINT THE DETAIL LINE FOR A DEPARTMENT.   *        
062600******************************************************************        
062700                                                                          
062700*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062600*** IS THERE ROOM FOR CURRENT LINE AND PERCENT LINE ON SAME PAGE?         
062600*** AND CROSS-DOCK TOTALS LINE ON SAME PAGE?                              
062600*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062800     MOVE PV-LINE-CNT TO PV-LINE-CNT-AHEAD.                               
062800     ADD +4           TO PV-LINE-CNT-AHEAD.                               
062800     IF PV-LINE-CNT-AHEAD > PC-LINE-LIMIT                                 
062900         PERFORM 8000-PRINT-HEADINGS                                      
063000     END-IF.                                                              
063100                                                                          
063200     MOVE SAVE-DPT-NBR         TO DL1-DPT-NBR.                            
063300     MOVE PV-DPT-VRFYD-QTY     TO DL1-VRFYD-QTY.                          
063400     MOVE PV-DPT-GOH-QTY       TO DL1-GOH-QTY.                            
063500     MOVE PV-DPT-PRETKT-QTY    TO DL1-PRETKT-QTY.                         
063600     MOVE PV-DPT-SINGLE-QTY    TO DL1-SINGLE-QTY.                         
063700     MOVE PV-DPT-MULTI-QTY     TO DL1-MULTI-QTY.                          
063800     MOVE PV-DPT-INNER-QTY     TO DL1-INNER-QTY.                          
063900     MOVE PV-DPT-BULK-QTY      TO DL1-BULK-QTY.                           
064000     MOVE PV-DPT-CASE-QTY      TO DL1-CASE-QTY.                           
064100     MOVE PV-DPT-PBS-QTY       TO DL1-PBS-QTY.                            
064200                                                                          
064300     MOVE DETAIL-LINE1         TO PV-PRINT-RECORD.                        
064400     MOVE +2                   TO PV-LINE-SPACING.                        
064500     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
064600                                                                          
064700     MOVE PV-DPT-VRFYD-QTY     TO PV-WRK-TOTAL-QTY.                       
064700     MOVE PV-DPT-GOH-QTY       TO PV-WRK-GOH-QTY.                         
064800     MOVE PV-DPT-PRETKT-QTY    TO PV-WRK-PRETKT-QTY.                      
064900     MOVE PV-DPT-SINGLE-QTY    TO PV-WRK-SINGLE-QTY.                      
065000     MOVE PV-DPT-MULTI-QTY     TO PV-WRK-MULTI-QTY.                       
065100     MOVE PV-DPT-INNER-QTY     TO PV-WRK-INNER-QTY.                       
065200     MOVE PV-DPT-BULK-QTY      TO PV-WRK-BULK-QTY.                        
065300     MOVE PV-DPT-CASE-QTY      TO PV-WRK-CASE-QTY.                        
065400     MOVE PV-DPT-PBS-QTY       TO PV-WRK-PBS-QTY.                         
065500                                                                          
065600     PERFORM 5000-PRINT-PERCENT-TOTAL-LINE.                               
                                                                                
      * * *  TOTAL FOR CROSS-DOCKABLE                                           
LF0114     MOVE PV-DPT-CROSS-DOCK-QTY TO T4-GROUP-TOTAL-1                       
LF0114                                   PV-PARTIAL-QTY.                        
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-1                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-1                      
           END-IF.                                                              
                                                                                
      * * *  TOTAL FOR NON CROSS-DOCKABLE                                       
LF0114     MOVE PV-DPT-NON-CROSS-DK-QTY TO T4-GROUP-TOTAL-2                     
LF0114                                     PV-PARTIAL-QTY.                      
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-2                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-2                      
           END-IF.                                                              
                                                                                
           MOVE GROUP-TOTAL-LINE4       TO PV-PRINT-RECORD.                     
064400     MOVE +1                      TO PV-LINE-SPACING.                     
064500     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
                                                                                
065700     INITIALIZE PV-DPT-ACCUM-FIELDS.                                      
065800                                                                          
065900 2300-PRINT-BYR-LNE.                                                      
066000******************************************************************        
066100*  THIS PARAGRAPH WILL PRINT THE BUYER SUBTOTAL LINE.            *        
066200******************************************************************        
066300                                                                          
066300*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062600*** IS THERE ROOM FOR CURRENT LINE, PERCENT LINE, AND                     
      *** CROSS-DOCK TOTALS LINE ON THE SAME PAGE?                              
062600*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062800     MOVE PV-LINE-CNT TO PV-LINE-CNT-AHEAD.                               
062800     ADD +4           TO PV-LINE-CNT-AHEAD.                               
062800     IF PV-LINE-CNT-AHEAD > PC-LINE-LIMIT                                 
066500         PERFORM 8000-PRINT-HEADINGS                                      
066600     END-IF.                                                              
066700                                                                          
066800     MOVE PV-BYR-VRFYD-QTY     TO T1-VRFYD-QTY.                           
066900     MOVE PV-BYR-GOH-QTY       TO T1-GOH-QTY.                             
067000     MOVE PV-BYR-PRETKT-QTY    TO T1-PRETKT-QTY.                          
067100     MOVE PV-BYR-SINGLE-QTY    TO T1-SINGLE-QTY.                          
067200     MOVE PV-BYR-MULTI-QTY     TO T1-MULTI-QTY.                           
067300     MOVE PV-BYR-INNER-QTY     TO T1-INNER-QTY.                           
067400     MOVE PV-BYR-BULK-QTY      TO T1-BULK-QTY.                            
067500     MOVE PV-BYR-CASE-QTY      TO T1-CASE-QTY.                            
067600     MOVE PV-BYR-PBS-QTY       TO T1-PBS-QTY.                             
067700                                                                          
067800     MOVE BYR-TOTAL-LINE1      TO PV-PRINT-RECORD.                        
067900     MOVE +2                   TO PV-LINE-SPACING.                        
068000     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
068100                                                                          
068200     MOVE PV-BYR-VRFYD-QTY     TO PV-WRK-TOTAL-QTY.                       
068300     MOVE PV-BYR-PRETKT-QTY    TO PV-WRK-PRETKT-QTY.                      
068300     MOVE PV-BYR-GOH-QTY       TO PV-WRK-GOH-QTY.                         
068400     MOVE PV-BYR-SINGLE-QTY    TO PV-WRK-SINGLE-QTY.                      
068500     MOVE PV-BYR-MULTI-QTY     TO PV-WRK-MULTI-QTY.                       
068600     MOVE PV-BYR-INNER-QTY     TO PV-WRK-INNER-QTY.                       
068700     MOVE PV-BYR-BULK-QTY      TO PV-WRK-BULK-QTY.                        
068800     MOVE PV-BYR-CASE-QTY      TO PV-WRK-CASE-QTY.                        
068900     MOVE PV-BYR-PBS-QTY       TO PV-WRK-PBS-QTY.                         
069000                                                                          
069100     PERFORM 5000-PRINT-PERCENT-TOTAL-LINE.                               
                                                                                
      * * *  TOTAL FOR CROSS-DOCKABLE                                           
LF0114     MOVE PV-BYR-CROSS-DOCK-QTY TO T4-GROUP-TOTAL-1                       
LF0114                                   PV-PARTIAL-QTY.                        
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-1                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-1                      
           END-IF.                                                              
                                                                                
      * * *  TOTAL FOR NON CROSS-DOCKABLE                                       
LF0114     MOVE PV-BYR-NON-CROSS-DK-QTY TO T4-GROUP-TOTAL-2                     
LF0114                                     PV-PARTIAL-QTY.                      
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-2                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-2                      
           END-IF.                                                              
                                                                                
           MOVE GROUP-TOTAL-LINE4       TO PV-PRINT-RECORD.                     
064400     MOVE +1                      TO PV-LINE-SPACING.                     
064500     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
                                                                                
069200     INITIALIZE PV-BYR-ACCUM-FIELDS.                                      
069300                                                                          
069400 2400-PRINT-DMM-LNE.                                                      
069500******************************************************************        
069600*  THIS PARAGRAPH WILL PRINT THE BUYER SUBTOTAL LINE.            *        
069700******************************************************************        
069800                                                                          
069800*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062600*** IS THERE ROOM FOR CURRENT LINE, PERCENT LINE, AND                     
      *** AND CROSS-DOCK TOTALS LINE ON THE SAME PAGE?                          
062600*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062800     MOVE PV-LINE-CNT TO PV-LINE-CNT-AHEAD.                               
062800     ADD +3           TO PV-LINE-CNT-AHEAD.                               
062800     IF PV-LINE-CNT-AHEAD > PC-LINE-LIMIT                                 
070000         PERFORM 8000-PRINT-HEADINGS                                      
070100     END-IF.                                                              
070200                                                                          
070300     MOVE SAVE-DMM-NBR         TO T2-DMM-NBR.                             
070400     MOVE PV-DMM-VRFYD-QTY     TO T2-VRFYD-QTY.                           
070500     MOVE PV-DMM-GOH-QTY       TO T2-GOH-QTY.                             
070600     MOVE PV-DMM-PRETKT-QTY    TO T2-PRETKT-QTY.                          
070700     MOVE PV-DMM-SINGLE-QTY    TO T2-SINGLE-QTY.                          
070800     MOVE PV-DMM-MULTI-QTY     TO T2-MULTI-QTY.                           
070900     MOVE PV-DMM-INNER-QTY     TO T2-INNER-QTY.                           
071000     MOVE PV-DMM-BULK-QTY      TO T2-BULK-QTY.                            
071100     MOVE PV-DMM-CASE-QTY      TO T2-CASE-QTY.                            
071200     MOVE PV-DMM-PBS-QTY       TO T2-PBS-QTY.                             
071300                                                                          
071400     MOVE DMM-TOTAL-LINE2      TO PV-PRINT-RECORD.                        
071500     MOVE +2                   TO PV-LINE-SPACING.                        
071600     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
071700                                                                          
071800     MOVE PV-DMM-VRFYD-QTY     TO PV-WRK-TOTAL-QTY.                       
071900     MOVE PV-DMM-PRETKT-QTY    TO PV-WRK-PRETKT-QTY.                      
071900     MOVE PV-DMM-GOH-QTY       TO PV-WRK-GOH-QTY.                         
072000     MOVE PV-DMM-SINGLE-QTY    TO PV-WRK-SINGLE-QTY.                      
072100     MOVE PV-DMM-MULTI-QTY     TO PV-WRK-MULTI-QTY.                       
072200     MOVE PV-DMM-INNER-QTY     TO PV-WRK-INNER-QTY.                       
072300     MOVE PV-DMM-BULK-QTY      TO PV-WRK-BULK-QTY.                        
072400     MOVE PV-DMM-CASE-QTY      TO PV-WRK-CASE-QTY.                        
072500     MOVE PV-DMM-PBS-QTY       TO PV-WRK-PBS-QTY.                         
072600                                                                          
072700     PERFORM 5000-PRINT-PERCENT-TOTAL-LINE.                               
048100                                                                          
      * * *  TOTAL FOR CROSS-DOCKABLE                                           
LF0114     MOVE PV-DMM-CROSS-DOCK-QTY TO T4-GROUP-TOTAL-1                       
LF0114                                   PV-PARTIAL-QTY.                        
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-1                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-1                      
           END-IF.                                                              
                                                                                
      * * *  TOTAL FOR NON CROSS-DOCKABLE                                       
LF0114     MOVE PV-DMM-NON-CROSS-DK-QTY TO T4-GROUP-TOTAL-2                     
LF0114                                     PV-PARTIAL-QTY.                      
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-2                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-2                      
           END-IF.                                                              
                                                                                
           MOVE GROUP-TOTAL-LINE4       TO PV-PRINT-RECORD.                     
064400     MOVE +1                      TO PV-LINE-SPACING.                     
064500     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
                                                                                
072700     IF PV-VALID-DATE-CNT > ZERO                                          
072700         PERFORM 6000-CREATE-DMM-SUMMARY-REC                              
072700     END-IF.                                                              
072800     INITIALIZE PV-DMM-ACCUM-FIELDS.                                      
072900                                                                          
073000 2600-PRINT-COR-LNE.                                                      
073100******************************************************************        
073200*  THIS PARAGRAPH WILL PRINT THE GRAND TOTAL LINE.               *        
073300******************************************************************        
073400                                                                          
073400*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062600*** IS THERE ROOM FOR CURRENT LINE, PERCENT LINE, AND                     
062600*** CROSS-DOCK TOTALS LINE ON THE SAME PAGE?                              
062600*** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         
062800     MOVE PV-LINE-CNT TO PV-LINE-CNT-AHEAD.                               
062800     ADD +4           TO PV-LINE-CNT-AHEAD.                               
062800     IF PV-LINE-CNT-AHEAD > PC-LINE-LIMIT                                 
073600         PERFORM 8000-PRINT-HEADINGS                                      
073700     END-IF.                                                              
073800                                                                          
073900     MOVE PV-COR-VRFYD-QTY     TO T3-VRFYD-QTY.                           
074000     MOVE PV-COR-GOH-QTY       TO T3-GOH-QTY.                             
074100     MOVE PV-COR-PRETKT-QTY    TO T3-PRETKT-QTY.                          
074200     MOVE PV-COR-SINGLE-QTY    TO T3-SINGLE-QTY.                          
074300     MOVE PV-COR-MULTI-QTY     TO T3-MULTI-QTY.                           
074400     MOVE PV-COR-INNER-QTY     TO T3-INNER-QTY.                           
074500     MOVE PV-COR-BULK-QTY      TO T3-BULK-QTY.                            
074600     MOVE PV-COR-CASE-QTY      TO T3-CASE-QTY.                            
074700     MOVE PV-COR-PBS-QTY       TO T3-PBS-QTY.                             
074800                                                                          
074900     MOVE COR-TOTAL-LINE3      TO PV-PRINT-RECORD.                        
075000     MOVE +2                   TO PV-LINE-SPACING.                        
075100     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
075200                                                                          
075300     MOVE PV-COR-VRFYD-QTY     TO PV-WRK-TOTAL-QTY.                       
075400     MOVE PV-COR-PRETKT-QTY    TO PV-WRK-PRETKT-QTY.                      
075400     MOVE PV-COR-GOH-QTY       TO PV-WRK-GOH-QTY.                         
075500     MOVE PV-COR-SINGLE-QTY    TO PV-WRK-SINGLE-QTY.                      
075600     MOVE PV-COR-MULTI-QTY     TO PV-WRK-MULTI-QTY.                       
075700     MOVE PV-COR-INNER-QTY     TO PV-WRK-INNER-QTY.                       
075800     MOVE PV-COR-BULK-QTY      TO PV-WRK-BULK-QTY.                        
075900     MOVE PV-COR-CASE-QTY      TO PV-WRK-CASE-QTY.                        
076000     MOVE PV-COR-PBS-QTY       TO PV-WRK-PBS-QTY.                         
076100                                                                          
076200     PERFORM 5000-PRINT-PERCENT-TOTAL-LINE.                               
048100                                                                          
      * * *  TOTAL FOR CROSS-DOCKABLE                                           
LF0114     MOVE PV-COR-CROSS-DOCK-QTY TO T4-GROUP-TOTAL-1                       
LF0114                                   PV-PARTIAL-QTY.                        
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-1                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-1                      
           END-IF.                                                              
                                                                                
      * * *  TOTAL FOR NON CROSS-DOCKABLE                                       
LF0114     MOVE PV-COR-NON-CROSS-DK-QTY TO T4-GROUP-TOTAL-2                     
LF0114                                     PV-PARTIAL-QTY.                      
                                                                                
           IF PV-PARTIAL-QTY > ZERO                                             
               PERFORM 5010-CALCULATE-PERCENT                                   
               MOVE  PV-PERCENT-SHIFTED TO T4-GROUP-PCNT-2                      
           ELSE                                                                 
               MOVE ZERO                TO T4-GROUP-PCNT-2                      
           END-IF.                                                              
                                                                                
           MOVE GROUP-TOTAL-LINE4       TO PV-PRINT-RECORD.                     
064400     MOVE +1                      TO PV-LINE-SPACING.                     
064500     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
076100                                                                          
090400 3000-DETERMINE-CENTURY.                                                  
090500******************************************************************        
090600*  DERTERMINE THE CENTURY OF A YYMMDD DATE BASED ON PIVOT YEAR.  *        
090700******************************************************************        
022300     IF PV-TEST-DATE-YY > 80                                              
022300          MOVE 19 TO PV-TEST-DATE-CC                                      
022300     ELSE                                                                 
022300          MOVE 20 TO PV-TEST-DATE-CC                                      
022300     END-IF.                                                              
076100                                                                          
076400                                                                          
076500 5000-PRINT-PERCENT-TOTAL-LINE.                                           
076600******************************************************************        
076700*  CALCULATE PERCENTAGES OF ACCUMULATED TOTALS.                  *        
076800*  FORMAT THE PERCENT LINE WITH CALCULATED RESULTS.              *        
076900*  PERFORM PARAGRAPH TO PRINT THE PERCENT LINE.                  *        
077000******************************************************************        
077100                                                                          
077200     MOVE ZEROES                      TO PL-PRE-TKT-PCNT                  
077300                                         PL-GOH-PCNT                      
077300                                         PL-SINGLE-PCNT                   
077400                                         PL-MULTI-PCNT                    
077500                                         PL-INNER-PCNT                    
077600                                         PL-BULK-PCNT                     
077700                                         PL-CASE-PCNT                     
077800                                         PL-PBS-PCNT.                     
077900                                                                          
078000     IF PV-WRK-TOTAL-QTY > ZERO                                           
078100         IF PV-WRK-PRETKT-QTY > ZERO                                      
078200             MOVE  PV-WRK-PRETKT-QTY  TO PV-PARTIAL-QTY                   
078300             PERFORM 5010-CALCULATE-PERCENT                               
078400             MOVE  PV-PERCENT-SHIFTED TO PL-PRE-TKT-PCNT                  
078500         END-IF                                                           
078100         IF PV-WRK-GOH-QTY > ZERO                                         
078200             MOVE  PV-WRK-GOH-QTY     TO PV-PARTIAL-QTY                   
078300             PERFORM 5010-CALCULATE-PERCENT                               
078400             MOVE  PV-PERCENT-SHIFTED TO PL-GOH-PCNT                      
078500         END-IF                                                           
078600         IF PV-WRK-SINGLE-QTY > ZERO                                      
078700             MOVE  PV-WRK-SINGLE-QTY  TO PV-PARTIAL-QTY                   
078800             PERFORM 5010-CALCULATE-PERCENT                               
078900             MOVE  PV-PERCENT-SHIFTED TO PL-SINGLE-PCNT                   
079000         END-IF                                                           
079100         IF PV-WRK-MULTI-QTY > ZERO                                       
079200             MOVE  PV-WRK-MULTI-QTY   TO PV-PARTIAL-QTY                   
079300             PERFORM 5010-CALCULATE-PERCENT                               
079400             MOVE  PV-PERCENT-SHIFTED TO PL-MULTI-PCNT                    
079500         END-IF                                                           
079600         IF PV-WRK-INNER-QTY > ZERO                                       
079700             MOVE  PV-WRK-INNER-QTY   TO PV-PARTIAL-QTY                   
079800             PERFORM 5010-CALCULATE-PERCENT                               
079900             MOVE  PV-PERCENT-SHIFTED TO PL-INNER-PCNT                    
080000         END-IF                                                           
080100         IF PV-WRK-BULK-QTY > ZERO                                        
080200             MOVE  PV-WRK-BULK-QTY    TO PV-PARTIAL-QTY                   
080300             PERFORM 5010-CALCULATE-PERCENT                               
080400             MOVE  PV-PERCENT-SHIFTED TO PL-BULK-PCNT                     
080500         END-IF                                                           
080600         IF PV-WRK-CASE-QTY > ZERO                                        
080700             MOVE  PV-WRK-CASE-QTY    TO PV-PARTIAL-QTY                   
080800             PERFORM 5010-CALCULATE-PERCENT                               
080900             MOVE  PV-PERCENT-SHIFTED TO PL-CASE-PCNT                     
081000         END-IF                                                           
081100         IF PV-WRK-PBS-QTY > ZERO                                         
081200             MOVE  PV-WRK-PBS-QTY     TO PV-PARTIAL-QTY                   
081300             PERFORM 5010-CALCULATE-PERCENT                               
081400             MOVE  PV-PERCENT-SHIFTED TO PL-PBS-PCNT                      
081500         END-IF                                                           
081600     END-IF.                                                              
081700                                                                          
081800     MOVE PL-PERCENT-LINE             TO PV-PRINT-RECORD.                 
081900     MOVE +1                          TO PV-LINE-SPACING.                 
082000     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
082100                                                                          
082200                                                                          
082300 5010-CALCULATE-PERCENT.                                                  
082400******************************************************************        
082500*  CALCULATE A PERCENTAGE OF A TOTAL QUANTITY                    *        
082600******************************************************************        
082700                                                                          
082800     COMPUTE PV-PERCENT-DECIMAL ROUNDED =                                 
082900         PV-PARTIAL-QTY / PV-WRK-TOTAL-QTY.                               
083000                                                                          
083100     COMPUTE PV-PERCENT-SHIFTED =                                         
083200         PV-PERCENT-DECIMAL * 100.                                        
083300                                                                          
083400                                                                          
082300 6000-CREATE-DMM-SUMMARY-REC.                                             
082400******************************************************************        
082500*  FORMAT THE DMM SUMMARY RECORD.                                *        
082500*  PERFORM A PARAGRAPH TO WRITE THE OUTPUT RECORD.               *        
082600******************************************************************        
083400                                                                          
083400     MOVE SPACES                  TO RC044-REC.                           
070300     MOVE SAVE-GMM-NBR            TO RC044-GMM-NBR.                       
070300     MOVE SAVE-DMM-NBR            TO RC044-DMM-NBR.                       
070300     MOVE SAVE-GMM-NAME           TO RC044-GMM-NAME.                      
070300     MOVE SAVE-DMM-NAME           TO RC044-DMM-NAME.                      
070400     MOVE PV-DMM-VRFYD-QTY        TO RC044-VRFYD-QTY.                     
070500     MOVE PV-DMM-GOH-QTY          TO RC044-GOH-QTY.                       
070600     MOVE PV-DMM-PRETKT-QTY       TO RC044-PRETKT-QTY.                    
070700     MOVE PV-DMM-SINGLE-QTY       TO RC044-SINGLE-QTY.                    
070800     MOVE PV-DMM-MULTI-QTY        TO RC044-MULTI-QTY.                     
070900     MOVE PV-DMM-INNER-QTY        TO RC044-INNER-QTY.                     
071000     MOVE PV-DMM-BULK-QTY         TO RC044-BULK-QTY.                      
071100     MOVE PV-DMM-CASE-QTY         TO RC044-CASE-QTY.                      
071200     MOVE PV-DMM-PBS-QTY          TO RC044-PBS-QTY.                       
LF0114     MOVE PV-DMM-CROSS-DOCK-QTY   TO RC044-CROSS-DOCK-QTY.                
LF0114     MOVE PV-DMM-NON-CROSS-DK-QTY TO RC044-NON-CROSS-DOCK-QTY.            
LF0114                                                                          
082700     PERFORM 6100-WRITE-DMM-SUMMARY-RECORD.                               
083400                                                                          
083400                                                                          
082300 6100-WRITE-DMM-SUMMARY-RECORD.                                           
082400******************************************************************        
082500*  WRITE THE OUTPUT DMM SUMMARY RECORD.                          *        
082600******************************************************************        
082600                                                                          
082600     WRITE DMM-SUMMARY-RECORD                                             
082600         FROM RC044-REC.                                                  
082600                                                                          
083500******************************************************************        
083600*  READ THE ASN EXTRACT RECORDS.                                 *        
083700******************************************************************        
083800 7000-READ-INPUT.                                                         
083900                                                                          
084000     MOVE '7000'                  TO PGM-LOCATION.                        
084100     MOVE '7000-READ-INPUT           '                                    
084200                                  TO PV-ABEND-PARAGRAPH.                  
084300                                                                          
084400     READ STORE-SUMMED-EXTRACT-FILE                                       
084500       INTO RC010-REC                                                     
084600         AT END                                                           
084700           SET PS-NO-MORE-RECV-RECS TO TRUE.                              
084800                                                                          
084900                                                                          
085000 8000-PRINT-HEADINGS.                                                     
085100******************************************************************        
085200*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SUBSEQUENT   *        
085300*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *        
085400******************************************************************        
085500                                                                          
085600     ADD 1                        TO PV-PAGE-CNT.                         
085700                                                                          
085800     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.                  
085900                                                                          
086000     MOVE PC-REPORT-NBR-1        TO DP132O-REPORT-NUMBER.                 
086100     MOVE DP132O-STANDRD-HEADER-132-COLS                                  
086200                                 TO PV-PRINT-RECORD.                      
086300     PERFORM 8100-WRITE-RPT-TOP-OF-PAGE.                                  
086400                                                                          
086500     MOVE HEADING-LINE-0         TO PV-PRINT-RECORD.                      
086600     MOVE +1                     TO PV-LINE-SPACING.                      
086700     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
086800                                                                          
086500     MOVE HEADING-LINE-1         TO PV-PRINT-RECORD.                      
086600     MOVE +1                     TO PV-LINE-SPACING.                      
086700     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
086800                                                                          
086900     MOVE SAVE-DMM-NBR            TO HL2-DMM-NBR.                         
087000     MOVE SAVE-DMM-NAME           TO HL2-DMM-NAME.                        
087100                                                                          
087200     MOVE HEADING-LINE-2         TO PV-PRINT-RECORD.                      
087300     MOVE +2                     TO PV-LINE-SPACING.                      
087400     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
087500                                                                          
089100     MOVE +1                     TO PV-LINE-SPACING.                      
087600     PERFORM 8010-PRINT-BYR-HEAD.                                         
087700                                                                          
087800     MOVE HEADING-LINE-4         TO PV-PRINT-RECORD.                      
087900     MOVE +1                     TO PV-LINE-SPACING.                      
088000     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
088100                                                                          
087800     MOVE HEADING-LINE-5         TO PV-PRINT-RECORD.                      
087900     MOVE +1                     TO PV-LINE-SPACING.                      
088000     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
088100                                                                          
088200     MOVE HEADING-LINE-6         TO PV-PRINT-RECORD.                      
088300     MOVE +1                     TO PV-LINE-SPACING.                      
088400     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
088500                                                                          
088600 8010-PRINT-BYR-HEAD.                                                     
089500******************************************************************        
089600*  PRINT BUYER HEADING AFTER PAGE BREAK OR BUYER CONTROL BREAK.  *        
089600*  NOTE:  PV-LINE-SPACING IS SET BY CALLING PARAGRAPH.           *        
089700******************************************************************        
088700     MOVE SAVE-BYR-NBR            TO HL3-BYR-NBR.                         
088800     MOVE SAVE-BYR-NAME           TO HL3-BYR-NAME.                        
088900                                                                          
089000     MOVE HEADING-LINE-3         TO PV-PRINT-RECORD.                      
089200     PERFORM 8200-WRITE-RECV-RPT-LINE.                                    
089300                                                                          
089400 8100-WRITE-RPT-TOP-OF-PAGE.                                              
089500******************************************************************        
089600*  WRITE FIRST REPORT LINE AFTER PAGE BREAK.                     *        
089700******************************************************************        
089800                                                                          
089900     WRITE RECV-REPORT-RECORD                                             
090000       FROM PV-PRINT-RECORD                                               
090100         AFTER ADVANCING PAGE.                                            
090200     MOVE +1             TO PV-LINE-CNT.                                  
090300                                                                          
090400 8200-WRITE-RECV-RPT-LINE.                                                
090500******************************************************************        
090600*  WRITE REPORT LINE AFTER ADVANCING LINE SPACING.               *        
090700******************************************************************        
090800                                                                          
090900     WRITE RECV-REPORT-RECORD                                             
091000       FROM PV-PRINT-RECORD                                               
091100         AFTER ADVANCING PV-LINE-SPACING.                                 
091200                                                                          
091300     ADD PV-LINE-SPACING TO PV-LINE-CNT.                                  
091400                                                                          
