000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.      RCKUP925.                                       00020000
000300 AUTHOR.          RON KRIER.                                      00030000
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040000
000500 DATE-WRITTEN.    APRIL 2020.                                     00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*  THIS PROGRAM WAS COPIED FROM RCKUP919 TO START WITH.          *00080000
000900*                                                                *00090000
001000*  THIS PROGRAM WAS WRITTEN IN EARLY 2020 FOR THE PURPOSE OF     *00100000
001100*  BEING ABLE TO TAKE RECEIVERS FOR A TRAILER THAT HAVE ALREADY  *00110000
001200*  BEEN TRANSCRIBED FOR THE BRICK AND MORTAR STORES AND CHANGE   *00120000
001300*  THE RECEIVERS SO THAT THEY CAN BE RECEIVED AT AN EFC.         *00130000
001400*                                                                *00140000
001500*  PROGRAM RCKUP919 WILL TAKE IN THE SAME INPUT FILE AS THIS     *00150000
001600*  PROGRAM AND THAT PROGRAM WILL BE USED TO UPDATE THE           *00160000
001700*  OPER UNIT ID FIELDS ON VARIOUS TABLES TO CHANGE RECEIVER AND  *00170000
001800*  INBOUND TRIP LEVEL DATA FROM ONE DC TO ANOTHER.               *00180000
001900*                                                                *00190000
002000*  THIS PROGRAM WILL BE USED TO DEAL WITH THE STORE LEVEL DATA   *00200000
002100*  THEN FOR THE SAME RECEIVERS ON THE INPUT FILE.  THIS PROGRAM  *00210000
002200*  WILL CHANGE THE STORE NUMBERS ON PACKSLIPS AND INBOUND        *00220000
002300*  CARTON DATA TO BE THE CHANGE TO STORE NUMBER IN THE RECORD    *00230000
002400*  ON THE INPUT FILE.  THIS PROGRAM WILL ALSO THEN ZERO OUT THE  *00240000
002500*  THE QUANTITY FIELDS ON THE TRECDIS TABLE FOR THE RECEIVERS    *00250000
002600*  AND THEN INSERT A ROW INTO THE TRECDIS TABLE FOR EACH LINE    *00260000
002700*  FOR THE RECEIVER FOR THE 'CHANGE TO' STORE ON THE INPUT       *00270000
002800*  RECORD.                                                       *00280000
003400*                                                                *00340000
004000******************************************************************00400000
004100 ENVIRONMENT DIVISION.                                            00410000
004200 CONFIGURATION SECTION.                                           00420000
004300 SOURCE-COMPUTER. IBM-3090.                                       00430000
004400 OBJECT-COMPUTER. IBM-3090.                                       00440000
004500                                                                  00450000
004600 INPUT-OUTPUT SECTION.                                            00460000
004700 FILE-CONTROL.                                                    00470000
004800     SELECT INPUT-FILE                                            00480000
004900         ASSIGN TO INP01.                                         00490000
005000                                                                  00500000
005100                                                                  00510000
005200 DATA DIVISION.                                                   00520000
005300 FILE SECTION.                                                    00530000
005400 FD  INPUT-FILE                                                   00540000
005500     LABEL RECORDS ARE STANDARD                                   00550000
005600     RECORDING MODE IS F                                          00560000
005700     BLOCK CONTAINS 0 RECORDS                                     00570000
005800     RECORD CONTAINS 80 CHARACTERS.                               00580000
005900 01  INPUT-RECORD                    PIC X(80).                   00590000
006000                                                                  00600000
006100                                                                  00610000
006200 WORKING-STORAGE SECTION.                                         00620000
006300                                                                  00630000
006400 01  ABEND-CODE                       PIC S9(04)     VALUE +0     00640000
006500                                                     COMP SYNC.   00650000
006600     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00660000
006700                                                                  00670000
006800 01  PS-PROGRAM-SWITCHES.                                         00680000
006900     05  PS-END-OF-INPUT-SW           PIC X          VALUE 'N'.   00690000
007000         88  PS-NOT-END-OF-INPUT                     VALUE 'N'.   00700000
007100         88  PS-END-OF-INPUT                         VALUE 'Y'.   00710000
007200     05  PS-END-OF-CRTN-CURSOR-SW     PIC X          VALUE 'N'.   00720002
007300         88  PS-NOT-END-OF-CRTN-CURSOR               VALUE 'N'.   00730002
007400         88  PS-END-OF-CRTN-CURSOR                   VALUE 'Y'.   00740002
007410     05  PS-END-OF-LL-CURSOR-SW       PIC X          VALUE 'N'.   00741002
007420         88  PS-NOT-END-OF-LL-CURSOR                 VALUE 'N'.   00742002
007430         88  PS-END-OF-LL-CURSOR                     VALUE 'Y'.   00743002
007500     05  PS-CHECK-CASEPACK-SW         PIC X          VALUE 'N'.   00750000
007600         88  PS-CASEPACK-NOT-RUN                     VALUE 'N'.   00760000
007700         88  PS-CASEPACK-RUN                         VALUE 'Y'.   00770000
007800     05  PS-DATA-ISSUE-SW             PIC X          VALUE 'N'.   00780000
007900         88  PS-DATA-ISSUE-FOUND                     VALUE 'Y'.   00790000
008000         88  PS-DATA-ISSUE-NOT-FOUND                 VALUE 'N'.   00800000
008100     05  PS-RCVR-ACTIVITY-SW          PIC X          VALUE 'N'.   00810000
008200         88  PS-RCVR-ACTIVITY-FOUND                  VALUE 'Y'.   00820000
008300         88  PS-NO-RCVR-ACTIVITY-FOUND               VALUE 'N'.   00830000
008400     05  PS-RCVR-CM-VE-STATUS-SW      PIC X          VALUE 'N'.   00840000
008500         88  PS-RCVR-CM-VE-STATUS-FOUND              VALUE 'Y'.   00850000
008600         88  PS-RCVR-NO-CM-VE-STATUS                 VALUE 'N'.   00860000
008700     05  PS-IB-CART-ACTIVITY-SW       PIC X          VALUE 'N'.   00870000
008800         88  PS-IB-CART-ACTIVITY-FOUND               VALUE 'Y'.   00880000
008900         88  PS-NO-IB-CART-ACTIVITY                  VALUE 'N'.   00890000
009000     05  PS-OB-CART-ACTIVITY-SW       PIC X          VALUE 'N'.   00900000
009100         88  PS-OB-CART-ACTIVITY-FOUND               VALUE 'Y'.   00910000
009200         88  PS-NO-OB-CART-ACTIVITY                  VALUE 'N'.   00920000
009210     05  PS-STORE-ON-TRECDIS-SW       PIC X          VALUE 'N'.   00921001
009220         88  PS-STORE-ON-TRECDIS                     VALUE 'Y'.   00922001
009230         88  PS-STORE-NOT-ON-TRECDIS                 VALUE 'N'.   00923001
009240     05  PS-LOC-ORGN-FOUND-SW         PIC X          VALUE 'N'.   00924003
009250         88  PS-LOC-ORGN-FOUND                       VALUE 'Y'.   00925003
009260         88  PS-LOC-ORGN-NOT-FOUND                   VALUE 'N'.   00926003
009270     05  PS-LOC-DEST-FOUND-SW         PIC X          VALUE 'N'.   00927003
009280         88  PS-LOC-DEST-FOUND                       VALUE 'Y'.   00928003
009290         88  PS-LOC-DEST-NOT-FOUND                   VALUE 'N'.   00929003
009291     05  PS-LOC-FOUND-SW              PIC X          VALUE 'N'.   00929103
009292         88  PS-LOC-FOUND                            VALUE 'Y'.   00929203
009293         88  PS-LOC-NOT-FOUND                        VALUE 'N'.   00929303
009300                                                                  00930000
009400 01  PV-PROGRAM-VARIABLES.                                        00940000
009500     05  PV-DB2-FUNCTION              PIC  X(30)     VALUE SPACES.00950000
009600     05  PV-PARAGRAPH                 PIC  X(30)     VALUE SPACES.00960000
009700     05  PV-READ-COUNT                PIC S9(09)     COMP-3       00970000
009800                                                     VALUE ZERO.  00980000
009900     05  PV-READ-PROCESS-COUNT        PIC S9(09)     COMP-3       00990000
010000                                                     VALUE ZERO.  01000000
010100     05  PV-READ-BYPASS-COUNT         PIC S9(09)     COMP-3       01010000
010200                                                     VALUE ZERO.  01020000
010300     05  PV-ROW-COUNT                 PIC S9(09)     COMP-3       01030000
010400                                                     VALUE ZERO.  01040000
010410     05  PV-PREV-SHPUNT-ORGN          PIC S9(04) VALUE +0         01041003
010420                                                 COMP.            01042003
010430     05  PV-PREV-SHPUNT-DEST          PIC S9(04) VALUE +0         01043003
010440                                                 COMP.            01044003
010450     05  PV-LOC-ORGN-TYPE-CDE         PIC  X(02)     VALUE SPACES.01045003
010460     05  PV-LOC-DEST-TYPE-CDE         PIC  X(02)     VALUE SPACES.01046003
010500     05  PV-FCLTY-AREA-ID-NULL        PIC S9(04) VALUE +0         01050000
010600                                                 COMP.            01060000
010700     05  PV-TKT-FMT-ID-NULL           PIC S9(04) VALUE +0         01070000
010800                                                 COMP.            01080000
010900     05  UPDATE-COUNT                 PIC S9(09)     COMP-3       01090000
011000                                                     VALUE ZERO.  01100000
011100     05  PV-COMMIT-COUNT              PIC S9(09)     COMP-3       01110000
011200                                                     VALUE ZERO.  01120000
011300     05  FETCH-COUNT                  PIC S9(09)     COMP-3       01130000
011400                                                     VALUE ZERO.  01140000
011410     05  PV-RECDIS-INSERT-COUNT       PIC S9(09)     COMP-3       01141002
011411                                                     VALUE ZERO.  01141102
011412     05  PV-RECDIS-UPDATE-COUNT       PIC S9(09)     COMP-3       01141202
011420                                                     VALUE ZERO.  01142002
011500     05  PV-ROW-COUNT-DISPLAY         PIC ZZZ,ZZZ,ZZ9             01150000
011600                                                     VALUE ZERO.  01160000
011700     05  UPDATE-COUNT-DISPLAY         PIC ZZZ,ZZZ,ZZ9             01170000
011800                                                     VALUE ZERO.  01180000
011900     05  COMMIT-COUNT-DISPLAY         PIC ZZZ,ZZZ,ZZ9             01190000
012000                                                     VALUE ZERO.  01200000
012100     05  FETCH-COUNT-DISPLAY          PIC ZZZ,ZZZ,ZZ9             01210000
012200                                                     VALUE ZERO.  01220000
012300     05  PV-PREV-TRIP-ID              PIC 9(10)      VALUE ZERO.  01230000
012400     05  PV-PREV-SCAC                 PIC X(04)      VALUE SPACES.01240000
012500     05  PV-PREV-TRLR                 PIC X(10)      VALUE SPACES.01250000
012600     05  PV-DISPLAY-FIELD-5           PIC 99999      VALUE ZERO.  01260000
012700     05  PV-DISPLAY-FIELD-5A          PIC 99999      VALUE ZERO.  01270000
012800     05  PV-DISPLAY-FIELD-5B          PIC 99999      VALUE ZERO.  01280000
012900     05  PV-DISPLAY-SQLCODE           PIC 99999-     VALUE ZERO.  01290000
013000     05  PV-DISPLAY-CARTON            PIC 999999999999999999.     01300000
013010     05  PV-CSR-ORD-NBR               PIC  S9(9) COMP  VALUE ZERO.01301001
013020     05  PV-CSR-ORD-LNE-NBR           PIC  S9(9) COMP  VALUE ZERO.01302001
013030     05  PV-CSR-REC-SEQ-NBR           PIC  S9(9) COMP  VALUE ZERO.01303001
013040     05  PV-CSR-OPER-UNT-ID           PIC  S9(4) COMP  VALUE ZERO.01304001
013050     05  PV-CSR-FCLTY-ID              PIC  S9(4) COMP  VALUE ZERO.01305001
013090     05  PV-CSR-EXPTED-ITM-QTY        PIC  S9(9) COMP  VALUE ZERO.01309001
013091     05  PV-CSR-VERIFY-ITM-QTY        PIC  S9(9) COMP  VALUE ZERO.01309101
013092     05  PV-CSR-AP-VERIFY-ITM-QTY     PIC  S9(9) COMP  VALUE ZERO.01309201
013095     05  PV-CSR-PLAN-ITM-QTY          PIC  S9(4) COMP  VALUE ZERO.01309501
013096                                                                  01309603
013097 01  DK-DATABASE-KEYS.                                            01309703
013098     05  DK-LOC-NBR                   PIC S9(04) VALUE +0         01309803
013099                                                 COMP.            01309903
013100                                                                  01310000
013200 01  WS-INPUT-RECORD.                                             01320000
013300     05  WS-IR-PO-NBR                PIC 9(08).                   01330000
013400     05  FILLER                      PIC X(01).                   01340000
013500     05  WS-IR-RCVR-NBR              PIC 9(04).                   01350000
013600     05  FILLER                      PIC X(01).                   01360000
013700     05  WS-IR-OPER-CHG-TO           PIC 9(04).                   01370000
013800     05  FILLER                      PIC X(01).                   01380000
013900     05  WS-IR-CRE-OPER-CHG-TO       PIC 9(04).                   01390000
014000     05  FILLER                      PIC X(01).                   01400000
014100     05  WS-IR-CURR-OPER-CHG-TO      PIC 9(04).                   01410000
014200     05  FILLER                      PIC X(01).                   01420000
014300     05  WS-IR-STOR-CHG-TO           PIC 9(04).                   01430000
014400     05  FILLER                      PIC X(01).                   01440000
014500     05  WS-IR-OPER-SET              PIC 9(04).                   01450000
014600     05  FILLER                      PIC X(01).                   01460000
014700     05  WS-IR-SCAC                  PIC X(04).                   01470000
014800     05  FILLER                      PIC X(01).                   01480000
014900     05  WS-IR-TRLR                  PIC X(10).                   01490000
015000     05  FILLER                      PIC X(01).                   01500000
015100     05  WS-IR-TRIP-ID               PIC 9(10).                   01510000
015200     05  FILLER                      PIC X(15).                   01520000
015300                                                                  01530000
015400 01  PC-PROGRAM-CONSTANTS.                                        01540000
015500     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)       VALUE        01550000
015600                                                     'RCKUP925'.  01560000
015700                                                                  01570000
015800******************************************************************01580000
015900*  DB2 MESSAGE AREAS                                              01590000
016000******************************************************************01600000
016100     COPY DPWS004.                                                01610000
016200                                                                  01620000
016300     EXEC SQL                                                     01630000
016400         INCLUDE TSHPUNT                                          01640000
016500     END-EXEC.                                                    01650000
016600                                                                  01660000
016700     EXEC SQL                                                     01670000
016800         INCLUDE TINPKSU                                          01680000
016900     END-EXEC.                                                    01690000
017000                                                                  01700000
017100     EXEC SQL                                                     01710000
017200         INCLUDE TPKSLIP                                          01720000
017300     END-EXEC.                                                    01730000
017400                                                                  01740000
017500     EXEC SQL                                                     01750000
017600         INCLUDE TRECEIV                                          01760000
017700     END-EXEC.                                                    01770000
017800                                                                  01780000
017900     EXEC SQL                                                     01790000
018000         INCLUDE TRECITM                                          01800000
018100     END-EXEC.                                                    01810000
018200                                                                  01820000
018300     EXEC SQL                                                     01830000
018400         INCLUDE TRECDIS                                          01840000
018500     END-EXEC.                                                    01850000
020600                                                                  02060000
020700     EXEC SQL                                                     02070000
020800         INCLUDE TDISTHD                                          02080000
020900     END-EXEC.                                                    02090000
021000                                                                  02100000
021100     EXEC SQL                                                     02110000
021200         INCLUDE TSHUNLO                                          02120000
021300     END-EXEC.                                                    02130000
021400                                                                  02140000
021500*    SUT_OTBND_CART OUTBOUND CARTON TABLE                         02150000
021600                                                                  02160000
021700     EXEC SQL                                                     02170000
021800          INCLUDE SUT00024                                        02180000
021900     END-EXEC.                                                    02190000
022000                                                                  02200000
022100*    SUT_OTBND_UPC OUTBOUND CARTON UPC TABLE                      02210000
022200                                                                  02220000
022300     EXEC SQL                                                     02230000
022400          INCLUDE SUT00028                                        02240000
022500     END-EXEC.                                                    02250000
022510                                                                  02251003
022520*    XLT_LOC TABLE                                                02252003
022530                                                                  02253003
022540     EXEC SQL                                                     02254003
022550         INCLUDE XLT00010                                         02255003
022560     END-EXEC.                                                    02256003
022600                                                                  02260000
022700******************************************************************02270000
022800*    DB2 COMMUNICATIONS AREA                                      02280000
022900******************************************************************02290000
023000                                                                  02300000
023100     EXEC SQL                                                     02310000
023200         INCLUDE SQLCA                                            02320000
023300     END-EXEC.                                                    02330000
023400                                                                  02340002
023410******************************************************************02341002
023420*    CURSOR TO GET INBOUND CARTON ENTRIES                         02342002
023430******************************************************************02343002
023440     EXEC SQL                                                     02344002
023450       DECLARE CARTON-CSR CURSOR FOR                              02345002
023451        SELECT A.PO_NBR                                           02345102
023452              ,A.REC_SEQ_NBR                                      02345202
023453              ,A.SEQ_NBR                                          02345302
023454              ,A.STR_DEST_NBR                                     02345402
023455              ,C.SHIPT_UNT_ID                                     02345502
023456              ,C.ORGN_OPER_UNT_ID                                 02345602
023457              ,C.DEST_OPER_UNT_ID                                 02345702
023492        FROM   TPKSLIP A                                          02349202
023493              ,TINPKSU B                                          02349302
023494              ,TSHPUNT C                                          02349402
023495        WHERE A.PO_NBR        = :PKSLIP-PO-NBR                    02349502
023496          AND A.REC_SEQ_NBR   = :PKSLIP-REC-SEQ-NBR               02349602
023497          AND A.VER_STAT_CDE  = 'A'                               02349702
023498          AND A.PKSL_STAT_CDE = 'AC'                              02349802
023499          AND B.PO_NBR        = A.PO_NBR                          02349902
023500          AND B.SEQ_NBR       = A.SEQ_NBR                         02350002
023501          AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                    02350102
023502        ORDER BY 3                                                02350202
023503     END-EXEC.                                                    02350302
023504                                                                  02350402
023510******************************************************************02351000
023600*    CURSOR TO GET RECEIVER ITEM LEVEL ENTRIES                    02360001
023700******************************************************************02370000
023800     EXEC SQL                                                     02380000
023900       DECLARE LINE-LEVEL-CSR CURSOR FOR                          02390001
024110        SELECT A.ORD_NBR , A.REC_SEQ_NBR , A.ORD_LNE_NBR          02411001
024120             , A.STATUS_CDE , A.OPER_UNT_ID, A.FCLTY_ID           02412001
024130             , SUM(B.EXPTED_ITM_QTY), SUM(B.VERIFY_ITM_QTY)       02413001
024140             , SUM(B.AP_VERIFY_ITM_QTY), SUM(B.PLAN_ITM_QTY)      02414001
024150          FROM TRECITM A                                          02415001
024160             , TRECDIS B                                          02416001
024170        WHERE A.ORD_NBR        = :RECITM-ORD-NBR                  02417001
024180          AND A.REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR              02418001
024190          AND A.VER_STATUS_CDE = 'A'                              02419001
024191          AND B.ORD_NBR        = A.ORD_NBR                        02419101
024192          AND B.REC_SEQ_NBR    = A.REC_SEQ_NBR                    02419201
024193          AND B.ORD_LNE_NBR    = A.ORD_LNE_NBR                    02419301
024194        GROUP BY A.ORD_NBR , A.REC_SEQ_NBR , A.ORD_LNE_NBR        02419401
024195               , A.STATUS_CDE , A.OPER_UNT_ID, A.FCLTY_ID         02419501
024196        ORDER BY 1, 2, 3                                          02419601
025600     END-EXEC.                                                    02560000
025700                                                                  02570000
025800******************************************************************02580000
025900 PROCEDURE DIVISION.                                              02590000
026000******************************************************************02600000
026100                                                                  02610000
026200 0000-MAIN-MODULE.                                                02620000
026300                                                                  02630000
026400     DISPLAY '** START OF PROGRAM RCKUP925 **'.                   02640000
026500                                                                  02650000
026600     OPEN INPUT  INPUT-FILE.                                      02660000
026700                                                                  02670000
026800     INITIALIZE UPDATE-COUNT                                      02680000
026900                FETCH-COUNT.                                      02690000
027000                                                                  02700000
027100     PERFORM 2001-READ-INPUT-FILE.                                02710000
027200                                                                  02720000
027300     IF  PS-END-OF-INPUT                                          02730000
027400         DISPLAY ' '                                              02740000
027500         DISPLAY '***** INPUT FILE EMPTY *****'                   02750000
027600     END-IF.                                                      02760000
027700                                                                  02770000
027800     PERFORM 2000-PROCESS-INPUT-FILE                              02780000
027900       UNTIL PS-END-OF-INPUT.                                     02790000
028000                                                                  02800000
028100     DISPLAY ' '.                                                 02810000
028200     MOVE PV-READ-COUNT TO PV-DISPLAY-FIELD-5.                    02820000
028300     DISPLAY 'TOTAL INPUT RECORDS READ     :  '                   02830000
028400         PV-DISPLAY-FIELD-5.                                      02840000
028500     MOVE PV-READ-PROCESS-COUNT TO PV-DISPLAY-FIELD-5.            02850000
028600     DISPLAY 'TOTAL INPUT RECORDS PROCESSED:  '                   02860000
028700         PV-DISPLAY-FIELD-5.                                      02870000
028800     MOVE PV-READ-BYPASS-COUNT TO PV-DISPLAY-FIELD-5.             02880000
028900     DISPLAY 'TOTAL INPUT RECORDS BYPASSED :  '                   02890000
029000         PV-DISPLAY-FIELD-5.                                      02900000
029100     MOVE PV-COMMIT-COUNT TO PV-DISPLAY-FIELD-5.                  02910000
029200     DISPLAY 'TOTAL COMMITS EXECUTED       :  '                   02920000
029300         PV-DISPLAY-FIELD-5.                                      02930000
029400                                                                  02940000
029500     CLOSE INPUT-FILE.                                            02950000
029600                                                                  02960000
029700     IF  PS-DATA-ISSUE-FOUND                                      02970000
029800         MOVE 4008 TO RETURN-CODE                                 02980000
029900     END-IF.                                                      02990000
030000                                                                  03000000
030100     GOBACK.                                                      03010000
030200                                                                  03020000
030300 2000-PROCESS-INPUT-FILE.                                         03030000
030400                                                                  03040000
030500     DISPLAY ' '.                                                 03050000
030600     MOVE PV-READ-COUNT TO PV-DISPLAY-FIELD-5.                    03060000
030700     DISPLAY 'STARTING TO PROCESS RECORD NUMBER:  '               03070000
030800         PV-DISPLAY-FIELD-5.                                      03080000
030900     DISPLAY 'PO NBR       : ' WS-IR-PO-NBR.                      03090000
031000     DISPLAY 'RCVR NBR     : ' WS-IR-RCVR-NBR.                    03100000
031100     DISPLAY 'OPER NBR     : ' WS-IR-OPER-CHG-TO.                 03110000
031200     DISPLAY 'CRE OPER NBR : ' WS-IR-CRE-OPER-CHG-TO.             03120000
031300     DISPLAY 'CURR OPER NBR: ' WS-IR-CURR-OPER-CHG-TO.            03130000
031400     DISPLAY 'STOR NBR     : ' WS-IR-STOR-CHG-TO.                 03140000
031500     DISPLAY 'OPSET        : ' WS-IR-OPER-SET.                    03150000
031600     DISPLAY 'SCAC         : ' WS-IR-SCAC.                        03160000
031700     DISPLAY 'TRLR         : ' WS-IR-TRLR.                        03170000
031800     DISPLAY 'TRIP         : ' WS-IR-TRIP-ID.                     03180000
031900                                                                  03190000
032000     SET PS-NO-RCVR-ACTIVITY-FOUND TO TRUE.                       03200000
032100     PERFORM 5000-CHECK-RECEIVER-ACTIVITY.                        03210000
032200                                                                  03220000
032300     IF  PS-RCVR-ACTIVITY-FOUND                                   03230000
032400         DISPLAY 'ACTIVITY FOUND FOR THIS '                       03240000
032500                 'PO ' WS-IR-PO-NBR ' RECEIVER '                  03250000
032600                 WS-IR-RCVR-NBR                                   03260000
032700         DISPLAY '** WILL NOT PROCESS THIS RECORD **'             03270000
032800         ADD +1 TO PV-READ-BYPASS-COUNT                           03280000
032900     ELSE                                                         03290000
033000         ADD +1 TO PV-READ-PROCESS-COUNT                          03300000
033100         PERFORM 2020-PROCESS-RECORD                              03310000
033200         PERFORM 2030-COMMIT-DB2                                  03320000
033300     END-IF.                                                      03330000
033400                                                                  03340000
033500     PERFORM 2001-READ-INPUT-FILE.                                03350000
033600                                                                  03360000
033700 2001-READ-INPUT-FILE.                                            03370000
033800                                                                  03380000
033900     READ INPUT-FILE INTO WS-INPUT-RECORD                         03390000
034000        AT END                                                    03400000
034100           SET PS-END-OF-INPUT TO TRUE.                           03410000
034200                                                                  03420000
034300     IF  PS-END-OF-INPUT                                          03430000
034400         NEXT SENTENCE                                            03440000
034500     ELSE                                                         03450000
034600         ADD +1 TO PV-READ-COUNT                                  03460000
034610         MOVE ZEROS TO PV-PREV-SHPUNT-ORGN                        03461005
034620                       PV-PREV-SHPUNT-DEST                        03462005
034630         MOVE SPACES TO PV-LOC-ORGN-TYPE-CDE                      03463005
034640                        PV-LOC-DEST-TYPE-CDE                      03464005
034700     END-IF.                                                      03470000
034800                                                                  03480000
034900 2020-PROCESS-RECORD.                                             03490000
034910                                                                  03491001
034911     PERFORM 2335-UPDATE-PBS-TPKSLIP.                             03491102
034912                                                                  03491202
034913     INITIALIZE UPDATE-COUNT FETCH-COUNT.                         03491302
034914     SET PS-NOT-END-OF-CRTN-CURSOR TO TRUE.                       03491402
034915     PERFORM 2400-OPEN-CRTN-CURSOR.                               03491502
034916     PERFORM 2500-FETCH-CRTN-CURSOR.                              03491602
034917                                                                  03491702
034918     PERFORM 2600-PROCESS-CARTONS                                 03491802
034919         UNTIL PS-END-OF-CRTN-CURSOR.                             03491902
034920     PERFORM 2700-CLOSE-CRTN-CURSOR.                              03492002
034921     MOVE UPDATE-COUNT TO UPDATE-COUNT-DISPLAY.                   03492102
034922     MOVE FETCH-COUNT TO FETCH-COUNT-DISPLAY.                     03492202
034923     DISPLAY 'CURSOR NBR OF CARTONS EXTRACTED:  ' FETCH-COUNT.    03492302
034924     DISPLAY 'CURSOR NBR OF CARTONS UPDATED  :  ' UPDATE-COUNT.   03492402
034925                                                                  03492502
034926     INITIALIZE UPDATE-COUNT FETCH-COUNT.                         03492602
034928     SET PS-NOT-END-OF-LL-CURSOR TO TRUE.                         03492801
034929     PERFORM 4000-OPEN-LL-CURSOR.                                 03492902
034930     PERFORM 4100-FETCH-LL-CURSOR.                                03493002
034931                                                                  03493101
034932     PERFORM 4200-PROCESS-LINES                                   03493202
034933         UNTIL PS-END-OF-LL-CURSOR.                               03493301
034934     PERFORM 4300-CLOSE-LL-CURSOR.                                03493402
034935     MOVE UPDATE-COUNT TO UPDATE-COUNT-DISPLAY.                   03493501
034936     MOVE FETCH-COUNT TO FETCH-COUNT-DISPLAY.                     03493601
034937     DISPLAY 'CURSOR NBR OF LINES EXTRACTED:  ' FETCH-COUNT.      03493701
034938     DISPLAY 'CURSOR NBR OF LINES UPDATED  :  ' UPDATE-COUNT.     03493801
034939     INITIALIZE UPDATE-COUNT FETCH-COUNT.                         03493901
034950                                                                  03495001
039800 2030-COMMIT-DB2.                                                 03980000
039900                                                                  03990000
040000     EXEC SQL                                                     04000000
040100          COMMIT                                                  04010000
040200     END-EXEC.                                                    04020000
040300                                                                  04030000
040400     EVALUATE TRUE                                                04040000
040500         WHEN SQLCODE = ZEROS                                     04050000
040600              ADD +1 TO PV-COMMIT-COUNT                           04060000
040700         WHEN OTHER                                               04070000
040800             MOVE '2030-COMMIT-DB2          '                     04080000
040900                                    TO PV-PARAGRAPH               04090000
041000             MOVE 'COMMIT        ' TO PV-DB2-FUNCTION             04100000
041100             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   04110000
041200             DISPLAY '2030-COMMIT-DB2:  '                         04120000
041300                     PV-DISPLAY-SQLCODE                           04130000
041400             PERFORM 9900-DB2-ABEND                               04140000
041500     END-EVALUATE.                                                04150000
041600                                                                  04160000
054400                                                                  05440000
054500******************************************************************05450000
054600*    PERFORMS UPDATE OF OPER UNIT ID'S ON NON PACK-BY-STORE       05460000
054700*    PACKSLIPS                                                    05470000
054800******************************************************************05480000
054900 2335-UPDATE-PBS-TPKSLIP.                                         05490000
055000                                                                  05500000
055200     MOVE WS-IR-STOR-CHG-TO TO PKSLIP-STR-DEST-NBR.               05520000
055300                                                                  05530000
055400     MOVE WS-IR-PO-NBR      TO PKSLIP-PO-NBR.                     05540000
055500     MOVE WS-IR-RCVR-NBR    TO PKSLIP-REC-SEQ-NBR.                05550000
055600                                                                  05560000
055700     EXEC SQL                                                     05570000
055800        UPDATE TPKSLIP                                            05580000
056000          SET  STR_DEST_NBR      = :PKSLIP-STR-DEST-NBR           05600002
056100        WHERE  PO_NBR            = :PKSLIP-PO-NBR                 05610000
056200          AND  REC_SEQ_NBR       = :PKSLIP-REC-SEQ-NBR            05620000
056300          AND  STR_DEST_NBR      > 0                              05630000
056400     END-EXEC.                                                    05640000
056500                                                                  05650000
056600     EVALUATE TRUE                                                05660000
056700         WHEN SQLCODE = +0                                        05670000
056800              DISPLAY 'PBS TPKSLIP UPDATED'                       05680000
056900         WHEN SQLCODE = +100                                      05690000
057000              DISPLAY 'PBS TPKSLIP +100   '                       05700000
057100         WHEN OTHER                                               05710000
057200             MOVE '2335-UPDATE-PBS-TPKSLIP  '                     05720000
057300                                    TO PV-PARAGRAPH               05730000
057400             MOVE 'UPDATE PBS TPKSLIP' TO PV-DB2-FUNCTION         05740000
057500             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   05750000
057600             DISPLAY '2335-UPDATE-PBS-TPKSLIP SQLCODE:  '         05760000
057700                     PV-DISPLAY-SQLCODE                           05770000
057800             PERFORM 9900-DB2-ABEND                               05780000
057900     END-EVALUATE.                                                05790000
058000                                                                  05800000
058100                                                                  05810002
058300***************************************************************** 05830002
058400*    OPENS THE CURSOR TO GET ONE OR MORE ROWS FROM TRECDIS WHICH  05840002
058500*    CORRESPOND TO THE INPUT RECORD.                              05850002
058600***************************************************************** 05860002
058700 2400-OPEN-CRTN-CURSOR.                                           05870002
058800                                                                  05880002
058900     MOVE WS-IR-PO-NBR   TO PKSLIP-PO-NBR.                        05890002
059000     MOVE WS-IR-RCVR-NBR TO PKSLIP-REC-SEQ-NBR.                   05900002
059100                                                                  05910002
059200     EXEC SQL                                                     05920002
059300         OPEN CARTON-CSR                                          05930002
059400     END-EXEC.                                                    05940002
059500                                                                  05950002
059600     EVALUATE TRUE                                                05960002
059700         WHEN SQLCODE = +0                                        05970002
059800             CONTINUE                                             05980002
059900         WHEN OTHER                                               05990002
060000             MOVE '2400-OPEN-CRTN-CURSOR'                         06000002
060100                                    TO PV-PARAGRAPH               06010002
060200             MOVE 'OPEN CARTON-CSR' TO PV-DB2-FUNCTION            06020002
060300             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   06030002
060400             DISPLAY '2400-OPEN-CRTN-CURSOR SQLCODE:  '           06040002
060500                     PV-DISPLAY-SQLCODE                           06050002
060600             PERFORM 9900-DB2-ABEND                               06060002
060700     END-EVALUATE.                                                06070002
060800                                                                  06080002
060900***************************************************************** 06090002
061000*    PROCESSES THE ROWS FROM TRECDIS WHICH CORRESPOND TO THE      06100002
061100*    INPUT RECORD.                                                06110002
061200***************************************************************** 06120002
061300 2500-FETCH-CRTN-CURSOR.                                          06130002
061400                                                                  06140002
061500     EXEC SQL                                                     06150002
061600         FETCH CARTON-CSR                                         06160002
061610         INTO  :PKSLIP-PO-NBR                                     06161006
061620              ,:PKSLIP-REC-SEQ-NBR                                06162006
061630              ,:PKSLIP-SEQ-NBR                                    06163006
061640              ,:PKSLIP-STR-DEST-NBR                               06164006
061650              ,:SHPUNT-SHIPT-UNT-ID                               06165006
061660              ,:SHPUNT-ORGN-OPER-UNT-ID                           06166006
061670              ,:SHPUNT-DEST-OPER-UNT-ID                           06167006
062200     END-EXEC.                                                    06220002
062300                                                                  06230002
062400     EVALUATE TRUE                                                06240002
062500         WHEN SQLCODE = +0                                        06250002
062600             ADD +1 TO FETCH-COUNT                                06260002
062700         WHEN SQLCODE = +100                                      06270002
062800             SET PS-END-OF-CRTN-CURSOR TO TRUE                    06280004
062900         WHEN OTHER                                               06290002
063000             MOVE '2500-FETCH-CRTN-CURSOR'                        06300002
063100                                    TO PV-PARAGRAPH               06310002
063200             MOVE 'FETCH CARTON-CSR' TO PV-DB2-FUNCTION           06320002
063300             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   06330002
063400             DISPLAY '2500-FETCH-CRTN-CURSOR SQLCODE:  '          06340002
063500                     PV-DISPLAY-SQLCODE                           06350002
063600             PERFORM 9900-DB2-ABEND                               06360002
063700     END-EVALUATE.                                                06370002
063800                                                                  06380002
063900                                                                  06390002
064000***************************************************************** 06400002
064100*    PROCESSES THE CARTONS FROM THE CARTON-CSR                    06410002
064200***************************************************************** 06420002
064300 2600-PROCESS-CARTONS.                                            06430002
064400                                                                  06440003
064970     PERFORM 2610-CHECK-SHPUNT-LOC.                               06497003
064980                                                                  06498003
064990     IF  PV-LOC-DEST-TYPE-CDE = 'DC'                              06499003
064991         NEXT SENTENCE                                            06499103
064994     ELSE                                                         06499403
064995         MOVE WS-IR-STOR-CHG-TO TO SHPUNT-DEST-OPER-UNT-ID        06499503
064996         PERFORM 2650-UPDATE-TSHPUNT                              06499603
064998     END-IF.                                                      06499803
064999                                                                  06499903
065000     PERFORM 2500-FETCH-CRTN-CURSOR.                              06500004
065001                                                                  06500103
065002 2610-CHECK-SHPUNT-LOC.                                           06500203
065003                                                                  06500303
065025     IF  SHPUNT-DEST-OPER-UNT-ID = 0                              06502503
065026         MOVE 'DC' TO PV-LOC-DEST-TYPE-CDE                        06502603
065027     ELSE                                                         06502703
065028         IF  SHPUNT-DEST-OPER-UNT-ID = PV-PREV-SHPUNT-DEST        06502803
065029             NEXT SENTENCE                                        06502903
065030         ELSE                                                     06503003
065031             SET PS-LOC-NOT-FOUND TO TRUE                         06503103
065032             MOVE SHPUNT-DEST-OPER-UNT-ID TO DK-LOC-NBR           06503203
065033             PERFORM 2620-SELECT-XLT-LOC                          06503303
065034             IF  PS-LOC-FOUND                                     06503403
065035                 MOVE XLT00010-LOC-TYP-CDE TO                     06503503
065036                      PV-LOC-DEST-TYPE-CDE                        06503603
065037                 MOVE SHPUNT-DEST-OPER-UNT-ID TO                  06503703
065038                      PV-PREV-SHPUNT-DEST                         06503803
065039             ELSE                                                 06503903
065040                 MOVE 'DC' TO PV-LOC-DEST-TYPE-CDE                06504003
065041                 MOVE 0 TO PV-PREV-SHPUNT-DEST                    06504103
065042             END-IF                                               06504203
065043         END-IF                                                   06504303
065044     END-IF.                                                      06504403
065045                                                                  06504503
065046 2620-SELECT-XLT-LOC.                                             06504603
065047                                                                  06504703
065048     EXEC SQL                                                     06504803
065049        SELECT LOC_TYP_CDE                                        06504903
065050          INTO :XLT00010-LOC-TYP-CDE                              06505003
065051        FROM   XLT_LOC                                            06505103
065052        WHERE  LOC_NBR           = :DK-LOC-NBR                    06505203
065053     END-EXEC.                                                    06505303
065054                                                                  06505403
065055     EVALUATE TRUE                                                06505503
065056         WHEN SQLCODE = +0                                        06505603
065057              SET PS-LOC-FOUND TO TRUE                            06505703
065058         WHEN SQLCODE = +100                                      06505803
065059              SET PS-LOC-NOT-FOUND TO TRUE                        06505903
065060         WHEN OTHER                                               06506003
065061             MOVE '2620-SELECT-XLT-LOC'                           06506103
065062                                    TO PV-PARAGRAPH               06506203
065063             MOVE DK-LOC-NBR TO PV-DISPLAY-FIELD-5                06506303
065064             DISPLAY 'LOC NUMBER BEING SELECTED:  '               06506403
065065                     PV-DISPLAY-FIELD-5                           06506503
065066             MOVE 'SELECT XLT_LOC' TO PV-DB2-FUNCTION             06506603
065067             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   06506703
065068             DISPLAY '2620-SELECT-XLT-LOC SQLCODE:  '             06506803
065069                     PV-DISPLAY-SQLCODE                           06506903
065070             PERFORM 9900-DB2-ABEND                               06507003
065071     END-EVALUATE.                                                06507103
065072                                                                  06507203
065080                                                                  06508002
065100***************************************************************** 06510002
065200*    UPDATE THE OPER UNIT IT FOR THE CARTON                       06520002
065300***************************************************************** 06530002
065400 2650-UPDATE-TSHPUNT.                                             06540002
065500                                                                  06550002
065600     EXEC SQL                                                     06560002
065700        UPDATE TSHPUNT                                            06570002
065800          SET  DEST_OPER_UNT_ID  = :SHPUNT-DEST-OPER-UNT-ID       06580002
065900        WHERE  SHIPT_UNT_ID      = :SHPUNT-SHIPT-UNT-ID           06590002
066000     END-EXEC.                                                    06600002
066100                                                                  06610002
066200     EVALUATE TRUE                                                06620002
066300         WHEN SQLCODE = +0                                        06630002
066400             ADD +1 TO UPDATE-COUNT                               06640002
066500         WHEN OTHER                                               06650002
066600             MOVE '2650-UPDATE-TSHPUNT      '                     06660002
066700                                    TO PV-PARAGRAPH               06670002
066800             MOVE 'UPDATE TSHPUNT' TO PV-DB2-FUNCTION             06680002
066900             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   06690002
067000             DISPLAY '2650-UPDATE-TSHPUNT SQLCODE:  '             06700002
067100                     PV-DISPLAY-SQLCODE                           06710002
067200             PERFORM 9900-DB2-ABEND                               06720002
067300     END-EVALUATE.                                                06730002
067400                                                                  06740002
067500***************************************************************** 06750002
067600*    CLOSES THE CURSOR.                                           06760002
067700***************************************************************** 06770002
067800 2700-CLOSE-CRTN-CURSOR.                                          06780002
067900                                                                  06790002
068000     EXEC SQL                                                     06800002
068100         CLOSE CARTON-CSR                                         06810002
068200     END-EXEC.                                                    06820002
068300                                                                  06830002
068400     EVALUATE TRUE                                                06840002
068500         WHEN SQLCODE = +0                                        06850002
068600             CONTINUE                                             06860002
068700         WHEN OTHER                                               06870002
068800             MOVE '2700-CLOSE-CRTN-CURSOR '                       06880002
068900                                    TO PV-PARAGRAPH               06890002
069000             MOVE 'CLOSE CARTON-CSR' TO PV-DB2-FUNCTION           06900002
069100             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   06910002
069200             DISPLAY '2700-CLOSE-CRTN-CURSOR SQLCODE:  '          06920002
069300                     PV-DISPLAY-SQLCODE                           06930002
069400             PERFORM 9900-DB2-ABEND                               06940002
069500     END-EVALUATE.                                                06950002
069600                                                                  06960002
077000***************************************************************** 07700000
077100*    OPENS THE CURSOR TO GET THE LINES ATTACHED TO THE RECEIVER   07710001
077200*    CORRESPONDING TO THE INPUT RECORD.                           07720001
077300***************************************************************** 07730000
077400 4000-OPEN-LL-CURSOR.                                             07740002
077500                                                                  07750000
077600     MOVE WS-IR-PO-NBR   TO RECITM-ORD-NBR.                       07760001
077700     MOVE WS-IR-RCVR-NBR TO RECITM-REC-SEQ-NBR.                   07770001
077800                                                                  07780000
077900     EXEC SQL                                                     07790000
078000         OPEN LINE-LEVEL-CSR                                      07800001
078100     END-EXEC.                                                    07810000
078200                                                                  07820000
078300     EVALUATE TRUE                                                07830000
078400         WHEN SQLCODE = +0                                        07840000
078500             CONTINUE                                             07850000
078600         WHEN OTHER                                               07860000
078700             MOVE '4000-OPEN-LL-CURSOR'                           07870002
078800                                    TO PV-PARAGRAPH               07880000
078900             MOVE 'OPEN LINE-LEVEL-CSR' TO PV-DB2-FUNCTION        07890001
079000             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   07900000
079100             DISPLAY '4000-OPEN-LL-CURSOR SQLCODE:  '             07910002
079200                     PV-DISPLAY-SQLCODE                           07920000
079300             PERFORM 9900-DB2-ABEND                               07930000
079400     END-EVALUATE.                                                07940000
079500                                                                  07950000
079600***************************************************************** 07960000
079700*    PROCESSES THE ROWS FROM LINE LEVEL CURSOR WHICH              07970001
079800*    CORRESPOND TO THE INPUT RECORD.                              07980001
079900***************************************************************** 07990000
080000 4100-FETCH-LL-CURSOR.                                            08000002
080100                                                                  08010000
080200     EXEC SQL                                                     08020000
080300         FETCH LINE-LEVEL-CSR                                     08030001
080310         INTO  :PV-CSR-ORD-NBR                                    08031001
080330              ,:PV-CSR-REC-SEQ-NBR                                08033001
080331              ,:PV-CSR-ORD-LNE-NBR                                08033101
080332              ,:RECITM-STATUS-CDE                                 08033201
080340              ,:PV-CSR-OPER-UNT-ID                                08034001
080350              ,:PV-CSR-FCLTY-ID                                   08035001
080360              ,:PV-CSR-EXPTED-ITM-QTY                             08036001
080370              ,:PV-CSR-VERIFY-ITM-QTY                             08037001
080380              ,:PV-CSR-AP-VERIFY-ITM-QTY                          08038001
080390              ,:PV-CSR-PLAN-ITM-QTY                               08039001
080900     END-EXEC.                                                    08090000
081000                                                                  08100000
081100     EVALUATE TRUE                                                08110000
081200         WHEN SQLCODE = +0                                        08120000
081300             ADD +1 TO FETCH-COUNT                                08130000
081400         WHEN SQLCODE = +100                                      08140000
081500             SET PS-END-OF-LL-CURSOR TO TRUE                      08150001
081600         WHEN OTHER                                               08160000
081700             MOVE '4100-FETCH-LL-CURSOR'                          08170002
081800                                    TO PV-PARAGRAPH               08180000
081900             MOVE 'FETCH LINE-LEVEL-CSR' TO PV-DB2-FUNCTION       08190001
082000             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   08200000
082100             DISPLAY '4100-FETCH-LL-CURSOR SQLCODE:  '            08210002
082200                     PV-DISPLAY-SQLCODE                           08220000
082300             PERFORM 9900-DB2-ABEND                               08230000
082400     END-EVALUATE.                                                08240000
082500                                                                  08250000
082600                                                                  08260000
082700***************************************************************** 08270000
082800*    PROCESSES THE LINES FROM THE LINE LEVEL CURSOR               08280001
082900***************************************************************** 08290000
083000 4200-PROCESS-LINES.                                              08300002
083100                                                                  08310000
083101     SET PS-STORE-NOT-ON-TRECDIS TO TRUE.                         08310101
083110     PERFORM 4400-CHECK-IF-STR-ON-TRECDIS.                        08311004
083120                                                                  08312001
083200     MOVE WS-IR-OPER-CHG-TO TO SHPUNT-ORGN-OPER-UNT-ID            08320000
083300                                                                  08330000
083400     PERFORM 4500-ZERO-OUT-TRECDIS.                               08340002
083500                                                                  08350000
083510     IF  PS-STORE-NOT-ON-TRECDIS                                  08351001
083520         PERFORM 4600-INSERT-TRECDIS                              08352002
083530     ELSE                                                         08353001
083540         PERFORM 4700-UPDATE-TRECDIS                              08354002
083550     END-IF.                                                      08355001
083560                                                                  08356001
083600     PERFORM 4100-FETCH-LL-CURSOR.                                08360002
083700                                                                  08370000
086100                                                                  08610000
086200***************************************************************** 08620000
086300*    CLOSES THE CURSOR.                                           08630000
086400***************************************************************** 08640000
086500 4300-CLOSE-LL-CURSOR.                                            08650002
086600                                                                  08660000
086700     EXEC SQL                                                     08670000
086800         CLOSE LINE-LEVEL-CSR                                     08680002
086900     END-EXEC.                                                    08690000
087000                                                                  08700000
087100     EVALUATE TRUE                                                08710000
087200         WHEN SQLCODE = +0                                        08720000
087300             CONTINUE                                             08730000
087400         WHEN OTHER                                               08740000
087500             MOVE '4300-CLOSE-LL-CURSOR '                         08750002
087600                                    TO PV-PARAGRAPH               08760000
087700             MOVE 'CLOSE LINE-LEVEL-CSR' TO PV-DB2-FUNCTION       08770002
087800             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   08780000
087900             DISPLAY '4300-CLOSE-LL-CURSOR SQLCODE:  '            08790002
088000                     PV-DISPLAY-SQLCODE                           08800000
088100             PERFORM 9900-DB2-ABEND                               08810000
088200     END-EVALUATE.                                                08820000
088300                                                                  08830000
088301***************************************************************** 08830101
088302*  THIS WILL CHECK TO SEE IF THE 'CHANGE TO STORE' FROM THE       08830201
088303*  INPUT RECORD IS ALREADY ON THE TRECDIS TABLE FOR THE           08830301
088304*  ORDER/RECEIVER/LINE BEING PROCESSED.                           08830401
088305***************************************************************** 08830501
088310 4400-CHECK-IF-STR-ON-TRECDIS.                                    08831002
088311                                                                  08831101
088312     MOVE PV-CSR-ORD-NBR      TO RECDIS-ORD-NBR.                  08831201
088313     MOVE PV-CSR-REC-SEQ-NBR  TO RECDIS-REC-SEQ-NBR.              08831301
088314     MOVE PV-CSR-ORD-LNE-NBR  TO RECDIS-ORD-LNE-NBR.              08831401
088315     MOVE WS-IR-STOR-CHG-TO   TO RECDIS-STR-NBR.                  08831501
088316                                                                  08831601
088317     EXEC SQL                                                     08831701
088318        SELECT VER_STATUS_CDE                                     08831801
088319          INTO :RECDIS-VER-STATUS-CDE                             08831901
088320        FROM   TRECDIS A                                          08832001
088321        WHERE  ORD_NBR           = :RECDIS-ORD-NBR                08832101
088322          AND  REC_SEQ_NBR       = :RECDIS-REC-SEQ-NBR            08832201
088323          AND  ORD_LNE_NBR       = :RECDIS-ORD-LNE-NBR            08832301
088324          AND  STR_NBR           = :RECDIS-STR-NBR                08832401
088326     END-EXEC.                                                    08832601
088327                                                                  08832701
088328     EVALUATE TRUE                                                08832801
088329         WHEN SQLCODE = +0                                        08832901
088330         WHEN SQLCODE = -811                                      08833001
088331              SET PS-STORE-ON-TRECDIS TO TRUE                     08833101
088333         WHEN SQLCODE = +100                                      08833301
088334              SET PS-STORE-NOT-ON-TRECDIS TO TRUE                 08833401
088335         WHEN OTHER                                               08833501
088336             MOVE '4400-CHECK-IF-STR-ON-TRECDIS'                  08833602
088337                                    TO PV-PARAGRAPH               08833701
088338             MOVE 'SELECT TRECDIS' TO PV-DB2-FUNCTION             08833801
088339             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   08833901
088340             DISPLAY '4400-CHECK-IF-STR-ON-TRECDIS SQLCODE:  '    08834002
088342                     PV-DISPLAY-SQLCODE                           08834201
088343             PERFORM 9900-DB2-ABEND                               08834301
088344     END-EVALUATE.                                                08834401
088345                                                                  08834501
088350                                                                  08835001
088370******************************************************************08837001
088380*  PERFORM UPDATE ON THE TRECDIS TABLE TO ZERO OUT THE            08838001
088381*  CURRENT DISTRIBUTION QUANTITIES FOR THE STORES FOUND ON THE    08838101
088382*  ORDER/RECEIVER/LINE.                                           08838201
088390******************************************************************08839001
088391 4500-ZERO-OUT-TRECDIS.                                           08839102
088392                                                                  08839201
088393     MOVE PV-CSR-ORD-NBR      TO RECDIS-ORD-NBR.                  08839301
088394     MOVE PV-CSR-REC-SEQ-NBR  TO RECDIS-REC-SEQ-NBR.              08839401
088395     MOVE PV-CSR-ORD-LNE-NBR  TO RECDIS-ORD-LNE-NBR.              08839501
088400                                                                  08840001
088401     EXEC SQL                                                     08840101
088402        UPDATE TRECDIS                                            08840201
088403          SET  EXPTED_ITM_QTY    = 0                              08840301
088404              ,VERIFY_ITM_QTY    = 0                              08840401
088405              ,AP_VERIFY_ITM_QTY = 0                              08840501
088406        WHERE  ORD_NBR           = :RECDIS-ORD-NBR                08840601
088407          AND  REC_SEQ_NBR       = :RECDIS-REC-SEQ-NBR            08840701
088408          AND  ORD_LNE_NBR       = :RECDIS-ORD-LNE-NBR            08840801
088409     END-EXEC.                                                    08840901
088410                                                                  08841001
088411     EVALUATE TRUE                                                08841101
088412         WHEN SQLCODE = +0                                        08841201
088413              DISPLAY 'TRECDIS ZEROED OUT'                        08841301
088414              ADD +1 TO UPDATE-COUNT                              08841407
088415         WHEN SQLCODE = +100                                      08841501
088416              DISPLAY 'TRECDIS +100   '                           08841601
088417         WHEN OTHER                                               08841701
088418             MOVE '4500-ZERO-OUT-TRECDIS    '                     08841802
088419                                    TO PV-PARAGRAPH               08841901
088420             MOVE 'UPDATE TRECDIS' TO PV-DB2-FUNCTION             08842001
088421             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   08842101
088422             DISPLAY '4500-ZERO-OUT-TRECDIS SQLCODE:  '           08842202
088423                     PV-DISPLAY-SQLCODE                           08842301
088424             PERFORM 9900-DB2-ABEND                               08842401
088425     END-EVALUATE.                                                08842501
088426                                                                  08842601
088427                                                                  08842701
088428******************************************************************08842801
088429*  INSERT A ROW INTO THE TRECDIS TABLE FOR THE 'CHANGE TO STORE'  08842901
088430*  NUMBER FROM THE INPUT RECORD FOR THE ORDER/RECEIVER/LINE.      08843001
088431******************************************************************08843101
088432 4600-INSERT-TRECDIS.                                             08843202
088433                                                                  08843302
088434     INITIALIZE DCLTRECDIS.                                       08843402
088435                                                                  08843502
088436     MOVE WS-IR-PO-NBR            TO RECDIS-ORD-NBR.              08843602
088437     MOVE PV-CSR-ORD-LNE-NBR      TO RECDIS-ORD-LNE-NBR.          08843702
088438     MOVE WS-IR-RCVR-NBR          TO RECDIS-REC-SEQ-NBR.          08843802
088439     MOVE PV-CSR-OPER-UNT-ID      TO RECDIS-OPER-UNT-ID.          08843902
088440     MOVE PC-CURRENT-PROGRAM-NAME TO RECDIS-CRE-UID.              08844002
088441     MOVE 'A'                     TO RECDIS-VER-STATUS-CDE.       08844102
088442     MOVE PV-CSR-EXPTED-ITM-QTY   TO RECDIS-EXPTED-ITM-QTY        08844202
088443     MOVE PV-CSR-VERIFY-ITM-QTY   TO RECDIS-VERIFY-ITM-QTY.       08844302
088444     MOVE ZERO                    TO RECDIS-AP-VERIFY-ITM-QTY.    08844402
088445     MOVE WS-IR-STOR-CHG-TO       TO RECDIS-STR-NBR.              08844502
088446     MOVE 1                       TO RECDIS-FCLTY-ID.             08844602
088447     MOVE 1                       TO RECDIS-STR-FCLTY-ID.         08844702
088448     MOVE '9999-09-09'            TO RECDIS-AP-PRC-DTE.           08844802
088449                                                                  08844902
088450     EXEC SQL                                                     08845002
088451          INSERT INTO TRECDIS                                     08845102
088452                 (ORD_NBR                                         08845202
088453               ,  ORD_LNE_NBR                                     08845302
088454               ,  REC_SEQ_NBR                                     08845402
088455               ,  OPER_UNT_ID                                     08845502
088456               ,  FCLTY_ID                                        08845602
088457               ,  CRE_TMST                                        08845702
088458               ,  CRE_UID                                         08845802
088459               ,  VER_STATUS_CDE                                  08845902
088460               ,  EXPTED_ITM_QTY                                  08846002
088461               ,  VERIFY_ITM_QTY                                  08846102
088462               ,  AP_VERIFY_ITM_QTY                               08846202
088463               ,  STR_NBR                                         08846302
088464               ,  STR_FCLTY_ID                                    08846402
088465               ,  PLAN_ITM_QTY                                    08846502
088466               ,  AP_PRC_CDE                                      08846602
088467               ,  AP_PRC_DTE)                                     08846702
088468          VALUES (:RECDIS-ORD-NBR                                 08846802
088469               ,  :RECDIS-ORD-LNE-NBR                             08846902
088470               ,  :RECDIS-REC-SEQ-NBR                             08847002
088471               ,  :RECDIS-OPER-UNT-ID                             08847102
088472               ,  :RECDIS-FCLTY-ID                                08847202
088473               ,  CURRENT_TIMESTAMP                               08847302
088474               ,  :RECDIS-CRE-UID                                 08847402
088475               ,  :RECDIS-VER-STATUS-CDE                          08847502
088476               ,  :RECDIS-EXPTED-ITM-QTY                          08847602
088477               ,  :RECDIS-VERIFY-ITM-QTY                          08847702
088478               ,  :RECDIS-AP-VERIFY-ITM-QTY                       08847802
088479               ,  :RECDIS-STR-NBR                                 08847902
088480               ,  :RECDIS-STR-FCLTY-ID                            08848002
088481               ,  :RECDIS-PLAN-ITM-QTY                            08848102
088482               ,  :RECDIS-AP-PRC-CDE                              08848202
088483               ,  :RECDIS-AP-PRC-DTE)                             08848302
088484     END-EXEC.                                                    08848402
088485                                                                  08848502
088486     EVALUATE TRUE                                                08848602
088487         WHEN SQLCODE = +0                                        08848702
088488              MOVE RECDIS-ORD-LNE-NBR TO PV-DISPLAY-FIELD-5       08848807
088489              MOVE RECDIS-STR-NBR     TO PV-DISPLAY-FIELD-5A      08848907
088490              DISPLAY 'TRECDIS INSERT DONE FOR LINE: '            08849007
088491                      PV-DISPLAY-FIELD-5                          08849107
088496                      ' FOR STORE: '                              08849607
088497                      PV-DISPLAY-FIELD-5A                         08849707
088498              ADD +1 TO PV-RECDIS-INSERT-COUNT                    08849802
088499         WHEN OTHER                                               08849902
088500             MOVE '4600-INSERT-TRECDIS    '                       08850002
088501                                    TO PV-PARAGRAPH               08850102
088502             MOVE 'INSERT TRECDIS' TO PV-DB2-FUNCTION             08850202
088503             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   08850302
088504             DISPLAY '4600-INSERT-TRECDIS SQLCODE:  '             08850402
088505                     PV-DISPLAY-SQLCODE                           08850502
088506             PERFORM 9900-DB2-ABEND                               08850602
088507     END-EVALUATE.                                                08850702
088508                                                                  08850802
088509                                                                  08850902
088510******************************************************************08851002
088511*  UPDATE THE ROW ON THE TRECDIS TABLE FOR THE 'CHANGE TO STORE'  08851102
088512*  NUMBER FROM THE INPUT RECORD FOR THE ORDER/RECEIVER/LINE.      08851202
088513******************************************************************08851302
088514 4700-UPDATE-TRECDIS.                                             08851402
088515                                                                  08851501
088516     MOVE WS-IR-PO-NBR            TO RECDIS-ORD-NBR.              08851601
088517     MOVE PV-CSR-ORD-LNE-NBR      TO RECDIS-ORD-LNE-NBR.          08851701
088518     MOVE WS-IR-RCVR-NBR          TO RECDIS-REC-SEQ-NBR.          08851801
088519     MOVE WS-IR-STOR-CHG-TO       TO RECDIS-STR-NBR.              08851902
088520                                                                  08852001
088521     EXEC SQL                                                     08852101
088522          UPDATE TRECDIS                                          08852202
088523             SET EXPTED_ITM_QTY  = :PV-CSR-EXPTED-ITM-QTY         08852302
088524               , VERIFY_ITM_QTY  = :PV-CSR-VERIFY-ITM-QTY         08852402
088525               , VER_STATUS_CDE  = 'A'                            08852502
088526           WHERE ORD_NBR         = :RECDIS-ORD-NBR                08852602
088527             AND ORD_LNE_NBR     = :RECDIS-ORD-LNE-NBR            08852702
088528             AND REC_SEQ_NBR     = :RECDIS-REC-SEQ-NBR            08852802
088529             AND STR_NBR         = :RECDIS-STR-NBR                08852902
088530     END-EXEC.                                                    08853001
088531                                                                  08853101
088532     EVALUATE TRUE                                                08853201
088533         WHEN SQLCODE = +0                                        08853301
088535              ADD +1 TO PV-RECDIS-UPDATE-COUNT                    08853507
088536              MOVE RECDIS-ORD-LNE-NBR TO PV-DISPLAY-FIELD-5       08853607
088537              MOVE RECDIS-STR-NBR     TO PV-DISPLAY-FIELD-5A      08853707
088538              DISPLAY 'TRECDIS UPDATE DONE FOR LINE: '            08853807
088539                      PV-DISPLAY-FIELD-5                          08853907
088540                      ' FOR STORE: '                              08854007
088541                      PV-DISPLAY-FIELD-5A                         08854107
088542         WHEN OTHER                                               08854201
088543             MOVE '4700-UPDATE-TRECDIS    '                       08854302
088544                                    TO PV-PARAGRAPH               08854401
088545             MOVE 'UPDATE TRECDIS' TO PV-DB2-FUNCTION             08854502
088546             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   08854601
088547             DISPLAY '4700-UPDATE-TRECDIS SQLCODE:  '             08854702
088548                     PV-DISPLAY-SQLCODE                           08854801
088549             PERFORM 9900-DB2-ABEND                               08854901
088550     END-EVALUATE.                                                08855001
088551                                                                  08855101
088560                                                                  08856001
088597 5000-CHECK-RECEIVER-ACTIVITY.                                    08859702
088598                                                                  08859802
088600     SET PS-CASEPACK-NOT-RUN TO TRUE.                             08860000
088700     PERFORM 5100-CHECK-IF-CASEPACK-RUN.                          08870000
088800                                                                  08880000
088900     IF  PS-CASEPACK-RUN                                          08890000
089000         SET PS-RCVR-ACTIVITY-FOUND TO TRUE                       08900000
089100         DISPLAY 'CASEPACK SPLIT IS ACTIVE FOR THIS '             08910000
089200                 'PO ' WS-IR-PO-NBR ' RECEIVER '                  08920000
089300                 WS-IR-RCVR-NBR                                   08930000
089400         DISPLAY '** WILL NOT PROCESS THIS RECORD **'             08940000
089500     ELSE                                                         08950000
089600         DISPLAY 'CASEPACK SPLIT CHECK IS GOOD'                   08960000
089700     END-IF.                                                      08970000
089800                                                                  08980000
089900     SET PS-RCVR-NO-CM-VE-STATUS TO TRUE.                         08990000
090000     PERFORM 5200-CHECK-CM-VE-STATUS.                             09000000
090100                                                                  09010000
090200     IF  PS-RCVR-CM-VE-STATUS-FOUND                               09020000
090300         SET PS-RCVR-ACTIVITY-FOUND TO TRUE                       09030000
090400         DISPLAY 'RECEIVER ITEM ENTRIES WITH CM OR VE STATUS FOR '09040000
090500                 'PO ' WS-IR-PO-NBR ' RECEIVER '                  09050000
090600                 WS-IR-RCVR-NBR                                   09060000
090700         DISPLAY '** WILL NOT PROCESS THIS RECORD **'             09070000
090800     ELSE                                                         09080000
090900         DISPLAY 'RECITM STATUS CHECK IS GOOD'                    09090000
091000     END-IF.                                                      09100000
091100                                                                  09110000
091200     SET PS-NO-IB-CART-ACTIVITY TO TRUE.                          09120000
091300     PERFORM 5300-CHECK-INBOUND-ACTIVITY.                         09130000
091400                                                                  09140000
091500     IF  PS-IB-CART-ACTIVITY-FOUND                                09150000
091600         SET PS-RCVR-ACTIVITY-FOUND TO TRUE                       09160000
091700         DISPLAY 'INBOUND CARTON ACTIVE CHECK IN FOUND FOR '      09170000
091800                 'PO ' WS-IR-PO-NBR ' RECEIVER '                  09180000
091900                 WS-IR-RCVR-NBR                                   09190000
092000         DISPLAY '** WILL NOT PROCESS THIS RECORD **'             09200000
092100     ELSE                                                         09210000
092200         DISPLAY 'INBOUND CARTON CHECK IS GOOD'                   09220000
092300     END-IF.                                                      09230000
092400                                                                  09240000
092500     SET PS-NO-OB-CART-ACTIVITY TO TRUE.                          09250000
092600     PERFORM 5400-CHECK-OUTBOUND-ACTIVITY.                        09260000
092700                                                                  09270000
092800     IF  PS-OB-CART-ACTIVITY-FOUND                                09280000
092900         SET PS-RCVR-ACTIVITY-FOUND TO TRUE                       09290000
093000         DISPLAY 'ACTIVE OUTBOUND CARTON FOUND FOR '              09300000
093100                 'PO ' WS-IR-PO-NBR ' RECEIVER '                  09310000
093200                 WS-IR-RCVR-NBR                                   09320000
093300         DISPLAY '** WILL NOT PROCESS THIS RECORD **'             09330000
093400     ELSE                                                         09340000
093500         DISPLAY 'OUTBOUND CARTON CHECK IS GOOD'                  09350000
093600     END-IF.                                                      09360000
093700                                                                  09370000
093800 5100-CHECK-IF-CASEPACK-RUN.                                      09380000
093900                                                                  09390000
094000     MOVE  WS-IR-PO-NBR   TO DISTHD-ORD-NBR.                      09400000
094100     MOVE  WS-IR-RCVR-NBR TO DISTHD-RCVR-SEQ-NBR.                 09410000
094200                                                                  09420000
094300     EXEC SQL                                                     09430000
094400        SELECT TOT_CART_CNT                                       09440000
094500          INTO :DISTHD-TOT-CART-CNT                               09450000
094600        FROM   TDISTHD A                                          09460000
094700        WHERE  ORD_NBR           = :DISTHD-ORD-NBR                09470000
094800          AND  RCVR_SEQ_NBR      = :DISTHD-RCVR-SEQ-NBR           09480000
094900          AND  TOT_CART_CNT      > 0                              09490000
095000     END-EXEC.                                                    09500000
095100                                                                  09510000
095200     EVALUATE TRUE                                                09520000
095300         WHEN SQLCODE = +0                                        09530000
095400         WHEN SQLCODE = -811                                      09540000
095500              SET PS-CASEPACK-RUN TO TRUE                         09550000
095600              SET PS-DATA-ISSUE-FOUND TO TRUE                     09560000
095700         WHEN SQLCODE = +100                                      09570000
095800              SET PS-CASEPACK-NOT-RUN TO TRUE                     09580000
095900         WHEN OTHER                                               09590000
096000             MOVE '5100-CHECK-IF-CASEPACK-RUN'                    09600000
096100                                    TO PV-PARAGRAPH               09610000
096200             MOVE 'SELECT TDISTHD' TO PV-DB2-FUNCTION             09620000
096300             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   09630000
096400             DISPLAY '5100-CHECK-IF-CASEPACK-RUN SQLCODE:  '      09640000
096500                     PV-DISPLAY-SQLCODE                           09650000
096600             PERFORM 9900-DB2-ABEND                               09660000
096700     END-EVALUATE.                                                09670000
096800                                                                  09680000
096900 5200-CHECK-CM-VE-STATUS.                                         09690000
097000                                                                  09700000
097100     MOVE  WS-IR-PO-NBR   TO RECITM-ORD-NBR.                      09710000
097200     MOVE  WS-IR-RCVR-NBR TO RECITM-REC-SEQ-NBR.                  09720000
097300                                                                  09730000
097400     EXEC SQL                                                     09740000
097500        SELECT STATUS_CDE                                         09750000
097600          INTO :RECITM-STATUS-CDE                                 09760000
097700        FROM   TRECITM A                                          09770000
097800        WHERE  ORD_NBR           = :RECITM-ORD-NBR                09780000
097900          AND  REC_SEQ_NBR       = :RECITM-REC-SEQ-NBR            09790000
098000          AND  STATUS_CDE        IN ('CM','VE')                   09800000
098100          AND  VER_STATUS_CDE    = 'A'                            09810000
098200     END-EXEC.                                                    09820000
098300                                                                  09830000
098400     EVALUATE TRUE                                                09840000
098500         WHEN SQLCODE = +0                                        09850000
098600         WHEN SQLCODE = -811                                      09860000
098700              SET PS-RCVR-CM-VE-STATUS-FOUND TO TRUE              09870000
098800              SET PS-DATA-ISSUE-FOUND TO TRUE                     09880000
098900         WHEN SQLCODE = +100                                      09890000
099000              SET PS-RCVR-NO-CM-VE-STATUS TO TRUE                 09900000
099100         WHEN OTHER                                               09910000
099200             MOVE '5200-CHECK-CM-VE-STATUS'                       09920000
099300                                    TO PV-PARAGRAPH               09930000
099400             MOVE 'SELECT TRECITM' TO PV-DB2-FUNCTION             09940000
099500             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   09950000
099600             DISPLAY '5200-CHECK-CM-VE-STATUS SQLCODE:  '         09960000
099700                     PV-DISPLAY-SQLCODE                           09970000
099800             PERFORM 9900-DB2-ABEND                               09980000
099900     END-EVALUATE.                                                09990000
100000                                                                  10000000
100100 5300-CHECK-INBOUND-ACTIVITY.                                     10010000
100200                                                                  10020000
100300     MOVE  WS-IR-PO-NBR   TO PKSLIP-PO-NBR.                       10030000
100400     MOVE  WS-IR-RCVR-NBR TO PKSLIP-REC-SEQ-NBR.                  10040000
100500                                                                  10050000
100600     EXEC SQL                                                     10060000
100700        SELECT C.SHIPT_UNT_ID                                     10070000
100800          INTO :SHPUNT-SHIPT-UNT-ID                               10080000
100900        FROM   TPKSLIP A                                          10090000
101000              ,TINPKSU B                                          10100000
101100              ,TSHPUNT C                                          10110000
101200              ,TSHUNLO D                                          10120000
101300        WHERE A.PO_NBR        = :PKSLIP-PO-NBR                    10130000
101400          AND A.REC_SEQ_NBR   = :PKSLIP-REC-SEQ-NBR               10140000
101500          AND A.VER_STAT_CDE  = 'A'                               10150000
101600          AND A.PKSL_STAT_CDE = 'AC'                              10160000
101700          AND B.PO_NBR        = A.PO_NBR                          10170000
101800          AND B.SEQ_NBR       = A.SEQ_NBR                         10180000
101900          AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                    10190000
102000          AND C.ACTV_IND      = 'A'                               10200000
102100          AND D.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                    10210000
102200          AND D.ACTV_CDE      = 'A'                               10220000
102300     END-EXEC.                                                    10230000
102400                                                                  10240000
102500     EVALUATE TRUE                                                10250000
102600         WHEN SQLCODE = +0                                        10260000
102700         WHEN SQLCODE = -811                                      10270000
102800              MOVE SHPUNT-SHIPT-UNT-ID TO PV-DISPLAY-CARTON       10280000
102900              DISPLAY 'EXAMPLE INBOUND CARTON WITH ACTIVITY:  '   10290000
103000                      PV-DISPLAY-CARTON                           10300000
103100              SET PS-IB-CART-ACTIVITY-FOUND TO TRUE               10310000
103200              SET PS-DATA-ISSUE-FOUND TO TRUE                     10320000
103300         WHEN SQLCODE = +100                                      10330000
103400              SET PS-NO-IB-CART-ACTIVITY TO TRUE                  10340000
103500         WHEN OTHER                                               10350000
103600             MOVE '5300-CHECK-INBOUND-ACTIVITY'                   10360000
103700                                    TO PV-PARAGRAPH               10370000
103800             MOVE 'SELECT INBOUND CARTON' TO PV-DB2-FUNCTION      10380000
103900             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   10390000
104000             DISPLAY '5300-CHECK-INBOUND-ACTIVITY SQLCODE:  '     10400000
104100                     PV-DISPLAY-SQLCODE                           10410000
104200             PERFORM 9900-DB2-ABEND                               10420000
104300     END-EVALUATE.                                                10430000
104400                                                                  10440000
104500 5400-CHECK-OUTBOUND-ACTIVITY.                                    10450000
104600                                                                  10460000
104700     MOVE  WS-IR-PO-NBR   TO SUT00028-TRN-NBR.                    10470000
104800     MOVE  WS-IR-RCVR-NBR TO SUT00028-RCVR-SEQ-NBR.               10480000
104900                                                                  10490000
105000     EXEC SQL                                                     10500000
105100        SELECT A.SHIPT_UNT_ID                                     10510000
105200          INTO :SUT00028-SHIPT-UNT-ID                             10520000
105300        FROM   SUT_OTBND_UPC  A                                   10530000
105400              ,SUT_OTBND_CART B                                   10540000
105500        WHERE A.TRN_NBR       = :SUT00028-TRN-NBR                 10550000
105600          AND A.RCVR_SEQ_NBR  = :SUT00028-RCVR-SEQ-NBR            10560000
105700          AND B.SHIPT_UNT_ID  = A.SHIPT_UNT_ID                    10570000
105800          AND B.ACTV_IND      = 'Y'                               10580000
105900     END-EXEC.                                                    10590000
106000                                                                  10600000
106100     EVALUATE TRUE                                                10610000
106200         WHEN SQLCODE = +0                                        10620000
106300         WHEN SQLCODE = -811                                      10630000
106400              MOVE SUT00028-SHIPT-UNT-ID TO PV-DISPLAY-CARTON     10640000
106500              DISPLAY 'EXAMPLE OUTBOUND CARTON:  '                10650000
106600                      PV-DISPLAY-CARTON                           10660000
106700              SET PS-OB-CART-ACTIVITY-FOUND TO TRUE               10670000
106800              SET PS-DATA-ISSUE-FOUND TO TRUE                     10680000
106900         WHEN SQLCODE = +100                                      10690000
107000              SET PS-NO-OB-CART-ACTIVITY TO TRUE                  10700000
107100         WHEN OTHER                                               10710000
107200             MOVE '5400-CHECK-OUTBOUND-ACTIVITY'                  10720000
107300                                    TO PV-PARAGRAPH               10730000
107400             MOVE 'SELECT OUTBOUND CARTON' TO PV-DB2-FUNCTION     10740000
107500             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   10750000
107600             DISPLAY '5400-CHECK-OUTBOUND-ACTIVITY SQLCODE:  '    10760000
107700                     PV-DISPLAY-SQLCODE                           10770000
107800             PERFORM 9900-DB2-ABEND                               10780000
107900     END-EVALUATE.                                                10790000
108000                                                                  10800000
108100******************************************************************10810000
108200*    PERFORMS ABEND AFTER UNEXPECTED SQLCODE.                     10820000
108300******************************************************************10830000
108400 9900-DB2-ABEND.                                                  10840000
108500                                                                  10850000
108600     DISPLAY '** ABEND **'.                                       10860000
108700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        10870000
108800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   10880000
108900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                10890000
109000                                                                  10900000
109100* ROUTINE TO DISPLAY ABEND IN READABLE FORMAT                     10910000
109200     COPY DPPD004.                                                10920000
109300                                                                  10930000
109400     EXEC SQL                                                     10940000
109500         ROLLBACK                                                 10950000
109600     END-EXEC.                                                    10960000
109700                                                                  10970000
109800     SET ABEND-4013-DB2-ERROR TO TRUE.                            10980000
109900     CALL 'ILBOABN0' USING ABEND-CODE.                            10990000
110000                                                                  11000000
