000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400                                                                  00040000
000500 PROGRAM-ID.     APKRP083.                                        00050000
000600 AUTHOR.         CHRIS KUNSTMANN IBS.                             00060000
000700 DATE-WRITTEN.   08/13/1998.                                      00070000
000800                                                                  00080000
000900 DATE-COMPILED.                                                   00090000
001000*---------------------------------------------------------------* 00100000
001100*    COBOL II / DB2                                             * 00110000
001200*                                                               * 00120000
001300*        IMPORT PO COST VARIANCE BY FOB REPORT PROGRAM.         * 00130000
001400*                                                               * 00140000
001500* THE PURPOSE OF THIS PROGRAM IS TO PRODUCE A REPORT OF IMPORT  * 00150000
001600* PO'S WITH COST VARIANCE INFORMATION BY FOB CODE.              * 00160000
001700* THE REPORT LAYOUT AND PROCESSING IS SIMILIAR TO APKRP081,     * 00170000
001800* EXCEPT THE DATA IS ACCUMULATED BY FOB BEFORE PRINTING. SOME   * 00180000
001900* FIELDS HAVE BEEN ELIMNATED FROM THE REPORT. THE GRAND TOTALS  * 00190000
002000* ARE FORMATED THE SAME AS THE FOB TOTALS, AND ARE PRINTED ON   * 00200000
002100* A SEPERATE PAGE.                                              * 00210000
002200*                                                               * 00220000
002300*  IF THE REPORT LINE SEQUENCE ASSIGNED IN APKUT080 IS CHANGED, * 00230000
002400* LOGIC IN B200-PROCESS-IMPORT-FILE AND B300-END-OF-PROGRAM     * 00240000
002500* WILL BE IMPACTED.                                             * 00250000
002600*---------------------------------------------------------------* 00260000
002700*                                                               * 00270000
002800* DB2 TABLES:                                                   * 00280000
002900*  1. IMPORT FREE ON BOARD TABLE           (TIMFOB)             * 00290000
003000*  2. AP CONTROL TABLE                     (TAPCNTL)            * 00300010
003100*                                                               * 00310000
003200* INPUT:                                                        * 00320000
003300*                                                               * 00330000
003400*  1. IMPORT PO COST VARIANCE REPORT DATA  (APRD036)            * 00340000
003500*  2. CONTROL CARD                                              * 00350000
003600*                                                               * 00360000
003700* OUTPUT:                                                       * 00370000
003800*                                                               * 00380000
003900*  1. IMPORT PO COST VARIANCE REPORT SUMMARIZED BY FOB          * 00390000
004000*                                                               * 00400000
004100*---------------------------------------------------------------* 00410000
004200*   CHANGES:                                                    * 00420000
004300*   8/13/98   CHRIS KUNSTMANN, IBS.      WR4164                 * 00430000
004400*       INITIAL VERSION.                                        * 00440000
004500*                                                               * 00450000
004600*---------------------------------------------------------------* 00460000
004700*   1/19/99   CHRIS KUNSTMANN, IBS.      WR4164                 * 00470000
004800*       MODIFIED HEADINGS TO DISPLAY DATE THE DATA REPRESENTS.  * 00480000
004900*       H3-HEADER3 ALREADY EXISTED, BUT WASN'T BEING PRINTED.   * 00490000
005000*       MODIFIED B200- TO PRINT LESS SPACE BETWEEN PO'S ON A    * 00500000
005100*       PAGE, AND NOT PRINT SPACES AFTER THE SECOND PO.         * 00510000
005200*                                                               * 00520000
005300*                                                               * 00530000
005400* 12/08/1999 MIKE BESKE                      WR/IR #: WR20529   * 00540000
005500*            - CHANGED THE CODE PC-RPT-LITERALS TO INCLUDE ROY  * 00550000
005600*              AS A PART OF THE PC-RPT-TABLE.  THIS WAS DUE TO  * 00560000
005700*              THE ADDITION OF A NEW CHARGE CODE: ROY (ROYALTY).* 00570000
005800*              THESE VALUES FOR AP036-RPT-LINE-SEQ ARE ASSIGNED * 00580000
005900*              IN APKUT080.                                     * 00590000
006000*                                                               * 00600000
006100* 03/28/2001 WILLIAM EHMKE                   WR/IR #: WR20529   * 00610002
006200*            - CHANGED                                            00620003
006300*                                                                 00630003
006400*              REVERSE THE FORMAT FOR THE SYMBOLIC PARAMETERS     00640003
006500*              USED TO PROVIDE THE HEADING LINE AND HEADING       00650003
006600*              DATE INFORMATION.  %UZ.%XS, TOGETHER, THESE        00660003
006700*              PARAMETERS PROVIDE THE FISCAL CCYY AND THE         00670003
006800*              ALPHA MONTH.  THE SYSTEM ALPHA MONTH MINUS 21      00680003
006900*              DAYS PROVIDES THAT THE CORRECT FISCAL              00690003
007000*              PERIOD IS USED.  AN ADDITIONAL RTN IS NEED BY      00700003
007100*              SCHEDULING TO GET THE FISCAL CCYY IN               00710003
007200*              THE RUNNING OF THE 12TH CYCLE.                     00720003
007300*                                                                 00730003
007400* 08/08/2002 COLBY HANGER EXPENSE PROCESSING.  RECOMPILE FROM     00740007
007500*            PRODUCTION TO INCORPORATE COPYBOOK CHANGES.          00750004
007600*        BY: KEVIN CATLIN                   WR#: 23254            00760006
007700*                                                                 00770015
007800* 01/02/2003 CHANGE MADE: THE SEASONAL VERSION OF THIS REPORT WAS 00780017
007900*            CHANGED TO A FISCAL YEAR-TO-DATE REPORT.  THIS RE-   00790015
008000*            QUIRED SOME MODIFICATION TO THE REPORT TITLE AND     00800015
008100*            REPORT HEADERS.                                      00810015
008200*        BY: MIKE BESKE                     WR#: 24126            00820015
008250*                                                                 00825019
008260* 03/16/2009                                                      00826020
008270*     CHANGE MADE: RECOMPILE FOR ADDITION OF DMA-NBR TO           00827019
008280*     APRD036.                                                    00828019
008290*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR31546           00829019
008300*---------------------------------------------------------------* 00830000
008400                                                                  00840000
008500     EJECT                                                        00850000
008600                                                                  00860000
008700 ENVIRONMENT DIVISION.                                            00870000
008800                                                                  00880000
008900 CONFIGURATION SECTION.                                           00890000
009000                                                                  00900000
009100 SOURCE-COMPUTER.    IBM-3090.                                    00910000
009200 OBJECT-COMPUTER.    IBM-3090.                                    00920000
009300                                                                  00930000
009400 INPUT-OUTPUT SECTION.                                            00940000
009500                                                                  00950000
009600 FILE-CONTROL.                                                    00960000
009700                                                                  00970000
009800     SELECT IMPORT-REPORT-FILE   ASSIGN TO UT-S-INP01.            00980000
009900     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            00990000
010000                                                                  01000000
010100     EJECT                                                        01010000
010200                                                                  01020000
010300 DATA DIVISION.                                                   01030000
010400                                                                  01040000
010500 FILE SECTION.                                                    01050000
010600                                                                  01060000
010700 FD  IMPORT-REPORT-FILE                                           01070000
010800     RECORDING MODE IS F                                          01080000
010900     LABEL RECORDS ARE STANDARD                                   01090000
011000     RECORD CONTAINS 170 CHARACTERS                               01100001
011100     BLOCK CONTAINS 0 RECORDS                                     01110000
011200     DATA RECORD IS IMPORT-REPORT-REC.                            01120000
011300                                                                  01130000
011400 01  IMPORT-REPORT-REC           PIC  X(170).                     01140000
011500                                                                  01150000
011600                                                                  01160000
011700 FD  REPORT-FILE                                                  01170000
011800     RECORDING MODE IS F                                          01180000
011900     LABEL RECORDS ARE STANDARD                                   01190000
012000     RECORD CONTAINS 150 CHARACTERS                               01200001
012100     BLOCK CONTAINS 0 RECORDS                                     01210000
012200     DATA RECORD IS REPORT-REC.                                   01220000
012300                                                                  01230000
012400 01  REPORT-REC                  PIC  X(150).                     01240000
012500                                                                  01250000
012600     EJECT                                                        01260000
012700                                                                  01270000
012800 WORKING-STORAGE SECTION.                                         01280000
012900                                                                  01290000
013000 01  PROGRAM-CONSTANTS.                                           01300000
013100     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP083'. 01310000
013200     05  PC-DASH-LIT             PIC  X(30)     VALUE             01320000
013300         '------------------------------'.                        01330000
013400     05  PC-FOB-PER-PAGE-MAX     PIC S999       VALUE +2.         01340000
013500     05  PC-SUB-LITERALS         COMP-3.                          01350000
013600         10  PC-SUB-MAX          PIC S99        VALUE +14.        01360015
013700* THIS TABLE MUST REFLECT THE REPORT LINE SEQUENCES IN APKUT080.  01370000
013800*  IF MORE THAN 1 CHARGE CODE IS ASSIGNED TO A REPORT LINE SEQ    01380000
013900*  THEY WILL BE ACCUMULATED TOGETHER IN THIS REPORT. ( ONLY 1     01390000
014000*  LINE PER REPORT LINE SEQ. EX. A1 IS BOTH 1ST & 1LC )           01400000
014100     05  PC-RPT-LITERALS.                                         01410000
014200         10  FILLER              PIC  XX        VALUE 'A1'.       01420000
014300         10  FILLER              PIC  XX        VALUE 'B1'.       01430000
014400         10  FILLER              PIC  XX        VALUE 'C1'.       01440000
014500         10  FILLER              PIC  XX        VALUE 'D1'.       01450000
014600         10  FILLER              PIC  XX        VALUE 'E1'.       01460000
014700         10  FILLER              PIC  XX        VALUE 'F1'.       01470000
014800         10  FILLER              PIC  XX        VALUE 'G1'.       01480000
014900         10  FILLER              PIC  XX        VALUE 'H1'.       01490000
015000         10  FILLER              PIC  XX        VALUE 'I1'.       01500000
015100         10  FILLER              PIC  XX        VALUE 'J1'.       01510000
015200         10  FILLER              PIC  XX        VALUE 'K1'.       01520000
015300         10  FILLER              PIC  XX        VALUE 'L1'.       01530000
015400         10  FILLER              PIC  XX        VALUE 'M1'.       01540000
015500         10  FILLER              PIC  XX        VALUE 'N1'.       01550000
015600     05  PC-RPT-TABLE            REDEFINES      PC-RPT-LITERALS.  01560000
015700         10  PC-RPT-OCCUR        OCCURS 14 TIMES.                 01570000
015800             15  PC-RPT-LIT      PIC  XX.                         01580000
015900                                                                  01590000
016000 01  PV-SUBSCRIPTS                              COMP-3.           01600016
016100     10  CHRG-SUB                PIC S99        VALUE ZEROES.     01610016
016200                                                                  01620016
016300 01  PV-RPT-CHARGE-TABLE.                                         01630016
016400     05  PV-RPT-CHARGE-OCCURS    OCCURS 14 TIMES.                 01640016
016500         10  PV-RPT-COMP-DESC    PIC  X(30)     VALUE SPACES.     01650016
016600         10  FILLER              COMP-3.                          01660016
016700             15  PV-RPT-PO-COST-AMT                               01670016
016800                                 PIC S9(11)V99  VALUE ZEROES.     01680016
016900             15  PV-RPT-EST-COST-AMT                              01690016
017000                                 PIC S9(11)V99  VALUE ZEROES.     01700016
017100             15  PV-RPT-PO-EST-AMT                                01710016
017200                                 PIC S9(11)V99  VALUE ZEROES.     01720016
017300             15  PV-RPT-RCV-COST-AMT                              01730016
017400                                 PIC S9(11)V99  VALUE ZEROES.     01740016
017500             15  PV-RPT-INV-COST-AMT                              01750016
017600                                 PIC S9(11)V99  VALUE ZEROES.     01760016
017700             15  PV-RPT-INV-RCV-AMT                               01770016
017800                                 PIC S9(11)V99  VALUE ZEROES.     01780016
017900             15  PV-RPT-INV-RCV-PCT                               01790016
018000                                 PIC S999V9(5)  VALUE ZEROES.     01800016
018100                                                                  01810016
018200                                                                  01820000
018300 01  PV-PROCESS-COUNTERS.                                         01830000
018400     05  PV-RETRY-COUNTER        PIC S9(4) COMP VALUE ZERO.       01840000
018500     05  PV-READ-COUNT           PIC  9(08)     VALUE ZEROES.     01850000
018600     05  PV-PO-READ-COUNT        PIC  9(08)     VALUE ZEROES.     01860000
018700     05  PV-FOB-PRINTED-COUNT    PIC  9(08)     VALUE ZEROES.     01870000
018800                                                                  01880000
018900 01  PV-REPORT-CONTROLS.                                          01890000
019000     05  PV-LINE-SKIP            PIC S999       VALUE ZEROES.     01900000
019100     05  PV-FOB-PER-PAGE         PIC S999       VALUE +999.       01910000
019200     05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     01920000
019300                                                                  01930000
019400 01  PROGRAM-SWITCHES.                                            01940000
019500     05  PS-PO-EOF-SW            PIC  X         VALUE 'N'.        01950000
019600         88  PS-PO-NOT-EOF                      VALUE 'N'.        01960000
019700         88  PS-PO-EOF                          VALUE 'Y'.        01970000
019800     05  PS-PROCESS-SW           PIC  X         VALUE 'H'.        01980000
019900         88  PS-PROCESS-HEADER                  VALUE 'H'.        01990000
020000         88  PS-PROCESS-DETAIL                  VALUE 'D'.        02000000
020100     05  PS-DATE-SW              PIC  X(01)     VALUE 'N'.        02010010
020200         88  VALID-DATE                         VALUE 'Y'.        02020010
020300         88  NOT-VALID-DATE                     VALUE 'N'.        02030010
020400                                                                  02040000
020500 01  PROGRAM-VARIABLES.                                           02050000
020600                                                                  02060000
020700     05  PV-CURRENT-DATE.                                         02070000
020800         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      02080000
020900         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      02090000
021000         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      02100000
021100                                                                  02110000
021200     05  PV-CURRENT-TIME.                                         02120000
021300         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     02130000
021400         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     02140000
021500         10  FILLER              PIC  9(02)     VALUE ZEROES.     02150000
021600                                                                  02160010
021700     05  PV-1ST-FISCAL-DATE.                                      02170010
021800         10  PV-1ST-FISCAL-CC    PIC  X(02)     VALUE SPACE.      02180010
021900         10  PV-1ST-FISCAL-YY    PIC  X(02)     VALUE SPACE.      02190010
022000         10  FILLER              PIC  X(01)     VALUE '-'.        02200010
022100         10  PV-1ST-FISCAL-MM    PIC  X(02)     VALUE SPACE.      02210010
022200         10  FILLER              PIC  X(01)     VALUE '-'.        02220010
022300         10  PV-1ST-FISCAL-DD    PIC  X(02)     VALUE SPACE.      02230010
022400                                                                  02240000
022500     05  PV-BATCH-DATE.                                           02250010
022600         10  PV-BATCH-CC         PIC  X(02)     VALUE SPACE.      02260010
022700         10  PV-BATCH-YY         PIC  X(02)     VALUE SPACE.      02270010
022800         10  FILLER              PIC  X(01)     VALUE '-'.        02280010
022900         10  PV-BATCH-MM         PIC  X(02)     VALUE SPACE.      02290010
023000         10  FILLER              PIC  X(01)     VALUE '-'.        02300010
023100         10  PV-BATCH-DD         PIC  X(02)     VALUE SPACE.      02310010
023200                                                                  02320010
023300     05  PV-CC-DATE.                                              02330010
023400         10  PV-CC-YEAR          PIC  X(04)     VALUE SPACES.     02340010
023500         10  PV-CC-MONTH         PIC  X(09)     VALUE SPACES.     02350010
023600                                                                  02360010
023700     05  PV-HOLD-SEASON          PIC  X(06)     VALUE SPACES.     02370010
023800                                                                  02380010
023900     EJECT                                                        02390010
024000                                                                  02400010
024100* USED FOR PO LEVEL PROCESSING                                    02410010
024200     05  PV-HLD-PO-NBR           PIC  X(09)     VALUE SPACES.     02420010
024300     05  PV-HLD-FOB-CDE          PIC  X(03)     VALUE SPACES.     02430010
024400     05  PV-HLD-FOB-NAME         PIC  X(30)     VALUE SPACES.     02440010
024500     05  PV-HLD-RPT-LINE-SEQ     PIC  XX        VALUE SPACES.     02450010
024600     05  PV-HLD-COMP-DESC        PIC  X(30)     VALUE SPACES.     02460010
024700                                                                  02470010
024800* USED FOR FOB LEVEL PROCESSING                                   02480010
024900     05  PV-FOB-PO-COUNT         PIC S9(9)      VALUE ZEROES.     02490010
025000     05  PV-FOB-PO-UNT-QTY       PIC S9(9)      VALUE ZEROES.     02500010
025100     05  PV-FOB-RCV-UNT-QTY      PIC S9(9)      VALUE ZEROES.     02510010
025200     05  PV-FOB-INV-UNT-QTY      PIC S9(9)      VALUE ZEROES.     02520010
025300     05  PV-FOB-INV-RCV-QTY      PIC S9(9)      VALUE ZEROES.     02530010
025400     05  PV-FOB-INV-QTY-VAR-PCT  PIC S999V99999 VALUE ZEROES.     02540010
025500                                                                  02550010
025600     05  PV-FOB-PO-COST-AMT      PIC S9(11)V99  VALUE ZEROES.     02560010
025700     05  PV-FOB-EST-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     02570010
025800     05  PV-FOB-PO-EST-VAR-AMT   PIC S9(11)V99  VALUE ZEROES.     02580010
025900     05  PV-FOB-RCV-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     02590010
026000     05  PV-FOB-INV-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     02600010
026100     05  PV-FOB-INV-RCV-VAR-AMT  PIC S9(11)V99  VALUE ZEROES.     02610010
026200     05  PV-FOB-LC-INV-RCV-AMT   PIC S9(11)V99  VALUE ZEROES.     02620010
026300                                                                  02630010
026400*  USED FOR BOTH FOB AND FINAL RPT PROCESSING                     02640010
026500     05  PV-INV-RCV-VAR-PCT      PIC S999V99999 VALUE ZEROES.     02650010
026600     05  PV-INV-COST-AMT         PIC S9(11)V99  VALUE ZEROES.     02660010
026700     05  PV-LC-INV-RCV-AMT       PIC S9(11)V99  VALUE ZEROES.     02670010
026800                                                                  02680010
026900*  USED FOR FINAL RPT PROCESSING                                  02690010
027000     05  PV-RPT-PO-COUNT         PIC S9(9)      VALUE ZEROES.     02700010
027100     05  PV-RPT-PO-UNT-QTY       PIC S9(9)      VALUE ZEROES.     02710010
027200     05  PV-RPT-RCV-UNT-QTY      PIC S9(9)      VALUE ZEROES.     02720010
027300     05  PV-RPT-INV-UNT-QTY      PIC S9(9)      VALUE ZEROES.     02730010
027400                                                                  02740010
027500     EJECT                                                        02750010
027600                                                                  02760010
027700*----------------------------------------------------------------*02770010
027800*  INPUT RECORD LAYOUT                                            02780010
027900*----------------------------------------------------------------*02790010
028000                                                                  02800010
028100 01  CONTROL-CARD-TITLE.                                          02810010
028200     05  CC-TITLE                PIC X(35).                       02820016
028300     05  FILLER                  PIC X(45).                       02830016
028400                                                                  02840010
028500                                                                  02850010
028600 01  CONTROL-CARD-DATE.                                           02860010
028700     05  CC-DATE                 PIC  X(14).                      02870010
028800     05  FILLER                  PIC  X(66).                      02880010
028900                                                                  02890010
029000     EJECT                                                        02900010
029100                                                                  02910010
029200*----------------------------------------------------------------*02920010
029300*  INPUT RECORD LAYOUT                                            02930010
029400*----------------------------------------------------------------*02940010
029500     COPY APRD036.                                                02950018
029600                                                                  02960010
029700     EJECT                                                        02970010
029800                                                                  02980010
029900*----------------------------------------------------------------*02990010
030000* WORKING STORAGE FOR DATE ROUTINE                                03000010
030100*----------------------------------------------------------------*03010010
030200     COPY DPWS500.                                                03020018
030300                                                                  03030010
030400     EJECT                                                        03040010
030500                                                                  03050010
030600*----------------------------------------------------------------*03060010
030700*  STANDARD HEADER LAYOUT                                         03070010
030800*----------------------------------------------------------------*03080010
030900     COPY DPWS150O.                                               03090018
031000                                                                  03100010
031100     EJECT                                                        03110010
031200                                                                  03120010
031300*----------------------------------------------------------------*03130010
031400*  REPORT LAYOUT                                                  03140010
031500*----------------------------------------------------------------*03150010
031600                                                                  03160010
031700 01  H2-HEADER2.                                                  03170010
031800     05  FILLER                  PIC  X(54)     VALUE SPACES.     03180010
031900     05  FILLER                  PIC  X(07)     VALUE 'FISCAL '.  03190014
032000     05  H2-TITLE                PIC  X(35)     VALUE SPACES.     03200016
032100     05  H2-TITLE-HEADER         REDEFINES H2-TITLE.              03210010
032200         10  H2-FIRST-BYTE       PIC  X(01).                      03220010
032300         10  H2-TITLE-REMAINDER  PIC  X(34).                      03230016
032400     05  FILLER                  PIC  X(54)     VALUE SPACES.     03240010
032500                                                                  03250010
032600 01  H3-HEADER3.                                                  03260010
032700     05  FILLER                  PIC  X(68)     VALUE SPACES.     03270010
032800     05  H3-DATE                 PIC  X(14)     VALUE SPACES.     03280010
032900     05  FILLER                  PIC  X(68)     VALUE SPACES.     03290010
033000                                                                  03300010
033100 01  H3A-HEADER3.                                                 03310010
033200     05  FILLER                  PIC  X(63)     VALUE SPACES.     03320011
033300     05  H3A-DATE-RANGE.                                          03330011
033400         10  H3A-1ST-FISCAL-MM   PIC  X(02)     VALUE SPACES.     03340011
033500         10  FILLER              PIC  X(01)     VALUE '-'.        03350011
033600         10  H3A-1ST-FISCAL-DD   PIC  X(02)     VALUE SPACES.     03360011
033700         10  FILLER              PIC  X(01)     VALUE '-'.        03370011
033800         10  H3A-1ST-FISCAL-CC   PIC  X(02)     VALUE SPACES.     03380011
033900         10  H3A-1ST-FISCAL-YY   PIC  X(02)     VALUE SPACES.     03390011
034000         10  FILLER              PIC  X(04)     VALUE ' TO '.     03400011
034100         10  H3A-BATCH-MM        PIC  X(02)     VALUE SPACES.     03410011
034200         10  FILLER              PIC  X(01)     VALUE '-'.        03420011
034300         10  H3A-BATCH-DD        PIC  X(02)     VALUE SPACES.     03430011
034400         10  FILLER              PIC  X(01)     VALUE '-'.        03440011
034500         10  H3A-BATCH-CC        PIC  X(02)     VALUE SPACES.     03450011
034600         10  H3A-BATCH-YY        PIC  X(02)     VALUE SPACES.     03460011
034700     05  FILLER                  PIC  X(63)     VALUE SPACES.     03470011
034800                                                                  03480010
034900 01 H4-HEADER4.                                                   03490010
035000     05  FILLER                  PIC  X(10)     VALUE SPACES.     03500010
035100     05  FILLER                  PIC  X(13)     VALUE             03510010
035200         'FOB POINT  : '.                                         03520010
035300     05  H4-FOB-POINT            PIC  X(30)     VALUE SPACES.     03530010
035400     05  FILLER                  PIC  X(10)     VALUE SPACES.     03540010
035500     05  FILLER                  PIC  X(11)     VALUE             03550010
035600         'FOB CODE : '.                                           03560010
035700     05  H4-FOB-CDE              PIC  X(03)     VALUE SPACES.     03570010
035800     05  FILLER                  PIC  X(10)     VALUE SPACES.     03580010
035900     05  FILLER                  PIC  X(11)     VALUE             03590010
036000         'PO COUNT : '.                                           03600010
036100     05  H4-FOB-PO-COUNT         PIC  ZZZ,ZZ9                     03610010
036200                                                VALUE ZEROES.     03620010
036300     05  FILLER                  PIC  X(42)     VALUE SPACES.     03630010
036400                                                                  03640010
036500 01 H5-HEADER5.                                                   03650010
036600     05  FILLER                  PIC  X(33)     VALUE SPACES.     03660010
036700     05  FILLER                  PIC  X(8)      VALUE             03670010
036800         'PURCHASE'.                                              03680010
036900     05  FILLER                  PIC  X(10)     VALUE SPACES.     03690010
037000     05  FILLER                  PIC  X(9)      VALUE             03700010
037100         'ESTIMATED'.                                             03710010
037200     05  FILLER                  PIC  X(13)     VALUE SPACES.     03720010
037300     05  FILLER                  PIC  X(6)      VALUE 'PO VS.'.   03730010
037400     05  FILLER                  PIC  X(11)     VALUE SPACES.     03740010
037500     05  FILLER                  PIC  X(8)      VALUE             03750010
037600         'VERIFIED'.                                              03760010
037700     05  FILLER                  PIC  X(30)     VALUE SPACES.     03770010
037800     05  FILLER                  PIC  X(11)     VALUE             03780010
037900         'INVOICED VS'.                                           03790010
038000     05  FILLER                  PIC  X(06)     VALUE SPACES.     03800010
038100     05  FILLER                  PIC  X(03)     VALUE 'PCT'.      03810010
038200     05  FILLER                  PIC  X(02)     VALUE SPACES.     03820010
038300                                                                  03830010
038400     EJECT                                                        03840010
038500                                                                  03850010
038600 01  H6-HEADER6.                                                  03860010
038700     05  FILLER                  PIC  X(24)     VALUE             03870010
038800         '   COMPONENT DESCRIPTION'.                              03880010
038900     05  FILLER                  PIC  X(10)     VALUE SPACES.     03890010
039000     05  FILLER                  PIC  X(05)     VALUE 'ORDER'.    03900010
039100     05  FILLER                  PIC  X(11)     VALUE SPACES.     03910010
039200     05  FILLER                  PIC  X(11)     VALUE             03920010
039300         'LANDED COST'.                                           03930010
039400     05  FILLER                  PIC  X(13)     VALUE SPACES.     03940010
039500     05  FILLER                  PIC  X(03)     VALUE 'ELC'.      03950010
039600     05  FILLER                  PIC  X(13)     VALUE SPACES.     03960010
039700     05  FILLER                  PIC  X(08)     VALUE 'RECEIPTS'. 03970010
039800     05  FILLER                  PIC  X(12)     VALUE SPACES.     03980010
039900     05  FILLER                  PIC  X(08)     VALUE 'INVOICED'. 03990010
040000     05  FILLER                  PIC  X(11)     VALUE SPACES.     04000010
040100     05  FILLER                  PIC  X(08)     VALUE 'VERIFIED'. 04010010
040200     05  FILLER                  PIC  X(08)     VALUE SPACES.     04020010
040300     05  FILLER                  PIC  X(03)     VALUE 'VAR'.      04030010
040400     05  FILLER                  PIC  X(02)     VALUE SPACES.     04040010
040500                                                                  04050010
040600     EJECT                                                        04060010
040700                                                                  04070010
040800 01  H7-DASHLINE.                                                 04080010
040900     05  H7-DASH1                PIC  X(27)     VALUE             04090010
041000         '---------------------------'.                           04100010
041100     05  FILLER                  PIC  X         VALUE SPACES.     04110010
041200     05  H7-DASH2                PIC  X(18)     VALUE             04120010
041300         '------------------'.                                    04130010
041400     05  FILLER                  PIC  X         VALUE SPACES.     04140010
041500     05  H7-DASH3                PIC  X(18)     VALUE             04150010
041600         '------------------'.                                    04160010
041700     05  FILLER                  PIC  X         VALUE SPACES.     04170010
041800     05  H7-DASH5                PIC  X(18)     VALUE             04180010
041900         '------------------'.                                    04190010
042000     05  FILLER                  PIC  X         VALUE SPACES.     04200010
042100     05  H7-DASH6                PIC  X(18)     VALUE             04210010
042200         '------------------'.                                    04220010
042300     05  FILLER                  PIC  X         VALUE SPACES.     04230010
042400     05  FILLER                  PIC  X(18)     VALUE             04240010
042500         '------------------'.                                    04250010
042600     05  FILLER                  PIC  X         VALUE SPACES.     04260010
042700     05  FILLER                  PIC  X(18)     VALUE             04270010
042800         '------------------'.                                    04280010
042900     05  FILLER                  PIC  X(01)     VALUE SPACES.     04290010
043000     05  H7-DASH8                PIC  X(08)     VALUE             04300010
043100         '--------'.                                              04310010
043200                                                                  04320010
043300     EJECT                                                        04330010
043400                                                                  04340010
043500 01 D1-DETAIL1.                                                   04350010
043600     05  FILLER                  PIC  X(6)      VALUE 'UNITS'.    04360010
043700     05  FILLER                  PIC  X(26)     VALUE SPACES.     04370010
043800     05  D1-PO-UNITS             PIC  ZZZ,ZZZ,ZZ9                 04380010
043900                                                VALUE ZEROES.     04390010
044000     05  FILLER                  PIC  X(8)      VALUE SPACES.     04400010
044100     05  D1-ELC-UNITS            PIC  ZZZ,ZZZ,ZZ9                 04410010
044200                                                VALUE ZEROES.     04420010
044300     05  FILLER                  PIC  X(27)     VALUE SPACES.     04430010
044400     05  D1-RCV-UNITS            PIC  ZZZ,ZZZ,ZZ9                 04440010
044500                                                VALUE ZEROES.     04450010
044600     05  FILLER                  PIC  X(8)      VALUE SPACES.     04460010
044700     05  D1-INV-UNITS            PIC  ZZZ,ZZZ,ZZ9                 04470010
044800                                                VALUE ZEROES.     04480010
044900     05  FILLER                  PIC  X(08)     VALUE SPACES.     04490010
045000     05  D1-RCV-VAR-UNITS        PIC  ---,---,--9                 04500010
045100                                                VALUE ZEROES.     04510010
045200     05  FILLER                  PIC  X(4)      VALUE SPACES.     04520010
045300     05  D1-PCT-VAR              PIC  ---9.99   VALUE ZEROES.     04530010
045400     05  FILLER                  PIC  X         VALUE '%'.        04540010
045500                                                                  04550010
045600     EJECT                                                        04560010
045700                                                                  04570010
045800 01  D2-DETAIL2.                                                  04580010
045900     05  D2-COMPNT-DESC          PIC  X(27)     VALUE SPACES.     04590010
046000     05  FILLER                  PIC  X         VALUE SPACES.     04600010
046100     05  D2-PO-COST-ALPHA        PIC  X(18)     VALUE SPACES.     04610010
046200     05  D2-PO-COST-EDIT         REDEFINES      D2-PO-COST-ALPHA. 04620010
046300         10  D2-PO-COST          PIC  --,---,---,--9.99.          04630010
046400         10  D2-PO-COST-RP       PIC  X.                          04640010
046500     05  FILLER                  PIC  X         VALUE SPACES.     04650010
046600     05  D2-EST-COST-ALPHA       PIC  X(18)     VALUE SPACES.     04660010
046700     05  D2-EST-COST-EDIT        REDEFINES      D2-EST-COST-ALPHA.04670010
046800         10  D2-EST-COST         PIC  --,---,---,--9.99.          04680010
046900         10  D2-EST-COST-RP      PIC  X.                          04690010
047000     05  FILLER                  PIC  X         VALUE SPACES.     04700010
047100     05  D2-PO-EST-VAR-ALPHA     PIC  X(18)     VALUE SPACES.     04710010
047200     05  D2-PO-EST-VAR-EDIT      REDEFINES    D2-PO-EST-VAR-ALPHA.04720010
047300         10  D2-PO-EST-VAR       PIC  --,---,---,--9.99.          04730010
047400         10  D2-PO-EST-VAR-RP    PIC  X.                          04740010
047500     05  FILLER                  PIC  X         VALUE SPACES.     04750010
047600     05  D2-RCV-COST-ALPHA       PIC  X(18)     VALUE SPACES.     04760010
047700     05  D2-RCV-COST-EDIT        REDEFINES      D2-RCV-COST-ALPHA.04770010
047800         10  D2-RCV-COST         PIC  --,---,---,--9.99.          04780010
047900         10  D2-RCV-COST-RP      PIC  X.                          04790010
048000     05  FILLER                  PIC  X         VALUE SPACES.     04800010
048100     05  D2-INV-COST             PIC  --,---,---,--9.99           04810010
048200                                                VALUE ZEROES.     04820010
048300     05  D2-INV-COST-RP          PIC  X         VALUE SPACES.     04830010
048400     05  FILLER                  PIC  X         VALUE SPACES.     04840010
048500     05  D2-INV-RCV-VAR          PIC  --,---,---,--9.99           04850010
048600                                                VALUE ZEROES.     04860010
048700     05  D2-INV-RCV-VAR-RP       PIC  X         VALUE SPACES.     04870010
048800     05  FILLER                  PIC  X         VALUE SPACES.     04880010
048900     05  D2-PCT-VAR-ALPHA        PIC  X(8)      VALUE SPACES.     04890010
049000     05  D2-PCT-VAR-EDIT         REDEFINES      D2-PCT-VAR-ALPHA. 04900010
049100         10  D2-PCT-VAR          PIC  ---9.99.                    04910010
049200         10  D2-PCT-VAR-SYMBOL   PIC  X.                          04920010
049300                                                                  04930010
049400     EJECT                                                        04940010
049500                                                                  04950010
049600 01  D3-DETAIL3.                                                  04960010
049700     05  D3-COMPNT-DESC          PIC  X(27)     VALUE SPACES.     04970010
049800     05  FILLER                  PIC  X(77)     VALUE SPACES.     04980010
049900     05  D3-INV-COST             PIC  --,---,---,--9.99           04990010
050000                                                VALUE ZEROES.     05000010
050100     05  D3-INV-COST-RP          PIC  X         VALUE SPACES.     05010010
050200     05  FILLER                  PIC  X         VALUE SPACES.     05020010
050300     05  D3-INV-RCV-VAR          PIC  --,---,---,--9.99           05030010
050400                                                VALUE ZEROES.     05040010
050500     05  D3-INV-RCV-VAR-RP       PIC  X         VALUE SPACES.     05050010
050600     05  FILLER                  PIC  X(09)     VALUE SPACES.     05060010
050700                                                                  05070010
050800     EJECT                                                        05080010
050900                                                                  05090010
051000                                                                  05100010
051100*     FINAL TOTAL HEADINGS.                                       05110010
051200                                                                  05120010
051300 01 T1-HEADER1.                                                   05130010
051400     05  FILLER                  PIC  X(59)     VALUE SPACES.     05140012
051500     05  FILLER                  PIC  X(17)     VALUE             05150010
051600         'GRAND TOTALS FOR '.                                     05160010
051700     05  T1-DATE                 PIC  X(14)     VALUE SPACES.     05170012
051800     05  FILLER                  PIC  X(60)     VALUE SPACES.     05180012
051900                                                                  05190010
052000 01 T1A-HEADER1.                                                  05200012
052100     05  FILLER                  PIC  X(54)     VALUE SPACES.     05210012
052200     05  FILLER                  PIC  X(17)     VALUE             05220012
052300         'GRAND TOTALS FOR '.                                     05230012
052400     05  T1A-DATE                PIC  X(24)     VALUE SPACES.     05240012
052500     05  FILLER                  PIC  X(55)     VALUE SPACES.     05250012
052600                                                                  05260012
052700                                                                  05270012
052800 01  END-OF-REPORT.                                               05280012
052900     05  FILLER                  PIC  X(56)     VALUE SPACES.     05290012
053000     05  FILLER                  PIC  X(37)     VALUE             05300012
053100         '**********  END OF REPORT  **********'.                 05310012
053200     05  FILLER                  PIC  X(57)     VALUE SPACES.     05320012
053300                                                                  05330012
053400     EJECT                                                        05340012
053500                                                                  05350012
053600*----------------------------------------------------------------*05360012
053700*    SQL COMMUNICATIONS AREA DCLGEN                               05370012
053800*----------------------------------------------------------------*05380012
053900     EXEC SQL                                                     05390012
054000         INCLUDE SQLCA                                            05400012
054100     END-EXEC.                                                    05410012
054200                                                                  05420012
054300*----------------------------------------------------------------*05430012
054400*    TIMFOB DCLGEN                                                05440012
054500*----------------------------------------------------------------*05450012
054600     EXEC SQL                                                     05460012
054700         INCLUDE TIMFOB                                           05470012
054800     END-EXEC.                                                    05480012
054900                                                                  05490012
055000     EJECT                                                        05500012
055100                                                                  05510012
055200*----------------------------------------------------------------*05520012
055300*  ACCOUNTS PAYABLE CONTROL TABLE                                *05530012
055400*----------------------------------------------------------------*05540012
055500     EXEC SQL                                                     05550012
055600          INCLUDE TAPCNTL                                         05560012
055700     END-EXEC.                                                    05570012
055800                                                                  05580012
055900*----------------------------------------------------------------*05590012
056000*  ABEND DATA AREAS                                               05600012
056100*----------------------------------------------------------------*05610012
056200 01  ABEND-CODE                  PIC S9(4)      VALUE ZEROES      05620012
056300                                 COMP           SYNC.             05630012
056400                                                                  05640012
056500     88  AC-ANY-ERROR                           VALUE +4001       05650012
056600                                                THRU  +4019.      05660012
056700     88  AC-INVALID-KEY-WRITE                   VALUE +4001.      05670012
056800     88  AC-INVALID-KEY-READ                    VALUE +4002.      05680012
056900     88  AC-INVALID-CONTROL-CARD                VALUE +4003.      05690012
057000     88  AC-TABLE-OVERFLOW                      VALUE +4004.      05700012
057100     88  AC-OPEN-FILE-ERROR                     VALUE +4005.      05710012
057200     88  AC-CLOSE-FILE-ERROR                    VALUE +4006.      05720012
057300     88  AC-SEQUENCE-ERROR                      VALUE +4007.      05730012
057400     88  AC-INVALID-DATA                        VALUE +4008.      05740012
057500     88  AC-INVALID-KEYPUNCH                    VALUE +4009.      05750012
057800     88  AC-INTERNAL-SORT-ERROR                 VALUE +4012.      05780012
057900     88  AC-DB2-ERROR                           VALUE +4013.      05790012
058000     88  AC-DPWS500-DATE-ERROR                  VALUE +4019.      05800012
058100                                                                  05810012
058200                                                                  05820012
058300 01  ABEND-AREAS.                                                 05830012
058400     05  AA-ABEND-LIT            PIC  X(40)     VALUE             05840012
058500             '*****       ABEND'.                                 05850012
058600     05  AA-PROGRAM-LIT          PIC  X(40)     VALUE             05860012
058700             '*****   PROGRAM: APKRP083'.                         05870012
058800     05  AA-PARAGRAPH-LIT.                                        05880012
058900         10  FILLER              PIC  X(17)     VALUE             05890012
059000             '***** PARAGRAPH: '.                                 05900012
059100         10  AA-PARAGRAPH-NAME   PIC  X(35)     VALUE SPACES.     05910012
059200     05  AA-MESSAGE-LINE.                                         05920012
059300         10  FILLER              PIC  X(06)     VALUE '*****'.    05930012
059400         10  AA-MESSAGE.                                          05940012
059500             15 AA-MESS-1        PIC  X(30)     VALUE SPACES.     05950012
059600             15 AA-MESS-2        PIC  X(97)     VALUE SPACES.     05960012
059700     05  AA-DB2-ERROR-LIT        PIC  X(40)     VALUE             05970012
059800             '*****    DB2 ERROR'.                                05980012
059900     05  AA-DB2-OPERATION-LIT.                                    05990012
060000         10  FILLER              PIC  X(17)     VALUE             06000012
060100             '***** OPERATION: '.                                 06010012
060200         10  AA-DB2-OPERATION.                                    06020012
060300             15  AA-DB2-OP-1     PIC  X(25)     VALUE SPACES.     06030012
060400             15  AA-DB2-OP-2     PIC  X(25)     VALUE SPACES.     06040012
060500     05  AA-DB2-TABLE-1          PIC  X(08)     VALUE SPACES.     06050012
060600     05  AA-DB2-TABLE-2          PIC  X(08)     VALUE SPACES.     06060012
060700     05  AA-DB2-TABLE-3          PIC  X(08)     VALUE SPACES.     06070012
060800                                                                  06080012
060900     EJECT                                                        06090012
061000                                                                  06100012
061100*----------------------------------------------------------------*06110012
061200*  SQLCA FORMATTED MESSAGE AREA                                   06120012
061300*----------------------------------------------------------------*06130012
061400     COPY DPWS004.                                                06140012
061500                                                                  06150012
061600 01  FILLER                      PIC  X(25)     VALUE             06160012
061700     '** END OF APKRP083 W/S **'.                                 06170012
061800                                                                  06180012
061900     EJECT                                                        06190012
062000                                                                  06200012
062100 PROCEDURE DIVISION.                                              06210012
062200                                                                  06220012
062300 A100-MAIN.                                                       06230012
062400                                                                  06240012
062500     PERFORM B100-INITIALIZE.                                     06250012
062600                                                                  06260012
062700     PERFORM B200-PROCESS-IMPORT-FILE                             06270012
062800         UNTIL PS-PO-EOF.                                         06280012
062900                                                                  06290012
063000     PERFORM B300-END-OF-PROGRAM.                                 06300012
063100                                                                  06310012
063200     GOBACK.                                                      06320012
063300                                                                  06330012
063400                                                                  06340012
063500 B100-INITIALIZE.                                                 06350012
063600*----------------------------------------------------------------*06360012
063700*    INITIALIZATION PROCESSING                                   *06370012
063800*                                                                *06380012
063900*    - OPEN FILES.                                               *06390012
064000*    - FORMAT PAGE HEADINGS.                                     *06400012
064100*    - READ INPUT FILE.                                          *06410012
064200*    - PROCESS HEADER RECORD DATA.                               *06420012
064300*----------------------------------------------------------------*06430012
064400                                                                  06440012
064500     OPEN INPUT  IMPORT-REPORT-FILE                               06450012
064600          OUTPUT REPORT-FILE.                                     06460012
064700                                                                  06470012
064800*    - FORMAT PAGE HEADINGS.                                     *06480012
064900                                                                  06490012
065000     ACCEPT CONTROL-CARD-DATE.                                    06500012
065100                                                                  06510012
065200     ACCEPT CONTROL-CARD-TITLE.                                   06520012
065300                                                                  06530012
065400     DISPLAY ' '.                                                 06540012
065500     DISPLAY '************************************************'.  06550012
065600     DISPLAY '*           APKRP083  CONTROL INFORMATION      *'.  06560012
065700     DISPLAY ' '.                                                 06570012
065800     DISPLAY ' CONTROL-CARD-DATE  = ' CONTROL-CARD-DATE.          06580012
065900     DISPLAY ' '.                                                 06590012
066000     DISPLAY ' CONTROL-CARD-TITLE = ' CONTROL-CARD-TITLE.         06600012
066100     DISPLAY ' '.                                                 06610012
066200     DISPLAY '************************************************'.  06620012
066300     DISPLAY ' '.                                                 06630012
066400                                                                  06640012
066500     MOVE CC-TITLE               TO H2-TITLE.                     06650012
066600                                                                  06660012
066700     MOVE CC-DATE                TO PV-CC-DATE.                   06670012
066800                                                                  06680012
066900     IF H2-FIRST-BYTE = 'Y'                                       06690012
067000         INITIALIZE DCLTAPCNTL                                    06700012
067100         PERFORM R200-SELECT-BATCH-DATE                           06710012
067200         PERFORM D100-DETERMINE-1ST-FISCAL-DT                     06720012
067300         MOVE H3A-DATE-RANGE         TO T1A-DATE                  06730012
067400     ELSE                                                         06740012
067500         STRING  PV-CC-MONTH     DELIMITED BY SPACE               06750012
067600                 ' '             DELIMITED BY SIZE                06760012
067700         PV-CC-YEAR              DELIMITED BY SIZE                06770012
067800             INTO H3-DATE                                         06780012
067900         MOVE H3-DATE                TO T1-DATE                   06790012
068000     END-IF.                                                      06800012
068100                                                                  06810012
068200     DISPLAY ' '.                                                 06820012
068300     DISPLAY '************************************************'.  06830012
068400     DISPLAY '*       APKRP083  CONTROL DATE INFORMATION     *'.  06840012
068500     DISPLAY ' '.                                                 06850012
068600     DISPLAY ' PV-CC-DATE         = ' PV-CC-DATE.                 06860012
068700     DISPLAY ' '.                                                 06870012
068800     DISPLAY ' PV-CC-MONTH        = ' PV-CC-MONTH.                06880012
068900     DISPLAY ' '.                                                 06890012
069000     DISPLAY ' PV-CC-YEAR         = ' PV-CC-YEAR.                 06900012
069100     DISPLAY ' '.                                                 06910012
069200     DISPLAY '************************************************'.  06920012
069300     DISPLAY ' '.                                                 06930012
069400                                                                  06940012
069500     ACCEPT PV-CURRENT-DATE FROM DATE.                            06950012
069600     MOVE PV-CURRENT-MONTH       TO DP150O-RUN-MONTH.             06960012
069700     MOVE PV-CURRENT-DAY         TO DP150O-RUN-DAY.               06970012
069800     MOVE PV-CURRENT-YEAR        TO DP150O-RUN-YEAR.              06980012
069900                                                                  06990012
070000     ACCEPT PV-CURRENT-TIME FROM TIME.                            07000012
070100     MOVE PV-CURRENT-HOUR        TO DP150O-RUN-HOUR.              07010012
070200     MOVE PV-CURRENT-MINUTE      TO DP150O-RUN-MINUTE.            07020012
070300     MOVE PC-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          07030012
070400     MOVE 1                      TO DP150O-REPORT-NUMBER.         07040012
070500                                                                  07050012
070600*    - READ INPUT FILE.                                          *07060012
070700     PERFORM R100-READ-INPUT.                                     07070012
070800     IF PS-PO-EOF                                                 07080012
070900         DISPLAY ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'    07090012
071000     END-IF                                                       07100012
071100     .                                                            07110012
071200                                                                  07120012
071300*    - PROCESS HEADER RECORD DATA.                               *07130012
071400     IF PS-PO-NOT-EOF                                             07140012
071500         PERFORM C100-PROCESS-HEADER                              07150012
071600     END-IF                                                       07160012
071700     .                                                            07170012
071800                                                                  07180012
071900                                                                  07190012
072000*----------------------------------------------------------------*07200012
072100*    PROCESS IMPORT FILE.                                        *07210012
072200*                                                                *07220012
072300*    - IF A NEW FOB CODE IS READ;                                *07230012
072400*      - SET UP TO PRINT THE LAST COMPONENT FOR THE PREVIOUS     *07240012
072500*         FOB ( EITHER AN 'M1' OR 'N1' ).                        *07250012
072600*      - FORMAT THE LAST COMPONENT TO PRINT AND PRINT IT.        *07260012
072700*      - ADD SOME SPACE BETWEEN THE FOB'S FOR CLARITY.           *07270012
072800*      - PROCESS THE HEADER RECORD FOR THE NEXT FOB.             *07280012
072900*                                                                *07290012
073000*    - IF A PO HEADER RECORD IS READ, ACCUMULATE QUANTITIES.     *07300012
073100*    - IF A PO DETAIL RECORD IS READ;                            *07310012
073200*      - IF THIS IS THE FIRST DETAIL RECORD FOR THE FOB;         *07320012
073300*        - FORMAT THE REPORT HEADINGS FROM THE HEADER DATA       *07330012
073400*           AND SET UP TO PROCESS THE COMPONENT DETAIL DATA.     *07340012
073500*      - IF THIS IS A NEW COMPONENT FOR THE FOB;                 *07350012
073600*        - SET UP TO PRINT THE LAST COMPONENT.                   *07360012
073700*        - DEFAULT THE DESCRIPTION, IF THE RPT LINE SEQ IS       *07370012
073800*           USED FOR MULTIPLE ALLOWANCE CHARGE CODES.            *07380012
073900*           ('A1' HAS '1ST' & '1LC' CHARGE CODES)                *07390012
074000*           ('C1' HAS 'IAC' & 'LCC' CHARGE CODES)                *07400012
074100*        - FORMAT THE COMPONENT TO PRINT.                        *07410012
074200*        - PRINT THE COMPONENT AND SET UP FOR NEW COMPONENT.     *07420012
074300*      - ACCUMULATE THE COMPONENT DATA FOR THE FOB CODE.         *07430012
074400*    - READ THE IMPORT FILE.                                     *07440012
074500*----------------------------------------------------------------*07450012
074600 B200-PROCESS-IMPORT-FILE.                                        07460012
074700                                                                  07470012
074800*    - IF A NEW FOB CODE IS READ;                                *07480012
074900     IF AP036-FOB-CDE NOT = PV-HLD-FOB-CDE                        07490012
075000                                                                  07500012
075100*      - SET UP TO PRINT THE LAST COMPONENT FOR THE PREVIOUS     *07510012
075200*         FOB ( EITHER AN 'M1' OR 'N1' ).                        *07520012
075300         PERFORM                                                  07530012
075400           VARYING CHRG-SUB FROM CHRG-SUB BY 1                    07540012
075500           UNTIL   CHRG-SUB > PC-SUB-MAX                          07550012
075600           OR      PV-HLD-RPT-LINE-SEQ =                          07560012
075700                                   PC-RPT-LIT (CHRG-SUB)          07570012
075800         END-PERFORM                                              07580012
075900         MOVE PV-HLD-COMP-DESC   TO D2-COMPNT-DESC                07590012
076000                                    PV-RPT-COMP-DESC (CHRG-SUB)   07600012
076100*----------------------------------------------------------------*07610012
076200*  THE LAST COMPONENT WILL EITHER BE AN 'M1' OR AN 'N1'.         *07620012
076300*    M1 = 'LANDED COST    '                                      *07630012
076400*    N1 = 'LANDED COST LOAD - INTERNAL'                          *07640012
076500*----------------------------------------------------------------*07650012
076600*      - FORMAT THE LAST COMPONENT TO PRINT AND PRINT IT.        *07660012
076700         IF PV-HLD-RPT-LINE-SEQ = 'M1'                            07670012
076800             PERFORM F250-FORMAT-TOTAL-LC                         07680012
076900             PERFORM W300-PRINT-DETAIL                            07690012
077000         ELSE                                                     07700012
077100             IF PV-HLD-RPT-LINE-SEQ = 'N1'                        07710012
077200                 PERFORM F300-FORMAT-LCL                          07720012
077300                 PERFORM W300-PRINT-DETAIL                        07730012
077400             END-IF                                               07740012
077500         END-IF                                                   07750012
077600                                                                  07760012
077700*      - ADD SOME SPACE BETWEEN THE FOB'S FOR CLARITY.           *07770012
077800         IF PV-FOB-PER-PAGE < PC-FOB-PER-PAGE-MAX                 07780012
077900             MOVE SPACES         TO REPORT-REC                    07790012
078000             MOVE +6             TO PV-LINE-SKIP                  07800012
078100             PERFORM W300-PRINT-DETAIL                            07810012
078200         END-IF                                                   07820012
078300                                                                  07830012
078400*      - PROCESS THE HEADER RECORD FOR THE NEXT FOB.             *07840012
078500         PERFORM C100-PROCESS-HEADER                              07850012
078600     END-IF.                                                      07860012
078700                                                                  07870012
078800*    - IF A PO HEADER RECORD IS READ, ACCUMULATE QUANTITIES.     *07880012
078900     IF AP036-HEADER                                              07890012
079000         ADD +1                  TO PV-FOB-PO-COUNT               07900012
079100         ADD AP036-PO-UNT-QTY    TO PV-FOB-PO-UNT-QTY             07910012
079200         ADD AP036-RCV-UNT-QTY   TO PV-FOB-RCV-UNT-QTY            07920012
079300         ADD AP036-INV-UNT-QTY   TO PV-FOB-INV-UNT-QTY            07930012
079400     END-IF.                                                      07940012
079500                                                                  07950012
079600*    - IF A PO DETAIL RECORD IS READ;                            *07960012
079700     IF AP036-DETAIL                                              07970012
079800*      - IF THIS IS THE FIRST DETAIL RECORD FOR THE FOB;         *07980012
079900*        - FORMAT THE REPORT HEADINGS FROM THE HEADER DATA       *07990012
080000*           AND SET UP TO PROCESS THE COMPONENT DETAIL DATA.     *08000012
080100         IF PS-PROCESS-HEADER                                     08010012
080200             SET PS-PROCESS-DETAIL                                08020012
080300                                 TO TRUE                          08030012
080400             PERFORM F100-FORMAT-HEADER                           08040012
080500             MOVE AP036-RPT-LINE-SEQ                              08050012
080600                                 TO PV-HLD-RPT-LINE-SEQ           08060012
080700             MOVE AP036-COMPONENT-DESC                            08070012
080800                                 TO PV-HLD-COMP-DESC              08080012
080900             MOVE ZEROES         TO PV-FOB-PO-COST-AMT            08090012
081000                                    PV-FOB-EST-COST-AMT           08100012
081100                                    PV-FOB-RCV-COST-AMT           08110012
081200                                    PV-FOB-INV-COST-AMT           08120012
081300             MOVE ZEROES         TO CHRG-SUB                      08130012
081400         END-IF                                                   08140012
081500*      - IF THIS IS A NEW COMPONENT FOR THE FOB;                 *08150012
081600         IF AP036-RPT-LINE-SEQ NOT = PV-HLD-RPT-LINE-SEQ          08160012
081700*        - SET UP TO PRINT THE LAST COMPONENT.                   *08170012
081800             PERFORM                                              08180012
081900               VARYING CHRG-SUB FROM CHRG-SUB BY 1                08190012
082000               UNTIL   CHRG-SUB > PC-SUB-MAX                      08200012
082100               OR      PV-HLD-RPT-LINE-SEQ =                      08210012
082200                                   PC-RPT-LIT (CHRG-SUB)          08220012
082300             END-PERFORM                                          08230012
082400             MOVE PV-HLD-COMP-DESC                                08240012
082500                                 TO D2-COMPNT-DESC                08250012
082600                                    PV-RPT-COMP-DESC (CHRG-SUB)   08260012
082700*        - DEFAULT THE DESCRIPTION, IF THE RPT LINE SEQ IS       *08270012
082800*           USED FOR MULTIPLE ALLOWANCE CHARGE CODES.            *08280012
082900*           ('A1' HAS '1ST' & '1LC' CHARGE CODES)                *08290012
083000*           ('C1' HAS 'IAC' & 'LCC' CHARGE CODES)                *08300012
083100             IF PV-HLD-RPT-LINE-SEQ = 'A1'                        08310012
083200                 MOVE 'IMPORT FIRST COST             '            08320012
083300                                 TO D2-COMPNT-DESC                08330012
083400                                    PV-RPT-COMP-DESC (CHRG-SUB)   08340012
083500             END-IF                                               08350012
083600             IF PV-HLD-RPT-LINE-SEQ = 'C1'                        08360012
083700                 MOVE 'IMPORT AGENT COMMISSION       '            08370012
083800                                 TO D2-COMPNT-DESC                08380012
083900                                    PV-RPT-COMP-DESC (CHRG-SUB)   08390012
084000             END-IF                                               08400012
084100*        - FORMAT THE COMPONENT TO PRINT.                        *08410012
084200*----------------------------------------------------------------*08420012
084300*  M1 = 'LANDED COST    '                                         08430012
084400*  N1 = 'LANDED COST LOAD - INTERNAL'                             08440012
084500*----------------------------------------------------------------*08450012
084600             IF PV-HLD-RPT-LINE-SEQ = 'M1'                        08460012
084700                 PERFORM F250-FORMAT-TOTAL-LC                     08470012
084800             ELSE                                                 08480012
084900                 IF PV-HLD-RPT-LINE-SEQ = 'N1'                    08490012
085000                     PERFORM F300-FORMAT-LCL                      08500012
085100                 ELSE                                             08510012
085200                     PERFORM F200-FORMAT-COMPONENTS               08520012
085300                 END-IF                                           08530012
085400             END-IF                                               08540012
085500*        - PRINT THE COMPONENT AND SET UP FOR NEW COMPONENT.     *08550012
085600             PERFORM W300-PRINT-DETAIL                            08560012
085700             MOVE AP036-RPT-LINE-SEQ                              08570012
085800                                 TO PV-HLD-RPT-LINE-SEQ           08580012
085900             MOVE AP036-COMPONENT-DESC                            08590012
086000                                 TO PV-HLD-COMP-DESC              08600012
086100             MOVE ZEROES         TO PV-FOB-PO-COST-AMT            08610012
086200                                    PV-FOB-EST-COST-AMT           08620012
086300                                    PV-FOB-RCV-COST-AMT           08630012
086400                                    PV-FOB-INV-COST-AMT           08640012
086500         END-IF                                                   08650012
086600*      - ACCUMULATE THE COMPONENT DATA FOR THE FOB CODE.         *08660012
086700         ADD AP036-PO-COST-AMT   TO PV-FOB-PO-COST-AMT            08670012
086800         ADD AP036-EST-COST-AMT  TO PV-FOB-EST-COST-AMT           08680012
086900         ADD AP036-RCV-COST-AMT  TO PV-FOB-RCV-COST-AMT           08690012
087000         ADD AP036-INV-COST-AMT  TO PV-FOB-INV-COST-AMT           08700012
087100     END-IF.                                                      08710012
087200                                                                  08720012
087300*    - READ THE IMPORT FILE.                                     *08730012
087400     PERFORM R100-READ-INPUT.                                     08740012
087500                                                                  08750012
087600     EJECT                                                        08760012
087700                                                                  08770012
087800 B300-END-OF-PROGRAM.                                             08780012
087900*----------------------------------------------------------------*08790012
088000*    END OF PROGRAM                                              *08800012
088100*                                                                *08810012
088200*    - SET UP TO PRINT THE LAST COMPONENT.                       *08820012
088300*       FOB ( EITHER AN 'M1' OR 'N1' ).                          *08830012
088400*    - FORMAT THE COMPONENT TO PRINT AND PRINT IT.               *08840012
088500*    - PROCESS THE FINAL REPORT TOTALS.                          *08850012
088600*    - CLOSE THE FILES.                                          *08860012
088700*----------------------------------------------------------------*08870012
088800                                                                  08880012
088900     IF PV-READ-COUNT > ZEROES                                    08890012
089000*    - SET UP TO PRINT THE LAST COMPONENT.                       *08900012
089100*       FOB ( EITHER AN 'M1' OR 'N1' ).                          *08910012
089200         PERFORM                                                  08920012
089300           VARYING CHRG-SUB FROM CHRG-SUB BY 1                    08930012
089400           UNTIL   CHRG-SUB > PC-SUB-MAX                          08940012
089500           OR      PV-HLD-RPT-LINE-SEQ =                          08950012
089600                                   PC-RPT-LIT (CHRG-SUB)          08960012
089700         END-PERFORM                                              08970012
089800         MOVE PV-HLD-COMP-DESC   TO D2-COMPNT-DESC                08980012
089900                                    PV-RPT-COMP-DESC (CHRG-SUB)   08990012
090000*    - FORMAT THE COMPONENT TO PRINT AND PRINT IT.               *09000012
090100*----------------------------------------------------------------*09010012
090200*  M1 = 'LANDED COST    '                                        *09020012
090300*  N1 = 'LANDED COST LOAD - INTERNAL'                            *09030012
090400*----------------------------------------------------------------*09040012
090500         IF PV-HLD-RPT-LINE-SEQ = 'M1'                            09050012
090600             PERFORM F250-FORMAT-TOTAL-LC                         09060012
090700             PERFORM W300-PRINT-DETAIL                            09070012
090800         ELSE                                                     09080012
090900             IF PV-HLD-RPT-LINE-SEQ = 'N1'                        09090012
091000                 PERFORM F300-FORMAT-LCL                          09100012
091100                 PERFORM W300-PRINT-DETAIL                        09110012
091200             END-IF                                               09120012
091300         END-IF                                                   09130012
091400                                                                  09140012
091500*    - PROCESS THE FINAL REPORT TOTALS.                          *09150012
091600         PERFORM X100-PROCESS-FINAL-TOTALS                        09160012
091700     END-IF.                                                      09170012
091800                                                                  09180012
091900     WRITE REPORT-REC FROM END-OF-REPORT AFTER 2.                 09190012
092000                                                                  09200012
092100     DISPLAY '** END OF APKRP083 PROCESSING **'.                  09210012
092200     DISPLAY '** PO''S READ             = ' PV-PO-READ-COUNT.     09220012
092300     DISPLAY '** TOTAL RECORDS READ    = ' PV-READ-COUNT.         09230012
092400     DISPLAY ' ' .                                                09240012
092500     DISPLAY '** FOB''S PRINTED         = ' PV-FOB-PRINTED-COUNT. 09250012
092600                                                                  09260012
092700*    - CLOSE THE FILES.                                          *09270012
092800     CLOSE IMPORT-REPORT-FILE                                     09280012
092900           REPORT-FILE.                                           09290012
093000                                                                  09300012
093100                                                                  09310012
093200 C100-PROCESS-HEADER.                                             09320012
093300*----------------------------------------------------------------*09330012
093400*    PROCESS HEADER RECORD.                                      *09340012
093500*                                                                *09350012
093600*    - SET UP SAVED FIELDS FOR THE NEW PO.                       *09360012
093700*    - GET DB2 DATA FOR REPORT.                                  *09370012
093800*----------------------------------------------------------------*09380012
093900                                                                  09390012
094000     MOVE AP036-FOB-CDE          TO PV-HLD-FOB-CDE.               09400012
094100     MOVE AP036-PO-NBR           TO PV-HLD-PO-NBR.                09410012
094200     MOVE +1                     TO CHRG-SUB.                     09420012
094300                                                                  09430012
094400     MOVE ZEROES                 TO PV-FOB-PO-COUNT               09440012
094500             PV-FOB-PO-UNT-QTY      PV-FOB-INV-RCV-QTY            09450012
094600             PV-FOB-RCV-UNT-QTY     PV-FOB-INV-QTY-VAR-PCT        09460012
094700             PV-FOB-INV-UNT-QTY     PV-FOB-LC-INV-RCV-AMT.        09470012
094800     SET PS-PROCESS-HEADER       TO TRUE.                         09480012
094900                                                                  09490012
095000                                                                  09500012
095100*    - GET DB2 DATA FOR REPORT.                                  *09510012
095200     PERFORM S100-GET-FOB-NAME.                                   09520012
095300                                                                  09530012
095400     EJECT                                                        09540012
095500                                                                  09550012
095600 D100-DETERMINE-1ST-FISCAL-DT.                                    09560012
095700*----------------------------------------------------------------*09570012
095800*    DETERMINE THE FIRST FISCAL DATE FOR THE CURRENT FISCAL YEAR.*09580012
095900*----------------------------------------------------------------*09590012
096000                                                                  09600012
096100     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         09610012
096200                                                                  09620012
096300     SET DPG51-FISCAL-454-CALENDAR                                09630012
096400         DPG51-DO-NOT-INCR-DECR-DATE                              09640012
096500         DPG52-LK-DTE-ISO-FMT       TO TRUE.                      09650012
096600     MOVE APCNTL-BTCH-PRC-DTE       TO DPG52-LK-DATE-INPUT        09660012
096700                                       PV-BATCH-DATE.             09670012
096800                                                                  09680012
096900     CALL DP500-KOHLS-CALENDAR-ROUTINE                            09690012
097000         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               09700012
097100                                                                  09710012
097200     IF (DPG54-SEVERE-ERROR OR                                    09720012
097300         DPG54-WARNING-ERROR)                                     09730012
097400         DISPLAY 'BATCH DATE '  APCNTL-BTCH-PRC-DTE               09740012
097500         MOVE 'D100-DETERMINE-1ST-FISCAL-DT'                      09750012
097600                                    TO AA-PARAGRAPH-NAME          09760012
097700         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE'              09770012
097800                                    TO AA-MESSAGE                 09780012
097900         SET AC-DPWS500-DATE-ERROR  TO TRUE                       09790012
098000         PERFORM Z998-ABEND                                       09800012
098100     ELSE                                                         09810012
098200         MOVE DPG56-FIRST-FD-DB2-ISO-FMT                          09820012
098300                                    TO PV-1ST-FISCAL-DATE         09830012
098400         MOVE PV-1ST-FISCAL-MM      TO H3A-1ST-FISCAL-MM          09840012
098500         MOVE PV-1ST-FISCAL-DD      TO H3A-1ST-FISCAL-DD          09850012
098600         MOVE PV-1ST-FISCAL-CC      TO H3A-1ST-FISCAL-CC          09860012
098700         MOVE PV-1ST-FISCAL-YY      TO H3A-1ST-FISCAL-YY          09870012
098800         MOVE PV-BATCH-MM           TO H3A-BATCH-MM               09880012
098900         MOVE PV-BATCH-DD           TO H3A-BATCH-DD               09890012
099000         MOVE PV-BATCH-CC           TO H3A-BATCH-CC               09900012
099100         MOVE PV-BATCH-YY           TO H3A-BATCH-YY               09910012
099200     END-IF.                                                      09920012
099300                                                                  09930012
099400                                                                  09940012
099500 F100-FORMAT-HEADER.                                              09950012
099600*----------------------------------------------------------------*09960012
099700*    FORMAT HEADER DATA TO THE REPORT HEADINGS, DETAIL LINES.    *09970012
099800*                                                                *09980012
099900*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *09990012
100000*    - FORMAT HEADER DATA TO REPORT HEADING LINES.               *10000012
100100*    - FORMAT HEADER DATA TO DETAIL LINES.                       *10010012
100200*    - WRITE FOB HEADINGS.                                       *10020012
100300*    - ACCUMULATE FOB QUANTITIES TO REPORT TOTALS                *10030012
100400*----------------------------------------------------------------*10040012
100500                                                                  10050012
100600*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *10060012
100700     IF PV-FOB-PER-PAGE NOT < PC-FOB-PER-PAGE-MAX                 10070012
100800         PERFORM W100-WRITE-HEADINGS                              10080012
100900     END-IF.                                                      10090012
101000     ADD +1                      TO PV-FOB-PER-PAGE               10100012
101100                                    PV-FOB-PRINTED-COUNT.         10110012
101200                                                                  10120012
101300*    - FORMAT HEADER DATA TO REPORT HEADING LINES.               *10130012
101400     MOVE PV-HLD-FOB-CDE         TO H4-FOB-CDE.                   10140012
101500     MOVE PV-HLD-FOB-NAME        TO H4-FOB-POINT.                 10150012
101600     MOVE PV-FOB-PO-COUNT        TO H4-FOB-PO-COUNT.              10160012
101700                                                                  10170012
101800                                                                  10180012
101900*    - FORMAT HEADER DATA TO DETAIL LINES.                       *10190012
102000     MOVE PV-FOB-PO-UNT-QTY      TO D1-PO-UNITS                   10200012
102100                                    D1-ELC-UNITS.                 10210012
102200     MOVE PV-FOB-RCV-UNT-QTY     TO D1-RCV-UNITS.                 10220012
102300     MOVE PV-FOB-INV-UNT-QTY     TO D1-INV-UNITS.                 10230012
102400                                                                  10240012
102500     COMPUTE PV-FOB-INV-RCV-QTY =                                 10250012
102600                    ( PV-FOB-INV-UNT-QTY - PV-FOB-RCV-UNT-QTY ).  10260012
102700     MOVE PV-FOB-INV-RCV-QTY     TO D1-RCV-VAR-UNITS.             10270012
102800                                                                  10280012
102900     IF PV-FOB-INV-UNT-QTY NOT = ZEROES                           10290012
103000         COMPUTE PV-FOB-INV-QTY-VAR-PCT = ( ( PV-FOB-INV-RCV-QTY  10300012
103100            / PV-FOB-INV-UNT-QTY ) * 100 ) + .005                 10310012
103200     ELSE                                                         10320012
103300         IF PV-FOB-INV-RCV-QTY = ZEROES                           10330012
103400             MOVE ZEROES         TO PV-FOB-INV-QTY-VAR-PCT        10340012
103500         ELSE                                                     10350012
103600             IF PV-FOB-INV-RCV-QTY < ZEROES                       10360012
103700                 MOVE -100.00000 TO PV-FOB-INV-QTY-VAR-PCT        10370012
103800             ELSE                                                 10380012
103900                 MOVE 100.00000  TO PV-FOB-INV-QTY-VAR-PCT        10390012
104000             END-IF                                               10400012
104100         END-IF                                                   10410012
104200     END-IF.                                                      10420012
104300     MOVE PV-FOB-INV-QTY-VAR-PCT TO D1-PCT-VAR.                   10430012
104400                                                                  10440012
104500     MOVE PC-DASH-LIT            TO H7-DASH1   H7-DASH2           10450012
104600              H7-DASH3   H7-DASH5   H7-DASH6   H7-DASH8.          10460012
104700                                                                  10470012
104800*    - WRITE FOB HEADINGS.                                       *10480012
104900     MOVE H4-HEADER4             TO REPORT-REC.                   10490012
105000     PERFORM W200-WRITE-DETAIL-HEADINGS.                          10500012
105100                                                                  10510012
105200*    - ACCUMULATE FOB QUANTITIES TO REPORT TOTALS                *10520012
105300     ADD PV-FOB-PO-COUNT         TO PV-RPT-PO-COUNT.              10530012
105400     ADD PV-FOB-PO-UNT-QTY       TO PV-RPT-PO-UNT-QTY.            10540012
105500     ADD PV-FOB-RCV-UNT-QTY      TO PV-RPT-RCV-UNT-QTY.           10550012
105600     ADD PV-FOB-INV-UNT-QTY      TO PV-RPT-INV-UNT-QTY.           10560012
105700                                                                  10570012
105800                                                                  10580012
105900 F200-FORMAT-COMPONENTS.                                          10590012
106000*----------------------------------------------------------------*10600012
106100*    PROCESS DETAIL DATA (COMPONENTS).                           *10610012
106200*                                                                *10620012
106300*    - FORMAT DATA TO DETAIL REPORT LINE.                        *10630012
106400*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10640012
106500*       ACCUMULATE FOR THE REPORT TOTALS.                        *10650012
106600*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *10660012
106700*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *10670012
106800*----------------------------------------------------------------*10680012
106900                                                                  10690012
107000*    - FORMAT DATA TO DETAIL REPORT LINE.                        *10700012
107100*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10710012
107200*       ACCUMULATE FOR THE REPORT TOTALS.                        *10720012
107300     IF PV-FOB-PO-COST-AMT = ZEROES                               10730012
107400         MOVE SPACES             TO D2-PO-COST-ALPHA              10740012
107500     ELSE                                                         10750012
107600         MOVE PV-FOB-PO-COST-AMT TO D2-PO-COST                    10760012
107700         ADD PV-FOB-PO-COST-AMT  TO PV-RPT-PO-COST-AMT (CHRG-SUB) 10770012
107800         IF PV-FOB-PO-COST-AMT < ZERO                             10780012
107900             INSPECT D2-PO-COST                                   10790012
108000               REPLACING ALL '-' BY '('                           10800012
108100             MOVE ')'            TO D2-PO-COST-RP                 10810012
108200         ELSE                                                     10820012
108300             MOVE ' '            TO D2-PO-COST-RP                 10830012
108400         END-IF                                                   10840012
108500     END-IF.                                                      10850012
108600                                                                  10860012
108700     MOVE PV-FOB-EST-COST-AMT    TO D2-EST-COST.                  10870012
108800     ADD PV-FOB-EST-COST-AMT     TO PV-RPT-EST-COST-AMT           10880012
108900                                                      (CHRG-SUB). 10890012
109000     IF PV-FOB-EST-COST-AMT < ZERO                                10900012
109100         INSPECT D2-EST-COST                                      10910012
109200           REPLACING ALL '-' BY '('                               10920012
109300         MOVE ')'                TO D2-EST-COST-RP                10930012
109400     ELSE                                                         10940012
109500         MOVE ' '                TO D2-EST-COST-RP                10950012
109600     END-IF.                                                      10960012
109700                                                                  10970012
109800     IF PV-FOB-PO-COST-AMT > ZEROES                               10980012
109900         COMPUTE PV-FOB-PO-EST-VAR-AMT =                          10990012
110000            ( PV-FOB-PO-COST-AMT - PV-FOB-EST-COST-AMT )          11000012
110100         MOVE PV-FOB-PO-EST-VAR-AMT                               11010012
110200                                 TO D2-PO-EST-VAR                 11020012
110300         ADD PV-FOB-PO-EST-VAR-AMT                                11030012
110400                                 TO PV-RPT-PO-EST-AMT (CHRG-SUB)  11040012
110500         IF PV-FOB-PO-EST-VAR-AMT < ZERO                          11050012
110600             INSPECT D2-PO-EST-VAR                                11060012
110700               REPLACING ALL '-' BY '('                           11070012
110800             MOVE ')'            TO D2-PO-EST-VAR-RP              11080012
110900         ELSE                                                     11090012
111000             MOVE ' '            TO D2-PO-EST-VAR-RP              11100012
111100         END-IF                                                   11110012
111200     ELSE                                                         11120012
111300         MOVE SPACES             TO D2-PO-EST-VAR-ALPHA           11130012
111400     END-IF.                                                      11140012
111500                                                                  11150012
111600     MOVE PV-FOB-RCV-COST-AMT    TO D2-RCV-COST.                  11160012
111700     ADD PV-FOB-RCV-COST-AMT     TO PV-RPT-RCV-COST-AMT           11170012
111800                                                      (CHRG-SUB). 11180012
111900     IF PV-FOB-RCV-COST-AMT < ZERO                                11190012
112000         INSPECT D2-RCV-COST                                      11200012
112100           REPLACING ALL '-' BY '('                               11210012
112200         MOVE ')'                TO D2-RCV-COST-RP                11220012
112300     ELSE                                                         11230012
112400         MOVE ' '                TO D2-RCV-COST-RP                11240012
112500     END-IF.                                                      11250012
112600                                                                  11260012
112700     MOVE PV-FOB-INV-COST-AMT    TO D2-INV-COST.                  11270012
112800     ADD PV-FOB-INV-COST-AMT     TO PV-RPT-INV-COST-AMT           11280012
112900                                                      (CHRG-SUB). 11290012
113000     IF PV-FOB-INV-COST-AMT < ZERO                                11300012
113100         INSPECT D2-INV-COST                                      11310012
113200           REPLACING ALL '-' BY '('                               11320012
113300         MOVE ')'                TO D2-INV-COST-RP                11330012
113400     ELSE                                                         11340012
113500         MOVE ' '                TO D2-INV-COST-RP                11350012
113600     END-IF.                                                      11360012
113700                                                                  11370012
113800     COMPUTE PV-FOB-INV-RCV-VAR-AMT =                             11380012
113900           ( PV-FOB-INV-COST-AMT - PV-FOB-RCV-COST-AMT ).         11390012
114000     ADD PV-FOB-INV-RCV-VAR-AMT  TO PV-FOB-LC-INV-RCV-AMT.        11400012
114100     MOVE PV-FOB-INV-RCV-VAR-AMT TO D2-INV-RCV-VAR.               11410012
114200     ADD PV-FOB-INV-RCV-VAR-AMT  TO PV-RPT-INV-RCV-AMT            11420012
114300                                                      (CHRG-SUB). 11430012
114400     IF PV-FOB-INV-RCV-VAR-AMT < ZERO                             11440012
114500         INSPECT D2-INV-RCV-VAR                                   11450012
114600           REPLACING ALL '-' BY '('                               11460012
114700         MOVE ')'                TO D2-INV-RCV-VAR-RP             11470012
114800     ELSE                                                         11480012
114900         MOVE ' '                TO D2-INV-RCV-VAR-RP             11490012
115000     END-IF.                                                      11500012
115100                                                                  11510012
115200     IF PV-FOB-INV-COST-AMT NOT = ZEROES                          11520012
115300         COMPUTE PV-INV-RCV-VAR-PCT = (                           11530012
115400               ( PV-FOB-INV-RCV-VAR-AMT                           11540012
115500               / PV-FOB-INV-COST-AMT ) * 100 ) + .005             11550012
115600     ELSE                                                         11560012
115700         IF PV-FOB-INV-RCV-VAR-AMT = ZEROES                       11570012
115800              MOVE ZEROES        TO PV-INV-RCV-VAR-PCT            11580012
115900         ELSE                                                     11590012
116000             IF PV-FOB-INV-RCV-VAR-AMT < ZEROES                   11600012
116100                 MOVE -100.00000 TO PV-INV-RCV-VAR-PCT            11610012
116200             ELSE                                                 11620012
116300                 MOVE 100.00000  TO PV-INV-RCV-VAR-PCT            11630012
116400             END-IF                                               11640012
116500         END-IF                                                   11650012
116600     END-IF.                                                      11660012
116700     MOVE PV-INV-RCV-VAR-PCT     TO D2-PCT-VAR.                   11670012
116800     ADD PV-INV-RCV-VAR-PCT      TO PV-RPT-INV-RCV-PCT            11680012
116900                                                      (CHRG-SUB). 11690012
117000     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            11700012
117100                                                                  11710012
117200*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *11720012
117300*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *11730012
117400     MOVE D2-DETAIL2             TO REPORT-REC.                   11740012
117500     MOVE +1                     TO PV-LINE-SKIP.                 11750012
117600                                                                  11760012
117700                                                                  11770012
117800                                                                  11780012
117900 F250-FORMAT-TOTAL-LC.                                            11790012
118000*----------------------------------------------------------------*11800012
118100*    PROCESS THE 'TOT' COMPONENT (LANDED COST).                  *11810012
118200*                                                                *11820012
118300*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *11830012
118400*    - FORMAT DATA TO DETAIL REPORT LINE.                        *11840012
118500*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *11850012
118600*    - COMPUTE ESTIMATED LANDED COST VARIANCE.                   *11860012
118700*    - COMPUTE INVOICE RECEIVING VARIANCE PERCENT.               *11870012
118800*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *11880012
118900*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *11890012
119000*----------------------------------------------------------------*11900012
119100                                                                  11910012
119200*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *11920012
119300     MOVE SPACES                 TO H7-DASH6   H7-DASH2           11930012
119400                                    H7-DASH5   H7-DASH8.          11940012
119500     MOVE H7-DASHLINE            TO REPORT-REC.                   11950012
119600     MOVE +1                     TO PV-LINE-SKIP.                 11960012
119700     PERFORM W300-PRINT-DETAIL.                                   11970012
119800                                                                  11980012
119900*    - FORMAT DATA TO DETAIL REPORT LINE.                        *11990012
120000*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *12000012
120100     IF PV-FOB-PO-COST-AMT = ZEROES                               12010012
120200         MOVE SPACES             TO D2-PO-COST-ALPHA              12020012
120300     ELSE                                                         12030012
120400         MOVE PV-FOB-PO-COST-AMT TO D2-PO-COST                    12040012
120500         ADD PV-FOB-PO-COST-AMT  TO PV-RPT-PO-COST-AMT            12050012
120600                                                      (CHRG-SUB)  12060012
120700         IF PV-FOB-PO-COST-AMT < ZERO                             12070012
120800             INSPECT D2-PO-COST                                   12080012
120900               REPLACING ALL '-' BY '('                           12090012
121000             MOVE ')'            TO D2-PO-COST-RP                 12100012
121100         ELSE                                                     12110012
121200             MOVE ' '            TO D2-PO-COST-RP                 12120012
121300         END-IF                                                   12130012
121400     END-IF.                                                      12140012
121500                                                                  12150012
121600     MOVE PV-FOB-EST-COST-AMT    TO D2-EST-COST.                  12160012
121700     ADD PV-FOB-EST-COST-AMT     TO PV-RPT-EST-COST-AMT (CHRG-SUB)12170012
121800     .                                                            12180012
121900     IF PV-FOB-EST-COST-AMT < ZERO                                12190012
122000         INSPECT D2-EST-COST                                      12200012
122100           REPLACING ALL '-' BY '('                               12210012
122200         MOVE ')'                TO D2-EST-COST-RP                12220012
122300     ELSE                                                         12230012
122400         MOVE ' '                TO D2-EST-COST-RP                12240012
122500     END-IF.                                                      12250012
122600                                                                  12260012
122700                                                                  12270012
122800     IF PV-FOB-PO-COST-AMT > ZEROES                               12280012
122900         COMPUTE PV-FOB-PO-EST-VAR-AMT =                          12290012
123000               ( PV-FOB-PO-COST-AMT - PV-FOB-EST-COST-AMT )       12300012
123100         MOVE PV-FOB-PO-EST-VAR-AMT                               12310012
123200                                 TO D2-PO-EST-VAR                 12320012
123300         ADD PV-FOB-PO-EST-VAR-AMT                                12330012
123400                                 TO PV-RPT-PO-EST-AMT (CHRG-SUB)  12340012
123500         IF PV-FOB-PO-EST-VAR-AMT < ZERO                          12350012
123600             INSPECT D2-PO-EST-VAR                                12360012
123700               REPLACING ALL '-' BY '('                           12370012
123800             MOVE ')'            TO D2-PO-EST-VAR-RP              12380012
123900         ELSE                                                     12390012
124000             MOVE ' '            TO D2-PO-EST-VAR-RP              12400012
124100         END-IF                                                   12410012
124200     ELSE                                                         12420012
124300         MOVE SPACES             TO D2-PO-EST-VAR-ALPHA           12430012
124400     END-IF.                                                      12440012
124500                                                                  12450012
124600     MOVE PV-FOB-RCV-COST-AMT    TO D2-RCV-COST.                  12460012
124700     ADD PV-FOB-RCV-COST-AMT     TO PV-RPT-RCV-COST-AMT           12470012
124800                                                      (CHRG-SUB). 12480012
124900     IF PV-FOB-RCV-COST-AMT < ZERO                                12490012
125000         INSPECT D2-RCV-COST                                      12500012
125100           REPLACING ALL '-' BY '('                               12510012
125200         MOVE ')'                TO D2-RCV-COST-RP                12520012
125300     ELSE                                                         12530012
125400         MOVE ' '                TO D2-RCV-COST-RP                12540012
125500     END-IF.                                                      12550012
125600                                                                  12560012
125700     MOVE PV-FOB-INV-COST-AMT    TO D2-INV-COST                   12570012
125800                                    PV-INV-COST-AMT               12580012
125900     .                                                            12590012
126000     ADD PV-FOB-INV-COST-AMT     TO PV-RPT-INV-COST-AMT           12600012
126100                                                      (CHRG-SUB). 12610012
126200     IF PV-FOB-INV-COST-AMT < ZERO                                12620012
126300         INSPECT D2-INV-COST                                      12630012
126400           REPLACING ALL '-' BY '('                               12640012
126500         MOVE ')'                TO D2-INV-COST-RP                12650012
126600     ELSE                                                         12660012
126700         MOVE ' '                TO D2-INV-COST-RP                12670012
126800     END-IF.                                                      12680012
126900                                                                  12690012
127000     MOVE PV-FOB-LC-INV-RCV-AMT  TO D2-INV-RCV-VAR                12700012
127100                                    PV-LC-INV-RCV-AMT             12710012
127200     .                                                            12720012
127300     ADD PV-FOB-LC-INV-RCV-AMT   TO PV-RPT-INV-RCV-AMT            12730012
127400                                                      (CHRG-SUB). 12740012
127500     IF PV-FOB-LC-INV-RCV-AMT < ZERO                              12750012
127600         INSPECT D2-INV-RCV-VAR                                   12760012
127700           REPLACING ALL '-' BY '('                               12770012
127800         MOVE ')'                TO D2-INV-RCV-VAR-RP             12780012
127900     ELSE                                                         12790012
128000         MOVE ' '                TO D2-INV-RCV-VAR-RP             12800012
128100     END-IF.                                                      12810012
128200                                                                  12820012
128300*    - COMPUTE INVOICE RECEIVING VARIANCE PERCENT.               *12830012
128400     IF PV-FOB-INV-COST-AMT NOT = ZEROES                          12840012
128500         COMPUTE PV-INV-RCV-VAR-PCT = (                           12850012
128600               ( PV-FOB-LC-INV-RCV-AMT                            12860012
128700               / PV-FOB-INV-COST-AMT ) * 100 ) + .005             12870012
128800     ELSE                                                         12880012
128900         IF PV-FOB-LC-INV-RCV-AMT = ZEROES                        12890012
129000             MOVE ZEROES         TO PV-INV-RCV-VAR-PCT            12900012
129100         ELSE                                                     12910012
129200             IF PV-FOB-LC-INV-RCV-AMT < ZEROES                    12920012
129300                 MOVE -100.00000 TO PV-INV-RCV-VAR-PCT            12930012
129400             ELSE                                                 12940012
129500                 MOVE 100.00000  TO PV-INV-RCV-VAR-PCT            12950012
129600             END-IF                                               12960012
129700         END-IF                                                   12970012
129800     END-IF.                                                      12980012
129900     MOVE PV-INV-RCV-VAR-PCT     TO D2-PCT-VAR.                   12990012
130000     ADD PV-INV-RCV-VAR-PCT      TO PV-RPT-INV-RCV-PCT            13000012
130100                                                      (CHRG-SUB). 13010012
130200     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            13020012
130300                                                                  13030012
130400*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *13040012
130500*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *13050012
130600     MOVE D2-DETAIL2             TO REPORT-REC.                   13060012
130700     MOVE +1                     TO PV-LINE-SKIP.                 13070012
130800                                                                  13080012
130900                                                                  13090012
131000 F300-FORMAT-LCL.                                                 13100012
131100*----------------------------------------------------------------*13110012
131200*    PROCESS THE LCL RECORD HERE                                 *13120012
131300*                                                                *13130012
131400*    - FORMAT DATA TO DETAIL REPORT LINE.                        *13140012
131500*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *13150012
131600*    - MOVE THE DETAIL LINE TO THE REPORT RECORD AND PRINT.      *13160012
131700*                                                                *13170012
131800*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *13180012
131900*                                                                *13190012
132000*    - FORMAT PO TOTAL DATA TO DETAIL REPORT LINE.               *13200012
132100*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *13210012
132200*    - COMPUTE INVOICE COST AND INVOICE RECEIVING VARIANCE.      *13220012
132300*    - MOVE THE TOTAL LINE TO THE REPORT RECORD.                 *13230012
132400*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *13240012
132500*----------------------------------------------------------------*13250012
132600                                                                  13260012
132700*    - FORMAT DATA TO DETAIL REPORT LINE.                        *13270012
132800*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *13280012
132900     MOVE SPACES                 TO D2-PO-COST-ALPHA              13290012
133000                                    D2-EST-COST-ALPHA             13300012
133100                                    D2-PO-EST-VAR-ALPHA           13310012
133200                                    D2-RCV-COST-ALPHA             13320012
133300                                    D2-PCT-VAR-ALPHA.             13330012
133400                                                                  13340012
133500     COMPUTE PV-INV-COST-AMT =                                    13350012
133600           ( PV-INV-COST-AMT + PV-FOB-INV-COST-AMT ).             13360012
133700     COMPUTE PV-LC-INV-RCV-AMT =                                  13370012
133800           ( PV-LC-INV-RCV-AMT + PV-FOB-INV-COST-AMT ).           13380012
133900                                                                  13390012
134000     MOVE PV-FOB-INV-COST-AMT    TO D2-INV-COST                   13400012
134100                                    D2-INV-RCV-VAR                13410012
134200                                    .                             13420012
134300     ADD  PV-FOB-INV-COST-AMT    TO                               13430012
134400                                    PV-RPT-INV-COST-AMT (CHRG-SUB)13440012
134500                                    PV-RPT-INV-RCV-AMT (CHRG-SUB).13450012
134600     IF PV-FOB-INV-COST-AMT < ZERO                                13460012
134700         INSPECT D2-INV-COST                                      13470012
134800           REPLACING ALL '-' BY '('                               13480012
134900         INSPECT D2-INV-RCV-VAR                                   13490012
135000           REPLACING ALL '-' BY '('                               13500012
135100         MOVE ')'                TO D2-INV-COST-RP                13510012
135200                                    D2-INV-RCV-VAR-RP             13520012
135300     ELSE                                                         13530012
135400         MOVE ' '                TO D2-INV-COST-RP                13540012
135500                                    D2-INV-RCV-VAR-RP             13550012
135600     END-IF.                                                      13560012
135700                                                                  13570012
135800*    - MOVE THE DETAIL LINE TO THE REPORT RECORD AND PRINT.      *13580012
135900     MOVE D2-DETAIL2             TO REPORT-REC.                   13590012
136000     MOVE +2                     TO PV-LINE-SKIP.                 13600012
136100     PERFORM W300-PRINT-DETAIL.                                   13610012
136200                                                                  13620012
136300*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *13630012
136400     MOVE SPACES                 TO H7-DASH1 H7-DASH2             13640012
136500              H7-DASH3   H7-DASH5   H7-DASH6   H7-DASH8.          13650012
136600     MOVE H7-DASHLINE            TO REPORT-REC.                   13660012
136700     MOVE +1                     TO PV-LINE-SKIP.                 13670012
136800     PERFORM W300-PRINT-DETAIL.                                   13680012
136900                                                                  13690012
137000*    - FORMAT PO TOTAL DATA TO DETAIL REPORT LINE.               *13700012
137100*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *13710012
137200*    - COMPUTE INVOICE COST AND INVOICE RECEIVING VARIANCE.      *13720012
137300     MOVE SPACES                 TO D3-COMPNT-DESC.               13730012
137400     MOVE 'TOTAL FOB COST '      TO D3-COMPNT-DESC.               13740012
137500     MOVE PV-INV-COST-AMT                                         13750012
137600                                 TO D3-INV-COST.                  13760012
137700     IF PV-INV-COST-AMT < ZEROES                                  13770012
137800         INSPECT D3-INV-COST                                      13780012
137900           REPLACING ALL '-' BY '('                               13790012
138000         MOVE ')'                TO D3-INV-COST-RP                13800012
138100     ELSE                                                         13810012
138200         MOVE ' '                TO D3-INV-COST-RP                13820012
138300     END-IF.                                                      13830012
138400                                                                  13840012
138500     MOVE PV-LC-INV-RCV-AMT                                       13850012
138600                                 TO D3-INV-RCV-VAR.               13860012
138700     IF PV-LC-INV-RCV-AMT < ZEROES                                13870012
138800         INSPECT D3-INV-RCV-VAR                                   13880012
138900           REPLACING ALL '-' BY '('                               13890012
139000         MOVE ')'                TO D3-INV-RCV-VAR-RP             13900012
139100     ELSE                                                         13910012
139200         MOVE ' '                TO D3-INV-RCV-VAR-RP             13920012
139300     END-IF.                                                      13930012
139400                                                                  13940012
139500*    - MOVE THE TOTAL LINE TO THE REPORT RECORD.                 *13950012
139600*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *13960012
139700     MOVE D3-DETAIL3             TO REPORT-REC.                   13970012
139800     MOVE +2                     TO PV-LINE-SKIP.                 13980012
139900                                                                  13990012
140000                                                                  14000012
140100 R100-READ-INPUT.                                                 14010012
140200*----------------------------------------------------------------*14020012
140300*    READ IMPORT FILE.                                           *14030012
140400*----------------------------------------------------------------*14040012
140500                                                                  14050012
140600     READ IMPORT-REPORT-FILE INTO AP036-IMPORT-REPORT-RECORD      14060012
140700         AT END                                                   14070012
140800             SET PS-PO-EOF TO TRUE.                               14080012
140900                                                                  14090012
141000     IF PS-PO-NOT-EOF                                             14100012
141100         ADD 1                   TO PV-READ-COUNT                 14110012
141200         IF AP036-HEADER                                          14120012
141300             ADD 1               TO PV-PO-READ-COUNT              14130012
141400         END-IF                                                   14140012
141500     END-IF.                                                      14150012
141600                                                                  14160012
141700                                                                  14170012
141800 R200-SELECT-BATCH-DATE.                                          14180012
141900*----------------------------------------------------------------*14190012
142000*  RETRIEVES THE BATCH PROCESS DATE FROM THE AP PAYMENT CONTROL  *14200012
142100*            TABLE.                                              *14210012
142200*----------------------------------------------------------------*14220012
142300                                                                  14230012
142400     EXEC SQL                                                     14240012
142500         SELECT                                                   14250012
142600             BTCH_PRC_DTE                                         14260012
142700         INTO                                                     14270012
142800             :APCNTL-BTCH-PRC-DTE                                 14280012
142900         FROM TAPCNTL                                             14290012
143000     END-EXEC.                                                    14300012
143100                                                                  14310012
143200     EVALUATE TRUE                                                14320012
143300       WHEN SQLCODE = ZERO                                        14330012
143400         CONTINUE                                                 14340012
143500       WHEN OTHER                                                 14350012
143600         MOVE 'R200-SELECT-BATCH-DATE'                            14360012
143700                             TO AA-PARAGRAPH-NAME                 14370012
143800         MOVE 'UNSUCCESSFUL SELECT'                               14380012
143900                             TO AA-DB2-OPERATION                  14390012
144000         MOVE 'TAPCNTL'      TO AA-DB2-TABLE-1                    14400012
144100         MOVE SPACES         TO AA-DB2-TABLE-2                    14410012
144200                                AA-DB2-TABLE-3                    14420012
144300         PERFORM Z999-DB2-ABEND                                   14430012
144400     END-EVALUATE.                                                14440012
144500                                                                  14450012
144600                                                                  14460012
144700 S100-GET-FOB-NAME.                                               14470012
144800*----------------------------------------------------------------*14480012
144900*   RETRIEVES THE FOB NAME FOR THE FOB BEING PROCESSED.          *14490012
145000*----------------------------------------------------------------*14500012
145100                                                                  14510012
145200     INITIALIZE  DCLTIMFOB.                                       14520012
145300                                                                  14530012
145400     PERFORM WITH TEST AFTER                                      14540012
145500             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 14550012
145600             UNTIL   PV-RETRY-COUNTER > 3  OR                     14560012
145700                     SQLCODE = ZERO OR                            14570012
145800                     SQLCODE = +100                               14580012
145900                                                                  14590012
146000         EXEC SQL                                                 14600012
146100             SELECT FOB_CTY_NM                                    14610012
146200             INTO   :IMFOB-FOB-CTY-NM                             14620012
146300             FROM   TIMFOB                                        14630012
146400             WHERE  FOB_CDE    =  :PV-HLD-FOB-CDE                 14640012
146500         END-EXEC                                                 14650012
146600                                                                  14660012
146700         EVALUATE TRUE                                            14670012
146800           WHEN SQLCODE = ZERO                                    14680012
146900             MOVE IMFOB-FOB-CTY-NM TO PV-HLD-FOB-NAME             14690012
147000                                                                  14700012
147100           WHEN SQLCODE = +100                                    14710012
147200             MOVE 'NO CITY NAME FOUND '                           14720012
147300                                 TO PV-HLD-FOB-NAME               14730012
147400                                                                  14740012
147500           WHEN SQLWARN0 NOT = SPACES                             14750012
147600           WHEN SQLCODE NOT  = ZERO                               14760012
147700             DISPLAY 'PO NUMBER: ' PV-HLD-PO-NBR                  14770012
147800             DISPLAY 'FOB CODE: ' PV-HLD-FOB-CDE                  14780012
147900             MOVE 'S100-GET-FOB-NAME'                             14790012
148000                                 TO AA-PARAGRAPH-NAME             14800012
148100             MOVE 'UNSUCCESSFUL SELECT'                           14810012
148200                                 TO AA-DB2-OPERATION              14820012
148300             MOVE 'TIMFOB'       TO AA-DB2-TABLE-1                14830012
148400             INITIALIZE             AA-DB2-TABLE-2                14840012
148500                                    AA-DB2-TABLE-3                14850012
148600             PERFORM Z999-DB2-ABEND                               14860012
148700         END-EVALUATE                                             14870012
148800     END-PERFORM.                                                 14880012
148900                                                                  14890012
149000     IF PV-RETRY-COUNTER > 3                                      14900012
149100         MOVE 'S100-GET-FOB-NAME'                                 14910012
149200                                 TO AA-PARAGRAPH-NAME             14920012
149300         MOVE 'MAX RETRIES EXCEEDED ON SELECT IMFOB'              14930012
149400                                 TO AA-DB2-OPERATION              14940012
149500         PERFORM Z999-DB2-ABEND                                   14950012
149600     END-IF.                                                      14960012
149700                                                                  14970012
149800                                                                  14980012
149900 W100-WRITE-HEADINGS.                                             14990012
150000*----------------------------------------------------------------*15000012
150100*    WRITE PAGE HEADING LINES.                                   *15010012
150200*----------------------------------------------------------------*15020012
150300                                                                  15030012
150400     ADD +1                      TO PV-PAGE-COUNT.                15040012
150500     MOVE PV-PAGE-COUNT          TO DP150O-PAGE-NUMBER            15050012
150600                                                                  15060012
150700* HEADING LINE 1 (STANDARD)                                       15070012
150800     WRITE REPORT-REC FROM DP150O-STANDRD-HEADER-150-COLS         15080012
150900       AFTER ADVANCING PAGE.                                      15090012
151000                                                                  15100012
151100     WRITE REPORT-REC FROM H2-HEADER2                             15110012
151200       AFTER ADVANCING +1 LINES.                                  15120012
151300                                                                  15130012
151400     IF H2-FIRST-BYTE = 'Y'                                       15140012
151500        WRITE REPORT-REC FROM H3A-HEADER3                         15150012
151600          AFTER ADVANCING +1 LINES                                15160012
151700     ELSE                                                         15170012
151800        WRITE REPORT-REC FROM H3-HEADER3                          15180012
151900          AFTER ADVANCING +1 LINES                                15190012
152000     END-IF.                                                      15200012
152100                                                                  15210012
152200     MOVE ZEROES                 TO PV-FOB-PER-PAGE.              15220012
152300                                                                  15230012
152400                                                                  15240012
152500 W200-WRITE-DETAIL-HEADINGS.                                      15250012
152600*----------------------------------------------------------------*15260012
152700*    WRITE FOB DETAIL HEADINGS.                                  *15270012
152800*----------------------------------------------------------------*15280012
152900                                                                  15290012
153000     WRITE REPORT-REC                                             15300012
153100       AFTER ADVANCING +2 LINES.                                  15310012
153200                                                                  15320012
153300     WRITE REPORT-REC FROM H5-HEADER5                             15330012
153400       AFTER ADVANCING +3 LINES.                                  15340012
153500     WRITE REPORT-REC FROM H6-HEADER6                             15350012
153600       AFTER ADVANCING +1 LINES.                                  15360012
153700     WRITE REPORT-REC FROM H7-DASHLINE                            15370012
153800       AFTER ADVANCING +1 LINES.                                  15380012
153900                                                                  15390012
154000     WRITE REPORT-REC FROM D1-DETAIL1                             15400012
154100       AFTER ADVANCING +2 LINES.                                  15410012
154200                                                                  15420012
154300     MOVE SPACES                 TO H7-DASH1.                     15430012
154400     WRITE REPORT-REC FROM H7-DASHLINE                            15440012
154500       AFTER ADVANCING +2 LINES.                                  15450012
154600                                                                  15460012
154700                                                                  15470012
154800 W300-PRINT-DETAIL.                                               15480012
154900*----------------------------------------------------------------*15490012
155000*    PRINTS PO DETAIL LINES.                                     *15500012
155100*----------------------------------------------------------------*15510012
155200                                                                  15520012
155300     WRITE REPORT-REC                                             15530012
155400       AFTER ADVANCING PV-LINE-SKIP LINES.                        15540012
155500                                                                  15550012
155600     INITIALIZE REPORT-REC.                                       15560012
155700                                                                  15570012
155800                                                                  15580012
155900 X100-PROCESS-FINAL-TOTALS.                                       15590012
156000*----------------------------------------------------------------*15600012
156100*    PROCESSING FINAL TOTALS.                                    *15610012
156200*                                                                *15620012
156300*    - WRITE PAGE HEADINGS.                                      *15630012
156400*    - FORMAT ALL THE TOTAL COMPONENTS TO PRINT.                 *15640012
156500*    - PRINT TOTAL COMPONENT                                     *15650012
156600*----------------------------------------------------------------*15660012
156700                                                                  15670012
156800     PERFORM X150-FORMAT-TOTAL-HEADER.                            15680012
156900                                                                  15690012
157000*    - FORMAT ALL THE TOTAL COMPONENTS TO PRINT.                 *15700012
157100     PERFORM                                                      15710012
157200       VARYING CHRG-SUB FROM 1 BY 1                               15720012
157300       UNTIL   CHRG-SUB > PC-SUB-MAX                              15730012
157400       OR      PC-RPT-LIT (CHRG-SUB) = SPACES                     15740012
157500         MOVE PV-RPT-COMP-DESC (CHRG-SUB)                         15750012
157600                                 TO D2-COMPNT-DESC                15760012
157700*----------------------------------------------------------------*15770012
157800*  M1 = 'LANDED COST    '                                         15780012
157900*  N1 = 'LANDED COST LOAD - INTERNAL'                             15790012
158000*----------------------------------------------------------------*15800012
158100         IF PC-RPT-LIT (CHRG-SUB) = 'M1'                          15810012
158200             PERFORM X250-FORMAT-TOTAL-LC                         15820012
158300         ELSE                                                     15830012
158400             IF PC-RPT-LIT (CHRG-SUB) = 'N1'                      15840012
158500                 IF PV-RPT-INV-COST-AMT (CHRG-SUB) = ZEROES       15850012
158600* IF NO LCL WAS PROCESSED, THE AMOUNT IS ZEREO                    15860012
158700*  DON'T PRINT THE LCL LINE AND THE TOTAL REPORT LINE             15870012
158800                     MOVE SPACES TO REPORT-REC                    15880012
158900                 ELSE                                             15890012
159000                     PERFORM X300-FORMAT-TOTAL-LCL                15900012
159100                 END-IF                                           15910012
159200             ELSE                                                 15920012
159300                 PERFORM X200-FORMAT-TOTAL-COMPONENTS             15930012
159400             END-IF                                               15940012
159500         END-IF                                                   15950012
159600*    - PRINT TOTAL COMPONENT                                     *15960012
159700         PERFORM W300-PRINT-DETAIL                                15970012
159800     END-PERFORM.                                                 15980012
159900                                                                  15990012
160000                                                                  16000012
160100                                                                  16010012
160200 X150-FORMAT-TOTAL-HEADER.                                        16020012
160300*----------------------------------------------------------------*16030012
160400*    FORMAT TOTAL FOB HEADINGS.                                  *16040012
160500*                                                                *16050012
160600*    - WRITE PAGE HEADINGS.                                      *16060012
160700*    - FORMAT TOTAL DATA TO DETAIL REPORT LINE.                  *16070012
160800*    - PRINT FOB TOTAL DETAIL HEADINGS.                          *16080012
160900*----------------------------------------------------------------*16090012
161000                                                                  16100012
161100     PERFORM W100-WRITE-HEADINGS.                                 16110012
161200                                                                  16120012
161300*    - FORMAT TOTAL DATA TO DETAIL REPORT LINE.                  *16130012
161400     MOVE PV-RPT-PO-UNT-QTY      TO D1-PO-UNITS                   16140012
161500                                    D1-ELC-UNITS.                 16150012
161600     MOVE PV-RPT-RCV-UNT-QTY TO D1-RCV-UNITS.                     16160012
161700     MOVE PV-RPT-INV-UNT-QTY TO D1-INV-UNITS.                     16170012
161800                                                                  16180012
161900     COMPUTE PV-FOB-INV-RCV-QTY =                                 16190012
162000            ( PV-RPT-INV-UNT-QTY - PV-RPT-RCV-UNT-QTY ).          16200012
162100     MOVE PV-FOB-INV-RCV-QTY     TO D1-RCV-VAR-UNITS.             16210012
162200                                                                  16220012
162300     IF PV-RPT-INV-UNT-QTY NOT = ZEROES                           16230012
162400         COMPUTE PV-FOB-INV-QTY-VAR-PCT = ( ( PV-FOB-INV-RCV-QTY  16240012
162500            / PV-RPT-INV-UNT-QTY ) * 100 ) + .005                 16250012
162600     ELSE                                                         16260012
162700         IF PV-FOB-INV-RCV-QTY = ZEROES                           16270012
162800             MOVE ZEROES         TO PV-FOB-INV-QTY-VAR-PCT        16280012
162900         ELSE                                                     16290012
163000             IF PV-FOB-INV-RCV-QTY < ZEROES                       16300012
163100                 MOVE -100.00000 TO PV-FOB-INV-QTY-VAR-PCT        16310012
163200             ELSE                                                 16320012
163300                 MOVE 100.00000  TO PV-FOB-INV-QTY-VAR-PCT        16330012
163400             END-IF                                               16340012
163500         END-IF                                                   16350012
163600     END-IF.                                                      16360012
163700     MOVE PV-FOB-INV-QTY-VAR-PCT TO D1-PCT-VAR.                   16370012
163800                                                                  16380012
163900     MOVE PC-DASH-LIT            TO H7-DASH1   H7-DASH2           16390012
164000              H7-DASH3   H7-DASH5   H7-DASH6   H7-DASH8.          16400012
164100                                                                  16410012
164200*    - PRINT FOB TOTAL DETAIL HEADINGS.                          *16420012
164300     IF H2-FIRST-BYTE = 'Y'                                       16430012
164400        MOVE T1A-HEADER1            TO REPORT-REC                 16440012
164500     ELSE                                                         16450012
164600        MOVE T1-HEADER1             TO REPORT-REC                 16460012
164700     END-IF.                                                      16470012
164800     PERFORM W200-WRITE-DETAIL-HEADINGS.                          16480012
164900                                                                  16490012
165000                                                                  16500012
165100 X200-FORMAT-TOTAL-COMPONENTS.                                    16510012
165200*----------------------------------------------------------------*16520012
165300*    FORMAT TOTAL FOB COMPONENTS.                                *16530012
165400*                                                                *16540012
165500*    - FORMAT TOTAL FOB DATA TO DETAIL REPORT LINE.              *16550012
165600*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *16560012
165700*----------------------------------------------------------------*16570012
165800                                                                  16580012
165900                                                                  16590012
166000*    - FORMAT DATA TO DETAIL REPORT LINE.                        *16600012
166100     IF PV-RPT-PO-COST-AMT (CHRG-SUB) = ZEROES                    16610012
166200         MOVE SPACES             TO D2-PO-COST-ALPHA              16620012
166300     ELSE                                                         16630012
166400         MOVE PV-RPT-PO-COST-AMT (CHRG-SUB)                       16640012
166500                                 TO D2-PO-COST                    16650012
166600         IF PV-RPT-PO-COST-AMT (CHRG-SUB) < ZERO                  16660012
166700             INSPECT D2-PO-COST                                   16670012
166800               REPLACING ALL '-' BY '('                           16680012
166900             MOVE ')'            TO D2-PO-COST-RP                 16690012
167000         ELSE                                                     16700012
167100             MOVE ' '            TO D2-PO-COST-RP                 16710012
167200         END-IF                                                   16720012
167300     END-IF.                                                      16730012
167400                                                                  16740012
167500     MOVE PV-RPT-EST-COST-AMT (CHRG-SUB)                          16750012
167600                                 TO D2-EST-COST.                  16760012
167700     IF PV-RPT-EST-COST-AMT (CHRG-SUB) < ZERO                     16770012
167800         INSPECT D2-EST-COST                                      16780012
167900           REPLACING ALL '-' BY '('                               16790012
168000         MOVE ')'                TO D2-EST-COST-RP                16800012
168100     ELSE                                                         16810012
168200         MOVE ' '                TO D2-EST-COST-RP                16820012
168300     END-IF.                                                      16830012
168400                                                                  16840012
168500     IF PV-RPT-PO-EST-AMT (CHRG-SUB) = ZEROES                     16850012
168600         MOVE SPACES             TO D2-PO-EST-VAR-ALPHA           16860012
168700     ELSE                                                         16870012
168800         MOVE PV-RPT-PO-EST-AMT (CHRG-SUB)                        16880012
168900                                 TO D2-PO-EST-VAR                 16890012
169000         IF PV-RPT-PO-EST-AMT (CHRG-SUB) < ZERO                   16900012
169100             INSPECT D2-PO-EST-VAR                                16910012
169200                   REPLACING ALL '-' BY '('                       16920012
169300             MOVE ')'            TO D2-PO-EST-VAR-RP              16930012
169400         ELSE                                                     16940012
169500             MOVE ' '            TO D2-PO-EST-VAR-RP              16950012
169600         END-IF                                                   16960012
169700     END-IF.                                                      16970012
169800                                                                  16980012
169900     MOVE PV-RPT-RCV-COST-AMT (CHRG-SUB)                          16990012
170000                                 TO D2-RCV-COST.                  17000012
170100     IF PV-RPT-RCV-COST-AMT (CHRG-SUB) < ZERO                     17010012
170200         INSPECT D2-RCV-COST                                      17020012
170300           REPLACING ALL '-' BY '('                               17030012
170400         MOVE ')'                TO D2-RCV-COST-RP                17040012
170500     ELSE                                                         17050012
170600         MOVE ' '                TO D2-RCV-COST-RP                17060012
170700     END-IF.                                                      17070012
170800                                                                  17080012
170900     MOVE PV-RPT-INV-COST-AMT (CHRG-SUB)                          17090012
171000                                 TO D2-INV-COST.                  17100012
171100     IF PV-RPT-INV-COST-AMT (CHRG-SUB) < ZERO                     17110012
171200         INSPECT D2-INV-COST                                      17120012
171300           REPLACING ALL '-' BY '('                               17130012
171400         MOVE ')'                TO D2-INV-COST-RP                17140012
171500     ELSE                                                         17150012
171600         MOVE ' '                TO D2-INV-COST-RP                17160012
171700     END-IF.                                                      17170012
171800                                                                  17180012
171900     MOVE PV-RPT-INV-RCV-AMT (CHRG-SUB)                           17190012
172000                                 TO D2-INV-RCV-VAR                17200012
172100     IF PV-RPT-INV-RCV-AMT (CHRG-SUB) < ZERO                      17210012
172200         INSPECT D2-INV-RCV-VAR                                   17220012
172300           REPLACING ALL '-' BY '('                               17230012
172400         MOVE ')'                TO D2-INV-RCV-VAR-RP             17240012
172500     ELSE                                                         17250012
172600         MOVE ' '                TO D2-INV-RCV-VAR-RP             17260012
172700     END-IF.                                                      17270012
172800                                                                  17280012
172900     IF PV-RPT-INV-COST-AMT (CHRG-SUB) NOT = ZEROES               17290012
173000         COMPUTE PV-INV-RCV-VAR-PCT = (                           17300012
173100               ( PV-RPT-INV-RCV-AMT (CHRG-SUB)                    17310012
173200               / PV-RPT-INV-COST-AMT (CHRG-SUB) ) * 100 ) + .005  17320012
173300     ELSE                                                         17330012
173400         IF PV-RPT-INV-RCV-AMT (CHRG-SUB) = ZEROES                17340012
173500             MOVE ZEROES         TO PV-INV-RCV-VAR-PCT            17350012
173600         ELSE                                                     17360012
173700             IF PV-RPT-INV-RCV-AMT (CHRG-SUB) < ZEROES            17370012
173800                 MOVE -100.00000 TO PV-INV-RCV-VAR-PCT            17380012
173900             ELSE                                                 17390012
174000                 MOVE 100.00000  TO PV-INV-RCV-VAR-PCT            17400012
174100             END-IF                                               17410012
174200         END-IF                                                   17420012
174300     END-IF.                                                      17430012
174400     MOVE PV-INV-RCV-VAR-PCT     TO D2-PCT-VAR.                   17440012
174500     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            17450012
174600                                                                  17460012
174700     MOVE D2-DETAIL2             TO REPORT-REC.                   17470012
174800     MOVE +1                     TO PV-LINE-SKIP.                 17480012
174900                                                                  17490012
175000                                                                  17500012
175100                                                                  17510012
175200 X250-FORMAT-TOTAL-LC.                                            17520012
175300*----------------------------------------------------------------*17530012
175400*    FORMAT TOTAL FOB 'LC' COMPONENT.                            *17540012
175500*                                                                *17550012
175600*    - FORMAT DASHLINE AND PRINT.                                *17560012
175700*    - FORMAT TOTAL FOB DATA TO DETAIL REPORT LINE.              *17570012
175800*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *17580012
175900*----------------------------------------------------------------*17590012
176000                                                                  17600012
176100*    - FORMAT DASHLINE AND PRINT.                                *17610012
176200     MOVE SPACES                 TO H7-DASH6   H7-DASH2           17620012
176300                                    H7-DASH5   H7-DASH8.          17630012
176400     MOVE H7-DASHLINE            TO REPORT-REC.                   17640012
176500     MOVE +1                     TO PV-LINE-SKIP.                 17650012
176600     PERFORM W300-PRINT-DETAIL.                                   17660012
176700                                                                  17670012
176800*    - FORMAT TOTAL FOB DATA TO DETAIL REPORT LINE.              *17680012
176900*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *17690012
177000     IF PV-RPT-PO-COST-AMT (CHRG-SUB) = ZEROES                    17700012
177100         MOVE SPACES             TO D2-PO-COST-ALPHA              17710012
177200     ELSE                                                         17720012
177300         MOVE PV-RPT-PO-COST-AMT (CHRG-SUB)                       17730012
177400                                 TO D2-PO-COST                    17740012
177500         IF PV-RPT-PO-COST-AMT (CHRG-SUB) < ZERO                  17750012
177600             INSPECT D2-PO-COST                                   17760012
177700               REPLACING ALL '-' BY '('                           17770012
177800             MOVE ')'            TO D2-PO-COST-RP                 17780012
177900         ELSE                                                     17790012
178000             MOVE ' '            TO D2-PO-COST-RP                 17800012
178100         END-IF                                                   17810012
178200     END-IF.                                                      17820012
178300                                                                  17830012
178400     MOVE PV-RPT-EST-COST-AMT (CHRG-SUB)                          17840012
178500                                 TO D2-EST-COST                   17850012
178600     .                                                            17860012
178700     IF PV-RPT-EST-COST-AMT (CHRG-SUB) < ZERO                     17870012
178800         INSPECT D2-EST-COST                                      17880012
178900           REPLACING ALL '-' BY '('                               17890012
179000         MOVE ')'                TO D2-EST-COST-RP                17900012
179100     ELSE                                                         17910012
179200         MOVE ' '                TO D2-EST-COST-RP                17920012
179300     END-IF.                                                      17930012
179400                                                                  17940012
179500     IF PV-RPT-PO-COST-AMT (CHRG-SUB) > ZEROES                    17950012
179600         COMPUTE PV-RPT-PO-EST-AMT (CHRG-SUB) =                   17960012
179700               ( PV-RPT-PO-COST-AMT (CHRG-SUB)                    17970012
179800               - PV-RPT-EST-COST-AMT (CHRG-SUB) )                 17980012
179900         MOVE PV-RPT-PO-EST-AMT (CHRG-SUB)                        17990012
180000                                 TO D2-PO-EST-VAR                 18000012
180100         IF PV-RPT-PO-EST-AMT (CHRG-SUB) < ZERO                   18010012
180200             INSPECT D2-PO-EST-VAR                                18020012
180300               REPLACING ALL '-' BY '('                           18030012
180400             MOVE ')'            TO D2-PO-EST-VAR-RP              18040012
180500         ELSE                                                     18050012
180600             MOVE ' '            TO D2-PO-EST-VAR-RP              18060012
180700         END-IF                                                   18070012
180800     ELSE                                                         18080012
180900         MOVE SPACES             TO D2-PO-EST-VAR-ALPHA           18090012
181000     END-IF.                                                      18100012
181100                                                                  18110012
181200     MOVE PV-RPT-RCV-COST-AMT (CHRG-SUB)                          18120012
181300                                 TO D2-RCV-COST                   18130012
181400     .                                                            18140012
181500     IF PV-RPT-RCV-COST-AMT (CHRG-SUB) < ZERO                     18150012
181600         INSPECT D2-RCV-COST                                      18160012
181700           REPLACING ALL '-' BY '('                               18170012
181800         MOVE ')'                TO D2-RCV-COST-RP                18180012
181900     ELSE                                                         18190012
182000         MOVE ' '                TO D2-RCV-COST-RP                18200012
182100     END-IF.                                                      18210012
182200                                                                  18220012
182300     MOVE PV-RPT-INV-COST-AMT (CHRG-SUB)                          18230012
182400                                 TO D2-INV-COST.                  18240012
182500     MOVE PV-RPT-INV-COST-AMT (CHRG-SUB)                          18250012
182600                                 TO PV-INV-COST-AMT               18260012
182700     .                                                            18270012
182800     IF PV-RPT-INV-COST-AMT (CHRG-SUB) < ZERO                     18280012
182900         INSPECT D2-INV-COST                                      18290012
183000           REPLACING ALL '-' BY '('                               18300012
183100         MOVE ')'                TO D2-INV-COST-RP                18310012
183200     ELSE                                                         18320012
183300         MOVE ' '                TO D2-INV-COST-RP                18330012
183400     END-IF.                                                      18340012
183500                                                                  18350012
183600     MOVE PV-RPT-INV-RCV-AMT (CHRG-SUB)                           18360012
183700                                 TO D2-INV-RCV-VAR.               18370012
183800     MOVE PV-RPT-INV-RCV-AMT (CHRG-SUB)                           18380012
183900                                 TO PV-LC-INV-RCV-AMT             18390012
184000     .                                                            18400012
184100     IF PV-RPT-INV-RCV-AMT (CHRG-SUB) < ZERO                      18410012
184200         INSPECT D2-INV-RCV-VAR                                   18420012
184300           REPLACING ALL '-' BY '('                               18430012
184400         MOVE ')'                TO D2-INV-RCV-VAR-RP             18440012
184500     ELSE                                                         18450012
184600         MOVE ' '                TO D2-INV-RCV-VAR-RP             18460012
184700     END-IF.                                                      18470012
184800                                                                  18480012
184900     IF PV-RPT-INV-COST-AMT (CHRG-SUB) NOT = ZEROES               18490012
185000         COMPUTE PV-RPT-INV-RCV-PCT (CHRG-SUB) = (                18500012
185100               ( PV-RPT-INV-RCV-AMT (CHRG-SUB)                    18510012
185200               / PV-RPT-INV-COST-AMT (CHRG-SUB) ) * 100 ) + .005  18520012
185300     ELSE                                                         18530012
185400         IF PV-RPT-INV-RCV-AMT (CHRG-SUB) = ZEROES                18540012
185500             MOVE ZEROES         TO PV-RPT-INV-RCV-PCT            18550012
185600                                                      (CHRG-SUB)  18560012
185700         ELSE                                                     18570012
185800             IF PV-RPT-INV-RCV-AMT (CHRG-SUB) < ZEROES            18580012
185900                 MOVE -100.00000 TO PV-RPT-INV-RCV-PCT            18590012
186000                                                      (CHRG-SUB)  18600012
186100             ELSE                                                 18610012
186200                 MOVE 100.00000  TO PV-RPT-INV-RCV-PCT            18620012
186300                                                      (CHRG-SUB)  18630012
186400             END-IF                                               18640012
186500         END-IF                                                   18650012
186600     END-IF.                                                      18660012
186700     MOVE PV-RPT-INV-RCV-PCT (CHRG-SUB)                           18670012
186800                                 TO D2-PCT-VAR                    18680012
186900     .                                                            18690012
187000     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            18700012
187100                                                                  18710012
187200     MOVE D2-DETAIL2             TO REPORT-REC.                   18720012
187300     MOVE +1                     TO PV-LINE-SKIP.                 18730012
187400                                                                  18740012
187500                                                                  18750012
187600 X300-FORMAT-TOTAL-LCL.                                           18760012
187700*----------------------------------------------------------------*18770012
187800*    FORMAT THE TOTAL FOB 'LCL' RECORD.                          *18780012
187900*                                                                *18790012
188000*    - FORMAT TOTAL FOB 'LCL' TO DETAIL REPORT LINE AND PRINT.   *18800012
188100*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *18810012
188200*    - FORMAT TOTAL RPT DATA TO DETAIL REPORT LINE AND PRINT.    *18820012
188300*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *18830012
188400*----------------------------------------------------------------*18840012
188500                                                                  18850012
188600*    - FORMAT TOTAL FOB DATA TO DETAIL REPORT LINE AND PRINT.    *18860012
188700*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *18870012
188800     MOVE SPACES                 TO D2-PO-COST-ALPHA              18880012
188900                                    D2-EST-COST-ALPHA             18890012
189000                                    D2-PO-EST-VAR-ALPHA           18900012
189100                                    D2-RCV-COST-ALPHA             18910012
189200                                    D2-PCT-VAR-ALPHA.             18920012
189300                                                                  18930012
189400* ADD FOB LCL INV COST TO FOB LANDED INVOICE COST                 18940012
189500     COMPUTE PV-INV-COST-AMT =                                    18950012
189600           ( PV-INV-COST-AMT + PV-RPT-INV-COST-AMT                18960012
189700                                                    (CHRG-SUB) ). 18970012
189800* ADD FOB LCL INV/RCV VAR COST TO FOB LANDED INVOICE/RCV COST     18980012
189900     COMPUTE PV-LC-INV-RCV-AMT =                                  18990012
190000           ( PV-LC-INV-RCV-AMT + PV-RPT-INV-COST-AMT              19000012
190100                                                    (CHRG-SUB) ). 19010012
190200                                                                  19020012
190300     MOVE PV-RPT-INV-COST-AMT (CHRG-SUB)                          19030012
190400                                 TO D2-INV-COST                   19040012
190500                                    D2-INV-RCV-VAR.               19050012
190600     IF PV-RPT-INV-COST-AMT (CHRG-SUB) < ZERO                     19060012
190700         INSPECT D2-INV-COST                                      19070012
190800           REPLACING ALL '-' BY '('                               19080012
190900         INSPECT D2-INV-RCV-VAR                                   19090012
191000           REPLACING ALL '-' BY '('                               19100012
191100         MOVE ')'                TO D2-INV-COST-RP                19110012
191200                                    D2-INV-RCV-VAR-RP             19120012
191300     ELSE                                                         19130012
191400         MOVE ' '                TO D2-INV-COST-RP                19140012
191500                                    D2-INV-RCV-VAR-RP             19150012
191600     END-IF.                                                      19160012
191700                                                                  19170012
191800*    - FORMAT DASHLINE AND PRINT.                                *19180012
191900     MOVE D2-DETAIL2             TO REPORT-REC.                   19190012
192000     MOVE +2                     TO PV-LINE-SKIP.                 19200012
192100     PERFORM W300-PRINT-DETAIL.                                   19210012
192200                                                                  19220012
192300     MOVE SPACES                 TO H7-DASH1   H7-DASH2           19230012
192400              H7-DASH3   H7-DASH5   H7-DASH6   H7-DASH8.          19240012
192500     MOVE H7-DASHLINE            TO REPORT-REC.                   19250012
192600     MOVE +1                     TO PV-LINE-SKIP.                 19260012
192700     PERFORM W300-PRINT-DETAIL.                                   19270012
192800                                                                  19280012
192900                                                                  19290012
193000*    - FORMAT TOTAL RPT DATA TO DETAIL REPORT LINE.              *19300012
193100*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *19310012
193200*       THIS WILL BE PRINTED IN B2ISPLAYED WITHIN PARENS.        *19320012
193300     MOVE SPACES                 TO D3-COMPNT-DESC.               19330012
193400     MOVE '  FINAL REPORT TOTALS         '                        19340012
193500                                 TO D3-COMPNT-DESC.               19350012
193600     MOVE PV-INV-COST-AMT                                         19360012
193700                                 TO D3-INV-COST.                  19370012
193800     IF PV-INV-COST-AMT < ZEROES                                  19380012
193900         INSPECT D3-INV-COST                                      19390012
194000           REPLACING ALL '-' BY '('                               19400012
194100         MOVE ')'                TO D3-INV-COST-RP                19410012
194200     ELSE                                                         19420012
194300         MOVE ' '                TO D3-INV-COST-RP                19430012
194400     END-IF.                                                      19440012
194500                                                                  19450012
194600     MOVE PV-LC-INV-RCV-AMT                                       19460012
194700                                 TO D3-INV-RCV-VAR.               19470012
194800     IF PV-LC-INV-RCV-AMT < ZEROES                                19480012
194900         INSPECT D3-INV-RCV-VAR                                   19490012
195000           REPLACING ALL '-' BY '('                               19500012
195100         MOVE ')'                TO D3-INV-RCV-VAR-RP             19510012
195200     ELSE                                                         19520012
195300         MOVE ' '                TO D3-INV-RCV-VAR-RP             19530012
195400     END-IF.                                                      19540012
195500                                                                  19550012
195600     MOVE D3-DETAIL3             TO REPORT-REC.                   19560012
195700     MOVE +2                     TO PV-LINE-SKIP.                 19570012
195800                                                                  19580012
195900                                                                  19590012
196000 Z998-ABEND.                                                      19600012
196100*----------------------------------------------------------------*19610012
196200*    ABEND ROUTINE                                               *19620012
196300*----------------------------------------------------------------*19630012
196400                                                                  19640012
196500     CLOSE IMPORT-REPORT-FILE                                     19650012
196600           REPORT-FILE.                                           19660012
196700                                                                  19670012
196800     DISPLAY AA-ABEND-LIT.                                        19680012
196900     DISPLAY AA-PROGRAM-LIT.                                      19690012
197000     DISPLAY AA-PARAGRAPH-LIT.                                    19700012
197100     DISPLAY AA-MESSAGE-LINE.                                     19710012
197200     CALL 'ILBOABN0' USING ABEND-CODE.                            19720012
197300 Z999-DB2-ABEND.                                                  19730012
197400*----------------------------------------------------------------*19740012
197500*    DB2 ABEND ROUTINE                                           *19750012
197600*----------------------------------------------------------------*19760012
197700                                                                  19770012
197800     CLOSE IMPORT-REPORT-FILE                                     19780012
197900           REPORT-FILE.                                           19790012
198000                                                                  19800012
198100     DISPLAY AA-ABEND-LIT.                                        19810012
198200     DISPLAY AA-MESSAGE-LINE.                                     19820012
198300     DISPLAY AA-DB2-ERROR-LIT.                                    19830012
198400     DISPLAY AA-PROGRAM-LIT.                                      19840012
198500     DISPLAY AA-PARAGRAPH-LIT.                                    19850012
198600     DISPLAY AA-DB2-OPERATION-LIT.                                19860012
198700     DISPLAY AA-DB2-TABLE-1.                                      19870012
198800     DISPLAY AA-DB2-TABLE-2.                                      19880012
198900     DISPLAY AA-DB2-TABLE-3.                                      19890012
199000     SET AC-DB2-ERROR TO TRUE.                                    19900012
199100                                                                  19910012
199200     COPY DPPD004.                                                19920012
199300                                                                  19930012
199400     CALL 'ILBOABN0' USING ABEND-CODE.                            19940012
199500                                                                  19950012
199600                                                                  19960012
