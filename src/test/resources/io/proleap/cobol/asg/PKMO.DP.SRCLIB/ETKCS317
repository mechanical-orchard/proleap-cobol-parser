000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    ETKCS317.                                         00020000
000300 AUTHOR.        MARC BLAZICH. G&R.                                00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  02-28-94.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    TRANID      - E317                                         * 00090000
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100000
001100*    DESCRIPTION - TRADING PARTNER TRANSACTION SET MAINTENANCE  * 00110000
001200*    MAPSET      - ETKM317                                      * 00120000
001300*                                                               * 00130000
001400*    THIS PROGRAM WILL ADD, UPDATE, AND DELETE TRADING PARTNER  * 00140000
001500*    TRANSACTION SETS.                                          * 00150000
001600*                                                               * 00160000
001700*---------------------------------------------------------------* 00170000
001800*  CHANGE MADE: ALLOW THE SAME VENDOR TO BE SETUP TO RECEIVE    * 00180000
001900*               THE SAME TRANSACTION SET UNDER 2 DIFFERENT      * 00190000
002000*               ID'S.                                           * 00200000
002100*  MADE BY: DAN FRANKLIN - 8/8/94                               * 00210000
002200*                                                               * 00220000
002300*     03/20/97 TOM MEDREK - FIXED APPLICATION SPECIFIC SECTION. * 00230000
002400*       ADDED NRF INDICATOR WHICH WAS ADDED TO ETWS300 &        * 00240000
002500*       ETWS301 EARLIER.                                        * 00250000
002600*                                                               * 00260000
002700******************************************************************00270000
002800*  DATE  05/14/03                                                 00280000
002900*  CHANGE MADE:                                                   00290000
003000*   ADDED CODE TO SEND ENT-ID IN MQSERIES UPDATE OF RMS/SUPPLIER. 00300000
003100*  MADE BY: JON FIEDLER             WR# : 24663                   00310000
003200******************************************************************00320000
003300*  DATE  06/16/03                                                 00330000
003400*  CHANGE MADE:                                                   00340000
003500*  FIXED ISSUE WITH INCORRECT PO AND ASN INDICATORS BEING SENT    00350000
003600*  OVER TO THE RMS/SUPPLIER SYSTEM. THIS ISSUE INVOLVES VENDORS   00360000
003700*  WHO HAVE MULTIPLE IDS. THE CHECK FOR PO AND ASN SETUP ONLY     00370000
003800*  LOOKED AT THE CURRENT TP_DKEY BEING ADDED, UPDATED, OR DELETED.00380000
003900*  THE CODE WILL NOW LOOK AT PO AND ASN SETUP FOR A PARTICULAR    00390000
004000*  ENT_ID AND WILL CHECK ALL TP_DKEYS INVOLVING ONE VENDOR FOR    00400000
004100*  PO AND ASN SETUP.                                              00410000
004200*  MADE BY: JON FIEDLER             WR# : 23521                   00420000
004300******************************************************************00430000
004400*  DATE  06/26/2003                                               00440000
004500*  CHANGE MADE:                                                   00450000
004600*   CHANGED THE PO/ASN SETUP CHECK TO EXTRACT BOTH TEST AND       00460000
004700*   PRODUCTION TRANSACTION SETS.                                  00470000
004800*  MADE BY: JON FIEDLER             WR# : 23521                   00480000
004900******************************************************************00490000
004910* 10/11/2021 GERMAN BANDA                    WR/IR #: CHG0262418* 00491002
004920*            - CHANGE CALL OF DPKUT100 TO                       * 00492002
004930*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00493002
004940*              MAKING THE CALL DYNAMIC VS STATIC                * 00494002
004950*                                                               * 00495002
004900******************************************************************00495103
CICS  *  CHANGED 10/25/2022    BY BARB SCHULTZ    WR: CHG0277210      * 00497005
CICS  *                                                               * 00498003
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00499003
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00499103
004960*---------------------------------------------------------------* 00499303
005000                                                                  00500000
005100 ENVIRONMENT DIVISION.                                            00510000
005200 DATA DIVISION.                                                   00520000
005300                                                                  00530000
005400/                                                                 00540000
005500 WORKING-STORAGE SECTION.                                         00550000
005600                                                                  00560000
005700 01  DK-DB2-KEYS.                                                 00570000
005800     05  DK-TP-DKEY                   PIC S9(09) COMP.            00580000
005900     05  DK-TRAN-SET-CDE              PIC  X(03).                 00590000
006000     05  DK-PROD-TEST-IND             PIC  X(01).                 00600000
006100     05  DK-DIR-IND                   PIC  X(01).                 00610000
006200     05  DK-VER-NBR                   PIC  X(12).                 00620000
006300                                                                  00630000
006400 01  PC-PROGRAM-CONSTANTS.                                        00640000
006500     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00650000
006600                                                    'ET317A  '.   00660000
006700     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00670000
006800                                                    'ETKM317 '.   00680000
006900     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00690000
007000                                                    COMP.         00700000
007100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00710000
007200                                                    'ETKCS317'.   00720000
007300     05  PC-DPKUT100                    PIC  X(08)  VALUE         00730000
007400                                                    'DPKUT100'.   00740000
007500     05  PC-DPKUT500                    PIC  X(08)  VALUE         00750000
007600                                                    'DPKUT500'.   00760000
007700     05  PC-NULL-DATE                   PIC  X(10)  VALUE         00770000
007800                                                    '9999-09-09'. 00780000
007900     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00790000
008000                                                    COMP-3.       00800000
008100     05  PC-VER-4010                    PIC X(12)                 00810000
008200                                            VALUE '004010VICS  '. 00820000
008300     05  PC-TSYMSG-NUMBERS.                                       00830000
008400         10  PC-TSYMSG-00004            PIC  9(05)  VALUE  00004. 00840000
008500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE  00005. 00850000
008600         10  PC-TSYMSG-00007            PIC  9(05)  VALUE  00007. 00860000
008700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE  00008. 00870000
008800         10  PC-TSYMSG-00009            PIC  9(05)  VALUE  00009. 00880000
008900         10  PC-TSYMSG-00016            PIC  9(05)  VALUE  00016. 00890000
009000         10  PC-TSYMSG-00034            PIC  9(05)  VALUE  00034. 00900000
009100         10  PC-TSYMSG-00046            PIC  9(05)  VALUE  00046. 00910000
009200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE  00057. 00920000
009300         10  PC-TSYMSG-00059            PIC  9(05)  VALUE  00059. 00930000
009400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE  00069. 00940000
009500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE  00070. 00950000
009600         10  PC-TSYMSG-00112            PIC  9(05)  VALUE  00112. 00960000
009700         10  PC-TSYMSG-00115            PIC  9(05)  VALUE  00115. 00970000
009800         10  PC-TSYMSG-00116            PIC  9(05)  VALUE  00116. 00980000
009900         10  PC-TSYMSG-00117            PIC  9(05)  VALUE  00117. 00990000
010000         10  PC-TSYMSG-00134            PIC  9(05)  VALUE  00134. 01000000
010100         10  PC-TSYMSG-00148            PIC  9(05)  VALUE  00148. 01010000
010200         10  PC-TSYMSG-00158            PIC  9(05)  VALUE  00158. 01020000
010300         10  PC-TSYMSG-00165            PIC  9(05)  VALUE  00165. 01030000
010400         10  PC-TSYMSG-00231            PIC  9(05)  VALUE  00231. 01040000
010500         10  PC-TSYMSG-00349            PIC  9(05)  VALUE  00349. 01050000
010600         10  PC-TSYMSG-00396            PIC  9(05)  VALUE  00396. 01060000
010700         10  PC-TSYMSG-00762            PIC  9(05)  VALUE  00762. 01070000
010800         10  PC-TSYMSG-00765            PIC  9(05)  VALUE  00765. 01080000
010900         10  PC-TSYMSG-00766            PIC  9(05)  VALUE  00766. 01090000
011000         10  PC-TSYMSG-00833            PIC  9(05)  VALUE  00833. 01100000
011100         10  PC-TSYMSG-00834            PIC  9(05)  VALUE  00834. 01110000
011200         10  PC-TSYMSG-00835            PIC  9(05)  VALUE  00835. 01120000
011300         10  PC-TSYMSG-00836            PIC  9(05)  VALUE  00836. 01130000
011400         10  PC-TSYMSG-00837            PIC  9(05)  VALUE  00837. 01140000
011500         10  PC-TSYMSG-01878            PIC  9(05)  VALUE  01878. 01150000
011600***** VENDOR NOT SET UP FOR PRODUCTION 850                        01160000
011700         10  PC-TSYMSG-03461            PIC  9(05)  VALUE  03461. 01170000
011800***** VENDOR NOT SET UP FOR 850                                   01180000
011900         10  PC-TSYMSG-03462            PIC  9(05)  VALUE  03462. 01190000
012000***** VENDOR SET UP FOR 860                                       01200000
012100         10  PC-TSYMSG-03463            PIC  9(05)  VALUE  03463. 01210000
012200***** VENDOR SET UP FOR PRODUCTION 860                            01220000
012300         10  PC-TSYMSG-03464            PIC  9(05)  VALUE  03464. 01230000
012400     05  PC-VNKCS024                    PIC  X(08)  VALUE         01240000
012500                                                    'VNKCS024'.   01250000
012600                                                                  01260000
012700 01  PV-PROGRAM-VARIABLES.                                        01270000
012800     05  PV-INT-APPL-FORMAT-IND         PIC  X(01).               01280000
012900*****    88  PV-INTER-APPL-CRIT-ADD                 VALUE '1'.    01290000
013000         88  PV-INTER-APPL-CRIT-ADD                 VALUE ' '.    01300000
013100         88  PV-INTER-APPL-LIST-UPDATE              VALUE '4'.    01310000
013200         88  PV-INTER-APPL-LIST-DELETE              VALUE '5'.    01320000
013300                                                                  01330000
013400     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      01340000
013500                                                    COMP SYNC.    01350000
013600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01360000
013700                                                    COMP SYNC.    01370000
013800     05  PV-CCYYMMDD-DATE               PIC  X(10).               01380000
013900     05  PV-CCYYMMDD-DATE-RDF           REDEFINES                 01390000
014000         PV-CCYYMMDD-DATE.                                        01400000
014100         10  PV-CCYY                    PIC  X(04).               01410000
014200         10  PV-CCYY-9   REDEFINES PV-CCYY                        01420000
014300                                        PIC  9(04).               01430000
014400         10  PV-CCYY-RDF REDEFINES PV-CCYY.                       01440000
014500             15  PV-CC                  PIC  9(02).               01450000
014600             15  PV-YY                  PIC  9(02).               01460000
014700         10  PV-DASH1                   PIC  X(01).               01470000
014800         10  PV-MM                      PIC  X(02).               01480000
014900         10  PV-DASH2                   PIC  X(01).               01490000
015000         10  PV-DD                      PIC  X(02).               01500000
015100     05  PV-DUP-COUNTER                 PIC S9(04) COMP.          01510000
015200     05  PV-TRAN-SET-CDE                PIC  X(03).               01520000
015300     05  PV-PROD-TEST-IND               PIC  X(01).               01530000
015400                                                                  01540000
015500 01  PS-PROGRAM-SWITCHES.                                         01550000
015600     05  PS-VALID-DATE-SW               PIC  X(01).               01560000
015700         88  PS-VALID-DATE                          VALUE 'Y'.    01570000
015800         88  PS-INVALID-DATE                        VALUE 'N'.    01580000
015900     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01590000
016000         88  PS-NO-ERROR                            VALUE 'Y'.    01600000
016100         88  PS-ERROR                               VALUE 'N'.    01610000
016200     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01620000
016300         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01630000
016400         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01640000
016500     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01650000
016600         88  PS-DONE                                VALUE 'Y'.    01660000
016700         88  PS-NOT-DONE                            VALUE 'N'.    01670000
016800     05  PS-MQ-SEND-SW                  PIC  X(01)  VALUE 'N'.    01680000
016900         88  PS-SEND                                VALUE 'Y'.    01690000
017000         88  PS-DONT-SEND                           VALUE 'N'.    01700000
017100     05  PS-DELETE-SW                   PIC  X(01)  VALUE 'N'.    01710000
017200         88  PS-DELETE                              VALUE 'Y'.    01720000
017300         88  PS-NON-DELETE                          VALUE 'N'.    01730000
017400     05  PS-PO850-EXISTS-SW             PIC  X(01)  VALUE ' '.    01740000
017500         88  PS-PO850-PROD-EXISTS                   VALUE 'P'.    01750000
017600         88  PS-PO850-TEST-EXISTS                   VALUE 'T'.    01760000
017700         88  PS-PO850-ANY-EXISTS                    VALUE 'A'.    01770000
017800         88  PS-NO-PO850-EXISTS                     VALUE 'N'.    01780000
017900     05  PS-PC860-EXISTS-SW             PIC  X(01)  VALUE ' '.    01790000
018000         88  PS-PC860-PROD-EXISTS                   VALUE 'P'.    01800000
018100         88  PS-PC860-ANY-EXISTS                    VALUE 'A'.    01810000
018200         88  PS-NO-PC860-EXISTS                     VALUE 'N'.    01820000
018300         88  PS-PC860-DOES-NOT-MATTER               VALUE ' '.    01830000
018400                                                                  01840000
018500*---------------------------------------------------------------* 01850000
018600*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 01860000
018700*---------------------------------------------------------------* 01870000
018800                                                                  01880000
018900     COPY ETWS301.                                                01890000
019000                                                                  01900000
019100/                                                                 01910000
019200*---------------------------------------------------------------* 01920000
019300*    MAP LAYOUT                                                 * 01930000
019400*---------------------------------------------------------------* 01940000
019500                                                                  01950000
019600     COPY ETKM317.                                                01960000
019700                                                                  01970000
019800/                                                                 01980000
019900*---------------------------------------------------------------* 01990000
020000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02000000
020100*---------------------------------------------------------------* 02010000
020200                                                                  02020000
020300     COPY DPWS015.                                                02030000
020400                                                                  02040000
020500*---------------------------------------------------------------* 02050000
020600*    FUNCTION KEYS COPYBOOK.                                    * 02060000
020700*---------------------------------------------------------------* 02070000
020800                                                                  02080000
020900     COPY DPWS016.                                                02090000
021000                                                                  02100000
021100/                                                                 02110000
021200**--------------------------------------------------------------* 02120000
021300** COMMAREA FOR VNKCS024                                        * 02130000
021400**--------------------------------------------------------------* 02140000
021500 01 VN007-COMMAREA.                                               02150000
021600     COPY VNWS007.                                                02160000
021700 EJECT                                                            02170000
021800*---------------------------------------------------------------* 02180000
021900*  WORK AREA FOR NUMERIC EDIT ROUTINE - DPKUT100                * 02190000
022000*---------------------------------------------------------------* 02200000
022100     COPY DPWS010I.                                               02210000
022200                                                                  02220000
022300/                                                                 02230000
022400*---------------------------------------------------------------* 02240000
022500*  WORK AREA FOR THE DATE ROUTINE -     DPKUT500                * 02250000
022600*---------------------------------------------------------------* 02260000
022700     COPY DPWS500.                                                02270000
022800                                                                  02280000
022900/                                                                 02290000
023000*---------------------------------------------------------------* 02300000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02310003
023200*---------------------------------------------------------------* 02320000
023300                                                                  02330000
023400     COPY DPWS030.                                                02340000
CICS       COPY DPWS930.                                                02350003
023600/                                                                 02360000
023700*---------------------------------------------------------------* 02370000
023800*    STANDARD COMMAREA.                                         * 02380000
023900*---------------------------------------------------------------* 02390000
024000                                                                  02400000
024100     COPY DPWS020.                                                02410000
024200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02420000
024300                                                                  02430000
024400         10  INTER-APPL-COMM-AREA       PIC X(200).               02440000
024500     COPY ETWS300.                                                02450000
024600*---------------------------------------------------------------* 02460000
024700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02470000
024800*---------------------------------------------------------------* 02480000
024900         10  ASC-SPECIFIC-COMMAREA.                               02490000
025000             15  ASC-INT-APPL-FORMAT-IND    PIC X(01).            02500000
025100             15  ASC-ACTION-SW              PIC X(03).            02510000
025200                 88  ASC-ADD-PENDING        VALUE 'ADD'.          02520000
025300                 88  ASC-DELETE-PENDING     VALUE 'DEL'.          02530000
025400                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.          02540000
025500             15  ASC-DELETE-SUCCESSFUL-SW   PIC X(01).            02550000
025600                 88  ASC-DELETE-SUCCESSFUL  VALUE 'Y'.            02560000
025700             15  ASC-ADD-SUCCESSFUL-SW      PIC X(01).            02570000
025800                 88  ASC-ADD-NOT-SUCCESSFUL VALUE ' '.            02580000
025900                 88  ASC-ADD-SUCCESSFUL     VALUE 'Y'.            02590000
026000             15  ASC-FIELDS-CHANGED-SW      PIC X(01).            02600000
026100                 88  ASC-FIELDS-CHANGED     VALUE 'Y'.            02610000
026200             15  ASC-KEY-FIELDS.                                  02620000
026300                 20  ASC-KEY-TP-DKEY       PIC S9(09)  COMP.      02630000
026400                 20  ASC-KEY-TRAN-SET-CDE  PIC X(03).             02640000
026500                 20  ASC-KEY-PROD-TEST-IND PIC X(01).             02650000
026600                 20  ASC-KEY-DIR-IND       PIC X(01).             02660000
026700             15  ASC-ORIGINAL-FIELD-VALUES.                       02670000
026800                 20  ASC-VER-NBR                  PIC X(12).      02680000
026900                 20  ASC-COMM-MTHD                PIC X(01).      02690000
027000                 20  ASC-ACTV-DTE                 PIC X(10).      02700000
027100                 20  ASC-ACTV-DTE-RDF             REDEFINES       02710000
027200                     ASC-ACTV-DTE.                                02720000
027300                     25  ASC-ACTV-DTE-YY          PIC X(04).      02730000
027400                     25  FILLER                   PIC X(01).      02740000
027500                     25  ASC-ACTV-DTE-MM          PIC X(02).      02750000
027600                     25  FILLER                   PIC X(01).      02760000
027700                     25  ASC-ACTV-DTE-DD          PIC X(02).      02770000
027800                 20  ASC-INACTV-DTE               PIC X(10).      02780000
027900                 20  ASC-INACTV-DTE-RDF           REDEFINES       02790000
028000                     ASC-INACTV-DTE.                              02800000
028100                     25  ASC-INACTV-DTE-YY        PIC X(04).      02810000
028200                     25  FILLER                   PIC X(01).      02820000
028300                     25  ASC-INACTV-DTE-MM        PIC X(02).      02830000
028400                     25  FILLER                   PIC X(01).      02840000
028500                     25  ASC-INACTV-DTE-DD        PIC X(02).      02850000
028600                 20  ASC-LAST-CALL-DTE            PIC X(10).      02860000
028700                 20  ASC-LAST-CALL-DTE-RDF        REDEFINES       02870000
028800                     ASC-LAST-CALL-DTE.                           02880000
028900                     25  ASC-LAST-CALL-DTE-YY     PIC X(04).      02890000
029000                     25  FILLER                   PIC X(01).      02900000
029100                     25  ASC-LAST-CALL-DTE-MM     PIC X(02).      02910000
029200                     25  FILLER                   PIC X(01).      02920000
029300                     25  ASC-LAST-CALL-DTE-DD     PIC X(02).      02930000
029400                 20  ASC-NEXT-CALL-DTE            PIC X(10).      02940000
029500                 20  ASC-NEXT-CALL-DTE-RDF        REDEFINES       02950000
029600                     ASC-NEXT-CALL-DTE.                           02960000
029700                     25  ASC-NEXT-CALL-DTE-YY     PIC X(04).      02970000
029800                     25  FILLER                   PIC X(01).      02980000
029900                     25  ASC-NEXT-CALL-DTE-MM     PIC X(02).      02990000
030000                     25  FILLER                   PIC X(01).      03000000
030100                     25  ASC-NEXT-CALL-DTE-DD     PIC X(02).      03010000
030200                 20  ASC-NOTES-TXT                PIC X(80).      03020000
030300                 20  ASC-NOTES-TXT-RDF        REDEFINES           03030000
030400                     ASC-NOTES-TXT.                               03040000
030500                     25  ASC-NOTES-TXT1           PIC X(40).      03050000
030600                     25  ASC-NOTES-TXT2           PIC X(40).      03060000
030700             15  ASC-NEWLY-ENTERED-FIELDS.                        03070000
030800                 20  ASC-VER-NBR-NEW              PIC X(12).      03080000
030900                 20  ASC-COMM-MTHD-NEW            PIC X(01).      03090000
031000                 20  ASC-ACTV-DTE-NEW             PIC X(10).      03100000
031100                 20  ASC-ACTV-DTE-RDF-NEW         REDEFINES       03110000
031200                     ASC-ACTV-DTE-NEW.                            03120000
031300                     25  ASC-ACTV-DTE-YY-NEW      PIC X(04).      03130000
031400                     25  FILLER                   PIC X(01).      03140000
031500                     25  ASC-ACTV-DTE-MM-NEW      PIC X(02).      03150000
031600                     25  FILLER                   PIC X(01).      03160000
031700                     25  ASC-ACTV-DTE-DD-NEW      PIC X(02).      03170000
031800                 20  ASC-INACTV-DTE-NEW           PIC X(10).      03180000
031900                 20  ASC-INACTV-DTE-RDF-NEW       REDEFINES       03190000
032000                     ASC-INACTV-DTE-NEW.                          03200000
032100                     25  ASC-INACTV-DTE-YY-NEW    PIC X(04).      03210000
032200                     25  FILLER                   PIC X(01).      03220000
032300                     25  ASC-INACTV-DTE-MM-NEW    PIC X(02).      03230000
032400                     25  FILLER                   PIC X(01).      03240000
032500                     25  ASC-INACTV-DTE-DD-NEW    PIC X(02).      03250000
032600                 20  ASC-LAST-CALL-DTE-NEW        PIC X(10).      03260000
032700                 20  ASC-LAST-CALL-DTE-RDF-NEW    REDEFINES       03270000
032800                     ASC-LAST-CALL-DTE-NEW.                       03280000
032900                     25  ASC-LAST-CALL-DTE-YY-NEW PIC X(04).      03290000
033000                     25  FILLER                   PIC X(01).      03300000
033100                     25  ASC-LAST-CALL-DTE-MM-NEW PIC X(02).      03310000
033200                     25  FILLER                   PIC X(01).      03320000
033300                     25  ASC-LAST-CALL-DTE-DD-NEW PIC X(02).      03330000
033400                 20  ASC-NEXT-CALL-DTE-NEW        PIC X(10).      03340000
033500                 20  ASC-NEXT-CALL-DTE-RDF-NEW    REDEFINES       03350000
033600                     ASC-NEXT-CALL-DTE-NEW.                       03360000
033700                     25  ASC-NEXT-CALL-DTE-YY-NEW PIC X(04).      03370000
033800                     25  FILLER                   PIC X(01).      03380000
033900                     25  ASC-NEXT-CALL-DTE-MM-NEW PIC X(02).      03390000
034000                     25  FILLER                   PIC X(01).      03400000
034100                     25  ASC-NEXT-CALL-DTE-DD-NEW PIC X(02).      03410000
034200                 20  ASC-NOTES-TXT-NEW            PIC X(80).      03420000
034300                 20  ASC-NOTES-TXT-RDF-NEW    REDEFINES           03430000
034400                     ASC-NOTES-TXT-NEW.                           03440000
034500                     25  ASC-NOTES-TXT1-NEW       PIC X(40).      03450000
034600                     25  ASC-NOTES-TXT2-NEW       PIC X(40).      03460000
034700             15  ASC-OTHER-FIELDS.                                03470000
034800                 20  ASC-FUNC-CDE                  PIC  X(02).    03480000
034900                 20  ASC-ENT-ID                    PIC S9(9) COMP.03490000
035000                 20  ASC-NETWK-ID                  PIC  X(01).    03500000
035100                 20  ASC-VENDOR-NAME               PIC  X(35).    03510000
035200                 20  ASC-VEND-INCHG-QUAL           PIC  X(02).    03520000
035300                 20  ASC-VEND-INCHG-ID             PIC  X(15).    03530000
035400                 20  ASC-NRFC-ID                   PIC  X(01).    03540000
035500                 20  ASC-NETWORK-NAME              PIC  X(15).    03550000
035600                 20  ASC-TRAN-SET-NME              PIC  X(25).    03560000
035700                 20  ASC-COMM-MTHD-NME             PIC  X(05).    03570000
035800                 20  ASC-VER-NME                   PIC  X(01).    03580000
035900                 20  ASC-SETUP-DTE            PIC X(10).          03590000
036000                 20  ASC-SETUP-DTE-RDF        REDEFINES           03600000
036100                     ASC-SETUP-DTE.                               03610000
036200                     25  ASC-SETUP-DTE-YY     PIC X(04).          03620000
036300                     25  FILLER               PIC X(01).          03630000
036400                     25  ASC-SETUP-DTE-MM     PIC X(02).          03640000
036500                     25  FILLER               PIC X(01).          03650000
036600                     25  ASC-SETUP-DTE-DD     PIC X(02).          03660000
036700                 20  ASC-VER-CHG-DTE          PIC X(10).          03670000
036800                 20  ASC-VER-CHG-DTE-RDF      REDEFINES           03680000
036900                     ASC-VER-CHG-DTE.                             03690000
037000                     25  ASC-VER-CHG-DTE-YY   PIC X(04).          03700000
037100                     25  FILLER               PIC X(01).          03710000
037200                     25  ASC-VER-CHG-DTE-MM   PIC X(02).          03720000
037300                     25  FILLER               PIC X(01).          03730000
037400                     25  ASC-VER-CHG-DTE-DD   PIC X(02).          03740000
037500                 20  ASC-LAST-CHG-DTE         PIC X(10).          03750000
037600                 20  ASC-LAST-CHG-DTE-RDF     REDEFINES           03760000
037700                     ASC-LAST-CHG-DTE.                            03770000
037800                     25  ASC-LAST-CHG-DTE-YY  PIC X(04).          03780000
037900                     25  FILLER               PIC X(01).          03790000
038000                     25  ASC-LAST-CHG-DTE-MM  PIC X(02).          03800000
038100                     25  FILLER               PIC X(01).          03810000
038200                     25  ASC-LAST-CHG-DTE-DD  PIC X(02).          03820000
038300                 20  ASC-LAST-CHG-UID              PIC  X(08).    03830000
038400                 20  ASC-CURRENT-TIMESTAMP    PIC X(26).          03840000
038500                 20  ASC-CURRENT-TS-RDF       REDEFINES           03850000
038600                     ASC-CURRENT-TIMESTAMP.                       03860000
038700                     25  ASC-CURRENT-DATE     PIC X(10).          03870000
038800                     25  FILLER               PIC X(01).          03880000
038900                     25  ASC-CURRENT-TIME.                        03890000
039000                         30  ASC-HH           PIC 9(02).          03900000
039100                         30  FILLER           PIC X(01).          03910000
039200                         30  ASC-MIN          PIC 9(02).          03920000
039300                         30  FILLER           PIC X(01).          03930000
039400                         30  ASC-SEC          PIC 9(02).          03940000
039500                         30  FILLER           PIC X(01).          03950000
039600                         30  ASC-MILLI-SEC    PIC 9(06).          03960000
039700                 20  ASC-TRDPRT-INACTV-DTE    PIC X(10).          03970000
039800                 20  ASC-TRDPRT-ACTV-DTE      PIC X(10).          03980000
039900                                                                  03990000
040000             15  ASC-USE-SELECTION-QUEUE-IND                      04000000
040100                                        PIC  X(01).               04010000
040200                 88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    04020000
040300             15  ASC-SEL-QUEUE-NAME     PIC  X(08).               04030000
040400             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05)  COMP-3.       04040000
040500             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04050000
040600                                        PIC S9(09)  COMP-3.       04060000
040700             15  ASC-SEL-SUB            PIC S9(04)  COMP.         04070000
040800             15  ASC-SEL-ITEM           PIC S9(04)  COMP.         04080000
040900             15  ASC-INTER-APPL-COPY    PIC X(200).               04090000
041000                                                                  04100000
041100/                                                                 04110000
041200*---------------------------------------------------------------* 04120000
041300*    ABEND PROCESSING COPYBOOK.                                 * 04130000
041400*---------------------------------------------------------------* 04140000
041500     COPY DPWS013.                                                04150000
041600                                                                  04160000
041700/                                                                 04170000
041800*    DB2 AREA FOR TRADING PARTNERSHIP TABLE                       04180000
041900                                                                  04190000
042000     EXEC SQL                                                     04200000
042100          INCLUDE TTRDPRT                                         04210000
042200     END-EXEC.                                                    04220000
042300                                                                  04230000
042400*    DB2 AREA FOR TRANSACTION SET TABLE                           04240000
042500                                                                  04250000
042600     EXEC SQL                                                     04260000
042700          INCLUDE TTRDTRN                                         04270000
042800     END-EXEC.                                                    04280000
042900                                                                  04290000
043000*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE TABLE              04300000
043100                                                                  04310000
043200     EXEC SQL                                                     04320000
043300          INCLUDE TEXTENT                                         04330000
043400     END-EXEC.                                                    04340000
043500/                                                                 04350000
043600*    DB2 DCLGEN FOR VENDOR NAME TABLE                             04360000
043700                                                                  04370000
043800     EXEC SQL                                                     04380000
043900          INCLUDE TENTNME                                         04390000
044000     END-EXEC.                                                    04400000
044100/                                                                 04410000
044200*    DB2 AREA FOR TRAN_SET_CDE DESCRIPTIONS                       04420000
044300                                                                  04430000
044400     EXEC SQL                                                     04440000
044500          INCLUDE TTRNSET                                         04450000
044600     END-EXEC.                                                    04460000
044700/                                                                 04470000
044800*    DB2 AREA FOR VER_NBR NAMES                                   04480000
044900                                                                  04490000
045000     EXEC SQL                                                     04500000
045100          INCLUDE TTRNVER                                         04510000
045200     END-EXEC.                                                    04520000
045300/                                                                 04530000
045400*---------------------------------------------------------------* 04540000
045500*    DB2 AREA FOR COMMUNICATIONS                                * 04550000
045600*---------------------------------------------------------------* 04560000
045700     EXEC SQL                                                     04570000
045800          INCLUDE SQLCA                                           04580000
045900     END-EXEC.                                                    04590000
046000                                                                  04600000
046100/                                                                 04610000
046200 LINKAGE SECTION.                                                 04620000
046300                                                                  04630000
046400 01  DFHCOMMAREA.                                                 04640000
046500     05  FILLER                         OCCURS  1 TO 4072 TIMES   04650000
046600                                        DEPENDING ON EIBCALEN.    04660000
046700         10  FILLER                     PIC X.                    04670000
046800                                                                  04680000
046900/                                                                 04690000
047000 PROCEDURE DIVISION.                                              04700000
047100*---------------------------------------------------------------* 04710000
047200*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 04720000
047300*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 04730000
047400*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 04740000
047500*---------------------------------------------------------------* 04750000
047600 0000-MAIN-MODULE.                                                04760000
047700                                                                  04770000
047800     INITIALIZE DP030-CICS-API-FIELDS.                            04780000
047900                                                                  04790000
048000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04800000
048100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04810000
048200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04820000
048300                                                                  04830000
048400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04840000
048500                                                                  04850000
048600     MOVE LENGTH OF ET317AI        TO DP030-MAP-LENGTH (1).       04860000
048700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04870000
048800                                                                  04880000
048900     PERFORM 0001-CALL-CICS-ARCH-API.                             04890000
049000     PERFORM 1000-CONTROL-PROCESSING                              04900000
049100                                                                  04910000
049200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04920000
049300     PERFORM 0001-CALL-CICS-ARCH-API.                             04930000
049400                                                                  04940000
049500*---------------------------------------------------------------* 04950000
049600*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 04960000
049700*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 04970000
049800*---------------------------------------------------------------* 04980000
049900 0001-CALL-CICS-ARCH-API.                                         04990000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05000003
050100                                    DFHCOMMAREA                   05010003
050200                                    DP030-CICS-API-FIELDS         05020003
050300                                    DP020-STANDARD-COMMAREA       05030003
050400                                    ET317AI.                      05040003
050500                                                                  05050000
050600     IF  DP030-RC-CALL-SUCCESSFUL                                 05060000
050700         CONTINUE                                                 05070000
050800     ELSE                                                         05080000
050900         SET DP013-NO-ROLLBACK                                    05090000
051000             DP013-XCTL-DISPLAY-RESTART                           05100000
051100             DP013-CICS-ABEND      TO TRUE                        05110000
051200         MOVE '0001-CALL-CICS-ARCH-API'                           05120000
051300                                   TO DP013-PARAGRAPH             05130000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05140003
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05150003
051600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05160000
051700         PERFORM DP013-0000-PROCESS-ABEND                         05170000
051800     END-IF.                                                      05180000
051900                                                                  05190000
052000*---------------------------------------------------------------- 05200000
052100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT       05210000
052200* COURSE OF ACTION IS FOR THIS TRANSACTION.                       05220000
052300*---------------------------------------------------------------- 05230000
052400                                                                  05240000
052500 1000-CONTROL-PROCESSING.                                         05250000
052600                                                                  05260000
052700     EVALUATE TRUE                                                05270000
052800         WHEN DP020-NEXT-ACT-INITIAL                              05280000
052900              PERFORM 1100-FIND-OBJECT-KEYS                       05290000
053000              IF  PS-ERROR                                        05300000
053100                  CONTINUE                                        05310000
053200              ELSE                                                05320000
053300                  MOVE ASC-KEY-TP-DKEY TO DK-TP-DKEY              05330000
053400                  PERFORM 4035-GET-TTRDPRT-ACTV-DTES              05340000
053500                  MOVE TRDPRT-ACTV-DTE   TO ASC-TRDPRT-ACTV-DTE   05350000
053600                  MOVE TRDPRT-INACTV-DTE TO ASC-TRDPRT-INACTV-DTE 05360000
053700                  EXEC SQL                                        05370000
053800                    SET :ASC-CURRENT-TIMESTAMP = CURRENT TIMESTAMP05380000
053900                  END-EXEC                                        05390000
054000                  EVALUATE TRUE                                   05400000
054100                      WHEN SQLCODE = 0                            05410000
054200                          CONTINUE                                05420000
054300                      WHEN OTHER                                  05430000
054400                          MOVE '1000-CONTROL-PROCESSING'          05440000
054500                                       TO DP013-PARAGRAPH         05450000
054600                          MOVE 'SET VARIABLE TO CURRENT TIMESTAMP'05460000
054700                                       TO DP013-MESSAGE-TEXT(1)   05470000
054800                          MOVE SQLCA   TO DP013-SQLCA             05480000
054900                          MOVE 'N/A    '                          05490000
055000                                       TO DP013-DB2-TABLE-NAME (1)05500000
055100                          SET DP013-DB2-ABEND                     05510000
055200                              DP013-XCTL-DISPLAY-RESTART TO TRUE  05520000
055300                          PERFORM DP013-0000-PROCESS-ABEND        05530000
055400                  END-EVALUATE                                    05540000
055500                  IF ASC-TRDPRT-INACTV-DTE < ASC-CURRENT-DATE     05550000
055600                  OR ASC-TRDPRT-ACTV-DTE   = PC-NULL-DATE         05560000
055700                      PERFORM 4000-BUILD-INITIAL-PANEL            05570000
055800                      PERFORM 3250-SET-ATTRIBUTES-TO-PROT         05580000
055900                      SET DP030-SET-CURSOR-TRAILER TO TRUE        05590000
056000*                     ** TRADING PARTNER INACTIVE. MAINTENANCE ** 05600000
056100*                     ** NOT ALLOWED.                          ** 05610000
056200                      MOVE PC-TSYMSG-00836                        05620000
056300                                         TO DP020-MSG-NUMBER      05630000
056400                      SET DP020-MSG-INFORMATIONAL                 05640000
056500                                         TO TRUE                  05650000
056600                  ELSE                                            05660000
056700                      PERFORM 4000-BUILD-INITIAL-PANEL            05670000
056800                      PERFORM 3200-RESET-ATTRIBUTES               05680000
056900                      PERFORM 3500-SAVE-SCREEN-FIELDS             05690000
057000                      IF  SQLCODE = +100                          05700000
057100                      AND NOT ASC-ADD-PENDING                     05710000
057200                          SET DP020-NEXT-ACT-APPL-ERROR           05720000
057300                                         TO TRUE                  05730000
057400                          MOVE PC-TSYMSG-00148                    05740000
057500                                         TO DP020-MSG-NUMBER      05750000
057600                          SET DP020-MSG-INFORMATIONAL             05760000
057700                                         TO TRUE                  05770000
057800                      ELSE                                        05780000
057900                          IF  ASC-DELETE-PENDING                  05790000
058000*    -->                      ** PRESS PF2 TO CONFIRM DELETE **   05800000
058100                              MOVE PC-TSYMSG-00004                05810000
058200                                         TO DP020-MSG-NUMBER      05820000
058300                              SET DP020-MSG-INFORMATIONAL         05830000
058400                                         TO TRUE                  05840000
058500                          END-IF                                  05850000
058600                      END-IF                                      05860000
058700                  END-IF                                          05870000
058800              END-IF                                              05880000
058900                                                                  05890000
059000         WHEN DP020-NEXT-ACT-READ-MAP                             05900000
059100             MOVE ASC-INTER-APPL-COPY TO INTER-APPL-COMM-AREA     05910000
059200             IF DP020-FK-NEXT-SELECTION (DP020-SRC-AID)           05920000
059300             OR DP020-FK-PREV-SELECTION (DP020-SRC-AID)           05930000
059400                 PERFORM 2000-PROCESS-PANEL                       05940000
059500             ELSE                                                 05950000
059600                 IF ASC-TRDPRT-INACTV-DTE < ASC-CURRENT-DATE      05960000
059700                 OR ASC-TRDPRT-ACTV-DTE   = PC-NULL-DATE          05970000
059800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         05980000
059900                     PERFORM 3250-SET-ATTRIBUTES-TO-PROT          05990000
060000                     SET DP030-SET-CURSOR-TRAILER TO TRUE         06000000
060100*                    ** TRADING PARTNER INACTIVE. MAINTENANCE **  06010000
060200*                    ** NOT ALLOWED.                          **  06020000
060300                     MOVE PC-TSYMSG-00836                         06030000
060400                                    TO DP020-MSG-NUMBER           06040000
060500                     SET DP020-MSG-INFORMATIONAL                  06050000
060600                                    TO TRUE                       06060000
060700                 ELSE                                             06070000
060800                     PERFORM 2000-PROCESS-PANEL                   06080000
060900                 END-IF                                           06090000
061000             END-IF                                               06100000
061100                                                                  06110000
061200         WHEN DP020-NEXT-ACT-RETURN                               06120000
061300             MOVE ASC-INTER-APPL-COPY TO INTER-APPL-COMM-AREA     06130000
061400             IF ASC-TRDPRT-INACTV-DTE < ASC-CURRENT-DATE          06140000
061500             OR ASC-TRDPRT-ACTV-DTE   = PC-NULL-DATE              06150000
061600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06160000
061700                 PERFORM 3250-SET-ATTRIBUTES-TO-PROT              06170000
061800                 SET DP030-SET-CURSOR-TRAILER TO TRUE             06180000
061900*                ** TRADING PARTNER INACTIVE. MAINTENANCE **      06190000
062000*                ** NOT ALLOWED.                          **      06200000
062100                 MOVE PC-TSYMSG-00836                             06210000
062200                                    TO DP020-MSG-NUMBER           06220000
062300                 SET DP020-MSG-INFORMATIONAL                      06230000
062400                                    TO TRUE                       06240000
062500             ELSE                                                 06250000
062600                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               06260000
062700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06270000
062800             END-IF                                               06280000
062900                                                                  06290000
063000         WHEN OTHER                                               06300000
063100             SET DP013-LOGIC-ABEND TO TRUE                        06310000
063200             SET DP013-NO-ROLLBACK TO TRUE                        06320000
063300             MOVE '1000-CONTROL-PROCESSING'                       06330000
063400                                   TO DP013-PARAGRAPH             06340000
063500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   06350000
063600                                   TO DP013-MESSAGE-TEXT(1)       06360000
063700             MOVE DP020-NEXT-APPL-ACTIVITY                        06370000
063800                                   TO DP013-MESSAGE-TEXT(2)       06380000
063900             PERFORM DP013-0000-PROCESS-ABEND                     06390000
064000     END-EVALUATE.                                                06400000
064100                                                                  06410000
064200     MOVE INTER-APPL-COMM-AREA TO ASC-INTER-APPL-COPY.            06420000
064300/                                                                 06430000
064400*---------------------------------------------------------------- 06440000
064500*  DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE     06450000
064600*  INTER-APPLICATION FORMAT CODE.                                 06460000
064700*---------------------------------------------------------------- 06470000
064800 1100-FIND-OBJECT-KEYS.                                           06480000
064900                                                                  06490000
065000     INITIALIZE ASC-SPECIFIC-COMMAREA.                            06500000
065100                                                                  06510000
065200     MOVE DP020-INT-APPL-FORMAT-IND                               06520000
065300                                 TO ASC-INT-APPL-FORMAT-IND.      06530000
065400                                                                  06540000
065500     MOVE ET300-TP-DKEY          TO                               06550000
065600          ASC-KEY-TP-DKEY                                         06560000
065700     MOVE ET300-ENT-ID           TO                               06570000
065800          ASC-ENT-ID                                              06580000
065900     MOVE ET300-VEND-INCHG-ID    TO                               06590000
066000          ASC-VEND-INCHG-ID                                       06600000
066100     MOVE ET300-VEND-INCHG-QUAL  TO                               06610000
066200          ASC-VEND-INCHG-QUAL                                     06620000
066300     MOVE ET300-NETWK-ID         TO                               06630000
066400          ASC-NETWK-ID                                            06640000
066500     MOVE ET300-NETWORK-NAME     TO                               06650000
066600          ASC-NETWORK-NAME                                        06660000
066700     MOVE ET300-VENDOR-NAME      TO                               06670000
066800          ASC-VENDOR-NAME                                         06680000
066900     MOVE ET300-FUNC-CDE         TO                               06690000
067000          ASC-FUNC-CDE                                            06700000
067100     MOVE ET300-DIR-IND          TO                               06710000
067200          ASC-KEY-DIR-IND                                         06720000
067300                                                                  06730000
067400     MOVE DP020-INT-APPL-FORMAT-IND TO                            06740000
067500          PV-INT-APPL-FORMAT-IND                                  06750000
067600                                                                  06760000
067700     EVALUATE TRUE                                                06770000
067800                                                                  06780000
067900         WHEN PV-INTER-APPL-CRIT-ADD                              06790000
068000             SET ASC-ADD-PENDING TO TRUE                          06800000
068100                                                                  06810000
068200         WHEN PV-INTER-APPL-LIST-UPDATE                           06820000
068300         WHEN PV-INTER-APPL-LIST-DELETE                           06830000
068400             IF PV-INTER-APPL-LIST-UPDATE                         06840000
068500                 SET ASC-UPDATE-PENDING                           06850000
068600                             TO TRUE                              06860000
068700             ELSE                                                 06870000
068800                 SET ASC-DELETE-PENDING                           06880000
068900                             TO TRUE                              06890000
069000             END-IF                                               06900000
069100             SET ASC-USE-SELECTION-QUEUE                          06910000
069200                             TO TRUE                              06920000
069300             MOVE ET300-NBR-SELECTED-ITEMS                        06930000
069400                             TO ASC-NUMBER-OF-SELECTED-ITEMS      06940000
069500             MOVE ET300-NUMBER-OF-TS-ITEMS                        06950000
069600                             TO ASC-NUMBER-OF-TS-ITEMS            06960000
069700             MOVE ET300-SEL-QUEUE-NAME                            06970000
069800                             TO ASC-SEL-QUEUE-NAME                06980000
069900             PERFORM 1120-PREPARE-LIST-ENTRY                      06990000
070000                                                                  07000000
070100         WHEN OTHER                                               07010000
070200             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             07020000
070300             SET DP020-MSG-FATAL                                  07030000
070400                 DP020-NEXT-ACT-APPL-ERROR                        07040000
070500                 PS-ERROR        TO TRUE                          07050000
070600     END-EVALUATE.                                                07060000
070700                                                                  07070000
070800/                                                                 07080000
070900*---------------------------------------------------------------- 07090000
071000* ENTRY IS FROM A LIST.  GET THE FORMAT NUMBER FROM THE TEMP      07100000
071100* STORAGE QUEUE PASSED FROM THE LIST.                             07110000
071200*---------------------------------------------------------------- 07120000
071300 1120-PREPARE-LIST-ENTRY.                                         07130000
071400                                                                  07140000
071500     MOVE ET301-MAX-ITEMS          TO ASC-SEL-SUB.                07150000
071600     MOVE ZERO                     TO ASC-SEL-ITEM.               07160000
071700     PERFORM 2110-GET-NEXT-RECORD.                                07170000
071800                                                                  07180000
071900/                                                                 07190000
072000*---------------------------------------------------------------- 07200000
072100* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA    07210000
072200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT    07220000
072300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST   07230000
072400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID       07240000
072500* FUNCTION KEYS CAN GET THIS FAR.                                 07250000
072600*---------------------------------------------------------------- 07260000
072700                                                                  07270000
072800 2000-PROCESS-PANEL.                                              07280000
072900                                                                  07290000
073000     EVALUATE TRUE                                                07300000
073100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    07310000
073200             IF  ASC-DELETE-SUCCESSFUL                            07320000
073300                 MOVE PC-TSYMSG-00116                             07330000
073400                                   TO DP020-MSG-NUMBER            07340000
073500                 SET DP020-MSG-FATAL                              07350000
073600                     PS-ERROR      TO TRUE                        07360000
073700                 PERFORM 3200-RESET-ATTRIBUTES                    07370000
073800             ELSE                                                 07380000
073900                 SET DP030-CONTINUE-GO                            07390000
074000                                   TO TRUE                        07400000
074100                 IF ASC-KEY-TRAN-SET-CDE = '850'                  07410000
074200                     INITIALIZE PS-PO850-EXISTS-SW                07420000
074300                                PS-PC860-EXISTS-SW                07430000
074400                     PERFORM 3700-CHK-BEFORE-850-DEL-INACT        07440000
074500                     IF PS-NO-PC860-EXISTS OR                     07450000
074600                        PS-PC860-DOES-NOT-MATTER                  07460000
074700                         INITIALIZE PS-MQ-SEND-SW                 07470000
074800                         MOVE 'Y' TO PS-DELETE-SW                 07480000
074900                         PERFORM 7000-DELETE-TTRDTRN              07490000
075000                         PERFORM 8000-PO-ASN-CHECK                07500000
075100                         PERFORM 8050-CHECK-EDI-PO-ASN-IND        07510000
075200                     END-IF                                       07520000
075300                 ELSE                                             07530000
075400                     INITIALIZE PS-MQ-SEND-SW                     07540000
075500                     MOVE 'Y' TO PS-DELETE-SW                     07550000
075600                     PERFORM 7000-DELETE-TTRDTRN                  07560000
075700                     PERFORM 8000-PO-ASN-CHECK                    07570000
075800                     PERFORM 8050-CHECK-EDI-PO-ASN-IND            07580000
075900                 END-IF                                           07590000
076000             END-IF                                               07600000
076100                                                                  07610000
076200         WHEN DP020-SRC-AID = DP016-CLEAR                         07620000
076300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07630000
076400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07640000
076500                                                                  07650000
076600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07660000
076700*WHY?        SET DP030-DONT-ERASE                                 07670000
076800*                DP030-SEND-DATAONLY (PC-APPL-MAP)                07680000
076900*                              TO TRUE                            07690000
077000             PERFORM 4000-BUILD-INITIAL-PANEL                     07700000
077100             PERFORM 3200-RESET-ATTRIBUTES                        07710000
077200             PERFORM 3500-SAVE-SCREEN-FIELDS                      07720000
077300                                                                  07730000
077400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07740000
077500             IF  ASC-USE-SELECTION-QUEUE                          07750000
077600                 PERFORM 2110-GET-NEXT-RECORD                     07760000
077700                 PERFORM 4000-BUILD-INITIAL-PANEL                 07770000
077800                 IF ASC-TRDPRT-INACTV-DTE < ASC-CURRENT-DATE      07780000
077900                 OR ASC-TRDPRT-ACTV-DTE   = PC-NULL-DATE          07790000
078000                     PERFORM 3250-SET-ATTRIBUTES-TO-PROT          07800000
078100                     SET DP030-SET-CURSOR-TRAILER TO TRUE         07810000
078200*                    ** TRADING PARTNER INACTIVE. MAINTENANCE **  07820000
078300*                    ** NOT ALLOWED.                          **  07830000
078400                     MOVE PC-TSYMSG-00836                         07840000
078500                                    TO DP020-MSG-NUMBER           07850000
078600                     SET DP020-MSG-INFORMATIONAL                  07860000
078700                                    TO TRUE                       07870000
078800                 ELSE                                             07880000
078900                     PERFORM 3200-RESET-ATTRIBUTES                07890000
079000                 END-IF                                           07900000
079100             ELSE                                                 07910000
079200*                --- BOTTOM OF LIST ---                           07920000
079300                 MOVE PC-TSYMSG-00070                             07930000
079400                                   TO DP020-MSG-NUMBER            07940000
079500                 SET DP020-MSG-INFORMATIONAL                      07950000
079600                                   TO TRUE                        07960000
079700             END-IF                                               07970000
079800                                                                  07980000
079900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             07990000
080000             IF  ASC-USE-SELECTION-QUEUE                          08000000
080100                 PERFORM 2120-GET-PREV-RECORD                     08010000
080200                 PERFORM 4000-BUILD-INITIAL-PANEL                 08020000
080300                 IF ASC-TRDPRT-INACTV-DTE < ASC-CURRENT-DATE      08030000
080400                 OR ASC-TRDPRT-ACTV-DTE   = PC-NULL-DATE          08040000
080500                     PERFORM 3250-SET-ATTRIBUTES-TO-PROT          08050000
080600                     SET DP030-SET-CURSOR-TRAILER TO TRUE         08060000
080700*                    ** TRADING PARTNER INACTIVE. MAINTENANCE **  08070000
080800*                    ** NOT ALLOWED.                          **  08080000
080900                     MOVE PC-TSYMSG-00836                         08090000
081000                                    TO DP020-MSG-NUMBER           08100000
081100                     SET DP020-MSG-INFORMATIONAL                  08110000
081200                                    TO TRUE                       08120000
081300                 ELSE                                             08130000
081400                     PERFORM 3200-RESET-ATTRIBUTES                08140000
081500                 END-IF                                           08150000
081600             ELSE                                                 08160000
081700*                --- TOP OF LIST ---                              08170000
081800                 MOVE PC-TSYMSG-00069                             08180000
081900                                   TO DP020-MSG-NUMBER            08190000
082000                 SET DP020-MSG-INFORMATIONAL                      08200000
082100                                   TO TRUE                        08210000
082200             END-IF                                               08220000
082300                                                                  08230000
082400         WHEN OTHER                                               08240000
082500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08250000
082600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08260000
082700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08270000
082800             IF  PS-NO-ERROR                                      08280000
082900                 SET DP030-CONTINUE-GO                            08290000
083000                                   TO TRUE                        08300000
083100                 PERFORM 2100-CHECK-FUNCTION-KEY                  08310000
083200             ELSE                                                 08320000
083300                 SET DP030-OVERRIDE-GO                            08330000
083400                                   TO TRUE                        08340000
083500             END-IF                                               08350000
083600     END-EVALUATE.                                                08360000
083700                                                                  08370000
083800/                                                                 08380000
083900*---------------------------------------------------------------- 08390000
084000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST. 08400000
084100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE   08410000
084200* CICS ARCHITECTURE API.                                          08420000
084300*---------------------------------------------------------------- 08430000
084400 2100-CHECK-FUNCTION-KEY.                                         08440000
084500                                                                  08450000
084600     EVALUATE TRUE                                                08460000
084700         WHEN DP020-SRC-AID = DP016-ENTER                         08470000
084800             CONTINUE                                             08480000
084900                                                                  08490000
085000                                                                  08500000
085100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08510000
085200             IF ASC-UPDATE-PENDING                                08520000
085300                 PERFORM 3600-CHECK-IF-FIELDS-CHANGED             08530000
085400                 IF  ASC-FIELDS-CHANGED                           08540000
085500                     SET DP030-CONTINUE-GO                        08550000
085600                                       TO TRUE                    08560000
085700                     INITIALIZE PS-MQ-SEND-SW                     08570000
085800                     IF ASC-INACTV-DTE NOT = ASC-INACTV-DTE-NEW   08580000
085900                         IF ASC-KEY-TRAN-SET-CDE = '860'          08590000
086000***********************   WHEN REACTIVATING AN '860', A CHECK     08600000
086100***********************   FOR AN '850' IS DONE IN 3030- OR 3035-  08610000
086200***********************   DEPENDING ON THE TYPE OF '860'. IF THE  08620000
086300***********************   REQUIRED '850' IS NOT FOUND, THEN AN    08630000
086400***********************   ERROR MSG IS SENT AND THE UPDATE IS     08640000
086500***********************   BYPASSED.                               08650000
086600                             IF PS-NO-PO850-EXISTS                08660000
086700                                 CONTINUE                         08670000
086800                             ELSE                                 08680000
086900                                 PERFORM 6000-UPDATE-TTRDTRN      08690000
087000                                 PERFORM 8000-PO-ASN-CHECK        08700000
087100                                 PERFORM 8050-CHECK-EDI-PO-ASN-IND08710000
087200                             END-IF                               08720000
087300                         ELSE                                     08730000
087400                             IF ASC-KEY-TRAN-SET-CDE = '850'      08740000
087500***********************   WHEN INACTIVATING AN '850', A CHECK     08750000
087600***********************   FOR AN '860' IS DONE IN 3700-           08760000
087700***********************   SEE 3700- FOR DETAILS AS TO WHEN EITHER 08770000
087800***********************   OF THE ABOVE '860' SWITCHES ARE SET.    08780000
087900                                 IF PS-PC860-ANY-EXISTS OR        08790000
088000                                    PS-PC860-PROD-EXISTS          08800000
088100                                     CONTINUE                     08810000
088200                                 ELSE                             08820000
088300                                     PERFORM 6000-UPDATE-TTRDTRN  08830000
088400                                     PERFORM 8000-PO-ASN-CHECK    08840000
088500                                     PERFORM                      08850000
088600                                         8050-CHECK-EDI-PO-ASN-IND08860000
088700                                 END-IF                           08870000
088800                             ELSE                                 08880000
088900                                 PERFORM 6000-UPDATE-TTRDTRN      08890000
089000                                 PERFORM 8000-PO-ASN-CHECK        08900000
089100                                 PERFORM 8050-CHECK-EDI-PO-ASN-IND08910000
089200                             END-IF                               08920000
089300                     ELSE                                         08930000
089400                         PERFORM 6000-UPDATE-TTRDTRN              08940000
089500                     END-IF                                       08950000
089600                 ELSE                                             08960000
089700                     MOVE PC-TSYMSG-00046                         08970000
089800                                       TO DP020-MSG-NUMBER        08980000
089900                     SET DP020-MSG-INFORMATIONAL                  08990000
090000                                       TO TRUE                    09000000
090100                 END-IF                                           09010000
090200             END-IF                                               09020000
090300             IF ASC-ADD-PENDING                                   09030000
090400                 IF PS-NO-PO850-EXISTS                            09040000
090500**************      WHEN ADDING AN '860', AN 850 MUST EXIST       09050000
090600                     CONTINUE                                     09060000
090700                 ELSE                                             09070000
090800                     INITIALIZE PS-MQ-SEND-SW                     09080000
090900                     PERFORM 5000-ADD-TTRDTRN                     09090000
091000                     PERFORM 8000-PO-ASN-CHECK                    09100000
091100                     PERFORM 8050-CHECK-EDI-PO-ASN-IND            09110000
091200                     MOVE ASC-KEY-TP-DKEY   TO ET300-TP-DKEY      09120000
091300                     MOVE ASC-ENT-ID        TO ET300-ENT-ID       09130000
091400                     MOVE ASC-VENDOR-NAME   TO ET300-VENDOR-NAME  09140000
091500                     MOVE ASC-VEND-INCHG-ID TO                    09150000
091600                                             ET300-VEND-INCHG-ID  09160000
091700                     MOVE ASC-VEND-INCHG-QUAL TO                  09170000
091800                                             ET300-VEND-INCHG-QUAL09180000
091900                     MOVE ASC-NETWK-ID      TO ET300-NETWK-ID     09190000
092000                     MOVE ASC-NETWORK-NAME  TO                    09200000
092100                                               ET300-NETWORK-NAME 09210000
092200                     MOVE ASC-FUNC-CDE      TO ET300-FUNC-CDE     09220000
092300                     MOVE ASC-KEY-DIR-IND     TO ET300-DIR-IND    09230000
092400                 END-IF                                           09240000
092500             END-IF                                               09250000
092600                                                                  09260000
092700         WHEN OTHER                                               09270000
092800             SET DP013-NO-ROLLBACK                                09280000
092900                 DP013-XCTL-DISPLAY-RESTART                       09290000
093000                 DP013-CICS-ABEND  TO TRUE                        09300000
093100             MOVE '2100-CHECK-FUNCTION-KEY'                       09310000
093200                                   TO DP013-PARAGRAPH             09320000
093300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09330000
093400                                   TO DP013-MESSAGE-TEXT (1)      09340000
093500             PERFORM DP013-0000-PROCESS-ABEND                     09350000
093600     END-EVALUATE.                                                09360000
093700                                                                  09370000
093800/                                                                 09380000
093900 2110-GET-NEXT-RECORD.                                            09390000
094000                                                                  09400000
094100     ADD +1                        TO ASC-SEL-SUB.                09410000
094200     IF  ASC-SEL-SUB > ET301-MAX-ITEMS                            09420000
094300         ADD +1                    TO ASC-SEL-ITEM                09430000
094400         MOVE +1                   TO ASC-SEL-SUB                 09440000
094500     END-IF.                                                      09450000
094600                                                                  09460000
094700     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09470000
094800         PERFORM 9100-READ-SEL-QUEUE                              09480000
094900         IF  ET301-ITEM (ASC-SEL-SUB) > ZERO                      09490000
095000             MOVE ET301-TP-DKEY     (ASC-SEL-SUB)                 09500000
095100                                   TO ASC-KEY-TP-DKEY             09510000
095200             MOVE ET301-ENT-ID   (ASC-SEL-SUB)                    09520000
095300                                   TO ASC-ENT-ID                  09530000
095400             MOVE ET301-VENDOR-NAME   (ASC-SEL-SUB)               09540000
095500                                   TO ASC-VENDOR-NAME             09550000
095600             MOVE ET301-VEND-INCHG-ID (ASC-SEL-SUB)               09560000
095700                                   TO ASC-VEND-INCHG-ID           09570000
095800             MOVE ET301-VEND-INCHG-QUAL (ASC-SEL-SUB)             09580000
095900                                   TO ASC-VEND-INCHG-QUAL         09590000
096000             MOVE ET301-NETWK-ID        (ASC-SEL-SUB)             09600000
096100                                   TO ASC-NETWK-ID                09610000
096200             MOVE ET301-NETWK-NAME      (ASC-SEL-SUB)             09620000
096300                                   TO ASC-NETWORK-NAME            09630000
096400             MOVE ET301-FUNC-CDE        (ASC-SEL-SUB)             09640000
096500                                   TO ASC-FUNC-CDE                09650000
096600             MOVE ET301-DIR-IND         (ASC-SEL-SUB)             09660000
096700                                   TO ASC-KEY-DIR-IND             09670000
096800             MOVE ET301-TRAN-SET-CDE    (ASC-SEL-SUB)             09680000
096900                                   TO ASC-KEY-TRAN-SET-CDE        09690000
097000             MOVE ET301-PROD-TEST-IND   (ASC-SEL-SUB)             09700000
097100                                   TO ASC-KEY-PROD-TEST-IND       09710000
097200*-->         IT'S POSSIBLE THAT THE USER DID AN UPDATE, DID A     09720000
097300*-->         "PREV", AND DID A NEXT TO RE-DISPLAY THIS RECORD.    09730000
097400*-->         IF SO, ET301-ACTION-SW WOULD EQUAL 'U', AND SHOULD   09740000
097500*-->         STAY THAT WAY.  THAT WAY, WHEN PF3'ING BACK TO THE   09750000
097600*-->         LIST, "UPD" WILL SHOW UP BESIDE THE UPDATED REC.     09760000
097700             IF ET301-ACTION-SW (ASC-SEL-SUB) > SPACES            09770000
097800                 CONTINUE                                         09780000
097900             ELSE                                                 09790000
098000                 SET ET301-INQ (ASC-SEL-SUB)                      09800000
098100                                       TO TRUE                    09810000
098200                 PERFORM 9200-REWRITE-LIST-QUEUE                  09820000
098300             END-IF                                               09830000
098400         ELSE                                                     09840000
098500             SUBTRACT +1 FROM ASC-SEL-SUB                         09850000
098600*            --- BOTTOM OF LIST ---                               09860000
098700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            09870000
098800             SET DP020-MSG-INFORMATIONAL                          09880000
098900                                   TO TRUE                        09890000
099000         END-IF                                                   09900000
099100     ELSE                                                         09910000
099200         SUBTRACT +1 FROM ASC-SEL-ITEM                            09920000
099300         MOVE ET301-MAX-ITEMS      TO ASC-SEL-SUB                 09930000
099400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            09940000
099500         SET DP020-MSG-INFORMATIONAL                              09950000
099600                                   TO TRUE                        09960000
099700     END-IF.                                                      09970000
099800                                                                  09980000
099900/                                                                 09990000
100000 2120-GET-PREV-RECORD.                                            10000000
100100                                                                  10010000
100200     SUBTRACT +1 FROM ASC-SEL-SUB.                                10020000
100300     IF  ASC-SEL-SUB < +1                                         10030000
100400         SUBTRACT +1 FROM ASC-SEL-ITEM                            10040000
100500         MOVE ET301-MAX-ITEMS      TO ASC-SEL-SUB                 10050000
100600     END-IF.                                                      10060000
100700                                                                  10070000
100800     IF  ASC-SEL-ITEM > ZERO                                      10080000
100900         PERFORM 9100-READ-SEL-QUEUE                              10090000
101000         MOVE ET301-TP-DKEY     (ASC-SEL-SUB)                     10100000
101100                               TO ASC-KEY-TP-DKEY                 10110000
101200         MOVE ET301-ENT-ID   (ASC-SEL-SUB)                        10120000
101300                               TO ASC-ENT-ID                      10130000
101400         MOVE ET301-VENDOR-NAME   (ASC-SEL-SUB)                   10140000
101500                               TO ASC-VENDOR-NAME                 10150000
101600         MOVE ET301-VEND-INCHG-ID (ASC-SEL-SUB)                   10160000
101700                               TO ASC-VEND-INCHG-ID               10170000
101800         MOVE ET301-VEND-INCHG-QUAL    (ASC-SEL-SUB)              10180000
101900                               TO ASC-VEND-INCHG-QUAL             10190000
102000         MOVE ET301-NETWK-ID        (ASC-SEL-SUB)                 10200000
102100                               TO ASC-NETWK-ID                    10210000
102200         MOVE ET301-NETWK-NAME      (ASC-SEL-SUB)                 10220000
102300                               TO ASC-NETWORK-NAME                10230000
102400         MOVE ET301-FUNC-CDE        (ASC-SEL-SUB)                 10240000
102500                               TO ASC-FUNC-CDE                    10250000
102600         MOVE ET301-DIR-IND         (ASC-SEL-SUB)                 10260000
102700                               TO ASC-KEY-DIR-IND                 10270000
102800         MOVE ET301-TRAN-SET-CDE    (ASC-SEL-SUB)                 10280000
102900                               TO ASC-KEY-TRAN-SET-CDE            10290000
103000         MOVE ET301-PROD-TEST-IND   (ASC-SEL-SUB)                 10300000
103100                               TO ASC-KEY-PROD-TEST-IND           10310000
103200     ELSE                                                         10320000
103300         MOVE +1                   TO ASC-SEL-ITEM                10330000
103400                                      ASC-SEL-SUB                 10340000
103500*        --- TOP OF LIST ---                                      10350000
103600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10360000
103700         SET DP020-MSG-INFORMATIONAL                              10370000
103800                                   TO TRUE                        10380000
103900     END-IF.                                                      10390000
104000                                                                  10400000
104100/                                                                 10410000
104200*---------------------------------------------------------------- 10420000
104300*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE      10430000
104400*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.   10440000
104500*---------------------------------------------------------------- 10450000
104600 2200-MOVE-SCREEN-TO-COMMAREA.                                    10460000
104700                                                                  10470000
104800     IF TSETL   >       ZERO                                      10480000
104900         MOVE TSETI   TO ASC-KEY-TRAN-SET-CDE                     10490000
105000     ELSE                                                         10500000
105100         IF TSETF   = DP015-ERASE-EOF                             10510000
105200             MOVE SPACES TO ASC-KEY-TRAN-SET-CDE                  10520000
105300         END-IF                                                   10530000
105400     END-IF                                                       10540000
105500                                                                  10550000
105600     IF PRDTSTL >       ZERO                                      10560000
105700         MOVE PRDTSTI TO ASC-KEY-PROD-TEST-IND                    10570000
105800     ELSE                                                         10580000
105900         IF PRDTSTF = DP015-ERASE-EOF                             10590000
106000             MOVE SPACES TO ASC-KEY-PROD-TEST-IND                 10600000
106100         END-IF                                                   10610000
106200     END-IF                                                       10620000
106300                                                                  10630000
106400     IF COMMTHL >       ZERO                                      10640000
106500         MOVE COMMTHI TO ASC-COMM-MTHD-NEW                        10650000
106600     ELSE                                                         10660000
106700         IF COMMTHF = DP015-ERASE-EOF                             10670000
106800             MOVE SPACES TO ASC-COMM-MTHD-NEW                     10680000
106900         END-IF                                                   10690000
107000     END-IF                                                       10700000
107100                                                                  10710000
107200     IF VERNBRL >       ZERO                                      10720000
107300         MOVE VERNBRI TO ASC-VER-NBR-NEW                          10730000
107400     ELSE                                                         10740000
107500         IF VERNBRF = DP015-ERASE-EOF                             10750000
107600             MOVE SPACES TO ASC-VER-NBR-NEW                       10760000
107700         END-IF                                                   10770000
107800     END-IF                                                       10780000
107900                                                                  10790000
108000     IF ACTVMTHL >      ZERO                                      10800000
108100         MOVE ACTVMTHI TO ASC-ACTV-DTE-MM-NEW                     10810000
108200     ELSE                                                         10820000
108300         IF ACTVMTHF = DP015-ERASE-EOF                            10830000
108400             MOVE SPACES TO ASC-ACTV-DTE-MM-NEW                   10840000
108500         END-IF                                                   10850000
108600     END-IF                                                       10860000
108700                                                                  10870000
108800     IF ACTVDAYL >      ZERO                                      10880000
108900         MOVE ACTVDAYI TO ASC-ACTV-DTE-DD-NEW                     10890000
109000     ELSE                                                         10900000
109100         IF ACTVDAYF = DP015-ERASE-EOF                            10910000
109200             MOVE SPACES TO ASC-ACTV-DTE-DD-NEW                   10920000
109300         END-IF                                                   10930000
109400     END-IF                                                       10940000
109500                                                                  10950000
109600     IF ACTVYRL >      ZERO                                       10960000
109700         MOVE ACTVYRI TO ASC-ACTV-DTE-YY-NEW                      10970000
109800     ELSE                                                         10980000
109900         IF ACTVYRF = DP015-ERASE-EOF                             10990000
110000             MOVE SPACES TO ASC-ACTV-DTE-YY-NEW                   11000000
110100         END-IF                                                   11010000
110200     END-IF                                                       11020000
110300                                                                  11030000
110400     IF INACTVML >      ZERO                                      11040000
110500         MOVE INACTVMI   TO ASC-INACTV-DTE-MM-NEW                 11050000
110600     ELSE                                                         11060000
110700         IF INACTVMF = DP015-ERASE-EOF                            11070000
110800             MOVE SPACES TO ASC-INACTV-DTE-MM-NEW                 11080000
110900         END-IF                                                   11090000
111000     END-IF                                                       11100000
111100                                                                  11110000
111200     IF INACTVDL >      ZERO                                      11120000
111300         MOVE INACTVDI   TO ASC-INACTV-DTE-DD-NEW                 11130000
111400     ELSE                                                         11140000
111500         IF INACTVDF = DP015-ERASE-EOF                            11150000
111600             MOVE SPACES TO ASC-INACTV-DTE-DD-NEW                 11160000
111700         END-IF                                                   11170000
111800     END-IF                                                       11180000
111900                                                                  11190000
112000     IF INACTVYL >      ZERO                                      11200000
112100         MOVE INACTVYI   TO ASC-INACTV-DTE-YY-NEW                 11210000
112200     ELSE                                                         11220000
112300         IF INACTVYF = DP015-ERASE-EOF                            11230000
112400             MOVE SPACES TO ASC-INACTV-DTE-YY-NEW                 11240000
112500         END-IF                                                   11250000
112600     END-IF                                                       11260000
112700                                                                  11270000
112800     IF LCALMTHL >      ZERO                                      11280000
112900         MOVE LCALMTHI TO ASC-LAST-CALL-DTE-MM-NEW                11290000
113000     ELSE                                                         11300000
113100         IF LCALMTHF = DP015-ERASE-EOF                            11310000
113200             MOVE SPACES TO ASC-LAST-CALL-DTE-MM-NEW              11320000
113300         END-IF                                                   11330000
113400     END-IF                                                       11340000
113500                                                                  11350000
113600     IF LCALDAYL >      ZERO                                      11360000
113700         MOVE LCALDAYI TO ASC-LAST-CALL-DTE-DD-NEW                11370000
113800     ELSE                                                         11380000
113900         IF LCALDAYF = DP015-ERASE-EOF                            11390000
114000             MOVE SPACES TO ASC-LAST-CALL-DTE-DD-NEW              11400000
114100         END-IF                                                   11410000
114200     END-IF                                                       11420000
114300                                                                  11430000
114400     IF LCALYRL >      ZERO                                       11440000
114500         MOVE LCALYRI TO ASC-LAST-CALL-DTE-YY-NEW                 11450000
114600     ELSE                                                         11460000
114700         IF LCALYRF = DP015-ERASE-EOF                             11470000
114800             MOVE SPACES TO ASC-LAST-CALL-DTE-YY-NEW              11480000
114900         END-IF                                                   11490000
115000     END-IF                                                       11500000
115100                                                                  11510000
115200     IF NCALMTHL >      ZERO                                      11520000
115300         MOVE NCALMTHI TO ASC-NEXT-CALL-DTE-MM-NEW                11530000
115400     ELSE                                                         11540000
115500         IF NCALMTHF = DP015-ERASE-EOF                            11550000
115600             MOVE SPACES TO ASC-NEXT-CALL-DTE-MM-NEW              11560000
115700         END-IF                                                   11570000
115800     END-IF                                                       11580000
115900                                                                  11590000
116000     IF NCALDAYL >      ZERO                                      11600000
116100         MOVE NCALDAYI   TO ASC-NEXT-CALL-DTE-DD-NEW              11610000
116200     ELSE                                                         11620000
116300         IF NCALDAYF = DP015-ERASE-EOF                            11630000
116400             MOVE SPACES TO ASC-NEXT-CALL-DTE-DD-NEW              11640000
116500         END-IF                                                   11650000
116600     END-IF                                                       11660000
116700                                                                  11670000
116800     IF NCALYRL >      ZERO                                       11680000
116900         MOVE NCALYRI TO ASC-NEXT-CALL-DTE-YY-NEW                 11690000
117000     ELSE                                                         11700000
117100         IF NCALYRF = DP015-ERASE-EOF                             11710000
117200             MOVE SPACES TO ASC-NEXT-CALL-DTE-YY-NEW              11720000
117300         END-IF                                                   11730000
117400     END-IF                                                       11740000
117500                                                                  11750000
117600     IF NOTE1L >       ZERO                                       11760000
117700         MOVE NOTE1I TO ASC-NOTES-TXT1-NEW                        11770000
117800     ELSE                                                         11780000
117900         IF NOTE1F = DP015-ERASE-EOF                              11790000
118000             MOVE SPACES TO ASC-NOTES-TXT1-NEW                    11800000
118100         END-IF                                                   11810000
118200     END-IF                                                       11820000
118300                                                                  11830000
118400     IF NOTE2L >       ZERO                                       11840000
118500         MOVE NOTE2I TO ASC-NOTES-TXT2-NEW                        11850000
118600     ELSE                                                         11860000
118700         IF NOTE2F = DP015-ERASE-EOF                              11870000
118800             MOVE SPACES TO ASC-NOTES-TXT2-NEW                    11880000
118900         END-IF                                                   11890000
119000     END-IF.                                                      11900000
119100                                                                  11910000
119200/                                                                 11920000
119300*---------------------------------------------------------------- 11930000
119400*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE        11940000
119500*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).   11950000
119600*---------------------------------------------------------------- 11960000
119700 3000-EDIT-DATA-IN-COMMAREA.                                      11970000
119800                                                                  11980000
119900     SET PS-NO-ERROR         TO TRUE                              11990000
120000                                                                  12000000
120100     PERFORM 3200-RESET-ATTRIBUTES.                               12010000
120200                                                                  12020000
120300     EVALUATE TRUE                                                12030000
120400       WHEN ASC-ADD-PENDING                                       12040000
120500         PERFORM 3010-ADD-EDITS                                   12050000
120600       WHEN ASC-UPDATE-PENDING                                    12060000
120700         PERFORM 3100-UPDATE-EDITS                                12070000
120800     END-EVALUATE.                                                12080000
120900/                                                                 12090000
121000 3010-ADD-EDITS.                                                  12100000
121100                                                                  12110000
121200     IF ASC-KEY-TRAN-SET-CDE > SPACES                             12120000
121300         MOVE ASC-KEY-TRAN-SET-CDE TO DK-TRAN-SET-CDE             12130000
121400         PERFORM 4020-GET-TRAN-DESC                               12140000
121500         IF SQLCODE = +0                                          12150000
121600             MOVE TRNSET-TRAN-SET-NME  TO ASC-TRAN-SET-NME        12160000
121700*-->         ** FORCE AN EDIT OF VER_NBR RELATIVE TO THIS NEWLY   12170000
121800*-->         ** ENTERED                                           12180000
121900             MOVE +1                   TO VERNBRL                 12190000
122000         ELSE                                                     12200000
122100             SET DP020-MSG-FATAL       TO TRUE                    12210000
122200             MOVE DP015-UNP-ALP-BRT-MDT                           12220000
122300                                       TO TSETA                   12230000
122400             MOVE DP015-RED            TO TSETC                   12240000
122500             MOVE DP015-REVERSE        TO TSETH                   12250000
122600             IF PS-NO-ERROR                                       12260000
122700                 SET PS-ERROR          TO TRUE                    12270000
122800                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        12280000
122900                 MOVE -1               TO TSETL                   12290000
123000             END-IF                                               12300000
123100             SET DP030-SET-CURSOR-APPL-1                          12310000
123200                                       TO TRUE                    12320000
123300         END-IF                                                   12330000
123400     ELSE                                                         12340000
123500*-->     ** REQUIRED ENTRY **                                     12350000
123600         SET DP020-MSG-FATAL       TO TRUE                        12360000
123700         MOVE DP015-UNP-ALP-BRT-MDT                               12370000
123800                                   TO TSETA                       12380000
123900         MOVE DP015-RED            TO TSETC                       12390000
124000         MOVE DP015-REVERSE        TO TSETH                       12400000
124100         IF PS-NO-ERROR                                           12410000
124200             SET PS-ERROR          TO TRUE                        12420000
124300             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            12430000
124400             MOVE -1               TO TSETL                       12440000
124500         END-IF                                                   12450000
124600         SET DP030-SET-CURSOR-APPL-1                              12460000
124700                                   TO TRUE                        12470000
124800     END-IF.                                                      12480000
124900                                                                  12490000
125000     IF ASC-KEY-PROD-TEST-IND = 'P' OR 'T'                        12500000
125100         CONTINUE                                                 12510000
125200     ELSE                                                         12520000
125300         SET DP020-MSG-FATAL       TO TRUE                        12530000
125400         MOVE DP015-UNP-ALP-BRT-MDT                               12540000
125500                                   TO PRDTSTA                     12550000
125600         MOVE DP015-RED            TO PRDTSTC                     12560000
125700         MOVE DP015-REVERSE        TO PRDTSTH                     12570000
125800         IF PS-NO-ERROR                                           12580000
125900             SET PS-ERROR          TO TRUE                        12590000
126000             MOVE PC-TSYMSG-00765  TO DP020-MSG-NUMBER            12600000
126100             MOVE -1               TO PRDTSTL                     12610000
126200         END-IF                                                   12620000
126300         SET DP030-SET-CURSOR-APPL-1                              12630000
126400                                   TO TRUE                        12640000
126500     END-IF.                                                      12650000
126600                                                                  12660000
126700     PERFORM 3005-EDIT-COMM-FIELDS.                               12670000
126800     PERFORM 3010-EDIT-VER-NBR.                                   12680000
126900     PERFORM 3120-EDIT-ACTIVE-DATE.                               12690000
127000     PERFORM 3130-EDIT-INACTIVE-DATE.                             12700000
127100     PERFORM 3140-EDIT-LAST-NEXT-CALL-DATE.                       12710000
127200                                                                  12720000
127300     IF PS-NO-ERROR                                               12730000
127400         PERFORM 3015-EDIT-FOR-EXISTANCE                          12740000
127500     END-IF.                                                      12750000
127600                                                                  12760000
127700***** WHEN ADDING AN '860', MUST CHECK FOR AN '850'               12770000
127800     IF ASC-KEY-TRAN-SET-CDE = '860'                              12780000
127900         IF ASC-KEY-PROD-TEST-IND = 'P'                           12790000
128000******** CAN'T ADD PROD 860 IF PROD 850 DOESN'T EXIST             12800000
128100             PERFORM 3030-CHK-FOR-PROD-850-ADD                    12810000
128200         ELSE                                                     12820000
128300             IF ASC-KEY-PROD-TEST-IND = 'T'                       12830000
128400******** CAN'T ADD TEST 860 IF NO 850 EXISTS (PROD OR TEST)       12840000
128500                 PERFORM 3035-CHK-FOR-ANY-850-ADD                 12850000
128600             END-IF                                               12860000
128700         END-IF                                                   12870000
128800     END-IF.                                                      12880000
128900/                                                                 12890000
129000 3005-EDIT-COMM-FIELDS.                                           12900000
129100                                                                  12910000
129200     IF ASC-COMM-MTHD-NEW = 'F' OR 'E' OR 'V' OR 'A'              12920000
129300         IF ASC-COMM-MTHD-NEW = 'F'                               12930000
129400             MOVE 'FTP  ' TO ASC-COMM-MTHD-NME                    12940000
129500         ELSE                                                     12950000
129600             IF ASC-COMM-MTHD-NEW = 'E'                           12960000
129700                 MOVE 'EMAIL' TO ASC-COMM-MTHD-NME                12970000
129800             ELSE                                                 12980000
129900                 IF ASC-COMM-MTHD-NEW = 'A'                       12990000
130000                     MOVE 'AS2  ' TO ASC-COMM-MTHD-NME            13000000
130100                 ELSE                                             13010000
130200                     MOVE 'VAN  ' TO ASC-COMM-MTHD-NME            13020000
130300                 END-IF                                           13030000
130400             END-IF                                               13040000
130500         END-IF                                                   13050000
130600     ELSE                                                         13060000
130700         MOVE SPACES TO ASC-COMM-MTHD-NME                         13070000
130800         SET DP020-MSG-FATAL       TO TRUE                        13080000
130900         MOVE DP015-UNP-ALP-BRT-MDT                               13090000
131000                                   TO COMMTHA                     13100000
131100         MOVE DP015-RED            TO COMMTHC                     13110000
131200         MOVE DP015-REVERSE        TO COMMTHH                     13120000
131300         IF PS-NO-ERROR                                           13130000
131400             SET PS-ERROR          TO TRUE                        13140000
131500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            13150000
131600             MOVE -1               TO COMMTHL                     13160000
131700         END-IF                                                   13170000
131800         SET DP030-SET-CURSOR-APPL-1                              13180000
131900                                   TO TRUE                        13190000
132000     END-IF.                                                      13200000
132100                                                                  13210000
132200/                                                                 13220000
132300 3010-EDIT-VER-NBR.                                               13230000
132400                                                                  13240000
132500     IF ASC-VER-NBR-NEW > SPACES                                  13250000
132600         MOVE ASC-KEY-TRAN-SET-CDE TO DK-TRAN-SET-CDE             13260000
132700         MOVE ASC-VER-NBR-NEW      TO DK-VER-NBR                  13270000
132800         PERFORM 4030-GET-VERSION-NAME                            13280000
132900         IF SQLCODE = +0                                          13290000
133000             IF (TRNVER-ACTV-DTE  <= ASC-CURRENT-DATE)    AND     13300000
133100                (TRNVER-INACTV-DTE > ASC-CURRENT-DATE)            13310000
133200                 MOVE TRNVER-VER-NME       TO ASC-VER-NME         13320000
133300                 IF  ASC-UPDATE-PENDING                           13330000
133400                 AND ASC-VER-NBR-NEW NOT = ASC-VER-NBR            13340000
133500                     MOVE ASC-CURRENT-DATE                        13350000
133600                                           TO ASC-VER-CHG-DTE     13360000
133700                 END-IF                                           13370000
133800             ELSE                                                 13380000
133900                 SET DP020-MSG-FATAL       TO TRUE                13390000
134000                 MOVE DP015-UNP-ALP-BRT-MDT                       13400000
134100                                           TO VERNBRA             13410000
134200                 MOVE DP015-RED            TO VERNBRC             13420000
134300                 MOVE DP015-REVERSE        TO VERNBRH             13430000
134400                 IF PS-NO-ERROR                                   13440000
134500                     SET PS-ERROR          TO TRUE                13450000
134600***** NEW MSG  - INACTIVE DATE                                    13460000
134700                     MOVE PC-TSYMSG-00766  TO DP020-MSG-NUMBER    13470000
134800                     MOVE -1               TO VERNBRL             13480000
134900                 END-IF                                           13490000
135000                 SET DP030-SET-CURSOR-APPL-1                      13500000
135100                                           TO TRUE                13510000
135200             END-IF                                               13520000
135300         ELSE                                                     13530000
135400             SET DP020-MSG-FATAL       TO TRUE                    13540000
135500             MOVE DP015-UNP-ALP-BRT-MDT                           13550000
135600                                       TO VERNBRA                 13560000
135700             MOVE DP015-RED            TO VERNBRC                 13570000
135800             MOVE DP015-REVERSE        TO VERNBRH                 13580000
135900             IF PS-NO-ERROR                                       13590000
136000                 SET PS-ERROR          TO TRUE                    13600000
136100                 MOVE PC-TSYMSG-00766  TO DP020-MSG-NUMBER        13610000
136200                 MOVE -1               TO VERNBRL                 13620000
136300             END-IF                                               13630000
136400             SET DP030-SET-CURSOR-APPL-1                          13640000
136500                                       TO TRUE                    13650000
136600         END-IF                                                   13660000
136700     ELSE                                                         13670000
136800*-->     **  REQUIRED ENTRY   **                                  13680000
136900         SET DP020-MSG-FATAL       TO TRUE                        13690000
137000         MOVE DP015-UNP-ALP-BRT-MDT                               13700000
137100                                   TO VERNBRA                     13710000
137200         MOVE DP015-RED            TO VERNBRC                     13720000
137300         MOVE DP015-REVERSE        TO VERNBRH                     13730000
137400         IF PS-NO-ERROR                                           13740000
137500             SET PS-ERROR          TO TRUE                        13750000
137600             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            13760000
137700             MOVE -1               TO VERNBRL                     13770000
137800         END-IF                                                   13780000
137900         SET DP030-SET-CURSOR-APPL-1                              13790000
138000                                   TO TRUE                        13800000
138100     END-IF.                                                      13810000
138200                                                                  13820000
138300/                                                                 13830000
138400*---------------------------------------------------------------- 13840000
138500*  SEE IF THIS OPERATION WOULD RESULT IN A DUPLICATE              13850000
138600*---------------------------------------------------------------- 13860000
138700 3015-EDIT-FOR-EXISTANCE.                                         13870000
138800                                                                  13880000
138900     PERFORM                                                      13890000
139000         WITH TEST AFTER                                          13900000
139100         VARYING PV-RETRY-COUNTER                                 13910000
139200         FROM 1 BY 1                                              13920000
139300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13930000
139400            OR (SQLCODE = +0))                                    13940000
139500                                                                  13950000
139600         MOVE +0 TO PV-DUP-COUNTER                                13960000
139700                                                                  13970000
139800         EXEC SQL                                                 13980000
139900           SELECT COUNT(*)                                        13990000
140000           INTO   :PV-DUP-COUNTER                                 14000000
140100           FROM   TTRDTRN                                         14010000
140200           WHERE  TP_DKEY            = :ASC-KEY-TP-DKEY           14020000
140300             AND  TRAN_SET_CDE       = :ASC-KEY-TRAN-SET-CDE      14030000
140400             AND  PROD_TEST_IND      = :ASC-KEY-PROD-TEST-IND     14040000
140500             AND  DIR_IND            = :ASC-KEY-DIR-IND           14050000
140600         END-EXEC                                                 14060000
140700                                                                  14070000
140800         EVALUATE TRUE                                            14080000
140900             WHEN SQLCODE = +0                                    14090000
141000             WHEN SQLCODE = -904                                  14100000
141100             WHEN SQLCODE = -913                                  14110000
141200                 CONTINUE                                         14120000
141300                                                                  14130000
141400             WHEN SQLWARN0 NOT = SPACES                           14140000
141500             WHEN SQLCODE < ZERO                                  14150000
141600             WHEN SQLCODE > ZERO                                  14160000
141700                 MOVE '3015-COUNT-TTRDTRN'                        14170000
141800                                   TO DP013-PARAGRAPH             14180000
141900                 MOVE 'SELECT ON TTRDTRN'                         14190000
142000                                   TO DP013-MESSAGE-TEXT (1)      14200000
142100                 MOVE SQLCA        TO DP013-SQLCA                 14210000
142200                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    14220000
142300                 SET DP013-DB2-ABEND                              14230000
142400                     DP013-XCTL-DISPLAY-RESTART                   14240000
142500                                   TO TRUE                        14250000
142600                 PERFORM DP013-0000-PROCESS-ABEND                 14260000
142700         END-EVALUATE                                             14270000
142800     END-PERFORM.                                                 14280000
142900                                                                  14290000
143000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14300000
143100         MOVE '3015-COUNT-TTRDTRN'                                14310000
143200                                   TO DP013-PARAGRAPH             14320000
143300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14330000
143400                                   TO DP013-MESSAGE-TEXT (1)      14340000
143500         MOVE 'A TTRDTRN ROW   '   TO DP013-MESSAGE-TEXT (2)      14350000
143600         MOVE SQLCA                TO DP013-SQLCA                 14360000
143700         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    14370000
143800         SET DP013-DB2-ABEND                                      14380000
143900             DP013-XCTL-DISPLAY-RESTART                           14390000
144000                                   TO TRUE                        14400000
144100         PERFORM DP013-0000-PROCESS-ABEND                         14410000
144200     END-IF.                                                      14420000
144300                                                                  14430000
144400     IF PV-DUP-COUNTER > +0                                       14440000
144500         SET PS-ERROR                   TO TRUE                   14450000
144600         SET DP020-MSG-FATAL            TO TRUE                   14460000
144700         MOVE PC-TSYMSG-00231           TO DP020-MSG-NUMBER       14470000
144800         MOVE DP015-UNP-ALP-BRT-MDT     TO TSETA                  14480000
144900                                           PRDTSTA                14490000
145000         MOVE DP015-RED                 TO TSETC                  14500000
145100                                           PRDTSTC                14510000
145200         MOVE DP015-REVERSE             TO TSETH                  14520000
145300                                           PRDTSTH                14530000
145400         MOVE -1                        TO TSETL                  14540000
145500         SET DP030-SET-CURSOR-APPL-1    TO TRUE                   14550000
145600     ELSE                                                         14560000
145700                                                                  14570000
145800         IF ASC-KEY-DIR-IND          = 'S' AND                    14580000
145900            ASC-KEY-TRAN-SET-CDE NOT = '997'                      14590000
146000             PERFORM 3020-SEE-IF-VNDR-OTHER-TRNSET                14600000
146100         END-IF                                                   14610000
146200                                                                  14620000
146300     END-IF.                                                      14630000
146400/                                                                 14640000
146500*---------------------------------------------------------------- 14650000
146600*  FOR THIS VENDOR, SEE IF THERE ARE ANY OTHER TTRDTRN ROWS       14660000
146700*  SETUP UNDER ANOTHER TRADING PARTNERSHIP AGREEMENT (TTRDPRT).   14670000
146800*---------------------------------------------------------------- 14680000
146900 3020-SEE-IF-VNDR-OTHER-TRNSET.                                   14690000
147000                                                                  14700000
147100     PERFORM                                                      14710000
147200         WITH TEST AFTER                                          14720000
147300         VARYING PV-RETRY-COUNTER                                 14730000
147400         FROM 1 BY 1                                              14740000
147500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14750000
147600            OR (SQLCODE = +0))                                    14760000
147700                                                                  14770000
147800         MOVE +0 TO PV-DUP-COUNTER                                14780000
147900                                                                  14790000
148000         EXEC SQL                                                 14800000
148100           SELECT COUNT(*)                                        14810000
148200           INTO   :PV-DUP-COUNTER                                 14820000
148300           FROM   TTRDPRT  A                                      14830000
148400                 ,TTRDTRN  B                                      14840000
148500           WHERE  A.ENT_ID           = :ASC-ENT-ID                14850000
148600             AND  A.TP_DKEY          = B.TP_DKEY                  14860000
148700             AND  B.TRAN_SET_CDE     = :ASC-KEY-TRAN-SET-CDE      14870000
148800             AND  B.PROD_TEST_IND    = :ASC-KEY-PROD-TEST-IND     14880000
148900             AND  B.DIR_IND          = :ASC-KEY-DIR-IND           14890000
149000         END-EXEC                                                 14900000
149100                                                                  14910000
149200         EVALUATE TRUE                                            14920000
149300             WHEN SQLCODE = +0                                    14930000
149400             WHEN SQLCODE = -904                                  14940000
149500             WHEN SQLCODE = -913                                  14950000
149600                 CONTINUE                                         14960000
149700                                                                  14970000
149800             WHEN SQLWARN0 NOT = SPACES                           14980000
149900             WHEN SQLCODE < ZERO                                  14990000
150000             WHEN SQLCODE > ZERO                                  15000000
150100                 MOVE '3020-SEE-IF-VNDR'                          15010000
150200                                   TO DP013-PARAGRAPH             15020000
150300                 MOVE 'SELECT ON TTRDTRN'                         15030000
150400                                   TO DP013-MESSAGE-TEXT (1)      15040000
150500                 MOVE SQLCA        TO DP013-SQLCA                 15050000
150600                 MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    15060000
150700                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (2)    15070000
150800                 SET DP013-DB2-ABEND                              15080000
150900                     DP013-XCTL-DISPLAY-RESTART                   15090000
151000                                   TO TRUE                        15100000
151100                 PERFORM DP013-0000-PROCESS-ABEND                 15110000
151200         END-EVALUATE                                             15120000
151300     END-PERFORM.                                                 15130000
151400                                                                  15140000
151500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15150000
151600         MOVE '3020-SEE-IF-VNDR'                                  15160000
151700                                   TO DP013-PARAGRAPH             15170000
151800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     15180000
151900                                   TO DP013-MESSAGE-TEXT (1)      15190000
152000         MOVE 'A TTRDTRN ROW   '   TO DP013-MESSAGE-TEXT (2)      15200000
152100         MOVE SQLCA                TO DP013-SQLCA                 15210000
152200         MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    15220000
152300         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (2)    15230000
152400         SET DP013-DB2-ABEND                                      15240000
152500             DP013-XCTL-DISPLAY-RESTART                           15250000
152600                                   TO TRUE                        15260000
152700         PERFORM DP013-0000-PROCESS-ABEND                         15270000
152800     END-IF.                                                      15280000
152900                                                                  15290000
153000     IF PV-DUP-COUNTER > +0                                       15300000
153100         SET PS-ERROR                   TO TRUE                   15310000
153200         SET DP020-MSG-FATAL            TO TRUE                   15320000
153300***      NEW MSG...                                               15330000
153400         MOVE PC-TSYMSG-00231           TO DP020-MSG-NUMBER       15340000
153500         MOVE DP015-UNP-ALP-BRT-MDT     TO TSETA                  15350000
153600                                           PRDTSTA                15360000
153700         MOVE DP015-RED                 TO TSETC                  15370000
153800                                           PRDTSTC                15380000
153900         MOVE DP015-REVERSE             TO TSETH                  15390000
154000                                           PRDTSTH                15400000
154100         MOVE -1                        TO TSETL                  15410000
154200         SET DP030-SET-CURSOR-APPL-1    TO TRUE                   15420000
154300     END-IF.                                                      15430000
154400                                                                  15440000
154500*---------------------------------------------------------------- 15450000
154600* WHEN ADDING A PROD. PURCHASE ORDER CHANGE DOCUMENT PC (860)     15460000
154700*     A PROD 850 MUST EXIST.                                      15470000
154800*---------------------------------------------------------------- 15480000
154900 3030-CHK-FOR-PROD-850-ADD.                                       15490000
155000     INITIALIZE PS-PO850-EXISTS-SW.                               15500000
155100                                                                  15510000
155200     PERFORM                                                      15520000
155300         WITH TEST AFTER                                          15530000
155400         VARYING PV-RETRY-COUNTER                                 15540000
155500         FROM 1 BY 1                                              15550000
155600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15560000
155700             OR ((SQLCODE = +0)                                   15570000
155800             OR (SQLCODE = +100)))                                15580000
155900                                                                  15590000
156000         EXEC SQL                                                 15600000
156100             SELECT TP_DKEY                                       15610000
156200                  , TRAN_SET_CDE                                  15620000
156300                  , PROD_TEST_IND                                 15630000
156400                  , INACTV_DTE                                    15640000
156500               INTO :TRDTRN-TP-DKEY                               15650000
156600                  , :TRDTRN-TRAN-SET-CDE                          15660000
156700                  , :TRDTRN-PROD-TEST-IND                         15670000
156800                  , :TRDTRN-INACTV-DTE                            15680000
156900               FROM TTRDTRN                                       15690000
157000              WHERE TP_DKEY        = :ASC-KEY-TP-DKEY             15700000
157100                AND TRAN_SET_CDE = '850'                          15710000
157200                AND PROD_TEST_IND = 'P'                           15720000
157300                AND DIR_IND        = 'S'                          15730000
157400                AND INACTV_DTE = '9999-09-09'                     15740000
157500         END-EXEC                                                 15750000
157600                                                                  15760000
157700         EVALUATE TRUE                                            15770000
157800             WHEN SQLCODE = +0                                    15780000
157900                 SET PS-PO850-PROD-EXISTS TO TRUE                 15790000
158000                                                                  15800000
158100             WHEN SQLCODE = +100                                  15810000
158200                 SET PS-NO-PO850-EXISTS                           15820000
158300                     PS-ERROR                                     15830000
158400                     DP020-MSG-FATAL                              15840000
158500                     DP030-SET-CURSOR-APPL-1 TO TRUE              15850000
158600*************    "VENDOR NOT SET UP FOR PRODUCTION 850"           15860000
158700                 MOVE PC-TSYMSG-03461        TO DP020-MSG-NUMBER  15870000
158800             WHEN SQLCODE = -904                                  15880000
158900             WHEN SQLCODE = -913                                  15890000
159000                 CONTINUE                                         15900000
159100                                                                  15910000
159200             WHEN SQLWARN0 NOT = SPACES                           15920000
159300             WHEN SQLCODE < +0                                    15930000
159400             WHEN SQLCODE > +0                                    15940000
159500                 MOVE '3030-CHK-FOR-PROD-850-ADD'                 15950000
159600                                   TO DP013-PARAGRAPH             15960000
159700                 MOVE 'SELECT A ROW ON TTRDTRN'                   15970000
159800                                   TO DP013-MESSAGE-TEXT(1)       15980000
159900                 MOVE SQLCA        TO DP013-SQLCA                 15990000
160000                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    16000000
160100                 SET DP013-DB2-ABEND                              16010000
160200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16020000
160300                 PERFORM DP013-0000-PROCESS-ABEND                 16030000
160400         END-EVALUATE                                             16040000
160500     END-PERFORM.                                                 16050000
160600                                                                  16060000
160700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16070000
160800         MOVE '3030-CHK-FOR-PROD-850-ADD' TO DP013-PARAGRAPH      16080000
160900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              16090000
161000                                   TO DP013-MESSAGE-TEXT (1)      16100000
161100         MOVE 'TO SELECT A TTRDTRN ROW'                           16110000
161200                                   TO DP013-MESSAGE-TEXT (2)      16120000
161300         MOVE SQLCA                TO DP013-SQLCA                 16130000
161400         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    16140000
161500         SET DP013-DB2-ABEND                                      16150000
161600             DP013-XCTL-DISPLAY-RESTART                           16160000
161700                                   TO TRUE                        16170000
161800         PERFORM DP013-0000-PROCESS-ABEND                         16180000
161900     END-IF.                                                      16190000
162000                                                                  16200000
162100*---------------------------------------------------------------- 16210000
162200* WHEN ADDING A TEST PURCHASE ORDER CHANGE DOCUMENT PC (860)      16220000
162300*     EITHER A PROD. OR TEST 850 MUST EXIST.                      16230000
162400*---------------------------------------------------------------- 16240000
162500 3035-CHK-FOR-ANY-850-ADD.                                        16250000
162600     INITIALIZE PS-PO850-EXISTS-SW.                               16260000
162700                                                                  16270000
162800     PERFORM                                                      16280000
162900         WITH TEST AFTER                                          16290000
163000         VARYING PV-RETRY-COUNTER                                 16300000
163100         FROM 1 BY 1                                              16310000
163200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16320000
163300             OR ((SQLCODE = +0)                                   16330000
163400             OR (SQLCODE = -811)                                  16340000
163500             OR (SQLCODE = +100)))                                16350000
163600                                                                  16360000
163700         EXEC SQL                                                 16370000
163800             SELECT TP_DKEY                                       16380000
163900                  , TRAN_SET_CDE                                  16390000
164000                  , PROD_TEST_IND                                 16400000
164100                  , INACTV_DTE                                    16410000
164200               INTO :TRDTRN-TP-DKEY                               16420000
164300                  , :TRDTRN-TRAN-SET-CDE                          16430000
164400                  , :TRDTRN-PROD-TEST-IND                         16440000
164500                  , :TRDTRN-INACTV-DTE                            16450000
164600               FROM TTRDTRN                                       16460000
164700              WHERE TP_DKEY        = :ASC-KEY-TP-DKEY             16470000
164800                AND TRAN_SET_CDE = '850'                          16480000
164900                AND DIR_IND        = 'S'                          16490000
165000                AND INACTV_DTE = '9999-09-09'                     16500000
165100         END-EXEC                                                 16510000
165200                                                                  16520000
165300         EVALUATE TRUE                                            16530000
165400             WHEN SQLCODE = +0                                    16540000
165500             WHEN SQLCODE = -811                                  16550000
165600                 SET PS-PO850-ANY-EXISTS TO TRUE                  16560000
165700                                                                  16570000
165800             WHEN SQLCODE = +100                                  16580000
165900                 SET PS-NO-PO850-EXISTS                           16590000
166000                     PS-ERROR                                     16600000
166100                     DP020-MSG-FATAL                              16610000
166200                     DP030-SET-CURSOR-APPL-1 TO TRUE              16620000
166300*************    "VENDOR NOT SET UP FOR 850"                      16630000
166400                 MOVE PC-TSYMSG-03462        TO DP020-MSG-NUMBER  16640000
166500                                                                  16650000
166600             WHEN SQLCODE = -904                                  16660000
166700             WHEN SQLCODE = -913                                  16670000
166800                 CONTINUE                                         16680000
166900                                                                  16690000
167000             WHEN SQLWARN0 NOT = SPACES                           16700000
167100             WHEN SQLCODE < +0                                    16710000
167200             WHEN SQLCODE > +0                                    16720000
167300                 MOVE '3035-CHK-FOR-ANY-850-ADD'                  16730000
167400                                   TO DP013-PARAGRAPH             16740000
167500                 MOVE 'SELECT A ROW ON TTRDTRN'                   16750000
167600                                   TO DP013-MESSAGE-TEXT(1)       16760000
167700                 MOVE SQLCA        TO DP013-SQLCA                 16770000
167800                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    16780000
167900                 SET DP013-DB2-ABEND                              16790000
168000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16800000
168100                 PERFORM DP013-0000-PROCESS-ABEND                 16810000
168200         END-EVALUATE                                             16820000
168300     END-PERFORM.                                                 16830000
168400                                                                  16840000
168500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16850000
168600         MOVE '3035-CHK-FOR-ANY-850-ADD' TO DP013-PARAGRAPH       16860000
168700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              16870000
168800                                   TO DP013-MESSAGE-TEXT (1)      16880000
168900         MOVE 'TO SELECT A TTRDTRN ROW'                           16890000
169000                                   TO DP013-MESSAGE-TEXT (2)      16900000
169100         MOVE SQLCA                TO DP013-SQLCA                 16910000
169200         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    16920000
169300         SET DP013-DB2-ABEND                                      16930000
169400             DP013-XCTL-DISPLAY-RESTART                           16940000
169500                                   TO TRUE                        16950000
169600         PERFORM DP013-0000-PROCESS-ABEND                         16960000
169700     END-IF.                                                      16970000
169800                                                                  16980000
169900/                                                                 16990000
170000***************************************************************** 17000000
170100* UPDATE EDITS                                                    17010000
170200***************************************************************** 17020000
170300 3100-UPDATE-EDITS.                                               17030000
170400                                                                  17040000
170500     PERFORM 3005-EDIT-COMM-FIELDS.                               17050000
170600     PERFORM 3010-EDIT-VER-NBR.                                   17060000
170700     PERFORM 3120-EDIT-ACTIVE-DATE.                               17070000
170800     PERFORM 3130-EDIT-INACTIVE-DATE.                             17080000
170900     PERFORM 3140-EDIT-LAST-NEXT-CALL-DATE.                       17090000
171000                                                                  17100000
171100 3120-EDIT-ACTIVE-DATE.                                           17110000
171200                                                                  17120000
171300     IF ASC-ACTV-DTE-MM-NEW = SPACES AND                          17130000
171400        ASC-ACTV-DTE-DD-NEW = SPACES AND                          17140000
171500        ASC-ACTV-DTE-YY-NEW = SPACES                              17150000
171600         MOVE SPACE TO ASC-ACTV-DTE-NEW                           17160000
171700     END-IF                                                       17170000
171800                                                                  17180000
171900     SET PS-VALID-DATE TO TRUE                                    17190000
172000                                                                  17200000
172100     IF ASC-ACTV-DTE-NEW = ASC-CURRENT-DATE OR                    17210000
172200                           SPACE                                  17220000
172300         CONTINUE                                                 17230000
172400     ELSE                                                         17240000
172500         MOVE ASC-ACTV-DTE-NEW TO PV-CCYYMMDD-DATE                17250000
172600         PERFORM 3195-EDIT-DATE                                   17260000
172700         IF PS-VALID-DATE                                         17270000
172800             MOVE PV-CCYYMMDD-DATE TO ASC-ACTV-DTE-NEW            17280000
172900             IF PV-CCYYMMDD-DATE >= ASC-SETUP-DTE                 17290000
173000                 CONTINUE                                         17300000
173100             ELSE                                                 17310000
173200                 SET PS-INVALID-DATE       TO TRUE                17320000
173300                 IF PS-NO-ERROR                                   17330000
173400                     MOVE PC-TSYMSG-00835  TO DP020-MSG-NUMBER    17340000
173500                 END-IF                                           17350000
173600             END-IF                                               17360000
173700         ELSE                                                     17370000
173800             IF PS-NO-ERROR                                       17380000
173900                 MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER    17390000
174000             END-IF                                               17400000
174100         END-IF                                                   17410000
174200     END-IF                                                       17420000
174300                                                                  17430000
174400     IF PS-INVALID-DATE                                           17440000
174500         SET DP020-MSG-FATAL       TO TRUE                        17450000
174600         MOVE DP015-UNP-ALP-BRT-MDT                               17460000
174700                                   TO ACTVMTHA                    17470000
174800                                      ACTVDAYA                    17480000
174900                                      ACTVYRA                     17490000
175000         MOVE DP015-RED            TO ACTVMTHC                    17500000
175100                                      ACTVDAYC                    17510000
175200                                      ACTVYRC                     17520000
175300         MOVE DP015-REVERSE        TO ACTVMTHH                    17530000
175400                                      ACTVDAYH                    17540000
175500                                      ACTVYRH                     17550000
175600         MOVE -1                   TO ACTVMTHL                    17560000
175700         SET PS-ERROR              TO TRUE                        17570000
175800         SET DP030-SET-CURSOR-APPL-1                              17580000
175900                                   TO TRUE                        17590000
176000     END-IF.                                                      17600000
176100                                                                  17610000
176200 3130-EDIT-INACTIVE-DATE.                                         17620000
176300                                                                  17630000
176400     IF ASC-INACTV-DTE-MM-NEW = SPACES AND                        17640000
176500        ASC-INACTV-DTE-DD-NEW = SPACES AND                        17650000
176600        ASC-INACTV-DTE-YY-NEW = SPACES                            17660000
176700         MOVE SPACE TO ASC-INACTV-DTE-NEW                         17670000
176800     END-IF                                                       17680000
176900                                                                  17690000
177000     SET PS-VALID-DATE TO TRUE                                    17700000
177100                                                                  17710000
177200     IF ASC-INACTV-DTE-NEW = SPACE                                17720000
177300         CONTINUE                                                 17730000
177400     ELSE                                                         17740000
177500         IF ASC-ACTV-DTE-NEW = SPACES                             17750000
177600             MOVE DP015-UNP-ALP-BRT-MDT                           17760000
177700                                       TO ACTVMTHA                17770000
177800                                          ACTVDAYA                17780000
177900                                          ACTVYRA                 17790000
178000             MOVE DP015-RED            TO ACTVMTHC                17800000
178100                                          ACTVDAYC                17810000
178200                                          ACTVYRC                 17820000
178300             MOVE DP015-REVERSE        TO ACTVMTHH                17830000
178400                                          ACTVDAYH                17840000
178500                                          ACTVYRH                 17850000
178600             IF PS-NO-ERROR                                       17860000
178700*               ** ACTIVE DATE REQUIRED IF INACTIVE DATE ENTERED  17870000
178800                 SET PS-ERROR          TO TRUE                    17880000
178900                 MOVE PC-TSYMSG-00833  TO DP020-MSG-NUMBER        17890000
179000                 SET DP020-MSG-FATAL   TO TRUE                    17900000
179100                 MOVE -1               TO ACTVMTHL                17910000
179200                 SET DP030-SET-CURSOR-APPL-1                      17920000
179300                                       TO TRUE                    17930000
179400             END-IF                                               17940000
179500         ELSE                                                     17950000
179600             MOVE ASC-INACTV-DTE-NEW TO PV-CCYYMMDD-DATE          17960000
179700             PERFORM 3195-EDIT-DATE                               17970000
179800             IF PS-VALID-DATE                                     17980000
179900                 MOVE PV-CCYYMMDD-DATE TO ASC-INACTV-DTE-NEW      17990000
180000                 IF PV-CCYYMMDD-DATE >= ASC-ACTV-DTE-NEW          18000000
180100                     IF PV-CCYYMMDD-DATE > ASC-TRDPRT-INACTV-DTE  18010000
180200                         SET PS-INVALID-DATE   TO TRUE            18020000
180300                         IF PS-NO-ERROR                           18030000
180400*                            ** INACTIVE DATE CANNOT BE GREATER **18040000
180500*                            ** THAN TRADING PARTNER INACTIVE   **18050000
180600*                            ** DATE                            **18060000
180700                             MOVE PC-TSYMSG-00837                 18070000
180800                                               TO DP020-MSG-NUMBER18080000
180900                             MOVE -1           TO INACTVML        18090000
181000                             SET PS-ERROR      TO TRUE            18100000
181100                         END-IF                                   18110000
181200                     END-IF                                       18120000
181300                 ELSE                                             18130000
181400                     SET PS-INVALID-DATE       TO TRUE            18140000
181500                     IF PS-NO-ERROR                               18150000
181600                         MOVE PC-TSYMSG-00165  TO DP020-MSG-NUMBER18160000
181700                         MOVE -1               TO INACTVML        18170000
181800                         SET PS-ERROR          TO TRUE            18180000
181900                     END-IF                                       18190000
182000                 END-IF                                           18200000
182100             ELSE                                                 18210000
182200                 IF PS-NO-ERROR                                   18220000
182300                     MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER18230000
182400                     MOVE -1                   TO INACTVML        18240000
182500                     SET PS-ERROR              TO TRUE            18250000
182600                 END-IF                                           18260000
182700             END-IF                                               18270000
182800         END-IF                                                   18280000
182900     END-IF                                                       18290000
183000                                                                  18300000
183100     IF PS-INVALID-DATE                                           18310000
183200         SET DP020-MSG-FATAL       TO TRUE                        18320000
183300         MOVE DP015-UNP-ALP-BRT-MDT                               18330000
183400                                   TO INACTVMA                    18340000
183500                                      INACTVDA                    18350000
183600                                      INACTVYA                    18360000
183700         MOVE DP015-RED            TO INACTVMC                    18370000
183800                                      INACTVDC                    18380000
183900                                      INACTVYC                    18390000
184000         MOVE DP015-REVERSE        TO INACTVMH                    18400000
184100                                      INACTVDH                    18410000
184200                                      INACTVYH                    18420000
184300         SET DP030-SET-CURSOR-APPL-1                              18430000
184400                                   TO TRUE                        18440000
184500     END-IF.                                                      18450000
184600                                                                  18460000
184700     IF ASC-UPDATE-PENDING                                        18470000
184800***** WHEN REACTIVATING AN '860', MUST CHECK FOR AN '850'         18480000
184900         IF ASC-KEY-TRAN-SET-CDE = '860'                          18490000
185000             IF ASC-KEY-PROD-TEST-IND = 'P'                       18500000
185100******** CAN'T REACTIVATE PROD 860 IF PROD 850 DOESN'T EXIST      18510000
185200                 PERFORM 3030-CHK-FOR-PROD-850-ADD                18520000
185300             ELSE                                                 18530000
185400                 IF ASC-KEY-PROD-TEST-IND = 'T'                   18540000
185500******** CAN'T REACTIVATE TEST 860 IF NO 850 EXISTS (PROD OR TEST)18550000
185600                     PERFORM 3035-CHK-FOR-ANY-850-ADD             18560000
185700                 END-IF                                           18570000
185800             END-IF                                               18580000
185900         ELSE                                                     18590000
186000             IF ASC-KEY-TRAN-SET-CDE = '850'                      18600000
186100******** WHEN INACTIVATING AN 850, HAVE TO CHECK FOR              18610000
186200******** EITHER A PROD OR TEST 860. SEE COMMENTS BEFORE           18620000
186300******** 3700-CHK-BEFORE-850-DEL-INACT FOR DETAILS                18630000
186400                 PERFORM 3700-CHK-BEFORE-850-DEL-INACT            18640000
186500             END-IF                                               18650000
186600         END-IF                                                   18660000
186700     END-IF.                                                      18670000
186800                                                                  18680000
186900 3140-EDIT-LAST-NEXT-CALL-DATE.                                   18690000
187000                                                                  18700000
187100     IF ASC-LAST-CALL-DTE-MM-NEW = SPACES AND                     18710000
187200        ASC-LAST-CALL-DTE-DD-NEW = SPACES AND                     18720000
187300        ASC-LAST-CALL-DTE-YY-NEW = SPACES                         18730000
187400         MOVE SPACE TO ASC-LAST-CALL-DTE-NEW                      18740000
187500     END-IF                                                       18750000
187600                                                                  18760000
187700     SET PS-VALID-DATE TO TRUE                                    18770000
187800                                                                  18780000
187900     IF ASC-LAST-CALL-DTE-NEW = SPACE                             18790000
188000         CONTINUE                                                 18800000
188100     ELSE                                                         18810000
188200         MOVE ASC-LAST-CALL-DTE-NEW TO PV-CCYYMMDD-DATE           18820000
188300         PERFORM 3195-EDIT-DATE                                   18830000
188400         MOVE PV-CCYYMMDD-DATE TO ASC-LAST-CALL-DTE-NEW           18840000
188500         IF PS-VALID-DATE                                         18850000
188600             IF ASC-LAST-CALL-DTE-NEW <= ASC-CURRENT-DATE         18860000
188700                 CONTINUE                                         18870000
188800             ELSE                                                 18880000
188900                 SET PS-INVALID-DATE TO TRUE                      18890000
189000                 IF PS-NO-ERROR                                   18900000
189100                     MOVE PC-TSYMSG-00396  TO DP020-MSG-NUMBER    18910000
189200                 END-IF                                           18920000
189300             END-IF                                               18930000
189400         ELSE                                                     18940000
189500             IF PS-NO-ERROR                                       18950000
189600                 MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER    18960000
189700             END-IF                                               18970000
189800         END-IF                                                   18980000
189900     END-IF.                                                      18990000
190000                                                                  19000000
190100     IF PS-INVALID-DATE                                           19010000
190200         MOVE DP015-UNP-ALP-BRT-MDT                               19020000
190300                                   TO LCALMTHA                    19030000
190400                                      LCALDAYA                    19040000
190500                                      LCALYRA                     19050000
190600         MOVE DP015-RED            TO LCALMTHC                    19060000
190700                                      LCALDAYC                    19070000
190800                                      LCALYRC                     19080000
190900         MOVE DP015-REVERSE        TO LCALMTHH                    19090000
191000                                      LCALDAYH                    19100000
191100                                      LCALYRH                     19110000
191200         IF PS-NO-ERROR                                           19120000
191300             SET DP020-MSG-FATAL         TO TRUE                  19130000
191400             MOVE -1                     TO LCALMTHL              19140000
191500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19150000
191600             SET PS-ERROR                TO TRUE                  19160000
191700         END-IF                                                   19170000
191800     END-IF.                                                      19180000
191900                                                                  19190000
192000     SET PS-VALID-DATE TO TRUE                                    19200000
192100                                                                  19210000
192200     IF ASC-NEXT-CALL-DTE-MM-NEW = SPACES AND                     19220000
192300        ASC-NEXT-CALL-DTE-DD-NEW = SPACES AND                     19230000
192400        ASC-NEXT-CALL-DTE-YY-NEW = SPACES                         19240000
192500         MOVE SPACE TO ASC-NEXT-CALL-DTE-NEW                      19250000
192600     END-IF                                                       19260000
192700                                                                  19270000
192800     IF ASC-NEXT-CALL-DTE-NEW = SPACE                             19280000
192900         CONTINUE                                                 19290000
193000     ELSE                                                         19300000
193100         IF ASC-LAST-CALL-DTE-NEW = SPACE                         19310000
193200             MOVE DP015-UNP-ALP-BRT-MDT      TO LCALMTHA          19320000
193300                                                LCALDAYA          19330000
193400                                                LCALYRA           19340000
193500             MOVE DP015-RED                  TO LCALMTHC          19350000
193600                                                LCALDAYC          19360000
193700                                                LCALYRC           19370000
193800             MOVE DP015-REVERSE              TO LCALMTHH          19380000
193900                                                LCALDAYH          19390000
194000                                                LCALYRH           19400000
194100             IF PS-NO-ERROR                                       19410000
194200                 MOVE PC-TSYMSG-00834      TO DP020-MSG-NUMBER    19420000
194300                 SET DP020-MSG-FATAL       TO TRUE                19430000
194400                 MOVE -1                   TO LCALMTHL            19440000
194500                 SET DP030-SET-CURSOR-APPL-1                      19450000
194600                                           TO TRUE                19460000
194700                 SET PS-ERROR              TO TRUE                19470000
194800             END-IF                                               19480000
194900         END-IF                                                   19490000
195000         MOVE ASC-NEXT-CALL-DTE-NEW TO PV-CCYYMMDD-DATE           19500000
195100         PERFORM 3195-EDIT-DATE                                   19510000
195200         MOVE PV-CCYYMMDD-DATE TO ASC-NEXT-CALL-DTE-NEW           19520000
195300         IF PS-VALID-DATE                                         19530000
195400             IF ASC-NEXT-CALL-DTE-NEW > ASC-LAST-CALL-DTE-NEW     19540000
195500                AND                                               19550000
195600                ASC-NEXT-CALL-DTE-NEW >= ASC-CURRENT-DATE         19560000
195700                 CONTINUE                                         19570000
195800             ELSE                                                 19580000
195900                 SET PS-INVALID-DATE       TO TRUE                19590000
196000                 IF PS-NO-ERROR                                   19600000
196100                     MOVE PC-TSYMSG-00762  TO DP020-MSG-NUMBER    19610000
196200                 END-IF                                           19620000
196300             END-IF                                               19630000
196400         ELSE                                                     19640000
196500             IF PS-NO-ERROR                                       19650000
196600                 MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER    19660000
196700             END-IF                                               19670000
196800         END-IF                                                   19680000
196900     END-IF                                                       19690000
197000                                                                  19700000
197100     IF PS-INVALID-DATE                                           19710000
197200         SET DP020-MSG-FATAL       TO TRUE                        19720000
197300         MOVE -1                   TO NCALMTHL                    19730000
197400         SET PS-ERROR              TO TRUE                        19740000
197500         MOVE DP015-UNP-ALP-BRT-MDT                               19750000
197600                                   TO NCALMTHA                    19760000
197700                                      NCALDAYA                    19770000
197800                                      NCALYRA                     19780000
197900         MOVE DP015-RED            TO NCALMTHC                    19790000
198000                                      NCALDAYC                    19800000
198100                                      NCALYRC                     19810000
198200         MOVE DP015-REVERSE        TO NCALMTHH                    19820000
198300                                      NCALDAYH                    19830000
198400                                      NCALYRH                     19840000
198500         SET DP030-SET-CURSOR-APPL-1                              19850000
198600                                   TO TRUE                        19860000
198700     END-IF.                                                      19870000
198800/                                                                 19880000
198900 3195-EDIT-DATE.                                                  19890000
199000                                                                  19900000
199100     SET PS-VALID-DATE TO TRUE                                    19910000
199200                                                                  19920000
199300     INITIALIZE DPG51                                             19930000
199400                DPG52                                             19940000
199500                DPG53                                             19950000
199600                DPG54                                             19960000
199700                DPG55                                             19970000
199800                DPG56                                             19980000
199900                                                                  19990000
200000     MOVE 'F2'                 TO DPG51-CALENDAR-TYPE             20000000
200100                                                                  20010000
200200     SET DPG51-DO-NOT-INCR-DECR-DATE                              20020000
200300         DPG52-LK-DTE-ISO-FMT  TO TRUE                            20030000
200400                                                                  20040000
200500     IF PV-CCYY NUMERIC                                           20050000
200600         CONTINUE                                                 20060000
200700     ELSE                                                         20070000
200800         MOVE PV-CCYY                TO DP010I-UNEDITED-FIELD     20080000
200900         MOVE 4                      TO DP010I-MAXIMUM-DIGITS     20090000
201000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   20100000
201100         SET DP010I-NEGATIVE-NOT-ALLOWED                          20110000
201200                                     TO TRUE                      20120000
201310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20131001
201320                         USING DP010I-NUMERIC-EDIT-AREA           20132001
201400         IF DP010I-ERROR-DETECTED                                 20140000
201500             CONTINUE                                             20150000
201600         ELSE                                                     20160000
201700             MOVE DP010I-NUMERIC-FIELD                            20170000
201800                                     TO PV-CCYY-9                 20180000
201900*-->         ALLOW THEM TO ENTER A TWO DIGIT YEAR W/OUT CENTURY   20190000
202000             IF PV-CCYY-9 < 75                                    20200000
202100                 MOVE 20             TO PV-CC                     20210000
202200             ELSE                                                 20220000
202300                 IF PV-CCYY-9 > 1999                              20230000
202400                     CONTINUE                                     20240000
202500                 ELSE                                             20250000
202600                     MOVE 19         TO PV-CC                     20260000
202700                 END-IF                                           20270000
202800             END-IF                                               20280000
202900         END-IF                                                   20290000
203000     END-IF                                                       20300000
203100                                                                  20310000
203200     IF PV-CCYY NUMERIC AND                                       20320000
203300        PV-MM   NUMERIC AND                                       20330000
203400        PV-DD   NUMERIC                                           20340000
203500         MOVE '-'      TO PV-DASH1                                20350000
203600                          PV-DASH2                                20360000
203700         MOVE PV-CCYYMMDD-DATE  TO DPG52-LK-DATE-INPUT            20370000
203800                                                                  20380000
203900         CALL PC-DPKUT500                                         20390000
204000             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            20400000
204100                                                                  20410000
204200         IF (DPG54-DATE-INVALID OR                                20420000
204300             DPG54-SEVERE-ERROR)                                  20430000
204400             SET PS-INVALID-DATE TO TRUE                          20440000
204500         END-IF                                                   20450000
204600     ELSE                                                         20460000
204700         SET PS-INVALID-DATE    TO TRUE                           20470000
204800     END-IF.                                                      20480000
204900/                                                                 20490000
205000/                                                                 20500000
205100 3200-RESET-ATTRIBUTES.                                           20510000
205200                                                                  20520000
205300     MOVE DP015-PRO-NOR-OFF    TO  TSETA                          20530000
205400                                   PRDTSTA                        20540000
205500                                   COMMTHA                        20550000
205600                                   DIRA                           20560000
205700                                   VERNBRA                        20570000
205800                                   VERNMEA                        20580000
205900                                   SETDTEA                        20590000
206000                                   LCHGDTEA                       20600000
206100                                   LCHGUIDA                       20610000
206200                                   ACTVMTHA                       20620000
206300                                   ACTVDAYA                       20630000
206400                                   ACTVYRA                        20640000
206500                                   INACTVMA                       20650000
206600                                   INACTVDA                       20660000
206700                                   INACTVYA                       20670000
206800                                   LCALMTHA                       20680000
206900                                   LCALDAYA                       20690000
207000                                   LCALYRA                        20700000
207100                                   NCALMTHA                       20710000
207200                                   NCALDAYA                       20720000
207300                                   NCALYRA                        20730000
207400                                   NOTE1A                         20740000
207500                                   NOTE2A                         20750000
207600                                                                  20760000
207700     MOVE DP015-HL-OFF         TO  TSETH                          20770000
207800                                   PRDTSTH                        20780000
207900                                   COMMTHH                        20790000
208000                                   DIRH                           20800000
208100                                   VERNBRH                        20810000
208200                                   VERNMEH                        20820000
208300                                   SETDTEH                        20830000
208400                                   LCHGDTEH                       20840000
208500                                   LCHGUIDH                       20850000
208600                                   ACTVMTHH                       20860000
208700                                   ACTVDAYH                       20870000
208800                                   ACTVYRH                        20880000
208900                                   INACTVMH                       20890000
209000                                   INACTVDH                       20900000
209100                                   INACTVYH                       20910000
209200                                   LCALMTHH                       20920000
209300                                   LCALDAYH                       20930000
209400                                   LCALYRH                        20940000
209500                                   NCALMTHH                       20950000
209600                                   NCALDAYH                       20960000
209700                                   NCALYRH                        20970000
209800                                   NOTE1H                         20980000
209900                                   NOTE2H                         20990000
210000                                                                  21000000
210100     MOVE DP015-BLUE           TO  TSETC                          21010000
210200                                   PRDTSTC                        21020000
210300                                   COMMTHC                        21030000
210400                                   DIRC                           21040000
210500                                   VERNBRC                        21050000
210600                                   VERNMEC                        21060000
210700                                   SETDTEC                        21070000
210800                                   LCHGDTEC                       21080000
210900                                   LCHGUIDC                       21090000
211000                                   ACTVMTHC                       21100000
211100                                   ACTVDAYC                       21110000
211200                                   ACTVYRC                        21120000
211300                                   INACTVMC                       21130000
211400                                   INACTVDC                       21140000
211500                                   INACTVYC                       21150000
211600                                   LCALMTHC                       21160000
211700                                   LCALDAYC                       21170000
211800                                   LCALYRC                        21180000
211900                                   NCALMTHC                       21190000
212000                                   NCALDAYC                       21200000
212100                                   NCALYRC                        21210000
212200                                   NOTE1C                         21220000
212300                                   NOTE2C                         21230000
212400                                                                  21240000
212500     IF  ASC-UPDATE-PENDING OR                                    21250000
212600         ASC-ADD-PENDING                                          21260000
212700         MOVE DP015-UNP-ALP-NOR-OFF                               21270000
212800                                TO COMMTHA                        21280000
212900                                   VERNBRA                        21290000
213000                                   ACTVMTHA                       21300000
213100                                   ACTVDAYA                       21310000
213200                                   ACTVYRA                        21320000
213300                                   LCALMTHA                       21330000
213400                                   LCALDAYA                       21340000
213500                                   LCALYRA                        21350000
213600                                   NCALMTHA                       21360000
213700                                   NCALDAYA                       21370000
213800                                   NCALYRA                        21380000
213900                                   NOTE1A                         21390000
214000                                   NOTE2A                         21400000
214100         MOVE DP015-GREEN       TO COMMTHC                        21410000
214200                                   VERNBRC                        21420000
214300                                   ACTVMTHC                       21430000
214400                                   ACTVDAYC                       21440000
214500                                   ACTVYRC                        21450000
214600                                   LCALMTHC                       21460000
214700                                   LCALDAYC                       21470000
214800                                   LCALYRC                        21480000
214900                                   NCALMTHC                       21490000
215000                                   NCALDAYC                       21500000
215100                                   NCALYRC                        21510000
215200                                   NOTE1C                         21520000
215300                                   NOTE2C                         21530000
215400         MOVE DP015-UNDERLINE   TO COMMTHH                        21540000
215500                                   VERNBRH                        21550000
215600                                   ACTVMTHH                       21560000
215700                                   ACTVDAYH                       21570000
215800                                   ACTVYRH                        21580000
215900                                   LCALMTHH                       21590000
216000                                   LCALDAYH                       21600000
216100                                   LCALYRH                        21610000
216200                                   NCALMTHH                       21620000
216300                                   NCALDAYH                       21630000
216400                                   NCALYRH                        21640000
216500                                   NOTE1H                         21650000
216600                                   NOTE2H                         21660000
216700     END-IF                                                       21670000
216800                                                                  21680000
216900     IF  ASC-UPDATE-PENDING                                       21690000
217000         MOVE DP015-UNP-ALP-NOR-OFF                               21700000
217100                                TO INACTVMA                       21710000
217200                                   INACTVDA                       21720000
217300                                   INACTVYA                       21730000
217400         MOVE DP015-GREEN       TO INACTVMC                       21740000
217500                                   INACTVDC                       21750000
217600                                   INACTVYC                       21760000
217700         MOVE DP015-UNDERLINE   TO INACTVMH                       21770000
217800                                   INACTVDH                       21780000
217900                                   INACTVYH                       21790000
218000     END-IF                                                       21800000
218100                                                                  21810000
218200     IF  ASC-ADD-PENDING                                          21820000
218300         MOVE DP015-UNP-ALP-NOR-OFF TO TSETA                      21830000
218400                                       PRDTSTA                    21840000
218500         MOVE DP015-GREEN           TO TSETC                      21850000
218600                                       PRDTSTC                    21860000
218700         MOVE DP015-UNDERLINE       TO TSETH                      21870000
218800                                       PRDTSTH                    21880000
218900     END-IF.                                                      21890000
219000                                                                  21900000
219100                                                                  21910000
219200 3250-SET-ATTRIBUTES-TO-PROT.                                     21920000
219300                                                                  21930000
219400     MOVE DP015-PRO-NOR-OFF    TO  TSETA                          21940000
219500                                   PRDTSTA                        21950000
219600                                   COMMTHA                        21960000
219700                                   DIRA                           21970000
219800                                   VERNBRA                        21980000
219900                                   VERNMEA                        21990000
220000                                   SETDTEA                        22000000
220100                                   LCHGDTEA                       22010000
220200                                   LCHGUIDA                       22020000
220300                                   ACTVMTHA                       22030000
220400                                   ACTVDAYA                       22040000
220500                                   ACTVYRA                        22050000
220600                                   INACTVMA                       22060000
220700                                   INACTVDA                       22070000
220800                                   INACTVYA                       22080000
220900                                   LCALMTHA                       22090000
221000                                   LCALDAYA                       22100000
221100                                   LCALYRA                        22110000
221200                                   NCALMTHA                       22120000
221300                                   NCALDAYA                       22130000
221400                                   NCALYRA                        22140000
221500                                   NOTE1A                         22150000
221600                                   NOTE2A                         22160000
221700                                                                  22170000
221800     MOVE DP015-HL-OFF         TO  TSETH                          22180000
221900                                   PRDTSTH                        22190000
222000                                   COMMTHH                        22200000
222100                                   DIRH                           22210000
222200                                   VERNBRH                        22220000
222300                                   VERNMEH                        22230000
222400                                   SETDTEH                        22240000
222500                                   LCHGDTEH                       22250000
222600                                   LCHGUIDH                       22260000
222700                                   ACTVMTHH                       22270000
222800                                   ACTVDAYH                       22280000
222900                                   ACTVYRH                        22290000
223000                                   INACTVMH                       22300000
223100                                   INACTVDH                       22310000
223200                                   INACTVYH                       22320000
223300                                   LCALMTHH                       22330000
223400                                   LCALDAYH                       22340000
223500                                   LCALYRH                        22350000
223600                                   NCALMTHH                       22360000
223700                                   NCALDAYH                       22370000
223800                                   NCALYRH                        22380000
223900                                   NOTE1H                         22390000
224000                                   NOTE2H                         22400000
224100                                                                  22410000
224200     MOVE DP015-BLUE           TO  TSETC                          22420000
224300                                   PRDTSTC                        22430000
224400                                   COMMTHC                        22440000
224500                                   DIRC                           22450000
224600                                   VERNBRC                        22460000
224700                                   VERNMEC                        22470000
224800                                   SETDTEC                        22480000
224900                                   LCHGDTEC                       22490000
225000                                   LCHGUIDC                       22500000
225100                                   ACTVMTHC                       22510000
225200                                   ACTVDAYC                       22520000
225300                                   ACTVYRC                        22530000
225400                                   INACTVMC                       22540000
225500                                   INACTVDC                       22550000
225600                                   INACTVYC                       22560000
225700                                   LCALMTHC                       22570000
225800                                   LCALDAYC                       22580000
225900                                   LCALYRC                        22590000
226000                                   NCALMTHC                       22600000
226100                                   NCALDAYC                       22610000
226200                                   NCALYRC                        22620000
226300                                   NOTE1C                         22630000
226400                                   NOTE2C.                        22640000
226500                                                                  22650000
226600*---------------------------------------------------------------- 22660000
226700*    SAVE SCREEN FIELDS FOR LATER COMPARISONS                     22670000
226800*---------------------------------------------------------------- 22680000
226900                                                                  22690000
227000 3500-SAVE-SCREEN-FIELDS.                                         22700000
227100                                                                  22710000
227200     MOVE ASC-NEWLY-ENTERED-FIELDS        TO                      22720000
227300          ASC-ORIGINAL-FIELD-VALUES.                              22730000
227400/                                                                 22740000
227500*---------------------------------------------------------------- 22750000
227600*  CHECK TO SEE IF ANY FIELDS CHANGED.                            22760000
227700*---------------------------------------------------------------- 22770000
227800                                                                  22780000
227900 3600-CHECK-IF-FIELDS-CHANGED.                                    22790000
228000                                                                  22800000
228100     MOVE 'N'                    TO ASC-FIELDS-CHANGED-SW.        22810000
228200                                                                  22820000
228300     IF   ASC-NEWLY-ENTERED-FIELDS       =                        22830000
228400          ASC-ORIGINAL-FIELD-VALUES                               22840000
228500         CONTINUE                                                 22850000
228600     ELSE                                                         22860000
228700         SET ASC-FIELDS-CHANGED  TO TRUE                          22870000
228800     END-IF.                                                      22880000
228900                                                                  22890000
229000*---------------------------------------------------------------- 22900000
229100* WHEN DELETING A PROD 850 OR A TEST 850 CERTAIN CONDITIONS NEED  22910000
229200* TO BE CHECKED BEFORE ALLOWING THE DELETE TO HAPPEN              22920000
229300*                                                                 22930000
229400* IF DELETING A PROD 850 CHECK IF A TEST 850 EXISTS, IF THE TEST  22940000
229500*     850 IS NOT FOUND THEN CHECK FOR ANY 860'S (TEST OR PROD)    22950000
229600*     THAT MAY EXIST.  IF ANY 860 EXISTS, SEND ERROR MESSAGE 3463 22960000
229700*     (VENDOR SET UP FOR 860). THE 860'S MUST BE DELETED FIRST    22970000
229800*                                                                 22980000
229900* IF DELETING A PROD 850 CHECK IF A TEST 850 EXISTS, IF THE TEST  22990000
230000*     850 IS FOUND THEN CHECK FOR A PROD 860.  IF THE PROD 860    23000000
230100*     IS FOUND, SEND MESSAGE 3464 (VENDOR SET UP FOR A PRODUCTION 23010000
230200*     860) THE PROD 860 MUST BE DELETED FIRST                     23020000
230300*                                                                 23030000
230400* IF DELETING A TEST 850 CHECK IF A PROD 850 EXISTS, IF THE PROD. 23040000
230500*     850 IS NOT FOUND THEN CHECK FOR ANY 860'S (TEST OR PROD)    23050000
230600*     THAT MAY EXIST.  IF ANY 860 EXISTS, SEND ERROR MESSAGE 3463 23060000
230700*     (VENDOR SET UP FOR 860). THE 860'S MUST BE DELETED FIRST    23070000
230800*                                                                 23080000
230900* IF DELETING A TEST 850 CHECK IF A PROD 850 EXISTS, IF THE PROD  23090000
231000*     850 IS FOUND, NO FURTHER CHECKING IS NEEDED                 23100000
231100*---------------------------------------------------------------- 23110000
231200 3700-CHK-BEFORE-850-DEL-INACT.                                   23120000
231300     IF ASC-KEY-PROD-TEST-IND = 'P'                               23130000
231400         PERFORM 3710-CHK-FOR-TEST-PO850-DEL                      23140000
231500         IF PS-NO-PO850-EXISTS                                    23150000
231600             PERFORM 3720-CHK-FOR-ANY-PC860                       23160000
231700             IF PS-PC860-ANY-EXISTS                               23170000
231800                 SET PS-ERROR                                     23180000
231900                     DP020-MSG-FATAL                              23190000
232000                     DP030-SET-CURSOR-APPL-1 TO TRUE              23200000
232100*************    "VENDOR SET UP FOR 860"                          23210000
232200                 MOVE PC-TSYMSG-03463        TO DP020-MSG-NUMBER  23220000
232300             END-IF                                               23230000
232400         ELSE                                                     23240000
232500             IF PS-PO850-TEST-EXISTS                              23250000
232600                 PERFORM 3715-CHK-FOR-PROD-PC860                  23260000
232700                 IF PS-PC860-PROD-EXISTS                          23270000
232800                     SET PS-ERROR                                 23280000
232900                         DP020-MSG-FATAL                          23290000
233000                         DP030-SET-CURSOR-APPL-1 TO TRUE          23300000
233100***************   "VENDOR SET UP FOR PRODUCTION 860               23310000
233200                     MOVE PC-TSYMSG-03464     TO DP020-MSG-NUMBER 23320000
233300                 END-IF                                           23330000
233400             END-IF                                               23340000
233500         END-IF                                                   23350000
233600     ELSE                                                         23360000
233700         IF ASC-KEY-PROD-TEST-IND = 'T'                           23370000
233800             PERFORM 3705-CHK-FOR-PROD-850-DEL                    23380000
233900             IF PS-NO-PO850-EXISTS                                23390000
234000                 PERFORM 3720-CHK-FOR-ANY-PC860                   23400000
234100                 IF PS-PC860-ANY-EXISTS                           23410000
234200                     SET PS-ERROR                                 23420000
234300                         DP020-MSG-FATAL                          23430000
234400                         DP030-SET-CURSOR-APPL-1 TO TRUE          23440000
234500*************    "VENDOR SET UP FOR 860"                          23450000
234600                     MOVE PC-TSYMSG-03463     TO DP020-MSG-NUMBER 23460000
234700                 END-IF                                           23470000
234800             ELSE                                                 23480000
234900                 SET PS-PC860-DOES-NOT-MATTER TO TRUE             23490000
235000             END-IF                                               23500000
235100         END-IF                                                   23510000
235200     END-IF.                                                      23520000
235300                                                                  23530000
235400*---------------------------------------------------------------- 23540000
235500* CHECK IF A PRODUCTION 850 EXISTS                                23550000
235600*      SEE COMMENTS BEFORE 3700-CHK-BEFORE-850-DEL-INACT          23560000
235700*---------------------------------------------------------------- 23570000
235800 3705-CHK-FOR-PROD-850-DEL.                                       23580000
235900     INITIALIZE PS-PO850-EXISTS-SW.                               23590000
236000                                                                  23600000
236100     PERFORM                                                      23610000
236200         WITH TEST AFTER                                          23620000
236300         VARYING PV-RETRY-COUNTER                                 23630000
236400         FROM 1 BY 1                                              23640000
236500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23650000
236600             OR (SQLCODE = +0)                                    23660000
236700             OR (SQLCODE = +100))                                 23670000
236800                                                                  23680000
236900         EXEC SQL                                                 23690000
237000             SELECT TP_DKEY                                       23700000
237100                  , TRAN_SET_CDE                                  23710000
237200                  , PROD_TEST_IND                                 23720000
237300                  , INACTV_DTE                                    23730000
237400               INTO :TRDTRN-TP-DKEY                               23740000
237500                  , :TRDTRN-TRAN-SET-CDE                          23750000
237600                  , :TRDTRN-PROD-TEST-IND                         23760000
237700                  , :TRDTRN-INACTV-DTE                            23770000
237800               FROM TTRDTRN                                       23780000
237900              WHERE TP_DKEY        = :ASC-KEY-TP-DKEY             23790000
238000                AND TRAN_SET_CDE = '850'                          23800000
238100                AND PROD_TEST_IND = 'P'                           23810000
238200                AND DIR_IND        = 'S'                          23820000
238300                AND INACTV_DTE = '9999-09-09'                     23830000
238400         END-EXEC                                                 23840000
238500                                                                  23850000
238600         EVALUATE TRUE                                            23860000
238700             WHEN SQLCODE = +0                                    23870000
238800                 SET PS-PC860-DOES-NOT-MATTER TO TRUE             23880000
238900                                                                  23890000
239000             WHEN SQLCODE = +100                                  23900000
239100                 SET PS-NO-PO850-EXISTS TO TRUE                   23910000
239200                                                                  23920000
239300             WHEN SQLCODE = -904                                  23930000
239400             WHEN SQLCODE = -913                                  23940000
239500                 CONTINUE                                         23950000
239600                                                                  23960000
239700             WHEN SQLWARN0 NOT = SPACES                           23970000
239800             WHEN SQLCODE < +0                                    23980000
239900             WHEN SQLCODE > +0                                    23990000
240000                 MOVE '3705-CHK-FOR-PROD-PO850-DEL'               24000000
240100                                   TO DP013-PARAGRAPH             24010000
240200                 MOVE 'SELECT A ROW ON TTRDTRN'                   24020000
240300                                   TO DP013-MESSAGE-TEXT(1)       24030000
240400                 MOVE SQLCA        TO DP013-SQLCA                 24040000
240500                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    24050000
240600                 SET DP013-DB2-ABEND                              24060000
240700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           24070000
240800                 PERFORM DP013-0000-PROCESS-ABEND                 24080000
240900         END-EVALUATE                                             24090000
241000     END-PERFORM.                                                 24100000
241100                                                                  24110000
241200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24120000
241300         MOVE '3705-CHK-FOR-PROD-PO850-DEL' TO DP013-PARAGRAPH    24130000
241400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              24140000
241500                                   TO DP013-MESSAGE-TEXT (1)      24150000
241600         MOVE 'TO SELECT A TTRDTRN ROW'                           24160000
241700                                   TO DP013-MESSAGE-TEXT (2)      24170000
241800         MOVE SQLCA                TO DP013-SQLCA                 24180000
241900         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    24190000
242000         SET DP013-DB2-ABEND                                      24200000
242100             DP013-XCTL-DISPLAY-RESTART                           24210000
242200                                   TO TRUE                        24220000
242300         PERFORM DP013-0000-PROCESS-ABEND                         24230000
242400     END-IF.                                                      24240000
242500                                                                  24250000
242600*---------------------------------------------------------------- 24260000
242700* CHECK IF A TEST 850 EXISTS                                      24270000
242800*      SEE COMMENTS BEFORE 3700-CHK-BEFORE-850-DEL-INACT          24280000
242900*---------------------------------------------------------------- 24290000
243000 3710-CHK-FOR-TEST-PO850-DEL.                                     24300000
243100     INITIALIZE PS-PO850-EXISTS-SW.                               24310000
243200                                                                  24320000
243300     PERFORM                                                      24330000
243400         WITH TEST AFTER                                          24340000
243500         VARYING PV-RETRY-COUNTER                                 24350000
243600         FROM 1 BY 1                                              24360000
243700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24370000
243800             OR ((SQLCODE = +0)                                   24380000
243900             OR  (SQLCODE = +100)))                               24390000
244000                                                                  24400000
244100         EXEC SQL                                                 24410000
244200             SELECT TP_DKEY                                       24420000
244300                  , TRAN_SET_CDE                                  24430000
244400                  , PROD_TEST_IND                                 24440000
244500                  , INACTV_DTE                                    24450000
244600               INTO :TRDTRN-TP-DKEY                               24460000
244700                  , :TRDTRN-TRAN-SET-CDE                          24470000
244800                  , :TRDTRN-PROD-TEST-IND                         24480000
244900                  , :TRDTRN-INACTV-DTE                            24490000
245000               FROM TTRDTRN                                       24500000
245100              WHERE TP_DKEY        = :ASC-KEY-TP-DKEY             24510000
245200                AND TRAN_SET_CDE = '850'                          24520000
245300                AND PROD_TEST_IND = 'T'                           24530000
245400                AND DIR_IND        = 'S'                          24540000
245500                AND INACTV_DTE = '9999-09-09'                     24550000
245600         END-EXEC                                                 24560000
245700                                                                  24570000
245800         EVALUATE TRUE                                            24580000
245900             WHEN SQLCODE = +0                                    24590000
246000                 SET PS-PO850-TEST-EXISTS TO TRUE                 24600000
246100                                                                  24610000
246200             WHEN SQLCODE = +100                                  24620000
246300                 SET PS-NO-PO850-EXISTS TO TRUE                   24630000
246400                                                                  24640000
246500             WHEN SQLCODE = -904                                  24650000
246600             WHEN SQLCODE = -913                                  24660000
246700                 CONTINUE                                         24670000
246800                                                                  24680000
246900             WHEN SQLWARN0 NOT = SPACES                           24690000
247000             WHEN SQLCODE < +0                                    24700000
247100             WHEN SQLCODE > +0                                    24710000
247200                 MOVE '3710-CHK-FOR-TEST-PO850-DEL'               24720000
247300                                   TO DP013-PARAGRAPH             24730000
247400                 MOVE 'SELECT A ROW ON TTRDTRN'                   24740000
247500                                   TO DP013-MESSAGE-TEXT(1)       24750000
247600                 MOVE SQLCA        TO DP013-SQLCA                 24760000
247700                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    24770000
247800                 SET DP013-DB2-ABEND                              24780000
247900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           24790000
248000                 PERFORM DP013-0000-PROCESS-ABEND                 24800000
248100         END-EVALUATE                                             24810000
248200     END-PERFORM.                                                 24820000
248300                                                                  24830000
248400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24840000
248500         MOVE '3710-CHK-FOR-TEST-PO850-DEL' TO DP013-PARAGRAPH    24850000
248600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              24860000
248700                                   TO DP013-MESSAGE-TEXT (1)      24870000
248800         MOVE 'TO SELECT A TTRDTRN ROW'                           24880000
248900                                   TO DP013-MESSAGE-TEXT (2)      24890000
249000         MOVE SQLCA                TO DP013-SQLCA                 24900000
249100         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    24910000
249200         SET DP013-DB2-ABEND                                      24920000
249300             DP013-XCTL-DISPLAY-RESTART                           24930000
249400                                   TO TRUE                        24940000
249500         PERFORM DP013-0000-PROCESS-ABEND                         24950000
249600     END-IF.                                                      24960000
249700                                                                  24970000
249800                                                                  24980000
249900*---------------------------------------------------------------- 24990000
250000* WHEN DELETING A ROW FROM TTRDTRN FOR A PO (850) CHECK IF        25000000
250100* A PRODUCTION  PC (860) RELATIONSHIP EXISTS                      25010000
250200*---------------------------------------------------------------- 25020000
250300 3715-CHK-FOR-PROD-PC860.                                         25030000
250400     PERFORM                                                      25040000
250500         WITH TEST AFTER                                          25050000
250600         VARYING PV-RETRY-COUNTER                                 25060000
250700         FROM 1 BY 1                                              25070000
250800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25080000
250900             OR (SQLCODE = +0)                                    25090000
251000             OR (SQLCODE = +100))                                 25100000
251100                                                                  25110000
251200         EXEC SQL                                                 25120000
251300             SELECT TP_DKEY                                       25130000
251400                  , TRAN_SET_CDE                                  25140000
251500                  , PROD_TEST_IND                                 25150000
251600                  , INACTV_DTE                                    25160000
251700               INTO :TRDTRN-TP-DKEY                               25170000
251800                  , :TRDTRN-TRAN-SET-CDE                          25180000
251900                  , :TRDTRN-PROD-TEST-IND                         25190000
252000                  , :TRDTRN-INACTV-DTE                            25200000
252100               FROM TTRDTRN                                       25210000
252200              WHERE TP_DKEY        = :ASC-KEY-TP-DKEY             25220000
252300                AND TRAN_SET_CDE   = '860'                        25230000
252400                AND PROD_TEST_IND  = 'P'                          25240000
252500                AND DIR_IND        = 'S'                          25250000
252600                AND INACTV_DTE     = '9999-09-09'                 25260000
252700         END-EXEC                                                 25270000
252800                                                                  25280000
252900         EVALUATE TRUE                                            25290000
253000             WHEN SQLCODE = +0                                    25300000
253100                 SET PS-PC860-PROD-EXISTS TO TRUE                 25310000
253200                                                                  25320000
253300             WHEN SQLCODE = +100                                  25330000
253400                 SET PS-NO-PC860-EXISTS TO TRUE                   25340000
253500                                                                  25350000
253600             WHEN SQLCODE = -904                                  25360000
253700             WHEN SQLCODE = -913                                  25370000
253800                 CONTINUE                                         25380000
253900                                                                  25390000
254000             WHEN SQLWARN0 NOT = SPACES                           25400000
254100             WHEN SQLCODE < +0                                    25410000
254200             WHEN SQLCODE > +0                                    25420000
254300                 MOVE '3715-CHK-FOR-PROD-PC860'                   25430000
254400                                   TO DP013-PARAGRAPH             25440000
254500                 MOVE 'SELECT A ROW ON TTRDTRN'                   25450000
254600                                   TO DP013-MESSAGE-TEXT(1)       25460000
254700                 MOVE SQLCA        TO DP013-SQLCA                 25470000
254800                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    25480000
254900                 SET DP013-DB2-ABEND                              25490000
255000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25500000
255100                 PERFORM DP013-0000-PROCESS-ABEND                 25510000
255200         END-EVALUATE                                             25520000
255300     END-PERFORM.                                                 25530000
255400                                                                  25540000
255500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25550000
255600         MOVE '3715-CHK-FOR-PROD-PC860' TO DP013-PARAGRAPH        25560000
255700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              25570000
255800                                   TO DP013-MESSAGE-TEXT (1)      25580000
255900         MOVE 'TO SELECT A TTRDTRN ROW'                           25590000
256000                                   TO DP013-MESSAGE-TEXT (2)      25600000
256100         MOVE SQLCA                TO DP013-SQLCA                 25610000
256200         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    25620000
256300         SET DP013-DB2-ABEND                                      25630000
256400             DP013-XCTL-DISPLAY-RESTART                           25640000
256500                                   TO TRUE                        25650000
256600         PERFORM DP013-0000-PROCESS-ABEND                         25660000
256700     END-IF.                                                      25670000
256800                                                                  25680000
256900*---------------------------------------------------------------- 25690000
257000* WHEN DELETING A ROW FROM TTRDTRN FOR A PO (850) CHECK IF THERE  25700000
257100* EXIST ANY PURCHASE ORDER CHANGE DOCUMENT PC (860) RELATIONSHIPS 25710000
257200*---------------------------------------------------------------- 25720000
257300 3720-CHK-FOR-ANY-PC860.                                          25730000
257400     PERFORM                                                      25740000
257500         WITH TEST AFTER                                          25750000
257600         VARYING PV-RETRY-COUNTER                                 25760000
257700         FROM 1 BY 1                                              25770000
257800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25780000
257900             OR (SQLCODE = +0)                                    25790000
258000             OR (SQLCODE = +100)                                  25800000
258100             OR (SQLCODE = -811))                                 25810000
258200                                                                  25820000
258300         EXEC SQL                                                 25830000
258400             SELECT TP_DKEY                                       25840000
258500                  , TRAN_SET_CDE                                  25850000
258600                  , PROD_TEST_IND                                 25860000
258700                  , INACTV_DTE                                    25870000
258800               INTO :TRDTRN-TP-DKEY                               25880000
258900                  , :TRDTRN-TRAN-SET-CDE                          25890000
259000                  , :TRDTRN-PROD-TEST-IND                         25900000
259100                  , :TRDTRN-INACTV-DTE                            25910000
259200               FROM TTRDTRN                                       25920000
259300              WHERE TP_DKEY        = :ASC-KEY-TP-DKEY             25930000
259400                AND TRAN_SET_CDE   = '860'                        25940000
259500                AND PROD_TEST_IND IN ('P', 'T')                   25950000
259600                AND DIR_IND        = 'S'                          25960000
259700                AND INACTV_DTE     = '9999-09-09'                 25970000
259800         END-EXEC                                                 25980000
259900                                                                  25990000
260000         EVALUATE TRUE                                            26000000
260100             WHEN SQLCODE = +0                                    26010000
260200             WHEN SQLCODE = -811                                  26020000
260300                 SET PS-PC860-ANY-EXISTS TO TRUE                  26030000
260400                                                                  26040000
260500             WHEN SQLCODE = +100                                  26050000
260600                 SET PS-NO-PC860-EXISTS TO TRUE                   26060000
260700                                                                  26070000
260800             WHEN SQLCODE = -904                                  26080000
260900             WHEN SQLCODE = -913                                  26090000
261000                 CONTINUE                                         26100000
261100                                                                  26110000
261200             WHEN SQLWARN0 NOT = SPACES                           26120000
261300             WHEN SQLCODE < +0                                    26130000
261400             WHEN SQLCODE > +0                                    26140000
261500                 MOVE '3720-CHK-FOR-ANY-PC860'                    26150000
261600                                   TO DP013-PARAGRAPH             26160000
261700                 MOVE 'SELECT A ROW ON TTRDTRN'                   26170000
261800                                   TO DP013-MESSAGE-TEXT(1)       26180000
261900                 MOVE SQLCA        TO DP013-SQLCA                 26190000
262000                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    26200000
262100                 SET DP013-DB2-ABEND                              26210000
262200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26220000
262300                 PERFORM DP013-0000-PROCESS-ABEND                 26230000
262400         END-EVALUATE                                             26240000
262500     END-PERFORM.                                                 26250000
262600                                                                  26260000
262700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26270000
262800         MOVE '3720-CHK-FOR-ANY-PC860' TO DP013-PARAGRAPH         26280000
262900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              26290000
263000                                   TO DP013-MESSAGE-TEXT (1)      26300000
263100         MOVE 'TO SELECT A TTRDTRN ROW'                           26310000
263200                                   TO DP013-MESSAGE-TEXT (2)      26320000
263300         MOVE SQLCA                TO DP013-SQLCA                 26330000
263400         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    26340000
263500         SET DP013-DB2-ABEND                                      26350000
263600             DP013-XCTL-DISPLAY-RESTART                           26360000
263700                                   TO TRUE                        26370000
263800         PERFORM DP013-0000-PROCESS-ABEND                         26380000
263900     END-IF.                                                      26390000
264000                                                                  26400000
264100/                                                                 26410000
264200*---------------------------------------------------------------- 26420000
264300*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST      26430000
264400*    ENTRY.                                                       26440000
264500*---------------------------------------------------------------- 26450000
264600                                                                  26460000
264700 4000-BUILD-INITIAL-PANEL.                                        26470000
264800                                                                  26480000
264900     INITIALIZE DCLTTRDTRN                                        26490000
265000                DCLTTRNSET                                        26500000
265100                DCLTTRNVER                                        26510000
265200                DK-DB2-KEYS                                       26520000
265300                ASC-NEWLY-ENTERED-FIELDS                          26530000
265400                ASC-ORIGINAL-FIELD-VALUES.                        26540000
265500                                                                  26550000
265600     IF ASC-ADD-PENDING                                           26560000
265700         INITIALIZE ASC-KEY-TRAN-SET-CDE                          26570000
265800                    ASC-TRAN-SET-NME                              26580000
265900                    ASC-KEY-PROD-TEST-IND                         26590000
266000                    ASC-COMM-MTHD-NEW                             26600000
266100                    ASC-VER-NBR-NEW                               26610000
266200                    ASC-COMM-MTHD-NME                             26620000
266300                    ASC-VER-NME                                   26630000
266400     END-IF                                                       26640000
266500                                                                  26650000
266600     EXEC SQL                                                     26660000
266700         SET :ASC-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           26670000
266800     END-EXEC                                                     26680000
266900                                                                  26690000
267000     EVALUATE TRUE                                                26700000
267100         WHEN SQLCODE = 0                                         26710000
267200             CONTINUE                                             26720000
267300         WHEN OTHER                                               26730000
267400             MOVE '4000-BUILD-INITIAL-PANEL'                      26740000
267500                          TO DP013-PARAGRAPH                      26750000
267600             MOVE 'SET VARIABLE TO CURRENT TIMESTAMP'             26760000
267700                          TO DP013-MESSAGE-TEXT(1)                26770000
267800             MOVE SQLCA   TO DP013-SQLCA                          26780000
267900             MOVE 'N/A    '                                       26790000
268000                          TO DP013-DB2-TABLE-NAME (1)             26800000
268100             SET DP013-DB2-ABEND                                  26810000
268200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26820000
268300             PERFORM DP013-0000-PROCESS-ABEND                     26830000
268400     END-EVALUATE                                                 26840000
268500                                                                  26850000
268600     MOVE ASC-KEY-TP-DKEY        TO DK-TP-DKEY                    26860000
268700     MOVE ASC-KEY-DIR-IND        TO DK-DIR-IND                    26870000
268800     MOVE ASC-KEY-TRAN-SET-CDE   TO DK-TRAN-SET-CDE               26880000
268900     MOVE ASC-KEY-PROD-TEST-IND  TO DK-PROD-TEST-IND              26890000
269000                                                                  26900000
269100     PERFORM 4010-GET-TTRDTRN.                                    26910000
269200                                                                  26920000
269300     IF ASC-ADD-PENDING                                           26930000
269400         MOVE SPACE              TO ASC-INACTV-DTE-NEW            26940000
269500         MOVE ASC-CURRENT-DATE   TO ASC-LAST-CHG-DTE              26950000
269600                                    ASC-SETUP-DTE                 26960000
269700                                    ASC-ACTV-DTE-NEW              26970000
269800                                    ASC-VER-CHG-DTE               26980000
269900         MOVE DP020-USERID       TO ASC-LAST-CHG-UID              26990000
270000         MOVE 'V' TO ASC-COMM-MTHD-NEW                            27000000
270100         MOVE 'VAN  ' TO ASC-COMM-MTHD-NME                        27010000
270200     END-IF                                                       27020000
270300                                                                  27030000
270400     IF SQLCODE = +100                                            27040000
270500         IF ASC-UPDATE-PENDING OR                                 27050000
270600            ASC-DELETE-PENDING                                    27060000
270700             SET PS-ERROR                                         27070000
270800                 DP020-MSG-FATAL                                  27080000
270900                 DP030-SET-CURSOR-TRAILER TO TRUE                 27090000
271000*-->         ** DETAIL DOESN'T EXIST **                           27100000
271100             IF ASC-UPDATE-PENDING                                27110000
271200                 MOVE PC-TSYMSG-00134    TO DP020-MSG-NUMBER      27120000
271300             ELSE                                                 27130000
271400                 SET ASC-DELETE-SUCCESSFUL TO TRUE                27140000
271500                 MOVE PC-TSYMSG-00116    TO DP020-MSG-NUMBER      27150000
271600             END-IF                                               27160000
271700         END-IF                                                   27170000
271800     ELSE                                                         27180000
271900         IF  ASC-DELETE-PENDING                                   27190000
272000             MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER            27200000
272100             SET DP020-MSG-INFORMATIONAL                          27210000
272200                                   TO TRUE                        27220000
272300             IF  ASC-DELETE-SUCCESSFUL                            27230000
272400                 MOVE SPACES       TO ASC-DELETE-SUCCESSFUL-SW    27240000
272500             END-IF                                               27250000
272600         END-IF                                                   27260000
272700     END-IF.                                                      27270000
272800                                                                  27280000
272900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        27290000
273000/                                                                 27300000
273100 4010-GET-TTRDTRN.                                                27310000
273200*----------------------------------------------------------------*27320000
273300*  RETRIEVE THE ROW ASSOCIATED W/ THE DK- FIELDS                  27330000
273400*----------------------------------------------------------------*27340000
273500                                                                  27350000
273600     PERFORM                                                      27360000
273700         WITH TEST AFTER                                          27370000
273800         VARYING PV-RETRY-COUNTER                                 27380000
273900         FROM 1 BY 1                                              27390000
274000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27400000
274100             OR (SQLCODE = +0)                                    27410000
274200             OR (SQLCODE = +100))                                 27420000
274300                                                                  27430000
274400         EXEC SQL                                                 27440000
274500              SELECT  VER_NBR                                     27450000
274600                     ,ACTV_DTE                                    27460000
274700                     ,INACTV_DTE                                  27470000
274800                     ,NOTES_TXT                                   27480000
274900                     ,LAST_CHG_DTE                                27490000
275000                     ,LAST_CHG_UID                                27500000
275100                     ,SETUP_DTE                                   27510000
275200                     ,LAST_CALL_DTE                               27520000
275300                     ,NEXT_CALL_DTE                               27530000
275400                     ,VER_CHG_DTE                                 27540000
275500                     ,COM_MTHD_CDE                                27550000
275600                INTO :TRDTRN-VER-NBR                              27560000
275700                    ,:TRDTRN-ACTV-DTE                             27570000
275800                    ,:TRDTRN-INACTV-DTE                           27580000
275900                    ,:TRDTRN-NOTES-TXT                            27590000
276000                    ,:TRDTRN-LAST-CHG-DTE                         27600000
276100                    ,:TRDTRN-LAST-CHG-UID                         27610000
276200                    ,:TRDTRN-SETUP-DTE                            27620000
276300                    ,:TRDTRN-LAST-CALL-DTE                        27630000
276400                    ,:TRDTRN-NEXT-CALL-DTE                        27640000
276500                    ,:TRDTRN-VER-CHG-DTE                          27650000
276600                    ,:TRDTRN-COM-MTHD-CDE                         27660000
276700                FROM TTRDTRN                                      27670000
276800               WHERE TP_DKEY       = :DK-TP-DKEY                  27680000
276900                 AND TRAN_SET_CDE  = :DK-TRAN-SET-CDE             27690000
277000                 AND PROD_TEST_IND = :DK-PROD-TEST-IND            27700000
277100                 AND DIR_IND       = :DK-DIR-IND                  27710000
277200         END-EXEC                                                 27720000
277300                                                                  27730000
277400         EVALUATE TRUE                                            27740000
277500             WHEN SQLCODE = +0                                    27750000
277600             WHEN SQLCODE = +100                                  27760000
277700             WHEN SQLCODE = -904                                  27770000
277800             WHEN SQLCODE = -913                                  27780000
277900                  CONTINUE                                        27790000
278000                                                                  27800000
278100             WHEN SQLWARN0 NOT = SPACES                           27810000
278200             WHEN SQLCODE < +0                                    27820000
278300             WHEN SQLCODE > +0                                    27830000
278400                  MOVE '4010-GET-TRDTRN'                          27840000
278500                                  TO DP013-PARAGRAPH              27850000
278600                  MOVE 'UNSUCCESSFUL SELECT TRDTRN'               27860000
278700                                  TO DP013-MESSAGE-TEXT (1)       27870000
278800                  MOVE SQLCA      TO DP013-SQLCA                  27880000
278900                  MOVE 'TRDTRN  ' TO DP013-DB2-TABLE-NAME (1)     27890000
279000                  SET DP013-DB2-ABEND                             27900000
279100                      DP013-XCTL-DISPLAY-RESTART                  27910000
279200                                  TO TRUE                         27920000
279300                  PERFORM DP013-0000-PROCESS-ABEND                27930000
279400         END-EVALUATE                                             27940000
279500     END-PERFORM.                                                 27950000
279600                                                                  27960000
279700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27970000
279800         MOVE '4010-GET-TRDTRN'   TO DP013-PARAGRAPH              27980000
279900         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    27990000
280000                                  TO DP013-MESSAGE-TEXT (1)       28000000
280100         MOVE SQLCA               TO DP013-SQLCA                  28010000
280200         MOVE 'TTRDTRN '          TO DP013-DB2-TABLE-NAME (1)     28020000
280300         SET DP013-DB2-ABEND                                      28030000
280400             DP013-XCTL-DISPLAY-RESTART                           28040000
280500                                  TO TRUE                         28050000
280600         PERFORM DP013-0000-PROCESS-ABEND                         28060000
280700     END-IF.                                                      28070000
280800                                                                  28080000
280900     IF SQLCODE = +0                                              28090000
281000         PERFORM 4020-GET-TRAN-DESC                               28100000
281100         MOVE TRDTRN-VER-NBR    TO DK-VER-NBR                     28110000
281200         PERFORM 4030-GET-VERSION-NAME                            28120000
281300     END-IF                                                       28130000
281400                                                                  28140000
281500     IF ASC-ADD-PENDING                                           28150000
281600         CONTINUE                                                 28160000
281700     ELSE                                                         28170000
281800         MOVE TRDTRN-COM-MTHD-CDE   TO ASC-COMM-MTHD-NEW          28180000
281900         MOVE TRDTRN-VER-NBR        TO ASC-VER-NBR-NEW            28190000
282000         IF TRDTRN-ACTV-DTE = PC-NULL-DATE                        28200000
282100             MOVE SPACE             TO ASC-ACTV-DTE-NEW           28210000
282200         ELSE                                                     28220000
282300             MOVE TRDTRN-ACTV-DTE   TO ASC-ACTV-DTE-NEW           28230000
282400         END-IF                                                   28240000
282500         IF TRDTRN-INACTV-DTE = PC-NULL-DATE                      28250000
282600             MOVE SPACE             TO ASC-INACTV-DTE-NEW         28260000
282700         ELSE                                                     28270000
282800             MOVE TRDTRN-INACTV-DTE TO ASC-INACTV-DTE-NEW         28280000
282900         END-IF                                                   28290000
283000         MOVE TRDTRN-NOTES-TXT      TO ASC-NOTES-TXT-NEW          28300000
283100         MOVE TRDTRN-LAST-CHG-DTE   TO ASC-LAST-CHG-DTE           28310000
283200         MOVE TRDTRN-LAST-CHG-UID   TO ASC-LAST-CHG-UID           28320000
283300         MOVE TRDTRN-SETUP-DTE      TO ASC-SETUP-DTE              28330000
283400         IF TRDTRN-LAST-CALL-DTE = PC-NULL-DATE                   28340000
283500             MOVE SPACE             TO ASC-LAST-CALL-DTE-NEW      28350000
283600         ELSE                                                     28360000
283700             MOVE TRDTRN-LAST-CALL-DTE                            28370000
283800                                    TO ASC-LAST-CALL-DTE-NEW      28380000
283900         END-IF                                                   28390000
284000         IF TRDTRN-NEXT-CALL-DTE = PC-NULL-DATE                   28400000
284100             MOVE SPACE             TO ASC-NEXT-CALL-DTE-NEW      28410000
284200         ELSE                                                     28420000
284300             MOVE TRDTRN-NEXT-CALL-DTE                            28430000
284400                                    TO ASC-NEXT-CALL-DTE-NEW      28440000
284500         END-IF                                                   28450000
284600         MOVE TRDTRN-VER-CHG-DTE    TO ASC-VER-CHG-DTE            28460000
284700         MOVE TRNSET-TRAN-SET-NME   TO ASC-TRAN-SET-NME           28470000
284800         MOVE TRNVER-VER-NME        TO ASC-VER-NME                28480000
284900         IF TRDTRN-COM-MTHD-CDE = 'F'                             28490000
285000             MOVE 'FTP  ' TO ASC-COMM-MTHD-NME                    28500000
285100         ELSE                                                     28510000
285200             IF TRDTRN-COM-MTHD-CDE = 'E'                         28520000
285300                 MOVE 'EMAIL' TO ASC-COMM-MTHD-NME                28530000
285400             ELSE                                                 28540000
285500                 IF TRDTRN-COM-MTHD-CDE = 'A'                     28550000
285600                     MOVE 'AS2  ' TO ASC-COMM-MTHD-NME            28560000
285700                 ELSE                                             28570000
285800                     MOVE 'VAN  ' TO ASC-COMM-MTHD-NME            28580000
285900                 END-IF                                           28590000
286000             END-IF                                               28600000
286100         END-IF                                                   28610000
286200     END-IF.                                                      28620000
286300/                                                                 28630000
286400 4020-GET-TRAN-DESC.                                              28640000
286500                                                                  28650000
286600     PERFORM                                                      28660000
286700         WITH TEST AFTER                                          28670000
286800         VARYING PV-RETRY-COUNTER                                 28680000
286900         FROM 1 BY 1                                              28690000
287000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28700000
287100             OR (SQLCODE = +0)                                    28710000
287200             OR (SQLCODE = +100))                                 28720000
287300                                                                  28730000
287400         EXEC SQL                                                 28740000
287500              SELECT   TRAN_SET_NME                               28750000
287600                INTO  :TRNSET-TRAN-SET-NME                        28760000
287700                FROM TTRNSET                                      28770000
287800               WHERE TRAN_SET_CDE =:DK-TRAN-SET-CDE               28780000
287900                 AND FUNC_CDE     =:ASC-FUNC-CDE                  28790000
288000         END-EXEC                                                 28800000
288100                                                                  28810000
288200         EVALUATE TRUE                                            28820000
288300             WHEN SQLCODE = +0                                    28830000
288400             WHEN SQLCODE = +100                                  28840000
288500             WHEN SQLCODE = -904                                  28850000
288600             WHEN SQLCODE = -913                                  28860000
288700                  CONTINUE                                        28870000
288800                                                                  28880000
288900             WHEN SQLWARN0 NOT = SPACES                           28890000
289000             WHEN SQLCODE < +0                                    28900000
289100             WHEN SQLCODE > +0                                    28910000
289200                  MOVE '4020-GET-TRNSET'                          28920000
289300                                  TO DP013-PARAGRAPH              28930000
289400                  MOVE 'UNSUCCESSFUL SELECT'                      28940000
289500                                  TO DP013-MESSAGE-TEXT (1)       28950000
289600                  MOVE SQLCA      TO DP013-SQLCA                  28960000
289700                  MOVE 'TRNSET  ' TO DP013-DB2-TABLE-NAME (1)     28970000
289800                  SET DP013-DB2-ABEND                             28980000
289900                      DP013-XCTL-DISPLAY-RESTART                  28990000
290000                                  TO TRUE                         29000000
290100                  PERFORM DP013-0000-PROCESS-ABEND                29010000
290200         END-EVALUATE                                             29020000
290300     END-PERFORM.                                                 29030000
290400                                                                  29040000
290500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29050000
290600         MOVE '4020-GET-TTRNSET'  TO DP013-PARAGRAPH              29060000
290700         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    29070000
290800                                  TO DP013-MESSAGE-TEXT (1)       29080000
290900         MOVE SQLCA               TO DP013-SQLCA                  29090000
291000         MOVE 'TTRNSET '          TO DP013-DB2-TABLE-NAME (1)     29100000
291100         SET DP013-DB2-ABEND                                      29110000
291200             DP013-XCTL-DISPLAY-RESTART                           29120000
291300                                  TO TRUE                         29130000
291400         PERFORM DP013-0000-PROCESS-ABEND                         29140000
291500     END-IF.                                                      29150000
291600                                                                  29160000
291700/                                                                 29170000
291800 4030-GET-VERSION-NAME.                                           29180000
291900                                                                  29190000
292000     PERFORM                                                      29200000
292100         WITH TEST AFTER                                          29210000
292200         VARYING PV-RETRY-COUNTER                                 29220000
292300         FROM 1 BY 1                                              29230000
292400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29240000
292500             OR (SQLCODE = +0)                                    29250000
292600             OR (SQLCODE = +100))                                 29260000
292700                                                                  29270000
292800         EXEC SQL                                                 29280000
292900              SELECT   VER_NME                                    29290000
293000                      ,ACTV_DTE                                   29300000
293100                      ,INACTV_DTE                                 29310000
293200                INTO  :TRNVER-VER-NME                             29320000
293300                     ,:TRNVER-ACTV-DTE                            29330000
293400                     ,:TRNVER-INACTV-DTE                          29340000
293500                FROM TTRNVER                                      29350000
293600               WHERE TRAN_SET_CDE = :DK-TRAN-SET-CDE              29360000
293700                 AND VER_NBR      = :DK-VER-NBR                   29370000
293800         END-EXEC                                                 29380000
293900                                                                  29390000
294000         EVALUATE TRUE                                            29400000
294100             WHEN SQLCODE = +0                                    29410000
294200             WHEN SQLCODE = +100                                  29420000
294300             WHEN SQLCODE = -904                                  29430000
294400             WHEN SQLCODE = -913                                  29440000
294500                  CONTINUE                                        29450000
294600                                                                  29460000
294700             WHEN SQLWARN0 NOT = SPACES                           29470000
294800             WHEN SQLCODE < +0                                    29480000
294900             WHEN SQLCODE > +0                                    29490000
295000                  MOVE '4030-GET-TRNVER'                          29500000
295100                                  TO DP013-PARAGRAPH              29510000
295200                  MOVE 'UNSUCCESSFUL SELECT'                      29520000
295300                                  TO DP013-MESSAGE-TEXT (1)       29530000
295400                  MOVE SQLCA      TO DP013-SQLCA                  29540000
295500                  MOVE 'TRDTRN  ' TO DP013-DB2-TABLE-NAME (1)     29550000
295600                  SET DP013-DB2-ABEND                             29560000
295700                      DP013-XCTL-DISPLAY-RESTART                  29570000
295800                                  TO TRUE                         29580000
295900                  PERFORM DP013-0000-PROCESS-ABEND                29590000
296000         END-EVALUATE                                             29600000
296100     END-PERFORM.                                                 29610000
296200                                                                  29620000
296300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29630000
296400         MOVE '4030-GET-TTRNVER'  TO DP013-PARAGRAPH              29640000
296500         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    29650000
296600                                  TO DP013-MESSAGE-TEXT (1)       29660000
296700         MOVE SQLCA               TO DP013-SQLCA                  29670000
296800         MOVE 'TTRNVER '          TO DP013-DB2-TABLE-NAME (1)     29680000
296900         SET DP013-DB2-ABEND                                      29690000
297000             DP013-XCTL-DISPLAY-RESTART                           29700000
297100                                  TO TRUE                         29710000
297200         PERFORM DP013-0000-PROCESS-ABEND                         29720000
297300     END-IF.                                                      29730000
297400                                                                  29740000
297500/                                                                 29750000
297600*---------------------------------------------------------------- 29760000
297700* SELECT A TRADING PARTNERSHIP                                    29770000
297800*---------------------------------------------------------------- 29780000
297900 4035-GET-TTRDPRT-ACTV-DTES.                                      29790000
298000                                                                  29800000
298100     PERFORM                                                      29810000
298200         WITH TEST AFTER                                          29820000
298300         VARYING PV-RETRY-COUNTER                                 29830000
298400         FROM 1 BY 1                                              29840000
298500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29850000
298600            OR (SQLCODE = +0))                                    29860000
298700                                                                  29870000
298800         EXEC SQL                                                 29880000
298900             SELECT    ACTV_DTE                                   29890000
299000                     , INACTV_DTE                                 29900000
299100             INTO     :TRDPRT-ACTV-DTE                            29910000
299200                    , :TRDPRT-INACTV-DTE                          29920000
299300             FROM      TTRDPRT                                    29930000
299400             WHERE     TP_DKEY = :DK-TP-DKEY                      29940000
299500         END-EXEC                                                 29950000
299600                                                                  29960000
299700         EVALUATE TRUE                                            29970000
299800             WHEN SQLCODE = +0                                    29980000
299900             WHEN SQLCODE = -904                                  29990000
300000             WHEN SQLCODE = -913                                  30000000
300100                 CONTINUE                                         30010000
300200                                                                  30020000
300300             WHEN SQLWARN0 NOT = SPACES                           30030000
300400             WHEN SQLCODE < ZERO                                  30040000
300500             WHEN SQLCODE > ZERO                                  30050000
300600                 MOVE '4035-GET-TTRDPRT-ACTV-DTES'                30060000
300700                                   TO DP013-PARAGRAPH             30070000
300800                 MOVE 'SELECT ON TTRDPRT'                         30080000
300900                                   TO DP013-MESSAGE-TEXT (1)      30090000
301000                 MOVE SQLCA        TO DP013-SQLCA                 30100000
301100                 MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    30110000
301200                 SET DP013-DB2-ABEND                              30120000
301300                     DP013-XCTL-DISPLAY-RESTART                   30130000
301400                                   TO TRUE                        30140000
301500                 PERFORM DP013-0000-PROCESS-ABEND                 30150000
301600         END-EVALUATE                                             30160000
301700     END-PERFORM.                                                 30170000
301800                                                                  30180000
301900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30190000
302000         MOVE '4035-GET-TTRDPRT-ACTV-DTES'                        30200000
302100                                   TO DP013-PARAGRAPH             30210000
302200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30220000
302300                                   TO DP013-MESSAGE-TEXT (1)      30230000
302400         MOVE 'A TTRDPRT ROW   '   TO DP013-MESSAGE-TEXT (2)      30240000
302500         MOVE SQLCA                TO DP013-SQLCA                 30250000
302600         MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    30260000
302700         SET DP013-DB2-ABEND                                      30270000
302800             DP013-XCTL-DISPLAY-RESTART                           30280000
302900                                   TO TRUE                        30290000
303000         PERFORM DP013-0000-PROCESS-ABEND                         30300000
303100     END-IF.                                                      30310000
303200                                                                  30320000
303300*----------------------------------------------------------------*30330000
303400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *30340000
303500*----------------------------------------------------------------*30350000
303600                                                                  30360000
303700 4400-MOVE-COMMAREA-TO-SCREEN.                                    30370000
303800                                                                  30380000
303900     MOVE ASC-VENDOR-NAME                     TO VNDRNMEO         30390000
304000     MOVE ASC-VEND-INCHG-QUAL                 TO VTPIDQO          30400000
304100     MOVE ASC-VEND-INCHG-ID                   TO VTPIDO           30410000
304200     MOVE ASC-NETWK-ID                        TO NTWKCDEO         30420000
304300     MOVE ASC-NETWORK-NAME                    TO NTWKNMEO         30430000
304400     MOVE ASC-KEY-TRAN-SET-CDE                TO TSETO            30440000
304500     MOVE ASC-TRAN-SET-NME                    TO TSETNMEO         30450000
304600     MOVE ASC-KEY-PROD-TEST-IND               TO PRDTSTO          30460000
304700     MOVE ASC-COMM-MTHD-NEW                   TO COMMTHO          30470000
304800     MOVE ASC-COMM-MTHD-NME                   TO COMNMEO          30480000
304900     MOVE ASC-KEY-DIR-IND                     TO DIRO             30490000
305000     MOVE ASC-VER-NBR-NEW                     TO VERNBRO          30500000
305100     MOVE ASC-VER-NME                         TO VERNMEO          30510000
305200                                                                  30520000
305300     IF ASC-VER-CHG-DTE  = PC-NULL-DATE                           30530000
305400         MOVE ASC-SETUP-DTE                   TO VERDTEO          30540000
305500     END-IF                                                       30550000
305600                                                                  30560000
305700     STRING ASC-VER-CHG-DTE-MM DELIMITED BY SIZE                  30570000
305800            ' '                 DELIMITED BY SIZE                 30580000
305900            ASC-VER-CHG-DTE-DD DELIMITED BY SIZE                  30590000
306000            ' '                 DELIMITED BY SIZE                 30600000
306100            ASC-VER-CHG-DTE-YY DELIMITED BY SIZE                  30610000
306200                                            INTO VERDTEO          30620000
306300                                                                  30630000
306400     IF ASC-LAST-CHG-DTE = PC-NULL-DATE                           30640000
306500         MOVE SPACES                          TO LCHGDTEO         30650000
306600     ELSE                                                         30660000
306700         STRING ASC-LAST-CHG-DTE-MM DELIMITED BY SIZE             30670000
306800                ' '                 DELIMITED BY SIZE             30680000
306900                ASC-LAST-CHG-DTE-DD DELIMITED BY SIZE             30690000
307000                ' '                 DELIMITED BY SIZE             30700000
307100                ASC-LAST-CHG-DTE-YY DELIMITED BY SIZE             30710000
307200                                            INTO LCHGDTEO         30720000
307300     END-IF                                                       30730000
307400                                                                  30740000
307500     MOVE ASC-LAST-CHG-UID                    TO LCHGUIDO         30750000
307600                                                                  30760000
307700     STRING ASC-SETUP-DTE-MM    DELIMITED BY SIZE                 30770000
307800            ' '                 DELIMITED BY SIZE                 30780000
307900            ASC-SETUP-DTE-DD    DELIMITED BY SIZE                 30790000
308000            ' '                 DELIMITED BY SIZE                 30800000
308100            ASC-SETUP-DTE-YY    DELIMITED BY SIZE                 30810000
308200                                INTO SETDTEO                      30820000
308300                                                                  30830000
308400     MOVE ASC-ACTV-DTE-MM-NEW       TO ACTVMTHO                   30840000
308500     MOVE ASC-ACTV-DTE-DD-NEW       TO ACTVDAYO                   30850000
308600     MOVE ASC-ACTV-DTE-YY-NEW       TO ACTVYRO                    30860000
308700                                                                  30870000
308800     MOVE ASC-INACTV-DTE-MM-NEW     TO INACTVMO                   30880000
308900     MOVE ASC-INACTV-DTE-DD-NEW     TO INACTVDO                   30890000
309000     MOVE ASC-INACTV-DTE-YY-NEW     TO INACTVYO                   30900000
309100                                                                  30910000
309200     MOVE ASC-LAST-CALL-DTE-MM-NEW  TO LCALMTHO                   30920000
309300     MOVE ASC-LAST-CALL-DTE-DD-NEW  TO LCALDAYO                   30930000
309400     MOVE ASC-LAST-CALL-DTE-YY-NEW  TO LCALYRO                    30940000
309500                                                                  30950000
309600     MOVE ASC-NEXT-CALL-DTE-MM-NEW  TO NCALMTHO                   30960000
309700     MOVE ASC-NEXT-CALL-DTE-DD-NEW  TO NCALDAYO                   30970000
309800     MOVE ASC-NEXT-CALL-DTE-YY-NEW  TO NCALYRO                    30980000
309900                                                                  30990000
310000     MOVE ASC-NOTES-TXT1-NEW            TO NOTE1O                 31000000
310100     MOVE ASC-NOTES-TXT2-NEW            TO NOTE2O                 31010000
310200                                                                  31020000
310300     IF PS-NO-ERROR                                               31030000
310400         IF ASC-DELETE-PENDING                                    31040000
310500             SET DP030-SET-CURSOR-TRAILER                         31050000
310600                                        TO TRUE                   31060000
310700         ELSE                                                     31070000
310800             SET DP030-SET-CURSOR-APPL-1                          31080000
310900                                        TO TRUE                   31090000
311000             IF ASC-ADD-PENDING                                   31100000
311100                 MOVE -1                TO TSETL                  31110000
311200             ELSE                                                 31120000
311300                 MOVE -1                TO COMMTHL                31130000
311400             END-IF                                               31140000
311500         END-IF                                                   31150000
311600     END-IF.                                                      31160000
311700/                                                                 31170000
311800*---------------------------------------------------------------- 31180000
311900* ADD A TRADING PARTNER RELATIONSHIP                              31190000
312000*---------------------------------------------------------------- 31200000
312100 5000-ADD-TTRDTRN.                                                31210000
312200                                                                  31220000
312300     PERFORM 6100-PREPARE-TTRDTRN.                                31230000
312400                                                                  31240000
312500     PERFORM                                                      31250000
312600         WITH TEST AFTER                                          31260000
312700         VARYING PV-RETRY-COUNTER                                 31270000
312800         FROM 1 BY 1                                              31280000
312900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31290000
313000             OR (SQLCODE = +0))                                   31300000
313100         EXEC SQL                                                 31310000
313200             INSERT INTO TTRDTRN                                  31320000
313300                          (TP_DKEY                                31330000
313400                          ,TRAN_SET_CDE                           31340000
313500                          ,PROD_TEST_IND                          31350000
313600                          ,DIR_IND                                31360000
313700                          ,FUNC_CDE                               31370000
313800                          ,VER_NBR                                31380000
313900                          ,ACTV_DTE                               31390000
314000                          ,INACTV_DTE                             31400000
314100                          ,NOTES_TXT                              31410000
314200                          ,LAST_CHG_DTE                           31420000
314300                          ,LAST_CHG_UID                           31430000
314400                          ,SETUP_DTE                              31440000
314500                          ,LAST_CALL_DTE                          31450000
314600                          ,NEXT_CALL_DTE                          31460000
314700                          ,VER_CHG_DTE                            31470000
314800                          ,COM_MTHD_CDE)                          31480000
314900                 VALUES                                           31490000
315000                                                                  31500000
315100                         (:TRDTRN-TP-DKEY                         31510000
315200                         ,:TRDTRN-TRAN-SET-CDE                    31520000
315300                         ,:TRDTRN-PROD-TEST-IND                   31530000
315400                         ,:TRDTRN-DIR-IND                         31540000
315500                         ,:TRDTRN-FUNC-CDE                        31550000
315600                         ,:TRDTRN-VER-NBR                         31560000
315700                         ,:TRDTRN-ACTV-DTE                        31570000
315800                         ,:TRDTRN-INACTV-DTE                      31580000
315900                         ,:TRDTRN-NOTES-TXT                       31590000
316000                         ,:TRDTRN-LAST-CHG-DTE                    31600000
316100                         ,:TRDTRN-LAST-CHG-UID                    31610000
316200                         ,:TRDTRN-SETUP-DTE                       31620000
316300                         ,:TRDTRN-LAST-CALL-DTE                   31630000
316400                         ,:TRDTRN-NEXT-CALL-DTE                   31640000
316500                         ,:TRDTRN-VER-CHG-DTE                     31650000
316600                         ,:TRDTRN-COM-MTHD-CDE)                   31660000
316700         END-EXEC                                                 31670000
316800                                                                  31680000
316900         EVALUATE TRUE                                            31690000
317000             WHEN SQLCODE = +0                                    31700000
317100             WHEN SQLCODE = -904                                  31710000
317200             WHEN SQLCODE = -913                                  31720000
317300                 CONTINUE                                         31730000
317400                                                                  31740000
317500                                                                  31750000
317600             WHEN SQLWARN0 NOT = SPACES                           31760000
317700             WHEN SQLCODE < +0                                    31770000
317800             WHEN SQLCODE > +0                                    31780000
317900                 MOVE '5000-ADD-TTRDTRN'                          31790000
318000                                   TO DP013-PARAGRAPH             31800000
318100                 MOVE 'INSERT A ROW ON TTRDTRN'                   31810000
318200                                   TO DP013-MESSAGE-TEXT(1)       31820000
318300                 MOVE SQLCA        TO DP013-SQLCA                 31830000
318400                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    31840000
318500                 SET DP013-DB2-ABEND                              31850000
318600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           31860000
318700                 PERFORM DP013-0000-PROCESS-ABEND                 31870000
318800         END-EVALUATE                                             31880000
318900     END-PERFORM.                                                 31890000
319000                                                                  31900000
319100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31910000
319200         MOVE '5000-ADD-TTRDTRN'   TO DP013-PARAGRAPH             31920000
319300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              31930000
319400                                   TO DP013-MESSAGE-TEXT (1)      31940000
319500         MOVE 'TO INSERT A TTRDTRN ROW'                           31950000
319600                                   TO DP013-MESSAGE-TEXT (2)      31960000
319700         MOVE SQLCA                TO DP013-SQLCA                 31970000
319800         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    31980000
319900         SET DP013-DB2-ABEND                                      31990000
320000             DP013-XCTL-DISPLAY-RESTART                           32000000
320100                                   TO TRUE                        32010000
320200         PERFORM DP013-0000-PROCESS-ABEND                         32020000
320300     END-IF.                                                      32030000
320400                                                                  32040000
320500     MOVE PC-TSYMSG-00034    TO DP020-MSG-NUMBER                  32050000
320600     SET DP020-MSG-INFORMATIONAL TO TRUE.                         32060000
320700                                                                  32070000
320800/                                                                 32080000
320900*---------------------------------------------------------------- 32090000
321000* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS   32100000
321100* OBJECT WAS UPDATED.                                             32110000
321200*---------------------------------------------------------------- 32120000
321300                                                                  32130000
321400 5200-UPDATE-SELECTION-QUEUE.                                     32140000
321500                                                                  32150000
321600     PERFORM 9100-READ-SEL-QUEUE.                                 32160000
321700                                                                  32170000
321800     IF  ASC-DELETE-SUCCESSFUL                                    32180000
321900         SET ET301-DEL (ASC-SEL-SUB)     TO TRUE                  32190000
322000     ELSE                                                         32200000
322100         SET ET301-UPD (ASC-SEL-SUB)     TO TRUE                  32210000
322200     END-IF.                                                      32220000
322300                                                                  32230000
322400     PERFORM 9200-REWRITE-LIST-QUEUE.                             32240000
322500                                                                  32250000
322600/                                                                 32260000
322700*---------------------------------------------------------------- 32270000
322800* UPDATE A TRADING PARTNERSHIP ROW                                32280000
322900*---------------------------------------------------------------- 32290000
323000 6000-UPDATE-TTRDTRN.                                             32300000
323100                                                                  32310000
323200     PERFORM 6100-PREPARE-TTRDTRN.                                32320000
323300                                                                  32330000
323400     PERFORM                                                      32340000
323500         WITH TEST AFTER                                          32350000
323600         VARYING PV-RETRY-COUNTER                                 32360000
323700         FROM 1 BY 1                                              32370000
323800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32380000
323900             OR (SQLCODE = +0))                                   32390000
324000                                                                  32400000
324100         EXEC SQL                                                 32410000
324200             UPDATE TTRDTRN                                       32420000
324300              SET VER_NBR            = :TRDTRN-VER-NBR            32430000
324400                 ,ACTV_DTE           = :TRDTRN-ACTV-DTE           32440000
324500                 ,INACTV_DTE         = :TRDTRN-INACTV-DTE         32450000
324600                 ,LAST_CALL_DTE      = :TRDTRN-LAST-CALL-DTE      32460000
324700                 ,NEXT_CALL_DTE      = :TRDTRN-NEXT-CALL-DTE      32470000
324800                 ,LAST_CHG_DTE       = :TRDTRN-LAST-CHG-DTE       32480000
324900                 ,LAST_CHG_UID       = :TRDTRN-LAST-CHG-UID       32490000
325000                 ,NOTES_TXT          = :TRDTRN-NOTES-TXT          32500000
325100                 ,VER_CHG_DTE        = :TRDTRN-VER-CHG-DTE        32510000
325200                 ,COM_MTHD_CDE       = :TRDTRN-COM-MTHD-CDE       32520000
325300                                                                  32530000
325400             WHERE TP_DKEY         = :ASC-KEY-TP-DKEY             32540000
325500               AND TRAN_SET_CDE    = :ASC-KEY-TRAN-SET-CDE        32550000
325600               AND PROD_TEST_IND   = :ASC-KEY-PROD-TEST-IND       32560000
325700               AND DIR_IND         = :ASC-KEY-DIR-IND             32570000
325800                                                                  32580000
325900         END-EXEC                                                 32590000
326000                                                                  32600000
326100         EVALUATE TRUE                                            32610000
326200             WHEN SQLCODE = +0                                    32620000
326300             WHEN SQLCODE = -904                                  32630000
326400             WHEN SQLCODE = -913                                  32640000
326500                 CONTINUE                                         32650000
326600                                                                  32660000
326700             WHEN SQLWARN0 NOT = SPACES                           32670000
326800             WHEN SQLCODE < +0                                    32680000
326900             WHEN SQLCODE > +0                                    32690000
327000                 MOVE '6000-UPDATE-TTRDTRN'                       32700000
327100                                   TO DP013-PARAGRAPH             32710000
327200                 MOVE 'UPDATE A ROW ON TTRDTRN'                   32720000
327300                                   TO DP013-MESSAGE-TEXT(1)       32730000
327400                 MOVE SQLCA        TO DP013-SQLCA                 32740000
327500                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    32750000
327600                 SET DP013-DB2-ABEND                              32760000
327700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32770000
327800                 PERFORM DP013-0000-PROCESS-ABEND                 32780000
327900         END-EVALUATE                                             32790000
328000     END-PERFORM.                                                 32800000
328100                                                                  32810000
328200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32820000
328300         MOVE '6000-UPDATE-TTRDTRN' TO DP013-PARAGRAPH            32830000
328400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              32840000
328500                                   TO DP013-MESSAGE-TEXT (1)      32850000
328600         MOVE 'TO UPDATE A TTRDTRN ROW'                           32860000
328700                                   TO DP013-MESSAGE-TEXT (2)      32870000
328800         MOVE SQLCA                TO DP013-SQLCA                 32880000
328900         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    32890000
329000         SET DP013-DB2-ABEND                                      32900000
329100             DP013-XCTL-DISPLAY-RESTART                           32910000
329200                                   TO TRUE                        32920000
329300         PERFORM DP013-0000-PROCESS-ABEND                         32930000
329400     END-IF.                                                      32940000
329500                                                                  32950000
329600     MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER              32960000
329700     SET DP020-MSG-INFORMATIONAL TO TRUE                          32970000
329800                                                                  32980000
329900     IF  ASC-USE-SELECTION-QUEUE                                  32990000
330000         PERFORM 5200-UPDATE-SELECTION-QUEUE                      33000000
330100     END-IF.                                                      33010000
330200                                                                  33020000
330300     PERFORM 3500-SAVE-SCREEN-FIELDS.                             33030000
330400                                                                  33040000
330500     MOVE   ASC-LAST-CHG-UID    TO LCHGUIDO.                      33050000
330600                                                                  33060000
330700     STRING ASC-LAST-CHG-DTE-MM DELIMITED BY SIZE                 33070000
330800            ' '                 DELIMITED BY SIZE                 33080000
330900            ASC-LAST-CHG-DTE-DD DELIMITED BY SIZE                 33090000
331000            ' '                 DELIMITED BY SIZE                 33100000
331100            ASC-LAST-CHG-DTE-YY DELIMITED BY SIZE                 33110000
331200                           INTO LCHGDTEO.                         33120000
331300                                                                  33130000
331400 6100-PREPARE-TTRDTRN.                                            33140000
331500                                                                  33150000
331600     INITIALIZE DCLTTRDTRN.                                       33160000
331700                                                                  33170000
331800     MOVE ASC-KEY-TP-DKEY            TO TRDTRN-TP-DKEY            33180000
331900     MOVE ASC-FUNC-CDE               TO TRDTRN-FUNC-CDE           33190000
332000     MOVE ASC-KEY-TRAN-SET-CDE       TO TRDTRN-TRAN-SET-CDE       33200000
332100     MOVE ASC-KEY-PROD-TEST-IND      TO TRDTRN-PROD-TEST-IND      33210000
332200     MOVE ASC-KEY-DIR-IND            TO TRDTRN-DIR-IND            33220000
332300                                                                  33230000
332400     MOVE ASC-COMM-MTHD-NEW          TO TRDTRN-COM-MTHD-CDE       33240000
332500     MOVE ASC-VER-NBR-NEW            TO TRDTRN-VER-NBR            33250000
332600     IF ASC-ACTV-DTE-NEW = SPACE                                  33260000
332700         MOVE PC-NULL-DATE           TO TRDTRN-ACTV-DTE           33270000
332800     ELSE                                                         33280000
332900         MOVE ASC-ACTV-DTE-NEW       TO TRDTRN-ACTV-DTE           33290000
333000     END-IF                                                       33300000
333100     IF ASC-INACTV-DTE-NEW = SPACE                                33310000
333200         MOVE PC-NULL-DATE           TO TRDTRN-INACTV-DTE         33320000
333300     ELSE                                                         33330000
333400         MOVE ASC-INACTV-DTE-NEW     TO TRDTRN-INACTV-DTE         33340000
333500     END-IF                                                       33350000
333600     MOVE ASC-NOTES-TXT-NEW          TO TRDTRN-NOTES-TXT          33360000
333700     MOVE ASC-SETUP-DTE              TO TRDTRN-SETUP-DTE          33370000
333800     IF ASC-LAST-CALL-DTE-NEW = SPACE                             33380000
333900         MOVE PC-NULL-DATE           TO TRDTRN-LAST-CALL-DTE      33390000
334000     ELSE                                                         33400000
334100         MOVE ASC-LAST-CALL-DTE-NEW  TO TRDTRN-LAST-CALL-DTE      33410000
334200     END-IF                                                       33420000
334300     IF ASC-NEXT-CALL-DTE-NEW = SPACE                             33430000
334400         MOVE PC-NULL-DATE           TO TRDTRN-NEXT-CALL-DTE      33440000
334500     ELSE                                                         33450000
334600         MOVE ASC-NEXT-CALL-DTE-NEW  TO TRDTRN-NEXT-CALL-DTE      33460000
334700     END-IF                                                       33470000
334800                                                                  33480000
334900     MOVE ASC-CURRENT-DATE           TO ASC-LAST-CHG-DTE          33490000
335000                                        TRDTRN-LAST-CHG-DTE       33500000
335100     MOVE DP020-USERID               TO ASC-LAST-CHG-UID          33510000
335200                                        TRDTRN-LAST-CHG-UID.      33520000
335300                                                                  33530000
335400     MOVE ASC-VER-CHG-DTE            TO TRDTRN-VER-CHG-DTE.       33540000
335500/                                                                 33550000
335600*---------------------------------------------------------------- 33560000
335700* DELETE A TRADING PARTNERSHIP TRANSACTION SET ROW.               33570000
335800*---------------------------------------------------------------- 33580000
335900 7000-DELETE-TTRDTRN.                                             33590000
336000                                                                  33600000
336100     PERFORM                                                      33610000
336200         WITH TEST AFTER                                          33620000
336300         VARYING PV-RETRY-COUNTER                                 33630000
336400         FROM 1 BY 1                                              33640000
336500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33650000
336600             OR (SQLCODE = +0))                                   33660000
336700                                                                  33670000
336800         EXEC SQL DELETE FROM TTRDTRN                             33680000
336900                                                                  33690000
337000             WHERE TP_DKEY         = :ASC-KEY-TP-DKEY             33700000
337100               AND TRAN_SET_CDE    = :ASC-KEY-TRAN-SET-CDE        33710000
337200               AND PROD_TEST_IND   = :ASC-KEY-PROD-TEST-IND       33720000
337300               AND DIR_IND         = :ASC-KEY-DIR-IND             33730000
337400                                                                  33740000
337500         END-EXEC                                                 33750000
337600                                                                  33760000
337700         EVALUATE TRUE                                            33770000
337800             WHEN SQLCODE = +0                                    33780000
337900             WHEN SQLCODE = -904                                  33790000
338000             WHEN SQLCODE = -913                                  33800000
338100                 CONTINUE                                         33810000
338200                                                                  33820000
338300             WHEN SQLWARN0 NOT = SPACES                           33830000
338400             WHEN SQLCODE < +0                                    33840000
338500             WHEN SQLCODE > +0                                    33850000
338600                 MOVE '7000-DELETE-TTRDTRN'                       33860000
338700                                   TO DP013-PARAGRAPH             33870000
338800                 MOVE 'DELETE A ROW ON TTRDTRN'                   33880000
338900                                   TO DP013-MESSAGE-TEXT(1)       33890000
339000                 MOVE SQLCA        TO DP013-SQLCA                 33900000
339100                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    33910000
339200                 SET DP013-DB2-ABEND                              33920000
339300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33930000
339400                 PERFORM DP013-0000-PROCESS-ABEND                 33940000
339500         END-EVALUATE                                             33950000
339600     END-PERFORM.                                                 33960000
339700                                                                  33970000
339800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33980000
339900         MOVE '7000-DELETE-TTRDTRN' TO DP013-PARAGRAPH            33990000
340000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              34000000
340100                                   TO DP013-MESSAGE-TEXT (1)      34010000
340200         MOVE 'TO DELETE A TTRDTRN ROW'                           34020000
340300                                   TO DP013-MESSAGE-TEXT (2)      34030000
340400         MOVE SQLCA                TO DP013-SQLCA                 34040000
340500         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    34050000
340600         SET DP013-DB2-ABEND                                      34060000
340700             DP013-XCTL-DISPLAY-RESTART                           34070000
340800                                   TO TRUE                        34080000
340900         PERFORM DP013-0000-PROCESS-ABEND                         34090000
341000     END-IF.                                                      34100000
341100                                                                  34110000
341200     MOVE PC-TSYMSG-00115        TO DP020-MSG-NUMBER.             34120000
341300     SET DP020-MSG-INFORMATIONAL                                  34130000
341400         ASC-DELETE-SUCCESSFUL   TO TRUE.                         34140000
341500                                                                  34150000
341600     IF  ASC-USE-SELECTION-QUEUE                                  34160000
341700         PERFORM 5200-UPDATE-SELECTION-QUEUE                      34170000
341800     END-IF.                                                      34180000
341900/                                                                 34190000
342000*---------------------------------------------------------------- 34200000
342100* GET THE VENDOR NUMBER FOR SENDING MQ MESSAGE TO SUPPLIER SYSTEM 34210000
342200*---------------------------------------------------------------- 34220000
342300 7100-GET-VENDOR-NUMBER.                                          34230000
342400     PERFORM                                                      34240000
342500         WITH TEST AFTER                                          34250000
342600         VARYING PV-RETRY-COUNTER                                 34260000
342700         FROM 1 BY 1                                              34270000
342800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34280000
342900            OR (SQLCODE = +0 OR +100))                            34290000
343000                                                                  34300000
343100         EXEC SQL                                                 34310000
343200             SELECT B.DUN_NBR,                                    34320000
343300                    B.PRTNR_IND                                   34330000
343400              INTO  :EXTENT-DUN-NBR,                              34340000
343500                    :EXTENT-PRTNR-IND                             34350000
343600              FROM  TENTNME A                                     34360000
343700                 ,  TEXTENT B                                     34370000
343800              WHERE A.ENT_ID   = :ASC-ENT-ID                      34380000
343900                AND A.ENT_ID   = B.ENT_ID                         34390000
344000                AND A.TYPE_CDE = '01'                             34400000
344100                AND VND_IN_RMS_IND = 'Y'                          34410000
344200         END-EXEC                                                 34420000
344300                                                                  34430000
344400         EVALUATE TRUE                                            34440000
344500             WHEN SQLCODE = +0                                    34450000
344600             WHEN SQLCODE = +100                                  34460000
344700             WHEN SQLCODE = -904                                  34470000
344800             WHEN SQLCODE = -913                                  34480000
344900                 CONTINUE                                         34490000
345000             WHEN SQLWARN0 NOT = SPACE                            34500000
345100             WHEN SQLCODE < +0                                    34510000
345200             WHEN SQLCODE > +0                                    34520000
345300                 MOVE '7100-GET-VENDOR-NUMBER'                    34530000
345400                                 TO DP013-PARAGRAPH               34540000
345500                 MOVE 'SELECT ON TEXTENT TABLE'                   34550000
345600                                 TO DP013-MESSAGE-TEXT (1)        34560000
345700                 MOVE SQLCA      TO DP013-SQLCA                   34570000
345800                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)      34580000
345900                     SET DP013-DB2-ABEND                          34590000
346000                         DP013-XCTL-DISPLAY-RESTART               34600000
346100                                 TO TRUE                          34610000
346200                 PERFORM DP013-0000-PROCESS-ABEND                 34620000
346300          END-EVALUATE                                            34630000
346400     END-PERFORM.                                                 34640000
346500                                                                  34650000
346600     IF SQLCODE = -904 OR -913                                    34660000
346700        MOVE '7100-GET-VENDOR-NUMBER'                             34670000
346800                        TO DP013-PARAGRAPH                        34680000
346900        MOVE 'SELECT ON TEXTENT TABLE'                            34690000
347000                        TO DP013-MESSAGE-TEXT (1)                 34700000
347100        MOVE SQLCA      TO DP013-SQLCA                            34710000
347200        MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)               34720000
347300            SET DP013-DB2-ABEND                                   34730000
347400                DP013-XCTL-DISPLAY-RESTART                        34740000
347500                        TO TRUE                                   34750000
347600        PERFORM DP013-0000-PROCESS-ABEND                          34760000
347700     END-IF.                                                      34770000
347800                                                                  34780000
347900*-----------------------------------------------------------------34790000
348000* CHECK TO SEE IF THE VENDOR DOCUMENT RECENTLY ADDED, UPDATED, OR 34800000
348100* DELETED IS SET UP FOR EDI PRODUCTION ASNS OR POS                34810000
348200*-----------------------------------------------------------------34820000
348300 7200-CHECK-PO-ASN-STATUS.                                        34830000
348400     PERFORM                                                      34840000
348500         WITH TEST AFTER                                          34850000
348600         VARYING PV-RETRY-COUNTER                                 34860000
348700         FROM 1 BY 1                                              34870000
348800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34880000
348900            OR (SQLCODE = +0 OR +100 OR -811))                    34890000
349000                                                                  34900000
349100         EXEC SQL                                                 34910000
349200             SELECT A.TP_DKEY                                     34920000
349300              INTO  :TRDTRN-TP-DKEY                               34930000
349400              FROM  TTRDTRN A                                     34940000
349500                   ,TTRDPRT B                                     34950000
349600              WHERE ENT_ID = :ASC-ENT-ID                          34960000
349700                AND A.TP_DKEY = B.TP_DKEY                         34970000
349800                AND A.INACTV_DTE = '9999-09-09'                   34980000
349900                AND B.INACTV_DTE = '9999-09-09'                   34990000
350000                AND TRAN_SET_CDE = :PV-TRAN-SET-CDE               35000000
350100*               AND PROD_TEST_IND = 'P'                           35010000
350200         END-EXEC                                                 35020000
350300                                                                  35030000
350400         EVALUATE TRUE                                            35040000
350500             WHEN SQLCODE = +0                                    35050000
350600             WHEN SQLCODE = -811                                  35060000
350700             WHEN SQLCODE = -904                                  35070000
350800             WHEN SQLCODE = -913                                  35080000
350900             WHEN SQLCODE = +100                                  35090000
351000                 CONTINUE                                         35100000
351100             WHEN SQLWARN0 NOT = SPACE                            35110000
351200             WHEN SQLCODE < +0                                    35120000
351300             WHEN SQLCODE > +0                                    35130000
351400                 MOVE '7200-CHECK-PO-ASN-STATUS'                  35140000
351500                                 TO DP013-PARAGRAPH               35150000
351600                 MOVE 'SELECT ON TTRDTRN TABLE'                   35160000
351700                                 TO DP013-MESSAGE-TEXT (1)        35170000
351800                 MOVE SQLCA      TO DP013-SQLCA                   35180000
351900                 MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)      35190000
352000                     SET DP013-DB2-ABEND                          35200000
352100                         DP013-XCTL-DISPLAY-RESTART               35210000
352200                                 TO TRUE                          35220000
352300                 PERFORM DP013-0000-PROCESS-ABEND                 35230000
352400         END-EVALUATE                                             35240000
352500     END-PERFORM.                                                 35250000
352600                                                                  35260000
352700     IF SQLCODE = -904 OR -913                                    35270000
352800        MOVE '7200-CHECK-PO-ASN-STATUS'                           35280000
352900                        TO DP013-PARAGRAPH                        35290000
353000        MOVE 'SELECT ON TTRDTRN TABLE'                            35300000
353100                        TO DP013-MESSAGE-TEXT (1)                 35310000
353200        MOVE SQLCA      TO DP013-SQLCA                            35320000
353300        MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)               35330000
353400            SET DP013-DB2-ABEND                                   35340000
353500                DP013-XCTL-DISPLAY-RESTART                        35350000
353600                        TO TRUE                                   35360000
353700        PERFORM DP013-0000-PROCESS-ABEND                          35370000
353800     END-IF.                                                      35380000
353900                                                                  35390000
354000*-----------------------------------------------------------------35400000
354100* CHECK TO SEE IF THE VENDOR DOCUMENT RECENTLY ADDED, UPDATED, OR 35410000
354200* DELETED IS SET UP FOR EDI PRODUCTION ASNS OR POS                35420000
354300*-----------------------------------------------------------------35430000
354400 7300-CHECK-PROD-TEST-STATUS.                                     35440000
354500     PERFORM                                                      35450000
354600         WITH TEST AFTER                                          35460000
354700         VARYING PV-RETRY-COUNTER                                 35470000
354800         FROM 1 BY 1                                              35480000
354900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35490000
355000            OR (SQLCODE = +0 OR +100 OR -811))                    35500000
355100                                                                  35510000
355200         EXEC SQL                                                 35520000
355300             SELECT A.TP_DKEY                                     35530000
355400              INTO  :TRDTRN-TP-DKEY                               35540000
355500              FROM  TTRDTRN A                                     35550000
355600                   ,TTRDPRT B                                     35560000
355700              WHERE ENT_ID = :ASC-ENT-ID                          35570000
355800                AND A.TP_DKEY = B.TP_DKEY                         35580000
355900                AND A.INACTV_DTE = '9999-09-09'                   35590000
356000                AND B.INACTV_DTE = '9999-09-09'                   35600000
356100                AND TRAN_SET_CDE = :PV-TRAN-SET-CDE               35610000
356200                AND PROD_TEST_IND = :PV-PROD-TEST-IND             35620000
356300         END-EXEC                                                 35630000
356400                                                                  35640000
356500         EVALUATE TRUE                                            35650000
356600             WHEN SQLCODE = +0                                    35660000
356700             WHEN SQLCODE = -811                                  35670000
356800             WHEN SQLCODE = -904                                  35680000
356900             WHEN SQLCODE = -913                                  35690000
357000             WHEN SQLCODE = +100                                  35700000
357100                 CONTINUE                                         35710000
357200             WHEN SQLWARN0 NOT = SPACE                            35720000
357300             WHEN SQLCODE < +0                                    35730000
357400             WHEN SQLCODE > +0                                    35740000
357500                 MOVE '7300-CHECK-PROD-TEST-STATUS'               35750000
357600                                 TO DP013-PARAGRAPH               35760000
357700                 MOVE 'SELECT ON TTRDTRN TABLE'                   35770000
357800                                 TO DP013-MESSAGE-TEXT (1)        35780000
357900                 MOVE SQLCA      TO DP013-SQLCA                   35790000
358000                 MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)      35800000
358100                     SET DP013-DB2-ABEND                          35810000
358200                         DP013-XCTL-DISPLAY-RESTART               35820000
358300                                 TO TRUE                          35830000
358400                 PERFORM DP013-0000-PROCESS-ABEND                 35840000
358500         END-EVALUATE                                             35850000
358600     END-PERFORM.                                                 35860000
358700                                                                  35870000
358800     IF SQLCODE = -904 OR -913                                    35880000
358900        MOVE '7300-CHECK-PROD-TEST-STATUS'                        35890000
359000                        TO DP013-PARAGRAPH                        35900000
359100        MOVE 'SELECT ON TTRDTRN TABLE'                            35910000
359200                        TO DP013-MESSAGE-TEXT (1)                 35920000
359300        MOVE SQLCA      TO DP013-SQLCA                            35930000
359400        MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)               35940000
359500            SET DP013-DB2-ABEND                                   35950000
359600                DP013-XCTL-DISPLAY-RESTART                        35960000
359700                        TO TRUE                                   35970000
359800        PERFORM DP013-0000-PROCESS-ABEND                          35980000
359900     END-IF.                                                      35990000
360000                                                                  36000000
360100*-------------------------------------------------------------    36010000
360200* CHECK THAT VENDOR IS SET UP FOR PO OR ASN DOCUMENTS WHENEVER    36020000
360300* THERE IS AN ADD, UPDATE,OR DELETE. IF THEY ARE SET UP           36030000
360400* SEND EDI PO OR ASN INDICATOR TO RMS SUPPLIER SYSTEM             36040000
360500*-------------------------------------------------------------    36050000
360600 8000-PO-ASN-CHECK.                                               36060000
360700                                                                  36070000
360800*    IF ASC-KEY-TRAN-SET-CDE = '850'                              36080000
360900*    AND ASC-KEY-PROD-TEST-IND = 'P'                              36090000
361000*       INITIALIZE VN007-SENDING-FIELDS                           36100000
361100*       MOVE 'Y' TO PS-MQ-SEND-SW                                 36110000
361200*       IF ASC-INACTV-DTE-NEW = SPACES AND PS-NON-DELETE          36120000
361300*          MOVE 'Y' TO VN007-EDI-PO-IND                           36130000
361400*          INITIALIZE PS-DELETE-SW                                36140000
361500*       ELSE                                                      36150000
361600*          MOVE '850' TO PV-TRAN-SET-CDE                          36160000
361700*          PERFORM 7200-CHECK-PO-ASN-STATUS                       36170000
361800*          IF SQLCODE = +000 OR -811                              36180000
361900*             MOVE 'Y' TO VN007-EDI-PO-IND                        36190000
362000*          ELSE                                                   36200000
362100*             MOVE 'N' TO VN007-EDI-PO-IND                        36210000
362200*          END-IF                                                 36220000
362300*       END-IF                                                    36230000
362400*       MOVE '856' TO PV-TRAN-SET-CDE                             36240000
362500*       PERFORM 7200-CHECK-PO-ASN-STATUS                          36250000
362600*       IF SQLCODE = +000 OR -811                                 36260000
362700*          MOVE 'Y' TO VN007-EDI-ASN-IND                          36270000
362800*       ELSE                                                      36280000
362900*          MOVE 'N' TO VN007-EDI-ASN-IND                          36290000
363000*       END-IF                                                    36300000
363100*    ELSE                                                         36310000
363200*      IF ASC-KEY-TRAN-SET-CDE = '856'                            36320000
363300*      AND ASC-KEY-PROD-TEST-IND = 'P'                            36330000
363400*         INITIALIZE VN007-SENDING-FIELDS                         36340000
363500*         MOVE 'Y' TO PS-MQ-SEND-SW                               36350000
363600*         IF ASC-INACTV-DTE-NEW = SPACES AND PS-NON-DELETE        36360000
363700*            MOVE 'Y' TO VN007-EDI-ASN-IND                        36370000
363800*         ELSE                                                    36380000
363900*            MOVE '856' TO PV-TRAN-SET-CDE                        36390000
364000*            PERFORM 7200-CHECK-PO-ASN-STATUS                     36400000
364100*            IF SQLCODE = +000 OR -811                            36410000
364200*               MOVE 'Y' TO VN007-EDI-ASN-IND                     36420000
364300*            ELSE                                                 36430000
364400*               MOVE 'N' TO VN007-EDI-ASN-IND                     36440000
364500*            END-IF                                               36450000
364600*            INITIALIZE PS-DELETE-SW                              36460000
364700*         END-IF                                                  36470000
364800*         MOVE '850' TO PV-TRAN-SET-CDE                           36480000
364900*         PERFORM 7200-CHECK-PO-ASN-STATUS                        36490000
365000*         IF SQLCODE = +000 OR -811                               36500000
365100*            MOVE 'Y' TO VN007-EDI-PO-IND                         36510000
365200*         ELSE                                                    36520000
365300*            MOVE 'N' TO VN007-EDI-PO-IND                         36530000
365400*         END-IF                                                  36540000
365500*      END-IF                                                     36550000
365600*    END-IF.                                                      36560000
365700                                                                  36570000
365800     IF ASC-KEY-TRAN-SET-CDE = '850' OR                           36580000
365900        ASC-KEY-TRAN-SET-CDE = '856' OR                           36590000
366000        ASC-KEY-TRAN-SET-CDE = '860'                              36600000
366100           INITIALIZE VN007-SENDING-FIELDS                        36610000
366200           MOVE 'Y' TO PS-MQ-SEND-SW                              36620000
366300                                                                  36630000
366400           MOVE '850' TO PV-TRAN-SET-CDE                          36640000
366500           MOVE 'P' TO PV-PROD-TEST-IND                           36650000
366600           PERFORM 7300-CHECK-PROD-TEST-STATUS                    36660000
366700           IF SQLCODE = +000 OR -811                              36670000
366800              MOVE 'Y' TO VN007-EDI-PO-PROD-IND                   36680000
366900           ELSE                                                   36690000
367000              MOVE 'N' TO VN007-EDI-PO-PROD-IND                   36700000
367100           END-IF                                                 36710000
367200                                                                  36720000
367300           MOVE '850' TO PV-TRAN-SET-CDE                          36730000
367400           MOVE 'T' TO PV-PROD-TEST-IND                           36740000
367500           PERFORM 7300-CHECK-PROD-TEST-STATUS                    36750000
367600           IF SQLCODE = +000 OR -811                              36760000
367700              MOVE 'Y' TO VN007-EDI-PO-TEST-IND                   36770000
367800           ELSE                                                   36780000
367900              MOVE 'N' TO VN007-EDI-PO-TEST-IND                   36790000
368000           END-IF                                                 36800000
368100                                                                  36810000
368200           IF VN007-EDI-PO-PROD-IND = 'Y' OR                      36820000
368300              VN007-EDI-PO-TEST-IND = 'Y'                         36830000
368400                 MOVE 'Y' TO VN007-EDI-PO-IND                     36840000
368500           ELSE                                                   36850000
368600              MOVE 'N' TO VN007-EDI-PO-IND                        36860000
368700           END-IF                                                 36870000
368800                                                                  36880000
368900           MOVE '856' TO PV-TRAN-SET-CDE                          36890000
369000           PERFORM 7200-CHECK-PO-ASN-STATUS                       36900000
369100           IF SQLCODE = +000 OR -811                              36910000
369200              MOVE 'Y' TO VN007-EDI-ASN-IND                       36920000
369300           ELSE                                                   36930000
369400              MOVE 'N' TO VN007-EDI-ASN-IND                       36940000
369500           END-IF                                                 36950000
369600                                                                  36960000
369700           MOVE '860' TO PV-TRAN-SET-CDE                          36970000
369800           MOVE 'P' TO PV-PROD-TEST-IND                           36980000
369900           PERFORM 7300-CHECK-PROD-TEST-STATUS                    36990000
370000           IF SQLCODE = +000 OR -811                              37000000
370100              MOVE 'Y' TO VN007-EDI-POCHG-PROD-IND                37010000
370200           ELSE                                                   37020000
370300              MOVE 'N' TO VN007-EDI-POCHG-PROD-IND                37030000
370400           END-IF                                                 37040000
370500                                                                  37050000
370600           MOVE '860' TO PV-TRAN-SET-CDE                          37060000
370700           MOVE 'T' TO PV-PROD-TEST-IND                           37070000
370800           PERFORM 7300-CHECK-PROD-TEST-STATUS                    37080000
370900           IF SQLCODE = +000 OR -811                              37090000
371000              MOVE 'Y' TO VN007-EDI-POCHG-TEST-IND                37100000
371100           ELSE                                                   37110000
371200              MOVE 'N' TO VN007-EDI-POCHG-TEST-IND                37120000
371300           END-IF                                                 37130000
371400                                                                  37140000
371500           IF VN007-EDI-POCHG-PROD-IND = 'Y' OR                   37150000
371600              VN007-EDI-POCHG-TEST-IND = 'Y'                      37160000
371700                 MOVE 'Y' TO VN007-EDI-POCHG-IND                  37170000
371800           ELSE                                                   37180000
371900              MOVE 'N' TO VN007-EDI-POCHG-IND                     37190000
372000           END-IF                                                 37200000
372100     END-IF.                                                      37210000
372200                                                                  37220000
372300*-----------------------------------------------------------------37230000
372400* CHECK EDI PO AND ASN INDICATORS TO SEE WHETHER OR NOT TO SEND   37240000
372500* MQSERIES MESSAGE.                                               37250000
372600*-----------------------------------------------------------------37260000
372700 8050-CHECK-EDI-PO-ASN-IND.                                       37270000
372800                                                                  37280000
372900     IF PS-SEND                                                   37290000
373000        PERFORM 8100-SEND-MQ-MESSAGE                              37300000
373100     END-IF.                                                      37310000
373200                                                                  37320000
373300*---------------------------------------------------------------  37330000
373400* SEND MQSERIES MESSAGE TO VNKCS024 WHEN VENDOR INFORMATION HAS   37340000
373500* BEEN INSERTED, UPDATED, OR DELETED FOR PO OR ASN DOCUMENTS      37350000
373600*---------------------------------------------------------------- 37360000
373700 8100-SEND-MQ-MESSAGE.                                            37370000
373800                                                                  37380000
373900     PERFORM 7100-GET-VENDOR-NUMBER.                              37390000
374000     IF SQLCODE = +0                                              37400000
374100        MOVE EXTENT-DUN-NBR TO VN007-VND-NBR                      37410000
374200        MOVE ASC-ENT-ID TO VN007-ENT-ID                           37420000
374300        IF EXTENT-PRTNR-IND = 'Y'                                 37430000
374400           MOVE 'P' TO VN007-EDI-VNDR-TYPE-IND                    37440000
374500        ELSE                                                      37450000
374600           MOVE 'S' TO VN007-EDI-VNDR-TYPE-IND                    37460000
374700        END-IF                                                    37470000
374800                                                                  37480000
374900        EXEC CICS LINK PROGRAM (PC-VNKCS024)                      37490000
375000                      COMMAREA (VN007-COMMAREA)                   37500000
375100                          RESP (PV-CICS-RESPONSE)                 37510000
375200        END-EXEC                                                  37520000
375300                                                                  37530000
375400        IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                37540000
375500            CONTINUE                                              37550000
375600        ELSE                                                      37560000
375700           MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM             37570000
375800           MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH           37580000
375900           MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT (1)    37590000
376000           MOVE VN007-REASON-CODE    TO DP013-SQLCA               37600000
376100           SET DP013-DB2-ABEND                                    37610000
376200               DP013-ROLLBACK                                     37620000
376300               DP013-XCTL-DISPLAY-RESTART TO TRUE                 37630000
376400           PERFORM DP013-0000-PROCESS-ABEND                       37640000
376500        END-IF                                                    37650000
376600     END-IF.                                                      37660000
376700*---------------------------------------------------------------- 37670000
376800* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.        37680000
376900*---------------------------------------------------------------- 37690000
377000                                                                  37700000
377100 9100-READ-SEL-QUEUE.                                             37710000
377200     EXEC CICS                                                    37720000
377300         READQ TS                                                 37730000
377400             QUEUE (ASC-SEL-QUEUE-NAME)                           37740000
377500             INTO  (ET301-SELECTED-VNDRS)                         37750000
377600             ITEM  (ASC-SEL-ITEM)                                 37760000
377700             RESP  (PV-CICS-RESPONSE)                             37770000
377800     END-EXEC.                                                    37780000
377900                                                                  37790000
378000     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   37800000
378100         CONTINUE                                                 37810000
378200     ELSE                                                         37820000
378300         SET DP013-LOGIC-ABEND                                    37830000
378400             DP013-NO-ROLLBACK     TO TRUE                        37840000
378500         MOVE '9100-READ-SEL-QUEUE'                               37850000
378600                                   TO DP013-PARAGRAPH             37860000
378700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   37870000
378800                                   TO DP013-MESSAGE-TEXT (1)      37880000
378900         PERFORM DP013-0000-PROCESS-ABEND                         37890000
379000     END-IF.                                                      37900000
379100                                                                  37910000
379200/                                                                 37920000
379300*---------------------------------------------------------------- 37930000
379400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.        37940000
379500*---------------------------------------------------------------- 37950000
379600 9200-REWRITE-LIST-QUEUE.                                         37960000
379700                                                                  37970000
379800     EXEC CICS                                                    37980000
379900          WRITEQ TS                                               37990000
380000              QUEUE  (ASC-SEL-QUEUE-NAME)                         38000000
380100              FROM   (ET301-SELECTED-VNDRS)                       38010000
380200              ITEM   (ASC-SEL-ITEM)                               38020000
380300              RESP   (PV-CICS-RESPONSE)                           38030000
380400              REWRITE                                             38040000
380500     END-EXEC.                                                    38050000
380600                                                                  38060000
380700     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               38070000
380800         SET DP013-CICS-ABEND                                     38080000
380900             DP013-NO-ROLLBACK     TO TRUE                        38090000
381000         MOVE '9200-REWRITE-LIST-QUEUE'                           38100000
381100                                   TO DP013-PARAGRAPH             38110000
381200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   38120000
381300                                   TO DP013-MESSAGE-TEXT (1)      38130000
381400         PERFORM DP013-0000-PROCESS-ABEND                         38140000
381500     END-IF.                                                      38150000
381600                                                                  38160000
381700/                                                                 38170000
381800*---------------------------------------------------------------- 38180000
381900*    ABEND PROCESSOR MODULE                                       38190000
382000*---------------------------------------------------------------- 38200000
382100                                                                  38210000
382200     COPY DPPD013.                                                38220000
