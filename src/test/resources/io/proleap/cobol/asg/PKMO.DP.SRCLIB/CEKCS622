000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CEKCS622.                                         00040000
000500 AUTHOR.        THERESE RAMSEYER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  AUGUST 2000.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S622 - CE-CENTRAL-STOCK/RDM ITEM RESEND                    * 00110000
001200*---------------------------------------------------------------* 00120004
001300*                                                               * 00130005
001310* CHANGE HISTORY:                                               * 00131005
001320* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES         * 00132005
001330* ------- ---------- ----------- -------------------------------- 00133005
001340* WR38216 04-26-2010 C. TWIEHAUS  EFC1-2 TRANSFERS              * 00134005
001350*         05-14-2020 JEAN KURK    RENAME WMKCS201 TO CEKCS622   * 00135005
001360*---------------------------------------------------------------* 00136005
001361* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00136105
001362* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00136205
001363* MAKING THE CALL DYNAMIC VS STATIC.                              00136305
001364*----------------------------------------------------------------*00136405
001365* CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00136505
001366* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00136605
001367* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00136705
001368*-----------------------------------------------------------------00136805
001369 EJECT                                                            00136905
001370 ENVIRONMENT DIVISION.                                            00137005
001380                                                                  00138005
001390 DATA DIVISION.                                                   00139005
001400                                                                  00140005
001500 WORKING-STORAGE SECTION.                                         00150005
001600                                                                  00160005
001700 01  DK-DB2-KEYS.                                                 00170005
001800     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00180005
001900                                                    COMP.         00190005
002000     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00200005
002100     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00210005
002200                                                    COMP.         00220005
002300     15  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00230005
002400     15  DK-DUMMY-FIELD                 PIC S9(01)  VALUE ZERO    00240005
002500                                                    COMP.         00250005
002600     15  DK-RDM-PULL-NUMBER             PIC S9(09)  VALUE ZERO    00260005
002700                                                    COMP.         00270005
002900                                                                  00290000
003000 01  PC-PROGRAM-CONSTANTS.                                        00300000
003010     05  PC-SPACE                  PIC  X(01)  VALUE ' '.         00301017
003100     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE622A  '.  00310000
003200     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM622 '.  00320000
003300     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS622'.  00330000
003400     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00340005
003500     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00350005
003600     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00360005
003700     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00370005
003800     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00380005
003900                                               COMP SYNC.         00390005
004000     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00400005
004100                                               COMP SYNC.         00410005
004200     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00420005
004300                                               COMP-3.            00430005
004400     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00440005
004500                                               COMP SYNC.         00450005
004600     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00460005
004700                                               COMP-3.            00470005
004800     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00480005
004900     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00490005
005000     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00500005
005100     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00510005
005200     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00520005
005300     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00530005
005400     05  PC-R                      PIC  X(01)  VALUE 'R'.         00540005
005500     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00550005
005600                                               COMP.              00560005
005700     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00570005
005800     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00580005
005900     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00590005
006000     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00600005
006100     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00610005
006200     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00620005
006300     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00630005
006400     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00640005
006500     05  PC-01                     PIC  X(02)  VALUE '01'.        00650005
006600                                                                  00660005
006700     05  PC-RDM-DOWNLOADED         PIC  X(20)                     00670005
006800                                   VALUE 'DOWNLOADED TO RDM   '.  00680005
006810     05  PC-RDM-TO-BE-RESENT       PIC  X(20)                     00681005
006820                                   VALUE 'TO BE RESENT TO RDM '.  00682005
006830     05  PC-RDM-NOT-DOWNLOADED     PIC  X(20)                     00683005
006840                                   VALUE 'NOT DOWNLOADED      '.  00684005
006850*                                                                 00685005
006860*----------------------------------------------------------------*00686005
006870*  DESCRIPTION CONSTANTS                                         *00687005
006880*----------------------------------------------------------------*00688005
006890     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  00689005
006900     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  00690005
007000     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  00700005
007100     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  00710005
007200     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  00720005
007300     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  00730005
007400     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  00740005
007500     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  00750005
007600     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  00760005
007700* 04/26/2010 CT START ADDED THIS LINE                             00770005
007800     05  PC-XFER-DESC               PIC X(10)  VALUE 'WMXFR'.     00780005
007900* 04/26/2010 CT ENDED                                             00790005
008000     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  00800005
008100     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.00810005
008200     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.00820005
008300     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     00830005
008400                                           VALUE '** UNKNOWN **'. 00840005
008500*                                                                 00850005
008600*----------------------------------------------------------------*00860005
008700*  SYSTEM MESSAGES                                               *00870005
008800*----------------------------------------------------------------*00880005
008900*   00005 = INVALID VALUE                                        *00890005
009000*   00008 = MUST BE NUMERIC                                      *00900005
009100*   00045 = INVALID FUNCTION KEY                                 *00910005
009200*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00920005
009300*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00930005
009400*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00940005
009500*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00950005
009600*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00960005
009700*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00970005
009800*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00980005
009900*   00069 - TOP OF LIST                                          *00990005
010000*   00070 - BOTTOM OF LIST                                       *01000005
010100*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01010005
010200*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01020005
010300*   00279 - MORE ITEMS TO DISPLAY                                *01030005
010400*   00746 = INVALID PRINTER DESTINATION                          *01040005
010500*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01050005
010600*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01060005
010700*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01070005
010800*   02225 = CANNOT CONFIRM DISTRIBUTION - PULL CANCELLED          01080005
010900*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01090005
011000*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01100005
011100*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01110005
011200*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01120005
011300*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01130005
011400*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01140005
011500*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01150005
011600*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                01160005
011700*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              01170005
011800*   02258 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM PULL DI01180005
011900*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01190005
012000*   02260 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM LINE IT01200005
012100*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01210005
012200*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01220005
012300*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01230005
012400*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01240005
012500*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01250005
012600*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01260005
012700*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01270005
012800*   02268 - CANNOT CANCEL/UNCANCEL - LINE(S) ALREADY POSTED/DISTRB01280005
012900*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01290005
013000*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01300005
013100*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01310005
013200*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01320005
013300*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01330005
013400*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01340005
013500*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01350005
013600*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01360005
013700*   02278 = ALL SELECTED LINES MUST HAVE THE SAME STATUS TO PER  *01370005
013800*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01380005
013900*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01390005
014000*   02289 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS DISTRIBTD01400005
014100*   02290 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS POSTED   01410005
014200*   02291 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS CANCELLED01420005
014300*   02296 - PRINT PULL FAILED - NO LINE(S) FOR REQUESTED PULL     01430005
014400*   02297 - PRINT PULL FAILED - LINE(S) MISSING DISTRIBUTION INFOR01440005
014401*   02306 - YOU DO NOT HAVE AUTHORITY TO PRINT                    01440105
014402*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01440205
014403*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01440305
014404*   02317 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS NEW         01440405
014405*   02324 - PRINT REQUEST FAILED - LINE STATUS IS POSTED OR DISTRI01440505
014406*   02325 - PRINT REQUEST FAILED - LINE STATUS IS CANCELLED       01440605
014407*   02328 - YOU DO NOT HAVE AUTHORITY TO ADD NEW LINE ITEMS       01440705
014408*   02332 - CANNOT ADD LINE ITEMS - PULL STATUS IS POSTED/DISTRIBU01440805
014409*   02339 - CANNOT CONFIRM DISTRIBUTION - PULL LINE STATUS NEW    01440905
014410*   03820 - ALL LINES MUST BE SELECTED TO USE THE RESEND FUNCTION 01441005
014411*   99901 = INVALID COMMAND WAS ENTERED                          *01441105
014420*----------------------------------------------------------------*01442005
014430     05  PC-TSYMSG-NUMBERS.                                       01443005
014440         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01444005
014450         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01445005
014460         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01446005
014470         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01447005
014480         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01448005
014490         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01449005
014500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01450005
014600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01460005
014700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01470005
014800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01480005
014900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01490005
015000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01500005
015100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01510005
015200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01520005
015300         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01530005
015400         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01540005
015500         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01550005
015600         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01560005
015700         10  PC-TSYMSG-02224            PIC  9(05)  VALUE 02224.  01570005
015800         10  PC-TSYMSG-02225            PIC  9(05)  VALUE 02225.  01580005
015900         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01590005
016000         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01600005
016100         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01610005
016200         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01620005
016300         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01630005
016400         10  PC-TSYMSG-02254            PIC  9(05)  VALUE 02254.  01640005
016500         10  PC-TSYMSG-02255            PIC  9(05)  VALUE 02255.  01650005
016600         10  PC-TSYMSG-02256            PIC  9(05)  VALUE 02256.  01660005
016700         10  PC-TSYMSG-02257            PIC  9(05)  VALUE 02257.  01670005
016800         10  PC-TSYMSG-02258            PIC  9(05)  VALUE 02258.  01680005
016900         10  PC-TSYMSG-02259            PIC  9(05)  VALUE 02259.  01690005
017000         10  PC-TSYMSG-02260            PIC  9(05)  VALUE 02260.  01700005
017100         10  PC-TSYMSG-02261            PIC  9(05)  VALUE 02261.  01710005
017200         10  PC-TSYMSG-02262            PIC  9(05)  VALUE 02262.  01720005
017300         10  PC-TSYMSG-02263            PIC  9(05)  VALUE 02263.  01730005
017400         10  PC-TSYMSG-02264            PIC  9(05)  VALUE 02264.  01740005
017500         10  PC-TSYMSG-02265            PIC  9(05)  VALUE 02265.  01750005
017600         10  PC-TSYMSG-02266            PIC  9(05)  VALUE 02266.  01760005
017700         10  PC-TSYMSG-02267            PIC  9(05)  VALUE 02267.  01770005
017800         10  PC-TSYMSG-02268            PIC  9(05)  VALUE 02268.  01780005
017900         10  PC-TSYMSG-02269            PIC  9(05)  VALUE 02269.  01790005
018000         10  PC-TSYMSG-02270            PIC  9(05)  VALUE 02270.  01800005
018100         10  PC-TSYMSG-02271            PIC  9(05)  VALUE 02271.  01810005
018200         10  PC-TSYMSG-02272            PIC  9(05)  VALUE 02272.  01820005
018300         10  PC-TSYMSG-02273            PIC  9(05)  VALUE 02273.  01830005
018400         10  PC-TSYMSG-02274            PIC  9(05)  VALUE 02274.  01840005
018500         10  PC-TSYMSG-02275            PIC  9(05)  VALUE 02275.  01850005
018600         10  PC-TSYMSG-02276            PIC  9(05)  VALUE 02276.  01860005
018700         10  PC-TSYMSG-02278            PIC  9(05)  VALUE 02278.  01870005
018800         10  PC-TSYMSG-02287            PIC  9(05)  VALUE 02287.  01880005
018900         10  PC-TSYMSG-02288            PIC  9(05)  VALUE 02288.  01890005
019000         10  PC-TSYMSG-02289            PIC  9(05)  VALUE 02289.  01900005
019100         10  PC-TSYMSG-02290            PIC  9(05)  VALUE 02290.  01910005
019200         10  PC-TSYMSG-02291            PIC  9(05)  VALUE 02291.  01920005
019300         10  PC-TSYMSG-02296            PIC  9(05)  VALUE 02296.  01930005
019400         10  PC-TSYMSG-02297            PIC  9(05)  VALUE 02297.  01940005
019500         10  PC-TSYMSG-02306            PIC  9(05)  VALUE 02306.  01950005
019600         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  01960005
019700         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  01970005
019800         10  PC-TSYMSG-02317            PIC  9(05)  VALUE 02317.  01980005
019900         10  PC-TSYMSG-02324            PIC  9(05)  VALUE 02324.  01990005
020000         10  PC-TSYMSG-02325            PIC  9(05)  VALUE 02325.  02000005
020100         10  PC-TSYMSG-02328            PIC  9(05)  VALUE 02328.  02010005
020110         10  PC-TSYMSG-02332            PIC  9(05)  VALUE 02332.  02011005
020120         10  PC-TSYMSG-02339            PIC  9(05)  VALUE 02339.  02012005
020130         10  PC-TSYMSG-02495            PIC  9(05)  VALUE 02495.  02013005
020131         10  PC-TSYMSG-03820            PIC  9(05)  VALUE 03820.  02013105
020140         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02014005
020150*                                                                 02015005
020160 01  PS-PROGRAM-SWITCHES.                                         02016005
020170     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02017005
020180         88  PS-NO-ERROR                            VALUE 'Y'.    02018005
020190         88  PS-ERROR                               VALUE 'N'.    02019005
020200     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    02020005
020300         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02030005
020400         88  PS-BLOCK-ERROR                         VALUE 'N'.    02040005
020500     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   02050005
020600         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   02060005
020700         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   02070005
020800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02080005
020900         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02090005
021000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02100005
021100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02110005
021200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02120005
021300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02130005
021400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02140005
021500         88  PS-DONE                                VALUE 'Y'.    02150005
021600         88  PS-NOT-DONE                            VALUE 'N'.    02160005
021700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02170005
021800         88  PS-LIST-END                            VALUE 'Y'.    02180005
021900         88  PS-NO-LIST-END                         VALUE 'N'.    02190005
022000     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   02200005
022100         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   02210005
022200         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   02220005
022300*                                                                 02230005
022400 01  PV-PROGRAM-VARIABLES.                                        02240005
022500     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02250005
022600                                        COMP SYNC.                02260005
022700     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 02270005
022800     05  PV-SUB                         PIC S9(04)  VALUE +0      02280005
022900                                                    COMP SYNC.    02290005
023000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02300005
023100                                                    COMP SYNC.    02310005
023200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02320005
023300                                                    COMP-3.       02330005
023400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02340005
023500                                                    COMP-3.       02350005
023600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02360005
023700                                                    COMP-3.       02370005
023800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02380005
023900                                                    COMP-3.       02390005
024000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02400005
024100                                                    COMP-3.       02410005
024200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02420005
024300                                                    COMP-3.       02430005
024400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02440005
024500                                                    COMP-3.       02450005
024600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02460005
024700                                                    COMP SYNC.    02470005
024800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02480005
024900                                                    COMP SYNC.    02490005
025000     05  PV-ITEM                        PIC S9(04)  VALUE +0      02500005
025100                                                    COMP SYNC.    02510005
025200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02520005
025300                                                    COMP SYNC.    02530005
025400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02540005
025500                                                    COMP SYNC.    02550005
025600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02560005
025700                                                    COMP SYNC.    02570005
025800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02580005
025900                                                    COMP SYNC.    02590005
026000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02600005
026100                                                    COMP SYNC.    02610005
026200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02620005
026300                                                    COMP SYNC.    02630005
026400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02640005
026500                                                    COMP SYNC.    02650005
026600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02660005
026700                                                    COMP SYNC.    02670005
026800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02680005
026900                                                    COMP SYNC.    02690005
027000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02700005
027100                                                    COMP SYNC.    02710005
027200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02720005
027300                                                    COMP SYNC.    02730005
027400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02740005
027500                                                    COMP SYNC.    02750005
027600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02760005
027700                                                    COMP SYNC.    02770005
027800     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02780005
027900                                                    COMP.         02790005
028000     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02800005
028100                                                    COMP.         02810005
028200     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02820005
028300                                                    COMP.         02830005
028400     05  PV-SOFT-ABORT-MSG.                                       02840005
028500         10  FILLER            PIC X(12) VALUE ' CEKCS622 - '.    02850005
028600         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02860005
028700         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02870005
028800         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02880005
028900         10  PV-SOFT-PARAGRAPH PIC X(30).                         02890005
029000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02900005
029100                                                     COMP SYNC.   02910005
029200     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02920005
029300     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02930005
029400     05  PV-CICS-MSG-HOLD.                                        02940005
029500         10  FILLER                      PIC  X(01)  VALUE SPACE. 02950005
029600         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02960005
029700     05  PV-CICS-MSG-HOLD2.                                       02970005
029800         10  FILLER                      PIC  X(01)  VALUE SPACE. 02980005
029900         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02990005
030000                                                                  03000005
030100                                                                  03010005
030200     05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 03020005
030300     05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              03030005
030400         10   PV-CREATE-CC              PIC X(02).                03040005
030500         10   PV-CREATE-YY              PIC X(02).                03050005
030600         10   FILLER                    PIC X(01).                03060005
030700         10   PV-CREATE-MM              PIC X(02).                03070005
030800         10   FILLER                    PIC X(01).                03080005
030900         10   PV-CREATE-DD              PIC X(02).                03090005
031000         10   FILLER                    PIC X(16).                03100005
031100     05  PV-CREATE-MMDDYY.                                        03110005
031200         10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 03120005
031300         10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 03130005
031400         10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 03140005
031500         10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 03150005
031600         10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 03160005
031700     05  PV-STATUS-MMDDYY.                                        03170005
031800         10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 03180005
031900         10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 03190005
032000         10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 03200005
032100         10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 03210005
032200         10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 03220005
032300     05  PV-SELECT-FROM-DATE.                                     03230005
032400         10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 03240005
032500         10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 03250005
032600         10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 03260005
032700         10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 03270005
032800         10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 03280005
032900     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 03290005
033000         88   PV-SOURCE-ADAM                        VALUE 'AD'.   03300005
033100         88   PV-SOURCE-INFOREM                     VALUE 'IN'.   03310005
033200         88   PV-SOURCE-MANUAL                      VALUE 'MA'.   03320005
033300         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 03330005
033400     05  PV-PULL-STATUS                 PIC X(02)   VALUE SPACES. 03340005
033500         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   03350005
033600         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   03360005
033700         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   03370005
033800         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   03380005
033900         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   03390005
034000     05  PV-LINE-STATUS                 PIC X(02)   VALUE SPACES. 03400005
034100         88   PV-LINE-STATUS-NEW                    VALUE 'NW'.   03410005
034200         88   PV-LINE-STATUS-CANCELLED              VALUE 'CA'.   03420005
034300         88   PV-LINE-STATUS-INPROCESS              VALUE 'IP'.   03430005
034400         88   PV-LINE-STATUS-DISTRIBTD              VALUE 'DS'.   03440005
034500         88   PV-LINE-STATUS-POSTED                 VALUE 'PD'.   03450005
034600     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  03460005
034700                                                    COMP.         03470005
034800     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  03480005
034900                                                    COMP.         03490005
035000     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  03500005
035100                                                    COMP.         03510005
035200     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  03520005
035300                                                    COMP.         03530005
035400     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  03540005
035500                                                    COMP.         03550005
035600                                                                  03560005
035700     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 03570005
035800         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   03580005
035900         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   03590005
036000         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   03600005
036100     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 03610005
036200         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   03620005
036300         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   03630005
036400         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   03640005
036500     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 03650005
036600         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   03660005
036700         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   03670005
036800         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   03680005
036900                                                                  03690005
037000     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 03700005
037100         88   PV-STATUS-1-NEW                       VALUE 'NW'.   03710005
037200         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   03720005
037300         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   03730005
037400         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   03740005
037500         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   03750005
037600     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 03760005
037700         88   PV-STATUS-2-NEW                       VALUE 'NW'.   03770005
037800         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   03780005
037900         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   03790005
038000         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   03800005
038100         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   03810005
038200     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 03820005
038300         88   PV-STATUS-3-NEW                       VALUE 'NW'.   03830005
038400         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   03840005
038500         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   03850005
038600         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   03860005
038700         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   03870005
038800     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 03880005
038900         88   PV-STATUS-4-NEW                       VALUE 'NW'.   03890005
039000         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   03900005
039100         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   03910005
039200         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   03920005
039300         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   03930005
039400     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 03940005
039500         88   PV-STATUS-5-NEW                       VALUE 'NW'.   03950005
039600         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   03960005
039700         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   03970005
039800         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   03980005
039900         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   03990005
040000                                                                  04000005
040100     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 04010005
040200     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 04020005
040300     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 04030005
040400     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 04040005
040500     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 04050005
040600     05  PV-SKU-NUMBER                   PIC  X(08) VALUE SPACES. 04060005
040700     05  PV-SKU-DESCRIPTION              PIC  X(15) VALUE SPACES. 04070005
040800     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 04080005
040900     05  PV-LINE-STATUS-DESC             PIC  X(09) VALUE SPACES. 04090005
041000     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 04100005
041100     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 04110005
041200     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 04120005
041300     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 04130005
041400     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 04140005
041500     05  PV-DIST-UNT-ZERO-SUPPRESS       PIC  ZZZZ9 VALUE ZEROES. 04150005
041600                                                                  04160005
041700     05  PV-CS-PRINTER-ID                PIC  X(08) VALUE SPACES. 04170005
041800     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 04180005
041900     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 04190005
042000     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 04200005
042100     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 04210005
042200     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 04220005
042300     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 04230005
042400                                                                  04240005
042500     05  PV-SEL-TERM-ID                  PIC  X(04).              04250005
042600     05  PV-SEL-TASK-NUMBER              PIC  9(05).              04260005
042700     05  PV-SEL-SEQ                      PIC  9(01).              04270005
042800                                                                  04280005
042900     05  PV-LINES-POSTED-DISTRB          PIC S9(09)  COMP.        04290005
043000     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     04300005
043100                                                     COMP SYNC.   04310005
043200     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      04320005
043300     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      04330005
043400     05  PV-SEL-CNCL-CNT                 PIC S9(09)  COMP-3       04340005
043500                                                     VALUE ZEROES.04350005
043600     05  PV-SEL-UNCNCL-CNT               PIC S9(09)  COMP-3       04360005
043700                                                     VALUE ZEROES.04370005
043800     05  PV-NUMBER-OF-STORES             PIC  9(05)  VALUE ZEROES.04380005
043900     05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.04390005
044000     05  PV-DUMMY                        PIC  X(04)  VALUE SPACES.04400005
044020                                                                  04402011
044100******************************************************************04410005
044200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **04420005
044300**  THIS MUST BE THE EXACT SAME FORMAT AS A BLOCK IN THE        **04430005
044400**  APPLICATION-SPECIFIC COMMAREA.                              **04440005
044500******************************************************************04450005
044600 01  LQW-LIST-QUEUE-WORK-AREA.                                    04460005
044700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04470005
044800     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           04480005
044900                                        INDEXED BY LQW-IDX.       04490005
045000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04500005
045100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04510005
045200         10  LQW-SELECTED-SW            PIC  X(01).               04520005
045300             88  LQW-SELECT                         VALUE 'S'.    04530005
045400             88  LQW-DESELECT                       VALUE ' '.    04540005
045500         10  LQW-ACTION                 PIC  X(03).               04550005
045600             88  LQW-DEL                            VALUE 'DEL'.  04560005
045700             88  LQW-INQ                            VALUE 'INQ'.  04570005
045800             88  LQW-UPD                            VALUE 'UPD'.  04580005
045900             88  LQW-ERR                            VALUE 'ERR'.  04590005
046000             88  LQW-PRT                            VALUE 'PRT'.  04600005
046100         10  LQW-LINE-NUMBER            PIC  Z(08).               04610005
046200         10  LQW-SKU-NUMBER             PIC  X(08).               04620005
046300         10  LQW-SKU-DESCRIPTION        PIC  X(15).               04630005
046400         10  LQW-LINE-STATUS-CDE        PIC  X(02).               04640005
046500         10  LQW-LINE-STATUS-DESC       PIC  X(08).               04650005
046600         10  LQW-NBR-STORES             PIC  Z(05).               04660005
046700         10  LQW-REQ-PULL-UNITS         PIC  Z(05).               04670005
046800         10  LQW-ACT-PULL-UNITS         PIC  Z(05).               04680005
046900         10  LQW-DISTRBUTED-UNITS       PIC  X(05).               04690005
047000         10  LQW-LINE-ITEM              PIC  9(15).               04700005
047100         10  LQW-LINE-SKU-RETAIL        PIC  9(05)V99.            04710005
047200         10  LQW-RDM-STATUS             PIC  X(01).               04720005
047300             88   LQW-RDM-DOWNLOADED    VALUE 'X'.                04730005
047400             88   LQW-RDM-TO-BE-RESENT  VALUE 'R'.                04740005
047500                                                                  04750005
047600                                                                  04760005
047700 EJECT                                                            04770005
047800*---------------------------------------------------------------* 04780005
047900* SELECTON QUEUE LAYOUT                                         * 04790005
048000*---------------------------------------------------------------* 04800005
048100     COPY CEWS003.                                                04810005
048200                                                                  04820005
048300 EJECT                                                            04830005
048400*---------------------------------------------------------------* 04840005
048500*    MAP LAYOUT                                                 * 04850005
048600*---------------------------------------------------------------* 04860005
048700     COPY CEKM622.                                                04870005
048800*                                                                 04880005
048900 01  MR-OCCURS-LAYOUT                   REDEFINES  CE622AO.       04890005
049000     05  FILLER                         PIC X(110).               04900005
049100     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          04910005
049200         10  MR-SELECTL                 PIC S9(04) COMP.          04920005
049300         10  MR-SELECTA                 PIC  X(01).               04930005
049400         10  MR-SELECTC                 PIC  X(01).               04940005
049500         10  MR-SELECTH                 PIC  X(01).               04950005
049600         10  MR-SELECTI                 PIC  X(01).               04960005
049700                                                                  04970005
049800         10  MR-ACTIONL                 PIC S9(04) COMP.          04980005
049900         10  MR-ACTIONA                 PIC  X(01).               04990005
050000         10  MR-ACTIONC                 PIC  X(01).               05000005
050100         10  MR-ACTIONH                 PIC  X(01).               05010005
050200         10  MR-ACTION                  PIC  X(03).               05020005
050300                                                                  05030005
050400         10  MR-LINE-NUMBERL            PIC S9(04) COMP.          05040005
050500         10  MR-LINE-NUMBERA            PIC  X(01).               05050005
050600         10  MR-LINE-NUMBERC            PIC  X(01).               05060005
050700         10  MR-LINE-NUMBERH            PIC  X(01).               05070005
050800         10  MR-LINE-NUMBER-X.                                    05080005
050900             15  MR-LINE-NUMBER         PIC  Z(04).               05090005
051000                                                                  05100005
051100         10  MR-SKU-NBRL                PIC S9(04) COMP.          05110005
051200         10  MR-SKU-NBRA                PIC  X(01).               05120005
051300         10  MR-SKU-NBRC                PIC  X(01).               05130005
051400         10  MR-SKU-NBRH                PIC  X(01).               05140005
051500         10  MR-SKU-NBR                 PIC  X(08).               05150005
051600                                                                  05160005
051700         10  MR-SKU-DESCL               PIC S9(04) COMP.          05170005
051800         10  MR-SKU-DESCA               PIC  X(01).               05180005
051900         10  MR-SKU-DESCC               PIC  X(01).               05190005
052000         10  MR-SKU-DESCH               PIC  X(01).               05200005
052100         10  MR-SKU-DESC                PIC  X(15).               05210005
052200                                                                  05220005
052300         10  MR-LINE-STATUSL            PIC S9(04) COMP.          05230005
052400         10  MR-LINE-STATUSA            PIC  X(01).               05240005
052500         10  MR-LINE-STATUSC            PIC  X(01).               05250005
052600         10  MR-LINE-STATUSH            PIC  X(01).               05260005
052700         10  MR-LINE-STATUS             PIC  X(08).               05270005
052800                                                                  05280005
052900         10  MR-RDM-STATUSL             PIC S9(04) COMP.          05290005
053000         10  MR-RDM-STATUSA             PIC  X(01).               05300005
053100         10  MR-RDM-STATUSC             PIC  X(01).               05310005
053200         10  MR-RDM-STATUSH             PIC  X(01).               05320005
053300         10  MR-RDM-STATUS              PIC  X(20).               05330005
053400                                                                  05340005
053500     05  FILLER                         PIC  X(12).               05350005
053600                                                                  05360005
053700*----------------------------------------------------------------*05370005
053800*  SENDING/RECEIVING AREA FOR THE                                *05380005
053900*  PRINTER VALIDATION ROUTING (DPKCS060)                         *05390005
054000*----------------------------------------------------------------*05400005
054100     COPY DPWS072.                                                05410005
054200                                                                  05420005
054300 EJECT                                                            05430005
054400*----------------------------------------------------------------*05440005
054500**  SECURITY SUBROUTINE PARAMETERS                                05450005
054600*----------------------------------------------------------------*05460005
054700     COPY DPWS008.                                                05470005
054800                                                                  05480005
054900 EJECT                                                            05490005
055000*---------------------------------------------------------------* 05500005
055100*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05510005
055200*---------------------------------------------------------------* 05520005
055300                                                                  05530005
055400     COPY DPWS015.                                                05540005
055500                                                                  05550005
055600 EJECT                                                            05560005
055700*---------------------------------------------------------------* 05570005
055800*    FUNCTION KEYS COPYBOOK.                                    * 05580005
055900*---------------------------------------------------------------* 05590005
056000                                                                  05600005
056100     COPY DPWS016.                                                05610005
056200                                                                  05620005
056300 EJECT                                                            05630005
056400*---------------------------------------------------------------* 05640005
056500*    NUMERIC EDIT LAYOUT.                                       * 05650005
056600*---------------------------------------------------------------* 05660005
056700                                                                  05670005
056800     COPY DPWS010I.                                               05680005
056900                                                                  05690005
057000 EJECT                                                            05700005
057100*---------------------------------------------------------------* 05710005
057200*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 05720005
057300*---------------------------------------------------------------* 05730005
057400                                                                  05740005
057500     COPY DPWS030.                                                05750005
057510     COPY DPWS930.                                                05751005
057520                                                                  05752005
057530 EJECT                                                            05753005
057540*---------------------------------------------------------------* 05754005
057550*    STANDARD COMMAREA.                                         * 05755005
057560*---------------------------------------------------------------* 05756005
057570                                                                  05757005
057580     COPY DPWS020.                                                05758005
057590     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05759005
057600                                                                  05760005
057700*---------------------------------------------------------------* 05770005
057800* INTER-APPLICATION COMMAREA.                                   * 05780005
057900*   CEWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05790005
058000*             SPEC SCREEN.                                      * 05800005
058100*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05810005
058200*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05820005
058300*---------------------------------------------------------------* 05830005
058400                                                                  05840005
058500         10  INTER-APPL-COMM-AREA       PIC X(200).               05850005
058600     COPY CEWS001.                                                05860005
058700     COPY CEWS002.                                                05870005
058800*---------------------------------------------------------------* 05880005
058900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05890005
059000*---------------------------------------------------------------* 05900005
059100         10  ASC-SPECIFIC-COMMAREA.                               05910005
059200             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          05920005
059300             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 05930005
059400                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          05940005
059500             15  ASC-CURR-FCLTY-ID           PIC  X(04).          05950005
059600             15  ASC-CURR-FCLTY-ID-N REDEFINES                    05960005
059700                     ASC-CURR-FCLTY-ID       PIC  9(04).          05970005
059800             15  ASC-CS-LOC                  PIC  X(04).          05980005
059900             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               05990005
060000                 20  ASC-CS-LOC-N            PIC  9(04).          06000005
060100             15  ASC-CS-LOCATION-DESC        PIC  X(25).          06010005
060200             15  ASC-CS-PRINTER-ID           PIC  X(08).          06020005
060300             15  ASC-PULL-NBR                PIC  X(09).          06030005
060400             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           06040005
060500                 20  ASC-PULL-NBR-N          PIC  9(09).          06050005
060600             15  ASC-REF-NBR                 PIC  X(15).          06060005
060700             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          06070005
060800                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    06080005
060900                                                   'I' 'N' 'P'    06090005
061000                                                   ' '.           06100005
061100                 88  ASC-PULL-STATUS-ENTERED VALUE 'A' 'C' 'D'    06110005
061200                                                   'I' 'N' 'P'.   06120005
061300                 88  ASC-SELECT-ALL               VALUE 'A'.      06130005
061400                 88  ASC-SELECT-CNCLD             VALUE 'C'.      06140005
061500                 88  ASC-SELECT-DSTRB             VALUE 'D'.      06150005
061600                 88  ASC-SELECT-INPROC            VALUE 'I'.      06160005
061700                 88  ASC-SELECT-NEW               VALUE 'N'.      06170005
061800                 88  ASC-SELECT-POSTD             VALUE 'P'.      06180005
061900* 04/26/2010 CT START ADDED 'X' TO BOTH                           06190005
062000             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          06200005
062100                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    06210005
062200                                                   'M' ' ' 'X'.   06220005
062300                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    06230005
062400                                                   'M' 'X'.       06240005
062500                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      06250005
062600                 88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      06260005
062700                 88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      06270005
062800                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      06280005
062900                 88  ASC-SELECT-SRC-XFER          VALUE 'X'.      06290005
063000* 04/26/2010 CT END                                               06300005
063100             15  ASC-PULL-SELECT-DATE-FROM.                       06310005
063200                 20  ASC-FROM-MM             PIC  9(02).          06320005
063300                 20  ASC-FROM-DD             PIC  9(02).          06330005
063400                 20  ASC-FROM-YY             PIC  9(04).          06340005
063500             15  ASC-PULL-SELECT-DATE-TO.                         06350005
063600                 20  ASC-TO-MM               PIC  9(02).          06360005
063700                 20  ASC-TO-DD               PIC  9(02).          06370005
063800                 20  ASC-TO-YY               PIC  9(04).          06380005
063900             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          06390005
064000                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   06400005
064100                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       06410005
064200                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      06420005
064300                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      06430005
064400             15  ASC-PULL-STATUS             PIC  X(02).          06440005
064500                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     06450005
064600                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     06460005
064700                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     06470005
064800                 88  ASC-PULL-NEW                 VALUE 'NW'.     06480005
064900                 88  ASC-PULL-POSTED              VALUE 'PD'.     06490005
065000* 04/26/2010 CT START ADDED 'XF'                                  06500005
065100             15  ASC-PULL-TYPE               PIC  X(02).          06510005
065200                 88  ASC-PULL-SRC-ADAM            VALUE 'MA'.     06520005
065300                 88  ASC-PULL-SRC-XFER            VALUE 'XF'.     06530005
065400                 88  ASC-PULL-SRC-INFOREM         VALUE 'MR'.     06540005
065500                 88  ASC-PULL-SRC-MANUAL          VALUE 'UC'.     06550005
065600* 04/26/2010 CT END                                               06560005
065700             15  ASC-CONFIRM-TYPE-IND        PIC  X(01).          06570005
065800                 88  ASC-CONFIRM-TYPE-NONE        VALUE 'N'.      06580005
065900                 88  ASC-CONFIRM-CNCL-ITEM        VALUE 'A'.      06590005
066000                 88  ASC-CONFIRM-UNCNCL-ITEM      VALUE 'B'.      06600005
066100                 88  ASC-CONFIRM-CONF-DIST-ITEM   VALUE 'C'.      06610005
066200                 88  ASC-CONFIRM-UNCONF-DIST-ITEM VALUE 'D'.      06620005
066300                 88  ASC-CONFIRM-CONF-ITEM        VALUE 'E'.      06630005
066400                 88  ASC-CONFIRM-UNCONF-ITEM      VALUE 'F'.      06640005
066500                                                                  06650005
066600             15  FILLER                      PIC  X(124).         06660005
066700*-----------------------------------------------------------------06670005
066800             15  ASC-BLK-SUB                  PIC S9(04) COMP     06680005
066900                                                         SYNC.    06690005
067000             15  ASC-ITEM-SUB                 PIC S9(04) COMP     06700005
067100                                                         SYNC.    06710005
067200             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  06720005
067300             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  06730005
067400             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  06740005
067500             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  06750005
067600             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  06760005
067700             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     06770005
067800                                                         SYNC.    06780005
067900             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  06790005
068000             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  06800005
068100             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         06810005
068200                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06820005
068300                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06830005
068400             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         06840005
068500                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     06850005
068600                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     06860005
068700             15  ASC-LIST-QUEUE-NAME.                             06870005
068800                 20  ASC-LIST-TERM-ID         PIC  X(04).         06880005
068900                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  06890005
069000                 20  ASC-LIST-SEQ             PIC  9(01).         06900005
069100                                                                  06910005
069200             15  ASC-START-ITEM-REQUEST.                          06920005
069300                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         06930005
069400                                                                  06940005
069500             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06950005
069600             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06960005
069700             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06970005
069800                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06980005
069900             15  ASC-SEL-QUEUE-NAME.                              06990005
070000                 20  ASC-SEL-TERM-ID          PIC  X(04).         07000005
070100                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  07010005
070200                 20  ASC-SEL-SEQ              PIC  9(01).         07020005
070300             15  ASC-SEL-QUEUE-NAME-2.                            07030005
070400                 20  ASC-SEL-TERM-ID-2        PIC  X(04).         07040005
070500                 20  ASC-SEL-TASK-NUMBER-2    PIC S9(05) COMP-3.  07050005
070600                 20  ASC-SEL-SEQ-2            PIC  9(01).         07060005
070700             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  07070005
070800                                                                  07080005
070900*-----------------------------------------------------------------07090005
071000                                                                  07100005
071100             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                07110005
071200                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  07120005
071300                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   07130005
071400                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   07140005
071500                                                                  07150005
071600                 20  ASC-ITEM-ARRAY.                              07160005
071700                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        07170005
071800                         30  ASC-LIST-ITEM-NUMBER                 07180005
071900                                                     PIC S9(09)   07190005
072000                                                     COMP-3.      07200005
072100                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  07210005
072200                             88  ASC-VALID-SELECT    VALUE ' '    07220005
072300                                                           'S'    07230005
072400                                                           'B'    07240005
072500                                                           'E'.   07250005
072600                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   07260005
072700                             88  ASC-TEMP-SELECT     VALUE 'S'.   07270005
072800                             88  ASC-TEMP-BEGIN      VALUE 'B'.   07280005
072900                             88  ASC-TEMP-END        VALUE 'E'.   07290005
073000                         30  ASC-SELECTED-SW         PIC  X(01).  07300005
073100                             88  ASC-NO-SELECT       VALUE ' '.   07310005
073200                             88  ASC-SELECT          VALUE 'S'.   07320005
073300                             88  ASC-BEGIN           VALUE 'B'.   07330005
073400                             88  ASC-END             VALUE 'E'.   07340005
073500                         30  ASC-ACTION              PIC  X(03).  07350005
073600                         30  ASC-LINE-NUMBER         PIC  9(08).  07360005
073700                         30  ASC-SKU-NUMBER          PIC  X(08).  07370005
073800                         30  ASC-SKU-DESCRIPTION     PIC  X(15).  07380005
073900                         30  ASC-LINE-STATUS-CDE     PIC  X(02).  07390005
074000                             88   ASC-LINE-STATUS-NEW             07400005
074100                                                      VALUE 'NW'. 07410005
074200                             88   ASC-LINE-STATUS-CANCELLED       07420005
074300                                                      VALUE 'CA'. 07430005
074400                             88   ASC-LINE-STATUS-INPROCESS       07440005
074500                                                      VALUE 'IP'. 07450005
074600                             88   ASC-LINE-STATUS-DISTRIBTD       07460005
074700                                                      VALUE 'DS'. 07470005
074800                             88   ASC-LINE-STATUS-POSTED          07480005
074900                                                      VALUE 'PD'. 07490005
075000                         30  ASC-LINE-STATUS-DESC    PIC  X(08).  07500005
075100                         30  ASC-NBR-STORES          PIC  Z(05).  07510005
075200                         30  ASC-REQ-PULL-UNITS      PIC  Z(05).  07520005
075300                         30  ASC-ACT-PULL-UNITS      PIC  Z(05).  07530005
075400                         30  ASC-DISTRBUTED-UNITS    PIC  X(05).  07540005
075500                         30  ASC-LINE-ITEM           PIC  9(15).  07550005
075600                         30  ASC-LINE-SKU-RETAIL   PIC  9(05)V99. 07560005
075700                         30  ASC-RDM-STATUS          PIC  X(01).  07570005
075800                             88   ASC-RDM-DOWNLOADED    VALUE 'X'.07580005
075900                             88   ASC-RDM-TO-BE-RESENT  VALUE 'R'.07590005
076000                                                                  07600005
076100     EJECT                                                        07610005
076200*---------------------------------------------------------------* 07620005
076300*    ABEND PROCESSING COPYBOOK.                                 * 07630005
076400*---------------------------------------------------------------* 07640005
076500                                                                  07650005
076600     COPY DPWS013.                                                07660005
076700                                                                  07670005
076800 EJECT                                                            07680005
076900*---------------------------------------------------------------* 07690005
077000*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 07700005
077100*---------------------------------------------------------------* 07710005
077200     EXEC SQL                                                     07720005
077300          INCLUDE TCEPLRQ                                         07730005
077400     END-EXEC.                                                    07740005
077500*---------------------------------------------------------------* 07750005
077600*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 07760005
077700*---------------------------------------------------------------* 07770005
077800     EXEC SQL                                                     07780005
077900          INCLUDE TCEPLDS                                         07790005
078000     END-EXEC.                                                    07800005
078100*---------------------------------------------------------------* 07810005
078200*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 07820005
078300*---------------------------------------------------------------* 07830005
078400     EXEC SQL                                                     07840005
078500          INCLUDE TCEPLIT                                         07850005
078600     END-EXEC.                                                    07860005
078700*---------------------------------------------------------------* 07870005
078800*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 07880005
078900*---------------------------------------------------------------* 07890005
079000     EXEC SQL                                                     07900005
079100          INCLUDE TCEPLST                                         07910005
079200     END-EXEC.                                                    07920005
079300*---------------------------------------------------------------* 07930005
079400*    XLT_SKU TABLE                                             *  07940005
079500*---------------------------------------------------------------* 07950005
079600     EXEC SQL                                                     07960005
079700          INCLUDE XLT00003                                        07970005
079800     END-EXEC.                                                    07980005
079900*---------------------------------------------------------------* 07990005
080000*    DB2 AREA FOR COMMUNICATIONS                                * 08000005
080100*---------------------------------------------------------------* 08010005
080200     EXEC SQL                                                     08020005
080300          INCLUDE SQLCA                                           08030005
080400     END-EXEC.                                                    08040005
080500*---------------------------------------------------------------* 08050005
080600*    LINE ITEM CURSOR                                           * 08060005
080700*---------------------------------------------------------------* 08070005
080800                                                                  08080005
080900     EXEC SQL                                                     08090005
081000          DECLARE LINE-ITEM-CSR CURSOR FOR                        08100005
081100              SELECT  CNSTK_REQ_PL_NBR                            08110005
081200                     ,PL_LNE_NBR                                  08120005
081300                     ,ITM_NBR                                     08130005
081400                     ,PL_REQ_QTY                                  08140005
081500                     ,ACTL_PL_QTY                                 08150005
081600                     ,STAT_CDE                                    08160005
081700                     ,UNT_RTL_AMT                                 08170005
081800                     ,DWNLD_RDM_STAT_CDE                          08180005
081900                FROM  TCEPLIT                                     08190005
082000               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          08200005
082100            ORDER BY  PL_LNE_NBR                                  08210005
082200     END-EXEC.                                                    08220005
082300                                                                  08230005
082400*---------------------------------------------------------------* 08240005
082500                                                                  08250005
082600 LINKAGE SECTION.                                                 08260005
082700                                                                  08270005
082800 01  DFHCOMMAREA.                                                 08280005
082900     05  FILLER                         OCCURS  1 TO 4072 TIMES   08290005
083000                                        DEPENDING ON EIBCALEN.    08300005
083100         10  FILLER                     PIC X.                    08310005
083200                                                                  08320005
083300 EJECT                                                            08330005
083400                                                                  08340005
083500 PROCEDURE DIVISION.                                              08350005
083600******************************************************************08360005
083700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **08370005
083800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **08380005
083900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **08390005
084000******************************************************************08400005
084100 0000-MAIN-MODULE.                                                08410005
084200     INITIALIZE DP030-CICS-API-FIELDS.                            08420005
084300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08430005
084400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08440005
084500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08450005
084600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08460005
084700     MOVE LENGTH OF CE622AI        TO DP030-MAP-LENGTH (1).       08470005
084800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08480005
084900     PERFORM 0001-CALL-CICS-ARCH-API.                             08490005
085000*                                                                 08500005
085100     PERFORM 1000-CONTROL-PROCESSING                              08510005
085200*                                                                 08520005
085300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08530005
085400     PERFORM 0001-CALL-CICS-ARCH-API.                             08540005
085500                                                                  08550005
085600******************************************************************08560005
085700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08570005
085800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08580005
085900******************************************************************08590005
086000 0001-CALL-CICS-ARCH-API.                                         08600005
086100     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08610005
086200                                    DFHCOMMAREA                   08620005
086300                                    DP030-CICS-API-FIELDS         08630005
086400                                    DP020-STANDARD-COMMAREA       08640005
086500                                    CE622AI.                      08650005
086600*                                                                 08660005
086700     IF  DP030-RC-CALL-SUCCESSFUL                                 08670005
086800         CONTINUE                                                 08680005
086900     ELSE                                                         08690005
087000         SET DP013-NO-ROLLBACK                                    08700005
087100             DP013-XCTL-DISPLAY-RESTART                           08710005
087200             DP013-CICS-ABEND      TO TRUE                        08720005
087300         MOVE '0001-CALL-CICS-ARCH-API'                           08730005
087400                                   TO DP013-PARAGRAPH             08740005
087500         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08750005
087600-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08760005
087700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08770005
087800         PERFORM DP013-0000-PROCESS-ABEND                         08780005
087900     END-IF.                                                      08790005
088000*----------------------------------------------------------------*08800005
088100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08810005
088200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08820005
088300*                                                                *08830005
088400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08840005
088500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08850005
088600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08860005
088700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08870005
088800*----------------------------------------------------------------*08880005
088900                                                                  08890005
089000 1000-CONTROL-PROCESSING.                                         08900005
089100                                                                  08910005
089200     EVALUATE TRUE                                                08920005
089300         WHEN DP020-NEXT-ACT-INITIAL                              08930005
089400             INITIALIZE ASC-SPECIFIC-COMMAREA                     08940005
089500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08950005
089600                                      ASC-SEL-TERM-ID             08960005
089700                                      ASC-SEL-TERM-ID-2           08970005
089800             MOVE DP020-SRC-TASK-NUMBER                           08980005
089900                                   TO ASC-LIST-TASK-NUMBER        08990005
090000                                      ASC-SEL-TASK-NUMBER         09000005
090100                                      ASC-SEL-TASK-NUMBER-2       09010005
090200             MOVE PC-LIST-QUEUE-SEQ                               09020005
090300                                   TO ASC-LIST-SEQ                09030005
090400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09040005
090500                                      ASC-SEL-SEQ-2               09050005
090600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09060005
090700***-----$TEMPLATE NOTE$-------------------------------------------09070005
090800*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,09080005
090900*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  09090005
091000*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.09100005
091100***---------------------------------------------------------------09110005
091200             IF  PS-COMMAREA-NOT-VALID                            09120005
091300                 SET DP020-NEXT-ACT-APPL-ERROR                    09130005
091400                                   TO TRUE                        09140005
091500             ELSE                                                 09150005
091600                 PERFORM 4000-BUILD-INITIAL-PANEL                 09160005
091700             END-IF                                               09170005
091800                                                                  09180005
091900         WHEN DP020-NEXT-ACT-READ-MAP                             09190005
092000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09200005
092100                                   TO PV-TOP-ITEM                 09210005
092200             PERFORM 2000-PROCESS-PANEL                           09220005
092300                                                                  09230005
092400         WHEN DP020-NEXT-ACT-RETURN                               09240005
092500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09250005
092600                                   TO PV-TOP-ITEM                 09260005
092700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09270005
092800             PERFORM 4505-COUNT-PULL-LINE-ITEMS                   09280005
092900             IF  PV-CEPLIT-ITEM-QTY = ASC-NUMBER-OF-ITEMS-READ    09290005
093000                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             09300005
093100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09310005
093200             ELSE                                                 09320005
093300                 PERFORM 2050-DELETE-LIST-QUEUE                   09330005
093400                 PERFORM 4000-BUILD-INITIAL-PANEL                 09340005
093500             END-IF                                               09350005
093600                                                                  09360005
093700         WHEN OTHER                                               09370005
093800             SET DP013-LOGIC-ABEND TO TRUE                        09380005
093900             SET DP013-NO-ROLLBACK TO TRUE                        09390005
094000             MOVE '1000-CONTROL-PROCESSING'                       09400005
094100                                   TO DP013-PARAGRAPH             09410005
094200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09420005
094300                                   TO DP013-MESSAGE-TEXT(1)       09430005
094400             PERFORM DP013-0000-PROCESS-ABEND                     09440005
094500     END-EVALUATE.                                                09450005
094600                                                                  09460005
094700 EJECT                                                            09470005
094800*----------------------------------------------------------------*09480005
094900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *09490005
095000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *09500005
095100*----------------------------------------------------------------*09510005
095200                                                                  09520005
095300 1100-PROCESS-INTER-APPL-COMM.                                    09530005
095400                                                                  09540005
095500     SET PS-COMMAREA-VALID         TO TRUE.                       09550005
095600     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09560005
095700                                                                  09570005
095800     IF  DP020-INT-APPL-FORMAT-IND = (PC-CRIT-SPEC-FORMAT)        09580005
095900                                                                  09590005
096000         MOVE CE001-CURR-OPER-UNT-ID-N                            09600005
096100                                      TO ASC-CURR-OPER-UNT-ID-N   09610005
096200         MOVE CE001-CURR-FCLTY-ID-N   TO ASC-CURR-FCLTY-ID-N      09620005
096300         MOVE CE001-CS-LOCATION       TO ASC-CS-LOC-N             09630005
096400         MOVE CE001-CS-PRINTER-ID     TO ASC-CS-PRINTER-ID        09640005
096500         MOVE CE001-PULL-NBR          TO ASC-PULL-NBR-N           09650005
096600         MOVE CE001-REF-NBR           TO ASC-REF-NBR              09660005
096700         MOVE CE001-PULL-SELECT-STATUS                            09670005
096800                                      TO ASC-PULL-SELECT-STATUS   09680005
096900         MOVE CE001-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     09690005
097000         MOVE CE001-PULL-SELECT-DATE-FROM                         09700005
097100                                      TO ASC-PULL-SELECT-DATE-FROM09710005
097200         MOVE CE001-PULL-SELECT-DATE-TO                           09720005
097300                                      TO ASC-PULL-SELECT-DATE-TO  09730005
097400         MOVE CE001-SELECT-LIST-SEQUENCE                          09740005
097500                                      TO ASC-SELECT-LIST-SEQUENCE 09750005
097600         MOVE CE001-CURR-PULL-STATUS  TO ASC-PULL-STATUS          09760005
097700         MOVE CE001-CURR-PULL-TYPE    TO ASC-PULL-TYPE            09770005
097800     END-IF.                                                      09780005
097900                                                                  09790005
098000     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              09800005
098100         MOVE CE002-CURR-OPER-UNT-ID-N                            09810005
098200                                      TO ASC-CURR-OPER-UNT-ID-N   09820005
098300         MOVE CE002-CURR-FCLTY-ID-N   TO ASC-CURR-FCLTY-ID-N      09830005
098400         MOVE CE002-CS-LOCATION       TO ASC-CS-LOC-N             09840005
098500         MOVE CE002-PULL-NBR          TO ASC-PULL-NBR-N           09850005
098600         MOVE CE002-REF-NBR           TO ASC-REF-NBR              09860005
098700         MOVE CE002-PULL-SELECT-STATUS                            09870005
098800                                      TO ASC-PULL-SELECT-STATUS   09880005
098900         MOVE CE002-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     09890005
099000         MOVE CE002-CURR-PULL-TYPE    TO ASC-PULL-TYPE            09900005
099100         MOVE CE002-SELECT-LIST-SEQUENCE                          09910005
099200                                      TO ASC-SELECT-LIST-SEQUENCE 09920005
099300         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    09930005
099400         MOVE CE002-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      09940005
099500         PERFORM 1120-PREPARE-LIST-ENTRY                          09950005
099600     END-IF.                                                      09960005
099700                                                                  09970005
099800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09980005
099900 1120-PREPARE-LIST-ENTRY.                                         09990005
100000                                                                  10000005
100100     MOVE CE003-MAX-ITEMS          TO ASC-SEL-SUB.                10010005
100200     MOVE ZERO                     TO ASC-SEL-ITEM.               10020005
100300     PERFORM 1130-GET-NEXT-RECORD.                                10030005
100400                                                                  10040005
100500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10050005
100600*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*10060005
100700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10070005
100800 1130-GET-NEXT-RECORD.                                            10080005
100900                                                                  10090005
101000     ADD +1                       TO ASC-SEL-SUB.                 10100005
101100                                                                  10110005
101200     IF  ASC-SEL-SUB > CE003-MAX-ITEMS                            10120005
101300         ADD +1                   TO ASC-SEL-ITEM                 10130005
101400         MOVE +1                  TO ASC-SEL-SUB                  10140005
101500     END-IF.                                                      10150005
101600                                                                  10160005
101700     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10170005
101800         PERFORM 9100-READ-SEL-QUEUE                              10180005
101900         IF  CE003-ITEM (ASC-SEL-SUB) > ZERO                      10190005
102000             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 10200005
102100                                  TO PV-PULL-NUMBER               10210005
102200                                     ASC-PULL-NBR-N               10220005
102300             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  10230005
102400                                  TO PV-REF-NUMBER                10240005
102500                                     ASC-REF-NBR                  10250005
102600             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 10260005
102700                                  TO PV-LINE-NUMBER               10270005
102800             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 10280005
102900                                  TO PV-CS-LOCATION               10290005
103000                                     ASC-CS-LOC-N                 10300005
103100             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             10310005
103200                                  TO PV-PULL-STATUS-CDE           10320005
103300                                     ASC-PULL-STATUS              10330005
103400             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             10340005
103500                                  TO PV-PULL-SOURCE-CDE           10350005
103600                                     ASC-PULL-TYPE                10360005
103700             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             10370005
103800                                  TO PV-SELECT-LIST-SEQ           10380005
103900             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   10390005
104000                                  TO PV-NBR-ITEMS                 10400005
104100             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  10410005
104200                                  TO PV-NBR-STORES                10420005
104300             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              10430005
104400                                  TO PV-REQ-PULL-UNITS            10440005
104500             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              10450005
104600                                  TO PV-ACT-PULL-UNITS            10460005
104700             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             10470005
104800                                  TO PV-DIST-PULL-UNITS           10480005
104900                                                                  10490005
105000             SET CE003-INQ (ASC-SEL-SUB)                          10500005
105100                                  TO TRUE                         10510005
105200             PERFORM 9200-REWRITE-SEL-QUEUE                       10520005
105300         ELSE                                                     10530005
105400             SUBTRACT +1 FROM ASC-SEL-SUB                         10540005
105500             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             10550005
105600             SET DP020-MSG-INFORMATIONAL                          10560005
105700                 PS-LIST-END             TO TRUE                  10570005
105800         END-IF                                                   10580005
105900     ELSE                                                         10590005
106000         SUBTRACT +1 FROM ASC-SEL-ITEM                            10600005
106100         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  10610005
106200         SET PS-LIST-END             TO TRUE                      10620005
106300     END-IF.                                                      10630005
106400                                                                  10640005
106500/                                                                 10650005
106600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10660005
106700*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *10670005
106800*    PROCESSED.                                                  *10680005
106900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10690005
107000                                                                  10700005
107100 1140-GET-PREV-RECORD.                                            10710005
107200                                                                  10720005
107300     SUBTRACT +1 FROM ASC-SEL-SUB.                                10730005
107400                                                                  10740005
107500     IF  ASC-SEL-SUB < +1                                         10750005
107600         SUBTRACT +1 FROM ASC-SEL-ITEM                            10760005
107700         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  10770005
107800     END-IF.                                                      10780005
107900                                                                  10790005
108000     IF  ASC-SEL-ITEM > ZERO                                      10800005
108100         PERFORM 9100-READ-SEL-QUEUE                              10810005
108200             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 10820005
108300                                  TO PV-PULL-NUMBER               10830005
108400                                     ASC-PULL-NBR-N               10840005
108500             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  10850005
108600                                  TO PV-REF-NUMBER                10860005
108700                                     ASC-REF-NBR                  10870005
108800             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 10880005
108900                                  TO PV-LINE-NUMBER               10890005
109000             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 10900005
109100                                  TO PV-CS-LOCATION               10910005
109200                                     ASC-CS-LOC-N                 10920005
109300             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 10930005
109400                                  TO PV-CREATE-DATE               10940005
109500             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             10950005
109600                                  TO PV-PULL-STATUS-CDE           10960005
109700                                     ASC-PULL-STATUS              10970005
109800             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             10980005
109900                                  TO PV-PULL-SOURCE-CDE           10990005
110000                                     ASC-PULL-TYPE                11000005
110100             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             11010005
110200                                  TO PV-SELECT-LIST-SEQ           11020005
110300             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   11030005
110400                                  TO PV-NBR-ITEMS                 11040005
110500             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  11050005
110600                                  TO PV-NBR-STORES                11060005
110700             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              11070005
110800                                  TO PV-REQ-PULL-UNITS            11080005
110900             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              11090005
111000                                  TO PV-ACT-PULL-UNITS            11100005
111100             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             11110005
111200                                  TO PV-DIST-PULL-UNITS           11120005
111300         SET CE003-INQ (ASC-SEL-SUB)                              11130005
111400                                  TO TRUE                         11140005
111500         PERFORM 9200-REWRITE-SEL-QUEUE                           11150005
111600     ELSE                                                         11160005
111700         MOVE +1                  TO ASC-SEL-ITEM                 11170005
111800                                     ASC-SEL-SUB                  11180005
111900         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11190005
112000         SET DP020-MSG-INFORMATIONAL                              11200005
112100             PS-LIST-END             TO TRUE                      11210005
112200     END-IF.                                                      11220005
112300                                                                  11230005
112400*----------------------------------------------------------------*11240005
112500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11250005
112600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11260005
112700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11270005
112800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11280005
112900* FUNCTION KEYS CAN GET THIS FAR.                                *11290005
113000*----------------------------------------------------------------*11300005
113100                                                                  11310005
113200 2000-PROCESS-PANEL.                                              11320005
113300     EVALUATE TRUE                                                11330005
113400         WHEN DP020-SRC-AID = DP016-CLEAR                         11340005
113500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11350005
113600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11360005
113700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11370005
113800                                                                  11380005
113900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11390005
114000             PERFORM 2050-DELETE-LIST-QUEUE                       11400005
114100             PERFORM 4000-BUILD-INITIAL-PANEL                     11410005
114200                                                                  11420005
114300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11430005
114400             PERFORM 2140-DESELECT-ALL-ITEMS                      11440005
114500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11450005
114600                                                                  11460005
114700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11470005
114800             PERFORM 2150-SELECT-ALL-ITEMS                        11480005
114900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11490005
115000                                                                  11500005
115100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11510005
115200             IF  ASC-USE-SELECTION-QUEUE                          11520005
115300                 PERFORM 1130-GET-NEXT-RECORD                     11530005
115400                 IF PS-LIST-END                                   11540005
115500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11550005
115600                     SET PS-NO-LIST-END TO TRUE                   11560005
115700                 ELSE                                             11570005
115800                     PERFORM 2050-DELETE-LIST-QUEUE               11580005
115900                     PERFORM 3200-RESET-ATTRIBUTES                11590005
116000                     PERFORM 4000-BUILD-INITIAL-PANEL             11600005
116100                 END-IF                                           11610005
116200              ELSE                                                11620005
116300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11630005
116400*                --- BOTTOM OF LIST ---                           11640005
116500                 MOVE PC-TSYMSG-00070                             11650005
116600                                   TO DP020-MSG-NUMBER            11660005
116700                 SET DP020-MSG-INFORMATIONAL                      11670005
116800                                   TO TRUE                        11680005
116900             END-IF                                               11690005
117000                                                                  11700005
117100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11710005
117200             IF  ASC-USE-SELECTION-QUEUE                          11720005
117300                 PERFORM 1140-GET-PREV-RECORD                     11730005
117400                 IF PS-LIST-END                                   11740005
117500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11750005
117600                     SET PS-NO-LIST-END                           11760005
117700                                   TO TRUE                        11770005
117800                 ELSE                                             11780005
117900                     PERFORM 3200-RESET-ATTRIBUTES                11790005
118000                     PERFORM 4000-BUILD-INITIAL-PANEL             11800005
118100                 END-IF                                           11810005
118200             ELSE                                                 11820005
118300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11830005
118400                 MOVE PC-TSYMSG-00069                             11840005
118500                                   TO DP020-MSG-NUMBER            11850005
118600                 SET DP020-MSG-INFORMATIONAL                      11860005
118700                                   TO TRUE                        11870005
118800             END-IF                                               11880005
118900                                                                  11890005
119000         WHEN OTHER                                               11900005
119100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11910005
119200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11920005
119300                                                                  11930005
119400             IF  PS-NO-ERROR                                      11940005
119500                 SET DP030-CONTINUE-GO                            11950005
119600                                 TO TRUE                          11960005
119700                 PERFORM 2100-CHECK-FUNCTION-KEY                  11970005
119800             ELSE                                                 11980005
119900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11990005
120000                 SET DP030-OVERRIDE-GO                            12000005
120100                                 TO TRUE                          12010005
120200             END-IF                                               12020005
120300     END-EVALUATE.                                                12030005
120400                                                                  12040005
120500 EJECT                                                            12050005
120600*----------------------------------------------------------------*12060005
120700*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12070005
120800*----------------------------------------------------------------*12080005
120900 2050-DELETE-LIST-QUEUE.                                          12090005
121000                                                                  12100005
121100     EXEC CICS                                                    12110005
121200         DELETEQ TS                                               12120005
121300             QUEUE (ASC-LIST-QUEUE-NAME)                          12130005
121400             RESP  (PV-CICS-RESP)                                 12140005
121500     END-EXEC.                                                    12150005
121600                                                                  12160005
121700     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12170005
121800        (PV-CICS-RESP = DFHRESP(QIDERR))                          12180005
121900         CONTINUE                                                 12190005
122000     ELSE                                                         12200005
122100         SET DP013-CICS-ABEND      TO TRUE                        12210005
122200         SET DP013-NO-ROLLBACK     TO TRUE                        12220005
122300                                                                  12230005
122400         MOVE '2050-DELETE-LIST-QUEUE'                            12240005
122500                                   TO DP013-PARAGRAPH             12250005
122600         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12260005
122700                                   TO DP013-MESSAGE-TEXT (1)      12270005
122800         PERFORM DP013-0000-PROCESS-ABEND                         12280005
122900     END-IF.                                                      12290005
123000                                                                  12300005
123100     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12310005
123200 EJECT                                                            12320005
123300*----------------------------------------------------------------*12330005
123400* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12340005
123500* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12350005
123600* CICS ARCHITECTURE API.                                         *12360005
123700*----------------------------------------------------------------*12370005
123800 2100-CHECK-FUNCTION-KEY.                                         12380005
123900                                                                  12390005
124000     EVALUATE TRUE                                                12400005
124100*                                                                 12410005
124200* F15 - RESEND          (LOCAL-FUNC-01)                           12420011
124300*                                                                 12430005
124400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12440005
124500                                                                  12450005
124600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12460012
124700             PERFORM 5000-PREPARE-SEL-QUEUE                       12470005
124840                                                                  12484011
124900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12490005
124910                 IF  ASC-NUMBER-OF-SELECTED-ITEMS =               12491007
124920                     ASC-NUMBER-OF-ITEMS-READ                     12492006
125000                     PERFORM 4700-PROCESS-RESEND-FUNCTION         12500006
125100                         VARYING PV-ITEM  FROM 1 BY 1             12510006
125200                         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN12520006
125300                            OR PS-SOFT-ABORT-ERROR                12530006
125400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12540006
125500                 ELSE                                             12550006
125501                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12550106
125502                     SET DP030-OVERRIDE-GO                        12550206
125503                                       TO TRUE                    12550306
125504                     MOVE PC-TSYMSG-03820                         12550406
125505                                       TO DP020-MSG-NUMBER        12550506
125506                     SET DP020-MSG-WARNING                        12550606
125507                                       TO TRUE                    12550706
125508                 END-IF                                           12550806
125510             ELSE                                                 12551006
125600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12560005
125700                 SET DP030-OVERRIDE-GO                            12570005
125800                                   TO TRUE                        12580005
125900                 MOVE PC-TSYMSG-00057                             12590005
126000                                   TO DP020-MSG-NUMBER            12600005
126100                 SET DP020-MSG-WARNING                            12610005
126200                                   TO TRUE                        12620005
126300             END-IF                                               12630005
126400*                                                                 12640005
126500* F6 - FIRST PAGE                                                 12650005
126600*                                                                 12660005
126700         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  12670005
126800             MOVE +1               TO PV-TOP-ITEM                 12680005
126900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12690005
127000*                                                                 12700005
127100* F7 - PREVIOUS PAGE                                              12710005
127200*                                                                 12720005
127300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12730005
127400             PERFORM 2110-BROWSE-BACKWARD                         12740005
127500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12750005
127600*                                                                 12760005
127700* F8 - NEXT PAGE                                                  12770005
127800*                                                                 12780005
127900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12790005
128000             PERFORM 2120-BROWSE-FORWARD                          12800005
128100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12810005
128200*                                                                 12820005
128300* ENTER KEY                                                       12830005
128400*                                                                 12840005
128500         WHEN DP020-SRC-AID = DP016-ENTER                         12850005
128600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12860005
128700             IF  PS-ERROR                                         12870005
128800                 CONTINUE                                         12880005
128900             ELSE                                                 12890005
129000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12900005
129100             END-IF                                               12910005
129200                                                                  12920005
129300         WHEN OTHER                                               12930005
129400             SET DP013-NO-ROLLBACK                                12940005
129500                 DP013-XCTL-DISPLAY-RESTART                       12950005
129600                 DP013-CICS-ABEND  TO TRUE                        12960005
129700             MOVE '2100-CHECK-FUNCTION-KEY'                       12970005
129800                                   TO DP013-PARAGRAPH             12980005
129900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12990005
130000                                   TO DP013-MESSAGE-TEXT (1)      13000005
130100             PERFORM DP013-0000-PROCESS-ABEND                     13010005
130200     END-EVALUATE.                                                13020005
130300                                                                  13030005
130400 EJECT                                                            13040005
130500*----------------------------------------------------------------*13050005
130600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13060005
130700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13070005
130800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13080005
130900*    MESSAGE.                                                    *13090005
131000*----------------------------------------------------------------*13100005
131100 2110-BROWSE-BACKWARD.                                            13110005
131200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13120005
131300         GIVING PV-TOP-ITEM.                                      13130005
131400*                                                                 13140005
131500     IF  ((PV-TOP-ITEM < +1)                                      13150005
131600       OR (PV-TOP-ITEM = +1))                                     13160005
131700         MOVE +1                   TO PV-TOP-ITEM                 13170005
131800*        -- TOP OF LIST --                                        13180005
131900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13190005
132000         SET DP020-MSG-INFORMATIONAL TO TRUE                      13200005
132100     END-IF.                                                      13210005
132200                                                                  13220005
132300 EJECT                                                            13230005
132400*----------------------------------------------------------------*13240005
132500*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13250005
132600*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13260005
132700*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13270005
132800*----------------------------------------------------------------*13280005
132900 2120-BROWSE-FORWARD.                                             13290005
133000                                                                  13300005
133100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13310005
133200         GIVING PV-TOP-ITEM.                                      13320005
133300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13330005
133400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13340005
133500                                   TO PV-TOP-ITEM                 13350005
133600*        -- BOTTOM OF LIST --                                     13360005
133700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13370005
133800         SET DP020-MSG-INFORMATIONAL                              13380005
133900                                   TO TRUE                        13390005
134000     ELSE                                                         13400005
134100         COMPUTE PV-BOTTOM-ITEM =                                 13410005
134200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13420005
134300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13430005
134400*            -- BOTTOM OF LIST --                                 13440005
134500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13450005
134600             SET DP020-MSG-INFORMATIONAL                          13460005
134700                                   TO TRUE                        13470005
134800         END-IF                                                   13480005
134900     END-IF.                                                      13490005
135000                                                                  13500005
135100 EJECT                                                            13510005
135200*----------------------------------------------------------------*13520005
135300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13530005
135400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13540005
135500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13550005
135600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13560005
135700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13570005
135800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13580005
135900*----------------------------------------------------------------*13590005
136000 2130-CHECK-FOR-JUMP-BROWSE.                                      13600005
136100     SET PS-NO-ERROR               TO TRUE.                       13610005
136200     IF (ASC-START-ITEM-REQUEST = SPACE)                          13620005
136300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13630005
136400                                   TO PV-TOP-ITEM                 13640005
136500     ELSE                                                         13650005
136600         MOVE ASC-START-ITEM-REQUEST                              13660005
136700                                   TO DP010I-UNEDITED-FIELD       13670005
136800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13680005
136900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13690005
137000         SET DP010I-NEGATIVE-NOT-ALLOWED                          13700005
137100                                   TO TRUE                        13710005
137200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13720005
137300              USING DP010I-NUMERIC-EDIT-AREA                      13730005
137400                                                                  13740005
137500         IF  NOT DP010I-ERROR-DETECTED                            13750005
137600             MOVE DP010I-NUMERIC-FIELD                            13760005
137700                                   TO  ASC-START-ITEM-REQUEST-N   13770005
137800             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13780005
137900                 IF  ASC-START-ITEM-REQUEST-N >                   13790005
138000                                          ASC-NUMBER-OF-ITEMS-READ13800005
138100                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13810005
138200                     COMPUTE PV-TOP-ITEM =                        13820005
138300                             ASC-NUMBER-OF-ITEMS-READ             13830005
138400                             - PC-ITEMS-PER-PANEL + 1             13840005
138500                     IF  PV-TOP-ITEM < +1                         13850005
138600                         MOVE +1   TO PV-TOP-ITEM                 13860005
138700                         MOVE PC-TSYMSG-00070                     13870005
138800                                   TO DP020-MSG-NUMBER            13880005
138900                         SET DP020-MSG-INFORMATIONAL              13890005
139000                                   TO TRUE                        13900005
139100                     END-IF                                       13910005
139200                 ELSE                                             13920005
139300                     MOVE ASC-START-ITEM-REQUEST-N                13930005
139400                                   TO PV-TOP-ITEM                 13940005
139500                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13950005
139600                     COMPUTE PV-BOTTOM-ITEM =                     13960005
139700                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13970005
139800                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13980005
139900*                        -- BOTTOM OF LIST --                     13990005
140000                         MOVE PC-TSYMSG-00070                     14000005
140100                                   TO DP020-MSG-NUMBER            14010005
140200                         SET DP020-MSG-INFORMATIONAL              14020005
140300                                   TO TRUE                        14030005
140400                     END-IF                                       14040005
140500                 END-IF                                           14050005
140600             ELSE                                                 14060005
140700*                --- VALUE OUT OF RANGE ----                      14070005
140800                 MOVE PC-TSYMSG-00101                             14080005
140900                                   TO DP020-MSG-NUMBER            14090005
141000                 MOVE -1           TO ASTRTITL                    14100005
141100                 SET DP030-SET-CURSOR-APPL-1                      14110005
141200                                   TO TRUE                        14120005
141300                 MOVE DP015-REVERSE                               14130005
141400                                   TO ASTRTITH                    14140005
141500                 MOVE DP015-RED    TO ASTRTITC                    14150005
141600                 MOVE DP015-UNP-NUM-BRT-MDT                       14160005
141700                                   TO ASTRTITA                    14170005
141800                 SET DP020-MSG-FATAL                              14180005
141900                                   TO TRUE                        14190005
142000                 SET PS-ERROR      TO TRUE                        14200005
142100             END-IF                                               14210005
142200                                                                  14220005
142300         ELSE                                                     14230005
142400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14240005
142500             MOVE -1               TO ASTRTITL                    14250005
142600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14260005
142700             MOVE DP015-REVERSE    TO ASTRTITH                    14270005
142800             MOVE DP015-RED        TO ASTRTITC                    14280005
142900             MOVE DP015-UNP-NUM-BRT-MDT                           14290005
143000                                   TO ASTRTITA                    14300005
143100             SET DP020-MSG-FATAL   TO TRUE                        14310005
143200             SET PS-ERROR          TO TRUE                        14320005
143300         END-IF                                                   14330005
143400     END-IF.                                                      14340005
143500                                                                  14350005
143600 EJECT                                                            14360005
143700*----------------------------------------------------------------*14370005
143800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14380005
143900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14390005
144000*----------------------------------------------------------------*14400005
144100 2140-DESELECT-ALL-ITEMS.                                         14410005
144200     MOVE +1                       TO ASC-BLK-SUB.                14420005
144300                                                                  14430005
144400     PERFORM 2141-CLEAR-SELECTED-INDS                             14440005
144500         VARYING ASC-ITEM-SUB                                     14450005
144600         FROM 1 BY 1                                              14460005
144700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14470005
144800                                                                  14480005
144900     ADD +1                        TO ASC-BLK-SUB.                14490005
145000                                                                  14500005
145100     PERFORM 2141-CLEAR-SELECTED-INDS                             14510005
145200         VARYING ASC-ITEM-SUB                                     14520005
145300         FROM 1 BY 1                                              14530005
145400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14540005
145500                                                                  14550005
145600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14560005
145700                                   TO PV-LIST-ITEM-NUMBER.        14570005
145800                                                                  14580005
145900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14590005
146000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14600005
146100                                                                  14610005
146200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14620005
146300        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      14630005
146400         MOVE +1                   TO ASC-BLK-SUB                 14640005
146500                                                                  14650005
146600         PERFORM 5100-WRITE-TEMP-STORAGE                          14660005
146700                                                                  14670005
146800         MOVE +1                   TO PV-BLOCK-NUMBER             14680005
146900                                                                  14690005
147000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14700005
147100             PV-FIRST-BLOCK-IN-ARRAY - 1                          14710005
147200                                                                  14720005
147300         PERFORM                                                  14730005
147400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14740005
147500                                                                  14750005
147600             PERFORM 4410-READ-TEMP-STORAGE                       14760005
147700                                                                  14770005
147800             PERFORM 2141-CLEAR-SELECTED-INDS                     14780005
147900                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 14790005
148000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14800005
148100                                                                  14810005
148200             PERFORM 5100-WRITE-TEMP-STORAGE                      14820005
148300                                                                  14830005
148400             ADD +1                TO PV-BLOCK-NUMBER             14840005
148500                                                                  14850005
148600         END-PERFORM                                              14860005
148700                                                                  14870005
148800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14880005
148900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14890005
149000                                                                  14900005
149100         PERFORM                                                  14910005
149200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14920005
149300                   ASC-HIGHEST-BLOCK-WRITTEN                      14930005
149400                                                                  14940005
149500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14950005
149600                                   TO PV-BLOCK-NUMBER             14960005
149700                                                                  14970005
149800             PERFORM 4410-READ-TEMP-STORAGE                       14980005
149900                                                                  14990005
150000             PERFORM 2141-CLEAR-SELECTED-INDS                     15000005
150100                 VARYING ASC-ITEM-SUB                             15010005
150200                 FROM 1 BY 1                                      15020005
150300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15030005
150400                                                                  15040005
150500             PERFORM 5100-WRITE-TEMP-STORAGE                      15050005
150600                                                                  15060005
150700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15070005
150800                                                                  15080005
150900         END-PERFORM                                              15090005
151000                                                                  15100005
151100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15110005
151200                                   TO PV-BLOCK-NUMBER             15120005
151300                                                                  15130005
151400         PERFORM 4410-READ-TEMP-STORAGE                           15140005
151500     END-IF.                                                      15150005
151600                                                                  15160005
151700                                                                  15170005
151800     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 15180005
151900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15190005
152000     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15200005
152100                                                                  15210005
152200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15220005
152300                                                                  15230005
152400 EJECT                                                            15240005
152500*----------------------------------------------------------------*15250005
152600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15260005
152700*----------------------------------------------------------------*15270005
152800 2141-CLEAR-SELECTED-INDS.                                        15280005
152900                                                                  15290005
153000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15300005
153100             NOT EQUAL ZERO                                       15310005
153200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15320005
153300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15330005
153400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15340005
153500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15350005
153600                                   TO TRUE                        15360005
153700         END-IF                                                   15370005
153800     END-IF.                                                      15380005
153900                                                                  15390005
154000 EJECT                                                            15400005
154100*----------------------------------------------------------------*15410005
154200*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15420005
154300*  FOR ALL ITEMS.                                                *15430005
154400*----------------------------------------------------------------*15440005
154500 2150-SELECT-ALL-ITEMS.                                           15450005
154600                                                                  15460005
154700     MOVE +1                       TO ASC-BLK-SUB.                15470005
154800                                                                  15480005
154900     PERFORM 2151-SET-SELECTED-INDS                               15490005
155000         VARYING ASC-ITEM-SUB                                     15500005
155100         FROM 1 BY 1                                              15510005
155200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15520005
155300                                                                  15530005
155400     ADD +1                        TO ASC-BLK-SUB.                15540005
155500                                                                  15550005
155600     PERFORM 2151-SET-SELECTED-INDS                               15560005
155700         VARYING ASC-ITEM-SUB                                     15570005
155800         FROM 1 BY 1                                              15580005
155900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15590005
156000                                                                  15600005
156100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15610005
156200                                   TO PV-LIST-ITEM-NUMBER.        15620005
156300                                                                  15630005
156400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15640005
156500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15650005
156600                                                                  15660005
156610* 2023 - BEGIN                                                    15661016
156620     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            15662010
156630         MOVE +1                   TO ASC-BLK-SUB                 15663010
156640                                                                  15664010
156650         PERFORM 5100-WRITE-TEMP-STORAGE                          15665010
156660         MOVE +2                   TO ASC-BLK-SUB                 15666010
156670         PERFORM 5100-WRITE-TEMP-STORAGE                          15667010
156680         MOVE +1                   TO ASC-BLK-SUB                 15668010
156690         MOVE +1                   TO PV-BLOCK-NUMBER             15669010
156691     END-IF.                                                      15669110
156692* 2023 - END                                                      15669216
156693                                                                  15669310
156700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15670005
156800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15680005
156900         MOVE +1                   TO ASC-BLK-SUB                 15690005
157000                                                                  15700005
157100         PERFORM 5100-WRITE-TEMP-STORAGE                          15710005
157200                                                                  15720005
157300         MOVE +1                   TO PV-BLOCK-NUMBER             15730005
157400                                                                  15740005
157500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15750005
157600             PV-FIRST-BLOCK-IN-ARRAY - 1                          15760005
157700                                                                  15770005
157800         PERFORM                                                  15780005
157900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15790005
158000                                                                  15800005
158100             PERFORM 4410-READ-TEMP-STORAGE                       15810005
158200                                                                  15820005
158300             PERFORM 2151-SET-SELECTED-INDS                       15830005
158400                 VARYING ASC-ITEM-SUB                             15840005
158500                 FROM 1 BY 1                                      15850005
158600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15860005
158700                                                                  15870005
158800             PERFORM 5100-WRITE-TEMP-STORAGE                      15880005
158900                                                                  15890005
159000             ADD +1                TO PV-BLOCK-NUMBER             15900005
159100                                                                  15910005
159200         END-PERFORM                                              15920005
159300                                                                  15930005
159400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15940005
159500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15950005
159600                                                                  15960005
159700         PERFORM                                                  15970005
159800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15980005
159900                   ASC-HIGHEST-BLOCK-WRITTEN                      15990005
160000                                                                  16000005
160100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16010005
160200                                   TO PV-BLOCK-NUMBER             16020005
160300                                                                  16030005
160400             PERFORM 4410-READ-TEMP-STORAGE                       16040005
160500                                                                  16050005
160600             PERFORM 2151-SET-SELECTED-INDS                       16060005
160700                 VARYING ASC-ITEM-SUB                             16070005
160800                 FROM 1 BY 1                                      16080005
160900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16090005
161000                                                                  16100005
161100             PERFORM 5100-WRITE-TEMP-STORAGE                      16110005
161200                                                                  16120005
161300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16130005
161400                                                                  16140005
161500         END-PERFORM                                              16150005
161600                                                                  16160005
161700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16170005
161800                                   TO PV-BLOCK-NUMBER             16180005
161900                                                                  16190005
162000         PERFORM 4410-READ-TEMP-STORAGE                           16200005
162100     END-IF.                                                      16210005
162200                                                                  16220005
162300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16230005
162400                       ASC-NUMBER-OF-SELECTED-ITEMS.              16240005
162500                                                                  16250005
162600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16260005
162700                                                                  16270005
162800 EJECT                                                            16280005
162900*----------------------------------------------------------------*16290005
163000*    MARK EACH ITEM AS BEING SELECTED.                           *16300005
163100*----------------------------------------------------------------*16310005
163200 2151-SET-SELECTED-INDS.                                          16320005
163300                                                                  16330005
163400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16340005
163500             NOT EQUAL ZERO                                       16350005
163600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16360005
163700             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16370005
163800                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16380005
163900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16390005
164000                               TO  TRUE                           16400005
164100         END-IF                                                   16410005
164200     END-IF.                                                      16420005
164300                                                                  16430005
164400 EJECT                                                            16440005
164500******************************************************************16450005
164600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **16460005
164700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **16470005
164800******************************************************************16480005
164900 2200-MOVE-SCREEN-TO-COMMAREA.                                    16490005
165000                                                                  16500005
165100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16510005
165200     MOVE +1                       TO PV-SUB.                     16520005
165300*                                                                 16530005
165400     PERFORM 3100-SET-SUBSCRIPTS.                                 16540005
165500     IF  ASTRTITL > ZERO                                          16550005
165600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          16560005
165700     ELSE                                                         16570005
165800         IF  ASTRTITF = DP015-ERASE-EOF                           16580005
165900             INITIALIZE ASC-START-ITEM-REQUEST                    16590005
166000         END-IF                                                   16600005
166100     END-IF.                                                      16610005
166200                                                                  16620005
166300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16630005
166400         VARYING PV-SUB                                           16640005
166500         FROM 1 BY 1                                              16650005
166600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16660005
166700                                                                  16670005
166800 EJECT                                                            16680005
166900******************************************************************16690005
167000** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**16700005
167100******************************************************************16710005
167200 2210-MOVE-LINES-TO-COMMAREA.                                     16720005
167300     IF  MR-SELECTL (PV-SUB) > ZERO                               16730005
167400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16740005
167500         MOVE MR-SELECTI (PV-SUB)                                 16750005
167600                                   TO ASC-TEMP-SELECTED-SW        16760005
167700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16770005
167800     ELSE                                                         16780005
167900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                16790005
168000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     16800005
168100                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        16810005
168200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16820005
168300         END-IF                                                   16830005
168400     END-IF.                                                      16840005
168500                                                                  16850005
168600     ADD +1                        TO ASC-ITEM-SUB.               16860005
168700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16870005
168800         ADD +1                    TO ASC-BLK-SUB                 16880005
168900         MOVE +1                   TO ASC-ITEM-SUB                16890005
169000     END-IF.                                                      16900005
169100                                                                  16910005
169200 EJECT                                                            16920005
169300******************************************************************16930005
169400** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **16940005
169500** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **16950005
169600******************************************************************16960005
169700 3000-EDIT-DATA-IN-COMMAREA.                                      16970005
169800     SET PS-NO-ERROR               TO TRUE.                       16980005
169900     PERFORM 3200-RESET-ATTRIBUTES.                               16990005
170000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17000005
170100                                                                  17010005
170200**                                                                17020005
170300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17030005
170400* EDITTING IS DONE FROM THE BOTTOM UP.                            17040005
170500**                                                                17050005
170600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17060005
170700         ASC-ITEMS-DISPLAYED - 1.                                 17070005
170800     PERFORM 3100-SET-SUBSCRIPTS.                                 17080005
170900     PERFORM 3300-EDIT-SELECTIONS                                 17090005
171000         VARYING PV-SUB                                           17100005
171100         FROM PV-SUB BY -1                                        17110005
171200         UNTIL PV-SUB < +1                                        17120005
171300*                                                                 17130005
171400     IF  PS-NO-ERROR                                              17140005
171500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        17150005
171600     END-IF.                                                      17160005
171700*                                                                 17170005
171800     IF  ((PS-NO-ERROR)                                           17180005
171900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   17190005
172000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    17200005
172100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  17210005
172200     END-IF.                                                      17220005
172300                                                                  17230005
172400 EJECT                                                            17240005
172500*----------------------------------------------------------------*17250005
172600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17260005
172700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17270005
172800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17280005
172900*                                                                *17290005
173000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17300005
173100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17310005
173200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17320005
173300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17330005
173400*----------------------------------------------------------------*17340005
173500 3100-SET-SUBSCRIPTS.                                             17350005
173600                                                                  17360005
173700     COMPUTE ASC-ITEM-SUB =                                       17370005
173800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17380005
173900                                                                  17390005
174000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17400005
174100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17410005
174200                                                                  17420005
174300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               17430005
174400     ELSE                                                         17440005
174500         MOVE +1                     TO ASC-BLK-SUB               17450005
174600     END-IF.                                                      17460005
174700                                                                  17470005
174800 EJECT                                                            17480005
174900******************************************************************17490005
175000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **17500005
175100******************************************************************17510005
175200 3200-RESET-ATTRIBUTES.                                           17520005
175300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   17530005
175400                                                                  17540005
175500     MOVE DP015-GREEN              TO ASTRTITC.                   17550005
175600                                                                  17560005
175700     MOVE DP015-UNDERLINE          TO ASTRTITH.                   17570005
175800*                                                                 17580005
175900     PERFORM                                                      17590005
176000         VARYING PV-SUB                                           17600005
176100         FROM 1 BY 1                                              17610005
176200         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        17620005
176300         MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)        17630005
176400         MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)        17640005
176500         MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)        17650005
176600     END-PERFORM.                                                 17660005
176700                                                                  17670005
176800 EJECT                                                            17680005
176900******************************************************************17690005
177000** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **17700005
177100** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **17710005
177200** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **17720005
177300** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **17730005
177400******************************************************************17740005
177500 3300-EDIT-SELECTIONS.                                            17750005
177600                                                                  17760005
177700     EVALUATE TRUE                                                17770005
177800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17780005
177900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         17790005
178000                 CONTINUE                                         17800005
178100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         17810005
178200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        17820005
178300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   17830005
178400                 MOVE ASC-TEMP-SELECTED-SW                        17840005
178500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17850005
178600                                TO ASC-SELECTED-SW                17860005
178700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17870005
178800             END-IF                                               17880005
178900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17890005
179000                 = SPACE                                          17900005
179100             EVALUATE TRUE                                        17910005
179200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       17920005
179300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS17930005
179400                     MOVE SPACE TO ASC-SELECTED-SW                17940005
179500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17950005
179600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        17960005
179700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    17970005
179800                     MOVE SPACE TO ASC-SELECTED-SW                17980005
179900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17990005
180000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18000005
180100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      18010005
180200                     MOVE SPACE TO ASC-SELECTED-SW                18020005
180300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18030005
180400             END-EVALUATE                                         18040005
180500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18050005
180600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18060005
180700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18070005
180800             END-IF                                               18080005
180900             PERFORM 3310-EDIT-RANGE                              18090005
181000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18100005
181100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18110005
181200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18120005
181300             END-IF                                               18130005
181400             PERFORM 3310-EDIT-RANGE                              18140005
181500         WHEN OTHER                                               18150005
181600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           18160005
181700             SET DP020-MSG-FATAL    TO TRUE                       18170005
181800             MOVE -1                TO MR-SELECTL (PV-SUB)        18180005
181900             SET DP030-SET-CURSOR-APPL-1                          18190005
182000                                    TO TRUE                       18200005
182100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        18210005
182200             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        18220005
182300             SET PS-ERROR TO TRUE                                 18230005
182400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18240005
182500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18250005
182600                 MOVE SPACE         TO ASC-SELECTED-SW            18260005
182700                                        (ASC-BLK-SUB ASC-ITEM-SUB)18270005
182800             END-IF                                               18280005
182900     END-EVALUATE.                                                18290005
183000                                                                  18300005
183100     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 18310005
183200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18320005
183300     IF  ASC-ITEM-SUB < 1                                         18330005
183400         SUBTRACT +1 FROM ASC-BLK-SUB                             18340005
183500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                18350005
183600     END-IF.                                                      18360005
183700                                                                  18370005
183800 EJECT                                                            18380005
183900******************************************************************18390005
184000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **18400005
184100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **18410005
184200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**18420005
184300** THE ENDING.                                                  **18430005
184400******************************************************************18440005
184500 3310-EDIT-RANGE.                                                 18450005
184600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                18460005
184700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   18470005
184800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)18480005
184900                                   TO ASC-SELECTED-SW             18490005
185000                                        (ASC-BLK-SUB ASC-ITEM-SUB)18500005
185100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 18510005
185200         ELSE                                                     18520005
185300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     18530005
185400                 CONTINUE                                         18540005
185500             ELSE                                                 18550005
185600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        18560005
185700                 MOVE PC-TSYMSG-00054                             18570005
185800                                   TO DP020-MSG-NUMBER            18580005
185900                 SET DP020-MSG-FATAL                              18590005
186000                                   TO TRUE                        18600005
186100                 MOVE -1           TO MR-SELECTL (PV-SUB)         18610005
186200                 SET DP030-SET-CURSOR-APPL-1                      18620005
186300                                   TO TRUE                        18630005
186400                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         18640005
186500                 MOVE DP015-UNDERLINE                             18650005
186600                                   TO MR-SELECTH (PV-SUB)         18660005
186700                 SET PS-ERROR      TO TRUE                        18670005
186800             END-IF                                               18680005
186900         END-IF                                                   18690005
187000     ELSE                                                         18700005
187100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     18710005
187200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18720005
187300                                   TO ASC-SELECTED-SW             18730005
187400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18740005
187500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   18750005
187600         ELSE                                                     18760005
187700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       18770005
187800                 CONTINUE                                         18780005
187900             ELSE                                                 18790005
188000*                -- ONLY ONE END-OF-RANGE ALLOWED --              18800005
188100                 MOVE PC-TSYMSG-00055                             18810005
188200                                   TO DP020-MSG-NUMBER            18820005
188300                 SET DP020-MSG-FATAL                              18830005
188400                                   TO TRUE                        18840005
188500                 MOVE -1           TO MR-SELECTL (PV-SUB)         18850005
188600                 SET DP030-SET-CURSOR-APPL-1                      18860005
188700                                   TO TRUE                        18870005
188800                 SET PS-ERROR      TO TRUE                        18880005
188900             END-IF                                               18890005
189000         END-IF                                                   18900005
189100     END-IF.                                                      18910005
189200*                                                                 18920005
189300******************************************************************18930005
189400** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **18940005
189500** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **18950005
189600******************************************************************18960005
189700 3400-CHECK-RANGE-SEQUENCE.                                       18970005
189800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       18980005
189900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      18990005
190000       AND  ASC-START-OF-SELECTED-RANGE >                         19000005
190100                                         ASC-END-OF-SELECTED-RANGE19010005
190200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                19020005
190300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 19030005
190400         SET DP020-MSG-FATAL TO TRUE                              19040005
190500         SET PS-ERROR TO TRUE                                     19050005
190600         PERFORM 3410-POSITION-AT-ERROR                           19060005
190700     END-IF.                                                      19070005
190800******************************************************************19080005
190900** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **19090005
191000** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **19100005
191100** SHOULD BE POSITIONED ON A RANGE ERROR.                       **19110005
191200******************************************************************19120005
191300 3410-POSITION-AT-ERROR.                                          19130005
191400     SET DP030-SET-CURSOR-APPL-1                                  19140005
191500                                   TO TRUE.                       19150005
191600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 19160005
191700                    - PV-TOP-ITEM + 1.                            19170005
191800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19180005
191900         CONTINUE                                                 19190005
192000     ELSE                                                         19200005
192100         MOVE -1                   TO MR-SELECTL (PV-SUB)         19210005
192200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19220005
192300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19230005
192400     END-IF.                                                      19240005
192500*                                                                 19250005
192600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   19260005
192700                    - PV-TOP-ITEM + 1.                            19270005
192800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19280005
192900         CONTINUE                                                 19290005
193000     ELSE                                                         19300005
193100         MOVE -1                   TO MR-SELECTL (PV-SUB)         19310005
193200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19320005
193300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19330005
193400     END-IF.                                                      19340005
193500 EJECT                                                            19350005
193600*----------------------------------------------------------------*19360005
193700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *19370005
193800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *19380005
193900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *19390005
194000*----------------------------------------------------------------*19400005
194100 3500-MARK-RANGE-AS-SELECTED.                                     19410005
194200     MOVE +1                       TO  ASC-BLK-SUB.               19420005
194300     PERFORM 3510-MARK-SELECTED-INDS                              19430005
194400         VARYING ASC-ITEM-SUB                                     19440005
194500         FROM 1 BY 1                                              19450005
194600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19460005
194700                                                                  19470005
194800     ADD +1                        TO ASC-BLK-SUB.                19480005
194900     PERFORM 3510-MARK-SELECTED-INDS                              19490005
195000         VARYING ASC-ITEM-SUB                                     19500005
195100         FROM 1 BY 1                                              19510005
195200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19520005
195300                                                                  19530005
195400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19540005
195500                                   TO  PV-LIST-ITEM-NUMBER.       19550005
195600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19560005
195700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         19570005
195800               PC-ITEMS-PER-PANEL).                               19580005
195900                                                                  19590005
196000     MOVE ASC-START-OF-SELECTED-RANGE                             19600005
196100                                   TO PV-START-OF-SELECTED-RANGE. 19610005
196200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            19620005
196300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  19630005
196400               PC-ITEMS-PER-PANEL).                               19640005
196500                                                                  19650005
196600     MOVE ASC-END-OF-SELECTED-RANGE                               19660005
196700                                   TO  PV-END-OF-SELECTED-RANGE.  19670005
196800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             19680005
196900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    19690005
197000               PC-ITEMS-PER-PANEL).                               19700005
197100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             19710005
197200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             19720005
197300                                                                  19730005
197400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19740005
197500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19750005
197600         MOVE +1                   TO ASC-BLK-SUB                 19760005
197700         PERFORM 5100-WRITE-TEMP-STORAGE                          19770005
197800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19780005
197900             PV-FIRST-BLOCK-IN-ARRAY - 1                          19790005
198000                                                                  19800005
198100         PERFORM                                                  19810005
198200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      19820005
198300                   PV-PREV-BLOCK-IN-ARRAY                         19830005
198400             MOVE PV-FIRST-BLOCK-IN-RANGE                         19840005
198500                                   TO PV-BLOCK-NUMBER             19850005
198600             PERFORM 4410-READ-TEMP-STORAGE                       19860005
198700             PERFORM 3510-MARK-SELECTED-INDS                      19870005
198800                 VARYING ASC-ITEM-SUB                             19880005
198900                 FROM 1 BY 1                                      19890005
199000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19900005
199100             PERFORM 5100-WRITE-TEMP-STORAGE                      19910005
199200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     19920005
199300         END-PERFORM                                              19930005
199400                                                                  19940005
199500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19950005
199600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19960005
199700         PERFORM                                                  19970005
199800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19980005
199900                   PV-LAST-BLOCK-IN-RANGE                         19990005
200000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20000005
200100                                   TO PV-BLOCK-NUMBER             20010005
200200             PERFORM 4410-READ-TEMP-STORAGE                       20020005
200300             PERFORM 3510-MARK-SELECTED-INDS                      20030005
200400                 VARYING ASC-ITEM-SUB                             20040005
200500                 FROM 1 BY 1                                      20050005
200600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20060005
200700             PERFORM 5100-WRITE-TEMP-STORAGE                      20070005
200800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20080005
200900         END-PERFORM                                              20090005
201000                                                                  20100005
201100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20110005
201200                                   TO PV-BLOCK-NUMBER             20120005
201300         PERFORM 4410-READ-TEMP-STORAGE                           20130005
201400     END-IF.                                                      20140005
201500                                                                  20150005
201600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 20160005
201700                                      ASC-END-OF-SELECTED-RANGE.  20170005
201800                                                                  20180005
201900 EJECT                                                            20190005
202000*----------------------------------------------------------------*20200005
202100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *20210005
202200*----------------------------------------------------------------*20220005
202300 3510-MARK-SELECTED-INDS.                                         20230005
202400                                                                  20240005
202500     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20250005
202600                                ASC-ITEM-SUB) >                   20260005
202700         ASC-START-OF-SELECTED-RANGE)                             20270005
202800     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20280005
202900                                ASC-ITEM-SUB) =                   20290005
203000         ASC-START-OF-SELECTED-RANGE)                             20300005
203100                                                                  20310005
203200         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20320005
203300                                    ASC-ITEM-SUB) <               20330005
203400             ASC-END-OF-SELECTED-RANGE)                           20340005
203500         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20350005
203600                                    ASC-ITEM-SUB) =               20360005
203700             ASC-END-OF-SELECTED-RANGE)                           20370005
203800                                                                  20380005
203900             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20390005
204000                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   20400005
204100                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   20410005
204200                               TO TRUE                            20420005
204300                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              20430005
204400                               TO TRUE                            20440005
204500                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    20450005
204600             END-IF                                               20460005
204700         END-IF                                                   20470005
204800     END-IF.                                                      20480005
204900                                                                  20490005
205000 EJECT                                                            20500005
205100*----------------------------------------------------------------*20510005
205200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *20520005
205300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *20530005
205400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *20540005
205500*    DISPLAY THE PANEL TO USER.                                  *20550005
205600*----------------------------------------------------------------*20560005
205700 4000-BUILD-INITIAL-PANEL.                                        20570005
205800                                                                  20580005
205900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            20590005
206000                                 ASC-BLOCK-ENTRIES (2).           20600005
206100     MOVE +1                 TO ASC-BLK-SUB.                      20610005
206200     SET ASC-ITEMS-LEFT-ON-DB                                     20620005
206300                             TO TRUE.                             20630005
206400                                                                  20640005
206500     MOVE +0                 TO ASC-ITEM-SUB                      20650005
206600                                ASC-NUMBER-OF-ITEMS-READ          20660005
206700                                ASC-NUMBER-OF-SELECTED-ITEMS      20670005
206800                                ASC-HIGHEST-BLOCK-WRITTEN         20680005
206900                                ASC-START-OF-SELECTED-RANGE       20690005
207000                                ASC-END-OF-SELECTED-RANGE         20700005
207100                                ASC-ITEM-AT-TOP-OF-PANEL.         20710005
207200                                                                  20720005
207300     PERFORM 4100-PREPARE-CURSOR                                  20730005
207400                                                                  20740005
207500     PERFORM 4010-OPEN-CURSOR.                                    20750005
207600                                                                  20760005
207700     PERFORM 4300-READ-ITEMS-FROM-DB.                             20770005
207800                                                                  20780005
207900     PERFORM 4020-CLOSE-CURSOR.                                   20790005
208000                                                                  20800005
208100     MOVE +1                   TO  PV-TOP-ITEM.                   20810005
208200     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          20820005
208300         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    20830005
208400         SET DP020-MSG-FATAL   TO  TRUE                           20840005
208500         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               20850005
208600     ELSE                                                         20860005
208700         MOVE -1               TO MR-SELECTL (1)                  20870005
208800         SET DP030-SET-CURSOR-APPL-1                              20880005
208900                               TO TRUE                            20890005
209000         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     20900005
209100     END-IF.                                                      20910005
209200                                                                  20920005
209300 EJECT                                                            20930005
209400*----------------------------------------------------------------*20940005
209500* OPEN THE LINE CURSOR.                                          *20950005
209600*----------------------------------------------------------------*20960005
209700 4010-OPEN-CURSOR.                                                20970005
209800                                                                  20980005
209900     PERFORM                                                      20990005
210000         WITH TEST AFTER                                          21000005
210100         VARYING PV-RETRY-COUNTER                                 21010005
210200         FROM 1 BY 1                                              21020005
210300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21030005
210400                   OR (SQLCODE = ZERO))                           21040005
210500                                                                  21050005
210600         MOVE 'CURSOR:  LINE-ITEM-CSR'                            21060005
210700                              TO DP013-MESSAGE-TEXT (2)           21070005
210800         EXEC SQL                                                 21080005
210900              OPEN LINE-ITEM-CSR                                  21090005
211000         END-EXEC                                                 21100005
211100                                                                  21110005
211200         EVALUATE TRUE                                            21120005
211300             WHEN SQLCODE = ZERO                                  21130005
211400             WHEN SQLCODE = -904                                  21140005
211500             WHEN SQLCODE = -913                                  21150005
211600                 CONTINUE                                         21160005
211700             WHEN SQLWARN0 NOT = SPACES                           21170005
211800             WHEN SQLCODE < ZERO                                  21180005
211900             WHEN SQLCODE > ZERO                                  21190005
212000                 MOVE '4010-OPEN-CURSOR'                          21200005
212100                                   TO DP013-PARAGRAPH             21210005
212200                 MOVE 'OPEN LINE ITEM CURSOR - '                  21220005
212300                                   TO DP013-MESSAGE-TEXT (1)      21230005
212400                 MOVE SQLCA        TO DP013-SQLCA                 21240005
212500                 MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)    21250005
212600                 SET DP013-DB2-ABEND                              21260005
212700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           21270005
212800                 PERFORM DP013-0000-PROCESS-ABEND                 21280005
212900         END-EVALUATE                                             21290005
213000     END-PERFORM                                                  21300005
213100*                                                                 21310005
213200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21320005
213300         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             21330005
213400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   21340005
213500                                   TO DP013-MESSAGE-TEXT (1)      21350005
213600         MOVE SQLCA                TO DP013-SQLCA                 21360005
213700         MOVE 'TCEPLIT '           TO DP013-DB2-TABLE-NAME (1)    21370005
213800         SET DP013-DB2-ABEND                                      21380005
213900             DP013-XCTL-DISPLAY-RESTART                           21390005
214000                                   TO TRUE                        21400005
214100         PERFORM DP013-0000-PROCESS-ABEND                         21410005
214200     END-IF.                                                      21420005
214300                                                                  21430005
214400 EJECT                                                            21440005
214500*----------------------------------------------------------------*21450005
214600* CLOSE THE LINE ITEM CURSOR.                                    *21460005
214700*----------------------------------------------------------------*21470005
214800 4020-CLOSE-CURSOR.                                               21480005
214900                                                                  21490005
215000     EXEC SQL                                                     21500005
215100          CLOSE LINE-ITEM-CSR                                     21510005
215200     END-EXEC.                                                    21520005
215300*                                                                 21530005
215400     EVALUATE TRUE                                                21540005
215500         WHEN SQLCODE = ZERO                                      21550005
215600             CONTINUE                                             21560005
215700         WHEN SQLWARN0 NOT = SPACES                               21570005
215800         WHEN SQLCODE < ZERO                                      21580005
215900         WHEN SQLCODE > ZERO                                      21590005
216000             MOVE '4020-CLOSE-CURSOR'                             21600005
216100                               TO DP013-PARAGRAPH                 21610005
216200             MOVE 'CLOSE LINE ITEM CURSOR'                        21620005
216300                               TO DP013-MESSAGE-TEXT (1)          21630005
216400             MOVE SQLCA        TO DP013-SQLCA                     21640005
216500             MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)        21650005
216600             SET DP013-DB2-ABEND                                  21660005
216700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21670005
216800             PERFORM DP013-0000-PROCESS-ABEND                     21680005
216900     END-EVALUATE.                                                21690005
217000                                                                  21700005
217100 EJECT                                                            21710005
217200*----------------------------------------------------------------*21720005
217300*    SET UP THE HOST VARIABLES.                                  *21730005
217400*----------------------------------------------------------------*21740005
217500 4100-PREPARE-CURSOR.                                             21750005
217600                                                                  21760005
217700     IF  DP020-INT-APPL-FORMAT-IND = (PC-CRIT-SPEC-FORMAT)        21770005
217800         MOVE CE001-PULL-NBR       TO DK-PULL-NUMBER              21780005
217900     ELSE                                                         21790005
218000         MOVE CE002-PULL-NBR       TO DK-PULL-NUMBER              21800005
218100     END-IF.                                                      21810005
218200                                                                  21820005
218300*----------------------------------------------------------------*21830005
218400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21840005
218500*    BLOCKS IN THE ARRAY. WHENEVER BOTH BLOCKS BECOME FULL,      *21850005
218600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21860005
218700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21870005
218800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21880005
218900*                                                                *21890005
219000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21900005
219100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21910005
219200*    UPON INITIALIZATION.                                        *21920005
219300*----------------------------------------------------------------*21930005
219400 4300-READ-ITEMS-FROM-DB.                                         21940005
219500                                                                  21950005
219600     PERFORM                                                      21960005
219700         VARYING PV-READ-COUNT                                    21970005
219800         FROM 1 BY 1                                              21980005
219900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21990005
220000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         22000005
220100                                                                  22010005
220200         PERFORM 4310-FETCH                                       22020005
220300                                                                  22030005
220400         IF  ASC-ITEMS-LEFT-ON-DB                                 22040005
220500             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                22050005
220600                 ADD +1            TO ASC-ITEM-SUB                22060005
220700             ELSE                                                 22070005
220800                 ADD +1            TO ASC-BLK-SUB                 22080005
220900                 MOVE +1           TO ASC-ITEM-SUB                22090005
221000                                                                  22100005
221100                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         22110005
221200                     MOVE +1       TO ASC-BLK-SUB                 22120005
221300                     SET ASC-BLOCK-MODIFIED (1)                   22130005
221400                                   TO TRUE                        22140005
221500                     PERFORM 5100-WRITE-TEMP-STORAGE              22150005
221600                     MOVE ASC-BLOCK-ENTRIES                       22160005
221700                               (PC-MAX-BLOCKS-IN-ARRAY)           22170005
221800                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 22180005
221900                     ADD +1        TO ASC-BLK-SUB                 22190005
222000                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   22200005
222100                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      22210005
222200                                   TO TRUE                        22220005
222300                 END-IF                                           22230005
222400             END-IF                                               22240005
222500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    22250005
222600             MOVE ASC-NUMBER-OF-ITEMS-READ                        22260005
222700                                   TO ASC-LIST-ITEM-NUMBER        22270005
222800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22280005
222900                                                                  22290005
223000             PERFORM 4320-GET-LINE-ITEM                           22300005
223100             PERFORM 4340-GET-ITEM-DISTRO                         22310005
223200             PERFORM 4350-GET-SKU-INFO                            22320005
223300                                                                  22330005
223400             MOVE DK-LINE-NUMBER                                  22340005
223500                              TO  ASC-LINE-NUMBER                 22350005
223600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22360005
223700             MOVE PV-CEPLDS-STORE-COUNT                           22370005
223800                              TO  ASC-NBR-STORES                  22380005
223900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22390005
224000             MOVE PV-CEPLIT-REQ-QTY                               22400005
224100                              TO  ASC-REQ-PULL-UNITS              22410005
224200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22420005
224300             MOVE PV-CEPLIT-ACTL-QTY                              22430005
224400                              TO  ASC-ACT-PULL-UNITS              22440005
224500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22450005
224600             MOVE  PV-CEPLDS-DISTRB-QTY                           22460005
224700                              TO  ASC-DISTRBUTED-UNITS            22470005
224800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22480005
224900             MOVE  PV-PULL-STATUS                                 22490005
225000                               TO ASC-LINE-STATUS-CDE             22500005
225100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22510005
225200             MOVE  PV-SKU-NUMBER                                  22520005
225300                              TO  ASC-SKU-NUMBER                  22530005
225400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22540005
225500             MOVE  PV-SKU-DESCRIPTION                             22550005
225600                              TO  ASC-SKU-DESCRIPTION             22560005
225700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22570005
225800             MOVE  CEPLIT-ITM-NBR                                 22580005
225900                              TO  ASC-LINE-ITEM                   22590005
226000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22600005
226100             MOVE  CEPLIT-UNT-RTL-AMT                             22610005
226200                              TO  ASC-LINE-SKU-RETAIL             22620005
226300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22630005
226400                                                                  22640005
226500             MOVE  CEPLIT-DWNLD-RDM-STAT-CDE                      22650005
226600                              TO  ASC-RDM-STATUS                  22660005
226700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22670005
226800                                                                  22680005
226900             EVALUATE  TRUE                                       22690005
227000                 WHEN  PV-PULL-STATUS-NEW                         22700005
227100                           MOVE  PC-NEW-DESC                      22710005
227200                               TO ASC-LINE-STATUS-DESC            22720005
227300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22730005
227400                 WHEN  PV-PULL-STATUS-CANCELLED                   22740005
227500                           MOVE  PC-PULL-STATUS-CANCELLED         22750005
227600                               TO ASC-LINE-STATUS-DESC            22760005
227700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22770005
227800                 WHEN  PV-PULL-STATUS-INPROCESS                   22780005
227900                           MOVE  PC-IN-PROCESS-DESC               22790005
228000                               TO ASC-LINE-STATUS-DESC            22800005
228100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22810005
228200                 WHEN  PV-PULL-STATUS-DISTRIBTD                   22820005
228300                           MOVE  PC-DISTRIB-DESC                  22830005
228400                               TO ASC-LINE-STATUS-DESC            22840005
228500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22850005
228600                 WHEN  PV-PULL-STATUS-POSTED                      22860005
228700                           MOVE  PC-POSTED-DESC                   22870005
228800                               TO ASC-LINE-STATUS-DESC            22880005
228900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22890005
229000             END-EVALUATE                                         22900005
229100                                                                  22910005
229200         END-IF                                                   22920005
229300     END-PERFORM.                                                 22930005
229400                                                                  22940005
229500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          22950005
229600         MOVE +1               TO ASC-BLK-SUB                     22960005
229700         PERFORM 5100-WRITE-TEMP-STORAGE                          22970005
229800         ADD +1                TO ASC-BLK-SUB                     22980005
229900         PERFORM 5100-WRITE-TEMP-STORAGE                          22990005
230000                                                                  23000005
230100         MOVE 1                TO ASC-BLK-SUB                     23010005
230200                                  PV-BLOCK-NUMBER                 23020005
230300         PERFORM 4410-READ-TEMP-STORAGE                           23030005
230400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             23040005
230500             MOVE 2            TO ASC-BLK-SUB                     23050005
230600                                  PV-BLOCK-NUMBER                 23060005
230700             PERFORM 4410-READ-TEMP-STORAGE                       23070005
230800         END-IF                                                   23080005
230900     END-IF.                                                      23090005
231000                                                                  23100005
231100 EJECT                                                            23110005
231200*----------------------------------------------------------------*23120005
231300*    FETCH THE LINE ITEM CURSOR.                                 *23130005
231400*----------------------------------------------------------------*23140005
231500 4310-FETCH.                                                      23150005
231600                                                                  23160005
231700     EXEC SQL                                                     23170005
231800          FETCH LINE-ITEM-CSR                                     23180005
231900           INTO  :CEPLIT-CNSTK-REQ-PL-NBR                         23190005
232000               , :CEPLIT-PL-LNE-NBR                               23200005
232100               , :CEPLIT-ITM-NBR                                  23210005
232200               , :CEPLIT-PL-REQ-QTY                               23220005
232300               , :CEPLIT-ACTL-PL-QTY :PV-NULL-IND-3               23230005
232400               , :CEPLIT-STAT-CDE                                 23240005
232500               , :CEPLIT-UNT-RTL-AMT                              23250005
232600               , :CEPLIT-DWNLD-RDM-STAT-CDE                       23260005
232700     END-EXEC.                                                    23270005
232800                                                                  23280005
232900     EVALUATE TRUE                                                23290005
233000         WHEN SQLCODE = ZERO                                      23300005
233100              MOVE  CEPLIT-STAT-CDE     TO  PV-PULL-STATUS        23310005
233200              MOVE  CEPLIT-PL-LNE-NBR   TO  DK-LINE-NUMBER        23320005
233300              MOVE  CEPLIT-STAT-CDE     TO  DK-LINE-STATUS        23330005
233400         WHEN SQLCODE = +100                                      23340005
233500              MOVE  SPACES              TO  PV-PULL-STATUS        23350005
233600              MOVE  ZEROES              TO  DK-LINE-NUMBER        23360005
233700              MOVE  SPACES              TO  DK-LINE-STATUS        23370005
233800         WHEN SQLWARN0 NOT = SPACE                                23380005
233900         WHEN SQLCODE NOT = ZERO                                  23390005
234000              MOVE '4310-FETCH-CURSOR'                            23400005
234100                               TO DP013-PARAGRAPH                 23410005
234200              MOVE 'FETCH LINE ITEM CURSOR'                       23420005
234300                               TO DP013-MESSAGE-TEXT (1)          23430005
234400              MOVE SQLCA       TO DP013-SQLCA                     23440005
234500              SET DP013-DB2-ABEND                                 23450005
234600                               TO TRUE                            23460005
234700              PERFORM DP013-0000-PROCESS-ABEND                    23470005
234800     END-EVALUATE.                                                23480005
234900                                                                  23490005
235000     IF  SQLCODE EQUAL +100                                       23500005
235100         SET ASC-NO-ITEMS-LEFT-ON-DB                              23510005
235200                                   TO TRUE                        23520005
235300     END-IF.                                                      23530005
235400                                                                  23540005
235500 EJECT                                                            23550005
235600*----------------------------------------------------------------*23560005
235700* GET PULL ITEM LINE QTY.                                        *23570005
235800*----------------------------------------------------------------*23580005
235900 4320-GET-LINE-ITEM.                                              23590005
236000                                                                  23600005
236100     INITIALIZE  PV-CEPLIT-ITEM-QTY                               23610005
236200                 PV-CEPLIT-REQ-QTY                                23620005
236300                 PV-CEPLIT-ACTL-QTY.                              23630005
236400                                                                  23640005
236500     EXEC SQL                                                     23650005
236600         SELECT  COUNT(*)                                         23660005
236700                ,SUM(PL_REQ_QTY)                                  23670005
236800                ,SUM(ACTL_PL_QTY)                                 23680005
236900           INTO  :PV-CEPLIT-ITEM-QTY                              23690005
237000                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               23700005
237100                ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2               23710005
237200           FROM  TCEPLIT                                          23720005
237300          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             23730005
237400            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             23740005
237500            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    23750005
237600     END-EXEC                                                     23760005
237700                                                                  23770005
237800     EVALUATE TRUE                                                23780005
237900         WHEN SQLCODE = +0                                        23790005
238000              CONTINUE                                            23800005
238100         WHEN SQLCODE = -904                                      23810005
238200         WHEN SQLCODE = -911                                      23820005
238300         WHEN SQLCODE = -913                                      23830005
238400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    23840005
238500             MOVE '4320-GET-LINE-ITEM  '    TO PV-SOFT-PARAGRAPH  23850005
238600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  23860005
238700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23870005
238800               TO PV-COMMAREA-LENGTH                              23880005
238900             EXEC CICS                                            23890005
239000                  WRITEQ TD                                       23900005
239100                   QUEUE  ('CSSL')                                23910005
239200                    FROM  (PV-CICS-MSG-AREA2)                     23920005
239300                  LENGTH  (PV-COMMAREA-LENGTH)                    23930005
239400                    RESP  (PV-CICS-RESP)                          23940005
239500             END-EXEC                                             23950005
239600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          23960005
239700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              23970005
239800             PERFORM 9900-SOFT-ABORT                              23980005
239900         WHEN OTHER                                               23990005
240000              MOVE '4320-GET-LINE-ITEM'                           24000005
240100                               TO DP013-PARAGRAPH                 24010005
240200              MOVE 'GET PULL STATUS ITEM QTYS'                    24020005
240300                               TO DP013-MESSAGE-TEXT (1)          24030005
240400              MOVE SQLCA       TO DP013-SQLCA                     24040005
240500              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        24050005
240600              SET DP013-DB2-ABEND                                 24060005
240700                  DP013-XCTL-DISPLAY-RESTART                      24070005
240800                                   TO TRUE                        24080005
240900                  PERFORM DP013-0000-PROCESS-ABEND                24090005
241000     END-EVALUATE.                                                24100005
241100                                                                  24110005
241200 EJECT                                                            24120005
241300*----------------------------------------------------------------*24130005
241400* GET LINE ITEM DISTRIBUTION QTY & STORE COUNT                   *24140005
241500*----------------------------------------------------------------*24150005
241600 4340-GET-ITEM-DISTRO.                                            24160005
241700     INITIALIZE  PV-CEPLDS-DISTRB-QTY                             24170005
241800                 PV-CEPLDS-STORE-COUNT.                           24180005
241900                                                                  24190005
242000     EXEC SQL                                                     24200005
242100          SELECT  SUM(A.ACTL_DISTRB_QTY)                          24210005
242200            INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1            24220005
242300            FROM  TCEPLDS A                                       24230005
242400           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           24240005
242500             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           24250005
242600             AND  :DK-LINE-STATUS  IN  ('DS','PD')                24260005
242700     END-EXEC                                                     24270005
242800                                                                  24280005
242900                                                                  24290005
243000     EVALUATE TRUE                                                24300005
243100         WHEN SQLCODE = +0                                        24310005
243200              CONTINUE                                            24320005
243300         WHEN SQLCODE = -904                                      24330005
243400         WHEN SQLCODE = -911                                      24340005
243500         WHEN SQLCODE = -913                                      24350005
243600             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    24360005
243700             MOVE '4340-GET-ITEM-DISTRO'    TO PV-SOFT-PARAGRAPH  24370005
243800             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  24380005
243900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24390005
244000               TO PV-COMMAREA-LENGTH                              24400005
244100             EXEC CICS                                            24410005
244200                  WRITEQ TD                                       24420005
244300                   QUEUE  ('CSSL')                                24430005
244400                    FROM  (PV-CICS-MSG-AREA2)                     24440005
244500                  LENGTH  (PV-COMMAREA-LENGTH)                    24450005
244600                    RESP  (PV-CICS-RESP)                          24460005
244700             END-EXEC                                             24470005
244800             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24480005
244900             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24490005
245000             PERFORM 9900-SOFT-ABORT                              24500005
245100         WHEN OTHER                                               24510005
245200              MOVE '4340-GET-ITEM-DISTRO'                         24520005
245300                               TO DP013-PARAGRAPH                 24530005
245400              MOVE 'GET LINE DISTRIBTION     '                    24540005
245500                               TO DP013-MESSAGE-TEXT (1)          24550005
245600              MOVE SQLCA       TO DP013-SQLCA                     24560005
245700              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        24570005
245800              SET DP013-DB2-ABEND                                 24580005
245900                  DP013-XCTL-DISPLAY-RESTART                      24590005
246000                                   TO TRUE                        24600005
246100                  PERFORM DP013-0000-PROCESS-ABEND                24610005
246200     END-EVALUATE.                                                24620005
246300                                                                  24630005
246400     EXEC SQL                                                     24640005
246500          SELECT  COUNT(*)                                        24650005
246600            INTO  :PV-CEPLDS-STORE-COUNT                          24660005
246700            FROM  TCEPLDS A                                       24670005
246800           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           24680005
246900             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           24690005
247000     END-EXEC                                                     24700005
247100                                                                  24710005
247200     EVALUATE TRUE                                                24720005
247300         WHEN SQLCODE = +0                                        24730005
247400              CONTINUE                                            24740005
247500         WHEN SQLCODE = -904                                      24750005
247600         WHEN SQLCODE = -911                                      24760005
247700         WHEN SQLCODE = -913                                      24770005
247800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   24780005
247900             MOVE '4340-GET-ITEM-DISTRO 2ND' TO PV-SOFT-PARAGRAPH 24790005
248000             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 24800005
248100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24810005
248200               TO PV-COMMAREA-LENGTH                              24820005
248300             EXEC CICS                                            24830005
248400                  WRITEQ TD                                       24840005
248500                   QUEUE  ('CSSL')                                24850005
248600                    FROM  (PV-CICS-MSG-AREA2)                     24860005
248700                  LENGTH  (PV-COMMAREA-LENGTH)                    24870005
248800                    RESP  (PV-CICS-RESP)                          24880005
248900             END-EXEC                                             24890005
249000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24900005
249100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24910005
249200             PERFORM 9900-SOFT-ABORT                              24920005
249300         WHEN OTHER                                               24930005
249400              MOVE '4340-GET-ITEM-DISTRO 2ND'                     24940005
249500                               TO DP013-PARAGRAPH                 24950005
249600              MOVE 'GET LINE DISTRO STORE COUNT'                  24960005
249700                               TO DP013-MESSAGE-TEXT (1)          24970005
249800              MOVE SQLCA       TO DP013-SQLCA                     24980005
249900              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        24990005
250000              SET DP013-DB2-ABEND                                 25000005
250100                  DP013-XCTL-DISPLAY-RESTART                      25010005
250200                                   TO TRUE                        25020005
250300                  PERFORM DP013-0000-PROCESS-ABEND                25030005
250400     END-EVALUATE.                                                25040005
250500                                                                  25050005
250600 EJECT                                                            25060005
250700*----------------------------------------------------------------*25070005
250800* GET LINE ITEM SKU & DESCRIPTION                                *25080005
250900*----------------------------------------------------------------*25090005
251000 4350-GET-SKU-INFO.                                               25100005
251100                                                                  25110005
251200     INITIALIZE  XLT00003-SKU-NBR                                 25120005
251300                 XLT00003-SKU-DESC                                25130005
251400                 PV-SKU-NUMBER.                                   25140005
251500                                                                  25150005
251600     EXEC SQL                                                     25160005
251700          SELECT   SKU_NBR                                        25170005
251800                  ,SKU_DESC                                       25180005
251900            INTO   :XLT00003-SKU-NBR                              25190005
252000                  ,:XLT00003-SKU-DESC                             25200005
252100            FROM  XLT_SKU                                         25210005
252200           WHERE  ITM_NBR            =  :CEPLIT-ITM-NBR           25220005
252300     END-EXEC                                                     25230005
252400                                                                  25240005
252500     EVALUATE TRUE                                                25250005
252600         WHEN SQLCODE = +0                                        25260005
252700              MOVE  XLT00003-SKU-NBR     TO  PV-SKU-NUMBER        25270005
252710              PERFORM 4360-INSPECT-XLT00003-SKU-DESC              25271017
252800              MOVE  XLT00003-SKU-DESC    TO  PV-SKU-DESCRIPTION   25280005
252900         WHEN SQLCODE = +100                                      25290005
253000              MOVE  SPACES               TO  PV-SKU-NUMBER        25300005
253100              MOVE  PC-UNKNOWN-SKU-DESC  TO  PV-SKU-DESCRIPTION   25310005
253200         WHEN SQLCODE = -904                                      25320005
253300         WHEN SQLCODE = -911                                      25330005
253400         WHEN SQLCODE = -913                                      25340005
253500             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    25350005
253600             MOVE '4350-GET-SKU-INFO'       TO PV-SOFT-PARAGRAPH  25360005
253700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  25370005
253800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25380005
253900               TO PV-COMMAREA-LENGTH                              25390005
254000             EXEC CICS                                            25400005
254100                  WRITEQ TD                                       25410005
254200                   QUEUE  ('CSSL')                                25420005
254300                    FROM  (PV-CICS-MSG-AREA2)                     25430005
254400                  LENGTH  (PV-COMMAREA-LENGTH)                    25440005
254500                    RESP  (PV-CICS-RESP)                          25450005
254600             END-EXEC                                             25460005
254700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25470005
254800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              25480005
254900             PERFORM 9900-SOFT-ABORT                              25490005
255000         WHEN OTHER                                               25500005
255100              MOVE '4350-GET-SKU-INFO'                            25510005
255200                               TO DP013-PARAGRAPH                 25520005
255300              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           25530005
255400              STRING ' PULL-'           DELIMITED BY SIZE         25540005
255500                     PV-PULL-NUMBER     DELIMITED BY SIZE         25550005
255600                     '  -  LINE-'       DELIMITED BY SIZE         25560005
255700                     PV-LINE-NUMBER     DELIMITED BY SIZE         25570005
255800                     '  -  ITEM NBR-'   DELIMITED BY SIZE         25580005
255900                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         25590005
256000                     '  TRYING TO GET SKU INFORMATION'            25600005
256100                                        DELIMITED BY SIZE         25610005
256200                             INTO DP013-MESSAGE-TEXT (1)          25620005
256300              MOVE SQLCA       TO DP013-SQLCA                     25630005
256400              MOVE 'XLT_SKU '  TO DP013-DB2-TABLE-NAME (2)        25640005
256500              SET DP013-DB2-ABEND                                 25650005
256600                  DP013-XCTL-DISPLAY-RESTART                      25660005
256700                                   TO TRUE                        25670005
256800                  PERFORM DP013-0000-PROCESS-ABEND                25680005
256900     END-EVALUATE.                                                25690005
257000                                                                  25700005
257100 EJECT                                                            25710005
257110*----------------------------------------------------------------*25711017
257120* INSPECT THE SKU DESCRIPTION FROM XLT_SKU TO CONVERT INVALID    *25712017
257130* CHARACTERS TO SPACES.                                          *25713017
257140*----------------------------------------------------------------*25714017
257150 4360-INSPECT-XLT00003-SKU-DESC.                                  25715017
257160                                                                  25716017
257170     MOVE SPACE TO  PC-SPACE.                                     25717017
257180     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25718017
257190         quote BY PC-SPACE.                                       25719017
257191     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25719117
257192         '&'   BY PC-SPACE.                                       25719217
257193     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25719317
257194         '"'   BY PC-SPACE.                                       25719417
257195     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25719517
257196         '<'   BY PC-SPACE.                                       25719617
257197     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25719717
257198         '>'   BY PC-SPACE.                                       25719817
257199*-------------------------                                        25719917
257200* ADDED CHECK FOR HEX 05                                          25720017
257201*-------------------------                                        25720117
257202     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25720217
257203         '	'   BY PC-SPACE.                                       25720317
257204     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25720417
257205         ''   BY PC-SPACE.                                       25720517
257206     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25720617
257207         ';'   BY PC-SPACE.                                       25720717
257208     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25720817
257209         LOW-VALUES BY PC-SPACE.                                  25720917
257210*-------------------------                                        25721017
257211* ADDED CHECK FOR HEX 3F                                          25721117
257212*-------------------------                                        25721217
257213     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25721317
257214         ''   BY PC-SPACE.                                       25721417
257215*-------------------------                                        25721517
257216* ADDED CHECK FOR HEX 71                                          25721617
257217*-------------------------                                        25721717
257218     INSPECT XLT00003-SKU-DESC   REPLACING ALL                    25721817
257219         ''   BY PC-SPACE.                                       25721917
257220                                                                  25722017
257230*----------------------------------------------------------------*25723005
257300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *25730005
257400*----------------------------------------------------------------*25740005
257500 4400-MOVE-COMMAREA-TO-SCREEN.                                    25750005
257600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             25760005
257700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          25770005
257800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          25780005
257900             MOVE +1    TO ASC-BLK-SUB                            25790005
258000             PERFORM 5100-WRITE-TEMP-STORAGE                      25800005
258100             ADD +1     TO ASC-BLK-SUB                            25810005
258200             PERFORM 5100-WRITE-TEMP-STORAGE                      25820005
258300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             25830005
258400                 GIVING PV-BLOCK-NUMBER                           25840005
258500                 REMAINDER PV-REMAINDER                           25850005
258600             IF  PV-REMAINDER > ZERO                              25860005
258700                 ADD +1 TO PV-BLOCK-NUMBER                        25870005
258800             END-IF                                               25880005
258900             MOVE +1    TO ASC-BLK-SUB                            25890005
259000             PERFORM 4410-READ-TEMP-STORAGE                       25900005
259100             ADD +1     TO ASC-BLK-SUB                            25910005
259200                           PV-BLOCK-NUMBER                        25920005
259300             PERFORM 4410-READ-TEMP-STORAGE                       25930005
259400     END-IF.                                                      25940005
259500     MOVE +1            TO ASC-BLK-SUB.                           25950005
259600     COMPUTE ASC-ITEM-SUB =                                       25960005
259700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              25970005
259800         + PC-ITEMS-PER-PANEL).                                   25980005
259900*                                                                 25990005
260000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        26000005
260100         ADD +1         TO ASC-BLK-SUB                            26010005
260200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            26020005
260300     END-IF.                                                      26030005
260400*                                                                 26040005
260500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           26050005
260600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                26060005
260700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        26070005
260800     PERFORM 4420-FORMAT-LIST-LINES                               26080005
260900         VARYING PV-SUB                                           26090005
261000         FROM PC-ITEMS-PER-PANEL BY -1                            26100005
261100         UNTIL PV-SUB < +1.                                       26110005
261200*                                                                 26120005
261300     COMPUTE ASC-ITEMS-DISPLAYED =                                26130005
261400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          26140005
261500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    26150005
261600                                      ASTRTITO.                   26160005
261700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    26170005
261800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    26180005
261900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26190005
262000                                   TO ASELITO.                    26200005
262100*                                                                 26210005
262200     MOVE ASC-CS-LOC-N               TO PV-4-DIGIT-STORE.         26220005
262300     MOVE PV-4-DIGIT-STORE           TO ALOCIDO.                  26230005
262400                                                                  26240005
262500     MOVE ASC-PULL-NBR-N             TO APULNOO                   26250005
262600                                        DK-PULL-NUMBER.           26260005
262700                                                                  26270005
262800     PERFORM 4500-GET-PULL-ITEM                                   26280005
262900     PERFORM 4510-GET-PULL-DISTRO                                 26290005
263000     PERFORM 4840-GET-NEW-PULL-STATUS.                            26300005
263100                                                                  26310005
263200     MOVE ASC-REF-NBR                TO AREFNOO.                  26320005
263300                                                                  26330005
263400     EVALUATE TRUE                                                26340005
263500         WHEN ASC-PULL-SRC-ADAM                                   26350005
263600              MOVE PC-ADAM-DESC             TO APLSRCO            26360005
263700         WHEN ASC-PULL-SRC-INFOREM                                26370005
263800              MOVE PC-INFOREM-DESC          TO APLSRCO            26380005
263900         WHEN ASC-PULL-SRC-MANUAL                                 26390005
264000              MOVE PC-MANUAL-DESC           TO APLSRCO            26400005
264100* 04/26/2010 CT START ADDED 'XF'                                  26410005
264200         WHEN ASC-PULL-SRC-XFER                                   26420005
264300              MOVE PC-XFER-DESC             TO APLSRCO            26430005
264400* 04/26/2010 CT END                                               26440005
264500         WHEN OTHER                                               26450005
264600              MOVE PC-UNKNOWN-DESC          TO APLSRCO            26460005
264700     END-EVALUATE.                                                26470005
264800                                                                  26480005
264900     EVALUATE TRUE                                                26490005
265000         WHEN ASC-PULL-CANCELLED                                  26500005
265100              MOVE PC-PULL-STATUS-CANCELLED TO APULSTO            26510005
265200         WHEN ASC-PULL-DISTRIBUTED                                26520005
265300              MOVE PC-DISTRIB-DESC          TO APULSTO            26530005
265400         WHEN ASC-PULL-IN-PROCESS                                 26540005
265500              MOVE PC-IN-PROCESS-DESC       TO APULSTO            26550005
265600         WHEN ASC-PULL-NEW                                        26560005
265700              MOVE PC-NEW-DESC              TO APULSTO            26570005
265800         WHEN ASC-PULL-POSTED                                     26580005
265900              MOVE PC-POSTED-DESC           TO APULSTO            26590005
266000         WHEN OTHER                                               26600005
266100              MOVE PC-UNKNOWN-DESC          TO APULSTO            26610005
266200     END-EVALUATE.                                                26620005
266300*                                                                 26630005
266400     IF  DP020-MSG-NUMBER-X = SPACE                               26640005
266500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  26650005
266600*            --- MORE ITEMS TO DISPLAY ----                       26660005
266700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            26670005
266800             SET DP020-MSG-INFORMATIONAL TO TRUE                  26680005
266900         END-IF                                                   26690005
267000     END-IF.                                                      26700005
267100                                                                  26710005
267200 EJECT                                                            26720005
267300*----------------------------------------------------------------*26730005
267400*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *26740005
267500*----------------------------------------------------------------*26750005
267600 4410-READ-TEMP-STORAGE.                                          26760005
267700                                                                  26770005
267800     EXEC CICS                                                    26780005
267900         READQ TS                                                 26790005
268000             QUEUE (ASC-LIST-QUEUE-NAME)                          26800005
268100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26810005
268200             ITEM  (PV-BLOCK-NUMBER)                              26820005
268300             RESP  (PV-CICS-RESP)                                 26830005
268400     END-EXEC.                                                    26840005
268500                                                                  26850005
268600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       26860005
268700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     26870005
268800         CONTINUE                                                 26880005
268900     ELSE                                                         26890005
269000         SET DP013-CICS-ABEND     TO TRUE                         26900005
269100         SET DP013-NO-ROLLBACK    TO TRUE                         26910005
269200         MOVE '4410-READ-TEMP-STORAGE'                            26920005
269300                                  TO DP013-PARAGRAPH              26930005
269400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      26940005
269500                                  TO DP013-MESSAGE-TEXT(1)        26950005
269600         PERFORM DP013-0000-PROCESS-ABEND                         26960005
269700     END-IF.                                                      26970005
269800                                                                  26980005
269900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26990005
270000*                                                                 27000005
270100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         27010005
270200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               27020005
270300     END-IF.                                                      27030005
270400                                                                  27040005
270500 EJECT                                                            27050005
270600*----------------------------------------------------------------*27060005
270700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *27070005
270800*----------------------------------------------------------------*27080005
270900 4420-FORMAT-LIST-LINES.                                          27090005
271000                                                                  27100005
271100     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      27110005
271200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                27120005
271300         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           27130005
271400         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           27140005
271500         MOVE SPACE              TO MR-SELECTI (PV-SUB)           27150005
271600                                    MR-ACTION (PV-SUB)            27160005
271700                                    MR-SKU-NBR (PV-SUB)           27170005
271800                                    MR-SKU-DESC (PV-SUB)          27180005
271900                                    MR-LINE-STATUS (PV-SUB)       27190005
272000                                    MR-RDM-STATUS (PV-SUB)        27200005
272100                                                                  27210005
272200         MOVE ZEROES             TO MR-LINE-NUMBER (PV-SUB)       27220005
272300     ELSE                                                         27230005
272400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27240005
272500                                                   > SPACE        27250005
272600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 27260005
272700                                 TO MR-SELECTI (PV-SUB)           27270005
272800         ELSE                                                     27280005
272900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27290005
273000                                 TO MR-SELECTI (PV-SUB)           27300005
273100         END-IF                                                   27310005
273200*                                                                 27320005
273300         IF  DP030-SET-CURSOR-TRAILER                             27330005
273400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)27340005
273500                 > SPACE)                                         27350005
273600               OR (PV-SUB = 1))                                   27360005
273700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               27370005
273800                MOVE -1          TO MR-SELECTL (PV-SUB)           27380005
273900             END-IF                                               27390005
274000         END-IF                                                   27400005
274100*                                                                 27410005
274200         MOVE ASC-PULL-NBR              TO  DK-PULL-NUMBER        27420005
274300         MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          27430005
274400                                        TO  DK-LINE-NUMBER        27440005
274500         PERFORM 4830-LINE-STATUS                                 27450005
274600         MOVE  PV-PULL-STATUS                                     27460005
274700           TO  ASC-LINE-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)     27470005
274800         EVALUATE  TRUE                                           27480005
274900             WHEN  PV-PULL-STATUS-NEW                             27490005
275000                   MOVE  PC-NEW-DESC                              27500005
275100                     TO  ASC-LINE-STATUS-DESC                     27510005
275200                         (ASC-BLK-SUB ASC-ITEM-SUB)               27520005
275300             WHEN  PV-PULL-STATUS-CANCELLED                       27530005
275400                   MOVE  PC-PULL-STATUS-CANCELLED                 27540005
275500                     TO  ASC-LINE-STATUS-DESC                     27550005
275600                         (ASC-BLK-SUB ASC-ITEM-SUB)               27560005
275700             WHEN  PV-PULL-STATUS-INPROCESS                       27570005
275800                   MOVE  PC-IN-PROCESS-DESC                       27580005
275900                     TO  ASC-LINE-STATUS-DESC                     27590005
276000                         (ASC-BLK-SUB ASC-ITEM-SUB)               27600005
276100             WHEN  PV-PULL-STATUS-DISTRIBTD                       27610005
276200                   MOVE  PC-DISTRIB-DESC                          27620005
276300                     TO  ASC-LINE-STATUS-DESC                     27630005
276400                         (ASC-BLK-SUB ASC-ITEM-SUB)               27640005
276500             WHEN  PV-PULL-STATUS-POSTED                          27650005
276600                   MOVE  PC-POSTED-DESC                           27660005
276700                     TO  ASC-LINE-STATUS-DESC                     27670005
276800                         (ASC-BLK-SUB ASC-ITEM-SUB)               27680005
276900         END-EVALUATE                                             27690005
277000*                                                                 27700005
277100         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               27710005
277200                                 TO MR-ACTION (PV-SUB)            27720005
277300         MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          27730005
277400                                 TO MR-LINE-NUMBER (PV-SUB)       27740005
277500         MOVE ASC-SKU-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)           27750005
277600                                 TO MR-SKU-NBR (PV-SUB)           27760005
277700         MOVE ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)      27770005
277800                                 TO MR-SKU-DESC (PV-SUB)          27780005
277900         MOVE ASC-LINE-STATUS-DESC (ASC-BLK-SUB ASC-ITEM-SUB)     27790005
278000                                 TO MR-LINE-STATUS (PV-SUB)       27800005
278100         IF  ASC-RDM-DOWNLOADED (ASC-BLK-SUB ASC-ITEM-SUB)        27810005
278200             MOVE PC-RDM-DOWNLOADED                               27820005
278300                                 TO MR-RDM-STATUS (PV-SUB)        27830005
278400         ELSE                                                     27840005
278500         IF  ASC-RDM-TO-BE-RESENT (ASC-BLK-SUB ASC-ITEM-SUB)      27850005
278600             MOVE PC-RDM-TO-BE-RESENT                             27860005
278700                                 TO MR-RDM-STATUS (PV-SUB)        27870005
278800         ELSE                                                     27880005
278900             MOVE PC-RDM-NOT-DOWNLOADED                           27890005
279000                                 TO MR-RDM-STATUS (PV-SUB)        27900005
279100         END-IF                                                   27910005
279200         END-IF                                                   27920005
279300         MOVE ASC-PULL-NBR       TO DK-PULL-NUMBER                27930005
279400         MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          27940005
279500                                 TO DK-LINE-NUMBER                27950005
279600         MOVE ASC-LINE-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)      27960005
279700                                 TO DK-LINE-STATUS                27970005
279800         PERFORM 4340-GET-ITEM-DISTRO                             27980005
279900         IF  PV-PULL-STATUS-DISTRIBTD  OR                         27990005
280000             PV-PULL-STATUS-POSTED                                28000005
280100             MOVE  PV-CEPLDS-DISTRB-QTY                           28010005
280200                              TO  PV-DIST-UNT-ZERO-SUPPRESS       28020005
280300             MOVE  PV-DIST-UNT-ZERO-SUPPRESS                      28030005
280400                              TO  ASC-DISTRBUTED-UNITS            28040005
280500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28050005
280600         ELSE                                                     28060005
280700             MOVE  SPACES                                         28070005
280800                              TO  ASC-DISTRBUTED-UNITS            28080005
280900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28090005
281000         END-IF                                                   28100005
281100     END-IF.                                                      28110005
281200     SUBTRACT +1 FROM ASC-ITEM-SUB                                28120005
281300     IF  ASC-ITEM-SUB < + 1                                       28130005
281400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  28140005
281500         MOVE +1                 TO ASC-BLK-SUB                   28150005
281600     END-IF.                                                      28160005
281700                                                                  28170005
281800 EJECT                                                            28180005
281900******************************************************************28190005
282000** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **28200005
282100** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **28210005
282200** ISSUE A WARNING.                                             **28220005
282300******************************************************************28230005
282400 4430-CHECK-FOR-BEGIN-AND-END.                                    28240005
282500                                                                  28250005
282600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       28260005
282700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28270005
282800*            -- NO END-OF-RANGE SPECFIED ---                      28280005
282900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            28290005
283000             SET DP020-MSG-WARNING TO TRUE                        28300005
283100             PERFORM 4431-POSITION-AT-WARNING                     28310005
283200         END-IF                                                   28320005
283300     ELSE                                                         28330005
283400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     28340005
283500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                28350005
283600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            28360005
283700             SET DP020-MSG-WARNING TO TRUE                        28370005
283800             PERFORM 4431-POSITION-AT-WARNING                     28380005
283900         END-IF                                                   28390005
284000     END-IF.                                                      28400005
284100                                                                  28410005
284200 EJECT                                                            28420005
284300******************************************************************28430005
284400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **28440005
284500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **28450005
284600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **28460005
284700** POSITION THE CURSOR THERE.                                   **28470005
284800******************************************************************28480005
284900 4431-POSITION-AT-WARNING.                                        28490005
285000                                                                  28500005
285100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 28510005
285200                    - PV-TOP-ITEM + 1.                            28520005
285300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28530005
285400         CONTINUE                                                 28540005
285500     ELSE                                                         28550005
285600         SET DP030-SET-CURSOR-APPL-1                              28560005
285700                                   TO TRUE                        28570005
285800         MOVE -1                   TO MR-SELECTL (PV-SUB)         28580005
285900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         28590005
286000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         28600005
286100     END-IF.                                                      28610005
286200*                                                                 28620005
286300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   28630005
286400                    - PV-TOP-ITEM + 1.                            28640005
286500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28650005
286600         CONTINUE                                                 28660005
286700     ELSE                                                         28670005
286800         SET DP030-SET-CURSOR-APPL-1                              28680005
286900                                   TO TRUE                        28690005
287000         MOVE -1                   TO MR-SELECTL (PV-SUB)         28700005
287100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         28710005
287200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         28720005
287300     END-IF.                                                      28730005
287400                                                                  28740005
287500 EJECT                                                            28750005
287600*----------------------------------------------------------------*28760005
287700* GET PULL ITEM QTYS                                             *28770005
287800*----------------------------------------------------------------*28780005
287900 4500-GET-PULL-ITEM.                                              28790005
288000                                                                  28800005
288100     INITIALIZE  PV-CEPLIT-ITEM-QTY                               28810005
288200                 PV-CEPLIT-REQ-QTY                                28820005
288300                 PV-CEPLIT-ACTL-QTY.                              28830005
288400                                                                  28840005
288500     EXEC SQL                                                     28850005
288600         SELECT  COUNT(*)                                         28860005
288700                ,SUM(PL_REQ_QTY)                                  28870005
288800                ,SUM(ACTL_PL_QTY)                                 28880005
288900           INTO  :PV-CEPLIT-ITEM-QTY                              28890005
289000                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               28900005
289100                ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2               28910005
289200           FROM  TCEPLIT                                          28920005
289300          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             28930005
289400            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    28940005
289500     END-EXEC                                                     28950005
289600                                                                  28960005
289700     EVALUATE TRUE                                                28970005
289800         WHEN SQLCODE = +0                                        28980005
289900              CONTINUE                                            28990005
290000         WHEN SQLCODE = -904                                      29000005
290100         WHEN SQLCODE = -911                                      29010005
290200         WHEN SQLCODE = -913                                      29020005
290300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    29030005
290400             MOVE '4500-GET-PULL-ITEM  '    TO PV-SOFT-PARAGRAPH  29040005
290500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  29050005
290600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29060005
290700               TO PV-COMMAREA-LENGTH                              29070005
290800             EXEC CICS                                            29080005
290900                  WRITEQ TD                                       29090005
291000                   QUEUE  ('CSSL')                                29100005
291100                    FROM  (PV-CICS-MSG-AREA2)                     29110005
291200                  LENGTH  (PV-COMMAREA-LENGTH)                    29120005
291300                    RESP  (PV-CICS-RESP)                          29130005
291400             END-EXEC                                             29140005
291500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29150005
291600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29160005
291700             PERFORM 9900-SOFT-ABORT                              29170005
291800         WHEN OTHER                                               29180005
291900              MOVE '4500-GET-PULL-ITEM'                           29190005
292000                               TO DP013-PARAGRAPH                 29200005
292100              MOVE 'GET PULL STATUS ITEM QTYS'                    29210005
292200                               TO DP013-MESSAGE-TEXT (1)          29220005
292300              MOVE SQLCA       TO DP013-SQLCA                     29230005
292400              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        29240005
292500              SET DP013-DB2-ABEND                                 29250005
292600                  DP013-XCTL-DISPLAY-RESTART                      29260005
292700                                   TO TRUE                        29270005
292800                  PERFORM DP013-0000-PROCESS-ABEND                29280005
292900     END-EVALUATE.                                                29290005
293000                                                                  29300005
293100*----------------------------------------------------------------*29310005
293200* COUNT NUMBER OF LINE ITEMS                                     *29320005
293300*----------------------------------------------------------------*29330005
293400 4505-COUNT-PULL-LINE-ITEMS.                                      29340005
293500                                                                  29350005
293600     INITIALIZE  PV-CEPLIT-ITEM-QTY.                              29360005
293700     MOVE  ASC-PULL-NBR  TO DK-PULL-NUMBER.                       29370005
293800                                                                  29380005
293900     EXEC SQL                                                     29390005
294000         SELECT  COUNT(*)                                         29400005
294100           INTO  :PV-CEPLIT-ITEM-QTY                              29410005
294200           FROM  TCEPLIT                                          29420005
294300          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             29430005
294400     END-EXEC                                                     29440005
294500                                                                  29450005
294600     EVALUATE TRUE                                                29460005
294700         WHEN SQLCODE = +0                                        29470005
294800              CONTINUE                                            29480005
294900         WHEN SQLCODE = -904                                      29490005
295000         WHEN SQLCODE = -911                                      29500005
295100         WHEN SQLCODE = -913                                      29510005
295200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    29520005
295300             MOVE '4505-COUNT-LINE-ITEM'    TO PV-SOFT-PARAGRAPH  29530005
295400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  29540005
295500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29550005
295600               TO PV-COMMAREA-LENGTH                              29560005
295700             EXEC CICS                                            29570005
295800                  WRITEQ TD                                       29580005
295900                   QUEUE  ('CSSL')                                29590005
296000                    FROM  (PV-CICS-MSG-AREA2)                     29600005
296100                  LENGTH  (PV-COMMAREA-LENGTH)                    29610005
296200                    RESP  (PV-CICS-RESP)                          29620005
296300             END-EXEC                                             29630005
296400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29640005
296500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29650005
296600             PERFORM 9900-SOFT-ABORT                              29660005
296700         WHEN OTHER                                               29670005
296800              MOVE '4500-GET-PULL-ITEM'                           29680005
296900                               TO DP013-PARAGRAPH                 29690005
297000              MOVE 'GET PULL STATUS ITEM QTYS'                    29700005
297100                               TO DP013-MESSAGE-TEXT (1)          29710005
297200              MOVE SQLCA       TO DP013-SQLCA                     29720005
297300              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        29730005
297400              SET DP013-DB2-ABEND                                 29740005
297500                  DP013-XCTL-DISPLAY-RESTART                      29750005
297600                                   TO TRUE                        29760005
297700                  PERFORM DP013-0000-PROCESS-ABEND                29770005
297800     END-EVALUATE.                                                29780005
297900                                                                  29790005
298000*----------------------------------------------------------------*29800005
298100* GET PULL DISTRIBUTION QTY                                      *29810005
298200*----------------------------------------------------------------*29820005
298300 4510-GET-PULL-DISTRO.                                            29830005
298400                                                                  29840005
298500     INITIALIZE  PV-CEPLDS-DISTRB-QTY.                            29850005
298600                                                                  29860005
298700     EXEC SQL                                                     29870005
298800          SELECT  SUM(B.ACTL_DISTRB_QTY)                          29880005
298900            INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1            29890005
299000            FROM  TCEPLIT A                                       29900005
299100                 ,TCEPLDS B                                       29910005
299200           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           29920005
299300             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        29930005
299400             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              29940005
299500             AND  A.STAT_CDE   IN  ('DS')                         29950005
299600     END-EXEC                                                     29960005
299700                                                                  29970005
299800     EVALUATE TRUE                                                29980005
299900         WHEN SQLCODE = +0                                        29990005
300000              CONTINUE                                            30000005
300100         WHEN SQLCODE = -904                                      30010005
300200         WHEN SQLCODE = -911                                      30020005
300300         WHEN SQLCODE = -913                                      30030005
300400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30040005
300500             MOVE '4510-GET-PULL-DISTRO'    TO PV-SOFT-PARAGRAPH  30050005
300600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30060005
300700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30070005
300800               TO PV-COMMAREA-LENGTH                              30080005
300900             EXEC CICS                                            30090005
301000                  WRITEQ TD                                       30100005
301100                   QUEUE  ('CSSL')                                30110005
301200                    FROM  (PV-CICS-MSG-AREA2)                     30120005
301300                  LENGTH  (PV-COMMAREA-LENGTH)                    30130005
301400                    RESP  (PV-CICS-RESP)                          30140005
301500             END-EXEC                                             30150005
301600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30160005
301700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30170005
301800             PERFORM 9900-SOFT-ABORT                              30180005
301900         WHEN OTHER                                               30190005
302000              MOVE '4510-GET-PULL-DISTRO'                         30200005
302100                               TO DP013-PARAGRAPH                 30210005
302200              MOVE 'GET PULL DISTRIBTION     '                    30220005
302300                               TO DP013-MESSAGE-TEXT (1)          30230005
302400              MOVE SQLCA       TO DP013-SQLCA                     30240005
302500              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        30250005
302600              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        30260005
302700              SET DP013-DB2-ABEND                                 30270005
302800                  DP013-XCTL-DISPLAY-RESTART                      30280005
302900                                   TO TRUE                        30290005
303000                  PERFORM DP013-0000-PROCESS-ABEND                30300005
303100     END-EVALUATE.                                                30310005
303200                                                                  30320005
303300 EJECT                                                            30330005
303400*----------------------------------------------------------------*30340005
303500*  RESEND FUNCTION                                               *30350005
303600*----------------------------------------------------------------*30360005
303700 4700-PROCESS-RESEND-FUNCTION.                                    30370005
303800                                                                  30380005
303900     MOVE +1                       TO ASC-BLK-SUB.                30390005
304000     PERFORM 5100-WRITE-TEMP-STORAGE.                             30400005
304100     ADD +1                        TO ASC-BLK-SUB.                30410005
304200     PERFORM 5100-WRITE-TEMP-STORAGE.                             30420005
304300                                                                  30430005
304400     PERFORM 6112-READ-LIST-QUEUE.                                30440005
304500                                                                  30450005
304600     SET  LQW-IDX  TO   1.                                        30460005
304700                                                                  30470005
304800     IF PS-NO-SOFT-ABORT-ERROR                                    30480005
304900       IF PV-CICS-RESP = DFHRESP (NORMAL)                         30490005
305000         PERFORM                                                  30500005
305100         VARYING LQW-IDX  FROM 1 BY 1                             30510005
305200         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     30520005
305300            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            30530005
305400            OR   PS-SOFT-ABORT-ERROR                              30540005
305500            OR   PS-ERROR                                         30550005
305600             IF  LQW-SELECT (LQW-IDX)                             30560005
305700                 PERFORM 4705-PROCESS-SELECTED-LINES              30570005
305800             END-IF                                               30580005
305900         END-PERFORM                                              30590005
306000       END-IF                                                     30600005
306100     END-IF.                                                      30610005
306200                                                                  30620005
306300     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           30630005
306400     PERFORM 6111-WRITE-LIST-QUEUE.                               30640005
306500                                                                  30650005
306600     MOVE +1                     TO  ASC-BLK-SUB.                 30660005
306700     PERFORM 4410-READ-TEMP-STORAGE.                              30670005
306800                                                                  30680005
306900     ADD +1                      TO  ASC-BLK-SUB                  30690005
307000                                     PV-BLOCK-NUMBER.             30700005
307100                                                                  30710005
307200     PERFORM 4410-READ-TEMP-STORAGE.                              30720005
307300                                                                  30730005
307400 EJECT                                                            30740005
307500*----------------------------------------------------------------*30750005
307600*                                                                *30760005
307700*----------------------------------------------------------------*30770005
307800 4705-PROCESS-SELECTED-LINES.                                     30780005
307900                                                                  30790005
308000     PERFORM 4720-RESEND-LINES.                                   30800005
308100                                                                  30810005
308200     IF  PS-NO-ERROR                                              30820005
308300*2023*   PERFORM 2140-DESELECT-ALL-ITEMS                          30830013
308400         SET DP020-MSG-INFORMATIONAL  TO  TRUE                    30840005
308500         MOVE PC-TSYMSG-02252  TO  DP020-MSG-NUMBER               30850005
308600     END-IF.                                                      30860005
308700                                                                  30870005
308800 EJECT                                                            30880005
308900*----------------------------------------------------------------*30890005
309000* UPDATE EVERY SELECTED LINE FOR A SINGLE GIVEN PULL NUMBER.     *30900005
309100*----------------------------------------------------------------*30910005
309200 4720-RESEND-LINES.                                               30920005
309300                                                                  30930005
309400     MOVE ASC-PULL-NBR                   TO PV-PULL-NUMBER.       30940005
309500     MOVE LQW-LINE-NUMBER (LQW-IDX)      TO PV-LINE-NUMBER.       30950005
309600                                                                  30960005
309700     IF  PS-NO-ERROR                                              30970005
309800         IF  LQW-SELECT (LQW-IDX)                                 30980005
309801             IF  LQW-RDM-DOWNLOADED (LQW-IDX)  OR                 30980114
309810                 LQW-RDM-TO-BE-RESENT (LQW-IDX)                   30981014
309900                 PERFORM 4730-ISSUE-RESEND-REQ                    30990005
310000             END-IF                                               31000014
310010         END-IF                                                   31001014
310100     END-IF.                                                      31010005
310200                                                                  31020005
310300     IF  PS-NO-ERROR                                              31030005
310400         SET  LQW-DESELECT (LQW-IDX)   TO  TRUE                   31040005
310401* 2023 BEGIN                                                      31040114
310402         IF  LQW-RDM-DOWNLOADED (LQW-IDX)  OR                     31040214
310403             LQW-RDM-TO-BE-RESENT (LQW-IDX)                       31040314
310410             SET  LQW-UPD (LQW-IDX)        TO  TRUE               31041014
310411             SET  LQW-RDM-TO-BE-RESENT (LQW-IDX) TO  TRUE         31041115
310420         ELSE                                                     31042014
310430             SET  LQW-INQ (LQW-IDX)        TO  TRUE               31043014
310440         END-IF                                                   31044014
310450* 2023 END                                                        31045014
310500         SUBTRACT  1                                              31050005
310600             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   31060005
310700         MOVE LQW-SELECTED-SW (LQW-IDX)                           31070005
310800                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   31080005
310900     END-IF.                                                      31090005
311000                                                                  31100005
311100 EJECT                                                            31110005
311200*----------------------------------------------------------------*31120005
311300*                                                                *31130005
311400*----------------------------------------------------------------*31140005
311500 4730-ISSUE-RESEND-REQ.                                           31150005
311600                                                                  31160005
311700     PERFORM 4740-UPDATE-STAT-CDE.                                31170005
311800                                                                  31180005
311900     IF  PS-NO-ERROR                                              31190005
312000         EXEC CICS                                                31200005
312100              SYNCPOINT                                           31210005
312200         END-EXEC                                                 31220005
312300     END-IF.                                                      31230005
312400                                                                  31240005
312500 EJECT                                                            31250005
312600*----------------------------------------------------------------*31260005
312700*                                                                *31270005
312800*----------------------------------------------------------------*31280005
312900 4740-UPDATE-STAT-CDE.                                            31290005
313000                                                                  31300005
313100     MOVE PV-PULL-NUMBER          TO DK-PULL-NUMBER.              31310005
313200     MOVE PV-LINE-NUMBER          TO DK-LINE-NUMBER.              31320005
313300                                                                  31330005
313400     EXEC SQL                                                     31340005
313500          UPDATE TCEPLIT                                          31350005
313600             SET DWNLD_RDM_STAT_CDE = :PC-R                       31360005
313700           WHERE CNSTK_REQ_PL_NBR   = :DK-PULL-NUMBER             31370005
313800             AND PL_LNE_NBR         = :DK-LINE-NUMBER             31380005
313900     END-EXEC.                                                    31390005
314000                                                                  31400005
314100     EVALUATE TRUE                                                31410005
314200         WHEN SQLCODE = ZERO                                      31420005
314300              CONTINUE                                            31430005
314400         WHEN SQLCODE = -904                                      31440005
314500         WHEN SQLCODE = -911                                      31450005
314600         WHEN SQLCODE = -913                                      31460005
314700             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   31470005
314800             MOVE '4740-UPDATE-STAT-CDE'     TO PV-SOFT-PARAGRAPH 31480005
314900             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 31490005
315000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31500005
315100               TO PV-COMMAREA-LENGTH                              31510005
315200             EXEC CICS                                            31520005
315300                  WRITEQ TD                                       31530005
315400                   QUEUE  ('CSSL')                                31540005
315500                    FROM  (PV-CICS-MSG-AREA2)                     31550005
315600                  LENGTH  (PV-COMMAREA-LENGTH)                    31560005
315700                    RESP  (PV-CICS-RESP)                          31570005
315800             END-EXEC                                             31580005
315900              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         31590005
316000              PERFORM 9900-SOFT-ABORT                             31600005
316100         WHEN SQLWARN0 NOT = SPACES                               31610005
316200         WHEN SQLCODE NOT EQUAL ZERO                              31620005
316300              MOVE '4740-UPDATE-STAT-CDE'                         31630005
316400                                   TO DP013-PARAGRAPH             31640005
316500              STRING ' PULL NUMBER-'  DELIMITED BY SIZE           31650005
316600                     PV-PULL-NUMBER   DELIMITED BY SIZE           31660005
316700                     '  -  LINE NBR-' DELIMITED BY SIZE           31670005
316800                     PV-LINE-NUMBER   DELIMITED BY SIZE           31680005
316900                     '  -  UPD UNIT-' DELIMITED BY SIZE           31690005
317000                     PV-UPDATE-UNITS  DELIMITED BY SIZE           31700005
317100                     '  TRYING TO DWNLD_RDM_STAT_CDE'             31710005
317200                                      DELIMITED BY SIZE           31720005
317300                                 INTO DP013-MESSAGE-TEXT (1)      31730005
317400              MOVE SQLCA           TO DP013-SQLCA                 31740005
317500              MOVE 'TCEPLIT'       TO DP013-DB2-TABLE-NAME (1)    31750005
317600              SET DP013-DB2-ABEND  TO TRUE                        31760005
317700              PERFORM DP013-0000-PROCESS-ABEND                    31770005
317800     END-EVALUATE.                                                31780005
317900                                                                  31790005
318000 EJECT                                                            31800005
318100*----------------------------------------------------------------*31810005
318200*                                                                *31820005
318300*----------------------------------------------------------------*31830005
318400 4830-LINE-STATUS.                                                31840005
318500                                                                  31850005
318600     EXEC SQL                                                     31860005
318700          SELECT STAT_CDE                                         31870005
318800            INTO :PV-PULL-STATUS                                  31880005
318900            FROM TCEPLIT                                          31890005
319000           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             31900005
319100             AND PL_LNE_NBR        =  :DK-LINE-NUMBER             31910005
319200     END-EXEC.                                                    31920005
319300                                                                  31930005
319400     EVALUATE TRUE                                                31940005
319500         WHEN SQLCODE = +0                                        31950005
319600              CONTINUE                                            31960005
319700                                                                  31970005
319800         WHEN OTHER                                               31980005
319900              MOVE '4830-LINE-STATUS     '    TO DP013-PARAGRAPH  31990005
320000              MOVE 'GET NEW LINE STATUS AFTER CONFIRM ROUTINE'    32000005
320100                                       TO DP013-MESSAGE-TEXT (1)  32010005
320200              STRING ' PULL NBR-'    DELIMITED BY SIZE            32020005
320300                      ASC-PULL-NBR-N DELIMITED BY SIZE            32030005
320400                     ' LINE NBR-'    DELIMITED BY SIZE            32040005
320500                      LQW-LINE-NUMBER (LQW-IDX)                   32050005
320600                                     DELIMITED BY SIZE            32060005
320700                                     INTO DP013-MESSAGE-TEXT (2)  32070005
320800              MOVE SQLCA                      TO DP013-SQLCA      32080005
320900              MOVE 'TCEPLIT '        TO DP013-DB2-TABLE-NAME (1)  32090005
321000              SET  DP013-DB2-ABEND                                32100005
321100                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            32110005
321200              PERFORM DP013-0000-PROCESS-ABEND                    32120005
321300     END-EVALUATE.                                                32130005
321400                                                                  32140005
321500 EJECT                                                            32150005
321600*----------------------------------------------------------------*32160005
321700*                                                                *32170005
321800*----------------------------------------------------------------*32180005
321900 4840-GET-NEW-PULL-STATUS.                                        32190005
322000                                                                  32200005
322100     MOVE ASC-PULL-NBR              TO  DK-PULL-NUMBER.           32210005
322200                                                                  32220005
322300     EXEC SQL                                                     32230005
322400          SELECT STAT_CDE                                         32240005
322500            INTO :PV-PULL-STATUS                                  32250005
322600            FROM TCEPLRQ                                          32260005
322700           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             32270005
322800     END-EXEC.                                                    32280005
322900                                                                  32290005
323000     EVALUATE TRUE                                                32300005
323100         WHEN SQLCODE = +0                                        32310005
323200              MOVE  PV-PULL-STATUS TO ASC-PULL-STATUS             32320005
323300              CONTINUE                                            32330005
323400                                                                  32340005
323500         WHEN OTHER                                               32350005
323600              MOVE '4840-GET-NEW-PULL-STATUS' TO DP013-PARAGRAPH  32360005
323700              MOVE 'GET NEW PULL STATUS AFTER CONFIRM ROUTINE'    32370005
323800                                       TO DP013-MESSAGE-TEXT (1)  32380005
323900              STRING ' PULL NBR-'    DELIMITED BY SIZE            32390005
324000                      ASC-PULL-NBR-N DELIMITED BY SIZE            32400005
324100                     ' LINE NBR-'    DELIMITED BY SIZE            32410005
324200                      LQW-LINE-NUMBER (LQW-IDX)                   32420005
324300                                     DELIMITED BY SIZE            32430005
324400                                     INTO DP013-MESSAGE-TEXT (2)  32440005
324500              MOVE SQLCA                      TO DP013-SQLCA      32450005
324600              MOVE 'TCEPLRQ '        TO DP013-DB2-TABLE-NAME (1)  32460005
324700              SET  DP013-DB2-ABEND                                32470005
324800                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            32480005
324900              PERFORM DP013-0000-PROCESS-ABEND                    32490005
325000     END-EVALUATE.                                                32500005
325100                                                                  32510005
325200 EJECT                                                            32520005
325300*----------------------------------------------------------------*32530005
325400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *32540005
325500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *32550005
325600* FOR THE SELECTED ITEMS QUEUE.                                  *32560005
325700*                                                                *32570005
325800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *32580005
325900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *32590005
326000* THE ARRAY IS FULL.                                             *32600005
326100*----------------------------------------------------------------*32610005
326200 5000-PREPARE-SEL-QUEUE.                                          32620005
326300                                                                  32630005
326400     MOVE +1                   TO  ASC-BLK-SUB.                   32640005
326500     PERFORM 5100-WRITE-TEMP-STORAGE.                             32650005
326600     ADD +1                    TO  ASC-BLK-SUB.                   32660005
326700     PERFORM 5100-WRITE-TEMP-STORAGE.                             32670005
326800                                                                  32680005
326900     MOVE ASC-SEL-QUEUE-NAME-2 TO  ASC-SEL-QUEUE-NAME.            32690005
327000     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          32700005
327100     PERFORM 6010-DELETE-SEL-QUEUE.                               32710005
327200                                                                  32720005
327300     SET ASC-UPDATE-TSQ        TO  TRUE.                          32730005
327400                                                                  32740005
327500     SET CE003-IDX             TO  1.                             32750005
327600     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       32760005
327700     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        32770005
327800                                                                  32780005
327900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           32790005
328000             VARYING PV-ITEM                                      32800005
328100             FROM 1 BY 1                                          32810005
328200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     32820005
328300                                                                  32830005
328400     IF  CE003-IDX > 1                                            32840005
328500         PERFORM 5205-WRITE-SEL-QUEUE                             32850005
328600         ADD +1                TO CE002-NUMBER-OF-TS-ITEMS        32860005
328700     END-IF.                                                      32870005
328800                                                                  32880005
328900 EJECT                                                            32890005
329000*----------------------------------------------------------------*32900005
329100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *32910005
329200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *32920005
329300*----------------------------------------------------------------*32930005
329400 5100-WRITE-TEMP-STORAGE.                                         32940005
329500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     32950005
329600                                   TO PV-LIST-ITEM-NUMBER.        32960005
329700     COMPUTE PV-BLOCK-NUMBER =                                    32970005
329800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    32980005
329900                                                                  32990005
330000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             33000005
330100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             33010005
330200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      33020005
330300             PERFORM 5105-REWRITE-ASC-LISTQ                       33030005
330400         END-IF                                                   33040005
330500     ELSE                                                         33050005
330600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       33060005
330700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            33070005
330800         PERFORM 5110-WRITE-ASC-LISTQ                             33080005
330900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   33090005
331000     END-IF.                                                      33100005
331100                                                                  33110005
331200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33120005
331300                                                                  33130005
331400 EJECT                                                            33140005
331500******************************************************************33150005
331600** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **33160005
331700** SPECIFIC COMMAREA.                                           **33170005
331800******************************************************************33180005
331900 5105-REWRITE-ASC-LISTQ.                                          33190005
332000     EXEC CICS                                                    33200005
332100         WRITEQ TS                                                33210005
332200             QUEUE (ASC-LIST-QUEUE-NAME)                          33220005
332300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33230005
332400             ITEM  (PV-BLOCK-NUMBER)                              33240005
332500             REWRITE                                              33250005
332600             RESP  (PV-CICS-RESP)                                 33260005
332700     END-EXEC.                                                    33270005
332800                                                                  33280005
332900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           33290005
333000         CONTINUE                                                 33300005
333100     ELSE                                                         33310005
333200         SET DP013-CICS-ABEND            TO TRUE                  33320005
333300         SET DP013-NO-ROLLBACK           TO TRUE                  33330005
333400         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       33340005
333500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     33350005
333600                                         TO DP013-MESSAGE-TEXT(1) 33360005
333700         PERFORM DP013-0000-PROCESS-ABEND                         33370005
333800     END-IF.                                                      33380005
333900                                                                  33390005
334000 EJECT                                                            33400005
334100******************************************************************33410005
334200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **33420005
334300** SPECIFIC COMMAREA.                                           **33430005
334400******************************************************************33440005
334500 5110-WRITE-ASC-LISTQ.                                            33450005
334600     EXEC CICS                                                    33460005
334700         WRITEQ TS                                                33470005
334800             QUEUE (ASC-LIST-QUEUE-NAME)                          33480005
334900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33490005
335000             ITEM  (PV-BLOCK-NUMBER)                              33500005
335100             RESP  (PV-CICS-RESP)                                 33510005
335200     END-EXEC.                                                    33520005
335300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      33530005
335400         SET DP013-CICS-ABEND      TO TRUE                        33540005
335500         SET DP013-NO-ROLLBACK     TO TRUE                        33550005
335600         MOVE '5110-WRITE-ASC-LISTQ'                              33560005
335700                                   TO DP013-PARAGRAPH             33570005
335800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           33580005
335900                                   TO DP013-MESSAGE-TEXT(1)       33590005
336000         PERFORM DP013-0000-PROCESS-ABEND                         33600005
336100     END-IF.                                                      33610005
336200                                                                  33620005
336300 EJECT                                                            33630005
336400*----------------------------------------------------------------*33640005
336500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *33650005
336600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *33660005
336700*----------------------------------------------------------------*33670005
336800 5200-FILL-SEL-QUEUE-RECORD.                                      33680005
336900                                                                  33690005
337000     PERFORM 6112-READ-LIST-QUEUE.                                33700005
337100                                                                  33710005
337200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       33720005
337300         PERFORM                                                  33730005
337400         VARYING LQW-IDX                                          33740005
337500         FROM 1 BY 1                                              33750005
337600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            33760005
337700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          33770005
337800                                                                  33780005
337900             IF  LQW-SELECT (LQW-IDX)                             33790005
338000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              33800005
338100                                   TO CE003-ITEM (CE003-IDX)      33810005
338200                 MOVE SPACE        TO CE003-ACTION-SW (CE003-IDX) 33820005
338300                                                                  33830005
338400                 MOVE ASC-PULL-NBR TO  CE003-PULL-NUMBER          33840005
338500                                        (CE003-IDX)               33850005
338600                 MOVE ASC-REF-NBR  TO  CE003-REF-NUMBER           33860005
338700                                        (CE003-IDX)               33870005
338800                 MOVE ASC-CS-LOC   TO  CE003-CS-LOCATION          33880005
338900                                        (CE003-IDX)               33890005
339000                 MOVE ZEROES       TO  CE003-CREATE-DATE          33900005
339100                                        (CE003-IDX)               33910005
339200                 MOVE ASC-PULL-STATUS                             33920005
339300                                   TO  CE003-PULL-STATUS-CDE      33930005
339400                                        (CE003-IDX)               33940005
339500                 MOVE ASC-PULL-TYPE                               33950005
339600                                   TO  CE003-PULL-SOURCE-CDE      33960005
339700                                        (CE003-IDX)               33970005
339800                 MOVE ZEROES       TO  CE003-NBR-ITEMS            33980005
339900                                        (CE003-IDX)               33990005
340000                 MOVE LQW-NBR-STORES (LQW-IDX)                    34000005
340100                                   TO  CE003-NBR-STORES           34010005
340200                                        (CE003-IDX)               34020005
340300                 MOVE LQW-REQ-PULL-UNITS (LQW-IDX)                34030005
340400                                   TO  CE003-REQ-PULL-UNITS       34040005
340500                                        (CE003-IDX)               34050005
340600                 MOVE LQW-ACT-PULL-UNITS (LQW-IDX)                34060005
340700                                   TO  CE003-ACT-PULL-UNITS       34070005
340800                                        (CE003-IDX)               34080005
340900                 MOVE LQW-DISTRBUTED-UNITS (LQW-IDX)              34090005
341000                                   TO  CE003-DIST-PULL-UNITS      34100005
341100                                        (CE003-IDX)               34110005
341200                 MOVE LQW-LINE-STATUS-CDE (LQW-IDX)               34120005
341300                                   TO  CE003-LINE-STATUS-CDE      34130005
341400                                        (CE003-IDX)               34140005
341500                 MOVE LQW-SKU-NUMBER (LQW-IDX)                    34150005
341600                                   TO  CE003-LINE-SKU             34160005
341700                                        (CE003-IDX)               34170005
341800                 MOVE LQW-LINE-SKU-RETAIL (LQW-IDX)               34180005
341900                                   TO  CE003-LINE-SKU-RETAIL      34190005
342000                                        (CE003-IDX)               34200005
342100                 MOVE LQW-LINE-ITEM (LQW-IDX)                     34210005
342200                                   TO  CE003-LINE-ITEM            34220005
342300                                        (CE003-IDX)               34230005
342400                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   34240005
342500                                   TO  CE003-LINE-NUMBER          34250005
342600                                        (CE003-IDX)               34260005
342700                                                                  34270005
342800                 SET CE003-IDX UP BY 1                            34280005
342900                 IF  CE003-IDX > CE003-MAX-ITEMS                  34290005
343000                     PERFORM 5205-WRITE-SEL-QUEUE                 34300005
343100                     ADD +1        TO CE002-NUMBER-OF-TS-ITEMS    34310005
343200                     INITIALIZE CE003-SELECTED-ITEM-ARRAY         34320005
343300                     SET CE003-IDX TO  1                          34330005
343400                 END-IF                                           34340005
343500             END-IF                                               34350005
343600         END-PERFORM                                              34360005
343700     END-IF.                                                      34370005
343800                                                                  34380005
343900 EJECT                                                            34390005
344000*----------------------------------------------------------------*34400005
344100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *34410005
344200*----------------------------------------------------------------*34420005
344300 5205-WRITE-SEL-QUEUE.                                            34430005
344400                                                                  34440005
344500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34450005
344600                                   TO CE003-SELECTED-ITEMS.       34460005
344700                                                                  34470005
344800     EXEC CICS                                                    34480005
344900          WRITEQ TS                                               34490005
345000              QUEUE (ASC-SEL-QUEUE-NAME)                          34500005
345100              FROM  (CE003-SELECT-RECORD)                         34510005
345200              ITEM  (PV-SEL-QUEUE-ITEM)                           34520005
345300              RESP  (PV-CICS-RESP)                                34530005
345400     END-EXEC.                                                    34540005
345500                                                                  34550005
345600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34560005
345700         CONTINUE                                                 34570005
345800     ELSE                                                         34580005
345900         SET DP013-CICS-ABEND      TO TRUE                        34590005
346000         SET DP013-NO-ROLLBACK     TO TRUE                        34600005
346100         MOVE '5205-WRITE-SEL-QUEUE'                              34610005
346200                                   TO DP013-PARAGRAPH             34620005
346300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          34630005
346400                                   TO DP013-MESSAGE-TEXT(1)       34640005
346500         PERFORM DP013-0000-PROCESS-ABEND                         34650005
346600     END-IF.                                                      34660005
346700                                                                  34670005
346800 EJECT                                                            34680005
346900******************************************************************34690005
347000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **34700005
347100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **34710005
347200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **34720005
347300** THE USER.                                                    **34730005
347400******************************************************************34740005
347500 6000-REFRESH-PANEL-FROM-TEMP.                                    34750005
347600     IF  ASC-UPDATE-TSQ                                           34760005
347700         SET ASC-NO-TSQ-UPDATE TO TRUE                            34770005
347800         MOVE ZERO                 TO PV-SAVE-ITEM                34780005
347900                                      PV-SEL-QUEUE-ITEM           34790005
348000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        34800005
348100                                   TO PV-HOLD-SELECTED-ITEMS      34810005
348200         MOVE +1                   TO PV-ITEMS-PROCESSED          34820005
348300         PERFORM 6100-UPDATE-TSQ                                  34830005
348400             UNTIL PV-ITEMS-PROCESSED >                           34840005
348500                                     PV-HOLD-SELECTED-ITEMS       34850005
348600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         34860005
348700                    ASC-BLOCK-ENTRIES (2)                         34870005
348800     END-IF.                                                      34880005
348900                                                                  34890005
349000 EJECT                                                            34900005
349100*----------------------------------------------------------------*34910005
349200*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *34920005
349300*----------------------------------------------------------------*34930005
349400 6010-DELETE-SEL-QUEUE.                                           34940005
349500                                                                  34950005
349600     EXEC CICS                                                    34960005
349700         DELETEQ TS                                               34970005
349800             QUEUE (ASC-SEL-QUEUE-NAME)                           34980005
349900             RESP  (PV-CICS-RESP)                                 34990005
350000     END-EXEC.                                                    35000005
350100*                                                                 35010005
350200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      35020005
350300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         35030005
350400         CONTINUE                                                 35040005
350500     ELSE                                                         35050005
350600         SET DP013-CICS-ABEND TO TRUE                             35060005
350700         SET DP013-NO-ROLLBACK TO TRUE                            35070005
350800         MOVE '6010-DELETE-SEL-QUEUE'                             35080005
350900                        TO DP013-PARAGRAPH                        35090005
351000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         35100005
351100                        TO DP013-MESSAGE-TEXT (1)                 35110005
351200         PERFORM DP013-0000-PROCESS-ABEND                         35120005
351300     END-IF.                                                      35130005
351400                                                                  35140005
351500 EJECT                                                            35150005
351600*----------------------------------------------------------------*35160005
351700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *35170005
351800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *35180005
351900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *35190005
352000*    THE TEMP QUEUE.                                             *35200005
352100*----------------------------------------------------------------*35210005
352200 6100-UPDATE-TSQ.                                                 35220005
352300                                                                  35230005
352400     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             35240005
352500     PERFORM 6105-READ-SEL-QUEUE.                                 35250005
352600     PERFORM                                                      35260005
352700         VARYING CE003-IDX                                        35270005
352800         FROM 1 BY 1                                              35280005
352900         UNTIL ((PV-ITEMS-PROCESSED >                             35290005
353000                              PV-HOLD-SELECTED-ITEMS)             35300005
353100         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             35310005
353200         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  35320005
353300             PERFORM 6110-PROCESS-ITEMS                           35330005
353400         END-IF                                                   35340005
353500         ADD +1                TO PV-ITEMS-PROCESSED              35350005
353600     END-PERFORM.                                                 35360005
353700     PERFORM 6111-WRITE-LIST-QUEUE.                               35370005
353800                                                                  35380005
353900 EJECT                                                            35390005
354000*----------------------------------------------------------------*35400005
354100*    READ THE LIST QUEUE RECORD.                                 *35410005
354200*----------------------------------------------------------------*35420005
354300 6105-READ-SEL-QUEUE.                                             35430005
354400                                                                  35440005
354500     EXEC CICS                                                    35450005
354600          READQ TS                                                35460005
354700              QUEUE (ASC-SEL-QUEUE-NAME)                          35470005
354800              INTO  (CE003-SELECT-RECORD)                         35480005
354900              ITEM  (PV-SEL-QUEUE-ITEM)                           35490005
355000              RESP  (PV-CICS-RESP)                                35500005
355100     END-EXEC.                                                    35510005
355200*                                                                 35520005
355300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          35530005
355400         CONTINUE                                                 35540005
355500     ELSE                                                         35550005
355600         SET DP013-CICS-ABEND      TO  TRUE                       35560005
355700         SET DP013-NO-ROLLBACK     TO  TRUE                       35570005
355800         MOVE '6105-READ-SEL-QUEUE'                               35580005
355900                                   TO  DP013-PARAGRAPH            35590005
356000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           35600005
356100                                   TO  DP013-MESSAGE-TEXT(1)      35610005
356200         PERFORM DP013-0000-PROCESS-ABEND                         35620005
356300     END-IF.                                                      35630005
356400                                                                  35640005
356500 EJECT                                                            35650005
356600*----------------------------------------------------------------*35660005
356700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*35670005
356800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*35680005
356900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *35690005
357000*----------------------------------------------------------------*35700005
357100 6110-PROCESS-ITEMS.                                              35710005
357200                                                                  35720005
357300     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          35730005
357400                     / PC-ITEMS-PER-PANEL).                       35740005
357500                                                                  35750005
357600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           35760005
357700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          35770005
357800             PERFORM 6111-WRITE-LIST-QUEUE                        35780005
357900         END-IF                                                   35790005
358000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    35800005
358100                                                                  35810005
358200         PERFORM 6112-READ-LIST-QUEUE                             35820005
358300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               35830005
358400             CONTINUE                                             35840005
358500         END-IF                                                   35850005
358600     END-IF.                                                      35860005
358700                                                                  35870005
358800     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     35880005
358900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              35890005
359000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         35900005
359100     MOVE LQW-SELECTED-SW (PV-SUB)                                35910005
359200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  35920005
359300     EVALUATE TRUE                                                35930005
359400         WHEN CE003-INQ (CE003-IDX)                               35940005
359500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             35950005
359600                                                                  35960005
359700         WHEN CE003-UPD (CE003-IDX)                               35970005
359800              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             35980005
359900                                                                  35990005
360000         WHEN CE003-DEL (CE003-IDX)                               36000005
360100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             36010005
360200                                                                  36020005
360300         WHEN CE003-ERR (CE003-IDX)                               36030005
360400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             36040005
360500     END-EVALUATE.                                                36050005
360600                                                                  36060005
360700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                36070005
360800                                                                  36080005
360900 EJECT                                                            36090005
361000*----------------------------------------------------------------*36100005
361100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *36110005
361200*----------------------------------------------------------------*36120005
361300 6111-WRITE-LIST-QUEUE.                                           36130005
361400                                                                  36140005
361500     EXEC CICS                                                    36150005
361600         WRITEQ TS                                                36160005
361700             QUEUE (ASC-LIST-QUEUE-NAME)                          36170005
361800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     36180005
361900             ITEM  (PV-SAVE-ITEM)                                 36190005
362000             REWRITE                                              36200005
362100             RESP  (PV-CICS-RESP)                                 36210005
362200     END-EXEC.                                                    36220005
362300*                                                                 36230005
362400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36240005
362500         CONTINUE                                                 36250005
362600     ELSE                                                         36260005
362700         SET DP013-CICS-ABEND  TO  TRUE                           36270005
362800         SET DP013-NO-ROLLBACK TO  TRUE                           36280005
362900         MOVE '6111-WRITE-LIST-QUEUE'                             36290005
363000                               TO  DP013-PARAGRAPH                36300005
363100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  36310005
363200                               TO  DP013-MESSAGE-TEXT(1)          36320005
363300         PERFORM DP013-0000-PROCESS-ABEND                         36330005
363400     END-IF.                                                      36340005
363500                                                                  36350005
363600 EJECT                                                            36360005
363700*----------------------------------------------------------------*36370005
363800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*36380005
363900*----------------------------------------------------------------*36390005
364000 6112-READ-LIST-QUEUE.                                            36400005
364100                                                                  36410005
364200     EXEC CICS                                                    36420005
364300         READQ TS                                                 36430005
364400             QUEUE (ASC-LIST-QUEUE-NAME)                          36440005
364500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     36450005
364600             ITEM  (PV-ITEM)                                      36460005
364700             RESP  (PV-CICS-RESP)                                 36470005
364800     END-EXEC.                                                    36480005
364900*                                                                 36490005
365000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36500005
365100         CONTINUE                                                 36510005
365200     ELSE                                                         36520005
365300         SET DP013-CICS-ABEND        TO TRUE                      36530005
365400         SET DP013-NO-ROLLBACK       TO TRUE                      36540005
365500         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           36550005
365600         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    36560005
365700                                     TO DP013-MESSAGE-TEXT(1)     36570005
365800         PERFORM DP013-0000-PROCESS-ABEND                         36580005
365900     END-IF.                                                      36590005
366000                                                                  36600005
366100 EJECT                                                            36610005
366200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 36620005
366300* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *36630005
366400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 36640005
366500 9100-READ-SEL-QUEUE.                                             36650005
366600     EXEC CICS                                                    36660005
366700         READQ TS                                                 36670005
366800             QUEUE (ASC-SEL-QUEUE-NAME)                           36680005
366900             INTO  (CE003-SELECT-RECORD)                          36690005
367000             ITEM  (ASC-SEL-ITEM)                                 36700005
367100             RESP  (PV-CICS-RESP)                                 36710005
367200     END-EXEC.                                                    36720005
367300     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        36730005
367400         CONTINUE                                                 36740005
367500     ELSE                                                         36750005
367600         SET DP013-LOGIC-ABEND                                    36760005
367700             DP013-NO-ROLLBACK   TO   TRUE                        36770005
367800         MOVE '9100-READ-SEL-QUEUE'                               36780005
367900                                 TO   DP013-PARAGRAPH             36790005
368000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   36800005
368100                                 TO   DP013-MESSAGE-TEXT (1)      36810005
368200         PERFORM DP013-0000-PROCESS-ABEND                         36820005
368300     END-IF.                                                      36830005
368400                                                                  36840005
368500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*36850005
368600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *36860005
368700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 36870005
368800 9200-REWRITE-SEL-QUEUE.                                          36880005
368900                                                                  36890005
369000     EXEC CICS                                                    36900005
369100          WRITEQ TS                                               36910005
369200              QUEUE  (ASC-SEL-QUEUE-NAME)                         36920005
369300              FROM   (CE003-SELECT-RECORD)                        36930005
369400              ITEM   (ASC-SEL-ITEM)                               36940005
369500              RESP   (PV-CICS-RESP)                               36950005
369600              REWRITE                                             36960005
369700     END-EXEC.                                                    36970005
369800                                                                  36980005
369900     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   36990005
370000         SET DP013-CICS-ABEND                                     37000005
370100             DP013-NO-ROLLBACK     TO TRUE                        37010005
370200         MOVE '9200-REWRITE-SEL-QUEUE'                            37020005
370300                                   TO DP013-PARAGRAPH             37030005
370400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   37040005
370500                                   TO DP013-MESSAGE-TEXT (1)      37050005
370600         PERFORM DP013-0000-PROCESS-ABEND                         37060005
370700     END-IF.                                                      37070005
370800                                                                  37080005
370900*----------------------------------------------------------------*37090005
371000*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *37100005
371100*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *37110005
371200*----------------------------------------------------------------*37120005
371300 9900-SOFT-ABORT.                                                 37130005
371400                                                                  37140005
371500     EXEC CICS SYNCPOINT                                          37150005
371600          ROLLBACK                                                37160005
371700     END-EXEC.                                                    37170005
371800                                                                  37180005
371900     SET  PS-ERROR                                                37190005
372000          PS-SOFT-ABORT-ERROR                                     37200005
372100          DP020-MSG-FATAL       TO  TRUE.                         37210005
372200                                                                  37220005
372300*----------------------------------------------------------------*37230005
372400*    ABEND PROCESSOR MODULE                                      *37240005
372500*----------------------------------------------------------------*37250005
372600                                                                  37260005
372700     COPY DPPD013.                                                37270005
