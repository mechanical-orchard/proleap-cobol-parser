000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         XMKRP039.                                    00020007
000300 AUTHOR.             BOB MCASEY.                                  00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       03-22-2003.                                  00050000
000600 DATE-COMPILED.                                                   00060000
000700*                                                                 00070000
000800******************************************************************00080011
000810*  COMPARES DATA FROM THE XMDOMAIN AND SYSTEM OF RECORD           00090011
000811*  XMT_STR_GP_MBSHP TABLE.                                        00100011
000820******************************************************************00110011
      *---------------------------------------------------------------* 00120011
      *    WR/PITS#     DATE        DESCRIPTION                       * 00130011
      *    --------   ----------   ---------------------------------  * 00140011
      *    WR24442    08/20/2003   INITIAL CREATION.                  * 00150011
      *---------------------------------------------------------------* 00160011
000800 ENVIRONMENT DIVISION.                                            00170000
000900                                                                  00180000
001000 CONFIGURATION SECTION.                                           00190000
001100                                                                  00200000
001200 SOURCE-COMPUTER.    IBM-3090.                                    00210000
001300 OBJECT-COMPUTER.    IBM-3090.                                    00220000
001400                                                                  00230000
001500 INPUT-OUTPUT SECTION.                                            00240000
001600                                                                  00250000
001700 FILE-CONTROL.                                                    00260000
001800                                                                  00270000
001900     SELECT XMT-INPUT-FILE       ASSIGN TO INP01.                 00280000
002000     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00290000
002100     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00300000
002200                                                                  00310000
002300 DATA DIVISION.                                                   00320000
002400                                                                  00330000
002500 FILE SECTION.                                                    00340000
002600                                                                  00350000
003300 FD  XMT-INPUT-FILE                                               00360000
003400     RECORDING MODE IS F                                          00370000
003500     BLOCK CONTAINS 0 RECORDS                                     00380000
003600     LABEL RECORDS ARE OMITTED.                                   00390000
003700 01  XMT-INPUT-RECORD                    PIC  X(27).              00400000
003800                                                                  00410000
002700 FD  RMS-INPUT-FILE                                               00420000
002800     RECORDING MODE IS F                                          00430000
002900     BLOCK CONTAINS 0 RECORDS                                     00440000
003000     LABEL RECORDS ARE OMITTED.                                   00450000
003100 01  RMS-INPUT-RECORD                    PIC  X(35).              00460000
003200                                                                  00470000
003900 FD  ERROR-REPORT                                                 00480000
004000     RECORDING MODE IS F                                          00490000
004100     BLOCK CONTAINS 0 RECORDS                                     00500000
004200     LABEL RECORDS ARE OMITTED.                                   00510000
004300 01  ERR-RPT-LINE                        PIC  X(200).             00520000
004400                                                                  00530000
004500 WORKING-STORAGE SECTION.                                         00540000
004600                                                                  00550000
005351 01 PC-PROGRAM-CONSTANTS.                                         00560000
005352     05 PC-PGM-NAME                 PIC X(08)  VALUE 'XMKRP039'.  00570005
005353                                                                  00580000
005360 01 PV-PROGRAM-VARIABLES.                                         00590000
005370     05 PV-XMT-KEY.                                               00600000
005380        10 PV-XMT-STR-NBR           PIC 9(04).                    00610000
005381        10 PV-XMT-STR-GP-TYP-CDE    PIC 9(04).                    00620000
005382        10 PV-XMT-STR-GP-ID         PIC 9(04).                    00630000
005383        10 PV-XMT-STR-EFF-BEG-DTE   PIC X(10) VALUE SPACE.        00640000
005390     05 PV-XMT-STR-EFF-END-DTE      PIC X(10) VALUE SPACE.        00650000
005400                                                                  00660000
005410     05 PV-RMS-KEY.                                               00670000
005420        10 PV-RMS-STR-NBR           PIC 9(04).                    00680000
005421        10 PV-RMS-STR-GP-TYP-CDE    PIC 9(04).                    00690000
005422        10 PV-RMS-STR-GP-ID         PIC 9(04).                    00700000
005423        10 PV-RMS-STR-EFF-BEG-DTE   PIC X(10) VALUE SPACE.        00710000
005430     05 PV-RMS-STR-EFF-END-DTE      PIC X(10) VALUE SPACE.        00720000
005433                                                                  00730000
005440     05 PV-PAGE-CNT                 PIC S9(05)  VALUE ZERO.       00740000
005450     05 PV-LINE-CNT                 PIC S9(04)  COMP VALUE ZERO.  00750000
005460     05 PV-MAX-LINES                PIC S9(04)  COMP VALUE +71.   00760000
005470                                                                  00770000
005480     05 PV-DISPLAY-CNT              PIC ZZZZ9.                    00780000
005492     05 PV-NBR-ERRORS               PIC S9(04)  COMP              00790000
005493                                                VALUE ZERO.       00800000
005494     05 PV-DATE-YYMMDD.                                           00810000
005495          10 PV-YYMMDD-YY           PIC X(02)  VALUE SPACE.       00820000
005496          10 PV-YYMMDD-MM           PIC X(02)  VALUE SPACE.       00830000
005497          10 PV-YYMMDD-DD           PIC X(02)  VALUE SPACE.       00840000
005498     05 PV-TIME-HHMMSS.                                           00850000
005499          10 PV-HHMMSS-HH           PIC X(02)  VALUE SPACE.       00860000
005500          10 PV-HHMMSS-MM           PIC X(02)  VALUE SPACE.       00870000
005501          10 PV-HHMMSS-SS           PIC X(02)  VALUE SPACE.       00880000
005502     05 PV-MESSAGE                  PIC X(50)  VALUE SPACE.       00890000
005510                                                                  00900000
005530 01 RPT-TOTAL-LINE.                                               00910000
005540     05 FILLER     PIC  X(23) VALUE                               00920000
005550                         'TOTAL NUMBER OF ERRORS '.               00930000
005560     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00940000
005561                                                                  00950000
005562 01 RPT-END-OF-REPORT-LINE.                                       00960000
005563     05 FILLER     PIC  X(21) VALUE                               00970000
005564                            '*** END OF REPORT ***'.              00980000
005565 01 PA-PROGRAM-ACCUMULATORS.                                      00990000
005566     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              01000000
005567     05 PA-XMT-RECS-READ       PIC 9(13) VALUE ZERO.              01010000
005568     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              01020000
005569                                                                  01030000
005571 01 PS-PROGRAM-SWITCHES.                                          01040000
005572     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01050000
005573         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           01060000
005574         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           01070000
005575     05 PS-MORE-XMT-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01080000
005576         88 PS-MORE-XMT-INPUT-RECS           VALUE 'Y'.           01090000
005577         88 PS-END-OF-XMT-INPUT-RECS         VALUE 'N'.           01100000
005578     05 PS-RMS-OR-XMT-ERR        PIC X(01)   VALUE '0'.           01110000
005579         88 PS-RMS-ERROR                     VALUE '1'.           01120000
005580         88 PS-XMT-ERROR                     VALUE '2'.           01130000
005581         88 PS-DATA-ERROR                    VALUE '3'.           01140000
005582                                                                  01150000
005583 01 RPT-REPORT-HEADING.                                           01160000
005584     05 FILLER     PIC  X(77)    VALUE SPACES.                    01170010
005585     05 FILLER     PIC  X(47)    VALUE                            01180000
005586         'XM STORE GROUP MEMBERSHIP DATA INTEGRITY ERRORS'.       01190000
005587                                                                  01200000
005588 01 RPT-COL-HEADING-1.                                            01210000
005589     05 FILLER     PIC  X(01) VALUE SPACE.                        01220000
005590     05 FILLER     PIC  X(15) VALUE ALL '-'.                      01230000
005591     05 FILLER     PIC  X(03) VALUE 'KEY'.                        01240000
005592     05 FILLER     PIC  X(15) VALUE ALL '-'.                      01250000
005593                                                                  01260000
005594 01 RPT-COL-HEADING-2.                                            01270000
005595     05 FILLER     PIC  X(01) VALUE SPACE.                        01280000
005596     05 FILLER     PIC  X(07) VALUE 'STR_NBR'.                    01290000
005597     05 FILLER     PIC  X(01) VALUE SPACE.                        01300000
005598     05 FILLER     PIC  X(06) VALUE 'STR_GP'.                     01310000
005599     05 FILLER     PIC  X(02) VALUE SPACE.                        01320000
005600     05 FILLER     PIC  X(06) VALUE 'STR_GP'.                     01330000
005601     05 FILLER     PIC  X(03) VALUE SPACE.                        01340000
005602     05 FILLER     PIC  X(07) VALUE 'EFF_BEG'.                    01350000
005603     05 FILLER     PIC  X(10) VALUE SPACE.                        01360000
005604     05 FILLER     PIC  X(08) VALUE 'XMDOMAIN'.                   01370000
005605     05 FILLER     PIC  X(07) VALUE SPACE.                        01380000
005606     05 FILLER     PIC  X(16) VALUE 'SYSTEM OF RECORD'.           01390000
005607     05 FILLER     PIC  X(12) VALUE SPACE.                        01400000
005608     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    01410000
005609                                                                  01420000
005610 01 RPT-COL-HEADING-3.                                            01430000
005611     05 FILLER     PIC  X(09) VALUE SPACE.                        01440000
005612     05 FILLER     PIC  X(07) VALUE 'TYP_CDE'.                    01450000
005613     05 FILLER     PIC  X(02) VALUE SPACE.                        01460000
005614     05 FILLER     PIC  X(03) VALUE '_ID'.                        01470000
005615     05 FILLER     PIC  X(06) VALUE SPACE.                        01480000
005616     05 FILLER     PIC  X(04) VALUE '_DTE'.                       01490000
005617     05 FILLER     PIC  X(11) VALUE SPACE.                        01500000
005618     05 FILLER     PIC  X(11) VALUE 'EFF_END_DTE'.                01510000
005619     05 FILLER     PIC  X(07) VALUE SPACE.                        01520000
005620     05 FILLER     PIC  X(11) VALUE 'EFF_END_DTE'.                01530000
005621                                                                  01540000
005622 01 RPT-COL-HEADING-4.                                            01550000
005623     05 FILLER     PIC  X(132) VALUE ALL '-'.                     01560000
005624                                                                  01570000
005625 01 DL-DETAIL-LINE.                                               01580000
005626     05 FILLER                PIC  X(01) VALUE SPACE.             01590000
005627     05 DL-STR-NBR            PIC  X(04) VALUE SPACE.             01600000
005628     05 FILLER                PIC  X(04) VALUE SPACE.             01610000
005629     05 DL-STR-GP-TYP-CDE     PIC  X(04) VALUE SPACE.             01620000
005630     05 FILLER                PIC  X(04) VALUE SPACE.             01630000
005631     05 DL-STR-GP-ID          PIC  X(04) VALUE SPACE.             01640000
005632     05 FILLER                PIC  X(04) VALUE SPACE.             01650000
005633     05 DL-STR-EFF-BEG-DTE    PIC  X(10) VALUE SPACE.             01660000
005634     05 FILLER                PIC  X(08) VALUE SPACE.             01670000
005635     05 DL-XMT-EFF-END-DTE    PIC  X(10) VALUE SPACE.             01680000
005636     05 FILLER                PIC  X(08) VALUE SPACE.             01690000
005637     05 DL-RMS-EFF-END-DTE    PIC  X(10) VALUE SPACE.             01700000
005638     05 FILLER                PIC  X(08) VALUE SPACE.             01710000
005640     05 DL-MESSAGE            PIC  X(50) VALUE SPACE.             01720000
005641                                                                  01730000
005300     COPY DPWS200O.                                               01740007
005301                                                                  01750000
004700     COPY HORD007.                                                01760003
004701                                                                  01770000
005310 01 XMT-REC.                                                      01780003
005320     05 XMT-STR-NBR                 PIC S9(04) COMP.              01790003
005321     05 XMT-STR-GP-TYP-CDE          PIC S9(04) COMP.              01800003
005330     05 XMT-STR-GP-ID               PIC S9(04) COMP.              01810003
005340     05 XMT-STR-EFF-BEG-DTE         PIC X(10) VALUE SPACE.        01820003
005341     05 XMT-STR-EFF-END-DTE         PIC X(10) VALUE SPACE.        01830003
005342     05 FILLER                      PIC X(01) VALUE SPACE.        01840003
005350                                                                  01850003
005642 PROCEDURE DIVISION.                                              01860000
005643                                                                  01870000
005644 0000-MAIN-MODULE.                                                01880000
005650                                                                  01890000
005660       OPEN INPUT RMS-INPUT-FILE                                  01900000
005670                  XMT-INPUT-FILE                                  01910000
005680            OUTPUT ERROR-REPORT.                                  01920000
005681                                                                  01930000
005690       PERFORM 1000-INITIALIZE.                                   01940000
005691       PERFORM 7000-READ-XMT-INPUT-FILE.                          01950000
005692       PERFORM 7100-READ-RMS-INPUT-FILE.                          01960000
005693                                                                  01970000
005694       PERFORM 2000-PROCESS-RECS                                  01980000
005695          UNTIL (PS-END-OF-XMT-INPUT-RECS                         01990000
005696            AND PS-END-OF-RMS-INPUT-RECS).                        02000000
005700                                                                  02010000
005710       PERFORM 8400-WRITE-TOTALS.                                 02020000
005720                                                                  02030000
005800       CLOSE RMS-INPUT-FILE                                       02040000
005900             XMT-INPUT-FILE                                       02050000
006000             ERROR-REPORT.                                        02060000
006010                                                                  02070000
006100       DISPLAY '**** XMKRP039 STATISTICS ****'                    02080007
006200       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     02090000
006300       DISPLAY 'TOTAL XMT RECORDS READ : ' PA-XMT-RECS-READ.      02100000
006400       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      02110000
006500       DISPLAY ' '                                                02120000
006600                                                                  02130000
006700       STOP RUN.                                                  02140000
006710                                                                  02150000
006800 1000-INITIALIZE.                                                 02160000
006900                                                                  02170000
007000       ACCEPT PV-DATE-YYMMDD FROM DATE.                           02180000
007100       MOVE PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      02190007
007200       MOVE PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     02200007
007300       MOVE PV-YYMMDD-DD TO DP200O-RUN-DAY.                       02210007
007400                                                                  02220000
007500       ACCEPT PV-TIME-HHMMSS FROM TIME.                           02230000
007600       MOVE PV-HHMMSS-HH TO DP200O-RUN-HOUR.                      02240007
007700       MOVE PV-HHMMSS-MM TO DP200O-RUN-MINUTE.                    02250007
007800       MOVE PC-PGM-NAME TO DP200O-PROGRAM-NAME.                   02260007
007900       MOVE 1        TO DP200O-REPORT-NUMBER.                     02270007
008000                                                                  02280000
008100       PERFORM 8100-WRITE-STD-RPT-HEADING.                        02290000
008200       PERFORM 8200-WRITE-REPORT-HEADING.                         02300000
008300       PERFORM 8300-WRITE-COLUMN-HEADING.                         02310000
008400                                                                  02320000
008500 2000-PROCESS-RECS.                                               02330000
008501                                                                  02340000
008510       MOVE HO007-STR-NBR         TO  PV-RMS-STR-NBR.             02350000
008511       MOVE HO007-STR-GP-TYP-CDE  TO  PV-RMS-STR-GP-TYP-CDE.      02360000
008512       MOVE HO007-STR-GP-ID       TO  PV-RMS-STR-GP-ID.           02370000
008520       MOVE HO007-STR-EFF-BEG-DTE TO  PV-RMS-STR-EFF-BEG-DTE.     02380000
008521       MOVE HO007-STR-EFF-END-DTE TO  PV-RMS-STR-EFF-END-DTE.     02390000
008530                                                                  02400000
008540       MOVE XMT-STR-NBR           TO PV-XMT-STR-NBR.              02410004
008541       MOVE XMT-STR-GP-TYP-CDE    TO PV-XMT-STR-GP-TYP-CDE.       02420000
008550       MOVE XMT-STR-GP-ID         TO PV-XMT-STR-GP-ID.            02430004
008551       MOVE XMT-STR-EFF-BEG-DTE   TO PV-XMT-STR-EFF-BEG-DTE.      02440004
008552       MOVE XMT-STR-EFF-END-DTE   TO PV-XMT-STR-EFF-END-DTE.      02450004
008560                                                                  02460000
008561       IF PV-XMT-STR-EFF-END-DTE NOT > ZEROES                     02470000
008562           MOVE SPACES TO PV-XMT-STR-EFF-END-DTE                  02480000
008563       END-IF.                                                    02490000
008564                                                                  02500000
008570      IF PV-XMT-KEY = PV-RMS-KEY                                  02510000
008572         PERFORM 3000-COMPARE-FIELDS                              02520000
008573         PERFORM 7000-READ-XMT-INPUT-FILE                         02530000
008574         PERFORM 7100-READ-RMS-INPUT-FILE                         02540000
008575      ELSE                                                        02550000
008580         IF ((PV-RMS-KEY < PV-XMT-KEY)                            02560000
008590             OR PS-END-OF-XMT-INPUT-RECS) AND                     02570000
008591             PS-MORE-RMS-INPUT-RECS                               02580000
008592             MOVE '1' TO PS-RMS-OR-XMT-ERR                        02590000
008593             MOVE 'KEY ON SYSTEM OF RECORD TABLES ONLY'           02600000
008594                TO PV-MESSAGE                                     02610000
008595             PERFORM 8000-WRITE-OUTPUT-REC                        02620000
008596             PERFORM 7100-READ-RMS-INPUT-FILE                     02630000
008597          ELSE                                                    02640000
008620             IF ((PV-RMS-KEY > PV-XMT-KEY)                        02650000
008630                OR PS-END-OF-RMS-INPUT-RECS) AND                  02660000
008640                PS-MORE-XMT-INPUT-RECS                            02670000
008650                MOVE '2' TO PS-RMS-OR-XMT-ERR                     02680000
008660                MOVE 'KEY ON XM DOMAIN TABLES ONLY' TO PV-MESSAGE 02690000
008670                PERFORM 8000-WRITE-OUTPUT-REC                     02700000
008680                PERFORM 7000-READ-XMT-INPUT-FILE                  02710000
008690             END-IF                                               02720000
008691          END-IF                                                  02730000
008692      END-IF.                                                     02740000
008693                                                                  02750000
008694 3000-COMPARE-FIELDS.                                             02760000
008695                                                                  02770000
008696      EVALUATE TRUE                                               02780000
008698         WHEN ((PV-RMS-STR-EFF-END-DTE NOT =                      02790000
008699                 PV-XMT-STR-EFF-END-DTE)                          02800000
008720             AND NOT (PV-XMT-STR-EFF-END-DTE = '9999-09-09'       02810000
008721             AND  PV-RMS-STR-EFF-END-DTE = SPACES ))              02820000
008726             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02830000
008727             MOVE 'EFFECTIVE END DATES DO NOT MATCH'              02840000
008728                       TO PV-MESSAGE                              02850000
008729             PERFORM 8000-WRITE-OUTPUT-REC                        02860000
008730      END-EVALUATE.                                               02870000
008731                                                                  02880000
008740 7000-READ-XMT-INPUT-FILE.                                        02890000
008800                                                                  02900000
008900       INITIALIZE XMT-REC.                                        02910000
009000                                                                  02920000
009100       READ XMT-INPUT-FILE INTO XMT-REC                           02930000
009200           AT END SET PS-END-OF-XMT-INPUT-RECS TO TRUE.           02940000
009300                                                                  02950000
009400       ADD 1 TO PA-XMT-RECS-READ.                                 02960000
009500                                                                  02970000
009600 7100-READ-RMS-INPUT-FILE.                                        02980000
009700                                                                  02990000
009800       INITIALIZE HO007-STR-GP-MBRSHP-DATA                        03000000
009900                                                                  03010000
010000       READ RMS-INPUT-FILE INTO HO007-STR-GP-MBRSHP-DATA          03020000
010100            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          03030000
010200                                                                  03040000
010300       ADD 1 TO PA-RMS-RECS-READ.                                 03050000
010400                                                                  03060000
010500 8000-WRITE-OUTPUT-REC.                                           03070000
010620                                                                  03080000
010700       IF PS-RMS-ERROR                                            03090000
010800          MOVE SPACES TO DL-DETAIL-LINE                           03100000
010900          MOVE PV-RMS-STR-NBR          TO DL-STR-NBR              03110000
010901          MOVE PV-RMS-STR-GP-TYP-CDE   TO DL-STR-GP-TYP-CDE       03120000
010910          MOVE PV-RMS-STR-GP-ID        TO DL-STR-GP-ID            03130000
011000          MOVE PV-RMS-STR-EFF-BEG-DTE  TO DL-STR-EFF-BEG-DTE      03140000
011001          MOVE PV-RMS-STR-EFF-END-DTE  TO DL-RMS-EFF-END-DTE      03150000
011100          MOVE PV-MESSAGE TO DL-MESSAGE                           03160000
011200       ELSE                                                       03170000
011300          IF PS-XMT-ERROR                                         03180000
011310             MOVE SPACES TO DL-DETAIL-LINE                        03190000
011311             MOVE PV-XMT-STR-NBR TO DL-STR-NBR                    03200000
011320             MOVE PV-XMT-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      03210000
011330             MOVE PV-XMT-STR-GP-ID TO DL-STR-GP-ID                03220000
011340             MOVE PV-XMT-STR-EFF-BEG-DTE TO DL-STR-EFF-BEG-DTE    03230000
011350             MOVE PV-XMT-STR-EFF-END-DTE TO DL-XMT-EFF-END-DTE    03240000
011600             MOVE PV-MESSAGE TO DL-MESSAGE                        03250000
011610          ELSE                                                    03260000
011611             MOVE SPACES TO DL-DETAIL-LINE                        03270000
011612             MOVE PV-RMS-STR-NBR TO DL-STR-NBR                    03280000
011613             MOVE PV-RMS-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      03290000
011614             MOVE PV-RMS-STR-GP-ID TO DL-STR-GP-ID                03300000
011615             MOVE PV-RMS-STR-EFF-BEG-DTE                          03310000
011616                                    TO DL-STR-EFF-BEG-DTE         03320000
011617             MOVE PV-XMT-STR-EFF-END-DTE                          03330000
011618                                TO DL-XMT-EFF-END-DTE             03340000
011619             MOVE PV-RMS-STR-EFF-END-DTE                          03350000
011620                                TO DL-RMS-EFF-END-DTE             03360000
011627             MOVE PV-MESSAGE TO DL-MESSAGE                        03370000
011630          END-IF                                                  03380000
011700       END-IF.                                                    03390000
011710                                                                  03400000
011800       IF PV-LINE-CNT > PV-MAX-LINES                              03410000
011810          PERFORM 8100-WRITE-STD-RPT-HEADING                      03420000
011820          PERFORM 8200-WRITE-REPORT-HEADING                       03430000
011830          PERFORM 8300-WRITE-COLUMN-HEADING                       03440000
011840       END-IF.                                                    03450000
011850                                                                  03460000
011900       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     03470000
012000             AFTER ADVANCING 1 LINE.                              03480000
012100       ADD +1 TO PV-LINE-CNT.                                     03490000
012200                                                                  03500000
012210       MOVE 4095 TO RETURN-CODE.                                  03510000
012300       ADD 1 TO PA-ERROR-MESSAGES.                                03520000
012400                                                                  03530000
012500 8100-WRITE-STD-RPT-HEADING.                                      03540000
012600                                                                  03550000
012610       INITIALIZE PV-LINE-CNT.                                    03560000
012700       ADD 1  TO PV-PAGE-CNT.                                     03570000
012800       MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                    03580007
012900       WRITE ERR-RPT-LINE FROM DP200O-STANDRD-HEADER-200-COLS     03590008
013000             AFTER ADVANCING PAGE.                                03600000
013110       ADD +1 TO PV-LINE-CNT.                                     03610000
013200                                                                  03620000
013300 8200-WRITE-REPORT-HEADING.                                       03630000
013400                                                                  03640000
013500       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 03650000
013600            AFTER ADVANCING 1 LINES.                              03660000
013700       ADD +1 TO PV-LINE-CNT.                                     03670000
013800                                                                  03680000
013900 8300-WRITE-COLUMN-HEADING.                                       03690000
013910                                                                  03700000
013920       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  03710000
013930            AFTER ADVANCING 2 LINES.                              03720000
013940       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  03730000
013950            AFTER ADVANCING 1 LINES.                              03740000
013960       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  03750000
013970            AFTER ADVANCING 1 LINES.                              03760000
013971       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  03770000
013972            AFTER ADVANCING 1 LINES.                              03780000
013980       ADD +5 TO PV-LINE-CNT.                                     03790000
014000                                                                  03800000
014100 8400-WRITE-TOTALS.                                               03810000
014101                                                                  03820000
014102       IF PV-LINE-CNT > PV-MAX-LINES                              03830000
014103          PERFORM 8100-WRITE-STD-RPT-HEADING                      03840000
014104          PERFORM 8200-WRITE-REPORT-HEADING                       03850000
014105          PERFORM 8300-WRITE-COLUMN-HEADING                       03860000
014106       END-IF.                                                    03870000
014107                                                                  03880000
014110      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    03890000
014200      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      03900000
014210            AFTER ADVANCING 2 LINES.                              03910000
014211      ADD +2 TO PV-LINE-CNT.                                      03920000
014212                                                                  03930000
014220      IF PV-LINE-CNT > PV-MAX-LINES                               03940000
014230         PERFORM 8100-WRITE-STD-RPT-HEADING                       03950000
014240         PERFORM 8200-WRITE-REPORT-HEADING                        03960000
014250         PERFORM 8300-WRITE-COLUMN-HEADING                        03970000
014260      END-IF.                                                     03980000
014300      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              03990000
014400            AFTER ADVANCING 1 LINES.                              04000000
014500                                                                  04010000
