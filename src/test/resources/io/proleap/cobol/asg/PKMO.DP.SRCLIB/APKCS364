000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKCS364.                                         00020000
000300 AUTHOR.        MARK BURNSIDE.                                    00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  09-21-98.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*    A364 - ADD, UPDATE, DELETE ADJUSTMENT                       *00080000
000900*                                                                *00090000
001000*    THIS PROGRAM ALLOWS THE USER TO ADD, UPDATE, OR DELETE      *00100000
001100*    HEADER ADJUSTMENT DATA, AS WELL AS ACCESS DISTRIBUTION      *00110000
001200*    ADJUSTMENT DATA.                                            *00120000
001300*    VENDOR NUMBER IS REQUIRED FOR ADDING FROM THE               *00130000
001400*    CRITERIA SPECIFICATION OR ADJUSTMENT LIST PROGRAM.          *00140000
001500******************************************************************00150000
001600*                                                                *00160000
001700* CHANGE LOG:                                                    *00170000
001800******************************************************************00180000
001900* DATE  10/20/99                                                 *00190000
002000*    CHANGE MADE: INSERTED CALL TO APKUP151 TO GET NEXT AVAILABLE*00200000
002100*    DOCUMENT NUMBER.  APKUP151 IS EXCLUSIVELY FOR ON-LINE       *00210000
002200*    APPLICATIONS.  PREVIOUS MODULE FOR NEXT AVAILABLE DOCUMENT  *00220000
002300*    NUMBER WAS DPKUP151 WHICH IS NOW EXCLUSIVELY FOR BATCH      *00230000
002400*    APPLICATIONS.                                               *00240000
002500*    MADE BY: MARK BURNSIDE           WR/IR #: 5998              *00250000
002600*                                                                *00260000
002700* DATE  11/02/99                                                 *00270000
002800*    CHANGE MADE: IN 3080- PARAGRAPH TO EDIT THE GROSS COST      *00280000
002900*    FIELD UNCOMMENTED THE INITIALIZE OF THE GROSS COST.  USERS  *00290000
003000*    WERE HAVING PROBLEMS IN UPDATE MODE WHEN THEY ATTEMPTED TO  *00300000
003100*    FIELD DELETE THE GROSS COST AND ENTER THE AMOUNT AS FREIGHT.*00310000
003200*    THE NEXT COST WOULD STILL INCLUDE THE GROSS COST EVEN       *00320000
003300*    THOUGH IT NO LONGER APPEARED ON THE SCREEN.                 *00330000
003400*    MADE BY: MARK BURNSIDE           WR/IR #: 5998              *00340000
003500*                                                                *00350000
003600* DATE  12/07/99                                                 *00360000
003700*    CHANGES MADE:                                               *00370000
003800*    1.  INSERTED WARNING MESSAGE IN CASE THAT VENDOR IS         *00380000
003900*        INACTIVE IN DB2.                                        *00390000
004000*    2.  WHEN IN UPDATE MODE THE CURRENT OR PREVIOUS POSTING     *00400000
004100*        PERIOD WILL NOT DEFAULT TO THE CURRENT PERIOD.          *00410000
004200*    MADE BY: MARK BURNSIDE           WR/IR #: 5998              *00420000
004300*                                                                *00430000
004400* DATE  01/26/00                                                 *00440000
004500*    CHANGE MADE: ADDED A NEW EDIT THAT CALCULATES THE MARKON    *00450000
004600*    PERCENTAGE FOR ANY TRANSACTION THAT HAS A GROSS COST AND    *00460000
004700*    RETAIL AMOUNT.  IF IT IS 85% OR GREATER OR 15% OR LESS, THEN*00470000
004800*    A WARNING MESSAGE COMES.  THE USER CAN THEN ADJUST ONE OF   *00480000
004900*    THE AMOUNTS OR CONTINUE WITH THE ADD/UPDATE.  REACTIVATED   *00490000
005000*    THE WARNING MESSAGE FOR THE GROSS COST BEING GREATER THAN   *00500000
005100*    THE RETAIL AMOUNT, ALSO.  OPENED UP THE CHECK FOR THIS CON- *00510000
005200*    DITION FOR ANY ADJUSTMENT REGARDLESS OF THE TRAN CODE.  THIS*00520000
005300*    WOULD ONLY HAPPEN IF BOTH AMOUNTS ARE NOT EQUAL TO ZERO.    *00530000
005400*    PARAS 3315-, 3385-                                          *00540000
005500*    MADE BY: MIKE BESKE              WR/IR #: 20758             *00550000
005600*                                                                *00560000
005700* DATE  02/23/00                                                 *00570000
005800*    CHANGE MADE: ADDED A NEW EDIT THAT TRIGGERS AN ERROR WHEN   *00580000
005900*    TRYING TO KEY A HEADQUARTER STORE ON A MERCHANDISE          *00590000
006000*    TRANSACTION.                                                *00600000
006100*    MADE BY: ROBIN BERNOSKI          WR/IR #: 20704             *00610000
006200*                                                                *00620000
006300* DATE  02/25/00                                                 *00630000
006400*    CHANGE MADE: MODIFIED PARAGRAPH 4900-VALIDATE-DEPARTMENT    *00640000
006500*    BY CHANGING THE TABLE TO CHECK THE DEPARTMENT AGAINST.      *00650000
006600*    MADE BY: ROBIN BERNOSKI          WR/IR #: 20704             *00660000
006700*                                                                *00670000
006800* DATE  04/11/00                                                 *00680000
006900*    CHANGE MADE: ADDED A NEW PO TYPE CODE (IE) IN PARA 3020- AND*00690000
007000*    3040.-.  THIS IS A NEW IMPORT PO TYPE CODE THAT IS PART OF  *00700000
007100*    OF THE PO TEAMS PROJECT THAT IS ADDING 4 NEW PO TYPE CODES  *00710000
007200*    TO TPURCHS.                                                 *00720000
007300*    MADE BY: MIKE BESKE              WR/IR #: 20997             *00730000
007400*                                                                *00740000
007500* DATE  04/13/00                                                 *00750000
007600*    CHANGE MADE: ADDED A NEW PO TYPE CODE (IF) IN PARA 3020- AND*00760000
007700*    3040.-.                                                     *00770000
007800*    MADE BY: MIKE BESKE              WR/IR #: 20997             *00780000
007900*                                                                *00790000
008000* DATE  05/05/00                                                 *00800000
008100*    CHANGE MADE: ADDED CODE TO CHECK FOR THE CONDITION FOR ANY  *00810000
008200*    TRANSACTION THAT HAS A RETAIL AMOUNT ENTERED, A FREIGHT AMT *00820000
008300*    OR MISC CHARGE ENTERED AND NO GROSS COST ENTERED.  THIS WILL*00830000
008400*    NOW BE CONSIDERED AN ERROR CONDITION AND AN ERROR MESSAGE   *00840000
008500*    WILL BE DISPLAYED TO NOT ALLOW THE USER TO ADD THIS ADJUST- *00850000
008600*    MENT.                                                       *00860000
008700*    MADE BY: MIKE BESKE              WR/IR #: 20704             *00870000
008800*                                                                *00880000
008900* DATE  08/24/00                                                 *00890000
009000*    CHANGE MADE: ADDED CODE TO DISPLAY 2 NEW COLS FROM TADJRNL  *00900000
009100*    - MOS_DISC_PCT AND MOS_DISC_AMT.  MOS_DISC_PCT CAN BE       *00910000
009200*    CHANGED VIA THE ONLINE BUT MOS_DISC_AMT IS CALCULATED BASED *00920000
009300*    ON THE PERCENTAGE THAT IS ENTERED.                          *00930000
009400*    MADE BY: MIKE BESKE              WR/IR #: 20704             *00940000
009500*                                                                *00950000
009600* DATE  12/12/2000                                               *00960000
009700*    CHANGE MADE: CHANGED THE LENGTH OF DK-VEND-NUMBER-LOW       *00970000
009800*    AND DK-VEND-NUMBER-HIGH FROM TEN CHARACTERS TO NINE         *00980000
009900*    CHARACTERS TO IMPROVE THE EFFICIENCY OF SQL CALLS TO THE    *00990000
010000*    ADJUSTMENT JOURNAL DB2 TABLES.                              *01000000
010100*    MADE BY: MARK BURNSIDE           WR/IR #: 21699             *01010000
010200*                                                                *01020000
010300* DATE  01/24/2002                                               *01030000
010400*    CHANGE MADE: ADDED TWO MORE BYTES TO THE END OF THE         *01040000
010500*    DISCOUNT STORAGE FIELDS, SO THAT THE PERCENTAGE WILL NOT    *01050000
010600*    BE TRUNCATED AND STORED ON THE TADJRNL TABLE INCORRECTLY.   *01060000
010700*    MODIFIED PARAGRAPHS 4200 AND 5010, SO ON UPDATES THE        *01070000
010800*    DATABASE FIELDS WILL BE MOVED FOR PS_PSTG_IND, PS_BTCH_NBR, *01080000
010900*    ORGN_CDE, DOC_EXTR_IND, AND DOC_EXTR_DTE INSTEAD OF HARD    *01090000
011000*    CODING.  THIS IS TO CORRECT THE PROBLEM OF THE PS_PSTG_IND  *01100000
011100*    SET TO 'Y' ON AN UPDATE, EVEN THOUGH IT IS 'N' AND HADN'T   *01110000
011200*    POSTED YET.                                                 *01120000
011300*    MADE BY: KEVIN CATLIN            WR/IR #:  PM00444221       *01130000
011400*                                                                *01140000
011500* DATE  04/02/2002                                               *01150000
011600*    CHANGE MADE: ADDED CODE TO CHECK FOR THE A REQUIRED GL      *01160000
011700*    ACCOUNT NUMBER FOR THE ENTERED TRANSACTION CODE ON TTRNCDE. *01170000
011800*    THIS IS ONLY FOR EXPENSE TRAN CODES.  IF A GL ACCOUNT NUMBER*01180000
011900*    IS FOUND AND IT DOES NOT MATCH THE ENTERED ACCOUNT NUMBER   *01190000
012000*    THEN AN ERROR MESSAGE IS GENERATED.  (PARAS: 4950- 4951)    *01200000
012100*    MADE BY: MIKE BESKE              WR/IR #:  WR22902          *01210000
012200*                                                                *01220000
012300* DATE  05/16/2002                                               *01230000
012400*    CHANGE MADE:  NI-SKU CHANGES.  THE 3 BYTE SKU-SEQ FIELD IS  *01240000
012500*    REPLACED WITH A NUMERIC 8 BYTE SKU FIELD.  CHANGES MADE TO  *01250000
012600*    WORKING STORAGE FIELDS AND TO PARAGRAPHS 2200, 3200, 3360,  *01260000
012700*    3380, 3390, 4018, 4200, 4400, 4900, 5010, AND 7800.         *01270000
012800*    MADE BY: KEVIN CATLIN                    WR/IR #: 21278     *01280000
012900*                                                                *01290000
013000*   02/10/2003                                                   *01300000
013100*      CHANGED CALL TO PEOPLESOFT TABLE TO USE NEW ALIAS         *01310000
013200*      NAMING STANDARD.                                          *01320000
013300*   MADE BY: L SCHALLHORN                 WR#: 23417             *01330000
013400*                                                                *01340000
013500*   05/05/2003                                                   *01350000
013600*      CHANGED THE WHERE CONDITION (IN 7800-VALIDATE-SKU) ON     *01360000
013700*      TSKXREF TO USE DEPT & CLASS INSTEAD OF DEPT_NBR & CL_NBR. *01370000
013800*      ADDED REDEFINES FOR THE ASC- FIELDS FOR CLASS AND DEPT FOR*01380000
013900*      NUMERIC DEFNS.  ADDED NEW W/S FIELDS DEFINED AS PACKED    *01390000
014000*      DECIMAL TO MATCH DEPT & CLASS AS HOST VARIABLES. THESE    *01400000
014100*      ARE USED IN THE 3360- PARAGRAPH.                          *01410000
014200*      5/28/03 CHANGED PARAS 3360- AND 7800- TO TAKE THE         *01420000
014300*      CLASS SCREEN INPUT VALUE AND USE THIS TO VALIDATE         *01430000
014400*      AGAINST SUBCLASS ON TSKXREF. THIS ALLOWS THE USER TO ENTER*01440000
014500*      THE SUBCLASS VALUE SO THAT IT IS RETAINED ON THE TADJDIS  *01450000
014600*      TABLE FOR INVENTORY CONTROL AS IS DONE PRIOR TO NI-SKU    *01460000
014700*      INSTALL.                                                  *01470000
014800*   MADE BY: MIKE BESKE                   WR#: 22557             *01480000
014900*                                                                *01490000
015000*   04/27/2004                                                   *01500000
015100*      CHANGED LOGIC VALIDATING CLASS TO NOT REQUIRE CLASS FOR   *01510000
015200*      VENDOR AGREEMENTS TRANCODES (BATCH SOURCE = VAA OR VDA)   *01520000
015300*   MADE BY: NANCY EILBES                 WR#: 26677             *01530000
015400*                                                                *01540000
015500*   05/04/2004                                                   *01550000
015600*      REPLACED TSTR000 WITH XFT00003. INCREASED THE SIZE OF     *01560000
015700*      PV-STORE-NBR-3 FROM S9(03) TO S9(04) AND RENAMED IT TO    *01570000
015800*      PV-STORE-NBR-4.  MODIFIED PARA 3040-EDIT-STORE & 3180-EDIT*01580000
015900*      -DISTRO-STORE TO USE XFT00003 FIELDS.  RECODED PARA       *01590000
016000*      7400-VALIDATE-STORE TO USE XFT00003 IN PLACE OF TSTR000.  *01600000
016100*   MADE BY: MIKE BESKE                   WR#: 25805             *01610000
016200*                                                                *01620000
016300*   08/06/2004                                                   *01630000
016400*      CHANGED LOGIC VALIDATING CLASS TO REPLACE CLASS FOR       *01640000
016500*      VENDOR AGREEMENTS TRANCODES (BATCH SOURCE = VAA OR VDA OR *01650000
016600*      TRANCODE = '56', '57') WITH THE MINIMUM VALID MAJOR CLASS *01660000
016700*      FOR THE DEPT KEYED.  REPLACEMENT TAKES PLACE WHETHER OR   *01670000
016800*      NOT A CLASS WAS KEYED, AS LONG AS A VALID CLASS IS FOUND. *01680000
016900*   MADE BY: NANCY EILBES                 WR#: 26677             *01690000
017000*                                                                *01700000
017100* DATE  09/20/2004                                               *01710000
017200*     CHANGE MADE: ADDED 'CURRENT DATE <= FINCL_CLO_DTE' TO      *01720000
017300*     SELECT STATEMENT THAT IS VALIDATING STORE NUMBER.          *01730000
017400*     PARAGRAPH 7400-VALIDATE-STORE WAS MODIFIED.                *01740000
017500*     MADE BY: KEVIN CATLIN            WR/IR #: P000693987       *01750000
017600*                                                                *01760000
017700* DATE  01/05/2005                                               *01770000
017800*     CHANGE MADE: ADDED LOGIC THROUGHOUT PROGRAM TO ALLOW ENTRY *01780000
017900*     OF A DISCOUNT-ONLY TRANSACTION.  THIS IS REQUIRED FOR THE  *01790000
018000*     ABILITY TO KEY A PAYBACK FOR A SYSTEM-GENERATED NEW STORE  *01800000
018100*     DISCOUNT TRANSACTION. DISTRIB AMOUNT ON A NSD ADJUSTMENT   *01810000
018200*     WILL BE KEYED IN THE COST FIELD AND THE PROGRAM WILL MAKE  *01820000
018300*     SURE IT GOES TO THE CORRECT DATABASE FIELD.  SIGN CHECKING *01830000
018400*     WILL BE HANDLED SPECIALLY FOR THESE TRANS AS IT IS THE     *01840000
018500*     OPPOSITE OF WHAT WOULD NORMALLY BE USED ON THE TRAN TYPE.  *01850000
018600*       ALSO ADDED LOGIC IN PARAGRAPH 3015-EDIT-TRAN-CD          *01860000
018700*     TO ENSURE THAT A BROADCAST OR BRIDAL VENDOR AGREEMENT      *01870000
018800*     EXISTS WHEN ONE OF THESE TRANCODES IS ENTERED.  ADDED DB2  *01880000
018900*     TABLE TVNDAGR TO VALIDATE AGREEMENTS AGAINST AND ADDED     *01890000
019000*     PARAGRAPHS 4750, 4770 AND 4775 TO PERFORM THE SQL.         *01900000
019100*     NOTE THAT THIS LOGIC WAS INTENTIONALLY OMITTED FROM        *01910000
019200*     4001-ADD-PENDING-LOGIC BECAUSE DEPT NUMBER IS NOT A KEY    *01920000
019300*     FIELD ON THE SELECTION CRITERIA SCREEN, NOR IS IT RETAINED *01930000
019400*     WHEN THE SCREEN IS REFRESHED AFTER AN ADD, SO IT WAS NOT   *01940000
019500*     AVAILABLE TO PERFORM THESE EDITS.                          *01950000
019600*     MADE BY: NANCY EILBES            WR/IR #: WR26679          *01960000
019700*                                                                *01970000
019800*   05/02/2005                                                   *01980000
019900*      REMOVED LOGIC DEFAULTING CLASS FOR BROADCAST TRANSACTIONS.*01990000
020000*      SUBCLASS WILL NOW BE KEYED.                               *02000000
020100*   MADE BY: NANCY EILBES                 WR#: WR28143           *02010000
020200*                                                                *02020000
020300*   06/21/2005                                                   *02030000
020400*      LOGIC HANDLING THE NEW STORE DISCOUNT ONLY TRANSACTION    *02040000
020500*      WAS LOOKING FOR THE WRONG SIGN. THE TRANCODE WAS ACTUALLY *02050000
020600*      CREATED WITH THE SIGN THAT MATCHES THE DISCOUNT AMOUNT,   *02060000
020700*      BUT THE LOGIC WAS ASSUMING THE TRANCODE WAS SET UP WITH   *02070000
020800*      THE SIGN MATCHING THE RESULTING NET COST AMOUNT.          *02080000
020900*   MADE BY: NANCY EILBES                 WR#: P000773596        *02090000
021000*                                                                *02100000
021100*   DATE  09/07/2005                                             *02110000
021200*       CHANGE MADE: PRODUCT LICENSE FEES                        *02120000
021300*       MODIFIED THE EXISTING ADJUSTMENT ENTRY SCREEN TO AUTO-   *02130000
021400*       MATICALLY GENERATE THE OFFSETTING TRANSACTION WHEN THE   *02140000
021500*       CONTROLS ON THE TTRNCDE TABLE INDICATE THAT ONE SHOULD BE*02150000
021600*       CREATED.  THIS ELIMINATES AP USERS FROM CREATING MANUAL  *02160000
021700*       ADJUSTMENTS TO BOTH A GENRL LEDGER AND THE BUYER'S STOCK *02170000
021800*       LEDGER BASED ON THE NEGOTIATED AGREEMENT.  THE OFFSET    *02180000
021900*       ADJUSTMENT WILL BE AN EXP ADJUSTMENT WITH 1 DISTRIB LINE *02190000
022000*       AND THE SAME OFFSET TRANCODE WILL ALWAYS BE USED FOR A   *02200000
022100*       SINGLE ORIGINATING TRANCODE.  THE USER WILL BE ABLE TO   *02210000
022200*       OVERRIDE THE AUTOMATIC OFFSET, STOPPING THE OFFSET ADJUST*02220000
022300*       MENT FROM BEING CREATED.  THE USER WILL BE ALLOWED TO    *02230000
022400*       ENTER A GL ACCOUNT IF THE OFFSETING TRANCODE IS NOT SET  *02240000
022500*       UP WITH A STATIC GL ACCOUNT ON TTRNCDE.  ONCE AN OFFSET  *02250000
022600*       ADJUSTMENT HAS BEEN ADDED, IT CANNOT BE DIRECTLY UPDATED *02260000
022700*       OR DELETED VIA THE ONLINE.  IT CAN ONLY BE UPDATED OR    *02270000
022800*       DELETED FROM THE ORIGINATING ADJUSTMENT.  THE OFFSET     *02280000
022900*       ADJUSTMENTS AMOUNTS WILL MIRROR THOSE ON THE HEADER OF   *02290000
023000*       ORIGINAL ADJUSTMENT WITH THE PROPER SIGN BASED ON THE    *02300000
023100*       POSTING TYPE OF THE OFFSET TRANSACTION.  THE OFFSET DOC  *02310000
023200*       NBR WILL BE BASED ON THE ORIGINATING ADJUSTMENT DOC NBR  *02320000
023300*       WITH 'OFF' ATTACHED TO THE END, WITH THE LENGTH BEING NO *02330000
023400*       LONGER THAN 16 CHARS.  THREE NEW FIELDS WERE ADDED TO THE*02340000
023500*       MAP THAT IS SUPPORTED BY THIS PROGRAM: OFFSET TRANCODE,  *02350000
023600*       OFFSET ACCOUNT NBR AND OFFSET BYPASS IND. THE OFFSET     *02360000
023700*       TRANCODE IS DISPLAY ONLY WHILE THE OTHER 2 ARE ENTERABLE *02370000
023800*       FIELDS.                                                  *02380000
023900*       NEW PARAS: 3041-, 3042-, 3043-, 3044-, 3045-, 3046-      *02390000
024000*                  4011-, 4012-, 4850-, 4860-, 5301-             *02400000
024100*       MOD PARAS: 2000-, 3000-, 4010-, 4020-, 2200-,            *02410000
024200*                  3200-, 4005-, 4200-, 4400-, 5010-             *02420000
024300*       MADE BY: MIKE BESKE              WR/IR #: WR28882        *02430000
024400*                                                                *02440000
024500*   DATE  05/30/2006                                             *02450000
024600*       CHANGE MADE: BROADCAST MERCHANDISE ADJUSTMENT OFF INVOICE*02460000
024700*       ADDED CODE IN 3040-EDIT-STORE THAT WILL GIVE AN ERROR    *02470000
024800*       MESSAGE FOR ANY EXPENSE ADJUSTMENT THAT IS CREATED WITHOUT02480000
024900*       USING THE CORPORATE STORE NUMBER 90.  THIS ERROR CHECK   *02490000
025000*       SUPERCEDES THE OLD ERROR CHECK THAT MADE SURE ALL IMPORT *02500000
025100*       EXPENSE ADJUSTMENTS USED STORE 90.  ADDED ADDITIONAL CODE*02510000
025200*       TO PARAS 4750- AND 4770- THAT CHECK FOR VENDOR AGRMT_TYP_*02520000
025300*       ID = 5 AND TYP_CDE = 9 ALONG WITH THE PRESENT CHECK FOR  *02530000
025400*       AGRMT = 6 & TYP_CDE = 6 & AP_TRN_CDE = 88 IN THE SQL     *02540000
025500*       STAEMENT.  ADDED A NEW ASC- FIELD TO                     *02550000
025600*       CARRY OVER THE OFFSET TRAN CODE POSTING TYPE CODE VALUE  *02560000
025700*       TO APKCS365 VIA THE APWS363 COPYBOOK.  ADDED CODE IN     *02570000
025800*       PARA 3042- TO SELECT THE OFFSET TRAN CODE POSTING TYPE   *02580000
025900*       CODE.                                                    *02590000
026000*       MADE BY: MIKE BESKE              WR/IR #: WR28882        *02600000
026100*                                                                *02610000
026200*   DATE  07/31/2006                                             *02620000
026300*       CHANGE MADE: INVENTORY CUTOFF DATE UPDATES               *02630000
026400*       ADDED CODE TO DISPLAY THE INVENTORY CUTTOFF DATE ONLY IN *02640000
026500*       DELETE AND UPDATE MODES.  IT WILL NOT DISPLAY IN ADD MODE*02650000
026600*       THE DATE CAN ONLY BE ADDED IN APKCS365.  THE DATE CANNOT *02660000
026700*       BE GREATER THAN THE CURRENT DATE.                        *02670000
026800*       NEW PARAS: 3100-                                         *02680000
026900*       MOD PARAS: 2200-, 3000-, 3044-, 3200-, 4400-             *02690000
027000*       MADE BY: MIKE BESKE              WR/IR #: WR30990        *02700000
027100*                                                                *02710000
027200*   DATE  09/05/2006                                             *02720000
027300*       CHANGE MADE: CORRECTED PRODUCTION PROBLEM WHERE THE      *02730000
027400*       OFFSET ADJUSTMENT IS LOSING ITS PROPER SIGN FOR THE      *02740000
027500*       AMOUNT FIELDS WHEN THE ORIGINATING ADJUSTMENT IS UPDATED.*02750000
027600*       ADDED PSTG_TYP_CDE TO THE SQL STMT TO ACCOMPLISH THIS FIX.02760000
027700*       MOD PARA: 4860-                                          *02770000
027800*       MADE BY: MIKE BESKE              WR/IR #: P000921211     *02780000
027900*                                                                *02790000
028000*   DATE  09/07/2006                                             *02800000
028100*       CHANGE MADE: MODIFIED CODE TO ALLOW THE COMMENTS FROM THE*02810000
028200*       ORIGINATING ADJUSTMENT TO CARRY OVER TO THE OFFSET       *02820000
028300*       ADJUSTMENT.  AS A RESULT OF THIS MODIFICATION, THE CODE  *02830000
028400*       THAT USE TO LOOK FOR A HARDCODED COMMENT IN COMMENT      *02840000
028500*       LINE 1 TO SEE IF THE ADJUSTMENT BEING PROCESSED WAS AN   *02850000
028600*       OFFSETTING ONE, WAS REMOVED.  NEW CODE WAS ADDED         *02860000
028700*       TO REPLACE THIS REMOVED CODE.  NOW IF THE ADJUSTMENT     *02870000
028800*       BEING PROCESSED IS AN OFFSET, THAT WAS CREATED AUTOMATIC-*02880000
028900*       ALLY, 3 CHECKS MUST BE PASSED.  THE 1ST                  *02890000
029000*       CHECK IS CHECKING IF THE TRANCODE BRING PROCESSED IS AN  *02900000
029100*       OFFSET FOR A MERCHANDISE TRANCODE THAT IS ENTERED VIA THE*02910000
029200*       ADJUSTMENT ONLINE SCREEN.  THE 2ND CHECK IS CHECKING IF  *02920000
029300*       'OFF' IS APENDED ONTO THE END OF THE DOC NUMBER BEING    *02930000
029400*       PROCESSED.  THE 3RD CHECK IS CHECKING FOR AN ORIGINATING *02940000
029500*       ADJUSTMENT ALREADY ON THE DATABASE FOR THE 'OFFSET'      *02950000
029600*       ADJUSTMENT BEING PROCESSED.  IF THE ADJUSTMENT PASSES ALL*02960000
029700*       3 CHECKS, THEN IT IS ASSUMED TO BE AN OFFSET AND IT IS   *02970000
029800*       BLOCKED FROM BEING UPDATED/DELETED DIRECTLY.  THIS CAN   *02980000
029900*       ONLY BE DONE FROM THE ORIGINATING ADJUSTMENT.            *02990000
030000*       NEW PARAS: 4012B-, 4013-, 4014-                          *03000000
030100*       MOD PARAS: 4005-, 4011-, 4012-                            03010000
030200*       MADE BY: MIKE BESKE              WR/IR #: P000919920     *03020000
030300*                                                                *03030000
030400*   DATE  03/27/2007                                             *03040000
030500*       CHANGE MADE: RECOMPILE FROM PRODUCTION TO INCORPORATE    *03050000
030600*       CHANGES TO PS_XFT_LOC TABLE FOR STORE DEMOGRAPHICS.      *03060000
030700*       MADE BY: KEVIN CATLIN            WR/IR #: WR31452        *03070000
030800*                                                                *03080000
030900*    DATE  07/23/2008                                            *03090000
031000*        CHANGE MADE: MODIFIED LOGIC TO INCLUDE THE OFFSET       *03100000
031100*        GL ACCOUNT NUMBER WHEN UPDATING AN ADJUSTMENT.          *03110000
031200*        THIS IS NOW BEING DONE IN 4870-.                        *03120000
031300*        MADE BY: MICHELE RINDFLEISCH   WR/IR #: INC000000452644 *03130000
031400*                                                                *03140000
031500*    DATE  07/30/2008                                            *03150000
031600*        CHANGE MADE: RE-CALLED PREVIOUS VERSION OF APKCS364 DUE *03160000
031700*        TO THE TK# BEING OVERLAID AND BEING WRITTEN TO THE      *03170000
031800*        TADJRNL TABLE.                                          *03180000
031900*        MADE BY: ROLF NOHE             WR/IR #: INC000000452644 *03190000
032000*                                                                *03200000
032100*    DATE  07/31/2008                                            *03210000
032200*        CHANGE MADE: THE PROGRAM REMOVED FROM PRODUCTION        *03220000
032300*        WAS RE-TESTED MULTIPLE WAYS AND THE ISSUE NOTED ON      *03230000
032400*        07/30/08 COULD NOT BE RECREATED.  IT WAS DETERMINED THAT*03240000
032500*        THE CHANGES THAT HAD BEEN CREATED DID NOT RESULT IN THE *03250000
032600*        SITUATION OF QUESTION. IT WAS DECIDED TO RE-INSTALL THE *03260000
032700*        MODIFIED VERSION OF THE PROGRAM AGAIN. IF THIS CONTINUES*03270000
032800*        TO OCCUR IT WILL THEN BE RE-EVALULATED.                 *03280000
032900*        MADE BY: MICHELE RINDFLEISCH   WR/IR #: INC000000452644 *03290000
033000*                                                                *03300000
033100*    DATE  11/13/2008                                            *03310000
033200*        CHANGE MADE: MODIFIED LOGIC THAT WAS CHECKING TO SEE IF *03320000
033300*        THE SELECTED TRANSACTION WAS AN OFFSET, AND THE LOGIC   *03330000
033400*        THAT CHECKED IF THE SELECTED TRANSACTION HAD AN OFFSET. *03340000
033500*        THE METHOD USED BEFORE ASSUMED THAT EACH OFFSET TRANCODE*03350000
033600*        WOULD HAVE ONE AND ONLY ONE ORIGINAL TRANCODE, BUT THIS *03360000
033700*        IS NO LONGER TRUE.  IN 4011-, ADDED LOGIC TO HANDLE -811*03370000
033800*        SQL CODE.  IN 4012-, MODIFIED THE SQL TO GET THE OFFSET *03380000
033900*        TRANCODE FROM THE ORIGINAL TRANCODE IF ONE EXISTED. IN  *03390000
034000*        4012B-  CHANGED THE SQL TO USE VND-NBR AND DOC-NBR FROM *03400000
034100*        SELECTED TRANSACTION.  IN 4014- CHANGED SQL TO USE VND- *03410000
034200*        NBR AND DOC-NBR FROM SELECTED TRANSACTION AND NOT TO    *03420000
034300*        SPECIFY THE AP-TRN-CDE, SINCE THE SQL IN 4011- COULD    *03430000
034400*        HAVE GOTTEN A -811, SO WE WON'T BE SURE THE TRANCODE IS *03440000
034500*        A MATCH.                                                *03450000
034600*        MADE BY: NANCY EILBES          WR/IR #: INC000000594343 *03460000
034700*    DATE  01/26/2010                                            *03470000
034800*        CHANGE MADE: DELETED THE INVENTORY CUTOFF DATE FROM THE *03480000
034900*        MAP AND ALL THE CODE USING THOSE FIELDS EXCEPT FOR THE  *03490000
035000*        COMMAREA.                                               *03500000
035100*        MADE BY: BARB SCHULTZ          WR/IR #: WR37487         *03510000
035200*    DATE  09/07/2011                                            *03520000
035300*        CHANGE MADE: REMOVED DB2 CALL TO FI_GL_ACCOUNT_TBL      *03530000
035400*        AND REPLACED WITH A CALL TO THE APKUT274 MODULE.  THIS  *03540000
035500*        IS NEEDED AS A RESULT OF THE PEOPLESOFT FI UPGRADE AND  *03550000
035600*        RE-PLATFORM AS FI_GL_ACCOUNT_TBL IS NOW IN ORACLE.      *03560000
035700*        CALLS TO THE 4950-VALIDATE-ACCOUNT-NO PARAGRAPH ARE     *03570000
035800*        REMOVED AND REPLACED WITH A CALL TO APKUT274.           *03580000
035900*     IT STILL USES DP013-DB2-ABEND SO RELEVANT INFO IS DISPLAYED.03590039
036000*        MADE BY: STEVE KRIEG           WR/IR #: WR37038         *03600027
036100*                                                                *03610055
036200* DATE  03/14/2014                                              * 03620042
036300*     CHANGE MADE: BPO PHASE2 BARCODE CHANGES.                  * 03630042
036400*   BARCODE LABEL HAS BEEN CHANGED TO WI/BARCODE AND CAN ACCEPT * 03640042
036500*   NON-NUMERIC VALUES.                                         * 03650042
036600*     MADE BY: VIKRAM                  WR/IR #: CHG0078414      * 03660045
036700*                                                               * 03670046
036800*    DATE  09/20/2018                                           * 03680047
036900*    CHANGE MADE: MAINFRAME REFACTORING - REMOVED COMMENTED     * 03690047
037000*                 REFERENCES TO CGU042MC AND CGU040MC.          * 03700047
037100*    MADE BY: JIM HUNTER               WR/IR #: CHG0208819      * 03710047
037110*                                                               * 03711050
037111*    DATE  04/05/2019                                           * 03711156
037112*    CHANGE MADE: REMOVED CALL TO PROGRAM APKUT274 TO VALIDATE  * 03711256
037113*    ACCOUNT NUMBER.  REPLACED WITH A LOOKUP ON NEW DB2 TABLE   * 03711356
037114*    APT_ACCT_TBL.  ERP PROJECT.                                * 03711456
037115*    MADE BY: COGNIZANT               WR/IR #: CHG0221352       * 03711556
037116* DATE  09/01/2021                                                03711659
037117*            - CHANGE CALL OF  DPKUT100  TO                     * 03711759
037118*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 03711859
037119*              MAKING THE CALL DYNAMIC VS STATIC                * 03711959
037120*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        03712060
037121* DATE  03/16/2022                                                03712172
037122*            - DO NOT ALLOW LEADING ZEROES ON DOC NBR           * 03712261
037125*     MADE BY: JEAN KURK               WR/IR #: CHG0267713        03712561
037130*                                                                *03713059
037140* DATE  09/07/2022                                                03714071
037150*            - MAKE THE BARCODE FIELD OPTIONAL. THE ONLY EDIT    *03715071
037151*              LEFT IN PARA 3030 IS TO VERIFY THAT IT IS         *03715171
037152*              POPULATED, SO THE WHOLE PARAGRAPH HAS BEEN REMOVED*03715271
037160*     MADE BY: JEAN KURK               WR/IR #: CHG0273822        03716071
037170*                                                                *03717071
037180* DATE  10/24/2022                                               *03718072
037190*     CHANGE MADE: ADD COPYBOOK DPWS930                          *03719072
037191*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API   *03719172
037192*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864       *03719272
037170*                                                                *03719374
037180* DATE  11/30/2023                                               *03719474
037190*     CHANGE MADE: REMOVE CHECK OF MDS TRAN TYPE FOR AUTO        *03719574
037191*                  OFFSET TRANS (PARAGRAPH 3041-)                *03719674
037192*     MADE BY: JEAN KURK               WR/IR #: CHG0276864       *03719774
037200******************************************************************03720047
037300                                                                  03730000
037400 ENVIRONMENT DIVISION.                                            03740000
037500                                                                  03750000
037600 DATA DIVISION.                                                   03760000
037700                                                                  03770000
037800 WORKING-STORAGE SECTION.                                         03780000
037900                                                                  03790000
038000 01  DK-DB2-KEYS.                                                 03800000
038100     05  DK-DOCUMENT-NO-LOW             PIC  X(16)  VALUE         03810000
038200                                                      LOW-VALUES. 03820000
038300     05  DK-DOCUMENT-NO-HIGH            PIC  X(16)  VALUE         03830000
038400                                                      HIGH-VALUES.03840000
038500     05  DK-TRAN-CODE-LOW               PIC  X(02)  VALUE         03850000
038600                                                      LOW-VALUES. 03860000
038700     05  DK-TRAN-CODE-HIGH              PIC  X(02)  VALUE         03870000
038800                                                      HIGH-VALUES.03880000
038900     05  DK-VEND-NUMBER-LOW             PIC  X(09)  VALUE         03890000
039000                                                      LOW-VALUES. 03900000
039100     05  DK-VEND-NUMBER-HIGH            PIC  X(09)  VALUE         03910000
039200                                                      HIGH-VALUES.03920000
039300     05  DK-PO-NBR-LOW                  PIC  S9(09) VALUE +0      03930000
039400                                                    COMP.         03940000
039500     05  DK-PO-NBR-HIGH                 PIC  S9(09) VALUE +0      03950000
039600                                                    COMP.         03960000
039700     05  DK-DOC-DATE-LOW                PIC   X(10) VALUE         03970000
039800                                                     '0001-01-01'.03980000
039900     05  DK-DOC-DATE-HIGH               PIC   X(10) VALUE         03990000
040000                                                     '9999-01-01'.04000000
040100*                                                                 04010000
040200 01  PC-PROGRAM-CONSTANTS.                                        04020000
040300     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'AP364A  '.  04030000
040400     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'APKM364 '.  04040000
040500     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'APKCS364'.  04050000
040600     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           04060000
040700                                              COMP.               04070000
040800     05  PC-SEL-QUEUE-ITEM        PIC S9(04)  VALUE  +1           04080000
040900                                              COMP SYNC.          04090000
041000     05  PC-SEL-QUEUE-SEQ         PIC  9(01)  VALUE 3.            04100000
041100     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE  +3           04110000
041200                                              COMP.               04120000
041300     05  PC-APKUP151-PGM          PIC  X(08)  VALUE 'APKUP151'.   04130000
041500     05  PC-OFFSET-BYPASS-IND-DFT PIC  X(01)  VALUE 'N'.          04150000
041600     05  PC-TSYMSG-NUMBERS.                                       04160000
041700         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       04170000
041800         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       04180000
041900         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       04190000
042000         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       04200000
042100         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       04210000
042200         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       04220000
042300         10  PC-TSYMSG-00118      PIC  9(05)  VALUE  00118.       04230000
042400         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       04240000
042500         10  PC-TSYMSG-00316      PIC  9(05)  VALUE  00316.       04250000
042600         10  PC-TSYMSG-00354      PIC  9(05)  VALUE  00354.       04260000
042700         10  PC-TSYMSG-00671      PIC  9(05)  VALUE  00671.       04270000
042800         10  PC-TSYMSG-01095      PIC  9(05)  VALUE  01095.       04280000
042900         10  PC-TSYMSG-01899      PIC  9(05)  VALUE  01899.       04290000
043000         10  PC-TSYMSG-01900      PIC  9(05)  VALUE  01900.       04300000
043100         10  PC-TSYMSG-01901      PIC  9(05)  VALUE  01901.       04310000
043200         10  PC-TSYMSG-01902      PIC  9(05)  VALUE  01902.       04320000
043300         10  PC-TSYMSG-01903      PIC  9(05)  VALUE  01903.       04330000
043400         10  PC-TSYMSG-01904      PIC  9(05)  VALUE  01904.       04340000
043500         10  PC-TSYMSG-01905      PIC  9(05)  VALUE  01905.       04350000
043600         10  PC-TSYMSG-01906      PIC  9(05)  VALUE  01906.       04360000
043700         10  PC-TSYMSG-01907      PIC  9(05)  VALUE  01907.       04370000
043800         10  PC-TSYMSG-01908      PIC  9(05)  VALUE  01908.       04380000
043900         10  PC-TSYMSG-01909      PIC  9(05)  VALUE  01909.       04390000
044000         10  PC-TSYMSG-01910      PIC  9(05)  VALUE  01910.       04400000
044100         10  PC-TSYMSG-01911      PIC  9(05)  VALUE  01911.       04410000
044200         10  PC-TSYMSG-01912      PIC  9(05)  VALUE  01912.       04420000
044300         10  PC-TSYMSG-01914      PIC  9(05)  VALUE  01914.       04430000
044400         10  PC-TSYMSG-01915      PIC  9(05)  VALUE  01915.       04440000
044500         10  PC-TSYMSG-01916      PIC  9(05)  VALUE  01916.       04450000
044600         10  PC-TSYMSG-01917      PIC  9(05)  VALUE  01917.       04460000
044700         10  PC-TSYMSG-01918      PIC  9(05)  VALUE  01918.       04470000
044800         10  PC-TSYMSG-01919      PIC  9(05)  VALUE  01919.       04480000
044900         10  PC-TSYMSG-01920      PIC  9(05)  VALUE  01920.       04490000
045000         10  PC-TSYMSG-01921      PIC  9(05)  VALUE  01921.       04500000
045100         10  PC-TSYMSG-01922      PIC  9(05)  VALUE  01922.       04510000
045200         10  PC-TSYMSG-01923      PIC  9(05)  VALUE  01923.       04520000
045300         10  PC-TSYMSG-01924      PIC  9(05)  VALUE  01924.       04530000
045400         10  PC-TSYMSG-01925      PIC  9(05)  VALUE  01925.       04540000
045500         10  PC-TSYMSG-01927      PIC  9(05)  VALUE  01927.       04550000
045600         10  PC-TSYMSG-01928      PIC  9(05)  VALUE  01928.       04560000
045700         10  PC-TSYMSG-01929      PIC  9(05)  VALUE  01929.       04570000
045800         10  PC-TSYMSG-01930      PIC  9(05)  VALUE  01930.       04580000
045900         10  PC-TSYMSG-01931      PIC  9(05)  VALUE  01931.       04590000
046000         10  PC-TSYMSG-01932      PIC  9(05)  VALUE  01932.       04600000
046100         10  PC-TSYMSG-01935      PIC  9(05)  VALUE  01935.       04610000
046200         10  PC-TSYMSG-01937      PIC  9(05)  VALUE  01937.       04620000
046300         10  PC-TSYMSG-01939      PIC  9(05)  VALUE  01939.       04630000
046400         10  PC-TSYMSG-01940      PIC  9(05)  VALUE  01940.       04640000
046500         10  PC-TSYMSG-01943      PIC  9(05)  VALUE  01943.       04650000
046600         10  PC-TSYMSG-01967      PIC  9(05)  VALUE  01967.       04660000
046700         10  PC-TSYMSG-01968      PIC  9(05)  VALUE  01968.       04670000
046800         10  PC-TSYMSG-02316      PIC  9(05)  VALUE  02316.       04680000
046900         10  PC-TSYMSG-02395      PIC  9(05)  VALUE  02395.       04690000
047000         10  PC-TSYMSG-02481      PIC  9(05)  VALUE  02481.       04700000
047100         10  PC-TSYMSG-02919      PIC  9(05)  VALUE  02919.       04710000
047200         10  PC-TSYMSG-03346      PIC  9(05)  VALUE  03346.       04720000
047300         10  PC-TSYMSG-03347      PIC  9(05)  VALUE  03347.       04730000
047400         10  PC-TSYMSG-03349      PIC  9(05)  VALUE  03349.       04740000
047500         10  PC-TSYMSG-03360      PIC  9(05)  VALUE  03360.       04750000
047600         10  PC-TSYMSG-03361      PIC  9(05)  VALUE  03361.       04760000
047700         10  PC-TSYMSG-03417      PIC  9(05)  VALUE  03417.       04770000
047800         10  PC-TSYMSG-03422      PIC  9(05)  VALUE  03422.       04780000
047900         10  PC-TSYMSG-03423      PIC  9(05)  VALUE  03423.       04790000
048000         10  PC-TSYMSG-03429      PIC  9(05)  VALUE  03429.       04800000
048100         10  PC-TSYMSG-03430      PIC  9(05)  VALUE  03430.       04810000
048200         10  PC-TSYMSG-03431      PIC  9(05)  VALUE  03431.       04820000
048300         10  PC-TSYMSG-03497      PIC  9(05)  VALUE  03497.       04830000
048400         10  PC-TSYMSG-03515      PIC  9(05)  VALUE  03515.       04840000
048500*                                                                 04850000
048600 01  PS-PROGRAM-SWITCHES.                                         04860000
048700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         04870000
048800         88  PS-ERROR                         VALUE  'Y'.         04880000
048900         88  PS-NO-ERROR                      VALUE  'N'.         04890000
049000     05  PS-WARNING-SW            PIC  X(01)  VALUE  'N'.         04900000
049100         88  PS-WARNING                       VALUE  'Y'.         04910000
049200         88  PS-NO-WARNING                    VALUE  'N'.         04920000
049300     05  PS-NUMBER-LOCK-SW        PIC  X(01)  VALUE  'N'.         04930000
049400         88  PS-NUMBER-LOCKED                 VALUE  'Y'.         04940000
049500         88  PS-NUMBER-NOT-LOCKED             VALUE  'N'.         04950000
049600     05  PS-AGR-FOUND-SW          PIC  X(01).                     04960000
049700         88  AGR-FOUND                        VALUE 'Y'.          04970000
049800         88  AGR-NOT-FOUND                    VALUE 'N'.          04980000
049900     05  PS-NEWST-PCT-ENTERED-SW  PIC  X(01).                     04990000
050000         88  PV-NEW-STR-PCT-ENTERED           VALUE 'Y'.          05000000
050100         88  PV-NEW-STR-PCT-NOT-ENTERED       VALUE 'N'.          05010000
050200     05  PS-NEWST-AMT-ENTERED-SW  PIC  X(01).                     05020000
050300         88  PV-NEW-STR-AMT-ENTERED           VALUE 'Y'.          05030000
050400         88  PV-NEW-STR-AMT-NOT-ENTERED       VALUE 'N'.          05040000
050500     05  PS-VALID-DATE-SW         PIC  X(01).                     05050000
050600         88  PS-VALID-DATE                    VALUE 'Y'.          05060000
050700         88  PS-INVALID-DATE                  VALUE 'N'.          05070000
050800         88  PS-DATE-RANGE-ERROR              VALUE 'E'.          05080000
050900*                                                                 05090000
051000 01  PV-PROGRAM-VARIABLES.                                        05100000
051100     05  PV-ONE                   PIC  X(01).                     05110000
051200     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            05120000
051300                                              COMP SYNC.          05130000
051400     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            05140000
051500                                              COMP SYNC.          05150000
051600     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            05160000
051700                                              COMP SYNC.          05170000
051800     05  PV-NET-COST              PIC S9(10)V999.                 05180000
051900     05  PV-3V99                  PIC  ZZ9.99.                    05190000
052000     05  PV-3V99-X REDEFINES                                      05200000
052100         PV-3V99                  PIC  X(06).                     05210000
052200     05  PV-NUM9                  PIC  Z(09).                     05220000
052300     05  PV-NUM9-X REDEFINES                                      05230000
052400         PV-NUM9                  PIC  X(09).                     05240000
052500     05  PV-NUM4                  PIC  9(04).                     05250000
052600     05  PV-NUM4-X REDEFINES                                      05260000
052700         PV-NUM4                  PIC  X(04).                     05270000
052800     05  PV-NUM8                  PIC  9(08).                     05280000
052900     05  PV-NUM8-X REDEFINES                                      05290000
053000         PV-NUM8                  PIC  X(08).                     05300000
053100     05  PV-10V99                 PIC  ----------.99.             05310000
053200     05  PV-10V99-X REDEFINES                                     05320000
053300         PV-10V99                 PIC  X(13).                     05330000
053400     05  PV-6V99                  PIC  ------.99.                 05340000
053500     05  PV-6V99-X REDEFINES                                      05350000
053600         PV-6V99                  PIC  X(09).                     05360000
053700     05  PV-STORE-NBR-4           PIC  S9(04).                    05370000
053800     05  PV-STRING                PIC  X(16).                     05380000
053900     05  PV-START                 PIC  S9(04)   COMP VALUE ZEROS. 05390000
054000     05  PV-END                   PIC   9(04).                    05400000
054100     05  PV-LENGTH                PIC   9(04).                    05410000
054110     05  PV-DOC-NO                PIC  X(16).                     05411069
054200     05  PV-OFFSET-DOC-NUMBER     PIC  X(16).                     05420000
054300     05  PV-OFFSET-TRN-TYP-CDE    PIC  X(03).                     05430000
054400     05  PV-OFFSET-PSTG-TYP-CDE   PIC  X(02).                     05440000
054500     05  PV-OFFSET-BTCH-SRC-CDE   PIC  X(03).                     05450000
054600     05  PV-OFFSET-DOC-EXTR-IND   PIC  X(01).                     05460000
054700     05  PV-OFFSET-AP-TRN-CDE     PIC  X(02).                     05470000
054800     05  PV-ORIGIN-DOC-NUMBER     PIC  X(16).                     05480000
054900     05  PV-ORIGIN-DOC-EXTR-IND   PIC  X(01).                     05490000
055000     05  PV-ORIGIN-AP-TRN-CDE     PIC  X(02).                     05500000
055100     05  PV-CCYYMMDD-DATE               PIC  X(10).               05510000
055200     05  PV-CCYYMMDD-DATE-RDF           REDEFINES                 05520000
055300         PV-CCYYMMDD-DATE.                                        05530000
055400         10  PV-CCYY                    PIC  X(04).               05540000
055500         10  PV-CCYY-9   REDEFINES PV-CCYY                        05550000
055600                                        PIC  9(04).               05560000
055700         10  PV-CCYY-RDF REDEFINES PV-CCYY.                       05570000
055800             15  PV-CC                  PIC  9(02).               05580000
055900             15  PV-YY                  PIC  9(02).               05590000
056000         10  PV-DASH1                   PIC  X(01).               05600000
056100         10  PV-MM                      PIC  X(02).               05610000
056200         10  PV-MM-9     REDEFINES PV-MM                          05620000
056300                                        PIC  9(02).               05630000
056400         10  PV-DASH2                   PIC  X(01).               05640000
056500         10  PV-DD                      PIC  X(02).               05650000
056600         10  PV-DD-9     REDEFINES PV-DD                          05660000
056700                                        PIC  9(02).               05670000
056800     05  PV-PERCENT-VARIABLE            PIC  S9(01)V9(4).         05680000
056900     05  PV-ENTRY-ID                    PIC  X(08).               05690000
057000     05  PV-SEL-QUEUE-NAME.                                       05700000
057100         10  PV-SEL-TERM-ID             PIC   X(04).              05710000
057200         10  PV-SEL-TASK-NUMBER         PIC  S9(05) COMP-3.       05720000
057300         10  PV-SEL-SEQ                 PIC   9(01).              05730000
057400     05  PV-DET-RETAIL                  PIC  S9(10)V999999.       05740000
057500     05  PV-DISC-AMT                    PIC  S9(10)V999999.       05750000
057600     05  PV-NEW-STR-AMT                 PIC  S9(10)V999999.       05760000
057700     05  PV-TRADE-AMT                   PIC  S9(10)V999999.       05770000
057800     05  PV-MOS-AMT                     PIC  S9(10)V999999.       05780000
057900     05  PV-TRAN-CDE-APPL-CDE           PIC  X(02).               05790000
058000         88  PV-TRANSFER-TRAN-CODE           VALUE '52' '53' '82'.05800000
058100         88  PV-BROADCAST-MDS-TRAN-CODE      VALUE '50' '51' '56' 05810000
058200                                                   '57'.          05820000
058300         88  PV-BROADCAST-EXP-TRAN-CODE      VALUE '88' '91' '92'.05830000
058400         88  PV-BRIDAL-TRAN-CODE             VALUE '89' '93' '94' 05840000
058500                                                   '95' '96' '97'.05850000
058600     05  PV-ALLOC-PERC                  PIC  S9(01)V999999.       05860000
058700     05  PV-DISTRO-FRGT-AMT             PIC  S9(10)V99.           05870000
058800     05  PV-DISTRO-MISC-CHRG            PIC  S9(10)V99.           05880000
058900     05  PV-DISTRO-DISC-AMT             PIC  S9(10)V99.           05890000
059000     05  PV-ROUNDING-FACTOR             PIC  S9(01)V9999.         05900000
059100     05  PV-ABS-RETAIL-AMT              PIC   9(10)V99.           05910000
059200     05  PV-ABS-GROSS-COST              PIC   9(10)V99.           05920000
059300     05  PV-MARKON-PCT                  PIC  S9(06)V9999.         05930000
059400     05  PV-DEPARTMENT                  PIC  S9(4)V COMP-3.       05940000
059500     05  PV-CLASS                       PIC  S9(4)V COMP-3.       05950000
059600     05  PV-OFFSET-GL-ACCT-NBR          PIC   X(06).              05960000
059700     05  PV-SQLDISP                     PIC  -99999.              05970035
059710     05  PV-ACCT-NBR                    PIC  X(10) VALUE SPACES.  05971052
059720     05  PV-CURRENT-DATE                PIC  X(10) VALUE SPACES.  05972052
059800                                                                  05980000
059900 01  BARCODE-CHK-DIGIT-AREA.                                      05990000
060000     05  PV-HOLD-BARCODE          PIC X(9)     VALUE SPACES.      06000000
060100     05  PV-HOLD-BARCODE-9    REDEFINES PV-HOLD-BARCODE           06010000
060200                                  PIC 9(9).                       06020000
060300                                                                  06030000
060400*EJECT                                                            06040044
060500******************************************************************06050000
060600*    RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.    *06060000
060700******************************************************************06070000
060800                                                                  06080000
060900     COPY APWS362.                                                06090000
061000     EJECT                                                        06100000
061100******************************************************************06110000
061200*     RECORD LAYOUT FOR TEMP STORAGE QUEUE FOR PASSING HEADER    *06120000
061300*     ADJUSTMENT DATA TO DETAIL SCREENS.                         *06130000
061400******************************************************************06140000
061500                                                                  06150000
061600     COPY APWS363.                                                06160000
061700                                                                  06170000
061800******************************************************************06180000
061900*    MAP LAYOUT                                                  *06190000
062000******************************************************************06200000
062100                                                                  06210000
062200     COPY APKM364.                                                06220000
062300                                                                  06230000
062400     EJECT                                                        06240000
062500******************************************************************06250000
062600*    ATTRIBUTE SETTINGS COPYBOOK.                                *06260000
062700******************************************************************06270000
062800                                                                  06280000
062900     COPY DPWS015.                                                06290000
063000                                                                  06300000
063100******************************************************************06310000
063200*    FUNCTION KEYS COPYBOOK                                      *06320000
063300******************************************************************06330000
063400                                                                  06340000
063500     COPY DPWS016.                                                06350000
063600 EJECT                                                            06360000
063700******************************************************************06370000
063800*    WORK AREA PASSED TO MODULE APKUP151 FOR GETTING NEXT        *06380000
063900*    AVAILABLE DOCUMENT NUMBER.                                  *06390000
064000******************************************************************06400000
064100     COPY APWS364.                                                06410000
064200                                                                  06420000
064300 01 WS364-COMMAREA               PIC X(01).                       06430000
064500                                                                  06450000
064600 EJECT                                                            06460000
064700                                                                  06470000
064800******************************************************************06480000
064900*    WORK AREA PASSED IN CALL TO DPKUT500 DATE ROUTINE           *06490000
065000******************************************************************06500000
065100     COPY DPWS500.                                                06510000
065200                                                                  06520000
065300******************************************************************06530000
065400*    WORK AREA FOR NUMERIC EDIT ROUTINE                          *06540000
065500******************************************************************06550000
065600     COPY DPWS010I.                                               06560000
065700******************************************************************06570000
065800* PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).       *06580000
065900******************************************************************06590000
066000     COPY DPWS030.                                                06600000
066010     COPY DPWS930.                                                06601072
066100 EJECT                                                            06610000
066200*----------------------------------------------------------------*06620051
066300*  COMMUNICATIONS AREA2 FOR DB2                                  *06630051
066400*----------------------------------------------------------------*06640051
066500     COPY SQLCA2.                                                 06650054
066510*                                                                 06651051
066600******************************************************************06660000
066700*    STANDARD COMMAREA.                                          *06670000
066800******************************************************************06680000
066900                                                                  06690000
067000     COPY DPWS020.                                                06700000
067100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06710000
067200                                                                  06720000
067300******************************************************************06730000
067400*    INTER-APPLICATION COMMAREA.                                 *06740000
067500******************************************************************06750000
067600                                                                  06760000
067700         10  INTER-APPL-COMM-AREA PIC X(200).                     06770000
067800     COPY APWS361.                                                06780000
067900******************************************************************06790000
068000*    SPECIFIC COMMMAREA FOR APKCS364.                            *06800000
068100******************************************************************06810000
068200         10  ASC-SPECIFIC-COMMAREA.                               06820000
068300             15  ASC-INT-APPL-FORMAT-IND     PIC  X(01).          06830000
068400                 88  ASC-INTER-APPL-ADD                 VALUE ' '.06840000
068500                 88  ASC-INTER-APPL-CRIT-UPDATE         VALUE '2'.06850000
068600                 88  ASC-INTER-APPL-CRIT-DELETE         VALUE '3'.06860000
068700                 88  ASC-INTER-APPL-LIST-UPDATE         VALUE '5'.06870000
068800                 88  ASC-INTER-APPL-LIST-DELETE         VALUE '6'.06880000
068900             15  ASC-RETURN-SW               PIC  X(01).          06890000
069000                 88  ASC-RETURN-FROM-DISTRO  VALUE 'D'.           06900000
069100                 88  ASC-OTHER-RETURN        VALUE ' '.           06910000
069200             15  ASC-REQUEST-SW              PIC  X(03).          06920000
069300                 88  ASC-DELETE-REQUESTED    VALUE 'DEL'.         06930000
069400                 88  ASC-UPDATE-REQUESTED    VALUE 'UPD'.         06940000
069500             15  ASC-ACTION-SW               PIC  X(03).          06950000
069600                 88  ASC-DELETE-ALLOWED      VALUE '   '.         06960000
069700                 88  ASC-NO-CHANGES-ALLOWED  VALUE 'NOC'.         06970000
069800                 88  ASC-DELETE-PENDING      VALUE 'DEL'.         06980000
069900                 88  ASC-UPDATE-PENDING      VALUE 'UPD'.         06990000
070000                 88  ASC-RETURN              VALUE 'RET'.         07000000
070100             15  ASC-DELETE-SUCCESSFUL-SW    PIC  X(01).          07010000
070200                 88  ASC-DELETE-SUCCESSFUL   VALUE 'Y'.           07020000
070300             15  ASC-ADD-SUCCESSFUL-SW       PIC  X(01).          07030000
070400                 88  ASC-ADD-NOT-SUCCESSFUL  VALUE ' '.           07040000
070500                 88  ASC-ADD-SUCCESSFUL      VALUE 'Y'.           07050000
070600             15  ASC-FIELDS-MODIFIED-SW      PIC  X(01).          07060000
070700                 88  ASC-FIELDS-MODIFIED     VALUE 'Y'.           07070000
070800             15  ASC-ADJUST-FOUND-SW         PIC  X(01).          07080000
070900                 88  ASC-ADJUST-FOUND        VALUE 'Y'.           07090000
071000                 88  ASC-ADJUST-NOT-FOUND    VALUE 'N'.           07100000
071100             15  ASC-CLASS-FOUND-SW          PIC  X(01).          07110000
071200                 88  ASC-CLASS-FOUND         VALUE 'Y'.           07120000
071300                 88  ASC-CLASS-NOT-FOUND     VALUE 'N'.           07130000
071400             15  ASC-SKU-FOUND-SW            PIC  X(01).          07140000
071500                 88  ASC-SKU-FOUND           VALUE 'Y'.           07150000
071600                 88  ASC-SKU-NOT-FOUND       VALUE 'N'.           07160000
071700             15  ASC-ADD-COMPLETE-SW         PIC  X(01).          07170000
071800                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.07180000
071900                 88  ASC-ADD-PENDING                    VALUE 'N'.07190000
072000             15  ASC-DUP-DOC-NO-SW           PIC  X(01).          07200000
072100                 88  ASC-DUP-DOC                        VALUE 'Y'.07210000
072200                 88  ASC-NO-DUP-DOC                     VALUE 'N'.07220000
072300             15  ASC-TRAN-CDE-FOUND-SW       PIC  X(01).          07230000
072400                 88  ASC-TRAN-CDE-NOT-FND               VALUE 'Y'.07240000
072500                 88  ASC-TRAN-CDE-FND                   VALUE 'N'.07250000
072600             15  ASC-VENDOR-FOUND-SW         PIC  X(01).          07260000
072700                 88  ASC-VENDOR-NOT-FOUND               VALUE 'Y'.07270000
072800                 88  ASC-VENDOR-FOUND                   VALUE 'N'.07280000
072900             15  ASC-DEPARTMENT-FOUND-SW     PIC  X(01).          07290000
073000                 88  ASC-DEPT-NOT-FOUND                 VALUE 'Y'.07300000
073100                 88  ASC-DEPT-FOUND                     VALUE 'N'.07310000
073200             15  ASC-ACCOUNT-NO-FOUND-SW     PIC  X(01).          07320000
073300                 88  ASC-ACCT-NOT-FOUND                 VALUE 'Y'.07330000
073400                 88  ASC-ACCT-FOUND                     VALUE 'N'.07340000
073500             15  ASC-HD-STORE-FOUND-SW       PIC  X(01).          07350000
073600                 88  ASC-HD-STORE-NOT-FOUND             VALUE 'Y'.07360000
073700                 88  ASC-HD-STORE-FOUND                 VALUE 'N'.07370000
073800             15  ASC-PO-FOUND-SW             PIC  X(01).          07380000
073900                 88  ASC-PO-NOT-FOUND                   VALUE 'Y'.07390000
074000                 88  ASC-PO-FOUND                       VALUE 'N'.07400000
074100             15  ASC-SKU-ENTERED-SW          PIC   X(01).         07410000
074200                 88  ASC-SKU-NOT-ENTERED                VALUE 'Y'.07420000
074300                 88  ASC-SKU-ENTERED                    VALUE 'N'.07430000
074400                 88  ASC-SKU-NOT-ALLOWED                VALUE 'O'.07440000
074500             15  ASC-FUNC-REQUESTED-SW       PIC   X(01).         07450000
074600                 88  ASC-FUNC-NOT-REQUESTED             VALUE ' '.07460000
074700                 88  ASC-FUNC-REQUESTED                 VALUE 'N'.07470000
074800             15  ASC-PO-VND-FOUND-SW         PIC   X(01).         07480000
074900                 88  ASC-PO-VND-NOT-FOUND               VALUE 'Y'.07490000
075000                 88  ASC-PO-VND-FOUND                   VALUE 'N'.07500000
075100             15  ASC-ALLOCATION-SW           PIC   X(01).         07510000
075200                 88  ASC-GROSS-COST-ALLOCATION          VALUE 'G'.07520000
075300                 88  ASC-RETAIL-AMT-ALLOCATION          VALUE 'R'.07530000
075400                 88  ASC-FREIGHT-COST-ALLOCATION        VALUE 'F'.07540000
075500                 88  ASC-NEW-STR-COST-ALLOCATION        VALUE 'N'.07550000
075600             15  ASC-MULTIPLE-PSTG-SW        PIC   X(01).         07560000
075700                 88  ASC-MULTI-PSTG-PERIOD              VALUE 'Y'.07570000
075800                 88  ASC-NOT-MULTI-PSTG-PERIOD          VALUE 'N'.07580000
075900             15  ASC-DOCUMENT-FOUND-SW       PIC   X(01).         07590000
076000                 88  ASC-DOCUMENT-FOUND                 VALUE 'Y'.07600000
076100                 88  ASC-DOCUMENT-NOT-FOUND             VALUE 'N'.07610000
076200                 88  ASC-MULTIPLE-DOCUMENTS             VALUE 'M'.07620000
076300             15  ASC-MULT-DISTRO-IND         PIC  X(01).          07630000
076400                 88  ASC-MULT-DIST                      VALUE 'Y'.07640000
076500                 88  ASC-SINGLE-DIST                    VALUE 'N'.07650000
076600             15  ASC-COST-MATCH-IND          PIC  X(01).          07660000
076700                 88  ASC-COST-MATCH                     VALUE 'Y'.07670000
076800                 88  ASC-COST-NOT-MATCH                 VALUE 'N'.07680000
076900             15  ASC-RETAIL-MATCH-IND        PIC  X(01).          07690000
077000                 88  ASC-RETAIL-MATCH                   VALUE 'Y'.07700000
077100                 88  ASC-RETAIL-NOT-MATCH               VALUE 'N'.07710000
077200             15  ASC-ACCT-NBR-MATCH-IND      PIC  X(01).          07720000
077300                 88  ASC-ACCT-NBR-MATCH-NOT-CHECKED     VALUE ' '.07730000
077400                 88  ASC-ACCT-NBR-MATCHES               VALUE 'Y'.07740000
077500                 88  ASC-ACCT-NBR-DOESNT-MATCH          VALUE 'N'.07750000
077600             15  ASC-OFFSET-TC-FOUND-SW      PIC  X(01).          07760000
077700                 88  ASC-OFFSET-TC-NOT-FOUND            VALUE 'Y'.07770000
077800                 88  ASC-OFFSET-TC-FOUND                VALUE 'N'.07780000
077900             15  ASC-OFFSET-ACCT-FOUND-SW    PIC  X(01).          07790000
078000                 88  ASC-OFFSET-ACCT-NOT-FOUND          VALUE 'Y'.07800000
078100                 88  ASC-OFFSET-ACCT-FOUND              VALUE 'N'.07810000
078200             15  ASC-OFFSET-ADJUSTMENT-SW    PIC  X(01).          07820000
078300                 88  ASC-OFFSET-ADJUSTMENT              VALUE 'Y'.07830000
078400                 88  ASC-NOT-OFFSET-ADJUSTMENT          VALUE 'N'.07840000
078500             15  ASC-OFFSET-ADJ-FOUND-SW     PIC  X(01).          07850000
078600                 88  ASC-OFFSET-ADJ-FOUND               VALUE 'Y'.07860000
078700                 88  ASC-OFFSET-ADJ-NOT-FOUND           VALUE 'N'.07870000
078800             15  ASC-OFFSET-EXTRACTED-SW     PIC  X(01).          07880000
078900                 88  ASC-OFFSET-EXTRACTED               VALUE 'Y'.07890000
079000                 88  ASC-OFFSET-NOT-EXTRACTED           VALUE 'N'.07900000
079100                                                                  07910000
079200             15  ASC-KEY-FIELDS.                                  07920000
079300                 20  ASC-KEY-VEND-NUMBER     PIC  X(09).          07930000
079400                 20  ASC-KEY-PO-NBR          PIC  S9(09).         07940000
079500                 20  ASC-KEY-TRAN-CODE       PIC  X(02).          07950000
079600                 20  ASC-KEY-DOC-NUMBER      PIC  X(16).          07960000
079700                 20  ASC-KEY-DOC-DATE        PIC  X(10).          07970000
079800             15  ASC-ALPHA-FIELDS.                                07980000
079900                 20  ASC-ALP-PO-NBR          PIC  X(09).          07990000
080000                 20  ASC-ALP-PO-NBR-9  REDEFINES                  08000000
080100                         ASC-ALP-PO-NBR     PIC  9(09).           08010000
080200                 20  ASC-ALP-STORE-NBR       PIC  X(04).          08020000
080300                 20  ASC-ALP-NET-COST.                            08030000
080400                     25  ASC-ALP-NET-COST-9  PIC   9(10)V99.      08040000
080500                 20  ASC-ALP-RET-COST        PIC   X(13).         08050000
080600                 20  ASC-ALP-RET-COST-9  REDEFINES                08060000
080700                         ASC-ALP-RET-COST    PIC  -9(10)V99.      08070000
080800                 20  ASC-ALP-GROSS-COST      PIC   X(13).         08080000
080900                 20  ASC-ALP-GRO-COST-9  REDEFINES                08090000
081000                         ASC-ALP-GROSS-COST  PIC  -9(10)V99.      08100000
081100                 20  ASC-ALP-FREIGHT-COST    PIC   X(13).         08110000
081200                 20  ASC-ALP-FRT-COST-9  REDEFINES                08120000
081300                        ASC-ALP-FREIGHT-COST PIC  -9(10)V99.      08130000
081400                 20  ASC-ALP-MISC-CHG        PIC    X(13).        08140000
081500                 20  ASC-ALP-MISC-CHG-9  REDEFINES                08150000
081600                        ASC-ALP-MISC-CHG     PIC  -9(10)V99.      08160000
081700                 20  ASC-ALP-DISC-PCT        PIC    X(08).        08170000
081800                 20  ASC-ALP-DISC-PCT-9  REDEFINES                08180000
081900                        ASC-ALP-DISC-PCT     PIC   9(04)V9(4).    08190000
082000                 20  ASC-ALP-MOS-PCT         PIC    X(08).        08200000
082100                 20  ASC-ALP-MOS-PCT-9   REDEFINES                08210000
082200                        ASC-ALP-MOS-PCT      PIC   9(04)V9(4).    08220000
082300                 20  ASC-ALP-NEW-STR-PCT     PIC    X(08).        08230000
082400                 20  ASC-ALP-NEW-STR-PCT-9 REDEFINES              08240000
082500                        ASC-ALP-NEW-STR-PCT  PIC   9(04)V9(4).    08250000
082600                 20  ASC-ALP-NEW-STR-AMT     PIC    X(09).        08260000
082700                 20  ASC-ALP-NEW-STR-AMT-9 REDEFINES              08270000
082800                        ASC-ALP-NEW-STR-AMT  PIC   9(07)V99.      08280000
082900                 20  ASC-ALP-TRADE-PCT       PIC    X(08).        08290000
083000                 20  ASC-ALP-TRADE-PCT-9   REDEFINES              08300000
083100                        ASC-ALP-TRADE-PCT    PIC   9(04)V9(4).    08310000
083200                 20  ASC-ALP-DET-COST        PIC   X(13).         08320000
083300                 20  ASC-ALP-DET-COST-9  REDEFINES                08330000
083400                         ASC-ALP-DET-COST    PIC  -9(10)V99.      08340000
083500                 20  ASC-ALP-DET-RETL        PIC   X(13).         08350000
083600                 20  ASC-ALP-DET-RETL-9  REDEFINES                08360000
083700                         ASC-ALP-DET-RETL    PIC  -9(10)V99.      08370000
083800                 20  ASC-ALP-DET-SKU         PIC  X(08).          08380000
083900                 20  ASC-ALP-DET-SKU-9   REDEFINES                08390000
084000                         ASC-ALP-DET-SKU     PIC  9(08).          08400000
084100                 20  ASC-ALP-DET-STORE       PIC   X(04).         08410000
084200             15  ASC-CURR-PSTG-FYR-NBR       PIC  X(04).          08420000
084300             15  ASC-CURR-PSTG-FMN-NBR       PIC  X(02).          08430000
084400             15  ASC-CURR-PSTG-FWK-NBR       PIC  X(02).          08440000
084500             15  ASC-PREV-PSTG-FYR-NBR       PIC  X(04).          08450000
084600             15  ASC-PREV-PSTG-FMN-NBR       PIC  X(02).          08460000
084700             15  ASC-PREV-PSTG-FWK-NBR       PIC  X(02).          08470000
084800             15  ASC-TRN-TYP-CDE             PIC  X(03).          08480000
084900             15  ASC-TXT-REQR-IND            PIC  X(01).          08490000
085000             15  ASC-COST-PRCCTL-CDE         PIC  X(01).          08500000
085100             15  ASC-AP-PSTG-IND             PIC  X(01).          08510000
085200             15  ASC-RTL-PRCCTL-CDE          PIC  X(01).          08520000
085300             15  ASC-PSTG-TYP-CDE            PIC  X(02).          08530000
085400             15  ASC-SKU-SEQ-REQR-IND        PIC  X(01).          08540000
085500             15  ASC-SUB-CL-REQR-IND         PIC  X(01).          08550000
085600             15  ASC-FRGT-REQR-IND           PIC  X(01).          08560000
085700             15  ASC-PS-BATCH-NBR            PIC  X(15).          08570000
085800             15  ASC-PS-POSTING-IND          PIC  X(01).          08580000
085900             15  ASC-DOC-EXTRACT-IND         PIC  X(01).          08590000
086000             15  ASC-DOC-EXTRACT-DTE         PIC  X(10).          08600000
086100             15  ASC-ORIGIN-CDE              PIC  X(01).          08610000
086200             15  ASC-CURRENT-DATE            PIC  X(10).          08620000
086300             15  ASC-HOLD-OFF-BYPASS-IND     PIC  X(01).          08630000
086400             15  ASC-OFFSET-DOC-NUMBER       PIC  X(16).          08640000
086500             15  ASC-OFFSET-BTCH-SRC-CDE     PIC  X(03).          08650000
086600             15  ASC-OFFSET-PSTG-TYP-CDE     PIC  X(02).          08660000
086700             15  ASC-SCREEN-FIELDS.                               08670000
086800                 20  ASC-TRAN-CD             PIC  X(02).          08680000
086900                 20  ASC-DOC-NUMBER          PIC  X(16).          08690000
087000                 20  ASC-VENDOR-NUMBER       PIC  X(09).          08700000
087100                 20  ASC-PO-NUMBER           PIC  S9(09).         08710000
087200                 20  ASC-VENDOR-NAME         PIC  X(25).          08720000
087300                 20  ASC-ENT-ID              PIC  S9(09).         08730000
087400                 20  ASC-BARCODE             PIC  X(09).          08740000
087500                 20  ASC-STORE               PIC  9(04).          08750000
087600                 20  ASC-DOC-DATE            PIC  X(10).          08760000
087700                 20  ASC-DOC-DATE-RDF REDEFINES                   08770000
087800                     ASC-DOC-DATE.                                08780000
087900                     25  ASC-DOC-DATE-CC     PIC  X(02).          08790000
088000                     25  ASC-DOC-DATE-YY     PIC  X(02).          08800000
088100                     25  FILLER              PIC  X(01).          08810000
088200                     25  ASC-DOC-DATE-MM     PIC  X(02).          08820000
088300                     25  FILLER              PIC  X(01).          08830000
088400                     25  ASC-DOC-DATE-DD     PIC  X(02).          08840000
088500                 20  ASC-DEPARTMENT          PIC  X(03).          08850000
088600                 20  ASC-DEPARTMENT-9 REDEFINES                   08860000
088700                     ASC-DEPARTMENT          PIC  9(03).          08870000
088800                 20  ASC-ACCT-NO             PIC  X(06).          08880000
088900                 20  ASC-VENDOR-AUTH         PIC  X(10).          08890000
089000                 20  ASC-GROSS-COST          PIC  S9(10)V99.      08900000
089100                 20  ASC-RETAIL-AMT          PIC  S9(10)V99.      08910000
089200                 20  ASC-FREIGHT-AMT         PIC  S9(10)V99.      08920000
089300                 20  ASC-MISC-CHG            PIC  S9(10)V99.      08930000
089400                 20  ASC-DISC-PCT            PIC  S9(03)V9(4).    08940000
089500                 20  ASC-DISC-AMT            PIC  S9(06)V99.      08950000
089600                 20  ASC-MOS-PCT             PIC  S9(03)V9(4).    08960000
089700                 20  ASC-MOS-AMT             PIC  S9(06)V99.      08970000
089800                 20  ASC-NEW-STR-PCT         PIC  S9(03)V9(4).    08980000
089900                 20  ASC-NEW-STR-AMT         PIC  S9(06)V99.      08990000
090000                 20  ASC-HOLD-STATUS         PIC  X(01).          09000000
090100                 20  ASC-TRADE-PCT           PIC  S9(03)V9(4).    09010000
090200                 20  ASC-TRADE-AMT           PIC  S9(06)V99.      09020000
090300                 20  ASC-NET-COST            PIC  S9(10)V99.      09030000
090400                 20  ASC-CUTOFF-DATE         PIC  X(10).          09040000
090500                 20  ASC-CUTOFF-DATE-RDF REDEFINES                09050000
090600                     ASC-CUTOFF-DATE.                             09060000
090700                     25  ASC-CUTOFF-CC       PIC  X(02).          09070000
090800                     25  ASC-CUTOFF-YY       PIC  X(02).          09080000
090900                     25  FILLER              PIC  X(01).          09090000
091000                     25  ASC-CUTOFF-MM       PIC  X(02).          09100000
091100                     25  FILLER              PIC  X(01).          09110000
091200                     25  ASC-CUTOFF-DD       PIC  X(02).          09120000
091300                 20  ASC-DUE-DATE            PIC  X(10).          09130000
091400                 20  ASC-DUE-DATE-RDF REDEFINES                   09140000
091500                     ASC-DUE-DATE.                                09150000
091600                     25  ASC-DUE-DATE-CC     PIC  X(02).          09160000
091700                     25  ASC-DUE-DATE-YY     PIC  X(02).          09170000
091800                     25  FILLER              PIC  X(01).          09180000
091900                     25  ASC-DUE-DATE-MM     PIC  X(02).          09190000
092000                     25  FILLER              PIC  X(01).          09200000
092100                     25  ASC-DUE-DATE-DD     PIC  X(02).          09210000
092200                 20  ASC-APPL-MTH            PIC  X(01).          09220000
092300                 20  ASC-REASON-CODE1        PIC  X(50).          09230000
092400                 20  ASC-REASON-CODE2        PIC  X(50).          09240000
092500                 20  ASC-DET-STORE           PIC  9(04).          09250000
092600                 20  ASC-DET-CLASS           PIC  X(02).          09260000
092700                 20  ASC-DET-CLASS-9 REDEFINES ASC-DET-CLASS      09270000
092800                                             PIC  9(02).          09280000
092900                 20  ASC-DET-SKU             PIC S9(08).          09290000
093000                 20  ASC-DET-COST            PIC  S9(10)V99.      09300000
093100                 20  ASC-DET-RETAIL          PIC  S9(10)V99.      09310000
093200                 20  ASC-DET-NET             PIC  S9(10)V99.      09320000
093300                 20  ASC-DET-DISTRB-SEQ      PIC  S9(09).         09330000
093400                 20  ASC-OFFSET-TRAN-CD      PIC  X(02).          09340000
093500                 20  ASC-OFFSET-ACCT-NO      PIC  X(06).          09350000
093600                 20  ASC-OFFSET-BYPASS-IND   PIC  X(01).          09360000
093700             15  ASC-USE-SELECTION-QUEUE-IND PIC  X(01).          09370000
093800                 88  ASC-USE-SELECTION-QUEUE            VALUE 'Y'.09380000
093900             15  ASC-SEL-QUEUE-NAME          PIC  X(08).          09390000
094000             15  ASC-NUMBER-OF-TS-ITEMS      PIC  S9(05).         09400000
094100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     09410000
094200                                             PIC  S9(09).         09420000
094300             15  ASC-SEL-SUB                 PIC  S9(04).         09430000
094400             15  ASC-SEL-ITEM                PIC  S9(04)          09440000
094500                                                    COMP SYNC.    09450000
094600             15  ASC-TS-QUEUE-NAME           PIC  X(08).          09460000
094700     EJECT                                                        09470000
094800******************************************************************09480000
094900*    ABEND PROCESSING COPYBOOK.                                  *09490000
095000******************************************************************09500000
095100                                                                  09510000
095200     COPY DPWS013.                                                09520000
095300                                                                  09530000
095400*    DB2 AREA FOR TADJRNL                                         09540000
095500                                                                  09550000
095600     EXEC SQL                                                     09560000
095700          INCLUDE TADJRNL                                         09570000
095800     END-EXEC.                                                    09580000
095900                                                                  09590000
096000*    DB2 AREA FOR TAJPSINT                                        09600000
096100                                                                  09610000
096200     EXEC SQL                                                     09620000
096300          INCLUDE TAJPSINT                                        09630000
096400     END-EXEC.                                                    09640000
096500                                                                  09650000
096600*    DB2 AREA FOR TADJDIS                                         09660000
096700                                                                  09670000
096800     EXEC SQL                                                     09680000
096900          INCLUDE TADJDIS                                         09690000
097000     END-EXEC.                                                    09700000
097100                                                                  09710000
097200*    DB2 AREA FOR TTRNCDE                                         09720000
097300                                                                  09730000
097400     EXEC SQL                                                     09740000
097500          INCLUDE TTRNCDE                                         09750000
097600     END-EXEC.                                                    09760000
097700                                                                  09770000
097800*    DB2 AREA FOR TAPCNTL                                         09780000
097900                                                                  09790000
098000     EXEC SQL                                                     09800000
098100          INCLUDE TAPCNTL                                         09810000
098200     END-EXEC.                                                    09820000
098300                                                                  09830000
098400*    DB2 AREA FOR TEXTENT                                         09840000
098500                                                                  09850000
098600     EXEC SQL                                                     09860000
098700          INCLUDE TEXTENT                                         09870000
098800     END-EXEC.                                                    09880000
098900                                                                  09890000
099000*    DB2 AREA FOR TENTNME                                         09900000
099100                                                                  09910000
099200     EXEC SQL                                                     09920000
099300          INCLUDE TENTNME                                         09930000
099400     END-EXEC.                                                    09940000
099500                                                                  09950000
099600*    DB2 AREA FOR TVNDAGR                                         09960000
099700                                                                  09970000
099800     EXEC SQL                                                     09980000
099900          INCLUDE TVNDAGR                                         09990000
100000     END-EXEC.                                                    10000000
100100                                                                  10010000
100200*    DB2 AREA FOR XFT00017                                        10020000
100300                                                                  10030000
100400     EXEC SQL                                                     10040000
100500          INCLUDE XFT00017                                        10050000
100600     END-EXEC.                                                    10060000
100700                                                                  10070000
100800*    DB2 AREA FOR XFT00003                                        10080000
100900                                                                  10090000
101000*    EXEC SQL                                                     10100000
101100*         INCLUDE XFT00003                                        10110000
101200*    END-EXEC.                                                    10120000
101300                                                                  10130000
101400*    DB2 AREA FOR TPURCHS                                         10140000
101500                                                                  10150000
101600     EXEC SQL                                                     10160000
101700          INCLUDE TPURCHS                                         10170000
101800     END-EXEC.                                                    10180000
101900                                                                  10190000
102000*    DB2 AREA FOR TMDSEAR                                         10200000
102100                                                                  10210000
102200     EXEC SQL                                                     10220000
102300          INCLUDE TMDSEAR                                         10230000
102400     END-EXEC.                                                    10240000
102500                                                                  10250000
102600*    DB2 AREA FOR TAPLAVL                                         10260000
102700                                                                  10270000
102800     EXEC SQL                                                     10280000
102900          INCLUDE TAPLAVL                                         10290000
103000     END-EXEC.                                                    10300000
103100                                                                  10310000
103200*    DB2 AREA FOR PFI00002                                        10320000
103300                                                                  10330000
103400     EXEC SQL                                                     10340000
103500          INCLUDE PFI00002                                        10350000
103600     END-EXEC.                                                    10360000
103700                                                                  10370000
103800*    DB2 AREA FOR TSKXREF                                         10380000
103900                                                                  10390000
104000     EXEC SQL                                                     10400000
104100          INCLUDE TSKXREF                                         10410000
104200     END-EXEC.                                                    10420000
104300                                                                  10430000
104400*    DB2 AREA FOR SYSDUMMY1                                       10440000
104500                                                                  10450000
104600     EXEC SQL                                                     10460000
104700          INCLUDE SYSDUMMY                                        10470000
104800     END-EXEC.                                                    10480000
104810*--------------------------------------------------------------*  10481051
104830*     APT_ACCT_TBL DCLGEN                                      *  10483051
104840*--------------------------------------------------------------*  10484051
104850     EXEC SQL                                                     10485051
104870         INCLUDE APT00002                                         10487051
104880     END-EXEC.                                                    10488051
104900                                                                  10490000
105000*    DB2 AREA FOR COMMUNICATIONS                                  10500000
105100                                                                  10510000
105200     EXEC SQL                                                     10520000
105300          INCLUDE SQLCA                                           10530000
105400     END-EXEC.                                                    10540000
105500                                                                  10550000
105600 EJECT                                                            10560000
105700 LINKAGE SECTION.                                                 10570000
105800                                                                  10580000
105900 01  DFHCOMMAREA.                                                 10590000
106000     05  FILLER                         OCCURS  1 TO 4072 TIMES   10600000
106100                                        DEPENDING ON EIBCALEN.    10610000
106200         10  FILLER                     PIC  X(01).               10620000
106300                                                                  10630000
106400***************************************************************** 10640000
106500** THIS IS THE UPDATE CURSOR FOR GETTING THE NEXT AVAILABLE    ** 10650000
106600** DOCUMENT NUMBER.  THIS CURSOR IS NEEDED IN ORDER TO "LOCK"  ** 10660000
106700** THE ROW SO NO COLLISIONS WILL OCCUR ON THE INSERT.          ** 10670000
106800***************************************************************** 10680000
106900                                                                  10690000
107000     EXEC SQL                                                     10700000
107100          DECLARE UPD_CSR CURSOR FOR                              10710000
107200          SELECT                                                  10720000
107300            NEXT_AP_DOC_NBR                                       10730000
107400          FROM TAPCNTL                                            10740000
107500          FOR UPDATE OF NEXT_AP_DOC_NBR                           10750000
107600     END-EXEC.                                                    10760000
107700                                                                  10770000
107800***************************************************************** 10780000
107900** THIS IS THE CURSOR TO GATHER ONE DISTRIBUTION LINE FOR AN   ** 10790000
108000** ADJUSTMENT.  ONLY ONE FETCH WILL OCCUR.                     ** 10800000
108100***************************************************************** 10810000
108200                                                                  10820000
108300     EXEC SQL                                                     10830000
108400          DECLARE DET-CSR CURSOR FOR                              10840000
108500          SELECT                                                  10850000
108600            VND_NBR                                               10860000
108700           ,DOC_NBR                                               10870000
108800           ,DOC_DTE                                               10880000
108900           ,AP_TRN_CDE                                            10890000
109000           ,DISTRB_SEQ_NBR                                        10900000
109100           ,STR_NBR                                               10910000
109200           ,DEPT_NBR                                              10920000
109300           ,CL_NBR                                                10930000
109400           ,SKU_NBR                                               10940000
109500           ,GRO_COST_AMT                                          10950000
109600           ,RTL_AMT                                               10960000
109700           ,FRGT_AMT                                              10970000
109800           ,MISC_CHRG_AMT                                         10980000
109900           ,DISC_AMT                                              10990000
110000           ,NET_COST_AMT                                          11000000
110100         FROM TADJDIS                                             11010000
110200         WHERE VND_NBR     = :ADJRNL-VND-NBR                      11020000
110300         AND   DOC_NBR     = :ADJRNL-DOC-NBR                      11030000
110400         AND   DOC_DTE     = :ADJRNL-DOC-DTE                      11040000
110500         AND AP_TRN_CDE    = :ADJRNL-AP-TRN-CDE                   11050000
110600         AND DISTRB_SEQ_NBR IS NOT NULL                           11060000
110700         ORDER BY VND_NBR, DOC_NBR, DOC_DTE, AP_TRN_CDE,          11070000
110800                  DISTRB_SEQ_NBR                                  11080000
110900     END-EXEC.                                                    11090000
111000                                                                  11100000
111100 PROCEDURE DIVISION.                                              11110000
111200***************************************************************** 11120000
111300** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 11130000
111400** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 11140000
111500** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 11150000
111600**                                                             ** 11160000
111700** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 11170000
111800** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 11180000
111900***************************************************************** 11190000
112000 0000-MAIN-MODULE.                                                11200000
112100                                                                  11210000
112200     INITIALIZE DP030-CICS-API-FIELDS.                            11220000
112300                                                                  11230000
112400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       11240000
112500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          11250000
112600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         11260000
112700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       11270000
112800     MOVE LENGTH OF AP364AI        TO DP030-MAP-LENGTH (1).       11280000
112900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     11290000
113000                                                                  11300000
113100     PERFORM 0001-CALL-CICS-ARCH-API.                             11310000
113200                                                                  11320000
113300     PERFORM 1000-CONTROL-PROCESSING.                             11330000
113400                                                                  11340000
113500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     11350000
113600                                                                  11360000
113700     PERFORM 0001-CALL-CICS-ARCH-API.                             11370000
113800                                                                  11380000
113900******************************************************************11390000
114000**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **11400000
114100**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **11410000
114200******************************************************************11420000
114300 0001-CALL-CICS-ARCH-API.                                         11430000
114400                                                                  11440000
114500     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     11450072
114600                                     DFHCOMMAREA                  11460072
114700                                     DP030-CICS-API-FIELDS        11470072
114800                                     DP020-STANDARD-COMMAREA      11480072
114900                                     AP364AI.                     11490072
115000                                                                  11500000
115100     IF  DP030-RC-CALL-SUCCESSFUL                                 11510000
115200         CONTINUE                                                 11520000
115300     ELSE                                                         11530000
115400         SET DP013-NO-ROLLBACK                                    11540000
115500             DP013-XCTL-DISPLAY-RESTART                           11550000
115600             DP013-CICS-ABEND      TO TRUE                        11560000
115700         MOVE 'BEFORE 0000-MAIN-MODULE'                           11570000
115800                                   TO DP013-PARAGRAPH             11580000
116010         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O11601072
116020-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11602072
116100         MOVE DP030-RETURN-CODE                                   11610000
116200                                   TO DP013-MESSAGE-TEXT (3)      11620000
116300         PERFORM DP013-0000-PROCESS-ABEND                         11630000
116400     END-IF.                                                      11640000
116500 EJECT                                                            11650000
116600******************************************************************11660000
116700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *11670000
116800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *11680000
116900******************************************************************11690000
117000 1000-CONTROL-PROCESSING.                                         11700000
117100                                                                  11710000
117200     EVALUATE TRUE                                                11720000
117300         WHEN DP020-NEXT-ACT-INITIAL                              11730000
117400             INITIALIZE ASC-SPECIFIC-COMMAREA                     11740000
117500             PERFORM 1100-FIND-OBJECT-KEYS                        11750000
117600             IF PS-ERROR                                          11760000
117700                CONTINUE                                          11770000
117800             ELSE                                                 11780000
117900                PERFORM 7000-EVALUATE-MULT-PSTG                   11790000
118000                PERFORM 4000-BUILD-INITIAL-PANEL                  11800000
118100                PERFORM 3200-RESET-ATTRIBUTES                     11810000
118200                IF PS-NO-ERROR                                    11820000
118300                   IF ASC-DOCUMENT-FOUND                          11830000
118400                      IF ASC-DELETE-REQUESTED                     11840000
118500                         SET ASC-DELETE-PENDING TO TRUE           11850000
118600                         MOVE PC-TSYMSG-00354 TO DP020-MSG-NUMBER 11860000
118700                         SET DP020-MSG-INFORMATIONAL TO TRUE      11870000
118800                      END-IF                                      11880000
118900                   ELSE                                           11890000
119000                      IF ASC-DOCUMENT-NOT-FOUND                   11900000
119100                         IF ASC-ADD-PENDING                       11910000
119200                            CONTINUE                              11920000
119300                         ELSE                                     11930000
119400                            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE 11940000
119500                            MOVE PC-TSYMSG-00148                  11950000
119600                                             TO DP020-MSG-NUMBER  11960000
119700                            SET DP020-MSG-INFORMATIONAL TO TRUE   11970000
119800                         END-IF                                   11980000
119900                      END-IF                                      11990000
120000                   END-IF                                         12000000
120100                END-IF                                            12010000
120200             END-IF                                               12020000
120300                                                                  12030000
120400         WHEN ASC-ADD-COMPLETE                                    12040000
120500             INITIALIZE ASC-SPECIFIC-COMMAREA                     12050000
120600             SET ASC-ADD-PENDING   TO TRUE                        12060000
120700             PERFORM 4000-BUILD-INITIAL-PANEL                     12070000
120800                                                                  12080000
120900         WHEN DP020-NEXT-ACT-READ-MAP                             12090000
121000             PERFORM 2000-PROCESS-PANEL                           12100000
121100                                                                  12110000
121200         WHEN DP020-NEXT-ACT-RETURN                               12120000
121300             IF ASC-UPDATE-REQUESTED OR                           12130000
121400                ASC-DELETE-REQUESTED                              12140000
121500                PERFORM 4000-BUILD-INITIAL-PANEL                  12150000
121600             ELSE                                                 12160000
121700*               INITIALIZE ASC-SPECIFIC-COMMAREA                  12170000
121800*               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              12180000
121900*NEW                                                              12190000
122000                PERFORM 1110-FIND-REFRESH-OBJECT-KEYS             12200000
122100                PERFORM 7000-EVALUATE-MULT-PSTG                   12210000
122200*NEW                                                              12220000
122300             END-IF                                               12230000
122400             MOVE -1 TO ATRANCDL                                  12240000
122500             MOVE ASC-KEY-VEND-NUMBER TO ASC-VENDOR-NUMBER        12250000
122600*            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12260000
122700             PERFORM 4000-BUILD-INITIAL-PANEL                     12270000
122800             PERFORM 3200-RESET-ATTRIBUTES                        12280000
122900             SET ASC-OTHER-RETURN TO TRUE                         12290000
123000                                                                  12300000
123100         WHEN OTHER                                               12310000
123200             SET DP013-LOGIC-ABEND                                12320000
123300                 DP013-NO-ROLLBACK TO TRUE                        12330000
123400             MOVE '1000-CONTROL-PROCESSING'                       12340000
123500                                   TO DP013-PARAGRAPH             12350000
123600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   12360000
123700                                   TO DP013-MESSAGE-TEXT(1)       12370000
123800             MOVE DP020-NEXT-APPL-ACTIVITY                        12380000
123900                                   TO DP013-MESSAGE-TEXT(2)       12390000
124000             PERFORM DP013-0000-PROCESS-ABEND                     12400000
124100     END-EVALUATE.                                                12410000
124200                                                                  12420000
124300******************************************************************12430000
124400*    DETERMINE ACTIONS FOR SCREEN ON INITIAL ENTRY.              *12440000
124500******************************************************************12450000
124600 1100-FIND-OBJECT-KEYS.                                           12460000
124700                                                                  12470000
124800     INITIALIZE ASC-SPECIFIC-COMMAREA.                            12480000
124900                                                                  12490000
125000     MOVE AP361-VND-NBR TO ASC-KEY-VEND-NUMBER.                   12500000
125100     MOVE AP361-TRN-CDE TO ASC-KEY-TRAN-CODE.                     12510000
125200                                                                  12520000
125300     IF AP361-PO-NUMB > ZERO                                      12530000
125400        MOVE AP361-PO-NUMB TO ASC-KEY-PO-NBR                      12540000
125500     END-IF.                                                      12550000
125600                                                                  12560000
125610* REMOVE ANY LEADING SPACES FROM DOC NUMBER                       12561069
125611     IF AP361-DOC-NO NOT = SPACES                                 12561169
125620         INITIALIZE              PV-START                         12562069
125630                                 PV-LENGTH                        12563069
125640         MOVE AP361-DOC-NO         TO PV-DOC-NO                   12564069
125641         INSPECT PV-DOC-NO TALLYING PV-START                      12564169
125650                        FOR LEADING SPACE                         12565069
125660         COMPUTE PV-LENGTH = 16 - PV-START                        12566069
125680         ADD 1                     TO PV-START                    12568069
125690         MOVE PV-DOC-NO(PV-START:PV-LENGTH)                       12569069
125691                                   TO AP361-DOC-NO                12569169
125692     END-IF.                                                      12569269
125700     MOVE AP361-DOC-NO     TO ASC-KEY-DOC-NUMBER.                 12570000
125800     MOVE AP361-DOC-DATE   TO ASC-KEY-DOC-DATE.                   12580000
125900     MOVE DP020-INT-APPL-FORMAT-IND                               12590000
126000                           TO ASC-INT-APPL-FORMAT-IND.            12600000
126100                                                                  12610000
126200     EVALUATE TRUE                                                12620000
126300        WHEN ASC-INTER-APPL-CRIT-UPDATE                           12630000
126400        WHEN ASC-INTER-APPL-CRIT-DELETE                           12640000
126500             IF ASC-INTER-APPL-CRIT-UPDATE                        12650000
126600                SET ASC-UPDATE-PENDING                            12660000
126700                    ASC-UPDATE-REQUESTED                          12670000
126800                               TO TRUE                            12680000
126900             ELSE                                                 12690000
127000                SET ASC-DELETE-REQUESTED TO TRUE                  12700000
127100             END-IF                                               12710000
127200                                                                  12720000
127300        WHEN ASC-INTER-APPL-LIST-UPDATE                           12730000
127400        WHEN ASC-INTER-APPL-LIST-DELETE                           12740000
127500             IF ASC-INTER-APPL-LIST-UPDATE                        12750000
127600                SET ASC-UPDATE-PENDING                            12760000
127700                    ASC-UPDATE-REQUESTED TO TRUE                  12770000
127800             ELSE                                                 12780000
127900                SET ASC-DELETE-REQUESTED TO TRUE                  12790000
128000             END-IF                                               12800000
128100             SET ASC-USE-SELECTION-QUEUE TO TRUE                  12810000
128200             MOVE AP361-NUMBER-OF-SELECTED-ITEMS                  12820000
128300                                TO ASC-NUMBER-OF-SELECTED-ITEMS   12830000
128400             MOVE AP361-NUMBER-OF-TS-ITEMS                        12840000
128500                                TO ASC-NUMBER-OF-TS-ITEMS         12850000
128600             MOVE AP361-SEL-QUEUE-NAME                            12860000
128700                                TO ASC-SEL-QUEUE-NAME             12870000
128800             PERFORM 1120-PREPARE-LIST-ENTRY                      12880000
128900                                                                  12890000
129000        WHEN ASC-INTER-APPL-ADD                                   12900000
129100             SET ASC-ADD-PENDING          TO TRUE                 12910000
129200                                                                  12920000
129300        WHEN OTHER                                                12930000
129400             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             12940000
129500             SET DP020-MSG-FATAL                                  12950000
129600                 DP020-NEXT-ACT-APPL-ERROR                        12960000
129700                 PS-ERROR                 TO TRUE                 12970000
129800     END-EVALUATE.                                                12980000
129900                                                                  12990000
130000******************************************************************13000000
130100*    DETERMINE ACTIONS FOR SCREEN ON REFRESH COMMAND.            *13010000
130200******************************************************************13020000
130300 1110-FIND-REFRESH-OBJECT-KEYS.                                   13030000
130400                                                                  13040000
130500     INITIALIZE ASC-SPECIFIC-COMMAREA.                            13050000
130600                                                                  13060000
130700     MOVE AP361-VND-NBR TO ASC-KEY-VEND-NUMBER.                   13070000
130800     MOVE AP361-TRN-CDE TO ASC-KEY-TRAN-CODE.                     13080000
130900                                                                  13090000
131000     IF AP361-PO-NUMB > ZERO                                      13100000
131100        MOVE AP361-PO-NUMB TO ASC-KEY-PO-NBR                      13110000
131200     END-IF.                                                      13120000
131300                                                                  13130000
131400     MOVE AP361-DOC-NO     TO ASC-KEY-DOC-NUMBER.                 13140000
131500     MOVE DP020-INT-APPL-FORMAT-IND                               13150000
131600                           TO ASC-INT-APPL-FORMAT-IND.            13160000
131700                                                                  13170000
131800     EVALUATE TRUE                                                13180000
131900        WHEN ASC-INTER-APPL-CRIT-UPDATE                           13190000
132000        WHEN ASC-INTER-APPL-CRIT-DELETE                           13200000
132100             IF ASC-INTER-APPL-CRIT-UPDATE                        13210000
132200                SET ASC-UPDATE-PENDING                            13220000
132300                    ASC-UPDATE-REQUESTED                          13230000
132400                               TO TRUE                            13240000
132500             ELSE                                                 13250000
132600                SET ASC-DELETE-REQUESTED TO TRUE                  13260000
132700             END-IF                                               13270000
132800                                                                  13280000
132900        WHEN ASC-INTER-APPL-LIST-UPDATE                           13290000
133000        WHEN ASC-INTER-APPL-LIST-DELETE                           13300000
133100             IF ASC-INTER-APPL-LIST-UPDATE                        13310000
133200                SET ASC-UPDATE-PENDING                            13320000
133300                    ASC-UPDATE-REQUESTED TO TRUE                  13330000
133400             ELSE                                                 13340000
133500                SET ASC-DELETE-REQUESTED TO TRUE                  13350000
133600             END-IF                                               13360000
133700             SET ASC-USE-SELECTION-QUEUE TO TRUE                  13370000
133800             MOVE AP361-NUMBER-OF-SELECTED-ITEMS                  13380000
133900                                TO ASC-NUMBER-OF-SELECTED-ITEMS   13390000
134000             MOVE AP361-NUMBER-OF-TS-ITEMS                        13400000
134100                                TO ASC-NUMBER-OF-TS-ITEMS         13410000
134200             MOVE AP361-SEL-QUEUE-NAME                            13420000
134300                                TO ASC-SEL-QUEUE-NAME             13430000
134400             PERFORM 1120-PREPARE-LIST-ENTRY                      13440000
134500                                                                  13450000
134600        WHEN ASC-INTER-APPL-ADD                                   13460000
134700             SET ASC-ADD-PENDING          TO TRUE                 13470000
134800             INITIALIZE AP361-DOC-NO                              13480000
134900                        ASC-KEY-DOC-NUMBER                        13490000
135000                                                                  13500000
135100        WHEN OTHER                                                13510000
135200             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             13520000
135300             SET DP020-MSG-FATAL                                  13530000
135400                 DP020-NEXT-ACT-APPL-ERROR                        13540000
135500                 PS-ERROR                 TO TRUE                 13550000
135600     END-EVALUATE.                                                13560000
135700                                                                  13570000
135800******************************************************************13580000
135900* ENTRY IS FROM A LIST.  GET THE FORMAT NUMBER FROM THE TEMP     *13590000
136000* STORAGE QUEUE PASSED FROM THE LIST.                            *13600000
136100******************************************************************13610000
136200 1120-PREPARE-LIST-ENTRY.                                         13620000
136300                                                                  13630000
136400     MOVE AP362-MAX-ITEMS         TO ASC-SEL-SUB.                 13640000
136500     MOVE ZERO                    TO ASC-SEL-ITEM.                13650000
136600                                                                  13660000
136700     PERFORM 2105-GET-NEXT-RECORD.                                13670000
136800                                                                  13680000
136900******************************************************************13690000
137000* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*13700000
137100* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*13710000
137200* EDITS.                                                         *13720000
137300******************************************************************13730000
137400 2000-PROCESS-PANEL.                                              13740000
137500                                                                  13750000
137600     EVALUATE TRUE                                                13760000
137700         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    13770000
137800              EVALUATE TRUE                                       13780000
137900                 WHEN ASC-DELETE-SUCCESSFUL                       13790000
138000                      MOVE PC-TSYMSG-00116                        13800000
138100                                        TO DP020-MSG-NUMBER       13810000
138200                      SET DP020-MSG-FATAL                         13820000
138300                          PS-ERROR      TO TRUE                   13830000
138400                      PERFORM 3200-RESET-ATTRIBUTES               13840000
138500                                                                  13850000
138600                 WHEN ASC-DELETE-PENDING                          13860000
138700                      IF PS-NO-ERROR                              13870000
138800                         SET DP030-CONTINUE-GO TO TRUE            13880000
138900                         PERFORM 5300-DELETE-TADJRNL              13890000
139000                         IF ASC-OFFSET-ADJ-FOUND                  13900000
139100                            PERFORM 5301-DELETE-OFFSET-TADJRNL    13910000
139200                         END-IF                                   13920000
139300                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     13930000
139400                         SET ASC-DELETE-SUCCESSFUL TO TRUE        13940000
139500                      END-IF                                      13950000
139600                                                                  13960000
139700                 WHEN OTHER                                       13970000
139800                      MOVE PC-TSYMSG-00118 TO DP020-MSG-NUMBER    13980000
139900                      SET DP020-MSG-FATAL                         13990000
140000                          PS-ERROR          TO TRUE               14000000
140100                      PERFORM 3200-RESET-ATTRIBUTES               14010000
140200              END-EVALUATE                                        14020000
140300                                                                  14030000
140400         WHEN DP020-SRC-AID = DP016-CLEAR                         14040000
140500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14050000
140600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14060000
140700                                                                  14070000
140800         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     14080000
140900             INITIALIZE ASC-SPECIFIC-COMMAREA                     14090000
141000             PERFORM 1110-FIND-REFRESH-OBJECT-KEYS                14100000
141100             IF PS-ERROR                                          14110000
141200                CONTINUE                                          14120000
141300             ELSE                                                 14130000
141400                PERFORM 7000-EVALUATE-MULT-PSTG                   14140000
141500                PERFORM 4000-BUILD-INITIAL-PANEL                  14150000
141600                PERFORM 3200-RESET-ATTRIBUTES                     14160000
141700                IF PS-NO-ERROR                                    14170000
141800                   IF ASC-DOCUMENT-FOUND                          14180000
141900                      IF ASC-DELETE-REQUESTED                     14190000
142000                         SET ASC-DELETE-PENDING TO TRUE           14200000
142100                         MOVE PC-TSYMSG-00354 TO DP020-MSG-NUMBER 14210000
142200                         SET DP020-MSG-INFORMATIONAL TO TRUE      14220000
142300                      END-IF                                      14230000
142400                   ELSE                                           14240000
142500                      IF ASC-DOCUMENT-FOUND                       14250000
142600                         IF ASC-ADD-PENDING                       14260000
142700                            IF ASC-ADD-PENDING                    14270000
142800                               CONTINUE                           14280000
142900                            ELSE                                  14290000
143000                               SET DP020-NEXT-ACT-APPL-ERROR TO   14300000
143100                                                       TRUE       14310000
143200                               MOVE PC-TSYMSG-00148 TO            14320000
143300                                              DP020-MSG-NUMBER    14330000
143400                               SET DP020-MSG-INFORMATIONAL TO TRUE14340000
143500                            END-IF                                14350000
143600                         END-IF                                   14360000
143700                      END-IF                                      14370000
143800                   END-IF                                         14380000
143900                END-IF                                            14390000
144000             END-IF                                               14400000
144100                                                                  14410000
144200         WHEN OTHER                                               14420000
144300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 14430000
144400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14440000
144500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14450000
144600             IF  PS-NO-ERROR                                      14460000
144700*                                                                 14470000
144800                 IF PS-NO-WARNING OR                              14480000
144900                    (PS-WARNING AND ASC-FUNC-REQUESTED)           14490000
145000                    INITIALIZE DP020-MSG-NUMBER                   14500000
145100                    SET DP030-CONTINUE-GO TO TRUE                 14510000
145200                    PERFORM 2100-CHECK-FUNCTION-KEY               14520000
145300                 ELSE                                             14530000
145400                    SET ASC-FUNC-REQUESTED TO TRUE                14540000
145500                    SET DP030-OVERRIDE-GO TO TRUE                 14550000
145600                 END-IF                                           14560000
145700             ELSE                                                 14570000
145800                 SET DP030-OVERRIDE-GO TO TRUE                    14580000
145900             END-IF                                               14590000
146000     END-EVALUATE.                                                14600000
146100                                                                  14610000
146200 EJECT                                                            14620000
146300******************************************************************14630000
146400** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **14640000
146500** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **14650000
146600** FROM THE CICS ARCHITECTURE API.                              **14660000
146700******************************************************************14670000
146800 2100-CHECK-FUNCTION-KEY.                                         14680000
146900                                                                  14690000
147000     EVALUATE TRUE                                                14700000
147100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14710000
147200                                                                  14720000
147300             PERFORM 5000-ADD-AP-KEY-ADJUSTMENT                   14730000
147400             SET AP363-ADD TO TRUE                                14740000
147500             PERFORM 5900-WRITE-TS-QUEUE                          14750000
147600                                                                  14760000
147700             PERFORM 2110-PREPARE-INTER-APPL-COMM                 14770000
147800                                                                  14780000
147900             SET DP030-ERASE-UNPROT TO TRUE                       14790000
148000                                                                  14800000
148100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              14810000
148200             PERFORM 5000-ADD-AP-KEY-ADJUSTMENT                   14820000
148300             SET AP363-UPDATE TO TRUE                             14830000
148400             IF ASC-USE-SELECTION-QUEUE AND                       14840000
148500                ASC-NUMBER-OF-SELECTED-ITEMS GREATER THAN ZERO    14850000
148600                MOVE +1 TO ASC-SEL-ITEM                           14860000
148700                PERFORM 5500-UPDATE-SELECTION-QUEUE               14870000
148800             END-IF                                               14880000
148900             PERFORM 5900-WRITE-TS-QUEUE                          14890000
149000             PERFORM 2110-PREPARE-INTER-APPL-COMM                 14900000
149100                                                                  14910000
149200             SET DP030-ERASE-UNPROT TO TRUE                       14920000
149300                                                                  14930000
149400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              14940000
149500             IF ASC-MULT-DIST                                     14950000
149600                PERFORM 5000-ADD-AP-KEY-ADJUSTMENT                14960000
149700                SET AP363-UPDATE TO TRUE                          14970000
149800                IF ASC-USE-SELECTION-QUEUE AND                    14980000
149900                   ASC-NUMBER-OF-SELECTED-ITEMS GREATER THAN ZERO 14990000
150000                   MOVE +1 TO ASC-SEL-ITEM                        15000000
150100                   PERFORM 5500-UPDATE-SELECTION-QUEUE            15010000
150200                END-IF                                            15020000
150300                PERFORM 5900-WRITE-TS-QUEUE                       15030000
150400                PERFORM 2110-PREPARE-INTER-APPL-COMM              15040000
150500                SET DP030-ERASE-UNPROT TO TRUE                    15050000
150600             ELSE                                                 15060000
150700                MOVE PC-TSYMSG-01932 TO DP020-MSG-NUMBER          15070000
150800                SET DP020-MSG-INFORMATIONAL TO TRUE               15080000
150900                SET DP030-OVERRIDE-GO TO TRUE                     15090000
151000             END-IF                                               15100000
151100                                                                  15110000
151200         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              15120000
151300             IF ASC-MULT-DIST AND                                 15130000
151400                NOT ASC-DELETE-SUCCESSFUL                         15140000
151500                PERFORM 5000-ADD-AP-KEY-ADJUSTMENT                15150000
151600                SET AP363-DELETE TO TRUE                          15160000
151700                IF ASC-USE-SELECTION-QUEUE AND                    15170000
151800                   ASC-NUMBER-OF-SELECTED-ITEMS GREATER THAN ZERO 15180000
151900                   MOVE +1 TO ASC-SEL-ITEM                        15190000
152000                   PERFORM 5500-UPDATE-SELECTION-QUEUE            15200000
152100                END-IF                                            15210000
152200                PERFORM 5900-WRITE-TS-QUEUE                       15220000
152300                PERFORM 2110-PREPARE-INTER-APPL-COMM              15230000
152400                SET DP030-ERASE-UNPROT TO TRUE                    15240000
152500             ELSE                                                 15250000
152600                MOVE PC-TSYMSG-01932 TO DP020-MSG-NUMBER          15260000
152700                SET DP020-MSG-INFORMATIONAL TO TRUE               15270000
152800                SET DP030-OVERRIDE-GO TO TRUE                     15280000
152900             END-IF                                               15290000
153000                                                                  15300000
153100         WHEN DP020-SRC-AID = DP016-ENTER                         15310000
153200             CONTINUE                                             15320000
153300                                                                  15330000
153400         WHEN OTHER                                               15340000
153500             SET DP013-NO-ROLLBACK                                15350000
153600                 DP013-XCTL-DISPLAY-RESTART                       15360000
153700                 DP013-CICS-ABEND  TO TRUE                        15370000
153800             MOVE '2100-CHECK-FUNCTION-KEY'                       15380000
153900                                   TO DP013-PARAGRAPH             15390000
154000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      15400000
154100                                   TO DP013-MESSAGE-TEXT (1)      15410000
154200             PERFORM DP013-0000-PROCESS-ABEND                     15420000
154300     END-EVALUATE.                                                15430000
154400 EJECT                                                            15440000
154500******************************************************************15450000
154600* GET NEXT RECORD FROM STORAGE QUEUE.                            *15460000
154700******************************************************************15470000
154800 2105-GET-NEXT-RECORD.                                            15480000
154900                                                                  15490000
155000     ADD +1                        TO ASC-SEL-SUB.                15500000
155100                                                                  15510000
155200     IF ASC-SEL-SUB > AP362-MAX-ITEMS                             15520000
155300        ADD +1                     TO ASC-SEL-ITEM                15530000
155400        MOVE +1                    TO ASC-SEL-SUB                 15540000
155500     END-IF.                                                      15550000
155600                                                                  15560000
155700     EVALUATE TRUE                                                15570000
155800        WHEN ASC-INTER-APPL-LIST-UPDATE                           15580000
155900        WHEN ASC-INTER-APPL-LIST-DELETE                           15590000
156000             IF ASC-INTER-APPL-LIST-UPDATE                        15600000
156100                SET ASC-UPDATE-PENDING                            15610000
156200                    ASC-UPDATE-REQUESTED                          15620000
156300                                   TO TRUE                        15630000
156400             ELSE                                                 15640000
156500                SET ASC-DELETE-REQUESTED                          15650000
156600                                   TO TRUE                        15660000
156700             END-IF                                               15670000
156800                                                                  15680000
156900        WHEN OTHER                                                15690000
157000             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             15700000
157100             SET DP020-MSG-FATAL                                  15710000
157200                 DP020-NEXT-ACT-APPL-ERROR                        15720000
157300                 PS-ERROR           TO TRUE                       15730000
157400     END-EVALUATE.                                                15740000
157500                                                                  15750000
157600     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 15760000
157700        PERFORM 9100-READ-SEL-QUEUE                               15770000
157800        IF AP362-ITEM (ASC-SEL-SUB) > ZERO                        15780000
157900           MOVE AP362-VND-NBR     (ASC-SEL-SUB)                   15790000
158000                                  TO ASC-KEY-VEND-NUMBER          15800000
158100           MOVE AP362-DOC-NO      (ASC-SEL-SUB)                   15810000
158200                                  TO ASC-KEY-DOC-NUMBER           15820000
158300           MOVE AP362-TRN-CDE     (ASC-SEL-SUB)                   15830000
158400                                  TO ASC-KEY-TRAN-CODE            15840000
158500           MOVE AP362-DOC-DTE     (ASC-SEL-SUB)                   15850000
158600                                  TO ASC-KEY-DOC-DATE             15860000
158700           IF AP362-ACTION-SW     (ASC-SEL-SUB) > SPACES          15870000
158800              CONTINUE                                            15880000
158900           ELSE                                                   15890000
159000              SET AP362-INQ       (ASC-SEL-SUB) TO TRUE           15900000
159100              PERFORM 9200-REWRITE-LIST-QUEUE                     15910000
159200           END-IF                                                 15920000
159300        ELSE                                                      15930000
159400           SUBTRACT +1 FROM ASC-SEL-SUB                           15940000
159500           MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER          15950000
159600           SET DP020-MSG-INFORMATIONAL                            15960000
159700                                  TO TRUE                         15970000
159800        END-IF                                                    15980000
159900     ELSE                                                         15990000
160000        SUBTRACT +1 FROM ASC-SEL-ITEM                             16000000
160100        MOVE AP362-MAX-ITEMS         TO ASC-SEL-SUB               16010000
160200        MOVE PC-TSYMSG-00070         TO DP020-MSG-NUMBER          16020000
160300        SET DP020-MSG-INFORMATIONAL  TO TRUE                      16030000
160400     END-IF.                                                      16040000
160500                                                                  16050000
160600******************************************************************16060000
160700** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **16070000
160800** INTER-APPLICATION COMMAREA.                                  **16080000
160900******************************************************************16090000
161000 2110-PREPARE-INTER-APPL-COMM.                                    16100000
161100                                                                  16110000
161200     MOVE ASC-KEY-VEND-NUMBER      TO AP361-VND-NBR.              16120000
161300     MOVE ASC-KEY-DOC-NUMBER       TO AP361-DOC-NO.               16130000
161400     MOVE ASC-KEY-DOC-DATE         TO AP361-DOC-DATE.             16140000
161500     MOVE ASC-KEY-TRAN-CODE        TO AP361-TRN-CDE.              16150000
161600                                                                  16160000
161700******************************************************************16170000
161800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*16180000
161900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *16190000
162000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *16200000
162100******************************************************************16210000
162200 2200-MOVE-SCREEN-TO-COMMAREA.                                    16220000
162300                                                                  16230000
162400     IF  ATRANCDL > ZERO                                          16240000
162500         MOVE ATRANCDI             TO ASC-TRAN-CD                 16250000
162600     ELSE                                                         16260000
162700         IF  ATRANCDF = DP015-ERASE-EOF                           16270000
162800             MOVE SPACE            TO ASC-TRAN-CD                 16280000
162900         END-IF                                                   16290000
163000     END-IF.                                                      16300000
163100                                                                  16310000
163200     IF  ADOCNUML > ZERO                                          16320000
163201         INITIALIZE              PV-START                         16320162
163204                                 PV-LENGTH                        16320462
163210         INSPECT ADOCNUMI TALLYING PV-START                       16321062
163220                        FOR LEADING SPACE                         16322062
163230         COMPUTE PV-LENGTH = ADOCNUML - PV-START                  16323062
163231         MOVE PV-LENGTH            TO ADOCNUML                    16323162
163232         ADD 1                     TO PV-START                    16323262
163240         MOVE ADOCNUMI(PV-START:PV-LENGTH)                        16324062
163241                                   TO ASC-DOC-NUMBER              16324162
163300*        MOVE ADOCNUMI             TO ASC-DOC-NUMBER              16330062
163400     ELSE                                                         16340000
163500         IF  ADOCNUMF = DP015-ERASE-EOF                           16350000
163600             MOVE SPACE            TO ASC-DOC-NUMBER              16360000
163700         END-IF                                                   16370000
163800     END-IF.                                                      16380000
163900                                                                  16390000
164000     IF  AVENDNOL > ZERO                                          16400000
164100         MOVE AVENDNOI             TO ASC-VENDOR-NUMBER           16410000
164200     ELSE                                                         16420000
164300         IF  AVENDNOF = DP015-ERASE-EOF                           16430000
164400             MOVE SPACE            TO ASC-VENDOR-NUMBER           16440000
164500         END-IF                                                   16450000
164600     END-IF.                                                      16460000
164700                                                                  16470000
164800     IF  APONUML > ZERO                                           16480000
164900         MOVE APONUMI              TO ASC-ALP-PO-NBR              16490000
165000     ELSE                                                         16500000
165100         IF  APONUMF = DP015-ERASE-EOF                            16510000
165200             MOVE SPACE            TO ASC-ALP-PO-NBR              16520000
165300         END-IF                                                   16530000
165400     END-IF.                                                      16540000
165500                                                                  16550000
165600     IF  ABARCDL > ZERO                                           16560000
165700         MOVE ABARCDI             TO ASC-BARCODE                  16570000
165800     ELSE                                                         16580000
165900         IF  ABARCDF = DP015-ERASE-EOF                            16590000
166000             MOVE SPACE            TO ASC-BARCODE                 16600000
166100         END-IF                                                   16610000
166200     END-IF.                                                      16620000
166300                                                                  16630000
166400     IF  ASTRNML > ZERO                                           16640000
166500         MOVE ASTRNMI             TO ASC-ALP-STORE-NBR            16650000
166600     ELSE                                                         16660000
166700         IF  ASTRNMF = DP015-ERASE-EOF                            16670000
166800             MOVE SPACE            TO ASC-ALP-STORE-NBR           16680000
166900         END-IF                                                   16690000
167000     END-IF.                                                      16700000
167100                                                                  16710000
167200     IF  AOFFBYPL > ZERO                                          16720000
167300         MOVE AOFFBYPI             TO ASC-OFFSET-BYPASS-IND       16730000
167400     ELSE                                                         16740000
167500         IF  AOFFBYPF = DP015-ERASE-EOF                           16750000
167600             MOVE SPACE            TO ASC-OFFSET-BYPASS-IND       16760000
167700         END-IF                                                   16770000
167800     END-IF.                                                      16780000
167900                                                                  16790000
168000     IF  AOFFACTL > ZERO                                          16800000
168100         MOVE AOFFACTI             TO ASC-OFFSET-ACCT-NO          16810000
168200     ELSE                                                         16820000
168300         IF  AOFFACTF = DP015-ERASE-EOF                           16830000
168400             MOVE SPACE            TO ASC-OFFSET-ACCT-NO          16840000
168500         END-IF                                                   16850000
168600     END-IF.                                                      16860000
168700                                                                  16870000
168800     IF  ADOCMML > ZERO                                           16880000
168900         MOVE ADOCMMI             TO ASC-DOC-DATE-MM              16890000
169000     ELSE                                                         16900000
169100         IF  ADOCMMF = DP015-ERASE-EOF                            16910000
169200             MOVE SPACE            TO ASC-DOC-DATE-MM             16920000
169300         END-IF                                                   16930000
169400     END-IF.                                                      16940000
169500                                                                  16950000
169600     IF  ADOCDDL > ZERO                                           16960000
169700         MOVE ADOCDDI              TO ASC-DOC-DATE-DD             16970000
169800     ELSE                                                         16980000
169900         IF  ADOCDDF = DP015-ERASE-EOF                            16990000
170000             MOVE SPACE            TO ASC-DOC-DATE-DD             17000000
170100         END-IF                                                   17010000
170200     END-IF.                                                      17020000
170300                                                                  17030000
170400     IF  ADOCYYL > ZERO                                           17040000
170500         MOVE ADOCYYI             TO ASC-DOC-DATE-YY              17050000
170600     ELSE                                                         17060000
170700         IF  ADOCYYF = DP015-ERASE-EOF                            17070000
170800             MOVE SPACE            TO ASC-DOC-DATE-YY             17080000
170900         END-IF                                                   17090000
171000     END-IF.                                                      17100000
171100                                                                  17110000
171200     IF  ADEPTL > ZERO                                            17120000
171300         MOVE ADEPTI               TO ASC-DEPARTMENT              17130000
171400     ELSE                                                         17140000
171500         IF  ADEPTF = DP015-ERASE-EOF                             17150000
171600             MOVE SPACE            TO ASC-DEPARTMENT              17160000
171700         END-IF                                                   17170000
171800     END-IF.                                                      17180000
171900                                                                  17190000
172000     IF  AACCNOL > ZERO                                           17200000
172100         MOVE AACCNOI              TO ASC-ACCT-NO                 17210000
172200     ELSE                                                         17220000
172300         IF  AACCNOF = DP015-ERASE-EOF                            17230000
172400             MOVE SPACE            TO ASC-ACCT-NO                 17240000
172500         END-IF                                                   17250000
172600     END-IF.                                                      17260000
172700                                                                  17270000
172800     IF  AVENDAL > ZERO                                           17280000
172900         MOVE AVENDAI              TO ASC-VENDOR-AUTH             17290000
173000     ELSE                                                         17300000
173100         IF  AVENDAF = DP015-ERASE-EOF                            17310000
173200             MOVE SPACE            TO ASC-VENDOR-AUTH             17320000
173300         END-IF                                                   17330000
173400     END-IF.                                                      17340000
173500                                                                  17350000
173600     IF  AGRCSTL > ZERO                                           17360000
173700         MOVE AGRCSTI              TO ASC-ALP-GROSS-COST          17370000
173800     ELSE                                                         17380000
173900         IF  AGRCSTF = DP015-ERASE-EOF                            17390000
174000            MOVE SPACE             TO ASC-ALP-GROSS-COST          17400000
174100         END-IF                                                   17410000
174200     END-IF.                                                      17420000
174300                                                                  17430000
174400     IF  ARETCSTL > ZERO                                          17440000
174500         MOVE ARETCSTI             TO ASC-ALP-RET-COST            17450000
174600     ELSE                                                         17460000
174700         IF  ARETCSTF = DP015-ERASE-EOF                           17470000
174800             MOVE SPACE            TO ASC-ALP-RET-COST            17480000
174900         END-IF                                                   17490000
175000     END-IF.                                                      17500000
175100                                                                  17510000
175200     IF  AFRAMTL > ZERO                                           17520000
175300         MOVE AFRAMTI              TO ASC-ALP-FREIGHT-COST        17530000
175400     ELSE                                                         17540000
175500         IF  AFRAMTF = DP015-ERASE-EOF                            17550000
175600             MOVE SPACE            TO ASC-ALP-FREIGHT-COST        17560000
175700         END-IF                                                   17570000
175800     END-IF.                                                      17580000
175900                                                                  17590000
176000     IF  AMISCL > ZERO                                            17600000
176100         MOVE AMISCI               TO ASC-ALP-MISC-CHG            17610000
176200     ELSE                                                         17620000
176300         IF  AMISCF = DP015-ERASE-EOF                             17630000
176400             MOVE SPACE            TO ASC-ALP-MISC-CHG            17640000
176500         END-IF                                                   17650000
176600     END-IF.                                                      17660000
176700                                                                  17670000
176800     IF  ADISCPCL > ZERO                                          17680000
176900         MOVE ADISCPCI             TO ASC-ALP-DISC-PCT            17690000
177000     ELSE                                                         17700000
177100         IF  ADISCPCF = DP015-ERASE-EOF                           17710000
177200             MOVE SPACE            TO ASC-ALP-DISC-PCT            17720000
177300         END-IF                                                   17730000
177400     END-IF.                                                      17740000
177500                                                                  17750000
177600     IF  AMOSPCL > ZERO                                           17760000
177700         MOVE AMOSPCI              TO ASC-ALP-MOS-PCT             17770000
177800     ELSE                                                         17780000
177900         IF  AMOSPCF = DP015-ERASE-EOF                            17790000
178000             MOVE SPACE            TO ASC-ALP-MOS-PCT             17800000
178100         END-IF                                                   17810000
178200     END-IF.                                                      17820000
178300                                                                  17830000
178400     IF  ANSTRPCL > ZERO                                          17840000
178500         MOVE ANSTRPCI             TO ASC-ALP-NEW-STR-PCT         17850000
178600     ELSE                                                         17860000
178700         IF  ANSTRPCF = DP015-ERASE-EOF                           17870000
178800             MOVE SPACE            TO ASC-ALP-NEW-STR-PCT         17880000
178900         END-IF                                                   17890000
179000     END-IF.                                                      17900000
179100                                                                  17910000
179200     IF  ANSTRAML > ZERO                                          17920000
179300         MOVE ANSTRAMI             TO ASC-ALP-NEW-STR-AMT         17930000
179400     ELSE                                                         17940000
179500         IF  ANSTRAMF = DP015-ERASE-EOF                           17950000
179600             MOVE SPACE            TO ASC-ALP-NEW-STR-AMT         17960000
179700         END-IF                                                   17970000
179800     END-IF.                                                      17980000
179900                                                                  17990000
180000     IF  AHOLDL > ZERO                                            18000000
180100         MOVE AHOLDI               TO ASC-HOLD-STATUS             18010000
180200     ELSE                                                         18020000
180300         IF  AHOLDF = DP015-ERASE-EOF                             18030000
180400             MOVE SPACE            TO ASC-HOLD-STATUS             18040000
180500         END-IF                                                   18050000
180600     END-IF.                                                      18060000
180700                                                                  18070000
180800     IF  ATRADPCL > ZERO                                          18080000
180900         MOVE ATRADPCI             TO ASC-ALP-TRADE-PCT           18090000
181000     ELSE                                                         18100000
181100         IF  ATRADPCF = DP015-ERASE-EOF                           18110000
181200             MOVE SPACE            TO ASC-ALP-TRADE-PCT           18120000
181300         END-IF                                                   18130000
181400     END-IF.                                                      18140000
181500                                                                  18150000
181600     IF  ADUEMML > ZERO                                           18160000
181700         MOVE ADUEMMI              TO ASC-DUE-DATE-MM             18170000
181800     ELSE                                                         18180000
181900         IF  ADUEMMF = DP015-ERASE-EOF                            18190000
182000             MOVE SPACE            TO ASC-DUE-DATE-MM             18200000
182100         END-IF                                                   18210000
182200     END-IF.                                                      18220000
182300                                                                  18230000
182400     IF  ADUEDDL > ZERO                                           18240000
182500         MOVE ADUEDDI              TO ASC-DUE-DATE-DD             18250000
182600     ELSE                                                         18260000
182700         IF  ADUEDDF = DP015-ERASE-EOF                            18270000
182800             MOVE SPACE            TO ASC-DUE-DATE-DD             18280000
182900         END-IF                                                   18290000
183000     END-IF.                                                      18300000
183100                                                                  18310000
183200     IF  ADUEYYL > ZERO                                           18320000
183300         MOVE ADUEYYI              TO ASC-DUE-DATE-YY             18330000
183400     ELSE                                                         18340000
183500         IF  ADUEYYF = DP015-ERASE-EOF                            18350000
183600             MOVE SPACE            TO ASC-DUE-DATE-YY             18360000
183700         END-IF                                                   18370000
183800     END-IF.                                                      18380000
183900                                                                  18390000
184000     IF  AAPLMTHL > ZERO                                          18400000
184100         MOVE AAPLMTHI            TO ASC-APPL-MTH                 18410000
184200     ELSE                                                         18420000
184300         IF  AAPLMTHF = DP015-ERASE-EOF                           18430000
184400             MOVE SPACE            TO ASC-APPL-MTH                18440000
184500         END-IF                                                   18450000
184600     END-IF.                                                      18460000
184700                                                                  18470000
184800     IF  AREAS1L > ZERO                                           18480000
184900         MOVE AREAS1I              TO ASC-REASON-CODE1            18490000
185000     ELSE                                                         18500000
185100         IF  AREAS1F = DP015-ERASE-EOF                            18510000
185200             MOVE SPACE            TO ASC-REASON-CODE1            18520000
185300         END-IF                                                   18530000
185400     END-IF.                                                      18540000
185500                                                                  18550000
185600     IF  AREAS2L > ZERO                                           18560000
185700         MOVE AREAS2I              TO ASC-REASON-CODE2            18570000
185800     ELSE                                                         18580000
185900         IF  AREAS2F = DP015-ERASE-EOF                            18590000
186000             MOVE SPACE            TO ASC-REASON-CODE2            18600000
186100         END-IF                                                   18610000
186200     END-IF.                                                      18620000
186300                                                                  18630000
186400     IF  ASTR01L > ZERO                                           18640000
186500         MOVE ASTR01I              TO ASC-ALP-DET-STORE           18650000
186600     ELSE                                                         18660000
186700         IF  ASTR01F = DP015-ERASE-EOF                            18670000
186800             MOVE SPACE            TO ASC-ALP-DET-STORE           18680000
186900         END-IF                                                   18690000
187000     END-IF.                                                      18700000
187100                                                                  18710000
187200     IF  ACLS01L > ZERO                                           18720000
187300         MOVE ACLS01I              TO ASC-DET-CLASS               18730000
187400     ELSE                                                         18740000
187500         IF  ACLS01F = DP015-ERASE-EOF                            18750000
187600             MOVE SPACE            TO ASC-DET-CLASS               18760000
187700         END-IF                                                   18770000
187800     END-IF.                                                      18780000
187900                                                                  18790000
188000     IF  ASKU01L > ZERO                                           18800000
188100         MOVE ASKU01I              TO ASC-ALP-DET-SKU             18810000
188200     ELSE                                                         18820000
188300         IF  ASKU01F = DP015-ERASE-EOF                            18830000
188400             MOVE SPACE            TO ASC-ALP-DET-SKU             18840000
188500         END-IF                                                   18850000
188600     END-IF.                                                      18860000
188700                                                                  18870000
188800     IF  ACST01L > ZERO                                           18880000
188900         MOVE ACST01I              TO ASC-ALP-DET-COST            18890000
189000     ELSE                                                         18900000
189100         IF  ACST01F = DP015-ERASE-EOF                            18910000
189200             MOVE SPACE            TO ASC-ALP-DET-COST            18920000
189300         END-IF                                                   18930000
189400     END-IF.                                                      18940000
189500                                                                  18950000
189600     IF  ARET01L > ZERO                                           18960000
189700         MOVE ARET01I              TO ASC-ALP-DET-RETL            18970000
189800     ELSE                                                         18980000
189900         IF  ARET01F = DP015-ERASE-EOF                            18990000
190000             MOVE SPACE            TO ASC-ALP-DET-RETL            19000000
190100         END-IF                                                   19010000
190200     END-IF.                                                      19020000
190300                                                                  19030000
190400******************************************************************19040000
190500* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *19050000
190600* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *19060000
190700* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *19070000
190800******************************************************************19080000
190900 3000-EDIT-DATA-IN-COMMAREA.                                      19090000
191000                                                                  19100000
191100     PERFORM 3200-RESET-ATTRIBUTES.                               19110000
191200                                                                  19120000
191300     IF DP020-SRC-AID = DP016-PF16                                19130000
191400        CONTINUE                                                  19140000
191500     ELSE                                                         19150000
191600** THERE ARE INDIVIDUAL IF STATEMENTS CONCERNING IF AN ADD        19160000
191700** IS PENDING SO THE ORDER OF THE EDITS CAN BE PRESERVED.         19170000
191800** THIS WAY THE FIELDS WILL BE EDITED IN THE ORDER THAT           19180000
191900** THEY APPEAR ON THE SCREEN TOP TO BOTTOM AND LEFT TO            19190000
192000** RIGHT.                                                         19200000
192100* 10-25 IF ASC-ADD-PENDING                                        19210000
192200* 10-25    PERFORM 3010-EDIT-DOC-NUMBER                           19220000
192300* 10-25 END-IF                                                    19230000
192400        PERFORM 3015-EDIT-TRAN-CD                                 19240000
192500        PERFORM 3017-EDIT-PO                                      19250000
192600        IF ASC-ADD-PENDING                                        19260000
192700           PERFORM 3020-EDIT-VEND-NO                              19270000
192800           MOVE EXTENT-ENT-ID     TO ASC-ENT-ID                   19280000
192900           MOVE ENTNME-ENT-NAME-DESC TO ASC-VENDOR-NAME           19290000
193000* ADDED NEXT LINE 10-25                                           19300000
193100           PERFORM 3010-EDIT-DOC-NUMBER                           19310000
193200        ELSE                                                      19320000
193300           IF ASC-UPDATE-REQUESTED                                19330000
193400              PERFORM 3022-EDIT-PO-VEND-IN-UPD                    19340000
193500           END-IF                                                 19350000
193600        END-IF                                                    19360000
193700*       IF NOT ASC-DELETE-REQUESTED AND                           19370071
193800*          NOT ASC-DELETE-PENDING                                 19380071
193900*          PERFORM 3030-EDIT-BARCODE                              19390071
194000*       END-IF                                                    19400071
194100        PERFORM 3040-EDIT-STORE                                   19410000
194200        IF ASC-ADD-PENDING                                        19420000
194300           PERFORM 3050-EDIT-DOC-DATE                             19430000
194400        END-IF                                                    19440000
194500        PERFORM 3060-EDIT-DEPARTMENT                              19450000
194600        PERFORM 3070-EDIT-ACCOUNT                                 19460000
194700        PERFORM 3080-EDIT-GROSS-COST                              19470000
194800        PERFORM 3090-EDIT-RETAIL-COST                             19480000
194900        PERFORM 3300-EDIT-FREIGHT-AMT                             19490000
195000        PERFORM 3310-EDIT-MISC-CHG                                19500000
195100        PERFORM 3330-EDIT-NEW-STR-PCT                             19510000
195200        PERFORM 3315-EDIT-DOLLAR-FIELD-COMBO                      19520000
195300        PERFORM 3320-EDIT-DISC-PCT                                19530000
195400        PERFORM 3325-EDIT-MOS-PCT                                 19540000
195500        PERFORM 3340-EDIT-HOLD-STATUS                             19550000
195600        PERFORM 3350-EDIT-TRADE-PCT                               19560000
195700        PERFORM 3355-CALCULATE-NET-AMT                            19570000
195800        PERFORM 3150-EDIT-DUE-DATE                                19580000
195900        IF ASC-ADD-PENDING                                        19590000
196000           PERFORM 3170-EDIT-C-P-FLAG                             19600000
196100        END-IF                                                    19610000
196200        PERFORM 3160-EDIT-REASON-TEXTS                            19620000
196300        PERFORM 3180-EDIT-DISTRO-STORE                            19630000
196400        PERFORM 3360-EDIT-DISTRO-CLS-SEQ                          19640000
196500        PERFORM 3370-EDIT-DISTRO-COST                             19650000
196600        PERFORM 3390-CALC-DISTRO-RETAIL                           19660000
196700        PERFORM 3380-EDIT-DISTRO-RETAIL                           19670000
196800        PERFORM 3385-CALC-MARKON-PERCENTAGE                       19680000
196900        IF ASC-ADD-PENDING OR                                     19690000
197000          ((ASC-UPDATE-PENDING OR                                 19700000
197100            (ASC-DELETE-REQUESTED AND                             19710000
197200             NOT ASC-DELETE-SUCCESSFUL)) AND                      19720000
197300            ASC-SINGLE-DIST)                                      19730000
197400           PERFORM 3395-CALC-DISTRO-NET                           19740000
197500        END-IF                                                    19750000
197600        IF ASC-ADD-PENDING                                        19760000
197700           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    19770000
197800        END-IF                                                    19780000
197900        SET ASC-COST-NOT-MATCH TO TRUE                            19790000
198000        SET ASC-RETAIL-NOT-MATCH TO TRUE                          19800000
198100        PERFORM 3400-CHECK-DOLLAR-AMOUNTS                         19810000
198200        IF ASC-UPDATE-PENDING AND                                 19820000
198300           ASC-SINGLE-DIST                                        19830000
198400           IF ASC-COST-NOT-MATCH                                  19840000
198500              SET DP020-MSG-FATAL        TO TRUE                  19850000
198600              MOVE DP015-UNP-ALP-BRT-OFF TO AGRCSTA               19860000
198700                                            ACST01A               19870000
198800              MOVE DP015-RED             TO AGRCSTC               19880000
198900                                            ACST01C               19890000
199000              MOVE DP015-REVERSE         TO AGRCSTH               19900000
199100                                            ACST01H               19910000
199200              MOVE -1                    TO AGRCSTL               19920000
199300                                            ACST01L               19930000
199400              IF PS-NO-ERROR                                      19940000
199500                 MOVE PC-TSYMSG-01931    TO DP020-MSG-NUMBER      19950000
199600              END-IF                                              19960000
199700              SET PS-ERROR TO TRUE                                19970000
199800           ELSE                                                   19980000
199900              IF ASC-RETAIL-NOT-MATCH                             19990000
200000                 MOVE DP015-UNP-ALP-BRT-OFF TO ARETCSTA           20000000
200100                                               ARET01A            20010000
200200                 MOVE DP015-RED          TO ARETCSTC              20020000
200300                                            ARET01C               20030000
200400                 MOVE DP015-REVERSE      TO ARETCSTH              20040000
200500                                            ARET01H               20050000
200600                 MOVE -1                 TO ARETCSTL              20060000
200700                 IF PS-NO-ERROR                                   20070000
200800                    MOVE PC-TSYMSG-01930 TO DP020-MSG-NUMBER      20080000
200900                 END-IF                                           20090000
201000                 SET PS-ERROR TO TRUE                             20100000
201100              END-IF                                              20110000
201200           END-IF                                                 20120000
201300        END-IF                                                    20130000
201400        IF ASC-ADD-PENDING                                        20140000
201500           PERFORM 3041-CHECK-FOR-OFFSET-TRANCD                   20150000
201600           IF ASC-OFFSET-TC-FOUND                                 20160000
201700              PERFORM 3043-CREATE-OFFSET-DOC-NBR                  20170000
201800              PERFORM 3044-CHECK-FOR-OFFSET-ACCTNO                20180000
201900              PERFORM 3045-EDIT-OFFSET-BYPASS-IND                 20190000
202000           ELSE                                                   20200000
202100              MOVE SPACE                 TO ASC-OFFSET-TRAN-CD    20210000
202200                                            ASC-OFFSET-ACCT-NO    20220000
202300              MOVE DP015-PRO-NOR-OFF     TO AOFFBYPA              20230000
202400                                            AOFFACTA              20240000
202500              MOVE DP015-BLUE            TO AOFFBYPC              20250000
202600                                            AOFFACTC              20260000
202700              MOVE DP015-HL-OFF          TO AOFFBYPH              20270000
202800                                            AOFFACTH              20280000
202900           END-IF                                                 20290000
203000        END-IF                                                    20300000
203100     END-IF.                                                      20310000
203200                                                                  20320000
203300     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         20330000
203400                                                                  20340000
203500     IF PS-NO-ERROR                                               20350000
203600        AND ASC-OFFSET-TC-NOT-FOUND                               20360000
203700        MOVE -1            TO ATRANCDL                            20370000
203800     END-IF.                                                      20380000
203900                                                                  20390000
204000******************************************************************20400000
204100* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED DOCUMENT      *20410000
204200* NUMBER.                                                        *20420000
204300******************************************************************20430000
204400 3010-EDIT-DOC-NUMBER.                                            20440000
204500                                                                  20450000
204600     IF ASC-DOC-NUMBER = SPACES                                   20460000
204700        SET ASC-NO-DUP-DOC TO TRUE                                20470000
204800        MOVE ASC-VENDOR-NUMBER TO WS364-VENDOR-NBR                20480000
204900        PERFORM 4500-GET-NEXT-DOC-NO                              20490000
205000        MOVE WS364-NEXT-DOC-NBR   TO ASC-DOC-NUMBER               20500000
205100     ELSE                                                         20510000
205200        PERFORM 4600-VALIDATE-UNIQUE-DOC                          20520000
205300     END-IF.                                                      20530000
205400                                                                  20540000
205500** IF THE ENTERED DOCUMENT NUMBER ALREADY EXISTS IN THE ADJUSTMENT20550000
205600** JOURNAL THEN AN ERROR IS PRODUCED.  DOCUMENT NUMBER MUST BE    20560000
205700** UNIQUE FOR A VENDOR.                                           20570000
205800     IF ASC-DUP-DOC                                               20580000
205900         SET DP020-MSG-FATAL TO TRUE                              20590000
206000         MOVE DP015-UNP-ALP-BRT-OFF TO ADOCNUMA                   20600000
206100         MOVE DP015-RED             TO ADOCNUMC                   20610000
206200         MOVE DP015-REVERSE         TO ADOCNUMH                   20620000
206300         MOVE -1                    TO ADOCNUML                   20630000
206400         IF PS-NO-ERROR                                           20640000
206500             MOVE PC-TSYMSG-01919   TO DP020-MSG-NUMBER           20650000
206600         END-IF                                                   20660000
206700         SET PS-ERROR               TO TRUE                       20670000
206800     END-IF.                                                      20680000
206900                                                                  20690000
207000******************************************************************20700000
207100* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED TRANSACTION   *20710000
207200* CODE.                                                          *20720000
207300******************************************************************20730000
207400 3015-EDIT-TRAN-CD.                                               20740000
207500                                                                  20750000
207600     IF ASC-TRAN-CD = SPACES                                      20760000
207700        SET DP020-MSG-FATAL        TO TRUE                        20770000
207800        MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA                    20780000
207900        MOVE DP015-RED             TO ATRANCDC                    20790000
208000        MOVE DP015-REVERSE         TO ATRANCDH                    20800000
208100        MOVE -1                    TO ATRANCDL                    20810000
208200        IF PS-NO-ERROR                                            20820000
208300           MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER            20830000
208400        END-IF                                                    20840000
208500        SET PS-ERROR               TO TRUE                        20850000
208600     ELSE                                                         20860000
208700        PERFORM 4700-VALIDATE-TRAN-CD                             20870000
208800        MOVE TRNCDE-RSN-TXT-REQR-IND TO ASC-TXT-REQR-IND          20880000
208900        MOVE TRNCDE-TRN-TYP-CDE TO ASC-TRN-TYP-CDE                20890000
209000        MOVE TRNCDE-FRGT-REQR-IND TO ASC-FRGT-REQR-IND            20900000
209100        MOVE TRNCDE-COST-PRCCTL-CDE TO ASC-COST-PRCCTL-CDE        20910000
209200        MOVE TRNCDE-AP-PSTG-IND TO ASC-AP-PSTG-IND                20920000
209300        MOVE TRNCDE-RTL-PRCCTL-CDE TO ASC-RTL-PRCCTL-CDE          20930000
209400        MOVE TRNCDE-PSTG-TYP-CDE TO ASC-PSTG-TYP-CDE              20940000
209500        MOVE TRNCDE-SKU-SEQ-REQR-IND TO ASC-SKU-SEQ-REQR-IND      20950000
209600        MOVE TRNCDE-SUB-CL-REQR-IND TO ASC-SUB-CL-REQR-IND        20960000
209700     END-IF.                                                      20970000
209800                                                                  20980000
209900     IF ASC-TRAN-CDE-NOT-FND                                      20990000
210000        SET DP020-MSG-FATAL        TO TRUE                        21000000
210100        MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA                    21010000
210200        MOVE DP015-RED             TO ATRANCDC                    21020000
210300        MOVE DP015-REVERSE         TO ATRANCDH                    21030000
210400        MOVE -1                    TO ATRANCDL                    21040000
210500        IF PS-NO-ERROR                                            21050000
210600           MOVE PC-TSYMSG-01899    TO DP020-MSG-NUMBER            21060000
210700        END-IF                                                    21070000
210800        SET PS-ERROR               TO TRUE                        21080000
210900     ELSE                                                         21090000
211000        IF TRNCDE-TRN-SRC-CDE NOT = 'A' AND                       21100000
211100           TRNCDE-TRN-SRC-CDE NOT = 'O'                           21110000
211200           SET DP020-MSG-FATAL        TO TRUE                     21120000
211300           MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA                 21130000
211400           MOVE DP015-RED             TO ATRANCDC                 21140000
211500           MOVE DP015-REVERSE         TO ATRANCDH                 21150000
211600           MOVE -1                    TO ATRANCDL                 21160000
211700           IF PS-NO-ERROR                                         21170000
211800              MOVE PC-TSYMSG-01899    TO DP020-MSG-NUMBER         21180000
211900           END-IF                                                 21190000
212000           SET PS-ERROR               TO TRUE                     21200000
212100        ELSE                                                      21210000
212200           MOVE TRNCDE-AP-TRN-CDE TO PV-TRAN-CDE-APPL-CDE         21220000
212300           MOVE ASC-VENDOR-NUMBER TO EXTENT-DUN-NBR               21230000
212400           EVALUATE TRUE                                          21240000
212500              WHEN PV-TRANSFER-TRAN-CODE                          21250000
212600               AND ASC-ADD-PENDING                                21260000
212700                   SET DP020-MSG-FATAL     TO TRUE                21270000
212800                   MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA         21280000
212900                   MOVE DP015-RED          TO ATRANCDC            21290000
213000                   MOVE DP015-REVERSE      TO ATRANCDH            21300000
213100                   MOVE -1                 TO ATRANCDL            21310000
213200                   IF PS-NO-ERROR                                 21320000
213300                      MOVE PC-TSYMSG-01940 TO DP020-MSG-NUMBER    21330000
213400                   END-IF                                         21340000
213500                   SET PS-ERROR            TO TRUE                21350000
213600              WHEN PV-BROADCAST-MDS-TRAN-CODE                     21360000
213700                   PERFORM 4750-VALIDATE-VNDDPT-AGREEMENT         21370000
213800                   IF AGR-NOT-FOUND                               21380000
213900                      SET DP020-MSG-FATAL     TO TRUE             21390000
214000                      MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA      21400000
214100                      MOVE DP015-RED          TO ATRANCDC         21410000
214200                      MOVE DP015-REVERSE      TO ATRANCDH         21420000
214300                      MOVE -1                 TO ATRANCDL         21430000
214400                      IF PS-NO-ERROR                              21440000
214500                         MOVE PC-TSYMSG-03346 TO DP020-MSG-NUMBER 21450000
214600                      END-IF                                      21460000
214700                      SET PS-ERROR            TO TRUE             21470000
214800                   END-IF                                         21480000
214900              WHEN PV-BROADCAST-EXP-TRAN-CODE                     21490000
215000                   PERFORM 4770-VALIDATE-BRDCAST-VENDOR           21500000
215100                   IF AGR-NOT-FOUND                               21510000
215200                      SET DP020-MSG-FATAL     TO TRUE             21520000
215300                      MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA      21530000
215400                      MOVE DP015-RED          TO ATRANCDC         21540000
215500                      MOVE DP015-REVERSE      TO ATRANCDH         21550000
215600                      MOVE -1                 TO ATRANCDL         21560000
215700                      IF PS-NO-ERROR                              21570000
215800                         MOVE PC-TSYMSG-03347 TO DP020-MSG-NUMBER 21580000
215900                      END-IF                                      21590000
216000                      SET PS-ERROR            TO TRUE             21600000
216100                   END-IF                                         21610000
216200              WHEN PV-BRIDAL-TRAN-CODE                            21620000
216300                   PERFORM 4775-VALIDATE-BRIDAL-VENDOR            21630000
216400                   IF AGR-NOT-FOUND                               21640000
216500                      SET DP020-MSG-FATAL     TO TRUE             21650000
216600                      MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA      21660000
216700                      MOVE DP015-RED          TO ATRANCDC         21670000
216800                      MOVE DP015-REVERSE      TO ATRANCDH         21680000
216900                      MOVE -1                 TO ATRANCDL         21690000
217000                      IF PS-NO-ERROR                              21700000
217100                         MOVE PC-TSYMSG-03349 TO DP020-MSG-NUMBER 21710000
217200                      END-IF                                      21720000
217300                      SET PS-ERROR            TO TRUE             21730000
217400                   END-IF                                         21740000
217500            END-EVALUATE                                          21750000
217600        END-IF                                                    21760000
217700     END-IF.                                                      21770000
217800                                                                  21780000
217900******************************************************************21790000
218000* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED PURCHASE      *21800000
218100* ORDER NUMBER.                                                  *21810000
218200******************************************************************21820000
218300 3017-EDIT-PO.                                                    21830000
218400                                                                  21840000
218500     IF ASC-ALP-PO-NBR > SPACES OR                                21850000
218600        ASC-ALP-PO-NBR-9 > ZEROS                                  21860000
218700        MOVE ASC-ALP-PO-NBR TO DP010I-UNEDITED-FIELD              21870000
218800        MOVE 9                   TO DP010I-MAXIMUM-DIGITS         21880000
218900        MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       21890000
219000        SET  DP010I-NEGATIVE-NOT-ALLOWED                          21900000
219100                                 TO TRUE                          21910000
219210        CALL DP010I-NUMERIC-EDIT-ROUTINE                          21921059
219220                         USING DP010I-NUMERIC-EDIT-AREA           21922059
219300        IF DP010I-ERROR-DETECTED                                  21930000
219400            SET DP020-MSG-FATAL  TO TRUE                          21940000
219500*           -- MUST BE NUMERIC --                                 21950000
219600            MOVE DP015-UNP-ALP-BRT-OFF                            21960000
219700                                 TO APONUMA                       21970000
219800            MOVE DP015-RED       TO APONUMC                       21980000
219900            MOVE DP015-REVERSE   TO APONUMH                       21990000
220000            MOVE -1                  TO APONUML                   22000000
220100            IF PS-NO-ERROR                                        22010000
220200                MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER          22020000
220300            END-IF                                                22030000
220400            SET PS-ERROR         TO TRUE                          22040000
220500        ELSE                                                      22050000
220600            MOVE DP010I-NUMERIC-FIELD TO ASC-PO-NUMBER            22060000
220700                                         ASC-ALP-PO-NBR-9         22070000
220800                                         PURCHS-PO-NBR            22080000
220900            IF PURCHS-PO-NBR NOT EQUAL ZERO                       22090000
221000                SET ASC-PO-FOUND TO TRUE                          22100000
221100                PERFORM 7500-VALIDATE-PO                          22110000
221200                IF ASC-PO-NOT-FOUND                               22120000
221300                   SET DP020-MSG-FATAL TO TRUE                    22130000
221400                   MOVE DP015-UNP-ALP-BRT-OFF TO APONUMA          22140000
221500                   MOVE DP015-RED     TO APONUMC                  22150000
221600                   MOVE DP015-REVERSE TO APONUMH                  22160000
221700                   MOVE -1            TO APONUML                  22170000
221800                   IF PS-NO-ERROR                                 22180000
221900                      MOVE PC-TSYMSG-01905 TO DP020-MSG-NUMBER    22190000
222000                   END-IF                                         22200000
222100                   SET PS-ERROR       TO TRUE                     22210000
222200                END-IF                                            22220000
222300        END-IF                                                    22230000
222400     ELSE                                                         22240000
222500        MOVE ZERO TO ASC-PO-NUMBER                                22250000
222600     END-IF.                                                      22260000
222700                                                                  22270000
222800** THE TRANSACTION CODE DICTATES THAT THE PURCHASE ORDER NUMBER IS22280000
222900** REQUIRED, BUT THE PURCHASE ORDER NUMBER WAS NOT ENTERED.       22290000
223000     IF TRNCDE-PO-NBR-REQR-IND = 'Y' AND                          22300000
223100        (ASC-ALP-PO-NBR = SPACES OR                               22310000
223200         ASC-ALP-PO-NBR-9 = ZEROS)                                22320000
223300        SET DP020-MSG-FATAL        TO TRUE                        22330000
223400        MOVE DP015-UNP-ALP-BRT-OFF TO APONUMA                     22340000
223500        MOVE DP015-RED             TO APONUMC                     22350000
223600        MOVE DP015-REVERSE         TO APONUMH                     22360000
223700        MOVE -1                    TO APONUML                     22370000
223800        IF PS-NO-ERROR                                            22380000
223900           MOVE PC-TSYMSG-01927    TO DP020-MSG-NUMBER            22390000
224000        END-IF                                                    22400000
224100        SET PS-ERROR               TO TRUE                        22410000
224200     END-IF.                                                      22420000
224300                                                                  22430000
224400******************************************************************22440000
224500* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED VENDOR NUMBER.*22450000
224600* THE VENDOR NUMBER IS REQUIRED FOR THE ADD OPERATION FROM       *22460000
224700* THE CRITERIA SPECIFICATION SCREEN.                             *22470000
224800******************************************************************22480000
224900 3020-EDIT-VEND-NO.                                               22490000
225000                                                                  22500000
225100     IF ASC-VENDOR-NUMBER = SPACES                                22510000
225200        INITIALIZE ENTNME-ENT-NAME-DESC                           22520000
225300        SET DP020-MSG-FATAL        TO TRUE                        22530000
225400        MOVE DP015-UNP-ALP-BRT-OFF TO AVENDNOA                    22540000
225500        MOVE DP015-RED             TO AVENDNOC                    22550000
225600        MOVE DP015-REVERSE         TO AVENDNOH                    22560000
225700        MOVE -1                    TO AVENDNOL                    22570000
225800        IF PS-NO-ERROR                                            22580000
225900           MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER            22590000
226000        END-IF                                                    22600000
226100        SET PS-ERROR               TO TRUE                        22610000
226200     ELSE                                                         22620000
226300        SET ASC-VENDOR-NOT-FOUND TO TRUE                          22630000
226400        MOVE ASC-VENDOR-NUMBER TO EXTENT-DUN-NBR                  22640000
226500        PERFORM 4800-VALIDATE-VENDOR                              22650000
226600        IF ASC-VENDOR-NOT-FOUND                                   22660000
226700           SET DP020-MSG-FATAL TO TRUE                            22670000
226800           MOVE DP015-UNP-ALP-BRT-OFF TO AVENDNOA                 22680000
226900           MOVE DP015-RED         TO AVENDNOC                     22690000
227000           MOVE DP015-REVERSE     TO AVENDNOH                     22700000
227100           MOVE -1                TO AVENDNOL                     22710000
227200           IF PS-NO-ERROR                                         22720000
227300               MOVE PC-TSYMSG-01095 TO DP020-MSG-NUMBER           22730000
227400           END-IF                                                 22740000
227500           SET PS-ERROR TO TRUE                                   22750000
227600        ELSE                                                      22760000
227700* 12-07 START                                                     22770000
227800           IF EXTENT-STATUS-CDE NOT = 'A'                         22780000
227900              SET DP020-MSG-WARNING        TO TRUE                22790000
228000              IF PS-NO-ERROR                                      22800000
228100                 MOVE PC-TSYMSG-00671      TO DP020-MSG-NUMBER    22810000
228200              END-IF                                              22820000
228300              SET PS-WARNING TO TRUE                              22830000
228400           END-IF                                                 22840000
228500* 12-07 END                                                       22850000
228600           IF ((PURCHS-PO-TYP-CDE = 'IM' OR 'IE' OR 'IF') AND     22860000
228700               ASC-TRN-TYP-CDE = 'EXP') OR                        22870000
228800               PURCHS-PO-NBR EQUAL ZERO                           22880000
228900               NEXT SENTENCE                                      22890000
229000           ELSE                                                   22900000
229100              MOVE EXTENT-ENT-ID     TO PURCHS-ENT-ID             22910000
229200              SET ASC-PO-VND-NOT-FOUND TO TRUE                    22920000
229300              PERFORM 7550-VALIDATE-PO-VENDOR                     22930000
229400              IF ASC-PO-VND-NOT-FOUND                             22940000
229500                 SET DP020-MSG-WARNING      TO TRUE               22950000
229600* MAB 08-12-99   MOVE DP015-UNP-ALP-BRT-OFF TO APONUMA            22960000
229700* MAB 08-12-99                                 AVENDNOA           22970000
229800* MAB 08-12-99   MOVE DP015-RED             TO APONUMC            22980000
229900* MAB 08-12-99                                 AVENDNOC           22990000
230000* MAB 08-12-99   MOVE DP015-REVERSE         TO APONUMH            23000000
230100* MAB 08-12-99                                 AVENDNOH           23010000
230200* MAB 08-12-99   MOVE -1                    TO AVENDNOL           23020000
230300                 IF PS-NO-ERROR                                   23030000
230400                    MOVE PC-TSYMSG-01928    TO DP020-MSG-NUMBER   23040000
230500                 END-IF                                           23050000
230600* MAB 08-12-99   SET PS-ERROR TO TRUE                             23060000
230700                 SET PS-WARNING TO TRUE                           23070000
230800              END-IF                                              23080000
230900           END-IF                                                 23090000
231000        END-IF                                                    23100000
231100     END-IF.                                                      23110000
231200                                                                  23120000
231300******************************************************************23130000
231400* IN UPDATE MODE THIS PARAGRAPH WILL CONTROL PROCESSING TO       *23140000
231500* VALIDATE THE PURCHASE ORDER NUMBER WITH THE VENDOR NUMBER.     *23150000
231600* THIS VALIDATION IS NEEDED BECAUSE THE PURCHASE ORDER NUMBER    *23160000
231700* IS AN UPDATEABLE FIELD AND THE VENDOR NUMBER IS NOT.           *23170000
231800******************************************************************23180000
231900 3022-EDIT-PO-VEND-IN-UPD.                                        23190000
232000                                                                  23200000
232100     IF ASC-PO-NUMBER NOT EQUAL ZERO                              23210000
232200        MOVE ASC-PO-NUMBER      TO PURCHS-PO-NBR                  23220000
232300        MOVE ASC-VENDOR-NUMBER  TO EXTENT-DUN-NBR                 23230000
232400        SET ASC-PO-VND-NOT-FOUND TO TRUE                          23240000
232500        PERFORM 7525-FOR-UPD-EDIT-VND-PO                          23250000
232600        IF ASC-PO-VND-NOT-FOUND                                   23260000
232700           SET DP020-MSG-WARNING TO TRUE                          23270000
232800* 08-12    MOVE DP015-UNP-ALP-BRT-OFF                             23280000
232900* 08-12                         TO APONUMA                        23290000
233000* 08-12    MOVE DP015-RED       TO APONUMC                        23300000
233100* 08-12    MOVE DP015-REVERSE   TO APONUMH                        23310000
233200* 08-12    MOVE -1              TO APONUML                        23320000
233300           IF PS-NO-ERROR                                         23330000
233400              MOVE PC-TSYMSG-01928 TO DP020-MSG-NUMBER            23340000
233500           END-IF                                                 23350000
233600* 08-12-99 SET PS-ERROR         TO TRUE                           23360000
233700           SET PS-WARNING       TO TRUE                           23370000
233800        END-IF                                                    23380000
233900     END-IF.                                                      23390000
234000                                                                  23400000
234100******************************************************************23410000
234200* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED BARCODE.      *23420000
234300******************************************************************23430000
234400*3030-EDIT-BARCODE.                                               23440071
234500                                                                  23450000
234600*    IF ASC-BARCODE > SPACES                                      23460071
234700*       MOVE ASC-BARCODE     TO DP010I-UNEDITED-FIELD             23470041
234800*       MOVE 9                   TO DP010I-MAXIMUM-DIGITS         23480041
234900*       MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       23490041
235000*       SET  DP010I-NEGATIVE-NOT-ALLOWED                          23500041
235100*                                TO TRUE                          23510041
235200*       CALL DP010I-NUMERIC-EDIT-AREA                             23520059
235300*       IF DP010I-ERROR-DETECTED                                  23530041
235400*           SET DP020-MSG-FATAL  TO TRUE                          23540041
235500*           -- MUST BE NUMERIC --                                 23550000
235600*           MOVE DP015-UNP-ALP-BRT-OFF                            23560041
235700*                                TO ABARCDA                       23570041
235800*           MOVE DP015-RED       TO ABARCDC                       23580041
235900*           MOVE DP015-REVERSE   TO ABARCDH                       23590041
236000*           MOVE -1              TO ABARCDL                       23600041
236100*           IF PS-NO-ERROR                                        23610041
236200*               MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER          23620041
236300*           END-IF                                                23630041
236400*           SET PS-ERROR         TO TRUE                          23640041
236500*       ELSE                                                      23650041
236600*           MOVE ASC-BARCODE TO PV-HOLD-BARCODE                   23660041
236700*           MOVE PV-HOLD-BARCODE-9 TO BASE-NUMBER                 23670041
236800*                                                                 23680041
236900** CALL THE BARCODE CHECK DIGIT ROUTINE.                          23690000
237000*           PERFORM VALIDATE-CHECK-DIGIT                          23700041
237100*           IF CHECK-DIGIT NOT = ZERO OR                          23710041
237200*              PV-HOLD-BARCODE-9 EQUAL ZERO                       23720041
237300*              MOVE DP015-UNP-ALP-BRT-OFF                         23730041
237400*                                   TO ABARCDA                    23740041
237500*              MOVE DP015-RED       TO ABARCDC                    23750041
237600*              MOVE DP015-REVERSE   TO ABARCDH                    23760041
237700*              MOVE -1              TO ABARCDL                    23770041
237800*              IF PS-NO-ERROR                                     23780041
237900*                 MOVE PC-TSYMSG-00316 TO DP020-MSG-NUMBER        23790041
238000*              END-IF                                             23800041
238100*              SET PS-ERROR         TO TRUE                       23810041
238200*           END-IF                                                23820041
238300*       END-IF                                                    23830041
238400*       CONTINUE                                                  23840071
238500*    ELSE                                                         23850071
238600*       IF ASC-ADD-PENDING OR                                     23860071
238700*          ASC-UPDATE-REQUESTED                                   23870071
238800*          MOVE DP015-UNP-ALP-BRT-OFF                             23880071
238900*                            TO ABARCDA                           23890071
239000*          MOVE DP015-RED    TO ABARCDC                           23900071
239100*          MOVE DP015-REVERSE TO ABARCDH                          23910071
239200*          MOVE -1           TO ABARCDL                           23920071
239300*          IF PS-NO-ERROR                                         23930071
239400*              MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER           23940071
239500*          END-IF                                                 23950071
239600*          SET PS-ERROR      TO TRUE                              23960071
239700*       END-IF                                                    23970071
239800*    END-IF.                                                      23980071
239900                                                                  23990000
240000******************************************************************24000000
240100* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED HEADER STORE. *24010000
240200******************************************************************24020000
240300 3040-EDIT-STORE.                                                 24030000
240400                                                                  24040000
240500     IF ASC-ALP-STORE-NBR = SPACES                                24050000
240600        MOVE DP015-UNP-ALP-BRT-OFF                                24060000
240700                             TO ASTRNMA                           24070000
240800        MOVE DP015-RED       TO ASTRNMC                           24080000
240900        MOVE DP015-REVERSE   TO ASTRNMH                           24090000
241000        MOVE -1              TO ASTRNML                           24100000
241100        IF PS-NO-ERROR                                            24110000
241200            MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER              24120000
241300        END-IF                                                    24130000
241400        SET PS-ERROR         TO TRUE                              24140000
241500     END-IF.                                                      24150000
241600                                                                  24160000
241700     SET ASC-HD-STORE-NOT-FOUND TO TRUE.                          24170000
241800                                                                  24180000
241900     IF ASC-ALP-STORE-NBR > SPACES                                24190000
242000        MOVE ASC-ALP-STORE-NBR                                    24200000
242100                                 TO DP010I-UNEDITED-FIELD         24210000
242200        MOVE 4                   TO DP010I-MAXIMUM-DIGITS         24220000
242300        MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       24230000
242400        SET  DP010I-NEGATIVE-NOT-ALLOWED                          24240000
242500                                 TO TRUE                          24250000
242610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         24261059
242620                         USING DP010I-NUMERIC-EDIT-AREA           24262059
242700        IF DP010I-ERROR-DETECTED                                  24270000
242800            SET DP020-MSG-FATAL  TO TRUE                          24280000
242900*           -- MUST BE NUMERIC --                                 24290000
243000            MOVE DP015-UNP-ALP-BRT-OFF                            24300000
243100                                 TO ASTRNMA                       24310000
243200            MOVE DP015-RED       TO ASTRNMC                       24320000
243300            MOVE DP015-REVERSE   TO ASTRNMH                       24330000
243400            MOVE -1              TO ASTRNML                       24340000
243500            IF PS-NO-ERROR                                        24350000
243600                MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER          24360000
243700            END-IF                                                24370000
243800            SET PS-ERROR         TO TRUE                          24380000
243900        ELSE                                                      24390000
244000            MOVE DP010I-NUMERIC-FIELD TO ASC-STORE                24400000
244100                                         PV-STORE-NBR-4           24410000
244200*           MOVE PV-STORE-NBR-4 TO XFT00003-LOC-NBR               24420000
244300            MOVE PV-STORE-NBR-4 TO XFT00017-LOC-NBR               24430000
244400*MAB 07-22-99 START                                               24440000
244500            IF ASC-STORE > 9998 OR                                24450000
244600               ASC-STORE = 80                                     24460000
244700               SET ASC-HD-STORE-NOT-FOUND TO TRUE                 24470000
244800            ELSE                                                  24480000
244900*MAB 07-22-99 END                                                 24490000
245000               IF PV-STORE-NBR-4 NOT EQUAL ZERO                   24500000
245100                  PERFORM 7400-VALIDATE-STORE                     24510000
245200               ELSE                                               24520000
245300                  SET ASC-HD-STORE-FOUND TO TRUE                  24530000
245400               END-IF                                             24540000
245500            END-IF                                                24550000
245600            IF ASC-HD-STORE-NOT-FOUND                             24560000
245700               MOVE DP015-UNP-ALP-BRT-OFF                         24570000
245800                                    TO ASTRNMA                    24580000
245900               MOVE DP015-RED       TO ASTRNMC                    24590000
246000               MOVE DP015-REVERSE   TO ASTRNMH                    24600000
246100               MOVE -1              TO ASTRNML                    24610000
246200               IF PS-NO-ERROR                                     24620000
246300                   MOVE PC-TSYMSG-01904 TO DP020-MSG-NUMBER       24630000
246400               END-IF                                             24640000
246500               SET PS-ERROR         TO TRUE                       24650000
246600            ELSE                                                  24660000
246700*              IF TRNCDE-TRN-TYP-CDE = 'EXP' AND                  24670000
246800*                 (PURCHS-PO-TYP-CDE  = 'IM' OR 'IE' OR 'IF') AND 24680000
246900*                 XFT00003-LOC-TYP-CDE  NOT = 'HQ'                24690000
247000*                 MOVE DP015-UNP-ALP-BRT-OFF                      24700000
247100*                                      TO ASTRNMA                 24710000
247200*                 MOVE DP015-RED       TO ASTRNMC                 24720000
247300*                 MOVE DP015-REVERSE   TO ASTRNMH                 24730000
247400*                 MOVE -1              TO ASTRNML                 24740000
247500*                 IF PS-NO-ERROR                                  24750000
247600*                     MOVE PC-TSYMSG-01900 TO DP020-MSG-NUMBER    24760000
247700*                 END-IF                                          24770000
247800*                 SET PS-ERROR         TO TRUE                    24780000
247900*              END-IF                                             24790000
248000               IF TRNCDE-TRN-TYP-CDE = 'EXP' AND                  24800000
248100                  XFT00017-LOC-NBR NOT = 90                       24810000
248200*                 XFT00003-LOC-NBR NOT = 90                       24820000
248300**                XFT00003-LOC-TYP-CDE  NOT = 'HQ'                24830000
248400** ERROR - CORPORATE STORE NUMBER (90) MUST BE USED ON ALL        24840000
248500**         EXPENSE ADJUSTMENTS - NO EXCEPTIONS                    24850000
248600                  MOVE DP015-UNP-ALP-BRT-OFF                      24860000
248700                                      TO ASTRNMA                  24870000
248800                  MOVE DP015-RED      TO ASTRNMC                  24880000
248900                  MOVE DP015-REVERSE  TO ASTRNMH                  24890000
249000                  MOVE -1             TO ASTRNML                  24900000
249100                  IF PS-NO-ERROR                                  24910000
249200                      MOVE PC-TSYMSG-03497 TO DP020-MSG-NUMBER    24920000
249300                  END-IF                                          24930000
249400                  SET PS-ERROR        TO TRUE                     24940000
249500               END-IF                                             24950000
249600               IF (ASC-TRAN-CD = '24' OR                          24960000
249700                   ASC-TRAN-CD = '26') AND                        24970000
249800                   XFT00017-LOC-TYP-CDE NOT = 'DA'                24980000
249900*                  XFT00003-LOC-TYP-CDE NOT = 'DA'                24990000
250000                   MOVE DP015-UNP-ALP-BRT-OFF                     25000000
250100                                       TO ASTRNMA                 25010000
250200                   MOVE DP015-RED      TO ASTRNMC                 25020000
250300                   MOVE DP015-REVERSE  TO ASTRNMH                 25030000
250400                   MOVE -1             TO ASTRNML                 25040000
250500                   IF PS-NO-ERROR                                 25050000
250600                       MOVE PC-TSYMSG-01911 TO DP020-MSG-NUMBER   25060000
250700                   END-IF                                         25070000
250800                   SET PS-ERROR        TO TRUE                    25080000
250900               END-IF                                             25090000
251000               IF TRNCDE-TRN-TYP-CDE = 'MDS' AND                  25100000
251100                  XFT00017-LOC-TYP-CDE  = 'HQ'                    25110000
251200*                 XFT00003-LOC-TYP-CDE  = 'HQ'                    25120000
251300                  MOVE DP015-UNP-ALP-BRT-OFF                      25130000
251400                                      TO ASTRNMA                  25140000
251500                  MOVE DP015-RED      TO ASTRNMC                  25150000
251600                  MOVE DP015-REVERSE  TO ASTRNMH                  25160000
251700                  MOVE -1             TO ASTRNML                  25170000
251800                  IF PS-NO-ERROR                                  25180000
251900                      MOVE PC-TSYMSG-02395 TO DP020-MSG-NUMBER    25190000
252000                  END-IF                                          25200000
252100                  SET PS-ERROR        TO TRUE                     25210000
252200               END-IF                                             25220000
252300        END-IF                                                    25230000
252400     END-IF.                                                      25240000
252500                                                                  25250000
252600******************************************************************25260000
252700* THIS PARAGRAPH WILL GET THE OFFSET TRAN CODE                   *25270000
252800* FROM TTRNCDE FOR THE TRANCODE THAT IS BEING PROCESSED.         *25280000
252900******************************************************************25290000
253000 3041-CHECK-FOR-OFFSET-TRANCD.                                    25300000
253100                                                                  25310000
253200     PERFORM                                                      25320000
253300        WITH TEST AFTER                                           25330000
253400         VARYING PV-RETRY-COUNTER                                 25340000
253500        FROM 1 BY 1                                               25350000
253600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25360000
253700                  OR (SQLCODE = ZERO)                             25370000
253800                   OR (SQLCODE = +100))                           25380000
253900                                                                  25390000
254000     EXEC SQL                                                     25400000
254100         SELECT AUTO_OFFST_TRN_CDE                                25410000
254200         INTO   :TRNCDE-AUTO-OFFST-TRN-CDE                        25420000
254300         FROM   TTRNCDE                                           25430000
254400         WHERE  AP_TRN_CDE    = :TRNCDE-AP-TRN-CDE                25440000
254500*        AND    TRN_TYP_CDE   = 'MDS'                             25450074
254600         AND    EFF_STRT_DTE <=  CURRENT DATE                     25460000
254700         AND    EFF_END_DTE  >=  CURRENT DATE                     25470000
254800     END-EXEC                                                     25480000
254900                                                                  25490000
255000     EVALUATE TRUE                                                25500000
255100         WHEN SQLCODE = ZERO                                      25510000
255200             IF TRNCDE-AUTO-OFFST-TRN-CDE > '  '                  25520000
255300                PERFORM 3042-CHECK-OFFSET-TRAN-TYPE               25530000
255400             ELSE                                                 25540000
255500                SET ASC-OFFSET-TC-NOT-FOUND TO TRUE               25550000
255600             END-IF                                               25560000
255700         WHEN SQLCODE = +100                                      25570000
255800             SET ASC-OFFSET-TC-NOT-FOUND TO TRUE                  25580000
255900         WHEN SQLCODE = -904                                      25590000
256000         WHEN SQLCODE = -913                                      25600000
256100         WHEN SQLWARN0 NOT = SPACES                               25610000
256200         WHEN SQLCODE < ZERO                                      25620000
256300         WHEN SQLCODE > ZERO                                      25630000
256400             MOVE '3041-CHECK-FOR-OFFSET-TRANCD'                  25640000
256500                               TO DP013-PARAGRAPH                 25650000
256600             MOVE 'SELECT TTRNCDE         '                       25660000
256700                               TO DP013-MESSAGE-TEXT (1)          25670000
256800             MOVE SQLCA        TO DP013-SQLCA                     25680000
256900             MOVE 'TTRNCDE'    TO DP013-DB2-TABLE-NAME (1)        25690000
257000             SET DP013-DB2-ABEND                                  25700000
257100                 DP013-XCTL-DISPLAY-RESTART                       25710000
257200                                     TO TRUE                      25720000
257300             PERFORM DP013-0000-PROCESS-ABEND                     25730000
257400     END-EVALUATE                                                 25740000
257500     END-PERFORM.                                                 25750000
257600                                                                  25760000
257700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25770000
257800         MOVE '3041-CHECK-FOR-OFFSET-TRANCD'                      25780000
257900                                   TO DP013-PARAGRAPH             25790000
258000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25800000
258100                                   TO DP013-MESSAGE-TEXT (1)      25810000
258200         MOVE 'OFFSET TRANCD'  TO DP013-MESSAGE-TEXT (2)          25820000
258300         MOVE SQLCA            TO DP013-SQLCA                     25830000
258400         MOVE 'TTRNCDE'        TO DP013-DB2-TABLE-NAME (1)        25840000
258500         SET DP013-DB2-ABEND                                      25850000
258600             DP013-XCTL-DISPLAY-RESTART                           25860000
258700                                   TO TRUE                        25870000
258800         PERFORM DP013-0000-PROCESS-ABEND                         25880000
258900     END-IF.                                                      25890000
259000                                                                  25900000
259100******************************************************************25910000
259200* THIS PARAGRAPH WILL CHECK THE OFFSET TRAN CODE'S TRAN TYPE.    *25920000
259300* THE TRAN TYPE MUST BE 'EXP' FOR THE AUTOMATED PROCESS TO WORK  *25930000
259400******************************************************************25940000
259500 3042-CHECK-OFFSET-TRAN-TYPE.                                     25950000
259600                                                                  25960000
259700     PERFORM                                                      25970000
259800        WITH TEST AFTER                                           25980000
259900         VARYING PV-RETRY-COUNTER                                 25990000
260000        FROM 1 BY 1                                               26000000
260100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26010000
260200                  OR (SQLCODE = ZERO)                             26020000
260300                   OR (SQLCODE = +100))                           26030000
260400                                                                  26040000
260500     EXEC SQL                                                     26050000
260600         SELECT TRN_TYP_CDE                                       26060000
260700               ,BTCH_SRC_CDE                                      26070000
260800               ,PSTG_TYP_CDE                                      26080000
260900         INTO   :PV-OFFSET-TRN-TYP-CDE                            26090000
261000               ,:PV-OFFSET-BTCH-SRC-CDE                           26100000
261100               ,:PV-OFFSET-PSTG-TYP-CDE                           26110000
261200         FROM   TTRNCDE                                           26120000
261300         WHERE  AP_TRN_CDE    = :TRNCDE-AUTO-OFFST-TRN-CDE        26130000
261400         AND    EFF_STRT_DTE <=  CURRENT DATE                     26140000
261500         AND    EFF_END_DTE  >=  CURRENT DATE                     26150000
261600     END-EXEC                                                     26160000
261700                                                                  26170000
261800     EVALUATE TRUE                                                26180000
261900         WHEN SQLCODE = ZERO                                      26190000
262000             IF PV-OFFSET-TRN-TYP-CDE = 'EXP'                     26200000
262100                SET ASC-OFFSET-TC-FOUND TO TRUE                   26210000
262200                MOVE TRNCDE-AUTO-OFFST-TRN-CDE TO                 26220000
262300                            ASC-OFFSET-TRAN-CD                    26230000
262400                MOVE PV-OFFSET-BTCH-SRC-CDE    TO                 26240000
262500                            ASC-OFFSET-BTCH-SRC-CDE               26250000
262600                MOVE PV-OFFSET-PSTG-TYP-CDE    TO                 26260000
262700                            ASC-OFFSET-PSTG-TYP-CDE               26270000
262800             ELSE                                                 26280000
262900                SET ASC-OFFSET-TC-NOT-FOUND TO TRUE               26290000
263000             END-IF                                               26300000
263100         WHEN SQLCODE = +100                                      26310000
263200         WHEN SQLCODE = -904                                      26320000
263300         WHEN SQLCODE = -913                                      26330000
263400         WHEN SQLWARN0 NOT = SPACES                               26340000
263500         WHEN SQLCODE < ZERO                                      26350000
263600         WHEN SQLCODE > ZERO                                      26360000
263700             MOVE '3042-CHECK-OFFSET-TRAN-TYPE '                  26370000
263800                               TO DP013-PARAGRAPH                 26380000
263900             MOVE 'SELECT TTRNCDE         '                       26390000
264000                               TO DP013-MESSAGE-TEXT (1)          26400000
264100             MOVE SQLCA        TO DP013-SQLCA                     26410000
264200             MOVE 'TTRNCDE'    TO DP013-DB2-TABLE-NAME (1)        26420000
264300             SET DP013-DB2-ABEND                                  26430000
264400                 DP013-XCTL-DISPLAY-RESTART                       26440000
264500                                     TO TRUE                      26450000
264600             PERFORM DP013-0000-PROCESS-ABEND                     26460000
264700     END-EVALUATE                                                 26470000
264800     END-PERFORM.                                                 26480000
264900                                                                  26490000
265000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         26500000
265100         MOVE '3042-CHECK-OFFSET-TRAN-TYPE '                      26510000
265200                                   TO DP013-PARAGRAPH             26520000
265300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26530000
265400                                   TO DP013-MESSAGE-TEXT (1)      26540000
265500         MOVE 'OFFSET TRANCD'  TO DP013-MESSAGE-TEXT (2)          26550000
265600         MOVE SQLCA            TO DP013-SQLCA                     26560000
265700         MOVE 'TTRNCDE'        TO DP013-DB2-TABLE-NAME (1)        26570000
265800         SET DP013-DB2-ABEND                                      26580000
265900             DP013-XCTL-DISPLAY-RESTART                           26590000
266000                                   TO TRUE                        26600000
266100         PERFORM DP013-0000-PROCESS-ABEND                         26610000
266200     END-IF.                                                      26620000
266300                                                                  26630000
266400******************************************************************26640000
266500*    CONVERTS THE DOC NBR FOR USE AS THE DOC NUMBER FOR THE OFFSET26650000
266600*    TRANSACTION. IT LEFT-JUSTIFIES THE NUMBER AND USES THE FIRST 26660000
266700*    15 CHARACTERS OF THE DOC NUMBER.  THIS IS BECAUSE THE DOC    26670000
266800*    NUMBER IS ONLY 16 CHARACTERS LONG.                           26680000
266900******************************************************************26690000
267000 3043-CREATE-OFFSET-DOC-NBR.                                      26700000
267100                                                                  26710000
267200     MOVE ASC-DOC-NUMBER      TO PV-STRING.                       26720000
267300     MOVE LENGTH OF PV-STRING TO PV-START.                        26730000
267400                                                                  26740000
267500     PERFORM                                                      26750000
267600       UNTIL PV-STRING(PV-START:1) > SPACES OR                    26760000
267700             PV-START = +0                                        26770000
267800         COMPUTE PV-START = PV-START - 1                          26780000
267900     END-PERFORM.                                                 26790000
268000                                                                  26800000
268100     IF PV-START > 13                                             26810000
268200** ERROR!! DOC NO CANNOT BE > 13 CHARS BECAUSE AN OFFSET TRANS    26820000
268300**         WILL BE CREATED                                        26830000
268400        SET DP020-MSG-FATAL TO TRUE                               26840000
268500        MOVE DP015-UNP-ALP-BRT-OFF TO ADOCNUMA                    26850000
268600        MOVE DP015-RED             TO ADOCNUMC                    26860000
268700        MOVE DP015-REVERSE         TO ADOCNUMH                    26870000
268800        MOVE -1                    TO ADOCNUML                    26880000
268900        IF PS-NO-ERROR                                            26890000
269000            MOVE PC-TSYMSG-03423   TO DP020-MSG-NUMBER            26900000
269100        END-IF                                                    26910000
269200        SET PS-ERROR               TO TRUE                        26920000
269300     ELSE                                                         26930000
269400        MOVE PV-START TO PV-END                                   26940000
269500        IF PV-START < 13                                          26950000
269600           MOVE +1 TO PV-START                                    26960000
269700        ELSE                                                      26970000
269800           SUBTRACT +12 FROM PV-START                             26980000
269900        END-IF                                                    26990000
270000        COMPUTE PV-LENGTH = PV-END - PV-START + 1                 27000000
270100        MOVE PV-STRING(PV-START:PV-LENGTH)                        27010000
270200                   TO PV-OFFSET-DOC-NUMBER                        27020000
270300        MOVE 'OFF' TO PV-OFFSET-DOC-NUMBER(PV-LENGTH + 1:3)       27030000
270400        MOVE PV-OFFSET-DOC-NUMBER TO ASC-OFFSET-DOC-NUMBER        27040000
270500     END-IF.                                                      27050000
270600                                                                  27060000
270700 EJECT                                                            27070000
270800******************************************************************27080000
270900* THIS PARAGRAPH WILL GET THE GL ACCT NBR FROM TTRNCDE FOR THE   *27090000
271000* OFFSET TRANCODE OF THE TRANCODE THAT IS BEING PROCESSED.       *27100000
271100******************************************************************27110000
271200 3044-CHECK-FOR-OFFSET-ACCTNO.                                    27120000
271300                                                                  27130000
271400                                                                  27140000
271500     EXEC SQL                                                     27150000
271600         SELECT GL_ACCT_NBR                                       27160000
271700         INTO   :PV-OFFSET-GL-ACCT-NBR                            27170000
271800         FROM   TTRNCDE                                           27180000
271900         WHERE  AP_TRN_CDE    = :TRNCDE-AUTO-OFFST-TRN-CDE        27190000
272000         AND    EFF_STRT_DTE <=  CURRENT DATE                     27200000
272100         AND    EFF_END_DTE  >=  CURRENT DATE                     27210000
272200     END-EXEC.                                                    27220000
272300                                                                  27230000
272400     EVALUATE TRUE                                                27240000
272500         WHEN SQLCODE = ZERO                                      27250000
272600             IF PV-OFFSET-GL-ACCT-NBR = SPACES                    27260000
272700                SET ASC-OFFSET-ACCT-NOT-FOUND TO TRUE             27270000
272800                IF ASC-OFFSET-ACCT-NO NOT = SPACE                 27280000
272900                   PERFORM 3046-EDIT-OFFSET-ACCOUNT               27290000
273000                ELSE                                              27300000
273100                   IF ASC-OFFSET-BYPASS-IND = 'Y'                 27310000
273200                      NEXT SENTENCE                               27320000
273300                   ELSE                                           27330000
273400                      SET DP020-MSG-FATAL     TO TRUE             27340000
273500                      MOVE DP015-UNP-ALP-BRT-OFF TO AOFFACTA      27350000
273600                      MOVE DP015-RED             TO AOFFACTC      27360000
273700                      MOVE DP015-REVERSE         TO AOFFACTH      27370000
273800                      MOVE -1                    TO AOFFACTL      27380000
273900                      IF PS-NO-ERROR                              27390000
274000                         MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER 27400000
274100                      END-IF                                      27410000
274200                      SET PS-ERROR            TO TRUE             27420000
274300                   END-IF                                         27430000
274400                END-IF                                            27440000
274500             ELSE                                                 27450000
274600                SET ASC-OFFSET-ACCT-FOUND TO TRUE                 27460000
274700                MOVE PV-OFFSET-GL-ACCT-NBR TO                     27470000
274800                        ASC-OFFSET-ACCT-NO                        27480000
274900             END-IF                                               27490000
275000         WHEN SQLCODE = +100                                      27500000
275100             SET ASC-OFFSET-ACCT-NOT-FOUND TO TRUE                27510000
275200         WHEN SQLCODE = -904                                      27520000
275300         WHEN SQLCODE = -913                                      27530000
275400         WHEN SQLWARN0 NOT = SPACES                               27540000
275500         WHEN SQLCODE < ZERO                                      27550000
275600         WHEN SQLCODE > ZERO                                      27560000
275700             MOVE '3044-CHECK-FOR-OFFSET-ACCTNO'                  27570000
275800                               TO DP013-PARAGRAPH                 27580000
275900             MOVE 'SELECT TTRNCDE         '                       27590000
276000                               TO DP013-MESSAGE-TEXT (1)          27600000
276100             MOVE SQLCA        TO DP013-SQLCA                     27610000
276200             MOVE 'TTRNCDE'    TO DP013-DB2-TABLE-NAME (1)        27620000
276300             SET DP013-DB2-ABEND                                  27630000
276400                 DP013-XCTL-DISPLAY-RESTART                       27640000
276500                                     TO TRUE                      27650000
276600             PERFORM DP013-0000-PROCESS-ABEND                     27660000
276700     END-EVALUATE.                                                27670000
276800                                                                  27680000
276900 EJECT                                                            27690000
277000******************************************************************27700000
277100* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED OFFSET BYPASS *27710000
277200* INDICATOR.                                                     *27720000
277300******************************************************************27730000
277400 3045-EDIT-OFFSET-BYPASS-IND.                                     27740000
277500                                                                  27750000
277600     IF ASC-OFFSET-BYPASS-IND = ' '                               27760000
277700        MOVE PC-OFFSET-BYPASS-IND-DFT TO ASC-OFFSET-BYPASS-IND    27770000
277800     ELSE                                                         27780000
277900        IF ASC-OFFSET-BYPASS-IND NOT EQUAL TO 'Y' AND             27790000
278000           ASC-OFFSET-BYPASS-IND NOT EQUAL TO 'N'                 27800000
278100** INVALID 'BYPASS' INDICATOR.  VALID VALUES ARE 'Y' OR 'N'.      27810000
278200           SET DP020-MSG-FATAL TO TRUE                            27820000
278300           MOVE DP015-UNP-ALP-BRT-OFF    TO AOFFBYPA              27830000
278400           MOVE DP015-RED                TO AOFFBYPC              27840000
278500           MOVE DP015-REVERSE            TO AOFFBYPH              27850000
278600           MOVE -1                       TO AOFFBYPL              27860000
278700           IF PS-NO-ERROR                                         27870000
278800              MOVE PC-TSYMSG-03417       TO DP020-MSG-NUMBER      27880000
278900           END-IF                                                 27890000
279000           SET PS-ERROR TO TRUE                                   27900000
279100     END-IF.                                                      27910000
279200                                                                  27920000
279300     IF ASC-OFFSET-TC-FOUND                                       27930000
279400** WARNING!! OFFSET TRANS WILL BE CREATED! ENTER 'Y' TO BYPASS    27940000
279500**           OFFSET TRANSACTION!                                  27950000
279600        MOVE DP015-UNP-ALP-BRT-OFF    TO AOFFBYPA                 27960000
279700        MOVE DP015-YELLOW             TO AOFFBYPC                 27970000
279800        MOVE DP015-REVERSE            TO AOFFBYPH                 27980000
279900        IF PS-NO-ERROR                                            27990000
280000           SET DP020-MSG-WARNING TO TRUE                          28000000
280100           MOVE -1                    TO AOFFBYPL                 28010000
280200           MOVE PC-TSYMSG-03422 TO DP020-MSG-NUMBER               28020000
280300           SET PS-WARNING TO TRUE                                 28030000
280400        END-IF                                                    28040000
280500     END-IF.                                                      28050000
280600                                                                  28060000
280700     IF ASC-OFFSET-TC-NOT-FOUND                                   28070000
280800        MOVE DP015-PRO-NOR-OFF     TO AOFFBYPA                    28080000
280900                                      AOFFACTA                    28090000
281000        MOVE DP015-BLUE            TO AOFFBYPC                    28100000
281100                                      AOFFACTC                    28110000
281200        MOVE DP015-HL-OFF          TO AOFFBYPH                    28120000
281300                                      AOFFACTH                    28130000
281400     END-IF.                                                      28140000
281500                                                                  28150000
281600     IF ASC-OFFSET-ACCT-FOUND                                     28160000
281700        MOVE DP015-PRO-NOR-OFF     TO AOFFACTA                    28170000
281800        MOVE DP015-BLUE            TO AOFFACTC                    28180000
281900        MOVE DP015-HL-OFF          TO AOFFACTH                    28190000
282000     END-IF.                                                      28200000
282100                                                                  28210000
282200******************************************************************28220000
282300* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED           *28230000
282400* OFFSET ACCOUNT.                                                *28240000
282500******************************************************************28250000
282600 3046-EDIT-OFFSET-ACCOUNT.                                        28260000
282700                                                                  28270000
282800     IF PV-OFFSET-TRN-TYP-CDE = 'EXP'                             28280000
282900        NEXT SENTENCE                                             28290000
283000     ELSE                                                         28300000
283100        IF ASC-OFFSET-ACCT-NO = '50000 ' OR                       28310000
283200           ASC-OFFSET-ACCT-NO = SPACES                            28320000
283300           NEXT SENTENCE                                          28330000
283400        ELSE                                                      28340000
283500           SET DP020-MSG-FATAL         TO TRUE                    28350000
283600           MOVE DP015-UNP-ALP-BRT-OFF  TO AOFFACTA                28360000
283700           MOVE DP015-RED              TO AOFFACTC                28370000
283800           MOVE DP015-REVERSE          TO AOFFACTH                28380000
283900           MOVE -1                     TO AOFFACTL                28390000
284000           IF PS-NO-ERROR                                         28400000
284100              MOVE PC-TSYMSG-01909 TO DP020-MSG-NUMBER            28410000
284200           END-IF                                                 28420000
284300           SET PS-ERROR                TO TRUE                    28430000
284400        END-IF                                                    28440000
284500     END-IF.                                                      28450000
284600                                                                  28460000
284700     IF ASC-OFFSET-ACCT-NO > SPACES AND                           28470000
284800        PS-NO-ERROR                                               28480000
285100        MOVE ASC-OFFSET-ACCT-NO   TO PV-ACCT-NBR                  28510052
285200        MOVE ASC-CURRENT-DATE     TO PV-CURRENT-DATE              28520052
285400        SET ASC-ACCT-NOT-FOUND    TO TRUE                         28540000
285500        PERFORM 6000-SELECT-ACCT-NBR-DESC                         28550052
285600        IF ASC-ACCT-NOT-FOUND                                     28560000
285700           SET DP020-MSG-FATAL TO TRUE                            28570000
285800           MOVE DP015-UNP-ALP-BRT-OFF    TO AOFFACTA              28580000
285900           MOVE DP015-RED                TO AOFFACTC              28590000
286000           MOVE DP015-REVERSE            TO AOFFACTH              28600000
286100           MOVE -1                       TO AOFFACTL              28610000
286200           IF PS-NO-ERROR                                         28620000
286300               MOVE PC-TSYMSG-01910 TO DP020-MSG-NUMBER           28630000
286400           END-IF                                                 28640000
286500           SET PS-ERROR TO TRUE                                   28650000
286600        END-IF                                                    28660000
286700     END-IF.                                                      28670000
286800                                                                  28680000
286900******************************************************************28690000
287000* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED DOCUMENT DATE.*28700000
287100******************************************************************28710000
287200 3050-EDIT-DOC-DATE.                                              28720000
287300                                                                  28730000
287400* START 08-04                                                     28740000
287500     IF ASC-DOC-DATE = SPACES OR                                  28750000
287600        ASC-DOC-DATE = LOW-VALUES                                 28760000
287700        IF ASC-ADD-PENDING OR                                     28770000
287800           ASC-UPDATE-REQUESTED                                   28780000
287900           MOVE ASC-CURRENT-DATE TO ASC-DOC-DATE                  28790000
288000        END-IF                                                    28800000
288100     ELSE                                                         28810000
288200* END 08-04                                                       28820000
288300                                                                  28830000
288400* INSERTED ADDITIONAL ASC-DOC-DATE > SPACES LINE                  28840000
288500        IF ASC-DOC-DATE-MM = SPACES AND                           28850000
288600           ASC-DOC-DATE > SPACES                                  28860000
288700           SET DP020-MSG-FATAL       TO TRUE                      28870000
288800           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCMMA                  28880000
288900           MOVE DP015-RED            TO ADOCMMC                   28890000
289000           MOVE DP015-REVERSE        TO ADOCMMH                   28900000
289100           MOVE -1                   TO ADOCMML                   28910000
289200           IF PS-NO-ERROR                                         28920000
289300               MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER          28930000
289400           END-IF                                                 28940000
289500           SET PS-ERROR              TO TRUE                      28950000
289600       END-IF                                                     28960000
289700                                                                  28970000
289800        IF ASC-DOC-DATE-DD = SPACES AND                           28980000
289900           ASC-DOC-DATE > SPACES                                  28990000
290000           SET DP020-MSG-FATAL       TO TRUE                      29000000
290100           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCDDA                  29010000
290200           MOVE DP015-RED            TO ADOCDDC                   29020000
290300           MOVE DP015-REVERSE        TO ADOCDDH                   29030000
290400           MOVE -1                   TO ADOCDDL                   29040000
290500           IF PS-NO-ERROR                                         29050000
290600               MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER          29060000
290700           END-IF                                                 29070000
290800           SET PS-ERROR              TO TRUE                      29080000
290900        END-IF                                                    29090000
291000                                                                  29100000
291100        IF ASC-DOC-DATE-YY = SPACES AND                           29110000
291200           ASC-DOC-DATE > SPACES                                  29120000
291300           SET DP020-MSG-FATAL       TO TRUE                      29130000
291400           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCYYA                  29140000
291500           MOVE DP015-RED            TO ADOCYYC                   29150000
291600           MOVE DP015-REVERSE        TO ADOCYYH                   29160000
291700           MOVE -1                   TO ADOCYYL                   29170000
291800           IF PS-NO-ERROR                                         29180000
291900               MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER          29190000
292000           END-IF                                                 29200000
292100           SET PS-ERROR              TO TRUE                      29210000
292200        END-IF                                                    29220000
292300                                                                  29230000
292400        IF ADOCMML = -1 OR                                        29240000
292500           ADOCDDL = -1 OR                                        29250000
292600           ADOCYYL = -1                                           29260000
292700           CONTINUE                                               29270000
292800        ELSE                                                      29280000
292900           MOVE ASC-DOC-DATE TO PV-CCYYMMDD-DATE                  29290000
293000           PERFORM 3155-EDIT-DATE                                 29300000
293100           MOVE PV-CCYYMMDD-DATE TO ASC-DOC-DATE                  29310000
293200           IF PS-VALID-DATE                                       29320000
293300              CONTINUE                                            29330000
293400           ELSE                                                   29340000
293500              MOVE DP015-UNP-ALP-BRT-OFF                          29350000
293600                                      TO ADOCMMA                  29360000
293700                                         ADOCDDA                  29370000
293800                                         ADOCYYA                  29380000
293900              MOVE DP015-RED       TO ADOCMMC                     29390000
294000                                      ADOCDDC                     29400000
294100                                      ADOCYYC                     29410000
294200              MOVE DP015-REVERSE   TO ADOCMMH                     29420000
294300                                      ADOCDDH                     29430000
294400                                      ADOCYYH                     29440000
294500              MOVE -1              TO ADOCMML                     29450000
294600              IF PS-NO-ERROR                                      29460000
294700                 IF PS-INVALID-DATE                               29470000
294800                    MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER      29480000
294900              END-IF                                              29490000
295000              SET PS-ERROR                                        29500000
295100                  DP020-MSG-FATAL   TO TRUE                       29510000
295200           END-IF                                                 29520000
295300        END-IF                                                    29530000
295400     END-IF.                                                      29540000
295500                                                                  29550000
295600******************************************************************29560000
295700* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED DEPARTMENT.   *29570000
295800******************************************************************29580000
295900 3060-EDIT-DEPARTMENT.                                            29590000
296000                                                                  29600000
296100     IF TRNCDE-TRN-TYP-CDE = 'MDS'                                29610000
296200        IF ASC-DEPARTMENT = SPACES                                29620000
296300           SET DP020-MSG-FATAL     TO TRUE                        29630000
296400           MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA                   29640000
296500           MOVE DP015-RED          TO ADEPTC                      29650000
296600           MOVE DP015-REVERSE      TO ADEPTH                      29660000
296700           MOVE -1                 TO ADEPTL                      29670000
296800           IF PS-NO-ERROR                                         29680000
296900              MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER            29690000
297000           END-IF                                                 29700000
297100           SET PS-ERROR            TO TRUE                        29710000
297200        ELSE                                                      29720000
297300           SET ASC-DEPT-NOT-FOUND TO TRUE                         29730000
297400           PERFORM 4900-VALIDATE-DEPARTMENT                       29740000
297500           IF ASC-DEPT-NOT-FOUND                                  29750000
297600              SET DP020-MSG-FATAL TO TRUE                         29760000
297700              MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA                29770000
297800              MOVE DP015-RED      TO ADEPTC                       29780000
297900              MOVE DP015-REVERSE  TO ADEPTH                       29790000
298000              MOVE -1             TO ADEPTL                       29800000
298100              IF PS-NO-ERROR                                      29810000
298200                  MOVE PC-TSYMSG-01907 TO DP020-MSG-NUMBER        29820000
298300              END-IF                                              29830000
298400              SET PS-ERROR TO TRUE                                29840000
298500           END-IF                                                 29850000
298600        END-IF                                                    29860000
298700     ELSE                                                         29870000
298800        IF ASC-DEPARTMENT > SPACES                                29880000
298900           SET DP020-MSG-FATAL TO TRUE                            29890000
299000           MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA                   29900000
299100           MOVE DP015-RED      TO ADEPTC                          29910000
299200           MOVE DP015-REVERSE  TO ADEPTH                          29920000
299300           MOVE -1             TO ADEPTL                          29930000
299400           IF PS-NO-ERROR                                         29940000
299500               MOVE PC-TSYMSG-01908 TO DP020-MSG-NUMBER           29950000
299600           END-IF                                                 29960000
299700           SET PS-ERROR TO TRUE                                   29970000
299800        END-IF                                                    29980000
299900     END-IF.                                                      29990000
300000                                                                  30000000
300100******************************************************************30010000
300200* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED ACCOUNT.  *30020000
300300******************************************************************30030000
300400 3070-EDIT-ACCOUNT.                                               30040000
300500                                                                  30050000
300600     IF TRNCDE-TRN-TYP-CDE = 'EXP'                                30060000
300700        IF ASC-ACCT-NO = SPACES                                   30070000
300800           SET DP020-MSG-FATAL     TO TRUE                        30080000
300900           MOVE DP015-UNP-ALP-BRT-OFF TO AACCNOA                  30090000
301000           MOVE DP015-RED             TO AACCNOC                  30100000
301100           MOVE DP015-REVERSE         TO AACCNOH                  30110000
301200           MOVE -1                    TO AACCNOL                  30120000
301300           IF PS-NO-ERROR                                         30130000
301400              MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER            30140000
301500           END-IF                                                 30150000
301600           SET PS-ERROR            TO TRUE                        30160000
301700        END-IF                                                    30170000
301800     ELSE                                                         30180000
301900        IF ASC-ACCT-NO EQUAL '50000 ' OR                          30190000
302000           ASC-ACCT-NO EQUAL SPACES                               30200000
302100           NEXT SENTENCE                                          30210000
302200        ELSE                                                      30220000
302300           SET DP020-MSG-FATAL         TO TRUE                    30230000
302400           MOVE DP015-UNP-ALP-BRT-OFF  TO AACCNOA                 30240000
302500           MOVE DP015-RED              TO AACCNOC                 30250000
302600           MOVE DP015-REVERSE          TO AACCNOH                 30260000
302700           MOVE -1                     TO AACCNOL                 30270000
302800           IF PS-NO-ERROR                                         30280000
302900              MOVE PC-TSYMSG-01909 TO DP020-MSG-NUMBER            30290000
303000           END-IF                                                 30300000
303100           SET PS-ERROR                TO TRUE                    30310000
303200        END-IF                                                    30320000
303300     END-IF.                                                      30330000
303400                                                                  30340000
303500     IF ASC-ACCT-NO GREATER THAN SPACES AND                       30350000
303600        PS-NO-ERROR                                               30360000
303900        MOVE ASC-ACCT-NO       TO PV-ACCT-NBR                     30390052
304000        MOVE ASC-CURRENT-DATE  TO PV-CURRENT-DATE                 30400052
304200        SET ASC-ACCT-NOT-FOUND    TO TRUE                         30420000
304300        PERFORM 6000-SELECT-ACCT-NBR-DESC                         30430052
304400        IF ASC-ACCT-NOT-FOUND                                     30440000
304500           SET DP020-MSG-FATAL TO TRUE                            30450000
304600           MOVE DP015-UNP-ALP-BRT-OFF TO AACCNOA                  30460000
304700           MOVE DP015-RED                TO AACCNOC               30470000
304800           MOVE DP015-REVERSE            TO AACCNOH               30480000
304900           MOVE -1                       TO AACCNOL               30490000
305000           IF PS-NO-ERROR                                         30500000
305100               MOVE PC-TSYMSG-01910 TO DP020-MSG-NUMBER           30510000
305200           END-IF                                                 30520000
305300           SET PS-ERROR TO TRUE                                   30530000
305400        END-IF                                                    30540000
305500     END-IF.                                                      30550000
305600                                                                  30560000
305700     IF TRNCDE-TRN-TYP-CDE = 'EXP' AND                            30570000
305800        ASC-ACCT-NO > SPACES       AND                            30580000
305900        PS-NO-ERROR                                               30590000
306000        SET ASC-ACCT-NBR-MATCH-NOT-CHECKED TO TRUE                30600000
306100        PERFORM 4951-VALID-ACCT-TRAN-CD-COMBIN                    30610000
306200        IF ASC-ACCT-NBR-DOESNT-MATCH                              30620000
306300           SET DP020-MSG-FATAL        TO TRUE                     30630000
306400           MOVE DP015-UNP-ALP-BRT-OFF TO AACCNOA                  30640000
306500           MOVE DP015-RED             TO AACCNOC                  30650000
306600           MOVE DP015-REVERSE         TO AACCNOH                  30660000
306700           MOVE -1                    TO AACCNOL                  30670000
306800           IF PS-NO-ERROR                                         30680000
306900              MOVE PC-TSYMSG-02919    TO DP020-MSG-NUMBER         30690000
307000              MOVE TRNCDE-GL-ACCT-NBR TO DP020-MSG-TEXT           30700000
307100           END-IF                                                 30710000
307200           SET PS-ERROR               TO TRUE                     30720000
307300        END-IF                                                    30730000
307400     END-IF.                                                      30740000
307500                                                                  30750000
307600******************************************************************30760000
307700* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED GROSS     *30770000
307800* COST.                                                          *30780000
307900******************************************************************30790000
308000 3080-EDIT-GROSS-COST.                                            30800000
308100                                                                  30810000
308200     IF ASC-ALP-GROSS-COST > SPACES AND                           30820000
308300        ASC-ALP-GROSS-COST NOT EQUAL TO '000000000000'            30830000
308400        IF TRNCDE-COST-PRCCTL-CDE = 'A' OR                        30840000
308500           TRNCDE-COST-PRCCTL-CDE = 'R'                           30850000
308600           MOVE ASC-ALP-GROSS-COST TO DP010I-UNEDITED-FIELD       30860000
308700           MOVE 10             TO DP010I-MAXIMUM-DIGITS           30870000
308800           MOVE 2              TO DP010I-MAXIMUM-DECIMALS         30880000
308900           SET DP010I-NEGATIVE-ALLOWED                            30890000
309000                                     TO TRUE                      30900000
309100                                                                  30910000
309210           CALL DP010I-NUMERIC-EDIT-ROUTINE                       30921059
309220                         USING DP010I-NUMERIC-EDIT-AREA           30922059
309300                                                                  30930000
309400           IF DP010I-ERROR-DETECTED                               30940000
309500               SET DP020-MSG-FATAL TO TRUE                        30950000
309600** GROSS COST MUST BE NUMERIC.                                    30960000
309700               MOVE DP015-UNP-ALP-BRT-OFF TO AGRCSTA              30970000
309800               MOVE DP015-RED       TO AGRCSTC                    30980000
309900               MOVE DP015-REVERSE   TO AGRCSTH                    30990000
310000               MOVE -1              TO AGRCSTL                    31000000
310100               IF PS-NO-ERROR                                     31010000
310200                  MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER        31020000
310300               END-IF                                             31030000
310400               SET PS-ERROR   TO TRUE                             31040000
310500           ELSE                                                   31050000
310600               MOVE DP010I-NUMERIC-FIELD                          31060000
310700                                TO ASC-GROSS-COST                 31070000
310800                                   ASC-ALP-GRO-COST-9             31080000
310900               IF ASC-GROSS-COST < 0 AND                          31090000
311000                  TRNCDE-PSTG-TYP-CDE = 'CH'                      31100000
311100                  SET DP020-MSG-FATAL    TO TRUE                  31110000
311200                  MOVE DP015-UNP-ALP-BRT-OFF TO AGRCSTA           31120000
311300                  MOVE DP015-RED             TO AGRCSTC           31130000
311400                  MOVE DP015-REVERSE         TO AGRCSTH           31140000
311500                  MOVE -1                    TO AGRCSTL           31150000
311600                  IF PS-NO-ERROR                                  31160000
311700                       MOVE PC-TSYMSG-01903 TO DP020-MSG-NUMBER   31170000
311800                  END-IF                                          31180000
311900                  SET PS-ERROR TO TRUE                            31190000
312000               END-IF                                             31200000
312100               IF ASC-GROSS-COST > 0 AND                          31210000
312200                  TRNCDE-PSTG-TYP-CDE = 'CR'                      31220000
312300                  SET DP020-MSG-FATAL    TO TRUE                  31230000
312400                  MOVE DP015-UNP-ALP-BRT-OFF TO AGRCSTA           31240000
312500                  MOVE DP015-RED             TO AGRCSTC           31250000
312600                  MOVE DP015-REVERSE         TO AGRCSTH           31260000
312700                  MOVE -1                    TO AGRCSTL           31270000
312800                  IF PS-NO-ERROR                                  31280000
312900                       MOVE PC-TSYMSG-01902 TO DP020-MSG-NUMBER   31290000
313000                  END-IF                                          31300000
313100                  SET PS-ERROR TO TRUE                            31310000
313200               END-IF                                             31320000
313300           END-IF                                                 31330000
313400        ELSE                                                      31340000
313500           IF TRNCDE-COST-PRCCTL-CDE = 'N'                        31350000
313600              SET DP020-MSG-FATAL    TO TRUE                      31360000
313700              MOVE DP015-UNP-ALP-BRT-OFF TO AGRCSTA               31370000
313800              MOVE DP015-RED       TO AGRCSTC                     31380000
313900              MOVE DP015-REVERSE   TO AGRCSTH                     31390000
314000              MOVE -1              TO AGRCSTL                     31400000
314100              IF PS-NO-ERROR                                      31410000
314200                 MOVE PC-TSYMSG-01906 TO DP020-MSG-NUMBER         31420000
314300              END-IF                                              31430000
314400              SET PS-ERROR   TO TRUE                              31440000
314500           END-IF                                                 31450000
314600        END-IF                                                    31460000
314700     ELSE                                                         31470000
314800        INITIALIZE ASC-GROSS-COST                                 31480000
314900*       IF TRNCDE-COST-PRCCTL-CDE = 'R'                           31490000
315000*          SET DP020-MSG-FATAL    TO TRUE                         31500000
315100*          MOVE DP015-UNP-ALP-BRT-OFF TO AGRCSTA                  31510000
315200*          MOVE DP015-RED       TO AGRCSTC                        31520000
315300*          MOVE DP015-REVERSE   TO AGRCSTH                        31530000
315400*          MOVE -1              TO AGRCSTL                        31540000
315500*          IF PS-NO-ERROR                                         31550000
315600*             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER            31560000
315700*          END-IF                                                 31570000
315800*          SET PS-ERROR   TO TRUE                                 31580000
315900*       END-IF                                                    31590000
316000     END-IF.                                                      31600000
316100                                                                  31610000
316200******************************************************************31620000
316300* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED RETAIL    *31630000
316400* AMOUNT FIELD.                                                  *31640000
316500******************************************************************31650000
316600 3090-EDIT-RETAIL-COST.                                           31660000
316700                                                                  31670000
316800     IF ASC-ALP-RET-COST > SPACES AND                             31680000
316900        ASC-ALP-RET-COST NOT EQUAL TO '000000000000'              31690000
317000        IF TRNCDE-RTL-PRCCTL-CDE = 'A' OR                         31700000
317100           TRNCDE-RTL-PRCCTL-CDE = 'R'                            31710000
317200           MOVE ASC-ALP-RET-COST TO DP010I-UNEDITED-FIELD         31720000
317300           MOVE 10             TO DP010I-MAXIMUM-DIGITS           31730000
317400           MOVE 2              TO DP010I-MAXIMUM-DECIMALS         31740000
317500           SET DP010I-NEGATIVE-ALLOWED                            31750000
317600                               TO TRUE                            31760000
317700                                                                  31770000
317810           CALL DP010I-NUMERIC-EDIT-ROUTINE                       31781059
317820                         USING DP010I-NUMERIC-EDIT-AREA           31782059
317900                                                                  31790000
318000           IF DP010I-ERROR-DETECTED                               31800000
318100               SET DP020-MSG-FATAL TO TRUE                        31810000
318200** RETAIL AMOUNT MUST BE NUMERIC.                                 31820000
318300               MOVE DP015-UNP-ALP-BRT-OFF TO ARETCSTA             31830000
318400               MOVE DP015-RED       TO ARETCSTC                   31840000
318500               MOVE DP015-REVERSE   TO ARETCSTH                   31850000
318600               MOVE -1              TO ARETCSTL                   31860000
318700              IF PS-NO-ERROR                                      31870000
318800                   MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER       31880000
318900              END-IF                                              31890000
319000               SET PS-ERROR   TO TRUE                             31900000
319100           ELSE                                                   31910000
319200               MOVE DP010I-NUMERIC-FIELD                          31920000
319300                                TO ASC-RETAIL-AMT                 31930000
319400                                   ASC-ALP-RET-COST-9             31940000
319500               IF ASC-RETAIL-AMT < 0 AND                          31950000
319600                  TRNCDE-PSTG-TYP-CDE = 'CH'                      31960000
319700                  SET DP020-MSG-FATAL TO TRUE                     31970000
319800                  MOVE DP015-UNP-ALP-BRT-OFF TO ARETCSTA          31980000
319900                  MOVE DP015-RED             TO ARETCSTC          31990000
320000                  MOVE DP015-REVERSE         TO ARETCSTH          32000000
320100                  MOVE -1                    TO ARETCSTL          32010000
320200                  IF PS-NO-ERROR                                  32020000
320300                     MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER  32030000
320400                  END-IF                                          32040000
320500                  SET PS-ERROR TO TRUE                            32050000
320600               END-IF                                             32060000
320700               IF ASC-RETAIL-AMT > 0 AND                          32070000
320800                  TRNCDE-PSTG-TYP-CDE = 'CR'                      32080000
320900                  SET DP020-MSG-FATAL    TO TRUE                  32090000
321000                  MOVE DP015-UNP-ALP-BRT-OFF TO ARETCSTA          32100000
321100                  MOVE DP015-RED             TO ARETCSTC          32110000
321200                  MOVE DP015-REVERSE         TO ARETCSTH          32120000
321300                  MOVE -1                    TO ARETCSTL          32130000
321400                  IF PS-NO-ERROR                                  32140000
321500                       MOVE PC-TSYMSG-01902 TO DP020-MSG-NUMBER   32150000
321600                  END-IF                                          32160000
321700                  SET PS-ERROR TO TRUE                            32170000
321800               END-IF                                             32180000
321900           END-IF                                                 32190000
322000        ELSE                                                      32200000
322100           IF TRNCDE-RTL-PRCCTL-CDE = 'N'                         32210000
322200              SET DP020-MSG-FATAL    TO TRUE                      32220000
322300              MOVE DP015-UNP-ALP-BRT-OFF TO ARETCSTA              32230000
322400              MOVE DP015-RED       TO ARETCSTC                    32240000
322500              MOVE DP015-REVERSE   TO ARETCSTH                    32250000
322600              MOVE -1              TO ARETCSTL                    32260000
322700              IF PS-NO-ERROR                                      32270000
322800                 MOVE PC-TSYMSG-01901 TO DP020-MSG-NUMBER         32280000
322900              END-IF                                              32290000
323000              SET PS-ERROR   TO TRUE                              32300000
323100           END-IF                                                 32310000
323200        END-IF                                                    32320000
323300     ELSE                                                         32330000
323400        INITIALIZE ASC-RETAIL-AMT                                 32340000
323500        IF TRNCDE-RTL-PRCCTL-CDE = 'R'                            32350000
323600           SET DP020-MSG-FATAL    TO TRUE                         32360000
323700           MOVE DP015-UNP-ALP-BRT-OFF TO ARETCSTA                 32370000
323800           MOVE DP015-RED       TO ARETCSTC                       32380000
323900           MOVE DP015-REVERSE   TO ARETCSTH                       32390000
324000           MOVE -1              TO ARETCSTL                       32400000
324100           IF PS-NO-ERROR                                         32410000
324200              MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER            32420000
324300           END-IF                                                 32430000
324400           SET PS-ERROR   TO TRUE                                 32440000
324500        END-IF                                                    32450000
324600     END-IF.                                                      32460000
324700                                                                  32470000
324800******************************************************************32480000
324900* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED DUE DATE. *32490000
325000* IF A DUE DATE IS NOT ENTERED THE DEFAULT IS THE CURRENT DATE.  *32500000
325100******************************************************************32510000
325200 3150-EDIT-DUE-DATE.                                              32520000
325300                                                                  32530000
325400     IF ASC-DUE-DATE = SPACES OR                                  32540000
325500        ASC-DUE-DATE = LOW-VALUES                                 32550000
325600        IF ASC-ADD-PENDING OR                                     32560000
325700           ASC-UPDATE-REQUESTED                                   32570000
325800           MOVE ASC-CURRENT-DATE TO ASC-DUE-DATE                  32580000
325900        END-IF                                                    32590000
326000     ELSE                                                         32600000
326100        IF ASC-DUE-DATE-MM = SPACES AND                           32610000
326200           ASC-DUE-DATE > SPACES                                  32620000
326300           SET DP020-MSG-FATAL       TO TRUE                      32630000
326400           MOVE DP015-UNP-ALP-BRT-OFF TO ADUEMMA                  32640000
326500           MOVE DP015-RED            TO ADUEMMC                   32650000
326600           MOVE DP015-REVERSE        TO ADUEMMH                   32660000
326700           MOVE -1                   TO ADUEMML                   32670000
326800           IF PS-NO-ERROR                                         32680000
326900               MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER           32690000
327000           END-IF                                                 32700000
327100           SET PS-ERROR              TO TRUE                      32710000
327200        END-IF                                                    32720000
327300                                                                  32730000
327400        IF ASC-DUE-DATE-DD = SPACES AND                           32740000
327500           ASC-DUE-DATE > SPACES                                  32750000
327600           SET DP020-MSG-FATAL       TO TRUE                      32760000
327700           MOVE DP015-UNP-ALP-BRT-OFF TO ADUEDDA                  32770000
327800           MOVE DP015-RED            TO ADUEDDC                   32780000
327900           MOVE DP015-REVERSE        TO ADUEDDH                   32790000
328000           MOVE -1                   TO ADUEDDL                   32800000
328100           IF PS-NO-ERROR                                         32810000
328200               MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER           32820000
328300           END-IF                                                 32830000
328400           SET PS-ERROR              TO TRUE                      32840000
328500        END-IF                                                    32850000
328600                                                                  32860000
328700        IF ASC-DUE-DATE-YY = SPACES AND                           32870000
328800           ASC-DUE-DATE > SPACES                                  32880000
328900           SET DP020-MSG-FATAL       TO TRUE                      32890000
329000           MOVE DP015-UNP-ALP-BRT-OFF TO ADUEYYA                  32900000
329100           MOVE DP015-RED            TO ADUEYYC                   32910000
329200           MOVE DP015-REVERSE        TO ADUEYYH                   32920000
329300           MOVE -1                   TO ADUEYYL                   32930000
329400           IF PS-NO-ERROR                                         32940000
329500               MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER           32950000
329600           END-IF                                                 32960000
329700           SET PS-ERROR              TO TRUE                      32970000
329800        END-IF                                                    32980000
329900                                                                  32990000
330000        IF ADUEMML = -1 OR                                        33000000
330100           ADUEDDL = -1 OR                                        33010000
330200           ADUEYYL = -1                                           33020000
330300           CONTINUE                                               33030000
330400        ELSE                                                      33040000
330500           MOVE ASC-DUE-DATE TO PV-CCYYMMDD-DATE                  33050000
330600           PERFORM 3155-EDIT-DATE                                 33060000
330700           MOVE PV-CCYYMMDD-DATE TO ASC-DUE-DATE                  33070000
330800           IF PS-VALID-DATE                                       33080000
330900              IF ASC-DUE-DATE < ASC-CURRENT-DATE                  33090000
331000                 MOVE DP015-UNP-ALP-BRT-OFF TO                    33100000
331100                                         ADUEMMA                  33110000
331200                                         ADUEDDA                  33120000
331300                                         ADUEYYA                  33130000
331400                 MOVE DP015-RED       TO ADUEMMC                  33140000
331500                                         ADUEDDC                  33150000
331600                                         ADUEYYC                  33160000
331700                 MOVE DP015-REVERSE   TO ADUEMMH                  33170000
331800                                         ADUEDDH                  33180000
331900                                         ADUEYYH                  33190000
332000                 MOVE -1              TO ADUEMML                  33200000
332100                 IF PS-NO-ERROR                                   33210000
332200                    MOVE PC-TSYMSG-01968                          33220000
332300                                      TO DP020-MSG-NUMBER         33230000
332400                 END-IF                                           33240000
332500                 SET PS-ERROR                                     33250000
332600                     DP020-MSG-FATAL  TO TRUE                     33260000
332700              END-IF                                              33270000
332800           ELSE                                                   33280000
332900              MOVE DP015-UNP-ALP-BRT-OFF                          33290000
333000                                      TO ADUEMMA                  33300000
333100                                         ADUEDDA                  33310000
333200                                         ADUEYYA                  33320000
333300              MOVE DP015-RED       TO ADUEMMC                     33330000
333400                                         ADUEDDC                  33340000
333500                                         ADUEYYC                  33350000
333600              MOVE DP015-REVERSE   TO ADUEMMH                     33360000
333700                                         ADUEDDH                  33370000
333800                                         ADUEYYH                  33380000
333900              MOVE -1              TO ADUEMML                     33390000
334000              IF PS-NO-ERROR                                      33400000
334100                 IF PS-INVALID-DATE                               33410000
334200                    MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER      33420000
334300                 END-IF                                           33430000
334400              END-IF                                              33440000
334500              SET PS-ERROR                                        33450000
334600                  DP020-MSG-FATAL   TO TRUE                       33460000
334700           END-IF                                                 33470000
334800        END-IF                                                    33480000
334900     END-IF.                                                      33490000
335000                                                                  33500000
335100******************************************************************33510000
335200* THIS PARAGRAPH PERFORMS THE COMMON DATE EDITS.                 *33520000
335300******************************************************************33530000
335400 3155-EDIT-DATE.                                                  33540000
335500                                                                  33550000
335600     IF PV-MM NUMERIC                                             33560000
335700     OR PV-MM = SPACE                                             33570000
335800         CONTINUE                                                 33580000
335900     ELSE                                                         33590000
336000         MOVE PV-MM                  TO DP010I-UNEDITED-FIELD     33600000
336100         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     33610000
336200         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   33620000
336300         SET DP010I-NEGATIVE-NOT-ALLOWED                          33630000
336400                                     TO TRUE                      33640000
336510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         33651059
336520                         USING DP010I-NUMERIC-EDIT-AREA           33652059
336600         IF DP010I-ERROR-DETECTED                                 33660000
336700             CONTINUE                                             33670000
336800         ELSE                                                     33680000
336900             MOVE DP010I-NUMERIC-FIELD                            33690000
337000                                     TO PV-MM-9                   33700000
337100         END-IF                                                   33710000
337200     END-IF.                                                      33720000
337300                                                                  33730000
337400     IF PV-DD NUMERIC                                             33740000
337500     OR PV-DD = SPACE                                             33750000
337600         CONTINUE                                                 33760000
337700     ELSE                                                         33770000
337800         MOVE PV-DD                  TO DP010I-UNEDITED-FIELD     33780000
337900         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     33790000
338000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   33800000
338100         SET DP010I-NEGATIVE-NOT-ALLOWED                          33810000
338200                                     TO TRUE                      33820000
338310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         33831059
338320                         USING DP010I-NUMERIC-EDIT-AREA           33832059
338400         IF DP010I-ERROR-DETECTED                                 33840000
338500             CONTINUE                                             33850000
338600         ELSE                                                     33860000
338700             MOVE DP010I-NUMERIC-FIELD                            33870000
338800                                     TO PV-DD-9                   33880000
338900         END-IF                                                   33890000
339000     END-IF.                                                      33900000
339100                                                                  33910000
339200     IF PV-DD NUMERIC                                             33920000
339300     OR PV-DD = SPACE                                             33930000
339400         CONTINUE                                                 33940000
339500     ELSE                                                         33950000
339600         MOVE PV-DD                  TO DP010I-UNEDITED-FIELD     33960000
339700         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     33970000
339800         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   33980000
339900         SET DP010I-NEGATIVE-NOT-ALLOWED                          33990000
340000                                     TO TRUE                      34000000
340110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         34011059
340120                         USING DP010I-NUMERIC-EDIT-AREA           34012059
340200         IF DP010I-ERROR-DETECTED                                 34020000
340300             CONTINUE                                             34030000
340400         ELSE                                                     34040000
340500             MOVE DP010I-NUMERIC-FIELD                            34050000
340600                                     TO PV-DD-9                   34060000
340700         END-IF                                                   34070000
340800     END-IF.                                                      34080000
340900                                                                  34090000
341000     IF PV-CCYY = SPACE                                           34100000
341100         CONTINUE                                                 34110000
341200     ELSE                                                         34120000
341300         IF PV-CCYY NUMERIC                                       34130000
341400             IF PV-YY < 80                                        34140000
341500                 MOVE 20             TO PV-CC                     34150000
341600             ELSE                                                 34160000
341700                 MOVE 19             TO PV-CC                     34170000
341800             END-IF                                               34180000
341900         ELSE                                                     34190000
342000             MOVE PV-CCYY            TO DP010I-UNEDITED-FIELD     34200000
342100             MOVE 4                  TO DP010I-MAXIMUM-DIGITS     34210000
342200             MOVE 0                  TO DP010I-MAXIMUM-DECIMALS   34220000
342300             SET DP010I-NEGATIVE-NOT-ALLOWED                      34230000
342400                                         TO TRUE                  34240000
342510             CALL DP010I-NUMERIC-EDIT-ROUTINE                     34251059
342520                         USING DP010I-NUMERIC-EDIT-AREA           34252059
342600             IF DP010I-ERROR-DETECTED                             34260000
342700                 CONTINUE                                         34270000
342800             ELSE                                                 34280000
342900                 MOVE DP010I-NUMERIC-FIELD                        34290000
343000                                         TO PV-CCYY-9             34300000
343100*        ALLOW THEM TO ENTER A TWO DIGIT YEAR W/OUT CENTURY       34310000
343200                 IF PV-YY < 80                                    34320000
343300                     MOVE 20             TO PV-CC                 34330000
343400                 ELSE                                             34340000
343500                     IF PV-CCYY-9 > 1999                          34350000
343600                         CONTINUE                                 34360000
343700                     ELSE                                         34370000
343800                         MOVE 19         TO PV-CC                 34380000
343900                     END-IF                                       34390000
344000                 END-IF                                           34400000
344100             END-IF                                               34410000
344200         END-IF                                                   34420000
344300     END-IF.                                                      34430000
344400                                                                  34440000
344500     SET PS-VALID-DATE TO TRUE.                                   34450000
344600                                                                  34460000
344700     INITIALIZE DPG51                                             34470000
344800                DPG52                                             34480000
344900                DPG53                                             34490000
345000                DPG54                                             34500000
345100                DPG55                                             34510000
345200                DPG56.                                            34520000
345300                                                                  34530000
345400*Y2K MOVE 'A0'                 TO DPG51-CALENDAR-TYPE.            34540000
345500     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      34550000
345600                                                                  34560000
345700     SET DPG51-DO-NOT-INCR-DECR-DATE                              34570000
345800         DPG52-LK-DTE-ISO-FMT  TO TRUE.                           34580000
345900                                                                  34590000
346000     IF PV-CCYY NUMERIC AND                                       34600000
346100        PV-MM NUMERIC AND                                         34610000
346200        PV-DD NUMERIC                                             34620000
346300         MOVE '-'  TO PV-DASH1                                    34630000
346400                          PV-DASH2                                34640000
346500         MOVE PV-CCYYMMDD-DATE TO DPG52-LK-DATE-INPUT             34650000
346600                                                                  34660000
346700         CALL DP500-KOHLS-CALENDAR-ROUTINE                        34670000
346800             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            34680000
346900                                                                  34690000
347000* Y2K    IF (DPG54-DATE-INVALID OR                                34700000
347100         IF (DPG54-WARNING-ERROR OR                               34710000
347200             DPG54-SEVERE-ERROR)                                  34720000
347300             SET PS-INVALID-DATE TO TRUE                          34730000
347400         END-IF                                                   34740000
347500     ELSE                                                         34750000
347600         SET PS-INVALID-DATE TO TRUE                              34760000
347700     END-IF.                                                      34770000
347800                                                                  34780000
347900******************************************************************34790000
348000* THIS PARAGRAPH WILL PERFORM EDITS FOR THE TWO REASON TEXT      *34800000
348100* LINES.                                                         *34810000
348200******************************************************************34820000
348300 3160-EDIT-REASON-TEXTS.                                          34830000
348400                                                                  34840000
348500     IF ASC-TXT-REQR-IND = 'Y' AND                                34850000
348600        ASC-REASON-CODE1 = SPACES AND                             34860000
348700        ASC-REASON-CODE2 = SPACES                                 34870000
348800        SET DP020-MSG-FATAL          TO TRUE                      34880000
348900        MOVE DP015-UNP-ALP-BRT-OFF   TO AREAS1A                   34890000
349000                                        AREAS2A                   34900000
349100        MOVE DP015-RED               TO AREAS1C                   34910000
349200                                        AREAS2C                   34920000
349300        MOVE DP015-REVERSE           TO AREAS1H                   34930000
349400                                        AREAS2H                   34940000
349500        MOVE -1                      TO AREAS1L                   34950000
349600                                        AREAS2L                   34960000
349700        IF PS-NO-ERROR                                            34970000
349800            MOVE PC-TSYMSG-00007     TO DP020-MSG-NUMBER          34980000
349900        END-IF                                                    34990000
350000        SET PS-ERROR                 TO TRUE                      35000000
350100     END-IF.                                                      35010000
350200                                                                  35020000
350300******************************************************************35030000
350400* THIS PARAGRAPH WILL PERFORM EDITS ON THE CURRENT OR PREVIOUS   *35040000
350500* MONTH POSTING FLAG.                                            *35050000
350600******************************************************************35060000
350700 3170-EDIT-C-P-FLAG.                                              35070000
350800                                                                  35080000
350900     IF ASC-MULTI-PSTG-PERIOD AND                                 35090000
351000        ASC-APPL-MTH NOT EQUAL 'C' AND                            35100000
351100        ASC-APPL-MTH NOT EQUAL 'P'                                35110000
351200        SET DP020-MSG-FATAL          TO TRUE                      35120000
351300        MOVE DP015-UNP-ALP-BRT-OFF   TO AAPLMTHA                  35130000
351400        MOVE DP015-RED               TO AAPLMTHC                  35140000
351500        MOVE DP015-REVERSE           TO AAPLMTHH                  35150000
351600        MOVE -1                      TO AAPLMTHL                  35160000
351700        IF PS-NO-ERROR                                            35170000
351800            MOVE PC-TSYMSG-01916     TO DP020-MSG-NUMBER          35180000
351900        END-IF                                                    35190000
352000        SET PS-ERROR                 TO TRUE                      35200000
352100     END-IF.                                                      35210000
352200                                                                  35220000
352300******************************************************************35230000
352400* THIS PARAGRAPH WILL PERFORM EDITS ON THE DISTRIBUTION STORE.   *35240000
352500******************************************************************35250000
352600 3180-EDIT-DISTRO-STORE.                                          35260000
352700                                                                  35270000
352800     IF ASC-STORE = ZERO                                          35280000
352900        IF ASC-ALP-DET-STORE = SPACES                             35290000
353000           SET DP020-MSG-FATAL       TO TRUE                      35300000
353100           MOVE DP015-UNP-ALP-BRT-OFF                             35310000
353200                                     TO ASTR01A                   35320000
353300           MOVE DP015-REVERSE        TO ASTR01H                   35330000
353400           MOVE DP015-RED            TO ASTR01C                   35340000
353500           MOVE -1                   TO ASTR01L                   35350000
353600           IF PS-NO-ERROR                                         35360000
353700              MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER          35370000
353800           END-IF                                                 35380000
353900           SET PS-ERROR              TO TRUE                      35390000
354000        END-IF                                                    35400000
354100     END-IF.                                                      35410000
354200                                                                  35420000
354300* MB IF PS-NO-ERROR AND                                           35430000
354400* MB    ASC-ALP-DET-STORE NOT NUMERIC AND                         35440000
354500* MB    ASC-ALP-DET-STORE > SPACES                                35450000
354600* MB    SET DP020-MSG-FATAL          TO TRUE                      35460000
354700* MB    MOVE DP015-UNP-ALP-BRT-OFF   TO ASTR01A                   35470000
354800* MB    MOVE DP015-REVERSE           TO ASTR01H                   35480000
354900* MB    MOVE DP015-RED               TO ASTR01C                   35490000
355000* MB    MOVE -1                      TO ASTR01L                   35500000
355100* MB    IF PS-NO-ERROR                                            35510000
355200* MB       MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER          35520000
355300* MB    END-IF                                                    35530000
355400* MB    SET PS-ERROR                 TO TRUE                      35540000
355500* MB END-IF.                                                      35550000
355600                                                                  35560000
355700     SET ASC-HD-STORE-NOT-FOUND TO TRUE.                          35570000
355800                                                                  35580000
355900     IF ASC-ALP-DET-STORE > SPACES                                35590000
356000        MOVE ASC-ALP-DET-STORE       TO DP010I-UNEDITED-FIELD     35600000
356100        MOVE 4                       TO DP010I-MAXIMUM-DIGITS     35610000
356200        MOVE 0                       TO DP010I-MAXIMUM-DECIMALS   35620000
356300        SET DP010I-NEGATIVE-NOT-ALLOWED                           35630000
356400                                     TO TRUE                      35640000
356510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         35651059
356520                         USING DP010I-NUMERIC-EDIT-AREA           35652059
356600        IF DP010I-ERROR-DETECTED                                  35660000
356700           SET DP020-MSG-FATAL TO TRUE                            35670000
356800           MOVE DP015-UNP-ALP-BRT-OFF                             35680000
356900                                     TO ASTR01A                   35690000
357000           MOVE DP015-RED            TO ASTR01C                   35700000
357100           MOVE DP015-REVERSE        TO ASTR01H                   35710000
357200           MOVE -1                   TO ASTR01L                   35720000
357300           IF PS-NO-ERROR                                         35730000
357400              MOVE PC-TSYMSG-00008   TO DP020-MSG-NUMBER          35740000
357500           END-IF                                                 35750000
357600           SET PS-ERROR TO TRUE                                   35760000
357700        ELSE                                                      35770000
357800           MOVE DP010I-NUMERIC-FIELD        TO ASC-DET-STORE      35780000
357900                                               PV-STORE-NBR-4     35790000
358000           MOVE PV-STORE-NBR-4 TO XFT00017-LOC-NBR                35800000
358100*          MOVE PV-STORE-NBR-4 TO XFT00003-LOC-NBR                35810000
358200*MAB 07-22-99 BEGIN                                               35820000
358300           IF ASC-DET-STORE > 9998 OR                             35830000
358400              ASC-DET-STORE = 80                                  35840000
358500              SET ASC-HD-STORE-NOT-FOUND TO TRUE                  35850000
358600           ELSE                                                   35860000
358700*MAB 07-22-99 END                                                 35870000
358800              PERFORM 7400-VALIDATE-STORE                         35880000
358900           END-IF                                                 35890000
359000** STORE IN HEADER IS GREATER THAN ZERO AND DOES NOT EQUAL THE    35900000
359100** STORE IN THE DISTRIBUTION PORTION OF THE SCREEN.               35910000
359200           IF ASC-STORE GREATER THAN ZERO AND                     35920000
359300              (ASC-STORE NOT EQUAL TO ASC-DET-STORE)              35930000
359400              MOVE DP015-UNP-ALP-BRT-OFF                          35940000
359500                                    TO ASTR01A                    35950000
359600              MOVE DP015-RED        TO ASTR01C                    35960000
359700              MOVE DP015-REVERSE    TO ASTR01H                    35970000
359800              MOVE -1               TO ASTR01L                    35980000
359900              IF PS-NO-ERROR                                      35990000
360000                 MOVE PC-TSYMSG-01920 TO DP020-MSG-NUMBER         36000000
360100              END-IF                                              36010000
360200              SET PS-ERROR          TO TRUE                       36020000
360300           END-IF                                                 36030000
360400           IF ASC-HD-STORE-NOT-FOUND                              36040000
360500              MOVE DP015-UNP-ALP-BRT-OFF                          36050000
360600                                       TO ASTR01A                 36060000
360700              MOVE DP015-RED           TO ASTR01C                 36070000
360800              MOVE DP015-REVERSE       TO ASTR01H                 36080000
360900              MOVE -1                  TO ASTR01L                 36090000
361000              IF PS-NO-ERROR                                      36100000
361100                 MOVE PC-TSYMSG-01904 TO DP020-MSG-NUMBER         36110000
361200              END-IF                                              36120000
361300              SET PS-ERROR             TO TRUE                    36130000
361400           END-IF                                                 36140000
361500        ELSE                                                      36150000
361600           IF ASC-STORE > ZERO                                    36160000
361700              MOVE ASC-STORE           TO ASC-DET-STORE           36170000
361800           END-IF                                                 36180000
361900        END-IF.                                                   36190000
362000                                                                  36200000
362100******************************************************************36210000
362200* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *36220000
362300* MAP.                                                           *36230000
362400******************************************************************36240000
362500 3200-RESET-ATTRIBUTES.                                           36250000
362600                                                                  36260000
362700     IF ASC-UPDATE-PENDING OR                                     36270000
362800        ASC-DELETE-REQUESTED                                      36280000
362900** PROTECT KEY FIELDS FOR UPDATE                                  36290000
363000        MOVE DP015-PRO-NOR-OFF     TO ATRANCDA                    36300000
363100                                      ADOCNUMA                    36310000
363200                                      ADOCMMA                     36320000
363300                                      ADOCDDA                     36330000
363400                                      ADOCYYA                     36340000
363500                                      AVENDNOA                    36350000
363600                                      AOFFBYPA                    36360000
363700                                      AOFFACTA                    36370000
363800        MOVE DP015-BLUE            TO ATRANCDC                    36380000
363900                                      ADOCNUMC                    36390000
364000                                      ADOCMMC                     36400000
364100                                      ADOCDDC                     36410000
364200                                      ADOCYYC                     36420000
364300                                      AVENDNOC                    36430000
364400                                      AOFFBYPC                    36440000
364500                                      AOFFACTC                    36450000
364600        MOVE DP015-HL-OFF          TO ATRANCDH                    36460000
364700                                      ADOCNUMH                    36470000
364800                                      ADOCMMH                     36480000
364900                                      ADOCDDH                     36490000
365000                                      ADOCYYH                     36500000
365100                                      AVENDNOH                    36510000
365200                                      AOFFBYPH                    36520000
365300                                      AOFFACTH                    36530000
365400        IF ASC-DELETE-REQUESTED                                   36540000
365500           MOVE DP015-PRO-NOR-OFF  TO ABARCDA                     36550000
365600                                      ASTRNMA                     36560000
365700                                      ADEPTA                      36570000
365800                                      AACCNOA                     36580000
365900                                      AVENDAA                     36590000
366000                                      AHOLDA                      36600000
366100                                      ADUEMMA                     36610000
366200                                      ADUEDDA                     36620000
366300                                      ADUEYYA                     36630000
366400                                      AREAS1A                     36640000
366500                                      AREAS2A                     36650000
366600                                      APONUMA                     36660000
366700           MOVE DP015-BLUE         TO ABARCDC                     36670000
366800                                      ASTRNMC                     36680000
366900                                      ADEPTC                      36690000
367000                                      AACCNOC                     36700000
367100                                      AVENDAC                     36710000
367200                                      AHOLDC                      36720000
367300                                      ADUEMMC                     36730000
367400                                      ADUEDDC                     36740000
367500                                      ADUEYYC                     36750000
367600                                      AREAS1C                     36760000
367700                                      AREAS2C                     36770000
367800                                      APONUMC                     36780000
367900           MOVE DP015-HL-OFF       TO ABARCDH                     36790000
368000                                      ASTRNMH                     36800000
368100                                      ADEPTH                      36810000
368200                                      AACCNOH                     36820000
368300                                      AVENDAH                     36830000
368400                                      AHOLDH                      36840000
368500                                      ADUEMMH                     36850000
368600                                      ADUEDDH                     36860000
368700                                      ADUEYYH                     36870000
368800                                      AREAS1H                     36880000
368900                                      AREAS2H                     36890000
369000                                      APONUMH                     36900000
369100        ELSE                                                      36910000
369200           MOVE DP015-UNP-ALP-NOR-OFF TO ABARCDA                  36920000
369300                                         ASTRNMA                  36930000
369400                                         ADEPTA                   36940000
369500                                         AACCNOA                  36950000
369600                                         AVENDAA                  36960000
369700                                         AHOLDA                   36970000
369800                                         ADUEMMA                  36980000
369900                                         ADUEDDA                  36990000
370000                                         ADUEYYA                  37000000
370100                                         AREAS1A                  37010000
370200                                         AREAS2A                  37020000
370300                                         APONUMA                  37030000
370400           MOVE DP015-GREEN           TO ABARCDC                  37040000
370500                                         ASTRNMC                  37050000
370600                                         ADEPTC                   37060000
370700                                         AACCNOC                  37070000
370800                                         AVENDAC                  37080000
370900                                         AHOLDC                   37090000
371000                                         ADUEMMC                  37100000
371100                                         ADUEDDC                  37110000
371200                                         ADUEYYC                  37120000
371300                                         AREAS1C                  37130000
371400                                         AREAS2C                  37140000
371500                                         APONUMC                  37150000
371600           MOVE DP015-UNDERLINE       TO ABARCDH                  37160000
371700                                         ASTRNMH                  37170000
371800                                         ADEPTH                   37180000
371900                                         AACCNOH                  37190000
372000                                         AVENDAH                  37200000
372100                                         AHOLDH                   37210000
372200                                         ADUEMMH                  37220000
372300                                         ADUEDDH                  37230000
372400                                         ADUEYYH                  37240000
372500                                         AREAS1H                  37250000
372600                                         AREAS2H                  37260000
372700                                         APONUMH                  37270000
372800        END-IF                                                    37280000
372900     ELSE                                                         37290000
373000        MOVE DP015-UNP-ALP-NOR-OFF TO ATRANCDA                    37300000
373100                                      ADOCNUMA                    37310000
373200                                      ADOCMMA                     37320000
373300                                      ADOCDDA                     37330000
373400                                      ADOCYYA                     37340000
373500                                      AVENDNOA                    37350000
373600                                      APONUMA                     37360000
373700                                      ADEPTA                      37370000
373800                                      ASTRNMA                     37380000
373900                                      ABARCDA                     37390000
374000                                      ADUEMMA                     37400000
374100                                      ADUEDDA                     37410000
374200                                      ADUEYYA                     37420000
374300                                      AACCNOA                     37430000
374400                                      AREAS1A                     37440000
374500                                      AREAS2A                     37450000
374600                                      AOFFBYPA                    37460000
374700                                      AOFFACTA                    37470000
374800        MOVE DP015-GREEN           TO ATRANCDC                    37480000
374900                                      ADOCNUMC                    37490000
375000                                      ADOCMMC                     37500000
375100                                      ADOCDDC                     37510000
375200                                      ADOCYYC                     37520000
375300                                      AVENDNOC                    37530000
375400                                      APONUMC                     37540000
375500                                      ADEPTC                      37550000
375600                                      ASTRNMC                     37560000
375700                                      ABARCDC                     37570000
375800                                      ADUEMMC                     37580000
375900                                      ADUEDDC                     37590000
376000                                      ADUEYYC                     37600000
376100                                      AACCNOC                     37610000
376200                                      AREAS1C                     37620000
376300                                      AREAS2C                     37630000
376400                                      AOFFBYPC                    37640000
376500                                      AOFFACTC                    37650000
376600        MOVE DP015-UNDERLINE       TO ATRANCDH                    37660000
376700                                      ADOCNUMH                    37670000
376800                                      ADOCMMH                     37680000
376900                                      ADOCDDH                     37690000
377000                                      ADOCYYH                     37700000
377100                                      AVENDNOH                    37710000
377200                                      APONUMH                     37720000
377300                                      ADEPTH                      37730000
377400                                      ASTRNMH                     37740000
377500                                      ABARCDH                     37750000
377600                                      ADUEMMH                     37760000
377700                                      ADUEDDH                     37770000
377800                                      ADUEYYH                     37780000
377900                                      AACCNOH                     37790000
378000                                      AREAS1H                     37800000
378100                                      AREAS2H                     37810000
378200                                      AOFFBYPH                    37820000
378300                                      AOFFACTH                    37830000
378400     END-IF.                                                      37840000
378500                                                                  37850000
378600     MOVE DP015-UNP-ALP-NOR-OFF    TO AGRCSTA                     37860000
378700                                      ARETCSTA                    37870000
378800                                      AFRAMTA                     37880000
378900                                      AMISCA                      37890000
379000                                      ADISCPCA                    37900000
379100                                      AMOSPCA                     37910000
379200                                      ANSTRPCA                    37920000
379300                                      ATRADPCA                    37930000
379400                                      ASTR01A                     37940000
379500                                      ACLS01A                     37950000
379600                                      ASKU01A                     37960000
379700                                      ACST01A                     37970000
379800                                      ARET01A.                    37980000
379900     MOVE DP015-GREEN              TO AGRCSTC                     37990000
380000                                      ARETCSTC                    38000000
380100                                      AFRAMTC                     38010000
380200                                      AMISCC                      38020000
380300                                      ADISCPCC                    38030000
380400                                      AMOSPCC                     38040000
380500                                      ANSTRPCC                    38050000
380600                                      ATRADPCC                    38060000
380700                                      ASTR01C                     38070000
380800                                      ACLS01C                     38080000
380900                                      ASKU01C                     38090000
381000                                      ACST01C                     38100000
381100                                      ARET01C.                    38110000
381200     MOVE DP015-UNDERLINE          TO AGRCSTH                     38120000
381300                                      ARETCSTH                    38130000
381400                                      AFRAMTH                     38140000
381500                                      AMISCH                      38150000
381600                                      ADISCPCH                    38160000
381700                                      AMOSPCH                     38170000
381800                                      ANSTRPCH                    38180000
381900                                      ATRADPCH                    38190000
382000                                      ASTR01H                     38200000
382100                                      ACLS01H                     38210000
382200                                      ASKU01H                     38220000
382300                                      ACST01H                     38230000
382400                                      ARET01H.                    38240000
382500                                                                  38250000
382600     IF ASC-OFFSET-TC-NOT-FOUND                                   38260000
382700        MOVE DP015-PRO-NOR-OFF     TO AOFFBYPA                    38270000
382800                                      AOFFACTA                    38280000
382900        MOVE DP015-BLUE            TO AOFFBYPC                    38290000
383000                                      AOFFACTC                    38300000
383100        MOVE DP015-HL-OFF          TO AOFFBYPH                    38310000
383200                                      AOFFACTH                    38320000
383300     END-IF.                                                      38330000
383400                                                                  38340000
383500     IF ASC-OFFSET-ACCT-FOUND                                     38350000
383600        MOVE DP015-PRO-NOR-OFF     TO AOFFACTA                    38360000
383700        MOVE DP015-BLUE            TO AOFFACTC                    38370000
383800        MOVE DP015-HL-OFF          TO AOFFACTH                    38380000
383900     END-IF.                                                      38390000
384000                                                                  38400000
384100     IF ASC-MULTI-PSTG-PERIOD                                     38410000
384200        MOVE DP015-UNP-ALP-NOR-OFF TO AAPLMTHA                    38420000
384300        MOVE DP015-GREEN           TO AAPLMTHC                    38430000
384400        MOVE DP015-UNDERLINE       TO AAPLMTHH                    38440000
384500     ELSE                                                         38450000
384600        MOVE DP015-PRO-DRK-MDT     TO AAPLMTHA                    38460000
384700        MOVE DP015-HL-OFF          TO AAPLMTHH                    38470000
384800        MOVE DP015-PRO-DRK-MDT     TO LABELA                      38480000
384900     END-IF.                                                      38490000
385000                                                                  38500000
385100******************************************************************38510000
385200* THIS PARAGRAPH PERFORMS EDITS ON THE ENTERED FREIGHT COST.     *38520000
385300******************************************************************38530000
385400 3300-EDIT-FREIGHT-AMT.                                           38540000
385500                                                                  38550000
385600     IF ASC-ALP-FREIGHT-COST > SPACES AND                         38560000
385700        ASC-ALP-FREIGHT-COST NOT EQUAL TO '000000000000'          38570000
385800        IF ASC-COST-PRCCTL-CDE = 'N'                              38580000
385900* OR PREV  (ASC-GROSS-COST EQUAL ZERO AND                         38590000
386000*           ASC-RETAIL-AMT NOT EQUAL ZERO)                        38600000
386100           MOVE DP015-UNP-ALP-BRT-OFF TO AFRAMTA                  38610000
386200           MOVE DP015-RED             TO AFRAMTC                  38620000
386300           MOVE DP015-REVERSE         TO AFRAMTH                  38630000
386400           MOVE -1                    TO AFRAMTL                  38640000
386500           IF PS-NO-ERROR                                         38650000
386600              MOVE PC-TSYMSG-01929 TO DP020-MSG-NUMBER            38660000
386700           END-IF                                                 38670000
386800           SET PS-ERROR TO TRUE                                   38680000
386900        ELSE                                                      38690000
387000           MOVE ASC-ALP-FREIGHT-COST TO DP010I-UNEDITED-FIELD     38700000
387100           MOVE 10                   TO DP010I-MAXIMUM-DIGITS     38710000
387200           MOVE 2                    TO DP010I-MAXIMUM-DECIMALS   38720000
387300           SET DP010I-NEGATIVE-ALLOWED                            38730000
387400                                     TO TRUE                      38740000
387500                                                                  38750000
387610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         38761059
387620                         USING DP010I-NUMERIC-EDIT-AREA           38762059
387700                                                                  38770000
387800           IF DP010I-ERROR-DETECTED                               38780000
387900               SET DP020-MSG-FATAL TO TRUE                        38790000
388000*       -- MUST BE NUMERIC --                                     38800000
388100               MOVE DP015-UNP-ALP-BRT-OFF TO AFRAMTA              38810000
388200               MOVE DP015-RED             TO AFRAMTC              38820000
388300               MOVE DP015-REVERSE         TO AFRAMTH              38830000
388400               MOVE -1                    TO AFRAMTL              38840000
388500              IF PS-NO-ERROR                                      38850000
388600                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         38860000
388700              END-IF                                              38870000
388800               SET PS-ERROR   TO TRUE                             38880000
388900           ELSE                                                   38890000
389000               MOVE DP010I-NUMERIC-FIELD TO ASC-FREIGHT-AMT       38900000
389100                                             ASC-ALP-FRT-COST-9   38910000
389200               IF ASC-FREIGHT-AMT < 0 AND                         38920000
389300                  TRNCDE-PSTG-TYP-CDE = 'CH'                      38930000
389400                  SET DP020-MSG-FATAL TO TRUE                     38940000
389500                  MOVE DP015-UNP-ALP-BRT-OFF TO AFRAMTA           38950000
389600                  MOVE DP015-RED             TO AFRAMTC           38960000
389700                  MOVE DP015-REVERSE         TO AFRAMTH           38970000
389800                  MOVE -1                    TO AFRAMTL           38980000
389900                  IF PS-NO-ERROR                                  38990000
390000                     MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER  39000000
390100                  END-IF                                          39010000
390200                  SET PS-ERROR TO TRUE                            39020000
390300               END-IF                                             39030000
390400               IF ASC-FREIGHT-AMT > 0 AND                         39040000
390500                  TRNCDE-PSTG-TYP-CDE = 'CR'                      39050000
390600                  SET DP020-MSG-FATAL    TO TRUE                  39060000
390700                  MOVE DP015-UNP-ALP-BRT-OFF TO AFRAMTA           39070000
390800                  MOVE DP015-RED             TO AFRAMTC           39080000
390900                  MOVE DP015-REVERSE         TO AFRAMTH           39090000
391000                  MOVE -1                    TO AFRAMTL           39100000
391100                  IF PS-NO-ERROR                                  39110000
391200                     MOVE PC-TSYMSG-01902 TO DP020-MSG-NUMBER     39120000
391300                  END-IF                                          39130000
391400                  SET PS-ERROR TO TRUE                            39140000
391500               END-IF                                             39150000
391600           END-IF                                                 39160000
391700        END-IF                                                    39170000
391800     ELSE                                                         39180000
391900        INITIALIZE ASC-FREIGHT-AMT                                39190000
392000        IF TRNCDE-FRGT-REQR-IND = 'Y'                             39200000
392100           SET DP020-MSG-FATAL    TO TRUE                         39210000
392200           MOVE DP015-UNP-ALP-BRT-OFF TO AFRAMTA                  39220000
392300           MOVE DP015-RED             TO AFRAMTC                  39230000
392400           MOVE DP015-REVERSE         TO AFRAMTH                  39240000
392500           MOVE -1                    TO AFRAMTL                  39250000
392600           IF PS-NO-ERROR                                         39260000
392700              MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER            39270000
392800           END-IF                                                 39280000
392900           SET PS-ERROR   TO TRUE                                 39290000
393000        END-IF                                                    39300000
393100     END-IF.                                                      39310000
393200                                                                  39320000
393300******************************************************************39330000
393400* THIS PARAGRAPH PERFORMS EDITS ON THE ENTERED MISCELLANEOUS     *39340000
393500* CHARGE.                                                        *39350000
393600******************************************************************39360000
393700 3310-EDIT-MISC-CHG.                                              39370000
393800                                                                  39380000
393900     IF ASC-ALP-MISC-CHG > SPACES AND                             39390000
394000        ASC-ALP-MISC-CHG NOT EQUAL TO '000000000000'              39400000
394100        IF ASC-COST-PRCCTL-CDE = 'N'                              39410000
394200* OR PREV  ASC-GROSS-COST = ZERO                                  39420000
394300           MOVE DP015-UNP-ALP-BRT-OFF TO AMISCA                   39430000
394400           MOVE DP015-RED             TO AMISCC                   39440000
394500           MOVE DP015-REVERSE         TO AMISCH                   39450000
394600           MOVE -1                    TO AMISCL                   39460000
394700           IF PS-NO-ERROR                                         39470000
394800              MOVE PC-TSYMSG-01929 TO DP020-MSG-NUMBER            39480000
394900           END-IF                                                 39490000
395000           SET PS-ERROR TO TRUE                                   39500000
395100        ELSE                                                      39510000
395200           MOVE ASC-ALP-MISC-CHG     TO DP010I-UNEDITED-FIELD     39520000
395300           MOVE 10                   TO DP010I-MAXIMUM-DIGITS     39530000
395400           MOVE 2                    TO DP010I-MAXIMUM-DECIMALS   39540000
395500           SET DP010I-NEGATIVE-ALLOWED                            39550000
395600                                     TO TRUE                      39560000
395610           CALL DP010I-NUMERIC-EDIT-ROUTINE                       39561059
395620                         USING DP010I-NUMERIC-EDIT-AREA           39562059
395700                                                                  39570000
395800           IF DP010I-ERROR-DETECTED                               39580059
396100               SET DP020-MSG-FATAL TO TRUE                        39610000
396200*       -- MUST BE NUMERIC --                                     39620000
396300               MOVE DP015-UNP-ALP-BRT-OFF TO AMISCA               39630000
396400               MOVE DP015-RED             TO AMISCC               39640000
396500               MOVE DP015-REVERSE         TO AMISCH               39650000
396600               MOVE -1                    TO AMISCL               39660000
396700               IF PS-NO-ERROR                                     39670000
396800                  MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER        39680000
396900               END-IF                                             39690000
397000               SET PS-ERROR   TO TRUE                             39700000
397100           ELSE                                                   39710000
397200               MOVE DP010I-NUMERIC-FIELD  TO ASC-MISC-CHG         39720000
397300                                             ASC-ALP-MISC-CHG-9   39730000
397400               IF ASC-MISC-CHG < 0 AND                            39740000
397500                  TRNCDE-PSTG-TYP-CDE = 'CH'                      39750000
397600                  SET DP020-MSG-FATAL TO TRUE                     39760000
397700                  MOVE DP015-UNP-ALP-BRT-OFF TO AMISCA            39770000
397800                  MOVE DP015-RED             TO AMISCC            39780000
397900                  MOVE DP015-REVERSE         TO AMISCH            39790000
398000                  MOVE -1                    TO AMISCL            39800000
398100                  IF PS-NO-ERROR                                  39810000
398200                     MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER  39820000
398300                  END-IF                                          39830000
398400                  SET PS-ERROR TO TRUE                            39840000
398500               END-IF                                             39850000
398600               IF ASC-MISC-CHG > 0 AND                            39860000
398700                  TRNCDE-PSTG-TYP-CDE = 'CR'                      39870000
398800                  SET DP020-MSG-FATAL        TO TRUE              39880000
398900                  MOVE DP015-UNP-ALP-BRT-OFF TO AMISCA            39890000
399000                  MOVE DP015-RED             TO AMISCC            39900000
399100                  MOVE DP015-REVERSE         TO AMISCH            39910000
399200                  MOVE -1                    TO AMISCL            39920000
399300                  IF PS-NO-ERROR                                  39930000
399400                     MOVE PC-TSYMSG-01902 TO DP020-MSG-NUMBER     39940000
399500                  END-IF                                          39950000
399600                  SET PS-ERROR TO TRUE                            39960000
399700               END-IF                                             39970000
399800          END-IF                                                  39980000
399900        END-IF                                                    39990000
400000     ELSE                                                         40000000
400100        INITIALIZE ASC-MISC-CHG                                   40010000
400200     END-IF.                                                      40020000
400300                                                                  40030000
400400     IF TRNCDE-COST-PRCCTL-CDE = 'R' AND                          40040000
400500        ASC-GROSS-COST         = 0   AND                          40050000
400600        ASC-FREIGHT-AMT        = 0   AND                          40060000
400700        ASC-MISC-CHG           = 0                                40070000
400800        SET DP020-MSG-FATAL    TO TRUE                            40080000
400900        MOVE DP015-UNP-ALP-BRT-OFF TO AGRCSTA                     40090000
401000                                      AFRAMTA                     40100000
401100                                      AMISCA                      40110000
401200        MOVE DP015-RED       TO AGRCSTC                           40120000
401300                                AFRAMTC                           40130000
401400                                AMISCC                            40140000
401500        MOVE DP015-REVERSE   TO AGRCSTH                           40150000
401600                                AFRAMTH                           40160000
401700                                AMISCH                            40170000
401800        MOVE -1              TO AGRCSTL                           40180000
401900        IF PS-NO-ERROR                                            40190000
402000           MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER               40200000
402100        END-IF                                                    40210000
402200        SET PS-ERROR   TO TRUE                                    40220000
402300     END-IF.                                                      40230000
402400                                                                  40240000
402500******************************************************************40250000
402600* THIS PARAGRAPH WILL PERFORM EDITS ON THE COMBINATION OF DOLLAR *40260000
402700* FIELDS.                                                        *40270000
402800******************************************************************40280000
402900 3315-EDIT-DOLLAR-FIELD-COMBO.                                    40290000
403000                                                                  40300000
403100     IF  ASC-GROSS-COST  = 0                                      40310000
403200     AND ASC-RETAIL-AMT  = 0                                      40320000
403300     AND ASC-FREIGHT-AMT = 0                                      40330000
403400     AND ASC-NEW-STR-AMT = 0                                      40340000
403500        SET DP020-MSG-FATAL                  TO TRUE              40350000
403600        MOVE DP015-UNP-ALP-BRT-OFF           TO AGRCSTA           40360000
403700                                                ARETCSTA          40370000
403800                                                AFRAMTA           40380000
403900                                                ANSTRAMA          40390000
404000        MOVE DP015-RED                       TO AGRCSTC           40400000
404100                                                ARETCSTC          40410000
404200                                                AFRAMTC           40420000
404300                                                ANSTRAMC          40430000
404400        MOVE DP015-REVERSE                   TO AGRCSTH           40440000
404500                                                ARETCSTH          40450000
404600                                                AFRAMTH           40460000
404700                                                ANSTRAMH          40470000
404800        MOVE -1                              TO AGRCSTL           40480000
404900                                                ARETCSTL          40490000
405000                                                AFRAMTL           40500000
405100                                                ANSTRAML          40510000
405200        IF PS-NO-ERROR                                            40520000
405300             MOVE PC-TSYMSG-01914 TO DP020-MSG-NUMBER             40530000
405400        END-IF                                                    40540000
405500        SET PS-ERROR TO TRUE                                      40550000
405600     END-IF.                                                      40560000
405700                                                                  40570000
405800     IF  ASC-GROSS-COST     = 0                                   40580000
405900         IF (ASC-RETAIL-AMT NOT = 0                               40590000
406000         AND (ASC-FREIGHT-AMT NOT = 0                             40600000
406100          OR  ASC-MISC-CHG   NOT = 0                              40610000
406200          OR  ASC-NEW-STR-AMT NOT = 0))                           40620000
406300            SET DP020-MSG-FATAL                  TO TRUE          40630000
406400            MOVE DP015-UNP-ALP-BRT-OFF           TO AGRCSTA       40640000
406500                                                    ARETCSTA      40650000
406600                                                    AFRAMTA       40660000
406700                                                    AMISCA        40670000
406800                                                    ANSTRAMA      40680000
406900            MOVE DP015-RED                       TO AGRCSTC       40690000
407000                                                    ARETCSTC      40700000
407100                                                    AFRAMTC       40710000
407200                                                    AMISCC        40720000
407300                                                    ANSTRAMC      40730000
407400            MOVE DP015-REVERSE                   TO AGRCSTH       40740000
407500                                                    ARETCSTH      40750000
407600                                                    AFRAMTH       40760000
407700                                                    AMISCH        40770000
407800                                                    ANSTRAMH      40780000
407900            MOVE -1                              TO AGRCSTL       40790000
408000                                                    ARETCSTL      40800000
408100                                                    AFRAMTL       40810000
408200                                                    AMISCL        40820000
408300                                                    ANSTRAML      40830000
408400*  - INVALID COMBINATION OF RETAIL AND OTHER AMOUNT FIELDS        40840000
408500            IF PS-NO-ERROR                                        40850000
408600                 MOVE PC-TSYMSG-02481 TO DP020-MSG-NUMBER         40860000
408700            END-IF                                                40870000
408800            SET PS-ERROR TO TRUE                                  40880000
408900        END-IF                                                    40890000
409000     END-IF.                                                      40900000
409100                                                                  40910000
409200     IF  PV-NEW-STR-AMT-ENTERED                                   40920000
409300         IF (ASC-GROSS-COST NOT = 0                               40930000
409400         OR  ASC-RETAIL-AMT NOT = 0                               40940000
409500         OR  ASC-FREIGHT-AMT NOT = 0                              40950000
409600         OR  ASC-MISC-CHG   NOT = 0                               40960000
409700         OR  ASC-DISC-PCT   NOT = 0                               40970000
409800         OR  ASC-MOS-PCT    NOT = 0                               40980000
409900         OR  ASC-TRADE-PCT  NOT = 0)                              40990000
410000*  - INVALID COMBINATION OF NEW STORE AMOUNT AND OTHER FIELDS     41000000
410100            SET DP020-MSG-FATAL                  TO TRUE          41010000
410200            MOVE DP015-UNP-ALP-BRT-OFF           TO AGRCSTA       41020000
410300                                                    ARETCSTA      41030000
410400                                                    AFRAMTA       41040000
410500                                                    AMISCA        41050000
410600                                                    ADISCPCA      41060000
410700                                                    AMOSPCA       41070000
410800                                                    ANSTRAMA      41080000
410900                                                    ATRADPCA      41090000
411000            MOVE DP015-RED                       TO AGRCSTC       41100000
411100                                                    ARETCSTC      41110000
411200                                                    AFRAMTC       41120000
411300                                                    AMISCC        41130000
411400                                                    ADISCPCC      41140000
411500                                                    AMOSPCC       41150000
411600                                                    ANSTRAMC      41160000
411700                                                    ATRADPCC      41170000
411800            MOVE DP015-REVERSE                   TO AGRCSTH       41180000
411900                                                    ARETCSTH      41190000
412000                                                    AFRAMTH       41200000
412100                                                    AMISCH        41210000
412200                                                    ADISCPCH      41220000
412300                                                    AMOSPCH       41230000
412400                                                    ANSTRAMH      41240000
412500                                                    ATRADPCH      41250000
412600            MOVE -1                              TO AGRCSTL       41260000
412700                                                    ARETCSTL      41270000
412800                                                    AFRAMTL       41280000
412900                                                    AMISCL        41290000
413000                                                    ADISCPCL      41300000
413100                                                    AMOSPCL       41310000
413200                                                    ANSTRAML      41320000
413300                                                    ATRADPCL      41330000
413400            IF PS-NO-ERROR                                        41340000
413500                 MOVE PC-TSYMSG-03361 TO DP020-MSG-NUMBER         41350000
413600            END-IF                                                41360000
413700            SET PS-ERROR TO TRUE                                  41370000
413800        END-IF                                                    41380000
413900     END-IF.                                                      41390000
414000                                                                  41400000
414100     IF ASC-GROSS-COST NOT EQUAL ZERO                             41410000
414200        SET ASC-GROSS-COST-ALLOCATION TO TRUE                     41420000
414300     ELSE                                                         41430000
414400        IF ASC-FREIGHT-AMT NOT EQUAL ZERO                         41440000
414500           SET ASC-FREIGHT-COST-ALLOCATION TO TRUE                41450000
414600        ELSE                                                      41460000
414700           IF ASC-RETAIL-AMT NOT EQUAL ZERO                       41470000
414800              SET ASC-RETAIL-AMT-ALLOCATION TO TRUE               41480000
414900           ELSE                                                   41490000
415000              IF ASC-NEW-STR-AMT NOT EQUAL ZERO                   41500000
415100                 SET ASC-NEW-STR-COST-ALLOCATION TO TRUE          41510000
415200              END-IF                                              41520000
415300           END-IF                                                 41530000
415400        END-IF                                                    41540000
415500     END-IF.                                                      41550000
415600                                                                  41560000
415700** IF RETAIL AMOUNT AND GROSS COST BOTH                           41570000
415800** ARE NOT EQUAL TO ZERO, CHECK TO SEE IF THE                     41580000
415900** UNSIGNED (OR ABSOLUTE VALUE) GROSS COST IS GREATER THAN THE    41590000
416000** UNSIGNED (OR ABSOLUTE VALUE) RETAIL AMOUNT.  IF THIS IS THE    41600000
416100** CASE A WARNING MESSAGE APPEARS.                                41610000
416200     IF ASC-RETAIL-AMT NOT EQUAL ZERO AND                         41620000
416300        ASC-GROSS-COST NOT EQUAL ZERO                             41630000
416400        MOVE ASC-RETAIL-AMT TO PV-ABS-RETAIL-AMT                  41640000
416500        MOVE ASC-GROSS-COST TO PV-ABS-GROSS-COST                  41650000
416600        IF PV-ABS-GROSS-COST > PV-ABS-RETAIL-AMT AND              41660000
416700           PS-NO-ERROR                                            41670000
416800           SET DP020-MSG-WARNING TO TRUE                          41680000
416900           MOVE PC-TSYMSG-01967 TO DP020-MSG-NUMBER               41690000
417000           SET PS-WARNING TO TRUE                                 41700000
417100        END-IF                                                    41710000
417200     END-IF.                                                      41720000
417300                                                                  41730000
417400******************************************************************41740000
417500* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED DISCOUNT      *41750000
417600* PERCENT FIELD.                                                 *41760000
417700******************************************************************41770000
417800 3320-EDIT-DISC-PCT.                                              41780000
417900                                                                  41790000
418000     IF ASC-ALP-DISC-PCT > SPACES AND                             41800000
418100        ASC-ALP-DISC-PCT NOT EQUAL TO '0000000'                   41810000
418200        IF ASC-COST-PRCCTL-CDE = 'N' OR                           41820000
418300           ASC-GROSS-COST = ZERO                                  41830000
418400           MOVE DP015-UNP-ALP-BRT-OFF TO ADISCPCA                 41840000
418500           MOVE DP015-RED             TO ADISCPCC                 41850000
418600           MOVE DP015-REVERSE         TO ADISCPCH                 41860000
418700           MOVE -1                    TO ADISCPCL                 41870000
418800           IF PS-NO-ERROR                                         41880000
418900              MOVE PC-TSYMSG-01929 TO DP020-MSG-NUMBER            41890000
419000           END-IF                                                 41900000
419100           SET PS-ERROR TO TRUE                                   41910000
419200        ELSE                                                      41920000
419300           MOVE ASC-ALP-DISC-PCT     TO DP010I-UNEDITED-FIELD     41930000
419400           MOVE 3                    TO DP010I-MAXIMUM-DIGITS     41940000
419500           MOVE 4                    TO DP010I-MAXIMUM-DECIMALS   41950000
419600           SET DP010I-NEGATIVE-NOT-ALLOWED                        41960000
419700                                     TO TRUE                      41970000
419800                                                                  41980000
419910           CALL DP010I-NUMERIC-EDIT-ROUTINE                       41991059
419920                         USING DP010I-NUMERIC-EDIT-AREA           41992059
419930                                                                  41993059
420000                                                                  42000000
420100           IF DP010I-ERROR-DETECTED                               42010000
420200               SET DP020-MSG-FATAL TO TRUE                        42020000
420300*       -- MUST BE NUMERIC --                                     42030000
420400               MOVE DP015-UNP-ALP-BRT-OFF TO ADISCPCA             42040000
420500               MOVE DP015-RED             TO ADISCPCC             42050000
420600               MOVE DP015-REVERSE         TO ADISCPCH             42060000
420700               MOVE -1                    TO ADISCPCL             42070000
420800               IF PS-NO-ERROR                                     42080000
420900                  MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER        42090000
421000               END-IF                                             42100000
421100               SET PS-ERROR   TO TRUE                             42110000
421200           ELSE                                                   42120000
421300               MOVE DP010I-NUMERIC-FIELD  TO ASC-DISC-PCT         42130000
421400                                             ASC-ALP-DISC-PCT-9   42140000
421500               IF ASC-DISC-PCT > 100                              42150000
421600                  SET DP020-MSG-FATAL TO TRUE                     42160000
421700                  MOVE DP015-UNP-ALP-BRT-OFF TO ADISCPCA          42170000
421800                  MOVE DP015-RED             TO ADISCPCC          42180000
421900                  MOVE DP015-REVERSE         TO ADISCPCH          42190000
422000                  MOVE -1                    TO ADISCPCL          42200000
422100                  IF PS-NO-ERROR                                  42210000
422200                     MOVE PC-TSYMSG-01912    TO DP020-MSG-NUMBER  42220000
422300                  END-IF                                          42230000
422400                  SET PS-ERROR TO TRUE                            42240000
422500               END-IF                                             42250000
422600           END-IF                                                 42260000
422700        END-IF                                                    42270000
422800     ELSE                                                         42280000
422900        INITIALIZE ASC-DISC-PCT                                   42290000
423000     END-IF.                                                      42300000
423100                                                                  42310000
423200******************************************************************42320000
423300* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED MARK OUT OF   *42330000
423400* STOCK (MOS) PERCENT FIELD.                                     *42340000
423500******************************************************************42350000
423600 3325-EDIT-MOS-PCT.                                               42360000
423700                                                                  42370000
423800     IF ASC-ALP-MOS-PCT > SPACES AND                              42380000
423900        ASC-ALP-MOS-PCT NOT EQUAL TO '0000000'                    42390000
424000        IF ASC-COST-PRCCTL-CDE = 'N' OR                           42400000
424100           ASC-GROSS-COST = ZERO                                  42410000
424200           MOVE DP015-UNP-ALP-BRT-OFF TO AMOSPCA                  42420000
424300           MOVE DP015-RED             TO AMOSPCC                  42430000
424400           MOVE DP015-REVERSE         TO AMOSPCH                  42440000
424500           MOVE -1                    TO AMOSPCL                  42450000
424600           IF PS-NO-ERROR                                         42460000
424700              MOVE PC-TSYMSG-01929 TO DP020-MSG-NUMBER            42470000
424800           END-IF                                                 42480000
424900           SET PS-ERROR TO TRUE                                   42490000
425000        ELSE                                                      42500000
425100           MOVE ASC-ALP-MOS-PCT      TO DP010I-UNEDITED-FIELD     42510000
425200           MOVE 3                    TO DP010I-MAXIMUM-DIGITS     42520000
425300           MOVE 4                    TO DP010I-MAXIMUM-DECIMALS   42530000
425400           SET DP010I-NEGATIVE-NOT-ALLOWED                        42540000
425500                                     TO TRUE                      42550000
425600                                                                  42560000
425710           CALL DP010I-NUMERIC-EDIT-ROUTINE                       42571059
425720                         USING DP010I-NUMERIC-EDIT-AREA           42572059
425730                                                                  42573059
425800                                                                  42580000
425900           IF DP010I-ERROR-DETECTED                               42590000
426000               SET DP020-MSG-FATAL TO TRUE                        42600000
426100*       -- MUST BE NUMERIC --                                     42610000
426200               MOVE DP015-UNP-ALP-BRT-OFF TO AMOSPCA              42620000
426300               MOVE DP015-RED             TO AMOSPCC              42630000
426400               MOVE DP015-REVERSE         TO AMOSPCH              42640000
426500               MOVE -1                    TO AMOSPCL              42650000
426600               IF PS-NO-ERROR                                     42660000
426700                  MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER        42670000
426800               END-IF                                             42680000
426900               SET PS-ERROR   TO TRUE                             42690000
427000           ELSE                                                   42700000
427100               MOVE DP010I-NUMERIC-FIELD  TO ASC-MOS-PCT          42710000
427200                                             ASC-ALP-MOS-PCT-9    42720000
427300               IF ASC-MOS-PCT > 100                               42730000
427400                  SET DP020-MSG-FATAL TO TRUE                     42740000
427500                  MOVE DP015-UNP-ALP-BRT-OFF TO AMOSPCA           42750000
427600                  MOVE DP015-RED             TO AMOSPCC           42760000
427700                  MOVE DP015-REVERSE         TO AMOSPCH           42770000
427800                  MOVE -1                    TO AMOSPCL           42780000
427900                  IF PS-NO-ERROR                                  42790000
428000                     MOVE PC-TSYMSG-01912    TO DP020-MSG-NUMBER  42800000
428100                  END-IF                                          42810000
428200                  SET PS-ERROR TO TRUE                            42820000
428300               END-IF                                             42830000
428400           END-IF                                                 42840000
428500        END-IF                                                    42850000
428600     ELSE                                                         42860000
428700        INITIALIZE ASC-MOS-PCT                                    42870000
428800     END-IF.                                                      42880000
428900                                                                  42890000
429000******************************************************************42900000
429100* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED NEW STORE     *42910000
429200* PERCENT FIELD AND/OR NEW STORE AMOUNT FIELD.                   *42920000
429300******************************************************************42930000
429400 3330-EDIT-NEW-STR-PCT.                                           42940000
429500                                                                  42950000
429600     IF ASC-ALP-NEW-STR-PCT > SPACES AND                          42960000
429700        ASC-ALP-NEW-STR-PCT NOT EQUAL TO '0000000'                42970000
429800        SET PV-NEW-STR-PCT-ENTERED TO TRUE                        42980000
429900        IF ASC-COST-PRCCTL-CDE = 'N' OR                           42990000
430000           ASC-GROSS-COST = ZERO                                  43000000
430100           MOVE DP015-UNP-ALP-BRT-OFF TO ANSTRPCA                 43010000
430200           MOVE DP015-RED             TO ANSTRPCC                 43020000
430300           MOVE DP015-REVERSE         TO ANSTRPCH                 43030000
430400           MOVE -1                    TO ANSTRPCL                 43040000
430500           IF PS-NO-ERROR                                         43050000
430600              MOVE PC-TSYMSG-01929 TO DP020-MSG-NUMBER            43060000
430700           END-IF                                                 43070000
430800           SET PS-ERROR TO TRUE                                   43080000
430900        ELSE                                                      43090000
431000           MOVE ASC-ALP-NEW-STR-PCT  TO DP010I-UNEDITED-FIELD     43100000
431100           MOVE 3                    TO DP010I-MAXIMUM-DIGITS     43110000
431200           MOVE 4                    TO DP010I-MAXIMUM-DECIMALS   43120000
431300           SET DP010I-NEGATIVE-NOT-ALLOWED                        43130000
431400                                     TO TRUE                      43140000
431500                                                                  43150000
431610           CALL DP010I-NUMERIC-EDIT-ROUTINE                       43161059
431620                         USING DP010I-NUMERIC-EDIT-AREA           43162059
431630                                                                  43163059
431700                                                                  43170000
431800           IF DP010I-ERROR-DETECTED                               43180000
431900               SET DP020-MSG-FATAL TO TRUE                        43190000
432000*       -- MUST BE NUMERIC --                                     43200000
432100               MOVE DP015-UNP-ALP-BRT-OFF TO ANSTRPCA             43210000
432200               MOVE DP015-RED             TO ANSTRPCC             43220000
432300               MOVE DP015-REVERSE         TO ANSTRPCH             43230000
432400               MOVE -1                    TO ANSTRPCL             43240000
432500               IF PS-NO-ERROR                                     43250000
432600                  MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER        43260000
432700               END-IF                                             43270000
432800               SET PS-ERROR   TO TRUE                             43280000
432900           ELSE                                                   43290000
433000               MOVE DP010I-NUMERIC-FIELD  TO ASC-NEW-STR-PCT      43300000
433100                                             ASC-ALP-NEW-STR-PCT-943310000
433200               IF ASC-NEW-STR-PCT > 100                           43320000
433300                  SET DP020-MSG-FATAL TO TRUE                     43330000
433400                  MOVE DP015-UNP-ALP-BRT-OFF TO ANSTRPCA          43340000
433500                  MOVE DP015-RED             TO ANSTRPCC          43350000
433600                  MOVE DP015-REVERSE         TO ANSTRPCH          43360000
433700                  MOVE -1                    TO ANSTRPCL          43370000
433800                  IF PS-NO-ERROR                                  43380000
433900                     MOVE PC-TSYMSG-01912    TO DP020-MSG-NUMBER  43390000
434000                  END-IF                                          43400000
434100                  SET PS-ERROR TO TRUE                            43410000
434200               END-IF                                             43420000
434300           END-IF                                                 43430000
434400        END-IF                                                    43440000
434500     ELSE                                                         43450000
434600        INITIALIZE ASC-NEW-STR-PCT                                43460000
434700     END-IF.                                                      43470000
434800                                                                  43480000
434900                                                                  43490000
435000     IF  ASC-ALP-NEW-STR-AMT > SPACES                             43500000
435100     AND ASC-ALP-NEW-STR-AMT NOT EQUAL TO '000000000'             43510000
435200        SET PV-NEW-STR-AMT-ENTERED TO TRUE                        43520000
435300        IF ASC-COST-PRCCTL-CDE = 'N'                              43530000
435400           MOVE DP015-UNP-ALP-BRT-OFF TO ANSTRAMA                 43540000
435500           MOVE DP015-RED             TO ANSTRAMC                 43550000
435600           MOVE DP015-REVERSE         TO ANSTRAMH                 43560000
435700           MOVE -1                    TO ANSTRAML                 43570000
435800           IF PS-NO-ERROR                                         43580000
435900              MOVE PC-TSYMSG-01929 TO DP020-MSG-NUMBER            43590000
436000           END-IF                                                 43600000
436100           SET PS-ERROR TO TRUE                                   43610000
436200        ELSE                                                      43620000
436300           MOVE ASC-ALP-NEW-STR-AMT  TO DP010I-UNEDITED-FIELD     43630000
436400           MOVE 6                    TO DP010I-MAXIMUM-DIGITS     43640000
436500           MOVE 2                    TO DP010I-MAXIMUM-DECIMALS   43650000
436600           SET DP010I-NEGATIVE-ALLOWED                            43660000
436700                                     TO TRUE                      43670000
436800                                                                  43680000
436910           CALL DP010I-NUMERIC-EDIT-ROUTINE                       43691059
436920                         USING DP010I-NUMERIC-EDIT-AREA           43692059
436930                                                                  43693059
437000                                                                  43700000
437100           IF DP010I-ERROR-DETECTED                               43710000
437200               SET DP020-MSG-FATAL TO TRUE                        43720000
437300*       -- MUST BE NUMERIC --                                     43730000
437400               MOVE DP015-UNP-ALP-BRT-OFF TO ANSTRAMA             43740000
437500               MOVE DP015-RED             TO ANSTRAMC             43750000
437600               MOVE DP015-REVERSE         TO ANSTRAMH             43760000
437700               MOVE -1                    TO ANSTRAML             43770000
437800               IF PS-NO-ERROR                                     43780000
437900                  MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER        43790000
438000               END-IF                                             43800000
438100               SET PS-ERROR   TO TRUE                             43810000
438200           ELSE                                                   43820000
438300               MOVE DP010I-NUMERIC-FIELD  TO ASC-NEW-STR-AMT      43830000
438400                                             ASC-ALP-NEW-STR-AMT-943840000
438500           END-IF                                                 43850000
438600        END-IF                                                    43860000
438700     ELSE                                                         43870000
438800        INITIALIZE ASC-NEW-STR-AMT                                43880000
438900     END-IF.                                                      43890000
439000                                                                  43900000
439100     IF  PV-NEW-STR-PCT-ENTERED                                   43910000
439200     AND PV-NEW-STR-AMT-ENTERED                                   43920000
439300**  NEW STORE PERCENT AND AMOUNT CANNOT BOTH BE ENTERED.          43930000
439400         MOVE DP015-UNP-ALP-BRT-OFF TO ANSTRPCA                   43940000
439500                                       ANSTRAMA                   43950000
439600         MOVE DP015-RED             TO ANSTRPCC                   43960000
439700                                       ANSTRAMC                   43970000
439800         MOVE DP015-REVERSE         TO ANSTRPCH                   43980000
439900                                       ANSTRAMH                   43990000
440000         MOVE -1                    TO ANSTRPCL                   44000000
440100                                       ANSTRAML                   44010000
440200         IF PS-NO-ERROR                                           44020000
440300            MOVE PC-TSYMSG-03360 TO DP020-MSG-NUMBER              44030000
440400         END-IF                                                   44040000
440500         SET PS-ERROR TO TRUE                                     44050000
440600     END-IF.                                                      44060000
440700                                                                  44070000
440800******************************************************************44080000
440900* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED HOLD STATUS   *44090000
441000* INDICATOR.                                                     *44100000
441100******************************************************************44110000
441200 3340-EDIT-HOLD-STATUS.                                           44120000
441300                                                                  44130000
441400     IF ASC-HOLD-STATUS NOT EQUAL TO 'Y' AND                      44140000
441500        ASC-HOLD-STATUS NOT EQUAL TO 'N' AND                      44150000
441600        ASC-HOLD-STATUS NOT EQUAL TO ' '                          44160000
441700        SET DP020-MSG-FATAL TO TRUE                               44170000
441800        MOVE DP015-UNP-ALP-BRT-OFF    TO AHOLDA                   44180000
441900        MOVE DP015-RED                TO AHOLDC                   44190000
442000        MOVE DP015-REVERSE            TO AHOLDH                   44200000
442100        MOVE -1                       TO AHOLDL                   44210000
442200        IF PS-NO-ERROR                                            44220000
442300           MOVE PC-TSYMSG-01915       TO DP020-MSG-NUMBER         44230000
442400        END-IF                                                    44240000
442500        SET PS-ERROR TO TRUE                                      44250000
442600     END-IF.                                                      44260000
442700                                                                  44270000
442800******************************************************************44280000
442900* THIS PARAGRAPH PERFORMS EDITS ON THE TRADE PERCENT FIELD.      *44290000
443000******************************************************************44300000
443100 3350-EDIT-TRADE-PCT.                                             44310000
443200                                                                  44320000
443300     IF ASC-ALP-TRADE-PCT > SPACES AND                            44330000
443400        ASC-ALP-TRADE-PCT NOT EQUAL TO '0000000'                  44340000
443500        IF ASC-COST-PRCCTL-CDE = 'N' OR                           44350000
443600           ASC-GROSS-COST = ZERO                                  44360000
443700           MOVE DP015-UNP-ALP-BRT-OFF TO ATRADPCA                 44370000
443800           MOVE DP015-RED             TO ATRADPCC                 44380000
443900           MOVE DP015-REVERSE         TO ATRADPCH                 44390000
444000           MOVE -1                    TO ATRADPCL                 44400000
444100           IF PS-NO-ERROR                                         44410000
444200              MOVE PC-TSYMSG-01929 TO DP020-MSG-NUMBER            44420000
444300           END-IF                                                 44430000
444400           SET PS-ERROR TO TRUE                                   44440000
444500        ELSE                                                      44450000
444600           MOVE ASC-ALP-TRADE-PCT    TO DP010I-UNEDITED-FIELD     44460000
444700           MOVE 3                    TO DP010I-MAXIMUM-DIGITS     44470000
444800           MOVE 4                    TO DP010I-MAXIMUM-DECIMALS   44480000
444900           SET DP010I-NEGATIVE-NOT-ALLOWED                        44490000
445000                                     TO TRUE                      44500000
445100                                                                  44510000
445210           CALL DP010I-NUMERIC-EDIT-ROUTINE                       44521059
445220                         USING DP010I-NUMERIC-EDIT-AREA           44522059
445230                                                                  44523059
445300                                                                  44530000
445400           IF DP010I-ERROR-DETECTED                               44540000
445500              SET DP020-MSG-FATAL TO TRUE                         44550000
445600*       -- MUST BE NUMERIC --                                     44560000
445700               MOVE DP015-UNP-ALP-BRT-OFF TO ATRADPCA             44570000
445800               MOVE DP015-RED             TO ATRADPCC             44580000
445900               MOVE DP015-REVERSE         TO ATRADPCH             44590000
446000               MOVE -1                    TO ATRADPCL             44600000
446100              IF PS-NO-ERROR                                      44610000
446200                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         44620000
446300              END-IF                                              44630000
446400               SET PS-ERROR   TO TRUE                             44640000
446500           ELSE                                                   44650000
446600               MOVE DP010I-NUMERIC-FIELD  TO ASC-TRADE-PCT        44660000
446700                                             ASC-ALP-TRADE-PCT-9  44670000
446800               IF ASC-TRADE-PCT > 100                             44680000
446900                  SET DP020-MSG-FATAL TO TRUE                     44690000
447000                  MOVE DP015-UNP-ALP-BRT-OFF TO ATRADPCA          44700000
447100                  MOVE DP015-RED             TO ATRADPCC          44710000
447200                  MOVE DP015-REVERSE         TO ATRADPCH          44720000
447300                  MOVE -1                    TO ATRADPCL          44730000
447400                  IF PS-NO-ERROR                                  44740000
447500                     MOVE PC-TSYMSG-01912    TO DP020-MSG-NUMBER  44750000
447600                  END-IF                                          44760000
447700                  SET PS-ERROR TO TRUE                            44770000
447800               END-IF                                             44780000
447900           END-IF                                                 44790000
448000        END-IF                                                    44800000
448100     ELSE                                                         44810000
448200        INITIALIZE ASC-TRADE-PCT                                  44820000
448300     END-IF.                                                      44830000
448400                                                                  44840000
448500******************************************************************44850000
448600* THIS PARAGRAPH WILL CALCULATE THE NET AMOUNT BASED ON DOLLAR   *44860000
448700* FIELDS ENTERED INTO THE SCREEN.                                *44870000
448800******************************************************************44880000
448900 3355-CALCULATE-NET-AMT.                                          44890000
449000                                                                  44900000
449100     INITIALIZE ASC-DISC-AMT                                      44910000
449200***             ASC-NEW-STR-AMT                                   44920000
449300                ASC-TRADE-AMT                                     44930000
449400                ASC-MOS-AMT                                       44940000
449500                ASC-NET-COST.                                     44950000
449600                                                                  44960000
449700     IF PS-NO-ERROR                                               44970000
449800        IF ASC-GROSS-COST GREATER THAN ZERO                       44980000
449900           COMPUTE PV-DISC-AMT  =                                 44990000
450000                   ((ASC-DISC-PCT / 100) * ASC-GROSS-COST) +      45000000
450100                                                    .005          45010000
450200           COMPUTE PV-TRADE-AMT  =                                45020000
450300                   ((ASC-TRADE-PCT / 100) * ASC-GROSS-COST) +     45030000
450400                                                    .005          45040000
450500           COMPUTE PV-MOS-AMT  =                                  45050000
450600                   ((ASC-MOS-PCT / 100) * ASC-GROSS-COST) +       45060000
450700                                                    .005          45070000
450800                                                                  45080000
450900           IF  PV-NEW-STR-AMT-ENTERED                             45090000
451000               MOVE ASC-NEW-STR-AMT TO PV-NEW-STR-AMT             45100000
451100           ELSE                                                   45110000
451200               COMPUTE PV-NEW-STR-AMT =                           45120000
451300                   ((ASC-NEW-STR-PCT / 100) * ASC-GROSS-COST) +   45130000
451400                                                    .005          45140000
451500           END-IF                                                 45150000
451600                                                                  45160000
451700        ELSE                                                      45170000
451800           IF ASC-GROSS-COST LESS THAN ZERO                       45180000
451900              COMPUTE PV-DISC-AMT  =                              45190000
452000                      ((ASC-DISC-PCT / 100) * ASC-GROSS-COST) -   45200000
452100                                                       .005       45210000
452200              COMPUTE PV-TRADE-AMT  =                             45220000
452300                      ((ASC-TRADE-PCT / 100) * ASC-GROSS-COST) -  45230000
452400                                                       .005       45240000
452500              COMPUTE PV-MOS-AMT  =                               45250000
452600                      ((ASC-MOS-PCT / 100) * ASC-GROSS-COST) -    45260000
452700                                                       .005       45270000
452800              IF  PV-NEW-STR-AMT-ENTERED                          45280000
452900                  MOVE ASC-NEW-STR-AMT TO PV-NEW-STR-AMT          45290000
453000              ELSE                                                45300000
453100                  COMPUTE PV-NEW-STR-AMT =                        45310000
453200                      ((ASC-NEW-STR-PCT / 100) * ASC-GROSS-COST) -45320000
453300                                                       .005       45330000
453400              END-IF                                              45340000
453500           ELSE                                                   45350000
453600              MOVE ZERO TO PV-DISC-AMT                            45360000
453700                           PV-TRADE-AMT                           45370000
453800                           PV-MOS-AMT                             45380000
453900              IF  PV-NEW-STR-AMT-ENTERED                          45390000
454000                  MOVE ASC-NEW-STR-AMT TO PV-NEW-STR-AMT          45400000
454100              ELSE                                                45410000
454200                  MOVE ZERO TO PV-NEW-STR-AMT                     45420000
454300              END-IF                                              45430000
454400           END-IF                                                 45440000
454500        END-IF                                                    45450000
454600        MOVE PV-DISC-AMT TO ASC-DISC-AMT                          45460000
454700        MOVE PV-NEW-STR-AMT TO ASC-NEW-STR-AMT                    45470000
454800        MOVE PV-TRADE-AMT TO ASC-TRADE-AMT                        45480000
454900        MOVE PV-MOS-AMT TO ASC-MOS-AMT                            45490000
455000     END-IF.                                                      45500000
455100                                                                  45510000
455200     INITIALIZE PV-NET-COST.                                      45520000
455300     COMPUTE PV-NET-COST  =                                       45530000
455400             (ASC-GROSS-COST + ASC-FREIGHT-AMT + ASC-MISC-CHG -   45540000
455500              ASC-DISC-AMT - ASC-NEW-STR-AMT - ASC-TRADE-AMT -    45550000
455600              ASC-MOS-AMT).                                       45560000
455700                                                                  45570000
455800     IF PV-NET-COST GREATER THAN ZERO                             45580000
455900        COMPUTE ASC-NET-COST =                                    45590000
456000                (ASC-GROSS-COST + ASC-FREIGHT-AMT + ASC-MISC-CHG -45600000
456100                 ASC-DISC-AMT - ASC-NEW-STR-AMT - ASC-TRADE-AMT - 45610000
456200                 ASC-MOS-AMT)                                     45620000
456300                 + .005                                           45630000
456400     ELSE                                                         45640000
456500        IF PV-NET-COST LESS THAN ZERO                             45650000
456600           COMPUTE ASC-NET-COST =                                 45660000
456700                (ASC-GROSS-COST + ASC-FREIGHT-AMT + ASC-MISC-CHG -45670000
456800                 ASC-DISC-AMT - ASC-NEW-STR-AMT - ASC-TRADE-AMT - 45680000
456900                 ASC-MOS-AMT)                                     45690000
457000                 - .005                                           45700000
457100        END-IF                                                    45710000
457200     END-IF.                                                      45720000
457300                                                                  45730000
457400******************************************************************45740000
457500* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED CLASS AND SKU *45750000
457600* SEQUENCE IN THE DISTRIBUTION PORTION OF THE SCREEN.            *45760000
457700******************************************************************45770000
457800 3360-EDIT-DISTRO-CLS-SEQ.                                        45780000
457900                                                                  45790000
458000     IF ASC-TRN-TYP-CDE = 'MDS'                                   45800000
458100        IF ASC-ALP-DET-SKU = SPACES                               45810000
458200           SET ASC-SKU-NOT-ENTERED TO TRUE                        45820000
458300           IF TRNCDE-SKU-SEQ-REQR-IND = 'Y'                       45830000
458400              SET DP020-MSG-FATAL     TO TRUE                     45840000
458500              MOVE DP015-UNP-ALP-BRT-OFF TO ASKU01A               45850000
458600              MOVE DP015-RED          TO ASKU01C                  45860000
458700              MOVE DP015-REVERSE      TO ASKU01H                  45870000
458800              MOVE -1                 TO ASKU01L                  45880000
458900              IF PS-NO-ERROR                                      45890000
459000                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         45900000
459100              END-IF                                              45910000
459200              SET PS-ERROR            TO TRUE                     45920000
459300           ELSE                                                   45930000
459400*             IF TRNCDE-BTCH-SRC-CDE = 'VAA' OR 'VDA'             45940000
459500*             OR TRNCDE-AP-TRN-CDE = '56' OR '57'                 45950000
459600*                PERFORM 4990-GET-MAJOR-CLASS                     45960000
459700*                IF  ASC-CLASS-FOUND                              45970000
459800*                    MOVE MDSEAR-MAJ-CL-NBR TO ASC-DET-CLASS      45980000
459900*                ELSE                                             45990000
460000*                   SET DP020-MSG-FATAL TO TRUE                   46000000
460100*                   MOVE DP015-UNP-ALP-BRT-OFF TO ACLS01A         46010000
460200*                   MOVE DP015-RED    TO ACLS01C                  46020000
460300*                   MOVE DP015-REVERSE TO ACLS01H                 46030000
460400*                   MOVE -1           TO ACLS01L                  46040000
460500*                   IF PS-NO-ERROR                                46050000
460600*                      MOVE PC-TSYMSG-01921 TO DP020-MSG-NUMBER   46060000
460700*                   END-IF                                        46070000
460800*                   SET PS-ERROR      TO TRUE                     46080000
460900*                END-IF                                           46090000
461000*             END-IF                                              46100000
461100              IF ASC-DET-CLASS = SPACES                           46110000
461200                 SET DP020-MSG-FATAL TO TRUE                      46120000
461300                 MOVE DP015-UNP-ALP-BRT-OFF TO ACLS01A            46130000
461400                 MOVE DP015-RED    TO ACLS01C                     46140000
461500                 MOVE DP015-REVERSE TO ACLS01H                    46150000
461600                 MOVE -1           TO ACLS01L                     46160000
461700                 IF PS-NO-ERROR                                   46170000
461800                    MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER      46180000
461900                 END-IF                                           46190000
462000                 SET PS-ERROR      TO TRUE                        46200000
462100              ELSE                                                46210000
462200**SUB-CLASS IS REQUIRED FOR THIS TRANSACTION                      46220000
462300**A ZERO MUST BE STRUNG IN FRONT OF CLASS FOR VALIDATION          46230000
462400                 MOVE ASC-DEPARTMENT TO MDSEAR-DEPT-NBR           46240000
462500                 SET ASC-CLASS-NOT-FOUND TO TRUE                  46250000
462600                 IF TRNCDE-SUB-CL-REQR-IND = 'Y'                  46260000
462700** USER ENTERED A SPACE IN FIRST BYTE OF DISTRO CLASS, MUST       46270000
462800** STRING A ZERO IN FRONT OF MAJOR CLASS                          46280000
462900                    STRING                                        46290000
463000                      '0',                                        46300000
463100                      ASC-DET-CLASS                               46310000
463200                      DELIMITED BY SIZE                           46320000
463300                      INTO MDSEAR-SUB-CL-NBR                      46330000
463400                    END-STRING                                    46340000
463500                    PERFORM 7600-VALIDATE-SUB-CLASS               46350000
463600                 ELSE                                             46360000
463700**SUBCLASS IS NOT REQUIRED, SO USER MAY HAVE ENTERED MAJOR CLASS. 46370000
463800**VALIDATE FOR MAJOR CLASS.                                       46380000
463900                    MOVE ASC-DET-CLASS TO MDSEAR-MAJ-CL-NBR       46390000
464000                    PERFORM 7700-VALIDATE-MAJ-CLASS               46400000
464100                 END-IF                                           46410000
464200                 IF ASC-CLASS-NOT-FOUND                           46420000
464300                    SET DP020-MSG-FATAL TO TRUE                   46430000
464400                    MOVE DP015-UNP-ALP-BRT-OFF TO ACLS01A         46440000
464500                    MOVE DP015-RED    TO ACLS01C                  46450000
464600                    MOVE DP015-REVERSE TO ACLS01H                 46460000
464700                    MOVE -1           TO ACLS01L                  46470000
464800                    IF PS-NO-ERROR                                46480000
464900                       MOVE PC-TSYMSG-01921 TO DP020-MSG-NUMBER   46490000
465000                    END-IF                                        46500000
465100                    SET PS-ERROR      TO TRUE                     46510000
465200                 END-IF                                           46520000
465300              END-IF                                              46530000
465400           END-IF                                                 46540000
465500        ELSE                                                      46550000
465600           SET ASC-SKU-ENTERED TO TRUE                            46560000
465700           MOVE ASC-ALP-DET-SKU     TO DP010I-UNEDITED-FIELD      46570000
465800           MOVE 8                   TO DP010I-MAXIMUM-DIGITS      46580000
465900           MOVE 0                   TO DP010I-MAXIMUM-DECIMALS    46590000
466000           SET  DP010I-NEGATIVE-NOT-ALLOWED                       46600000
466100                                    TO TRUE                       46610000
466210           CALL DP010I-NUMERIC-EDIT-ROUTINE                       46621059
466220                         USING DP010I-NUMERIC-EDIT-AREA           46622059
466230                                                                  46623059
466300           IF DP010I-ERROR-DETECTED                               46630000
466400               SET DP020-MSG-FATAL  TO TRUE                       46640000
466500*              -- MUST BE NUMERIC --                              46650000
466600               MOVE DP015-UNP-ALP-BRT-OFF                         46660000
466700                                    TO APONUMA                    46670000
466800               MOVE DP015-RED       TO APONUMC                    46680000
466900               MOVE DP015-REVERSE   TO APONUMH                    46690000
467000               MOVE -1              TO APONUML                    46700000
467100               IF PS-NO-ERROR                                     46710000
467200                   MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER       46720000
467300               END-IF                                             46730000
467400               SET PS-ERROR TO TRUE                               46740000
467500           ELSE                                                   46750000
467600               MOVE DP010I-NUMERIC-FIELD TO ASC-DET-SKU           46760000
467700                                            ASC-ALP-DET-SKU-9     46770000
467800           END-IF                                                 46780000
467900** DISTRO SEQUENCE IS ENTERED, VALIDATE THE DEPARTMENT, CLASS,    46790000
468000** AND SKU COMBINATION AGAINST THE TSKXREF DB2 TABLE.             46800000
468100           MOVE ZERO                  TO PV-CLASS                 46810000
468200           IF ASC-DET-CLASS NOT = SPACE                           46820000
468300              MOVE ASC-DET-CLASS-9    TO PV-CLASS                 46830000
468400           END-IF                                                 46840000
468500           MOVE PV-CLASS              TO SKXREF-SUBCLASS          46850000
468600           MOVE ZERO                  TO PV-DEPARTMENT            46860000
468700           IF ASC-DEPARTMENT NOT = SPACE                          46870000
468800              MOVE ASC-DEPARTMENT-9   TO PV-DEPARTMENT            46880000
468900           END-IF                                                 46890000
469000           MOVE PV-DEPARTMENT         TO SKXREF-DEPT              46900000
469100           MOVE ASC-DET-SKU           TO SKXREF-SKU               46910000
469200           SET ASC-SKU-NOT-FOUND TO TRUE                          46920000
469300           PERFORM 7800-VALIDATE-SKU                              46930000
469400** SKU COMBINATION WAS NOT VALID ON TSKXREF DB2 TABLE.            46940000
469500           IF ASC-SKU-NOT-FOUND                                   46950000
469600              SET DP020-MSG-FATAL     TO TRUE                     46960000
469700              MOVE DP015-UNP-ALP-BRT-OFF TO ASKU01A               46970000
469800                                            ACLS01A               46980000
469900              MOVE DP015-RED          TO ASKU01C                  46990000
470000                                            ACLS01C               47000000
470100              MOVE DP015-REVERSE      TO ASKU01H                  47010000
470200                                            ACLS01H               47020000
470300              MOVE -1                 TO ACLS01L                  47030000
470400              IF PS-NO-ERROR                                      47040000
470500                 MOVE PC-TSYMSG-01922 TO DP020-MSG-NUMBER         47050000
470600              END-IF                                              47060000
470700              SET PS-ERROR            TO TRUE                     47070000
470800           END-IF                                                 47080000
470900        END-IF                                                    47090000
471000     ELSE                                                         47100000
471100        SET ASC-SKU-NOT-ALLOWED TO TRUE                           47110000
471200        IF ASC-DET-CLASS > SPACES                                 47120000
471300           SET DP020-MSG-FATAL        TO TRUE                     47130000
471400           MOVE DP015-UNP-ALP-BRT-OFF TO ACLS01A                  47140000
471500           MOVE DP015-RED             TO ACLS01C                  47150000
471600           MOVE DP015-REVERSE         TO ACLS01H                  47160000
471700           MOVE -1                    TO ACLS01L                  47170000
471800           IF PS-NO-ERROR                                         47180000
471900              MOVE PC-TSYMSG-01923    TO DP020-MSG-NUMBER         47190000
472000           END-IF                                                 47200000
472100           SET PS-ERROR               TO TRUE                     47210000
472200        END-IF                                                    47220000
472300        IF ASC-ALP-DET-SKU > SPACES                               47230000
472400           SET DP020-MSG-FATAL        TO TRUE                     47240000
472500           MOVE DP015-UNP-ALP-BRT-OFF TO ASKU01A                  47250000
472600           MOVE DP015-RED             TO ASKU01C                  47260000
472700           MOVE DP015-REVERSE         TO ASKU01H                  47270000
472800           MOVE -1                    TO ASKU01L                  47280000
472900           IF PS-NO-ERROR                                         47290000
473000              MOVE PC-TSYMSG-01924    TO DP020-MSG-NUMBER         47300000
473100           END-IF                                                 47310000
473200           SET PS-ERROR               TO TRUE                     47320000
473300        END-IF                                                    47330000
473400     END-IF.                                                      47340000
473500                                                                  47350000
473600******************************************************************47360000
473700* THIS PARAGRAPH PERFORMS EDITS ON THE ENTERED DISTRIBUTION      *47370000
473800* GROSS COST FIELD.                                              *47380000
473900******************************************************************47390000
474000 3370-EDIT-DISTRO-COST.                                           47400000
474100                                                                  47410000
474200     IF ASC-GROSS-COST NOT EQUAL ZERO                             47420000
474300     OR ASC-FREIGHT-COST-ALLOCATION                               47430000
474400     OR ASC-NEW-STR-COST-ALLOCATION                               47440000
474500        IF ASC-ALP-DET-COST NOT EQUAL SPACES                      47450000
474600           MOVE ASC-ALP-DET-COST TO DP010I-UNEDITED-FIELD         47460000
474700           MOVE 10               TO DP010I-MAXIMUM-DIGITS         47470000
474800           MOVE 2                TO DP010I-MAXIMUM-DECIMALS       47480000
474900           SET DP010I-NEGATIVE-ALLOWED                            47490000
475000                                 TO TRUE                          47500000
475110           CALL DP010I-NUMERIC-EDIT-ROUTINE                       47511059
475120                         USING DP010I-NUMERIC-EDIT-AREA           47512059
475130                                                                  47513059
475200                                                                  47520000
475300           IF DP010I-ERROR-DETECTED                               47530000
475400              SET DP020-MSG-FATAL TO TRUE                         47540000
475500              MOVE DP015-UNP-ALP-BRT-OFF  TO ACST01A              47550000
475600              MOVE DP015-RED              TO ACST01C              47560000
475700              MOVE DP015-REVERSE          TO ACST01H              47570000
475800              MOVE -1                     TO ACST01L              47580000
475900              IF PS-NO-ERROR                                      47590000
476000                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         47600000
476100              END-IF                                              47610000
476200              SET PS-ERROR TO TRUE                                47620000
476300           ELSE                                                   47630000
476400              MOVE DP010I-NUMERIC-FIELD                           47640000
476500                                      TO ASC-DET-COST             47650000
476600                                         ASC-ALP-DET-COST-9       47660000
476700**            IF ASC-NEW-STR-COST-ALLOCATION                      47670000
476800*                IF ASC-DET-COST < 0 AND                          47680000
476900*                   TRNCDE-PSTG-TYP-CDE = 'CR'                    47690000
477000*                   SET DP020-MSG-FATAL        TO TRUE            47700000
477100*                   MOVE DP015-UNP-ALP-BRT-OFF TO ACST01A         47710000
477200*                   MOVE DP015-RED             TO ACST01C         47720000
477300*                   MOVE DP015-REVERSE         TO ACST01H         47730000
477400*                   MOVE -1                    TO ACST01L         47740000
477500*                   IF PS-NO-ERROR                                47750000
477600*                      MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER47760000
477700*                   END-IF                                        47770000
477800*                   SET PS-ERROR TO TRUE                          47780000
477900*                END-IF                                           47790000
478000*                IF ASC-DET-COST > 0 AND                          47800000
478100*                   TRNCDE-PSTG-TYP-CDE = 'CH'                    47810000
478200*                   SET DP020-MSG-FATAL        TO TRUE            47820000
478300*                   MOVE DP015-UNP-ALP-BRT-OFF TO ACST01A         47830000
478400*                   MOVE DP015-RED             TO ACST01C         47840000
478500*                   MOVE DP015-REVERSE         TO ACST01H         47850000
478600*                   MOVE -1                    TO ACST01L         47860000
478700*                   IF PS-NO-ERROR                                47870000
478800*                      MOVE PC-TSYMSG-01902    TO DP020-MSG-NUMBER47880000
478900*                   END-IF                                        47890000
479000*                   SET PS-ERROR TO TRUE                          47900000
479100*                END-IF                                           47910000
479200*             ELSE                                                47920000
479300                 IF ASC-DET-COST < 0 AND                          47930000
479400                    TRNCDE-PSTG-TYP-CDE = 'CH'                    47940000
479500                    SET DP020-MSG-FATAL        TO TRUE            47950000
479600                    MOVE DP015-UNP-ALP-BRT-OFF TO ACST01A         47960000
479700                    MOVE DP015-RED             TO ACST01C         47970000
479800                    MOVE DP015-REVERSE         TO ACST01H         47980000
479900                    MOVE -1                    TO ACST01L         47990000
480000                    IF PS-NO-ERROR                                48000000
480100                       MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER48010000
480200                    END-IF                                        48020000
480300                    SET PS-ERROR TO TRUE                          48030000
480400                 END-IF                                           48040000
480500                 IF ASC-DET-COST > 0 AND                          48050000
480600                    TRNCDE-PSTG-TYP-CDE = 'CR'                    48060000
480700                    SET DP020-MSG-FATAL        TO TRUE            48070000
480800                    MOVE DP015-UNP-ALP-BRT-OFF TO ACST01A         48080000
480900                    MOVE DP015-RED             TO ACST01C         48090000
481000                    MOVE DP015-REVERSE         TO ACST01H         48100000
481100                    MOVE -1                    TO ACST01L         48110000
481200                    IF PS-NO-ERROR                                48120000
481300                       MOVE PC-TSYMSG-01902    TO DP020-MSG-NUMBER48130000
481400                    END-IF                                        48140000
481500                    SET PS-ERROR TO TRUE                          48150000
481600                 END-IF                                           48160000
481700           END-IF                                                 48170000
481800        ELSE                                                      48180000
481900           SET DP020-MSG-FATAL        TO TRUE                     48190000
482000           MOVE DP015-UNP-ALP-BRT-OFF TO ACST01A                  48200000
482100           MOVE DP015-RED             TO ACST01C                  48210000
482200           MOVE DP015-REVERSE         TO ACST01H                  48220000
482300           MOVE -1                    TO ACST01L                  48230000
482400           IF PS-NO-ERROR                                         48240000
482500              MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER         48250000
482600           END-IF                                                 48260000
482700           SET PS-ERROR TO TRUE                                   48270000
482800        END-IF                                                    48280000
482900     ELSE                                                         48290000
483000        INITIALIZE ASC-DET-COST                                   48300000
483100        IF ASC-ALP-DET-COST GREATER THAN SPACES                   48310000
483200           SET DP020-MSG-FATAL        TO TRUE                     48320000
483300           MOVE DP015-UNP-ALP-BRT-OFF TO ACST01A                  48330000
483400           MOVE DP015-RED             TO ACST01C                  48340000
483500           MOVE DP015-REVERSE         TO ACST01H                  48350000
483600           MOVE -1                    TO ACST01L                  48360000
483700           IF PS-NO-ERROR                                         48370000
483800              MOVE PC-TSYMSG-01935    TO DP020-MSG-NUMBER         48380000
483900           END-IF                                                 48390000
484000           SET PS-ERROR TO TRUE                                   48400000
484100        END-IF                                                    48410000
484200     END-IF.                                                      48420000
484300                                                                  48430000
484400******************************************************************48440000
484500* THIS PARAGRAPH PERFORMS EDITS ON THE ENTERED DISTRIBUTION      *48450000
484600* RETAIL AMOUNT FIELD.                                           *48460000
484700******************************************************************48470000
484800 3380-EDIT-DISTRO-RETAIL.                                         48480000
484900                                                                  48490000
485000     IF ASC-RETAIL-AMT NOT EQUAL ZERO                             48500000
485100        IF (ASC-ALP-DET-SKU NOT EQUAL SPACES AND                  48510000
485200           ASC-ALP-DET-SKU NOT EQUAL '00000000')                  48520000
485300* MAB 08-10-99 START                                              48530000
485400           OR                                                     48540000
485500           (TRNCDE-COST-PRCCTL-CDE = 'R' AND                      48550000
485600            TRNCDE-RTL-PRCCTL-CDE = 'R')                          48560000
485700* MAB 08-10-99 END                                                48570000
485800           IF ASC-ALP-DET-RETL EQUAL SPACES                       48580000
485900              SET DP020-MSG-FATAL     TO TRUE                     48590000
486000              MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A               48600000
486100              MOVE DP015-RED          TO ARET01C                  48610000
486200              MOVE DP015-REVERSE      TO ARET01H                  48620000
486300              MOVE -1                 TO ARET01L                  48630000
486400              IF PS-NO-ERROR                                      48640000
486500                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         48650000
486600              END-IF                                              48660000
486700              SET PS-ERROR TO TRUE                                48670000
486800           ELSE                                                   48680000
486900              MOVE ASC-ALP-DET-RETL TO DP010I-UNEDITED-FIELD      48690000
487000              MOVE 10            TO DP010I-MAXIMUM-DIGITS         48700000
487100              MOVE 2             TO DP010I-MAXIMUM-DECIMALS       48710000
487200              SET DP010I-NEGATIVE-ALLOWED                         48720000
487300                                    TO TRUE                       48730000
487410              CALL DP010I-NUMERIC-EDIT-ROUTINE                    48741059
487420                         USING DP010I-NUMERIC-EDIT-AREA           48742059
487430                                                                  48743059
487500                                                                  48750000
487600              IF DP010I-ERROR-DETECTED                            48760000
487700                 SET DP020-MSG-FATAL TO TRUE                      48770000
487800                 MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A            48780000
487900                 MOVE DP015-RED           TO ARET01C              48790000
488000                 MOVE DP015-REVERSE       TO ARET01H              48800000
488100                 MOVE -1                  TO ARET01L              48810000
488200                 IF PS-NO-ERROR                                   48820000
488300                    MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER      48830000
488400                 END-IF                                           48840000
488500                 SET PS-ERROR TO TRUE                             48850000
488600              ELSE                                                48860000
488700                 MOVE DP010I-NUMERIC-FIELD                        48870000
488800                                         TO ASC-DET-RETAIL        48880000
488900                                            ASC-ALP-DET-RETL-9    48890000
489000                 IF ASC-DET-RETAIL < 0 AND                        48900000
489100                   TRNCDE-PSTG-TYP-CDE = 'CH'                     48910000
489200                   SET DP020-MSG-FATAL    TO TRUE                 48920000
489300                   MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A          48930000
489400                   MOVE DP015-RED             TO ARET01C          48940000
489500                   MOVE DP015-REVERSE         TO ARET01H          48950000
489600                   MOVE -1                    TO ARET01L          48960000
489700                   IF PS-NO-ERROR                                 48970000
489800                        MOVE PC-TSYMSG-01903 TO DP020-MSG-NUMBER  48980000
489900                   END-IF                                         48990000
490000                   SET PS-ERROR TO TRUE                           49000000
490100                 END-IF                                           49010000
490200                 IF ASC-DET-RETAIL > 0 AND                        49020000
490300                   TRNCDE-PSTG-TYP-CDE = 'CR'                     49030000
490400                    SET DP020-MSG-FATAL    TO TRUE                49040000
490500                   MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A          49050000
490600                    MOVE DP015-RED             TO ARET01C         49060000
490700                   MOVE DP015-REVERSE         TO ARET01H          49070000
490800                    MOVE -1                    TO ARET01L         49080000
490900                   IF PS-NO-ERROR                                 49090000
491000                         MOVE PC-TSYMSG-01902 TO DP020-MSG-NUMBER 49100000
491100                   END-IF                                         49110000
491200                    SET PS-ERROR TO TRUE                          49120000
491300                 END-IF                                           49130000
491400              END-IF                                              49140000
491500           END-IF                                                 49150000
491600        ELSE                                                      49160000
491700           IF ASC-GROSS-COST = ZERO                               49170000
491800              IF ASC-ALP-DET-RETL EQUAL SPACES                    49180000
491900                 SET DP020-MSG-FATAL  TO TRUE                     49190000
492000                 MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A            49200000
492100                 MOVE DP015-RED       TO ARET01C                  49210000
492200                 MOVE DP015-REVERSE   TO ARET01H                  49220000
492300                 MOVE -1              TO ARET01L                  49230000
492400                 IF PS-NO-ERROR                                   49240000
492500                    MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER      49250000
492600                 END-IF                                           49260000
492700                 SET PS-ERROR TO TRUE                             49270000
492800              ELSE                                                49280000
492900                 MOVE ASC-ALP-DET-RETL TO DP010I-UNEDITED-FIELD   49290000
493000                 MOVE 10         TO DP010I-MAXIMUM-DIGITS         49300000
493100                 MOVE 2          TO DP010I-MAXIMUM-DECIMALS       49310000
493200                 SET DP010I-NEGATIVE-ALLOWED                      49320000
493300                                       TO TRUE                    49330000
493410                 CALL DP010I-NUMERIC-EDIT-ROUTINE                 49341059
493420                         USING DP010I-NUMERIC-EDIT-AREA           49342059
493430                                                                  49343059
493500                                                                  49350000
493600                 IF DP010I-ERROR-DETECTED                         49360000
493700                    SET DP020-MSG-FATAL TO TRUE                   49370000
493800                    MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A         49380000
493900                    MOVE DP015-RED        TO ARET01C              49390000
494000                    MOVE DP015-REVERSE    TO ARET01H              49400000
494100                    MOVE -1               TO ARET01L              49410000
494200                    IF PS-NO-ERROR                                49420000
494300                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER   49430000
494400                    END-IF                                        49440000
494500                    SET PS-ERROR TO TRUE                          49450000
494600                 ELSE                                             49460000
494700                    MOVE DP010I-NUMERIC-FIELD                     49470000
494800                                            TO ASC-DET-RETAIL     49480000
494900                                               ASC-ALP-DET-RETL-9 49490000
495000                    IF ASC-DET-RETAIL < 0 AND                     49500000
495100                       TRNCDE-PSTG-TYP-CDE = 'CH'                 49510000
495200                       SET DP020-MSG-FATAL TO TRUE                49520000
495300                       MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A      49530000
495400                       MOVE DP015-RED         TO ARET01C          49540000
495500                       MOVE DP015-REVERSE     TO ARET01H          49550000
495600                       MOVE -1                TO ARET01L          49560000
495700                       IF PS-NO-ERROR                             49570000
495800                         MOVE PC-TSYMSG-01903 TO DP020-MSG-NUMBER 49580000
495900                       END-IF                                     49590000
496000                       SET PS-ERROR TO TRUE                       49600000
496100                     END-IF                                       49610000
496200                     IF ASC-DET-RETAIL > 0 AND                    49620000
496300                       TRNCDE-PSTG-TYP-CDE = 'CR'                 49630000
496400                       SET DP020-MSG-FATAL TO TRUE                49640000
496500                       MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A      49650000
496600                       MOVE DP015-RED          TO ARET01C         49660000
496700                       MOVE DP015-REVERSE     TO ARET01H          49670000
496800                       MOVE -1                 TO ARET01L         49680000
496900                       IF PS-NO-ERROR                             49690000
497000                         MOVE PC-TSYMSG-01902 TO DP020-MSG-NUMBER 49700000
497100                       END-IF                                     49710000
497200                       SET PS-ERROR TO TRUE                       49720000
497300                     END-IF                                       49730000
497400              END-IF                                              49740000
497500           END-IF                                                 49750000
497600        END-IF                                                    49760000
497700     ELSE                                                         49770000
497800        INITIALIZE ASC-DET-RETAIL                                 49780000
497900        IF ASC-ALP-DET-RETL GREATER THAN SPACES AND               49790000
498000           ASC-ALP-DET-RETL NOT EQUAL TO '000000000000'           49800000
498100           SET DP020-MSG-FATAL     TO TRUE                        49810000
498200           MOVE DP015-UNP-ALP-BRT-OFF TO ARET01A                  49820000
498300           MOVE DP015-RED          TO ARET01C                     49830000
498400           MOVE DP015-REVERSE      TO ARET01H                     49840000
498500           MOVE -1                 TO ARET01L                     49850000
498600           IF PS-NO-ERROR                                         49860000
498700              MOVE PC-TSYMSG-01937 TO DP020-MSG-NUMBER            49870000
498800           END-IF                                                 49880000
498900           SET PS-ERROR TO TRUE                                   49890000
499000        END-IF                                                    49900000
499100     END-IF.                                                      49910000
499200                                                                  49920000
499300******************************************************************49930000
499400* THIS PARAGRAPH CALCULATES THE MARKON PERCENTAGE FOR ANY TRANS- *49940000
499500* ACTION THAT HAS BOTH A RETAIL AND GROSS COST AMOUNT NOT EQUAL  *49950000
499600* TO ZERO.  IF THE PERCENTAGE IS 85% OR GREATER THEN A WARNING   *49960000
499700* MESSAGE IS DISPLAYED AND THE USER WILL HAVE TO CORRECT THE     *49970000
499800* AMOUNTS (RETAIL AND/OR GROSS COST).  ALSO IF THE PERCENTAGE IS *49980000
499900* 15% OR LESS THEN THE SAME WARNING IS SET.                      *49990000
500000******************************************************************50000000
500100 3385-CALC-MARKON-PERCENTAGE.                                     50010000
500200                                                                  50020000
500300     MOVE ZEROES TO PV-MARKON-PCT.                                50030000
500400                                                                  50040000
500500     IF ASC-RETAIL-AMT NOT EQUAL ZERO AND                         50050000
500600        ASC-GROSS-COST NOT EQUAL ZERO                             50060000
500700        MOVE ASC-RETAIL-AMT TO PV-ABS-RETAIL-AMT                  50070000
500800        MOVE ASC-GROSS-COST TO PV-ABS-GROSS-COST                  50080000
500900        IF PV-ABS-GROSS-COST <= PV-ABS-RETAIL-AMT                 50090000
501000           COMPUTE PV-MARKON-PCT = (PV-ABS-RETAIL-AMT -           50100000
501100                   PV-ABS-GROSS-COST) * 100 / PV-ABS-RETAIL-AMT   50110000
501200           IF PV-MARKON-PCT >= 85.000 OR                          50120000
501300                            <= 15.000                             50130000
501400** WARNING!! CALCULATED MARKON PCNT IS NOT CONSISTENT WITH NORMAL 50140000
501500*            MARKON                                               50150000
501600              SET DP020-MSG-WARNING TO TRUE                       50160000
501700              IF PS-NO-ERROR                                      50170000
501800                 MOVE PC-TSYMSG-02316 TO DP020-MSG-NUMBER         50180000
501900              END-IF                                              50190000
502000              SET PS-WARNING TO TRUE                              50200000
502100           END-IF                                                 50210000
502200        END-IF                                                    50220000
502300     END-IF.                                                      50230000
502400                                                                  50240000
502500******************************************************************50250000
502600* THIS PARAGRAPH WILL CALCULATE THE DISTRIBUTION DOLLAR FIELDS.  *50260000
502700******************************************************************50270000
502800 3390-CALC-DISTRO-RETAIL.                                         50280000
502900                                                                  50290000
503000     IF PS-NO-ERROR                                               50300000
503100        IF ASC-RETAIL-AMT NOT EQUAL ZERO AND                      50310000
503200           ASC-GROSS-COST NOT EQUAL ZERO AND                      50320000
503300           ASC-ALP-DET-SKU EQUAL SPACES                           50330000
503400*MAB 08-10-99 START                                               50340000
503500           IF  (TRNCDE-COST-PRCCTL-CDE = 'R' AND                  50350000
503600                TRNCDE-RTL-PRCCTL-CDE  = 'R')                     50360000
503700                 INITIALIZE PV-DET-RETAIL                         50370000
503800                            ASC-DET-RETAIL                        50380000
503900           ELSE                                                   50390000
504000*MAB 08-10-99 END                                                 50400000
504100              INITIALIZE PV-DET-RETAIL                            50410000
504200              COMPUTE PV-DET-RETAIL =                             50420000
504300                                  ((ASC-DET-COST /                50430000
504400                                    ASC-GROSS-COST) *             50440000
504500                                    ASC-RETAIL-AMT)               50450000
504600              IF PV-DET-RETAIL GREATER THAN ZERO                  50460000
504700                 COMPUTE ASC-DET-RETAIL =                         50470000
504800                         PV-DET-RETAIL + .005                     50480000
504900              ELSE                                                50490000
505000                 IF PV-DET-RETAIL LESS THAN ZERO                  50500000
505100                    COMPUTE ASC-DET-RETAIL =                      50510000
505200                            PV-DET-RETAIL - .005                  50520000
505300                 ELSE                                             50530000
505400                    MOVE ZERO TO ASC-DET-RETAIL                   50540000
505500                 END-IF                                           50550000
505600              END-IF                                              50560000
505700              MOVE ASC-DET-RETAIL TO ASC-ALP-DET-RETL-9           50570000
505800           END-IF                                                 50580000
505900        ELSE                                                      50590000
506000           IF ASC-GROSS-COST = ZERO AND                           50600000
506100              ASC-RETAIL-AMT NOT EQUAL ZERO AND                   50610000
506200              ASC-ALP-DET-SKU EQUAL SPACES                        50620000
506300              INITIALIZE PV-DET-RETAIL                            50630000
506400                         ASC-DET-RETAIL                           50640000
506500           END-IF                                                 50650000
506600        END-IF                                                    50660000
506700     END-IF.                                                      50670000
506800                                                                  50680000
506900******************************************************************50690000
507000* THIS PARAGRAPH WILL CALCULATE THE DISTRIBUTION NET COST AMOUNT *50700000
507100* FOR THE FIRST LINE.                                            *50710000
507200******************************************************************50720000
507300 3395-CALC-DISTRO-NET.                                            50730000
507400                                                                  50740000
507500     INITIALIZE PV-ALLOC-PERC                                     50750000
507600                PV-DISTRO-FRGT-AMT                                50760000
507700                PV-DISTRO-MISC-CHRG                               50770000
507800                PV-DISTRO-DISC-AMT                                50780000
507900                PV-ROUNDING-FACTOR.                               50790000
508000                                                                  50800000
508100     IF ASC-PSTG-TYP-CDE = 'CH'                                   50810000
508200        MOVE +.005 TO PV-ROUNDING-FACTOR                          50820000
508300     ELSE                                                         50830000
508400        MOVE -.005 TO PV-ROUNDING-FACTOR                          50840000
508500     END-IF.                                                      50850000
508600                                                                  50860000
508700     IF ASC-FREIGHT-COST-ALLOCATION                               50870000
508800        COMPUTE PV-ALLOC-PERC = ASC-DET-COST / ASC-FREIGHT-AMT    50880000
508900     ELSE                                                         50890000
509000        IF ASC-GROSS-COST-ALLOCATION                              50900000
509100           COMPUTE PV-ALLOC-PERC = ASC-DET-COST / ASC-GROSS-COST  50910000
509200        ELSE                                                      50920000
509300           IF ASC-NEW-STR-COST-ALLOCATION                         50930000
509400              COMPUTE PV-ALLOC-PERC =                             50940000
509500                      ASC-DET-COST / ASC-NEW-STR-AMT              50950000
509600           ELSE                                                   50960000
509700              IF ASC-RETAIL-AMT-ALLOCATION                        50970000
509800                 COMPUTE PV-ALLOC-PERC =                          50980000
509900                         ASC-DET-RETAIL / ASC-RETAIL-AMT          50990000
510000              END-IF                                              51000000
510100           END-IF                                                 51010000
510200        END-IF                                                    51020000
510300     END-IF.                                                      51030000
510400                                                                  51040000
510500     IF ASC-FREIGHT-COST-ALLOCATION                               51050000
510600        MOVE ZERO                  TO PV-DISTRO-FRGT-AMT          51060000
510700     ELSE                                                         51070000
510800        COMPUTE PV-DISTRO-FRGT-AMT =                              51080000
510900                         (PV-ALLOC-PERC * ASC-FREIGHT-AMT) +      51090000
511000                                          PV-ROUNDING-FACTOR      51100000
511100     END-IF.                                                      51110000
511200                                                                  51120000
511300     COMPUTE PV-DISTRO-MISC-CHRG =                                51130000
511400                         (PV-ALLOC-PERC * ASC-MISC-CHG) +         51140000
511500                                          PV-ROUNDING-FACTOR.     51150000
511600                                                                  51160000
511700     IF ASC-NEW-STR-COST-ALLOCATION                               51170000
511800        MOVE ASC-DET-COST          TO PV-DISTRO-DISC-AMT          51180000
511900        MOVE ZERO                  TO ASC-DET-COST                51190000
512000     ELSE                                                         51200000
512100        COMPUTE PV-DISTRO-DISC-AMT =                              51210000
512200                         (PV-ALLOC-PERC * (ASC-DISC-AMT +         51220000
512300                                           ASC-NEW-STR-AMT +      51230000
512400                                           ASC-TRADE-AMT +        51240000
512500                                           ASC-MOS-AMT)) +        51250000
512600                                           PV-ROUNDING-FACTOR     51260000
512700     END-IF.                                                      51270000
512800                                                                  51280000
512900     IF PS-NO-ERROR                                               51290000
513000        INITIALIZE PV-NET-COST                                    51300000
513100        COMPUTE PV-NET-COST = (ASC-DET-COST + PV-DISTRO-FRGT-AMT +51310000
513200                               PV-DISTRO-MISC-CHRG -              51320000
513300                               PV-DISTRO-DISC-AMT)                51330000
513400        IF PV-NET-COST GREATER THAN ZERO                          51340000
513500           MOVE +.005 TO PV-ROUNDING-FACTOR                       51350000
513600        ELSE                                                      51360000
513700           IF PV-NET-COST LESS THAN ZERO                          51370000
513800              MOVE -.005 TO PV-ROUNDING-FACTOR                    51380000
513900           ELSE                                                   51390000
514000              MOVE ZERO TO PV-ROUNDING-FACTOR                     51400000
514100           END-IF                                                 51410000
514200        END-IF                                                    51420000
514300        COMPUTE PV-NET-COST = (ASC-DET-COST + PV-DISTRO-FRGT-AMT +51430000
514400                               PV-DISTRO-MISC-CHRG -              51440000
514500                               PV-DISTRO-DISC-AMT) +              51450000
514600                               PV-ROUNDING-FACTOR                 51460000
514700        MOVE PV-NET-COST TO ASC-DET-NET                           51470000
514800     END-IF.                                                      51480000
514900                                                                  51490000
515000******************************************************************51500000
515100* THIS PARAGRAPH WILL DETERMINE IF THE FIRST (AND ONLY)          *51510000
515200* ADJUSTMENT DISTRIBUTION LINE ON THIS SCREEN HAS GROSS COST AND *51520000
515300* RETAIL AMOUNTS THAT MATCH THE HEADER VALUES FOR THESE FIELDS.  *51530000
515400* IF THESE TWO DISTRIBUTION VALUES MATCH THEIR HEADER VALUES     *51540000
515500* A SWITCH WILL BE SET TO BE PASSED TO THE ADJUSTMENT DETAIL     *51550000
515600* ENTRY SCREEN THAT WILL ALLOW FOR AN INSTANTANEOUS INSERT TO    *51560000
515700* BE PERFORMED.  THE USER WILL NOT SEE THE SECOND SCREEN.        *51570000
515800******************************************************************51580000
515900 3400-CHECK-DOLLAR-AMOUNTS.                                       51590000
516000                                                                  51600000
516100     IF ASC-FREIGHT-COST-ALLOCATION                               51610000
516200        IF ASC-FREIGHT-AMT = ASC-DET-COST                         51620000
516300           SET ASC-COST-MATCH TO TRUE                             51630000
516400        END-IF                                                    51640000
516500     ELSE                                                         51650000
516600        IF ASC-NEW-STR-COST-ALLOCATION                            51660000
516700           IF ASC-NEW-STR-AMT = PV-DISTRO-DISC-AMT                51670000
516800              SET ASC-COST-MATCH TO TRUE                          51680000
516900           END-IF                                                 51690000
517000        ELSE                                                      51700000
517100           IF ASC-GROSS-COST = ASC-DET-COST                       51710000
517200              SET ASC-COST-MATCH TO TRUE                          51720000
517300           END-IF                                                 51730000
517400        END-IF                                                    51740000
517500     END-IF.                                                      51750000
517600                                                                  51760000
517700     IF ASC-RETAIL-AMT = ASC-DET-RETAIL                           51770000
517800        SET ASC-RETAIL-MATCH TO TRUE                              51780000
517900     END-IF.                                                      51790000
518000                                                                  51800000
518100******************************************************************51810000
518200* GET THE NEXT AVAILABLE MESSAGE NUMBER, MOVE IT TO THE SCREEN   *51820000
518300* AND POSITION THE CURSOR FOR THE INITIAL PANEL.                 *51830000
518400******************************************************************51840000
518500 4000-BUILD-INITIAL-PANEL.                                        51850000
518600                                                                  51860000
518700     INITIALIZE DCLTADJRNL                                        51870000
518800                DCLTADJDIS                                        51880000
518900                DCLTTRNCDE                                        51890000
519000                DCLTEXTENT                                        51900000
519100                DCLTENTNME                                        51910000
519200                DCLTVNDAGR                                        51920000
519300                DCLXFT00017                                       51930000
519400*               DCLXFT00003                                       51940000
519500                DCLTPURCHS.                                       51950000
519600                                                                  51960000
519700     EXEC SQL                                                     51970000
519800         SET :ASC-CURRENT-DATE = CURRENT DATE                     51980000
519900     END-EXEC.                                                    51990000
520000                                                                  52000000
520100     IF ASC-KEY-DOC-NUMBER > SPACES                               52010000
520200        MOVE ASC-KEY-DOC-NUMBER TO DK-DOCUMENT-NO-LOW             52020000
520300                                   DK-DOCUMENT-NO-HIGH            52030000
520400     ELSE                                                         52040000
520500        MOVE LOW-VALUES         TO DK-DOCUMENT-NO-LOW             52050000
520600        MOVE HIGH-VALUES        TO DK-DOCUMENT-NO-HIGH            52060000
520700     END-IF.                                                      52070000
520800                                                                  52080000
520900     IF ASC-KEY-PO-NBR > +0                                       52090000
521000        MOVE ASC-KEY-PO-NBR        TO DK-PO-NBR-LOW               52100000
521100                                      DK-PO-NBR-HIGH              52110000
521200     ELSE                                                         52120000
521300        MOVE +0                    TO DK-PO-NBR-LOW               52130000
521400        MOVE +999999999            TO DK-PO-NBR-HIGH              52140000
521500     END-IF.                                                      52150000
521600                                                                  52160000
521700     IF ASC-KEY-TRAN-CODE > SPACES                                52170000
521800        MOVE ASC-KEY-TRAN-CODE     TO DK-TRAN-CODE-LOW            52180000
521900                                      DK-TRAN-CODE-HIGH           52190000
522000     ELSE                                                         52200000
522100        MOVE LOW-VALUES            TO DK-TRAN-CODE-LOW            52210000
522200        MOVE HIGH-VALUES           TO DK-TRAN-CODE-HIGH           52220000
522300     END-IF.                                                      52230000
522400                                                                  52240000
522500     IF ASC-KEY-VEND-NUMBER > SPACES                              52250000
522600        MOVE ASC-KEY-VEND-NUMBER   TO DK-VEND-NUMBER-LOW          52260000
522700                                      DK-VEND-NUMBER-HIGH         52270000
522800     ELSE                                                         52280000
522900        MOVE LOW-VALUES            TO DK-VEND-NUMBER-LOW          52290000
523000        MOVE HIGH-VALUES           TO DK-VEND-NUMBER-HIGH         52300000
523100     END-IF.                                                      52310000
523200                                                                  52320000
523300     IF ASC-KEY-DOC-DATE > SPACES                                 52330000
523400        MOVE ASC-KEY-DOC-DATE      TO DK-DOC-DATE-LOW             52340000
523500                                      DK-DOC-DATE-HIGH            52350000
523600     ELSE                                                         52360000
523700        MOVE '0001-01-01'          TO DK-DOC-DATE-LOW             52370000
523800        MOVE '9999-12-31'          TO DK-DOC-DATE-HIGH            52380000
523900     END-IF.                                                      52390000
524000                                                                  52400000
524100     SET PS-NO-ERROR               TO TRUE.                       52410000
524200     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       52420000
524300     MOVE -1                       TO ATRANCDL.                   52430000
524400     SET PS-NUMBER-NOT-LOCKED      TO TRUE.                       52440000
524500                                                                  52450000
524600     IF PS-NO-ERROR                                               52460000
524700        IF ASC-ADD-PENDING                                        52470000
524800           PERFORM 4001-ADD-PENDING-LOGIC                         52480000
524900        ELSE                                                      52490000
525000           PERFORM 4005-VALIDATE-KEY-FIELDS                       52500000
525100        END-IF                                                    52510000
525200     ELSE                                                         52520000
525300        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     52530000
525400     END-IF.                                                      52540000
525500                                                                  52550000
525600******************************************************************52560000
525700*    VERIFY REQUIRED FIELDS FOR INSERT ARE PRESENT.              *52570000
525800******************************************************************52580000
525900 4001-ADD-PENDING-LOGIC.                                          52590000
526000                                                                  52600000
526100     SET ASC-MULT-DIST        TO TRUE.                            52610000
526200     MOVE ASC-KEY-VEND-NUMBER TO ASC-VENDOR-NUMBER.               52620000
526300     MOVE ASC-KEY-PO-NBR      TO ASC-PO-NUMBER                    52630000
526400                                 ASC-ALP-PO-NBR.                  52640000
526500     MOVE ASC-KEY-DOC-NUMBER  TO ASC-DOC-NUMBER.                  52650000
526600     MOVE ASC-KEY-TRAN-CODE   TO ASC-TRAN-CD.                     52660000
526700                                                                  52670000
526800     IF ASC-KEY-VEND-NUMBER = SPACES                              52680000
526900         SET DP020-MSG-FATAL TO TRUE                              52690000
527000         MOVE DP015-UNP-ALP-BRT-OFF TO AVENDNOA                   52700000
527100         MOVE DP015-RED             TO AVENDNOC                   52710000
527200         MOVE DP015-REVERSE         TO AVENDNOH                   52720000
527300         MOVE -1                    TO AVENDNOL                   52730000
527400         IF PS-NO-ERROR                                           52740000
527500             MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           52750000
527600         END-IF                                                   52760000
527700         SET PS-ERROR TO TRUE                                     52770000
527800     ELSE                                                         52780000
527900         SET ASC-VENDOR-NOT-FOUND TO TRUE                         52790000
528000         MOVE ASC-VENDOR-NUMBER TO EXTENT-DUN-NBR                 52800000
528100         PERFORM 4800-VALIDATE-VENDOR                             52810000
528200         IF ASC-VENDOR-NOT-FOUND                                  52820000
528300            SET DP020-MSG-FATAL TO TRUE                           52830000
528400            MOVE DP015-UNP-ALP-BRT-OFF TO AVENDNOA                52840000
528500            MOVE DP015-RED         TO AVENDNOC                    52850000
528600            MOVE DP015-REVERSE     TO AVENDNOH                    52860000
528700            MOVE -1                TO AVENDNOL                    52870000
528800            IF PS-NO-ERROR                                        52880000
528900                MOVE PC-TSYMSG-01095 TO DP020-MSG-NUMBER          52890000
529000            END-IF                                                52900000
529100            SET PS-ERROR TO TRUE                                  52910000
529200            SET DP020-NEXT-ACT-APPL-ERROR                         52920000
529300                                      TO TRUE                     52930000
529400         END-IF                                                   52940000
529500         MOVE ENTNME-ENT-NAME-DESC TO ASC-VENDOR-NAME             52950000
529600         IF ASC-DOC-NUMBER > SPACES                               52960000
529700            SET ASC-NO-DUP-DOC TO TRUE                            52970000
529800            PERFORM 4600-VALIDATE-UNIQUE-DOC                      52980000
529900            IF ASC-DUP-DOC                                        52990000
530000               SET DP020-MSG-FATAL TO TRUE                        53000000
530100               MOVE DP015-UNP-ALP-BRT-OFF TO ADOCNUMA             53010000
530200               MOVE DP015-RED      TO ADOCNUMC                    53020000
530300               MOVE DP015-REVERSE  TO ADOCNUMH                    53030000
530400               MOVE -1             TO ADOCNUML                    53040000
530500               IF PS-NO-ERROR                                     53050000
530600                   MOVE PC-TSYMSG-01919 TO DP020-MSG-NUMBER       53060000
530700               END-IF                                             53070000
530800               SET PS-ERROR TO TRUE                               53080000
530900               SET DP020-NEXT-ACT-APPL-ERROR                      53090000
531000                                         TO TRUE                  53100000
531100            END-IF                                                53110000
531200         END-IF                                                   53120000
531300         IF ASC-TRAN-CD NOT EQUAL SPACES                          53130000
531400            PERFORM 4700-VALIDATE-TRAN-CD                         53140000
531500*           MOVE TRNCDE-AUTO-OFFST-TRN-CDE TO ASC-OFFSET-TRAN-CD  53150000
531600            IF ASC-TRAN-CDE-NOT-FND                               53160000
531700               SET DP020-MSG-FATAL TO TRUE                        53170000
531800               MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA             53180000
531900               MOVE DP015-RED             TO ATRANCDC             53190000
532000               MOVE DP015-REVERSE         TO ATRANCDH             53200000
532100               MOVE -1                    TO ATRANCDL             53210000
532200               IF PS-NO-ERROR                                     53220000
532300                  MOVE PC-TSYMSG-01899    TO DP020-MSG-NUMBER     53230000
532400               END-IF                                             53240000
532500               SET PS-ERROR               TO TRUE                 53250000
532600               SET DP020-NEXT-ACT-APPL-ERROR                      53260000
532700                                          TO TRUE                 53270000
532800            ELSE                                                  53280000
532900               IF TRNCDE-TRN-SRC-CDE NOT = 'A' AND                53290000
533000                  TRNCDE-TRN-SRC-CDE NOT = 'O'                    53300000
533100                  SET DP020-MSG-FATAL     TO TRUE                 53310000
533200                  MOVE DP015-UNP-ALP-BRT-OFF                      53320000
533300                                          TO ATRANCDA             53330000
533400                  MOVE DP015-RED          TO ATRANCDC             53340000
533500                  MOVE DP015-REVERSE      TO ATRANCDH             53350000
533600                  MOVE -1                 TO ATRANCDL             53360000
533700                  IF PS-NO-ERROR                                  53370000
533800                     MOVE PC-TSYMSG-01899 TO DP020-MSG-NUMBER     53380000
533900                  END-IF                                          53390000
534000                  SET PS-ERROR            TO TRUE                 53400000
534100                  SET DP020-NEXT-ACT-APPL-ERROR                   53410000
534200                                          TO TRUE                 53420000
534300               ELSE                                               53430000
534400                  MOVE TRNCDE-AP-TRN-CDE TO PV-TRAN-CDE-APPL-CDE  53440000
534500                  EVALUATE TRUE                                   53450000
534600                     WHEN PV-TRANSFER-TRAN-CODE                   53460000
534700                      AND ASC-ADD-PENDING                         53470000
534800                          SET DP020-MSG-FATAL        TO TRUE      53480000
534900                          MOVE DP015-UNP-ALP-BRT-OFF TO ATRANCDA  53490000
535000                          MOVE DP015-RED             TO ATRANCDC  53500000
535100                          MOVE DP015-REVERSE         TO ATRANCDH  53510000
535200                          MOVE -1                    TO ATRANCDL  53520000
535300                          IF PS-NO-ERROR                          53530000
535400                             MOVE PC-TSYMSG-01940                 53540000
535500                                               TO DP020-MSG-NUMBER53550000
535600                          END-IF                                  53560000
535700                          SET PS-ERROR TO TRUE                    53570000
535800                  END-EVALUATE                                    53580000
535900               END-IF                                             53590000
536000            END-IF                                                53600000
536100         END-IF                                                   53610000
536200     END-IF.                                                      53620000
536300                                                                  53630000
536400     IF PS-NO-ERROR                                               53640000
536500        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                      53650000
536600     ELSE                                                         53660000
536700        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     53670000
536800     END-IF.                                                      53680000
536900                                                                  53690000
537000******************************************************************53700000
537100* THIS PARAGRAPH WILL CONTROL VALIDATION FOR KEY FIELDS PASSED   *53710000
537200* TO THIS PROGRAM FROM ANOTHER.                                  *53720000
537300******************************************************************53730000
537400 4005-VALIDATE-KEY-FIELDS.                                        53740000
537500                                                                  53750000
537600     PERFORM 4010-VALIDATE-DOC-EXISTENCE.                         53760000
537700                                                                  53770000
537800     MOVE ADJRNL-AP-TRN-CDE TO PV-TRAN-CDE-APPL-CDE.              53780000
537900                                                                  53790000
538000     IF ASC-DOCUMENT-NOT-FOUND OR                                 53800000
538100        ASC-MULTIPLE-DOCUMENTS                                    53810000
538200        IF ASC-DOCUMENT-NOT-FOUND                                 53820000
538300**  DOCUMENT DOES NOT EXIST                                       53830000
538400           MOVE PC-TSYMSG-00148       TO DP020-MSG-NUMBER         53840000
538500           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCNUMA                 53850000
538600           MOVE DP015-RED             TO ADOCNUMC                 53860000
538700           MOVE DP015-REVERSE         TO ADOCNUMH                 53870000
538800           MOVE -1                    TO ADOCNUML                 53880000
538900        ELSE                                                      53890000
539000**  DUPLICATE ADJUSTMENTS FOUND - NEED MORE INFORMATION           53900000
539100           MOVE PC-TSYMSG-01943       TO DP020-MSG-NUMBER         53910000
539200           IF DP020-NEXT-ACT-INITIAL                              53920000
539300              SET DP020-NEXT-ACT-APPL-ERROR                       53930000
539400                  DP020-MSG-FATAL                                 53940000
539500                                      TO TRUE                     53950000
539600           END-IF                                                 53960000
539700        END-IF                                                    53970000
539800     ELSE                                                         53980000
539900        IF (ASC-DELETE-REQUESTED OR                               53990000
540000            ASC-UPDATE-REQUESTED)                                 54000000
540100            IF ADJRNL-ENTR-ID NOT EQUAL DP020-USERID              54010000
540200               MOVE PC-TSYMSG-01917 TO DP020-MSG-NUMBER           54020000
540300               SET DP020-MSG-WARNING          TO TRUE             54030000
540400            END-IF                                                54040000
540500                                                                  54050000
540600               IF ADJRNL-ENTR-TMST(1:10) NOT EQUAL                54060000
540700                                             ASC-CURRENT-DATE     54070000
540800** IF ADJRNL-PS-PSTG-IND IS 'N' THEN THE ADJUSTMENT HAS BEEN      54080000
540900** REJECTED FROM PEOPLESOFT AND UPDATEABLE REGARDLESS OF WHETHER  54090000
541000** THE UPDATE DATE IS THE SAME AS THE ENTER DATE.                 54100000
541100                  IF ADJRNL-PS-PSTG-IND = 'Y'                     54110000
541200                     MOVE PC-TSYMSG-01918 TO DP020-MSG-NUMBER     54120000
541300                     SET DP020-MSG-FATAL                          54130000
541400                         DP020-NEXT-ACT-APPL-ERROR                54140000
541500                         PS-ERROR             TO TRUE             54150000
541600                  ELSE                                            54160000
541700                     IF ASC-OFFSET-ADJUSTMENT                     54170000
541800** ERROR - OFFSET ADJUST CAN ONLY BE UPDATED/DELETED FROM THE     54180000
541900**         ORIGINATING ADJUSTMENT                                 54190000
542000                        MOVE PC-TSYMSG-03429 TO DP020-MSG-NUMBER  54200000
542100                        SET DP020-MSG-FATAL                       54210000
542200                            DP020-NEXT-ACT-APPL-ERROR             54220000
542300                            PS-ERROR             TO TRUE          54230000
542400                     ELSE                                         54240000
542500                        IF ASC-OFFSET-EXTRACTED                   54250000
542600** ERROR - CANNOT UPDATE/DELETE BECAUSE OFFSET ADJUSTMENT         54260000
542700**         HAS BEEN EXTRACTED                                     54270000
542800                           MOVE PC-TSYMSG-03431 TO                54280000
542900                                DP020-MSG-NUMBER                  54290000
543000                           SET DP020-MSG-FATAL                    54300000
543100                               DP020-NEXT-ACT-APPL-ERROR          54310000
543200                               PS-ERROR         TO TRUE           54320000
543300                        END-IF                                    54330000
543400                     END-IF                                       54340000
543500                  END-IF                                          54350000
543600               ELSE                                               54360000
543700                  IF ADJRNL-ORGN-CDE NOT = 'A'                    54370000
543800                     MOVE PC-TSYMSG-01939 TO DP020-MSG-NUMBER     54380000
543900                     SET DP020-MSG-FATAL                          54390000
544000                         DP020-NEXT-ACT-APPL-ERROR                54400000
544100                         PS-ERROR                 TO TRUE         54410000
544200                  ELSE                                            54420000
544300                     IF ASC-OFFSET-ADJUSTMENT                     54430000
544400** ERROR - OFFSET ADJUST CAN ONLY BE UPDATED/DELETED FROM THE     54440000
544500**         ORIGINATING ADJUSTMENT                                 54450000
544600                        MOVE PC-TSYMSG-03429 TO DP020-MSG-NUMBER  54460000
544700                        SET DP020-MSG-FATAL                       54470000
544800                            DP020-NEXT-ACT-APPL-ERROR             54480000
544900                            PS-ERROR             TO TRUE          54490000
545000                     ELSE                                         54500000
545100                        IF ASC-OFFSET-EXTRACTED                   54510000
545200** ERROR - CANNOT UPDATE/DELETE BECAUSE OFFSET ADJUSTMENT         54520000
545300**         HAS BEEN EXTRACTED                                     54530000
545400                           MOVE PC-TSYMSG-03431 TO                54540000
545500                                DP020-MSG-NUMBER                  54550000
545600                           SET DP020-MSG-FATAL                    54560000
545700                               DP020-NEXT-ACT-APPL-ERROR          54570000
545800                               PS-ERROR         TO TRUE           54580000
545900                        END-IF                                    54590000
546000                     END-IF                                       54600000
546100                  END-IF                                          54610000
546200               END-IF                                             54620000
546300*           END-IF                                                54630000
546400            IF NOT PV-TRANSFER-TRAN-CODE                          54640000
546500               PERFORM 4015-SELECT-AJPSINT                        54650000
546600            ELSE                                                  54660000
546700               IF ASC-UPDATE-REQUESTED                            54670000
546800                  IF PS-NO-ERROR                                  54680000
546900                     MOVE PC-TSYMSG-01939 TO DP020-MSG-NUMBER     54690000
547000                  END-IF                                          54700000
547100                  SET DP020-MSG-FATAL                             54710000
547200                      DP020-NEXT-ACT-APPL-ERROR                   54720000
547300                      PS-ERROR                TO TRUE             54730000
547400               ELSE                                               54740000
547500                  INITIALIZE AJPSINT-VND-NBR                      54750000
547600                             AJPSINT-DOC-NBR                      54760000
547700                             AJPSINT-DOC-DTE                      54770000
547800                             AJPSINT-AP-TRN-CDE                   54780000
547900                             AJPSINT-DUE-DTE                      54790000
548000                             AJPSINT-DOC-HLD-CDE                  54800000
548100                             AJPSINT-RSN-1ST-LNE-TXT              54810000
548200                             AJPSINT-RSN-2ND-LNE-TXT              54820000
548300                             AJPSINT-AUTH-NBR                     54830000
548400               END-IF                                             54840000
548500            END-IF                                                54850000
548600            PERFORM 4016-GET-FIRST-ADJDIS                         54860000
548700            PERFORM 4020-GET-REST-OF-DATA                         54870000
548800** THIS FETCH IS NEEDED TO DETERMINE IF THERE IS MORE THAN ONE    54880000
548900** DISTRIBUTION LINE FOR THIS ADJUSTMENT.  IF THE ASC-MULT-DISTRO 54890000
549000** SWITCH INDICATES THAT THERE ARE MORE DISTRIBUTION LINES        54900000
549100** REMAINING, THEN THERE IS MORE THAN ONE LINE OF DISTRIBUTION.   54910000
549200            PERFORM 4018-FETCH-DET-CSR                            54920000
549300            PERFORM 4019-CLOSE-DET-CSR                            54930000
549400        END-IF                                                    54940000
549500     END-IF.                                                      54950000
549600                                                                  54960000
549700******************************************************************54970000
549800* THIS PARAGRAPH WILL RETRIEVE THE ADJUSTMENT DOCUMENT DATA      *54980000
549900* FOR DISPLAY.                                                   *54990000
550000******************************************************************55000000
550100 4010-VALIDATE-DOC-EXISTENCE.                                     55010000
550200                                                                  55020000
550300     EXEC SQL                                                     55030000
550400         SELECT VND_NBR                                           55040000
550500               ,DOC_NBR                                           55050000
550600               ,DOC_DTE                                           55060000
550700               ,AP_TRN_CDE                                        55070000
550800               ,PO_NBR                                            55080000
550900               ,DEPT_NBR                                          55090000
551000               ,GL_ACCT_NBR                                       55100000
551100               ,STR_NBR                                           55110000
551200               ,ENTR_TMST                                         55120000
551300               ,ENTR_ID                                           55130000
551400               ,ORGN_CDE                                          55140000
551500               ,GRO_COST_AMT                                      55150000
551600               ,RTL_AMT                                           55160000
551700               ,FRGT_AMT                                          55170000
551800               ,MISC_CHRG_AMT                                     55180000
551900               ,TERM_DISC_PCT                                     55190000
552000               ,TERM_DISC_AMT                                     55200000
552100               ,NW_STR_DISC_PCT                                   55210000
552200               ,NW_STR_DISC_AMT                                   55220000
552300               ,TRD_DISC_PCT                                      55230000
552400               ,TRD_DISC_AMT                                      55240000
552500               ,NET_COST_AMT                                      55250000
552600               ,INV_CTOFF_DTE                                     55260000
552700               ,TRN_TYP_CDE                                       55270000
552800               ,DOC_EXTR_IND                                      55280000
552900               ,DOC_EXTR_DTE                                      55290000
553000               ,PSTG_FYR_NBR                                      55300000
553100               ,PSTG_FMN_NBR                                      55310000
553200               ,PSTG_FWK_NBR                                      55320000
553300               ,BRCDE_NBR                                         55330000
553400               ,PS_BTCH_NBR                                       55340000
553500               ,PS_PSTG_IND                                       55350000
553600               ,ENT_ID                                            55360000
553700               ,MOS_DISC_PCT                                      55370000
553800               ,MOS_DISC_AMT                                      55380000
553900         INTO  :ADJRNL-VND-NBR                                    55390000
554000              ,:ADJRNL-DOC-NBR                                    55400000
554100              ,:ADJRNL-DOC-DTE                                    55410000
554200              ,:ADJRNL-AP-TRN-CDE                                 55420000
554300              ,:ADJRNL-PO-NBR                                     55430000
554400              ,:ADJRNL-DEPT-NBR                                   55440000
554500              ,:ADJRNL-GL-ACCT-NBR                                55450000
554600              ,:ADJRNL-STR-NBR                                    55460000
554700              ,:ADJRNL-ENTR-TMST                                  55470000
554800              ,:ADJRNL-ENTR-ID                                    55480000
554900              ,:ADJRNL-ORGN-CDE                                   55490000
555000              ,:ADJRNL-GRO-COST-AMT                               55500000
555100              ,:ADJRNL-RTL-AMT                                    55510000
555200              ,:ADJRNL-FRGT-AMT                                   55520000
555300              ,:ADJRNL-MISC-CHRG-AMT                              55530000
555400              ,:ADJRNL-TERM-DISC-PCT                              55540000
555500              ,:ADJRNL-TERM-DISC-AMT                              55550000
555600              ,:ADJRNL-NW-STR-DISC-PCT                            55560000
555700              ,:ADJRNL-NW-STR-DISC-AMT                            55570000
555800              ,:ADJRNL-TRD-DISC-PCT                               55580000
555900              ,:ADJRNL-TRD-DISC-AMT                               55590000
556000              ,:ADJRNL-NET-COST-AMT                               55600000
556100              ,:ADJRNL-INV-CTOFF-DTE                              55610000
556200              ,:ADJRNL-TRN-TYP-CDE                                55620000
556300              ,:ADJRNL-DOC-EXTR-IND                               55630000
556400              ,:ADJRNL-DOC-EXTR-DTE                               55640000
556500              ,:ADJRNL-PSTG-FYR-NBR                               55650000
556600              ,:ADJRNL-PSTG-FMN-NBR                               55660000
556700              ,:ADJRNL-PSTG-FWK-NBR                               55670000
556800              ,:ADJRNL-BRCDE-NBR                                  55680000
556900              ,:ADJRNL-PS-BTCH-NBR                                55690000
557000              ,:ADJRNL-PS-PSTG-IND                                55700000
557100              ,:ADJRNL-ENT-ID                                     55710000
557200              ,:ADJRNL-MOS-DISC-PCT                               55720000
557300              ,:ADJRNL-MOS-DISC-AMT                               55730000
557400         FROM TADJRNL                                             55740000
557500         WHERE   DOC_NBR BETWEEN :DK-DOCUMENT-NO-LOW              55750000
557600                             AND :DK-DOCUMENT-NO-HIGH             55760000
557700         AND     PO_NBR IS NOT NULL                               55770000
557800         AND     PO_NBR BETWEEN :DK-PO-NBR-LOW                    55780000
557900                            AND :DK-PO-NBR-HIGH                   55790000
558000         AND AP_TRN_CDE BETWEEN :DK-TRAN-CODE-LOW                 55800000
558100                            AND :DK-TRAN-CODE-HIGH                55810000
558200         AND VND_NBR    BETWEEN :DK-VEND-NUMBER-LOW               55820000
558300                            AND :DK-VEND-NUMBER-HIGH              55830000
558400         AND DOC_DTE    BETWEEN :DK-DOC-DATE-LOW                  55840000
558500                            AND :DK-DOC-DATE-HIGH                 55850000
558600     END-EXEC.                                                    55860000
558700                                                                  55870000
558800     EVALUATE TRUE                                                55880000
558900         WHEN SQLCODE = +0                                        55890000
559000             SET ASC-DOCUMENT-FOUND   TO TRUE                     55900000
559100             PERFORM 4011-CHECK-IF-OFFSET-ADJ                     55910000
559200             IF ASC-NOT-OFFSET-ADJUSTMENT                         55920000
559300                PERFORM 4012-CHECK-FOR-OFFSET-TRANCODE            55930000
559400             END-IF                                               55940000
559500         WHEN SQLCODE = -904                                      55950000
559600         WHEN SQLCODE = -913                                      55960000
559700             CONTINUE                                             55970000
559800         WHEN SQLCODE = -811                                      55980000
559900                                                                  55990000
560000             SET ASC-MULTIPLE-DOCUMENTS TO TRUE                   56000000
560100                                                                  56010000
560200         WHEN SQLCODE = +100                                      56020000
560300                                                                  56030000
560400             SET ASC-DOCUMENT-NOT-FOUND TO TRUE                   56040000
560500                                                                  56050000
560600         WHEN SQLWARN0 NOT = SPACES                               56060000
560700                                                                  56070000
560800             SET ASC-DOCUMENT-NOT-FOUND TO TRUE                   56080000
560900                                                                  56090000
561000         WHEN SQLWARN0 NOT = SPACES                               56100000
561100         WHEN SQLCODE < ZERO                                      56110000
561200         WHEN SQLCODE > ZERO                                      56120000
561300             MOVE '4010-SELECT-TADJRNL'                           56130000
561400                               TO DP013-PARAGRAPH                 56140000
561500             MOVE 'SELECT ON TADJRNL        '                     56150000
561600                               TO DP013-MESSAGE-TEXT (1)          56160000
561700             MOVE SQLCA   TO DP013-SQLCA                          56170000
561800             MOVE 'TADJRNL' TO DP013-DB2-TABLE-NAME (1)           56180000
561900             SET DP013-DB2-ABEND                                  56190000
562000                 DP013-XCTL-DISPLAY-RESTART                       56200000
562100                               TO TRUE                            56210000
562200             PERFORM DP013-0000-PROCESS-ABEND                     56220000
562300     END-EVALUATE.                                                56230000
562400                                                                  56240000
562500******************************************************************56250000
562600* THIS PARAGRAPH WILL RETRIEVE THE AP_TRN_CDE FROM TTRNCDE FOR   *56260000
562700* THE ADJRNL-AP-TRN-CDE BEING PROCESSED TO SEE IF THE LATTER IS  *56270000
562800* AN OFFSET TRANCODE FOR THE FORMER.                             *56280000
562900******************************************************************56290000
563000 4011-CHECK-IF-OFFSET-ADJ.                                        56300000
563100                                                                  56310000
563200     EXEC SQL                                                     56320000
563300        SELECT  AP_TRN_CDE                                        56330000
563400         INTO  :PV-ORIGIN-AP-TRN-CDE                              56340000
563500         FROM TTRNCDE                                             56350000
563600         WHERE AUTO_OFFST_TRN_CDE = :ADJRNL-AP-TRN-CDE            56360000
563700         AND        TRN_TYP_CDE   = 'MDS'                         56370000
563800         AND        TRN_SRC_CDE   = 'O'                           56380000
563900         AND        BTCH_SRC_CDE  = 'ADJ'                         56390000
564000         AND        EFF_STRT_DTE <=  CURRENT DATE                 56400000
564100         AND        EFF_END_DTE  >=  CURRENT DATE                 56410000
564200     END-EXEC.                                                    56420000
564300                                                                  56430000
564400     EVALUATE TRUE                                                56440000
564500         WHEN SQLCODE = +0                                        56450000
564600         WHEN SQLCODE = -811                                      56460000
564700             PERFORM 4013-CHECK-DOC-NBR-FOR-OFF                   56470000
564800                                                                  56480000
564900         WHEN SQLCODE = +100                                      56490000
565000             SET ASC-NOT-OFFSET-ADJUSTMENT TO TRUE                56500000
565100                                                                  56510000
565200         WHEN SQLWARN0 NOT = SPACES                               56520000
565300         WHEN SQLCODE < ZERO                                      56530000
565400         WHEN SQLCODE > ZERO                                      56540000
565500             MOVE '4011-CHECK-IF-OFFSET-ADJ  '                    56550000
565600                               TO DP013-PARAGRAPH                 56560000
565700             MOVE 'SELECT ON TTRNCDE        '                     56570000
565800                               TO DP013-MESSAGE-TEXT (1)          56580000
565900             MOVE SQLCA   TO DP013-SQLCA                          56590000
566000             MOVE 'TTRNCDE' TO DP013-DB2-TABLE-NAME (1)           56600000
566100             SET DP013-DB2-ABEND                                  56610000
566200                 DP013-XCTL-DISPLAY-RESTART                       56620000
566300                               TO TRUE                            56630000
566400             PERFORM DP013-0000-PROCESS-ABEND                     56640000
566500     END-EVALUATE.                                                56650000
566600                                                                  56660000
566700******************************************************************56670000
566800* THIS PARAGRAPH WILL RETRIEVE THE AP_TRN_CDE FROM TTRNCDE FOR   *56680000
566900* THE ADJRNL-AP-TRN-CDE BEING PROCESSED TO SEE IF THE LATTER IS  *56690000
567000* AN ORIGINATING TRANCODE FOR THE FORMER.                        *56700000
567100******************************************************************56710000
567200 4012-CHECK-FOR-OFFSET-TRANCODE.                                  56720000
567300                                                                  56730000
567400     EXEC SQL                                                     56740000
567500        SELECT AUTO_OFFST_TRN_CDE                                 56750000
567600          INTO :PV-OFFSET-AP-TRN-CDE                              56760000
567700          FROM TTRNCDE                                            56770000
567800         WHERE AP_TRN_CDE    = :ADJRNL-AP-TRN-CDE                 56780000
567900           AND AUTO_OFFST_TRN_CDE ^= '  '                         56790000
568000           AND TRN_SRC_CDE   = 'O'                                56800000
568100           AND BTCH_SRC_CDE  = 'ADJ'                              56810000
568200           AND EFF_STRT_DTE <=  CURRENT DATE                      56820000
568300           AND EFF_END_DTE  >=  CURRENT DATE                      56830000
568400     END-EXEC.                                                    56840000
568500                                                                  56850000
568600     EVALUATE TRUE                                                56860000
568700         WHEN SQLCODE = +0                                        56870000
568800             PERFORM 4012B-CHECK-FOR-OFFSET-ADJ                   56880000
568900                                                                  56890000
569000         WHEN SQLCODE = +100                                      56900000
569100             SET ASC-OFFSET-ADJ-NOT-FOUND TO TRUE                 56910000
569200                                                                  56920000
569300         WHEN SQLWARN0 NOT = SPACES                               56930000
569400         WHEN SQLCODE < ZERO                                      56940000
569500         WHEN SQLCODE > ZERO                                      56950000
569600             MOVE '4012-CHECK-FOR-OFFSET-TRANCODE'                56960000
569700                               TO DP013-PARAGRAPH                 56970000
569800             MOVE 'SELECT ON TTRNCDE        '                     56980000
569900                               TO DP013-MESSAGE-TEXT (1)          56990000
570000             MOVE SQLCA   TO DP013-SQLCA                          57000000
570100             MOVE 'TTRNCDE' TO DP013-DB2-TABLE-NAME (1)           57010000
570200             SET DP013-DB2-ABEND                                  57020000
570300                 DP013-XCTL-DISPLAY-RESTART                       57030000
570400                               TO TRUE                            57040000
570500             PERFORM DP013-0000-PROCESS-ABEND                     57050000
570600     END-EVALUATE.                                                57060000
570700                                                                  57070000
570800******************************************************************57080000
570900* THIS PARAGRAPH WILL CHECK THE DOC_EXTR_IND OF AN OFFSETTING    *57090000
571000* ADJUSTMENT FOR THE ADJUSTMENT BEING PROCESSED.  THIS ESSENTIAL-*57100000
571100* LY INDICATES THAT AN OFFSET ADJUST EXISTS FOR THE ADJUSTMENT   *57110000
571200* BEING PROCESSED.                                               *57120000
571300******************************************************************57130000
571400 4012B-CHECK-FOR-OFFSET-ADJ.                                      57140000
571500                                                                  57150000
571600     INITIALIZE                  PV-STRING                        57160000
571700                                 PV-START                         57170000
571800                                 PV-END                           57180000
571900                                 PV-LENGTH.                       57190000
572000     MOVE ADJRNL-DOC-NBR      TO PV-STRING.                       57200000
572100     MOVE LENGTH OF PV-STRING TO PV-START.                        57210000
572200                                                                  57220000
572300     PERFORM                                                      57230000
572400       UNTIL PV-STRING(PV-START:1) > SPACES OR                    57240000
572500             PV-START = +0                                        57250000
572600         COMPUTE PV-START = PV-START - 1                          57260000
572700     END-PERFORM.                                                 57270000
572800                                                                  57280000
572900     IF PV-START > 13                                             57290000
573000        NEXT SENTENCE                                             57300000
573100     ELSE                                                         57310000
573200        MOVE PV-START TO PV-END                                   57320000
573300        IF PV-START < 13                                          57330000
573400           MOVE +1 TO PV-START                                    57340000
573500        ELSE                                                      57350000
573600           SUBTRACT +12 FROM PV-START                             57360000
573700        END-IF                                                    57370000
573800        COMPUTE PV-LENGTH = PV-END - PV-START + 1                 57380000
573900        MOVE PV-STRING(PV-START:PV-LENGTH)                        57390000
574000                   TO PV-OFFSET-DOC-NUMBER                        57400000
574100        MOVE 'OFF' TO PV-OFFSET-DOC-NUMBER(PV-LENGTH + 1:3)       57410000
574200     END-IF.                                                      57420000
574300                                                                  57430000
574400     EXEC SQL                                                     57440000
574500           SELECT DOC_EXTR_IND                                    57450000
574600            INTO :PV-OFFSET-DOC-EXTR-IND                          57460000
574700             FROM TADJRNL                                         57470000
574800            WHERE DOC_NBR          = :PV-OFFSET-DOC-NUMBER        57480000
574900              AND AP_TRN_CDE       = :PV-OFFSET-AP-TRN-CDE        57490000
575000              AND PO_NBR IS NOT NULL                              57500000
575100              AND VND_NBR          = :ADJRNL-VND-NBR              57510000
575200              AND DOC_DTE          = :ADJRNL-DOC-DTE              57520000
575300     END-EXEC.                                                    57530000
575400                                                                  57540000
575500     EVALUATE TRUE                                                57550000
575600         WHEN SQLCODE = +0                                        57560000
575700         WHEN SQLCODE = -811                                      57570000
575800             SET ASC-OFFSET-ADJ-FOUND TO TRUE                     57580000
575900             MOVE PV-OFFSET-DOC-NUMBER TO ASC-OFFSET-DOC-NUMBER   57590000
576000             IF PV-OFFSET-DOC-EXTR-IND = 'Y'                      57600000
576100                SET ASC-OFFSET-EXTRACTED TO TRUE                  57610000
576200             ELSE                                                 57620000
576300                SET ASC-OFFSET-NOT-EXTRACTED TO TRUE              57630000
576400             END-IF                                               57640000
576500                                                                  57650000
576600         WHEN SQLCODE = +100                                      57660000
576700         WHEN SQLWARN0 NOT = SPACES                               57670000
576800             SET ASC-OFFSET-ADJ-NOT-FOUND TO TRUE                 57680000
576900                                                                  57690000
577000         WHEN SQLCODE = -904                                      57700000
577100         WHEN SQLCODE = -913                                      57710000
577200         WHEN SQLWARN0 NOT = SPACES                               57720000
577300         WHEN SQLCODE < ZERO                                      57730000
577400         WHEN SQLCODE > ZERO                                      57740000
577500             MOVE '4012B-CHECK-FOR-OFFSET-ADJ'                    57750000
577600                               TO DP013-PARAGRAPH                 57760000
577700             MOVE 'SELECT ON TADJRNL        '                     57770000
577800                               TO DP013-MESSAGE-TEXT (1)          57780000
577900             MOVE SQLCA   TO DP013-SQLCA                          57790000
578000             MOVE 'TADJRNL' TO DP013-DB2-TABLE-NAME (1)           57800000
578100             SET DP013-DB2-ABEND                                  57810000
578200                 DP013-XCTL-DISPLAY-RESTART                       57820000
578300                               TO TRUE                            57830000
578400             PERFORM DP013-0000-PROCESS-ABEND                     57840000
578500     END-EVALUATE.                                                57850000
578600                                                                  57860000
578700******************************************************************57870000
578800* THIS PARAGRAPH WILL CHECK IF THE DOC_NBR HAS 'OFF' APENDED ON  *57880000
578900* END OF IT.  IF IT DOES, THEN IT WILL GO ON TO CHECK IF AN      *57890000
579000* ORIGINATING ADJUSTMENT EXISTS FOR IT.                          *57900000
579100******************************************************************57910000
579200 4013-CHECK-DOC-NBR-FOR-OFF.                                      57920000
579300                                                                  57930000
579400     INITIALIZE                  PV-STRING                        57940000
579500                                 PV-START                         57950000
579600                                 PV-END                           57960000
579700                                 PV-LENGTH.                       57970000
579800     MOVE ADJRNL-DOC-NBR      TO PV-STRING.                       57980000
579900     MOVE LENGTH OF PV-STRING TO PV-START.                        57990000
580000                                                                  58000000
580100     PERFORM                                                      58010000
580200       UNTIL PV-STRING(PV-START:1) = 'F'                          58020000
580300          OR PV-START = +0                                        58030000
580400         COMPUTE PV-START = PV-START - 1                          58040000
580500     END-PERFORM.                                                 58050000
580600                                                                  58060000
580700     IF PV-START > 3                                              58070000
580800        IF (PV-STRING(PV-START:1)     = 'F') AND                  58080000
580900           (PV-STRING(PV-START - 1:1) = 'F') AND                  58090000
581000           (PV-STRING(PV-START - 2:1) = 'O')                      58100000
581100           PERFORM 4014-CHECK-FOR-ORIGIN-ADJ                      58110000
581200        ELSE                                                      58120000
581300           SET ASC-NOT-OFFSET-ADJUSTMENT TO TRUE                  58130000
581400        END-IF                                                    58140000
581500     ELSE                                                         58150000
581600        SET ASC-NOT-OFFSET-ADJUSTMENT TO TRUE                     58160000
581700     END-IF.                                                      58170000
581800                                                                  58180000
581900******************************************************************58190000
582000* THIS WILL CHECK IF AN ORIGINATING ADJUSTMENT EXISTS FOR THE    *58200000
582100* ADJUSTMENT BEING PROCESSED.  IF ONE DOES EXIST THEN ADJUSTMENT *58210000
582200* BEING PROCESSED IS AN OFFSET ADJUSTMENT THAT WAS CREATED       *58220000
582300* AUTOMATICALLY.  THIS OFFSET ADJUSTMENT WILL THEN BE BLOCKED    *58230000
582400* FROM BEING UPDATED OR DELETED DIRECTLY.  THESE FUNCTIONS CAN   *58240000
582500* ONLY BE DONE FROM THE ORIGINATING ADJUSTMENT.                  *58250000
582600*                                                                *58260000
582700* THE AP_TRN_CDE CRITERIA WAS REMOVED FROM THE WHERE CONDITION   *58270000
582800* BELOW BECAUSE 4011- NOW ALLOWS A -811 SQLCODE, SO IT IS NOT    *58280000
582900* A GUARANTEE THAT THE TRANCODE ON THE ORIGINAL WILL MATCH THE   *58290000
583000* VALUE IN THE HOST-VARIABLE.                                    *58300000
583100******************************************************************58310000
583200 4014-CHECK-FOR-ORIGIN-ADJ.                                       58320000
583300                                                                  58330000
583400     MOVE PV-START TO PV-END.                                     58340000
583500     IF PV-START < 16                                             58350000
583600        MOVE +1 TO PV-START                                       58360000
583700     ELSE                                                         58370000
583800        SUBTRACT +15 FROM PV-START                                58380000
583900     END-IF.                                                      58390000
584000     COMPUTE PV-LENGTH = PV-END - PV-START - 2.                   58400000
584100     MOVE PV-STRING(PV-START:PV-LENGTH)                           58410000
584200                TO PV-ORIGIN-DOC-NUMBER.                          58420000
584300                                                                  58430000
584400     EXEC SQL                                                     58440000
584500           SELECT DOC_EXTR_IND                                    58450000
584600            INTO :PV-ORIGIN-DOC-EXTR-IND                          58460000
584700             FROM TADJRNL                                         58470000
584800            WHERE DOC_NBR          = :PV-ORIGIN-DOC-NUMBER        58480000
584900*             AND AP_TRN_CDE       = :PV-ORIGIN-AP-TRN-CDE        58490000
585000              AND VND_NBR          = :ADJRNL-VND-NBR              58500000
585100              AND DOC_DTE          = :ADJRNL-DOC-DTE              58510000
585200     END-EXEC.                                                    58520000
585300                                                                  58530000
585400     EVALUATE TRUE                                                58540000
585500         WHEN SQLCODE = +0                                        58550000
585600         WHEN SQLCODE = -811                                      58560000
585700             SET ASC-OFFSET-ADJUSTMENT TO TRUE                    58570000
585800                                                                  58580000
585900         WHEN SQLCODE = +100                                      58590000
586000         WHEN SQLWARN0 NOT = SPACES                               58600000
586100             SET ASC-NOT-OFFSET-ADJUSTMENT TO TRUE                58610000
586200                                                                  58620000
586300         WHEN SQLCODE = -904                                      58630000
586400         WHEN SQLCODE = -913                                      58640000
586500         WHEN SQLWARN0 NOT = SPACES                               58650000
586600         WHEN SQLCODE < ZERO                                      58660000
586700         WHEN SQLCODE > ZERO                                      58670000
586800             MOVE '4014-CHECK-FOR-ORIGIN-ADJ'                     58680000
586900                               TO DP013-PARAGRAPH                 58690000
587000             MOVE 'SELECT ON TADJRNL        '                     58700000
587100                               TO DP013-MESSAGE-TEXT (1)          58710000
587200             MOVE SQLCA   TO DP013-SQLCA                          58720000
587300             MOVE 'TADJRNL' TO DP013-DB2-TABLE-NAME (1)           58730000
587400             SET DP013-DB2-ABEND                                  58740000
587500                 DP013-XCTL-DISPLAY-RESTART                       58750000
587600                               TO TRUE                            58760000
587700             PERFORM DP013-0000-PROCESS-ABEND                     58770000
587800     END-EVALUATE.                                                58780000
587900                                                                  58790000
588000******************************************************************58800000
588100* THIS PARAGRAPH WILL RETRIEVE THE ADJUSTMENT PEOPLE INTERFACE   *58810000
588200* DATA FROM THE DB2 TABLE AJPSINT.                               *58820000
588300******************************************************************58830000
588400 4015-SELECT-AJPSINT.                                             58840000
588500                                                                  58850000
588600     EXEC SQL                                                     58860000
588700        SELECT  VND_NBR                                           58870000
588800               ,DOC_NBR                                           58880000
588900               ,DOC_DTE                                           58890000
589000               ,AP_TRN_CDE                                        58900000
589100               ,DUE_DTE                                           58910000
589200               ,DOC_HLD_CDE                                       58920000
589300               ,RSN_1ST_LNE_TXT                                   58930000
589400               ,RSN_2ND_LNE_TXT                                   58940000
589500               ,AUTH_NBR                                          58950000
589600         INTO  :AJPSINT-VND-NBR                                   58960000
589700              ,:AJPSINT-DOC-NBR                                   58970000
589800              ,:AJPSINT-DOC-DTE                                   58980000
589900              ,:AJPSINT-AP-TRN-CDE                                58990000
590000              ,:AJPSINT-DUE-DTE                                   59000000
590100              ,:AJPSINT-DOC-HLD-CDE                               59010000
590200              ,:AJPSINT-RSN-1ST-LNE-TXT                           59020000
590300              ,:AJPSINT-RSN-2ND-LNE-TXT                           59030000
590400              ,:AJPSINT-AUTH-NBR                                  59040000
590500         FROM TAJPSINT                                            59050000
590600         WHERE DOC_NBR    =   :ADJRNL-DOC-NBR                     59060000
590700         AND   VND_NBR    =   :ADJRNL-VND-NBR                     59070000
590800         AND   DOC_DTE    =   :ADJRNL-DOC-DTE                     59080000
590900         AND   AP_TRN_CDE =   :ADJRNL-AP-TRN-CDE                  59090000
591000     END-EXEC.                                                    59100000
591100                                                                  59110000
591200     EVALUATE TRUE                                                59120000
591300         WHEN SQLCODE = +0                                        59130000
591400         WHEN SQLCODE = -904                                      59140000
591500         WHEN SQLCODE = -913                                      59150000
591600             CONTINUE                                             59160000
591700         WHEN SQLCODE = -811                                      59170000
591800                                                                  59180000
591900             CONTINUE                                             59190000
592000                                                                  59200000
592100         WHEN SQLCODE = +100                                      59210000
592200                                                                  59220000
592300             INITIALIZE AJPSINT-VND-NBR     AJPSINT-DOC-NBR       59230000
592400                        AJPSINT-DOC-DTE     AJPSINT-AP-TRN-CDE    59240000
592500                        AJPSINT-DUE-DTE     AJPSINT-DOC-HLD-CDE   59250000
592600                        AJPSINT-RSN-1ST-LNE-TXT                   59260000
592700                        AJPSINT-RSN-2ND-LNE-TXT                   59270000
592800                        AJPSINT-AUTH-NBR                          59280000
592900                                                                  59290000
593000         WHEN SQLWARN0 NOT = SPACES                               59300000
593100         WHEN SQLCODE < ZERO                                      59310000
593200         WHEN SQLCODE > ZERO                                      59320000
593300             MOVE '4015-SELECT-AJPSINT'                           59330000
593400                               TO DP013-PARAGRAPH                 59340000
593500             MOVE 'SELECT ON TAJPSINT       '                     59350000
593600                               TO DP013-MESSAGE-TEXT (1)          59360000
593700             MOVE SQLCA   TO DP013-SQLCA                          59370000
593800             MOVE 'AJPSINT' TO DP013-DB2-TABLE-NAME (1)           59380000
593900             SET DP013-DB2-ABEND                                  59390000
594000                 DP013-XCTL-DISPLAY-RESTART                       59400000
594100                               TO TRUE                            59410000
594200             PERFORM DP013-0000-PROCESS-ABEND                     59420000
594300     END-EVALUATE.                                                59430000
594400                                                                  59440000
594500******************************************************************59450000
594600* THIS PARAGRAPH WILL CONTROL PROCESSING OF THE CURSOR TO GATHER *59460000
594700* THE FIRST ROW OF ADJUSTMENT DETAIL.                            *59470000
594800******************************************************************59480000
594900 4016-GET-FIRST-ADJDIS.                                           59490000
595000                                                                  59500000
595100     PERFORM 4017-OPEN-DET-CSR.                                   59510000
595200                                                                  59520000
595300     SET ASC-MULT-DIST TO TRUE.                                   59530000
595400                                                                  59540000
595500     PERFORM 4018-FETCH-DET-CSR.                                  59550000
595600                                                                  59560000
595700******************************************************************59570000
595800* THIS PARAGRAPH WILL OPEN THE DETAIL CURSOR FOR THE FIRST ROW   *59580000
595900* OF ADJUSTMENT DISTRIBUTION.                                    *59590000
596000******************************************************************59600000
596100 4017-OPEN-DET-CSR.                                               59610000
596200                                                                  59620000
596300     EXEC SQL                                                     59630000
596400         OPEN DET-CSR                                             59640000
596500     END-EXEC.                                                    59650000
596600                                                                  59660000
596700     EVALUATE TRUE                                                59670000
596800         WHEN SQLCODE = +0                                        59680000
596900             CONTINUE                                             59690000
597000         WHEN OTHER                                               59700000
597100              MOVE '4017-OPEN-DET-CS'                             59710000
597200                               TO DP013-PARAGRAPH                 59720000
597300              MOVE 'OPEN DET-CSR         '                        59730000
597400                               TO DP013-MESSAGE-TEXT (1)          59740000
597500              MOVE SQLCA           TO DP013-SQLCA                 59750000
597600              SET DP013-DB2-ABEND                                 59760000
597700                               TO TRUE                            59770000
597800              PERFORM DP013-0000-PROCESS-ABEND                    59780000
597900     END-EVALUATE.                                                59790000
598000                                                                  59800000
598100 EJECT                                                            59810000
598200******************************************************************59820000
598300* THIS PARAGRAPH WILL FETCH THE FIRST ROW OF ADJUSTMENT DETAIL.  *59830000
598400******************************************************************59840000
598500 4018-FETCH-DET-CSR.                                              59850000
598600                                                                  59860000
598700     EXEC SQL                                                     59870000
598800          FETCH DET-CSR                                           59880000
598900          INTO  :ADJDIS-VND-NBR                                   59890000
599000               ,:ADJDIS-DOC-NBR                                   59900000
599100               ,:ADJDIS-DOC-DTE                                   59910000
599200               ,:ADJDIS-AP-TRN-CDE                                59920000
599300               ,:ADJDIS-DISTRB-SEQ-NBR                            59930000
599400               ,:ADJDIS-STR-NBR                                   59940000
599500               ,:ADJDIS-DEPT-NBR                                  59950000
599600               ,:ADJDIS-CL-NBR                                    59960000
599700               ,:ADJDIS-SKU-NBR                                   59970000
599800               ,:ADJDIS-GRO-COST-AMT                              59980000
599900               ,:ADJDIS-RTL-AMT                                   59990000
600000               ,:ADJDIS-FRGT-AMT                                  60000000
600100               ,:ADJDIS-MISC-CHRG-AMT                             60010000
600200               ,:ADJDIS-DISC-AMT                                  60020000
600300               ,:ADJDIS-NET-COST-AMT                              60030000
600400     END-EXEC.                                                    60040000
600500                                                                  60050000
600600     EVALUATE TRUE                                                60060000
600700         WHEN SQLCODE = ZERO                                      60070000
600800         WHEN SQLCODE = +100                                      60080000
600900              CONTINUE                                            60090000
601000         WHEN SQLWARN0 NOT = SPACE                                60100000
601100         WHEN SQLCODE NOT = ZERO                                  60110000
601200              MOVE '4018-FETCH-DET-CS'                            60120000
601300                               TO DP013-PARAGRAPH                 60130000
601400              MOVE 'FETCH DETAIL CURSOR    '                      60140000
601500                               TO DP013-MESSAGE-TEXT (1)          60150000
601600              MOVE SQLCA       TO DP013-SQLCA                     60160000
601700              SET DP013-DB2-ABEND                                 60170000
601800                               TO TRUE                            60180000
601900              PERFORM DP013-0000-PROCESS-ABEND                    60190000
602000     END-EVALUATE.                                                60200000
602100                                                                  60210000
602200     IF SQLCODE EQUAL +100                                        60220000
602300        SET ASC-SINGLE-DIST TO TRUE                               60230000
602400     END-IF.                                                      60240000
602500                                                                  60250000
602600******************************************************************60260000
602700* THIS PARAGRAPH WILL CLOSE THE DETAIL CURSOR AFTER THE FIRST    *60270000
602800* ADJUSTMENT DISTRIBUTION ROW IS RETRIEVED.                      *60280000
602900******************************************************************60290000
603000 4019-CLOSE-DET-CSR.                                              60300000
603100                                                                  60310000
603200     EXEC SQL                                                     60320000
603300         CLOSE DET-CSR                                            60330000
603400     END-EXEC.                                                    60340000
603500                                                                  60350000
603600     EVALUATE TRUE                                                60360000
603700         WHEN SQLCODE = ZERO                                      60370000
603800             CONTINUE                                             60380000
603900         WHEN SQLWARN0 NOT = SPACES                               60390000
604000         WHEN SQLCODE < ZERO                                      60400000
604100         WHEN SQLCODE > ZERO                                      60410000
604200             MOVE '4019-CLOSE-DET-CS'                             60420000
604300                               TO DP013-PARAGRAPH                 60430000
604400             MOVE 'CLOSE DETAIL CURSOR     '                      60440000
604500                               TO DP013-MESSAGE-TEXT (1)          60450000
604600             MOVE SQLCA        TO DP013-SQLCA                     60460000
604700             MOVE 'TADJDIS '   TO DP013-DB2-TABLE-NAME (1)        60470000
604800             SET DP013-DB2-ABEND                                  60480000
604900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               60490000
605000             PERFORM DP013-0000-PROCESS-ABEND                     60500000
605100     END-EVALUATE.                                                60510000
605200                                                                  60520000
605300 EJECT                                                            60530000
605400******************************************************************60540000
605500* THIS PARAGRAPH WILL CONTROL KEY VALIDATION ON THE VENDOR       *60550000
605600* NUMBER AND MOVING DATA TO THE SCREEN.                          *60560000
605700******************************************************************60570000
605800 4020-GET-REST-OF-DATA.                                           60580000
605900                                                                  60590000
606000     IF PS-NO-ERROR                                               60600000
606100        MOVE ADJRNL-VND-NBR TO EXTENT-DUN-NBR                     60610000
606200        PERFORM 4800-VALIDATE-VENDOR                              60620000
606300        PERFORM 4850-GET-OFFSET-TRANCD                            60630000
606400        IF ASC-OFFSET-TC-FOUND                                    60640000
606500           PERFORM 4860-GET-OFFSET-ACCTNO                         60650000
606600        END-IF                                                    60660000
606700        PERFORM 4200-MOVE-DATABASE-TO-COMMAREA                    60670000
606800        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                      60680000
606900     END-IF.                                                      60690000
607000                                                                  60700000
607100******************************************************************60710000
607200* THIS PARAGRAPH WILL MOVE THE DISPLAYED FIELDS FROM THE         *60720000
607300* COMMAREA TO THE SCREEN.                                        *60730000
607400******************************************************************60740000
607500 4200-MOVE-DATABASE-TO-COMMAREA.                                  60750000
607600                                                                  60760000
607700     INITIALIZE PV-ENTRY-ID.                                      60770000
607800                                                                  60780000
607900     MOVE ADJRNL-VND-NBR             TO ASC-VENDOR-NUMBER         60790000
608000                                        ASC-KEY-VEND-NUMBER       60800000
608100                                        AP363-VND-NBR.            60810000
608200     MOVE ENTNME-ENT-NAME-DESC       TO ASC-VENDOR-NAME.          60820000
608300     MOVE ADJRNL-DOC-NBR             TO ASC-DOC-NUMBER            60830000
608400                                        ASC-KEY-DOC-NUMBER        60840000
608500                                        AP363-DOC-NBR.            60850000
608600     MOVE ADJRNL-DOC-DTE             TO ASC-DOC-DATE              60860000
608700                                        ASC-KEY-DOC-DATE          60870000
608800                                        AP363-DOC-DTE.            60880000
608900     MOVE ADJRNL-AP-TRN-CDE          TO ASC-TRAN-CD               60890000
609000                                        ASC-KEY-TRAN-CODE         60900000
609100                                        AP363-AP-TRN-CDE.         60910000
609200     MOVE TRNCDE-AUTO-OFFST-TRN-CDE  TO ASC-OFFSET-TRAN-CD.       60920000
609300     MOVE PV-OFFSET-GL-ACCT-NBR      TO ASC-OFFSET-ACCT-NO.       60930000
609400     MOVE PC-OFFSET-BYPASS-IND-DFT   TO ASC-OFFSET-BYPASS-IND.    60940000
609500     MOVE ADJRNL-PO-NBR              TO ASC-PO-NUMBER             60950000
609600                                        ASC-ALP-PO-NBR-9.         60960000
609700     MOVE ADJRNL-DEPT-NBR            TO ASC-DEPARTMENT.           60970000
609800     MOVE ADJRNL-GL-ACCT-NBR         TO ASC-ACCT-NO.              60980000
609900     MOVE ADJRNL-STR-NBR             TO ASC-ALP-STORE-NBR         60990000
610000                                        ASC-STORE.                61000000
610100     MOVE ADJRNL-ENTR-ID             TO PV-ENTRY-ID.              61010000
610200     MOVE ADJRNL-GRO-COST-AMT        TO ASC-GROSS-COST            61020000
610300                                        ASC-ALP-GRO-COST-9.       61030000
610400     MOVE ADJRNL-RTL-AMT             TO ASC-RETAIL-AMT            61040000
610500                                        ASC-ALP-RET-COST-9.       61050000
610600     MOVE ADJRNL-FRGT-AMT            TO ASC-FREIGHT-AMT           61060000
610700                                        ASC-ALP-FRT-COST-9.       61070000
610800     MOVE ADJRNL-MISC-CHRG-AMT       TO ASC-MISC-CHG              61080000
610900                                        ASC-ALP-MISC-CHG-9.       61090000
611000                                                                  61100000
611100     COMPUTE ASC-DISC-PCT =                                       61110000
611200             ADJRNL-TERM-DISC-PCT * 100.                          61120000
611300     MOVE ASC-DISC-PCT               TO ASC-ALP-DISC-PCT-9.       61130000
611400     MOVE ADJRNL-TERM-DISC-AMT       TO ASC-DISC-AMT.             61140000
611500                                                                  61150000
611600     COMPUTE ASC-MOS-PCT =                                        61160000
611700             ADJRNL-MOS-DISC-PCT * 100.                           61170000
611800     MOVE ASC-MOS-PCT                TO ASC-ALP-MOS-PCT-9.        61180000
611900     MOVE ADJRNL-MOS-DISC-AMT        TO ASC-MOS-AMT.              61190000
612000                                                                  61200000
612100     COMPUTE ASC-NEW-STR-PCT =                                    61210000
612200             ADJRNL-NW-STR-DISC-PCT * 100.                        61220000
612300     MOVE ASC-NEW-STR-PCT            TO ASC-ALP-NEW-STR-PCT-9.    61230000
612400     MOVE ADJRNL-NW-STR-DISC-AMT     TO ASC-NEW-STR-AMT.          61240000
612500                                                                  61250000
612600     COMPUTE ASC-TRADE-PCT =                                      61260000
612700             ADJRNL-TRD-DISC-PCT * 100.                           61270000
612800     MOVE ASC-TRADE-PCT              TO ASC-ALP-TRADE-PCT-9.      61280000
612900     MOVE ADJRNL-TRD-DISC-AMT        TO ASC-TRADE-AMT.            61290000
613000                                                                  61300000
613100     MOVE ADJRNL-NET-COST-AMT        TO ASC-NET-COST.             61310000
613200     MOVE ADJRNL-INV-CTOFF-DTE       TO ASC-CUTOFF-DATE.          61320000
613300     MOVE ADJRNL-BRCDE-NBR           TO ASC-BARCODE.              61330000
613400                                                                  61340000
613500     IF ADJRNL-GRO-COST-AMT EQUAL ZERO                            61350000
613600        IF ADJRNL-FRGT-AMT NOT EQUAL ZERO                         61360000
613700           SET ASC-FREIGHT-COST-ALLOCATION TO TRUE                61370000
613800        ELSE                                                      61380000
613900           IF ADJRNL-NW-STR-DISC-AMT NOT EQUAL ZERO               61390000
614000              SET ASC-NEW-STR-COST-ALLOCATION TO TRUE             61400000
614100           END-IF                                                 61410000
614200        END-IF                                                    61420000
614300     END-IF.                                                      61430000
614400                                                                  61440000
614500     MOVE ADJRNL-ENT-ID              TO ASC-ENT-ID.               61450000
614600                                                                  61460000
614700* 12-07 START                                                     61470000
614800     IF ADJRNL-PSTG-FYR-NBR = ASC-CURR-PSTG-FYR-NBR AND           61480000
614900        ADJRNL-PSTG-FMN-NBR = ASC-CURR-PSTG-FMN-NBR AND           61490000
615000        ADJRNL-PSTG-FWK-NBR = ASC-CURR-PSTG-FWK-NBR               61500000
615100        MOVE 'C' TO ASC-APPL-MTH                                  61510000
615200     ELSE                                                         61520000
615300        IF ADJRNL-PSTG-FYR-NBR = ASC-PREV-PSTG-FYR-NBR AND        61530000
615400           ADJRNL-PSTG-FMN-NBR = ASC-PREV-PSTG-FMN-NBR AND        61540000
615500           ADJRNL-PSTG-FWK-NBR = ASC-PREV-PSTG-FWK-NBR            61550000
615600           MOVE 'P' TO ASC-APPL-MTH                               61560000
615700        END-IF                                                    61570000
615800     END-IF.                                                      61580000
615900* 12-07 END                                                       61590000
616000                                                                  61600000
616100     MOVE ADJRNL-PS-BTCH-NBR         TO ASC-PS-BATCH-NBR.         61610000
616200     MOVE ADJRNL-PS-PSTG-IND         TO ASC-PS-POSTING-IND.       61620000
616300     MOVE ADJRNL-DOC-EXTR-IND        TO ASC-DOC-EXTRACT-IND.      61630000
616400     MOVE ADJRNL-DOC-EXTR-DTE        TO ASC-DOC-EXTRACT-DTE.      61640000
616500     MOVE ADJRNL-ORGN-CDE            TO ASC-ORIGIN-CDE.           61650000
616600     MOVE AJPSINT-DUE-DTE            TO ASC-DUE-DATE.             61660000
616700     MOVE AJPSINT-DOC-HLD-CDE        TO ASC-HOLD-STATUS.          61670000
616800     MOVE AJPSINT-RSN-1ST-LNE-TXT    TO ASC-REASON-CODE1.         61680000
616900     MOVE AJPSINT-RSN-2ND-LNE-TXT    TO ASC-REASON-CODE2.         61690000
617000     MOVE AJPSINT-AUTH-NBR           TO ASC-VENDOR-AUTH.          61700000
617100     MOVE ADJDIS-STR-NBR             TO ASC-DET-STORE             61710000
617200                                        ASC-ALP-DET-STORE.        61720000
617300     MOVE ADJDIS-CL-NBR              TO ASC-DET-CLASS.            61730000
617400     MOVE ADJDIS-SKU-NBR             TO ASC-DET-SKU               61740000
617500                                        ASC-ALP-DET-SKU-9.        61750000
617600                                                                  61760000
617700     IF ASC-FREIGHT-COST-ALLOCATION                               61770000
617800        MOVE ADJDIS-FRGT-AMT         TO ASC-DET-COST              61780000
617900                                        ASC-ALP-DET-COST-9        61790000
618000     ELSE                                                         61800000
618100        IF ASC-NEW-STR-COST-ALLOCATION                            61810000
618200           MOVE ADJDIS-DISC-AMT      TO ASC-DET-COST              61820000
618300                                        ASC-ALP-DET-COST-9        61830000
618400        ELSE                                                      61840000
618500           MOVE ADJDIS-GRO-COST-AMT  TO ASC-DET-COST              61850000
618600                                        ASC-ALP-DET-COST-9        61860000
618700     END-IF.                                                      61870000
618800                                                                  61880000
618900     MOVE ADJDIS-RTL-AMT             TO ASC-DET-RETAIL            61890000
619000                                        ASC-ALP-DET-RETL-9.       61900000
619100     MOVE ADJDIS-NET-COST-AMT        TO ASC-DET-NET.              61910000
619200     MOVE ADJDIS-DISTRB-SEQ-NBR      TO ASC-DET-DISTRB-SEQ.       61920000
619300                                                                  61930000
619400******************************************************************61940000
619500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *61950000
619600******************************************************************61960000
619700 4400-MOVE-COMMAREA-TO-SCREEN.                                    61970000
619800                                                                  61980000
619900     MOVE ASC-TRAN-CD              TO ATRANCDO.                   61990000
620000     MOVE ASC-DOC-NUMBER           TO ADOCNUMO.                   62000000
620100     MOVE ASC-VENDOR-NUMBER        TO AVENDNOO.                   62010000
620200                                                                  62020000
620300     IF ASC-ALP-PO-NBR NUMERIC                                    62030000
620400        IF ASC-PO-NUMBER = +0                                     62040000
620500           MOVE SPACES             TO APONUMO                     62050000
620600                                      ASC-ALP-PO-NBR              62060000
620700        ELSE                                                      62070000
620800           MOVE ASC-PO-NUMBER      TO PV-NUM9                     62080000
620900           MOVE PV-NUM9-X          TO APONUMO                     62090000
621000                                      ASC-ALP-PO-NBR              62100000
621100        END-IF                                                    62110000
621200     ELSE                                                         62120000
621300        MOVE ASC-ALP-PO-NBR        TO APONUMO                     62130000
621400     END-IF.                                                      62140000
621500                                                                  62150000
621600     MOVE ASC-VENDOR-NAME          TO AVENDNMO.                   62160000
621700     MOVE ASC-BARCODE              TO ABARCDO.                    62170000
621800                                                                  62180000
621900     IF ASC-ALP-STORE-NBR NUMERIC                                 62190000
622000        MOVE ASC-STORE             TO PV-NUM4                     62200000
622100        MOVE PV-NUM4-X             TO ASTRNMO                     62210000
622200     ELSE                                                         62220000
622300        MOVE ASC-ALP-STORE-NBR     TO ASTRNMO                     62230000
622400     END-IF.                                                      62240000
622500                                                                  62250000
622600     MOVE ASC-OFFSET-TRAN-CD       TO AOFFTRNO.                   62260000
622700     MOVE ASC-OFFSET-ACCT-NO       TO AOFFACTO.                   62270000
622800     MOVE ASC-OFFSET-BYPASS-IND    TO AOFFBYPO.                   62280000
622900     MOVE ASC-DOC-DATE-MM          TO ADOCMMO.                    62290000
623000     MOVE ASC-DOC-DATE-DD          TO ADOCDDO.                    62300000
623100     MOVE ASC-DOC-DATE-YY          TO ADOCYYO.                    62310000
623200     MOVE ASC-DEPARTMENT           TO ADEPTO.                     62320000
623300     MOVE ASC-ACCT-NO              TO AACCNOO.                    62330000
623400     MOVE ASC-VENDOR-AUTH          TO AVENDAO.                    62340000
623500                                                                  62350000
623600     IF ASC-ALP-GROSS-COST(2:12) NUMERIC                          62360000
623700        IF ASC-GROSS-COST = +0                                    62370000
623800           MOVE SPACES             TO AGRCSTO                     62380000
623900                                      ASC-ALP-GROSS-COST          62390000
624000        ELSE                                                      62400000
624100           MOVE ASC-GROSS-COST     TO PV-10V99                    62410000
624200           MOVE PV-10V99           TO AGRCSTO                     62420000
624300                                      ASC-ALP-GROSS-COST          62430000
624400         END-IF                                                   62440000
624500     ELSE                                                         62450000
624600         MOVE ASC-ALP-GROSS-COST   TO AGRCSTO                     62460000
624700     END-IF.                                                      62470000
624800                                                                  62480000
624900     IF ASC-ALP-RET-COST(2:12) NUMERIC                            62490000
625000        IF ASC-RETAIL-AMT = +0                                    62500000
625100           MOVE SPACES             TO ARETCSTO                    62510000
625200                                      ASC-ALP-RET-COST            62520000
625300        ELSE                                                      62530000
625400           MOVE ASC-RETAIL-AMT     TO PV-10V99                    62540000
625500           MOVE PV-10V99           TO ARETCSTO                    62550000
625600                                      ASC-ALP-RET-COST            62560000
625700         END-IF                                                   62570000
625800     ELSE                                                         62580000
625900         MOVE ASC-ALP-RET-COST     TO ARETCSTO                    62590000
626000     END-IF.                                                      62600000
626100                                                                  62610000
626200     IF ASC-ALP-FREIGHT-COST(2:12) NUMERIC                        62620000
626300        IF ASC-FREIGHT-AMT = +0                                   62630000
626400           MOVE SPACES             TO AFRAMTO                     62640000
626500                                      ASC-ALP-FREIGHT-COST        62650000
626600        ELSE                                                      62660000
626700           MOVE ASC-FREIGHT-AMT    TO PV-10V99                    62670000
626800           MOVE PV-10V99           TO AFRAMTO                     62680000
626900                                      ASC-ALP-FREIGHT-COST        62690000
627000         END-IF                                                   62700000
627100     ELSE                                                         62710000
627200         MOVE ASC-ALP-FREIGHT-COST TO AFRAMTO                     62720000
627300     END-IF.                                                      62730000
627400                                                                  62740000
627500     IF ASC-ALP-MISC-CHG(2:12) NUMERIC                            62750000
627600        IF ASC-MISC-CHG = +0                                      62760000
627700           MOVE SPACES             TO AMISCO                      62770000
627800                                      ASC-ALP-MISC-CHG            62780000
627900        ELSE                                                      62790000
628000           MOVE ASC-MISC-CHG       TO PV-10V99                    62800000
628100           MOVE PV-10V99           TO AMISCO                      62810000
628200                                      ASC-ALP-MISC-CHG            62820000
628300         END-IF                                                   62830000
628400     ELSE                                                         62840000
628500         MOVE ASC-ALP-MISC-CHG     TO AMISCO                      62850000
628600     END-IF.                                                      62860000
628700                                                                  62870000
628800     IF ASC-ALP-DISC-PCT NUMERIC                                  62880000
628900        IF ASC-DISC-PCT = +0                                      62890000
629000           MOVE SPACES             TO ADISCPCO                    62900000
629100                                      ASC-ALP-DISC-PCT            62910000
629200        ELSE                                                      62920000
629300           MOVE ASC-DISC-PCT       TO PV-3V99                     62930000
629400           MOVE PV-3V99            TO ADISCPCO                    62940000
629500                                      ASC-ALP-DISC-PCT            62950000
629600         END-IF                                                   62960000
629700     ELSE                                                         62970000
629800         MOVE ASC-ALP-DISC-PCT     TO ADISCPCO                    62980000
629900     END-IF.                                                      62990000
630000                                                                  63000000
630100     IF ASC-DISC-AMT NOT EQUAL 0                                  63010000
630200        MOVE ASC-DISC-AMT          TO PV-6V99                     63020000
630300        MOVE PV-6V99               TO ADISCAMO                    63030000
630400     ELSE                                                         63040000
630500        MOVE SPACES                TO ADISCAMO                    63050000
630600     END-IF.                                                      63060000
630700                                                                  63070000
630800     IF ASC-ALP-MOS-PCT NUMERIC                                   63080000
630900        IF ASC-MOS-PCT = +0                                       63090000
631000           MOVE SPACES             TO AMOSPCO                     63100000
631100                                      ASC-ALP-MOS-PCT             63110000
631200        ELSE                                                      63120000
631300           MOVE ASC-MOS-PCT       TO PV-3V99                      63130000
631400           MOVE PV-3V99            TO AMOSPCO                     63140000
631500                                      ASC-ALP-MOS-PCT             63150000
631600         END-IF                                                   63160000
631700     ELSE                                                         63170000
631800         MOVE ASC-ALP-MOS-PCT     TO AMOSPCO                      63180000
631900     END-IF.                                                      63190000
632000                                                                  63200000
632100     IF ASC-MOS-AMT NOT EQUAL 0                                   63210000
632200        MOVE ASC-MOS-AMT          TO PV-6V99                      63220000
632300        MOVE PV-6V99               TO AMOSAMO                     63230000
632400     ELSE                                                         63240000
632500        MOVE SPACES                TO AMOSAMO                     63250000
632600     END-IF.                                                      63260000
632700                                                                  63270000
632800     IF ASC-ALP-NEW-STR-PCT NUMERIC                               63280000
632900        IF ASC-NEW-STR-PCT = +0                                   63290000
633000           MOVE SPACES             TO ANSTRPCO                    63300000
633100                                      ASC-ALP-NEW-STR-PCT         63310000
633200        ELSE                                                      63320000
633300           MOVE ASC-NEW-STR-PCT    TO PV-3V99                     63330000
633400           MOVE PV-3V99            TO ANSTRPCO                    63340000
633500                                      ASC-ALP-NEW-STR-PCT         63350000
633600         END-IF                                                   63360000
633700     ELSE                                                         63370000
633800         MOVE ASC-ALP-NEW-STR-PCT  TO ANSTRPCO                    63380000
633900     END-IF.                                                      63390000
634000                                                                  63400000
634100     IF ASC-NEW-STR-AMT NOT EQUAL 0                               63410000
634200        MOVE ASC-NEW-STR-AMT       TO PV-6V99                     63420000
634300        MOVE PV-6V99               TO ANSTRAMO                    63430000
634400     ELSE                                                         63440000
634500        MOVE SPACES                TO ANSTRAMO                    63450000
634600     END-IF.                                                      63460000
634700                                                                  63470000
634800     MOVE ASC-HOLD-STATUS          TO AHOLDO.                     63480000
634900                                                                  63490000
635000     IF ASC-ALP-TRADE-PCT NUMERIC                                 63500000
635100        IF ASC-TRADE-PCT = +0                                     63510000
635200           MOVE SPACES             TO ATRADPCO                    63520000
635300                                      ASC-ALP-TRADE-PCT           63530000
635400        ELSE                                                      63540000
635500           MOVE ASC-TRADE-PCT      TO PV-3V99                     63550000
635600           MOVE PV-3V99            TO ATRADPCO                    63560000
635700                                      ASC-ALP-TRADE-PCT           63570000
635800         END-IF                                                   63580000
635900     ELSE                                                         63590000
636000         MOVE ASC-ALP-TRADE-PCT    TO ATRADPCO                    63600000
636100     END-IF.                                                      63610000
636200                                                                  63620000
636300     IF ASC-TRADE-AMT NOT EQUAL 0                                 63630000
636400        MOVE ASC-TRADE-AMT         TO PV-6V99                     63640000
636500        MOVE PV-6V99               TO ATRADAMO                    63650000
636600     ELSE                                                         63660000
636700        MOVE SPACES                TO ATRADAMO                    63670000
636800     END-IF.                                                      63680000
636900                                                                  63690000
637000     MOVE ASC-NET-COST             TO PV-10V99.                   63700000
637100     MOVE PV-10V99                 TO ANETCSTO.                   63710000
637200                                                                  63720000
637300     MOVE ASC-DUE-DATE-MM          TO ADUEMMO.                    63730000
637400     MOVE ASC-DUE-DATE-DD          TO ADUEDDO.                    63740000
637500     MOVE ASC-DUE-DATE-YY          TO ADUEYYO.                    63750000
637600                                                                  63760000
637700     MOVE ASC-APPL-MTH             TO AAPLMTHO.                   63770000
637800     MOVE ASC-REASON-CODE1         TO AREAS1O.                    63780000
637900     MOVE ASC-REASON-CODE2         TO AREAS2O.                    63790000
638000                                                                  63800000
638100     IF ASC-ALP-DET-STORE NUMERIC                                 63810000
638200        MOVE ASC-DET-STORE         TO PV-NUM4                     63820000
638300        MOVE PV-NUM4-X             TO ASTR01O                     63830000
638400     ELSE                                                         63840000
638500        MOVE ASC-ALP-DET-STORE     TO ASTR01O                     63850000
638600     END-IF.                                                      63860000
638700                                                                  63870000
638800     MOVE ASC-DET-CLASS            TO ACLS01O.                    63880000
638900                                                                  63890000
639000     IF ASC-ALP-DET-SKU NUMERIC                                   63900000
639100        IF ASC-DET-SKU = +0                                       63910000
639200           MOVE SPACES             TO ASKU01O                     63920000
639300                                      ASC-ALP-DET-SKU             63930000
639400        ELSE                                                      63940000
639500           MOVE ASC-DET-SKU        TO PV-NUM8                     63950000
639600           MOVE PV-NUM8-X          TO ASKU01O                     63960000
639700                                      ASC-ALP-DET-SKU             63970000
639800        END-IF                                                    63980000
639900     ELSE                                                         63990000
640000        MOVE ASC-ALP-DET-SKU       TO ASKU01O                     64000000
640100     END-IF.                                                      64010000
640200                                                                  64020000
640300     IF ASC-ALP-DET-COST(2:12) NUMERIC                            64030000
640400        IF ASC-DET-COST = +0                                      64040000
640500           MOVE SPACES             TO ACST01O                     64050000
640600                                      ASC-ALP-DET-COST            64060000
640700        ELSE                                                      64070000
640800           MOVE ASC-DET-COST       TO PV-10V99                    64080000
640900           MOVE PV-10V99           TO ACST01O                     64090000
641000                                      ASC-ALP-DET-COST            64100000
641100         END-IF                                                   64110000
641200     ELSE                                                         64120000
641300         MOVE ASC-ALP-DET-COST     TO ACST01O                     64130000
641400     END-IF.                                                      64140000
641500                                                                  64150000
641600     IF ASC-ALP-DET-RETL(2:12) NUMERIC                            64160000
641700        IF ASC-DET-RETAIL = +0                                    64170000
641800           MOVE SPACES             TO ARET01O                     64180000
641900                                      ASC-ALP-DET-RETL            64190000
642000        ELSE                                                      64200000
642100           MOVE ASC-DET-RETAIL     TO PV-10V99                    64210000
642200           MOVE PV-10V99           TO ARET01O                     64220000
642300                                      ASC-ALP-DET-RETL            64230000
642400         END-IF                                                   64240000
642500     ELSE                                                         64250000
642600         MOVE ASC-ALP-DET-RETL     TO ARET01O                     64260000
642700     END-IF.                                                      64270000
642800                                                                  64280000
642900     IF ASC-DET-NET = +0                                          64290000
643000        MOVE SPACES             TO ANET01O                        64300000
643100     ELSE                                                         64310000
643200        MOVE ASC-DET-NET        TO PV-10V99                       64320000
643300        MOVE PV-10V99           TO ANET01O                        64330000
643400     END-IF.                                                      64340000
643500                                                                  64350000
643600******************************************************************64360000
643700* THIS PARAGRAPH WILL CALL A MODULE TO ARRIVE AT THE NEXT        *64370000
643800* AVAILABLE DOCUMENT NUMBER.                                     *64380000
643900******************************************************************64390000
644000 4500-GET-NEXT-DOC-NO.                                            64400000
644100                                                                  64410000
644200     CALL PC-APKUP151-PGM    USING DFHEIBLK                       64420000
644300                                   WS364-COMMAREA                 64430000
644400                                   WS364-DOC-NBR-PARAMETERS.      64440000
644500                                                                  64450000
644600     IF WS364-ERRORS-FOUND                                        64460000
644700          MOVE '4500-GET-NEXT-DOC-NO   '                          64470000
644800                                TO DP013-PARAGRAPH                64480000
644900          MOVE WS364-ERROR-MESSAGE                                64490000
645000                                TO DP013-MESSAGE-TEXT (1)         64500000
645100          MOVE SQLCODE          TO DP013-SQLCA                    64510000
645200          SET DP013-DB2-ABEND                                     64520000
645300              DP013-XCTL-DISPLAY-RESTART TO TRUE                  64530000
645400          PERFORM DP013-0000-PROCESS-ABEND                        64540000
645500     END-IF.                                                      64550000
645600                                                                  64560000
645700******************************************************************64570000
645800* THIS PARAGRAPH WILL VALIDATE THAT AN ENTERED DOCUMENT NUMBER   *64580000
645900* DOES NOT ALREADY EXIST.                                        *64590000
646000******************************************************************64600000
646100 4600-VALIDATE-UNIQUE-DOC.                                        64610000
646200                                                                  64620000
646300     PERFORM                                                      64630000
646400        WITH TEST AFTER                                           64640000
646500         VARYING PV-RETRY-COUNTER                                 64650000
646600        FROM 1 BY 1                                               64660000
646700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               64670000
646800                  OR (SQLCODE = ZERO)                             64680000
646900                  OR (SQLCODE = +100)                             64690000
647000                  OR (SQLCODE = -811))                            64700000
647100                                                                  64710000
647200     EXEC SQL                                                     64720000
647300         SELECT DOC_NBR                                           64730000
647400         INTO   :ADJRNL-DOC-NBR                                   64740000
647500         FROM   TADJRNL                                           64750000
647600         WHERE  DOC_NBR = :ASC-DOC-NUMBER                         64760000
647700         AND    VND_NBR = :ASC-VENDOR-NUMBER                      64770000
647800     END-EXEC                                                     64780000
647900                                                                  64790000
648000     EVALUATE TRUE                                                64800000
648100         WHEN SQLCODE = ZERO                                      64810000
648200         WHEN SQLCODE = -811                                      64820000
648300             SET ASC-DUP-DOC TO TRUE                              64830000
648400         WHEN SQLCODE = +100                                      64840000
648500             SET ASC-NO-DUP-DOC TO TRUE                           64850000
648600         WHEN SQLCODE = -904                                      64860000
648700         WHEN SQLCODE = -913                                      64870000
648800         WHEN SQLWARN0 NOT = SPACES                               64880000
648900         WHEN SQLCODE < ZERO                                      64890000
649000         WHEN SQLCODE > ZERO                                      64900000
649100             MOVE '4600-VALIDATE-DOC'                             64910000
649200                               TO DP013-PARAGRAPH                 64920000
649300             MOVE 'SELECT TADJRNL         '                       64930000
649400                               TO DP013-MESSAGE-TEXT (1)          64940000
649500             MOVE SQLCA        TO DP013-SQLCA                     64950000
649600             MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1)        64960000
649700             SET DP013-DB2-ABEND                                  64970000
649800                 DP013-XCTL-DISPLAY-RESTART                       64980000
649900                                     TO TRUE                      64990000
650000             PERFORM DP013-0000-PROCESS-ABEND                     65000000
650100     END-EVALUATE                                                 65010000
650200     END-PERFORM.                                                 65020000
650300                                                                  65030000
650400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         65040000
650500         MOVE '4600-VALIDATE-DOC'                                 65050000
650600                                   TO DP013-PARAGRAPH             65060000
650700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     65070000
650800                                   TO DP013-MESSAGE-TEXT (1)      65080000
650900         MOVE 'DOC          '  TO DP013-MESSAGE-TEXT (2)          65090000
651000         MOVE SQLCA            TO DP013-SQLCA                     65100000
651100         MOVE 'TADJRNL'        TO DP013-DB2-TABLE-NAME (1)        65110000
651200         SET DP013-DB2-ABEND                                      65120000
651300             DP013-XCTL-DISPLAY-RESTART                           65130000
651400                                   TO TRUE                        65140000
651500         PERFORM DP013-0000-PROCESS-ABEND                         65150000
651600     END-IF.                                                      65160000
651700                                                                  65170000
651800******************************************************************65180000
651900* THIS PARAGRAPH WILL VALIDATE THE ENTERED TRANSACTION CODE      *65190000
652000* AGAINST THE DB2 TABLE TTRNCDE.                                 *65200000
652100******************************************************************65210000
652200 4700-VALIDATE-TRAN-CD.                                           65220000
652300                                                                  65230000
652400     PERFORM                                                      65240000
652500        WITH TEST AFTER                                           65250000
652600         VARYING PV-RETRY-COUNTER                                 65260000
652700        FROM 1 BY 1                                               65270000
652800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65280000
652900                  OR (SQLCODE = ZERO)                             65290000
653000                   OR (SQLCODE = +100))                           65300000
653100                                                                  65310000
653200     EXEC SQL                                                     65320000
653300         SELECT AP_TRN_CDE                                        65330000
653400               ,PO_NBR_REQR_IND                                   65340000
653500               ,TRN_TYP_CDE                                       65350000
653600               ,PSTG_TYP_CDE                                      65360000
653700               ,AP_PSTG_IND                                       65370000
653800               ,COST_PRCCTL_CDE                                   65380000
653900               ,RTL_PRCCTL_CDE                                    65390000
654000               ,RSN_TXT_REQR_IND                                  65400000
654100               ,SUB_CL_REQR_IND                                   65410000
654200               ,SKU_SEQ_REQR_IND                                  65420000
654300               ,AUTO_OFFST_TRN_CDE                                65430000
654400               ,TRN_SRC_CDE                                       65440000
654500               ,FRGT_REQR_IND                                     65450000
654600               ,BTCH_SRC_CDE                                      65460000
654700         INTO   :TRNCDE-AP-TRN-CDE                                65470000
654800               ,:TRNCDE-PO-NBR-REQR-IND                           65480000
654900               ,:TRNCDE-TRN-TYP-CDE                               65490000
655000               ,:TRNCDE-PSTG-TYP-CDE                              65500000
655100               ,:TRNCDE-AP-PSTG-IND                               65510000
655200               ,:TRNCDE-COST-PRCCTL-CDE                           65520000
655300               ,:TRNCDE-RTL-PRCCTL-CDE                            65530000
655400               ,:TRNCDE-RSN-TXT-REQR-IND                          65540000
655500               ,:TRNCDE-SUB-CL-REQR-IND                           65550000
655600               ,:TRNCDE-SKU-SEQ-REQR-IND                          65560000
655700               ,:TRNCDE-AUTO-OFFST-TRN-CDE                        65570000
655800               ,:TRNCDE-TRN-SRC-CDE                               65580000
655900               ,:TRNCDE-FRGT-REQR-IND                             65590000
656000               ,:TRNCDE-BTCH-SRC-CDE                              65600000
656100         FROM   TTRNCDE                                           65610000
656200         WHERE  AP_TRN_CDE    = :ASC-TRAN-CD                      65620000
656300         AND    EFF_STRT_DTE <=  CURRENT DATE                     65630000
656400         AND    EFF_END_DTE  >=  CURRENT DATE                     65640000
656500     END-EXEC                                                     65650000
656600                                                                  65660000
656700     EVALUATE TRUE                                                65670000
656800         WHEN SQLCODE = ZERO                                      65680000
656900             SET ASC-TRAN-CDE-FND TO TRUE                         65690000
657000         WHEN SQLCODE = +100                                      65700000
657100             SET ASC-TRAN-CDE-NOT-FND TO TRUE                     65710000
657200         WHEN SQLCODE = -904                                      65720000
657300         WHEN SQLCODE = -913                                      65730000
657400         WHEN SQLWARN0 NOT = SPACES                               65740000
657500         WHEN SQLCODE < ZERO                                      65750000
657600         WHEN SQLCODE > ZERO                                      65760000
657700             MOVE '4700-VALIDATE-TRAN'                            65770000
657800                               TO DP013-PARAGRAPH                 65780000
657900             MOVE 'SELECT TTRNCDE         '                       65790000
658000                               TO DP013-MESSAGE-TEXT (1)          65800000
658100             MOVE SQLCA        TO DP013-SQLCA                     65810000
658200             MOVE 'TTRNCDE'    TO DP013-DB2-TABLE-NAME (1)        65820000
658300             SET DP013-DB2-ABEND                                  65830000
658400                 DP013-XCTL-DISPLAY-RESTART                       65840000
658500                                     TO TRUE                      65850000
658600             PERFORM DP013-0000-PROCESS-ABEND                     65860000
658700     END-EVALUATE                                                 65870000
658800     END-PERFORM.                                                 65880000
658900                                                                  65890000
659000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         65900000
659100         MOVE '4700-VALIDATE-TRAN'                                65910000
659200                                   TO DP013-PARAGRAPH             65920000
659300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     65930000
659400                                   TO DP013-MESSAGE-TEXT (1)      65940000
659500         MOVE 'TRAN CODE    '  TO DP013-MESSAGE-TEXT (2)          65950000
659600         MOVE SQLCA            TO DP013-SQLCA                     65960000
659700         MOVE 'TTRNCDE'        TO DP013-DB2-TABLE-NAME (1)        65970000
659800         SET DP013-DB2-ABEND                                      65980000
659900             DP013-XCTL-DISPLAY-RESTART                           65990000
660000                                   TO TRUE                        66000000
660100         PERFORM DP013-0000-PROCESS-ABEND                         66010000
660200     END-IF.                                                      66020000
660300                                                                  66030000
660400 EJECT                                                            66040000
660500*---------------------------------------------------------------* 66050000
660600* THIS PARAGRAPH CHECKS THAT AN AGREEMENT EXISTS FOR THE VENDOR * 66060000
660700* DEPARTMENT BEING KEYED.  THE EFFECTIVE/EXPIRATION DATE CHECKS * 66070000
660800* IN THE WHERE CONDITION ALLOW ADJUSTMENTS TO BE KEYED UP TO    * 66080000
660900* 100 DAYS AFTER AN AGREEMENT HAS EXPIRED - THIS ALLOWS FOR     * 66090000
661000* REPAYMENTS TO BE KEYED AT QUARTER-END ON CANCELLED AGREEMENTS.* 66100000
661100*---------------------------------------------------------------* 66110000
661200 4750-VALIDATE-VNDDPT-AGREEMENT.                                  66120000
661300                                                                  66130000
661400     PERFORM WITH TEST AFTER                                      66140000
661500       VARYING PV-RETRY-COUNTER                                   66150000
661600          FROM 1 BY 1                                             66160000
661700          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)              66170000
661800             OR (SQLCODE = ZERO)                                  66180000
661900             OR (SQLCODE = +100))                                 66190000
662000                                                                  66200000
662100         EXEC SQL                                                 66210000
662200           SELECT '1'                                             66220000
662300             INTO :PV-ONE                                         66230000
662400             FROM SYSIBM.SYSDUMMY1 X                              66240000
662500            WHERE EXISTS                                          66250000
662600                 (SELECT 1                                        66260000
662700                    FROM TVNDAGR AG                               66270000
662800                       , TEXTENT EX                               66280000
662900                   WHERE EX.DUN_NBR      = :EXTENT-DUN-NBR        66290000
663000                     AND AG.ENT_ID       = EX.ENT_ID              66300000
663100                     AND AG.DEPT_NBR     = :ASC-DEPARTMENT        66310000
663200                     AND ((AG.AGRMT_TYP_ID = '6'                  66320000
663300                     AND AG.TYP_CDE      = 6                      66330000
663400                     AND AG.AP_TRN_CDE   = '88'                   66340000
663500                     AND (CURRENT DATE BETWEEN EFFECTIVE_DATE     66350000
663600                                           AND EXPIRATION_DATE    66360000
663700                      OR (EFFECTIVE_DATE < CURRENT DATE AND       66370000
663800                          EXPIRATION_DATE >                       66380000
663900                                    CURRENT DATE - 100 DAYS)))    66390000
664000                     OR  (AG.AGRMT_TYP_ID = '5'                   66400000
664100                      AND AG.TYP_CDE      = 9                     66410000
664200                      AND EFFECTIVE_DATE  <= CURRENT DATE         66420000
664300                      AND EXPIRATION_DATE  > CURRENT DATE))       66430000
664400                     AND X.IBMREQD    = X.IBMREQD)                66440000
664500         END-EXEC                                                 66450000
664600                                                                  66460000
664700     EVALUATE TRUE                                                66470000
664800         WHEN SQLCODE = ZERO                                      66480000
664900             SET AGR-FOUND TO TRUE                                66490000
665000         WHEN SQLCODE = +100                                      66500000
665100             SET AGR-NOT-FOUND TO TRUE                            66510000
665200         WHEN SQLCODE = -904                                      66520000
665300         WHEN SQLCODE = -913                                      66530000
665400         WHEN SQLWARN0 NOT = SPACES                               66540000
665500         WHEN SQLCODE < ZERO                                      66550000
665600         WHEN SQLCODE > ZERO                                      66560000
665700             MOVE '4750-VALIDATE-VNDDPT-AGREEMENT'                66570000
665800                               TO DP013-PARAGRAPH                 66580000
665900             MOVE 'SELECT TVNDAGR         '                       66590000
666000                               TO DP013-MESSAGE-TEXT (1)          66600000
666100             MOVE SQLCA        TO DP013-SQLCA                     66610000
666200             MOVE 'TVNDAGR'    TO DP013-DB2-TABLE-NAME (1)        66620000
666300             SET DP013-DB2-ABEND                                  66630000
666400                 DP013-XCTL-DISPLAY-RESTART                       66640000
666500                                     TO TRUE                      66650000
666600             PERFORM DP013-0000-PROCESS-ABEND                     66660000
666700     END-EVALUATE                                                 66670000
666800     END-PERFORM.                                                 66680000
666900                                                                  66690000
667000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         66700000
667100         MOVE '4750-VALIDATE-VNDDPT-AGREEMENT'                    66710000
667200                                   TO DP013-PARAGRAPH             66720000
667300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     66730000
667400                                   TO DP013-MESSAGE-TEXT (1)      66740000
667500         MOVE 'VND AGREEMENT'  TO DP013-MESSAGE-TEXT (2)          66750000
667600         MOVE SQLCA            TO DP013-SQLCA                     66760000
667700         MOVE 'TVNDAGR'        TO DP013-DB2-TABLE-NAME (1)        66770000
667800         SET DP013-DB2-ABEND                                      66780000
667900             DP013-XCTL-DISPLAY-RESTART                           66790000
668000                                   TO TRUE                        66800000
668100         PERFORM DP013-0000-PROCESS-ABEND                         66810000
668200     END-IF.                                                      66820000
668300                                                                  66830000
668400 EJECT                                                            66840000
668500*---------------------------------------------------------------* 66850000
668600* THIS PARAGRAPH CHECKS THAT AN AGREEMENT EXISTS FOR THE VENDOR * 66860000
668700* BEING KEYED. THE EFFECTIVE/EXPIRATION DATE CHECKS IN THE      * 66870000
668800* WHERE CONDITION ALLOW ADJUSTMENTS TO BE KEYED UP TO 100 DAYS  * 66880000
668900* AFTER AN AGREEMENT HAS EXPIRED - THIS ALLOWS FOR REPAYMENTS   * 66890000
669000* TO BE KEYED AT END OF QUARTER ON CANCELLED AGREEMENTS.        * 66900000
669100*---------------------------------------------------------------* 66910000
669200 4770-VALIDATE-BRDCAST-VENDOR.                                    66920000
669300                                                                  66930000
669400     PERFORM WITH TEST AFTER                                      66940000
669500       VARYING PV-RETRY-COUNTER                                   66950000
669600          FROM 1 BY 1                                             66960000
669700          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)              66970000
669800             OR (SQLCODE = ZERO)                                  66980000
669900             OR (SQLCODE = +100))                                 66990000
670000                                                                  67000000
670100         EXEC SQL                                                 67010000
670200           SELECT '1'                                             67020000
670300             INTO :PV-ONE                                         67030000
670400             FROM SYSIBM.SYSDUMMY1 X                              67040000
670500            WHERE EXISTS                                          67050000
670600                 (SELECT 1                                        67060000
670700                    FROM TVNDAGR AG                               67070000
670800                       , TEXTENT EX                               67080000
670900                   WHERE EX.DUN_NBR      = :EXTENT-DUN-NBR        67090000
671000                     AND AG.ENT_ID       = EX.ENT_ID              67100000
671100                     AND ((AG.AGRMT_TYP_ID = '6'                  67110000
671200                     AND AG.TYP_CDE      = 6                      67120000
671300                     AND AG.AP_TRN_CDE   = '88'                   67130000
671400                     AND (CURRENT DATE BETWEEN EFFECTIVE_DATE     67140000
671500                                           AND EXPIRATION_DATE    67150000
671600                      OR (EFFECTIVE_DATE < CURRENT DATE AND       67160000
671700                          EXPIRATION_DATE >                       67170000
671800                                    CURRENT DATE - 100 DAYS)))    67180000
671900                     OR  (AG.AGRMT_TYP_ID = '5'                   67190000
672000                      AND AG.TYP_CDE      = 9                     67200000
672100                      AND EFFECTIVE_DATE  <= CURRENT DATE         67210000
672200                      AND EXPIRATION_DATE  > CURRENT DATE))       67220000
672300                     AND X.IBMREQD    = X.IBMREQD)                67230000
672400         END-EXEC                                                 67240000
672500                                                                  67250000
672600     EVALUATE TRUE                                                67260000
672700         WHEN SQLCODE = ZERO                                      67270000
672800             SET AGR-FOUND TO TRUE                                67280000
672900         WHEN SQLCODE = +100                                      67290000
673000             SET AGR-NOT-FOUND TO TRUE                            67300000
673100         WHEN SQLCODE = -904                                      67310000
673200         WHEN SQLCODE = -913                                      67320000
673300         WHEN SQLWARN0 NOT = SPACES                               67330000
673400         WHEN SQLCODE < ZERO                                      67340000
673500         WHEN SQLCODE > ZERO                                      67350000
673600             MOVE '4770-VALIDATE-BRDCAST-VENDOR'                  67360000
673700                               TO DP013-PARAGRAPH                 67370000
673800             MOVE 'SELECT TVNDAGR         '                       67380000
673900                               TO DP013-MESSAGE-TEXT (1)          67390000
674000             MOVE SQLCA        TO DP013-SQLCA                     67400000
674100             MOVE 'TVNDAGR'    TO DP013-DB2-TABLE-NAME (1)        67410000
674200             SET DP013-DB2-ABEND                                  67420000
674300                 DP013-XCTL-DISPLAY-RESTART                       67430000
674400                                     TO TRUE                      67440000
674500             PERFORM DP013-0000-PROCESS-ABEND                     67450000
674600     END-EVALUATE                                                 67460000
674700     END-PERFORM.                                                 67470000
674800                                                                  67480000
674900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         67490000
675000         MOVE '4770-VALIDATE-BRDCAST-VENDOR'                      67500000
675100                                   TO DP013-PARAGRAPH             67510000
675200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     67520000
675300                                   TO DP013-MESSAGE-TEXT (1)      67530000
675400         MOVE 'VND AGREEMENT'  TO DP013-MESSAGE-TEXT (2)          67540000
675500         MOVE SQLCA            TO DP013-SQLCA                     67550000
675600         MOVE 'TVNDAGR'        TO DP013-DB2-TABLE-NAME (1)        67560000
675700         SET DP013-DB2-ABEND                                      67570000
675800             DP013-XCTL-DISPLAY-RESTART                           67580000
675900                                   TO TRUE                        67590000
676000         PERFORM DP013-0000-PROCESS-ABEND                         67600000
676100     END-IF.                                                      67610000
676200                                                                  67620000
676300 EJECT                                                            67630000
676400*---------------------------------------------------------------* 67640000
676500* THIS PARAGRAPH CHECKS THAT AN AGREEMENT EXISTS FOR THE VENDOR * 67650000
676600* BEING KEYED. THE EFFECTIVE/EXPIRATION DATE CHECKS IN THE      * 67660000
676700* WHERE CONDITION ALLOW ADJUSTMENTS TO BE KEYED UP TO 100 DAYS  * 67670000
676800* AFTER AN AGREEMENT HAS EXPIRED - THIS ALLOWS FOR REPAYMENTS   * 67680000
676900* TO BE KEYED AT END OF QUARTER ON CANCELLED AGREEMENTS.        * 67690000
677000*---------------------------------------------------------------* 67700000
677100 4775-VALIDATE-BRIDAL-VENDOR.                                     67710000
677200                                                                  67720000
677300     PERFORM WITH TEST AFTER                                      67730000
677400       VARYING PV-RETRY-COUNTER                                   67740000
677500          FROM 1 BY 1                                             67750000
677600          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)              67760000
677700             OR (SQLCODE = ZERO)                                  67770000
677800             OR (SQLCODE = +100))                                 67780000
677900                                                                  67790000
678000         EXEC SQL                                                 67800000
678100           SELECT '1'                                             67810000
678200             INTO :PV-ONE                                         67820000
678300             FROM SYSIBM.SYSDUMMY1 X                              67830000
678400            WHERE EXISTS                                          67840000
678500                 (SELECT 1                                        67850000
678600                    FROM TVNDAGR AG                               67860000
678700                       , TEXTENT EX                               67870000
678800                   WHERE EX.DUN_NBR      = :EXTENT-DUN-NBR        67880000
678900                     AND AG.ENT_ID       = EX.ENT_ID              67890000
679000                     AND AG.AGRMT_TYP_ID = '6'                    67900000
679100                     AND AG.TYP_CDE      = 6                      67910000
679200                     AND AG.AP_TRN_CDE   = '89'                   67920000
679300                     AND (CURRENT DATE BETWEEN EFFECTIVE_DATE     67930000
679400                                           AND EXPIRATION_DATE    67940000
679500                      OR (EFFECTIVE_DATE < CURRENT DATE AND       67950000
679600                        EXPIRATION_DATE > CURRENT DATE - 100 DAYS)67960000
679700                         )                                        67970000
679800                     AND X.IBMREQD    = X.IBMREQD)                67980000
679900         END-EXEC                                                 67990000
680000                                                                  68000000
680100     EVALUATE TRUE                                                68010000
680200         WHEN SQLCODE = ZERO                                      68020000
680300             SET AGR-FOUND TO TRUE                                68030000
680400         WHEN SQLCODE = +100                                      68040000
680500             SET AGR-NOT-FOUND TO TRUE                            68050000
680600         WHEN SQLCODE = -904                                      68060000
680700         WHEN SQLCODE = -913                                      68070000
680800         WHEN SQLWARN0 NOT = SPACES                               68080000
680900         WHEN SQLCODE < ZERO                                      68090000
681000         WHEN SQLCODE > ZERO                                      68100000
681100             MOVE '4775-VALIDATE-BRIDAL-VENDOR'                   68110000
681200                               TO DP013-PARAGRAPH                 68120000
681300             MOVE 'SELECT TVNDAGR         '                       68130000
681400                               TO DP013-MESSAGE-TEXT (1)          68140000
681500             MOVE SQLCA        TO DP013-SQLCA                     68150000
681600             MOVE 'TVNDAGR'    TO DP013-DB2-TABLE-NAME (1)        68160000
681700             SET DP013-DB2-ABEND                                  68170000
681800                 DP013-XCTL-DISPLAY-RESTART                       68180000
681900                                     TO TRUE                      68190000
682000             PERFORM DP013-0000-PROCESS-ABEND                     68200000
682100     END-EVALUATE                                                 68210000
682200     END-PERFORM.                                                 68220000
682300                                                                  68230000
682400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         68240000
682500         MOVE '4775-VALIDATE-BRIDAL-VENDOR'                       68250000
682600                                   TO DP013-PARAGRAPH             68260000
682700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     68270000
682800                                   TO DP013-MESSAGE-TEXT (1)      68280000
682900         MOVE 'VND AGREEMENT'  TO DP013-MESSAGE-TEXT (2)          68290000
683000         MOVE SQLCA            TO DP013-SQLCA                     68300000
683100         MOVE 'TVNDAGR'        TO DP013-DB2-TABLE-NAME (1)        68310000
683200         SET DP013-DB2-ABEND                                      68320000
683300             DP013-XCTL-DISPLAY-RESTART                           68330000
683400                                   TO TRUE                        68340000
683500         PERFORM DP013-0000-PROCESS-ABEND                         68350000
683600     END-IF.                                                      68360000
683700                                                                  68370000
683800******************************************************************68380000
683900* THIS PARAGRAPH WILL VALIDATE THE VENDOR NUMBER ENTERED IN THE  *68390000
684000* HEADER PORTION OF THE SCREEN.  THE VENDOR DESCRIPTION WILL BE  *68400000
684100* RETRIEVED FOR DISPLAY PURPOSES.                                *68410000
684200******************************************************************68420000
684300 4800-VALIDATE-VENDOR.                                            68430000
684400                                                                  68440000
684500     PERFORM                                                      68450000
684600        WITH TEST AFTER                                           68460000
684700         VARYING PV-RETRY-COUNTER                                 68470000
684800        FROM 1 BY 1                                               68480000
684900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               68490000
685000                  OR (SQLCODE = ZERO)                             68500000
685100                   OR (SQLCODE = +100))                           68510000
685200                                                                  68520000
685300     EXEC SQL                                                     68530000
685400         SELECT B.ENT_NAME_DESC                                   68540000
685500               ,A.ENT_ID                                          68550000
685600               ,A.STATUS_CDE                                      68560000
685700         INTO   :ENTNME-ENT-NAME-DESC                             68570000
685800               ,:EXTENT-ENT-ID                                    68580000
685900               ,:EXTENT-STATUS-CDE                                68590000
686000         FROM   TEXTENT A                                         68600000
686100               ,TENTNME B                                         68610000
686200         WHERE  A.DUN_NBR = :EXTENT-DUN-NBR                       68620000
686300         AND    A.ENT_ID  =  B.ENT_ID                             68630000
686400         AND   B.TYPE_CDE =  '01'                                 68640000
686500*        AND A.STATUS_CDE =  'A'                                  68650000
686600     END-EXEC                                                     68660000
686700                                                                  68670000
686800     EVALUATE TRUE                                                68680000
686900         WHEN SQLCODE = ZERO                                      68690000
687000             SET ASC-VENDOR-FOUND TO TRUE                         68700000
687100         WHEN SQLCODE = +100                                      68710000
687200             SET ASC-VENDOR-NOT-FOUND TO TRUE                     68720000
687300             INITIALIZE ENTNME-ENT-NAME-DESC                      68730000
687400         WHEN SQLCODE = -904                                      68740000
687500         WHEN SQLCODE = -913                                      68750000
687600         WHEN SQLWARN0 NOT = SPACES                               68760000
687700         WHEN SQLCODE < ZERO                                      68770000
687800         WHEN SQLCODE > ZERO                                      68780000
687900             MOVE '4800-VALIDATE-VEND'                            68790000
688000                               TO DP013-PARAGRAPH                 68800000
688100             MOVE 'SELECT TEXTENT         '                       68810000
688200                               TO DP013-MESSAGE-TEXT (1)          68820000
688300             MOVE SQLCA        TO DP013-SQLCA                     68830000
688400             MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)        68840000
688500             SET DP013-DB2-ABEND                                  68850000
688600                 DP013-XCTL-DISPLAY-RESTART                       68860000
688700                                     TO TRUE                      68870000
688800             PERFORM DP013-0000-PROCESS-ABEND                     68880000
688900     END-EVALUATE                                                 68890000
689000     END-PERFORM.                                                 68900000
689100                                                                  68910000
689200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         68920000
689300         MOVE '4800-VALIDATE-VEND'                                68930000
689400                                   TO DP013-PARAGRAPH             68940000
689500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     68950000
689600                                   TO DP013-MESSAGE-TEXT (1)      68960000
689700         MOVE 'ENTITY ID    '  TO DP013-MESSAGE-TEXT (2)          68970000
689800         MOVE SQLCA            TO DP013-SQLCA                     68980000
689900         MOVE 'TEXTENT'        TO DP013-DB2-TABLE-NAME (1)        68990000
690000         SET DP013-DB2-ABEND                                      69000000
690100             DP013-XCTL-DISPLAY-RESTART                           69010000
690200                                   TO TRUE                        69020000
690300         PERFORM DP013-0000-PROCESS-ABEND                         69030000
690400     END-IF.                                                      69040000
690500                                                                  69050000
690600******************************************************************69060000
690700* THIS PARAGRAPH WILL GET THE OFFSET TRAN CODE                   *69070000
690800* FROM TTRNCDE FOR THE TRANCODE THAT IS BEING PROCESSED.         *69080000
690900******************************************************************69090000
691000 4850-GET-OFFSET-TRANCD.                                          69100000
691100                                                                  69110000
691200     PERFORM                                                      69120000
691300        WITH TEST AFTER                                           69130000
691400         VARYING PV-RETRY-COUNTER                                 69140000
691500        FROM 1 BY 1                                               69150000
691600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69160000
691700                  OR (SQLCODE = ZERO)                             69170000
691800                   OR (SQLCODE = +100))                           69180000
691900                                                                  69190000
692000     EXEC SQL                                                     69200000
692100         SELECT AUTO_OFFST_TRN_CDE                                69210000
692200         INTO   :TRNCDE-AUTO-OFFST-TRN-CDE                        69220000
692300         FROM   TTRNCDE                                           69230000
692400         WHERE  AP_TRN_CDE    = :ADJRNL-AP-TRN-CDE                69240000
692500*        WHERE  AP_TRN_CDE    = :TRNCDE-AP-TRN-CDE                69250000
692600         AND    EFF_STRT_DTE <=  CURRENT DATE                     69260000
692700         AND    EFF_END_DTE  >=  CURRENT DATE                     69270000
692800     END-EXEC                                                     69280000
692900                                                                  69290000
693000     EVALUATE TRUE                                                69300000
693100         WHEN SQLCODE = ZERO                                      69310000
693200             IF TRNCDE-AUTO-OFFST-TRN-CDE > '  '                  69320000
693300                SET ASC-OFFSET-TC-FOUND TO TRUE                   69330000
693400             ELSE                                                 69340000
693500                SET ASC-OFFSET-TC-NOT-FOUND TO TRUE               69350000
693600             END-IF                                               69360000
693700         WHEN SQLCODE = +100                                      69370000
693800             SET ASC-OFFSET-TC-NOT-FOUND TO TRUE                  69380000
693900         WHEN SQLCODE = -904                                      69390000
694000         WHEN SQLCODE = -913                                      69400000
694100         WHEN SQLWARN0 NOT = SPACES                               69410000
694200         WHEN SQLCODE < ZERO                                      69420000
694300         WHEN SQLCODE > ZERO                                      69430000
694400             MOVE '4850-GET-OFFSET-TRANCD'                        69440000
694500                               TO DP013-PARAGRAPH                 69450000
694600             MOVE 'SELECT TTRNCDE         '                       69460000
694700                               TO DP013-MESSAGE-TEXT (1)          69470000
694800             MOVE SQLCA        TO DP013-SQLCA                     69480000
694900             MOVE 'TTRNCDE'    TO DP013-DB2-TABLE-NAME (1)        69490000
695000             SET DP013-DB2-ABEND                                  69500000
695100                 DP013-XCTL-DISPLAY-RESTART                       69510000
695200                                     TO TRUE                      69520000
695300             PERFORM DP013-0000-PROCESS-ABEND                     69530000
695400     END-EVALUATE                                                 69540000
695500     END-PERFORM.                                                 69550000
695600                                                                  69560000
695700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         69570000
695800         MOVE '4850-GET-OFFSET-TRANCD'                            69580000
695900                                   TO DP013-PARAGRAPH             69590000
696000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     69600000
696100                                   TO DP013-MESSAGE-TEXT (1)      69610000
696200         MOVE 'OFFSET TRANCD'  TO DP013-MESSAGE-TEXT (2)          69620000
696300         MOVE SQLCA            TO DP013-SQLCA                     69630000
696400         MOVE 'TTRNCDE'        TO DP013-DB2-TABLE-NAME (1)        69640000
696500         SET DP013-DB2-ABEND                                      69650000
696600             DP013-XCTL-DISPLAY-RESTART                           69660000
696700                                   TO TRUE                        69670000
696800         PERFORM DP013-0000-PROCESS-ABEND                         69680000
696900     END-IF.                                                      69690000
697000                                                                  69700000
697100 EJECT                                                            69710000
697200******************************************************************69720000
697300* THIS PARAGRAPH WILL GET THE GL ACCT NBR FROM TTRNCDE FOR THE   *69730000
697400* OFFSET TRANCODE OF THE TRANCODE THAT IS BEING PROCESSED.       *69740000
697500******************************************************************69750000
697600 4860-GET-OFFSET-ACCTNO.                                          69760000
697700                                                                  69770000
697800     PERFORM                                                      69780000
697900        WITH TEST AFTER                                           69790000
698000         VARYING PV-RETRY-COUNTER                                 69800000
698100        FROM 1 BY 1                                               69810000
698200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69820000
698300                  OR (SQLCODE = ZERO)                             69830000
698400                   OR (SQLCODE = +100))                           69840000
698500                                                                  69850000
698600     EXEC SQL                                                     69860000
698700         SELECT GL_ACCT_NBR                                       69870000
698800               ,BTCH_SRC_CDE                                      69880000
698900               ,PSTG_TYP_CDE                                      69890000
699000         INTO   :PV-OFFSET-GL-ACCT-NBR                            69900000
699100               ,:PV-OFFSET-BTCH-SRC-CDE                           69910000
699200               ,:PV-OFFSET-PSTG-TYP-CDE                           69920000
699300         FROM   TTRNCDE                                           69930000
699400         WHERE  AP_TRN_CDE    = :TRNCDE-AUTO-OFFST-TRN-CDE        69940000
699500         AND    EFF_STRT_DTE <=  CURRENT DATE                     69950000
699600         AND    EFF_END_DTE  >=  CURRENT DATE                     69960000
699700     END-EXEC                                                     69970000
699800                                                                  69980000
699900     EVALUATE TRUE                                                69990000
700000         WHEN SQLCODE = ZERO                                      70000000
700100             MOVE PV-OFFSET-BTCH-SRC-CDE TO                       70010000
700200                         ASC-OFFSET-BTCH-SRC-CDE                  70020000
700300             MOVE PV-OFFSET-PSTG-TYP-CDE    TO                    70030000
700400                         ASC-OFFSET-PSTG-TYP-CDE                  70040000
700500             IF PV-OFFSET-GL-ACCT-NBR = SPACES                    70050000
700600                SET ASC-OFFSET-ACCT-NOT-FOUND TO TRUE             70060000
700700                PERFORM 4870-CHECK-FOR-OFFSET-GL-ACCT             70070000
700800             ELSE                                                 70080000
700900                SET ASC-OFFSET-ACCT-FOUND TO TRUE                 70090000
701000             END-IF                                               70100000
701100         WHEN SQLCODE = +100                                      70110000
701200             SET ASC-OFFSET-ACCT-NOT-FOUND TO TRUE                70120000
701300         WHEN SQLCODE = -904                                      70130000
701400         WHEN SQLCODE = -913                                      70140000
701500         WHEN SQLWARN0 NOT = SPACES                               70150000
701600         WHEN SQLCODE < ZERO                                      70160000
701700         WHEN SQLCODE > ZERO                                      70170000
701800             MOVE '4860-GET-OFFSET-ACCTNO'                        70180000
701900                               TO DP013-PARAGRAPH                 70190000
702000             MOVE 'SELECT TTRNCDE         '                       70200000
702100                               TO DP013-MESSAGE-TEXT (1)          70210000
702200             MOVE SQLCA        TO DP013-SQLCA                     70220000
702300             MOVE 'TTRNCDE'    TO DP013-DB2-TABLE-NAME (1)        70230000
702400             SET DP013-DB2-ABEND                                  70240000
702500                 DP013-XCTL-DISPLAY-RESTART                       70250000
702600                                     TO TRUE                      70260000
702700             PERFORM DP013-0000-PROCESS-ABEND                     70270000
702800     END-EVALUATE                                                 70280000
702900     END-PERFORM.                                                 70290000
703000                                                                  70300000
703100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         70310000
703200         MOVE '4860-GET-OFFSET-ACCTNO'                            70320000
703300                                   TO DP013-PARAGRAPH             70330000
703400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     70340000
703500                                   TO DP013-MESSAGE-TEXT (1)      70350000
703600         MOVE 'OFFSET ACCTNO'  TO DP013-MESSAGE-TEXT (2)          70360000
703700         MOVE SQLCA            TO DP013-SQLCA                     70370000
703800         MOVE 'TTRNCDE'        TO DP013-DB2-TABLE-NAME (1)        70380000
703900         SET DP013-DB2-ABEND                                      70390000
704000             DP013-XCTL-DISPLAY-RESTART                           70400000
704100                                   TO TRUE                        70410000
704200         PERFORM DP013-0000-PROCESS-ABEND                         70420000
704300     END-IF.                                                      70430000
704400                                                                  70440000
704500******************************************************************70450000
704600* THIS PARAGRAPH WILL CHECK FOR A GL ACCT NUMBER ON THE TADJRNL  *70460000
704700* TABLE FOR THE ADJUSTMENT BEING PROCESSED.                      *70470000
704800******************************************************************70480000
704900 4870-CHECK-FOR-OFFSET-GL-ACCT.                                   70490000
705000                                                                  70500000
705100     EXEC SQL                                                     70510000
705200           SELECT GL_ACCT_NBR                                     70520000
705300            INTO :PV-OFFSET-GL-ACCT-NBR                           70530000
705400             FROM TADJRNL                                         70540000
705500            WHERE VND_NBR          = :EXTENT-DUN-NBR              70550000
705600              AND DOC_NBR          = :ASC-OFFSET-DOC-NUMBER       70560000
705700              AND DOC_DTE          = :ASC-KEY-DOC-DATE            70570000
705800              AND AP_TRN_CDE       = :TRNCDE-AUTO-OFFST-TRN-CDE   70580000
705900     END-EXEC.                                                    70590000
706000                                                                  70600000
706100     EVALUATE TRUE                                                70610000
706200         WHEN SQLCODE = +0                                        70620000
706300         WHEN SQLCODE = -811                                      70630000
706400             IF  PV-OFFSET-GL-ACCT-NBR  = ' '                     70640000
706500               SET ASC-OFFSET-ACCT-NOT-FOUND TO TRUE              70650000
706600             ELSE                                                 70660000
706700               SET ASC-OFFSET-ACCT-FOUND TO TRUE                  70670000
706800             END-IF                                               70680000
706900                                                                  70690000
707000         WHEN SQLCODE = +100                                      70700000
707100         WHEN SQLWARN0 NOT = SPACES                               70710000
707200                SET ASC-OFFSET-ACCT-NOT-FOUND TO TRUE             70720000
707300                                                                  70730000
707400         WHEN SQLCODE = -904                                      70740000
707500         WHEN SQLCODE = -913                                      70750000
707600         WHEN SQLWARN0 NOT = SPACES                               70760000
707700         WHEN SQLCODE < ZERO                                      70770000
707800         WHEN SQLCODE > ZERO                                      70780000
707900             MOVE '4870-CHECK-FOR-OFFSET-GL-ACCT'                 70790000
708000                               TO DP013-PARAGRAPH                 70800000
708100             MOVE 'SELECT ON TADJRNL        '                     70810000
708200                               TO DP013-MESSAGE-TEXT (1)          70820000
708300             MOVE SQLCA   TO DP013-SQLCA                          70830000
708400             MOVE 'TADJRNL' TO DP013-DB2-TABLE-NAME (1)           70840000
708500             SET DP013-DB2-ABEND                                  70850000
708600                 DP013-XCTL-DISPLAY-RESTART                       70860000
708700                               TO TRUE                            70870000
708800             PERFORM DP013-0000-PROCESS-ABEND                     70880000
708900     END-EVALUATE.                                                70890000
709000                                                                  70900000
709100                                                                  70910000
709200 EJECT                                                            70920000
709300******************************************************************70930000
709400* THIS PARAGRAPH WILL VALIDATE THE ENTERED HEADER DEPARTMENT     *70940000
709500* AGAINST THE DB2 TABLE TMDSEAR.                                 *70950000
709600******************************************************************70960000
709700 4900-VALIDATE-DEPARTMENT.                                        70970000
709800                                                                  70980000
709900     PERFORM                                                      70990000
710000        WITH TEST AFTER                                           71000000
710100         VARYING PV-RETRY-COUNTER                                 71010000
710200        FROM 1 BY 1                                               71020000
710300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               71030000
710400                  OR (SQLCODE = ZERO)                             71040000
710500                   OR (SQLCODE = +100)                            71050000
710600                   OR (SQLCODE = -811))                           71060000
710700                                                                  71070000
710800                                                                  71080000
710900     EXEC SQL                                                     71090000
711000       SELECT  DEPT_NBR                                           71100000
711100              ,MAJ_CL_NBR                                         71110000
711200              ,SUB_CL_NBR                                         71120000
711300              ,MDSELV_CDE                                         71130000
711400        INTO  :MDSEAR-DEPT-NBR                                    71140000
711500             ,:MDSEAR-MAJ-CL-NBR                                  71150000
711600             ,:MDSEAR-SUB-CL-NBR                                  71160000
711700             ,:MDSEAR-MDSELV-CDE                                  71170000
711800        FROM   TMDSEAR                                            71180000
711900       WHERE   DEPT_NBR   = :ASC-DEPARTMENT                       71190000
712000         AND   MDSELV_CDE =  'DPT'                                71200000
712100         AND   CURRENT DATE BETWEEN STRT_DTE AND END_DTE          71210000
712200     END-EXEC                                                     71220000
712300                                                                  71230000
712400                                                                  71240000
712500     EVALUATE TRUE                                                71250000
712600         WHEN SQLCODE = ZERO                                      71260000
712700             SET ASC-DEPT-FOUND TO TRUE                           71270000
712800         WHEN SQLCODE = +100                                      71280000
712900             SET ASC-DEPT-NOT-FOUND TO TRUE                       71290000
713000         WHEN SQLCODE = -904                                      71300000
713100         WHEN SQLCODE = -913                                      71310000
713200         WHEN SQLWARN0 NOT = SPACES                               71320000
713300         WHEN SQLCODE < ZERO                                      71330000
713400         WHEN SQLCODE > ZERO                                      71340000
713500             MOVE '4900-VALIDATE-DEPT'                            71350000
713600                               TO DP013-PARAGRAPH                 71360000
713700             MOVE 'SELECT TMDSEAR         '                       71370000
713800                               TO DP013-MESSAGE-TEXT (1)          71380000
713900             MOVE SQLCA        TO DP013-SQLCA                     71390000
714000             MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)        71400000
714100             SET DP013-DB2-ABEND                                  71410000
714200                 DP013-XCTL-DISPLAY-RESTART                       71420000
714300                                     TO TRUE                      71430000
714400             PERFORM DP013-0000-PROCESS-ABEND                     71440000
714500     END-EVALUATE                                                 71450000
714600     END-PERFORM.                                                 71460000
714700                                                                  71470000
714800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         71480000
714900         MOVE '4900-VALIDATE-DEPT'                                71490000
715000                                   TO DP013-PARAGRAPH             71500000
715100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     71510000
715200                                   TO DP013-MESSAGE-TEXT (1)      71520000
715300         MOVE 'DEPARTMENT   '  TO DP013-MESSAGE-TEXT (2)          71530000
715400         MOVE SQLCA            TO DP013-SQLCA                     71540000
715500         MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)        71550000
715600         SET DP013-DB2-ABEND                                      71560000
715700             DP013-XCTL-DISPLAY-RESTART                           71570000
715800                                   TO TRUE                        71580000
715900         PERFORM DP013-0000-PROCESS-ABEND                         71590000
716000     END-IF.                                                      71600000
716100                                                                  71610000
716200*                                                                 71620000
716300******************************************************************71630000
716400* THIS PARAGRAPH WILL VALIDATE THE ENTERED HEADER ACCOUNT NUMBER *71640000
716500* AGAINST THE ACCOUNT NUMBER ON THE TTRNCDE ROW FOR THE ENTERED  *71650000
716600* TRANSACTION CODE.  IF THERE IS NO ACCOUNT NUMBER ON TTRNCDE    *71660000
716700* THIS WILL NOT BE CONSIDERED AN ERROR.                         * 71670000
716800******************************************************************71680000
716900 4951-VALID-ACCT-TRAN-CD-COMBIN.                                  71690000
717000                                                                  71700000
717100     PERFORM                                                      71710000
717200        WITH TEST AFTER                                           71720000
717300         VARYING PV-RETRY-COUNTER                                 71730000
717400        FROM 1 BY 1                                               71740000
717500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               71750000
717600                  OR (SQLCODE = ZERO)                             71760000
717700                  OR (SQLCODE = +100))                            71770000
717800                                                                  71780000
717900        EXEC SQL                                                  71790000
718000            SELECT GL_ACCT_NBR                                    71800000
718100            INTO   :TRNCDE-GL-ACCT-NBR                            71810000
718200            FROM   TTRNCDE                                        71820000
718300            WHERE  AP_TRN_CDE    = :ASC-TRAN-CD                   71830000
718400            AND    EFF_STRT_DTE <=  CURRENT DATE                  71840000
718500            AND    EFF_END_DTE  >=  CURRENT DATE                  71850000
718600        END-EXEC                                                  71860000
718700                                                                  71870000
718800        EVALUATE TRUE                                             71880000
718900            WHEN SQLCODE = ZERO                                   71890000
719000                IF TRNCDE-GL-ACCT-NBR > SPACES                    71900000
719100                   IF TRNCDE-GL-ACCT-NBR = ASC-ACCT-NO            71910000
719200                      SET ASC-ACCT-NBR-MATCHES TO TRUE            71920000
719300                   ELSE                                           71930000
719400                      SET ASC-ACCT-NBR-DOESNT-MATCH TO TRUE       71940000
719500                   END-IF                                         71950000
719600                END-IF                                            71960000
719700            WHEN SQLCODE = +100                                   71970000
719800                CONTINUE                                          71980000
719900            WHEN SQLCODE = -904                                   71990000
720000            WHEN SQLCODE = -913                                   72000000
720100            WHEN SQLWARN0 NOT = SPACES                            72010000
720200            WHEN SQLCODE < ZERO                                   72020000
720300            WHEN SQLCODE > ZERO                                   72030000
720400                MOVE '4951-VALID-ACCT-TRAN-CD-COMBIN'             72040000
720500                                  TO DP013-PARAGRAPH              72050000
720600                MOVE 'SELECT GL_ACCT_NBR    '                     72060000
720700                                  TO DP013-MESSAGE-TEXT (1)       72070000
720800                MOVE SQLCA        TO DP013-SQLCA                  72080000
720900                MOVE 'TTRNCDE'    TO DP013-DB2-TABLE-NAME (1)     72090000
721000                SET DP013-DB2-ABEND                               72100000
721100                    DP013-XCTL-DISPLAY-RESTART                    72110000
721200                                  TO TRUE                         72120000
721300                PERFORM DP013-0000-PROCESS-ABEND                  72130000
721400        END-EVALUATE                                              72140000
721500     END-PERFORM.                                                 72150000
721600                                                                  72160000
721700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         72170000
721800         MOVE '4951-VALID-ACCT-TRAN-CD-COMBIN'                    72180000
721900                               TO DP013-PARAGRAPH                 72190000
722000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     72200000
722100                               TO DP013-MESSAGE-TEXT (1)          72210000
722200         MOVE 'GL_ACCT_NBR  '  TO DP013-MESSAGE-TEXT (2)          72220000
722300         MOVE SQLCA            TO DP013-SQLCA                     72230000
722400         MOVE 'TTRNCDE'        TO DP013-DB2-TABLE-NAME (1)        72240000
722500         SET DP013-DB2-ABEND                                      72250000
722600             DP013-XCTL-DISPLAY-RESTART                           72260000
722700                               TO TRUE                            72270000
722800         PERFORM DP013-0000-PROCESS-ABEND                         72280000
722900     END-IF.                                                      72290000
723000                                                                  72300000
726700*----------------------------------------------------------------*72670000
726800* SELECT FIRST AVAILABLE MAJOR CLASS FOR DEPT BEING PROCESSED    *72680000
726900*----------------------------------------------------------------*72690000
727000 4990-GET-MAJOR-CLASS.                                            72700000
727100                                                                  72710000
727200     PERFORM WITH TEST AFTER                                      72720000
727300       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       72730000
727400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               72740000
727500                  OR (SQLCODE = ZERO)                             72750000
727600                  OR (SQLCODE = +100))                            72760000
727700     EXEC SQL                                                     72770000
727800          SELECT MIN(B.MAJ_CL_NBR)                                72780000
727900            INTO :MDSEAR-MAJ-CL-NBR                               72790000
728000            FROM TMDSEAR B                                        72800000
728100           WHERE B.OPERCO_NBR = '03'                              72810000
728200             AND B.DEPT_NBR = :ASC-DEPARTMENT                     72820000
728300             AND B.MDSELV_CDE IN ('MCL')                          72830000
728400             AND B.END_DTE = '9999-09-09'                         72840000
728500             AND EXISTS                                           72850000
728600                 (SELECT 1                                        72860000
728700                    FROM TAPLAVL A                                72870000
728800                   WHERE A.APLSYS_CDE = 'ML'                      72880000
728900                     AND A.MDSEAR_DKEY = B.MDSEAR_DKEY            72890000
729000                     AND CURRENT DATE BETWEEN A.MDSEAR_STRT_DTE   72900000
729100                                          AND A.MDSEAR_END_DTE    72910000
729200                     AND A.OPERCO_NBR = B.OPERCO_NBR)             72920000
729300     END-EXEC                                                     72930000
729400                                                                  72940000
729500     EVALUATE TRUE                                                72950000
729600         WHEN SQLCODE = ZERO                                      72960000
729700             SET ASC-CLASS-FOUND TO TRUE                          72970000
729800         WHEN SQLCODE = +100                                      72980000
729900             SET ASC-CLASS-NOT-FOUND           TO TRUE            72990000
730000         WHEN SQLCODE = -904                                      73000000
730100         WHEN SQLCODE = -913                                      73010000
730200         WHEN SQLWARN0 NOT = SPACES                               73020000
730300         WHEN SQLCODE < ZERO                                      73030000
730400         WHEN SQLCODE > ZERO                                      73040000
730500             MOVE '4990-GET-MAJOR-CLASS'                          73050000
730600                               TO DP013-PARAGRAPH                 73060000
730700             MOVE 'SELECT TMDSEAR         '                       73070000
730800                               TO DP013-MESSAGE-TEXT (1)          73080000
730900             MOVE SQLCA        TO DP013-SQLCA                     73090000
731000             MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)        73100000
731100             MOVE 'TAPLAVL'    TO DP013-DB2-TABLE-NAME (2)        73110000
731200             SET DP013-DB2-ABEND                                  73120000
731300                 DP013-XCTL-DISPLAY-RESTART                       73130000
731400                                     TO TRUE                      73140000
731500             PERFORM DP013-0000-PROCESS-ABEND                     73150000
731600     END-EVALUATE                                                 73160000
731700     END-PERFORM.                                                 73170000
731800                                                                  73180000
731900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         73190000
732000         MOVE '4990-GET-MAJOR-CLASS'                              73200000
732100                                   TO DP013-PARAGRAPH             73210000
732200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     73220000
732300                                   TO DP013-MESSAGE-TEXT (1)      73230000
732400         MOVE 'MAJOR CLASS  '  TO DP013-MESSAGE-TEXT (2)          73240000
732500         MOVE SQLCA            TO DP013-SQLCA                     73250000
732600         MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)        73260000
732700         SET DP013-DB2-ABEND                                      73270000
732800             DP013-XCTL-DISPLAY-RESTART                           73280000
732900                                   TO TRUE                        73290000
733000         PERFORM DP013-0000-PROCESS-ABEND                         73300000
733100     END-IF.                                                      73310000
733200                                                                  73320000
733300******************************************************************73330000
733400* FORMAT THE ADJUSTMENT JOURNAL RECORDS FOR PASSING TO THE DETAIL*73340000
733500******************************************************************73350000
733600 5000-ADD-AP-KEY-ADJUSTMENT.                                      73360000
733700                                                                  73370000
733800     MOVE ASC-VENDOR-NUMBER       TO AP363-VND-NBR                73380000
733900                                     ASC-KEY-VEND-NUMBER.         73390000
734000                                                                  73400000
734100     PERFORM 5010-FORMAT-AP-ADJUSTMENT.                           73410000
734200                                                                  73420000
734300******************************************************************73430000
734400* THIS PARAGRAPH WILL FORMAT ADJUSTMENT DETAIL DATA FOR PASSING  *73440000
734500* TO THE DETAIL ENTRY SCREEN.                                    *73450000
734600******************************************************************73460000
734700 5010-FORMAT-AP-ADJUSTMENT.                                       73470000
734800                                                                  73480000
734900     MOVE ASC-DOC-NUMBER           TO AP363-DOC-NBR               73490000
735000                                      ASC-KEY-DOC-NUMBER.         73500000
735100     MOVE ASC-DOC-DATE             TO AP363-DOC-DTE               73510000
735200                                      ASC-KEY-DOC-DATE.           73520000
735300     MOVE ASC-TRAN-CD              TO AP363-AP-TRN-CDE            73530000
735400                                      ASC-KEY-TRAN-CODE.          73540000
735500     MOVE ASC-DEPARTMENT           TO AP363-DEPT-NBR.             73550000
735600     MOVE ASC-ACCT-NO              TO AP363-GL-ACCT-NBR.          73560000
735700     MOVE ASC-STORE                TO AP363-STR-NBR.              73570000
735800     MOVE ASC-PO-NUMBER            TO AP363-PO-NBR.               73580000
735900     MOVE DP020-USERID             TO AP363-ENTR-ID.              73590000
736000                                                                  73600000
736100     IF ASC-UPDATE-PENDING                                        73610000
736200        OR ASC-UPDATE-REQUESTED                                   73620000
736300           MOVE ASC-ORIGIN-CDE      TO AP363-ORGN-CDE             73630000
736400           MOVE ASC-PS-POSTING-IND  TO AP363-PS-PSTG-IND          73640000
736500           MOVE ASC-PS-BATCH-NBR    TO AP363-PS-BTCH-NBR          73650000
736600           MOVE ASC-DOC-EXTRACT-IND TO AP363-DOC-EXTR-IND         73660000
736700           MOVE ASC-DOC-EXTRACT-DTE TO AP363-DOC-EXTR-DTE         73670000
736800     ELSE                                                         73680000
736900           MOVE 'A'                 TO AP363-ORGN-CDE             73690000
737000           MOVE 'Y'                 TO AP363-PS-PSTG-IND          73700000
737100           STRING                                                 73710000
737200              ASC-CURRENT-DATE,                                   73720000
737300              TRNCDE-BTCH-SRC-CDE,                                73730000
737400              '00'                                                73740000
737500              DELIMITED BY SIZE                                   73750000
737600              INTO AP363-PS-BTCH-NBR                              73760000
737700           END-STRING                                             73770000
737800           MOVE 'N'                 TO AP363-DOC-EXTR-IND         73780000
737900           MOVE '0001-01-01'        TO AP363-DOC-EXTR-DTE         73790000
738000     END-IF.                                                      73800000
738100                                                                  73810000
738200     MOVE ASC-GROSS-COST           TO AP363-GRO-COST-AMT.         73820000
738300     MOVE ASC-RETAIL-AMT           TO AP363-RTL-AMT.              73830000
738400     MOVE ASC-FREIGHT-AMT          TO AP363-FRGT-AMT.             73840000
738500     MOVE ASC-MISC-CHG             TO AP363-MISC-CHRG-AMT.        73850000
738600                                                                  73860000
738700     INITIALIZE PV-PERCENT-VARIABLE.                              73870000
738800     COMPUTE PV-PERCENT-VARIABLE =                                73880000
738900             ASC-DISC-PCT / 100.                                  73890000
739000                                                                  73900000
739100     MOVE PV-PERCENT-VARIABLE      TO AP363-TERM-DISC-PCT.        73910000
739200     MOVE ASC-DISC-AMT             TO AP363-TERM-DISC-AMT.        73920000
739300                                                                  73930000
739400     INITIALIZE PV-PERCENT-VARIABLE.                              73940000
739500     COMPUTE PV-PERCENT-VARIABLE =                                73950000
739600             ASC-NEW-STR-PCT / 100.                               73960000
739700                                                                  73970000
739800     MOVE PV-PERCENT-VARIABLE      TO AP363-NW-STR-DISC-PCT.      73980000
739900     MOVE ASC-NEW-STR-AMT          TO AP363-NW-STR-DISC-AMT.      73990000
740000                                                                  74000000
740100     INITIALIZE PV-PERCENT-VARIABLE.                              74010000
740200     COMPUTE PV-PERCENT-VARIABLE =                                74020000
740300             ASC-TRADE-PCT / 100.                                 74030000
740400                                                                  74040000
740500     MOVE PV-PERCENT-VARIABLE      TO AP363-TRD-DISC-PCT.         74050000
740600     MOVE ASC-TRADE-AMT            TO AP363-TRD-DISC-AMT.         74060000
740700                                                                  74070000
740800     INITIALIZE PV-PERCENT-VARIABLE.                              74080000
740900     COMPUTE PV-PERCENT-VARIABLE =                                74090000
741000             ASC-MOS-PCT / 100.                                   74100000
741100                                                                  74110000
741200     MOVE PV-PERCENT-VARIABLE      TO AP363-MOS-DISC-PCT.         74120000
741300     MOVE ASC-MOS-AMT              TO AP363-MOS-DISC-AMT.         74130000
741400     MOVE ASC-NET-COST             TO AP363-NET-COST-AMT.         74140000
741500     MOVE ASC-CUTOFF-DATE          TO AP363-INV-CTOFF-DTE.        74150000
741600     MOVE ASC-TRN-TYP-CDE          TO AP363-TRN-TYP-CDE.          74160000
741700     MOVE ASC-BARCODE              TO AP363-BRCDE-NBR.            74170000
741800                                                                  74180000
741900     IF ASC-MULTI-PSTG-PERIOD                                     74190000
742000        IF ASC-APPL-MTH = 'P'                                     74200000
742100           MOVE ASC-PREV-PSTG-FYR-NBR TO AP363-PSTG-FYR-NBR       74210000
742200           MOVE ASC-PREV-PSTG-FMN-NBR TO AP363-PSTG-FMN-NBR       74220000
742300           MOVE ASC-PREV-PSTG-FWK-NBR TO AP363-PSTG-FWK-NBR       74230000
742400        ELSE                                                      74240000
742500           MOVE ASC-CURR-PSTG-FYR-NBR TO AP363-PSTG-FYR-NBR       74250000
742600           MOVE ASC-CURR-PSTG-FMN-NBR TO AP363-PSTG-FMN-NBR       74260000
742700           MOVE ASC-CURR-PSTG-FWK-NBR TO AP363-PSTG-FWK-NBR       74270000
742800        END-IF                                                    74280000
742900     ELSE                                                         74290000
743000        MOVE ASC-CURR-PSTG-FYR-NBR    TO AP363-PSTG-FYR-NBR       74300000
743100        MOVE ASC-CURR-PSTG-FMN-NBR    TO AP363-PSTG-FMN-NBR       74310000
743200        MOVE ASC-CURR-PSTG-FWK-NBR    TO AP363-PSTG-FWK-NBR       74320000
743300     END-IF.                                                      74330000
743400                                                                  74340000
743500     IF  ASC-NEW-STR-COST-ALLOCATION                              74350000
743600         MOVE PV-DISTRO-DISC-AMT TO AP363-DIS-GRO-COST-AMT        74360000
743700     ELSE                                                         74370000
743800         MOVE ASC-DET-COST       TO AP363-DIS-GRO-COST-AMT        74380000
743900     END-IF.                                                      74390000
744000                                                                  74400000
744100     MOVE ASC-VENDOR-NAME         TO AP363-VENDOR-NAME.           74410000
744200     MOVE ASC-DET-STORE           TO AP363-DIS-STR-NBR.           74420000
744300     MOVE ASC-DET-CLASS           TO AP363-DIS-CL-NBR.            74430000
744400     MOVE ASC-DET-SKU             TO AP363-DIS-SKU-NBR.           74440000
744500     MOVE ASC-DET-RETAIL          TO AP363-DIS-RTL-AMT.           74450000
744600     MOVE ASC-DET-NET             TO AP363-DIS-NET-COST-AMT.      74460000
744700     MOVE ASC-DET-DISTRB-SEQ      TO AP363-DISTRB-SEQ-NBR.        74470000
744800     MOVE ASC-MULT-DISTRO-IND     TO AP363-MULT-DISTRO-IND.       74480000
744900     MOVE ASC-COST-PRCCTL-CDE     TO AP363-COST-PRCCTL-CDE.       74490000
745000     MOVE ASC-AP-PSTG-IND         TO AP363-AP-PSTG-IND.           74500000
745100     MOVE ASC-RTL-PRCCTL-CDE      TO AP363-RTL-PRCCTL-CDE.        74510000
745200     MOVE ASC-PSTG-TYP-CDE        TO AP363-PSTG-TYP-CDE.          74520000
745300     MOVE ASC-FRGT-REQR-IND       TO AP363-FRGT-REQR-IND.         74530000
745400     MOVE ASC-SKU-SEQ-REQR-IND    TO AP363-SKU-SEQ-REQR-IND.      74540000
745500     MOVE ASC-SUB-CL-REQR-IND     TO AP363-SUB-CL-REQR-IND.       74550000
745600     MOVE ASC-COST-MATCH-IND      TO AP363-COST-MATCH-IND.        74560000
745700     MOVE ASC-RETAIL-MATCH-IND    TO AP363-RETAIL-MATCH-IND.      74570000
745800     MOVE ASC-SKU-ENTERED-SW      TO AP363-SKU-ENTERED-SW.        74580000
745900     MOVE ASC-ALLOCATION-SW       TO AP363-ALLOCATION-SW.         74590000
746000     MOVE ASC-ENT-ID              TO AP363-ENT-ID.                74600000
746100     MOVE ASC-OFFSET-TRAN-CD      TO AP363-OFFSET-TRAN-CD.        74610000
746200     MOVE ASC-OFFSET-ACCT-NO      TO AP363-OFFSET-ACCT-NO.        74620000
746300     MOVE ASC-OFFSET-BYPASS-IND   TO AP363-OFFSET-BYPASS-IND.     74630000
746400     MOVE ASC-OFFSET-DOC-NUMBER   TO AP363-OFFSET-DOC-NBR.        74640000
746500     MOVE ASC-OFFSET-BTCH-SRC-CDE TO AP363-OFFSET-BTCH-SRC-CDE.   74650000
746600     MOVE ASC-OFFSET-PSTG-TYP-CDE TO AP363-OFFSET-PSTG-TYP-CDE.   74660000
746700     MOVE ASC-OFFSET-ADJ-FOUND-SW TO AP363-OFFSET-ADJ-FOUND-SW.   74670000
746800                                                                  74680000
746900     PERFORM 5015-FORMAT-REMAIN-DTL-LAYOUT.                       74690000
747000                                                                  74700000
747100************************************************************      74710000
747200* THIS PARAGRAPH WILL FORMAT REMAINING APWS363 FIELDS.     *      74720000
747300************************************************************      74730000
747400 5015-FORMAT-REMAIN-DTL-LAYOUT.                                   74740000
747500                                                                  74750000
747600     MOVE ASC-DUE-DATE            TO AP363-DUE-DTE.               74760000
747700                                                                  74770000
747800     IF ASC-HOLD-STATUS > SPACES                                  74780000
747900        MOVE ASC-HOLD-STATUS      TO AP363-DOC-HLD-CDE            74790000
748000     ELSE                                                         74800000
748100        MOVE 'N'                  TO AP363-DOC-HLD-CDE            74810000
748200     END-IF.                                                      74820000
748300                                                                  74830000
748400     MOVE ASC-REASON-CODE1        TO AP363-RSN-1ST-LNE-TXT.       74840000
748500     MOVE ASC-REASON-CODE2        TO AP363-RSN-2ND-LNE-TXT.       74850000
748600     MOVE ASC-VENDOR-AUTH         TO AP363-AUTH-NBR.              74860000
748700                                                                  74870000
748800************************************************************      74880000
748900* THIS PARAGRAPH WILL PERFORM A DB2 DELETE OF THE TADJRNL  *      74890000
749000* TABLE WHEN AN ENTIRE ADJUSTMENT IS DELETED.              *      74900000
749100************************************************************      74910000
749200 5300-DELETE-TADJRNL.                                             74920000
749300                                                                  74930000
749400     PERFORM                                                      74940000
749500        WITH TEST AFTER                                           74950000
749600         VARYING PV-RETRY-COUNTER                                 74960000
749700        FROM 1 BY 1                                               74970000
749800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               74980000
749900            OR (SQLCODE = +0))                                    74990000
750000                                                                  75000000
750100        EXEC SQL                                                  75010000
750200           DELETE FROM                                            75020000
750300              TADJRNL                                             75030000
750400              WHERE VND_NBR      = :ASC-KEY-VEND-NUMBER           75040000
750500              AND DOC_NBR        = :ASC-KEY-DOC-NUMBER            75050000
750600              AND DOC_DTE        = :ASC-KEY-DOC-DATE              75060000
750700              AND AP_TRN_CDE     = :ASC-KEY-TRAN-CODE             75070000
750800        END-EXEC                                                  75080000
750900                                                                  75090000
751000        EVALUATE TRUE                                             75100000
751100             WHEN SQLCODE = +0                                    75110000
751200              SET ASC-DELETE-SUCCESSFUL TO TRUE                   75120000
751300              MOVE PC-TSYMSG-00115 TO DP020-MSG-NUMBER            75130000
751400              SET DP020-MSG-INFORMATIONAL TO TRUE                 75140000
751500                                                                  75150000
751600             WHEN SQLCODE = -904                                  75160000
751700             WHEN SQLCODE = -913                                  75170000
751800                 CONTINUE                                         75180000
751900                                                                  75190000
752000             WHEN SQLWARN0 NOT = SPACES                           75200000
752100             WHEN SQLCODE < +0                                    75210000
752200             WHEN SQLCODE > +0                                    75220000
752300                 MOVE '5300-DELETE-TADJRNL'                       75230000
752400                                   TO DP013-PARAGRAPH             75240000
752500                 MOVE 'DELETE A ROW ON TADJRNL'                   75250000
752600                                   TO DP013-MESSAGE-TEXT(1)       75260000
752700                 MOVE SQLCA        TO DP013-SQLCA                 75270000
752800                 MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1)    75280000
752900                 SET DP013-DB2-ABEND                              75290000
753000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           75300000
753100                 PERFORM DP013-0000-PROCESS-ABEND                 75310000
753200         END-EVALUATE                                             75320000
753300     END-PERFORM.                                                 75330000
753400                                                                  75340000
753500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        75350000
753600         MOVE '5300-DELETE-TADJRNL' TO DP013-PARAGRAPH            75360000
753700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              75370000
753800                                   TO DP013-MESSAGE-TEXT (1)      75380000
753900         MOVE 'TO DELETE A TADJRNL ROW'                           75390000
754000                                   TO DP013-MESSAGE-TEXT (2)      75400000
754100         MOVE SQLCA                TO DP013-SQLCA                 75410000
754200         MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)    75420000
754300         SET DP013-DB2-ABEND                                      75430000
754400             DP013-XCTL-DISPLAY-RESTART                           75440000
754500                                   TO TRUE                        75450000
754600         PERFORM DP013-0000-PROCESS-ABEND                         75460000
754700     END-IF.                                                      75470000
754800                                                                  75480000
754900     IF ASC-USE-SELECTION-QUEUE AND                               75490000
755000        ASC-NUMBER-OF-SELECTED-ITEMS GREATER THAN ZERO            75500000
755100        MOVE +1 TO ASC-SEL-ITEM                                   75510000
755200        PERFORM 5500-UPDATE-SELECTION-QUEUE                       75520000
755300     END-IF.                                                      75530000
755400                                                                  75540000
755500************************************************************      75550000
755600* THIS PARAGRAPH WILL PERFORM A DB2 DELETE OF THE TADJRNL  *      75560000
755700* TABLE WHEN AN ENTIRE OFFSET ADJUSTMENT IS DELETED.       *      75570000
755800************************************************************      75580000
755900 5301-DELETE-OFFSET-TADJRNL.                                      75590000
756000                                                                  75600000
756100     PERFORM                                                      75610000
756200        WITH TEST AFTER                                           75620000
756300         VARYING PV-RETRY-COUNTER                                 75630000
756400        FROM 1 BY 1                                               75640000
756500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               75650000
756600            OR (SQLCODE = +0))                                    75660000
756700                                                                  75670000
756800        EXEC SQL                                                  75680000
756900           DELETE FROM                                            75690000
757000              TADJRNL                                             75700000
757100              WHERE VND_NBR      = :ASC-KEY-VEND-NUMBER           75710000
757200              AND DOC_NBR        = :ASC-OFFSET-DOC-NUMBER         75720000
757300              AND DOC_DTE        = :ASC-KEY-DOC-DATE              75730000
757400              AND AP_TRN_CDE     = :ASC-OFFSET-TRAN-CD            75740000
757500        END-EXEC                                                  75750000
757600                                                                  75760000
757700        EVALUATE TRUE                                             75770000
757800             WHEN SQLCODE = +0                                    75780000
757900**  DELETE OF THE ORIGINATING AND OFFSET ADJUSTMENTS SUCCESSFUL.  75790000
758000              SET ASC-DELETE-SUCCESSFUL TO TRUE                   75800000
758100              MOVE PC-TSYMSG-03430 TO DP020-MSG-NUMBER            75810000
758200              SET DP020-MSG-INFORMATIONAL TO TRUE                 75820000
758300                                                                  75830000
758400             WHEN SQLCODE = -904                                  75840000
758500             WHEN SQLCODE = -913                                  75850000
758600                 CONTINUE                                         75860000
758700                                                                  75870000
758800             WHEN SQLWARN0 NOT = SPACES                           75880000
758900             WHEN SQLCODE < +0                                    75890000
759000             WHEN SQLCODE > +0                                    75900000
759100                 MOVE '5301-DELETE-OFFSET-TADJRNL'                75910000
759200                                   TO DP013-PARAGRAPH             75920000
759300                 MOVE 'DELETE A ROW ON TADJRNL'                   75930000
759400                                   TO DP013-MESSAGE-TEXT(1)       75940000
759500                 MOVE SQLCA        TO DP013-SQLCA                 75950000
759600                 MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1)    75960000
759700                 SET DP013-DB2-ABEND                              75970000
759800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           75980000
759900                 PERFORM DP013-0000-PROCESS-ABEND                 75990000
760000         END-EVALUATE                                             76000000
760100     END-PERFORM.                                                 76010000
760200                                                                  76020000
760300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        76030000
760400         MOVE '5301-DELETE-OFFSET-TADJRNL' TO DP013-PARAGRAPH     76040000
760500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              76050000
760600                                   TO DP013-MESSAGE-TEXT (1)      76060000
760700         MOVE 'TO DELETE A TADJRNL ROW'                           76070000
760800                                   TO DP013-MESSAGE-TEXT (2)      76080000
760900         MOVE SQLCA                TO DP013-SQLCA                 76090000
761000         MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)    76100000
761100         SET DP013-DB2-ABEND                                      76110000
761200             DP013-XCTL-DISPLAY-RESTART                           76120000
761300                                   TO TRUE                        76130000
761400         PERFORM DP013-0000-PROCESS-ABEND                         76140000
761500     END-IF.                                                      76150000
761600                                                                  76160000
761700******************************************************************76170000
761800* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *76180000
761900* OBJECT WAS UPDATED.                                            *76190000
762000******************************************************************76200000
762100 5500-UPDATE-SELECTION-QUEUE.                                     76210000
762200                                                                  76220000
762300      PERFORM 9100-READ-SEL-QUEUE.                                76230000
762400                                                                  76240000
762500      IF ASC-DELETE-SUCCESSFUL OR                                 76250000
762600         ASC-DELETE-REQUESTED                                     76260000
762700          SET AP362-DEL (ASC-SEL-SUB) TO TRUE                     76270000
762800      ELSE                                                        76280000
762900          SET AP362-UPD (ASC-SEL-SUB) TO TRUE                     76290000
763000      END-IF.                                                     76300000
763100                                                                  76310000
763200      PERFORM 9200-REWRITE-LIST-QUEUE.                            76320000
763300                                                                  76330000
763400******************************************************************76340000
763500* THIS PARAGRAPH WILL PERFORM A WRITE TO THE TEMPORARY STORAGE   *76350000
763600* QUEUE.                                                         *76360000
763700******************************************************************76370000
763800 5900-WRITE-TS-QUEUE.                                             76380000
763900                                                                  76390000
764000     MOVE EIBTRMID                 TO PV-SEL-TERM-ID.             76400000
764100     MOVE DP020-SRC-TASK-NUMBER    TO PV-SEL-TASK-NUMBER.         76410000
764200     MOVE PC-SEL-QUEUE-SEQ         TO PV-SEL-SEQ.                 76420000
764300*    MOVE PV-SEL-QUEUE-NAME        TO ASC-SEL-QUEUE-NAME          76430000
764400*                                     AP361-SEL-QUEUE-NAME.       76440000
764500     MOVE PV-SEL-QUEUE-NAME        TO ASC-TS-QUEUE-NAME           76450000
764600                                      AP361-TS-QUEUE-NAME.        76460000
764700                                                                  76470000
764800     EXEC CICS                                                    76480000
764900          WRITEQ TS                                               76490000
765000              QUEUE (ASC-TS-QUEUE-NAME)                           76500000
765100              FROM  (AP363-ADJUST-HEADER-AREA)                    76510000
765200              ITEM  (PC-SEL-QUEUE-ITEM)                           76520000
765300              RESP  (PV-CICS-RESPONSE)                            76530000
765400     END-EXEC.                                                    76540000
765500                                                                  76550000
765600     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       76560000
765700         CONTINUE                                                 76570000
765800     ELSE                                                         76580000
765900         SET DP013-CICS-ABEND      TO TRUE                        76590000
766000         SET DP013-NO-ROLLBACK     TO TRUE                        76600000
766100         MOVE '5900-WRITE-TS-QUEUE'                               76610000
766200                                   TO DP013-PARAGRAPH             76620000
766300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          76630000
766400                                   TO DP013-MESSAGE-TEXT(1)       76640000
766500         PERFORM DP013-0000-PROCESS-ABEND                         76650000
766600     END-IF.                                                      76660000
766700                                                                  76670000
766710******************************************************************76671052
766720*  SELECT DESCRPTION FROM APT_ACCT_TBL TABLE                     *76672052
766730******************************************************************76673052
766740 6000-SELECT-ACCT-NBR-DESC.                                       76674052
766750                                                                  76675052
766760     EXEC SQL                                                     76676052
766770         SELECT A.DESCR                                           76677052
766780           INTO :APT00002-DESCR                                   76678052
766791           FROM APT_ACCT_TBL      A                               76679152
766792          WHERE A.ACCOUNT = :PV-ACCT-NBR                          76679252
766793            AND A.EFF_STATUS = 'A'                                76679358
766794            AND A.EFFDT =                                         76679458
766795                (SELECT MAX(A1.EFFDT)                             76679558
766796                 FROM APT_ACCT_TBL      A1                        76679652
766797                 WHERE A1.ACCOUNT = A.ACCOUNT                     76679752
766798                 AND   A1.EFFDT  <= :PV-CURRENT-DATE)             76679852
766799     END-EXEC.                                                    76679952
766800                                                                  76680052
766801     EVALUATE TRUE                                                76680152
766802         WHEN SQLCODE = ZERO                                      76680252
766803              SET ASC-ACCT-FOUND  TO TRUE                         76680352
766804         WHEN SQLCODE = 100                                       76680452
766805             SET ASC-ACCT-NOT-FOUND     TO TRUE                   76680553
766806             DISPLAY 'ACCOUNT NUMBER NOT FOUND IN APT_ACCT_TBL'   76680653
766819         WHEN OTHER                                               76681952
766820             MOVE '6000-SELECT-ACCT-NBR-DESC'                     76682052
766821                               TO DP013-PARAGRAPH                 76682152
766822             MOVE 'SELECT APT_ACCT_TBL    '                       76682252
766823                               TO DP013-MESSAGE-TEXT (1)          76682352
766824             MOVE SQLCA        TO DP013-SQLCA                     76682452
766825             MOVE 'APT_ACCT_TBL'                                  76682552
766826                               TO DP013-DB2-TABLE-NAME (1)        76682652
766827             SET DP013-DB2-ABEND                                  76682752
766828                 DP013-XCTL-DISPLAY-RESTART                       76682852
766829                                     TO TRUE                      76682952
766830             PERFORM DP013-0000-PROCESS-ABEND                     76683052
766831     END-EVALUATE.                                                76683152
766832 EJECT                                                            76683252
766833                                                                  76683352
766840******************************************************************76684000
766900* THIS PARAGRAPH WILL MOVE THE POSTING DATA TO THE APPLICATION   *76690000
767000* SPECIFIC COMMAREA FIELDS AND EVALUATE THE MULTIPLE POSTING     *76700000
767100* PERIOD FLAG.                                                   *76710000
767200******************************************************************76720000
767300 7000-EVALUATE-MULT-PSTG.                                         76730000
767400                                                                  76740000
767500     PERFORM 7050-SELECT-TAPCNTL.                                 76750000
767600                                                                  76760000
767700     MOVE APCNTL-CURR-PSTG-FYR-NBR TO ASC-CURR-PSTG-FYR-NBR.      76770000
767800     MOVE APCNTL-CURR-PSTG-FMN-NBR TO ASC-CURR-PSTG-FMN-NBR.      76780000
767900     MOVE APCNTL-CURR-PSTG-FWK-NBR TO ASC-CURR-PSTG-FWK-NBR.      76790000
768000     MOVE APCNTL-PREV-PSTG-FYR-NBR TO ASC-PREV-PSTG-FYR-NBR.      76800000
768100     MOVE APCNTL-PREV-PSTG-FMN-NBR TO ASC-PREV-PSTG-FMN-NBR.      76810000
768200     MOVE APCNTL-PREV-PSTG-FWK-NBR TO ASC-PREV-PSTG-FWK-NBR.      76820000
768300                                                                  76830000
768400     IF APCNTL-MULT-PSTG-PER-IND = 'Y'                            76840000
768500        SET ASC-MULTI-PSTG-PERIOD TO TRUE                         76850000
768600     ELSE                                                         76860000
768700        SET ASC-NOT-MULTI-PSTG-PERIOD TO TRUE                     76870000
768800     END-IF.                                                      76880000
768900                                                                  76890000
769000******************************************************************76900000
769100* THIS PARAGRAPH WILL PERFORM A SELECT ON THE DB2 TAPCNTL TABLE  *76910000
769200* IN ORDER TO GET POSTING DATA FOR THE ADJUSTMENT JOURNAL.       *76920000
769300******************************************************************76930000
769400 7050-SELECT-TAPCNTL.                                             76940000
769500                                                                  76950000
769600     PERFORM                                                      76960000
769700        WITH TEST AFTER                                           76970000
769800         VARYING PV-RETRY-COUNTER                                 76980000
769900        FROM 1 BY 1                                               76990000
770000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               77000000
770100                  OR (SQLCODE = ZERO)                             77010000
770200                   OR (SQLCODE = +100))                           77020000
770300                                                                  77030000
770400     EXEC SQL                                                     77040000
770500         SELECT CURR_PSTG_FYR_NBR                                 77050000
770600               ,CURR_PSTG_FMN_NBR                                 77060000
770700               ,CURR_PSTG_FWK_NBR                                 77070000
770800               ,PREV_PSTG_FYR_NBR                                 77080000
770900               ,PREV_PSTG_FMN_NBR                                 77090000
771000               ,PREV_PSTG_FWK_NBR                                 77100000
771100               ,MULT_PSTG_PER_IND                                 77110000
771200         INTO   :APCNTL-CURR-PSTG-FYR-NBR                         77120000
771300               ,:APCNTL-CURR-PSTG-FMN-NBR                         77130000
771400               ,:APCNTL-CURR-PSTG-FWK-NBR                         77140000
771500               ,:APCNTL-PREV-PSTG-FYR-NBR                         77150000
771600               ,:APCNTL-PREV-PSTG-FMN-NBR                         77160000
771700               ,:APCNTL-PREV-PSTG-FWK-NBR                         77170000
771800               ,:APCNTL-MULT-PSTG-PER-IND                         77180000
771900         FROM   TAPCNTL                                           77190000
772000     END-EXEC                                                     77200000
772100                                                                  77210000
772200     EVALUATE TRUE                                                77220000
772300         WHEN SQLCODE = ZERO                                      77230000
772400             CONTINUE                                             77240000
772500         WHEN SQLCODE = +100                                      77250000
772600         WHEN SQLCODE = -904                                      77260000
772700         WHEN SQLCODE = -913                                      77270000
772800         WHEN SQLWARN0 NOT = SPACES                               77280000
772900         WHEN SQLCODE < ZERO                                      77290000
773000         WHEN SQLCODE > ZERO                                      77300000
773100             MOVE '7050-SELECT-TAPCNTL'                           77310000
773200                               TO DP013-PARAGRAPH                 77320000
773300             MOVE 'SELECT TAPCNTL         '                       77330000
773400                               TO DP013-MESSAGE-TEXT (1)          77340000
773500             MOVE SQLCA        TO DP013-SQLCA                     77350000
773600             MOVE 'TAPCNTL'    TO DP013-DB2-TABLE-NAME (1)        77360000
773700             SET DP013-DB2-ABEND                                  77370000
773800                 DP013-XCTL-DISPLAY-RESTART                       77380000
773900                                     TO TRUE                      77390000
774000             PERFORM DP013-0000-PROCESS-ABEND                     77400000
774100     END-EVALUATE                                                 77410000
774200     END-PERFORM.                                                 77420000
774300                                                                  77430000
774400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         77440000
774500         MOVE '7050-SELECT-TAPCNTL'                               77450000
774600                                   TO DP013-PARAGRAPH             77460000
774700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     77470000
774800                                   TO DP013-MESSAGE-TEXT (1)      77480000
774900         MOVE 'STORE        '  TO DP013-MESSAGE-TEXT (2)          77490000
775000         MOVE SQLCA            TO DP013-SQLCA                     77500000
775100         MOVE 'TAPCNTL'        TO DP013-DB2-TABLE-NAME (1)        77510000
775200         SET DP013-DB2-ABEND                                      77520000
775300             DP013-XCTL-DISPLAY-RESTART                           77530000
775400                                   TO TRUE                        77540000
775500         PERFORM DP013-0000-PROCESS-ABEND                         77550000
775600     END-IF.                                                      77560000
775700                                                                  77570000
775800******************************************************************77580000
775900* THIS PARAGRAPH VALIDATES THE STORE ENTERED IN THE HEADER       *77590000
776000* AND DETAIL PORTION OF THE SCREEN.                              *77600000
776100******************************************************************77610000
776200 7400-VALIDATE-STORE.                                             77620000
776300                                                                  77630000
776400     PERFORM                                                      77640000
776500         WITH TEST AFTER                                          77650000
776600         VARYING PV-RETRY-COUNTER                                 77660000
776700         FROM 1 BY 1                                              77670000
776800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               77680000
776900            OR (SQLCODE = +0)                                     77690000
777000            OR (SQLCODE = +100))                                  77700000
777100                                                                  77710000
777200         EXEC SQL                                                 77720000
777300           SELECT  LOC_NBR                                        77730000
777400                  ,LOC_TYP_CDE                                    77740000
777500            INTO   :XFT00017-LOC-NBR                              77750000
777600                  ,:XFT00017-LOC-TYP-CDE                          77760000
777700*           INTO   :XFT00003-LOC-NBR                              77770000
777800*                 ,:XFT00003-LOC-TYP-CDE                          77780000
777900             FROM  XFT_LOC                                        77790000
778000          WHERE LOC_NBR   = :XFT00017-LOC-NBR                     77800000
778100*         WHERE LOC_NBR   = :XFT00003-LOC-NBR                     77810000
778200          AND   LOC_TYP_CDE IN                                    77820000
778300                 ('DC', 'DS', 'CS', 'RV', 'HQ', 'AL', 'DA')       77830000
778400          AND CURRENT DATE <= FINCL_CLO_DTE                       77840000
778500         END-EXEC                                                 77850000
778600                                                                  77860000
778700         EVALUATE TRUE                                            77870000
778800             WHEN SQLCODE = +0                                    77880000
778900                 SET ASC-HD-STORE-FOUND        TO TRUE            77890000
779000             WHEN SQLCODE = -904                                  77900000
779100             WHEN SQLCODE = -913                                  77910000
779200                 CONTINUE                                         77920000
779300             WHEN SQLCODE = +100                                  77930000
779400                 SET ASC-HD-STORE-NOT-FOUND    TO TRUE            77940000
779500                                                                  77950000
779600             WHEN SQLWARN0 NOT = SPACES                           77960000
779700             WHEN SQLCODE < ZERO                                  77970000
779800             WHEN SQLCODE > ZERO                                  77980000
779900                 MOVE '7400-VALIDATE-STORE'                       77990000
780000                                   TO DP013-PARAGRAPH             78000000
780100*                MOVE 'SELECT ON XFT00003       '                 78010000
780200                 MOVE 'SELECT ON XFT00017       '                 78020000
780300                                   TO DP013-MESSAGE-TEXT (1)      78030000
780400                 MOVE SQLCA        TO DP013-SQLCA                 78040000
780500*                MOVE 'XFT00003'   TO DP013-DB2-TABLE-NAME (1)    78050000
780600                 MOVE 'XFT00017'   TO DP013-DB2-TABLE-NAME (1)    78060000
780700                 MOVE '       '    TO DP013-DB2-TABLE-NAME (2)    78070000
780800                 SET DP013-DB2-ABEND                              78080000
780900                     DP013-XCTL-DISPLAY-RESTART                   78090000
781000                                   TO TRUE                        78100000
781100                 PERFORM DP013-0000-PROCESS-ABEND                 78110000
781200         END-EVALUATE                                             78120000
781300     END-PERFORM.                                                 78130000
781400                                                                  78140000
781500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        78150000
781600         MOVE '7400-VALIDATE-STORE'                               78160000
781700                                   TO DP013-PARAGRAPH             78170000
781800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     78180000
781900                                   TO DP013-MESSAGE-TEXT (1)      78190000
782000         MOVE SQLCA                TO DP013-SQLCA                 78200000
782100*        MOVE 'XFT00003'           TO DP013-DB2-TABLE-NAME (1)    78210000
782200         MOVE 'XFT00017'           TO DP013-DB2-TABLE-NAME (1)    78220000
782300         MOVE '        '           TO DP013-DB2-TABLE-NAME (2)    78230000
782400         SET DP013-DB2-ABEND                                      78240000
782500             DP013-XCTL-DISPLAY-RESTART                           78250000
782600                                   TO TRUE                        78260000
782700         PERFORM DP013-0000-PROCESS-ABEND                         78270000
782800     END-IF.                                                      78280000
782900                                                                  78290000
783000******************************************************************78300000
783100* THIS PARAGRAPH WILL VALIDATE THE ENTERED PURCHASE ORDER NUMBER.*78310000
783200******************************************************************78320000
783300 7500-VALIDATE-PO.                                                78330000
783400                                                                  78340000
783500     PERFORM                                                      78350000
783600         WITH TEST AFTER                                          78360000
783700         VARYING PV-RETRY-COUNTER                                 78370000
783800         FROM 1 BY 1                                              78380000
783900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               78390000
784000            OR (SQLCODE = +0)                                     78400000
784100            OR (SQLCODE = +100))                                  78410000
784200                                                                  78420000
784300         EXEC SQL                                                 78430000
784400           SELECT  PO_NBR                                         78440000
784500                  ,PO_TYP_CDE                                     78450000
784600            INTO   :PURCHS-PO-NBR                                 78460000
784700                  ,:PURCHS-PO-TYP-CDE                             78470000
784800             FROM   TPURCHS                                       78480000
784900          WHERE PO_NBR       = :PURCHS-PO-NBR                     78490000
785000          AND VER_STATUS_CDE =  'A'                               78500000
785100         END-EXEC                                                 78510000
785200                                                                  78520000
785300         EVALUATE TRUE                                            78530000
785400             WHEN SQLCODE = +0                                    78540000
785500                 SET ASC-PO-FOUND              TO TRUE            78550000
785600             WHEN SQLCODE = -904                                  78560000
785700             WHEN SQLCODE = -913                                  78570000
785800                 CONTINUE                                         78580000
785900             WHEN SQLCODE = +100                                  78590000
786000                 SET ASC-PO-NOT-FOUND          TO TRUE            78600000
786100                                                                  78610000
786200             WHEN SQLWARN0 NOT = SPACES                           78620000
786300             WHEN SQLCODE < ZERO                                  78630000
786400             WHEN SQLCODE > ZERO                                  78640000
786500                 MOVE '7500-VALIDATE-PO   '                       78650000
786600                                   TO DP013-PARAGRAPH             78660000
786700                 MOVE 'SELECT ON TPURCHS        '                 78670000
786800                                   TO DP013-MESSAGE-TEXT (1)      78680000
786900                 MOVE SQLCA        TO DP013-SQLCA                 78690000
787000                 MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)    78700000
787100                 MOVE '       '    TO DP013-DB2-TABLE-NAME (2)    78710000
787200                 SET DP013-DB2-ABEND                              78720000
787300                     DP013-XCTL-DISPLAY-RESTART                   78730000
787400                                   TO TRUE                        78740000
787500                 PERFORM DP013-0000-PROCESS-ABEND                 78750000
787600         END-EVALUATE                                             78760000
787700     END-PERFORM.                                                 78770000
787800                                                                  78780000
787900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        78790000
788000         MOVE '7500-VALIDATE-PO   '                               78800000
788100                                   TO DP013-PARAGRAPH             78810000
788200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     78820000
788300                                   TO DP013-MESSAGE-TEXT (1)      78830000
788400         MOVE SQLCA                TO DP013-SQLCA                 78840000
788500         MOVE 'TPURCHS'            TO DP013-DB2-TABLE-NAME (1)    78850000
788600         MOVE '       '            TO DP013-DB2-TABLE-NAME (2)    78860000
788700         SET DP013-DB2-ABEND                                      78870000
788800             DP013-XCTL-DISPLAY-RESTART                           78880000
788900                                   TO TRUE                        78890000
789000         PERFORM DP013-0000-PROCESS-ABEND                         78900000
789100     END-IF.                                                      78910000
789200                                                                  78920000
789300******************************************************************78930000
789400* THIS PARAGRAPH WILL VALIDATE THE PURCHASE ORDER NUMBER IN      *78940000
789500* COMBINATION WITH THE VENDOR NUMBER IN UPDATE MODE ONLY.        *78950000
789600******************************************************************78960000
789700 7525-FOR-UPD-EDIT-VND-PO.                                        78970000
789800                                                                  78980000
789900     PERFORM                                                      78990000
790000         WITH TEST AFTER                                          79000000
790100         VARYING PV-RETRY-COUNTER                                 79010000
790200         FROM 1 BY 1                                              79020000
790300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               79030000
790400            OR (SQLCODE = +0)                                     79040000
790500            OR (SQLCODE = +100))                                  79050000
790600                                                                  79060000
790700         EXEC SQL                                                 79070000
790800           SELECT  PO_NBR                                         79080000
790900                  ,PO_TYP_CDE                                     79090000
791000            INTO   :PURCHS-PO-NBR                                 79100000
791100                  ,:PURCHS-PO-TYP-CDE                             79110000
791200             FROM   TPURCHS A                                     79120000
791300                   ,TEXTENT B                                     79130000
791400          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 79140000
791500          AND   A.VER_STATUS_CDE =  'A'                           79150000
791600          AND   B.DUN_NBR        = :EXTENT-DUN-NBR                79160000
791700          AND   B.ENT_ID         =  A.ENT_ID                      79170000
791800*         AND   B.STATUS_CDE     =  'A'                           79180000
791900         END-EXEC                                                 79190000
792000                                                                  79200000
792100         EVALUATE TRUE                                            79210000
792200             WHEN SQLCODE = +0                                    79220000
792300                 SET ASC-PO-VND-FOUND          TO TRUE            79230000
792400             WHEN SQLCODE = -904                                  79240000
792500             WHEN SQLCODE = -913                                  79250000
792600                 CONTINUE                                         79260000
792700             WHEN SQLCODE = +100                                  79270000
792800                 SET ASC-PO-VND-NOT-FOUND      TO TRUE            79280000
792900                                                                  79290000
793000             WHEN SQLWARN0 NOT = SPACES                           79300000
793100             WHEN SQLCODE < ZERO                                  79310000
793200             WHEN SQLCODE > ZERO                                  79320000
793300                 MOVE '7525-FOR-UPD-EDIT-V'                       79330000
793400                                   TO DP013-PARAGRAPH             79340000
793500                 MOVE 'SELECT ON TPURCHS        '                 79350000
793600                                   TO DP013-MESSAGE-TEXT (1)      79360000
793700                 MOVE SQLCA        TO DP013-SQLCA                 79370000
793800                 MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)    79380000
793900                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (2)    79390000
794000                 SET DP013-DB2-ABEND                              79400000
794100                     DP013-XCTL-DISPLAY-RESTART                   79410000
794200                                   TO TRUE                        79420000
794300                 PERFORM DP013-0000-PROCESS-ABEND                 79430000
794400         END-EVALUATE                                             79440000
794500     END-PERFORM.                                                 79450000
794600                                                                  79460000
794700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        79470000
794800         MOVE '7525-FOR-UPD-EDIT-V'                               79480000
794900                                   TO DP013-PARAGRAPH             79490000
795000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     79500000
795100                                   TO DP013-MESSAGE-TEXT (1)      79510000
795200         MOVE SQLCA                TO DP013-SQLCA                 79520000
795300         MOVE 'TPURCHS'            TO DP013-DB2-TABLE-NAME (1)    79530000
795400         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (2)    79540000
795500         SET DP013-DB2-ABEND                                      79550000
795600             DP013-XCTL-DISPLAY-RESTART                           79560000
795700                                   TO TRUE                        79570000
795800         PERFORM DP013-0000-PROCESS-ABEND                         79580000
795900     END-IF.                                                      79590000
796000                                                                  79600000
796100******************************************************************79610000
796200* THIS PARAGRAPH WILL VALIDATE THE ENTERED PURCHASE ORDER NUMBER *79620000
796300* WITH THE VENDOR.                                               *79630000
796400******************************************************************79640000
796500 7550-VALIDATE-PO-VENDOR.                                         79650000
796600                                                                  79660000
796700     PERFORM                                                      79670000
796800         WITH TEST AFTER                                          79680000
796900         VARYING PV-RETRY-COUNTER                                 79690000
797000         FROM 1 BY 1                                              79700000
797100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               79710000
797200            OR (SQLCODE = +0)                                     79720000
797300            OR (SQLCODE = +100))                                  79730000
797400                                                                  79740000
797500         EXEC SQL                                                 79750000
797600           SELECT  ENT_ID                                         79760000
797700            INTO   :PURCHS-ENT-ID                                 79770000
797800             FROM   TPURCHS                                       79780000
797900          WHERE PO_NBR       = :PURCHS-PO-NBR                     79790000
798000          AND VER_STATUS_CDE =  'A'                               79800000
798100          AND   ENT_ID       = :PURCHS-ENT-ID                     79810000
798200         END-EXEC                                                 79820000
798300                                                                  79830000
798400         EVALUATE TRUE                                            79840000
798500             WHEN SQLCODE = +0                                    79850000
798600                 SET ASC-PO-VND-FOUND          TO TRUE            79860000
798700             WHEN SQLCODE = -904                                  79870000
798800             WHEN SQLCODE = -913                                  79880000
798900                 CONTINUE                                         79890000
799000             WHEN SQLCODE = +100                                  79900000
799100                 SET ASC-PO-VND-NOT-FOUND      TO TRUE            79910000
799200                                                                  79920000
799300             WHEN SQLWARN0 NOT = SPACES                           79930000
799400             WHEN SQLCODE < ZERO                                  79940000
799500             WHEN SQLCODE > ZERO                                  79950000
799600                 MOVE '7550-VALIDATE-PO-VE'                       79960000
799700                                   TO DP013-PARAGRAPH             79970000
799800                 MOVE 'SELECT ON TPURCHS        '                 79980000
799900                                   TO DP013-MESSAGE-TEXT (1)      79990000
800000                 MOVE SQLCA        TO DP013-SQLCA                 80000000
800100                 MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)    80010000
800200                 MOVE '       '    TO DP013-DB2-TABLE-NAME (2)    80020000
800300                 SET DP013-DB2-ABEND                              80030000
800400                     DP013-XCTL-DISPLAY-RESTART                   80040000
800500                                   TO TRUE                        80050000
800600                 PERFORM DP013-0000-PROCESS-ABEND                 80060000
800700         END-EVALUATE                                             80070000
800800     END-PERFORM.                                                 80080000
800900                                                                  80090000
801000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        80100000
801100         MOVE '7550-VALIDATE-PO-VE'                               80110000
801200                                   TO DP013-PARAGRAPH             80120000
801300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     80130000
801400                                   TO DP013-MESSAGE-TEXT (1)      80140000
801500         MOVE SQLCA                TO DP013-SQLCA                 80150000
801600         MOVE 'TPURCHS'            TO DP013-DB2-TABLE-NAME (1)    80160000
801700         MOVE '       '            TO DP013-DB2-TABLE-NAME (2)    80170000
801800         SET DP013-DB2-ABEND                                      80180000
801900             DP013-XCTL-DISPLAY-RESTART                           80190000
802000                                   TO TRUE                        80200000
802100         PERFORM DP013-0000-PROCESS-ABEND                         80210000
802200     END-IF.                                                      80220000
802300                                                                  80230000
802400******************************************************************80240000
802500* THIS PARAGRAPH WILL PERFORM THE SUB CLASS VALIDATION AGAINST   *80250000
802600* THE DB2 TABLE TMDSEAR.                                         *80260000
802700******************************************************************80270000
802800 7600-VALIDATE-SUB-CLASS.                                         80280000
802900                                                                  80290000
803000     EXEC SQL                                                     80300000
803100       SELECT DEPT_NBR                                            80310000
803200             ,MAJ_CL_NBR                                          80320000
803300             ,SUB_CL_NBR                                          80330000
803400             ,MDSELV_CDE                                          80340000
803500        INTO :MDSEAR-DEPT-NBR                                     80350000
803600            ,:MDSEAR-MAJ-CL-NBR                                   80360000
803700            ,:MDSEAR-SUB-CL-NBR                                   80370000
803800            ,:MDSEAR-MDSELV-CDE                                   80380000
803900         FROM  TMDSEAR                                            80390000
804000      WHERE SUB_CL_NBR = :MDSEAR-SUB-CL-NBR                       80400000
804100      AND   DEPT_NBR   = :MDSEAR-DEPT-NBR                         80410000
804200      AND   MDSELV_CDE =  'SCL'                                   80420000
804300      AND   CURRENT DATE BETWEEN STRT_DTE AND END_DTE             80430000
804400     END-EXEC.                                                    80440000
804500                                                                  80450000
804600     EVALUATE TRUE                                                80460000
804700         WHEN SQLCODE = +0                                        80470000
804800             SET ASC-CLASS-FOUND               TO TRUE            80480000
804900         WHEN SQLCODE = -904                                      80490000
805000         WHEN SQLCODE = -913                                      80500000
805100             CONTINUE                                             80510000
805200         WHEN SQLCODE = +100                                      80520000
805300             SET ASC-CLASS-NOT-FOUND           TO TRUE            80530000
805400                                                                  80540000
805500         WHEN SQLWARN0 NOT = SPACES                               80550000
805600         WHEN SQLCODE < ZERO                                      80560000
805700         WHEN SQLCODE > ZERO                                      80570000
805800             MOVE '7600-VALIDATE-SUB-C'                           80580000
805900                               TO DP013-PARAGRAPH                 80590000
806000             MOVE 'SELECT ON TMDSEAR        '                     80600000
806100                               TO DP013-MESSAGE-TEXT (1)          80610000
806200             MOVE SQLCA            TO DP013-SQLCA                 80620000
806300             MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)    80630000
806400             MOVE '       '        TO DP013-DB2-TABLE-NAME (2)    80640000
806500             SET DP013-DB2-ABEND                                  80650000
806600                 DP013-XCTL-DISPLAY-RESTART                       80660000
806700                               TO TRUE                            80670000
806800             PERFORM DP013-0000-PROCESS-ABEND                     80680000
806900     END-EVALUATE.                                                80690000
807000                                                                  80700000
807100******************************************************************80710000
807200* THIS PARAGRAPH WILL VALIDATE THE ENTERED MAJOR CLASS AGAINST   *80720000
807300* THE TMDSEAR DB2 TABLE.                                         *80730000
807400******************************************************************80740000
807500 7700-VALIDATE-MAJ-CLASS.                                         80750000
807600                                                                  80760000
807700     EXEC SQL                                                     80770000
807800       SELECT DEPT_NBR                                            80780000
807900             ,MAJ_CL_NBR                                          80790000
808000             ,SUB_CL_NBR                                          80800000
808100             ,MDSELV_CDE                                          80810000
808200        INTO :MDSEAR-DEPT-NBR                                     80820000
808300            ,:MDSEAR-MAJ-CL-NBR                                   80830000
808400            ,:MDSEAR-SUB-CL-NBR                                   80840000
808500            ,:MDSEAR-MDSELV-CDE                                   80850000
808600         FROM  TMDSEAR                                            80860000
808700      WHERE MAJ_CL_NBR = :MDSEAR-MAJ-CL-NBR                       80870000
808800      AND   DEPT_NBR   = :MDSEAR-DEPT-NBR                         80880000
808900      AND   MDSELV_CDE =  'MCL'                                   80890000
809000      AND   CURRENT DATE BETWEEN STRT_DTE AND END_DTE             80900000
809100     END-EXEC.                                                    80910000
809200                                                                  80920000
809300     EVALUATE TRUE                                                80930000
809400         WHEN SQLCODE = +0                                        80940000
809500             SET ASC-CLASS-FOUND               TO TRUE            80950000
809600         WHEN SQLCODE = -904                                      80960000
809700         WHEN SQLCODE = -913                                      80970000
809800             CONTINUE                                             80980000
809900         WHEN SQLCODE = +100                                      80990000
810000             SET ASC-CLASS-NOT-FOUND           TO TRUE            81000000
810100                                                                  81010000
810200         WHEN SQLWARN0 NOT = SPACES                               81020000
810300         WHEN SQLCODE < ZERO                                      81030000
810400         WHEN SQLCODE > ZERO                                      81040000
810500             MOVE '7700-VALIDATE-MAJ-C'                           81050000
810600                               TO DP013-PARAGRAPH                 81060000
810700             MOVE 'SELECT ON TMDSEAR        '                     81070000
810800                               TO DP013-MESSAGE-TEXT (1)          81080000
810900             MOVE SQLCA            TO DP013-SQLCA                 81090000
811000             MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)    81100000
811100             MOVE '       '        TO DP013-DB2-TABLE-NAME (2)    81110000
811200             SET DP013-DB2-ABEND                                  81120000
811300                 DP013-XCTL-DISPLAY-RESTART                       81130000
811400                               TO TRUE                            81140000
811500             PERFORM DP013-0000-PROCESS-ABEND                     81150000
811600     END-EVALUATE.                                                81160000
811700                                                                  81170000
811800******************************************************************81180000
811900* THIS PARAGRAPH WILL VALIDATE THE SKU ENTERED.                  *81190000
812000******************************************************************81200000
812100 7800-VALIDATE-SKU.                                               81210000
812200                                                                  81220000
812300     EXEC SQL                                                     81230000
812400          SELECT '1'                                              81240000
812500            INTO :PV-ONE                                          81250000
812600            FROM SYSIBM.SYSDUMMY1 X                               81260000
812700           WHERE EXISTS (SELECT 1                                 81270000
812800                           FROM TSKXREF                           81280000
812900                          WHERE DEPT      = :SKXREF-DEPT          81290000
813000                            AND SUBCLASS  = :SKXREF-SUBCLASS      81300000
813100                            AND SKU       = :SKXREF-SKU           81310000
813200                            AND X.IBMREQD = X.IBMREQD)            81320000
813300     END-EXEC.                                                    81330000
813400                                                                  81340000
813500     EVALUATE TRUE                                                81350000
813600         WHEN SQLCODE = +0                                        81360000
813700             SET ASC-SKU-FOUND TO TRUE                            81370000
813800         WHEN SQLCODE = -904                                      81380000
813900         WHEN SQLCODE = -913                                      81390000
814000             CONTINUE                                             81400000
814100         WHEN SQLCODE = +100                                      81410000
814200             SET ASC-SKU-NOT-FOUND TO TRUE                        81420000
814300                                                                  81430000
814400         WHEN SQLWARN0 NOT = SPACES                               81440000
814500         WHEN SQLCODE < ZERO                                      81450000
814600         WHEN SQLCODE > ZERO                                      81460000
814700             MOVE '7800-VALIDATE-SKU  '                           81470000
814800                               TO DP013-PARAGRAPH                 81480000
814900             MOVE 'SELECT ON TSKXREF        '                     81490000
815000                               TO DP013-MESSAGE-TEXT (1)          81500000
815100             MOVE SQLCA            TO DP013-SQLCA                 81510000
815200             MOVE 'TSKXREF'        TO DP013-DB2-TABLE-NAME (1)    81520000
815300             MOVE '       '        TO DP013-DB2-TABLE-NAME (2)    81530000
815400             SET DP013-DB2-ABEND                                  81540000
815500                 DP013-XCTL-DISPLAY-RESTART                       81550000
815600                               TO TRUE                            81560000
815700             PERFORM DP013-0000-PROCESS-ABEND                     81570000
815800     END-EVALUATE.                                                81580000
815900                                                                  81590000
816000******************************************************************81600000
816100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *81610000
816200******************************************************************81620000
816300 9100-READ-SEL-QUEUE.                                             81630000
816400                                                                  81640000
816500     EXEC CICS                                                    81650000
816600         READQ TS                                                 81660000
816700             QUEUE (ASC-SEL-QUEUE-NAME)                           81670000
816800             INTO  (AP362-ADJUSTMENT-SEL-REC)                     81680000
816900             ITEM  (ASC-SEL-ITEM)                                 81690000
817000             RESP  (PV-CICS-RESPONSE)                             81700000
817100     END-EXEC.                                                    81710000
817200                                                                  81720000
817300     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   81730000
817400         CONTINUE                                                 81740000
817500     ELSE                                                         81750000
817600         SET DP013-LOGIC-ABEND                                    81760000
817700             DP013-NO-ROLLBACK     TO TRUE                        81770000
817800         MOVE '9100-READ-SEL-QUEUE'                               81780000
817900                                   TO DP013-PARAGRAPH             81790000
818000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   81800000
818100                                   TO DP013-MESSAGE-TEXT (1)      81810000
818200         PERFORM DP013-0000-PROCESS-ABEND                         81820000
818300     END-IF.                                                      81830000
818400                                                                  81840000
818500******************************************************************81850000
818600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *81860000
818700******************************************************************81870000
818800 9200-REWRITE-LIST-QUEUE.                                         81880000
818900                                                                  81890000
819000     EXEC CICS                                                    81900000
819100          WRITEQ TS                                               81910000
819200              QUEUE  (ASC-SEL-QUEUE-NAME)                         81920000
819300              FROM   (AP362-ADJUSTMENT-SEL-REC)                   81930000
819400              ITEM   (ASC-SEL-ITEM)                               81940000
819500              RESP   (PV-CICS-RESPONSE)                           81950000
819600              REWRITE                                             81960000
819700     END-EXEC.                                                    81970000
819800                                                                  81980000
819900     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               81990000
820000         SET DP013-CICS-ABEND                                     82000000
820100             DP013-NO-ROLLBACK     TO TRUE                        82010000
820200         MOVE '9200-REWRITE-LIST-QUEUE'                           82020000
820300                                   TO DP013-PARAGRAPH             82030000
820400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   82040000
820500                                   TO DP013-MESSAGE-TEXT (1)      82050000
820600         PERFORM DP013-0000-PROCESS-ABEND                         82060000
820700     END-IF.                                                      82070000
820800                                                                  82080000
820900                                                                  82090000
821000******************************************************************82100000
821100*    ABEND PROCESSOR MODULE                                      *82110000
821200******************************************************************82120000
821300                                                                  82130000
821400     COPY DPPD013.                                                82140000
