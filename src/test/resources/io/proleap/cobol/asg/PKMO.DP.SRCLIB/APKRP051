000100*-----------------------*                                         00010067
000200 IDENTIFICATION DIVISION.                                         00020067
000300*-----------------------*                                         00030067
000400 PROGRAM-ID.     APKRP051.                                        00040067
000500 AUTHOR.         JOYCE KNOKE  (TCC).                              00050067
000600 DATE-WRITTEN.   08/25/1997.                                      00060067
000700 DATE-COMPILED.                                                   00070067
000800*---------------------------------------------------------------* 00080067
000900*                                                               * 00090067
001000*          IMPORT PO'S WITHOUT RECEIVING REPORT                 * 00100067
001100*                                                               * 00110067
001200* THE PURPOSE OF THIS PROGRAM IS TO PRODUCE A REPORT OF IMPORT  * 00120067
001300* PO'S WHICH HAVE ACTUAL COST INVOICES, BUT A SPECIFIED AMOUNT  * 00130067
001400* OF TIME HAS PASSED AND THERE HAVE BEEN NO RECEIPTS. THE INPUT * 00140067
001500* WAS DETERMINED IN PROGRAM APKUT049.                           * 00150067
001600*---------------------------------------------------------------* 00160067
001700*                                                               * 00170067
001800* INPUT:                                                        * 00180067
001900*                                                               * 00190067
002000*  1. IMPORT-PO-REPORT-RECORDS                                  * 00200067
002100*                                                               * 00210067
002200* OUTPUT:                                                       * 00220067
002300*                                                               * 00230067
002400*  1. IMPORT PURCHASE ORDERS WITHOUT RECEIVING REPORT           * 00240067
002500*                                                               * 00250067
002600*---------------------------------------------------------------* 00260067
002700*   CHANGES:                                                    * 00270067
002800*                                                               * 00280067
002900*  08/26/98                                                     * 00290001
003000*    CHANGE LRECL FOR APRD031 FROM 150 TO 175.                  * 00300067
003100*  MADE BY:  CHRIS KUNSTMANN                  PITS/WR#:4164     * 00310001
003200*                                                               * 00320004
003300*---------------------------------------------------------------* 00330067
003400 EJECT                                                            00340067
003500                                                                  00350067
003600 ENVIRONMENT DIVISION.                                            00360067
003700 CONFIGURATION SECTION.                                           00370067
003800 SOURCE-COMPUTER.    IBM-3090.                                    00380067
003900 OBJECT-COMPUTER.    IBM-3090.                                    00390067
004000                                                                  00400067
004100*                                                                 00410067
004200 INPUT-OUTPUT SECTION.                                            00420067
004300 FILE-CONTROL.                                                    00430067
004400*                                                                 00440067
004500     SELECT IMPORT-REPORT-FILE   ASSIGN TO UT-S-INP01.            00450067
004600     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            00460067
004700                                                                  00470067
004800*                                                                 00480067
004900 DATA DIVISION.                                                   00490067
005000 FILE SECTION.                                                    00500067
005100*                                                                 00510067
005200 FD  IMPORT-REPORT-FILE                                           00520067
005300     RECORDING MODE IS F                                          00530067
005400     LABEL RECORDS ARE STANDARD                                   00540067
005500     BLOCK CONTAINS 0 RECORDS                                     00550067
005600     DATA RECORD IS IMPORT-REPORT-RECORD.                         00560067
005700 01  IMPORT-REPORT-RECORD             PIC X(175).                 00570067
005800*                                                                 00580067
005900 FD  REPORT-FILE                                                  00590067
006000     RECORDING MODE IS F                                          00600067
006100     LABEL RECORDS ARE STANDARD                                   00610067
006200     BLOCK CONTAINS 0 RECORDS                                     00620067
006300     DATA RECORD IS REPORT-RECORD.                                00630067
006400 01  REPORT-RECORD                    PIC X(132).                 00640067
006500*                                                                 00650067
006600 EJECT                                                            00660067
006700 WORKING-STORAGE SECTION.                                         00670067
006800                                                                  00680067
006900 01  PROGRAM-CONSTANTS.                                           00690067
007000     05  PC-PROGRAM-NAME         PIC  X(08)  VALUE 'APKRP051'.    00700067
007100     05  PC-TOTAL-DESC           PIC  X(19)  VALUE                00710067
007200         ' TOTALS FOR PO:'.                                       00720067
007300     05  PC-SLASH                PIC  X(01)  VALUE '/'.           00730067
007400                                                                  00740067
007500 01  PROGRAM-VARIABLES.                                           00750067
007600     05  PV-CURRENT-DATE.                                         00760067
007700         10  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         00770067
007800         10  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         00780067
007900         10  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         00790067
008000     05  PV-CURRENT-TIME.                                         00800067
008100         10  PV-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         00810067
008200         10  PV-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         00820067
008300         10  FILLER              PIC  9(02)  VALUE ZEROS.         00830067
008400     05  PV-INPUT-COUNTER        PIC  9(08)  VALUE ZEROS.         00840067
008500     05  PV-VENDOR-NBR           PIC  X(09)  VALUE SPACES.        00850067
008600     05  PV-PO-NBR               PIC  X(09)  VALUE SPACES.        00860067
008700     05  PV-CST-CDE              PIC  X(03)  VALUE SPACES.        00870067
008800     05  PV-ACTUAL-COST          PIC S9(12)V99 VALUE 0.           00880067
008900     05  PV-ESTIMATED-COST       PIC S9(12)V99 VALUE 0.           00890067
009000     05  PV-ESTIMATED-VARIANCE   PIC S9(12)V99 VALUE 0.           00900067
009100     05  PV-TOT-ACTUAL-COST          PIC S9(12)V99 VALUE 0.       00910067
009200     05  PV-TOT-ESTIMATED-COST       PIC S9(12)V99 VALUE 0.       00920067
009300     05  PV-TOT-ESTIMATED-VARIANCE   PIC S9(12)V99 VALUE 0.       00930067
009400     05  PV-PAGE-COUNT           PIC S9(05)  VALUE ZEROS          00940067
009500                                             COMP-3.              00950067
009600     05  PV-PO-COUNT             PIC S9(03)  VALUE ZEROS          00960067
009700                                             COMP-3.              00970067
009800     05  PV-INV-DATE             PIC  X(10).                      00980067
009900     05  FILLER   REDEFINES   PV-INV-DATE.                        00990067
010000         10  PV-INV-CCYY         PIC  X(4).                       01000067
010100         10  FILLER              PIC  X.                          01010067
010200         10  PV-INV-MM           PIC  X(2).                       01020067
010300         10  FILLER              PIC  X.                          01030067
010400         10  PV-INV-DD           PIC  X(2).                       01040067
010500                                                                  01050067
010600 01  PROGRAM-SWITCHES.                                            01060067
010700     05  PS-EOF-SW              PIC  X       VALUE 'N'.           01070067
010800         88  PS-IN-EOF                       VALUE 'Y'.           01080067
010900     05  PS-PPD-ELC-SW          PIC  X       VALUE 'N'.           01090067
011000         88  PS-1ST-PPD-ELC                  VALUE 'N'.           01100067
011100         88  PS-MORE-PPD-ELC                 VALUE 'Y'.           01110067
011200     05  PS-TOTALS-SW           PIC  X       VALUE 'N'.           01120067
011300         88  PS-PRINT-TOTALS                 VALUE 'Y'.           01130067
011400     05  PS-DESC-SW             PIC  X       VALUE 'N'.           01140067
011500         88  PS-DESC-NEEDED                  VALUE 'N'.           01150067
011600         88  PS-DESC-PRINTED                 VALUE 'Y'.           01160067
011700                                                                  01170067
011800 EJECT                                                            01180067
011900*----------------------------------------------------------------*01190067
012000*  INPUT RECORD LAYOUT                                            01200067
012100*----------------------------------------------------------------*01210067
012200     COPY APRD031.                                                01220067
012300*                                                                 01230067
012400 EJECT                                                            01240067
012500*----------------------------------------------------------------*01250067
012600*  STANDARD HEADER LAYOUT                                         01260067
012700*----------------------------------------------------------------*01270067
012800     COPY DPWS132O.                                               01280067
012900*                                                                 01290067
013000 EJECT                                                            01300067
013100*----------------------------------------------------------------*01310067
013200*  REPORT LAYOUT                                                  01320067
013300*----------------------------------------------------------------*01330067
013400 01  H2-HEADER2.                                                  01340067
013500     05  FILLER                  PIC   X(46) VALUE SPACES.        01350067
013600     05  FILLER                  PIC   X(40) VALUE                01360067
013700         'IMPORT PURCHASE ORDERS WITHOUT RECEIVING'.              01370067
013800     05  FILLER                  PIC   X(46) VALUE SPACES.        01380067
013900*                                                                 01390067
014000 01 SL-SUBHEADING-LINE1.                                          01400067
014100     05  FILLER                  PIC   X(14)                      01410067
014200                                        VALUE 'VENDOR NAME:  '.   01420067
014300     05  SL-VENDOR-NAME          PIC   X(30)   VALUE SPACES.      01430067
014400     05  FILLER                  PIC   X(04)   VALUE SPACES.      01440067
014500     05  FILLER                  PIC   X(15)                      01450067
014600                                        VALUE 'VENDOR NUMBER: '.  01460067
014700     05  SL-VENDOR-NBR           PIC   X(09)   VALUE SPACES.      01470067
014800     05  FILLER                  PIC   X(60)   VALUE SPACES.      01480067
014900*                                                                 01490067
015000 01 SL-SUBHEADING-LINE2.                                          01500067
015100     05  FILLER                  PIC   X(12)                      01510067
015200                                        VALUE ' PO NUMBER: '.     01520067
015300     05  SL-PO-NBR               PIC   X(09)   VALUE SPACES.      01530067
015400     05  FILLER                  PIC   X(07)   VALUE SPACES.      01540067
015500     05  FILLER                  PIC   X(14)                      01550067
015600                                        VALUE 'QTY ORDERED:'.     01560067
015700     05  SL-QTY-ORDERED          PIC   ZZZZZZZZ.                  01570067
015800     05  FILLER                  PIC   X(04)   VALUE SPACES.      01580067
015900     05  FILLER                  PIC   X(20)                      01590067
016000                                 VALUE 'ORDERED FIRST COST:'.     01600067
016100     05  SL-ORDERED-1ST-COST     PIC   $$,$$$,$$$,$$$.            01610067
016200     05  FILLER                  PIC   X(05)   VALUE SPACES.      01620067
016300     05  FILLER                  PIC   X(22)                      01630067
016400                                 VALUE 'TOTAL ORDERED ELC: '.     01640067
016500     05  SL-TOTAL-ORDERED-ELC    PIC   $$,$$$,$$$,$$$.            01650067
016600     05  FILLER                  PIC   X(06)   VALUE SPACES.      01660067
016700*                                                                 01670067
016800 01 SL-SUBHEADING-LINE3.                                          01680067
016900     05  FILLER                  PIC   X(16)                      01690067
017000                                        VALUE ' FIRST INVOICE: '. 01700067
017100     05  SL-1ST-INVOICE.                                          01710067
017200         10  SL-1ST-MM           PIC   X(02).                     01720067
017300         10  SL-SLASH1           PIC   X(01).                     01730067
017400         10  SL-1ST-DD           PIC   X(02).                     01740067
017500         10  SL-SLASH2           PIC   X(01).                     01750067
017600         10  SL-1ST-CCYY         PIC   X(04).                     01760067
017700     05  FILLER                  PIC   X(16)                      01770067
017800                                        VALUE '  QTY INVOICED: '. 01780067
017900     05  SL-QTY-INVOICED         PIC   ZZZZZZZZ.                  01790067
018000     05  FILLER                  PIC   X(04)   VALUE SPACES.      01800067
018100     05  FILLER                  PIC   X(20)                      01810067
018200                                 VALUE 'INVOICED 1ST COST:  '.    01820067
018300     05  SL-INVOICE-1ST-COST     PIC   $$,$$$,$$$,$$$.            01830067
018400     05  FILLER                  PIC   X(05)   VALUE SPACES.      01840067
018500     05  FILLER                  PIC   X(22)                      01850067
018600                                 VALUE 'ESTIMATED FIRST COST: '.  01860067
018700     05  SL-ESTIMATE-1ST-COST    PIC   $$,$$$,$$$,$$$.            01870067
018800     05  FILLER                  PIC   X(03)   VALUE SPACES.      01880067
018900*                                                                 01890067
019000 01 SL-SUBHEADING-LINE5.                                          01900067
019100     05  FILLER                  PIC   X(04)  VALUE SPACES.       01910067
019200     05  FILLER                  PIC   X(128) VALUE               01920067
019300         ' PREPAID AND ESTIMATED COSTS:'.                         01930067
019400*                                                                 01940067
019500 01  DH-DETAIL-HEADER1.                                           01950067
019600     05  FILLER                  PIC   X(06) VALUE SPACES.        01960067
019700     05  FILLER                  PIC   X(34) VALUE                01970067
019800         'COMPONENT DESCRIPTION'.                                 01980067
019900     05  FILLER                  PIC   X(23) VALUE                01990067
020000         'ACTUAL COST'.                                           02000067
020100     05  FILLER                  PIC   X(27) VALUE                02010067
020200         'ESTIMATED COST'.                                        02020067
020300     05  FILLER                  PIC   X(18) VALUE                02030067
020400         'ESTIMATED VARIANCE'.                                    02040067
020500     05  FILLER                  PIC   X(33) VALUE SPACES.        02050067
020600*                                                                 02060067
020700 01  DH-DETAIL-HEADER2.                                           02070067
020800     05  FILLER                  PIC   X(06) VALUE SPACES.        02080067
020900     05  FILLER                  PIC   X(31) VALUE                02090067
021000         '-----------------------'.                               02100067
021100     05  FILLER                  PIC   X(25) VALUE                02110067
021200         '----------------'.                                      02120067
021300     05  FILLER                  PIC   X(28) VALUE                02130067
021400         '----------------'.                                      02140067
021500     05  FILLER                  PIC   X(23) VALUE                02150067
021600         '------------------'.                                    02160067
021700     05  FILLER                  PIC   X(28) VALUE SPACES.        02170067
021800*                                                                 02180067
021900 01  DL-DETAIL-LINE.                                              02190067
022000     05  FILLER                  PIC   X(06)   VALUE SPACES.      02200067
022100     05  DL-DESC                 PIC   X(31)   VALUE SPACES.      02210067
022200     05  DL-ACTUAL-COST          PIC   -,---,---,--9.99.          02220067
022300     05  DL-ACT-COST-RPAREN      PIC   X       VALUE SPACES.      02230067
022400     05  FILLER                  PIC   X(08)   VALUE SPACES.      02240067
022500     05  DL-ESTIMATED-COST       PIC   -,---,---,--9.99.          02250067
022600     05  DL-EST-COST-RPAREN      PIC   X       VALUE SPACES.      02260067
022700     05  FILLER                  PIC   X(13)   VALUE SPACES.      02270067
022800     05  DL-ESTIMATED-VARIANCE   PIC   -,---,---,--9.99.          02280067
022900     05  DL-EST-VAR-RPAREN       PIC   X       VALUE SPACES.      02290067
023000*                                                                 02300067
023100 01  TL-TOTAL-LINE.                                               02310067
023200     05  FILLER                  PIC   X(35) VALUE SPACES.        02320067
023300     05  FILLER                  PIC   X(25) VALUE                02330067
023400         '------------------'.                                    02340067
023500     05  FILLER                  PIC   X(30) VALUE                02350067
023600         '------------------'.                                    02360067
023700     05  FILLER                  PIC   X(23) VALUE                02370067
023800         '------------------'.                                    02380067
023900*                                                                 02390067
024000 01  TL-TOTAL-LINE2.                                              02400067
024100     05  TL-TOTAL-DESC           PIC   X(35).                     02410067
024200     05  TL-ACTUAL-COST          PIC   ---,---,---,---.99.        02420067
024300     05  TL-ACT-COST-RPAREN      PIC   X(1).                      02430067
024400     05  FILLER                  PIC   X(6) VALUE SPACES.         02440067
024500     05  TL-ESTIMATED-COST       PIC   ---,---,---,---.99.        02450067
024600     05  TL-EST-COST-RPAREN      PIC   X(1).                      02460067
024700     05  FILLER                  PIC   X(11) VALUE SPACES.        02470067
024800     05  TL-ESTIMATED-VARIANCE   PIC   ---,---,---,---.99.        02480067
024900     05  TL-EST-VAR-RPAREN       PIC   X(1).                      02490067
025000*                                                                 02500067
025100 01  END-OF-REPORT.                                               02510067
025200     05  FILLER                  PIC  X(52)  VALUE SPACES.        02520067
025300     05  FILLER                  PIC  X(80)  VALUE                02530067
025400         '**********  END OF REPORT  **********'.                 02540067
025500*                                                                 02550067
025600 01  FILLER                      PIC  X(25)  VALUE                02560067
025700     '** END OF APKRP051 W/S **'.                                 02570067
025800 EJECT                                                            02580067
025900 PROCEDURE DIVISION.                                              02590067
026000                                                                  02600067
026100     PERFORM A100-MAINLINE.                                       02610067
026200     GOBACK.                                                      02620067
026300                                                                  02630067
026400 EJECT                                                            02640067
026500 A100-MAINLINE.                                                   02650067
026600                                                                  02660067
026700     PERFORM B100-INITIALIZE.                                     02670067
026800     PERFORM B200-PROCESS-IMPORT-FILE                             02680067
026900         UNTIL PS-IN-EOF.                                         02690067
027000     PERFORM B300-END-OF-PROGRAM.                                 02700067
027100                                                                  02710067
027200 EJECT                                                            02720067
027300*----------------------------------------------------------------*02730067
027400*    INITIALIZATION PROCESSING                                    02740067
027500*----------------------------------------------------------------*02750067
027600 B100-INITIALIZE.                                                 02760067
027700                                                                  02770067
027800     OPEN INPUT  IMPORT-REPORT-FILE                               02780067
027900          OUTPUT REPORT-FILE.                                     02790067
028000                                                                  02800067
028100     ACCEPT PV-CURRENT-DATE FROM DATE.                            02810067
028200     MOVE PV-CURRENT-MONTH            TO DP132O-RUN-MONTH.        02820067
028300     MOVE PV-CURRENT-DAY              TO DP132O-RUN-DAY.          02830067
028400     MOVE PV-CURRENT-YEAR             TO DP132O-RUN-YEAR.         02840067
028500                                                                  02850067
028600     ACCEPT PV-CURRENT-TIME FROM TIME.                            02860067
028700     MOVE PV-CURRENT-HOUR             TO DP132O-RUN-HOUR.         02870067
028800     MOVE PV-CURRENT-MINUTE           TO DP132O-RUN-MINUTE.       02880067
028900     MOVE PC-PROGRAM-NAME             TO DP132O-PROGRAM-NAME.     02890067
029000     MOVE 1                           TO DP132O-REPORT-NUMBER.    02900067
029100                                                                  02910067
029200     PERFORM R100-READ-INPUT.                                     02920067
029300     MOVE AP031-PO-NBR TO PV-PO-NBR.                              02930067
029400     INITIALIZE DL-DETAIL-LINE.                                   02940067
029500                                                                  02950067
029600 EJECT                                                            02960067
029700*----------------------------------------------------------------*02970067
029800*    THE INPUT FILE IS READ AND PROCESSED BY RECORD TYPE, WITHIN  02980067
029900*    PO AND VENDOR. TOTALS ARE PRINTED FOR EACH PO.               02990067
030000*----------------------------------------------------------------*03000067
030100 B200-PROCESS-IMPORT-FILE.                                        03010067
030200                                                                  03020067
030300     IF AP031-PO-NBR NOT = PV-PO-NBR                              03030067
030400         PERFORM W100-WRITE-OUTPUT                                03040067
030500         SET PS-DESC-NEEDED TO TRUE                               03050067
030600         PERFORM W600-PRINT-TOTALS                                03060067
030700         MOVE SPACES TO PV-CST-CDE                                03070067
030800         SET PS-1ST-PPD-ELC TO TRUE                               03080067
030900     END-IF.                                                      03090067
031000                                                                  03100067
031100     IF AP031-PO-INFO                                             03110067
031200         PERFORM C100-PROCESS-PO-INFO                             03120067
031300     END-IF.                                                      03130067
031400                                                                  03140067
031500     IF AP031-INV-TOT-INFO                                        03150067
031600         PERFORM C200-PROCESS-INV-INFO                            03160067
031700     END-IF.                                                      03170067
031800                                                                  03180067
031900     IF ((PV-CST-CDE = SPACES)                                    03190067
032000       AND (AP031-INV-INFO                                        03200067
032100         OR AP031-PPD-INFO                                        03210067
032200         OR AP031-ELC-INFO))                                      03220067
032300           MOVE AP031-IMPRT-CST-CDE TO PV-CST-CDE                 03230067
032400     END-IF.                                                      03240067
032500                                                                  03250067
032600     IF AP031-INV-INFO                                            03260067
032700       OR AP031-PPD-INFO                                          03270067
032800       OR AP031-ELC-INFO                                          03280067
032900         PERFORM C300-PROCESS-INVOICE-DETAIL                      03290067
033000     END-IF.                                                      03300067
033100                                                                  03310067
033200     PERFORM R100-READ-INPUT.                                     03320067
033300                                                                  03330067
033400 EJECT                                                            03340067
033500*----------------------------------------------------------------*03350067
033600*    END OF PROGRAM                                               03360067
033700*----------------------------------------------------------------*03370067
033800 B300-END-OF-PROGRAM.                                             03380067
033900                                                                  03390067
034000     PERFORM W100-WRITE-OUTPUT.                                   03400067
034100     PERFORM W600-PRINT-TOTALS.                                   03410067
034200                                                                  03420067
034300     WRITE REPORT-RECORD FROM END-OF-REPORT AFTER 2.              03430067
034400                                                                  03440067
034500     DISPLAY '** IMPORT RECORDS READ     = ' PV-INPUT-COUNTER.    03450067
034600     CLOSE IMPORT-REPORT-FILE                                     03460067
034700           REPORT-FILE.                                           03470067
034800                                                                  03480067
034900 EJECT                                                            03490067
035000*----------------------------------------------------------------*03500067
035100*    PROCESSING PO-INFO RECORD TYPES                              03510067
035200*      BREAK IN VENDOR NUMBER NEW PAGE AND HEADINGS ARE FORCED,   03520067
035300*      OTHERWISE JUST PO HEADINGS ARE PRINTED.                    03530067
035400*----------------------------------------------------------------*03540067
035500 C100-PROCESS-PO-INFO.                                            03550067
035600                                                                  03560067
035700     MOVE AP031-VENDOR-NBR             TO SL-VENDOR-NBR.          03570067
035800     MOVE AP031-VENDOR-NAME            TO SL-VENDOR-NAME.         03580067
035900                                                                  03590067
036000     MOVE AP031-PO-NBR                 TO SL-PO-NBR.              03600067
036100     MOVE AP031-TOTAL-QTY              TO SL-QTY-ORDERED.         03610067
036200     MOVE AP031-ACT-COST-AMT           TO SL-ORDERED-1ST-COST.    03620067
036300     MOVE AP031-EST-COST-AMT           TO SL-TOTAL-ORDERED-ELC.   03630067
036400                                                                  03640067
036500     IF AP031-VENDOR-NBR NOT = PV-VENDOR-NBR                      03650067
036600         MOVE AP031-VENDOR-NBR TO PV-VENDOR-NBR                   03660067
036700         MOVE AP031-PO-NBR TO PV-PO-NBR                           03670067
036800         MOVE 0 TO PV-PO-COUNT                                    03680067
036900         PERFORM W800-WRITE-HEADINGS                              03690067
037000         PERFORM W300-WRITE-VENDOR-SUBHEADING                     03700067
037100         PERFORM W400-WRITE-PO-SUBHEADING                         03710067
037200     ELSE                                                         03720067
037300       IF AP031-PO-NBR NOT = PV-PO-NBR                            03730067
037400         MOVE AP031-PO-NBR TO PV-PO-NBR                           03740067
037500         IF PV-PO-COUNT = 2                                       03750067
037600             MOVE 0 TO PV-PO-COUNT                                03760067
037700             PERFORM W800-WRITE-HEADINGS                          03770067
037800             PERFORM W300-WRITE-VENDOR-SUBHEADING                 03780067
037900         END-IF                                                   03790067
038000         PERFORM W400-WRITE-PO-SUBHEADING                         03800067
038100       END-IF                                                     03810067
038200     END-IF.                                                      03820067
038300                                                                  03830067
038400 EJECT                                                            03840067
038500*----------------------------------------------------------------*03850067
038600*    PROCESSING INV-INFO RECORD TYPES                             03860067
038700*      IF 1ST INVOICE FOR A PO, INVOICE DETAIL LINE IS PRINTED    03870067
038800*      OTHERWISE INVOICES ARE JUST LISTED.                        03880067
038900*----------------------------------------------------------------*03890067
039000 C200-PROCESS-INV-INFO.                                           03900067
039100                                                                  03910067
039200     MOVE AP031-IMPRT-RPT-DTE      TO PV-INV-DATE.                03920067
039300     MOVE PV-INV-MM                TO SL-1ST-MM.                  03930067
039400     MOVE PV-INV-DD                TO SL-1ST-DD.                  03940067
039500     MOVE PV-INV-CCYY              TO SL-1ST-CCYY.                03950067
039600     MOVE PC-SLASH                 TO SL-SLASH1                   03960067
039700                                      SL-SLASH2.                  03970067
039800     MOVE AP031-TOTAL-QTY          TO SL-QTY-INVOICED.            03980067
039900     MOVE AP031-ACT-COST-AMT       TO SL-INVOICE-1ST-COST.        03990067
040000     MOVE AP031-EST-COST-AMT       TO SL-ESTIMATE-1ST-COST.       04000067
040100                                                                  04010067
040200     PERFORM W500-WRITE-INVOICE-SUBHEADING.                       04020067
040300                                                                  04030067
040400 EJECT                                                            04040067
040500*----------------------------------------------------------------*04050067
040600*    PROCESSING PPD, ELC, AND ESTIMATE COST RECORDS               04060067
040700*      ONE DETAIL LINE IS PRINTED FOR EACH COST CODE, ALL         04070067
040800*      NEGATIVE COSTS ARE DISPLAY WITH LEFT AND RIGHT PAREN'S     04080067
040900*----------------------------------------------------------------*04090067
041000 C300-PROCESS-INVOICE-DETAIL.                                     04100067
041100                                                                  04110067
041200     IF PS-1ST-PPD-ELC                                            04120067
041300         PERFORM W200-WRITE-DETAIL-HEADINGS                       04130067
041400         SET PS-PRINT-TOTALS TO TRUE                              04140067
041500     END-IF.                                                      04150067
041600                                                                  04160067
041700     IF AP031-IMPRT-CST-CDE NOT = PV-CST-CDE                      04170067
041800         PERFORM W100-WRITE-OUTPUT                                04180067
041900         MOVE AP031-IMPRT-CST-CDE TO PV-CST-CDE                   04190067
042000         SET PS-DESC-NEEDED TO TRUE                               04200067
042100     END-IF.                                                      04210067
042200                                                                  04220067
042300     IF PS-DESC-NEEDED                                            04230067
042400         SET PS-DESC-PRINTED TO TRUE                              04240067
042500         MOVE AP031-IMPRT-CST-DESC (1:23)  TO DL-DESC             04250067
042600     END-IF.                                                      04260067
042700                                                                  04270067
042800     IF AP031-INV-INFO                                            04280067
042900       OR AP031-PPD-INFO                                          04290067
043000         ADD AP031-ACT-COST-AMT        TO PV-ACTUAL-COST          04300067
043100         MOVE PV-ACTUAL-COST           TO DL-ACTUAL-COST          04310067
043200         IF PV-ACTUAL-COST < ZERO                                 04320067
043300             INSPECT DL-ACTUAL-COST                               04330067
043400                 REPLACING ALL '-' BY '('                         04340067
043500             MOVE ')' TO DL-ACT-COST-RPAREN                       04350067
043600         ELSE                                                     04360067
043700             MOVE ' ' TO DL-ACT-COST-RPAREN                       04370067
043800         END-IF                                                   04380067
043900     END-IF.                                                      04390067
044000                                                                  04400067
044100     IF AP031-PPD-INFO                                            04410067
044200       OR AP031-ELC-INFO                                          04420067
044300         ADD AP031-EST-COST-AMT        TO PV-ESTIMATED-COST       04430067
044400         MOVE PV-ESTIMATED-COST        TO DL-ESTIMATED-COST       04440067
044500         IF PV-ESTIMATED-COST < ZERO                              04450067
044600             INSPECT DL-ESTIMATED-COST                            04460067
044700                 REPLACING ALL '-' BY '('                         04470067
044800             MOVE ')' TO DL-EST-COST-RPAREN                       04480067
044900         ELSE                                                     04490067
045000             MOVE ' ' TO DL-EST-COST-RPAREN                       04500067
045100         END-IF                                                   04510067
045200     END-IF.                                                      04520067
045300                                                                  04530067
045400     IF AP031-INV-INFO                                            04540067
045500       OR AP031-PPD-INFO                                          04550067
045600       OR AP031-ELC-INFO                                          04560067
045700         ADD AP031-VAR-COST-AMT        TO PV-ESTIMATED-VARIANCE   04570067
045800         MOVE PV-ESTIMATED-VARIANCE    TO DL-ESTIMATED-VARIANCE   04580067
045900         IF PV-ESTIMATED-VARIANCE < ZERO                          04590067
046000             INSPECT DL-ESTIMATED-VARIANCE                        04600067
046100                 REPLACING ALL '-' BY '('                         04610067
046200             MOVE ')' TO DL-EST-VAR-RPAREN                        04620067
046300         ELSE                                                     04630067
046400             MOVE ' ' TO DL-EST-VAR-RPAREN                        04640067
046500         END-IF                                                   04650067
046600     END-IF.                                                      04660067
046700                                                                  04670067
046800 EJECT                                                            04680067
046900*----------------------------------------------------------------*04690067
047000*    READ IMPORT INPUT FILE AND CHECK RECORD TYPE                 04700067
047100*----------------------------------------------------------------*04710067
047200 R100-READ-INPUT.                                                 04720067
047300                                                                  04730067
047400     READ IMPORT-REPORT-FILE INTO AP031-IMPORT-REPORT-FILE        04740067
047500         AT END                                                   04750067
047600             SET PS-IN-EOF TO TRUE.                               04760067
047700                                                                  04770067
047800     IF NOT AP031-NO-RCV-RPT                                      04780067
047900       SET PS-IN-EOF TO TRUE                                      04790067
048000       DISPLAY '** RECORD TYPE CODE NOT WITHOUT RECEIVING **'     04800067
048100       DISPLAY '      **** JOB CANCELLED  ***'                    04810067
048200     ELSE                                                         04820067
048300       ADD 1 TO PV-INPUT-COUNTER.                                 04830067
048400                                                                  04840067
048500 EJECT                                                            04850067
048600*----------------------------------------------------------------*04860067
048700*    WRITE COST DETAIL LINES AND ACCUM TOTALS BY PO               04870067
048800*----------------------------------------------------------------*04880067
048900 W100-WRITE-OUTPUT.                                               04890067
049000                                                                  04900067
049100     WRITE REPORT-RECORD FROM DL-DETAIL-LINE AFTER 1.             04910067
049200                                                                  04920067
049300     ADD PV-ACTUAL-COST        TO PV-TOT-ACTUAL-COST.             04930067
049400     ADD PV-ESTIMATED-COST     TO PV-TOT-ESTIMATED-COST.          04940067
049500     ADD PV-ESTIMATED-VARIANCE TO PV-TOT-ESTIMATED-VARIANCE.      04950067
049600                                                                  04960067
049700     INITIALIZE DL-DETAIL-LINE                                    04970067
049800                PV-ACTUAL-COST                                    04980067
049900                PV-ESTIMATED-COST                                 04990067
050000                PV-ESTIMATED-VARIANCE.                            05000067
050100                                                                  05010067
050200 EJECT                                                            05020067
050300*----------------------------------------------------------------*05030067
050400*    WRITES COST SUB-HEADING FOR COST DETAIL                      05040067
050500*----------------------------------------------------------------*05050067
050600 W200-WRITE-DETAIL-HEADINGS.                                      05060067
050700                                                                  05070067
050800     IF PS-1ST-PPD-ELC                                            05080067
050900         SET PS-MORE-PPD-ELC TO TRUE                              05090067
051000         WRITE REPORT-RECORD FROM SL-SUBHEADING-LINE5 AFTER 2     05100067
051100         WRITE REPORT-RECORD FROM DH-DETAIL-HEADER1 AFTER 2       05110067
051200         WRITE REPORT-RECORD FROM DH-DETAIL-HEADER2 AFTER 1       05120067
051300         MOVE SPACES TO REPORT-RECORD                             05130067
051400         WRITE REPORT-RECORD AFTER 1                              05140067
051500     ELSE                                                         05150067
051600         WRITE REPORT-RECORD FROM DL-DETAIL-LINE AFTER 1          05160067
051700         INITIALIZE DL-DETAIL-LINE                                05170067
051800     END-IF.                                                      05180067
051900                                                                  05190067
052000 EJECT                                                            05200067
052100*----------------------------------------------------------------*05210067
052200*    WRITES VENDOR SUBHEADING                                     05220067
052300*----------------------------------------------------------------*05230067
052400 W300-WRITE-VENDOR-SUBHEADING.                                    05240067
052500                                                                  05250067
052600     WRITE REPORT-RECORD FROM SL-SUBHEADING-LINE1 AFTER 3.        05260067
052700                                                                  05270067
052800 EJECT                                                            05280067
052900*----------------------------------------------------------------*05290067
053000*    WRITES PO SUBHEADING                                         05300067
053100*----------------------------------------------------------------*05310067
053200 W400-WRITE-PO-SUBHEADING.                                        05320067
053300                                                                  05330067
053400     WRITE REPORT-RECORD FROM SL-SUBHEADING-LINE2 AFTER 3.        05340067
053500     ADD 1  TO PV-PO-COUNT.                                       05350067
053600                                                                  05360067
053700 EJECT                                                            05370067
053800*----------------------------------------------------------------*05380067
053900*    WRITES INVOICE SUBHEADING                                    05390067
054000*----------------------------------------------------------------*05400067
054100 W500-WRITE-INVOICE-SUBHEADING.                                   05410067
054200                                                                  05420067
054300     WRITE REPORT-RECORD FROM SL-SUBHEADING-LINE3 AFTER 1.        05430067
054400                                                                  05440067
054500 EJECT                                                            05450067
054600*----------------------------------------------------------------*05460067
054700*    PRINTS PO TOTALS, NEGATIVE TOTAL COSTS ARE DISPLAYED WITH    05470067
054800*    LEFT AND RIGHT PAREN'S, AND ACCUMULATORS ARE CLEARED OUT     05480067
054900*----------------------------------------------------------------*05490067
055000 W600-PRINT-TOTALS.                                               05500067
055100                                                                  05510067
055200     WRITE REPORT-RECORD FROM TL-TOTAL-LINE AFTER 1.              05520067
055300     INITIALIZE TL-TOTAL-LINE2.                                   05530067
055400     MOVE PC-TOTAL-DESC TO TL-TOTAL-DESC.                         05540067
055500     MOVE PV-TOT-ACTUAL-COST TO TL-ACTUAL-COST.                   05550067
055600     IF PV-TOT-ACTUAL-COST < ZERO                                 05560067
055700         INSPECT TL-ACTUAL-COST                                   05570067
055800             REPLACING ALL '-' BY '('                             05580067
055900         MOVE ')' TO TL-ACT-COST-RPAREN                           05590067
056000     END-IF.                                                      05600067
056100     MOVE PV-TOT-ESTIMATED-COST TO TL-ESTIMATED-COST.             05610067
056200     IF PV-TOT-ESTIMATED-COST < ZERO                              05620067
056300         INSPECT TL-ESTIMATED-COST                                05630067
056400             REPLACING ALL '-' BY '('                             05640067
056500         MOVE ')' TO TL-EST-COST-RPAREN                           05650067
056600     END-IF.                                                      05660067
056700     MOVE PV-TOT-ESTIMATED-VARIANCE TO TL-ESTIMATED-VARIANCE.     05670067
056800     IF PV-TOT-ESTIMATED-VARIANCE < ZERO                          05680067
056900         INSPECT TL-ESTIMATED-VARIANCE                            05690067
057000             REPLACING ALL '-' BY '('                             05700067
057100         MOVE ')' TO TL-EST-VAR-RPAREN                            05710067
057200     END-IF.                                                      05720067
057300     WRITE REPORT-RECORD FROM TL-TOTAL-LINE2 AFTER 1.             05730067
057400     MOVE SPACES TO REPORT-RECORD.                                05740067
057500     WRITE REPORT-RECORD AFTER 3.                                 05750067
057600     MOVE ZEROS TO PV-TOT-ACTUAL-COST                             05760067
057700                   PV-TOT-ESTIMATED-COST                          05770067
057800                   PV-TOT-ESTIMATED-VARIANCE.                     05780067
057900                                                                  05790067
058000 EJECT                                                            05800067
058100*----------------------------------------------------------------*05810067
058200*    PRINTS STANDARD HEADER AND ADVANCES TO NEW-PAGE              05820067
058300*----------------------------------------------------------------*05830067
058400 W800-WRITE-HEADINGS.                                             05840067
058500                                                                  05850067
058600     ADD 1                            TO PV-PAGE-COUNT.           05860067
058700     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      05870067
058800                                                                  05880067
058900     WRITE REPORT-RECORD FROM                                     05890067
059000                   DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.     05900067
059100     WRITE REPORT-RECORD FROM H2-HEADER2 AFTER 1.                 05910067
