000100*-----------------------*                                         00010005
000200 IDENTIFICATION DIVISION.                                         00020005
000300*-----------------------*                                         00030005
000400 PROGRAM-ID.    PCKCS709.                                         00040005
000500 AUTHOR.        GERMAN BANDA.                                     00050005
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060005
000700 DATE-WRITTEN.  05-01-2001.                                       00070005
000800 DATE-COMPILED.                                                   00080005
000900*----------------------------------------------------------------*00090005
001000*    E709 - PC-PBS SMOOTHING CRIT SPEC                           *00100005
001100*                                                                *00110005
001200*    THIS PROGRAM ALLOWS THE USER TO KEY IN THE PO/RECEIVER      *00120005
001300*    (AND STORE NUMBER WHICH IS OPTIONAL) TO BUILD A LIST OF     *00130005
001400*    STORES FOR CREATING LABLES.                                 *00140005
001500*----------------------------------------------------------------*00150005
001510* DATE  11/04/2021                                                00151099
001520*            - CHANGE CALL OF 'DPKUT100' TO                     * 00152099
001530*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00153099
001540*              MAKING THE CALL DYNAMIC VS STATIC                * 00154099
001550*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00155099
001560*-----------------------------------------------------------------00156099
1122RM* DATE  11/07/2022                                              * 00157099
1122RM*            - ADD COPYBOOK DPWS930                             * 00158099
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00159099
1122RM*              DYNAMIC.                                         * 00159199
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00159299
1122RM*-----------------------------------------------------------------00159399
001600 ENVIRONMENT DIVISION.                                            00160005
001700 DATA DIVISION.                                                   00170005
001800                                                                  00180005
001900 WORKING-STORAGE SECTION.                                         00190005
002000*----------------------------------------------------------------*00200005
002100*   PROGRAM CONSTANTS                                            *00210005
002200*----------------------------------------------------------------*00220005
002300 01  PC-PROGRAM-CONSTANTS.                                        00230005
002400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'PC709A  '. 00240005
002500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'PCKM709 '. 00250005
002600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'PCKCS709'. 00260005
002700     05  PC-MAX-RETRIES            PIC S9(04)  VALUE  +2.         00270005
002800     05  PC-01                     PIC  X(02)  VALUE '01'.        00280005
002900     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00290005
003000     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'PCKCS126'.  00300008
003100     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00310099
003200     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00320005
003300     05  PC-A                           PIC  X(01)  VALUE 'A'.    00330005
003400     05  PC-F                           PIC  X(01)  VALUE 'F'.    00340005
003500     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 00350005
003600     05  PC-F17                    PIC  9(02)  VALUE  17.         00360099
003700     05  PC-F23                    PIC  9(02)  VALUE  23.         00370099
003800*                                                                 00380005
003900     05  PC-UCC128-EXISTS          PIC  X(25)  VALUE              00390076
004000                                   'UCC-128 DATA EXISTS      '.   00400076
004100*LMM                                                              00410099
004200     05  PC-LIST-QUEUE-SEQ         PIC 9       VALUE 1.           00420099
004300     05  PC-SEL-QUEUE-SEQ          PIC 9       VALUE 2.           00430099
004400     05  PC-INTER-APPL-CODES.                                     00440099
004500         10  PC-INTER-APPL-SU-PORCV    PIC X(01)   VALUE '3'.     00450099
004600                                                                  00460005
004700*----------------------------------------------------------------*00470005
004800*   PROGRAM VARIABLES                                            *00480005
004900*----------------------------------------------------------------*00490005
005000 01  PV-PROGRAM-VARIABLES.                                        00500005
005100     05  PV-OPER-FCLTY-HOLD.                                      00510005
005200         10  PV-OPER-UNT-HOLD      PIC  9(04)  VALUE ZEROES.      00520005
005300         10  FILLER                PIC  X(01)  VALUE '-'.         00530005
005400         10  PV-FCLTY-ID-HOLD      PIC  9(04)  VALUE ZEROES.      00540005
005500     05  PV-CURR-OPER-FCLTY-HOLD.                                 00550005
005600         10  PV-CURR-OPER-UNT-HOLD PIC  9(04)  VALUE ZEROES.      00560005
005700         10  FILLER                PIC  X(01)  VALUE '-'.         00570005
005800         10  PV-CURR-FCLTY-ID-HOLD PIC  9(04)  VALUE ZEROES.      00580005
005900     05  PV-RETRY-COUNT            PIC S9(04)  VALUE ZERO         00590005
006000                                   COMP SYNC.                     00600005
006100     05  PV-DB2-COUNT              PIC S9(09)   VALUE +0          00610030
006200                                               COMP-3.            00620030
006300     05  PV-TROUBLE-COUNT          PIC S9(09)  COMP.              00630099
006400     05  PV-DB2-COUNT-ACTV         PIC S9(09)  COMP.              00640099
006500     05  PV-FCLTY-NME              PIC  X(24)  VALUE SPACES.      00650005
006600     05  PV-PRTR-NME               PIC  X(30)  VALUE SPACES.      00660061
006700     05  PV-CICS-RESP              PIC S9(08)  VALUE ZEROES       00670005
006800                                   COMP SYNC.                     00680005
006900     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       00690005
007000                                   COMP SYNC.                     00700005
007100*                                                                 00710005
007200     05  PV-PO-NUMBER-HOLD         PIC S9(09)  COMP.              00720005
007300     05  PV-REC-SEQ-HOLD           PIC S9(09)  COMP.              00730005
007400     05  PV-OPER-UNT-ID-HOLD       PIC 9(04)   VALUE ZEROES.      00740071
007500*                                                                 00750005
007600     05  PV-SYSTEM-ID.                                            00760069
007700         10  FILLER                PIC  X(04)  VALUE SPACE.       00770069
007800         10  PV-REGION-IND         PIC  X(01).                    00780069
007900             88  PV-TEST-CICS                  VALUE 'T'.         00790069
008000             88  PV-QA-CICS                    VALUE 'Q'.         00800069
008100             88  PV-PROD-CICS                  VALUE 'P'.         00810069
008200             88  PV-LEARN-CICS                 VALUE 'L'.         00820069
008300         10  FILLER                PIC  X(03)  VALUE SPACE.       00830069
008400*                                                                 00840005
008500                                                                  00850005
008600     05  PV-UCC128-COUNT                PIC S9(09)  COMP.         00860005
008700                                                                  00870005
008800     05  PV-SHP-PRTR-CLUSTER-NBR        PIC S9(04)  VALUE ZERO.   00880005
008900     05  PV-SHP-PRTR-ID-ADDR            PIC  X(15)  VALUE SPACES. 00890005
009000     05  PV-SHP-PRTR-OS-RLSE-CDE        PIC  X(15)  VALUE SPACES. 00900005
009100     05  PV-SHP-DATA-XFER-MODE-ID       PIC  X(02)  VALUE SPACES. 00910005
009200     05  PV-SHP-XMIT-INTFC-CDE          PIC  X(01)  VALUE SPACE.  00920005
009300                                                                  00930005
009400*-----------------------------------------------------------------00940005
009500*                                                                 00950005
009600*-----------------------------------------------------------------00960005
009700 01  DK-DB2-KEYS.                                                 00970005
009800     05  DK-PO                          PIC S9(09)  COMP VALUE +0.00980005
009900     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP VALUE +0.00990005
010000     05  DK-CURR-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.01000005
010100     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.01010005
010200     05  DK-FCLTY-ID                    PIC S9(04)  COMP VALUE +0.01020005
010300     05  DK-PRINTER-ID                  PIC X(08)   VALUE SPACES. 01030063
010400                                                                  01040005
010500*----------------------------------------------------------------*01050005
010600*  SYSTEM MESSAGES                                               *01060005
010700*----------------------------------------------------------------*01070005
010800*   00007 = REQUIRED ENTRY                                        01080005
010900*   00008 = MUST BE NUMERIC                                       01090005
011000*   00057 = A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        01100099
011100*   00069 = TOP OF LIST                                           01110099
011200*   00070 = BOTTOM OF LIST                                        01120099
011300*   00746 = INVALID PRINTER DESTINATION                           01130005
011400*   00966 = INVALID FUNCTION FOR RECEIVER/RECEIPT ITEM STATUS     01140099
011500*   01732 = PO/RECEIVER NOT FOR THIS DC - F2 TO CONFIRM PROCESSING01150099
011600*   02634 = PO/RCVR ENTERED IS NOT A PACK-BY-STORE RECIEVER       01160099
011700*   02635 = PO/RCVR HAS CORRESPONDING UCC128 INFO, UNABLE TO PERFO01170099
011800*   02636 = TRANSCRIBED PACKSLIPS DO NOT EXIST FOR PO/RCVR        01180099
011900*   03362 = UNABLE TO SMOOTH AP TYPE RECEIVERS                    01190099
012000*----------------------------------------------------------------*01200005
012100 01  PC-TSYMSG-NUMBERS.                                           01210005
012200     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          01220068
012300     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          01230005
012400     05  PC-TSYMSG-00057       PIC  9(05)  VALUE  00057.          01240099
012500     05  PC-TSYMSG-00069       PIC  9(05)  VALUE  00069.          01250099
012600     05  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.          01260099
012700     05  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.          01270005
012800     05  PC-TSYMSG-00954       PIC  9(05)  VALUE  00954.          01280099
012900     05  PC-TSYMSG-00966       PIC  9(05)  VALUE  00966.          01290032
013000     05  PC-TSYMSG-01732       PIC  9(05)  VALUE  01732.          01300099
013100     05  PC-TSYMSG-01756       PIC  9(05)  VALUE  01756.          01310099
013200     05  PC-TSYMSG-02634       PIC  9(05)  VALUE  02634.          01320037
013300     05  PC-TSYMSG-02635       PIC  9(05)  VALUE  02635.          01330045
013400     05  PC-TSYMSG-02636       PIC  9(05)  VALUE  02636.          01340099
013500     05  PC-TSYMSG-03362       PIC  9(05)  VALUE  03362.          01350099
013600     05  PC-TSYMSG-03403       PIC  9(05)  VALUE  03403.          01360099
013700                                                                  01370005
013800                                                                  01380005
013900*----------------------------------------------------------------*01390005
014000*   SWITCHES                                                     *01400005
014100*----------------------------------------------------------------*01410005
014200 01  PS-PROGRAM-SWITCHES.                                         01420005
014300     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01430005
014400         88  PS-ERROR                          VALUE  'Y'.        01440005
014500         88  PS-NO-ERROR                       VALUE  'N'.        01450005
014600     05  PS-PRINTER-ERROR-SW       PIC  X(01)  VALUE  'N'.        01460005
014700         88  PS-PRINTER-ERROR                  VALUE  'Y'.        01470005
014800     05  PS-VALID-FUNC-RCVR-STATUS-SW   PIC  X(01)  VALUE  'Y'.   01480099
014900         88  PS-VALID-FUNC-RCVR-STATUS              VALUE  'Y'.   01490035
015000         88  PS-INVLD-FUNC-RCVR-STATUS              VALUE  'N'.   01500035
015100     05  PS-PRINTER-ID-ENTERED-SW       PIC  X(01)  VALUE  'N'.   01510061
015200         88  PS-PRINTER-ID-ENTERED                  VALUE  'Y'.   01520061
015300         88  PS-NO-PRINTER-ID-ENTERED               VALUE  'N'.   01530061
015400     05  PS-TRNSCRD-PKSLIPS-EXIST-SW    PIC  X(01)  VALUE  'N'.   01540093
015500         88  PS-TRNSCRD-PKSLIPS-EXIST               VALUE  'Y'.   01550093
015600         88  PS-NO-TRNSCRD-PKSLIPS-EXIST            VALUE  'N'.   01560093
015700                                                                  01570005
015800*----------------------------------------------------------------*01580005
015900*   PROGRAM MESSAGES                                             *01590005
016000*----------------------------------------------------------------*01600005
016100 01  PM-PROGRAM-MESSAGES.                                         01610005
016200     05  PM-ABEND-INFO-A.                                         01620005
016300         10  FILLER                PIC X(15)   VALUE              01630005
016400                                   'DP020-SRC-AID: '.             01640005
016500         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01650005
016600         10  FILLER                PIC X(19)   VALUE              01660005
016700                                   '. DP020-FK-ACTION: '.         01670005
016800         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01680005
016900         10  FILLER                PIC X(22)   VALUE              01690005
017000                                   '. DP020-FK-DISPN-IND: '.      01700005
017100         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01710005
017200         10  FILLER                PIC X(01)   VALUE '.'.         01720005
017300         10  FILLER                PIC X(19)   VALUE SPACE.       01730005
017400                                                                  01740005
017500                                                                  01750005
017600******************************************************************01760005
017700*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           01770005
017800******************************************************************01780005
017900     COPY RCWS013.                                                01790005
018000*LMM                                                              01800099
018100     COPY PCWS237.                                                01810099
018200                                                                  01820005
018300*----------------------------------------------------------------*01830005
018400*    MAP LAYOUT                                                  *01840005
018500*----------------------------------------------------------------*01850005
018600     COPY PCKM709.                                                01860012
018700                                                                  01870005
018800*----------------------------------------------------------------*01880005
018900*  SENDING/RECEIVING AREA FOR THE                                *01890005
019000*  PRINTER VALIDATION ROUTING (DPKCS060)                         *01900005
019100*----------------------------------------------------------------*01910005
019200     COPY DPWS072.                                                01920005
019300                                                                  01930005
019400*----------------------------------------------------------------*01940005
019500*    ATTRIBUTE SETTINGS COPYBOOK.                                *01950005
019600*----------------------------------------------------------------*01960005
019700     COPY DPWS015.                                                01970005
019800                                                                  01980005
019900*----------------------------------------------------------------*01990005
020000*    FUNCTION KEYS COPYBOOK                                      *02000005
020100*----------------------------------------------------------------*02010005
020200     COPY DPWS016.                                                02020005
020300                                                                  02030005
020400                                                                  02040005
020500*----------------------------------------------------------------*02050099
020600*    ABEND PROCESSING COPYBOOK.                                  *02060005
020700*----------------------------------------------------------------*02070005
020800     COPY DPWS013.                                                02080005
020900                                                                  02090005
021000*----------------------------------------------------------------*02100099
021100*    COPYBOOK FOR LOCATION CALL MODULE.                          *02110099
021200*----------------------------------------------------------------*02120099
021300     COPY XLWS071.                                                02130099
021400                                                                  02140099
021500*----------------------------------------------------------------*02150005
021600*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *02160005
021700*  SUB-ROUTINE (DPKUT100).                                       *02170005
021800*----------------------------------------------------------------*02180005
021900     COPY DPWS010I.                                               02190005
022000                                                                  02200005
022100*----------------------------------------------------------------*02210005
022200*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *02220005
022300*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *02230005
022400*----------------------------------------------------------------*02240005
022500     COPY DPWS030.                                                02250005
1122RM     COPY DPWS930.                                                02251099
022600                                                                  02260005
022700*----------------------------------------------------------------*02270005
022800*    STANDARD COMMAREA.                                          *02280005
022900*----------------------------------------------------------------*02290005
023000     COPY DPWS020.                                                02300005
023100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02310005
023200                                                                  02320005
023300*----------------------------------------------------------------*02330005
023400*    INTER-APPLICATION COMMAREA.                                 *02340005
023500*----------------------------------------------------------------*02350005
023600         10  INTER-APPL-COMM-AREA PIC X(200).                     02360005
023700     COPY PCWS201.                                                02370007
023800*LMM                                                              02380099
023900     COPY PCWS236.                                                02390099
024000                                                                  02400005
024100                                                                  02410005
024200*----------------------------------------------------------------*02420005
024300*    SPECIFIC COMMMAREA FOR PCKCS709.                            *02430005
024400*----------------------------------------------------------------*02440005
024500         10  ASC-SPECIFIC-COMMAREA.                               02450005
024600*LMM                                                              02460099
024700             15  ASC-SEL-SUB                 PIC S9(4) COMP.      02470099
024800             15  ASC-SEL-ITEM                PIC S9(4) COMP.      02480099
024900             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(9) COMP-3.   02490099
025000             15  ASC-NUMBER-OF-TS-ITEMS      PIC S9(5) COMP-3.    02500099
025100             15  ASC-LIST-QUEUE-NAME.                             02510099
025200                 20  ASC-LIST-TERM-ID        PIC X(4).            02520099
025300                 20  ASC-LIST-TASK-NUMBER    PIC S9(5) COMP-3.    02530099
025400                 20  ASC-LIST-SEQ            PIC 9.               02540099
025500             15  ASC-SEL-QUEUE-NAME-IN       PIC X(8).            02550099
025600             15  ASC-SEL-QUEUE-NAME-OUT.                          02560099
025700                 20  ASC-SEL-TERM-ID         PIC X(4).            02570099
025800                 20  ASC-SEL-TASK-NUMBER     PIC S9(5) COMP-3.    02580099
025900                 20  ASC-SEL-SEQ             PIC 9.               02590099
026000             15  ASC-INTER-APPL-CODE-IND     PIC X(01).           02600099
026100                 88  ASC-INTER-APPL-SU-PORCV     VALUE '3'.       02610099
026200             15  ASC-USE-SELECTION-QUEUE-IND PIC X(1).            02620099
026300                 88  ASC-USE-SELECTION-QUEUE     VALUE 'Y'.       02630099
026400                                                                  02640099
026500             15  ASC-PO-NBR                  PIC  X(09).          02650005
026600             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                02660005
026700                                             PIC  9(09).          02670005
026800                                                                  02680099
026900             15  ASC-REC-SEQ-NBR             PIC  X(09).          02690005
027000             15  ASC-REC-SEQ-NBR-N REDEFINES ASC-REC-SEQ-NBR      02700005
027100                                             PIC  9(09).          02710005
027200             15  ASC-STORE-NBR               PIC  X(09).          02720005
027300             15  ASC-STORE-NBR-N   REDEFINES ASC-STORE-NBR        02730011
027400                                             PIC  9(09).          02740005
027500             15  ASC-PRINTER-ID              PIC  X(09).          02750054
027600             15  ASC-PRINTER-ID-N  REDEFINES ASC-PRINTER-ID       02760054
027700                                             PIC  9(09).          02770054
027800             15  ASC-OPER-UNT-ID             PIC  X(04).          02780005
027900                 88  ASC-OPER-UNIT-CORP           VALUE '0090'.   02790005
028000             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      02800005
028100                                             PIC  9(04).          02810005
028200             15  ASC-FCLTY-ID                PIC  X(04).          02820005
028300             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            02830005
028400                                             PIC  9(04).          02840005
028500             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          02850005
028600             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 02860005
028700                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          02870005
028800             15  ASC-CURR-FCLTY-ID           PIC  X(04).          02880005
028900             15  ASC-CURR-FCLTY-ID-N REDEFINES                    02890005
029000                     ASC-CURR-FCLTY-ID       PIC  9(04).          02900005
029100             15  ASC-DFLT-STR-ZN-ID          PIC  X(05).          02910005
029200             15  ASC-PREV-CRE-LBL-OPT-SW     PIC  X(01).          02920009
029300                 88  ASC-PREV-CRE-LBL-OPT-Y             VALUE 'Y'.02930009
029400                 88  ASC-PREV-CRE-LBL-OPT-N             VALUE 'N'.02940009
029500             15  ASC-PACK-BY-ST-IND          PIC  X(01).          02950005
029600                 88  ASC-PACK-BY-ST-YES           VALUE  'Y'.     02960005
029700             15  ASC-UCC128-DATA-EXISTS-SW   PIC  X(1).           02970016
029800                 88  ASC-UCC128-DATA-EXISTS       VALUE  'Y'.     02980016
029900                 88  ASC-NO-UCC128-DATA-EXISTS    VALUE  'N'.     02990016
030000             15  ASC-RCVR-TROUBLE-EXISTS-SW  PIC  X(1).           03000099
030100                 88  ASC-RCVR-TROUBLE-EXISTS      VALUE  'Y'.     03010099
030200                 88  ASC-NO-RCVR-TROUBLE-EXISTS   VALUE  'N'.     03020099
030300             15  ASC-ACTV-SMTHNG-EXISTS-SW   PIC  X(1).           03030099
030400                 88  ASC-ACTV-SMTHNG-EXISTS       VALUE  'Y'.     03040099
030500                 88  ASC-NO-ACTV-SMTHNG-EXISTS    VALUE  'N'.     03050099
030600             15  ASC-CONFIRM-PROCESSING-SW   PIC  X(1).           03060099
030700                 88  ASC-CONFIRM-FUNC-01          VALUE  '1'.     03070099
030800                 88  ASC-CONFIRM-FUNC-02          VALUE  '2'.     03080099
030900                 88  ASC-CONFIRM-FUNC-NO          VALUE  'N'.     03090099
031000             15  FILLER                      PIC  X(26).          03100005
031100         10  ASC-HOLD-INTER-APPL             PIC X(200).          03110010
031200                                                                  03120005
031300                                                                  03130005
031400*-----------------------------------------------------------------03140005
031500*  SQL AND COBOL DECLARATIONS FOR THE RECEIVER TABLE (TRECEIV)    03150005
031600*-----------------------------------------------------------------03160005
031700     EXEC SQL                                                     03170005
031800          INCLUDE TRECEIV                                         03180005
031900     END-EXEC.                                                    03190005
032000                                                                  03200005
032100*-----------------------------------------------------------------03210005
032200*  SQL AND COBOL DECLARATIONS FOR THE RC-RECEIPT ITEM TABLE       03220005
032300*-----------------------------------------------------------------03230005
032400     EXEC SQL                                                     03240005
032500          INCLUDE TRECITM                                         03250005
032600     END-EXEC.                                                    03260005
032700                                                                  03270005
032800*---------------------------------------------------------------* 03280005
032900*      -PACK SLIP TABLE                                         * 03290005
033000*---------------------------------------------------------------* 03300005
033100     EXEC SQL                                                     03310005
033200          INCLUDE TPKSLIP                                         03320005
033300     END-EXEC.                                                    03330005
033400                                                                  03340005
033500*---------------------------------------------------------------* 03350005
033600*      -                                                        * 03360005
033700*---------------------------------------------------------------* 03370005
033800     EXEC SQL                                                     03380005
033900          INCLUDE TINPKSU                                         03390005
034000     END-EXEC.                                                    03400005
034100                                                                  03410005
034200*---------------------------------------------------------------* 03420099
034300*      -                                                        * 03430099
034400*---------------------------------------------------------------* 03440099
034500     EXEC SQL                                                     03450099
034600          INCLUDE TSHUUPC                                         03460099
034700     END-EXEC.                                                    03470099
034800                                                                  03480099
034900                                                                  03490099
035000*---------------------------------------------------------------* 03500005
035100*      - OTBND SHIPT UPC TABLE  (SUT_OTBND_UPC)                 * 03510099
035200*---------------------------------------------------------------* 03520005
035300     EXEC SQL                                                     03530005
035400          INCLUDE SUT00028                                        03540099
035500     END-EXEC.                                                    03550005
035600                                                                  03560005
035700                                                                  03570005
035800*---------------------------------------------------------------* 03580061
035900*---------------------------------------------------------------* 03590099
036000*      -  OTBND SHIPT UNIT TABLE  (SUT_OTBND_CART)              * 03600099
036100*---------------------------------------------------------------* 03610099
036200     EXEC SQL                                                     03620099
036300          INCLUDE SUT00024                                        03630099
036400     END-EXEC.                                                    03640099
036500                                                                  03650099
036600                                                                  03660099
036700*---------------------------------------------------------------* 03670099
036800*      -TROUBLE ID TABLE                                        * 03680099
036900*---------------------------------------------------------------* 03690061
037000     EXEC SQL                                                     03700061
037100          INCLUDE TPRTRID                                         03710061
037200     END-EXEC.                                                    03720061
037300*---------------------------------------------------------------* 03730099
037400*      -TROUBLE NOTIFICATION TABLE                              * 03740099
037500*---------------------------------------------------------------* 03750099
037600     EXEC SQL                                                     03760099
037700          INCLUDE TTRBNTF                                         03770099
037800     END-EXEC.                                                    03780099
037900                                                                  03790099
038000*---------------------------------------------------------------* 03800099
038100*      -TROUBLE REASON CODES TABLE                              * 03810099
038200*---------------------------------------------------------------* 03820099
038300     EXEC SQL                                                     03830099
038400          INCLUDE TTRBRSN                                         03840099
038500     END-EXEC.                                                    03850099
038600                                                                  03860099
038700*---------------------------------------------------------------* 03870099
038800*      -TROUBLE REASON CODES TABLE                              * 03880099
038900*---------------------------------------------------------------* 03890099
039000     EXEC SQL                                                     03900099
039100          INCLUDE TTRBRCN                                         03910099
039200     END-EXEC.                                                    03920099
039300                                                                  03930099
039400*-----------------------------------------------------------------03940099
039500*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                03950005
039600*-----------------------------------------------------------------03960005
039700     EXEC SQL                                                     03970005
039800          INCLUDE SQLCA                                           03980005
039900     END-EXEC.                                                    03990005
040000                                                                  04000005
040100*-----------------------------------------------------------------04010005
040200*-----------------------------------------------------------------04020005
040300 LINKAGE SECTION.                                                 04030005
040400                                                                  04040005
040500 01  DFHCOMMAREA.                                                 04050005
040600     05  FILLER                         OCCURS  1 TO 4072 TIMES   04060005
040700                                        DEPENDING ON EIBCALEN.    04070005
040800         10  FILLER                     PIC X.                    04080005
040900                                                                  04090005
041000                                                                  04100005
041100 PROCEDURE DIVISION.                                              04110005
041200*----------------------------------------------------------------*04120005
041300*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *04130005
041400*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *04140005
041500*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *04150005
041600*                                                                *04160005
041700*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *04170005
041800*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *04180005
041900*----------------------------------------------------------------*04190005
042000 0000-MAIN-MODULE.                                                04200005
042100     INITIALIZE DP030-CICS-API-FIELDS.                            04210005
042200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04220005
042300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04230005
042400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04240005
042500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04250005
042600     MOVE LENGTH OF PC709AI        TO DP030-MAP-LENGTH (1).       04260012
042700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04270005
042800     PERFORM 0001-CALL-CICS-ARCH-API.                             04280005
042900                                                                  04290005
043000     PERFORM 1000-CONTROL-PROCESSING                              04300005
043100                                                                  04310005
043200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04320005
043300     PERFORM 0001-CALL-CICS-ARCH-API.                             04330005
043400                                                                  04340005
043500                                                                  04350005
043600 0001-CALL-CICS-ARCH-API.                                         04360005
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               04370099
1122RM     CALL DP930-CICS-ARCH-API                                     04371099
1122RM                     USING DFHEIBLK                               04372099
043800                           DFHCOMMAREA                            04380005
043900                           DP030-CICS-API-FIELDS                  04390005
044000                           DP020-STANDARD-COMMAREA                04400005
044100                           PC709AI.                               04410012
044200*                                                                 04420005
044300     IF  DP030-RC-CALL-SUCCESSFUL                                 04430005
044400         CONTINUE                                                 04440005
044500     ELSE                                                         04450005
044600         SET DP013-NO-ROLLBACK                                    04460005
044700             DP013-XCTL-DISPLAY-RESTART                           04470005
044800             DP013-CICS-ABEND      TO TRUE                        04480005
044900         MOVE 'BEFORE 0000-MAIN-MODULE'                           04490005
045000                                   TO DP013-PARAGRAPH             04500005
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04510099
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04520099
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04521099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04522099
045300         MOVE DP030-RETURN-CODE                                   04530005
045400                                   TO DP013-MESSAGE-TEXT (3)      04540005
045500         PERFORM DP013-0000-PROCESS-ABEND                         04550005
045600     END-IF.                                                      04560005
045700                                                                  04570005
045800                                                                  04580005
045900*----------------------------------------------------------------*04590005
046000*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04600005
046100*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04610005
046200*----------------------------------------------------------------*04620005
046300 1000-CONTROL-PROCESSING.                                         04630005
046400                                                                  04640005
046500     EVALUATE TRUE                                                04650005
046600       WHEN DP020-NEXT-ACT-INITIAL                                04660005
046700           INITIALIZE ASC-SPECIFIC-COMMAREA                       04670099
046800           MOVE EIBTRMID              TO ASC-LIST-TERM-ID         04680099
046900                                         ASC-SEL-TERM-ID          04690099
047000           MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER     04700099
047100                                         ASC-SEL-TASK-NUMBER      04710099
047200           MOVE PC-LIST-QUEUE-SEQ     TO ASC-LIST-SEQ             04720099
047300           MOVE PC-SEL-QUEUE-SEQ      TO ASC-SEL-SEQ              04730099
047400           SET PS-NO-ERROR            TO TRUE                     04740099
047500           PERFORM 1100-PROCESS-INTER-APPL-COMM                   04750099
047600           IF PS-NO-ERROR                                         04760099
047700               MOVE INTER-APPL-COMM-AREA TO ASC-HOLD-INTER-APPL   04770099
047800               IF ASC-USE-SELECTION-QUEUE                         04780099
047900                   PERFORM 7000-BUILD-INITIAL-PANEL               04790099
048000                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             04800099
048100               ELSE                                               04810099
048200                   PERFORM 7000-BUILD-INITIAL-PANEL               04820099
048300               END-IF                                             04830099
048400           END-IF                                                 04840099
048500                                                                  04850099
048600       WHEN DP020-NEXT-ACT-RETURN                                 04860005
048700           MOVE ASC-PRINTER-ID     TO    MDEST1O                  04870099
048800           INITIALIZE                                             04880099
048900               ASC-PO-NBR                                         04890099
049000               ASC-REC-SEQ-NBR                                    04900099
049100               ASC-STORE-NBR                                      04910099
049200           PERFORM 7000-BUILD-INITIAL-PANEL                       04920099
049300                                                                  04930005
049400       WHEN DP020-NEXT-ACT-READ-MAP                               04940006
049500             PERFORM 2000-FKEY-PROCESSING                         04950005
049600                                                                  04960005
049700             MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID              04970005
049800             MOVE ASC-FCLTY-ID     TO DK-FCLTY-ID                 04980005
049900                                                                  04990005
050000             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 05000005
050100*            MOVE -1                   TO MPONBRL                 05010052
050200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05020005
050300                                                                  05030005
050400       WHEN OTHER                                                 05040006
050500             SET DP013-LOGIC-ABEND                                05050005
050600                 DP013-NO-ROLLBACK TO TRUE                        05060005
050700             MOVE '1000-CONTROL-PROCESSING'                       05070005
050800                                   TO  DP013-PARAGRAPH            05080005
050900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05090005
051000                                   TO  DP013-MESSAGE-TEXT(1)      05100005
051100             MOVE DP020-NEXT-APPL-ACTIVITY                        05110005
051200                                   TO DP013-MESSAGE-TEXT(2)       05120005
051300             PERFORM DP013-0000-PROCESS-ABEND                     05130005
051400     END-EVALUATE.                                                05140005
051500                                                                  05150099
051600*LMM                                                              05160099
051700 1100-PROCESS-INTER-APPL-COMM.                                    05170099
051800                                                                  05180099
051900     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND.   05190099
052000                                                                  05200099
052100     EVALUATE DP020-INT-APPL-FORMAT-IND                           05210099
052200                                                                  05220099
052300       WHEN PC-INTER-APPL-SU-PORCV                                05230099
052400           IF PC236-NUMBER-OF-SELECTED-ITEMS = ZERO               05240099
052500               SET DP020-MSG-FATAL                                05250099
052600                   DP020-NEXT-ACT-APPL-ERROR                      05260099
052700                   PS-ERROR          TO TRUE                      05270099
052800                   MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER      05280099
052900           ELSE                                                   05290099
053000               SET ASC-USE-SELECTION-QUEUE TO TRUE                05300099
053100               MOVE PC236-NUMBER-OF-SELECTED-ITEMS                05310099
053200                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 05320099
053300               MOVE PC236-NUMBER-OF-TS-ITEMS                      05330099
053400                                  TO ASC-NUMBER-OF-TS-ITEMS       05340099
053500               MOVE PC236-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN 05350099
053600               MOVE PC237-MAX-ITEMS      TO ASC-SEL-SUB           05360099
053700               MOVE ZEROES               TO ASC-SEL-ITEM          05370099
053800               PERFORM 1150-GET-NEXT-RECORD                       05380099
053900           END-IF                                                 05390099
054000     END-EVALUATE.                                                05400099
054100                                                                  05410099
054200*LMM                                                              05420099
054300******************************************************************05430099
054400* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *05440099
054500* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *05450099
054600******************************************************************05460099
054700 1150-GET-NEXT-RECORD.                                            05470099
054800                                                                  05480099
054900     ADD  +1 TO ASC-SEL-SUB.                                      05490099
055000                                                                  05500099
055100     IF ASC-SEL-SUB > PC237-MAX-ITEMS                             05510099
055200         ADD  +1 TO ASC-SEL-ITEM                                  05520099
055300         MOVE +1 TO ASC-SEL-SUB                                   05530099
055400     END-IF.                                                      05540099
055500                                                                  05550099
055600     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 05560099
055700         PERFORM 9100-READ-SEL-QUEUE                              05570099
055800         IF PC237-ITEM (ASC-SEL-SUB) > ZERO                       05580099
055900             MOVE PC237-PO-NBR (ASC-SEL-SUB)                      05590099
056000                  TO ASC-PO-NBR-N                                 05600099
056100                     DK-PO                                        05610099
056200                     MPONBRI                                      05620099
056300             MOVE PC237-REC-SEQ-NBR (ASC-SEL-SUB)                 05630099
056400                  TO ASC-REC-SEQ-NBR-N                            05640099
056500                     DK-REC-SEQ-NBR                               05650099
056600                     MRECVRI                                      05660099
056700             MOVE PC237-OPER-UNT-ID (ASC-SEL-SUB)                 05670099
056800                  TO ASC-OPER-UNT-ID-N                            05680099
056900                     DK-OPER-UNT-ID                               05690099
057000                     PV-OPER-UNT-HOLD                             05700099
057100             MOVE PC237-FCLTY-ID (ASC-SEL-SUB)                    05710099
057200                  TO ASC-FCLTY-ID-N                               05720099
057300                     DK-FCLTY-ID                                  05730099
057400                     PV-FCLTY-ID-HOLD                             05740099
057500             MOVE PV-OPER-FCLTY-HOLD                              05750099
057600                  TO MOPIDI                                       05760099
057700             SET PC237-INQ (ASC-SEL-SUB)                          05770099
057800                                   TO TRUE                        05780099
057900             PERFORM 9200-REWRITE-LIST-QUEUE                      05790099
058000         ELSE                                                     05800099
058100             SUBTRACT +1 FROM ASC-SEL-SUB                         05810099
058200*--- BOTTOM OF LIST ---                                           05820099
058300             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             05830099
058400             SET DP020-MSG-INFORMATIONAL TO TRUE                  05840099
058500         END-IF                                                   05850099
058600     ELSE                                                         05860099
058700         SUBTRACT +1               FROM ASC-SEL-ITEM              05870099
058800         MOVE PC237-MAX-ITEMS        TO ASC-SEL-SUB               05880099
058900         MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER          05890099
059000         SET DP020-MSG-INFORMATIONAL TO TRUE                      05900099
059100     END-IF.                                                      05910099
059200                                                                  05920099
059300*LMM                                                              05930099
059400******************************************************************05940099
059500* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *05950099
059600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *05960099
059700******************************************************************05970099
059800 1160-GET-PREV-RECORD.                                            05980099
059900                                                                  05990099
060000     SUBTRACT +1 FROM ASC-SEL-SUB.                                06000099
060100                                                                  06010099
060200     IF ASC-SEL-SUB < +1                                          06020099
060300         SUBTRACT +1 FROM ASC-SEL-ITEM                            06030099
060400         MOVE PC237-MAX-ITEMS TO ASC-SEL-SUB                      06040099
060500     END-IF.                                                      06050099
060600                                                                  06060099
060700     IF ASC-SEL-ITEM > ZERO                                       06070099
060800         PERFORM 9100-READ-SEL-QUEUE                              06080099
060900         MOVE PC237-PO-NBR (ASC-SEL-SUB)                          06090099
061000                  TO ASC-PO-NBR-N                                 06100099
061100                     DK-PO                                        06110099
061200         MOVE PC237-REC-SEQ-NBR (ASC-SEL-SUB)                     06120099
061300                  TO ASC-REC-SEQ-NBR-N                            06130099
061400                     DK-REC-SEQ-NBR                               06140099
061500         MOVE PC237-OPER-UNT-ID (ASC-SEL-SUB)                     06150099
061600                  TO ASC-OPER-UNT-ID-N                            06160099
061700                     DK-OPER-UNT-ID                               06170099
061800         MOVE PC237-FCLTY-ID (ASC-SEL-SUB)                        06180099
061900                  TO ASC-FCLTY-ID-N                               06190099
062000                     DK-FCLTY-ID                                  06200099
062100     ELSE                                                         06210099
062200         MOVE +1 TO ASC-SEL-ITEM                                  06220099
062300                    ASC-SEL-SUB                                   06230099
062400*--- TOP OF LIST ---                                              06240099
062500         MOVE PC-TSYMSG-00069        TO DP020-MSG-NUMBER          06250099
062600         SET DP020-MSG-INFORMATIONAL TO TRUE                      06260099
062700     END-IF.                                                      06270099
062800                                                                  06280099
062900******************************************************************06290005
063000*----------------------------------------------------------------*06300005
063100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06310005
063200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06320005
063300* EDITS.                                                         *06330005
063400*----------------------------------------------------------------*06340005
063500 2000-FKEY-PROCESSING.                                            06350005
063600                                                                  06360005
063700     EVALUATE TRUE                                                06370005
063800                                                                  06380005
063900         WHEN DP020-SRC-AID = DP016-CLEAR                         06390005
064000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06400005
064100             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 06410005
064200                                                                  06420005
064300         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06430005
064400             INITIALIZE ASC-SPECIFIC-COMMAREA                     06440005
064500             PERFORM 7000-BUILD-INITIAL-PANEL                     06450005
064600             PERFORM 3200-RESET-ATTRIBUTES                        06460005
064700                                                                  06470005
064800         WHEN OTHER                                               06480005
064900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06490005
065000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06500005
065100             IF  PS-NO-ERROR                                      06510005
065200                 SET DP030-CONTINUE-GO TO TRUE                    06520005
065300                 PERFORM 2100-CHECK-FUNCTION-KEY                  06530005
065400             ELSE                                                 06540005
065500                 SET DP030-OVERRIDE-GO TO TRUE                    06550005
065600             END-IF                                               06560005
065700     END-EVALUATE.                                                06570005
065800                                                                  06580005
065900                                                                  06590005
066000*----------------------------------------------------------------*06600005
066100*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *06610005
066200*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *06620005
066300*  FROM THE CICS ARCHITECTURE API.                               *06630005
066400*----------------------------------------------------------------*06640005
066500 2100-CHECK-FUNCTION-KEY.                                         06650005
066600                                                                  06660005
066700     EVALUATE TRUE                                                06670005
066800*************                                                     06680024
066900*F2 CONFIRM                                                       06690099
067000*************                                                     06700024
067100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    06710099
067200             IF ASC-CONFIRM-FUNC-01                               06720099
067300                 IF  ASC-STORE-NBR = SPACES OR ZEROES             06730099
067400                     INITIALIZE PC201-INTER-APPL-COMMAREA         06740099
067500                         SET PS-ERROR                             06750099
067600                            DP020-MSG-FATAL       TO TRUE         06760099
067700                     MOVE PC-TSYMSG-00007     TO DP020-MSG-NUMBER 06770099
067800                     MOVE DP015-UNP-ALP-BRT-OFF TO MSTRNBRA       06780099
067900                     MOVE DP015-RED            TO MSTRNBRC        06790099
068000                     MOVE DP015-REVERSE        TO MSTRNBRH        06800099
068100                     MOVE -1                   TO MSTRNBRL        06810099
068200                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          06820099
068300                     SET DP030-OVERRIDE-GO TO TRUE                06830099
068400                 ELSE                                             06840099
068500                     IF PS-VALID-FUNC-RCVR-STATUS                 06850099
068600                           PERFORM 2110-PREPARE-INTER-APPL-COMM   06860099
068700                     ELSE                                         06870099
068800                         IF PS-INVLD-FUNC-RCVR-STATUS             06880099
068900                             MOVE PC-TSYMSG-00966                 06890099
069000                                              TO DP020-MSG-NUMBER 06900099
069100                             INITIALIZE PC201-INTER-APPL-COMMAREA 06910099
069200                             SET PS-ERROR                         06920099
069300                                 DP020-MSG-FATAL       TO TRUE    06930099
069400                             MOVE DP015-UNP-ALP-BRT-OFF           06940099
069500                                                       TO MPONBRA 06950099
069600                                                          MRECVRA 06960099
069700                             MOVE DP015-RED            TO MPONBRC 06970099
069800                                                          MRECVRC 06980099
069900                             MOVE DP015-REVERSE        TO MPONBRH 06990099
070000                                                          MRECVRH 07000099
070100                             SET DP030-SET-CURSOR-APPL-1 TO TRUE  07010099
070200                             MOVE -1                   TO MPONBRL 07020099
070300                             SET DP030-OVERRIDE-GO TO TRUE        07030099
070400                         END-IF                                   07040099
070500                     END-IF                                       07050099
070600                 END-IF                                           07060099
070700             ELSE                                                 07070099
070800                 IF ASC-CONFIRM-FUNC-02                           07080099
070900                     IF  ASC-PRINTER-ID = SPACES OR ZEROES        07090099
071000                         INITIALIZE PC201-INTER-APPL-COMMAREA     07100099
071100                         SET PS-ERROR                             07110099
071200                             DP020-MSG-FATAL       TO TRUE        07120099
071300                         MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER 07130099
071400                         MOVE DP015-UNP-ALP-BRT-OFF TO MDEST1A    07140099
071500                         MOVE DP015-RED            TO MDEST1C     07150099
071600                         MOVE DP015-REVERSE        TO MDEST1H     07160099
071700                         MOVE -1                   TO MDEST1L     07170099
071800                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      07180099
071900                         SET DP030-OVERRIDE-GO TO TRUE            07190099
072000                     ELSE                                         07200099
072100                         PERFORM 3050-EDIT-SML-ID                 07210099
072200                         IF PS-NO-ERROR                           07220099
072300                             PERFORM 2110-PREPARE-INTER-APPL-COMM 07230099
072400                         END-IF                                   07240099
072500                     END-IF                                       07250099
072600                 END-IF                                           07260099
072700             END-IF                                               07270099
072800*************                                                     07280099
072900*F17 CTN LIST                                                     07290099
073000*************                                                     07300099
073100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              07310099
073200             SET ASC-CONFIRM-FUNC-01 TO TRUE                      07320099
073300             IF  ASC-STORE-NBR = SPACES OR ZEROES                 07330099
073400                 INITIALIZE PC201-INTER-APPL-COMMAREA             07340099
073500                     SET PS-ERROR                                 07350099
073600                        DP020-MSG-FATAL       TO TRUE             07360099
073700                 MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER    07370099
073800                 MOVE DP015-UNP-ALP-BRT-OFF TO MSTRNBRA           07380099
073900                 MOVE DP015-RED            TO MSTRNBRC            07390099
074000                 MOVE DP015-REVERSE        TO MSTRNBRH            07400099
074100                 MOVE -1                   TO MSTRNBRL            07410099
074200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07420099
074300                 SET DP030-OVERRIDE-GO TO TRUE                    07430099
074400             ELSE                                                 07440099
074500                 IF PS-VALID-FUNC-RCVR-STATUS                     07450099
074600                     PERFORM 2110-PREPARE-INTER-APPL-COMM         07460099
074700                 ELSE                                             07470099
074800                     IF PS-INVLD-FUNC-RCVR-STATUS                 07480099
074900                         MOVE PC-TSYMSG-00966 TO DP020-MSG-NUMBER 07490099
075000                         INITIALIZE PC201-INTER-APPL-COMMAREA     07500099
075100                         SET PS-ERROR                             07510099
075200                             DP020-MSG-FATAL       TO TRUE        07520099
075300                         MOVE DP015-UNP-ALP-BRT-OFF TO MPONBRA    07530099
075400                                                       MRECVRA    07540099
075500                         MOVE DP015-RED            TO MPONBRC     07550099
075600                                                      MRECVRC     07560099
075700                         MOVE DP015-REVERSE        TO MPONBRH     07570099
075800                                                      MRECVRH     07580099
075900                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      07590099
076000                         MOVE -1                   TO MPONBRL     07600099
076100                         SET DP030-OVERRIDE-GO TO TRUE            07610099
076200                     END-IF                                       07620099
076300                 END-IF                                           07630099
076400             END-IF                                               07640099
076500*************                                                     07650099
076600*F23 STORLIST                                                     07660005
076700*************                                                     07670005
076800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              07680005
076900             SET ASC-CONFIRM-FUNC-02 TO TRUE                      07690099
077000             IF  ASC-PRINTER-ID = SPACES OR ZEROES                07700099
077100                 INITIALIZE PC201-INTER-APPL-COMMAREA             07710099
077200                 SET PS-ERROR                                     07720053
077300                     DP020-MSG-FATAL       TO TRUE                07730053
077400                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         07740099
077500                 MOVE DP015-UNP-ALP-BRT-OFF TO MDEST1A            07750099
077600                 MOVE DP015-RED            TO MDEST1C             07760099
077700                 MOVE DP015-REVERSE        TO MDEST1H             07770099
077800                 MOVE -1                   TO MDEST1L             07780099
077900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07790099
078000                 SET DP030-OVERRIDE-GO TO TRUE                    07800099
078100             ELSE                                                 07810099
078200                 PERFORM 3050-EDIT-SML-ID                         07820099
078300                 IF PS-NO-ERROR                                   07830099
078400                    PERFORM 2110-PREPARE-INTER-APPL-COMM          07840099
078500                 END-IF                                           07850099
078600             END-IF                                               07860099
078700                                                                  07870056
078800         WHEN DP020-SRC-AID = DP016-ENTER                         07880023
078900             CONTINUE                                             07890023
079000                                                                  07900099
079100*LMM                                                              07910099
079200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07920099
079300             IF ASC-USE-SELECTION-QUEUE                           07930099
079400                 PERFORM 6200-DEL-LIST-QUEUE                      07940099
079500                 PERFORM 1150-GET-NEXT-RECORD                     07950099
079600                 PERFORM 7000-BUILD-INITIAL-PANEL                 07960099
079700                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               07970099
079800             ELSE                                                 07980099
079900*                --- BOTTOM OF LIST ---                           07990099
080000                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         08000099
080100                 SET DP020-MSG-INFORMATIONAL TO TRUE              08010099
080200             END-IF                                               08020099
080300                                                                  08030099
080400*LMM                                                              08040099
080500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08050099
080600             IF ASC-USE-SELECTION-QUEUE                           08060099
080700                 PERFORM 6200-DEL-LIST-QUEUE                      08070099
080800                 PERFORM 1160-GET-PREV-RECORD                     08080099
080900                 PERFORM 7000-BUILD-INITIAL-PANEL                 08090099
081000                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               08100099
081100             ELSE                                                 08110099
081200*                --- TOP OF LIST ---                              08120099
081300                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         08130099
081400                 SET DP020-MSG-INFORMATIONAL TO TRUE              08140099
081500             END-IF                                               08150099
081600                                                                  08160099
081700         WHEN OTHER                                               08170005
081800             SET DP013-NO-ROLLBACK                                08180005
081900                 DP013-XCTL-DISPLAY-RESTART                       08190005
082000                 DP013-CICS-ABEND  TO TRUE                        08200005
082100             MOVE '2100-CHECK-FUNCTION-KEY'                       08210005
082200                                   TO DP013-PARAGRAPH             08220005
082300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08230005
082400                                   TO DP013-MESSAGE-TEXT (1)      08240005
082500             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 08250005
082600                                   TO DP013-MESSAGE-TEXT (2)      08260005
082700             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                08270005
082800             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 08280005
082900                                   TO PM-A-FK-ACTION              08290005
083000             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              08300005
083100                                   TO PM-A-FK-DISPN               08310005
083200             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      08320005
083300             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        08330005
083400                                   TO DP013-MESSAGE-TEXT (4)      08340005
083500             PERFORM DP013-0000-PROCESS-ABEND                     08350005
083600     END-EVALUATE.                                                08360005
083700                                                                  08370005
083800                                                                  08380005
083900*----------------------------------------------------------------*08390005
084000*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *08400005
084100*  INTER-APPLICATION COMMAREA.                                   *08410005
084200*----------------------------------------------------------------*08420005
084300 2110-PREPARE-INTER-APPL-COMM.                                    08430005
084400                                                                  08440005
084500     INITIALIZE PC201-INTER-APPL-COMMAREA.                        08450005
084600                                                                  08460005
084700     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR                08470099
084800         (DP020-FK-CONFIRM (DP020-SRC-AID) AND                    08480099
084900                ASC-CONFIRM-FUNC-01)                              08490099
085000             MOVE PC-F17               TO DP020-SRC-AID           08500099
085100             MOVE ASC-PO-NBR-N         TO PC201-PO-NBR            08510005
085200             MOVE ASC-REC-SEQ-NBR-N    TO PC201-REC-SEQ-NBR       08520005
085300             MOVE ASC-OPER-UNT-ID-N    TO PC201-OPER-UNT-ID       08530005
085400             MOVE ASC-FCLTY-ID-N       TO PC201-FCLTY-ID          08540005
085500             MOVE ASC-STORE-NBR-N      TO PC201-STR-NUMBER        08550089
085600             MOVE ASC-PRINTER-ID       TO PC201-SML-PRTR-ID       08560088
085700             IF ASC-RCVR-TROUBLE-EXISTS                           08570099
085800                 SET PC201-RECEIVER-TROUBLE-YES TO TRUE           08580099
085900             END-IF                                               08590099
086000     ELSE                                                         08600005
086100     IF  DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR                08610099
086200         (DP020-FK-CONFIRM (DP020-SRC-AID) AND                    08620099
086300                ASC-CONFIRM-FUNC-02)                              08630099
086400             MOVE PC-F23               TO DP020-SRC-AID           08640099
086500             MOVE RECEIV-OPER-UNT-ID   TO PC201-OPER-UNT-ID       08650006
086600             MOVE ASC-FCLTY-ID-N       TO PC201-FCLTY-ID          08660006
086700             MOVE ASC-PO-NBR-N         TO PC201-PO-NBR            08670006
086800             MOVE ASC-REC-SEQ-NBR-N    TO PC201-REC-SEQ-NBR       08680006
086900             MOVE ASC-PRINTER-ID       TO PC201-SML-PRTR-ID       08690073
087000             IF ASC-UCC128-DATA-EXISTS                            08700079
087100                  MOVE 'Y'             TO PC201-UCC128-DATA-IND   08710080
087200             END-IF                                               08720079
087300             IF ASC-RCVR-TROUBLE-EXISTS                           08730099
087400                 SET PC201-RECEIVER-TROUBLE-YES TO TRUE           08740099
087500             END-IF                                               08750099
087600     END-IF.                                                      08760005
087700                                                                  08770005
087800                                                                  08780005
087900*----------------------------------------------------------------*08790005
088000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*08800005
088100* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *08810005
088200* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *08820005
088300*----------------------------------------------------------------*08830005
088400 2200-MOVE-SCREEN-TO-COMMAREA.                                    08840005
088500                                                                  08850005
088600* OPERATING UNIT ID / FACILITY                                    08860005
088700     IF  MOPIDL > ZERO                                            08870005
088800         MOVE MOPIDI               TO PV-OPER-FCLTY-HOLD          08880005
088900         MOVE PV-OPER-UNT-HOLD     TO ASC-OPER-UNT-ID             08890005
089000         MOVE PV-FCLTY-ID-HOLD     TO ASC-FCLTY-ID                08900005
089100     ELSE                                                         08910005
089200         MOVE ZEROES               TO ASC-OPER-UNT-ID             08920005
089300                                      ASC-FCLTY-ID                08930005
089400     END-IF.                                                      08940005
089500                                                                  08950005
089600* PURCHASE ORDER NUMBER                                           08960005
089700     IF  MPONBRL > ZERO                                           08970005
089800         MOVE MPONBRI              TO ASC-PO-NBR                  08980005
089900     ELSE                                                         08990005
090000         IF  MPONBRF = DP015-ERASE-EOF                            09000005
090100             MOVE ZEROES           TO ASC-PO-NBR                  09010005
090200         END-IF                                                   09020005
090300     END-IF.                                                      09030005
090400                                                                  09040005
090500* RECEIVER SEQUENCE NUMBER                                        09050005
090600     IF  MRECVRL > ZERO                                           09060005
090700         MOVE MRECVRI              TO ASC-REC-SEQ-NBR             09070005
090800     ELSE                                                         09080005
090900         IF  MRECVRF = DP015-ERASE-EOF                            09090005
091000             MOVE ZEROES           TO ASC-REC-SEQ-NBR             09100005
091100         END-IF                                                   09110005
091200     END-IF.                                                      09120005
091300                                                                  09130005
091400* STORE NUMBER                                                    09140005
091500     IF  MSTRNBRL > ZERO                                          09150005
091600         MOVE MSTRNBRI             TO ASC-STORE-NBR               09160005
091700     ELSE                                                         09170005
091800         IF  MSTRNBRF = DP015-ERASE-EOF                           09180005
091900             MOVE ZEROES           TO ASC-STORE-NBR               09190005
092000         END-IF                                                   09200005
092100     END-IF.                                                      09210005
092200                                                                  09220005
092300* PRINTER ID                                                      09230054
092400     IF  MDEST1L  > ZERO                                          09240054
092500         MOVE MDEST1I              TO ASC-PRINTER-ID              09250054
092600     ELSE                                                         09260054
092700         IF  MDEST1F = DP015-ERASE-EOF                            09270054
092800             MOVE ZEROES           TO ASC-PRINTER-ID              09280054
092900         END-IF                                                   09290054
093000     END-IF.                                                      09300054
093100                                                                  09310054
093200*----------------------------------------------------------------*09320005
093300* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *09330005
093400* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *09340005
093500* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*09350005
093600* IN THE DESTINATION PROGRAM, NOT HERE.                          *09360005
093700*----------------------------------------------------------------*09370005
093800 3000-EDIT-DATA-IN-COMMAREA.                                      09380005
093900                                                                  09390005
094000     PERFORM 3200-RESET-ATTRIBUTES.                               09400005
094100                                                                  09410005
094200*-----------------------------------------------------------------09420005
094300* VERIFY THAT PURCHASE ORDER NUMBER WAS ENTERED AND IS NUMERIC    09430005
094400*-----------------------------------------------------------------09440005
094500     IF  ASC-PO-NBR  > SPACES                                     09450005
094600         MOVE ASC-PO-NBR               TO DP010I-UNEDITED-FIELD   09460005
094700         MOVE LENGTH OF ASC-PO-NBR     TO DP010I-MAXIMUM-DIGITS   09470005
094800         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09480005
094900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09490005
095010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09501099
095020                         USING DP010I-NUMERIC-EDIT-AREA           09502099
095100         IF  DP010I-ERROR-DETECTED                                09510005
095200             SET PS-ERROR                                         09520005
095300                 DP020-MSG-FATAL       TO TRUE                    09530005
095400             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        09540005
095500             MOVE DP015-UNP-ALP-BRT-OFF                           09550005
095600                                       TO MPONBRA                 09560005
095700             MOVE DP015-RED            TO MPONBRC                 09570005
095800             MOVE DP015-REVERSE        TO MPONBRH                 09580005
095900             MOVE -1                   TO MPONBRL                 09590005
096000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09600005
096100         ELSE                                                     09610005
096200             MOVE DP010I-NUMERIC-FIELD                            09620005
096300                                   TO ASC-PO-NBR-N                09630005
096400                                      MPONBRO                     09640005
096500         END-IF                                                   09650005
096600     ELSE                                                         09660005
096700         SET PS-ERROR                                             09670005
096800             DP020-MSG-FATAL       TO TRUE                        09680005
096900         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            09690005
097000         MOVE DP015-UNP-ALP-BRT-OFF                               09700005
097100                                   TO MPONBRA                     09710005
097200         MOVE DP015-RED            TO MPONBRC                     09720005
097300         MOVE DP015-REVERSE        TO MPONBRH                     09730005
097400         MOVE -1                   TO MPONBRL                     09740005
097500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      09750005
097600     END-IF.                                                      09760005
097700                                                                  09770005
097800*-----------------------------------------------------------------09780005
097900* VERIFY THAT RECEIVER SEQUENCE NUMBER WAS ENTERED AND IS NUMERIC 09790005
098000*-----------------------------------------------------------------09800005
098100     IF  PS-NO-ERROR                                              09810038
098200         IF  ASC-REC-SEQ-NBR > SPACES                             09820005
098300             MOVE ASC-REC-SEQ-NBR      TO DP010I-UNEDITED-FIELD   09830005
098400             MOVE LENGTH OF ASC-REC-SEQ-NBR                       09840005
098500                                       TO DP010I-MAXIMUM-DIGITS   09850005
098600             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 09860005
098700             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              09870005
098810             CALL DP010I-NUMERIC-EDIT-ROUTINE                     09881099
098820                         USING DP010I-NUMERIC-EDIT-AREA           09882099
098900             IF  DP010I-ERROR-DETECTED                            09890005
099000                 SET PS-ERROR                                     09900005
099100                     DP020-MSG-FATAL       TO TRUE                09910005
099200             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        09920005
099300             MOVE DP015-UNP-ALP-BRT-OFF                           09930005
099400                                       TO MRECVRA                 09940005
099500             MOVE DP015-RED            TO MRECVRC                 09950005
099600             MOVE DP015-REVERSE        TO MRECVRH                 09960005
099700             MOVE -1                   TO MRECVRL                 09970005
099800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09980005
099900             ELSE                                                 09990005
100000                 MOVE DP010I-NUMERIC-FIELD                        10000005
100100                                       TO ASC-REC-SEQ-NBR-N       10010005
100200                                          MRECVRO                 10020005
100300             END-IF                                               10030005
100400         ELSE                                                     10040005
100500             SET PS-ERROR                                         10050005
100600                 DP020-MSG-FATAL       TO TRUE                    10060005
100700             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        10070005
100800             MOVE DP015-UNP-ALP-BRT-OFF                           10080005
100900                                       TO MRECVRA                 10090005
101000             MOVE DP015-RED            TO MRECVRC                 10100005
101100             MOVE DP015-REVERSE        TO MRECVRH                 10110005
101200             MOVE -1                   TO MRECVRL                 10120005
101300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10130005
101400         END-IF                                                   10140038
101500     END-IF.                                                      10150038
101600                                                                  10160005
101700*-----------------------------------------------------------------10170005
101800* VERIFY THERE ARE TRANSCRIBED PKSLIPS FOR PO/RCVR                10180025
101900*-----------------------------------------------------------------10190005
102000     MOVE  MPONBRI     TO  PV-PO-NUMBER-HOLD.                     10200093
102100     MOVE  MRECVRI     TO  PV-REC-SEQ-HOLD.                       10210093
102200     IF  PS-NO-ERROR                                              10220093
102300         EXEC SQL                                                 10230093
102400             SELECT  CRE_TMST                                     10240093
102500             INTO   :PKSLIP-CRE-TMST                              10250093
102600             FROM    TPKSLIP                                      10260093
102700             WHERE PO_NBR        =  :PV-PO-NUMBER-HOLD            10270093
102800               AND REC_SEQ_NBR   =  :PV-REC-SEQ-HOLD              10280093
102900               AND VER_STAT_CDE  =  'A'                           10290093
103000         END-EXEC                                                 10300093
103100                                                                  10310093
103200         EVALUATE TRUE                                            10320093
103300             WHEN SQLCODE = +0                                    10330093
103400             WHEN SQLCODE = -811                                  10340093
103500                  SET PS-TRNSCRD-PKSLIPS-EXIST TO TRUE            10350093
103600             WHEN SQLCODE = +100                                  10360093
103700                  SET PS-ERROR                                    10370093
103800                      DP020-MSG-FATAL       TO TRUE               10380093
103900                  MOVE DP015-UNP-ALP-BRT-OFF                      10390093
104000                                            TO MPONBRA            10400093
104100                  MOVE DP015-RED            TO MPONBRC            10410093
104200                  MOVE DP015-REVERSE        TO MPONBRH            10420093
104300                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             10430093
104400                                                                  10440093
104500                  MOVE DP015-UNP-ALP-BRT-OFF                      10450093
104600                                            TO MRECVRA            10460093
104700                  MOVE DP015-RED            TO MRECVRC            10470093
104800                  MOVE DP015-REVERSE        TO MRECVRH            10480093
104900                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             10490093
105000                  MOVE -1                   TO MPONBRL            10500093
105100                  MOVE PC-TSYMSG-02636      TO DP020-MSG-NUMBER   10510093
105200                  SET PS-NO-TRNSCRD-PKSLIPS-EXIST TO TRUE         10520093
105300             WHEN SQLCODE < +0                                    10530093
105400             WHEN SQLCODE > +0                                    10540093
105500                  MOVE '3000-EDIT-DATA-IN-COMMAREA'               10550093
105600                                  TO DP013-PARAGRAPH              10560093
105700                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP  TABLE'    10570093
105800                                  TO DP013-MESSAGE-TEXT (1)       10580093
105900                  MOVE SQLCA      TO DP013-SQLCA                  10590093
106000                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     10600093
106100                  SET DP013-DB2-ABEND                             10610094
106200                      DP013-XCTL-DISPLAY-RESTART                  10620094
106300                                  TO TRUE                         10630093
106400              PERFORM DP013-0000-PROCESS-ABEND                    10640093
106500         END-EVALUATE                                             10650093
106600                                                                  10660093
106700*-----------------------------------------------------------------10670030
106800* CHECK NO LINES ON THE PO/RCVR HAVE BEEN VERIFIED                10680031
106900*-----------------------------------------------------------------10690030
107000*    MOVE  MPONBRI     TO  PV-PO-NUMBER-HOLD.                     10700097
107100*    MOVE  MRECVRI     TO  PV-REC-SEQ-HOLD.                       10710098
107200*    MOVE ZEROES       TO  PV-DB2-COUNT.                          10720098
107300*                                                                 10730098
107400*    IF  PS-NO-ERROR                                              10740098
107500*        EXEC SQL                                                 10750098
107600*            SELECT  COUNT(*)                                     10760098
107700*            INTO   :PV-DB2-COUNT                                 10770098
107800*            FROM    TRECITM                                      10780098
107900*            WHERE ORD_NBR        =  :PV-PO-NUMBER-HOLD           10790098
108000*              AND REC_SEQ_NBR    =  :PV-REC-SEQ-HOLD             10800098
108100*              AND VER_STATUS_CDE =  'A'                          10810097
108200*              AND STATUS_CDE     =  'VE'                         10820098
108300*        END-EXEC                                                 10830098
108400*                                                                 10840098
108500*        EVALUATE TRUE                                            10850098
108600*            WHEN SQLCODE = +0                                    10860098
108700*              IF PV-DB2-COUNT >  0                               10870098
108800*                 SET PS-INVLD-FUNC-RCVR-STATUS TO TRUE           10880098
108900*                 SET PS-ERROR            TO TRUE                 10890098
109000*                                                                 10900098
109100*                 MOVE PC-TSYMSG-00966    TO DP020-MSG-NUMBER     10910098
109200*                 INITIALIZE PC201-INTER-APPL-COMMAREA            10920098
109300*                 SET PS-ERROR                                    10930098
109400*                     DP020-MSG-FATAL       TO TRUE               10940098
109500*                 MOVE DP015-UNP-ALP-BRT-OFF                      10950098
109600*                                           TO MPONBRA            10960098
109700*                 MOVE DP015-RED            TO MPONBRC            10970098
109800*                 MOVE DP015-REVERSE        TO MPONBRH            10980098
109900*                 SET DP030-SET-CURSOR-APPL-1 TO TRUE             10990098
110000*                                                                 11000098
110100*                 MOVE DP015-UNP-ALP-BRT-OFF                      11010098
110200*                                           TO MRECVRA            11020098
110300*                 MOVE DP015-RED            TO MRECVRC            11030098
110400*                 MOVE DP015-REVERSE        TO MRECVRH            11040098
110500*                 SET DP030-SET-CURSOR-APPL-1 TO TRUE             11050098
110600*                 MOVE -1                   TO MPONBRL            11060098
110700*                 SET DP030-OVERRIDE-GO TO TRUE                   11070098
110800*              ELSE                                               11080098
110900*                 SET PS-VALID-FUNC-RCVR-STATUS TO TRUE           11090098
111000*              END-IF                                             11100098
111100*            WHEN SQLCODE < +0                                    11110098
111200*            WHEN SQLCODE > +0                                    11120098
111300*                 MOVE '3000-EDIT-DATA-IN-COMMAREA'               11130098
111400*                                 TO DP013-PARAGRAPH              11140098
111500*                 MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP  TABLE'    11150098
111600*                                 TO DP013-MESSAGE-TEXT (1)       11160098
111700*                 MOVE SQLCA      TO DP013-SQLCA                  11170098
111800*                 MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     11180098
111900*                 SET DP013-DB2-ABEND                             11190098
112000*                     DP013-XCTL-DISPLAY-RESTART                  11200098
112100*                                 TO TRUE                         11210098
112200*             PERFORM DP013-0000-PROCESS-ABEND                    11220098
112300*        END-EVALUATE                                             11230098
112400**   END-IF                                                       11240093
112500*                                                                 11250093
112600**----------------------------------------------------------------11260092
112700* VERIFY PO/RCVR NUMBER IS VALID IN RECEIVING SYSTEM              11270030
112800*-----------------------------------------------------------------11280030
112900     MOVE  MPONBRI     TO  PV-PO-NUMBER-HOLD.                     11290030
113000     MOVE  MRECVRI     TO  PV-REC-SEQ-HOLD.                       11300030
113100**   IF  PS-NO-ERROR                                              11310084
113200         EXEC SQL                                                 11320025
113300             SELECT CURR_OPER_UNT_ID                              11330025
113400                   ,OPER_UNT_ID                                   11340025
113500                   ,REC_TMST                                      11350025
113600                   ,STATUS_CDE                                    11360025
113700                   ,PACK_BY_ST_IND                                11370025
113800                   ,PKGNG_CDE                                     11380025
113900                   ,REC_TYP_CDE                                   11390099
114000               INTO :RECEIV-CURR-OPER-UNT-ID                      11400025
114100                   ,:RECEIV-OPER-UNT-ID                           11410025
114200                   ,:RECEIV-REC-TMST                              11420025
114300                   ,:RECEIV-STATUS-CDE                            11430025
114400                   ,:RECEIV-PACK-BY-ST-IND                        11440025
114500                   ,:RECEIV-PKGNG-CDE                             11450025
114600                   ,:RECEIV-REC-TYP-CDE                           11460099
114700               FROM TRECEIV                                       11470025
114800              WHERE ORD_NBR       =  :PV-PO-NUMBER-HOLD           11480025
114900                AND REC_SEQ_NBR   =  :PV-REC-SEQ-HOLD             11490025
115000         END-EXEC                                                 11500025
115100                                                                  11510025
115200         EVALUATE TRUE                                            11520025
115300             WHEN SQLCODE = +0                                    11530025
115400                  MOVE  RECEIV-PACK-BY-ST-IND                     11540066
115500                            TO ASC-PACK-BY-ST-IND                 11550025
115600                  MOVE  RECEIV-CURR-OPER-UNT-ID                   11560025
115700                            TO  ASC-CURR-OPER-UNT-ID              11570025
115800                                PV-CURR-OPER-UNT-HOLD             11580025
115900                                DK-OPER-UNT-ID                    11590025
116000                  MOVE  PC-FCLTY-ID-0001                          11600025
116100                            TO  ASC-CURR-FCLTY-ID                 11610025
116200                                PV-CURR-FCLTY-ID-HOLD             11620025
116300                                DK-FCLTY-ID                       11630025
116400                  MOVE  PV-CURR-OPER-FCLTY-HOLD                   11640025
116500                            TO  MCOPIDO                           11650025
116600                  PERFORM 7010-GET-FCLTY-NAME                     11660025
116700                  MOVE PV-FCLTY-NME  TO MCOPDSCO                  11670025
116800                                                                  11680099
116900* DMH - 12/07/04 - BEGIN                                          11690099
117000                  IF  RECEIV-REC-TYP-CDE = 'AP'                   11700099
117100                      SET PS-ERROR                                11710099
117200                          DP020-MSG-FATAL  TO TRUE                11720099
117300                      MOVE PC-TSYMSG-03362 TO DP020-MSG-NUMBER    11730099
117400                      MOVE DP015-UNP-ALP-BRT-OFF                  11740099
117500                                           TO MPONBRA             11750099
117600                                              MRECVRA             11760099
117700                      MOVE DP015-RED       TO MPONBRC             11770099
117800                                              MRECVRC             11780099
117900                      MOVE DP015-REVERSE   TO MPONBRH             11790099
118000                                              MRECVRH             11800099
118100                      MOVE -1              TO MPONBRL             11810099
118200                                              MPONBRL             11820099
118300                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         11830099
118400                  END-IF                                          11840099
118500                  IF  RECEIV-REC-TYP-CDE = 'CR'                   11850099
118600                      SET PS-ERROR                                11860099
118700                          DP020-MSG-FATAL  TO TRUE                11870099
118800                      MOVE PC-TSYMSG-03403 TO DP020-MSG-NUMBER    11880099
118900                      MOVE DP015-UNP-ALP-BRT-OFF                  11890099
119000                                           TO MPONBRA             11900099
119100                                              MRECVRA             11910099
119200                      MOVE DP015-RED       TO MPONBRC             11920099
119300                                              MRECVRC             11930099
119400                      MOVE DP015-REVERSE   TO MPONBRH             11940099
119500                                              MRECVRH             11950099
119600                      MOVE -1              TO MPONBRL             11960099
119700                                              MPONBRL             11970099
119800                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         11980099
119900                  END-IF                                          11990099
120000* DMH - 12/07/04 - END                                            12000099
120100                                                                  12010099
120200             WHEN SQLCODE = +100                                  12020099
120300                  SET PS-ERROR                                    12030099
120400                      DP020-MSG-FATAL      TO TRUE                12040099
120500                  MOVE PC-TSYMSG-00954     TO DP020-MSG-NUMBER    12050099
120600                  MOVE DP015-UNP-ALP-BRT-OFF                      12060099
120700                                           TO MPONBRA             12070099
120800                                              MRECVRA             12080099
120900                  MOVE DP015-RED           TO MPONBRC             12090099
121000                                              MRECVRC             12100099
121100                  MOVE DP015-REVERSE       TO MPONBRH             12110099
121200                                              MRECVRH             12120099
121300                  MOVE -1                  TO MPONBRL             12130099
121400                                              MPONBRL             12140099
121500                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             12150099
121600             WHEN OTHER                                           12160099
121700                  MOVE '3000-EDIT-DATA-IN-COMMAREA'               12170099
121800                                   TO DP013-PARAGRAPH             12180099
121900                  MOVE 'VERIFY PO/RCVR IN SYSTEM'                 12190099
122000                                   TO DP013-MESSAGE-TEXT (1)      12200099
122100                  MOVE SQLCA       TO DP013-SQLCA                 12210099
122200                  MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)    12220099
122300                  SET DP013-DB2-ABEND                             12230099
122400                      DP013-XCTL-DISPLAY-RESTART                  12240099
122500                                   TO TRUE                        12250099
122600                  PERFORM DP013-0000-PROCESS-ABEND                12260099
122700         END-EVALUATE                                             12270099
122800**   END-IF                                                       12280084
122900*-----------------------------------------------------------------12290099
123000* VALIDATE THAT IF THE PO/RECEIVER HAS UCC128 DATA ATTACHED       12300099
123100*-----------------------------------------------------------------12310099
123200     IF PS-NO-ERROR                                               12320099
123300            SET  ASC-NO-UCC128-DATA-EXISTS  TO  TRUE              12330099
123400            MOVE  ZEROES          TO  PV-UCC128-COUNT             12340099
123500                                                                  12350099
123600            PERFORM 7050-CHECK-UCC128-DATA                        12360099
123700     END-IF                                                       12370099
123800                                                                  12380099
123900*-----------------------------------------------------------------12390099
124000* CHECK TO SEE IF ACTIVE SMOOTHING EXISTS                         12400099
124100*-----------------------------------------------------------------12410099
124200     IF  PS-NO-ERROR                                              12420099
124300            MOVE  ZEROES  TO  PV-DB2-COUNT-ACTV                   12430099
124400            PERFORM 4040-CHECK-FOR-ACTIVE-SMOOTH                  12440099
124500     END-IF                                                       12450099
124600                                                                  12460099
124700*-----------------------------------------------------------------12470099
124800* CHECK TO SEE IF RECEIVER IS IN TROUBLE STATUS                   12480099
124900*-----------------------------------------------------------------12490099
125000     IF  PS-NO-ERROR                                              12500099
125100         MOVE  ZEROES          TO  PV-TROUBLE-COUNT               12510099
125200         SET ASC-NO-RCVR-TROUBLE-EXISTS TO TRUE                   12520099
125300         PERFORM 4050-CHECK-TROUBLE                               12530099
125400     END-IF                                                       12540099
125500                                                                  12550099
125600*-----------------------------------------------------------------12560099
125700* VERIFY THAT STORE NUMBER ENTERED IS NUMERIC                     12570099
125800*-----------------------------------------------------------------12580020
125900     IF  PS-NO-ERROR                                              12590020
126000         IF  ASC-STORE-NBR > SPACES                               12600020
126100             MOVE ASC-STORE-NBR        TO DP010I-UNEDITED-FIELD   12610020
126200             MOVE LENGTH OF ASC-REC-SEQ-NBR                       12620020
126300                                       TO DP010I-MAXIMUM-DIGITS   12630020
126400             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 12640020
126500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              12650020
126610             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12661099
126620                         USING DP010I-NUMERIC-EDIT-AREA           12662099
126700             IF  DP010I-ERROR-DETECTED                            12670020
126800                 SET PS-ERROR                                     12680020
126900                     DP020-MSG-FATAL       TO TRUE                12690020
127000                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    12700066
127100                 MOVE DP015-UNP-ALP-BRT-OFF                       12710066
127200                                           TO MSTRNBRA            12720066
127300                 MOVE DP015-RED            TO MSTRNBRC            12730066
127400                 MOVE DP015-REVERSE        TO MSTRNBRH            12740066
127500                 MOVE -1                   TO MSTRNBRL            12750066
127600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12760066
127700             ELSE                                                 12770020
127800                 MOVE DP010I-NUMERIC-FIELD                        12780020
127900                                       TO ASC-STORE-NBR-N         12790020
128000                                          MSTRNBRO                12800020
128100             END-IF                                               12810020
128200         END-IF                                                   12820021
128300     END-IF.                                                      12830021
128400                                                                  12840020
128500*-----------------------------------------------------------------12850060
128600* CHECK IF PRINTER NUMBER IS VALID                                12860060
128700*-----------------------------------------------------------------12870060
128800     SET PS-NO-PRINTER-ID-ENTERED  TO TRUE                        12880061
128900     IF  PS-NO-ERROR                                              12890060
129000         IF  ASC-PRINTER-ID > SPACES                              12900060
129100             PERFORM 3050-EDIT-SML-ID                             12910060
129200                                                                  12920066
129300             IF PS-NO-ERROR                                       12930060
129400                MOVE ASC-PRINTER-ID TO DK-PRINTER-ID              12940062
129500                MOVE PV-OPER-UNT-HOLD TO DK-OPER-UNT-ID           12950065
129600                PERFORM 3060-GET-PRINTER-DESC                     12960065
129700                SET PS-PRINTER-ID-ENTERED TO TRUE                 12970065
129800             END-IF                                               12980065
129900         END-IF                                                   12990066
130000     END-IF.                                                      13000060
130100                                                                  13010060
130200*-----------------------------------------------------------------13020060
130300* CHECK TO SEE IF PO/RECEIVER IS PACK-BY-STORE                    13030060
130400*-----------------------------------------------------------------13040005
130500       IF PS-NO-ERROR                                             13050066
130600             IF  RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'              13060099
130700                 SET PS-ERROR                                     13070005
130800                     DP020-MSG-FATAL   TO TRUE                    13080005
130900                 MOVE PC-TSYMSG-02634  TO DP020-MSG-NUMBER        13090034
131000                 MOVE DP015-UNP-ALP-BRT-OFF                       13100005
131100                                       TO MPONBRA                 13110005
131200                                          MRECVRA                 13120005
131300                 MOVE DP015-RED        TO MPONBRC                 13130005
131400                                          MRECVRC                 13140005
131500                 MOVE DP015-REVERSE    TO MPONBRH                 13150005
131600                                          MRECVRH                 13160005
131700                 MOVE -1               TO MPONBRL                 13170005
131800                                          MRECVRL                 13180005
131900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13190005
132000       END-IF.                                                    13200066
132100                                                                  13210005
132200*-----------------------------------------------------------------13220005
132300* CHECK SEE IF DC ASSOCIATED W/ PO RECEIVER IS THE SAME DC        13230005
132400* TRYING TO PROCESS THE PO RECEIVER - IF NOT, REQUEST CONFIRM     13240005
132500*  DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID) = F17 STORE LIST         13250095
132600*  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) = F23 CARTON LIST        13260095
132700*-----------------------------------------------------------------13270005
132800     IF  PS-NO-ERROR                                              13280005
132900       IF RECEIV-CURR-OPER-UNT-ID  =  DP020-LOCATION-NBR          13290099
133000               CONTINUE                                           13300099
133100       ELSE                                                       13310099
133200         IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                13320099
133300              SET PS-ERROR                                        13330099
133400                  DP020-MSG-WARNING                               13340099
133500                  ASC-CONFIRM-FUNC-01   TO TRUE                   13350099
133600              MOVE PC-TSYMSG-01732      TO DP020-MSG-NUMBER       13360099
133700              MOVE DP015-RED            TO MOPIDC                 13370099
133800                                           MCOPIDC                13380099
133900              MOVE DP015-REVERSE        TO MOPIDH                 13390099
134000                                           MCOPIDH                13400099
134100              MOVE -1                   TO MPONBRL                13410099
134200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 13420099
134300         ELSE                                                     13430099
134400             IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)            13440099
134500                 SET PS-ERROR                                     13450099
134600                     DP020-MSG-WARNING                            13460099
134700                     ASC-CONFIRM-FUNC-02   TO TRUE                13470099
134800                 MOVE PC-TSYMSG-01732      TO DP020-MSG-NUMBER    13480099
134900                 MOVE DP015-RED            TO MOPIDC              13490099
135000                                              MCOPIDC             13500099
135100                 MOVE DP015-REVERSE        TO MOPIDH              13510099
135200                                           MCOPIDH                13520099
135300                 MOVE -1                   TO MPONBRL             13530099
135400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13540099
135500             END-IF                                               13550099
135600         END-IF                                                   13560099
135700       END-IF                                                     13570099
135800     END-IF.                                                      13580099
135900                                                                  13590099
136000*-----------------------------------------------------------------13600005
136100     IF  PS-NO-ERROR                                              13610005
136200         IF  ASC-PO-NBR-N       >  0  AND                         13620005
136300             ASC-REC-SEQ-NBR-N  >  0                              13630005
136400             MOVE -1               TO MDEST1L                     13640005
136500         ELSE                                                     13650005
136600             MOVE -1               TO MPONBRL                     13660005
136700         END-IF                                                   13670005
136800             SET DP030-SET-CURSOR-APPL-1                          13680005
136900                                   TO TRUE                        13690005
137000     END-IF.                                                      13700005
137100                                                                  13710005
137200*----------------------------------------------------------------*13720005
137300* VALIDATE SML PRINTER ID                                        *13730005
137400* VERIFY THAT SHIPPING MANIFEST LABEL(SML)                        13740099
137500* PRINTER ID IS ENTERED AND IS VALID.                             13750099
137600*----------------------------------------------------------------*13760005
137700 3050-EDIT-SML-ID.                                                13770005
137800                                                                  13780005
137900        MOVE ASC-PRINTER-ID    TO DP072-PRINTER-ID                13790055
138000        MOVE PC-REPORT-PGM-1   TO DP072-RPT-PGM-NME               13800055
138100        PERFORM 3600-VALIDATE-PRINTER                             13810055
138200        IF  PS-NO-ERROR                                           13820055
138300            PERFORM 3620-VALIDATE-PRINTER-ID-SML                  13830055
138400            MOVE  DP072-PRTR-CLUSTER-NBR                          13840055
138500                              TO PV-SHP-PRTR-CLUSTER-NBR          13850055
138600            MOVE  DP072-PRTR-IP-ADDRESS                           13860055
138700                              TO PV-SHP-PRTR-ID-ADDR              13870055
138800            MOVE  DP072-PRTR-CLUSTER-OS-RLSE-CDE                  13880055
138900                              TO PV-SHP-PRTR-OS-RLSE-CDE          13890055
139000            MOVE  DP072-PRTR-DATA-XFER-MODE-ID                    13900055
139100                              TO PV-SHP-DATA-XFER-MODE-ID         13910055
139200            MOVE  DP072-XMIT-INTFC-CDE                            13920055
139300                              TO PV-SHP-XMIT-INTFC-CDE.           13930057
139400                                                                  13940055
139500*----------------------------------------------------------------*13950060
139600*       GET PRINTER NAME                                         *13960060
139700*----------------------------------------------------------------*13970060
139800 3060-GET-PRINTER-DESC.                                           13980060
139900                                                                  13990060
140000     PERFORM                                                      14000060
140100         WITH TEST AFTER                                          14010060
140200         VARYING PV-RETRY-COUNT                                   14020060
140300         FROM 1 BY 1                                              14030060
140400         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 14040060
140500             OR (SQLCODE = +0)                                    14050060
140600             OR (SQLCODE = +100))                                 14060060
140700                                                                  14070060
140800     EXEC SQL                                                     14080060
140900         SELECT PRTR_LOC_DESC                                     14090060
141000           INTO :PRTRID-PRTR-LOC-DESC                             14100061
141100           FROM TPRTRID                                           14110061
141200           WHERE PRTR_ID          = :DK-PRINTER-ID                14120064
141300           AND   PRTR_OPER_UNT_ID = :DK-OPER-UNT-ID               14130064
141400     END-EXEC                                                     14140060
141500                                                                  14150060
141600         EVALUATE TRUE                                            14160060
141700             WHEN SQLCODE = +0                                    14170060
141800                  MOVE PRTRID-PRTR-LOC-DESC                       14180061
141900                                  TO PV-PRTR-NME                  14190061
142000                                                                  14200060
142100             WHEN SQLCODE = +100                                  14210060
142200                  MOVE SPACES     TO PV-PRTR-NME                  14220061
142300                                                                  14230060
142400             WHEN SQLCODE = -904                                  14240060
142500             WHEN SQLCODE = -913                                  14250060
142600                  CONTINUE                                        14260060
142700             WHEN SQLWARN0 NOT = +0                               14270060
142800             WHEN SQLCODE < +0                                    14280060
142900             WHEN SQLCODE > +0                                    14290060
143000                  MOVE '3060-GET-PRINTER-DESC'                    14300061
143100                                  TO DP013-PARAGRAPH              14310060
143200                  MOVE 'UNSUCCESSFUL SELECT ON PRINTER TABLE'     14320061
143300                                  TO DP013-MESSAGE-TEXT (1)       14330060
143400                  MOVE SQLCA      TO DP013-SQLCA                  14340060
143500                  MOVE 'TPRTRID ' TO DP013-DB2-TABLE-NAME (1)     14350061
143600                  SET DP013-DB2-ABEND                             14360060
143700                      DP013-XCTL-DISPLAY-RESTART                  14370060
143800                                  TO TRUE                         14380060
143900              PERFORM DP013-0000-PROCESS-ABEND                    14390060
144000         END-EVALUATE                                             14400060
144100     END-PERFORM.                                                 14410060
144200                                                                  14420060
144300     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          14430060
144400         MOVE '3060-GET-PRINTER-DESC'                             14440061
144500                                  TO DP013-PARAGRAPH              14450060
144600         MOVE 'MAX RETRIES EXCEEDED ON SELECT PRINTER TABLE'      14460061
144700                                  TO DP013-MESSAGE-TEXT (1)       14470060
144800         MOVE SQLCA               TO DP013-SQLCA                  14480060
144900         MOVE 'TPRTRID'           TO DP013-DB2-TABLE-NAME (1)     14490061
145000         SET DP013-DB2-ABEND                                      14500060
145100             DP013-XCTL-DISPLAY-RESTART                           14510060
145200                                  TO TRUE                         14520060
145300         PERFORM DP013-0000-PROCESS-ABEND                         14530060
145400     END-IF.                                                      14540060
145500                                                                  14550060
145600*----------------------------------------------------------------*14560005
145700*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *14570005
145800*  MAP.                                                          *14580005
145900*----------------------------------------------------------------*14590005
146000 3200-RESET-ATTRIBUTES.                                           14600005
146100     MOVE DP015-UNP-ALP-NOR-OFF    TO MDEST1A.                    14610013
146200     MOVE DP015-ASK-NOR-MDT        TO MOPIDA                      14620005
146300                                      MCOPIDA.                    14630087
146400     MOVE DP015-UNP-ALP-NOR-OFF    TO MPONBRA                     14640005
146500                                      MRECVRA                     14650005
146600                                      MSTRNBRA                    14660059
146700                                      MDEST1A.                    14670059
146800     MOVE DP015-GREEN              TO MPONBRC                     14680005
146900                                      MRECVRC                     14690005
147000                                      MSTRNBRC                    14700022
147100                                      MDEST1C                     14710059
147200     MOVE DP015-BLUE               TO MOPIDC                      14720005
147300                                      MCOPIDC.                    14730013
147400     MOVE DP015-HL-OFF             TO MOPIDH                      14740005
147500                                      MCOPIDH                     14750005
147600     MOVE DP015-UNDERLINE          TO MPONBRH                     14760005
147700                                      MRECVRH                     14770005
147800                                      MDEST1H                     14780022
147900                                      MSTRNBRH.                   14790022
148000                                                                  14800005
148100*----------------------------------------------------------------*14810005
148200*   3600-VALIDATE-PRINTER                                        *14820005
148300* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *14830005
148400* RETURNS DP072 VALUES WHICH ARE CHECKED IN 3620-VALIDATE        *14840058
148500*----------------------------------------------------------------*14850005
148600 3600-VALIDATE-PRINTER.                                           14860005
148700                                                                  14870005
148800     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     14880005
148900     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 14890099
149000     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        14900099
149100     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     14910005
149200                                        DP072-FCLTY-ID.           14920005
149300     SET DP072-VALIDATE              TO TRUE.                     14930005
149400                                                                  14940005
149500     EXEC CICS                                                    14950005
149600          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  14960005
149700               COMMAREA (DP072-COMM-AREA)                         14970005
149800               RESP     (PV-CICS-RESPONSE)                        14980005
149900     END-EXEC                                                     14990005
150000                                                                  15000005
150100     EVALUATE TRUE                                                15010005
150200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15020005
150300              CONTINUE                                            15030005
150400         WHEN OTHER                                               15040005
150500             SET PS-ERROR                                         15050005
150600                 DP020-MSG-FATAL       TO TRUE                    15060005
150700             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        15070005
150800             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              15080005
150900                 MOVE DP015-UNP-ALP-BRT-OFF                       15090005
151000                                       TO MDEST1A                 15100005
151100                 MOVE DP015-RED        TO MDEST1C                 15110005
151200                 MOVE DP015-REVERSE    TO MDEST1H                 15120005
151300                 MOVE -1               TO MDEST1L                 15130005
151400             END-IF                                               15140005
151500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15150005
151600     END-EVALUATE.                                                15160005
151700                                                                  15170005
151800                                                                  15180005
151900*----------------------------------------------------------------*15190005
152000*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *15200005
152100*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *15210005
152200*  CAN BE PRINTED ON THIS PRINTER.                               *15220005
152300*----------------------------------------------------------------*15230005
152400 3620-VALIDATE-PRINTER-ID-SML.                                    15240005
152500                                                                  15250005
152600     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               15260005
152700         SET  PS-PRINTER-ERROR                                    15270005
152800              PS-ERROR                                            15280005
152900              DP020-MSG-FATAL         TO TRUE                     15290005
153000         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         15300005
153100         MOVE DP015-UNP-ALP-BRT-OFF   TO MDEST1A                  15310005
153200         MOVE DP015-RED               TO MDEST1C                  15320005
153300         MOVE DP015-REVERSE           TO MDEST1H                  15330005
153400         MOVE -1                      TO MDEST1L                  15340005
153500         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     15350005
153600     END-IF.                                                      15360005
153700                                                                  15370005
153800     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  15380005
153900         CONTINUE                                                 15390005
154000     ELSE                                                         15400005
154100         SET  PS-PRINTER-ERROR                                    15410005
154200              PS-ERROR                                            15420005
154300              DP020-MSG-FATAL         TO TRUE                     15430005
154400         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         15440005
154500         MOVE DP015-UNP-ALP-BRT-OFF   TO MDEST1A                  15450005
154600         MOVE DP015-RED               TO MDEST1C                  15460005
154700         MOVE DP015-REVERSE           TO MDEST1H                  15470005
154800         MOVE -1                      TO MDEST1L                  15480005
154900         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     15490005
155000         SET DP030-OVERRIDE-GO TO TRUE                            15500058
155100     END-IF.                                                      15510005
155200                                                                  15520099
155300*----------------------------------------------------------------*15530099
155400* CHECK TO SEE IF PO/RECEIVER IS IN TROUBLE                      *15540099
155500*----------------------------------------------------------------*15550099
155600 4040-CHECK-FOR-ACTIVE-SMOOTH.                                    15560099
155700     EXEC SQL                                                     15570099
155800         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                   15580099
155900           INTO :PV-DB2-COUNT-ACTV                                15590099
156000           FROM SUT_OTBND_UPC A                                   15600099
156100              , SUT_OTBND_CART B                                  15610099
156200           WHERE A.TRN_NBR          = :DK-PO                      15620099
156300            AND  A.RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR             15630099
156400            AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID             15640099
156500            AND  B.CART_SRC_CDE     =  'SMO'                      15650099
156600            AND  B.ACTV_IND         =  'Y'                        15660099
156700            AND  B.CRE_PGM_NM       = 'PCKCS728'                  15670099
156800     END-EXEC                                                     15680099
156900                                                                  15690099
157000     EVALUATE TRUE                                                15700099
157100         WHEN SQLCODE = +0                                        15710099
157200           IF  PV-DB2-COUNT-ACTV >  +0                            15720099
157300               SET ASC-ACTV-SMTHNG-EXISTS TO TRUE                 15730099
157400           ELSE                                                   15740099
157500               SET ASC-NO-ACTV-SMTHNG-EXISTS TO TRUE              15750099
157600           END-IF                                                 15760099
157700         WHEN SQLWARN0 NOT = SPACES                               15770099
157800         WHEN SQLCODE < ZERO                                      15780099
157900         WHEN SQLCODE > ZERO                                      15790099
158000             MOVE '4040-CHECK-FOR-ACTIVE-SMOOTH'                  15800099
158100                               TO DP013-PARAGRAPH                 15810099
158200             MOVE 'CHECK FOR ACTIVE SMOOTHING '                   15820099
158300                               TO DP013-MESSAGE-TEXT (1)          15830099
158400             MOVE SQLCA        TO DP013-SQLCA                     15840099
158500             MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)    15850099
158600             SET DP013-DB2-ABEND                                  15860099
158700                 DP013-XCTL-DISPLAY-RESTART                       15870099
158800                               TO TRUE                            15880099
158900             PERFORM DP013-0000-PROCESS-ABEND                     15890099
159000     END-EVALUATE.                                                15900099
159100                                                                  15910099
159200*----------------------------------------------------------------*15920099
159300* CHECK TO SEE IF PO/RECEIVER IS IN TROUBLE                      *15930099
159400*----------------------------------------------------------------*15940099
159500 4050-CHECK-TROUBLE.                                              15950099
159600     EXEC SQL                                                     15960099
159700         SELECT COUNT(*)                                          15970099
159800           INTO :PV-TROUBLE-COUNT                                 15980099
159900           FROM TTRBNTF A                                         15990099
160000               ,TTRBRSN B                                         16000099
160100          WHERE A.PO_NBR       =  :DK-PO                          16010099
160200            AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                 16020099
160300            AND A.RESOLVED_IND IN ('N','I','R')                   16030099
160400            AND A.TRBL_RSN_CDE =  B.TRBL_RSN_CDE                  16040099
160500            AND B.NOTIF_IND    = 'T'                              16050099
160600            AND NOT EXISTS                                        16060099
160700                (SELECT *                                         16070099
160800           FROM TTRBRCN C                                         16080099
160900          WHERE C.RPT_PGM_NM   =  'PCKCS709'                      16090099
161000            AND A.TRBL_RSN_CDE =  C.TRBL_RSN_CDE)                 16100099
161100     END-EXEC                                                     16110099
161200                                                                  16120099
161300     EVALUATE TRUE                                                16130099
161400         WHEN SQLCODE = +0                                        16140099
161500           IF PV-TROUBLE-COUNT  >  +0                             16150099
161600              SET ASC-RCVR-TROUBLE-EXISTS TO TRUE                 16160099
161700              IF ASC-ACTV-SMTHNG-EXISTS                           16170099
161800                 CONTINUE                                         16180099
161900              ELSE                                                16190099
162000                SET PS-ERROR                                      16200099
162100                    DP020-NEXT-ACT-APPL-ERROR                     16210099
162200                    DP020-MSG-FATAL       TO TRUE                 16220099
162300                MOVE PC-TSYMSG-01756      TO DP020-MSG-NUMBER     16230099
162400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               16240099
162500           ELSE                                                   16250099
162600               SET ASC-NO-RCVR-TROUBLE-EXISTS TO TRUE             16260099
162700           END-IF                                                 16270099
162800         WHEN SQLWARN0 NOT = SPACES                               16280099
162900         WHEN SQLCODE < ZERO                                      16290099
163000         WHEN SQLCODE > ZERO                                      16300099
163100             MOVE '4050-CHECK-TROUBLE'                            16310099
163200                               TO DP013-PARAGRAPH                 16320099
163300             MOVE 'CHECK IF PO/RECEIVER IN TROUBLE'               16330099
163400                               TO DP013-MESSAGE-TEXT (1)          16340099
163500             MOVE SQLCA        TO DP013-SQLCA                     16350099
163600             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        16360099
163700             SET DP013-DB2-ABEND                                  16370099
163800                 DP013-XCTL-DISPLAY-RESTART                       16380099
163900                               TO TRUE                            16390099
164000             PERFORM DP013-0000-PROCESS-ABEND                     16400099
164100     END-EVALUATE.                                                16410099
164200                                                                  16420099
164300                                                                  16430099
164400                                                                  16440099
164500*LMM                                                              16450099
164600******************************************************************16460099
164700* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *16470099
164800******************************************************************16480099
164900 6200-DEL-LIST-QUEUE.                                             16490099
165000                                                                  16500099
165100     EXEC CICS                                                    16510099
165200         DELETEQ TS                                               16520099
165300             QUEUE (ASC-LIST-QUEUE-NAME)                          16530099
165400             RESP  (PV-CICS-RESP)                                 16540099
165500     END-EXEC.                                                    16550099
165600                                                                  16560099
165700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      16570099
165800        (PV-CICS-RESP = DFHRESP(QIDERR)))                         16580099
165900         CONTINUE                                                 16590099
166000     ELSE                                                         16600099
166100        SET DP013-CICS-ABEND       TO TRUE                        16610099
166200        SET DP013-NO-ROLLBACK      TO TRUE                        16620099
166300        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             16630099
166400        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               16640099
166500                                   TO DP013-MESSAGE-TEXT (1)      16650099
166600        PERFORM DP013-0000-PROCESS-ABEND                          16660099
166700     END-IF.                                                      16670099
166800                                                                  16680099
166900                                                                  16690005
167000*----------------------------------------------------------------*16700005
167100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *16710005
167200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *16720005
167300*  IT HERE.                                                      *16730005
167400*----------------------------------------------------------------*16740005
167500 7000-BUILD-INITIAL-PANEL.                                        16750005
167600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        16760005
167700     MOVE -1                       TO MPONBRL.                    16770005
167800                                                                  16780005
167900     EXEC CICS ASSIGN                                             16790005
168000               APPLID(PV-SYSTEM-ID)                               16800005
168100     END-EXEC.                                                    16810005
168200                                                                  16820005
168300         MOVE ASC-OPER-UNT-ID    TO PV-OPER-UNT-HOLD              16830005
168400         MOVE ASC-FCLTY-ID       TO PV-FCLTY-ID-HOLD              16840005
168500         MOVE PV-OPER-FCLTY-HOLD TO MOPIDO                        16850005
168600         MOVE PC-FCLTY-ID-0001   TO ASC-FCLTY-ID                  16860005
168700                                    DK-FCLTY-ID                   16870005
168800         MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID                16880099
168900                                    ASC-OPER-UNT-ID-N             16890005
169000         MOVE ASC-OPER-UNT-ID    TO PV-OPER-UNT-HOLD              16900005
169100         MOVE ASC-FCLTY-ID       TO PV-FCLTY-ID-HOLD              16910005
169200         MOVE PV-OPER-FCLTY-HOLD TO MOPIDO                        16920005
169300                                                                  16930005
169400     PERFORM 7010-GET-FCLTY-NAME.                                 16940005
169500                                                                  16950005
169600     MOVE PV-FCLTY-NME             TO MOPDESCO.                   16960005
169700                                                                  16970005
169800     MOVE ZEROES                   TO PV-CURR-OPER-UNT-HOLD       16980005
169900                                      PV-CURR-FCLTY-ID-HOLD.      16990005
170000     MOVE PV-CURR-OPER-FCLTY-HOLD  TO MCOPIDO.                    17000005
170100     MOVE SPACES                   TO MCOPDSCO.                   17010005
170200                                                                  17020005
170300                                                                  17030005
170400*----------------------------------------------------------------*17040005
170500*       GET THE FACILITY NAME                                    *17050005
170600*----------------------------------------------------------------*17060005
170700 7010-GET-FCLTY-NAME.                                             17070005
170800                                                                  17080099
170900     INITIALIZE XL071-COMMAREA-REC.                               17090099
171000     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               17100099
171100                                                                  17110099
171200     CALL PC-LOCATION-MODULE  USING                               17120099
171300                                    DFHEIBLK                      17130099
171400                                    XL071-COMMAREA                17140099
171500                                    XL071-COMMAREA-REC.           17150099
171600                                                                  17160099
171700     IF XL071-NO-ERRORS                                           17170099
171800         MOVE XL071-LOC-NM  TO  PV-FCLTY-NME                      17180099
171900     ELSE                                                         17190099
172000         MOVE SPACES        TO  PV-FCLTY-NME                      17200099
172100     END-IF.                                                      17210099
172200                                                                  17220005
172300*----------------------------------------------------------------*17230005
172400* CHECK TO SEE IF THERE IS UCC128 DATA FOR THE PO/RCVR ENTERED   *17240005
172500*----------------------------------------------------------------*17250005
172600 7050-CHECK-UCC128-DATA.                                          17260005
172700     MOVE  MPONBRI     TO  DK-PO.                                 17270005
172800     MOVE  MRECVRI     TO  DK-REC-SEQ-NBR.                        17280005
172900                                                                  17290005
173000     EXEC SQL                                                     17300005
173100          SELECT  COUNT(*)                                        17310005
173200            INTO  :PV-UCC128-COUNT                                17320005
173300            FROM  TPKSLIP A                                       17330005
173400                 ,TINPKSU B                                       17340005
173500                 ,TSHUUPC C                                       17350005
173600           WHERE  A.PO_NBR         = :DK-PO                       17360005
173700             AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR              17370005
173800             AND  A.VER_STAT_CDE   = 'A'                          17380005
173900             AND  A.PKSL_STAT_CDE  = 'AC'                         17390005
174000             AND  B.PO_NBR         = A.PO_NBR                     17400005
174100             AND  B.SEQ_NBR        = A.SEQ_NBR                    17410005
174200             AND  C.SHIPT_UNT_ID   = B.SHIPT_UNT_ID               17420005
174300             AND  C.TRN_NBR        = B.PO_NBR                     17430005
174400             AND  C.TRN_LNE_NBR    > 0                            17440005
174500     END-EXEC.                                                    17450005
174600                                                                  17460005
174700     EVALUATE TRUE                                                17470005
174800         WHEN SQLCODE = ZERO                                      17480005
174900              IF  PV-UCC128-COUNT  >  0                           17490083
175000                  SET  ASC-UCC128-DATA-EXISTS  TO  TRUE           17500099
175100              ELSE                                                17510083
175200                  SET  ASC-NO-UCC128-DATA-EXISTS  TO  TRUE        17520099
175300              END-IF                                              17530083
175400         WHEN SQLWARN0 NOT = SPACES                               17540005
175500         WHEN SQLCODE < ZERO                                      17550005
175600         WHEN SQLCODE > ZERO                                      17560005
175700              MOVE '7050-CHECK-UCC128-DATA  '                     17570005
175800                              TO DP013-PARAGRAPH                  17580005
175900              MOVE 'CHECK TO SEE IF THERE IS UCC128 DATA'         17590005
176000                              TO DP013-MESSAGE-TEXT (1)           17600005
176100              MOVE SQLCA      TO DP013-SQLCA                      17610005
176200              MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)         17620005
176300              MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME (1)         17630005
176400              MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME (1)         17640005
176500              SET DP013-DB2-ABEND                                 17650005
176600                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            17660005
176700          PERFORM DP013-0000-PROCESS-ABEND                        17670005
176800     END-EVALUATE.                                                17680005
176900                                                                  17690005
177000                                                                  17700005
177100*----------------------------------------------------------------*17710005
177200*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *17720005
177300*----------------------------------------------------------------*17730005
177400 8000-MOVE-COMMAREA-TO-SCREEN.                                    17740005
177500                                                                  17750005
177600     MOVE ASC-PO-NBR-N             TO MPONBRO.                    17760005
177700     MOVE ASC-REC-SEQ-NBR-N        TO MRECVRO.                    17770005
177800     MOVE ASC-OPER-UNT-ID-N        TO PV-OPER-UNT-HOLD            17780005
177900     MOVE ASC-FCLTY-ID-N           TO PV-FCLTY-ID-HOLD            17790005
178000     MOVE PV-OPER-FCLTY-HOLD       TO MOPIDO.                     17800005
178100     MOVE ASC-CURR-OPER-UNT-ID-N   TO PV-CURR-OPER-UNT-HOLD.      17810005
178200     MOVE ASC-CURR-FCLTY-ID-N      TO PV-CURR-FCLTY-ID-HOLD.      17820005
178300     MOVE PV-CURR-OPER-FCLTY-HOLD  TO MCOPIDO.                    17830005
178400                                                                  17840005
178500                                                                  17850005
178600     MOVE ASC-OPER-UNT-ID-N        TO DK-OPER-UNT-ID.             17860005
178700     MOVE ASC-FCLTY-ID-N           TO DK-FCLTY-ID.                17870005
178800     PERFORM 7010-GET-FCLTY-NAME.                                 17880005
178900     MOVE PV-FCLTY-NME             TO MOPDESCO.                   17890005
179000     IF ASC-UCC128-DATA-EXISTS                                    17900074
179100        MOVE PC-UCC128-EXISTS      TO MUCC128O                    17910077
179200     ELSE                                                         17920078
179300        MOVE SPACES                TO MUCC128O                    17930078
179400     END-IF                                                       17940074
179500     IF PS-PRINTER-ID-ENTERED                                     17950061
179600        MOVE PV-PRTR-NME           TO MPRTDSCO                    17960061
179700     END-IF.                                                      17970061
179800                                                                  17980099
179900*LMM                                                              17990099
180000******************************************************************18000099
180100* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *18010099
180200******************************************************************18020099
180300 9100-READ-SEL-QUEUE.                                             18030099
180400                                                                  18040099
180500     EXEC CICS                                                    18050099
180600         READQ TS                                                 18060099
180700             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        18070099
180800             INTO  (PC237-DC-SELECT-RECORD)                       18080099
180900             ITEM  (ASC-SEL-ITEM)                                 18090099
181000             RESP  (PV-CICS-RESP)                                 18100099
181100     END-EXEC.                                                    18110099
181200                                                                  18120099
181300     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        18130099
181400         CONTINUE                                                 18140099
181500     ELSE                                                         18150099
181600         SET DP013-LOGIC-ABEND                                    18160099
181700             DP013-NO-ROLLBACK   TO TRUE                          18170099
181800         MOVE '9100-READ-SEL-QUEUE'                               18180099
181900                                 TO DP013-PARAGRAPH               18190099
182000         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    18200099
182100                                 TO DP013-MESSAGE-TEXT (1)        18210099
182200         PERFORM DP013-0000-PROCESS-ABEND                         18220099
182300     END-IF.                                                      18230099
182400                                                                  18240099
182500******************************************************************18250099
182600* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *18260099
182700******************************************************************18270099
182800 9200-REWRITE-LIST-QUEUE.                                         18280099
182900     EXEC CICS                                                    18290099
183000          WRITEQ TS                                               18300099
183100              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     18310099
183200              FROM    (PC237-DC-SELECT-RECORD)                    18320099
183300              ITEM    (ASC-SEL-ITEM)                              18330099
183400              RESP    (PV-CICS-RESP)                              18340099
183500              REWRITE                                             18350099
183600     END-EXEC.                                                    18360099
183700                                                                  18370099
183800     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    18380099
183900         SET DP013-CICS-ABEND                                     18390099
184000             DP013-NO-ROLLBACK   TO TRUE                          18400099
184100         MOVE '9200-REWRITE-LIST-QUEUE'                           18410099
184200                                 TO DP013-PARAGRAPH               18420099
184300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   18430099
184400                                 TO DP013-MESSAGE-TEXT (1)        18440099
184500         PERFORM DP013-0000-PROCESS-ABEND                         18450099
184600     END-IF.                                                      18460099
184700                                                                  18470099
184800*----------------------------------------------------------------*18480005
184900*    ABEND PROCESSOR MODULE                                      *18490005
185000*----------------------------------------------------------------*18500005
185100                                                                  18510005
185200     COPY DPPD013.                                                18520005
