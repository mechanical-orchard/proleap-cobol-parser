000100 IDENTIFICATION DIVISION.                                         00010023
000200 PROGRAM-ID.    RCKCS253.                                         00020023
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030023
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040023
000500 DATE-WRITTEN.  MAY 1994.                                         00050023
000600 DATE-COMPILED.                                                   00060023
000700                                                                  00070023
000800*----------------------------------------------------------------*00080023
000900*                                                                *00090023
001000*    TRANID      - E253                                          *00100023
001100*    TYPE        - CICS ARCHITECTURE DELETE - DB2                *00110023
001200*    DESCRIPTION - RECEIVER/PACK SLIP/WORK ORDER DELETE PROGRAM  *00120023
001300*    MAPSET      - RCKM253                                       *00130023
001400*                                                                *00140023
001500*    LISTS PURCHASE ORDER AND RECEIPT INFORMATION FOR A SPECIFIC *00150023
001600*    RECEIVER.  THIS PROGRAM IS A COPY OF THE INQUIRY PROGRAM    *00160023
001700*    RCKCS223, AND CHANGED TO ALLOW THE DELETE FUNCTION.         *00170023
001800*                                                                *00180023
001900*    IR-229: WHEN DELETING A RECEIVER, DELETE TROUBLE TOO.       *00190023
002000*            7/22/94 BY M. FURLICK                               *00200023
002100*                                                                *00210023
002200*    WR-28767 REMOVE ARCHIVING OF TRECEIVER SEGMENT REPLACE     * 00220023
002300*             WITH UPDATE.                                      * 00230023
002400*             BY GARDNER     8/26/94                            * 00240023
002500*                                                                *00250023
002600*----------------------------------------------------------------*00260023
002700*  CHANGED 10/16/2014    BY COGNIZANT       WR: CHG0094517        00270071
002800*                                                                 00280071
002900* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00290071
002901*-----------------------------------------------------------------00290171
002902                                                                  00290223
002903 ENVIRONMENT DIVISION.                                            00290323
002904 DATA DIVISION.                                                   00290423
003000                                                                  00300023
003100 WORKING-STORAGE SECTION.                                         00310023
003200                                                                  00320023
003300 01  DN-DB2-NULL-INDICATORS.                                      00330023
003400     05  DN-AD-EVNT-DTE               PIC S9(04) VALUE +0         00340023
003500                                                  COMP.           00350023
003600     05  DN-SUBAREA-OF-ID             PIC S9(04) VALUE +0         00360023
003700                                                  COMP.           00370023
003800     05  DN-TKT-FMT-ID                PIC S9(04) VALUE +0         00380023
003900                                                  COMP.           00390023
004000     05  DN-VRFYD-CNT-ID              PIC S9(04) VALUE +0         00400023
004100                                                  COMP.           00410023
004200     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   00420023
004300     05  DN-EST-AR-TMST               PIC S9(04) COMP VALUE +0.   00430023
004400     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00440023
004500     05  DN-CURR-TRIP-ID              PIC S9(04) COMP VALUE +0.   00450023
004600                                                                  00460023
004700 01  DK-DB2-KEYS.                                                 00470023
004800     05  DK-SEQ-NBR                   PIC S9(04) COMP-3.          00480061
004900     05  DK-PO-NBR                    PIC S9(09) VALUE +0         00490023
005000                                                 COMP.            00500023
005100     05  DK-REC-SEQ-NBR               PIC S9(09) VALUE +0         00510023
005200                                                 COMP.            00520023
005300     05  DK-OPER-UNT-ID               PIC S9(04) VALUE +0         00530023
005400                                                 COMP.            00540023
005500     05  DK-FCLTY-ID                  PIC S9(04) VALUE +0         00550023
005600                                                 COMP.            00560023
005700     05  DK-TRIP-ID                   PIC S9(09) VALUE +0         00570023
005800                                                 COMP.            00580023
005900     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    00590023
006000     05  DK-STORE-NMBR                PIC X(04)  VALUE SPACES.    00600058
006100     05  DK-ENT-ID                    PIC S9(09) VALUE +0         00610036
006200                                                 COMP.            00620037
006300     05  DK-VILN-NBR                  PIC S9(09) VALUE +0         00630026
006400                                                 COMP.            00640037
006500                                                                  00650037
006600 01  PA-PROGRAM-ACCUMULATORS.                                     00660037
006700     05  PA-INVOICED-COUNT            PIC S9(09) VALUE +0         00670037
006800                                                 COMP-3.          00680037
006900     05  PA-AP-VERIFIED-COUNT         PIC S9(09) VALUE +0         00690037
007000                                                 COMP-3.          00700037
007100                                                                  00710037
007200 01  PC-PROGRAM-CONSTANTS.                                        00720037
007300     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS253'.00730037
007400     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC253A  '.00740037
007500     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM253 '.00750037
007600     05  PC-AUDIT-RTN                 PIC X(08)  VALUE 'RCKCS290'.00760037
007700     05  PC-AUDIT-RTN-LENGTH          PIC S9(04) VALUE  +300      00770037
007800                                                 COMP SYNC.       00780037
007900     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00790037
008000                                                 COMP.            00800037
008100     05  PC-A                         PIC X(01)  VALUE 'A'.       00810037
008200     05  PC-F                         PIC X(01)  VALUE 'F'.       00820037
008300     05  PC-I                         PIC X(01)  VALUE 'I'.       00830037
008400     05  PC-N                         PIC X(01)  VALUE 'N'.       00840037
008500     05  PC-U                         PIC X(01)  VALUE 'U'.       00850037
008600     05  PC-Y                         PIC X(01)  VALUE 'Y'.       00860037
008700     05  PC-DE                        PIC X(02)  VALUE 'DE'.      00870037
008800     05  PC-IN                        PIC X(02)  VALUE 'IN'.      00880037
008900     05  PC-VE                        PIC X(02)  VALUE 'VE'.      00890037
009000     05  PC-AC                        PIC X(02)  VALUE 'AC'.      00900037
009100     05  PC-INTER-APPL-CODES.                                     00910037
009200         10  PC-INTER-APPL-CRIT-DETAIL PIC X(01) VALUE '3'.       00920037
009300         10  PC-INTER-APPL-LIST        PIC X(01) VALUE '2'.       00930037
009400                                                                  00940037
009500******************************************************************00950037
009600* 00004 - PRESS F2 TO CONFIRM REQUEST                             00960037
009700* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          00970037
009800* 00069 - TOP OF LIST                                             00980037
009900* 00070 - BOTTOM OF LIST                                          00990037
010000* 00115 - DELETE SUCCESSFUL                                       01000037
010100* 00116 - CANNOT DELETE - RECORD DOES NOT EXIST                   01010037
010200* 00148 - DATA DOES NOT EXIST                                     01020037
010300* 00330 - ENTER DATA IN THE APPROPRIATE FIELD FOR THE FUNCTION    01030037
010400* 00789 - ** NO LONG DESCRIPTION OR CORRECTIVE ACTION FOUND **    01040037
010500* 00828 - CANNOT DELETE, RECEIVER OR RECEIPT ITEM VERIFIED        01050037
010600* 01819 - CANNOT DELETE RECEIVER - CASEPACK SPLIT PROCESS WAS PERF01060037
010700* 03269 - CANNOT DELETE RECEIVER - ACTIVE PACKSLIP EXIST          01070042
010800******************************************************************01080037
010900     05  PC-TSYMSG-NUMBERS.                                       01090037
011000         10  PC-TSYMSG-00004          PIC 9(05)  VALUE 00004.     01100037
011100         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01110037
011200         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01120037
011300         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01130037
011400         10  PC-TSYMSG-00115          PIC 9(05)  VALUE 00115.     01140037
011500         10  PC-TSYMSG-00116          PIC 9(05)  VALUE 00116.     01150037
011600         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01160037
011700         10  PC-TSYMSG-00330          PIC 9(05)  VALUE 00330.     01170037
011800         10  PC-TSYMSG-00789          PIC 9(05)  VALUE 00789.     01180037
011900         10  PC-TSYMSG-00828          PIC 9(05)  VALUE 00828.     01190037
012000         10  PC-TSYMSG-01819          PIC 9(05)  VALUE 01819.     01200037
012100         10  PC-TSYMSG-02972          PIC 9(05)  VALUE 02972.     01210061
012200         10  PC-TSYMSG-03269          PIC 9(05)  VALUE 03269.     01220042
012300                                                                  01230037
012400 01  PS-PROGRAM-SWITCHES.                                         01240037
012500     05  PS-SEQ-EOC-SW                PIC X(01)  VALUE 'N'.       01250061
012600         88  PS-EOC-SEQ                          VALUE 'Y'.       01260061
012700         88  PS-START-SEQ                        VALUE 'N'.       01270061
012800     05  PS-CHECKED-IN-FOUND-SW       PIC X(01)  VALUE 'N'.       01280061
012900         88  PS-CHECKED-IN-FOUND                 VALUE 'Y'.       01290061
013000         88  PS-NO-CHECKED-IN-FOUND              VALUE 'N'.       01300061
013100     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01310037
013200         88  PS-ERROR                            VALUE 'Y'.       01320037
013300         88  PS-NO-ERROR                         VALUE 'N'.       01330037
013400     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       01340037
013500         88  PS-LIST-END                         VALUE 'Y'.       01350037
013600         88  PS-NO-LIST-END                      VALUE 'N'.       01360037
013700     05  PS-TWKORIN-SW                PIC X(01)  VALUE 'N'.       01370037
013800         88  PS-END-OF-TWKORIN                   VALUE 'Y'.       01380037
013900         88  PS-NOT-END-OF-TWKORIN               VALUE 'N'.       01390037
014000     05  PS-TSHPTPO-SW                PIC X(01)  VALUE 'N'.       01400037
014100         88  PS-END-OF-TSHPTPO                   VALUE 'Y'.       01410037
014200         88  PS-NOT-END-OF-TSHPTPO               VALUE 'N'.       01420037
014300     05  PS-TWRKORD-SW                PIC X(01)  VALUE 'N'.       01430037
014400         88  PS-END-OF-TWRKORD                   VALUE 'Y'.       01440037
014500         88  PS-NOT-END-OF-TWRKORD               VALUE 'N'.       01450037
014600     05  PS-TPKSLIP-SW                PIC X(01)  VALUE 'N'.       01460037
014700         88  PS-END-OF-TPKSLIP                   VALUE 'Y'.       01470037
014800         88  PS-NOT-END-OF-TPKSLIP               VALUE 'N'.       01480037
014900     05  PS-TRECITM-SW                PIC X(01)  VALUE 'N'.       01490037
015000         88  PS-END-OF-TRECITM                   VALUE 'Y'.       01500037
015100         88  PS-NOT-END-OF-TRECITM               VALUE 'N'.       01510037
015200     05  PS-TRECEIV-SW                PIC X(01)  VALUE 'N'.       01520037
015300         88  PS-TRECEIV-FOUND                    VALUE 'Y'.       01530037
015400         88  PS-TRECEIV-NOT-FOUND                VALUE 'N'.       01540037
015500     05  ASC-CASEPACK-SW              PIC X(01)  VALUE 'N'.       01550037
015600         88  ASC-CASEPACK-FOUND                  VALUE 'Y'.       01560037
015700         88  ASC-CASEPACK-NOT-FOUND              VALUE 'N'.       01570037
015800     05  ASC-PKSL-STATUS-SW           PIC X(01)  VALUE 'N'.       01580043
015900         88  ASC-PKSL-ACTIVE                     VALUE 'Y'.       01590043
016000         88  ASC-PKSL-INACTIVE                   VALUE 'N'.       01600043
016100     05  PS-EOF-VILN-SW              PIC X(01)  VALUE 'N'.        01610023
016200         88  PS-EOF-VILN-CSR                     VALUE 'Y'.       01620023
016300                                                                  01630037
016400 01  PV-PROGRAM-VARIABLES.                                        01640037
016500     05  PV-SUB-CL-NBR-2CH            PIC X(02).                  01650059
016600     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.01660037
016700     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      01670037
016800                                                 COMP.            01680037
016900     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         01690037
017000                                                 COMP SYNC.       01700037
017100     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         01710037
017200                                                 COMP SYNC.       01720037
017300     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         01730037
017400                                                 COMP-3.          01740037
017500     05  PV-VERIFIED-COUNT            PIC S9(09) VALUE +0         01750037
017600                                                 COMP-3.          01760037
017700     05  PV-CARTON-COUNT              PIC S9(09) VALUE +0         01770062
017800                                                 COMP-3.          01780062
017900     05  PV-TRN-CDE                   PIC X VALUE SPACE.          01790037
018000     05  PV-CASEPACK-SPLIT-LINES      PIC S9(09) COMP.            01800037
018100     05  PV-ACTIVE-PACKSLIPS          PIC S9(09) COMP.            01810043
018200     05  PV-CURRENT-DATE              PIC X(06)  VALUE SPACE.     01820037
018300     05  PV-CURRENT-TIMESTAMP         PIC X(26)  VALUE SPACES.    01830037
018400     05  PV-DB2-DATE                  PIC  X(10).                 01840037
018500     05  FILLER  REDEFINES PV-DB2-DATE.                           01850037
018600         10  PV-DB2-DATE-CC           PIC  X(02).                 01860037
018700         10  PV-DB2-DATE-YY           PIC  X(02).                 01870037
018800         10  FILLER                   PIC  X(01).                 01880037
018900         10  PV-DB2-DATE-MM           PIC  X(02).                 01890037
019000         10  FILLER                   PIC  X(01).                 01900037
019100         10  PV-DB2-DATE-DD           PIC  X(02).                 01910037
019200     05  PV-DISPLAY-DATE.                                         01920037
019300         10  PV-DISPLAY-DATE-MM       PIC  X(02).                 01930037
019400         10  FILLER                   PIC  X(01) VALUE '/'.       01940037
019500         10  PV-DISPLAY-DATE-DD       PIC  X(02).                 01950037
019600         10  FILLER                   PIC  X(01) VALUE '/'.       01960037
019700         10  PV-DISPLAY-DATE-YY       PIC  X(02).                 01970037
019800     05  PV-DB2-TIMESTAMP             PIC  X(26).                 01980037
019900     05  FILLER  REDEFINES PV-DB2-TIMESTAMP.                      01990037
020000         10  PV-DB2-TMST-CC           PIC  X(02).                 02000037
020100         10  PV-DB2-TMST-YY           PIC  X(02).                 02010037
020200         10  FILLER                   PIC  X(01).                 02020037
020300         10  PV-DB2-TMST-MM           PIC  X(02).                 02030037
020400         10  FILLER                   PIC  X(01).                 02040037
020500         10  PV-DB2-TMST-DD           PIC  X(02).                 02050037
020600         10  FILLER                   PIC  X(01).                 02060037
020700         10  PV-DB2-TMST-HH           PIC  X(02).                 02070037
020800         10  FILLER                   PIC  X(01).                 02080037
020900         10  PV-DB2-TMST-MIN          PIC  X(02).                 02090037
021000         10  FILLER                   PIC  X(01).                 02100037
021100         10  PV-DB2-TMST-SS           PIC  X(02).                 02110037
021200         10  FILLER                   PIC  X(01).                 02120037
021300         10  PV-DB2-TMST-HS           PIC  X(06).                 02130037
021400     05  PV-ORIGINAL-UID              PIC  X(08).                 02140037
021500     05  PV-OPER-UNT-ID               PIC  9(04).                 02150037
021600     05  PV-OPER-UNT-ID-X REDEFINES                               02160037
021700         PV-OPER-UNT-ID               PIC  X(04).                 02170037
021800     05  PV-ABEND-MSG-KEYS.                                       02180037
021900         10  PV-MSG-PO                PIC  9(07).                 02190037
022000         10  FILLER                   PIC  X(01).                 02200037
022100         10  PV-MSG-RCVR              PIC  9(03).                 02210037
022200     05  PV-DISPLAY-PO                PIC  9(09).                 02220061
022300     05  PV-DISPLAY-RCVR              PIC  9(04).                 02230061
022400     05  PV-MESSAGE.                                              02240037
022500         10  PV-MESSAGE1                PIC X(10).                02250037
022600         10  PV-FILLER                  PIC X(01).                02260037
022700         10  PV-MESSAGE2                PIC X(10).                02270037
022800         10  PV-FILLER                  PIC X(01).                02280037
022900         10  PV-MESSAGE3                PIC X(10).                02290037
023000                                                                  02300037
023100 01  ST-SYSTEM-TIME-AREA.                                         02310037
023200     05  ST-ABSTIME                   PIC S9(16) VALUE +0         02320037
023300                                                 COMP SYNC.       02330037
023400     05  ST-TIME-EDIT.                                            02340037
023500         10  ST-TIME-HHMM             PIC X(05)  VALUE SPACES.    02350037
023600         10  FILLER                   PIC X(03)  VALUE SPACES.    02360037
023700                                                                  02370037
023800/                                                                 02380037
023900*---------------------------------------------------------------* 02390037
024000*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 02400037
024100*---------------------------------------------------------------* 02410037
024200                                                                  02420037
024300     COPY RCWS031.                                                02430037
024400                                                                  02440037
024500***************************************************************** 02450061
024600*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 02460061
024700*             FUNCTIONS                                        .* 02470061
024800***************************************************************** 02480061
024900     COPY RCWS071.                                                02490061
025000                                                                  02500061
025100/                                                                 02510037
025200*----------------------------------------------------------------*02520037
025300*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *02530037
025400*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *02540037
025500*----------------------------------------------------------------*02550037
025600                                                                  02560037
025700     COPY RCWS013.                                                02570037
025800                                                                  02580037
025900/                                                                 02590037
026000*----------------------------------------------------------------*02600037
026100*    MAP LAYOUT                                                  *02610037
026200*----------------------------------------------------------------*02620037
026300                                                                  02630037
026400     COPY RCKM253.                                                02640037
026500                                                                  02650037
026600/                                                                 02660059
026700*----------------------------------------------------------------*02670051
026800*    COPYBOOK FOR ITEM DATA CALL MODULE                           02680051
026900*-----------------------------------------------------------------02690051
027000     COPY XLWS001.                                                02700051
027100                                                                  02710051
027200/                                                                 02720037
027300*----------------------------------------------------------------*02730037
027400*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *02740037
027500*----------------------------------------------------------------*02750037
027600                                                                  02760037
027700     COPY DPWS003.                                                02770037
027800                                                                  02780037
027900/                                                                 02790037
028000*----------------------------------------------------------------*02800037
028100*    ATTRIBUTE SETTINGS COPYBOOK.                                *02810037
028200*----------------------------------------------------------------*02820037
028300                                                                  02830037
028400     COPY DPWS015.                                                02840037
028500                                                                  02850037
028600/                                                                 02860037
028700*----------------------------------------------------------------*02870037
028800*    FUNCTION KEYS COPYBOOK                                      *02880037
028900*----------------------------------------------------------------*02890037
029000                                                                  02900037
029100     COPY DPWS016.                                                02910037
029200                                                                  02920037
029300/                                                                 02930037
029400*----------------------------------------------------------------*02940037
029500*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *02950037
029600*    SUB-ROUTINE (RCKUT100).                                     *02960037
029700*----------------------------------------------------------------*02970037
029800     COPY DPWS010I.                                               02980037
029900                                                                  02990037
030000/                                                                 03000037
030100******************************************************************03010073
030200** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **03020073
030300** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **03030073
030400******************************************************************03040073
030500     COPY DPWS030.                                                03050037
030510     COPY DPWS930.                                                03051073
030600                                                                  03060037
030700/                                                                 03070037
030800*----------------------------------------------------------------*03080037
030900*    STANDARD COMMAREA.                                          *03090037
031000*----------------------------------------------------------------*03100037
031100                                                                  03110037
031200     COPY DPWS020.                                                03120037
031300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03130037
031400                                                                  03140037
031500*----------------------------------------------------------------*03150037
031600*    INTER-APPLICATION COMMAREA.                                 *03160037
031700*----------------------------------------------------------------*03170037
031800                                                                  03180037
031900         10  INTER-APPL-COMM-AREA PIC X(200).                     03190037
032000     COPY RCWS012.                                                03200037
032100     COPY RCWS015.                                                03210037
032200*----------------------------------------------------------------*03220037
032300*    SPECIFIC COMMMAREA FOR RCKCS253.                            *03230037
032400*----------------------------------------------------------------*03240037
032500         10  ASC-SPECIFIC-COMMAREA.                               03250037
032600             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             03260037
032700             15  ASC-USE-SELECTION-QUEUE-IND                      03270037
032800                                           PIC X(01).             03280037
032900                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        03290037
033000             15  ASC-SEL-QUEUE-NAME        PIC X(08).             03300037
033100             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     03310037
033200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03320037
033300                                           PIC S9(09) COMP-3.     03330037
033400             15  ASC-SEL-SUB               PIC S9(04) COMP.       03340037
033500             15  ASC-SEL-ITEM              PIC S9(04) COMP.       03350037
033600             15  ASC-DELETE-SUCCESSFUL-SW  PIC X(01).             03360037
033700                 88  ASC-DELETE-SUCCESSFUL      VALUE 'Y'.        03370037
033800             15  ASC-KEY-FIELDS.                                  03380037
033900                 20  ASC-KEY-PO-NBR        PIC S9(09) COMP.       03390037
034000                 20  ASC-KEY-REC-SEQ-NBR   PIC S9(09) COMP.       03400037
034100                 20  ASC-PO-NBR            PIC X(08).             03410037
034200                 20  ASC-PO-NBR-N REDEFINES ASC-PO-NBR            03420037
034300                                           PIC 9(08).             03430037
034400                 20  ASC-REC-SEQ-NBR       PIC X(04).             03440037
034500                 20  ASC-REC-SEQ-NBR-N REDEFINES                  03450037
034600                     ASC-REC-SEQ-NBR       PIC 9(04).             03460037
034700                 20  ASC-OPER-UNT-ID       PIC S9(04) COMP.       03470037
034800                 20  ASC-FCLTY-ID          PIC S9(04) COMP.       03480037
034900                 20  ASC-ENT-ID            PIC S9(09) COMP.       03490037
035000             15  ASC-SCREEN-FIELDS.                               03500037
035100                 20  ASC-PO-STATUS         PIC X(10).             03510037
035200                 20  ASC-RCVR-STATUS       PIC X(20).             03520037
035300                 20  ASC-VENDOR-NAME       PIC X(25).             03530037
035600                 20  ASC-BUYER-NAME        PIC X(25).             03560037
035700                 20  ASC-RCVR-CREATOR      PIC X(08).             03570037
035800                 20  ASC-REC-CLERK         PIC X(03).             03580037
035900                 20  ASC-DEPT              PIC X(03).             03590046
036000                 20  ASC-TROUB-STATUS-1    PIC X(11).             03600037
036100                 20  ASC-TROUB-STATUS-2    PIC X(11).             03610037
036200                 20  ASC-DO-NOT-SHIP-DATE  PIC X(08).             03620037
036300                 20  ASC-CARRIER           PIC X(04).             03630037
036400                 20  ASC-CANCEL-DATE       PIC X(08).             03640037
036500                 20  ASC-TRAILER-NBR       PIC X(10).             03650037
036600                 20  ASC-AD-DATE           PIC X(08).             03660037
036700                 20  ASC-PRO-NUMBER        PIC X(16).             03670037
036800                 20  ASC-BOL-NUMBER        PIC X(16).             03680037
036900                 20  ASC-AD-INFO           PIC X(04).             03690037
037000                 20  ASC-VDR-SHIP-DATE     PIC X(08).             03700037
037100                 20  ASC-SPEC-INSTRC       PIC X(25).             03710037
037200                 20  ASC-CARR-SHIP-DTE     PIC X(08).             03720037
037300                 20  ASC-TKT-FMT-ID        PIC X(06).             03730037
037400                 20  ASC-RCVR-NBR          PIC 9(08).             03740037
037500                 20  ASC-ARRIVAL-DATE      PIC X(08).             03750037
037600                 20  ASC-OPER-SET-ID       PIC X(03).             03760037
037700                 20  ASC-OPER-SET-ID-N REDEFINES                  03770037
037800                     ASC-OPER-SET-ID       PIC 9(03).             03780037
037900                 20  ASC-OPER-SET-DESC     PIC X(22).             03790037
038000                 20  ASC-PROC-INFO-ASN     PIC X(14).             03800037
038100                 20  ASC-PROC-INFO-PRE     PIC X(14).             03810037
038200                 20  ASC-PROC-INFO-PACK    PIC X(14).             03820037
038300                 20  ASC-RCV-CRE-DATE      PIC X(05).             03830037
038400                 20  ASC-RCV-CRE-TIME      PIC X(05).             03840037
038500                 20  ASC-EXPTED-CART-CNT   PIC X(05).             03850037
038600                 20  ASC-EXPTED-CART-CNT-N REDEFINES              03860037
038700                     ASC-EXPTED-CART-CNT   PIC 9(05).             03870037
038800                 20  ASC-PROC-INFO-EDI     PIC X(14).             03880037
038900                 20  ASC-TRANSCRIBE-DATE   PIC X(05).             03890037
039000                 20  ASC-TRANSCRIBE-TIME   PIC X(05).             03900037
039100                 20  ASC-ACTL-CART-CNT     PIC X(05).             03910037
039200                 20  ASC-ACTL-CART-CNT-N REDEFINES                03920037
039300                     ASC-ACTL-CART-CNT     PIC 9(05).             03930037
039400                 20  ASC-PROC-INFO-DET     PIC X(14).             03940037
039500                 20  ASC-MK-APRN-DATE      PIC X(05).             03950037
039600                 20  ASC-MK-APRN-TIME      PIC X(05).             03960037
039700                 20  ASC-DMG-CART-CNT      PIC X(05).             03970037
039800                 20  ASC-DMG-CART-CNT-N REDEFINES                 03980037
039900                     ASC-DMG-CART-CNT      PIC 9(05).             03990037
040000                 20  ASC-MK-HDR-DATE       PIC X(05).             04000037
040100                 20  ASC-MK-HDR-TIME       PIC X(05).             04010037
040200                 20  ASC-LAST-CHNG-DATE    PIC X(05).             04020037
040300                 20  ASC-LAST-CHNG-TIME    PIC X(05).             04030037
040400                 20  ASC-PCS-INVCD         PIC X(07).             04040037
040500                 20  ASC-PCS-INVCD-N REDEFINES ASC-PCS-INVCD      04050037
040600                                           PIC 9(07).             04060037
040700                 20  ASC-SHIPPED-DATE      PIC X(05).             04070037
040800                 20  ASC-SHIPPED-TIME      PIC X(05).             04080037
040900                 20  ASC-CHANGD-BY         PIC X(08).             04090037
041000                 20  ASC-PCS-VERFD         PIC X(07).             04100037
041100                 20  ASC-PCS-VERFD-N REDEFINES ASC-PCS-VERFD      04110037
041200                                           PIC 9(07).             04120037
041300                 20  ASC-PCS-VER-DATE      PIC X(05).             04130037
041400                 20  ASC-PCS-VER-TIME      PIC X(05).             04140037
041500                 20  ASC-ATL-OPER-UNT-ID   PIC 9(04).             04150037
041600                 20  ASC-ATL-FCLTY-ID      PIC 9(04).             04160037
041700                 20  ASC-CUR-OPER-UNT-ID   PIC 9(04).             04170037
041800                 20  ASC-CUR-FCLTY-ID      PIC 9(04).             04180037
041900                 20  ASC-ORIG-OPER-UNT-ID  PIC 9(04).             04190037
042000                 20  ASC-ORIG-FCLTY-ID     PIC 9(04).             04200037
042100                 20  ASC-APRON-LOC-DESC    PIC X(08).             04210037
042200                                                                  04220037
042300/                                                                 04230037
042400*----------------------------------------------------------------*04240037
042500*    ABEND PROCESSING COPYBOOK.                                  *04250037
042600*----------------------------------------------------------------*04260037
042700                                                                  04270037
042800     COPY DPWS013.                                                04280037
042900                                                                  04290037
043000/                                                                 04300037
043100*---------------------------------------------------------------* 04310037
043200*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 04320037
043300*---------------------------------------------------------------* 04330037
043400     EXEC SQL                                                     04340037
043500          INCLUDE TPURCHS                                         04350037
043600     END-EXEC.                                                    04360037
043700                                                                  04370037
043800/                                                                 04380037
043900*---------------------------------------------------------------* 04390037
044000*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * 04400037
044100*---------------------------------------------------------------* 04410037
044200     EXEC SQL                                                     04420037
044300          INCLUDE TPURITM                                         04430037
044400     END-EXEC.                                                    04440037
044500                                                                  04450037
044600/                                                                 04460037
044700*---------------------------------------------------------------* 04470037
044800*    DB2 AREA FOR THE PO STATUS CODE TABLE                      * 04480037
044900*---------------------------------------------------------------* 04490037
045000     EXEC SQL                                                     04500037
045100          INCLUDE TSTATCD                                         04510037
045200     END-EXEC.                                                    04520037
045300                                                                  04530037
045400/                                                                 04540037
045500*---------------------------------------------------------------* 04550037
045600*    DB2 AREA FOR THE PO INSTRUCTIONS TABLE                     * 04560037
045700*---------------------------------------------------------------* 04570037
045800     EXEC SQL                                                     04580037
045900          INCLUDE TPOINST                                         04590037
046000     END-EXEC.                                                    04600037
046100                                                                  04610037
046200/                                                                 04620037
046300*---------------------------------------------------------------* 04630037
046400*    DB2 AREA FOR THE PO INSTRUCTION CODE TABLE                 * 04640037
046500*---------------------------------------------------------------* 04650037
046600     EXEC SQL                                                     04660037
046700          INCLUDE TINSTCD                                         04670037
046800     END-EXEC.                                                    04680037
046900                                                                  04690037
047000/                                                                 04700037
047100*---------------------------------------------------------------* 04710037
047200*    DB2 AREA FOR THE PLANNED SHIPMENTS TABLE                   * 04720037
047300*---------------------------------------------------------------* 04730037
047400     EXEC SQL                                                     04740037
047500          INCLUDE TPLNSHP                                         04750037
047600     END-EXEC.                                                    04760037
047700                                                                  04770037
047800/                                                                 04780037
047900*---------------------------------------------------------------* 04790037
048000*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 04800037
048100*---------------------------------------------------------------* 04810037
048200     EXEC SQL                                                     04820037
048300          INCLUDE TENTNME                                         04830037
048400     END-EXEC.                                                    04840037
048500                                                                  04850037
048600/                                                                 04860037
048700*---------------------------------------------------------------* 04870037
048800*    DB2 AREA FOR RECEIVER TABLE                                * 04880037
048900*---------------------------------------------------------------* 04890037
049000     EXEC SQL                                                     04900037
049100          INCLUDE TRECEIV                                         04910037
049200     END-EXEC.                                                    04920037
049300                                                                  04930037
049400/                                                                 04940037
049500*---------------------------------------------------------------* 04950037
049600*    DB2 AREA FOR RECEIVER ITEM TABLE                           * 04960037
049700*---------------------------------------------------------------* 04970037
049800     EXEC SQL                                                     04980037
049900          INCLUDE TRECITM                                         04990037
050000     END-EXEC.                                                    05000037
050100                                                                  05010037
050200/                                                                 05020037
050300*---------------------------------------------------------------* 05030037
050400*    DB2 AREA FOR RECEIVER DISTRIBUTION TABLE                   * 05040037
050500*---------------------------------------------------------------* 05050037
050600     EXEC SQL                                                     05060037
050700          INCLUDE TRECDIS                                         05070037
050800     END-EXEC.                                                    05080037
050900                                                                  05090037
051000/                                                                 05100037
051100*---------------------------------------------------------------* 05110037
051200*    DB2 AREA FOR SHIPMENT TABLE                                * 05120037
051300*---------------------------------------------------------------* 05130037
051400     EXEC SQL                                                     05140037
051500          INCLUDE TSHIPMT                                         05150037
051600     END-EXEC.                                                    05160037
051700                                                                  05170037
051800/                                                                 05180037
051900*---------------------------------------------------------------* 05190037
052000*    DB2 AREA FOR SHIPMENT PO TABLE                             * 05200037
052100*---------------------------------------------------------------* 05210037
052200     EXEC SQL                                                     05220037
052300          INCLUDE TSHPTPO                                         05230037
052400     END-EXEC.                                                    05240037
052500                                                                  05250037
052600*---------------------------------------------------------------* 05260037
052700*    DB2 AREA FOR SHIPMENT PO AUDIT TABLE                       * 05270037
052800*---------------------------------------------------------------* 05280037
052900     EXEC SQL                                                     05290037
053000          INCLUDE TAUSHPO                                         05300037
053100     END-EXEC.                                                    05310037
053200                                                                  05320037
053300/                                                                 05330037
053400*---------------------------------------------------------------* 05340037
053500*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 05350037
053600*---------------------------------------------------------------* 05360037
053700     EXEC SQL                                                     05370037
053800          INCLUDE TVHTRIP                                         05380037
053900     END-EXEC.                                                    05390037
054000                                                                  05400037
054100*---------------------------------------------------------------* 05410037
054200*    DB2 AREA FOR VEHICLE TABLE                                 * 05420037
054300*---------------------------------------------------------------* 05430037
054400     EXEC SQL                                                     05440037
054500          INCLUDE TVEHICL                                         05450037
054600     END-EXEC.                                                    05460037
054700                                                                  05470037
054800/                                                                 05480037
055700*---------------------------------------------------------------* 05570037
055800*    DB2 AREA FOR TICKET FORMAT ASSIGNMENTS                     * 05580037
055900*---------------------------------------------------------------* 05590037
056000     EXEC SQL                                                     05600037
056100          INCLUDE TDCTFAS                                         05610037
056200     END-EXEC.                                                    05620037
056300                                                                  05630037
056400/                                                                 05640037
057300*---------------------------------------------------------------* 05730037
057400*    DB2 AREA FOR THE PACKING SLIP TABLE                        * 05740037
057500*---------------------------------------------------------------* 05750037
057600     EXEC SQL                                                     05760037
057700          INCLUDE TPKSLIP                                         05770037
057800     END-EXEC.                                                    05780037
057900                                                                  05790037
058000     EXEC SQL                                                     05800062
058100          INCLUDE TINPKSU                                         05810062
058200     END-EXEC.                                                    05820062
058300                                                                  05830062
058400     EXEC SQL                                                     05840062
058500          INCLUDE TSHUUPC                                         05850062
058600     END-EXEC.                                                    05860062
058700                                                                  05870063
058800     EXEC SQL                                                     05880063
058900          INCLUDE TSHUNLO                                         05890063
059000     END-EXEC.                                                    05900063
059100                                                                  05910062
059200     EXEC SQL                                                     05920063
059300          INCLUDE TSULBXF                                         05930063
059400     END-EXEC.                                                    05940063
059500                                                                  05950063
059600/                                                                 05960037
059700*---------------------------------------------------------------* 05970037
059800*    DB2 AREA FOR THE PACKING SLIP ITEM TABLE                   * 05980037
059900*---------------------------------------------------------------* 05990037
060000     EXEC SQL                                                     06000037
060100          INCLUDE TPKITEM                                         06010037
060200     END-EXEC.                                                    06020037
060300                                                                  06030037
060400/                                                                 06040037
060500*---------------------------------------------------------------* 06050037
060600*    DB2 AREA FOR THE UNMATCHED PACK SLIP ITEM TABLE            * 06060037
060700*---------------------------------------------------------------* 06070037
060800     EXEC SQL                                                     06080037
060900          INCLUDE TUNPKSL                                         06090037
061000     END-EXEC.                                                    06100037
061100                                                                  06110037
061200/                                                                 06120037
061300*----------------------------------------------------------------*06130037
061400*    DB2 AREA FOR OPERATION SET TABLE                            *06140037
061500*----------------------------------------------------------------*06150037
061600                                                                  06160037
061700     EXEC SQL                                                     06170037
061800          INCLUDE TOPRSET                                         06180037
061900     END-EXEC.                                                    06190037
062000                                                                  06200037
062100/                                                                 06210037
062200*----------------------------------------------------------------*06220037
062300*    DB2 AREA FOR WORK ORDER TABLE                               *06230037
062400*----------------------------------------------------------------*06240037
062500                                                                  06250037
062600     EXEC SQL                                                     06260037
062700          INCLUDE TWRKORD                                         06270037
062800     END-EXEC.                                                    06280037
062900                                                                  06290037
063000/                                                                 06300037
063100*----------------------------------------------------------------*06310037
063200*    DB2 AREA FOR WORK ORDER INSTRUCTION TABLE                   *06320037
063300*----------------------------------------------------------------*06330037
063400                                                                  06340037
063500     EXEC SQL                                                     06350037
063600          INCLUDE TWKORIN                                         06360037
063700     END-EXEC.                                                    06370037
063800                                                                  06380037
063900*----------------------------------------------------------------*06390037
064000*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06400037
064100*----------------------------------------------------------------*06410037
064200     EXEC SQL                                                     06420037
064300          INCLUDE TTRBNTF                                         06430037
064400     END-EXEC.                                                    06440037
064500/                                                                 06450037
064600*----------------------------------------------------------------*06460037
064700*    DB2 DCLGEN FOR THE ODD UNIT TABLE                            06470037
064800*----------------------------------------------------------------*06480037
064900     EXEC SQL                                                     06490037
065000          INCLUDE RCT00009                                        06500037
065100     END-EXEC.                                                    06510037
065200/                                                                 06520037
065300*----------------------------------------------------------------*06530037
065400*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      06540037
065500*----------------------------------------------------------------*06550037
065600     EXEC SQL                                                     06560037
065700          INCLUDE TTRBRSN                                         06570037
065800     END-EXEC.                                                    06580037
065900/                                                                 06590037
066000*                                                                 06600038
066100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          06610038
066200*  LOCATION TABLE                                                 06620038
066300*  (XLT_LOC)                                                      06630038
066400*                                                                 06640038
066500     EXEC SQL                                                     06650038
066600          INCLUDE XLT00010                                        06660038
066700     END-EXEC.                                                    06670038
066800                                                                  06680038
066900                                                                  06690037
067000*----------------------------------------------------------------*06700037
067100*    DC-DISTRIBUTION TRANSACTION HEADER                           06710037
067200*----------------------------------------------------------------*06720037
067300     EXEC SQL                                                     06730037
067400          INCLUDE TDISTHD                                         06740037
067500     END-EXEC.                                                    06750037
067600/                                                                 06760037
067700     EXEC SQL                                                     06770037
067800          INCLUDE TVILN                                           06780037
067900     END-EXEC.                                                    06790037
068000                                                                  06800037
068100/                                                                 06810037
068200     EXEC SQL                                                     06820037
068300          INCLUDE TVILNLN                                         06830037
068400     END-EXEC.                                                    06840037
068500/                                                                 06850037
068600     EXEC SQL                                                     06860037
068700          INCLUDE TVILSTA                                         06870037
068800     END-EXEC.                                                    06880037
068900/                                                                 06890037
069000     EXEC SQL                                                     06900037
069100          INCLUDE TVMNEVD                                         06910037
069200     END-EXEC.                                                    06920037
069300/                                                                 06930037
069400                                                                  06940037
069500*---------------------------------------------------------------* 06950037
069600*    DB2 AREA FOR COMMUNICATIONS                                * 06960037
069700*---------------------------------------------------------------* 06970037
069800     EXEC SQL                                                     06980037
069900          INCLUDE SQLCA                                           06990037
070000     END-EXEC.                                                    07000037
070100                                                                  07010037
070200     EXEC SQL                                                     07020037
070300       DECLARE SHIP_CSR CURSOR FOR                                07030037
070400         SELECT  A.TRIP_ID                                        07040037
070500                ,A.SHIPT_ID                                       07050037
070600                ,A.CRT_SRC_CDE                                    07060037
070700                ,A.LAST_UPD_DTE                                   07070037
070800                ,A.LAST_UPD_TME                                   07080037
070900                ,A.LAST_UPD_UID                                   07090037
071000                ,A.PRO_SCAC_ID                                    07100037
071100                ,A.PRO_NBR                                        07110037
071200                ,A.BOL_NBR                                        07120037
071300                ,A.SHIPPER_NME                                    07130037
071400                ,A.SHIPT_TYP_CDE                                  07140037
071500                ,A.EXPTED_GRO_WGHT                                07150037
071600                ,A.PKG_TYP_CDE                                    07160037
071700                ,A.EXPTED_PKG_QTY                                 07170037
071800                ,A.FRGT_CHG_AMT                                   07180037
071900                ,A.FRGT_TERMS_CDE                                 07190037
072000                ,A.EXPTED_PLT_QTY                                 07200037
072100                ,A.VEND_SHIP_DTE                                  07210037
072200                ,A.EST_AR_TMST                                    07220037
072300                ,A.ORIG_SCAC_ID                                   07230037
072400                ,A.LAST_UPD_PGM_ID                                07240037
072500                ,A.CRE_USER_ID                                    07250037
072600                ,A.CARR_CART_CT                                   07260037
072700                ,A.CARR_LAST_UPD_DTE                              07270037
072800                ,A.CARR_LAST_UPD_TIME                             07280037
072900                ,A.VEND_CART_CT                                   07290037
073000                ,A.VEND_LAST_UPD_DTE                              07300037
073100                ,A.VEND_LAST_UPD_TIME                             07310037
073200                ,A.VEH_NBR                                        07320037
073300                ,A.AUTH_NBR                                       07330037
073400                ,A.AUTH_DTE                                       07340037
073500                ,A.CONFIRM_DTE                                    07350037
073600                ,A.CONFIRM_TIME                                   07360037
073700                ,A.COMPLETE_PRO_NBR                               07370037
073800                ,A.COMPLETE_BOL_NBR                               07380037
073900                ,A.PROCESSED_DTE                                  07390037
074000                ,A.INVC_NBR                                       07400037
074100       FROM   TSHIPMT A                                           07410037
074200       WHERE  A.TRIP_ID         = :SHIPMT-TRIP-ID                 07420037
074300     END-EXEC                                                     07430037
074400/                                                                 07440037
074500*---------------------------------------------------------------* 07450037
074600*  CURSOR TO SELECT ALL WORKORDER INSTRUCTIONS FOR THE RECEIVER * 07460037
074700*---------------------------------------------------------------* 07470037
074800                                                                  07480037
074900     EXEC SQL                                                     07490037
075000          DECLARE TWKORIN-CSR CURSOR FOR                          07500037
075100              SELECT ORD_NBR                                      07510037
075200                   , RCVR_SEQ_NBR                                 07520037
075300                   , ORD_LNE_NBR                                  07530037
075400                   , WORK_ORD_SEQ_NBR                             07540037
075500                   , OPER_UNT_ID                                  07550037
075600                   , FCLTY_ID                                     07560037
075700                   , WO_INSTR_SEQ_NBR                             07570037
075800                   , CRE_TMST                                     07580037
075900                   , VER_STATUS_CDE                               07590037
076000                   , CRE_UID_ID                                   07600037
076100                   , OPER_ID                                      07610037
076200                   , FCLTY_AREA_ID                                07620037
076300                   , PRC_FCLTY_AREA_ID                            07630037
076400                   , EXPTED_CART_CNT                              07640037
076500                   , ACTL_CART_CNT                                07650037
076600                   , ALLOC_IND                                    07660037
076700                   , REPACK_IND                                   07670037
076800                   , STRT_TMST                                    07680037
076900                   , STOP_TMST                                    07690037
077000                   , SCREEN_SEQ_NBR                               07700037
077100                   , LNE_LOC_CDE                                  07710037
077200                   , REC_SEL_IND                                  07720037
077300                FROM TWKORIN                                      07730037
077400               WHERE ORD_NBR          = :DK-PO-NBR                07740037
077500                 AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR           07750037
077600                 AND OPER_UNT_ID      = :DK-OPER-UNT-ID           07760037
077700                 AND FCLTY_ID         = :DK-FCLTY-ID              07770037
077800                 AND ORD_LNE_NBR      = :WRKORD-ORD-LNE-NBR       07780037
077900                 AND WORK_ORD_SEQ_NBR = :WRKORD-WORK-ORD-SEQ-NBR  07790037
078000                 AND VER_STATUS_CDE   = :PC-A                     07800037
078100     END-EXEC.                                                    07810037
078200                                                                  07820037
078300/                                                                 07830037
078400*---------------------------------------------------------------* 07840037
078500*  CURSOR TO SELECT ALL WORK ORDERS FOR THE RECEIVER            * 07850037
078600*---------------------------------------------------------------* 07860037
078700                                                                  07870037
078800     EXEC SQL                                                     07880037
078900          DECLARE TWRKORD-CSR CURSOR FOR                          07890037
079000              SELECT ORD_NBR                                      07900037
079100                   , RCVR_SEQ_NBR                                 07910037
079200                   , ORD_LNE_NBR                                  07920037
079300                   , WORK_ORD_SEQ_NBR                             07930037
079400                   , OPER_UNT_ID                                  07940037
079500                   , FCLTY_ID                                     07950037
079600                   , CRE_TMST                                     07960037
079700                   , VER_STATUS_CDE                               07970037
079800                   , CRE_UID_ID                                   07980037
079900                   , EXPTED_CART_CNT                              07990037
080000                   , ACTL_CART_CNT                                08000037
080100                   , EXPTED_ITM_CNT                               08010037
080200                   , ACTL_ITM_CNT                                 08020037
080300                   , STAT_CDE                                     08030037
080400                   , WORK_ORD_DISTR_IND                           08040037
080500                   , OPER_SET_ID                                  08050037
080600                FROM TWRKORD                                      08060037
080700               WHERE ORD_NBR        = :DK-PO-NBR                  08070037
080800                 AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR             08080037
080900                 AND OPER_UNT_ID    = :DK-OPER-UNT-ID             08090037
081000                 AND FCLTY_ID       = :DK-FCLTY-ID                08100037
081100                 AND VER_STATUS_CDE = :PC-A                       08110037
081200     END-EXEC.                                                    08120037
081300                                                                  08130037
081400/                                                                 08140037
081500*---------------------------------------------------------------* 08150037
081600*  CURSOR TO SELECT ALL PACK SLIP ITEMS FOR THE RECEIVER        * 08160037
081700*---------------------------------------------------------------* 08170037
081800                                                                  08180037
081900     EXEC SQL                                                     08190037
082000          DECLARE TPKITEM-CSR CURSOR FOR                          08200037
082100              SELECT PO_NBR                                       08210037
082200                   , SEQ_NBR                                      08220037
082300                   , PKSL_LNE_NBR                                 08230037
082400                   , CRE_TMST                                     08240037
082500                   , VER_STAT_CDE                                 08250037
082600                   , PKSL_ITM_QTY                                 08260037
082700                   , CRE_UID                                      08270037
082800                   , PURITM_VER_NBR                               08280037
082900                FROM TPKITEM                                      08290037
083000               WHERE PO_NBR       = :DK-PO-NBR                    08300037
083100                 AND SEQ_NBR      = :PKSLIP-SEQ-NBR               08310037
083200                 AND VER_STAT_CDE = :PC-A                         08320037
083300     END-EXEC.                                                    08330037
083400                                                                  08340037
083500/                                                                 08350037
083600*---------------------------------------------------------------* 08360037
083700*  CURSOR TO SELECT UNMATCHED PACK SLIP ITEMS FOR THE RECEIVER  * 08370037
083800*---------------------------------------------------------------* 08380037
083900                                                                  08390037
084000     EXEC SQL                                                     08400037
084100          DECLARE TUNPKSL-CSR CURSOR FOR                          08410037
084200              SELECT PO_NBR                                       08420037
084300                   , SEQ_NBR                                      08430037
084400                   , PKSL_LNE_NBR                                 08440037
084500                   , CRE_TMST                                     08450037
084600                   , VER_STAT_CDE                                 08460037
084700                   , PKSL_ITM_QTY                                 08470037
084800                   , UNT_COST_AMT                                 08480037
084900                   , COLOR_DESC                                   08490037
085000                   , SIZE_DESC                                    08500037
085100                   , VEND_STYL_NAME                               08510037
085200                   , VEND_DESC                                    08520037
085300                   , CRE_UID                                      08530037
085400                FROM TUNPKSL                                      08540037
085500               WHERE PO_NBR       = :DK-PO-NBR                    08550037
085600                 AND SEQ_NBR      = :PKSLIP-SEQ-NBR               08560037
085700                 AND VER_STAT_CDE = :PC-A                         08570037
085800     END-EXEC.                                                    08580037
085900                                                                  08590037
086000/                                                                 08600037
086100*---------------------------------------------------------------* 08610037
086200*  CURSOR TO SELECT PACK SLIPS FOR THE RECEIVER                 * 08620037
086300*---------------------------------------------------------------* 08630037
086400                                                                  08640037
086500     EXEC SQL                                                     08650037
086600          DECLARE TPKSLIP-CSR CURSOR FOR                          08660037
086700              SELECT DISTINCT                                     08670037
086800                     PO_NBR                                       08680037
086900                   , SEQ_NBR                                      08690037
087000                   , CRE_TMST                                     08700037
087100                   , VER_STAT_CDE                                 08710037
087200                   , OPER_UNT_ID                                  08720037
087300                   , FCLTY_ID                                     08730037
087400                   , PKSL_NBR                                     08740037
087500                   , STR_DEST_NBR                                 08750037
087600                   , REC_SEQ_NBR                                  08760037
087700                   , SHIPT_ID                                     08770037
087800                   , BOL_NBR                                      08780037
087900                   , PRO_NBR                                      08790037
088000                   , PKSL_STAT_CDE                                08800037
088100                   , CRE_UID                                      08810037
088200                   , PO_VER_NBR                                   08820037
088300                   , CRE_SRC_CDE                                  08830037
088400                   , EXPTED_PKG_QTY                               08840037
088500                   , OWNER_SCAC_ID                                08850037
088600                   , ASN_NBR                                      08860037
088700                   , VEND_SHIP_DTE                                08870037
088800                   , CONTNR_ID                                    08880037
088900                   , ORIG_PKSL_SEQ_NBR                            08890037
089000                FROM TPKSLIP                                      08900037
089100               WHERE PO_NBR       = :DK-PO-NBR                    08910037
089200                 AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR               08920037
089300                 AND OPER_UNT_ID  = :DK-OPER-UNT-ID               08930037
089400                 AND FCLTY_ID     = :DK-FCLTY-ID                  08940037
089500                 AND VER_STAT_CDE = :PC-A                         08950037
089600               ORDER BY CRE_UID                                   08960037
089700     END-EXEC.                                                    08970037
089800                                                                  08980037
089900/                                                                 08990037
090000*---------------------------------------------------------------* 09000037
090100*  CURSOR TO SELECT ALL RECEIPT ITEMS FOR THE RECEIVER          * 09010037
090200*---------------------------------------------------------------* 09020037
090300                                                                  09030037
090400     EXEC SQL                                                     09040037
090500          DECLARE TRECITM-CSR CURSOR FOR                          09050037
090600              SELECT ORD_NBR                                      09060037
090700                   , ORD_LNE_NBR                                  09070037
090800                   , REC_SEQ_NBR                                  09080037
090900                   , OPER_UNT_ID                                  09090037
091000                   , FCLTY_ID                                     09100037
091100                   , CRE_TMST                                     09110037
091200                   , CRE_UID                                      09120037
091300                   , PO_VER_NBR                                   09130037
091400                   , ITM_NBR                                      09140037
091500                   , PRE_TKT_IND                                  09150037
091600                   , TKT_FMT_ID                                   09160037
091700                   , RTV_IND                                      09170037
091800                   , STATUS_CDE                                   09180037
091900                   , VER_STATUS_CDE                               09190037
092000                   , PKSL_ITM_QTY                                 09200037
092100                   , DTL_CK_ITM_QTY                               09210037
092200                   , INNR_PACK_QTY                                09220037
092300                   , CASE_PACK_QTY                                09230037
092400                   , RTV_QTY                                      09240037
092500                   , EXPTED_CART_CNT                              09250037
092600                   , ACTL_CART_CNT                                09260037
092700                   , MKING_APRON_TMST                             09270037
092800                   , UNT_COST_AMT                                 09280037
092900                   , COLOR_DESC                                   09290037
093000                   , SIZE_DESC                                    09300037
093100                   , VEND_STYL_NAME                               09310037
093200                   , VEND_DESC                                    09320037
093300                   , VERFYD_TMST                                  09330037
093400                   , PKSL_NBR                                     09340037
093500                   , REC_INV_LNE_NBR                              09350037
093600                   , DMG_ITM_QTY                                  09360037
093700                   , UPD_TMST                                     09370037
093800                   , UPD_UID                                      09380037
093900                   , UPD_PGM_ID                                   09390037
094000                   , RCPT_DISTR_UPD_CDE                           09400037
094100                   , VRFD_USR_ID                                  09410037
094200                   , LAST_TRSCP_TMST                              09420037
094300                   , LAST_TRSCP_USR_ID                            09430037
094400                   , PREPK_ID                                     09440062
094500                   , CURRENT TIMESTAMP                            09450037
094600                FROM TRECITM                                      09460037
094700               WHERE ORD_NBR        = :DK-PO-NBR                  09470037
094800                 AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR             09480037
094900                 AND VER_STATUS_CDE = :PC-A                       09490037
095000     END-EXEC.                                                    09500037
095100                                                                  09510037
095200/                                                                 09520037
095300*---------------------------------------------------------------* 09530037
095400*  CURSOR TO SELECT ALL THE SHPTPO RECS FOR A RECEIVER          * 09540037
095500*---------------------------------------------------------------* 09550037
095600                                                                  09560037
095700     EXEC SQL                                                     09570037
095800          DECLARE TSHPTPO-CSR CURSOR FOR                          09580037
095900              SELECT SHIPT_ID                                     09590037
096000                FROM TSHPTPO                                      09600037
096100               WHERE PO_NBR       = :DK-PO-NBR                    09610037
096200                 AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR               09620037
096300     END-EXEC.                                                    09630037
096400                                                                  09640037
096500     EXEC SQL                                                     09650037
096600         DECLARE VILN-CSR CURSOR FOR                              09660037
096700              SELECT VILN_NBR                                     09670037
096800                FROM TVILN                                        09680037
096900               WHERE ENT_ID       = :DK-ENT-ID                    09690037
097000                 AND PO_NBR       = :DK-PO-NBR                    09700037
097100                 AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR               09710037
097200     END-EXEC.                                                    09720037
097300                                                                  09730037
097400 LINKAGE SECTION.                                                 09740037
097500                                                                  09750037
097600 01  DFHCOMMAREA.                                                 09760037
097700     05  FILLER                       OCCURS  1 TO 4072 TIMES     09770037
097800                                      DEPENDING ON EIBCALEN.      09780037
097900         10  FILLER                   PIC X.                      09790037
098000                                                                  09800037
098100/                                                                 09810037
098200 PROCEDURE DIVISION.                                              09820037
098300                                                                  09830037
098400*----------------------------------------------------------------*09840037
098500*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *09850037
098600*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *09860037
098700*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *09870037
098800*                                                                *09880037
098900*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *09890037
099000*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *09900037
099100*----------------------------------------------------------------*09910037
099200 0000-MAIN-MODULE.                                                09920037
099300                                                                  09930037
099400     INITIALIZE DP030-CICS-API-FIELDS.                            09940037
099500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09950037
099600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09960037
099700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09970037
099800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09980037
099900     MOVE LENGTH OF RC253AI        TO DP030-MAP-LENGTH (1).       09990037
100000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10000037
100100     PERFORM 0001-CALL-CICS-ARCH-API.                             10010037
100200                                                                  10020037
100300     PERFORM 1000-CONTROL-PROCESSING.                             10030037
100400                                                                  10040037
100500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10050037
100600     PERFORM 0001-CALL-CICS-ARCH-API.                             10060037
100700                                                                  10070037
100800                                                                  10080037
100900 0001-CALL-CICS-ARCH-API.                                         10090037
101000                                                                  10100037
101110     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10111073
101200                                    DFHCOMMAREA                   10120073
101300                                    DP030-CICS-API-FIELDS         10130073
101400                                    DP020-STANDARD-COMMAREA       10140073
101500                                    RC253AI.                      10150073
101600                                                                  10160037
101700     IF  DP030-RC-CALL-SUCCESSFUL                                 10170037
101800         CONTINUE                                                 10180037
101900     ELSE                                                         10190037
102000         SET DP013-NO-ROLLBACK                                    10200037
102100             DP013-XCTL-DISPLAY-RESTART                           10210037
102200             DP013-CICS-ABEND      TO TRUE                        10220037
102300         MOVE 'BEFORE 0000-MAIN-MODULE'                           10230037
102400                                   TO DP013-PARAGRAPH             10240037
102420         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O10242073
102430-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10243073
102700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10270037
102800         PERFORM DP013-0000-PROCESS-ABEND                         10280037
102900     END-IF.                                                      10290037
103000                                                                  10300037
103100                                                                  10310037
103200*----------------------------------------------------------------*10320037
103300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *10330037
103400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *10340037
103500*----------------------------------------------------------------*10350037
103600                                                                  10360037
103700 1000-CONTROL-PROCESSING.                                         10370037
103800                                                                  10380037
103900     EVALUATE TRUE                                                10390037
104000         WHEN DP020-NEXT-ACT-INITIAL                              10400037
104100              PERFORM 1100-FIND-OBJECT-KEYS                       10410037
104200              IF  PS-ERROR                                        10420037
104300                  CONTINUE                                        10430037
104400              ELSE                                                10440037
104500                  PERFORM 4000-BUILD-INITIAL-PANEL                10450037
104600                  PERFORM 3200-RESET-ATTRIBUTES                   10460037
104700              END-IF                                              10470037
104800                                                                  10480037
104900         WHEN DP020-NEXT-ACT-READ-MAP                             10490037
105000              PERFORM 2000-PROCESS-PANEL                          10500037
105100                                                                  10510037
105200         WHEN DP020-NEXT-ACT-RETURN                               10520037
105300              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10530037
105400              PERFORM 3200-RESET-ATTRIBUTES                       10540037
105500                                                                  10550037
105600         WHEN OTHER                                               10560037
105700              SET DP013-LOGIC-ABEND                               10570037
105800                  DP013-NO-ROLLBACK                               10580037
105900                                   TO TRUE                        10590037
106000              MOVE '1000-CONTROL-PROCESSING'                      10600037
106100                                   TO DP013-PARAGRAPH             10610037
106200              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  10620037
106300                                   TO DP013-MESSAGE-TEXT(1)       10630037
106400              MOVE DP020-NEXT-APPL-ACTIVITY                       10640037
106500                                   TO DP013-MESSAGE-TEXT(2)       10650037
106600              PERFORM DP013-0000-PROCESS-ABEND                    10660037
106700     END-EVALUATE.                                                10670037
106800                                                                  10680037
106900/                                                                 10690037
107000*----------------------------------------------------------------*10700037
107100*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *10710037
107200*    INTER-APPLICATION FORMAT CODE.                              *10720037
107300*----------------------------------------------------------------*10730037
107400 1100-FIND-OBJECT-KEYS.                                           10740037
107500                                                                  10750037
107600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            10760037
107700                                                                  10770037
107800     MOVE DP020-INT-APPL-FORMAT-IND                               10780037
107900                                   TO ASC-INT-APPL-FORMAT-IND.    10790037
108000     MOVE PC-TSYMSG-00004          TO DP020-MSG-NUMBER.           10800037
108100     SET DP020-MSG-INFORMATIONAL   TO TRUE.                       10810037
108200                                                                  10820037
108300     EVALUATE DP020-INT-APPL-FORMAT-IND                           10830037
108400         WHEN PC-INTER-APPL-CRIT-DETAIL                           10840037
108500             IF  RC012-PO-NBR      = ZEROES                       10850037
108600             AND RC012-REC-SEQ-NBR = ZEROES                       10860037
108700                 MOVE PC-TSYMSG-00330                             10870037
108800                                   TO DP020-MSG-NUMBER            10880037
108900                 SET PS-ERROR                                     10890037
109000                     DP020-MSG-FATAL                              10900037
109100                     DP020-NEXT-ACT-APPL-ERROR                    10910037
109200                                   TO TRUE                        10920037
109300             END-IF                                               10930037
109400                                                                  10940037
109500             IF  PS-NO-ERROR                                      10950037
109600             AND RC012-OPER-UNT-ID = ZEROES                       10960037
109700             AND RC012-FCLTY-ID    = ZEROES                       10970037
109800                 MOVE PC-TSYMSG-00789                             10980037
109900                                   TO DP020-MSG-NUMBER            10990037
110000                 SET PS-ERROR                                     11000037
110100                     DP020-MSG-FATAL                              11010037
110200                     DP020-NEXT-ACT-APPL-ERROR                    11020037
110300                                   TO TRUE                        11030037
110400             ELSE                                                 11040037
110500                 MOVE RC012-OPER-UNT-ID                           11050037
110600                                   TO ASC-OPER-UNT-ID             11060037
110700                 MOVE RC012-FCLTY-ID                              11070037
110800                                   TO ASC-FCLTY-ID                11080037
110900                 MOVE RC012-PO-NBR TO ASC-KEY-PO-NBR              11090037
111000                                      ASC-PO-NBR-N                11100037
111100                                      DK-PO-NBR                   11110037
111200                 MOVE RC012-REC-SEQ-NBR                           11120037
111300                                   TO ASC-KEY-REC-SEQ-NBR         11130037
111400                                      ASC-REC-SEQ-NBR-N           11140037
111500                                      DK-REC-SEQ-NBR              11150037
111600             END-IF                                               11160037
111700             IF  PS-NO-ERROR                                      11170037
111800                 PERFORM 1110-CHECK-CASEPACK-SPLIT                11180037
111900                 IF  ASC-CASEPACK-FOUND                           11190037
112000                     MOVE PC-TSYMSG-01819                         11200037
112100                                   TO DP020-MSG-NUMBER            11210037
112200                     SET PS-ERROR                                 11220037
112300                         DP020-MSG-FATAL                          11230037
112400                         DP020-NEXT-ACT-APPL-ERROR                11240037
112500                                       TO TRUE                    11250037
112600                 END-IF                                           11260037
112700             END-IF                                               11270037
112800                                                                  11280037
112900             IF  PS-NO-ERROR                                      11290042
113000                 PERFORM 1115-CHECK-PKSL-STATUS                   11300042
113100                 IF  ASC-PKSL-ACTIVE                              11310042
113200                     MOVE PC-TSYMSG-03269                         11320045
113300                                   TO DP020-MSG-NUMBER            11330042
113400                     SET PS-ERROR                                 11340042
113500                         DP020-MSG-FATAL                          11350042
113600                         DP020-NEXT-ACT-APPL-ERROR                11360042
113700                                       TO TRUE                    11370042
113800                 END-IF                                           11380042
113900             END-IF                                               11390061
114000                                                                  11400061
114100             IF  PS-NO-ERROR                                      11410061
114200                 PERFORM 4215-GET-ORIGINAL-UID                    11420061
114300                 IF RECEIV-PACK-BY-ST-IND = 'Y'                   11430061
114400                     PERFORM 8200-ACTIVE-CARTONS-CHECKED-IN       11440067
114500                     IF PS-CHECKED-IN-FOUND                       11450061
114600                         MOVE PC-TSYMSG-02972                     11460061
114700                                       TO DP020-MSG-NUMBER        11470061
114800                         SET PS-ERROR                             11480061
114900                             DP020-MSG-FATAL                      11490061
115000                             DP020-NEXT-ACT-APPL-ERROR            11500061
115100                                           TO TRUE                11510061
115200                     END-IF                                       11520061
115300                 END-IF                                           11530061
115400             END-IF                                               11540061
115500                                                                  11550042
115600                                                                  11560042
115700         WHEN PC-INTER-APPL-LIST                                  11570037
115800             IF  RC015-NUMBER-OF-SELECTED-ITEMS > ZERO            11580037
115900                 SET ASC-USE-SELECTION-QUEUE                      11590037
116000                                   TO TRUE                        11600037
116100                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              11610037
116200                                   TO ASC-NUMBER-OF-SELECTED-ITEMS11620037
116300                 MOVE RC015-NUMBER-OF-TS-ITEMS                    11630037
116400                                   TO ASC-NUMBER-OF-TS-ITEMS      11640037
116500                 MOVE RC015-SEL-QUEUE-NAME                        11650037
116600                                   TO ASC-SEL-QUEUE-NAME          11660037
116700                 PERFORM 1120-PREPARE-LIST-ENTRY                  11670037
116800                 IF  ASC-OPER-UNT-ID = ZEROES                     11680037
116900                 AND ASC-FCLTY-ID    = ZEROES                     11690037
117000                     MOVE RC015-OPER-UNT-ID                       11700037
117100                                   TO ASC-OPER-UNT-ID             11710037
117200                     MOVE RC015-FCLTY-ID                          11720037
117300                                   TO ASC-FCLTY-ID                11730037
117400                 END-IF                                           11740037
117500             ELSE                                                 11750037
117600                 SET DP030-OVERRIDE-GO                            11760037
117700                                   TO TRUE                        11770037
117800                 MOVE PC-TSYMSG-00057                             11780037
117900                                   TO DP020-MSG-NUMBER            11790037
118000                 SET DP020-MSG-WARNING                            11800037
118100                     DP020-NEXT-ACT-APPL-ERROR                    11810037
118200                                   TO TRUE                        11820037
118300             END-IF                                               11830037
118400                                                                  11840037
118500         WHEN OTHER                                               11850037
118600             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            11860037
118700             SET DP020-MSG-FATAL                                  11870037
118800                 DP020-NEXT-ACT-APPL-ERROR                        11880037
118900                                   TO TRUE                        11890037
119000     END-EVALUATE.                                                11900037
119100                                                                  11910037
119200                                                                  11920037
119300*----------------------------------------------------------------*11930037
119400* CHECK TO SEE IF PO/RCVR PROCESSED THROUGH CASCPACK SPLIT       *11940037
119500* IF SO DO NOT ALLOW DELETE                                      *11950037
119600*----------------------------------------------------------------*11960037
119700 1110-CHECK-CASEPACK-SPLIT.                                       11970037
119800                                                                  11980037
119900         EXEC SQL                                                 11990037
120000              SELECT COUNT(*)                                     12000037
120100                INTO :PV-CASEPACK-SPLIT-LINES                     12010037
120200                FROM TDISTHD                                      12020037
120300               WHERE ORD_NBR          =  :DK-PO-NBR               12030037
120400                 AND RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR          12040037
120500                 AND                                              12050068
120600                 (                                                12060071
120601                      (TOT_CART_CNT   >  0)                       12060171
120602                  OR                                              12060268
120603                      (TOT_CART_CNT    =  0   AND                 12060371
120604                       NOT CRE_USR_ID  = ' ' AND                  12060468
120605                       NOT CRE_USR_ID  = 'RCKUT129' AND           12060569
120606                       NOT PRCG_STAT_CDE = 'C'      AND           12060670
120607                       NOT SYS_CRE_CDE = ' ')                     12060768
120608                  )                                               12060871
120609         END-EXEC.                                                12060937
120700                                                                  12070037
120800     EVALUATE TRUE                                                12080037
120900           WHEN SQLCODE = +0                                      12090037
121000                IF  PV-CASEPACK-SPLIT-LINES  >  +0                12100037
121100                    SET ASC-CASEPACK-FOUND TO TRUE                12110037
121200                ELSE                                              12120037
121300                    SET ASC-CASEPACK-NOT-FOUND TO TRUE            12130037
121400                END-IF                                            12140037
121500           WHEN SQLWARN0 NOT = SPACES                             12150037
121600           WHEN SQLCODE  NOT = ZERO                               12160037
121700                MOVE '1110-CHECK-CASEPACK-SPLIT'                  12170037
121800                               TO DP013-PARAGRAPH                 12180037
121900                MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'             12190037
122000                               TO DP013-MESSAGE-TEXT (1)          12200037
122100                MOVE 'SEARCHING FOR CASEPACK'                     12210037
122200                               TO DP013-MESSAGE-TEXT (2)          12220037
122300                MOVE SQLCA     TO DP013-SQLCA                     12230037
122400                MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (1)        12240037
122500                SET DP013-DB2-ABEND                               12250037
122600                      DP013-XCTL-DISPLAY-RESTART                  12260037
122700                                 TO TRUE                          12270037
122800                  PERFORM DP013-0000-PROCESS-ABEND                12280037
122900         END-EVALUATE.                                            12290037
123000                                                                  12300037
123100                                                                  12310037
123200 1115-CHECK-PKSL-STATUS.                                          12320042
123300                                                                  12330042
123400     EXEC SQL                                                     12340042
123500          SELECT COUNT (*)                                        12350042
123600            INTO :PV-ACTIVE-PACKSLIPS                             12360043
123700           FROM  TPKSLIP                                          12370042
123800          WHERE  PO_NBR             =  :DK-PO-NBR                 12380042
123900            AND  REC_SEQ_NBR        =  :DK-REC-SEQ-NBR            12390042
124000            AND  VER_STAT_CDE       =  :PC-A                      12400042
124100            AND  PKSL_STAT_CDE      =  :PC-AC                     12410042
124200     END-EXEC.                                                    12420042
124300                                                                  12430042
124400     EVALUATE TRUE                                                12440042
124500           WHEN SQLCODE = +0                                      12450042
124600                IF  PV-ACTIVE-PACKSLIPS      >  +0                12460043
124700                    SET ASC-PKSL-ACTIVE      TO TRUE              12470042
124800                ELSE                                              12480042
124900                    SET ASC-PKSL-INACTIVE    TO TRUE              12490042
125000                END-IF                                            12500042
125100           WHEN SQLWARN0 NOT = SPACES                             12510042
125200           WHEN SQLCODE  NOT = ZERO                               12520042
125300                MOVE '1115-CHECK-PKSL-STATUS'                     12530042
125400                               TO DP013-PARAGRAPH                 12540042
125500                MOVE 'UNSUCCESSFUL SELECT OF TPKSLIP'             12550042
125600                               TO DP013-MESSAGE-TEXT (1)          12560042
125700                MOVE 'SEARCHING FOR ACTIVE PACKSLIP '             12570042
125800                               TO DP013-MESSAGE-TEXT (2)          12580042
125900                MOVE SQLCA     TO DP013-SQLCA                     12590042
126000                MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)        12600042
126100                SET DP013-DB2-ABEND                               12610042
126200                      DP013-XCTL-DISPLAY-RESTART                  12620042
126300                                 TO TRUE                          12630042
126400                  PERFORM DP013-0000-PROCESS-ABEND                12640042
126500         END-EVALUATE.                                            12650042
126600                                                                  12660037
126700*----------------------------------------------------------------*12670037
126800*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *12680037
126900*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *12690037
127000*----------------------------------------------------------------*12700037
127100 1120-PREPARE-LIST-ENTRY.                                         12710037
127200                                                                  12720037
127300     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                12730037
127400     MOVE ZERO                     TO ASC-SEL-ITEM.               12740037
127500     PERFORM 2110-GET-NEXT-RECORD.                                12750037
127600                                                                  12760037
127700/                                                                 12770037
127800*----------------------------------------------------------------*12780037
127900*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*12790037
128000*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*12800037
128100*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *12810037
128200*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *12820037
128300*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *12830037
128400*----------------------------------------------------------------*12840037
128500                                                                  12850037
128600 2000-PROCESS-PANEL.                                              12860037
128700                                                                  12870037
128800     EVALUATE TRUE                                                12880037
128900                                                                  12890037
129000         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    12900037
129100             IF  ASC-DELETE-SUCCESSFUL                            12910037
129200                 MOVE PC-TSYMSG-00116                             12920037
129300                                   TO DP020-MSG-NUMBER            12930037
129400                 SET DP020-MSG-FATAL                              12940037
129500                     PS-ERROR      TO TRUE                        12950037
129600                 PERFORM 3200-RESET-ATTRIBUTES                    12960037
129700             ELSE                                                 12970037
129800                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               12980037
129900                 IF PS-NO-ERROR                                   12990037
130000                     SET DP030-CONTINUE-GO                        13000037
130100                                   TO TRUE                        13010037
130200                     PERFORM 7000-DELETE-PROCESSING               13020037
130300                 END-IF                                           13030037
130400             END-IF                                               13040037
130500                                                                  13050037
130600         WHEN DP020-SRC-AID = DP016-CLEAR                         13060037
130700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13070037
130800                                                                  13080037
130900         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     13090037
131000             PERFORM 4000-BUILD-INITIAL-PANEL                     13100037
131100             PERFORM 3200-RESET-ATTRIBUTES                        13110037
131200                                                                  13120037
131300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13130037
131400             IF  ASC-USE-SELECTION-QUEUE                          13140037
131500                 PERFORM 2110-GET-NEXT-RECORD                     13150037
131600                 IF PS-LIST-END                                   13160037
131700                    SET PS-NO-LIST-END                            13170037
131800                                   TO TRUE                        13180037
131900                 ELSE                                             13190037
132000                    PERFORM 4000-BUILD-INITIAL-PANEL              13200037
132100                    PERFORM 3200-RESET-ATTRIBUTES                 13210037
132200                 END-IF                                           13220037
132300             ELSE                                                 13230037
132400*                --- BOTTOM OF LIST ---                           13240037
132500                 MOVE PC-TSYMSG-00070                             13250037
132600                                   TO DP020-MSG-NUMBER            13260037
132700                 SET DP020-MSG-INFORMATIONAL                      13270037
132800                     PS-LIST-END   TO TRUE                        13280037
132900             END-IF                                               13290037
133000                                                                  13300037
133100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13310037
133200             IF  ASC-USE-SELECTION-QUEUE                          13320037
133300                 PERFORM 2120-GET-PREV-RECORD                     13330037
133400                 IF PS-LIST-END                                   13340037
133500                    SET PS-NO-LIST-END                            13350037
133600                                   TO TRUE                        13360037
133700                 ELSE                                             13370037
133800                    PERFORM 4000-BUILD-INITIAL-PANEL              13380037
133900                    PERFORM 3200-RESET-ATTRIBUTES                 13390037
134000                 END-IF                                           13400037
134100             ELSE                                                 13410037
134200*                --- TOP OF LIST ---                              13420037
134300                 MOVE PC-TSYMSG-00069                             13430037
134400                                   TO DP020-MSG-NUMBER            13440037
134500                 SET DP020-MSG-INFORMATIONAL                      13450037
134600                     PS-LIST-END   TO TRUE                        13460037
134700             END-IF                                               13470037
134800                                                                  13480037
134900         WHEN OTHER                                               13490037
135000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13500037
135100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13510037
135200             IF  PS-NO-ERROR                                      13520037
135300                 SET DP030-CONTINUE-GO                            13530037
135400                                   TO TRUE                        13540037
135500                 PERFORM 2100-CHECK-FUNCTION-KEY                  13550037
135600             ELSE                                                 13560037
135700                 SET DP030-OVERRIDE-GO                            13570037
135800                                   TO TRUE                        13580037
135900             END-IF                                               13590037
136000     END-EVALUATE.                                                13600037
136100                                                                  13610037
136200/                                                                 13620037
136300*----------------------------------------------------------------*13630037
136400*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *13640037
136500*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*13650037
136600*    FROM THE CICS ARCHITECTURE API.                             *13660037
136700*----------------------------------------------------------------*13670037
136800                                                                  13680037
136900 2100-CHECK-FUNCTION-KEY.                                         13690037
137000                                                                  13700037
137100     EVALUATE TRUE                                                13710037
137200         WHEN DP020-SRC-AID = DP016-ENTER                         13720037
137300             CONTINUE                                             13730037
137400                                                                  13740037
137500         WHEN DP020-FK-LOCAL-RETURN (DP020-SRC-AID)               13750037
137600             CONTINUE                                             13760037
137700                                                                  13770037
137800         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  13780037
137900             INITIALIZE RC012-INTER-APPL-COMMAREA                 13790037
138000             MOVE ASC-KEY-PO-NBR   TO RC012-PO-NBR                13800037
138100             MOVE ASC-KEY-REC-SEQ-NBR                             13810037
138200                                   TO RC012-REC-SEQ-NBR           13820037
138300             MOVE ASC-OPER-UNT-ID  TO RC012-OPER-UNT-ID           13830037
138400             MOVE ASC-FCLTY-ID     TO RC012-FCLTY-ID              13840037
138500             MOVE ASC-CARRIER      TO RC012-OWNER-SCAC-ID         13850037
138600             MOVE ASC-TRAILER-NBR  TO RC012-VEH-NBR               13860037
138700                                                                  13870037
138800         WHEN OTHER                                               13880037
138900             SET DP013-NO-ROLLBACK                                13890037
139000                 DP013-XCTL-DISPLAY-RESTART                       13900037
139100                 DP013-CICS-ABEND  TO TRUE                        13910037
139200             MOVE '2100-CHECK-FUNCTION-KEY'                       13920037
139300                                   TO DP013-PARAGRAPH             13930037
139400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13940037
139500                                   TO DP013-MESSAGE-TEXT (1)      13950037
139600             PERFORM DP013-0000-PROCESS-ABEND                     13960037
139700     END-EVALUATE.                                                13970037
139800                                                                  13980037
139900/                                                                 13990037
140000*----------------------------------------------------------------*14000037
140100*    GET THE RECEIVER NUMBER (KEY) OF THE NEXT SELECTED OBJECT   *14010037
140200*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *14020037
140300*----------------------------------------------------------------*14030037
140400 2110-GET-NEXT-RECORD.                                            14040037
140500                                                                  14050037
140600     ADD +1                        TO ASC-SEL-SUB.                14060037
140700     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            14070037
140800         ADD +1                    TO ASC-SEL-ITEM                14080037
140900         MOVE +1                   TO ASC-SEL-SUB                 14090037
141000     END-IF.                                                      14100037
141100                                                                  14110037
141200     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                14120037
141300         PERFORM 9100-READ-SEL-QUEUE                              14130037
141400         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      14140037
141500             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      14150037
141600                                   TO ASC-KEY-PO-NBR              14160037
141700                                      ASC-PO-NBR-N                14170037
141800             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 14180037
141900                                   TO ASC-KEY-REC-SEQ-NBR         14190037
142000                                      ASC-REC-SEQ-NBR-N           14200037
142100             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 14210037
142200                                   TO ASC-OPER-UNT-ID             14220037
142300             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    14230037
142400                                   TO ASC-FCLTY-ID                14240037
142500             SET RC013-INQ (ASC-SEL-SUB)                          14250037
142600                                   TO TRUE                        14260037
142700             PERFORM 9200-REWRITE-LIST-QUEUE                      14270037
142800             INITIALIZE ASC-SCREEN-FIELDS                         14280037
142900         ELSE                                                     14290037
143000             SUBTRACT +1 FROM ASC-SEL-SUB                         14300037
143100*            --- BOTTOM OF LIST ---                               14310037
143200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14320037
143300             SET DP020-MSG-INFORMATIONAL                          14330037
143400                 PS-LIST-END                                      14340037
143500                                   TO TRUE                        14350037
143600         END-IF                                                   14360037
143700     ELSE                                                         14370037
143800         SUBTRACT +1 FROM ASC-SEL-ITEM                            14380037
143900         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 14390037
144000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14400037
144100         SET DP020-MSG-INFORMATIONAL                              14410037
144200             PS-LIST-END                                          14420037
144300                                   TO TRUE                        14430037
144400     END-IF.                                                      14440037
144500                                                                  14450037
144600/                                                                 14460037
144700*----------------------------------------------------------------*14470037
144800*    GET THE RECEIVER NUMBER (KEY) OF THE PREVIOUS SELECTED      *14480037
144900*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *14490037
145000*----------------------------------------------------------------*14500037
145100 2120-GET-PREV-RECORD.                                            14510037
145200                                                                  14520037
145300     SUBTRACT +1 FROM ASC-SEL-SUB.                                14530037
145400     IF  ASC-SEL-SUB < +1                                         14540037
145500         SUBTRACT +1 FROM ASC-SEL-ITEM                            14550037
145600         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 14560037
145700     END-IF.                                                      14570037
145800                                                                  14580037
145900     IF  ASC-SEL-ITEM > ZERO                                      14590037
146000         PERFORM 9100-READ-SEL-QUEUE                              14600037
146100         MOVE RC013-PO-NBR (ASC-SEL-SUB)                          14610037
146200                                   TO ASC-KEY-PO-NBR              14620037
146300                                      ASC-PO-NBR-N                14630037
146400         MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                     14640037
146500                                   TO ASC-KEY-REC-SEQ-NBR         14650037
146600                                      ASC-REC-SEQ-NBR-N           14660037
146700         MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                     14670037
146800                                   TO ASC-OPER-UNT-ID             14680037
146900         MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                        14690037
147000                                   TO ASC-FCLTY-ID                14700037
147100         INITIALIZE ASC-SCREEN-FIELDS                             14710037
147200     ELSE                                                         14720037
147300         MOVE +1                   TO ASC-SEL-ITEM                14730037
147400                                      ASC-SEL-SUB                 14740037
147500*        --- TOP OF LIST ---                                      14750037
147600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14760037
147700         SET DP020-MSG-INFORMATIONAL                              14770037
147800             PS-LIST-END           TO TRUE                        14780037
147900     END-IF.                                                      14790037
148000                                                                  14800037
148100/                                                                 14810037
148200*----------------------------------------------------------------*14820037
148300*    MOVE DATA FROM SCREEN INTO THEIR RESPECTIVE FIELDS          *14830037
148400*    IN THE APPLICATION-SPECIFIC COMMAREA.                       *14840037
148500*----------------------------------------------------------------*14850037
148600                                                                  14860037
148700 2200-MOVE-SCREEN-TO-COMMAREA.                                    14870037
148800                                                                  14880037
148900     MOVE APONBRI                  TO ASC-PO-NBR.                 14890037
149000     MOVE ARECSEQI                 TO ASC-REC-SEQ-NBR.            14900037
149100     MOVE APOSTATI                 TO ASC-PO-STATUS.              14910037
149200     MOVE ARCVSTAI                 TO ASC-RCVR-STATUS.            14920037
149300     MOVE AVNAMEI                  TO ASC-VENDOR-NAME.            14930037
149600     MOVE ABNAMEI                  TO ASC-BUYER-NAME.             14960037
149700     MOVE ARCVCRI                  TO ASC-RCVR-CREATOR.           14970037
149800     MOVE ARCVCLI                  TO ASC-REC-CLERK.              14980037
149900     MOVE ADEPTI                   TO ASC-DEPT.                   14990046
150000     MOVE ATROUBI                  TO ASC-TROUB-STATUS-1.         15000037
150100     MOVE ASTATI                   TO ASC-TROUB-STATUS-2.         15010037
150200     MOVE ADNSHIPI                 TO ASC-DO-NOT-SHIP-DATE.       15020037
150300     MOVE ACARRI                   TO ASC-CARRIER.                15030037
150400     MOVE ACANDTEI                 TO ASC-CANCEL-DATE.            15040037
150500     MOVE ATRLRNOI                 TO ASC-TRAILER-NBR.            15050037
150600     MOVE AADDATEI                 TO ASC-AD-DATE.                15060037
150700     MOVE APROI                    TO ASC-PRO-NUMBER.             15070037
150800     MOVE ABOLI                    TO ASC-BOL-NUMBER.             15080037
150900     MOVE AADINFOI                 TO ASC-AD-INFO.                15090037
151000     MOVE AVSHPDTI                 TO ASC-VDR-SHIP-DATE.          15100037
151100     MOVE ASPCINSI                 TO ASC-SPEC-INSTRC.            15110037
151200     MOVE ACSHPDTI                 TO ASC-CARR-SHIP-DTE.          15120037
151300     MOVE ATTYPEI                  TO ASC-TKT-FMT-ID.             15130037
151400     MOVE ARCVRI                   TO ASC-RCVR-NBR.               15140037
151500     MOVE AARRVDTI                 TO ASC-ARRIVAL-DATE.           15150037
151600     MOVE AOPSETI                  TO ASC-OPER-SET-ID.            15160037
151700     MOVE AOPDESCI                 TO ASC-OPER-SET-DESC.          15170037
151800     MOVE APIASNI                  TO ASC-PROC-INFO-ASN.          15180037
151900     MOVE APIPREI                  TO ASC-PROC-INFO-PRE.          15190037
152000     MOVE APIPACKI                 TO ASC-PROC-INFO-PACK.         15200037
152100     MOVE ARCVDTEI                 TO ASC-RCV-CRE-DATE.           15210037
152200     MOVE ARCVTMEI                 TO ASC-RCV-CRE-TIME.           15220037
152300     MOVE AAPRLOCI                 TO ASC-APRON-LOC-DESC.         15230037
152400     MOVE ACTNSI                   TO ASC-EXPTED-CART-CNT.        15240037
152500     MOVE APIEDII                  TO ASC-PROC-INFO-EDI.          15250037
152600     MOVE ATRSDTEI                 TO ASC-TRANSCRIBE-DATE.        15260037
152700     MOVE ATRSTMEI                 TO ASC-TRANSCRIBE-TIME.        15270037
152800     MOVE AADJCTNI                 TO ASC-ACTL-CART-CNT.          15280037
152900     MOVE APIDETI                  TO ASC-PROC-INFO-DET.          15290037
153000     MOVE AMADTEI                  TO ASC-MK-APRN-DATE.           15300037
153100     MOVE AMATMEI                  TO ASC-MK-APRN-TIME.           15310037
153200     MOVE ADMGCTNI                 TO ASC-DMG-CART-CNT.           15320037
153300     MOVE AMHDTEI                  TO ASC-MK-HDR-DATE.            15330037
153400     MOVE AMHTMEI                  TO ASC-MK-HDR-TIME.            15340037
153500     MOVE ALCDTEI                  TO ASC-LAST-CHNG-DATE.         15350037
153600     MOVE ALCTMEI                  TO ASC-LAST-CHNG-TIME.         15360037
153700     MOVE APCSINVI                 TO ASC-PCS-INVCD.              15370037
153800     MOVE ASHPDTEI                 TO ASC-SHIPPED-DATE.           15380037
153900     MOVE ASHPTMEI                 TO ASC-SHIPPED-TIME.           15390037
154000     MOVE ACBIDI                   TO ASC-CHANGD-BY.              15400037
154100     MOVE APCSVERI                 TO ASC-PCS-VERFD.              15410037
154200     MOVE APCSDTEI                 TO ASC-PCS-VER-DATE.           15420037
154300     MOVE APCSTMEI                 TO ASC-PCS-VER-TIME.           15430037
154400                                                                  15440037
154500/                                                                 15450037
154600*----------------------------------------------------------------*15460037
154700*    A RECEIVER CANNOT BE DELETED ONCE ANY LINE HAS BEEN VERIFIED*15470037
154800*----------------------------------------------------------------*15480037
154900 3000-EDIT-DATA-IN-COMMAREA.                                      15490037
155000                                                                  15500037
155100     MOVE ASC-PO-NBR-N             TO DK-PO-NBR.                  15510037
155200     MOVE ASC-REC-SEQ-NBR-N        TO DK-REC-SEQ-NBR.             15520037
155300     MOVE ASC-OPER-UNT-ID          TO DK-OPER-UNT-ID.             15530037
155400     MOVE ASC-FCLTY-ID             TO DK-FCLTY-ID.                15540037
155500                                                                  15550037
155600     PERFORM 4200-SELECT-TRECEIV.                                 15560037
155700                                                                  15570037
155800     IF PS-TRECEIV-NOT-FOUND                                      15580037
155900         SET PS-ERROR                                             15590037
156000             DP020-MSG-FATAL       TO TRUE                        15600037
156100         MOVE PC-TSYMSG-00116      TO DP020-MSG-NUMBER            15610037
156200         SET DP030-SET-CURSOR-TRAILER                             15620037
156300                                   TO TRUE                        15630037
156400     END-IF.                                                      15640037
156500                                                                  15650037
156600     IF RECEIV-STATUS-CDE = PC-VE                                 15660037
156700         SET PS-ERROR                                             15670037
156800             DP020-MSG-FATAL       TO TRUE                        15680037
156900         MOVE PC-TSYMSG-00828      TO DP020-MSG-NUMBER            15690037
157000         SET DP030-SET-CURSOR-TRAILER                             15700037
157100                                   TO TRUE                        15710037
157200     END-IF.                                                      15720037
157300                                                                  15730037
157400     IF PS-NO-ERROR                                               15740037
157500         PERFORM 3010-CHECK-RECITM-FOR-VERIFIED                   15750037
157600         IF PV-VERIFIED-COUNT > 0                                 15760037
157700             SET PS-ERROR                                         15770037
157800                 DP020-MSG-FATAL   TO TRUE                        15780037
157900             MOVE PC-TSYMSG-00828  TO DP020-MSG-NUMBER            15790037
158000             SET DP030-SET-CURSOR-TRAILER                         15800037
158100                                   TO TRUE                        15810037
158200         END-IF                                                   15820037
158300     END-IF.                                                      15830037
158400                                                                  15840037
158500/                                                                 15850037
158600*----------------------------------------------------------------*15860037
158700*    A RECEIVER CANNOT BE DELETED ONCE ANY LINE HAS BEEN VERIFIED*15870037
158800*----------------------------------------------------------------*15880037
158900 3010-CHECK-RECITM-FOR-VERIFIED.                                  15890037
159000                                                                  15900037
159100     INITIALIZE PV-VERIFIED-COUNT.                                15910037
159200                                                                  15920037
159300     MOVE ASC-PO-NBR-N             TO PV-MSG-PO.                  15930037
159400     MOVE ASC-REC-SEQ-NBR-N        TO PV-MSG-RCVR.                15940037
159500                                                                  15950037
159600     PERFORM                                                      15960037
159700         WITH TEST AFTER                                          15970037
159800         VARYING PV-RETRY-COUNTER                                 15980037
159900         FROM 1 BY 1                                              15990037
160000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16000037
160100             OR (SQLCODE = +0)                                    16010037
160200             OR (SQLCODE = +100))                                 16020037
160300                                                                  16030037
160400         EXEC SQL                                                 16040037
160500              SELECT COUNT(*)                                     16050037
160600                INTO :PV-VERIFIED-COUNT :DN-VRFYD-CNT-ID          16060037
160700                FROM TRECITM                                      16070037
160800               WHERE ORD_NBR        = :DK-PO-NBR                  16080037
160900                 AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR             16090037
161000                 AND VER_STATUS_CDE = :PC-A                       16100037
161100                 AND STATUS_CDE     = :PC-VE                      16110037
161200         END-EXEC                                                 16120037
161300                                                                  16130037
161400         EVALUATE TRUE                                            16140037
161500             WHEN SQLCODE = +0                                    16150037
161600             WHEN SQLCODE = +100                                  16160037
161700             WHEN SQLCODE = -904                                  16170037
161800             WHEN SQLCODE = -913                                  16180037
161900                  CONTINUE                                        16190037
162000                                                                  16200037
162100             WHEN SQLWARN0 NOT = SPACES                           16210037
162200             WHEN SQLCODE < +0                                    16220037
162300             WHEN SQLCODE > +0                                    16230037
162400                  MOVE '3010-CHECK-RECITM-FOR-VERIFIED'           16240037
162500                                  TO DP013-PARAGRAPH              16250037
162600                  MOVE 'UNSUCCESSFUL COUNT OF TRECITM   '         16260037
162700                                  TO DP013-MESSAGE-TEXT (1)       16270037
162800                  MOVE PV-ABEND-MSG-KEYS                          16280037
162900                                  TO DP013-MESSAGE-TEXT (2)       16290037
163000                  MOVE SQLCA      TO DP013-SQLCA                  16300037
163100                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     16310037
163200                  SET DP013-DB2-ABEND                             16320037
163300                      DP013-XCTL-DISPLAY-RESTART                  16330037
163400                                  TO TRUE                         16340037
163500                  PERFORM DP013-0000-PROCESS-ABEND                16350037
163600         END-EVALUATE                                             16360037
163700     END-PERFORM.                                                 16370037
163800                                                                  16380037
163900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    16390037
164000         SQLCODE NOT = +0                                         16400037
164100         MOVE '3010-CHECK-RECITM-FOR-VERIFIED'                    16410037
164200                                  TO DP013-PARAGRAPH              16420037
164300         MOVE 'MAX RETRIES EXCEEDED ON COUNT FOR VERIFIED'        16430037
164400                                  TO DP013-MESSAGE-TEXT (1)       16440037
164500         MOVE PV-ABEND-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)       16450037
164600         MOVE SQLCA               TO DP013-SQLCA                  16460037
164700         MOVE 'TRECITM '          TO DP013-DB2-TABLE-NAME (1)     16470037
164800         SET DP013-DB2-ABEND                                      16480037
164900             DP013-XCTL-DISPLAY-RESTART                           16490037
165000                                  TO TRUE                         16500037
165100         PERFORM DP013-0000-PROCESS-ABEND                         16510037
165200     END-IF.                                                      16520037
165300                                                                  16530037
165400/                                                                 16540037
165500*----------------------------------------------------------------*16550037
165600*    RESET THE ATTRIBUTES OF CERTAIN FIELDS ON THE MAP.          *16560037
165700*----------------------------------------------------------------*16570037
165800                                                                  16580037
165900 3200-RESET-ATTRIBUTES.                                           16590037
166000                                                                  16600037
166100     IF  ASC-AD-INFO = 'PICT'                                     16610037
166200         IF  ASC-AD-DATE > SPACES                                 16620037
166300             MOVE DP015-YELLOW     TO AADDATEC                    16630037
166400                                      AADINFOC                    16640037
166500         END-IF                                                   16650037
166600     ELSE                                                         16660037
166700         MOVE DP015-BLUE           TO AADDATEC                    16670037
166800                                      AADINFOC                    16680037
166900     END-IF.                                                      16690037
167000                                                                  16700037
167100/                                                                 16710037
167200*----------------------------------------------------------------*16720037
167300*   -IF THE PO NUMBER WAS PASSED, GET PO INFORMATION FROM THE    *16730037
167400*    PO TABLES AND DISPLAY.                                      *16740037
167500*   -IF THE RECEIVER NUMBER WAS PASSED, GET RECEIPTS INFORMATION *16750037
167600*    FROM THE RECEIPTS TABLES AND DISPLAY.                       *16760037
167700*----------------------------------------------------------------*16770037
167800                                                                  16780037
167900 4000-BUILD-INITIAL-PANEL.                                        16790037
168000                                                                  16800037
168100     SET DP030-SET-CURSOR-TRAILER                                 16810037
168200         PS-NO-ERROR               TO TRUE.                       16820037
168300                                                                  16830037
168400     MOVE ZEROES                   TO ASC-EXPTED-CART-CNT-N       16840037
168500                                      ASC-ACTL-CART-CNT-N         16850037
168600                                      ASC-DMG-CART-CNT-N          16860037
168700                                      ASC-PCS-INVCD-N             16870037
168800                                      ASC-PCS-VERFD-N             16880037
168900                                      ASC-OPER-SET-ID-N.          16890037
169000                                                                  16900037
169100     IF  ASC-KEY-PO-NBR > ZEROES                                  16910037
169200         MOVE ASC-KEY-PO-NBR       TO DK-PO-NBR                   16920037
169300         PERFORM 4100-GET-PO-INFO                                 16930037
169400         IF  SQLCODE = +0                                         16940037
169500             PERFORM 4110-LOAD-PO-FIELDS                          16950037
169600         END-IF                                                   16960037
169700     END-IF.                                                      16970037
169800                                                                  16980037
169900     IF  ASC-KEY-REC-SEQ-NBR > ZEROES                             16990037
170000         MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID              17000037
170100         MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID                 17010037
170200         MOVE ASC-KEY-PO-NBR       TO DK-PO-NBR                   17020037
170300         MOVE ASC-KEY-REC-SEQ-NBR  TO DK-REC-SEQ-NBR              17030037
170400         PERFORM 4200-SELECT-TRECEIV                              17040037
170500         IF  SQLCODE = +0                                         17050037
170600             PERFORM 4210-LOAD-RECEIPT-FIELDS                     17060037
170700         END-IF                                                   17070037
170800     END-IF.                                                      17080037
170900                                                                  17090037
171000     PERFORM 4200-TROUBLE-DESC.                                   17100037
171100                                                                  17110037
171200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17120037
171300                                                                  17130037
171400/                                                                 17140037
171500*----------------------------------------------------------------*17150037
171600*    GET PURCHASE ORDER INFO                                     *17160037
171700*----------------------------------------------------------------*17170037
171800 4100-GET-PO-INFO.                                                17180037
171900                                                                  17190037
172000     PERFORM                                                      17200037
172100         WITH TEST AFTER                                          17210037
172200         VARYING PV-RETRY-COUNTER                                 17220037
172300         FROM 1 BY 1                                              17230037
172400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17240037
172500            OR (SQLCODE = +0)                                     17250037
172600            OR (SQLCODE = +100))                                  17260037
172700                                                                  17270037
172800         EXEC SQL                                                 17280037
172900            SELECT  DISTINCT                                      17290037
173000                    A.PO_NBR                                      17300037
173100                   ,A.DEPT_NBR                                    17310037
173200                   ,B.STATUS_DESC                                 17320037
173300                   ,C.ENT_NAME_DESC                               17330037
173400                   ,A.ENT_ID                                      17340037
173500              INTO :PURCHS-PO-NBR                                 17350037
173600                  ,:PURCHS-DEPT-NBR                               17360037
173700                  ,:STATCD-STATUS-DESC                            17370037
173800                  ,:ENTNME-ENT-NAME-DESC                          17380037
173900                  ,:PURCHS-ENT-ID                                 17390037
174000              FROM  TPURCHS A                                     17400037
174100                   ,TSTATCD B                                     17410037
174200                   ,TENTNME C                                     17420037
174300          WHERE A.PO_NBR         = :DK-PO-NBR                     17430037
174400            AND A.VER_STATUS_CDE = 'A'                            17440037
174500            AND C.TYPE_CDE       = '01'                           17450037
174600            AND A.STATUS_CDE = B.STATUS_CDE                       17460037
174700            AND A.ENT_ID     = C.ENT_ID                           17470037
174800         END-EXEC                                                 17480037
174900                                                                  17490037
175000         EVALUATE TRUE                                            17500037
175100             WHEN SQLCODE = +0                                    17510037
175200             WHEN SQLCODE = +100                                  17520037
175300             WHEN SQLCODE = -904                                  17530037
175400             WHEN SQLCODE = -913                                  17540037
175500                 CONTINUE                                         17550037
175600                                                                  17560037
175700             WHEN SQLWARN0 NOT = SPACE                            17570037
175800             WHEN SQLCODE < +0                                    17580037
175900             WHEN SQLCODE > +0                                    17590037
176000                 MOVE '4100-GET-PO-INFO'                          17600037
176100                                   TO DP013-PARAGRAPH             17610037
176200                 MOVE 'SELECT ON TPURCHS'                         17620037
176300                                   TO DP013-MESSAGE-TEXT (1)      17630037
176400                 MOVE SQLCA        TO DP013-SQLCA                 17640037
176500                 MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)    17650037
176600                 SET DP013-DB2-ABEND                              17660037
176700                                   TO TRUE                        17670037
176800                 SET DP013-XCTL-DISPLAY-RESTART                   17680037
176900                                   TO TRUE                        17690037
177000                 PERFORM DP013-0000-PROCESS-ABEND                 17700037
177100         END-EVALUATE                                             17710037
177200     END-PERFORM.                                                 17720037
177300                                                                  17730037
177400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    17740037
177500         SQLCODE NOT = +0                                         17750037
177600         MOVE '4100-GET-PO-INFO'                                  17760037
177700                                   TO DP013-PARAGRAPH             17770037
177800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     17780037
177900                                   TO DP013-MESSAGE-TEXT (1)      17790037
178000         MOVE 'PO INFO    '                                       17800037
178100                                   TO DP013-MESSAGE-TEXT (2)      17810037
178200         MOVE SQLCA                TO DP013-SQLCA                 17820037
178300         MOVE 'TPURCHS'            TO DP013-DB2-TABLE-NAME (1)    17830037
178400         SET DP013-DB2-ABEND       TO TRUE                        17840037
178500         SET DP013-XCTL-DISPLAY-RESTART                           17850037
178600                                   TO TRUE                        17860037
178700         PERFORM DP013-0000-PROCESS-ABEND                         17870037
178800     END-IF.                                                      17880037
178900                                                                  17890037
179000/                                                                 17900037
179100*----------------------------------------------------------------*17910037
179200*    MOVE THE PO DATABASE FIELDS INTO THE COMMAREA               *17920037
179300*----------------------------------------------------------------*17930037
179400 4110-LOAD-PO-FIELDS.                                             17940037
179500                                                                  17950037
179600     MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR.                  17960037
179700                                                                  17970037
179800*  SPECIAL INSTRUCTIONS                                           17980037
179900     PERFORM 4120-GET-SPECIAL-INSTR.                              17990037
180000                                                                  18000037
180100     IF  SQLCODE = +0                                             18010037
180200         MOVE INSTCD-INSTR-DESC(1:25)                             18020037
180300                                   TO ASC-SPEC-INSTRC             18030037
180400     END-IF.                                                      18040037
180500                                                                  18050037
180600*  PO STATUS                                                      18060037
180700     MOVE STATCD-STATUS-DESC       TO ASC-PO-STATUS.              18070037
180800                                                                  18080037
180900*  DO NOT SHIP DATE                                               18090037
181000*  CANCEL DATE                                                    18100037
181100     PERFORM 4130-GET-PLANNED-SHIP-INFO.                          18110037
181200                                                                  18120037
181300     IF  SQLCODE = +0                                             18130037
181400         IF  PLNSHP-DONT-SHIP-BEF-DTE > SPACES                    18140037
181500         AND PLNSHP-DONT-SHIP-BEF-DTE NOT = '0001-01-01'          18150037
181600             MOVE PLNSHP-DONT-SHIP-BEF-DTE                        18160037
181700                                   TO PV-DB2-DATE                 18170037
181800             MOVE PV-DB2-DATE-MM   TO PV-DISPLAY-DATE-MM          18180037
181900             MOVE PV-DB2-DATE-DD   TO PV-DISPLAY-DATE-DD          18190037
182000             MOVE PV-DB2-DATE-YY   TO PV-DISPLAY-DATE-YY          18200037
182100             MOVE PV-DISPLAY-DATE  TO ASC-DO-NOT-SHIP-DATE        18210037
182200         ELSE                                                     18220037
182300             MOVE SPACES           TO ASC-DO-NOT-SHIP-DATE        18230037
182400         END-IF                                                   18240037
182500         IF  PLNSHP-CAN-IFNOT-SHIP-DTE > SPACES                   18250037
182600         AND PLNSHP-CAN-IFNOT-SHIP-DTE NOT = '0001-01-01'         18260037
182700             MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                       18270037
182800                                   TO PV-DB2-DATE                 18280037
182900             MOVE PV-DB2-DATE-MM   TO PV-DISPLAY-DATE-MM          18290037
183000             MOVE PV-DB2-DATE-DD   TO PV-DISPLAY-DATE-DD          18300037
183100             MOVE PV-DB2-DATE-YY   TO PV-DISPLAY-DATE-YY          18310037
183200             MOVE PV-DISPLAY-DATE  TO                             18320037
183300                                  ASC-CANCEL-DATE                 18330037
183400         ELSE                                                     18340037
183500             MOVE SPACES           TO                             18350037
183600                                  ASC-CANCEL-DATE                 18360037
183700         END-IF                                                   18370037
183800     END-IF.                                                      18380037
183900                                                                  18390037
184000*  AD DATE                                                        18400037
184100     PERFORM 4140-GET-AD-DATE.                                    18410037
184200                                                                  18420037
184300     IF  SQLCODE = -305                                           18430037
184400         MOVE SPACES               TO ASC-AD-DATE                 18440037
184500     ELSE                                                         18450037
184600         IF  DN-AD-EVNT-DTE = -1                                  18460037
184700             MOVE SPACES           TO ASC-AD-DATE                 18470037
184800         ELSE                                                     18480037
184900             MOVE PURITM-AD-EVNT-DTE                              18490037
185000                                   TO PV-DB2-DATE                 18500037
185100             MOVE PV-DB2-DATE-MM   TO PV-DISPLAY-DATE-MM          18510037
185200             MOVE PV-DB2-DATE-DD   TO PV-DISPLAY-DATE-DD          18520037
185300             MOVE PV-DB2-DATE-YY   TO PV-DISPLAY-DATE-YY          18530037
185400             MOVE PV-DISPLAY-DATE  TO ASC-AD-DATE                 18540037
185500         END-IF                                                   18550037
185600     END-IF.                                                      18560037
185700                                                                  18570037
185800*  DEPT                                                           18580046
185900     MOVE PURCHS-DEPT-NBR          TO ASC-DEPT.                   18590046
186000                                                                  18600037
186100*  VENDOR NAME                                                    18610037
186200     MOVE ENTNME-ENT-NAME-DESC     TO ASC-VENDOR-NAME.            18620037
186300                                                                  18630037
186400*  VENDOR ENT ID                                                  18640037
186500     MOVE PURCHS-ENT-ID            TO ASC-ENT-ID                  18650037
186600                                      DK-ENT-ID.                  18660037
186700                                                                  18670037
186800*  BUYER NAME                                                     18680037
186900     PERFORM 4160-GET-BUYER-NAME.                                 18690037
187000                                                                  18700037
187100/                                                                 18710037
187200*----------------------------------------------------------------*18720037
187300*    GET SPECIAL INSTRUCTION FOR PO                              *18730037
187400*----------------------------------------------------------------*18740037
187500 4120-GET-SPECIAL-INSTR.                                          18750037
187600                                                                  18760037
187700     PERFORM                                                      18770037
187800         WITH TEST AFTER                                          18780037
187900         VARYING PV-RETRY-COUNTER                                 18790037
188000         FROM 1 BY 1                                              18800037
188100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18810037
188200            OR (SQLCODE = +0)                                     18820037
188300            OR (SQLCODE = -811)                                   18830037
188400            OR (SQLCODE = +100))                                  18840037
188500                                                                  18850037
188600         EXEC SQL                                                 18860037
188700            SELECT  B.INSTR_DESC                                  18870037
188800              INTO :INSTCD-INSTR-DESC                             18880037
188900              FROM  TPOINST A                                     18890037
189000                   ,TINSTCD B                                     18900037
189100          WHERE A.PO_NBR    = :DK-PO-NBR                          18910037
189200            AND A.RECIP_CDE = 'DC'                                18920037
189300            AND A.INSTR_NBR = B.INSTR_NBR                         18930037
189400         END-EXEC                                                 18940037
189500                                                                  18950037
189600         EVALUATE TRUE                                            18960037
189700             WHEN SQLCODE = +0                                    18970037
189800             WHEN SQLCODE = +100                                  18980037
189900             WHEN SQLCODE = -811                                  18990037
190000             WHEN SQLCODE = -904                                  19000037
190100             WHEN SQLCODE = -913                                  19010037
190200                 CONTINUE                                         19020037
190300                                                                  19030037
190400             WHEN SQLWARN0 NOT = SPACE                            19040037
190500             WHEN SQLCODE < +0                                    19050037
190600             WHEN SQLCODE > +0                                    19060037
190700                 MOVE '4120-GET-SPECIAL-INSTR'                    19070037
190800                                   TO DP013-PARAGRAPH             19080037
190900                 MOVE 'SELECT ON TPOINST'                         19090037
191000                                   TO DP013-MESSAGE-TEXT (1)      19100037
191100                 MOVE SQLCA        TO DP013-SQLCA                 19110037
191200                 MOVE 'TPOINST'    TO DP013-DB2-TABLE-NAME (1)    19120037
191300                 MOVE 'TINSTCD'    TO DP013-DB2-TABLE-NAME (2)    19130037
191400                 SET DP013-DB2-ABEND                              19140037
191500                                   TO TRUE                        19150037
191600                 SET DP013-XCTL-DISPLAY-RESTART                   19160037
191700                                   TO TRUE                        19170037
191800                 PERFORM DP013-0000-PROCESS-ABEND                 19180037
191900         END-EVALUATE                                             19190037
192000     END-PERFORM.                                                 19200037
192100                                                                  19210037
192200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    19220037
192300         SQLCODE NOT = +0                                         19230037
192400         MOVE '4120-GET-SPECIAL-INSTR'                            19240037
192500                                   TO DP013-PARAGRAPH             19250037
192600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     19260037
192700                                   TO DP013-MESSAGE-TEXT (1)      19270037
192800         MOVE 'SPECIAL INSTRUCTIONS FOR PO'                       19280037
192900                                   TO DP013-MESSAGE-TEXT (2)      19290037
193000         MOVE SQLCA                TO DP013-SQLCA                 19300037
193100         MOVE 'TPOINST'            TO DP013-DB2-TABLE-NAME (1)    19310037
193200         MOVE 'TINSTCD'            TO DP013-DB2-TABLE-NAME (2)    19320037
193300         SET DP013-DB2-ABEND       TO TRUE                        19330037
193400         SET DP013-XCTL-DISPLAY-RESTART                           19340037
193500                                   TO TRUE                        19350037
193600         PERFORM DP013-0000-PROCESS-ABEND                         19360037
193700     END-IF.                                                      19370037
193800                                                                  19380037
193900/                                                                 19390037
194000*----------------------------------------------------------------*19400037
194100*    GET PLANNED SHIPMENT INFO                                   *19410037
194200*----------------------------------------------------------------*19420037
194300 4130-GET-PLANNED-SHIP-INFO.                                      19430037
194400                                                                  19440037
194500     PERFORM                                                      19450037
194600         WITH TEST AFTER                                          19460037
194700         VARYING PV-RETRY-COUNTER                                 19470037
194800         FROM 1 BY 1                                              19480037
194900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19490037
195000            OR (SQLCODE = +0)                                     19500037
195100            OR (SQLCODE = +100))                                  19510037
195200                                                                  19520037
195300         EXEC SQL                                                 19530037
195400            SELECT  DONT_SHIP_BEF_DTE                             19540037
195500                   ,CAN_IFNOT_SHIP_DTE                            19550037
195600              INTO :PLNSHP-DONT-SHIP-BEF-DTE                      19560037
195700                  ,:PLNSHP-CAN-IFNOT-SHIP-DTE                     19570037
195800              FROM  TPLNSHP                                       19580037
195900          WHERE PO_NBR         = :DK-PO-NBR                       19590037
196000            AND VER_STATUS_CDE = 'A'                              19600037
196100         END-EXEC                                                 19610037
196200                                                                  19620037
196300         EVALUATE TRUE                                            19630037
196400             WHEN SQLCODE = +0                                    19640037
196500             WHEN SQLCODE = +100                                  19650037
196600             WHEN SQLCODE = -904                                  19660037
196700             WHEN SQLCODE = -913                                  19670037
196800                 CONTINUE                                         19680037
196900                                                                  19690037
197000             WHEN SQLWARN0 NOT = SPACE                            19700037
197100             WHEN SQLCODE < +0                                    19710037
197200             WHEN SQLCODE > +0                                    19720037
197300                 MOVE '4130-GET-PLANNED-SHIP-INFO'                19730037
197400                                   TO DP013-PARAGRAPH             19740037
197500                 MOVE 'SELECT ON TPLNSHP'                         19750037
197600                                   TO DP013-MESSAGE-TEXT (1)      19760037
197700                 MOVE SQLCA        TO DP013-SQLCA                 19770037
197800                 MOVE 'TPLNSHP'    TO DP013-DB2-TABLE-NAME (1)    19780037
197900                 SET DP013-DB2-ABEND                              19790037
198000                                   TO TRUE                        19800037
198100                 SET DP013-XCTL-DISPLAY-RESTART                   19810037
198200                                   TO TRUE                        19820037
198300                 PERFORM DP013-0000-PROCESS-ABEND                 19830037
198400         END-EVALUATE                                             19840037
198500     END-PERFORM.                                                 19850037
198600                                                                  19860037
198700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    19870037
198800         SQLCODE NOT = +0                                         19880037
198900         MOVE '4130-GET-PLANNED-SHIP-INFO'                        19890037
199000                                   TO DP013-PARAGRAPH             19900037
199100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     19910037
199200                                   TO DP013-MESSAGE-TEXT (1)      19920037
199300         MOVE 'PLANNED SHIPMENT INFO FOR PO'                      19930037
199400                                   TO DP013-MESSAGE-TEXT (2)      19940037
199500         MOVE SQLCA                TO DP013-SQLCA                 19950037
199600         MOVE 'TPLNSHP'            TO DP013-DB2-TABLE-NAME (1)    19960037
199700         SET DP013-DB2-ABEND       TO TRUE                        19970037
199800         SET DP013-XCTL-DISPLAY-RESTART                           19980037
199900                                   TO TRUE                        19990037
200000         PERFORM DP013-0000-PROCESS-ABEND                         20000037
200100     END-IF.                                                      20010037
200200                                                                  20020037
200300/                                                                 20030037
200400*----------------------------------------------------------------*20040037
200500*    GET THE EARLIEST AD DATE                                    *20050037
200600*----------------------------------------------------------------*20060037
200700 4140-GET-AD-DATE.                                                20070037
200800                                                                  20080037
200900     PERFORM                                                      20090037
201000         WITH TEST AFTER                                          20100037
201100         VARYING PV-RETRY-COUNTER                                 20110037
201200         FROM 1 BY 1                                              20120037
201300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20130037
201400             OR (SQLCODE = +0)                                    20140037
201500             OR (SQLCODE = -305))                                 20150037
201600                                                                  20160037
201700         EXEC SQL                                                 20170037
201800              SELECT MIN(AD_EVNT_DTE)                             20180037
201900                INTO :PURITM-AD-EVNT-DTE                          20190037
202000                       :DN-AD-EVNT-DTE                            20200037
202100                FROM TPURITM                                      20210037
202200               WHERE PO_NBR         = :DK-PO-NBR                  20220037
202300                 AND VER_STATUS_CDE = 'A'                         20230037
202400                 AND AD_EVNT_DTE > '0001-01-01'                   20240037
202500         END-EXEC                                                 20250037
202600                                                                  20260037
202700         EVALUATE TRUE                                            20270037
202800             WHEN SQLCODE = +0                                    20280037
202900             WHEN SQLCODE = -305                                  20290037
203000             WHEN SQLCODE = -904                                  20300037
203100             WHEN SQLCODE = -913                                  20310037
203200                  CONTINUE                                        20320037
203300                                                                  20330037
203400             WHEN SQLWARN0 NOT = SPACES                           20340037
203500             WHEN SQLCODE < +0                                    20350037
203600             WHEN SQLCODE > +0                                    20360037
203700                  MOVE '4140-GET-AD-DATE'                         20370037
203800                                   TO DP013-PARAGRAPH             20380037
203900                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           20390037
204000                                   TO DP013-MESSAGE-TEXT (1)      20400037
204100                  MOVE SQLCA       TO DP013-SQLCA                 20410037
204200                  MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)    20420037
204300                  SET DP013-DB2-ABEND                             20430037
204400                      DP013-XCTL-DISPLAY-RESTART                  20440037
204500                                   TO TRUE                        20450037
204600                  PERFORM DP013-0000-PROCESS-ABEND                20460037
204700         END-EVALUATE                                             20470037
204800     END-PERFORM.                                                 20480037
204900                                                                  20490037
205000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    20500037
205100         SQLCODE NOT = +0                                         20510037
205200         MOVE '4140-GET-AD-DATE'                                  20520037
205300                                   TO DP013-PARAGRAPH             20530037
205400         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            20540037
205500                                   TO DP013-MESSAGE-TEXT (1)      20550037
205600         MOVE SQLCA                TO DP013-SQLCA                 20560037
205700         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    20570037
205800         SET DP013-DB2-ABEND                                      20580037
205900             DP013-XCTL-DISPLAY-RESTART                           20590037
206000                                   TO TRUE                        20600037
206100         PERFORM DP013-0000-PROCESS-ABEND                         20610037
206200     END-IF.                                                      20620037
206300                                                                  20630037
206400*----------------------------------------------------------------*20640037
206500*    GET THE BUYER NAME AND NUMBER INFORMATION FROM THE MBS      *20650037
206600*    TABLES USING SUBROUTINE 'DPKUT038'.                         *20660037
206700*----------------------------------------------------------------*20670037
206800 4160-GET-BUYER-NAME.                                             20680037
206900                                                                  20690037
207000     INITIALIZE ASC-BUYER-NAME.                                   20700037
207100                                                                  20710037
207200     EXEC CICS                                                    20720037
207300         ASKTIME ABSTIME (ST-ABSTIME)                             20730037
207400     END-EXEC.                                                    20740037
207500                                                                  20750037
207600     EXEC CICS                                                    20760037
207700         FORMATTIME ABSTIME (ST-ABSTIME)                          20770037
207800                    YYMMDD  (PV-CURRENT-DATE)                     20780037
207900     END-EXEC.                                                    20790037
208000                                                                  20800037
208100     MOVE PURCHS-DEPT-NBR          TO DP003-DPT-INPUT.            20810037
208200     SET DP003-BYR-LOOKUP-NAME     TO TRUE.                       20820037
208300     SET DP003-BYR-NAME-FIRST-LAST TO TRUE.                       20830037
208400                                                                  20840037
208500     MOVE 'MP'                     TO DP003-SYSTEM-CODE.          20850037
208600     MOVE '03'                     TO DP003-OP-CO-NMBR.           20860037
208700     MOVE PV-CURRENT-DATE          TO DP003-CURRENT-DATE          20870037
208800                                          DP003-EFF-DATE.         20880037
208900                                                                  20890037
209000     EXEC CICS                                                    20900037
209100         LINK PROGRAM  (PV-DPKUT038)                              20910037
209200              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              20920037
209300              LENGTH   (PV-DPKUT038-CA-LENGTH)                    20930037
209400              RESP     (PV-CICS-RESPONSE)                         20940037
209500     END-EXEC.                                                    20950037
209600                                                                  20960037
209700     EVALUATE TRUE                                                20970037
209800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 20980037
209900              CONTINUE                                            20990037
210000         WHEN OTHER                                               21000037
210100              MOVE '4160-GET-BUYER-NAME'                          21010037
210200                                   TO DP013-PARAGRAPH             21020037
210300              MOVE 'CANNOT LINK TO DPKUT038'                      21030037
210400                                   TO DP013-MESSAGE-TEXT (1)      21040037
210500              SET DP013-CICS-ABEND TO TRUE                        21050037
210600              SET DP013-NO-ROLLBACK                               21060037
210700                                   TO TRUE                        21070037
210800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              21080037
210900     END-EVALUATE.                                                21090037
211000                                                                  21100037
211100     IF  PS-NO-ERROR                                              21110037
211200         EVALUATE TRUE                                            21120037
211300             WHEN DP003-SUCCESSFUL                                21130037
211400                  MOVE DP003-BYR-NAME                             21140037
211500                                   TO ASC-BUYER-NAME              21150037
211600                                                                  21160037
211700             WHEN DP003-BYR-NAME-NOT-FOUND                        21170037
211800                  MOVE '* NO BUYER NAME FOUND * '                 21180037
211900                                   TO ASC-BUYER-NAME              21190037
212000                                                                  21200037
212100             WHEN DP003-BYR-NAME-DB2-ERROR                        21210037
212200                  MOVE '4160-GET-BUYER-NAME'                      21220037
212300                                   TO DP013-PARAGRAPH             21230037
212400                  MOVE DP003-RETURN-MSG                           21240037
212500                                   TO DP013-MESSAGE-TEXT (1)      21250037
212600                  MOVE DP003-DPT-INPUT                            21260037
212700                                   TO DP013-MESSAGE-TEXT (2)      21270037
212800                  MOVE DP003-SQLCA TO DP013-SQLCA                 21280037
212900                  MOVE 'TMDSEAR'   TO DP013-DB2-TABLE-NAME (1)    21290037
213000                  MOVE 'TAPLAVL'   TO DP013-DB2-TABLE-NAME (2)    21300037
213100                  MOVE 'TRSPBAR'   TO DP013-DB2-TABLE-NAME (3)    21310037
213200                  SET DP013-DB2-ABEND                             21320037
213300                                   TO TRUE                        21330037
213400                  SET DP013-NO-ROLLBACK                           21340037
213500                                   TO TRUE                        21350037
213600                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          21360037
213700                                                                  21370037
213800             WHEN DP003-BYR-NAME-MAX-RETRIES                      21380037
213900                  MOVE '4160-GET-BUYER-NAME'                      21390037
214000                                   TO DP013-PARAGRAPH             21400037
214100                  MOVE DP003-RETURN-MSG                           21410037
214200                                   TO DP013-MESSAGE-TEXT (1)      21420037
214300                  MOVE DP003-DPT-INPUT                            21430037
214400                                   TO DP013-MESSAGE-TEXT (2)      21440037
214500                  MOVE DP003-SQLCA TO DP013-SQLCA                 21450037
214600                  MOVE 'TMDSEAR'   TO DP013-DB2-TABLE-NAME (1)    21460037
214700                  MOVE 'TAPLAVL'   TO DP013-DB2-TABLE-NAME (2)    21470037
214800                  MOVE 'TRSPBAR'   TO DP013-DB2-TABLE-NAME (3)    21480037
214900                  SET DP013-DB2-ABEND                             21490037
215000                                   TO TRUE                        21500037
215100                  SET DP013-NO-ROLLBACK                           21510037
215200                                   TO TRUE                        21520037
215300                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          21530037
215400                                                                  21540037
215500             WHEN OTHER                                           21550037
215600                  MOVE '4160-GET-BUYER-NAME'                      21560037
215700                                   TO DP013-PARAGRAPH             21570037
215800                  MOVE DP003-RETURN-MSG                           21580037
215900                                   TO DP013-MESSAGE-TEXT (1)      21590037
216000                  MOVE DP003-DPT-INPUT                            21600037
216100                                   TO DP013-MESSAGE-TEXT (2)      21610037
216200                  MOVE DP003-SQLCA TO DP013-SQLCA                 21620037
216300                  MOVE 'TMDSEAR'   TO DP013-DB2-TABLE-NAME (1)    21630037
216400                  MOVE 'TAPLAVL'   TO DP013-DB2-TABLE-NAME (2)    21640037
216500                  MOVE 'TRSPBAR'   TO DP013-DB2-TABLE-NAME (3)    21650037
216600                  SET DP013-OTHER-ABEND                           21660037
216700                                   TO TRUE                        21670037
216800                  SET DP013-NO-ROLLBACK                           21680037
216900                                   TO TRUE                        21690037
217000                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          21700037
217100       END-EVALUATE.                                              21710037
217200                                                                  21720037
217300/                                                                 21730037
217400*----------------------------------------------------------------*21740037
217500*    GET MOST RECENT RECEIVER INFO                               *21750037
217600*----------------------------------------------------------------*21760037
217700 4200-SELECT-TRECEIV.                                             21770037
217800                                                                  21780037
217900     PERFORM                                                      21790037
218000         WITH TEST AFTER                                          21800037
218100         VARYING PV-RETRY-COUNTER                                 21810037
218200         FROM 1 BY 1                                              21820037
218300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21830037
218400            OR (SQLCODE = +0)                                     21840037
218500            OR (SQLCODE = +100))                                  21850037
218600                                                                  21860037
218700         EXEC SQL                                                 21870037
218800            SELECT  A.OPER_UNT_ID                                 21880037
218900                   ,A.FCLTY_ID                                    21890037
219000                   ,A.CRE_UID                                     21900037
219100                   ,A.CRE_TMST                                    21910037
219200                   ,A.EXPTED_CART_CNT                             21920037
219300                   ,A.ACTL_CART_CNT                               21930037
219400                   ,A.REC_TMST                                    21940037
219500                   ,A.PRE_TKT_IND                                 21950037
219600                   ,A.AD_INFO_DESC                                21960037
219700                   ,A.REC_TYP_CDE                                 21970037
219800                   ,A.RCVG_CLERK_INIT_ID                          21980037
219900                   ,A.RCVR_NBR                                    21990037
220000                   ,A.STATUS_CDE                                  22000037
220100                   ,A.VERFYD_TMST                                 22010037
220200                   ,A.APRON_LOC_DESC                              22020037
220300                   ,A.UPD_TMST                                    22030037
220400                   ,B.STATUS_DESC                                 22040037
220500                   ,A.CURR_OPER_UNT_ID                            22050037
220600                   ,A.CURR_FCLTY_ID                               22060037
220700                   ,A.CRE_OPER_UNT_ID                             22070037
220800                   ,A.CRE_FCLTY_ID                                22080037
220900                   ,A.MKNG_APRN_PRT_TMST                          22090037
221000                   ,A.PKGNG_CDE                                   22100061
221100              INTO :RECEIV-OPER-UNT-ID                            22110037
221200                  ,:RECEIV-FCLTY-ID                               22120037
221300                  ,:RECEIV-CRE-UID                                22130037
221400                  ,:RECEIV-CRE-TMST                               22140037
221500                  ,:RECEIV-EXPTED-CART-CNT                        22150037
221600                  ,:RECEIV-ACTL-CART-CNT                          22160037
221700                  ,:RECEIV-REC-TMST                               22170037
221800                  ,:RECEIV-PRE-TKT-IND                            22180037
221900                  ,:RECEIV-AD-INFO-DESC                           22190037
222000                  ,:RECEIV-REC-TYP-CDE                            22200037
222100                  ,:RECEIV-RCVG-CLERK-INIT-ID                     22210037
222200                  ,:RECEIV-RCVR-NBR                               22220037
222300                  ,:RECEIV-STATUS-CDE                             22230037
222400                  ,:RECEIV-VERFYD-TMST                            22240037
222500                  ,:RECEIV-APRON-LOC-DESC                         22250037
222600                  ,:RECEIV-UPD-TMST                               22260037
222700                  ,:STATCD-STATUS-DESC                            22270037
222800                  ,:RECEIV-CURR-OPER-UNT-ID                       22280037
222900                  ,:RECEIV-CURR-FCLTY-ID                          22290037
223000                  ,:RECEIV-CRE-OPER-UNT-ID                        22300037
223100                  ,:RECEIV-CRE-FCLTY-ID                           22310037
223200                  ,:RECEIV-MKNG-APRN-PRT-TMST                     22320037
223300                  ,:RECEIV-PKGNG-CDE                              22330061
223400              FROM  TRECEIV A                                     22340037
223500                   ,TSTATCD B                                     22350037
223600             WHERE A.ORD_NBR     = :DK-PO-NBR                     22360061
223700               AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                22370037
223800               AND A.VER_STATUS_CDE = 'A'                         22380037
223900               AND B.STATUS_TYP_CDE = 'R'                         22390037
224000               AND A.STATUS_CDE     = B.STATUS_CDE                22400037
224100         END-EXEC                                                 22410037
224200                                                                  22420037
224300         EVALUATE TRUE                                            22430037
224400             WHEN SQLCODE = +0                                    22440037
224500                 SET PS-TRECEIV-FOUND                             22450037
224600                                   TO TRUE                        22460037
224700                                                                  22470037
224800             WHEN SQLCODE = +100                                  22480037
224900                 SET PS-TRECEIV-NOT-FOUND                         22490037
225000                                   TO TRUE                        22500037
225100                                                                  22510037
225200             WHEN SQLCODE = -904                                  22520037
225300             WHEN SQLCODE = -913                                  22530037
225400                 CONTINUE                                         22540037
225500                                                                  22550037
225600             WHEN SQLWARN0 NOT = SPACE                            22560037
225700             WHEN SQLCODE < +0                                    22570037
225800             WHEN SQLCODE > +0                                    22580037
225900                 MOVE '4200-SELECT-TRECEIV'                       22590037
226000                                   TO DP013-PARAGRAPH             22600037
226100                 MOVE 'SELECT ON TRECEIV'                         22610037
226200                                   TO DP013-MESSAGE-TEXT (1)      22620037
226300                 MOVE SQLCA        TO DP013-SQLCA                 22630037
226400                 MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)    22640037
226500                 MOVE 'TSTATCD'    TO DP013-DB2-TABLE-NAME (2)    22650037
226600                 SET DP013-DB2-ABEND                              22660037
226700                                   TO TRUE                        22670037
226800                 SET DP013-XCTL-DISPLAY-RESTART                   22680037
226900                                   TO TRUE                        22690037
227000                 PERFORM DP013-0000-PROCESS-ABEND                 22700037
227100         END-EVALUATE                                             22710037
227200     END-PERFORM.                                                 22720037
227300                                                                  22730037
227400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    22740037
227500         SQLCODE NOT = +0                                         22750037
227600         MOVE '4200-SELECT-TRECEIV'                               22760037
227700                                   TO DP013-PARAGRAPH             22770037
227800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22780037
227900                                   TO DP013-MESSAGE-TEXT (1)      22790037
228000         MOVE 'RECEIVER INFO'                                     22800037
228100                                   TO DP013-MESSAGE-TEXT (2)      22810037
228200         MOVE SQLCA                TO DP013-SQLCA                 22820037
228300         MOVE 'TRECEIV'            TO DP013-DB2-TABLE-NAME (1)    22830037
228400         MOVE 'TSTATCD'            TO DP013-DB2-TABLE-NAME (2)    22840037
228500         SET DP013-DB2-ABEND       TO TRUE                        22850037
228600         SET DP013-XCTL-DISPLAY-RESTART                           22860037
228700                                   TO TRUE                        22870037
228800         PERFORM DP013-0000-PROCESS-ABEND                         22880037
228900     END-IF.                                                      22890037
229000                                                                  22900037
229100/                                                                 22910037
229200*----------------------------------------------------------------*22920037
229300*    LOAD THE RECEIPTS DATABSE FIELDS INTO THE COMMAREA          *22930037
229400*----------------------------------------------------------------*22940037
229500 4210-LOAD-RECEIPT-FIELDS.                                        22950037
229600                                                                  22960037
229700*  RECEIVER NUMBER                                                22970037
229800     MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR.                  22980037
229900     MOVE ASC-KEY-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.             22990037
230000                                                                  23000037
230100*  RECEIVER LOCATION                                              23010037
230200     MOVE RECEIV-OPER-UNT-ID       TO ASC-ATL-OPER-UNT-ID.        23020037
230300     MOVE RECEIV-FCLTY-ID          TO ASC-ATL-FCLTY-ID.           23030037
230400     MOVE RECEIV-CURR-OPER-UNT-ID  TO ASC-CUR-OPER-UNT-ID.        23040037
230500     MOVE RECEIV-CURR-FCLTY-ID     TO ASC-CUR-FCLTY-ID.           23050037
230600     MOVE RECEIV-CRE-OPER-UNT-ID   TO ASC-ORIG-OPER-UNT-ID.       23060037
230700     MOVE RECEIV-CRE-FCLTY-ID      TO ASC-ORIG-FCLTY-ID.          23070037
230800     IF RECEIV-MKNG-APRN-PRT-TMST = '9999-09-09-09.09.09.999999'  23080037
230900        MOVE SPACES                TO ASC-MK-HDR-DATE             23090037
231000                                      ASC-MK-HDR-TIME             23100037
231100     ELSE                                                         23110037
231200        MOVE RECEIV-MKNG-APRN-PRT-TMST                            23120037
231300                                   TO PV-DB2-TIMESTAMP            23130037
231400         STRING PV-DB2-TMST-MM DELIMITED BY SIZE                  23140037
231500                '/'            DELIMITED BY SIZE                  23150037
231600                PV-DB2-TMST-DD DELIMITED BY SIZE                  23160037
231700                                 INTO ASC-MK-HDR-DATE             23170037
231800         STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                 23180037
231900                ':'             DELIMITED BY SIZE                 23190037
232000                PV-DB2-TMST-MIN DELIMITED BY SIZE                 23200037
232100                                 INTO ASC-MK-HDR-TIME             23210037
232200     END-IF.                                                      23220037
232300                                                                  23230037
232400*  AD INFO                                                        23240037
232500     MOVE RECEIV-AD-INFO-DESC      TO ASC-AD-INFO.                23250037
232600                                                                  23260037
232700*  RCVR STATUS                                                    23270037
232800     MOVE STATCD-STATUS-DESC       TO ASC-RCVR-STATUS.            23280037
232900                                                                  23290037
233000*  RCVR CREATOR                                                   23300037
233100     PERFORM 4215-GET-ORIGINAL-UID.                               23310037
233200     MOVE PV-ORIGINAL-UID          TO ASC-RCVR-CREATOR.           23320037
233300                                                                  23330037
233400*  REC CLERK ID                                                   23340037
233500     MOVE RECEIV-RCVG-CLERK-INIT-ID                               23350037
233600                                   TO ASC-REC-CLERK               23360037
233700                                                                  23370037
233800*  DOCK AREA AND DOOR                                             23380037
233900     INITIALIZE DCLTSHPTPO                                        23390037
234000                DCLTVHTRIP                                        23400037
234100                DCLTVEHICL.                                       23410037
234200     PERFORM 4220-GET-VEHICLE-INFO.                               23420037
234300*  CARRIER                                                        23430037
234400*  DAMAGED CARTON COUNT                                           23440037
234500*  TRAILER NBR                                                    23450037
234600     IF  SQLCODE = -811                                           23460037
234700         MOVE 'MULT'               TO ASC-CARRIER                 23470037
234800         MOVE 'MULT'               TO ASC-DMG-CART-CNT            23480037
234900         MOVE 'MULTIPLE'           TO ASC-TRAILER-NBR             23490037
235000     ELSE                                                         23500037
235100         MOVE VHTRIP-OWNER-SCAC-ID TO ASC-CARRIER                 23510037
235200         MOVE SHPTPO-DMG-CART-CNT  TO ASC-DMG-CART-CNT-N          23520037
235300         IF DN-VEH-NBR = -1                                       23530037
235400             MOVE SPACES           TO ASC-TRAILER-NBR             23540037
235500         ELSE                                                     23550037
235600             MOVE VHTRIP-VEH-NBR   TO ASC-TRAILER-NBR             23560037
235700         END-IF                                                   23570037
235800         MOVE VEHICL-CURR-TRIP-ID  TO DK-TRIP-ID                  23580037
235900                                                                  23590037
237500     END-IF.                                                      23750037
237600                                                                  23760037
237700                                                                  23770037
237800*  PRO NUMBER                                                     23780037
237900*  BOL NUMBER                                                     23790037
238000     INITIALIZE DCLTSHIPMT.                                       23800037
238100     PERFORM 4225-GET-SHIPMENT-INFO.                              23810037
238200     IF  SQLCODE = -811                                           23820037
238300         MOVE 'MULTIPLE'           TO ASC-PRO-NUMBER              23830037
238400                                      ASC-BOL-NUMBER              23840037
238500     ELSE                                                         23850037
238600         MOVE SHIPMT-PRO-NBR       TO ASC-PRO-NUMBER              23860037
238700         MOVE SHIPMT-BOL-NBR       TO ASC-BOL-NUMBER              23870037
238800     END-IF.                                                      23880037
238900                                                                  23890037
239000*  VENDOR SHIP DATE                                               23900037
239100     IF  SHIPMT-VEND-SHIP-DTE = '0001-01-01'                      23910037
239200     OR  SHIPMT-VEND-SHIP-DTE = SPACES                            23920037
239300         MOVE SPACES               TO ASC-VDR-SHIP-DATE           23930037
239400     ELSE                                                         23940037
239500         MOVE SHIPMT-VEND-SHIP-DTE TO PV-DB2-DATE                 23950037
239600         MOVE PV-DB2-DATE-MM       TO PV-DISPLAY-DATE-MM          23960037
239700         MOVE PV-DB2-DATE-DD       TO PV-DISPLAY-DATE-DD          23970037
239800         MOVE PV-DB2-DATE-YY       TO PV-DISPLAY-DATE-YY          23980037
239900         MOVE PV-DISPLAY-DATE      TO ASC-VDR-SHIP-DATE           23990037
240000     END-IF.                                                      24000037
240100                                                                  24010037
240200*  CARRIER SHIP DATE                                              24020037
240300     IF  VHTRIP-OWNR-SCAC-SHIP-DTE = '0001-01-01'                 24030037
240400     OR  VHTRIP-OWNR-SCAC-SHIP-DTE = SPACES                       24040037
240500         MOVE SPACES               TO ASC-CARR-SHIP-DTE           24050037
240600     ELSE                                                         24060037
240700         MOVE VHTRIP-OWNR-SCAC-SHIP-DTE                           24070037
240800                                   TO PV-DB2-DATE                 24080037
240900         MOVE PV-DB2-DATE-MM       TO PV-DISPLAY-DATE-MM          24090037
241000         MOVE PV-DB2-DATE-DD       TO PV-DISPLAY-DATE-DD          24100037
241100         MOVE PV-DB2-DATE-YY       TO PV-DISPLAY-DATE-YY          24110037
241200         MOVE PV-DISPLAY-DATE      TO ASC-CARR-SHIP-DTE           24120037
241300     END-IF.                                                      24130037
241400                                                                  24140037
241500*  RECEIPT DATE                                                   24150037
241600     IF RECEIV-REC-TMST = '9999-09-09-09.09.09.999999'            24160037
241700        MOVE 'ENROUTE'             TO ASC-ARRIVAL-DATE            24170037
241800     ELSE                                                         24180037
241900        MOVE RECEIV-REC-TMST       TO PV-DB2-TIMESTAMP            24190037
242000        MOVE PV-DB2-TMST-MM        TO PV-DISPLAY-DATE-MM          24200037
242100        MOVE PV-DB2-TMST-DD        TO PV-DISPLAY-DATE-DD          24210037
242200        MOVE PV-DB2-TMST-YY        TO PV-DISPLAY-DATE-YY          24220037
242300        MOVE PV-DISPLAY-DATE       TO ASC-ARRIVAL-DATE.           24230037
242400                                                                  24240037
242500*  MARKING APRON DATE AND TIME                                    24250037
242600     INITIALIZE DCLTRECITM.                                       24260037
242700     PERFORM 4240-GET-MARKING-INFO.                               24270037
242800     IF  SQLCODE = +0                                             24280037
242900         IF RECITM-MKING-APRON-TMST                               24290037
243000                            = '9999-09-09-09.09.09.999999'        24300037
243100             MOVE SPACES           TO ASC-MK-APRN-DATE            24310037
243200                                      ASC-MK-APRN-TIME            24320037
243300         ELSE                                                     24330037
243400             MOVE RECITM-MKING-APRON-TMST                         24340037
243500                                   TO PV-DB2-TIMESTAMP            24350037
243600             STRING PV-DB2-TMST-MM DELIMITED BY SIZE              24360037
243700                '/'            DELIMITED BY SIZE                  24370037
243800                PV-DB2-TMST-DD DELIMITED BY SIZE                  24380037
243900                                 INTO ASC-MK-APRN-DATE            24390037
244000             STRING PV-DB2-TMST-HH  DELIMITED BY SIZE             24400037
244100                ':'             DELIMITED BY SIZE                 24410037
244200                PV-DB2-TMST-MIN DELIMITED BY SIZE                 24420037
244300                                 INTO ASC-MK-APRN-TIME            24430037
244400         END-IF                                                   24440037
244500     ELSE                                                         24450037
244600         MOVE SPACES               TO ASC-MK-APRN-DATE            24460037
244700                                      ASC-MK-APRN-TIME            24470037
244800     END-IF.                                                      24480037
244900                                                                  24490037
245000*  PROC AREA INFO (ASN)                                           24500037
245100     INITIALIZE DCLTPKSLIP.                                       24510037
245200                                                                  24520037
245300     PERFORM 4270-SELECT-SRCCDE-TPKSLIP.                          24530037
245400     MOVE PKSLIP-CRE-SRC-CDE       TO ASC-PROC-INFO-ASN.          24540037
245500                                                                  24550037
245600     PERFORM 4275-SELECT-CRETMST-TPKSLIP.                         24560037
245700*  TRANSCRIBE DATE AND TIME                                       24570037
245800     IF  SQLCODE = +0                                             24580037
245900         MOVE PKSLIP-CRE-TMST      TO PV-DB2-TIMESTAMP            24590037
246000         STRING PV-DB2-TMST-MM DELIMITED BY SIZE                  24600037
246100                '/'            DELIMITED BY SIZE                  24610037
246200                PV-DB2-TMST-DD DELIMITED BY SIZE                  24620037
246300                                 INTO ASC-TRANSCRIBE-DATE         24630037
246400         STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                 24640037
246500                ':'             DELIMITED BY SIZE                 24650037
246600                PV-DB2-TMST-MIN DELIMITED BY SIZE                 24660037
246700                                 INTO ASC-TRANSCRIBE-TIME         24670037
246800     ELSE                                                         24680037
246900         MOVE SPACES               TO ASC-TRANSCRIBE-DATE         24690037
247000                                      ASC-TRANSCRIBE-TIME         24700037
247100     END-IF.                                                      24710037
247200                                                                  24720037
247300                                                                  24730037
247400*  TICKET TYPE                                                    24740037
247500     INITIALIZE DCLTDCTFAS.                                       24750037
247600     MOVE ASC-DEPT                 TO DK-DEPT-NBR.                24760046
247700                                                                  24770048
247800*  GET SUB CLASS NUMBER CALLING XLKUT001 (BLACK BOX)              24780054
247900     PERFORM 4259-SELECT-MIN-ITM.                                 24790048
248000                                                                  24800057
248100     MOVE SPACES               TO PV-SUB-CL-NBR-2CH               24810057
248200                                                                  24820057
248300     IF SQLCODE = +0                                              24830057
248400         PERFORM 4261-CALL-XLKUT001                               24840057
248500         IF XL001-SUCCESSFUL                                      24850057
248600             MOVE XL001-SUB-CL-NBR-2CH TO PV-SUB-CL-NBR-2CH       24860057
248700         END-IF                                                   24870057
248800     END-IF                                                       24880048
248900                                                                  24890048
249000     PERFORM 4260-SELECT-TDCTFAS.                                 24900037
249100                                                                  24910037
249200     IF  SQLCODE = +0                                             24920037
249300         IF  DN-TKT-FMT-ID = -1                                   24930037
249400             MOVE SPACES           TO ASC-TKT-FMT-ID              24940037
249500         ELSE                                                     24950037
249600             MOVE DCTFAS-TKT-FMT-ID                               24960037
249700                                   TO ASC-TKT-FMT-ID              24970037
249800         END-IF                                                   24980037
249900     ELSE                                                         24990037
250000         MOVE SPACES               TO ASC-TKT-FMT-ID              25000037
250100     END-IF.                                                      25010037
250200                                                                  25020037
250300*  AP RCVR NBR                                                    25030037
250400     MOVE RECEIV-RCVR-NBR          TO ASC-RCVR-NBR.               25040037
250500                                                                  25050037
250600*  OPERATION SET AND DESCRIPTION                                  25060037
250700     IF  RECEIV-REC-TYP-CDE = 'EX'                                25070037
250800         MOVE ZEROES               TO ASC-OPER-SET-ID-N           25080037
250900         MOVE 'EXPENSE RECEIPT'    TO ASC-OPER-SET-DESC           25090037
251000     ELSE                                                         25100037
251100         PERFORM 4280-GET-OPER-SET-DESC                           25110037
251200         MOVE WRKORD-OPER-SET-ID   TO ASC-OPER-SET-ID-N           25120037
251300         MOVE OPRSET-OPER-SET-DESC TO ASC-OPER-SET-DESC           25130037
251400     END-IF.                                                      25140037
251500                                                                  25150037
251600     INITIALIZE PV-DB2-COUNT.                                     25160037
251700     MOVE RECEIV-OPER-UNT-ID       TO PV-OPER-UNT-ID.             25170037
251800     MOVE PV-OPER-UNT-ID-X         TO DK-STORE-NMBR.              25180046
251900     MOVE PV-OPER-UNT-ID           TO DK-OPER-UNT-ID.             25190039
252000                                                                  25200039
252100     PERFORM 4290-CHECK-DIRECT-STORE.                             25210037
252200     IF  PV-DB2-COUNT > +0                                        25220037
252300         MOVE RECEIV-OPER-UNT-ID   TO ASC-OPER-SET-ID-N           25230037
252400         MOVE 'DIRECT STORE SHIPMENT'                             25240037
252500                                   TO ASC-OPER-SET-DESC           25250037
252600     END-IF.                                                      25260037
252700                                                                  25270037
252800*  APRON LOCATION DESCRIPTION                                     25280037
252900     MOVE RECEIV-APRON-LOC-DESC    TO ASC-APRON-LOC-DESC.         25290037
253000                                                                  25300037
253100*  CARTON COUNT                                                   25310037
253200     MOVE RECEIV-EXPTED-CART-CNT   TO ASC-EXPTED-CART-CNT-N.      25320037
253300                                                                  25330037
253400*  ACTL CARTON COUNT                                              25340037
253500     MOVE RECEIV-ACTL-CART-CNT     TO ASC-ACTL-CART-CNT-N.        25350037
253600                                                                  25360037
253700*  RECEIVER CREATE DATE AND TIME                                  25370037
253800     MOVE RECEIV-REC-TMST          TO PV-DB2-TIMESTAMP.           25380037
253900     IF  RECEIV-REC-TMST = '9999-09-09-09.09.09.999999'           25390037
254000         MOVE SPACES               TO ASC-RCV-CRE-DATE            25400037
254100                                      ASC-RCV-CRE-TIME            25410037
254200     ELSE                                                         25420037
254300         STRING PV-DB2-TMST-MM DELIMITED BY SIZE                  25430037
254400            '/'            DELIMITED BY SIZE                      25440037
254500            PV-DB2-TMST-DD DELIMITED BY SIZE                      25450037
254600                                 INTO ASC-RCV-CRE-DATE            25460037
254700         STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                 25470037
254800            ':'             DELIMITED BY SIZE                     25480037
254900            PV-DB2-TMST-MIN DELIMITED BY SIZE                     25490037
255000                                 INTO ASC-RCV-CRE-TIME            25500037
255100     END-IF.                                                      25510037
255200                                                                  25520037
255300*  LAST CHANGE DATE AND TIME                                      25530037
255400     MOVE RECEIV-UPD-TMST          TO PV-DB2-TIMESTAMP.           25540037
255500     STRING PV-DB2-TMST-MM DELIMITED BY SIZE                      25550037
255600            '/'            DELIMITED BY SIZE                      25560037
255700            PV-DB2-TMST-DD DELIMITED BY SIZE                      25570037
255800                                 INTO ASC-LAST-CHNG-DATE.         25580037
255900     STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                     25590037
256000            ':'             DELIMITED BY SIZE                     25600037
256100            PV-DB2-TMST-MIN DELIMITED BY SIZE                     25610037
256200                                 INTO ASC-LAST-CHNG-TIME.         25620037
256300                                                                  25630037
256400*  SHIPPED DATE AND TIME IS ACTUALLY THE DATE AND TIME THAT THE   25640037
256500*  RECEIVER WAS VERIFIED.                                         25650037
256600     IF  RECEIV-VERFYD-TMST = '9999-09-09-09.09.09.999999'        25660037
256700         MOVE SPACES               TO ASC-SHIPPED-DATE            25670037
256800                                      ASC-PCS-VER-DATE            25680037
256900         MOVE SPACES               TO ASC-SHIPPED-TIME            25690037
257000                                      ASC-PCS-VER-TIME            25700037
257100     ELSE                                                         25710037
257200         MOVE RECEIV-VERFYD-TMST   TO PV-DB2-TIMESTAMP            25720037
257300         STRING PV-DB2-TMST-MM DELIMITED BY SIZE                  25730037
257400                '/'            DELIMITED BY SIZE                  25740037
257500                PV-DB2-TMST-DD DELIMITED BY SIZE                  25750037
257600                                 INTO ASC-SHIPPED-DATE            25760037
257700         MOVE ASC-SHIPPED-DATE     TO ASC-PCS-VER-DATE            25770037
257800         STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                 25780037
257900                ':'             DELIMITED BY SIZE                 25790037
258000                PV-DB2-TMST-MIN DELIMITED BY SIZE                 25800037
258100                                 INTO ASC-SHIPPED-TIME            25810037
258200         MOVE ASC-SHIPPED-TIME     TO ASC-PCS-VER-TIME            25820037
258300     END-IF.                                                      25830037
258400                                                                  25840037
258500*  CHANGD BY                                                      25850037
258600     MOVE RECEIV-CRE-UID           TO ASC-CHANGD-BY.              25860037
258700                                                                  25870037
258800*  PCS INVCD AND VERFD                                            25880037
258900     INITIALIZE PA-INVOICED-COUNT                                 25890037
259000                PA-AP-VERIFIED-COUNT.                             25900037
259100                                                                  25910037
259200     PERFORM 4230-SUM-QTY.                                        25920037
259300                                                                  25930037
259400     MOVE PA-INVOICED-COUNT        TO ASC-PCS-INVCD-N.            25940037
259500                                                                  25950037
259600     IF  RECEIV-STATUS-CDE = 'VE'                                 25960037
259700         MOVE PA-AP-VERIFIED-COUNT TO ASC-PCS-VERFD-N             25970037
259800     ELSE                                                         25980037
259900         MOVE ZEROES               TO ASC-PCS-VERFD-N             25990037
260000     END-IF.                                                      26000037
260100                                                                  26010037
260200/                                                                 26020037
260300*----------------------------------------------------------------*26030037
260400*    GET ORIGINAL UID                                            *26040037
260500*----------------------------------------------------------------*26050037
260600 4215-GET-ORIGINAL-UID.                                           26060037
260700                                                                  26070037
260800     PERFORM                                                      26080037
260900         WITH TEST AFTER                                          26090037
261000         VARYING PV-RETRY-COUNTER                                 26100037
261100         FROM 1 BY 1                                              26110037
261200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26120037
261300            OR (SQLCODE = +0)                                     26130037
261400            OR (SQLCODE = +100))                                  26140037
261500                                                                  26150037
261600         EXEC SQL                                                 26160037
261700             SELECT A.CRE_UID                                     26170037
261800                   ,A.PACK_BY_ST_IND                              26180061
261900              INTO :PV-ORIGINAL-UID                               26190037
262000                  ,:RECEIV-PACK-BY-ST-IND                         26200061
262100              FROM  TRECEIV A                                     26210037
262200             WHERE A.ORD_NBR     = :DK-PO-NBR                     26220065
262300               AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                26230037
262400               AND A.CRE_TMST    =                                26240037
262500                (SELECT MIN(B.CRE_TMST)                           26250037
262600                   FROM TRECEIV B                                 26260037
262700                   WHERE B.ORD_NBR     = :DK-PO-NBR               26270065
262800                     AND B.REC_SEQ_NBR = :DK-REC-SEQ-NBR)         26280037
262900         END-EXEC                                                 26290037
263000                                                                  26300037
263100         EVALUATE TRUE                                            26310037
263200             WHEN SQLCODE = +0                                    26320037
263300             WHEN SQLCODE = +100                                  26330037
263400             WHEN SQLCODE = -904                                  26340037
263500             WHEN SQLCODE = -913                                  26350037
263600                 CONTINUE                                         26360037
263700                                                                  26370037
263800             WHEN SQLWARN0 NOT = SPACE                            26380037
263900             WHEN SQLCODE < +0                                    26390037
264000             WHEN SQLCODE > +0                                    26400037
264100                 MOVE '4215-GET-ORIGINAL-UID'                     26410037
264200                                   TO DP013-PARAGRAPH             26420037
264300                 MOVE 'SELECT ON TRECEIV'                         26430037
264400                                   TO DP013-MESSAGE-TEXT (1)      26440037
264500                 MOVE SQLCA        TO DP013-SQLCA                 26450037
264600                 MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)    26460037
264700                 SET DP013-DB2-ABEND                              26470037
264800                                   TO TRUE                        26480037
264900                 SET DP013-XCTL-DISPLAY-RESTART                   26490037
265000                                   TO TRUE                        26500037
265100                 PERFORM DP013-0000-PROCESS-ABEND                 26510037
265200         END-EVALUATE                                             26520037
265300     END-PERFORM.                                                 26530037
265400                                                                  26540037
265500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26550037
265600         SQLCODE NOT = +0                                         26560037
265700         MOVE '4215-GET-ORIGINAL-UID'                             26570037
265800                                   TO DP013-PARAGRAPH             26580037
265900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26590037
266000                                   TO DP013-MESSAGE-TEXT (1)      26600037
266100         MOVE 'RECEIVER UID '                                     26610037
266200                                   TO DP013-MESSAGE-TEXT (2)      26620037
266300         MOVE SQLCA                TO DP013-SQLCA                 26630037
266400         MOVE 'TRECEIV'            TO DP013-DB2-TABLE-NAME (1)    26640037
266500         SET DP013-DB2-ABEND       TO TRUE                        26650037
266600         SET DP013-XCTL-DISPLAY-RESTART                           26660037
266700                                   TO TRUE                        26670037
266800         PERFORM DP013-0000-PROCESS-ABEND                         26680037
266900     END-IF.                                                      26690037
267000                                                                  26700037
267100/                                                                 26710037
267200*----------------------------------------------------------------*26720037
267300*    GET VEHICLE INFO                                            *26730037
267400*----------------------------------------------------------------*26740037
267500 4220-GET-VEHICLE-INFO.                                           26750037
267600                                                                  26760037
267700     PERFORM                                                      26770037
267800         WITH TEST AFTER                                          26780037
267900         VARYING PV-RETRY-COUNTER                                 26790037
268000         FROM 1 BY 1                                              26800037
268100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26810037
268200            OR (SQLCODE = +0)                                     26820037
268300            OR (SQLCODE = +100)                                   26830037
268400            OR (SQLCODE = -811))                                  26840037
268500                                                                  26850037
268600         EXEC SQL                                                 26860037
268700            SELECT  DISTINCT                                      26870037
268800                    A.DMG_CART_CNT                                26880037
268900                   ,C.OWNER_SCAC_ID                               26890037
269000                   ,C.VEH_NBR                                     26900037
269100                   ,C.OWNR_SCAC_SHIP_DTE                          26910037
269200                   ,D.CURR_TRIP_ID                                26920037
269300              INTO :SHPTPO-DMG-CART-CNT                           26930037
269400                  ,:VHTRIP-OWNER-SCAC-ID                          26940037
269500                  ,:VHTRIP-VEH-NBR :DN-VEH-NBR                    26950037
269600                  ,:VHTRIP-OWNR-SCAC-SHIP-DTE                     26960037
269700                  ,:VEHICL-CURR-TRIP-ID                           26970037
269800              FROM  TSHPTPO A                                     26980037
269900                   ,TSHIPMT B                                     26990037
270000                   ,TVHTRIP C                                     27000037
270100                   ,TVEHICL D                                     27010037
270200          WHERE A.PO_NBR      = :DK-PO-NBR                        27020037
270300            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   27030037
270400            AND A.SHIPT_ID      = B.SHIPT_ID                      27040037
270500            AND B.TRIP_ID       = C.TRIP_ID                       27050037
270600            AND D.CURR_TRIP_ID  = C.TRIP_ID                       27060037
270700         END-EXEC                                                 27070037
270800                                                                  27080037
270900         EVALUATE TRUE                                            27090037
271000             WHEN SQLCODE = +0                                    27100037
271100             WHEN SQLCODE = +100                                  27110037
271200             WHEN SQLCODE = -811                                  27120037
271300             WHEN SQLCODE = -904                                  27130037
271400             WHEN SQLCODE = -913                                  27140037
271500                 CONTINUE                                         27150037
271600                                                                  27160037
271700             WHEN SQLWARN0 NOT = SPACE                            27170037
271800             WHEN SQLCODE < +0                                    27180037
271900             WHEN SQLCODE > +0                                    27190037
272000                 MOVE '4220-GET-VEHICLE-INFO'                     27200037
272100                                   TO DP013-PARAGRAPH             27210037
272200                 MOVE 'SELECT VEHICLE INFO'                       27220037
272300                                   TO DP013-MESSAGE-TEXT (1)      27230037
272400                 MOVE SQLCA        TO DP013-SQLCA                 27240037
272500                 MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)    27250037
272600                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (2)    27260037
272700                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (3)    27270037
272800                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (4)    27280037
272900                 SET DP013-DB2-ABEND                              27290037
273000                                   TO TRUE                        27300037
273100                 SET DP013-XCTL-DISPLAY-RESTART                   27310037
273200                                   TO TRUE                        27320037
273300                 PERFORM DP013-0000-PROCESS-ABEND                 27330037
273400         END-EVALUATE                                             27340037
273500     END-PERFORM.                                                 27350037
273600                                                                  27360037
273700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27370037
273800         SQLCODE NOT = +0                                         27380037
273900         MOVE '4220-GET-VEHICLE-INFO'                             27390037
274000                                   TO DP013-PARAGRAPH             27400037
274100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     27410037
274200                                   TO DP013-MESSAGE-TEXT (1)      27420037
274300         MOVE 'VEHICLE INFO'                                      27430037
274400                                   TO DP013-MESSAGE-TEXT (2)      27440037
274500         MOVE SQLCA                TO DP013-SQLCA                 27450037
274600         MOVE 'TSHPTPO'            TO DP013-DB2-TABLE-NAME (1)    27460037
274700         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (2)    27470037
274800         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (3)    27480037
274900         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (4)    27490037
275000         SET DP013-DB2-ABEND       TO TRUE                        27500037
275100         SET DP013-XCTL-DISPLAY-RESTART                           27510037
275200                                   TO TRUE                        27520037
275300         PERFORM DP013-0000-PROCESS-ABEND                         27530037
275400     END-IF.                                                      27540037
275500                                                                  27550037
275600/                                                                 27560037
275700*----------------------------------------------------------------*27570037
275800*    GET SHIPMENT INFO                                           *27580037
275900*----------------------------------------------------------------*27590037
276000 4225-GET-SHIPMENT-INFO.                                          27600037
276100                                                                  27610037
276200     PERFORM                                                      27620037
276300         WITH TEST AFTER                                          27630037
276400         VARYING PV-RETRY-COUNTER                                 27640037
276500         FROM 1 BY 1                                              27650037
276600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27660037
276700            OR (SQLCODE = +0)                                     27670037
276800            OR (SQLCODE = +100)                                   27680037
276900            OR (SQLCODE = -811))                                  27690037
277000                                                                  27700037
277100         EXEC SQL                                                 27710037
277200            SELECT  B.PRO_NBR                                     27720037
277300                   ,B.BOL_NBR                                     27730037
277400                   ,B.VEND_SHIP_DTE                               27740037
277500              INTO :SHIPMT-PRO-NBR                                27750037
277600                  ,:SHIPMT-BOL-NBR                                27760037
277700                  ,:SHIPMT-VEND-SHIP-DTE                          27770037
277800              FROM  TSHPTPO A                                     27780037
277900                   ,TSHIPMT B                                     27790037
278000          WHERE A.PO_NBR      = :DK-PO-NBR                        27800037
278100            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   27810037
278200            AND A.SHIPT_ID = B.SHIPT_ID                           27820037
278300         END-EXEC                                                 27830037
278400                                                                  27840037
278500         EVALUATE TRUE                                            27850037
278600             WHEN SQLCODE = +0                                    27860037
278700             WHEN SQLCODE = +100                                  27870037
278800             WHEN SQLCODE = -811                                  27880037
278900             WHEN SQLCODE = -904                                  27890037
279000             WHEN SQLCODE = -913                                  27900037
279100                 CONTINUE                                         27910037
279200                                                                  27920037
279300             WHEN SQLWARN0 NOT = SPACE                            27930037
279400             WHEN SQLCODE < +0                                    27940037
279500             WHEN SQLCODE > +0                                    27950037
279600                 MOVE '4225-GET-SHIPMENT-INFO'                    27960037
279700                                   TO DP013-PARAGRAPH             27970037
279800                 MOVE 'SELECT SHIPMENT INFO'                      27980037
279900                                   TO DP013-MESSAGE-TEXT (1)      27990037
280000                 MOVE SQLCA        TO DP013-SQLCA                 28000037
280100                 MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)    28010037
280200                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (2)    28020037
280300                 SET DP013-DB2-ABEND                              28030037
280400                                   TO TRUE                        28040037
280500                 SET DP013-XCTL-DISPLAY-RESTART                   28050037
280600                                   TO TRUE                        28060037
280700                 PERFORM DP013-0000-PROCESS-ABEND                 28070037
280800         END-EVALUATE                                             28080037
280900     END-PERFORM.                                                 28090037
281000                                                                  28100037
281100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28110037
281200         SQLCODE NOT = +0                                         28120037
281300         MOVE '4225-GET-SHIPMTNE-INFO'                            28130037
281400                                   TO DP013-PARAGRAPH             28140037
281500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28150037
281600                                   TO DP013-MESSAGE-TEXT (1)      28160037
281700         MOVE 'SHIPMENT INFO'                                     28170037
281800                                   TO DP013-MESSAGE-TEXT (2)      28180037
281900         MOVE SQLCA                TO DP013-SQLCA                 28190037
282000         MOVE 'TSHPTPO'            TO DP013-DB2-TABLE-NAME (1)    28200037
282100         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (2)    28210037
282200         SET DP013-DB2-ABEND       TO TRUE                        28220037
282300         SET DP013-XCTL-DISPLAY-RESTART                           28230037
282400                                   TO TRUE                        28240037
282500         PERFORM DP013-0000-PROCESS-ABEND                         28250037
282600     END-IF.                                                      28260037
282700                                                                  28270037
282800/                                                                 28280037
282900*----------------------------------------------------------------*28290037
283000*    SUM THE LINE ITEM QUANTITIES                                *28300037
283100*----------------------------------------------------------------*28310037
283200 4230-SUM-QTY.                                                    28320037
283300                                                                  28330037
283400     PERFORM                                                      28340037
283500         WITH TEST AFTER                                          28350037
283600         VARYING PV-RETRY-COUNTER                                 28360037
283700         FROM 1 BY 1                                              28370037
283800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28380037
283900            OR (SQLCODE = +0)                                     28390037
284000            OR (SQLCODE = -305))                                  28400037
284100                                                                  28410037
284200         EXEC SQL                                                 28420037
284300            SELECT  SUM(EXPTED_ITM_QTY)                           28430037
284400                   ,SUM(AP_VERIFY_ITM_QTY)                        28440037
284500              INTO :PA-INVOICED-COUNT                             28450037
284600                  ,:PA-AP-VERIFIED-COUNT                          28460037
284700              FROM  TRECDIS                                       28470037
284800            WHERE ORD_NBR        = :DK-PO-NBR                     28480065
284900              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                28490037
285100         END-EXEC                                                 28510037
285200                                                                  28520037
285300         EVALUATE TRUE                                            28530037
285400             WHEN SQLCODE = +0                                    28540037
285500             WHEN SQLCODE = -305                                  28550037
285600             WHEN SQLCODE = -904                                  28560037
285700             WHEN SQLCODE = -913                                  28570037
285800                 CONTINUE                                         28580037
285900                                                                  28590037
286000             WHEN SQLWARN0 NOT = SPACE                            28600037
286100             WHEN SQLCODE < +0                                    28610037
286200             WHEN SQLCODE > +0                                    28620037
286300                 MOVE '4230-SUM-QTY'                              28630037
286400                                   TO DP013-PARAGRAPH             28640037
286500                 MOVE 'SELECT ON TRECDIS'                         28650037
286600                                   TO DP013-MESSAGE-TEXT (1)      28660037
286700                 MOVE SQLCA        TO DP013-SQLCA                 28670037
286800                 MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)    28680037
286900                 SET DP013-DB2-ABEND                              28690037
287000                                   TO TRUE                        28700037
287100                 SET DP013-XCTL-DISPLAY-RESTART                   28710037
287200                                   TO TRUE                        28720037
287300                 PERFORM DP013-0000-PROCESS-ABEND                 28730037
287400         END-EVALUATE                                             28740037
287500     END-PERFORM.                                                 28750037
287600                                                                  28760037
287700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28770037
287800         SQLCODE NOT = +0                                         28780037
287900         MOVE '4230-SUM-QTY'                                      28790037
288000                                   TO DP013-PARAGRAPH             28800037
288100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28810037
288200                                   TO DP013-MESSAGE-TEXT (1)      28820037
288300         MOVE 'REC ITEM QTY INFO'                                 28830037
288400                                   TO DP013-MESSAGE-TEXT (2)      28840037
288500         MOVE SQLCA                TO DP013-SQLCA                 28850037
288600         MOVE 'TRECDIS'            TO DP013-DB2-TABLE-NAME (1)    28860037
288700         SET DP013-DB2-ABEND       TO TRUE                        28870037
288800         SET DP013-XCTL-DISPLAY-RESTART                           28880037
288900                                   TO TRUE                        28890037
289000         PERFORM DP013-0000-PROCESS-ABEND                         28900037
289100     END-IF.                                                      28910037
289200                                                                  28920037
289300/                                                                 28930037
289400*----------------------------------------------------------------*28940037
289500*    RETRIEVE THE MARKING DATE AND TIME                          *28950037
289600*----------------------------------------------------------------*28960037
289700 4240-GET-MARKING-INFO.                                           28970037
289800                                                                  28980037
289900     PERFORM                                                      28990037
290000         WITH TEST AFTER                                          29000037
290100         VARYING PV-RETRY-COUNTER                                 29010037
290200         FROM 1 BY 1                                              29020037
290300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29030037
290400            OR (SQLCODE = +0)                                     29040037
290500            OR (SQLCODE = -305))                                  29050037
290600                                                                  29060037
290700         EXEC SQL                                                 29070037
290800            SELECT  MIN(MKING_APRON_TMST)                         29080037
290900              INTO :RECITM-MKING-APRON-TMST                       29090037
291000              FROM  TRECITM                                       29100037
291100            WHERE ORD_NBR        = :DK-PO-NBR                     29110065
291200              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                29120037
291300         END-EXEC                                                 29130037
291400                                                                  29140037
291500         EVALUATE TRUE                                            29150037
291600             WHEN SQLCODE = +0                                    29160037
291700             WHEN SQLCODE = -305                                  29170037
291800             WHEN SQLCODE = -904                                  29180037
291900             WHEN SQLCODE = -913                                  29190037
292000                 CONTINUE                                         29200037
292100                                                                  29210037
292200             WHEN SQLWARN0 NOT = SPACE                            29220037
292300             WHEN SQLCODE < +0                                    29230037
292400             WHEN SQLCODE > +0                                    29240037
292500                 MOVE '4240-GET-MARKING-INFO'                     29250037
292600                                   TO DP013-PARAGRAPH             29260037
292700                 MOVE 'SELECT ON TRECITM'                         29270037
292800                                   TO DP013-MESSAGE-TEXT (1)      29280037
292900                 MOVE SQLCA        TO DP013-SQLCA                 29290037
293000                 MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)    29300037
293100                 SET DP013-DB2-ABEND                              29310037
293200                                   TO TRUE                        29320037
293300                 SET DP013-XCTL-DISPLAY-RESTART                   29330037
293400                                   TO TRUE                        29340037
293500                 PERFORM DP013-0000-PROCESS-ABEND                 29350037
293600         END-EVALUATE                                             29360037
293700     END-PERFORM.                                                 29370037
293800                                                                  29380037
293900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    29390037
294000         SQLCODE NOT = +0                                         29400037
294100         MOVE '4240-GET-MARKING-INFO'                             29410037
294200                                   TO DP013-PARAGRAPH             29420037
294300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29430037
294400                                   TO DP013-MESSAGE-TEXT (1)      29440037
294500         MOVE 'MARKING INFO     '                                 29450037
294600                                   TO DP013-MESSAGE-TEXT (2)      29460037
294700         MOVE SQLCA                TO DP013-SQLCA                 29470037
294800         MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)    29480037
294900         SET DP013-DB2-ABEND       TO TRUE                        29490037
295000         SET DP013-XCTL-DISPLAY-RESTART                           29500037
295100                                   TO TRUE                        29510037
295200         PERFORM DP013-0000-PROCESS-ABEND                         29520037
295300     END-IF.                                                      29530037
295400                                                                  29540037
295500/                                                                 29550037
307500 4259-SELECT-MIN-ITM.                                             30750048
307600     PERFORM                                                      30760048
307700         WITH TEST AFTER                                          30770048
307800         VARYING PV-RETRY-COUNTER                                 30780048
307900         FROM 1 BY 1                                              30790048
308000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30800048
308100             OR (SQLCODE = +0)                                    30810048
308200             OR (SQLCODE = -305)                                  30820056
308300             OR (SQLCODE = +100))                                 30830048
308400                                                                  30840048
308500         EXEC SQL                                                 30850048
308600              SELECT MIN(ITM_NBR)                                 30860048
308700                INTO :PURITM-ITM-NBR                              30870048
308800                FROM TPURITM                                      30880048
308900               WHERE PO_NBR         = :DK-PO-NBR                  30890048
309000                 AND VER_STATUS_CDE = 'A'                         30900048
309100         END-EXEC                                                 30910048
309200                                                                  30920048
309300         EVALUATE TRUE                                            30930048
309400                                                                  30940048
309500             WHEN SQLCODE = +0                                    30950048
309600             WHEN SQLCODE = +100                                  30960048
309700             WHEN SQLCODE = -305                                  30970055
309800             WHEN SQLCODE = -904                                  30980048
309900             WHEN SQLCODE = -913                                  30990048
310000                  CONTINUE                                        31000048
310100                                                                  31010048
310200             WHEN SQLWARN0 NOT = SPACES                           31020048
310300             WHEN SQLCODE < +0                                    31030048
310400             WHEN SQLCODE > +0                                    31040048
310500                  MOVE '4259-SELECT-MIN-ITM'                      31050048
310600                                   TO DP013-PARAGRAPH             31060048
310700                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM TABLE'     31070048
310800                                   TO DP013-MESSAGE-TEXT (1)      31080048
310900                  MOVE SQLCA       TO DP013-SQLCA                 31090048
311000                  MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)    31100048
311100                  SET DP013-DB2-ABEND                             31110048
311200                      DP013-XCTL-DISPLAY-RESTART                  31120048
311300                                   TO TRUE                        31130048
311400                  PERFORM DP013-0000-PROCESS-ABEND                31140048
311500         END-EVALUATE                                             31150048
311600     END-PERFORM.                                                 31160048
311700                                                                  31170048
311800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    31180048
311900         SQLCODE NOT = +0                                         31190048
312000         MOVE '4259-SELECT-MIN-ITM'                               31200048
312100                                   TO DP013-PARAGRAPH             31210048
312200         MOVE 'MAX RETRIES EXCEEDED ON SELECT MIN ITM'            31220048
312300                                   TO DP013-MESSAGE-TEXT (1)      31230048
312400         MOVE SQLCA                TO DP013-SQLCA                 31240048
312500         MOVE 'TPURITM'            TO DP013-DB2-TABLE-NAME (1)    31250048
312600         SET DP013-DB2-ABEND                                      31260048
312700             DP013-XCTL-DISPLAY-RESTART                           31270048
312800                                   TO TRUE                        31280048
312900         PERFORM DP013-0000-PROCESS-ABEND                         31290048
313000     END-IF.                                                      31300048
313100                                                                  31310048
313200/                                                                 31320037
313300 4260-SELECT-TDCTFAS.                                             31330037
313400     PERFORM                                                      31340037
313500         WITH TEST AFTER                                          31350037
313600         VARYING PV-RETRY-COUNTER                                 31360037
313700         FROM 1 BY 1                                              31370037
313800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31380037
313900             OR (SQLCODE = +0)                                    31390037
314000             OR (SQLCODE = +100))                                 31400037
314100                                                                  31410037
314200         EXEC SQL                                                 31420037
314300              SELECT TKT_FMT_ID                                   31430037
314400                INTO :DCTFAS-TKT-FMT-ID                           31440037
314500                       :DN-TKT-FMT-ID                             31450037
314600                FROM TDCTFAS A                                    31460037
314700               WHERE A.OPER_UNT_ID = :DK-OPER-UNT-ID              31470037
314800                 AND A.FCLTY_ID    = :DK-FCLTY-ID                 31480037
314900                 AND A.DEPT_NBR    = :DK-DEPT-NBR                 31490037
315000                 AND A.RANK_NBR    = 1                            31500037
315100                 AND A.CL_NBR      = :PV-SUB-CL-NBR-2CH           31510048
315200         END-EXEC                                                 31520037
315300                                                                  31530037
315400         EVALUATE TRUE                                            31540037
315500                                                                  31550037
315600             WHEN SQLCODE = +0                                    31560037
315700             WHEN SQLCODE = +100                                  31570037
315800             WHEN SQLCODE = -904                                  31580037
315900             WHEN SQLCODE = -913                                  31590037
316000                  CONTINUE                                        31600037
316100                                                                  31610037
316200             WHEN SQLWARN0 NOT = SPACES                           31620037
316300             WHEN SQLCODE < +0                                    31630037
316400             WHEN SQLCODE > +0                                    31640037
316500                  MOVE '4260-SELECT-TDCTFAS'                      31650037
316600                                   TO DP013-PARAGRAPH             31660037
316700                  MOVE 'UNSUCCESSFUL SELECT ON TDCTFAS TABLE'     31670037
316800                                   TO DP013-MESSAGE-TEXT (1)      31680037
316900                  MOVE SQLCA       TO DP013-SQLCA                 31690037
317000                  MOVE 'TDCTFAS '  TO DP013-DB2-TABLE-NAME (1)    31700037
317100                  SET DP013-DB2-ABEND                             31710037
317200                      DP013-XCTL-DISPLAY-RESTART                  31720037
317300                                   TO TRUE                        31730037
317400                  PERFORM DP013-0000-PROCESS-ABEND                31740037
317500         END-EVALUATE                                             31750037
317600     END-PERFORM.                                                 31760037
317700                                                                  31770037
317800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    31780037
317900         SQLCODE NOT = +0                                         31790037
318000         MOVE '4260-SELECT-TDCTFAS'                               31800037
318100                                   TO DP013-PARAGRAPH             31810037
318200         MOVE 'MAX RETRIES EXCEEDED ON SELECT TICKET FORMAT ASSIG'31820037
318300                                   TO DP013-MESSAGE-TEXT (1)      31830037
318400         MOVE SQLCA                TO DP013-SQLCA                 31840037
318500         MOVE 'TDCTFAS'            TO DP013-DB2-TABLE-NAME (1)    31850037
318600         SET DP013-DB2-ABEND                                      31860037
318700             DP013-XCTL-DISPLAY-RESTART                           31870037
318800                                   TO TRUE                        31880037
318900         PERFORM DP013-0000-PROCESS-ABEND                         31890037
319000     END-IF.                                                      31900037
319100                                                                  31910037
319200/                                                                 31920048
319300*----------------------------------------------------------------*31930048
319400*    RETRIEVE SUB CLASS USING BLACK BOX XLKUT001                 *31940048
319500*----------------------------------------------------------------*31950048
319600 4261-CALL-XLKUT001.                                              31960048
319700                                                                  31970048
319800     MOVE PURITM-ITM-NBR  TO XL001-KEY-ITM-NBR.                   31980052
319900                                                                  31990048
320000     SET XL001-BY-ITEM                                            32000052
320100         XL001-SELECT-VND-STYL TO TRUE.                           32010048
320200                                                                  32020048
320300     CALL XL001-VSM-PGM USING DFHEIBLK                            32030048
320400                              XL001-COMMAREA                      32040048
320500                              XL001-ITEM-COMMAREA.                32050048
320600                                                                  32060048
320700     EVALUATE TRUE                                                32070048
320800                                                                  32080048
320900         WHEN XL001-SUCCESSFUL                                    32090048
321000             WHEN XL001-SKU-SQLCODE =                             32100048
321100                  (0 OR +100 OR -904 OR -913)                     32110048
321200             WHEN XL001-VND-STYL-SQLCODE =                        32120048
321300                  (0 OR +100 OR -904 OR -913)                     32130048
321400                                                                  32140048
321500                  CONTINUE                                        32150053
321600                                                                  32160048
321700         WHEN OTHER                                               32170052
321800             MOVE '4261-CALL-XLKUT001'                            32180052
321900                               TO DP013-PARAGRAPH                 32190052
322000             MOVE 'UNSUCCESSFUL SELECT OF SUB CLASS'              32200052
322100                               TO DP013-MESSAGE-TEXT(1)           32210052
322200             IF XL001-SKU-SQLCODE NOT = ZERO                      32220052
322300                 MOVE XL001-SKU-SQLCODE                           32230052
322400                                   TO SQLCODE                     32240048
322500             ELSE                                                 32250052
322600                 MOVE XL001-VND-STYL-SQLCODE                      32260052
322700                                   TO SQLCODE                     32270048
322800             END-IF                                               32280052
322900             MOVE SQLCA        TO DP013-SQLCA                     32290052
323000             MOVE 'SKU VEND'   TO DP013-DB2-TABLE-NAME(1)         32300052
323100             SET DP013-DB2-ABEND                                  32310052
323200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32320052
323300             PERFORM DP013-0000-PROCESS-ABEND                     32330052
323400     END-EVALUATE.                                                32340048
323500/                                                                 32350037
323600*----------------------------------------------------------------*32360037
323700*    RETRIEVE PACKING SLIP INFO                                  *32370037
323800*----------------------------------------------------------------*32380037
323900 4270-SELECT-SRCCDE-TPKSLIP.                                      32390037
324000                                                                  32400037
324100     PERFORM                                                      32410037
324200         WITH TEST AFTER                                          32420037
324300         VARYING PV-RETRY-COUNTER                                 32430037
324400         FROM 1 BY 1                                              32440037
324500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32450037
324600             OR (SQLCODE = +0)                                    32460037
324700             OR (SQLCODE = +100)                                  32470037
324800             OR (SQLCODE = -811))                                 32480037
324900                                                                  32490037
325000         EXEC SQL                                                 32500037
325100              SELECT CRE_SRC_CDE                                  32510037
325200                INTO :PKSLIP-CRE-SRC-CDE                          32520037
325300                FROM TPKSLIP                                      32530037
325400               WHERE OPER_UNT_ID   = :DK-OPER-UNT-ID              32540037
325500                 AND FCLTY_ID      = :DK-FCLTY-ID                 32550037
325600                 AND PO_NBR        = :DK-PO-NBR                   32560037
325700                 AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR              32570037
325800                 AND VER_STAT_CDE  = 'A'                          32580037
325900         END-EXEC                                                 32590037
326000                                                                  32600037
326100         EVALUATE TRUE                                            32610037
326200             WHEN SQLCODE = +0                                    32620037
326300             WHEN SQLCODE = +100                                  32630037
326400             WHEN SQLCODE = -811                                  32640037
326500             WHEN SQLCODE = -904                                  32650037
326600             WHEN SQLCODE = -913                                  32660037
326700                  CONTINUE                                        32670037
326800                                                                  32680037
326900             WHEN SQLWARN0 NOT = SPACES                           32690037
327000             WHEN SQLCODE < +0                                    32700037
327100             WHEN SQLCODE > +0                                    32710037
327200                  MOVE '4270-SELECT-TPKSLIP'                      32720037
327300                                   TO DP013-PARAGRAPH             32730037
327400                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP  '         32740037
327500                                   TO DP013-MESSAGE-TEXT (1)      32750037
327600                  MOVE SQLCA       TO DP013-SQLCA                 32760037
327700                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    32770037
327800                  SET DP013-DB2-ABEND                             32780037
327900                      DP013-XCTL-DISPLAY-RESTART                  32790037
328000                                   TO TRUE                        32800037
328100                  PERFORM DP013-0000-PROCESS-ABEND                32810037
328200         END-EVALUATE                                             32820037
328300     END-PERFORM.                                                 32830037
328400                                                                  32840037
328500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    32850037
328600         SQLCODE NOT = +0                                         32860037
328700         MOVE '4270-SELECT-TPKSLIP'                               32870037
328800                                   TO DP013-PARAGRAPH             32880037
328900         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TPKSLIP  '       32890037
329000                                   TO DP013-MESSAGE-TEXT (1)      32900037
329100         MOVE SQLCA                TO DP013-SQLCA                 32910037
329200         MOVE 'TPKSLIP '           TO DP013-DB2-TABLE-NAME (1)    32920037
329300         SET DP013-DB2-ABEND                                      32930037
329400             DP013-XCTL-DISPLAY-RESTART                           32940037
329500                                   TO TRUE                        32950037
329600         PERFORM DP013-0000-PROCESS-ABEND                         32960037
329700     END-IF.                                                      32970037
329800                                                                  32980037
329900*----------------------------------------------------------------*32990037
330000*    RETRIEVE PACKING SLIP INFO                                  *33000037
330100*----------------------------------------------------------------*33010037
330200 4275-SELECT-CRETMST-TPKSLIP.                                     33020037
330300                                                                  33030037
330400     PERFORM                                                      33040037
330500         WITH TEST AFTER                                          33050037
330600         VARYING PV-RETRY-COUNTER                                 33060037
330700         FROM 1 BY 1                                              33070037
330800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33080037
330900             OR (SQLCODE = +0)                                    33090037
331000             OR (SQLCODE = +100)                                  33100037
331100             OR (SQLCODE = -305)                                  33110037
331200             OR (SQLCODE = -811))                                 33120037
331300                                                                  33130037
331400         EXEC SQL                                                 33140037
331500            SELECT MIN(CRE_TMST)                                  33150037
331600              INTO :PKSLIP-CRE-TMST                               33160037
331700              FROM TPKSLIP                                        33170037
331800              WHERE OPER_UNT_ID   = :DK-OPER-UNT-ID               33180037
331900                AND FCLTY_ID      = :DK-FCLTY-ID                  33190037
332000                AND PO_NBR        = :DK-PO-NBR                    33200037
332100                AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR               33210037
332200                AND PKSL_STAT_CDE = :PC-AC                        33220037
332300         END-EXEC                                                 33230037
332400                                                                  33240037
332500         EVALUATE TRUE                                            33250037
332600             WHEN SQLCODE = +0                                    33260037
332700             WHEN SQLCODE = +100                                  33270037
332800             WHEN SQLCODE = -305                                  33280037
332900             WHEN SQLCODE = -811                                  33290037
333000             WHEN SQLCODE = -904                                  33300037
333100             WHEN SQLCODE = -913                                  33310037
333200                  CONTINUE                                        33320037
333300                                                                  33330037
333400             WHEN SQLWARN0 NOT = SPACES                           33340037
333500             WHEN SQLCODE < +0                                    33350037
333600             WHEN SQLCODE > +0                                    33360037
333700                  MOVE '4275-SELECT-CRETMST-TPKSLIP'              33370037
333800                                  TO DP013-PARAGRAPH              33380037
333900                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP  '         33390037
334000                                  TO DP013-MESSAGE-TEXT (1)       33400037
334100                  MOVE SQLCA      TO DP013-SQLCA                  33410037
334200                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     33420037
334300                  SET DP013-DB2-ABEND                             33430037
334400                      DP013-XCTL-DISPLAY-RESTART                  33440037
334500                                  TO TRUE                         33450037
334600                  PERFORM DP013-0000-PROCESS-ABEND                33460037
334700         END-EVALUATE                                             33470037
334800     END-PERFORM.                                                 33480037
334900                                                                  33490037
335000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33500037
335100             AND (SQLCODE = -904 OR -913)                         33510037
335200         MOVE '4275-SELECT-CRETMST-TPKSLIP'                       33520037
335300                                  TO DP013-PARAGRAPH              33530037
335400         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TPKSLIP  '       33540037
335500                                  TO DP013-MESSAGE-TEXT (1)       33550037
335600         MOVE SQLCA               TO DP013-SQLCA                  33560037
335700         MOVE 'TPKSLIP '          TO DP013-DB2-TABLE-NAME (1)     33570037
335800         SET DP013-DB2-ABEND                                      33580037
335900             DP013-XCTL-DISPLAY-RESTART                           33590037
336000                                  TO TRUE                         33600037
336100         PERFORM DP013-0000-PROCESS-ABEND                         33610037
336200     END-IF.                                                      33620037
336300                                                                  33630037
336400/                                                                 33640037
336500*----------------------------------------------------------------*33650037
336600*    RETRIEVE OPERATION SET DESCRIPTION                          *33660037
336700*----------------------------------------------------------------*33670037
336800 4280-GET-OPER-SET-DESC.                                          33680037
336900                                                                  33690037
337000     PERFORM                                                      33700037
337100         WITH TEST AFTER                                          33710037
337200         VARYING PV-RETRY-COUNTER                                 33720037
337300         FROM 1 BY 1                                              33730037
337400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33740037
337500             OR (SQLCODE = +0)                                    33750037
337600             OR (SQLCODE = +100))                                 33760037
337700                                                                  33770037
337800         EXEC SQL                                                 33780037
337900            SELECT  DISTINCT                                      33790037
338000                    B.OPER_SET_ID                                 33800037
338100                   ,C.OPER_SET_DESC                               33810037
338200              INTO :WRKORD-OPER-SET-ID                            33820037
338300                  ,:OPRSET-OPER-SET-DESC                          33830037
338400              FROM  TRECEIV A                                     33840037
338500                   ,TWRKORD B                                     33850037
338600                   ,TOPRSET C                                     33860037
338700             WHERE  A.ORD_NBR        = :DK-PO-NBR                 33870065
338800               AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR            33880037
338900               AND  B.ORD_LNE_NBR    = 0                          33890037
339000               AND  A.VER_STATUS_CDE = 'A'                        33900037
339100               AND  B.VER_STATUS_CDE = 'A'                        33910037
339200               AND  A.OPER_UNT_ID    = B.OPER_UNT_ID              33920037
339300               AND  A.FCLTY_ID       = B.FCLTY_ID                 33930037
339400               AND  A.ORD_NBR        = B.ORD_NBR                  33940037
339500               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             33950037
339600               AND  B.OPER_SET_ID    = C.OPER_SET_ID              33960037
339700               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         33970060
339800         END-EXEC                                                 33980037
339900                                                                  33990037
340000         EVALUATE TRUE                                            34000037
340100             WHEN SQLCODE = +0                                    34010037
340200             WHEN SQLCODE = +100                                  34020037
340300             WHEN SQLCODE = -904                                  34030037
340400             WHEN SQLCODE = -913                                  34040037
340500                  CONTINUE                                        34050037
340600                                                                  34060037
340700             WHEN SQLWARN0 NOT = SPACES                           34070037
340800             WHEN SQLCODE < +0                                    34080037
340900             WHEN SQLCODE > +0                                    34090037
341000                  MOVE '4280-GET-OPER-SET-DESC'                   34100037
341100                                   TO DP013-PARAGRAPH             34110037
341200                  MOVE 'UNSUCCESSFUL SELECT ON TOPRSET  '         34120037
341300                                   TO DP013-MESSAGE-TEXT (1)      34130037
341400                  MOVE SQLCA       TO DP013-SQLCA                 34140037
341500                  MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)    34150037
341600                  MOVE 'TWRKORD '  TO DP013-DB2-TABLE-NAME (2)    34160037
341700                  MOVE 'TOPRSET '  TO DP013-DB2-TABLE-NAME (3)    34170037
341800                  SET DP013-DB2-ABEND                             34180037
341900                      DP013-XCTL-DISPLAY-RESTART                  34190037
342000                                   TO TRUE                        34200037
342100                  PERFORM DP013-0000-PROCESS-ABEND                34210037
342200         END-EVALUATE                                             34220037
342300     END-PERFORM.                                                 34230037
342400                                                                  34240037
342500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    34250037
342600         SQLCODE NOT = +0                                         34260037
342700         MOVE '4280-GET-OPER-SET-DESC'                            34270037
342800                                   TO DP013-PARAGRAPH             34280037
342900         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TOPRSET  '       34290037
343000                                   TO DP013-MESSAGE-TEXT (1)      34300037
343100         MOVE SQLCA                TO DP013-SQLCA                 34310037
343200         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    34320037
343300         MOVE 'TWRKORD '           TO DP013-DB2-TABLE-NAME (2)    34330037
343400         MOVE 'TOPRSET '           TO DP013-DB2-TABLE-NAME (3)    34340037
343500         SET DP013-DB2-ABEND                                      34350037
343600             DP013-XCTL-DISPLAY-RESTART                           34360037
343700                                   TO TRUE                        34370037
343800         PERFORM DP013-0000-PROCESS-ABEND                         34380037
343900     END-IF.                                                      34390037
344000                                                                  34400037
344100/                                                                 34410037
344200*----------------------------------------------------------------*34420037
344300*     CHECK TO SEE IF OPERATING UNIT IS A STORE                  *34430037
344400*     NOTE:  THE OLD STORE TABLE HAS BEEN REPLACED WITH          *34440058
344500*             THE DOMAIN XLT_LOC                                 *34450058
344600*----------------------------------------------------------------*34460037
344700 4290-CHECK-DIRECT-STORE.                                         34470037
344800                                                                  34480037
344900     PERFORM                                                      34490037
345000         WITH TEST AFTER                                          34500037
345100         VARYING PV-RETRY-COUNTER                                 34510037
345200         FROM 1 BY 1                                              34520037
345300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34530037
345400            OR (SQLCODE = +0)                                     34540037
345500            OR (SQLCODE = +100))                                  34550037
345600                                                                  34560037
345700         EXEC SQL                                                 34570037
345800             SELECT COUNT(*)                                      34580037
345900              INTO :PV-DB2-COUNT                                  34590037
346000              FROM  XLT_LOC                                       34600038
346100             WHERE LOC_NBR  = :DK-OPER-UNT-ID                     34610039
346200               AND LOC_TYP_CDE  ^= 'DC'                           34620038
346300         END-EXEC                                                 34630037
346400                                                                  34640037
346500         EVALUATE TRUE                                            34650037
346600             WHEN SQLCODE = +0                                    34660037
346700             WHEN SQLCODE = +100                                  34670037
346800             WHEN SQLCODE = -904                                  34680037
346900             WHEN SQLCODE = -913                                  34690037
347000                 CONTINUE                                         34700037
347100                                                                  34710037
347200             WHEN SQLWARN0 NOT = SPACE                            34720037
347300             WHEN SQLCODE < +0                                    34730037
347400             WHEN SQLCODE > +0                                    34740037
347500                 MOVE '4290-CHECK-DIRECT-STORE'                   34750037
347600                                   TO DP013-PARAGRAPH             34760037
347700                 MOVE 'COUNT ON XLT_LOC'                          34770038
347800                                   TO DP013-MESSAGE-TEXT (1)      34780037
347900                 MOVE SQLCA        TO DP013-SQLCA                 34790037
348000                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)    34800038
348100                 SET DP013-DB2-ABEND                              34810037
348200                                   TO TRUE                        34820037
348300                 SET DP013-XCTL-DISPLAY-RESTART                   34830037
348400                                   TO TRUE                        34840037
348500                 PERFORM DP013-0000-PROCESS-ABEND                 34850037
348600         END-EVALUATE                                             34860037
348700     END-PERFORM.                                                 34870037
348800                                                                  34880037
348900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    34890037
349000         SQLCODE NOT = +0                                         34900037
349100         MOVE '4290-CHECK-DIRECT-STORE'                           34910037
349200                                   TO DP013-PARAGRAPH             34920037
349300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     34930037
349400                                   TO DP013-MESSAGE-TEXT (1)      34940037
349500         MOVE 'ON XLT_LOC'         TO DP013-MESSAGE-TEXT (2)      34950038
349600         MOVE SQLCA                TO DP013-SQLCA                 34960037
349700         MOVE 'XLT_LOC'            TO DP013-DB2-TABLE-NAME (1)    34970038
349800         SET DP013-DB2-ABEND       TO TRUE                        34980037
349900         SET DP013-XCTL-DISPLAY-RESTART                           34990037
350000                                   TO TRUE                        35000037
350100         PERFORM DP013-0000-PROCESS-ABEND                         35010037
350200     END-IF.                                                      35020037
350300                                                                  35030037
350400/                                                                 35040037
350500 4200-TROUBLE-DESC.                                               35050037
350600                                                                  35060037
350700     PERFORM                                                      35070037
350800         WITH TEST AFTER                                          35080037
350900         VARYING PV-RETRY-COUNTER                                 35090037
351000         FROM 1 BY 1                                              35100037
351100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35110037
351200            OR (SQLCODE = +0 OR +100 OR -811))                    35120037
351300                                                                  35130037
351400         EXEC SQL                                                 35140037
351500             SELECT B.TRBL_SHT_DESC                               35150037
351600             INTO :TRBRSN-TRBL-SHT-DESC                           35160037
351700             FROM  TTRBNTF A                                      35170037
351800                  ,TTRBRSN B                                      35180037
351900             WHERE A.PO_NBR           = :DK-PO-NBR                35190037
352000                   AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR           35200037
352100                   AND A.RESOLVED_IND IN (:PC-N, :PC-I)           35210037
352200                   AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE            35220037
352300         END-EXEC                                                 35230037
352400                                                                  35240037
352500         EVALUATE TRUE                                            35250037
352600             WHEN SQLCODE = +0                                    35260037
352700                 MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUB-STATUS-1  35270037
352800             WHEN SQLCODE = -811                                  35280037
352900                 STRING TRBRSN-TRBL-SHT-DESC '*'                  35290037
353000                     DELIMITED BY SIZE                            35300037
353100                     INTO ASC-TROUB-STATUS-1                      35310037
353200             WHEN SQLCODE = +100                                  35320037
353300                 MOVE SPACES               TO ASC-TROUB-STATUS-1  35330037
353400             WHEN SQLCODE = -904                                  35340037
353500             WHEN SQLCODE = -913                                  35350037
353600                 CONTINUE                                         35360037
353700                                                                  35370037
353800             WHEN SQLWARN0 NOT = SPACE                            35380037
353900             WHEN SQLCODE < ZERO                                  35390037
354000             WHEN SQLCODE > ZERO                                  35400037
354100                 MOVE '4200-TROUBLE-DESC'                         35410037
354200                                 TO DP013-PARAGRAPH               35420037
354300                 MOVE 'SELECT ON TTRBNTF/TTRBRSN'                 35430037
354400                                 TO DP013-MESSAGE-TEXT (1)        35440037
354500                 MOVE SQLCA      TO DP013-SQLCA                   35450037
354600                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      35460037
354700                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      35470037
354800                 SET DP013-DB2-ABEND                              35480037
354900                                 TO TRUE                          35490037
355000                 SET DP013-XCTL-DISPLAY-RESTART                   35500037
355100                                 TO TRUE                          35510037
355200                 PERFORM DP013-0000-PROCESS-ABEND                 35520037
355300         END-EVALUATE                                             35530037
355400     END-PERFORM.                                                 35540037
355500                                                                  35550037
355600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35560037
355700         AND (SQLCODE = +904 OR +913)                             35570037
355800         MOVE '4200-TROUBLE-DESC'                                 35580037
355900                                 TO DP013-PARAGRAPH               35590037
356000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35600037
356100                                 TO DP013-MESSAGE-TEXT (1)        35610037
356200         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        35620037
356300         MOVE SQLCA              TO DP013-SQLCA                   35630037
356400         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      35640037
356500         MOVE 'TTRBRSN'          TO DP013-DB2-TABLE-NAME (2)      35650037
356600         SET DP013-DB2-ABEND     TO TRUE                          35660037
356700         SET DP013-XCTL-DISPLAY-RESTART                           35670037
356800                                 TO TRUE                          35680037
356900         PERFORM DP013-0000-PROCESS-ABEND                         35690037
357000     END-IF.                                                      35700037
357100                                                                  35710037
357200/                                                                 35720037
357300*----------------------------------------------------------------*35730037
357400*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *35740037
357500*----------------------------------------------------------------*35750037
357600 4400-MOVE-COMMAREA-TO-SCREEN.                                    35760037
357700                                                                  35770037
357800     MOVE ASC-PO-NBR-N             TO APONBRO.                    35780037
357900     MOVE ASC-REC-SEQ-NBR-N        TO ARECSEQO.                   35790037
358000     MOVE ASC-PO-STATUS            TO APOSTATO.                   35800037
358100     MOVE ASC-RCVR-STATUS          TO ARCVSTAO.                   35810037
358200     MOVE ASC-VENDOR-NAME          TO AVNAMEO.                    35820037
358500     MOVE ASC-BUYER-NAME           TO ABNAMEO.                    35850037
358600     MOVE ASC-RCVR-CREATOR         TO ARCVCRO.                    35860037
358700     MOVE ASC-REC-CLERK            TO ARCVCLO.                    35870037
358800     MOVE ASC-DEPT                 TO ADEPTO.                     35880046
358900     MOVE ASC-TROUB-STATUS-1       TO ATROUBO.                    35890037
359000     MOVE ASC-TROUB-STATUS-2       TO ASTATO.                     35900037
359100     MOVE ASC-DO-NOT-SHIP-DATE     TO ADNSHIPO.                   35910037
359200     MOVE ASC-CARRIER              TO ACARRO.                     35920037
359300     MOVE ASC-CANCEL-DATE          TO ACANDTEO.                   35930037
359400     MOVE ASC-TRAILER-NBR          TO ATRLRNOO.                   35940037
359500     MOVE ASC-AD-DATE              TO AADDATEO.                   35950037
359600     MOVE ASC-PRO-NUMBER           TO APROO.                      35960037
359700     MOVE ASC-BOL-NUMBER           TO ABOLO.                      35970037
359800     MOVE ASC-AD-INFO              TO AADINFOO.                   35980037
359900     MOVE ASC-VDR-SHIP-DATE        TO AVSHPDTO.                   35990037
360000     MOVE ASC-SPEC-INSTRC          TO ASPCINSO.                   36000037
360100     MOVE ASC-CARR-SHIP-DTE        TO ACSHPDTO.                   36010037
360200     MOVE ASC-TKT-FMT-ID           TO ATTYPEO.                    36020037
360300     MOVE ASC-RCVR-NBR             TO ARCVRO.                     36030037
360400     MOVE ASC-ARRIVAL-DATE         TO AARRVDTO.                   36040037
360500     MOVE ASC-OPER-SET-ID-N        TO AOPSETO.                    36050037
360600     MOVE ASC-OPER-SET-DESC        TO AOPDESCO.                   36060037
360700     MOVE ASC-PROC-INFO-ASN        TO APIASNO.                    36070037
360800     MOVE ASC-PROC-INFO-PRE        TO APIPREO.                    36080037
360900     MOVE ASC-PROC-INFO-PACK       TO APIPACKO.                   36090037
361000     MOVE ASC-RCV-CRE-DATE         TO ARCVDTEO.                   36100037
361100     MOVE ASC-RCV-CRE-TIME         TO ARCVTMEO.                   36110037
361200     MOVE ASC-APRON-LOC-DESC       TO AAPRLOCO.                   36120037
361300     MOVE ASC-EXPTED-CART-CNT-N    TO ACTNSO.                     36130037
361400     MOVE ASC-PROC-INFO-EDI        TO APIEDIO.                    36140037
361500     MOVE ASC-TRANSCRIBE-DATE      TO ATRSDTEO.                   36150037
361600     MOVE ASC-TRANSCRIBE-TIME      TO ATRSTMEO.                   36160037
361700     MOVE ASC-ACTL-CART-CNT-N      TO AADJCTNO.                   36170037
361800     MOVE ASC-PROC-INFO-DET        TO APIDETO.                    36180037
361900     MOVE ASC-MK-APRN-DATE         TO AMADTEO.                    36190037
362000     MOVE ASC-MK-APRN-TIME         TO AMATMEO.                    36200037
362100     MOVE ASC-DMG-CART-CNT-N       TO ADMGCTNO.                   36210037
362200     MOVE ASC-MK-HDR-DATE          TO AMHDTEO.                    36220037
362300     MOVE ASC-MK-HDR-TIME          TO AMHTMEO.                    36230037
362400     MOVE ASC-LAST-CHNG-DATE       TO ALCDTEO.                    36240037
362500     MOVE ASC-LAST-CHNG-TIME       TO ALCTMEO.                    36250037
362600     MOVE ASC-PCS-INVCD-N          TO APCSINVO.                   36260037
362700     MOVE ASC-SHIPPED-DATE         TO ASHPDTEO.                   36270037
362800     MOVE ASC-SHIPPED-TIME         TO ASHPTMEO.                   36280037
362900     MOVE ASC-CHANGD-BY            TO ACBIDO.                     36290037
363000     MOVE ASC-PCS-VERFD-N          TO APCSVERO.                   36300037
363100     MOVE ASC-PCS-VER-DATE         TO APCSDTEO.                   36310037
363200     MOVE ASC-PCS-VER-TIME         TO APCSTMEO.                   36320037
363300     MOVE ASC-ATL-OPER-UNT-ID      TO AOPERO.                     36330037
363400     MOVE ASC-ATL-FCLTY-ID         TO AFCLTYO.                    36340037
363500     MOVE ASC-CUR-OPER-UNT-ID      TO ACOPERO.                    36350037
363600     MOVE ASC-CUR-FCLTY-ID         TO ACFCLTYO.                   36360037
363700     MOVE ASC-ORIG-OPER-UNT-ID      TO AOOPERO.                   36370037
363800     MOVE ASC-ORIG-FCLTY-ID         TO AOFCLTYO.                  36380037
363900                                                                  36390037
364000/                                                                 36400037
364100*----------------------------------------------------------------*36410037
364200*    THIS PARAGRAPH CONTROL THE DELETION PROCESSING FOR THE      *36420037
364300*    TRECEIV, TRECDIS, TRECITM, TPKSLIP, TPKITEM, TWRKORD AND    *36430037
364400*    TWKORIN TABLES.                                             *36440037
364500*----------------------------------------------------------------*36450037
364600 7000-DELETE-PROCESSING.                                          36460037
364700                                                                  36470037
364800     MOVE ASC-PO-NBR-N             TO PV-MSG-PO                   36480037
364900     MOVE ASC-REC-SEQ-NBR-N        TO PV-MSG-RCVR                 36490037
365000                                                                  36500037
365100     PERFORM 7100-DELETE-WORK-ORDERS.                             36510037
365200     PERFORM 7200-DELETE-PACK-SLIPS.                              36520037
365300     PERFORM 7300-DELETE-RECEIPTS.                                36530037
365400     PERFORM 7407-OPEN-TSHPTPO-CSR.                               36540037
365500     PERFORM 7405-DETACH-TSHPTPOS                                 36550037
365600         UNTIL PS-END-OF-TSHPTPO.                                 36560037
365700     PERFORM 7409-CLOSE-TSHPTPO-CSR.                              36570037
365800                                                                  36580037
365900     MOVE PC-TSYMSG-00115          TO DP020-MSG-NUMBER.           36590037
366000     SET DP020-MSG-INFORMATIONAL   TO TRUE.                       36600037
366100                                                                  36610037
366200/                                                                 36620037
366300*----------------------------------------------------------------*36630037
366400*    THIS PARAGRAPH CONTROLS THE DELETION PROCESSING FOR THE     *36640037
366500*    WORK ORDER TABLES, TWRKORD AND TWKORIN.                     *36650037
366600*----------------------------------------------------------------*36660037
366700 7100-DELETE-WORK-ORDERS.                                         36670037
366800                                                                  36680037
366900     PERFORM 7105-OPEN-TWRKORD-CSR.                               36690037
367000     PERFORM 7110-SELECT-TWRKORD.                                 36700037
367100                                                                  36710037
367200     PERFORM                                                      36720037
367300         UNTIL PS-END-OF-TWRKORD                                  36730037
367400             PERFORM 7120-SET-WRKORD-INACTIVE                     36740037
367500             PERFORM 7130-INSERT-TWRKORD                          36750037
367600             PERFORM 7150-OPEN-TWKORIN-CSR                        36760037
367700             PERFORM 7160-SELECT-TWKORIN                          36770037
367800                                                                  36780037
367900             PERFORM                                              36790037
368000                 UNTIL PS-END-OF-TWKORIN                          36800037
368100                     PERFORM 7170-SET-TWKORIN-INACTIVE            36810037
368200                     PERFORM 7180-INSERT-TWKORIN                  36820037
368300                     PERFORM 7160-SELECT-TWKORIN                  36830037
368400             END-PERFORM                                          36840037
368500                                                                  36850037
368600             PERFORM 7140-CLOSE-TWKORIN-CSR                       36860037
368700             PERFORM 7110-SELECT-TWRKORD                          36870037
368800     END-PERFORM.                                                 36880037
368900                                                                  36890037
369000     PERFORM 7140-CLOSE-TWRKORD-CSR.                              36900037
369100                                                                  36910037
369200/                                                                 36920037
369300*----------------------------------------------------------------*36930037
369400* OPEN THE WORK ORDER CURSOR                                     *36940037
369500*----------------------------------------------------------------*36950037
369600                                                                  36960037
369700 7105-OPEN-TWRKORD-CSR.                                           36970037
369800                                                                  36980037
369900     PERFORM                                                      36990037
370000         WITH TEST AFTER                                          37000037
370100         VARYING PV-RETRY-COUNTER                                 37010037
370200         FROM 1 BY 1                                              37020037
370300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37030037
370400            OR (SQLCODE = +100)                                   37040037
370500            OR (SQLCODE = +0))                                    37050037
370600                                                                  37060037
370700         EXEC SQL                                                 37070037
370800             OPEN TWRKORD-CSR                                     37080037
370900         END-EXEC                                                 37090037
371000                                                                  37100037
371100         EVALUATE TRUE                                            37110037
371200             WHEN SQLCODE = +0                                    37120037
371300                  SET PS-NOT-END-OF-TWRKORD                       37130037
371400                                   TO TRUE                        37140037
371500             WHEN SQLCODE = -904                                  37150037
371600             WHEN SQLCODE = -913                                  37160037
371700                  CONTINUE                                        37170037
371800                                                                  37180037
371900             WHEN SQLWARN0 NOT = SPACE                            37190037
372000             WHEN SQLCODE  NOT = +0                               37200037
372100                  MOVE '7105-OPEN-TWRKORD-CSR'                    37210037
372200                                   TO DP013-PARAGRAPH             37220037
372300                  MOVE 'OPEN TWRKORD-CSR CURSOR'                  37230037
372400                                   TO DP013-MESSAGE-TEXT (1)      37240037
372500                  MOVE PV-ABEND-MSG-KEYS                          37250037
372600                                   TO DP013-MESSAGE-TEXT (2)      37260037
372700                  MOVE SQLCA       TO DP013-SQLCA                 37270037
372800                  MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)    37280037
372900                  SET DP013-DB2-ABEND                             37290037
373000                                   TO TRUE                        37300037
373100                  PERFORM DP013-0000-PROCESS-ABEND                37310037
373200         END-EVALUATE                                             37320037
373300     END-PERFORM.                                                 37330037
373400                                                                  37340037
373500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    37350037
373600         SQLCODE NOT = +0                                         37360037
373700         MOVE '7105-OPEN-TWRKORD-CSR'                             37370037
373800                                   TO DP013-PARAGRAPH             37380037
373900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              37390037
374000                                   TO DP013-MESSAGE-TEXT (1)      37400037
374100         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      37410037
374200         MOVE SQLCA                TO DP013-SQLCA                 37420037
374300         SET DP013-DB2-ABEND       TO TRUE                        37430037
374400         PERFORM DP013-0000-PROCESS-ABEND                         37440037
374500     END-IF.                                                      37450037
374600                                                                  37460037
374700/                                                                 37470037
374800*----------------------------------------------------------------*37480037
374900*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE WORK ORDER TABLE  *37490037
375000*  (TWRKORD) FOR A SPECIFIED ROW.                                *37500037
375100*----------------------------------------------------------------*37510037
375200 7110-SELECT-TWRKORD.                                             37520037
375300                                                                  37530037
375400     PERFORM                                                      37540037
375500         WITH TEST AFTER                                          37550037
375600         VARYING PV-RETRY-COUNTER                                 37560037
375700         FROM 1 BY 1                                              37570037
375800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37580037
375900             OR (SQLCODE = +100)                                  37590037
376000             OR (SQLCODE = +0))                                   37600037
376100                                                                  37610037
376200         EXEC SQL                                                 37620037
376300           FETCH  TWRKORD-CSR                                     37630037
376400            INTO  :WRKORD-ORD-NBR                                 37640037
376500                 ,:WRKORD-RCVR-SEQ-NBR                            37650037
376600                 ,:WRKORD-ORD-LNE-NBR                             37660037
376700                 ,:WRKORD-WORK-ORD-SEQ-NBR                        37670037
376800                 ,:WRKORD-OPER-UNT-ID                             37680037
376900                 ,:WRKORD-FCLTY-ID                                37690037
377000                 ,:WRKORD-CRE-TMST                                37700037
377100                 ,:WRKORD-VER-STATUS-CDE                          37710037
377200                 ,:WRKORD-CRE-UID-ID                              37720037
377300                 ,:WRKORD-EXPTED-CART-CNT                         37730037
377400                 ,:WRKORD-ACTL-CART-CNT                           37740037
377500                 ,:WRKORD-EXPTED-ITM-CNT                          37750037
377600                 ,:WRKORD-ACTL-ITM-CNT                            37760037
377700                 ,:WRKORD-STAT-CDE                                37770037
377800                 ,:WRKORD-WORK-ORD-DISTR-IND                      37780037
377900                 ,:WRKORD-OPER-SET-ID                             37790037
378000         END-EXEC                                                 37800037
378100                                                                  37810037
378200         EVALUATE TRUE                                            37820037
378300             WHEN SQLCODE = +0                                    37830037
378400             WHEN SQLCODE = -904                                  37840037
378500             WHEN SQLCODE = -913                                  37850037
378600                 CONTINUE                                         37860037
378700                                                                  37870037
378800             WHEN SQLCODE = +100                                  37880037
378900                 SET PS-END-OF-TWRKORD                            37890037
379000                                   TO TRUE                        37900037
379100                                                                  37910037
379200             WHEN SQLWARN0 NOT = SPACES                           37920037
379300             WHEN SQLCODE < +0                                    37930037
379400             WHEN SQLCODE > +0                                    37940037
379500                 MOVE '7110-SELECT-TWRKORD'                       37950037
379600                                   TO DP013-PARAGRAPH             37960037
379700                 MOVE 'ERROR READING TWRKORD'                     37970037
379800                                   TO DP013-MESSAGE-TEXT(1)       37980037
379900                 MOVE PV-ABEND-MSG-KEYS                           37990037
380000                                   TO DP013-MESSAGE-TEXT (2)      38000037
380100                 MOVE SQLCA        TO DP013-SQLCA                 38010037
380200                 MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)    38020037
380300                 SET DP013-DB2-ABEND                              38030037
380400                     DP013-XCTL-DISPLAY-RESTART                   38040037
380500                                   TO TRUE                        38050037
380600                 PERFORM DP013-0000-PROCESS-ABEND                 38060037
380700         END-EVALUATE                                             38070037
380800     END-PERFORM.                                                 38080037
380900                                                                  38090037
381000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38100037
381100         SQLCODE NOT = +0                                         38110037
381200         MOVE '7110-SELECT-TWRKORD'                               38120037
381300                                   TO DP013-PARAGRAPH             38130037
381400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38140037
381500                                   TO DP013-MESSAGE-TEXT (1)      38150037
381600         MOVE 'TO READ A ROW FROM TWRKORD FOR UPDATE'             38160037
381700                                   TO DP013-MESSAGE-TEXT (2)      38170037
381800         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (3)      38180037
381900         MOVE SQLCA                TO DP013-SQLCA                 38190037
382000         MOVE 'TWRKORD'            TO DP013-DB2-TABLE-NAME (1)    38200037
382100         SET DP013-DB2-ABEND                                      38210037
382200             DP013-XCTL-DISPLAY-RESTART                           38220037
382300                                   TO TRUE                        38230037
382400         PERFORM DP013-0000-PROCESS-ABEND                         38240037
382500     END-IF.                                                      38250037
382600                                                                  38260037
382700/                                                                 38270037
382800*----------------------------------------------------------------*38280037
382900*  THIS PARAGRAPH WILL STATUS THE CURRENT ROW INACTIVE.  THIS    *38290037
383000*  IS BEING DONE FOR AUDITING PURPOSES.                          *38300037
383100*----------------------------------------------------------------*38310037
383200 7120-SET-WRKORD-INACTIVE.                                        38320037
383300                                                                  38330037
383400     PERFORM                                                      38340037
383500         WITH TEST AFTER                                          38350037
383600         VARYING PV-RETRY-COUNTER                                 38360037
383700         FROM 1 BY 1                                              38370037
383800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38380037
383900             OR (SQLCODE = +0))                                   38390037
384000                                                                  38400037
384100         EXEC SQL                                                 38410037
384200           UPDATE TWRKORD                                         38420037
384300              SET VER_STATUS_CDE   = :PC-I                        38430037
384400            WHERE ORD_NBR          = :DK-PO-NBR                   38440037
384500              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              38450037
384600              AND ORD_LNE_NBR      = :WRKORD-ORD-LNE-NBR          38460037
384700              AND WORK_ORD_SEQ_NBR = :WRKORD-WORK-ORD-SEQ-NBR     38470037
384800              AND OPER_UNT_ID      = :DK-OPER-UNT-ID              38480037
384900              AND FCLTY_ID         = :DK-FCLTY-ID                 38490037
385000              AND VER_STATUS_CDE   = :PC-A                        38500037
385100         END-EXEC                                                 38510037
385200                                                                  38520037
385300         EVALUATE TRUE                                            38530037
385400             WHEN SQLCODE = +0                                    38540037
385500             WHEN SQLCODE = -904                                  38550037
385600             WHEN SQLCODE = -913                                  38560037
385700                 CONTINUE                                         38570037
385800                                                                  38580037
385900             WHEN SQLWARN0 NOT = SPACES                           38590037
386000             WHEN SQLCODE < +0                                    38600037
386100             WHEN SQLCODE > +0                                    38610037
386200                 MOVE '7120-SET-WRKORD-INACTIVE'                  38620037
386300                                   TO DP013-PARAGRAPH             38630037
386400                 MOVE 'ERROR UPDATING TWRKORD '                   38640037
386500                                   TO DP013-MESSAGE-TEXT(1)       38650037
386600                 MOVE PV-ABEND-MSG-KEYS                           38660037
386700                                   TO DP013-MESSAGE-TEXT (2)      38670037
386800                 MOVE SQLCA        TO DP013-SQLCA                 38680037
386900                 MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)    38690037
387000                 SET DP013-DB2-ABEND                              38700037
387100                     DP013-XCTL-DISPLAY-RESTART                   38710037
387200                                   TO TRUE                        38720037
387300                 PERFORM DP013-0000-PROCESS-ABEND                 38730037
387400         END-EVALUATE                                             38740037
387500     END-PERFORM.                                                 38750037
387600                                                                  38760037
387700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38770037
387800         SQLCODE NOT = +0                                         38780037
387900         MOVE '7120-SET-WRKORD-INACTIVE'                          38790037
388000                                   TO DP013-PARAGRAPH             38800037
388100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38810037
388200                                   TO DP013-MESSAGE-TEXT (1)      38820037
388300         MOVE 'TO UPDATE A ROW ON TWRKORD'                        38830037
388400                                   TO DP013-MESSAGE-TEXT (2)      38840037
388500         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (3)      38850037
388600         MOVE SQLCA                TO DP013-SQLCA                 38860037
388700         MOVE 'TWRKORD'            TO DP013-DB2-TABLE-NAME (1)    38870037
388800         SET DP013-DB2-ABEND                                      38880037
388900             DP013-XCTL-DISPLAY-RESTART                           38890037
389000                                   TO TRUE                        38900037
389100         PERFORM DP013-0000-PROCESS-ABEND                         38910037
389200     END-IF.                                                      38920037
389300                                                                  38930037
389400/                                                                 38940037
389500*----------------------------------------------------------------*38950037
389600*  THIS PARAGRAPH WILL INSERT A NEW ROW INTO THE WORK ORDER      *38960037
389700*  TABLE (TWRKORD).  IT WILL BE AN 'I'NACTIVE VER-STATUS WITH    *38970037
389800*  A STATUS-CDE OF 'DE'LETE                                      *38980037
389900*----------------------------------------------------------------*38990037
390000 7130-INSERT-TWRKORD.                                             39000037
390100                                                                  39010037
390200     PERFORM                                                      39020037
390300         WITH TEST AFTER                                          39030037
390400         VARYING PV-RETRY-COUNTER                                 39040037
390500         FROM 1 BY 1                                              39050037
390600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39060037
390700             OR (SQLCODE = +0))                                   39070037
390800                                                                  39080037
390900         EXEC SQL                                                 39090037
391000            INSERT INTO TWRKORD                                   39100037
391100                  (ORD_NBR                                        39110037
391200                  ,RCVR_SEQ_NBR                                   39120037
391300                  ,ORD_LNE_NBR                                    39130037
391400                  ,WORK_ORD_SEQ_NBR                               39140037
391500                  ,OPER_UNT_ID                                    39150037
391600                  ,FCLTY_ID                                       39160037
391700                  ,CRE_TMST                                       39170037
391800                  ,VER_STATUS_CDE                                 39180037
391900                  ,CRE_UID_ID                                     39190037
392000                  ,EXPTED_CART_CNT                                39200037
392100                  ,ACTL_CART_CNT                                  39210037
392200                  ,EXPTED_ITM_CNT                                 39220037
392300                  ,ACTL_ITM_CNT                                   39230037
392400                  ,STAT_CDE                                       39240037
392500                  ,WORK_ORD_DISTR_IND                             39250037
392600                  ,OPER_SET_ID)                                   39260037
392700           VALUES (:WRKORD-ORD-NBR                                39270037
392800                  ,:WRKORD-RCVR-SEQ-NBR                           39280037
392900                  ,:WRKORD-ORD-LNE-NBR                            39290037
393000                  ,:WRKORD-WORK-ORD-SEQ-NBR                       39300037
393100                  ,:WRKORD-OPER-UNT-ID                            39310037
393200                  ,:WRKORD-FCLTY-ID                               39320037
393300                  , CURRENT TIMESTAMP                             39330037
393400                  ,:PC-I                                          39340037
393500                  ,:DP020-USERID                                  39350037
393600                  ,:WRKORD-EXPTED-CART-CNT                        39360037
393700                  ,:WRKORD-ACTL-CART-CNT                          39370037
393800                  ,:WRKORD-EXPTED-ITM-CNT                         39380037
393900                  ,:WRKORD-ACTL-ITM-CNT                           39390037
394000                  ,:PC-DE                                         39400037
394100                  ,:WRKORD-WORK-ORD-DISTR-IND                     39410037
394200                  ,:WRKORD-OPER-SET-ID)                           39420037
394300         END-EXEC                                                 39430037
394400                                                                  39440037
394500         EVALUATE TRUE                                            39450037
394600             WHEN SQLCODE = +0                                    39460037
394700             WHEN SQLCODE = -904                                  39470037
394800             WHEN SQLCODE = -913                                  39480037
394900                 CONTINUE                                         39490037
395000                                                                  39500037
395100             WHEN SQLWARN0 NOT = SPACES                           39510037
395200             WHEN SQLCODE < +0                                    39520037
395300             WHEN SQLCODE > +0                                    39530037
395400                 MOVE '7130-INSERT-TWRKORD'                       39540037
395500                                   TO DP013-PARAGRAPH             39550037
395600                 MOVE 'ERROR INSERTING A ROW INTO TWRKORD '       39560037
395700                                   TO DP013-MESSAGE-TEXT(1)       39570037
395800                 MOVE PV-ABEND-MSG-KEYS                           39580037
395900                                   TO DP013-MESSAGE-TEXT (2)      39590037
396000                 MOVE SQLCA        TO DP013-SQLCA                 39600037
396100                 MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)    39610037
396200                 SET DP013-DB2-ABEND                              39620037
396300                     DP013-XCTL-DISPLAY-RESTART                   39630037
396400                                   TO TRUE                        39640037
396500                 PERFORM DP013-0000-PROCESS-ABEND                 39650037
396600         END-EVALUATE                                             39660037
396700     END-PERFORM.                                                 39670037
396800                                                                  39680037
396900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39690037
397000         SQLCODE NOT = +0                                         39700037
397100         MOVE '7130-INSERT-TWRKORD'                               39710037
397200                                   TO DP013-PARAGRAPH             39720037
397300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              39730037
397400                                   TO DP013-MESSAGE-TEXT (1)      39740037
397500         MOVE 'TO INSERT A ROW INTO TWRKORD '                     39750037
397600                                   TO DP013-MESSAGE-TEXT (2)      39760037
397700         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (3)      39770037
397800         MOVE SQLCA                TO DP013-SQLCA                 39780037
397900         MOVE 'TWRKORD'            TO DP013-DB2-TABLE-NAME (1)    39790037
398000         SET DP013-DB2-ABEND                                      39800037
398100             DP013-XCTL-DISPLAY-RESTART                           39810037
398200                                   TO TRUE                        39820037
398300         PERFORM DP013-0000-PROCESS-ABEND                         39830037
398400     END-IF.                                                      39840037
398500                                                                  39850037
398600/                                                                 39860037
398700*----------------------------------------------------------------*39870037
398800* CLOSE THE WORK ORDER CURSOR                                    *39880037
398900*----------------------------------------------------------------*39890037
399000                                                                  39900037
399100 7140-CLOSE-TWRKORD-CSR.                                          39910037
399200                                                                  39920037
399300     EXEC SQL                                                     39930037
399400         CLOSE TWRKORD-CSR                                        39940037
399500     END-EXEC.                                                    39950037
399600                                                                  39960037
399700     EVALUATE TRUE                                                39970037
399800         WHEN SQLCODE = +0                                        39980037
399900              CONTINUE                                            39990037
400000                                                                  40000037
400100         WHEN SQLWARN0 NOT = SPACE                                40010037
400200         WHEN SQLCODE  NOT = +0                                   40020037
400300              MOVE '7140-CLOSE-TWRKORD-CSR'                       40030037
400400                                   TO DP013-PARAGRAPH             40040037
400500              MOVE 'CLOSE TWRKORD-CSR CURSOR'                     40050037
400600                                   TO DP013-MESSAGE-TEXT (1)      40060037
400700              MOVE PV-ABEND-MSG-KEYS                              40070037
400800                                   TO DP013-MESSAGE-TEXT (2)      40080037
400900              MOVE SQLCA           TO DP013-SQLCA                 40090037
401000              MOVE 'TWRKORD'       TO DP013-DB2-TABLE-NAME (1)    40100037
401100              SET DP013-DB2-ABEND  TO TRUE                        40110037
401200              PERFORM DP013-0000-PROCESS-ABEND                    40120037
401300     END-EVALUATE.                                                40130037
401400                                                                  40140037
401500/                                                                 40150037
401600*----------------------------------------------------------------*40160037
401700* OPEN THE WORK ORDER INSTRUCTION CURSOR                         *40170037
401800*----------------------------------------------------------------*40180037
401900                                                                  40190037
402000 7150-OPEN-TWKORIN-CSR.                                           40200037
402100                                                                  40210037
402200     PERFORM                                                      40220037
402300         WITH TEST AFTER                                          40230037
402400         VARYING PV-RETRY-COUNTER                                 40240037
402500         FROM 1 BY 1                                              40250037
402600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40260037
402700            OR (SQLCODE = +100)                                   40270037
402800            OR (SQLCODE = +0))                                    40280037
402900                                                                  40290037
403000         EXEC SQL                                                 40300037
403100             OPEN TWKORIN-CSR                                     40310037
403200         END-EXEC                                                 40320037
403300                                                                  40330037
403400         EVALUATE TRUE                                            40340037
403500             WHEN SQLCODE = +0                                    40350037
403600                  SET PS-NOT-END-OF-TWKORIN                       40360037
403700                                   TO TRUE                        40370037
403800             WHEN SQLCODE = -904                                  40380037
403900             WHEN SQLCODE = -913                                  40390037
404000                  CONTINUE                                        40400037
404100                                                                  40410037
404200             WHEN SQLWARN0 NOT = SPACE                            40420037
404300             WHEN SQLCODE  NOT = +0                               40430037
404400                  MOVE '7150-OPEN-TWKORIN-CSR'                    40440037
404500                                   TO DP013-PARAGRAPH             40450037
404600                  MOVE 'OPEN TWKORIN-CSR CURSOR'                  40460037
404700                                   TO DP013-MESSAGE-TEXT (1)      40470037
404800                  MOVE PV-ABEND-MSG-KEYS                          40480037
404900                                   TO DP013-MESSAGE-TEXT (2)      40490037
405000                  MOVE SQLCA       TO DP013-SQLCA                 40500037
405100                  MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)    40510037
405200                  SET DP013-DB2-ABEND                             40520037
405300                                   TO TRUE                        40530037
405400                  PERFORM DP013-0000-PROCESS-ABEND                40540037
405500         END-EVALUATE                                             40550037
405600     END-PERFORM.                                                 40560037
405700                                                                  40570037
405800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    40580037
405900         SQLCODE NOT = +0                                         40590037
406000         MOVE '7150-OPEN-TWKORIN-CSR'                             40600037
406100                                   TO DP013-PARAGRAPH             40610037
406200         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              40620037
406300                                   TO DP013-MESSAGE-TEXT (1)      40630037
406400         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      40640037
406500         MOVE SQLCA                TO DP013-SQLCA                 40650037
406600         SET DP013-DB2-ABEND       TO TRUE                        40660037
406700         PERFORM DP013-0000-PROCESS-ABEND                         40670037
406800     END-IF.                                                      40680037
406900                                                                  40690037
407000/                                                                 40700037
407100*----------------------------------------------------------------*40710037
407200*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE WORK ORDER        *40720037
407300*  INSTRUCTION TABLE (TWKORIN) FOR A SPECIFIED ROW.              *40730037
407400*----------------------------------------------------------------*40740037
407500                                                                  40750037
407600 7160-SELECT-TWKORIN.                                             40760037
407700                                                                  40770037
407800     PERFORM                                                      40780037
407900         WITH TEST AFTER                                          40790037
408000         VARYING PV-RETRY-COUNTER                                 40800037
408100         FROM 1 BY 1                                              40810037
408200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40820037
408300             OR (SQLCODE = +100)                                  40830037
408400             OR (SQLCODE = +0))                                   40840037
408500                                                                  40850037
408600         EXEC SQL                                                 40860037
408700            FETCH TWKORIN-CSR                                     40870037
408800             INTO :WKORIN-ORD-NBR                                 40880037
408900                , :WKORIN-RCVR-SEQ-NBR                            40890037
409000                , :WKORIN-ORD-LNE-NBR                             40900037
409100                , :WKORIN-WORK-ORD-SEQ-NBR                        40910037
409200                , :WKORIN-OPER-UNT-ID                             40920037
409300                , :WKORIN-FCLTY-ID                                40930037
409400                , :WKORIN-WO-INSTR-SEQ-NBR                        40940037
409500                , :WKORIN-CRE-TMST                                40950037
409600                , :WKORIN-VER-STATUS-CDE                          40960037
409700                , :WKORIN-CRE-UID-ID                              40970037
409800                , :WKORIN-OPER-ID                                 40980037
409900                , :WKORIN-FCLTY-AREA-ID                           40990037
410000                , :WKORIN-PRC-FCLTY-AREA-ID                       41000037
410100                , :WKORIN-EXPTED-CART-CNT                         41010037
410200                , :WKORIN-ACTL-CART-CNT                           41020037
410300                , :WKORIN-ALLOC-IND                               41030037
410400                , :WKORIN-REPACK-IND                              41040037
410500                , :WKORIN-STRT-TMST                               41050037
410600                , :WKORIN-STOP-TMST                               41060037
410700                , :WKORIN-SCREEN-SEQ-NBR                          41070037
410800                , :WKORIN-LNE-LOC-CDE                             41080037
410900                , :WKORIN-REC-SEL-IND                             41090037
411000         END-EXEC                                                 41100037
411100                                                                  41110037
411200         EVALUATE TRUE                                            41120037
411300             WHEN SQLCODE = +0                                    41130037
411400             WHEN SQLCODE = -904                                  41140037
411500             WHEN SQLCODE = -913                                  41150037
411600                 CONTINUE                                         41160037
411700                                                                  41170037
411800             WHEN SQLCODE = +100                                  41180037
411900                 SET PS-END-OF-TWKORIN                            41190037
412000                                   TO TRUE                        41200037
412100                                                                  41210037
412200             WHEN SQLWARN0 NOT = SPACES                           41220037
412300             WHEN SQLCODE < +0                                    41230037
412400             WHEN SQLCODE > +0                                    41240037
412500                 MOVE '7160-SELECT-TWKORIN'                       41250037
412600                                   TO DP013-PARAGRAPH             41260037
412700                 MOVE 'ERROR READING TWKORIN'                     41270037
412800                                   TO DP013-MESSAGE-TEXT(1)       41280037
412900                 MOVE PV-ABEND-MSG-KEYS                           41290037
413000                                   TO DP013-MESSAGE-TEXT (2)      41300037
413100                 MOVE SQLCA        TO DP013-SQLCA                 41310037
413200                 MOVE 'TWKORIN'    TO DP013-DB2-TABLE-NAME (1)    41320037
413300                 SET DP013-DB2-ABEND                              41330037
413400                     DP013-XCTL-DISPLAY-RESTART                   41340037
413500                                   TO TRUE                        41350037
413600                 PERFORM DP013-0000-PROCESS-ABEND                 41360037
413700         END-EVALUATE                                             41370037
413800     END-PERFORM.                                                 41380037
413900                                                                  41390037
414000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    41400037
414100         SQLCODE NOT = +0                                         41410037
414200         MOVE '7160-SELECT-TWKORIN'                               41420037
414300                                   TO DP013-PARAGRAPH             41430037
414400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              41440037
414500                                   TO DP013-MESSAGE-TEXT (1)      41450037
414600         MOVE 'TO READ A ROW FROM TWKORIN FOR UPDATE'             41460037
414700                                   TO DP013-MESSAGE-TEXT (2)      41470037
414800         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (3)      41480037
414900         MOVE SQLCA                TO DP013-SQLCA                 41490037
415000         MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)    41500037
415100         SET DP013-DB2-ABEND                                      41510037
415200             DP013-XCTL-DISPLAY-RESTART                           41520037
415300                                   TO TRUE                        41530037
415400         PERFORM DP013-0000-PROCESS-ABEND                         41540037
415500     END-IF.                                                      41550037
415600                                                                  41560037
415700/                                                                 41570037
415800*----------------------------------------------------------------*41580037
415900*  THIS PARAGRAPH WILL STATUS THE CURRENT ROW INACTIVE.  THIS    *41590037
416000*  IS BEING DONE FOR AUDITING PURPOSES.                          *41600037
416100*----------------------------------------------------------------*41610037
416200 7170-SET-TWKORIN-INACTIVE.                                       41620037
416300                                                                  41630037
416400     PERFORM                                                      41640037
416500         WITH TEST AFTER                                          41650037
416600         VARYING PV-RETRY-COUNTER                                 41660037
416700         FROM 1 BY 1                                              41670037
416800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41680037
416900             OR (SQLCODE = +0))                                   41690037
417000                                                                  41700037
417100         EXEC SQL                                                 41710037
417200           UPDATE TWKORIN                                         41720037
417300              SET VER_STATUS_CDE   = :PC-I                        41730037
417400            WHERE ORD_NBR          = :DK-PO-NBR                   41740037
417500              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              41750037
417600              AND ORD_LNE_NBR      = :WRKORD-ORD-LNE-NBR          41760037
417700              AND WORK_ORD_SEQ_NBR = :WRKORD-WORK-ORD-SEQ-NBR     41770037
417800              AND OPER_UNT_ID      = :DK-OPER-UNT-ID              41780037
417900              AND FCLTY_ID         = :DK-FCLTY-ID                 41790037
418000              AND WO_INSTR_SEQ_NBR = :WKORIN-WO-INSTR-SEQ-NBR     41800037
418100              AND VER_STATUS_CDE   = :PC-A                        41810037
418200         END-EXEC                                                 41820037
418300                                                                  41830037
418400         EVALUATE TRUE                                            41840037
418500             WHEN SQLCODE = +0                                    41850037
418600             WHEN SQLCODE = -904                                  41860037
418700             WHEN SQLCODE = -913                                  41870037
418800                 CONTINUE                                         41880037
418900                                                                  41890037
419000             WHEN SQLWARN0 NOT = SPACES                           41900037
419100             WHEN SQLCODE < +0                                    41910037
419200             WHEN SQLCODE > +0                                    41920037
419300                 MOVE '7170-SET-TWKORIN-INACTIVE'                 41930037
419400                                   TO DP013-PARAGRAPH             41940037
419500                 MOVE 'ERROR UPDATING TWKORIN '                   41950037
419600                                   TO DP013-MESSAGE-TEXT(1)       41960037
419700                 MOVE PV-ABEND-MSG-KEYS                           41970037
419800                                   TO DP013-MESSAGE-TEXT (2)      41980037
419900                 MOVE SQLCA        TO DP013-SQLCA                 41990037
420000                 MOVE 'TWKORIN'    TO DP013-DB2-TABLE-NAME (1)    42000037
420100                 SET DP013-DB2-ABEND                              42010037
420200                     DP013-XCTL-DISPLAY-RESTART                   42020037
420300                                   TO TRUE                        42030037
420400                 PERFORM DP013-0000-PROCESS-ABEND                 42040037
420500         END-EVALUATE                                             42050037
420600     END-PERFORM.                                                 42060037
420700                                                                  42070037
420800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42080037
420900         SQLCODE NOT = +0                                         42090037
421000         MOVE '7170-SET-TWKORIN-INACTIVE'                         42100037
421100                                   TO DP013-PARAGRAPH             42110037
421200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              42120037
421300                                   TO DP013-MESSAGE-TEXT (1)      42130037
421400         MOVE 'TO UPDATE A ROW ON TWKORIN'                        42140037
421500                                   TO DP013-MESSAGE-TEXT (2)      42150037
421600         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (3)      42160037
421700         MOVE SQLCA                TO DP013-SQLCA                 42170037
421800         MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)    42180037
421900         SET DP013-DB2-ABEND                                      42190037
422000             DP013-XCTL-DISPLAY-RESTART                           42200037
422100                                   TO TRUE                        42210037
422200         PERFORM DP013-0000-PROCESS-ABEND                         42220037
422300     END-IF.                                                      42230037
422400                                                                  42240037
422500/                                                                 42250037
422600*----------------------------------------------------------------*42260037
422700*  THIS PARAGRAPH WILL INSERT A NEW ROW INTO THE WORK ORDER      *42270037
422800*  INSTRUCTION TABLE (TWKORIN).  IT WILL BE AN 'I'NACTIVE        *42280037
422900*  VER-STATUS WITH A STATUS-CDE OF 'DE'LETE                      *42290037
423000*----------------------------------------------------------------*42300037
423100 7180-INSERT-TWKORIN.                                             42310037
423200                                                                  42320037
423300     PERFORM                                                      42330037
423400         WITH TEST AFTER                                          42340037
423500         VARYING PV-RETRY-COUNTER                                 42350037
423600         FROM 1 BY 1                                              42360037
423700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42370037
423800             OR (SQLCODE = +0))                                   42380037
423900                                                                  42390037
424000                                                                  42400037
424100         EXEC SQL                                                 42410037
424200             INSERT INTO TWKORIN                                  42420037
424300                   (ORD_NBR                                       42430037
424400                   ,RCVR_SEQ_NBR                                  42440037
424500                   ,ORD_LNE_NBR                                   42450037
424600                   ,WORK_ORD_SEQ_NBR                              42460037
424700                   ,WO_INSTR_SEQ_NBR                              42470037
424800                   ,CRE_TMST                                      42480037
424900                   ,VER_STATUS_CDE                                42490037
425000                   ,CRE_UID_ID                                    42500037
425100                   ,OPER_ID                                       42510037
425200                   ,OPER_UNT_ID                                   42520037
425300                   ,FCLTY_ID                                      42530037
425400                   ,FCLTY_AREA_ID                                 42540037
425500                   ,PRC_FCLTY_AREA_ID                             42550037
425600                   ,EXPTED_CART_CNT                               42560037
425700                   ,ACTL_CART_CNT                                 42570037
425800                   ,ALLOC_IND                                     42580037
425900                   ,REPACK_IND                                    42590037
426000                   ,STRT_TMST                                     42600037
426100                   ,STOP_TMST                                     42610037
426200                   ,SCREEN_SEQ_NBR                                42620037
426300                   ,LNE_LOC_CDE                                   42630037
426400                   ,REC_SEL_IND)                                  42640037
426500            VALUES                                                42650037
426600                  (:WKORIN-ORD-NBR                                42660037
426700                  ,:WKORIN-RCVR-SEQ-NBR                           42670037
426800                  ,:WKORIN-ORD-LNE-NBR                            42680037
426900                  ,:WKORIN-WORK-ORD-SEQ-NBR                       42690037
427000                  ,:WKORIN-WO-INSTR-SEQ-NBR                       42700037
427100                  , CURRENT TIMESTAMP                             42710037
427200                  ,:PC-I                                          42720037
427300                  ,:DP020-USERID                                  42730037
427400                  ,:WKORIN-OPER-ID                                42740037
427500                  ,:WKORIN-OPER-UNT-ID                            42750037
427600                  ,:WKORIN-FCLTY-ID                               42760037
427700                  ,:WKORIN-FCLTY-AREA-ID                          42770037
427800                  ,:WKORIN-PRC-FCLTY-AREA-ID                      42780037
427900                  ,:WKORIN-EXPTED-CART-CNT                        42790037
428000                  ,:WKORIN-ACTL-CART-CNT                          42800037
428100                  ,:WKORIN-ALLOC-IND                              42810037
428200                  ,:WKORIN-REPACK-IND                             42820037
428300                  ,:WKORIN-STRT-TMST                              42830037
428400                  ,:WKORIN-STOP-TMST                              42840037
428500                  ,:WKORIN-SCREEN-SEQ-NBR                         42850037
428600                  ,:WKORIN-LNE-LOC-CDE                            42860037
428700                  ,:WKORIN-REC-SEL-IND)                           42870037
428800         END-EXEC                                                 42880037
428900                                                                  42890037
429000         EVALUATE TRUE                                            42900037
429100             WHEN SQLCODE = +0                                    42910037
429200             WHEN SQLCODE = -904                                  42920037
429300             WHEN SQLCODE = -913                                  42930037
429400                 CONTINUE                                         42940037
429500                                                                  42950037
429600             WHEN SQLWARN0 NOT = SPACES                           42960037
429700             WHEN SQLCODE < +0                                    42970037
429800             WHEN SQLCODE > +0                                    42980037
429900                 MOVE '7180-INSERT-TWKORIN'                       42990037
430000                                   TO DP013-PARAGRAPH             43000037
430100                 MOVE 'ERROR INSERTING A ROW INTO TWKORIN '       43010037
430200                                   TO DP013-MESSAGE-TEXT(1)       43020037
430300                 MOVE PV-ABEND-MSG-KEYS                           43030037
430400                                   TO DP013-MESSAGE-TEXT (2)      43040037
430500                 MOVE SQLCA        TO DP013-SQLCA                 43050037
430600                 MOVE 'TWKORIN'    TO DP013-DB2-TABLE-NAME (1)    43060037
430700                 SET DP013-DB2-ABEND                              43070037
430800                     DP013-XCTL-DISPLAY-RESTART                   43080037
430900                                   TO TRUE                        43090037
431000                 PERFORM DP013-0000-PROCESS-ABEND                 43100037
431100         END-EVALUATE                                             43110037
431200     END-PERFORM.                                                 43120037
431300                                                                  43130037
431400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43140037
431500         SQLCODE NOT = +0                                         43150037
431600         MOVE '7180-INSERT-TWKORIN'                               43160037
431700                                   TO DP013-PARAGRAPH             43170037
431800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              43180037
431900                                   TO DP013-MESSAGE-TEXT (1)      43190037
432000         MOVE 'TO INSERT A ROW INTO TWKORIN '                     43200037
432100                                   TO DP013-MESSAGE-TEXT (2)      43210037
432200         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (3)      43220037
432300         MOVE SQLCA                TO DP013-SQLCA                 43230037
432400         MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)    43240037
432500         SET DP013-DB2-ABEND                                      43250037
432600             DP013-XCTL-DISPLAY-RESTART                           43260037
432700                                   TO TRUE                        43270037
432800         PERFORM DP013-0000-PROCESS-ABEND                         43280037
432900     END-IF.                                                      43290037
433000                                                                  43300037
433100/                                                                 43310037
433200*----------------------------------------------------------------*43320037
433300* CLOSE THE WORK ORDER INSTRUCTION CURSOR                        *43330037
433400*----------------------------------------------------------------*43340037
433500                                                                  43350037
433600 7140-CLOSE-TWKORIN-CSR.                                          43360037
433700                                                                  43370037
433800     EXEC SQL                                                     43380037
433900         CLOSE TWKORIN-CSR                                        43390037
434000     END-EXEC.                                                    43400037
434100                                                                  43410037
434200     EVALUATE TRUE                                                43420037
434300         WHEN SQLCODE = +0                                        43430037
434400              CONTINUE                                            43440037
434500                                                                  43450037
434600         WHEN SQLWARN0 NOT = SPACE                                43460037
434700         WHEN SQLCODE  NOT = +0                                   43470037
434800              MOVE '7140-CLOSE-TWKORIN-CSR'                       43480037
434900                                   TO DP013-PARAGRAPH             43490037
435000              MOVE 'CLOSE TWKORIN-CSR CURSOR'                     43500037
435100                                   TO DP013-MESSAGE-TEXT (1)      43510037
435200              MOVE PV-ABEND-MSG-KEYS                              43520037
435300                                   TO DP013-MESSAGE-TEXT (2)      43530037
435400              MOVE SQLCA           TO DP013-SQLCA                 43540037
435500              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    43550037
435600              SET DP013-DB2-ABEND  TO TRUE                        43560037
435700              PERFORM DP013-0000-PROCESS-ABEND                    43570037
435800     END-EVALUATE.                                                43580037
435900                                                                  43590037
436000/                                                                 43600037
436100*----------------------------------------------------------------*43610037
436200*    THIS PARAGRAPH CONTROLS THE DELETION PROCESSING FOR THE     *43620037
436300*    PACK SLIP TABLES, TPKSLIP, TPKITEM AND TUNPKSL.             *43630037
436400*----------------------------------------------------------------*43640037
436500 7200-DELETE-PACK-SLIPS.                                          43650037
436600                                                                  43660037
436700     PERFORM 7230-OPEN-TPKSLIP-CSR.                               43670037
436800     PERFORM 7232-SELECT-TPKSLIP.                                 43680037
436900                                                                  43690037
437000     PERFORM                                                      43700037
437100         UNTIL PS-END-OF-TPKSLIP                                  43710037
437200             PERFORM 7234-SET-TPKSLIP-INACTIVE                    43720037
437300             PERFORM 7236-INSERT-TPKSLIP                          43730037
437400             PERFORM 7232-SELECT-TPKSLIP                          43740037
437500                                                                  43750037
437600                                                                  43760037
437700     END-PERFORM.                                                 43770037
437800                                                                  43780037
437900     PERFORM 7238-CLOSE-TPKSLIP-CSR.                              43790037
438000                                                                  43800037
438100/                                                                 43810037
438200*----------------------------------------------------------------*43820037
438300* OPEN THE PACK SLIP CURSOR                                      *43830037
438400*----------------------------------------------------------------*43840037
438500                                                                  43850037
438600 7230-OPEN-TPKSLIP-CSR.                                           43860037
438700                                                                  43870037
438800     PERFORM                                                      43880037
438900         WITH TEST AFTER                                          43890037
439000         VARYING PV-RETRY-COUNTER                                 43900037
439100         FROM 1 BY 1                                              43910037
439200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43920037
439300            OR (SQLCODE = +100)                                   43930037
439400            OR (SQLCODE = +0))                                    43940037
439500                                                                  43950037
439600         EXEC SQL                                                 43960037
439700             OPEN TPKSLIP-CSR                                     43970037
439800         END-EXEC                                                 43980037
439900                                                                  43990037
440000         EVALUATE TRUE                                            44000037
440100             WHEN SQLCODE = +0                                    44010037
440200                  SET PS-NOT-END-OF-TPKSLIP                       44020037
440300                                   TO TRUE                        44030037
440400             WHEN SQLCODE = -904                                  44040037
440500             WHEN SQLCODE = -913                                  44050037
440600                  CONTINUE                                        44060037
440700                                                                  44070037
440800             WHEN SQLWARN0 NOT = SPACE                            44080037
440900             WHEN SQLCODE  NOT = +0                               44090037
441000                  MOVE '7230-OPEN-TPKSLIP-CSR'                    44100037
441100                                   TO DP013-PARAGRAPH             44110037
441200                  MOVE 'OPEN TPKSLIP-CSR CURSOR'                  44120037
441300                                   TO DP013-MESSAGE-TEXT (1)      44130037
441400                  MOVE PV-ABEND-MSG-KEYS                          44140037
441500                                   TO DP013-MESSAGE-TEXT (2)      44150037
441600                  MOVE SQLCA       TO DP013-SQLCA                 44160037
441700                  MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)    44170037
441800                  SET DP013-DB2-ABEND                             44180037
441900                                   TO TRUE                        44190037
442000                  PERFORM DP013-0000-PROCESS-ABEND                44200037
442100         END-EVALUATE                                             44210037
442200     END-PERFORM.                                                 44220037
442300                                                                  44230037
442400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44240037
442500         SQLCODE NOT = +0                                         44250037
442600         MOVE '7230-OPEN-TPKSLIP-CSR'                             44260037
442700                                   TO DP013-PARAGRAPH             44270037
442800         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              44280037
442900                                   TO DP013-MESSAGE-TEXT (1)      44290037
443000         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      44300037
443100         MOVE SQLCA                TO DP013-SQLCA                 44310037
443200         SET DP013-DB2-ABEND       TO TRUE                        44320037
443300         PERFORM DP013-0000-PROCESS-ABEND                         44330037
443400     END-IF.                                                      44340037
443500                                                                  44350037
443600/                                                                 44360037
443700*----------------------------------------------------------------*44370037
443800*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE PACK SLIP TABLE   *44380037
443900*  (TPKSLIP) FOR A SPECIFIED ROW.                                *44390037
444000*----------------------------------------------------------------*44400037
444100 7232-SELECT-TPKSLIP.                                             44410037
444200                                                                  44420037
444300     PERFORM                                                      44430037
444400         WITH TEST AFTER                                          44440037
444500         VARYING PV-RETRY-COUNTER                                 44450037
444600         FROM 1 BY 1                                              44460037
444700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44470037
444800             OR (SQLCODE = +100)                                  44480037
444900             OR (SQLCODE = +0))                                   44490037
445000                                                                  44500037
445100         EXEC SQL                                                 44510037
445200           FETCH TPKSLIP-CSR                                      44520037
445300            INTO :PKSLIP-PO-NBR                                   44530037
445400               , :PKSLIP-SEQ-NBR                                  44540037
445500               , :PKSLIP-CRE-TMST                                 44550037
445600               , :PKSLIP-VER-STAT-CDE                             44560037
445700               , :PKSLIP-OPER-UNT-ID                              44570037
445800               , :PKSLIP-FCLTY-ID                                 44580037
445900               , :PKSLIP-PKSL-NBR                                 44590037
446000               , :PKSLIP-STR-DEST-NBR                             44600037
446100               , :PKSLIP-REC-SEQ-NBR                              44610037
446200               , :PKSLIP-SHIPT-ID                                 44620037
446300               , :PKSLIP-BOL-NBR                                  44630037
446400               , :PKSLIP-PRO-NBR                                  44640037
446500               , :PKSLIP-PKSL-STAT-CDE                            44650037
446600               , :PKSLIP-CRE-UID                                  44660037
446700               , :PKSLIP-PO-VER-NBR                               44670037
446800               , :PKSLIP-CRE-SRC-CDE                              44680037
446900               , :PKSLIP-EXPTED-PKG-QTY                           44690037
447000               , :PKSLIP-OWNER-SCAC-ID                            44700037
447100               , :PKSLIP-ASN-NBR                                  44710037
447200               , :PKSLIP-VEND-SHIP-DTE                            44720037
447300               , :PKSLIP-CONTNR-ID                                44730037
447400               , :PKSLIP-ORIG-PKSL-SEQ-NBR                        44740037
447500         END-EXEC                                                 44750037
447600                                                                  44760037
447700         EVALUATE TRUE                                            44770037
447800             WHEN SQLCODE = +0                                    44780037
447900             WHEN SQLCODE = -904                                  44790037
448000             WHEN SQLCODE = -913                                  44800037
448100                  CONTINUE                                        44810037
448200                                                                  44820037
448300             WHEN SQLCODE = +100                                  44830037
448400                  SET PS-END-OF-TPKSLIP                           44840037
448500                                   TO TRUE                        44850037
448600                                                                  44860037
448700             WHEN SQLWARN0 NOT = SPACES                           44870037
448800             WHEN SQLCODE < +0                                    44880037
448900             WHEN SQLCODE > +0                                    44890037
449000                  MOVE '7232-SELECT-TPKSLIP'                      44900037
449100                                   TO DP013-PARAGRAPH             44910037
449200                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'     44920037
449300                                   TO DP013-MESSAGE-TEXT (1)      44930037
449400                  MOVE PV-ABEND-MSG-KEYS                          44940037
449500                                   TO DP013-MESSAGE-TEXT (2)      44950037
449600                  MOVE SQLCA       TO DP013-SQLCA                 44960037
449700                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    44970037
449800                  SET DP013-DB2-ABEND                             44980037
449900                      DP013-XCTL-DISPLAY-RESTART                  44990037
450000                                   TO TRUE                        45000037
450100                  PERFORM DP013-0000-PROCESS-ABEND                45010037
450200         END-EVALUATE                                             45020037
450300     END-PERFORM.                                                 45030037
450400                                                                  45040037
450500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45050037
450600         SQLCODE NOT = +0                                         45060037
450700         MOVE '7232-SELECT-TPKSLIP'                               45070037
450800                                   TO DP013-PARAGRAPH             45080037
450900         MOVE 'MAX RETRIES EXCEEDED ON SELECT PACK SLIP HEADER'   45090037
451000                                   TO DP013-MESSAGE-TEXT (1)      45100037
451100         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      45110037
451200         MOVE SQLCA                TO DP013-SQLCA                 45120037
451300         MOVE 'TPKSLIP '           TO DP013-DB2-TABLE-NAME (1)    45130037
451400         SET DP013-DB2-ABEND                                      45140037
451500             DP013-XCTL-DISPLAY-RESTART                           45150037
451600                                   TO TRUE                        45160037
451700         PERFORM DP013-0000-PROCESS-ABEND                         45170037
451800     END-IF.                                                      45180037
451900                                                                  45190037
452000/                                                                 45200037
452100*----------------------------------------------------------------*45210037
452200*  THIS PARAGRAPH WILL STATUS THE CURRENT ROW INACTIVE.  THIS    *45220037
452300*  IS BEING DONE FOR AUDITING PURPOSES.                          *45230037
452400*----------------------------------------------------------------*45240037
452500                                                                  45250037
452600 7234-SET-TPKSLIP-INACTIVE.                                       45260037
452700                                                                  45270037
452800     PERFORM                                                      45280037
452900         WITH TEST AFTER                                          45290037
453000         VARYING PV-RETRY-COUNTER                                 45300037
453100         FROM 1 BY 1                                              45310037
453200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45320037
453300             OR (SQLCODE = +0))                                   45330037
453400                                                                  45340037
453500         EXEC SQL                                                 45350037
453600              UPDATE TPKSLIP                                      45360037
453700                 SET VER_STAT_CDE   = :PC-I                       45370037
453800               WHERE PO_NBR         = :DK-PO-NBR                  45380037
453900                 AND SEQ_NBR        = :PKSLIP-SEQ-NBR             45390037
454000                 AND VER_STAT_CDE   = :PC-A                       45400037
454100         END-EXEC                                                 45410037
454200                                                                  45420037
454300         EVALUATE TRUE                                            45430037
454400             WHEN SQLCODE = +0                                    45440037
454500             WHEN SQLCODE = -904                                  45450037
454600             WHEN SQLCODE = -913                                  45460037
454700                  CONTINUE                                        45470037
454800                                                                  45480037
454900             WHEN SQLWARN0 NOT = SPACES                           45490037
455000             WHEN SQLCODE < +0                                    45500037
455100             WHEN SQLCODE > +0                                    45510037
455200                  MOVE '7234-SET-TPKSLIP-INACTIVE'                45520037
455300                                   TO DP013-PARAGRAPH             45530037
455400                  MOVE 'UNSUCCESSFUL UPDATE OF TPKSLIP'           45540037
455500                                   TO DP013-MESSAGE-TEXT (1)      45550037
455600                  MOVE PV-ABEND-MSG-KEYS                          45560037
455700                                   TO DP013-MESSAGE-TEXT (2)      45570037
455800                  MOVE SQLCA       TO DP013-SQLCA                 45580037
455900                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    45590037
456000                  SET DP013-DB2-ABEND                             45600037
456100                      DP013-XCTL-DISPLAY-RESTART                  45610037
456200                                   TO TRUE                        45620037
456300                  PERFORM DP013-0000-PROCESS-ABEND                45630037
456400         END-EVALUATE                                             45640037
456500     END-PERFORM.                                                 45650037
456600                                                                  45660037
456700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45670037
456800         SQLCODE NOT = +0                                         45680037
456900         MOVE '7234-SET-TPKSLIP-INACTIVE'                         45690037
457000                                   TO DP013-PARAGRAPH             45700037
457100         MOVE 'MAX RETRIES EXCEEDED FOR UPDATE ON TPKSLIP'        45710037
457200                                   TO DP013-MESSAGE-TEXT (1)      45720037
457300         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      45730037
457400         MOVE SQLCA                TO DP013-SQLCA                 45740037
457500         MOVE 'TPKSLIP '           TO DP013-DB2-TABLE-NAME (1)    45750037
457600         SET DP013-DB2-ABEND                                      45760037
457700             DP013-XCTL-DISPLAY-RESTART                           45770037
457800                                   TO TRUE                        45780037
457900         PERFORM DP013-0000-PROCESS-ABEND                         45790037
458000     END-IF.                                                      45800037
458100                                                                  45810037
458200/                                                                 45820037
458300*----------------------------------------------------------------*45830037
458400*  THIS PARAGRAPH WILL INSERT A NEW ROW INTO THE PACK SLIP       *45840037
458500*  TABLE (TPKSLIP).  IT WILL BE AN 'I'NACTIVE VER-STATUS WITH    *45850037
458600*  A STATUS-CDE OF 'DE'LETE                                      *45860037
458700*----------------------------------------------------------------*45870037
458800                                                                  45880037
458900 7236-INSERT-TPKSLIP.                                             45890037
459000                                                                  45900037
459100     MOVE ZEROES             TO PKSLIP-REC-SEQ-NBR.               45910037
459200                                                                  45920037
459300     PERFORM                                                      45930037
459400         WITH TEST AFTER                                          45940037
459500         VARYING PV-RETRY-COUNTER                                 45950037
459600         FROM 1 BY 1                                              45960037
459700         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                45970037
459800            OR (SQLCODE = +0)                                     45980037
459900                                                                  45990037
460000         EXEC SQL                                                 46000037
460100              INSERT INTO TPKSLIP                                 46010037
460200                     (PO_NBR,                                     46020037
460300                      SEQ_NBR,                                    46030037
460400                      CRE_TMST,                                   46040037
460500                      VER_STAT_CDE,                               46050037
460600                      OPER_UNT_ID,                                46060037
460700                      FCLTY_ID,                                   46070037
460800                      PKSL_NBR,                                   46080037
460900                      STR_DEST_NBR,                               46090037
461000                      REC_SEQ_NBR,                                46100037
461100                      SHIPT_ID,                                   46110037
461200                      BOL_NBR,                                    46120037
461300                      PRO_NBR,                                    46130037
461400                      PKSL_STAT_CDE,                              46140037
461500                      CRE_UID,                                    46150037
461600                      PO_VER_NBR,                                 46160037
461700                      CRE_SRC_CDE,                                46170037
461800                      EXPTED_PKG_QTY,                             46180037
461900                      OWNER_SCAC_ID,                              46190037
462000                      ASN_NBR,                                    46200037
462100                      VEND_SHIP_DTE,                              46210037
462200                      CONTNR_ID,                                  46220037
462300                      ORIG_PKSL_SEQ_NBR)                          46230037
462400              VALUES (:PKSLIP-PO-NBR,                             46240037
462500                      :PKSLIP-SEQ-NBR,                            46250037
462600                       CURRENT TIMESTAMP,                         46260037
462700                      :PC-A,                                      46270037
462800                      :PKSLIP-OPER-UNT-ID,                        46280037
462900                      :PKSLIP-FCLTY-ID,                           46290037
463000                      :PKSLIP-PKSL-NBR,                           46300037
463100                      :PKSLIP-STR-DEST-NBR,                       46310037
463200                      :PKSLIP-REC-SEQ-NBR,                        46320037
463300                      :PKSLIP-SHIPT-ID,                           46330037
463400                      :PKSLIP-BOL-NBR,                            46340037
463500                      :PKSLIP-PRO-NBR,                            46350037
463600                      :PC-IN,                                     46360037
463700                      :DP020-USERID,                              46370037
463800                      :PKSLIP-PO-VER-NBR,                         46380037
463900                      :PKSLIP-CRE-SRC-CDE,                        46390037
464000                      :PKSLIP-EXPTED-PKG-QTY,                     46400037
464100                      :PKSLIP-OWNER-SCAC-ID,                      46410037
464200                      :PKSLIP-ASN-NBR,                            46420037
464300                      :PKSLIP-VEND-SHIP-DTE,                      46430037
464400                      :PKSLIP-CONTNR-ID,                          46440037
464500                      :PKSLIP-ORIG-PKSL-SEQ-NBR)                  46450037
464600         END-EXEC                                                 46460037
464700                                                                  46470037
464800         EVALUATE TRUE                                            46480037
464900             WHEN SQLCODE = +0                                    46490037
465000             WHEN SQLCODE = -904                                  46500037
465100             WHEN SQLCODE = -913                                  46510037
465200                  CONTINUE                                        46520037
465300                                                                  46530037
465400             WHEN SQLWARN0 NOT = SPACES                           46540037
465500             WHEN SQLCODE < +0                                    46550037
465600             WHEN SQLCODE > +0                                    46560037
465700                  MOVE '7236-INSERT-TPKSLIP'                      46570037
465800                                   TO DP013-PARAGRAPH             46580037
465900                  MOVE 'UNSUCCESSFUL INSERT FOR TPKSLIP'          46590037
466000                                   TO DP013-MESSAGE-TEXT (1)      46600037
466100                  MOVE PV-ABEND-MSG-KEYS                          46610037
466200                                   TO DP013-MESSAGE-TEXT (2)      46620037
466300                  MOVE SQLCA       TO DP013-SQLCA                 46630037
466400                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    46640037
466500                  SET DP013-DB2-ABEND                             46650037
466600                      DP013-XCTL-DISPLAY-RESTART                  46660037
466700                                   TO TRUE                        46670037
466800                  PERFORM DP013-0000-PROCESS-ABEND                46680037
466900         END-EVALUATE                                             46690037
467000     END-PERFORM.                                                 46700037
467100                                                                  46710037
467200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    46720037
467300         SQLCODE NOT = +0                                         46730037
467400         MOVE '7236-INSERT-TPKSLIP'                               46740037
467500                                   TO DP013-PARAGRAPH             46750037
467600         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TPKSLIP'        46760037
467700                                   TO DP013-MESSAGE-TEXT (1)      46770037
467800         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      46780037
467900         MOVE SQLCA                TO DP013-SQLCA                 46790037
468000         MOVE 'TPKSLIP '           TO DP013-DB2-TABLE-NAME (1)    46800037
468100         SET DP013-XCTL-DISPLAY-RESTART                           46810037
468200             DP013-DB2-ABEND       TO TRUE                        46820037
468300         PERFORM DP013-0000-PROCESS-ABEND                         46830037
468400     END-IF.                                                      46840037
468500                                                                  46850037
468600/                                                                 46860037
468700*----------------------------------------------------------------*46870037
468800* CLOSE THE PACK SLIP CURSOR                                     *46880037
468900*----------------------------------------------------------------*46890037
469000                                                                  46900037
469100 7238-CLOSE-TPKSLIP-CSR.                                          46910037
469200                                                                  46920037
469300     EXEC SQL                                                     46930037
469400         CLOSE TPKSLIP-CSR                                        46940037
469500     END-EXEC.                                                    46950037
469600                                                                  46960037
469700     EVALUATE TRUE                                                46970037
469800         WHEN SQLCODE = +0                                        46980037
469900              CONTINUE                                            46990037
470000                                                                  47000037
470100         WHEN SQLWARN0 NOT = SPACE                                47010037
470200         WHEN SQLCODE  NOT = +0                                   47020037
470300              MOVE '7238-CLOSE-TPKSLIP-CSR'                       47030037
470400                                   TO DP013-PARAGRAPH             47040037
470500              MOVE 'CLOSE TPKSLIP-CSR CURSOR'                     47050037
470600                                   TO DP013-MESSAGE-TEXT (1)      47060037
470700              MOVE PV-ABEND-MSG-KEYS                              47070037
470800                                   TO DP013-MESSAGE-TEXT (2)      47080037
470900              MOVE SQLCA           TO DP013-SQLCA                 47090037
471000              MOVE 'TPKSLIP'       TO DP013-DB2-TABLE-NAME (1)    47100037
471100              SET DP013-DB2-ABEND  TO TRUE                        47110037
471200              PERFORM DP013-0000-PROCESS-ABEND                    47120037
471300     END-EVALUATE.                                                47130037
471400                                                                  47140037
471500/                                                                 47150037
471600*----------------------------------------------------------------*47160037
471700*    THIS PARAGRAPH CONTROLS THE DELETION PROCESSING FOR THE     *47170037
471800*    RECEIVER TABLES, TRECEIV, TRECDIS AND TRECITM.              *47180037
471900*----------------------------------------------------------------*47190037
472000 7300-DELETE-RECEIPTS.                                            47200037
472100                                                                  47210037
472200     PERFORM 7310-DELETE-TRECDIS.                                 47220037
472300     PERFORM 7390-DELETE-ODD-UNIT.                                47230037
472400                                                                  47240037
472500     PERFORM 7320-OPEN-TRECITM-CSR.                               47250037
472600     PERFORM 7330-SELECT-TRECITM.                                 47260037
472700                                                                  47270037
472800     PERFORM                                                      47280037
472900         UNTIL PS-END-OF-TRECITM                                  47290037
473000             INITIALIZE RC031-FIELDS                              47300037
473100             MOVE 'B'                     TO RC031-AUD-TYP-CDE    47310037
473200             MOVE 'I'                     TO RC031-TABLE-TO-AUDIT 47320037
473300             MOVE 'D'                     TO RC031-AUD-FUNC-CDE   47330037
473400             MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID     47340037
473500             PERFORM 7340-LINK-AUDIT-MODULE                       47350037
473600             INITIALIZE RC031-FIELDS                              47360037
473700             MOVE 'A'                     TO RC031-AUD-TYP-CDE    47370037
473800             MOVE 'I'                     TO RC031-TABLE-TO-AUDIT 47380037
473900             MOVE 'D'                     TO RC031-AUD-FUNC-CDE   47390037
474000             MOVE 'DE'                    TO RC031-STATUS-CDE     47400037
474100             MOVE DP020-USERID            TO RC031-UPD-UID        47410037
474200             MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID     47420037
474300             MOVE PV-CURRENT-TIMESTAMP    TO RC031-UPD-TMST       47430037
474400             PERFORM 7340-LINK-AUDIT-MODULE                       47440037
474500             PERFORM 7350-DELETE-TRECITM                          47450037
474600             INITIALIZE RC071-FIELDS                              47460061
474700             MOVE '0A'                  TO RC071-DC-FUNCTION-CODE 47470061
474800             PERFORM 9300-CALL-PO-RCVR-TRKING-MOD                 47480061
474900             PERFORM 7330-SELECT-TRECITM                          47490037
475000     END-PERFORM.                                                 47500037
475100                                                                  47510037
475200     PERFORM 7360-CLOSE-TRECITM-CSR.                              47520037
475300                                                                  47530037
475400     PERFORM 7370-SELECT-TRECEIV.                                 47540037
475500     INITIALIZE RC031-FIELDS.                                     47550037
475600     MOVE 'B'                     TO RC031-AUD-TYP-CDE.           47560037
475700     MOVE 'V'                     TO RC031-TABLE-TO-AUDIT.        47570037
475800     MOVE 'U'                     TO RC031-AUD-FUNC-CDE           47580037
475900     MOVE 'DE'                    TO RC031-STATUS-CDE.            47590037
476000     MOVE DP020-USERID            TO RC031-UPD-UID.               47600037
476100     MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID.            47610037
476200     MOVE PV-CURRENT-TIMESTAMP    TO RC031-UPD-TMST.              47620037
476300     PERFORM 7340-LINK-AUDIT-MODULE.                              47630037
476400     PERFORM 7380-UPDATE-TRECEIV.                                 47640037
476500     INITIALIZE RC071-FIELDS.                                     47650061
476600     MOVE '0B'                      TO RC071-DC-FUNCTION-CODE.    47660061
476700     PERFORM 9300-CALL-PO-RCVR-TRKING-MOD.                        47670061
476800*IR-229                                                           47680037
476900     PERFORM 7395-DELETE-TROUBLE.                                 47690037
477000*IR-229                                                           47700037
477100     PERFORM 7396-CLEANUP-VIOLATIONS.                             47710037
477200/                                                                 47720037
477300*----------------------------------------------------------------*47730037
477400*    DUE TO THE SIZE OF THIS TABLE, A PHYSICAL DELETE OF THE     *47740037
477500*    ROW IS DONE RATHER THAN MAKING THE ROW 'I'NACTIVE.          *47750037
477600*----------------------------------------------------------------*47760037
477700                                                                  47770037
477800 7310-DELETE-TRECDIS.                                             47780037
477900                                                                  47790037
478000     PERFORM                                                      47800037
478100         WITH TEST AFTER                                          47810037
478200         VARYING PV-RETRY-COUNTER                                 47820037
478300         FROM 1 BY 1                                              47830037
478400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47840037
478500             OR (SQLCODE = +100)                                  47850037
478600             OR (SQLCODE = +0))                                   47860037
478700                                                                  47870037
478800         EXEC SQL                                                 47880037
478900              DELETE                                              47890037
479000                FROM TRECDIS                                      47900037
479100               WHERE ORD_NBR      = :DK-PO-NBR                    47910037
479200                 AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR               47920037
479300         END-EXEC                                                 47930037
479400                                                                  47940037
479500         EVALUATE TRUE                                            47950037
479600             WHEN SQLCODE = +0                                    47960037
479700             WHEN SQLCODE = +100                                  47970037
479800             WHEN SQLCODE = -904                                  47980037
479900             WHEN SQLCODE = -913                                  47990037
480000                  CONTINUE                                        48000037
480100                                                                  48010037
480200             WHEN SQLWARN0 NOT = SPACES                           48020037
480300             WHEN SQLCODE < +0                                    48030037
480400             WHEN SQLCODE > +0                                    48040037
480500                  MOVE '7310-DELETE-TRECDIS'                      48050037
480600                                   TO DP013-PARAGRAPH             48060037
480700                  MOVE 'UNSUCCESSFUL DELETE ON TRECDIS'           48070037
480800                                   TO DP013-MESSAGE-TEXT (1)      48080037
480900                  MOVE SQLCA       TO DP013-SQLCA                 48090037
481000                  MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)    48100037
481100                  SET DP013-DB2-ABEND                             48110037
481200                      DP013-XCTL-DISPLAY-RESTART                  48120037
481300                                   TO TRUE                        48130037
481400                  PERFORM DP013-0000-PROCESS-ABEND                48140037
481500         END-EVALUATE                                             48150037
481600     END-PERFORM.                                                 48160037
481700                                                                  48170037
481800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    48180037
481900         SQLCODE NOT = +0                                         48190037
482000         MOVE '7310-DELETE-TRECDIS'                               48200037
482100                                   TO DP013-PARAGRAPH             48210037
482200         MOVE 'MAX RETRIES EXCEEDED ON DELETE ON TRECDIS'         48220037
482300                                   TO DP013-MESSAGE-TEXT (1)      48230037
482400         MOVE SQLCA                TO DP013-SQLCA                 48240037
482500         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (1)    48250037
482600         SET DP013-DB2-ABEND                                      48260037
482700             DP013-XCTL-DISPLAY-RESTART                           48270037
482800                                   TO TRUE                        48280037
482900         PERFORM DP013-0000-PROCESS-ABEND                         48290037
483000     END-IF.                                                      48300037
483100                                                                  48310037
483200/                                                                 48320037
483300*----------------------------------------------------------------*48330037
483400* OPEN THE RECEIPT ITEM CURSOR                                   *48340037
483500*----------------------------------------------------------------*48350037
483600                                                                  48360037
483700 7320-OPEN-TRECITM-CSR.                                           48370037
483800                                                                  48380037
483900     PERFORM                                                      48390037
484000         WITH TEST AFTER                                          48400037
484100         VARYING PV-RETRY-COUNTER                                 48410037
484200         FROM 1 BY 1                                              48420037
484300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48430037
484400            OR (SQLCODE = +100)                                   48440037
484500            OR (SQLCODE = +0))                                    48450037
484600                                                                  48460037
484700         EXEC SQL                                                 48470037
484800             OPEN TRECITM-CSR                                     48480037
484900         END-EXEC                                                 48490037
485000                                                                  48500037
485100         EVALUATE TRUE                                            48510037
485200             WHEN SQLCODE = +0                                    48520037
485300                  SET PS-NOT-END-OF-TRECITM                       48530037
485400                                   TO TRUE                        48540037
485500             WHEN SQLCODE = -904                                  48550037
485600             WHEN SQLCODE = -913                                  48560037
485700                  CONTINUE                                        48570037
485800                                                                  48580037
485900             WHEN SQLWARN0 NOT = SPACE                            48590037
486000             WHEN SQLCODE  NOT = +0                               48600037
486100                  MOVE '7320-OPEN-TRECITM-CSR'                    48610037
486200                                   TO DP013-PARAGRAPH             48620037
486300                  MOVE 'OPEN TRECITM-CSR CURSOR'                  48630037
486400                                   TO DP013-MESSAGE-TEXT (1)      48640037
486500                  MOVE PV-ABEND-MSG-KEYS                          48650037
486600                                   TO DP013-MESSAGE-TEXT (2)      48660037
486700                  MOVE SQLCA       TO DP013-SQLCA                 48670037
486800                  MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)    48680037
486900                  SET DP013-DB2-ABEND                             48690037
487000                                   TO TRUE                        48700037
487100                  PERFORM DP013-0000-PROCESS-ABEND                48710037
487200         END-EVALUATE                                             48720037
487300     END-PERFORM.                                                 48730037
487400                                                                  48740037
487500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    48750037
487600         SQLCODE NOT = +0                                         48760037
487700         MOVE '7320-OPEN-TRECITM-CSR'                             48770037
487800                                   TO DP013-PARAGRAPH             48780037
487900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              48790037
488000                                   TO DP013-MESSAGE-TEXT (1)      48800037
488100         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      48810037
488200         MOVE SQLCA                TO DP013-SQLCA                 48820037
488300         SET DP013-DB2-ABEND       TO TRUE                        48830037
488400         PERFORM DP013-0000-PROCESS-ABEND                         48840037
488500     END-IF.                                                      48850037
488600                                                                  48860037
488700/                                                                 48870037
488800*----------------------------------------------------------------*48880037
488900*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE RECEIPT ITEM      *48890037
489000*  TABLE (TRECITM) FOR A SPECIFIED ROW.                          *48900037
489100*----------------------------------------------------------------*48910037
489200 7330-SELECT-TRECITM.                                             48920037
489300                                                                  48930037
489400     PERFORM                                                      48940037
489500         WITH TEST AFTER                                          48950037
489600         VARYING PV-RETRY-COUNTER                                 48960037
489700         FROM 1 BY 1                                              48970037
489800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48980037
489900            OR  (SQLCODE = +100)                                  48990037
490000            OR  (SQLCODE = +0))                                   49000037
490100                                                                  49010037
490200         EXEC SQL                                                 49020037
490300           FETCH TRECITM-CSR                                      49030037
490400            INTO :RECITM-ORD-NBR                                  49040037
490500               , :RECITM-ORD-LNE-NBR                              49050037
490600               , :RECITM-REC-SEQ-NBR                              49060037
490700               , :RECITM-OPER-UNT-ID                              49070037
490800               , :RECITM-FCLTY-ID                                 49080037
490900               , :RECITM-CRE-TMST                                 49090037
491000               , :RECITM-CRE-UID                                  49100037
491100               , :RECITM-PO-VER-NBR                               49110037
491200               , :RECITM-ITM-NBR                                  49120037
491300               , :RECITM-PRE-TKT-IND                              49130037
491400               , :RECITM-TKT-FMT-ID                               49140037
491500               , :RECITM-RTV-IND                                  49150037
491600               , :RECITM-STATUS-CDE                               49160037
491700               , :RECITM-VER-STATUS-CDE                           49170037
491800               , :RECITM-PKSL-ITM-QTY                             49180037
491900               , :RECITM-DTL-CK-ITM-QTY                           49190037
492000               , :RECITM-INNR-PACK-QTY                            49200037
492100               , :RECITM-CASE-PACK-QTY                            49210037
492200               , :RECITM-RTV-QTY                                  49220037
492300               , :RECITM-EXPTED-CART-CNT                          49230037
492400               , :RECITM-ACTL-CART-CNT                            49240037
492500               , :RECITM-MKING-APRON-TMST                         49250037
492600               , :RECITM-UNT-COST-AMT                             49260037
492700               , :RECITM-COLOR-DESC                               49270037
492800               , :RECITM-SIZE-DESC                                49280037
492900               , :RECITM-VEND-STYL-NAME                           49290037
493000               , :RECITM-VEND-DESC                                49300037
493100               , :RECITM-VERFYD-TMST                              49310037
493200               , :RECITM-PKSL-NBR                                 49320037
493300               , :RECITM-REC-INV-LNE-NBR                          49330037
493400               , :RECITM-DMG-ITM-QTY                              49340037
493500               , :RECITM-UPD-TMST                                 49350037
493600               , :RECITM-UPD-UID                                  49360037
493700               , :RECITM-UPD-PGM-ID                               49370037
493800               , :RECITM-RCPT-DISTR-UPD-CDE                       49380037
493900               , :RECITM-VRFD-USR-ID                              49390037
494000               , :RECITM-LAST-TRSCP-TMST                          49400037
494100               , :RECITM-LAST-TRSCP-USR-ID                        49410037
494200               ,:RECITM-PREPK-ID                                  49420062
494300               , :PV-CURRENT-TIMESTAMP                            49430037
494400         END-EXEC                                                 49440037
494500                                                                  49450037
494600         EVALUATE TRUE                                            49460037
494700             WHEN SQLCODE = ZERO                                  49470037
494800             WHEN SQLCODE = -904                                  49480037
494900             WHEN SQLCODE = -913                                  49490037
495000                  CONTINUE                                        49500037
495100                                                                  49510037
495200             WHEN SQLCODE = +100                                  49520037
495300                  SET PS-END-OF-TRECITM                           49530037
495400                                   TO TRUE                        49540037
495500             WHEN SQLWARN0 NOT = SPACES                           49550037
495600             WHEN SQLCODE  NOT = ZERO                             49560037
495700                  MOVE '7330-SELECT-TRECITM'                      49570037
495800                                   TO DP013-PARAGRAPH             49580037
495900                  MOVE 'UNSUCCESSFUL SELECT OF TRECITM'           49590037
496000                                   TO DP013-MESSAGE-TEXT (1)      49600037
496100                  MOVE PV-ABEND-MSG-KEYS                          49610037
496200                                   TO DP013-MESSAGE-TEXT (2)      49620037
496300                  MOVE SQLCA       TO DP013-SQLCA                 49630037
496400                  MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)    49640037
496500                  SET DP013-DB2-ABEND                             49650037
496600                      DP013-XCTL-DISPLAY-RESTART                  49660037
496700                                   TO TRUE                        49670037
496800                  PERFORM DP013-0000-PROCESS-ABEND                49680037
496900         END-EVALUATE                                             49690037
497000     END-PERFORM.                                                 49700037
497100                                                                  49710037
497200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     49720037
497300         SQLCODE NOT = +0                                         49730037
497400         MOVE '7330-SELECT-TRECITM'                               49740037
497500                                   TO DP013-PARAGRAPH             49750037
497600         MOVE 'MAX RETRIES EXCEEDED ON SELECT OF TRECITM'         49760037
497700                                   TO DP013-MESSAGE-TEXT (1)      49770037
497800         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      49780037
497900         MOVE SQLCA                TO DP013-SQLCA                 49790037
498000         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    49800037
498100         SET DP013-XCTL-DISPLAY-RESTART                           49810037
498200             DP013-DB2-ABEND       TO TRUE                        49820037
498300                                                                  49830037
498400         PERFORM DP013-0000-PROCESS-ABEND                         49840037
498500     END-IF.                                                      49850037
498600                                                                  49860037
498700/                                                                 49870037
498800*----------------------------------------------------------------*49880037
498900*  THIS PARAGRAPH WILL LINK TO THE AUDIT CREATE MODULE (RCKCS290)*49890037
499000*----------------------------------------------------------------*49900037
499100                                                                  49910037
499200 7340-LINK-AUDIT-MODULE.                                          49920037
499300     MOVE DK-OPER-UNT-ID     TO RC031-OPER-UNT-ID.                49930037
499400     MOVE DK-FCLTY-ID        TO RC031-FCLTY-ID.                   49940037
499500     MOVE DK-PO-NBR          TO RC031-PO-NBR.                     49950037
499600     MOVE DK-REC-SEQ-NBR     TO RC031-REC-SEQ-NBR.                49960037
499700     IF RC031-AUDIT-TRECITM                                       49970037
499800         MOVE RECITM-ORD-LNE-NBR TO RC031-PO-LNE-NBR              49980037
499900     END-IF.                                                      49990037
500000                                                                  50000037
500100     EXEC CICS                                                    50010037
500200          LINK PROGRAM  (PC-AUDIT-RTN)                            50020037
500300          COMMAREA (RC031-FIELDS)                                 50030037
500400          LENGTH   (PC-AUDIT-RTN-LENGTH)                          50040037
500500     END-EXEC.                                                    50050037
500600                                                                  50060037
500700     EVALUATE TRUE                                                50070037
500800         WHEN RC031-CALL-SUCCESSFUL                               50080037
500900             CONTINUE                                             50090037
501000         WHEN OTHER                                               50100037
501100             MOVE '7340-LINK-AUDIT-MODULE'                        50110037
501200                                 TO DP013-PARAGRAPH               50120037
501300             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                50130037
501400                                 TO DP013-MESSAGE-TEXT (1)        50140037
501500             MOVE RC031-RETURN-DESC                               50150037
501600                                 TO DP013-MESSAGE-TEXT (2)        50160037
501700             MOVE RC031-SQLCA    TO DP013-SQLCA                   50170037
501800             SET DP013-DB2-ABEND                                  50180037
501900                 DP013-XCTL-DISPLAY-RESTART                       50190037
502000                                 TO TRUE                          50200037
502100             PERFORM DP013-0000-PROCESS-ABEND                     50210037
502200     END-EVALUATE.                                                50220037
502300/                                                                 50230037
502400*----------------------------------------------------------------*50240037
502500*  THIS PARAGRAPH WILL DELETE A ROW FROM THE RECEIPT ITEM        *50250037
502600*  TABLE (TRECITM).                                              *50260037
502700*----------------------------------------------------------------*50270037
502800                                                                  50280037
502900 7350-DELETE-TRECITM.                                             50290037
503000                                                                  50300037
503100     PERFORM                                                      50310037
503200         WITH TEST AFTER                                          50320037
503300         VARYING PV-RETRY-COUNTER                                 50330037
503400         FROM 1 BY 1                                              50340037
503500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50350037
503600            OR  (SQLCODE = +0)                                    50360037
503700            OR  (SQLCODE = +100))                                 50370037
503800                                                                  50380037
503900         EXEC SQL                                                 50390037
504000           DELETE                                                 50400037
504100            FROM  TRECITM                                         50410037
504200            WHERE ORD_NBR        = :DK-PO-NBR                     50420037
504300              AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            50430037
504400              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                50440037
504500              AND VER_STATUS_CDE = :PC-A                          50450037
504600         END-EXEC                                                 50460037
504700                                                                  50470037
504800         EVALUATE TRUE                                            50480037
504900             WHEN SQLCODE = ZERO                                  50490037
505000             WHEN SQLCODE = +100                                  50500037
505100             WHEN SQLCODE = -904                                  50510037
505200             WHEN SQLCODE = -913                                  50520037
505300                  CONTINUE                                        50530037
505400                                                                  50540037
505500             WHEN SQLWARN0 NOT = SPACES                           50550037
505600             WHEN SQLCODE  NOT = ZERO                             50560037
505700                  MOVE '7350-DELETE-TRECITM'                      50570037
505800                                   TO DP013-PARAGRAPH             50580037
505900                  MOVE 'UNSUCCESSFUL DELETE OF TRECITM'           50590037
506000                                   TO DP013-MESSAGE-TEXT (1)      50600037
506100                  MOVE PV-ABEND-MSG-KEYS                          50610037
506200                                   TO DP013-MESSAGE-TEXT (2)      50620037
506300                  MOVE SQLCA       TO DP013-SQLCA                 50630037
506400                  MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)    50640037
506500                  SET DP013-DB2-ABEND                             50650037
506600                      DP013-XCTL-DISPLAY-RESTART                  50660037
506700                                   TO TRUE                        50670037
506800                  PERFORM DP013-0000-PROCESS-ABEND                50680037
506900         END-EVALUATE                                             50690037
507000     END-PERFORM.                                                 50700037
507100                                                                  50710037
507200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     50720037
507300         SQLCODE NOT = +0                                         50730037
507400         MOVE '7350-DELETE-TRECITM'                               50740037
507500                                   TO DP013-PARAGRAPH             50750037
507600         MOVE 'MAX RETRIES EXCEEDED ON DELETE OF TRECITM'         50760037
507700                                   TO DP013-MESSAGE-TEXT (1)      50770037
507800         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      50780037
507900         MOVE SQLCA                TO DP013-SQLCA                 50790037
508000         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    50800037
508100         SET DP013-XCTL-DISPLAY-RESTART                           50810037
508200             DP013-DB2-ABEND       TO TRUE                        50820037
508300                                                                  50830037
508400         PERFORM DP013-0000-PROCESS-ABEND                         50840037
508500     END-IF.                                                      50850037
508600                                                                  50860037
508700/                                                                 50870037
508800/                                                                 50880037
508900*----------------------------------------------------------------*50890037
509000* CLOSE THE RECEIPT ITEM CURSOR                                  *50900037
509100*----------------------------------------------------------------*50910037
509200                                                                  50920037
509300 7360-CLOSE-TRECITM-CSR.                                          50930037
509400                                                                  50940037
509500     EXEC SQL                                                     50950037
509600         CLOSE TRECITM-CSR                                        50960037
509700     END-EXEC.                                                    50970037
509800                                                                  50980037
509900     EVALUATE TRUE                                                50990037
510000         WHEN SQLCODE = +0                                        51000037
510100              CONTINUE                                            51010037
510200                                                                  51020037
510300         WHEN SQLWARN0 NOT = SPACE                                51030037
510400         WHEN SQLCODE  NOT = +0                                   51040037
510500              MOVE '7360-CLOSE-TRECITM-CSR'                       51050037
510600                                   TO DP013-PARAGRAPH             51060037
510700              MOVE 'CLOSE TRECITM-CSR CURSOR'                     51070037
510800                                   TO DP013-MESSAGE-TEXT (1)      51080037
510900              MOVE PV-ABEND-MSG-KEYS                              51090037
511000                                   TO DP013-MESSAGE-TEXT (2)      51100037
511100              MOVE SQLCA           TO DP013-SQLCA                 51110037
511200              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    51120037
511300              SET DP013-DB2-ABEND  TO TRUE                        51130037
511400              PERFORM DP013-0000-PROCESS-ABEND                    51140037
511500     END-EVALUATE.                                                51150037
511600                                                                  51160037
511700/                                                                 51170037
511800*----------------------------------------------------------------*51180037
511900*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE RECEIVER TABLE    *51190037
512000*  (TRECEIV) FOR A SPECIFIED ROW.                                *51200037
512100*----------------------------------------------------------------*51210037
512200 7370-SELECT-TRECEIV.                                             51220037
512300                                                                  51230037
512400     PERFORM                                                      51240037
512500         WITH TEST AFTER                                          51250037
512600         VARYING PV-RETRY-COUNTER                                 51260037
512700         FROM 1 BY 1                                              51270037
512800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               51280037
512900             OR (SQLCODE = +0)                                    51290037
513000             OR (SQLCODE = +100))                                 51300037
513100                                                                  51310037
513200         EXEC SQL                                                 51320037
513300              SELECT ORD_NBR                                      51330037
513400                    ,REC_SEQ_NBR                                  51340037
513500                    ,CRE_TMST                                     51350037
513600                    ,CRE_UID                                      51360037
513700                    ,PO_VER_NBR                                   51370037
513800                    ,OPER_UNT_ID                                  51380037
513900                    ,FCLTY_ID                                     51390037
514000                    ,STATUS_CDE                                   51400037
514100                    ,SYST_CRE_CDE                                 51410037
514200                    ,REC_TYP_CDE                                  51420037
514300                    ,VER_STATUS_CDE                               51430037
514400                    ,PACK_BY_ST_IND                               51440037
514500                    ,REC_TMST                                     51450037
514600                    ,EXPTED_CART_CNT                              51460037
514700                    ,ACTL_CART_CNT                                51470037
514800                    ,EXPTED_ITM_QTY                               51480037
514900                    ,ACTL_ITM_QTY                                 51490037
515000                    ,RCVR_NBR                                     51500037
515100                    ,ML_POST_TMST                                 51510037
515200                    ,FS_POST_TMST                                 51520037
515300                    ,PRE_TKT_IND                                  51530037
515400                    ,AD_INFO_DESC                                 51540037
515500                    ,IN_TRBL_TMST                                 51550037
515600                    ,IN_TRBL_MIN_CNT                              51560037
515700                    ,IN_TRBL_HOUR_CNT                             51570037
515800                    ,VERFYD_TMST                                  51580037
515900                    ,RCVG_CLERK_INIT_ID                           51590037
516000                    ,REFER_BACK_SEQ_NBR                           51600037
516100                    ,AP_PRC_CDE                                   51610037
516200                    ,AP_PRC_DTE                                   51620037
516300                    ,MIS_DIRECT_IND                               51630037
516400                    ,IMPRT_IND                                    51640037
516500                    ,CRE_OPER_UNT_ID                              51650037
516600                    ,CRE_FCLTY_ID                                 51660037
516700                    ,CURR_OPER_UNT_ID                             51670037
516800                    ,CURR_FCLTY_ID                                51680037
516900                    ,APRON_LOC_DESC                               51690037
517000                    ,CURRENT TIMESTAMP                            51700037
517100                INTO :RECEIV-ORD-NBR                              51710037
517200                    ,:RECEIV-REC-SEQ-NBR                          51720037
517300                    ,:RECEIV-CRE-TMST                             51730037
517400                    ,:RECEIV-CRE-UID                              51740037
517500                    ,:RECEIV-PO-VER-NBR                           51750037
517600                    ,:RECEIV-OPER-UNT-ID                          51760037
517700                    ,:RECEIV-FCLTY-ID                             51770037
517800                    ,:RECEIV-STATUS-CDE                           51780037
517900                    ,:RECEIV-SYST-CRE-CDE                         51790037
518000                    ,:RECEIV-REC-TYP-CDE                          51800037
518100                    ,:RECEIV-VER-STATUS-CDE                       51810037
518200                    ,:RECEIV-PACK-BY-ST-IND                       51820037
518300                    ,:RECEIV-REC-TMST                             51830037
518400                    ,:RECEIV-EXPTED-CART-CNT                      51840037
518500                    ,:RECEIV-ACTL-CART-CNT                        51850037
518600                    ,:RECEIV-EXPTED-ITM-QTY                       51860037
518700                    ,:RECEIV-ACTL-ITM-QTY                         51870037
518800                    ,:RECEIV-RCVR-NBR                             51880037
518900                    ,:RECEIV-ML-POST-TMST                         51890037
519000                    ,:RECEIV-FS-POST-TMST                         51900037
519100                    ,:RECEIV-PRE-TKT-IND                          51910037
519200                    ,:RECEIV-AD-INFO-DESC                         51920037
519300                    ,:RECEIV-IN-TRBL-TMST                         51930037
519400                    ,:RECEIV-IN-TRBL-MIN-CNT                      51940037
519500                    ,:RECEIV-IN-TRBL-HOUR-CNT                     51950037
519600                    ,:RECEIV-VERFYD-TMST                          51960037
519700                    ,:RECEIV-RCVG-CLERK-INIT-ID                   51970037
519800                    ,:RECEIV-REFER-BACK-SEQ-NBR                   51980037
519900                    ,:RECEIV-AP-PRC-CDE                           51990037
520000                    ,:RECEIV-AP-PRC-DTE                           52000037
520100                    ,:RECEIV-MIS-DIRECT-IND                       52010037
520200                    ,:RECEIV-IMPRT-IND                            52020037
520300                    ,:RECEIV-CRE-OPER-UNT-ID                      52030037
520400                    ,:RECEIV-CRE-FCLTY-ID                         52040037
520500                    ,:RECEIV-CURR-OPER-UNT-ID                     52050037
520600                    ,:RECEIV-CURR-FCLTY-ID                        52060037
520700                    ,:RECEIV-APRON-LOC-DESC                       52070037
520800                    ,:PV-CURRENT-TIMESTAMP                        52080037
520900                FROM TRECEIV                                      52090037
521000               WHERE ORD_NBR     = :DK-PO-NBR                     52100065
521100                 AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                52110037
521200                 AND VER_STATUS_CDE = 'A'                         52120037
521300         END-EXEC                                                 52130037
521400                                                                  52140037
521500         EVALUATE TRUE                                            52150037
521600             WHEN SQLCODE = +0                                    52160037
521700             WHEN SQLCODE = +100                                  52170037
521800             WHEN SQLCODE = -904                                  52180037
521900             WHEN SQLCODE = -913                                  52190037
522000                  CONTINUE                                        52200037
522100                                                                  52210037
522200             WHEN SQLWARN0 NOT = SPACES                           52220037
522300             WHEN SQLCODE < +0                                    52230037
522400             WHEN SQLCODE > +0                                    52240037
522500                  MOVE '7370-SELECT-TRECEIV'                      52250037
522600                                   TO DP013-PARAGRAPH             52260037
522700                  MOVE 'UNSUCCESSFUL SELECT ON TRECEIV  '         52270037
522800                                   TO DP013-MESSAGE-TEXT (1)      52280037
522900                  MOVE PV-ABEND-MSG-KEYS                          52290037
523000                                   TO DP013-MESSAGE-TEXT (2)      52300037
523100                  MOVE SQLCA       TO DP013-SQLCA                 52310037
523200                  MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)    52320037
523300                  SET DP013-DB2-ABEND                             52330037
523400                      DP013-XCTL-DISPLAY-RESTART                  52340037
523500                                   TO TRUE                        52350037
523600                  PERFORM DP013-0000-PROCESS-ABEND                52360037
523700         END-EVALUATE                                             52370037
523800     END-PERFORM.                                                 52380037
523900                                                                  52390037
524000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    52400037
524100         SQLCODE NOT = +0                                         52410037
524200         MOVE '7370-SELECT-TRECEIV'                               52420037
524300                                   TO DP013-PARAGRAPH             52430037
524400         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TRECEIV  '       52440037
524500                                   TO DP013-MESSAGE-TEXT (1)      52450037
524600         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      52460037
524700         MOVE SQLCA                TO DP013-SQLCA                 52470037
524800         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    52480037
524900         SET DP013-DB2-ABEND                                      52490037
525000             DP013-XCTL-DISPLAY-RESTART                           52500037
525100                                   TO TRUE                        52510037
525200         PERFORM DP013-0000-PROCESS-ABEND                         52520037
525300     END-IF.                                                      52530037
525400                                                                  52540037
525500/                                                                 52550037
525600*----------------------------------------------------------------*52560037
525700*  THIS PARAGRAPH WILL STATUS THE CURRENT ROW INACTIVE.  THIS    *52570037
525800*  IS BEING DONE FOR AUDITING PURPOSES.                          *52580037
525900*----------------------------------------------------------------*52590037
526000                                                                  52600037
526100 7380-UPDATE-TRECEIV.                                             52610037
526200                                                                  52620037
526300     PERFORM                                                      52630037
526400         WITH TEST AFTER                                          52640037
526500         VARYING PV-RETRY-COUNTER                                 52650037
526600         FROM 1 BY 1                                              52660037
526700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52670037
526800             OR (SQLCODE = +0))                                   52680037
526900                                                                  52690037
527000         EXEC SQL                                                 52700037
527100           UPDATE TRECEIV                                         52710037
527200             SET STATUS_CDE         = :PC-DE                      52720037
527300                ,VER_STATUS_CDE     = :PC-I                       52730037
527400                ,UPD_TMST           = CURRENT TIMESTAMP           52740037
527500                ,UPD_UID            = :DP020-USERID               52750037
527600                ,UPD_PGM_ID         = :PC-CURRENT-PROGRAM-NAME    52760037
527700               WHERE ORD_NBR        = :DK-PO-NBR                  52770065
527800                 AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR             52780037
527900                 AND VER_STATUS_CDE = 'A'                         52790037
528000         END-EXEC                                                 52800037
528100                                                                  52810037
528200         EVALUATE TRUE                                            52820037
528300             WHEN SQLCODE = +0                                    52830037
528400             WHEN SQLCODE = -904                                  52840037
528500             WHEN SQLCODE = -913                                  52850037
528600                 CONTINUE                                         52860037
528700                                                                  52870037
528800             WHEN SQLWARN0 NOT = SPACES                           52880037
528900             WHEN SQLCODE < +0                                    52890037
529000             WHEN SQLCODE > +0                                    52900037
529100                 MOVE '7380-UPDATE-TRECEIV'                       52910037
529200                                   TO DP013-PARAGRAPH             52920037
529300                 MOVE 'ERROR DELETING TRECEIV'                    52930037
529400                                   TO DP013-MESSAGE-TEXT(1)       52940037
529500                 MOVE PV-ABEND-MSG-KEYS                           52950037
529600                                   TO DP013-MESSAGE-TEXT (2)      52960037
529700                 MOVE SQLCA        TO DP013-SQLCA                 52970037
529800                 MOVE 'TUPDATE'    TO DP013-DB2-TABLE-NAME (1)    52980037
529900                 SET DP013-DB2-ABEND                              52990037
530000                     DP013-XCTL-DISPLAY-RESTART                   53000037
530100                                   TO TRUE                        53010037
530200                 PERFORM DP013-0000-PROCESS-ABEND                 53020037
530300         END-EVALUATE                                             53030037
530400     END-PERFORM.                                                 53040037
530500                                                                  53050037
530600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    53060037
530700         SQLCODE NOT = +0                                         53070037
530800         MOVE '7380-UPDATE-TRECEIV'                               53080037
530900                                   TO DP013-PARAGRAPH             53090037
531000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              53100037
531100                                   TO DP013-MESSAGE-TEXT (1)      53110037
531200         MOVE 'TO UPDATE A TRECEIV ROW'                           53120037
531300                                   TO DP013-MESSAGE-TEXT (2)      53130037
531400         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (3)      53140037
531500         MOVE SQLCA                TO DP013-SQLCA                 53150037
531600         MOVE 'TRECEIV'            TO DP013-DB2-TABLE-NAME (1)    53160037
531700         SET DP013-DB2-ABEND                                      53170037
531800             DP013-XCTL-DISPLAY-RESTART                           53180037
531900                                   TO TRUE                        53190037
532000         PERFORM DP013-0000-PROCESS-ABEND                         53200037
532100     END-IF.                                                      53210037
532200                                                                  53220037
532300                                                                  53230037
532400 7390-DELETE-ODD-UNIT.                                            53240037
532500                                                                  53250037
532600     PERFORM                                                      53260037
532700         WITH TEST AFTER                                          53270037
532800         VARYING PV-RETRY-COUNTER                                 53280037
532900         FROM 1 BY 1                                              53290037
533000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               53300037
533100             OR (SQLCODE = +100)                                  53310037
533200             OR (SQLCODE = +0))                                   53320037
533300                                                                  53330037
533400         EXEC SQL                                                 53340037
533500              DELETE                                              53350037
533600                FROM RCT_VRFD_ODD_UNT                             53360037
533700                WHERE PO_NBR         = :DK-PO-NBR                 53370037
533800                  AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR            53380037
533900         END-EXEC                                                 53390037
534000                                                                  53400037
534100         EVALUATE TRUE                                            53410037
534200             WHEN SQLCODE = ZERO                                  53420037
534300             WHEN SQLCODE = +100                                  53430037
534400                  CONTINUE                                        53440037
534500             WHEN SQLCODE = -904                                  53450037
534600             WHEN SQLCODE = -911                                  53460037
534700             WHEN SQLCODE = -913                                  53470037
534800                  CONTINUE                                        53480037
534900                                                                  53490037
535000             WHEN SQLWARN0 NOT = SPACES                           53500037
535100             WHEN SQLCODE  NOT = ZERO                             53510037
535200                  MOVE '7390-DELETE-ODD-UNIT'                     53520037
535300                                 TO DP013-PARAGRAPH               53530037
535400                  MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'  53540037
535500                                 TO DP013-MESSAGE-TEXT (1)        53550037
535600                  MOVE DK-PO-NBR       TO PV-MSG-PO               53560037
535700                  MOVE DK-REC-SEQ-NBR  TO PV-MSG-RCVR             53570037
535800                  STRING 'PO - '                                  53580037
535900                         PV-MSG-PO                                53590037
536000                         ' SEQ '                                  53600037
536100                         PV-MSG-RCVR                              53610037
536200                         DELIMITED BY SIZE                        53620037
536300                         INTO DP013-MESSAGE-TEXT (2)              53630037
536400                  MOVE SQLCA     TO DP013-SQLCA                   53640037
536500                  MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)     53650037
536600                  SET DP013-DB2-ABEND                             53660037
536700                      DP013-XCTL-DISPLAY-RESTART                  53670037
536800                                 TO TRUE                          53680037
536900                  PERFORM DP013-0000-PROCESS-ABEND                53690037
537000         END-EVALUATE                                             53700037
537100                                                                  53710037
537200     END-PERFORM.                                                 53720037
537300                                                                  53730037
537400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    53740037
537500         SQLCODE NOT = +0                                         53750037
537600         MOVE '7390-DELETE-ODD-UNIT'                              53760037
537700                                   TO DP013-PARAGRAPH             53770037
537800         MOVE 'MAX RETRIES EXCEEDED ON DELETE ON RCT00009'        53780037
537900                                   TO DP013-MESSAGE-TEXT (1)      53790037
538000         MOVE SQLCA                TO DP013-SQLCA                 53800037
538100         MOVE 'RCT00009'           TO DP013-DB2-TABLE-NAME (1)    53810037
538200         SET DP013-DB2-ABEND                                      53820037
538300             DP013-XCTL-DISPLAY-RESTART                           53830037
538400                                   TO TRUE                        53840037
538500         PERFORM DP013-0000-PROCESS-ABEND                         53850037
538600     END-IF.                                                      53860037
538700                                                                  53870037
538800/                                                                 53880023
538900*IR-229 FROM HERE                                                 53890023
539000*----------------------------------------------------------------*53900023
539100*    BY DELETING THE NOTIFICATION ROWS, R.I. WITH DELETE CASCADE *53910023
539200*    DELETES ALL TROUBLE DETAIL ROWS AS WELL.                    *53920023
539300*----------------------------------------------------------------*53930023
539400                                                                  53940023
539500 7395-DELETE-TROUBLE.                                             53950023
539600                                                                  53960023
539700     PERFORM                                                      53970023
539800         WITH TEST AFTER                                          53980023
539900         VARYING PV-RETRY-COUNTER                                 53990023
540000         FROM 1 BY 1                                              54000023
540100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               54010023
540200             OR (SQLCODE = +100)                                  54020023
540300             OR (SQLCODE = +0))                                   54030023
540400                                                                  54040023
540500         EXEC SQL                                                 54050023
540600              DELETE                                              54060023
540700                FROM TTRBNTF                                      54070023
540800               WHERE PO_NBR       = :DK-PO-NBR                    54080023
540900                 AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR               54090023
541000         END-EXEC                                                 54100023
541100                                                                  54110023
541200         EVALUATE TRUE                                            54120023
541300             WHEN SQLCODE = +0                                    54130023
541400             WHEN SQLCODE = +100                                  54140023
541500             WHEN SQLCODE = -904                                  54150023
541600             WHEN SQLCODE = -913                                  54160023
541700                  CONTINUE                                        54170023
541800                                                                  54180023
541900             WHEN SQLWARN0 NOT = SPACES                           54190023
542000             WHEN SQLCODE < +0                                    54200023
542100             WHEN SQLCODE > +0                                    54210023
542200                  MOVE '7395-DELETE-TROUBLE'                      54220023
542300                                   TO DP013-PARAGRAPH             54230023
542400                  MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'           54240023
542500                                   TO DP013-MESSAGE-TEXT (1)      54250023
542600                  MOVE PV-ABEND-MSG-KEYS                          54260023
542700                                   TO DP013-MESSAGE-TEXT (2)      54270023
542800                  MOVE SQLCA       TO DP013-SQLCA                 54280023
542900                  MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)    54290023
543000                  SET DP013-DB2-ABEND                             54300023
543100                      DP013-XCTL-DISPLAY-RESTART                  54310023
543200                                   TO TRUE                        54320023
543300                  PERFORM DP013-0000-PROCESS-ABEND                54330023
543400         END-EVALUATE                                             54340023
543500     END-PERFORM.                                                 54350023
543600                                                                  54360023
543700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    54370023
543800         SQLCODE NOT = +0                                         54380023
543900         MOVE '7395-DELETE-TROUBLE'                               54390023
544000                                   TO DP013-PARAGRAPH             54400023
544100         MOVE 'MAX RETRIES EXCEEDED ON DELETE ON TTRBNTF'         54410023
544200                                   TO DP013-MESSAGE-TEXT (1)      54420023
544300         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      54430023
544400         MOVE SQLCA                TO DP013-SQLCA                 54440023
544500         MOVE 'TTRBNTF '           TO DP013-DB2-TABLE-NAME (1)    54450023
544600         SET DP013-DB2-ABEND                                      54460023
544700             DP013-XCTL-DISPLAY-RESTART                           54470023
544800                                   TO TRUE                        54480023
544900         PERFORM DP013-0000-PROCESS-ABEND                         54490023
545000     END-IF.                                                      54500023
545100*IR-229 TO HERE                                                   54510037
545200/                                                                 54520037
545300 7396-CLEANUP-VIOLATIONS.                                         54530037
545400                                                                  54540037
545500* DELETE ALL VIOLATIONS RELATED TO THE PO/RECEIVER                54550037
545600     MOVE ASC-ENT-ID               TO DK-ENT-ID                   54560023
545700     PERFORM 7396A-OPEN-VILN-CSR.                                 54570037
545800     PERFORM 7396B-FETCH-VILN-CSR.                                54580037
545900     PERFORM UNTIL PS-EOF-VILN-CSR                                54590037
546000         MOVE VILN-VILN-NBR        TO DK-VILN-NBR                 54600037
546100         PERFORM 7396C-DELETE-VILN                                54610037
546200         PERFORM 7396D-DELETE-VILNLN                              54620037
546300         PERFORM 7396E-DELETE-VMNEVD                              54630037
546400         PERFORM 7396F-DELETE-VILNSTA                             54640037
546500         PERFORM 7396B-FETCH-VILN-CSR                             54650037
546600     END-PERFORM.                                                 54660037
546700                                                                  54670037
546800     PERFORM 7396G-CLOSE-VILN-CSR.                                54680037
546900/                                                                 54690037
547000 7396A-OPEN-VILN-CSR.                                             54700037
547100     EXEC SQL                                                     54710037
547200         OPEN VILN-CSR                                            54720037
547300     END-EXEC.                                                    54730037
547400                                                                  54740037
547500     EVALUATE TRUE                                                54750037
547600         WHEN SQLCODE = ZERO                                      54760037
547700             CONTINUE                                             54770037
547800         WHEN SQLCODE = -904                                      54780037
547900         WHEN SQLCODE = -911                                      54790037
548000         WHEN SQLCODE = -913                                      54800037
548100             MOVE '7396A-OPEN-VILN-CSR'                           54810037
548200                                   TO DP013-PARAGRAPH             54820037
548300             MOVE 'UNSUCCESSFUL OPEN OF TVILN-CSR'                54830023
548400                                   TO DP013-MESSAGE-TEXT (1)      54840023
548500             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     54850037
548600             MOVE SQLCA            TO DP013-SQLCA                 54860037
548700             SET DP013-DB2-ABEND   TO TRUE                        54870037
548800             PERFORM DP013-0000-PROCESS-ABEND                     54880037
548900                                                                  54890037
549000         WHEN SQLWARN0 NOT = SPACE                                54900037
549100         WHEN SQLCODE  NOT = ZERO                                 54910037
549200             MOVE '7396A-OPEN-VILN-CSR'                           54920037
549300                                   TO DP013-PARAGRAPH             54930037
549400             MOVE 'UNSUCCESSFUL OPEN OF TVILN-CSR'                54940023
549500                                   TO DP013-MESSAGE-TEXT (1)      54950023
549600             MOVE SQLCA            TO DP013-SQLCA                 54960037
549700             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     54970037
549800             SET DP013-DB2-ABEND   TO TRUE                        54980037
549900             PERFORM DP013-0000-PROCESS-ABEND                     54990037
550000     END-EVALUATE.                                                55000037
550100                                                                  55010037
550200                                                                  55020037
550300 7396B-FETCH-VILN-CSR.                                            55030037
550400     EXEC SQL                                                     55040037
550500         FETCH VILN-CSR                                           55050037
550600         INTO                                                     55060037
550700             :VILN-VILN-NBR                                       55070037
550800     END-EXEC.                                                    55080037
550900                                                                  55090027
551000     EVALUATE TRUE                                                55100027
551100         WHEN SQLCODE = ZERO                                      55110027
551200             CONTINUE                                             55120027
551300         WHEN SQLCODE = +100                                      55130027
551400             SET PS-EOF-VILN-CSR      TO TRUE                     55140037
551500         WHEN SQLCODE = -904                                      55150027
551600         WHEN SQLCODE = -911                                      55160027
551700         WHEN SQLCODE = -913                                      55170027
551800             MOVE '7396B-FETCH-VILN-CSR'                          55180026
551900                                   TO DP013-PARAGRAPH             55190027
552000             MOVE 'UNSUCCESSFUL FETCH OF TVILN-CSR'               55200023
552100                                   TO DP013-MESSAGE-TEXT (1)      55210023
552200             MOVE SQLCA            TO DP013-SQLCA                 55220027
552300             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     55230027
552400             SET DP013-DB2-ABEND   TO TRUE                        55240027
552500             PERFORM DP013-0000-PROCESS-ABEND                     55250027
552600                                                                  55260027
552700         WHEN SQLWARN0 NOT = SPACE                                55270027
552800         WHEN SQLCODE  NOT = ZERO                                 55280027
552900             MOVE '7396B-FETCH-VILN-CSR'                          55290026
553000                                   TO DP013-PARAGRAPH             55300027
553100             MOVE 'UNSUCCESSFUL FETCH OF TVILN-CSR'               55310023
553200                                   TO DP013-MESSAGE-TEXT (1)      55320023
553300             MOVE SQLCA            TO DP013-SQLCA                 55330027
553400             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     55340027
553500             SET DP013-DB2-ABEND   TO TRUE                        55350027
553600             PERFORM DP013-0000-PROCESS-ABEND                     55360027
553700     END-EVALUATE.                                                55370027
553800                                                                  55380026
553900 7396C-DELETE-VILN.                                               55390026
554000     EXEC SQL                                                     55400026
554100         DELETE FROM TVILN                                        55410026
554200         WHERE CURRENT OF VILN-CSR                                55420026
554300     END-EXEC.                                                    55430026
554400                                                                  55440026
554500     EVALUATE TRUE                                                55450027
554600         WHEN SQLCODE = ZERO                                      55460027
554700         WHEN SQLCODE = +100                                      55470027
554800             CONTINUE                                             55480027
554900         WHEN SQLCODE = -904                                      55490027
555000         WHEN SQLCODE = -911                                      55500027
555100         WHEN SQLCODE = -913                                      55510027
555200             MOVE '7396C-DELETE-VILN'                             55520026
555300                                   TO DP013-PARAGRAPH             55530027
555400             MOVE 'UNSUCCESSFUL DELETE OF TVILN-CSR'              55540023
555500                                   TO DP013-MESSAGE-TEXT (1)      55550023
555600             MOVE SQLCA            TO DP013-SQLCA                 55560027
555700             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     55570027
555800             SET DP013-DB2-ABEND   TO TRUE                        55580027
555900             PERFORM DP013-0000-PROCESS-ABEND                     55590027
556000                                                                  55600027
556100         WHEN SQLWARN0 NOT = SPACE                                55610027
556200         WHEN SQLCODE  NOT = ZERO                                 55620027
556300             MOVE '7396C-DELETE-VILN'                             55630026
556400                                   TO DP013-PARAGRAPH             55640027
556500             MOVE 'UNSUCCESSFUL DELETE OF TVILN-CSR'              55650023
556600                                   TO DP013-MESSAGE-TEXT (1)      55660023
556700             MOVE SQLCA            TO DP013-SQLCA                 55670027
556800             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     55680027
556900             SET DP013-DB2-ABEND   TO TRUE                        55690027
557000             PERFORM DP013-0000-PROCESS-ABEND                     55700027
557100     END-EVALUATE.                                                55710027
557200                                                                  55720026
557300 7396D-DELETE-VILNLN.                                             55730026
557400     EXEC SQL                                                     55740026
557500         DELETE FROM TVILNLN                                      55750026
557600         WHERE VILN_NBR = :DK-VILN-NBR                            55760026
557700     END-EXEC.                                                    55770026
557800                                                                  55780026
557900     EVALUATE TRUE                                                55790027
558000         WHEN SQLCODE = ZERO                                      55800027
558100         WHEN SQLCODE = +100                                      55810027
558200             CONTINUE                                             55820027
558300         WHEN SQLCODE = -904                                      55830027
558400         WHEN SQLCODE = -911                                      55840027
558500         WHEN SQLCODE = -913                                      55850027
558600             MOVE '7396D-DELETE-VILNLN'                           55860026
558700                                   TO DP013-PARAGRAPH             55870027
558800             MOVE 'UNSUCCESSFUL DELETE OF TVILNLN'                55880023
558900                                   TO DP013-MESSAGE-TEXT (1)      55890023
559000             MOVE SQLCA            TO DP013-SQLCA                 55900027
559100             MOVE 'TVILNLN'        TO DP013-DB2-TABLE-NAME(1)     55910027
559200             SET DP013-DB2-ABEND   TO TRUE                        55920027
559300             PERFORM DP013-0000-PROCESS-ABEND                     55930027
559400                                                                  55940027
559500         WHEN SQLWARN0 NOT = SPACE                                55950027
559600         WHEN SQLCODE  NOT = ZERO                                 55960027
559700             MOVE '7396D-DELETE-VILNLN'                           55970026
559800                                   TO DP013-PARAGRAPH             55980027
559900             MOVE 'UNSUCCESSFUL DELETE OF TVILNLN'                55990023
560000                                   TO DP013-MESSAGE-TEXT (1)      56000023
560100             MOVE SQLCA            TO DP013-SQLCA                 56010027
560200             MOVE 'TVILNLN'        TO DP013-DB2-TABLE-NAME(1)     56020027
560300             SET DP013-DB2-ABEND   TO TRUE                        56030027
560400             PERFORM DP013-0000-PROCESS-ABEND                     56040027
560500     END-EVALUATE.                                                56050027
560600                                                                  56060026
560700 7396E-DELETE-VMNEVD.                                             56070026
560800     EXEC SQL                                                     56080026
560900         DELETE FROM TVMNEVD                                      56090026
561000         WHERE VILN_NBR = :DK-VILN-NBR                            56100026
561100     END-EXEC.                                                    56110026
561200                                                                  56120026
561300     EVALUATE TRUE                                                56130027
561400         WHEN SQLCODE = ZERO                                      56140027
561500         WHEN SQLCODE = +100                                      56150027
561600             CONTINUE                                             56160027
561700         WHEN SQLCODE = -904                                      56170027
561800         WHEN SQLCODE = -911                                      56180027
561900         WHEN SQLCODE = -913                                      56190027
562000             MOVE '7396E-DELETE-VMNEVD'                           56200026
562100                                   TO DP013-PARAGRAPH             56210027
562200             MOVE 'UNSUCCESSFUL DELETE OF TVMNEVD'                56220023
562300                                   TO DP013-MESSAGE-TEXT (1)      56230023
562400             MOVE SQLCA            TO DP013-SQLCA                 56240027
562500             MOVE 'TVMNEVD'        TO DP013-DB2-TABLE-NAME(1)     56250027
562600             SET DP013-DB2-ABEND   TO TRUE                        56260027
562700             PERFORM DP013-0000-PROCESS-ABEND                     56270027
562800                                                                  56280027
562900         WHEN SQLWARN0 NOT = SPACE                                56290027
563000         WHEN SQLCODE  NOT = ZERO                                 56300027
563100             MOVE '7396E-DELETE-VMNEVD'                           56310026
563200                                   TO DP013-PARAGRAPH             56320027
563300             MOVE 'UNSUCCESSFUL DELETE OF TVMNEVD'                56330023
563400                                   TO DP013-MESSAGE-TEXT (1)      56340023
563500             MOVE SQLCA            TO DP013-SQLCA                 56350027
563600             MOVE 'TVMNEVD'        TO DP013-DB2-TABLE-NAME(1)     56360027
563700             SET DP013-DB2-ABEND   TO TRUE                        56370027
563800             PERFORM DP013-0000-PROCESS-ABEND                     56380027
563900     END-EVALUATE.                                                56390027
564000                                                                  56400026
564100 7396F-DELETE-VILNSTA.                                            56410026
564200     EXEC SQL                                                     56420026
564300         DELETE FROM TVILSTA                                      56430026
564400         WHERE VILN_NBR = :DK-VILN-NBR                            56440026
564500     END-EXEC.                                                    56450026
564600                                                                  56460026
564700     EVALUATE TRUE                                                56470027
564800         WHEN SQLCODE = ZERO                                      56480027
564900         WHEN SQLCODE = +100                                      56490027
565000             CONTINUE                                             56500027
565100         WHEN SQLCODE = -904                                      56510027
565200         WHEN SQLCODE = -911                                      56520027
565300         WHEN SQLCODE = -913                                      56530027
565400             MOVE '7396F-DELETE-VILNSTA'                          56540026
565500                                   TO DP013-PARAGRAPH             56550027
565600             MOVE 'UNSUCCESSFUL DELETE OF TVILNLN'                56560023
565700                                   TO DP013-MESSAGE-TEXT (1)      56570023
565800             MOVE SQLCA            TO DP013-SQLCA                 56580027
565900             MOVE 'TVILSTA'        TO DP013-DB2-TABLE-NAME(1)     56590027
566000             SET DP013-DB2-ABEND   TO TRUE                        56600027
566100             PERFORM DP013-0000-PROCESS-ABEND                     56610027
566200                                                                  56620027
566300         WHEN SQLWARN0 NOT = SPACE                                56630027
566400         WHEN SQLCODE  NOT = ZERO                                 56640027
566500             MOVE '7396F-DELETE-VILNSTA'                          56650026
566600                                   TO DP013-PARAGRAPH             56660027
566700             MOVE 'UNSUCCESSFUL DELETE OF TVILNLN'                56670023
566800                                   TO DP013-MESSAGE-TEXT (1)      56680023
566900             MOVE SQLCA            TO DP013-SQLCA                 56690027
567000             MOVE 'TVILSTA'        TO DP013-DB2-TABLE-NAME(1)     56700027
567100             SET DP013-DB2-ABEND   TO TRUE                        56710027
567200             PERFORM DP013-0000-PROCESS-ABEND                     56720027
567300     END-EVALUATE.                                                56730027
567400                                                                  56740026
567500 7396G-CLOSE-VILN-CSR.                                            56750026
567600     EXEC SQL                                                     56760026
567700         CLOSE VILN-CSR                                           56770026
567800     END-EXEC.                                                    56780026
567900                                                                  56790027
568000     EVALUATE TRUE                                                56800027
568100         WHEN SQLCODE = ZERO                                      56810027
568200             CONTINUE                                             56820027
568300         WHEN SQLCODE = -904                                      56830027
568400         WHEN SQLCODE = -911                                      56840027
568500         WHEN SQLCODE = -913                                      56850027
568600             MOVE '7396G-CLOSE-VILN-CSR'                          56860027
568700                                   TO DP013-PARAGRAPH             56870027
568800             MOVE 'UNSUCCESSFUL CLOSE OF TVILN-CSR'               56880023
568900                                   TO DP013-MESSAGE-TEXT (1)      56890023
569000             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     56900027
569100             MOVE SQLCA            TO DP013-SQLCA                 56910027
569200             SET DP013-DB2-ABEND   TO TRUE                        56920027
569300             PERFORM DP013-0000-PROCESS-ABEND                     56930027
569400                                                                  56940027
569500         WHEN SQLWARN0 NOT = SPACE                                56950027
569600         WHEN SQLCODE  NOT = ZERO                                 56960027
569700             MOVE '7396G-CLOSE-VILN-CSR'                          56970027
569800                                   TO DP013-PARAGRAPH             56980027
569900             MOVE 'UNSUCCESSFUL OPEN OF TVILN-CSR'                56990023
570000                                   TO DP013-MESSAGE-TEXT (1)      57000023
570100             MOVE 'TVILN'          TO DP013-DB2-TABLE-NAME(1)     57010027
570200             MOVE SQLCA            TO DP013-SQLCA                 57020027
570300             SET DP013-DB2-ABEND   TO TRUE                        57030027
570400             PERFORM DP013-0000-PROCESS-ABEND                     57040027
570500     END-EVALUATE.                                                57050027
570600                                                                  57060037
570700/                                                                 57070027
570800*----------------------------------------------------------------*57080023
570900*    A DETACH FUNCTION WILL SET THE REC-SEQ-NBR FIELD TO ZERO    *57090023
571000*    FOR ALL OF THE SHIPMENTS ATTACHED TO THE RECEIVER.          *57100037
571100*----------------------------------------------------------------*57110037
571200                                                                  57120037
571300 7405-DETACH-TSHPTPOS.                                            57130037
571400     PERFORM 7410-GET-SHIPT-ID.                                   57140037
571500     IF PS-NOT-END-OF-TSHPTPO                                     57150037
571600         PERFORM 7430-UPDATE-TSHPTPO                              57160037
571700     END-IF.                                                      57170037
571800                                                                  57180037
571900 7407-OPEN-TSHPTPO-CSR.                                           57190037
572000                                                                  57200037
572100     PERFORM                                                      57210037
572200         WITH TEST AFTER                                          57220037
572300         VARYING PV-RETRY-COUNTER                                 57230037
572400         FROM 1 BY 1                                              57240037
572500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               57250037
572600            OR (SQLCODE = +100)                                   57260037
572700            OR (SQLCODE = +0))                                    57270037
572800                                                                  57280037
572900         EXEC SQL                                                 57290037
573000             OPEN TSHPTPO-CSR                                     57300037
573100         END-EXEC                                                 57310037
573200                                                                  57320037
573300         EVALUATE TRUE                                            57330037
573400             WHEN SQLCODE = +0                                    57340037
573500                  SET PS-NOT-END-OF-TSHPTPO                       57350037
573600                                   TO TRUE                        57360037
573700             WHEN SQLCODE = -904                                  57370037
573800             WHEN SQLCODE = -913                                  57380037
573900                  CONTINUE                                        57390037
574000                                                                  57400037
574100             WHEN SQLWARN0 NOT = SPACE                            57410037
574200             WHEN SQLCODE  NOT = +0                               57420037
574300                  MOVE '7407-OPEN-TSHPTPO-CSR'                    57430037
574400                                   TO DP013-PARAGRAPH             57440037
574500                  MOVE 'OPEN TSHPTPO-CSR CURSOR'                  57450037
574600                                   TO DP013-MESSAGE-TEXT (1)      57460037
574700                  MOVE PV-ABEND-MSG-KEYS                          57470037
574800                                   TO DP013-MESSAGE-TEXT (2)      57480037
574900                  MOVE SQLCA       TO DP013-SQLCA                 57490037
575000                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    57500037
575100                  SET DP013-DB2-ABEND                             57510037
575200                                   TO TRUE                        57520037
575300                  PERFORM DP013-0000-PROCESS-ABEND                57530037
575400         END-EVALUATE                                             57540037
575500     END-PERFORM.                                                 57550037
575600                                                                  57560037
575700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    57570037
575800         SQLCODE NOT = +0                                         57580037
575900         MOVE '7407-OPEN-TSHPTPO-CSR'                             57590037
576000                                   TO DP013-PARAGRAPH             57600037
576100         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              57610037
576200                                   TO DP013-MESSAGE-TEXT (1)      57620037
576300         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      57630037
576400         MOVE SQLCA                TO DP013-SQLCA                 57640037
576500         SET DP013-DB2-ABEND       TO TRUE                        57650037
576600         PERFORM DP013-0000-PROCESS-ABEND                         57660037
576700     END-IF.                                                      57670037
576800                                                                  57680037
576900 7409-CLOSE-TSHPTPO-CSR.                                          57690037
577000                                                                  57700037
577100     EXEC SQL                                                     57710037
577200         CLOSE TSHPTPO-CSR                                        57720037
577300     END-EXEC.                                                    57730037
577400                                                                  57740037
577500     EVALUATE TRUE                                                57750037
577600         WHEN SQLCODE = +0                                        57760037
577700              CONTINUE                                            57770037
577800                                                                  57780037
577900         WHEN SQLWARN0 NOT = SPACE                                57790037
578000         WHEN SQLCODE  NOT = +0                                   57800037
578100              MOVE '7409-CLOSE-TSHPTPO-CSR'                       57810037
578200                                   TO DP013-PARAGRAPH             57820037
578300              MOVE 'CLOSE TSHPTPO-CSR CURSOR'                     57830037
578400                                   TO DP013-MESSAGE-TEXT (1)      57840037
578500              MOVE PV-ABEND-MSG-KEYS                              57850037
578600                                   TO DP013-MESSAGE-TEXT (2)      57860037
578700              MOVE SQLCA           TO DP013-SQLCA                 57870037
578800              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (1)    57880037
578900              SET DP013-DB2-ABEND  TO TRUE                        57890037
579000              PERFORM DP013-0000-PROCESS-ABEND                    57900037
579100     END-EVALUATE.                                                57910037
579200                                                                  57920037
579300                                                                  57930037
579400*----------------------------------------------------------------*57940037
579500*    GET THE SHIPT ID FOR THE PO, RECEIVE SEQUENCE NUBMER.       *57950037
579600*----------------------------------------------------------------*57960037
579700 7410-GET-SHIPT-ID.                                               57970037
579800                                                                  57980037
579900     PERFORM                                                      57990037
580000         WITH TEST AFTER                                          58000037
580100         VARYING PV-RETRY-COUNTER                                 58010037
580200         FROM 1 BY 1                                              58020037
580300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58030037
580400             OR (SQLCODE = +100)                                  58040037
580500             OR (SQLCODE = +0))                                   58050037
580600                                                                  58060037
580700         EXEC SQL                                                 58070037
580800               FETCH  TSHPTPO-CSR                                 58080037
580900                INTO :SHPTPO-SHIPT-ID                             58090037
581000         END-EXEC                                                 58100037
581100                                                                  58110037
581200         EVALUATE TRUE                                            58120037
581300             WHEN SQLCODE = +0                                    58130037
581400                  SET PS-NOT-END-OF-TSHPTPO                       58140037
581500                                   TO TRUE                        58150037
581600             WHEN SQLCODE = +100                                  58160037
581700                  SET PS-END-OF-TSHPTPO                           58170037
581800                                   TO TRUE                        58180037
581900             WHEN SQLCODE = -904                                  58190037
582000             WHEN SQLCODE = -913                                  58200037
582100                  CONTINUE                                        58210037
582200                                                                  58220037
582300             WHEN SQLWARN0 NOT = SPACES                           58230037
582400             WHEN SQLCODE < +0                                    58240037
582500             WHEN SQLCODE > +0                                    58250037
582600                  MOVE '7410-GET-SHIPT-ID'                        58260037
582700                                   TO DP013-PARAGRAPH             58270037
582800                  MOVE 'UNSUCCESSFUL SELECT ON TSHPTPO'           58280037
582900                                   TO DP013-MESSAGE-TEXT (1)      58290037
583000                  MOVE DK-PO-NBR                                  58300037
583100                                   TO DP013-MESSAGE-TEXT (2)      58310037
583200                  MOVE DK-REC-SEQ-NBR                             58320037
583300                                   TO DP013-MESSAGE-TEXT (3)      58330037
583400                  MOVE SQLCA       TO DP013-SQLCA                 58340037
583500                  MOVE 'TSHPTPO '  TO DP013-DB2-TABLE-NAME (1)    58350037
583600                  SET DP013-DB2-ABEND                             58360037
583700                      DP013-XCTL-DISPLAY-RESTART                  58370037
583800                                   TO TRUE                        58380037
583900                  PERFORM DP013-0000-PROCESS-ABEND                58390037
584000         END-EVALUATE                                             58400037
584100     END-PERFORM.                                                 58410037
584200                                                                  58420037
584300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58430037
584400         SQLCODE NOT = +0                                         58440037
584500         MOVE '7410-GET-SHIPT-ID'                                 58450037
584600                                   TO DP013-PARAGRAPH             58460037
584700         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TSHPTPO'         58470037
584800                                   TO DP013-MESSAGE-TEXT (1)      58480037
584900         MOVE PV-ABEND-MSG-KEYS    TO DP013-MESSAGE-TEXT (2)      58490037
585000         MOVE SQLCA                TO DP013-SQLCA                 58500037
585100         MOVE 'TSHPTPO '           TO DP013-DB2-TABLE-NAME (1)    58510037
585200         SET DP013-DB2-ABEND                                      58520037
585300             DP013-XCTL-DISPLAY-RESTART                           58530037
585400                                   TO TRUE                        58540037
585500         PERFORM DP013-0000-PROCESS-ABEND                         58550037
585600     END-IF.                                                      58560037
585700*----------------------------------------------------------------*58570037
585800*    UPDATE THE RECEVING SEQUENCE NUMBER                         *58580037
585900*----------------------------------------------------------------*58590037
586000 7430-UPDATE-TSHPTPO.                                             58600037
586100                                                                  58610037
586200     PERFORM                                                      58620037
586300         WITH TEST AFTER                                          58630037
586400         VARYING PV-RETRY-COUNTER                                 58640037
586500         FROM 1 BY 1                                              58650037
586600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58660037
586700             OR (SQLCODE = +0))                                   58670037
586800                                                                  58680037
586900         EXEC SQL                                                 58690037
587000              UPDATE TSHPTPO                                      58700037
587100                 SET REC_SEQ_NBR      = 0                         58710037
587200                    ,LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME  58720037
587300                    ,LAST_UPD_DTE     = CURRENT DATE              58730037
587400                    ,LAST_UPD_TIME    = CURRENT TIME              58740037
587500                    ,LAST_UPD_USER_ID = :DP020-USERID             58750037
587600                    ,PRIM_SHIPT_IND   = :PC-Y                     58760037
587700               WHERE SHIPT_ID         = :SHPTPO-SHIPT-ID          58770037
587800                 AND PO_NBR           = :DK-PO-NBR                58780037
587900         END-EXEC                                                 58790037
588000                                                                  58800037
588100         EVALUATE TRUE                                            58810037
588200             WHEN SQLCODE = +0                                    58820037
588300             WHEN SQLCODE = -904                                  58830037
588400             WHEN SQLCODE = -913                                  58840037
588500                  CONTINUE                                        58850037
588600                                                                  58860037
588700             WHEN SQLWARN0 NOT = SPACES                           58870037
588800             WHEN SQLCODE < +0                                    58880037
588900             WHEN SQLCODE > +0                                    58890037
589000                  MOVE '7430-UPDATE-TSHPTPO'                      58900037
589100                                   TO DP013-PARAGRAPH             58910037
589200                  MOVE 'UNSUCCESSFUL UPDATE ON TSHIPMT'           58920037
589300                                   TO DP013-MESSAGE-TEXT (1)      58930037
589400                  MOVE SHPTPO-SHIPT-ID                            58940037
589500                                   TO DP013-MESSAGE-TEXT (2)      58950037
589600                  MOVE DK-PO-NBR                                  58960037
589700                                   TO DP013-MESSAGE-TEXT (3)      58970037
589800                  MOVE SQLCA       TO DP013-SQLCA                 58980037
589900                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    58990037
590000                  SET DP013-DB2-ABEND                             59000037
590100                      DP013-XCTL-DISPLAY-RESTART                  59010037
590200                                   TO TRUE                        59020037
590300                  PERFORM DP013-0000-PROCESS-ABEND                59030037
590400         END-EVALUATE                                             59040037
590500     END-PERFORM.                                                 59050037
590600                                                                  59060037
590700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    59070037
590800         SQLCODE NOT = +0                                         59080037
590900         MOVE '7430-UPDATE-TSHPTPO'                               59090037
591000                                   TO DP013-PARAGRAPH             59100037
591100         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TSHIPMT'         59110037
591200                                   TO DP013-MESSAGE-TEXT (1)      59120037
591300         MOVE SQLCA                TO DP013-SQLCA                 59130037
591400         MOVE 'TSHPTPO '           TO DP013-DB2-TABLE-NAME (1)    59140037
591500         SET DP013-DB2-ABEND                                      59150037
591600             DP013-XCTL-DISPLAY-RESTART                           59160037
591700                                   TO TRUE                        59170037
591800         PERFORM DP013-0000-PROCESS-ABEND                         59180037
591900     END-IF.                                                      59190037
592000                                                                  59200037
592100     EVALUATE TRUE                                                59210037
592200        WHEN SQLCODE = +0                                         59220037
592300             MOVE PC-U             TO PV-TRN-CDE                  59230037
592400             PERFORM 7440-CREATE-TAUSHPO                          59240037
592500     END-EVALUATE.                                                59250037
592600                                                                  59260037
592700*----------------------------------------------------------------*59270037
592800*  INSERT THE PO TO THE SHIPEMENT PO ASSOCIATION AUDIT TABLE      59280037
592900*                                                                 59290037
593000*----------------------------------------------------------------*59300037
593100                                                                  59310037
593200 7440-CREATE-TAUSHPO.                                             59320037
593300                                                                  59330037
593400     PERFORM                                                      59340037
593500         WITH TEST AFTER                                          59350037
593600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     59360037
593700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            59370037
593800                (SQLCODE = ZERO)   OR                             59380037
593900                (SQLCODE = +100)                                  59390037
594000                                                                  59400037
594100         EXEC SQL                                                 59410037
594200             SELECT SHIPT_ID,                                     59420037
594300                    PO_NBR,                                       59430037
594400                    REC_SEQ_NBR,                                  59440037
594500                    EXPTED_CART_CNT,                              59450037
594600                    ACTL_CART_CNT,                                59460037
594700                    DMG_CART_CNT,                                 59470037
594800                    PKSL_IND,                                     59480037
594900                    VEND_NAME,                                    59490037
595000                    FRGT_CHG_AMT,                                 59500037
595100                    LAST_UPD_PGM_ID,                              59510037
595200                    CRE_USER_ID,                                  59520037
595300                    CARR_CART_CT,                                 59530037
595400                    CARR_LAST_UPD_DTE,                            59540037
595500                    CARR_LAST_UPD_TIME,                           59550037
595600                    VEND_CART_CT,                                 59560037
595700                    VEND_LAST_UPD_DTE,                            59570037
595800                    VEND_LAST_UPD_TIME,                           59580037
595900                    CRE_TMST,                                     59590037
596000                    LAST_UPD_DTE,                                 59600037
596100                    LAST_UPD_TIME,                                59610037
596200                    LAST_UPD_USER_ID,                             59620037
596300                    PRIM_SHIPT_IND                                59630037
596400                  , SPLT_XMIT_IND                                 59640037
596500                  , SPLT_XMIT_DTE                                 59650037
596600                  , SPLT_XMIT_TM                                  59660037
596700               INTO :SHPTPO-SHIPT-ID,                             59670037
596800                    :SHPTPO-PO-NBR,                               59680037
596900                    :SHPTPO-REC-SEQ-NBR,                          59690037
597000                    :SHPTPO-EXPTED-CART-CNT,                      59700037
597100                    :SHPTPO-ACTL-CART-CNT,                        59710037
597200                    :SHPTPO-DMG-CART-CNT,                         59720037
597300                    :SHPTPO-PKSL-IND,                             59730037
597400                    :SHPTPO-VEND-NAME,                            59740037
597500                    :SHPTPO-FRGT-CHG-AMT,                         59750037
597600                    :SHPTPO-LAST-UPD-PGM-ID,                      59760037
597700                    :SHPTPO-CRE-USER-ID,                          59770037
597800                    :SHPTPO-CARR-CART-CT,                         59780037
597900                    :SHPTPO-CARR-LAST-UPD-DTE,                    59790037
598000                    :SHPTPO-CARR-LAST-UPD-TIME,                   59800037
598100                    :SHPTPO-VEND-CART-CT,                         59810037
598200                    :SHPTPO-VEND-LAST-UPD-DTE,                    59820037
598300                    :SHPTPO-VEND-LAST-UPD-TIME,                   59830037
598400                    :SHPTPO-CRE-TMST,                             59840037
598500                    :SHPTPO-LAST-UPD-DTE,                         59850037
598600                    :SHPTPO-LAST-UPD-TIME,                        59860037
598700                    :SHPTPO-LAST-UPD-USER-ID,                     59870037
598800                    :SHPTPO-PRIM-SHIPT-IND                        59880037
598900                  , :SHPTPO-SPLT-XMIT-IND                         59890037
599000                  , :SHPTPO-SPLT-XMIT-DTE                         59900037
599100                  , :SHPTPO-SPLT-XMIT-TM                          59910037
599200               FROM TSHPTPO                                       59920037
599300              WHERE SHIPT_ID = :SHPTPO-SHIPT-ID                   59930037
599400                AND PO_NBR   = :DK-PO-NBR                         59940037
599500         END-EXEC                                                 59950037
599600                                                                  59960037
599700         EVALUATE TRUE                                            59970037
599800             WHEN SQLCODE = ZERO                                  59980037
599900             WHEN SQLCODE = +100                                  59990037
600000             WHEN SQLCODE = -904                                  60000037
600100             WHEN SQLCODE = -913                                  60010037
600200                 CONTINUE                                         60020037
600300                                                                  60030037
600400             WHEN SQLWARN0 NOT = SPACE                            60040037
600500             WHEN SQLCODE  NOT = +0                               60050037
600600                  MOVE SPACES TO PV-MESSAGE                       60060037
600700                  MOVE SHPTPO-SHIPT-ID TO PV-MESSAGE1             60070037
600800                  MOVE DK-PO-NBR       TO PV-MESSAGE2             60080037
600900                  MOVE '7440-CREATE-TAUSHPO'                      60090037
601000                                   TO DP013-PARAGRAPH             60100037
601100                  MOVE 'SELECT TSHPTPO DATA'                      60110037
601200                                   TO DP013-MESSAGE-TEXT (1)      60120037
601300                  MOVE PV-MESSAGE  TO DP013-MESSAGE-TEXT (2)      60130037
601400                  MOVE SQLCA       TO DP013-SQLCA                 60140037
601500                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    60150037
601600                  SET DP013-DB2-ABEND                             60160037
601700                                   TO TRUE                        60170037
601800                  PERFORM DP013-0000-PROCESS-ABEND                60180037
601900         END-EVALUATE                                             60190037
602000                                                                  60200037
602100     END-PERFORM.                                                 60210037
602200                                                                  60220037
602300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60230037
602400         SQLCODE NOT = +0                                         60240037
602500         MOVE '7440-CREATE-TAUSHPO'                               60250037
602600                                   TO DP013-PARAGRAPH             60260037
602700         MOVE 'MAX RETRIES EXCEEDED FOR SELECT TAUSHPO'           60270037
602800                                   TO DP013-MESSAGE-TEXT (1)      60280037
602900         MOVE SQLCA                TO DP013-SQLCA                 60290037
603000         SET DP013-DB2-ABEND       TO TRUE                        60300037
603100         PERFORM DP013-0000-PROCESS-ABEND                         60310037
603200     END-IF.                                                      60320037
603300                                                                  60330037
603400     MOVE PV-TRN-CDE               TO AUSHPO-TRN-CDE              60340037
603500     PERFORM                                                      60350037
603600         WITH TEST AFTER                                          60360037
603700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     60370037
603800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            60380037
603900                 SQLCODE = ZERO                                   60390037
604000                                                                  60400037
604100         EXEC SQL                                                 60410037
604200             INSERT INTO TAUSHPO                                  60420037
604300                   (SHIPT_ID,                                     60430037
604400                    PO_NBR,                                       60440037
604500                    REC_SEQ_NBR,                                  60450037
604600                    EXPTED_CART_CNT,                              60460037
604700                    ACTL_CART_CNT,                                60470037
604800                    DMG_CART_CNT,                                 60480037
604900                    PKSL_IND,                                     60490037
605000                    VEND_NAME,                                    60500037
605100                    FRGT_CHG_AMT,                                 60510037
605200                    LAST_UPD_PGM_ID,                              60520037
605300                    CRE_USER_ID,                                  60530037
605400                    CARR_CART_CT,                                 60540037
605500                    CARR_LAST_UPD_DTE,                            60550037
605600                    CARR_LAST_UPD_TIME,                           60560037
605700                    VEND_CART_CT,                                 60570037
605800                    VEND_LAST_UPD_DTE,                            60580037
605900                    VEND_LAST_UPD_TIME,                           60590037
606000                    CRE_TMST,                                     60600037
606100                    LAST_UPD_DTE,                                 60610037
606200                    LAST_UPD_TIME,                                60620037
606300                    LAST_UPD_USER_ID,                             60630037
606400                    PRIM_SHIPT_IND                                60640037
606500                  , SPLT_XMIT_IND                                 60650037
606600                  , SPLT_XMIT_DTE                                 60660037
606700                  , SPLT_XMIT_TM                                  60670037
606800                  , TRN_CDE )                                     60680037
606900             VALUES                                               60690037
607000                  (:SHPTPO-SHIPT-ID,                              60700037
607100                   :SHPTPO-PO-NBR,                                60710037
607200                   :SHPTPO-REC-SEQ-NBR,                           60720037
607300                   :SHPTPO-EXPTED-CART-CNT,                       60730037
607400                   :SHPTPO-ACTL-CART-CNT,                         60740037
607500                   :SHPTPO-DMG-CART-CNT,                          60750037
607600                   :SHPTPO-PKSL-IND,                              60760037
607700                   :SHPTPO-VEND-NAME,                             60770037
607800                   :SHPTPO-FRGT-CHG-AMT,                          60780037
607900                   :SHPTPO-LAST-UPD-PGM-ID,                       60790037
608000                   :SHPTPO-CRE-USER-ID,                           60800037
608100                   :SHPTPO-CARR-CART-CT,                          60810037
608200                   :SHPTPO-CARR-LAST-UPD-DTE,                     60820037
608300                   :SHPTPO-CARR-LAST-UPD-TIME,                    60830037
608400                   :SHPTPO-VEND-CART-CT,                          60840037
608500                   :SHPTPO-VEND-LAST-UPD-DTE,                     60850037
608600                   :SHPTPO-VEND-LAST-UPD-TIME,                    60860037
608700                   :SHPTPO-CRE-TMST,                              60870037
608800                   :SHPTPO-LAST-UPD-DTE,                          60880037
608900                   :SHPTPO-LAST-UPD-TIME,                         60890037
609000                   :SHPTPO-LAST-UPD-USER-ID,                      60900037
609100                   :SHPTPO-PRIM-SHIPT-IND                         60910037
609200                 , :SHPTPO-SPLT-XMIT-IND                          60920037
609300                 , :SHPTPO-SPLT-XMIT-DTE                          60930037
609400                 , :SHPTPO-SPLT-XMIT-TM                           60940037
609500                 , :AUSHPO-TRN-CDE )                              60950037
609600         END-EXEC                                                 60960037
609700                                                                  60970037
609800                                                                  60980037
609900         EVALUATE TRUE                                            60990037
610000             WHEN SQLCODE = +0                                    61000037
610100             WHEN SQLCODE = -904                                  61010037
610200             WHEN SQLCODE = -913                                  61020037
610300                 CONTINUE                                         61030037
610400                                                                  61040037
610500             WHEN SQLWARN0 NOT = SPACES                           61050037
610600             WHEN SQLCODE < +0                                    61060037
610700             WHEN SQLCODE > +0                                    61070037
610800                 MOVE SPACES TO PV-MESSAGE                        61080037
610900                 MOVE SHPTPO-SHIPT-ID TO PV-MESSAGE1              61090037
611000                 MOVE DK-PO-NBR       TO PV-MESSAGE2              61100037
611100                 MOVE '7440-CREATE-TAUSHPO'                       61110037
611200                                   TO DP013-PARAGRAPH             61120037
611300                 MOVE 'INSERT A ROW ON TAUSHPO'                   61130037
611400                                   TO DP013-MESSAGE-TEXT(1)       61140037
611500                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       61150037
611600                 MOVE SQLCA        TO DP013-SQLCA                 61160037
611700                 MOVE 'TAUSHPO'    TO DP013-DB2-TABLE-NAME (1)    61170037
611800                 SET DP013-DB2-ABEND                              61180037
611900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           61190037
612000                 PERFORM DP013-0000-PROCESS-ABEND                 61200037
612100         END-EVALUATE                                             61210037
612200     END-PERFORM.                                                 61220037
612300                                                                  61230037
612400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    61240037
612500         SQLCODE NOT = +0                                         61250037
612600         MOVE '7440-CREATE-TAUSHPO'                               61260037
612700                                   TO DP013-PARAGRAPH             61270037
612800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              61280037
612900                                   TO DP013-MESSAGE-TEXT (1)      61290037
613000         MOVE 'TO INSERT A TAUSHPO ROW'                           61300037
613100                                   TO DP013-MESSAGE-TEXT (2)      61310037
613200         MOVE SQLCA                TO DP013-SQLCA                 61320037
613300         MOVE 'TAUSHPO'            TO DP013-DB2-TABLE-NAME (1)    61330037
613400         SET DP013-DB2-ABEND                                      61340037
613500             DP013-XCTL-DISPLAY-RESTART                           61350037
613600                                   TO TRUE                        61360037
613700         PERFORM DP013-0000-PROCESS-ABEND                         61370037
613800     END-IF.                                                      61380037
613900                                                                  61390061
614000                                                                  61400061
614100******************************************************************61410061
614200* CHECK TSHUNLO FOR ACTIVE CARTONS CHECKED-IN                     61420061
614300******************************************************************61430061
614400 8200-ACTIVE-CARTONS-CHECKED-IN.                                  61440061
614500                                                                  61450061
614600     MOVE 0        TO PV-CARTON-COUNT.                            61460061
614700                                                                  61470061
614800     EXEC SQL                                                     61480067
614900          SELECT COUNT (*)                                        61490067
615000            INTO :PV-CARTON-COUNT                                 61500067
615100            FROM TINPKSU A                                        61510067
615200                ,TSHUNLO B                                        61520067
615300                ,TSULBXF C                                        61530067
615400                ,TPKSLIP D                                        61540067
615500                ,TSHUUPC E                                        61550067
615600            WHERE A.PO_NBR        = :DK-PO-NBR                    61560067
615700              AND A.SEQ_NBR       = D.SEQ_NBR                     61570067
615800              AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                61580067
615900              AND A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                61590067
616000              AND B.ACTV_CDE      = 'A'                           61600067
616100              AND B.SCN_LOC_ID    = 'RECV'                        61610067
616200              AND D.PO_NBR        = A.PO_NBR                      61620067
616300              AND D.REC_SEQ_NBR   = :DK-REC-SEQ-NBR               61630067
616400              AND D.VER_STAT_CDE  = 'A'                           61640067
616500              AND D.PKSL_STAT_CDE = 'AC'                          61650067
616600              AND A.SHIPT_UNT_ID  = E.SHIPT_UNT_ID                61660067
616700              AND A.PO_NBR        = E.TRN_NBR                     61670067
616800     END-EXEC                                                     61680061
616900                                                                  61690061
617000     EVALUATE TRUE                                                61700061
617100         WHEN SQLCODE = ZERO                                      61710061
617200              IF PV-CARTON-COUNT > 0                              61720061
617300                  SET PS-CHECKED-IN-FOUND TO TRUE                 61730061
617400              END-IF                                              61740061
617500         WHEN SQLCODE = +100                                      61750061
617600              CONTINUE                                            61760061
617700         WHEN SQLWARN0 NOT = SPACES                               61770061
617800         WHEN SQLCODE  NOT = ZERO                                 61780061
617900              MOVE '8200-ACTIVE-CARTONS-CHECKED-IN'               61790061
618000                                 TO DP013-PARAGRAPH               61800061
618100              MOVE 'UNSUCCESSFUL CHECK ACTIVE CARTONS '           61810061
618200                                 TO DP013-MESSAGE-TEXT (1)        61820061
618300              MOVE DK-PO-NBR     TO PV-DISPLAY-PO                 61830064
618400              MOVE DK-SEQ-NBR    TO PV-DISPLAY-RCVR               61840064
618500              STRING ' RCKCS255 - PO: '                           61850061
618600                     PV-DISPLAY-PO                                61860064
618700                     ' SEQ NBR: '                                 61870061
618800                     PV-DISPLAY-RCVR                              61880064
618900                                      DELIMITED BY SIZE           61890061
619000                               INTO DP013-MESSAGE-TEXT (2)        61900061
619100              MOVE SQLCA TO DP013-SQLCA                           61910061
619200              MOVE 'TINPSKU '    TO DP013-DB2-TABLE-NAME (1)      61920061
619300              MOVE 'TSHUNLO '    TO DP013-DB2-TABLE-NAME (2)      61930061
619400              MOVE 'TSULBXF '    TO DP013-DB2-TABLE-NAME (3)      61940061
619500              SET DP013-DB2-ABEND                                 61950061
619600                  DP013-XCTL-DISPLAY-RESTART                      61960061
619700                                 TO TRUE                          61970061
619800                                                                  61980061
619900              PERFORM DP013-0000-PROCESS-ABEND                    61990061
620000     END-EVALUATE.                                                62000061
620100                                                                  62010061
620200/                                                                 62020037
620300*----------------------------------------------------------------*62030037
620400*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *62040037
620500*----------------------------------------------------------------*62050037
620600                                                                  62060037
620700 9100-READ-SEL-QUEUE.                                             62070037
620800                                                                  62080037
620900     EXEC CICS                                                    62090037
621000         READQ TS                                                 62100037
621100             QUEUE (ASC-SEL-QUEUE-NAME)                           62110037
621200             INTO  (RC013-DC-SELECT-RECORD)                       62120037
621300             ITEM  (ASC-SEL-ITEM)                                 62130037
621400             RESP  (PV-CICS-RESPONSE)                             62140037
621500     END-EXEC.                                                    62150037
621600                                                                  62160037
621700     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   62170037
621800         CONTINUE                                                 62180037
621900     ELSE                                                         62190037
622000         SET DP013-LOGIC-ABEND                                    62200037
622100             DP013-NO-ROLLBACK     TO TRUE                        62210037
622200         MOVE '9100-READ-SEL-QUEUE'                               62220037
622300                                   TO DP013-PARAGRAPH             62230037
622400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   62240037
622500                                   TO DP013-MESSAGE-TEXT (1)      62250037
622600         PERFORM DP013-0000-PROCESS-ABEND                         62260037
622700     END-IF.                                                      62270037
622800                                                                  62280037
622900/                                                                 62290037
623000*----------------------------------------------------------------*62300037
623100*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *62310037
623200*----------------------------------------------------------------*62320037
623300 9200-REWRITE-LIST-QUEUE.                                         62330037
623400     EXEC CICS                                                    62340037
623500          WRITEQ TS                                               62350037
623600              QUEUE  (ASC-SEL-QUEUE-NAME)                         62360037
623700              FROM   (RC013-DC-SELECT-RECORD)                     62370037
623800              ITEM   (ASC-SEL-ITEM)                               62380037
623900              RESP   (PV-CICS-RESPONSE)                           62390037
624000              REWRITE                                             62400037
624100     END-EXEC.                                                    62410037
624200                                                                  62420037
624300     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               62430037
624400         SET DP013-CICS-ABEND                                     62440037
624500             DP013-NO-ROLLBACK     TO TRUE                        62450037
624600         MOVE '9200-REWRITE-LIST-QUEUE'                           62460037
624700                                   TO DP013-PARAGRAPH             62470037
624800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   62480037
624900                                   TO DP013-MESSAGE-TEXT (1)      62490037
625000         PERFORM DP013-0000-PROCESS-ABEND                         62500037
625100     END-IF.                                                      62510037
625200                                                                  62520037
625300 9300-CALL-PO-RCVR-TRKING-MOD.                                    62530061
625400                                                                  62540061
625500     MOVE DK-PO-NBR                 TO RC071-PO-NBR               62550061
625600     MOVE DK-REC-SEQ-NBR            TO RC071-PO-RCVR              62560061
625700     IF RC071-DC-FUNCTION-CODE = '0B'                             62570061
625800         MOVE ZEROES                    TO RC071-PREPK-ID         62580061
625900         MOVE ZEROES                    TO RC071-PO-LINE          62590061
626000     ELSE                                                         62600061
626100         IF RECEIV-PKGNG-CDE = 'I' OR 'M'                         62610061
626200            MOVE RECITM-PREPK-ID           TO RC071-PREPK-ID      62620061
626300            MOVE ZEROES                    TO RC071-PO-LINE       62630061
626400         ELSE                                                     62640061
626500            MOVE RECITM-ORD-LNE-NBR        TO RC071-PO-LINE       62650061
626600            MOVE ZEROES                    TO RC071-PREPK-ID      62660061
626700         END-IF                                                   62670061
626800     END-IF.                                                      62680061
626900     MOVE ASC-OPER-UNT-ID           TO RC071-SIGNON-LOCATION      62690061
627000     MOVE DP020-USERID              TO RC071-USER-ID              62700061
627100     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      62710061
627200                                                                  62720061
627300     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  62730061
627400                                        RC071-COMMAREA            62740061
627500                                        RC071-FIELDS.             62750061
627600                                                                  62760061
627700     IF RC071-SUCCESSFUL                                          62770061
627800         CONTINUE                                                 62780061
627900     ELSE                                                         62790061
628000         SET DP013-NO-ROLLBACK                                    62800061
628100             DP013-XCTL-DISPLAY-RESTART                           62810061
628200             DP013-CICS-ABEND      TO TRUE                        62820061
628300         MOVE '9300-CALL-PO-RCVR-TRKING-MOD'                      62830061
628400                                   TO DP013-PARAGRAPH             62840061
628500         MOVE DK-PO-NBR            TO PV-DISPLAY-PO               62850061
628600         MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR             62860061
628700         STRING                                                   62870061
628800               'CALL TO RCKUT137 NOT SUCCESSFUL '                 62880061
628900               'RETURN CODE = '                                   62890061
629000               RC071-SUCCESS-IND                                  62900061
629100                                DELIMITED BY SIZE                 62910061
629200                                 INTO DP013-MESSAGE-TEXT (2)      62920061
629300         STRING 'PO/RECEIVER = '                                  62930061
629400                 PV-DISPLAY-PO                                    62940061
629500                 ' '                                              62950061
629600                 PV-DISPLAY-RCVR                                  62960061
629700                                DELIMITED BY SIZE                 62970061
629800                                 INTO DP013-MESSAGE-TEXT (3)      62980061
629900         PERFORM DP013-0000-PROCESS-ABEND                         62990061
630000                                                                  63000061
630100      END-IF.                                                     63010061
630200                                                                  63020061
630300/                                                                 63030037
630400*----------------------------------------------------------------*63040037
630500*    WRITE A FORMATTED MESSAGE OUT TO THE CICS LOG FILE          *63050037
630600*----------------------------------------------------------------*63060037
630700 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  63070037
630800                                                                  63080037
630900     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              63090037
631000     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             63100037
631100     INITIALIZE DP013-SRC-TASK-NUMBER                             63110037
631200                DP013-STACK.                                      63120037
631300     SET DP013-LINK-RETURN         TO TRUE.                       63130037
631400                                                                  63140037
631500     EXEC CICS                                                    63150037
631600         LINK PROGRAM  (DP013-NAME)                               63160037
631700              COMMAREA (DP013-PARAMETERS)                         63170037
631800              LENGTH   (DP013-LENGTH)                             63180037
631900     END-EXEC.                                                    63190037
632000/                                                                 63200037
632100*----------------------------------------------------------------*63210037
632200*    ABEND PROCESSOR MODULE                                      *63220037
632300*----------------------------------------------------------------*63230037
632400                                                                  63240037
632500     COPY DPPD013.                                                63250037
