000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS577.                                         00040000
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  DECEMBER 2001.                                    00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S577 - SU-AUDIT RANK LIST                                  * 00110000
001200*    AUDIT RANK LIST - SULRNKLT                                 * 00120000
001300*    THIS PROGRAM DISPLAYS A LIST OF AUDIT PARAMETER RANKINGS   * 00130000
001600*    THIS PROGRAM ALSO ALLOWS THE ASSOCIATE TO DELETE AN        * 00160000
001610*    EXISTING RANK IF IT DOES NOT EXIST ON THE VEND DEPT RNKNG, * 00161000
001620*    VND RNKNG OR PO AUDIT REQUEST TABLES.                      * 00162000
001700*---------------------------------------------------------------* 00170000
001500*    CHANGES                                                     *00171000
      *    MADE BY: SHOBHIT BAIJAL       PR#5148D                      *00172000
      *    DATE:    10/07/2013                                         *00173000
      *                                                                *00174000
      *    NEW COLUMN 'RFID' WAS ADDED TO THE SCREEN FOR RFID RANK LIST*00175000
      *    CHANGES CAN BE FOUND WITH *SB 10/07/13                      *00176000
      *                                                                *00177000
001600*----------------------------------------------------------------*00178000
273427* CHANGED 08/15/2022    BY BARB SCHULTZ    WR: CHG0273427         00179065
273427* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00179165
273427* MAKING THE CALL DYNAMIC VS STATIC.                              00179265
001130*                                                                 00179366
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00179466
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00179566
273427*----------------------------------------------------------------*00179665
001800 EJECT                                                            00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000                                                                  00200000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500 01  DK-DB2-KEYS.                                                 00250000
002800     05  DK-VND-RNKG-CDE                PIC  X(06)  VALUE SPACES. 00280000
004100                                                                  00410000
004200                                                                  00420000
004300 01  PC-PROGRAM-CONSTANTS.                                        00430000
004400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00440000
004500                                                    'SUK577  '.   00450000
004600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00460000
004700                                                    'SUKM577 '.   00470000
004800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00480000
004900                                                    'SUKCS577'.   00490000
005900     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00590000
006000     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00600000
006100     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00610000
006200     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00620000
006300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00630000
006400                                                    COMP SYNC.    00640000
006500     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00650000
006600                                                    COMP SYNC.    00660000
006700     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00670000
006800                                                    +1000000      00680000
006900                                                    COMP-3.       00690000
007000     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00700000
007100                                                    COMP SYNC.    00710000
007200     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00720000
007300                                                    COMP-3.       00730000
007500     05  PC-A                           PIC  X(01)  VALUE  'A'.   00750000
007510     05  PC-X                           PIC  X(01)  VALUE  'X'.   00751000
007600     05  PC-DEFAULT                     PIC  X(06)  VALUE         00760000
007900                                                     'DEFALT'.    00790000
008000     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00800000
008100     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00810000
008200     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00820000
008300     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00830000
008900*MESSAGE DEFINITIONS                                              00890000
009000*----------------------------------------------------------------*00900000
009100*  SYSTEM MESSAGES                                               *00910000
009200*----------------------------------------------------------------*00920000
009300*   00005 - INVALID VALUE                                        *00930000
009400*   00008 - MUST BE NUMERIC                                      *00940000
009500*   00045 - INVALID FUNCTION KEY                                 *00950000
009600*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00960000
009700*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00970000
009800*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00980000
009900*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00990000
010000*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01000000
010100*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01010000
010200*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01020000
010300*   00069 - TOP OF LIST                                          *01030000
010400*   00070 - BOTTOM OF LIST                                       *01040000
010500*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01050000
010600*   00279 - MORE ITEMS TO DISPLAY                                *01060000
010800*   00954 - PO/RECEIVER SEQUENCE NOT FOUND                       *01080000
010900*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01090000
011000*   02234 - PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S)*01100000
011100*   02238 - PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT HAV*01110000
011200*   02479 - RECEIVER SEQUENCE NUMBER MUST BE GREATER THAN ZERO   *01120000
011400*   02679 - UNABLE TO RE-ACTIVATE, NO INACTIVE SMOOTHING EXISTS F*01140000
011500*   02680 - NUMBER OF CRTNS MUST EQUAL NBR OF CRTNS FROM ORIGINAL*01150000
011600*   02681 - RE-ACTIVATION SUCCESSFUL                             *01160000
011700*   02683 - VEND UCC128 DATA EXISTS - F2 TO CONFIRM SMOOTHING    *01170000
011800*   02684 - SMOOTHING HAS NOT OCCURRED, UNABLE TO PERFORM FUNCTIO*01180000
011900*   02688 - UNABLE TO PERFORM FUNCTION, CARTON INACTIVE          *01190000
012000*   02691 - ONE OR MORE STORE(S) SELECTED HAS NOT BEEN SMOOTHED  *01200000
012100*   02692 - INVALID STATUS FOR FUNCTION REQUESTED                *01210000
012200*   02693 - COMMUNICATION ERROR WHEN CREATING LABELS - CONTACT SU*01220000
012300*   02694 - DATABASE ERROR WHEN CREATING LABELS - CONTACT SUPERVI*01230000
012400*   02720 - YOU DO NOT HAVE AUTHORITY TO INACTIVATE SMOOTHING    *01240000
012600                                                                  01260000
012700     05  PC-TSYMSG-NUMBERS.                                       01270000
012800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01280000
012900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01290000
013000         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01300000
013100         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01310000
013200         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01320000
013300         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01330000
013400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01340000
013500         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01350000
013600         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01360000
013700         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01370000
013800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01380000
013900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01390000
014000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01400000
014010         10  PC-TSYMSG-00115            PIC  9(05)  VALUE 00115.  01401000
014020         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01402000
014200         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01420000
015611         10  PC-TSYMSG-02790            PIC  9(05)  VALUE 02790.  01561100
015612         10  PC-TSYMSG-02843            PIC  9(05)  VALUE 02843.  01561200
015613         10  PC-TSYMSG-02848            PIC  9(05)  VALUE 02848.  01561300
015614         10  PC-TSYMSG-02849            PIC  9(05)  VALUE 02849.  01561400
015615         10  PC-TSYMSG-02855            PIC  9(05)  VALUE 02855.  01561500
015620*                                                                 01562000
015630 01  PS-PROGRAM-SWITCHES.                                         01563000
015640     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01564000
015650         88  PS-NO-ERROR                            VALUE 'Y'.    01565000
015660         88  PS-ERROR                               VALUE 'N'.    01566000
015670     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01567000
015680         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01568000
015690         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01569000
016300     05  PS-LIST-END-SW           PIC  X(01)  VALUE 'N'.          01630000
016400         88  PS-LIST-END                      VALUE 'Y'.          01640000
016500         88  PS-NO-LIST-END                   VALUE 'N'.          01650000
016600     05  PS-BLOCK-ERROR-SW        PIC  X(01)  VALUE 'Y'.          01660000
016700         88  PS-NO-BLOCK-ERROR                VALUE 'Y'.          01670000
016800         88  PS-BLOCK-ERROR                   VALUE 'N'.          01680000
022310     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    02231000
022320         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    02232000
022330         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    02233000
022340     05  PS-VND-DEPT-RNKG-EXISTS-SW     PIC  X(01)  VALUE 'N'.    02234000
022350         88  PS-VND-DEPT-RNKG-EXISTS                VALUE 'Y'.    02235000
022360         88  PS-NO-VND-DEPT-RNKG-EXISTS             VALUE 'N'.    02236000
022370     05  PS-VND-RNKG-EXISTS-SW          PIC  X(01)  VALUE 'N'.    02237000
022380         88  PS-VND-RNKG-EXISTS                     VALUE 'Y'.    02238000
022390         88  PS-NO-VND-RNKG-EXISTS                  VALUE 'N'.    02239000
022391     05  PS-PO-AUD-REQ-EXISTS-SW        PIC  X(01)  VALUE 'N'.    02239100
022392         88  PS-PO-AUD-REQ-EXISTS                   VALUE 'Y'.    02239200
022393         88  PS-NO-PO-AUD-REQ-EXISTS                VALUE 'N'.    02239300
022394     05  PS-END-OF-PACK-TYP-CSR-SW      PIC  X(01)  VALUE 'N'.    02239400
022395         88  PS-END-OF-PACK-TYP-CSR                 VALUE 'Y'.    02239500
022396         88  PS-NOT-END-OF-PACK-TYP-CSR             VALUE 'N'.    02239600
022397     05  PS-PKGNG-TYP-CDE-BC-SW         PIC  X(01)  VALUE 'N'.    02239700
022398         88  PS-PKGNG-TYP-CDE-BC-YES                VALUE 'Y'.    02239800
022399         88  PS-PKGNG-TYP-CDE-BC-NO                 VALUE 'N'.    02239900
022400     05  PS-PKGNG-TYP-CDE-PP-SW         PIC  X(01)  VALUE 'N'.    02240000
022401         88  PS-PKGNG-TYP-CDE-PP-YES                VALUE 'Y'.    02240100
022402         88  PS-PKGNG-TYP-CDE-PP-NO                 VALUE 'N'.    02240200
022403     05  PS-PKGNG-TYP-CDE-PS-SW         PIC  X(01)  VALUE 'N'.    02240300
022404         88  PS-PKGNG-TYP-CDE-PS-YES                VALUE 'Y'.    02240400
022405         88  PS-PKGNG-TYP-CDE-PS-NO                 VALUE 'N'.    02240500
      *SB 10/07/13 - BEGIN PR#5148D                                     02240600
           05  PS-PKGNG-TYP-CDE-RF-SW         PIC  X(01)  VALUE 'N'.    02240700
               88  PS-PKGNG-TYP-CDE-RF-YES                VALUE 'Y'.    02240800
               88  PS-PKGNG-TYP-CDE-RF-NO                 VALUE 'N'.    02240900
      *SB 10/07/13 - END PR#5148D                                       02241000
022410*                                                                 02242000
022500 01  DN-DB2-NULL-INDICATORS.                                      02250000
022800     05  DN-CRE-TM                  PIC S9(04) COMP VALUE ZEROES. 02280000
022900*                                                                 02290000
023000 01  PV-PROGRAM-VARIABLES.                                        02300000
023100     05  PV-SEL-TERM-ID                  PIC  X(04).              02310000
023200     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02320000
023300     05  PV-SEL-SEQ                      PIC  9(01).              02330000
023400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02340000
023500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02350000
023600                                                     COMP SYNC.   02360000
023700     05  PV-SUB                         PIC S9(04)  VALUE +0      02370000
023800                                                    COMP SYNC.    02380000
023900     05  PV-DB2-CURRENT-DATE            PIC X(10).                02390000
024000     05  PV-PLND-INV-DTE-FUNC-QTY       PIC X(10).                02400000
024100     05  PV-DB2-CURRENT-TIMESTAMP       PIC X(26).                02410000
024200     05  PV-CURRENT-DATE                PIC X(10).                02420000
024300     05  PV-CURRENT-TIME                PIC  9(06).               02430000
024700     05  PV-NUMBER-OF-UPDATES           PIC S9(04)  VALUE +0      02470000
024800                                                    COMP-3.       02480000
025010     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02501000
025020                                                    COMP SYNC.    02502000
025030     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02503000
025040                                                    COMP-3.       02504000
025050     05  PV-COUNT                       PIC S9(09)  VALUE +0      02505000
025060                                                    COMP-3.       02506000
025090     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02509000
025100                                                    COMP-3.       02510000
025200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02520000
025300                                                    COMP-3.       02530000
025400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02540000
025500                                                    COMP-3.       02550000
025600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02560000
025700                                                    COMP SYNC.    02570000
025800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02580000
025900                                                    COMP SYNC.    02590000
026000     05  PV-ITEM                        PIC S9(04)  VALUE +0      02600000
026100                                                    COMP SYNC.    02610000
026200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02620000
026300                                                    COMP SYNC.    02630000
026400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02640000
026500                                                    COMP SYNC.    02650000
026600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02660000
026700                                                    COMP SYNC.    02670000
026800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02680000
026900                                                    COMP SYNC.    02690000
027000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02700000
027100                                                    COMP SYNC.    02710000
027200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02720000
027300                                                    COMP SYNC.    02730000
027400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02740000
027500                                                    COMP SYNC.    02750000
027600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02760000
027700                                                    COMP SYNC.    02770000
027800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02780000
027900                                                    COMP SYNC.    02790000
028000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02800000
028100                                                    COMP SYNC.    02810000
028200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02820000
028300                                                    COMP SYNC.    02830000
028400     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02840000
028500                                                    COMP-3.       02850000
036200*                                                                 03620000
036300     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      03630000
036400                                                    COMP-3.       03640000
036500     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      03650000
036600                                                    COMP SYNC.    03660000
036700     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       03670000
036800     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       03680000
036900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      03690000
037000                                                    COMP-3.       03700000
037900                                                                  03790000
038000******************************************************************03800000
038100**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03810000
038200**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03820000
038300**  APPLICATION-SPECIFIC COMMAREA.                              **03830000
038400******************************************************************03840000
038500 01  LQW-LIST-QUEUE-WORK-AREA.                                    03850000
038600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03860000
038700     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           03870000
038800                                        INDEXED BY LQW-IDX.       03880000
038900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03890000
039000*                                                                 03900000
039100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03910000
039200         10  LQW-SELECTED-SW            PIC  X(01).               03920000
039300             88  LQW-SELECT                         VALUE 'S'.    03930000
039400             88  LQW-DESELECT                       VALUE ' '.    03940000
039500             88  LQW-PRT                            VALUE 'P'.    03950000
039600         10  LQW-ACTION                 PIC  X(03).               03960000
039700         10  LQW-AUDIT-RANK             PIC  X(06).               03970000
039800         10  LQW-AUDIT-DESC             PIC  X(30).               03980000
039900         10  LQW-RANK-BULK-CSE          PIC  X(01).               03990000
040000         10  LQW-RANK-PREPK             PIC  X(01).               04000000
040100         10  LQW-RANK-PBS               PIC  X(01).               04010000
      *SB 10/07/13 - BEGIN PR#5148D                                     04011000
               10  LQW-RANK-RFID              PIC  X(01).               04020000
      *SB 10/07/13 - END PR#5148D                                       04030000
042600                                                                  04260000
042610                                                                  04261000
042620     EJECT                                                        04262000
042630*---------------------------------------------------------------* 04263000
042640*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 04264000
042641*---------------------------------------------------------------* 04264100
042642                                                                  04264200
042643     COPY SUWS016.                                                04264300
042645                                                                  04264500
042900/                                                                 04290000
043000*----------------------------------------------------------------*04300000
043100*  WORK AREA PASSED IN CALL TO DPKUT500                          *04310000
043200*----------------------------------------------------------------*04320000
043300     COPY DPWS500.                                                04330000
043400                                                                  04340000
043500*----------------------------------------------------------------*04350000
043600*    CURRENT DATE COPYBOOK.                                       04360000
043700*----------------------------------------------------------------*04370000
043800                                                                  04380000
043900     COPY DPWS017.                                                04390000
044000*----------------------------------------------------------------*04400000
044100*  SENDING/RECEIVING AREA FOR THE                                 04410000
044200*  PRINTER VALIDATION ROUTING (DPKCS060)                          04420000
044300*----------------------------------------------------------------*04430000
044400     COPY DPWS072.                                                04440000
044500                                                                  04450000
044600*---------------------------------------------------------------* 04460000
044700*    MAP LAYOUT                                                 * 04470000
044800*---------------------------------------------------------------* 04480000
044900                                                                  04490000
045000     COPY SUKM577.                                                04500000
045100*                                                                 04510000
045200 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK577O.       04520000
045300     05  FILLER                         PIC X(42).                04530000
045400     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          04540000
045500         10  MR-SELECTL                 PIC S9(04) COMP.          04550000
045600         10  MR-SELECTA                 PIC  X(01).               04560000
045700         10  MR-SELECTC                 PIC  X(01).               04570000
045800         10  MR-SELECTH                 PIC  X(01).               04580000
045900         10  MR-SELECTI                 PIC  X(01).               04590000
046000                                                                  04600000
046100         10  MR-ACTIONL                 PIC S9(04) COMP.          04610000
046200         10  MR-ACTIONA                 PIC  X(01).               04620000
046300         10  MR-ACTIONC                 PIC  X(01).               04630000
046400         10  MR-ACTIONH                 PIC  X(01).               04640000
046500         10  MR-ACTION                  PIC  X(03).               04650000
046600                                                                  04660000
046700         10  MR-AUDIT-RANKL                PIC S9(04) COMP.       04670000
046800         10  MR-AUDIT-RANKA                PIC  X(01).            04680000
046900         10  MR-AUDIT-RANKC                PIC  X(01).            04690000
047000         10  MR-AUDIT-RANKH                PIC  X(01).            04700000
047100         10  MR-AUDIT-RANK                 PIC  X(06).            04710000
047300                                                                  04730000
047400         10  MR-AUDIT-DESCL                PIC S9(04) COMP.       04740000
047500         10  MR-AUDIT-DESCA                PIC  X(01).            04750000
047600         10  MR-AUDIT-DESCC                PIC  X(01).            04760000
047700         10  MR-AUDIT-DESCH                PIC  X(01).            04770000
047800         10  MR-AUDIT-DESC                 PIC  X(30).            04780000
048000                                                                  04800000
048700         10  MR-RANK-BULK-CSEL             PIC S9(04) COMP.       04870000
048800         10  MR-RANK-BULK-CSEA             PIC  X(01).            04880000
048900         10  MR-RANK-BULK-CSEC             PIC  X(01).            04890000
049000         10  MR-RANK-BULK-CSEH             PIC  X(01).            04900000
049100         10  MR-RANK-BULK-CSE              PIC  X(01).            04910000
049200                                                                  04920000
049400         10  MR-RANK-PREPKL                PIC S9(04) COMP.       04940000
049500         10  MR-RANK-PREPKA                PIC  X(01).            04950000
049600         10  MR-RANK-PREPKC                PIC  X(01).            04960000
049700         10  MR-RANK-PREPKH                PIC  X(01).            04970000
049800         10  MR-RANK-PREPK                 PIC  X(01).            04980000
049900                                                                  04990000
049910         10  MR-RANK-PBSL                  PIC S9(04) COMP.       04991000
049920         10  MR-RANK-PBSA                  PIC  X(01).            04992000
049930         10  MR-RANK-PBSC                  PIC  X(01).            04993000
049940         10  MR-RANK-PBSH                  PIC  X(01).            04994000
049950         10  MR-RANK-PBS                   PIC  X(01).            04995000
049900                                                                  04997000
      *SB 10/07/13 - BEGIN PR#5148D                                     04997100
               10  MR-RANK-RFIDL                 PIC S9(04) COMP.       04998000
               10  MR-RANK-RFIDA                 PIC  X(01).            04999000
               10  MR-RANK-RFIDC                 PIC  X(01).            04999100
               10  MR-RANK-RFIDH                 PIC  X(01).            04999200
               10  MR-RANK-RFID                  PIC  X(01).            04999300
      *SB 10/07/13 - END PR#5148D                                       04999400
049960                                                                  04999500
050000     05  FILLER                         PIC  X(13).               05000000
050100                                                                  05010000
050200                                                                  05020000
050300     EJECT                                                        05030000
050400/                                                                 05040000
050500*----------------------------------------------------------------*05050000
050600*  RANDOM NUMBER AREA                                             05060000
050700*----------------------------------------------------------------*05070000
050800     COPY DPWS902.                                                05080000
050900                                                                  05090000
051000*----------------------------------------------------------------*05100000
051100**  SECURITY SUBROUTINE PARAMETERS                                05110000
051200*----------------------------------------------------------------*05120000
051300     COPY DPWS008.                                                05130000
051400*---------------------------------------------------------------* 05140000
051500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05150000
051600*---------------------------------------------------------------* 05160000
051700                                                                  05170000
051800     COPY DPWS015.                                                05180000
051900                                                                  05190000
052000*---------------------------------------------------------------* 05200000
052100*    FUNCTION KEYS COPYBOOK.                                    * 05210000
052200*---------------------------------------------------------------* 05220000
052300                                                                  05230000
052400     COPY DPWS016.                                                05240000
052500                                                                  05250000
052600*---------------------------------------------------------------* 05260000
052700*    NUMERIC EDIT LAYOUT.                                       * 05270000
052800*---------------------------------------------------------------* 05280000
052900                                                                  05290000
053000     COPY DPWS010I.                                               05300000
053100 EJECT                                                            05310000
053200*---------------------------------------------------------------* 05320000
053300*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 05330066
053400*---------------------------------------------------------------* 05340000
053500                                                                  05350000
053600     COPY DPWS030.                                                05360000
053600     COPY DPWS930.                                                05361066
053700 EJECT                                                            05370000
053800*---------------------------------------------------------------* 05380000
053900*    STANDARD COMMAREA.                                         * 05390000
054000*---------------------------------------------------------------* 05400000
054100                                                                  05410000
054200     COPY DPWS020.                                                05420000
054300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05430000
054400                                                                  05440000
054500*---------------------------------------------------------------* 05450000
054600* INTER-APPLICATION COMMAREA.                                   * 05460000
054700*   SUWS014 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05470000
054800*             SPEC SCREEN.                                      * 05480000
054900*   SUWS015 - IS THE INPUT  LAYOUT THAT WILL BE PASSED TO THE   * 05490000
055000*             ADD/UPDATE SCREEN.                                * 05500000
055100*---------------------------------------------------------------* 05510000
055200                                                                  05520000
055300         10  INTER-APPL-COMM-AREA       PIC X(200).               05530000
055400     COPY SUWS014.                                                05540000
055500     COPY SUWS015.                                                05550000
055900*---------------------------------------------------------------* 05590000
056000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05600000
056100*---------------------------------------------------------------* 05610000
056200         10  ASC-SPECIFIC-COMMAREA.                               05620000
056700             15  ASC-LIST-KEYS.                                   05670000
057800                 20  ASC-AUDIT-RANK-KEY              PIC  X(06).  05780000
057900                 20  ASC-AUDIT-DESC-KEY              PIC  X(30).  05790000
058800             15  ASC-BLK-SUB                         PIC S9(04)   05880000
058900                                                          COMP    05890000
059000                                                          SYNC.   05900000
059100             15  ASC-ITEM-SUB                        PIC S9(04)   05910000
059200                                                          COMP    05920000
059300                                                          SYNC.   05930000
059400             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05940000
059500                                                          COMP-3. 05950000
059600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05960000
059700                                                          COMP-3. 05970000
059800             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05980000
059900                                                          COMP-3. 05990000
060000             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   06000000
060100                                                          COMP-3. 06010000
060200             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   06020000
060300                                                          COMP-3. 06030000
060400             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   06040000
060500                                                          COMP    06050000
060600                                                          SYNC.   06060000
060700             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06070000
060800                                                          COMP-3. 06080000
060900             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06090000
061000                                                          COMP-3. 06100000
061100             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06110000
061200                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06120000
061300                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06130000
061400             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  06140000
061500                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06150000
061600                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06160000
061700             15  ASC-LIST-QUEUE-NAME.                             06170000
061800                 20  ASC-LIST-TERM-ID                PIC  X(04).  06180000
061900                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06190000
062000                                                          COMP-3. 06200000
062100                 20  ASC-LIST-SEQ                    PIC  9(01).  06210000
062200             15  ASC-SEL-QUEUE-NAME.                              06220000
062300                 20  ASC-SEL-TERM-ID          PIC  X(04).         06230000
062400                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  06240000
062500                 20  ASC-SEL-SEQ              PIC  9(01).         06250000
062600             15  ASC-SEL-QUEUE-NAME-IN.                           06260000
062700                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         06270000
062800                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  06280000
062900                 20  ASC-SEL-SEQ-IN           PIC  9(01).         06290000
063000                                                                  06300000
063100             15  ASC-START-ITEM-REQUEST.                          06310000
063200                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06320000
063300*                                                                 06330000
063400             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06340000
063500             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06350000
063600             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06360000
063700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06370000
063800             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06380000
063900                                                                  06390000
064000                                                                  06400000
064100             15  ASC-FUNC01-RETURN-FLAG       PIC  X(1).          06410000
064200                 88  ASC-FUNC01-RETURN-NO   VALUE 'N'.            06420000
064300                 88  ASC-FUNC01-RETURN-YES  VALUE 'Y'.            06430000
064400                                                                  06440000
064500             15  ASC-FUNC02-RETURN-FLAG       PIC  X(1).          06450000
064600                 88  ASC-FUNC02-RETURN-NO   VALUE 'N'.            06460000
064700                 88  ASC-FUNC02-RETURN-YES  VALUE 'Y'.            06470000
064800                                                                  06480000
065600                                                                  06560000
065700             15  ASC-CONFIRM-TYPE-IND         PIC  X(01).         06570000
065800                 88  ASC-CONFIRM-UCC128          VALUE 'U'.       06580000
065900                 88  ASC-NO-CONFIRM-UCC128       VALUE 'N'.       06590000
066000                                                                  06600000
066100             15  ASC-CONFIRM-DELETE-SW        PIC  X(01).         06610000
066200                 88  ASC-CONFIRM-DELETE          VALUE 'I'.       06620000
066300                 88  ASC-NO-CONFIRM-DELETE       VALUE 'N'.       06630000
067000                                                                  06700000
067100             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06710000
067200                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06720000
067300                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06730000
067400                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06740000
067500                                                                  06750000
067600                 20  ASC-ITEM-ARRAY.                              06760000
067610                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        06761000
067620                         30  ASC-LIST-ITEM-NUMBER                 06762000
067630                                                     PIC S9(09)   06763000
067640                                                     COMP-3.      06764000
067650                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06765000
067660                             88  ASC-VALID-SELECT    VALUE ' '    06766000
067670                                                           'S'    06767000
067680                                                           'B'    06768000
067690                                                           'E'.   06769000
067700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06770000
067800                             88  ASC-TEMP-SELECT     VALUE 'S'.   06780000
067900                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06790000
068000                             88  ASC-TEMP-END        VALUE 'E'.   06800000
068100                         30  ASC-SELECTED-SW         PIC  X(01).  06810000
068200                             88  ASC-NO-SELECT       VALUE ' '.   06820000
068300                             88  ASC-SELECT          VALUE 'S'.   06830000
068400                             88  ASC-BEGIN           VALUE 'B'.   06840000
068500                             88  ASC-END             VALUE 'E'.   06850000
068600                         30  ASC-ACTION             PIC  X(03).   06860000
068700                         30  ASC-AUDIT-RANK         PIC  X(06).   06870000
068800                         30  ASC-AUDIT-DESC         PIC  X(30).   06880000
068900                         30  ASC-RANK-BULK-CSE      PIC  X(01).   06890000
069000                         30  ASC-RANK-PREPK         PIC  X(01).   06900000
069100                         30  ASC-RANK-PBS           PIC  X(01).   06910000
      *SB 10/07/13 - BEGIN PR#5148D                                     06911000
                               30  ASC-RANK-RFID          PIC  X(01).   06920000
      *SB 10/07/13 - END PR#5148D                                       06930000
071700                                                                  07170000
071710     EJECT                                                        07171000
071720*---------------------------------------------------------------* 07172000
071730*    ABEND PROCESSING COPYBOOK.                                 * 07173000
071740*---------------------------------------------------------------* 07174000
071750                                                                  07175000
071751     COPY DPWS013.                                                07175100
071752                                                                  07175200
071753 EJECT                                                            07175300
071754*----------------------------------------------------------------*07175400
071756*    DB2 DCLGEN FOR THE PO AUDIT REQUEST TABLE(SUT_PO_AUD_REQ)    07175600
071757*----------------------------------------------------------------*07175700
071758     EXEC SQL                                                     07175800
071759          INCLUDE SUT00015                                        07175900
071760     END-EXEC.                                                    07176000
071761                                                                  07176100
071780*----------------------------------------------------------------*07178000
071790*    DB2 DCLGEN FOR THE VEDNOR RANKING CODE (SUT_VND_RNKG_CDE)    07179000
071800*----------------------------------------------------------------*07180000
071900     EXEC SQL                                                     07190000
072000          INCLUDE SUT00016                                        07200000
072100     END-EXEC.                                                    07210000
072200                                                                  07220000
072300*----------------------------------------------------------------*07230000
072310*----------------------------------------------------------------*07231000
072320*    DB2 DCLGEN FOR THE PO AUDIT PARM TABLE (SUT_PO_AUD_PARM)     07232000
072330*----------------------------------------------------------------*07233000
072340     EXEC SQL                                                     07234000
072350          INCLUDE SUT00017                                        07235000
072360     END-EXEC.                                                    07236000
072370                                                                  07237000
072380*----------------------------------------------------------------*07238000
072400*----------------------------------------------------------------*07240000
072500*    DB2 DCLGEN FOR THE VEDNOR DEPARTMENT RANKING                 07250000
072510*    (SUT_VND_DEPT_RNKG)                                          07251000
072600*----------------------------------------------------------------*07260000
072700     EXEC SQL                                                     07270000
072800          INCLUDE SUT00018                                        07280000
072900     END-EXEC.                                                    07290000
073000                                                                  07300000
073200*----------------------------------------------------------------*07320000
073300*    DB2 DCLGEN FOR THE VEDNOR RANKING                            07330000
073400*    (SUT_VND_RNKG)                                               07340000
073500*----------------------------------------------------------------*07350000
073600     EXEC SQL                                                     07360000
073700          INCLUDE SUT00019                                        07370000
073800     END-EXEC.                                                    07380000
073900                                                                  07390000
073910*----------------------------------------------------------------*07391000
073920*    DB2 DCLGEN FOR THE VEDNOR PACKAGING ASSOCIATION TABLE        07392000
073930*    (SUT_VND_PKGNG_ASSN)                                         07393000
073940*----------------------------------------------------------------*07394000
073950     EXEC SQL                                                     07395000
073960          INCLUDE SUT00020                                        07396000
073970     END-EXEC.                                                    07397000
073980                                                                  07398000
074000*----------------------------------------------------------------*07400000
080610*---------------------------------------------------------------* 08061000
080620*    DB2 AREA FOR COMMUNICATIONS                                * 08062000
080630*---------------------------------------------------------------* 08063000
080640     EXEC SQL                                                     08064000
080650          INCLUDE SQLCA                                           08065000
080660     END-EXEC.                                                    08066000
080670                                                                  08067000
080680******************************************************************08068000
080690*  CURSOR TO BUILD THE VENDOR RANKING LIST                     ** 08069000
080700******************************************************************08070000
080800                                                                  08080000
080900                                                                  08090000
081000     EXEC SQL                                                     08100000
081100          DECLARE VEND_RNK_CDE_CSR CURSOR FOR                     08110000
081200          SELECT VND_RNKG_CDE                                     08120000
081300               , VND_RNKG_DESC                                    08130000
081500          FROM   SUT_VND_RNKG_CDE                                 08150000
081600          ORDER BY VND_RNKG_CDE                                   08160000
082000     END-EXEC.                                                    08200000
082100                                                                  08210000
090700                                                                  09070000
090710******************************************************************09071000
090720*  CURSOR TO RETURN THE CURRENT VENDOR RANKING BY PACK TYPE    ** 09072000
090730******************************************************************09073000
090740                                                                  09074000
090750                                                                  09075000
090760     EXEC SQL                                                     09076000
090770          DECLARE PACK_TYPE_CSR CURSOR FOR                        09077000
090780          SELECT DISTINCT(PKGNG_TYP_CDE)                          09078000
090791          FROM   SUT_PO_AUD_PARM                                  09079100
090792          WHERE  VND_RNKG_CDE  =  :SUT00016-VND-RNKG-CDE          09079200
090793     END-EXEC.                                                    09079300
090794                                                                  09079400
090795                                                                  09079500
090800*---------------------------------------------------------------* 09080000
090900                                                                  09090000
091000                                                                  09100000
091100 EJECT                                                            09110000
091200 LINKAGE SECTION.                                                 09120000
091300                                                                  09130000
091400 01  DFHCOMMAREA.                                                 09140000
091500     05  FILLER                         OCCURS  1 TO 4072 TIMES   09150000
091600                                        DEPENDING ON EIBCALEN.    09160000
091700         10  FILLER                     PIC X.                    09170000
091800                                                                  09180000
091900 EJECT                                                            09190000
092000 PROCEDURE DIVISION.                                              09200000
092100******************************************************************09210000
092200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09220000
092300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09230000
092400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09240000
092500******************************************************************09250000
092600 0000-MAIN-MODULE.                                                09260000
092700     INITIALIZE DP030-CICS-API-FIELDS.                            09270000
092800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09280000
092900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09290000
093000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09300000
093100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09310000
093200     MOVE LENGTH OF SUK577I        TO DP030-MAP-LENGTH (1).       09320000
093300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09330000
093400     PERFORM 0001-CALL-CICS-ARCH-API.                             09340000
093500                                                                  09350000
093600     PERFORM 1000-CONTROL-PROCESSING                              09360000
093700                                                                  09370000
093800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09380000
093900     PERFORM 0001-CALL-CICS-ARCH-API.                             09390000
094000                                                                  09400000
094100******************************************************************09410000
094200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09420000
094300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **09430000
094400******************************************************************09440000
094500 0001-CALL-CICS-ARCH-API.                                         09450000
094600*    CALL 'DPKCS030' USING DFHEIBLK                               09460066
094600     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09461066
094700                           DFHCOMMAREA                            09470000
094800                           DP030-CICS-API-FIELDS                  09480000
094900                           DP020-STANDARD-COMMAREA                09490000
095000                           SUK577I.                               09500000
095100                                                                  09510000
095200     IF  DP030-RC-CALL-SUCCESSFUL                                 09520000
095300         CONTINUE                                                 09530000
095400     ELSE                                                         09540000
095500         SET DP013-NO-ROLLBACK                                    09550000
095600             DP013-XCTL-DISPLAY-RESTART                           09560000
095700             DP013-CICS-ABEND      TO TRUE                        09570000
095800         MOVE '0001-CALL-CICS-ARCH-API'                           09580000
095900                                   TO DP013-PARAGRAPH             09590000
096000*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX09600066
096100*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      09610066
096000         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O09611066
096100-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09612066
096200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09620000
096300         PERFORM DP013-0000-PROCESS-ABEND                         09630000
096400     END-IF.                                                      09640000
096500*----------------------------------------------------------------*09650000
096600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09660000
096700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09670000
096800*                                                                *09680000
096900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09690000
097000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09700000
097100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09710000
097200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09720000
097300*----------------------------------------------------------------*09730000
097400                                                                  09740000
097500 1000-CONTROL-PROCESSING.                                         09750000
097600                                                                  09760000
097700     EVALUATE TRUE                                                09770000
097800         WHEN DP020-NEXT-ACT-INITIAL                              09780000
097900             INITIALIZE ASC-SPECIFIC-COMMAREA                     09790000
098000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09800000
098100                                      ASC-SEL-TERM-ID             09810000
098200             MOVE DP020-SRC-TASK-NUMBER                           09820000
098300                                   TO ASC-LIST-TASK-NUMBER        09830000
098400                                      ASC-SEL-TASK-NUMBER         09840000
098500             MOVE PC-LIST-QUEUE-SEQ                               09850000
098600                                   TO ASC-LIST-SEQ                09860000
098700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09870000
098800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09880000
098900***-----$TEMPLATE NOTE$-------------------------------------------09890000
099000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,09900000
099100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  09910000
099200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.09920000
099300***---------------------------------------------------------------09930000
099400             PERFORM 4000-BUILD-INITIAL-PANEL                     09940000
099500                                                                  09950000
099600         WHEN DP020-NEXT-ACT-READ-MAP                             09960000
099700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09970000
099800                                   TO PV-TOP-ITEM                 09980000
099900             PERFORM 2000-PROCESS-PANEL                           09990000
100000                                                                  10000000
100100         WHEN DP020-NEXT-ACT-RETURN                               10010000
100110            IF ASC-FUNC02-RETURN-YES                              10011000
100200               MOVE ASC-ITEM-AT-TOP-OF-PANEL                      10020000
100300                                     TO PV-TOP-ITEM               10030000
100400               MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL  10040000
100500               PERFORM 6000-REFRESH-PANEL-FROM-TEMP               10050000
100501               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               10050100
100503            ELSE                                                  10050300
100504               PERFORM 2050-DELETE-LIST-QUEUE                     10050400
100505               PERFORM 4000-BUILD-INITIAL-PANEL                   10050500
100700            END-IF                                                10070000
100800         WHEN OTHER                                               10080000
100900             SET DP013-LOGIC-ABEND TO TRUE                        10090000
101000             SET DP013-NO-ROLLBACK TO TRUE                        10100000
101100             MOVE '1000-CONTROL-PROCESSING'                       10110000
101200                                   TO DP013-PARAGRAPH             10120000
101300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10130000
101400                                   TO DP013-MESSAGE-TEXT(1)       10140000
101500             PERFORM DP013-0000-PROCESS-ABEND                     10150000
101600     END-EVALUATE.                                                10160000
101700                                                                  10170000
101800 EJECT                                                            10180000
101900*----------------------------------------------------------------*10190000
102000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10200000
102100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10210000
102200*----------------------------------------------------------------*10220000
102300                                                                  10230000
102400 1100-PROCESS-INTER-APPL-COMM.                                    10240000
102500                                                                  10250000
102600     SET PS-COMMAREA-VALID          TO TRUE.                      10260000
102700     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    10270000
105200                                                                  10520000
105300 EJECT                                                            10530000
105400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10540000
105500*1120-PREPARE-LIST-ENTRY.                                         10550000
105600*                                                                 10560000
105700*    MOVE SU016-MAX-ITEMS          TO ASC-SEL-SUB.                10570000
105800*    MOVE ZERO                     TO ASC-SEL-ITEM.               10580000
105900*    PERFORM 1130-GET-NEXT-RECORD.                                10590000
106000*                                                                 10600000
106100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10610000
106200*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*10620000
106300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10630000
106400 1130-GET-NEXT-RECORD.                                            10640000
106500                                                                  10650000
106600     ADD +1                       TO ASC-SEL-SUB.                 10660000
106700                                                                  10670000
106800     IF  ASC-SEL-SUB > SU016-MAX-ITEMS                            10680000
106900         ADD +1                   TO ASC-SEL-ITEM                 10690000
107000         MOVE +1                  TO ASC-SEL-SUB                  10700000
107100     END-IF.                                                      10710000
107200                                                                  10720000
107300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10730000
107400         PERFORM 9100-READ-SEL-QUEUE                              10740000
107500         IF  SU016-ITEM (ASC-SEL-SUB) > ZERO                      10750000
107600                                                                  10760000
107700             SET SU016-INQ (ASC-SEL-SUB)                          10770000
107800                                  TO TRUE                         10780000
107900             PERFORM 9200-REWRITE-SEL-QUEUE                       10790000
108000         ELSE                                                     10800000
108100             SUBTRACT +1 FROM ASC-SEL-SUB                         10810000
108200             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             10820000
108300             SET DP020-MSG-INFORMATIONAL                          10830000
108400                 PS-LIST-END             TO TRUE                  10840000
108500         END-IF                                                   10850000
108600     ELSE                                                         10860000
108700         SUBTRACT +1 FROM ASC-SEL-ITEM                            10870000
108800         MOVE SU016-MAX-ITEMS     TO ASC-SEL-SUB                  10880000
108900         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             10890000
109000             SET DP020-MSG-INFORMATIONAL                          10900000
109100                 PS-LIST-END             TO TRUE                  10910000
109200     END-IF.                                                      10920000
109300                                                                  10930000
109400/                                                                 10940000
109500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10950000
109600*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *10960000
109700*    PROCESSED.                                                  *10970000
109800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10980000
109900                                                                  10990000
110000 1140-GET-PREV-RECORD.                                            11000000
110100                                                                  11010000
110200     SUBTRACT +1 FROM ASC-SEL-SUB.                                11020000
110300                                                                  11030000
110400     IF  ASC-SEL-SUB < +1                                         11040000
110500         SUBTRACT +1 FROM ASC-SEL-ITEM                            11050000
110600         MOVE SU016-MAX-ITEMS     TO ASC-SEL-SUB                  11060000
110700     END-IF.                                                      11070000
110800                                                                  11080000
110900     IF  ASC-SEL-ITEM > ZERO                                      11090000
111000         PERFORM 9100-READ-SEL-QUEUE                              11100000
111100         SET SU016-INQ (ASC-SEL-SUB)                              11110000
111200                                  TO TRUE                         11120000
111300         PERFORM 9200-REWRITE-SEL-QUEUE                           11130000
111400     ELSE                                                         11140000
111500         MOVE +1                  TO ASC-SEL-ITEM                 11150000
111600                                     ASC-SEL-SUB                  11160000
111700         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11170000
111800             SET DP020-MSG-INFORMATIONAL                          11180000
111900                 PS-LIST-END             TO TRUE                  11190000
112000     END-IF.                                                      11200000
112100                                                                  11210000
112200                                                                  11220000
112300                                                                  11230000
112400*----------------------------------------------------------------*11240000
112500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11250000
112600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11260000
112700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11270000
112800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11280000
112900* FUNCTION KEYS CAN GET THIS FAR.                                *11290000
113000*----------------------------------------------------------------*11300000
113100                                                                  11310000
113200 2000-PROCESS-PANEL.                                              11320000
113300     EVALUATE TRUE                                                11330000
113400         WHEN DP020-SRC-AID = DP016-CLEAR                         11340000
113500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11350000
113600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11360000
113700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11370000
113800                                                                  11380000
113900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11390000
114000             SET ASC-NO-CONFIRM-DELETE TO TRUE                    11400000
114300             PERFORM 2050-DELETE-LIST-QUEUE                       11430000
114400             PERFORM 4000-BUILD-INITIAL-PANEL                     11440000
114500                                                                  11450000
114600         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11460000
114700             PERFORM 2140-DESELECT-ALL-ITEMS                      11470000
114800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11480000
114900                                                                  11490000
115000         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11500000
115100             PERFORM 2150-SELECT-ALL-ITEMS                        11510000
115200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11520000
115300                                                                  11530000
115400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11540000
115500           IF  ASC-USE-SELECTION-QUEUE                            11550000
115600               PERFORM 1130-GET-NEXT-RECORD                       11560000
115700               IF PS-LIST-END                                     11570000
115800                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           11580000
115900                   SET PS-NO-LIST-END TO TRUE                     11590000
116000               ELSE                                               11600000
116100                   PERFORM 2050-DELETE-LIST-QUEUE                 11610000
116200                   PERFORM 3200-RESET-ATTRIBUTES                  11620000
116300                   PERFORM 4000-BUILD-INITIAL-PANEL               11630000
116400               END-IF                                             11640000
116500            ELSE                                                  11650000
116600               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               11660000
116700*              --- BOTTOM OF LIST ---                             11670000
116800               MOVE PC-TSYMSG-00070                               11680000
116900                                 TO DP020-MSG-NUMBER              11690000
117000               SET DP020-MSG-INFORMATIONAL                        11700000
117100                                 TO TRUE                          11710000
117200           END-IF                                                 11720000
117300                                                                  11730000
117400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11740000
117500           IF  ASC-USE-SELECTION-QUEUE                            11750000
117600               PERFORM 1140-GET-PREV-RECORD                       11760000
117700               IF PS-LIST-END                                     11770000
117800                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           11780000
117900                   SET PS-NO-LIST-END                             11790000
118000                                 TO TRUE                          11800000
118100               ELSE                                               11810000
118200                   PERFORM 2050-DELETE-LIST-QUEUE                 11820000
118300                   PERFORM 3200-RESET-ATTRIBUTES                  11830000
118400                   PERFORM 4000-BUILD-INITIAL-PANEL               11840000
118500               END-IF                                             11850000
118600           ELSE                                                   11860000
118700               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               11870000
118800               MOVE PC-TSYMSG-00069                               11880000
118900                                 TO DP020-MSG-NUMBER              11890000
119000               SET DP020-MSG-INFORMATIONAL                        11900000
119100                                 TO TRUE                          11910000
119200           END-IF                                                 11920000
119300                                                                  11930000
119400         WHEN OTHER                                               11940000
119500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11950000
119600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11960000
119700             IF  PS-NO-ERROR                                      11970000
119800                 SET DP030-CONTINUE-GO                            11980000
119900                                 TO TRUE                          11990000
120000                 PERFORM 2100-CHECK-FUNCTION-KEY                  12000000
120100             ELSE                                                 12010000
120200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12020000
120300                 SET DP030-OVERRIDE-GO                            12030000
120400                                 TO TRUE                          12040000
120500             END-IF                                               12050000
120600     END-EVALUATE.                                                12060000
120700 EJECT                                                            12070000
120800*----------------------------------------------------------------*12080000
120900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12090000
121000*----------------------------------------------------------------*12100000
121100 2050-DELETE-LIST-QUEUE.                                          12110000
121200                                                                  12120000
121300     EXEC CICS                                                    12130000
121400         DELETEQ TS                                               12140000
121500             QUEUE (ASC-LIST-QUEUE-NAME)                          12150000
121600             RESP  (PV-CICS-RESP)                                 12160000
121700     END-EXEC.                                                    12170000
121800                                                                  12180000
121900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12190000
122000        (PV-CICS-RESP = DFHRESP(QIDERR))                          12200000
122100         CONTINUE                                                 12210000
122200     ELSE                                                         12220000
122300         SET DP013-CICS-ABEND      TO TRUE                        12230000
122400         SET DP013-NO-ROLLBACK     TO TRUE                        12240000
122500                                                                  12250000
122600         MOVE '2050-DELETE-LIST-QUEUE'                            12260000
122700                                   TO DP013-PARAGRAPH             12270000
122800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12280000
122900                                   TO DP013-MESSAGE-TEXT (1)      12290000
123000         PERFORM DP013-0000-PROCESS-ABEND                         12300000
123100     END-IF.                                                      12310000
123200                                                                  12320000
123300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12330000
123400 EJECT                                                            12340000
123500*----------------------------------------------------------------*12350000
123600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12360000
123700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12370000
123800* CICS ARCHITECTURE API.                                         *12380000
123900*----------------------------------------------------------------*12390000
124000***********************************                               12400000
124100* F13=ADD RANK      (LOCAL-FUNC-01)                               12410000
124200***********************************                               12420000
124300                                                                  12430000
124400 2100-CHECK-FUNCTION-KEY.                                         12440000
124500     SET SU015-UPDATE-TSQ TO TRUE.                                12450000
124600     EVALUATE TRUE                                                12460000
124610**F13=ADD RANK                                                    12461000
124700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12470000
124900              INITIALIZE SU015-INTER-APPL-COMMAREA                12490000
124910              MOVE +1        TO SU015-NUMBER-OF-SELECTED-ITEMS    12491000
125200                                                                  12520000
126300              PERFORM 5000-PREPARE-SEL-QUEUE                      12630000
126400              SET ASC-FUNC01-RETURN-YES TO TRUE                   12640000
127400                                                                  12740000
132700****F15=UPD RANK                                                  13270000
132800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13280000
133000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13300000
133100                 INITIALIZE SU015-INTER-APPL-COMMAREA             13310000
133200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13320000
133300                                TO SU015-NUMBER-OF-SELECTED-ITEMS 13330000
133400                                                                  13340000
134500                 PERFORM 5000-PREPARE-SEL-QUEUE                   13450000
134600                 SET ASC-FUNC02-RETURN-YES TO TRUE                13460000
134700             ELSE                                                 13470000
134800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13480000
134900                 SET DP030-OVERRIDE-GO                            13490000
135000                                   TO TRUE                        13500000
135100                 MOVE PC-TSYMSG-00057                             13510000
135200                                   TO DP020-MSG-NUMBER            13520000
135210                 SET DP020-MSG-WARNING                            13521000
135220                                   TO TRUE                        13522000
135230             END-IF                                               13523000
135240                                                                  13524000
145200*F16=DEL RANK                                                     14520000
152400*F2=CONFIRM                                                       15240000
152500         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    15250000
152700              IF ASC-CONFIRM-DELETE                               15270000
152900                 PERFORM 4600-PROCESS-DELETE-FUNCTION             15290000
153000                     VARYING PV-ITEM  FROM 1 BY 1                 15300000
153100                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    15310000
153200                     OR PS-ERROR                                  15320000
153300                   IF PS-NO-ERROR                                 15330000
153400                      PERFORM 2050-DELETE-LIST-QUEUE              15340000
153410                      PERFORM 4000-BUILD-INITIAL-PANEL            15341000
153500                      SET DP020-MSG-INFORMATIONAL  TO  TRUE       15350000
153600                        MOVE PC-TSYMSG-00115  TO DP020-MSG-NUMBER 15360000
153610                   ELSE                                           15361000
153611                        MOVE PC-TSYMSG-02848 TO DP020-MSG-NUMBER  15361100
153612                                                                  15361200
153613                        SET DP030-OVERRIDE-GO TO TRUE             15361300
153614                                                                  15361400
153615                        SET DP020-MSG-WARNING TO TRUE             15361500
153700                   END-IF                                         15370000
153800                   SET ASC-NO-CONFIRM-DELETE  TO TRUE             15380000
153900                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           15390000
154000              ELSE                                                15400000
155600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15560000
155700                 SET ASC-NO-CONFIRM-DELETE  TO TRUE               15570000
156000                 SET DP030-OVERRIDE-GO                            15600000
156100                                   TO TRUE                        15610000
156200                 MOVE PC-TSYMSG-00045                             15620000
156300                                   TO DP020-MSG-NUMBER            15630000
156400                 SET DP020-MSG-WARNING                            15640000
156500                                   TO TRUE                        15650000
156600              END-IF                                              15660000
156700                                                                  15670000
156800*                                                                 15680000
156900* F6 - FIRST PAGE                                                 15690000
157000*                                                                 15700000
157100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  15710000
157200             MOVE +1               TO PV-TOP-ITEM                 15720000
157300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15730000
157400*                                                                 15740000
157500* F7 - PREVIOUS PAGE                                              15750000
157600*                                                                 15760000
157700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   15770000
157800             PERFORM 2110-BROWSE-BACKWARD                         15780000
157900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15790000
158000*                                                                 15800000
158100* F8 - NEXT PAGE                                                  15810000
158200*                                                                 15820000
158300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   15830000
158400             PERFORM 2120-BROWSE-FORWARD                          15840000
158500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15850000
158600*                                                                 15860000
158700* ENTER KEY                                                       15870000
158800*                                                                 15880000
158900         WHEN DP020-SRC-AID = DP016-ENTER                         15890000
159000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15900000
159100             IF  PS-ERROR                                         15910000
159200                 CONTINUE                                         15920000
159300             ELSE                                                 15930000
159400*                PERFORM 3200-RESET-ATTRIBUTES                    15940000
159500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15950000
159600             END-IF                                               15960000
159700                                                                  15970000
159800         WHEN OTHER                                               15980000
159900             SET DP013-NO-ROLLBACK                                15990000
160000                 DP013-XCTL-DISPLAY-RESTART                       16000000
160100                 DP013-CICS-ABEND  TO TRUE                        16010000
160200             MOVE '2100-CHECK-FUNCTION-KEY'                       16020000
160300                                   TO DP013-PARAGRAPH             16030000
160400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      16040000
160500                                   TO DP013-MESSAGE-TEXT (1)      16050000
160600             PERFORM DP013-0000-PROCESS-ABEND                     16060000
160700     END-EVALUATE.                                                16070000
160800*                                                                 16080000
160900*LMM                                                              16090000
161000*----------------------------------------------------------------*16100000
161100* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR DELETING       *16110000
161200* PARAMETERS                                                     *16120000
161300*----------------------------------------------------------------*16130000
161400 2105-RACF-ACCESS.                                                16140000
161500                                                                  16150000
161600      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  16160000
161700      SET DP008-ACCESS-TYPE-USE          TO TRUE                  16170000
161800                                                                  16180000
161900      EXEC CICS                                                   16190000
162000         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 16200000
162100              COMMAREA (DP008-SECURITY-COMMAREA)                  16210000
162200              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             16220000
162300      END-EXEC                                                    16230000
162400                                                                  16240000
162500      IF DP008-CALL-SUCCESSFUL                                    16250000
162600         IF DP008-ACCESS-ALLOWED                                  16260000
162700             SET PS-ACCESS-ALLOWED TO TRUE                        16270000
162800         ELSE                                                     16280000
162900             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    16290000
163000         END-IF                                                   16300000
163100     ELSE                                                         16310000
163200         MOVE '2105-RACF-ACCESS'                                  16320000
163300                               TO DP013-PARAGRAPH                 16330000
163400          MOVE 'UNABLE TO ACCESS CICS'                            16340000
163500                               TO DP013-MESSAGE-TEXT (1)          16350000
163600          MOVE SQLCA                 TO DP013-SQLCA               16360000
163700          SET DP013-DB2-ABEND                                     16370000
163800              DP013-XCTL-DISPLAY-RESTART                          16380000
163900                               TO TRUE                            16390000
164000          PERFORM DP013-0000-PROCESS-ABEND                        16400000
164100      END-IF.                                                     16410000
164200                                                                  16420000
164300                                                                  16430000
164400*----------------------------------------------------------------*16440000
164500*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16450000
164600*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16460000
164700*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16470000
164800*    MESSAGE.                                                    *16480000
164900*----------------------------------------------------------------*16490000
165000                                                                  16500000
165100 2110-BROWSE-BACKWARD.                                            16510000
165200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    16520000
165300         GIVING PV-TOP-ITEM.                                      16530000
165400                                                                  16540000
165500     IF  ((PV-TOP-ITEM < +1)                                      16550000
165600       OR (PV-TOP-ITEM = +1))                                     16560000
165700         MOVE +1                   TO PV-TOP-ITEM                 16570000
165800*        -- TOP OF LIST --                                        16580000
165900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16590000
166000         SET DP020-MSG-INFORMATIONAL TO TRUE                      16600000
166100     END-IF.                                                      16610000
166200                                                                  16620000
166300 EJECT                                                            16630000
166400*----------------------------------------------------------------*16640000
166500*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *16650000
166600*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *16660000
166700*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *16670000
166800*----------------------------------------------------------------*16680000
166900                                                                  16690000
167000 2120-BROWSE-FORWARD.                                             16700000
167100                                                                  16710000
167200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              16720000
167300         GIVING PV-TOP-ITEM.                                      16730000
167400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   16740000
167500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16750000
167600                                   TO PV-TOP-ITEM                 16760000
167700*        -- BOTTOM OF LIST --                                     16770000
167800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16780000
167900         SET DP020-MSG-INFORMATIONAL                              16790000
168000                                   TO TRUE                        16800000
168100     ELSE                                                         16810000
168200         COMPUTE PV-BOTTOM-ITEM =                                 16820000
168300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16830000
168400         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16840000
168500*            -- BOTTOM OF LIST --                                 16850000
168600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16860000
168700             SET DP020-MSG-INFORMATIONAL                          16870000
168800                                   TO TRUE                        16880000
168900         END-IF                                                   16890000
169000     END-IF.                                                      16900000
169100 EJECT                                                            16910000
169200*----------------------------------------------------------------*16920000
169300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16930000
169400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16940000
169500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *16950000
169600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *16960000
169700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *16970000
169800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *16980000
169900*----------------------------------------------------------------*16990000
170000                                                                  17000000
170100 2130-CHECK-FOR-JUMP-BROWSE.                                      17010000
170200     SET PS-NO-ERROR               TO TRUE.                       17020000
170300     IF (ASC-START-ITEM-REQUEST = SPACE)                          17030000
170400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17040000
170500                                   TO PV-TOP-ITEM                 17050000
170600     ELSE                                                         17060000
170700         MOVE ASC-START-ITEM-REQUEST                              17070000
170800                                   TO DP010I-UNEDITED-FIELD       17080000
170900         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       17090000
171000         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     17100000
171100         SET DP010I-NEGATIVE-NOT-ALLOWED                          17110000
171200                                   TO TRUE                        17120000
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17131065
273427              USING DP010I-NUMERIC-EDIT-AREA                      17132065
171400                                                                  17140000
171500         IF  NOT DP010I-ERROR-DETECTED                            17150000
171600             MOVE DP010I-NUMERIC-FIELD                            17160000
171700                                   TO  ASC-START-ITEM-REQUEST-N   17170000
171800             IF  ASC-START-ITEM-REQUEST-N > ZERO                  17180000
171900                 IF  ASC-START-ITEM-REQUEST-N >                   17190000
172000                                          ASC-NUMBER-OF-ITEMS-READ17200000
172100                     MOVE SPACE TO ASC-START-ITEM-REQUEST         17210000
172200                     COMPUTE PV-TOP-ITEM =                        17220000
172300                             ASC-NUMBER-OF-ITEMS-READ             17230000
172400                             - PC-ITEMS-PER-PANEL + 1             17240000
172500                     IF  PV-TOP-ITEM < +1                         17250000
172600                         MOVE +1   TO PV-TOP-ITEM                 17260000
172700                         MOVE PC-TSYMSG-00070                     17270000
172800                                   TO DP020-MSG-NUMBER            17280000
172900                         SET DP020-MSG-INFORMATIONAL              17290000
173000                                   TO TRUE                        17300000
173100                     END-IF                                       17310000
173200                 ELSE                                             17320000
173300                     MOVE ASC-START-ITEM-REQUEST-N                17330000
173400                                   TO PV-TOP-ITEM                 17340000
173500                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      17350000
173600                     COMPUTE PV-BOTTOM-ITEM =                     17360000
173700                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     17370000
173800                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ17380000
173900*                        -- BOTTOM OF LIST --                     17390000
174000                         MOVE PC-TSYMSG-00070                     17400000
174100                                   TO DP020-MSG-NUMBER            17410000
174200                         SET DP020-MSG-INFORMATIONAL              17420000
174300                                   TO TRUE                        17430000
174400                     END-IF                                       17440000
174500                 END-IF                                           17450000
174600             ELSE                                                 17460000
174700*                --- VALUE OUT OF RANGE ----                      17470000
174800                 MOVE PC-TSYMSG-00101                             17480000
174900                                   TO DP020-MSG-NUMBER            17490000
175000                 MOVE -1           TO ASTRTITL                    17500000
175100                 SET DP030-SET-CURSOR-APPL-1                      17510000
175200                                   TO TRUE                        17520000
175300                 MOVE DP015-REVERSE                               17530000
175400                                   TO ASTRTITH                    17540000
175500                 MOVE DP015-RED    TO ASTRTITC                    17550000
175600                 MOVE DP015-UNP-NUM-BRT-MDT                       17560000
175700                                   TO ASTRTITA                    17570000
175800                 SET DP020-MSG-FATAL                              17580000
175900                                   TO TRUE                        17590000
176000                 SET PS-ERROR      TO TRUE                        17600000
176100             END-IF                                               17610000
176200                                                                  17620000
176300         ELSE                                                     17630000
176400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17640000
176500             MOVE -1               TO ASTRTITL                    17650000
176600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17660000
176700             MOVE DP015-REVERSE    TO ASTRTITH                    17670000
176800             MOVE DP015-RED        TO ASTRTITC                    17680000
176900             MOVE DP015-UNP-NUM-BRT-MDT                           17690000
177000                                   TO ASTRTITA                    17700000
177100             SET DP020-MSG-FATAL   TO TRUE                        17710000
177200             SET PS-ERROR          TO TRUE                        17720000
177300         END-IF                                                   17730000
177400     END-IF.                                                      17740000
177500 EJECT                                                            17750000
177600*----------------------------------------------------------------*17760000
177700*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *17770000
177800*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *17780000
177900*----------------------------------------------------------------*17790000
178000 2140-DESELECT-ALL-ITEMS.                                         17800000
178100     MOVE +1                       TO ASC-BLK-SUB.                17810000
178200                                                                  17820000
178300     PERFORM 2141-CLEAR-SELECTED-INDS                             17830000
178400         VARYING ASC-ITEM-SUB                                     17840000
178500         FROM 1 BY 1                                              17850000
178600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17860000
178700                                                                  17870000
178800     ADD +1                        TO ASC-BLK-SUB.                17880000
178900                                                                  17890000
179000     PERFORM 2141-CLEAR-SELECTED-INDS                             17900000
179100         VARYING ASC-ITEM-SUB                                     17910000
179200         FROM 1 BY 1                                              17920000
179300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17930000
179400                                                                  17940000
179500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17950000
179600                                   TO PV-LIST-ITEM-NUMBER.        17960000
179700                                                                  17970000
179800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17980000
179900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17990000
180000                                                                  18000000
180100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18010000
180200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      18020000
180300         MOVE +1                   TO ASC-BLK-SUB                 18030000
180400                                                                  18040000
180500         PERFORM 5100-WRITE-TEMP-STORAGE                          18050000
180600                                                                  18060000
180700         MOVE +1                   TO PV-BLOCK-NUMBER             18070000
180800                                                                  18080000
180900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18090000
181000             PV-FIRST-BLOCK-IN-ARRAY - 1                          18100000
181100                                                                  18110000
181200         PERFORM                                                  18120000
181300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18130000
181400                                                                  18140000
181500             PERFORM 4410-READ-TEMP-STORAGE                       18150000
181600                                                                  18160000
181700             PERFORM 2141-CLEAR-SELECTED-INDS                     18170000
181800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 18180000
181900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18190000
182000                                                                  18200000
182100             PERFORM 5100-WRITE-TEMP-STORAGE                      18210000
182200                                                                  18220000
182300             ADD +1                TO PV-BLOCK-NUMBER             18230000
182400                                                                  18240000
182500         END-PERFORM                                              18250000
182600                                                                  18260000
182700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18270000
182800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18280000
182900                                                                  18290000
183000         PERFORM                                                  18300000
183100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18310000
183200                   ASC-HIGHEST-BLOCK-WRITTEN                      18320000
183300                                                                  18330000
183400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18340000
183500                                   TO PV-BLOCK-NUMBER             18350000
183600                                                                  18360000
183700             PERFORM 4410-READ-TEMP-STORAGE                       18370000
183800                                                                  18380000
183900             PERFORM 2141-CLEAR-SELECTED-INDS                     18390000
184000                 VARYING ASC-ITEM-SUB                             18400000
184100                 FROM 1 BY 1                                      18410000
184200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18420000
184300                                                                  18430000
184400             PERFORM 5100-WRITE-TEMP-STORAGE                      18440000
184500                                                                  18450000
184600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18460000
184700                                                                  18470000
184800         END-PERFORM                                              18480000
184900                                                                  18490000
185000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18500000
185100                                   TO PV-BLOCK-NUMBER             18510000
185200                                                                  18520000
185300         PERFORM 4410-READ-TEMP-STORAGE                           18530000
185400     END-IF.                                                      18540000
185500                                                                  18550000
185600                                                                  18560000
185700     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 18570000
185800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.18580000
185900     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  18590000
186000                                                                  18600000
186100*GB  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18610000
186200*3/23                                                             18620000
186300 EJECT                                                            18630000
186400*----------------------------------------------------------------*18640000
186500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *18650000
186600*----------------------------------------------------------------*18660000
186700                                                                  18670000
186800 2141-CLEAR-SELECTED-INDS.                                        18680000
186900                                                                  18690000
187000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18700000
187100             NOT EQUAL ZERO                                       18710000
187200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18720000
187300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18730000
187400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    18740000
187500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18750000
187600                                   TO TRUE                        18760000
187700         END-IF                                                   18770000
187800     END-IF.                                                      18780000
187900                                                                  18790000
188000 EJECT                                                            18800000
188100*----------------------------------------------------------------*18810000
188200*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *18820000
188300*  FOR ALL ITEMS.                                                *18830000
188400*----------------------------------------------------------------*18840000
188500                                                                  18850000
188600 2150-SELECT-ALL-ITEMS.                                           18860000
188700                                                                  18870000
188800     MOVE +1                       TO ASC-BLK-SUB.                18880000
188900                                                                  18890000
189000     PERFORM 2151-SET-SELECTED-INDS                               18900000
189100         VARYING ASC-ITEM-SUB                                     18910000
189200         FROM 1 BY 1                                              18920000
189300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18930000
189400                                                                  18940000
189500     ADD +1                        TO ASC-BLK-SUB.                18950000
189600                                                                  18960000
189700     PERFORM 2151-SET-SELECTED-INDS                               18970000
189800         VARYING ASC-ITEM-SUB                                     18980000
189900         FROM 1 BY 1                                              18990000
190000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19000000
190100                                                                  19010000
190200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19020000
190300                                   TO PV-LIST-ITEM-NUMBER.        19030000
190400                                                                  19040000
190500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19050000
190600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19060000
190700                                                                  19070000
190800*10/13/00- BEGIN                                                  19080000
190900     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            19090000
191000         MOVE +1                   TO ASC-BLK-SUB                 19100000
191100                                                                  19110000
191200         PERFORM 5100-WRITE-TEMP-STORAGE                          19120000
191300         MOVE +2                   TO ASC-BLK-SUB                 19130000
191400         PERFORM 5100-WRITE-TEMP-STORAGE                          19140000
191500         MOVE +1                   TO ASC-BLK-SUB                 19150000
191600         MOVE +1                   TO PV-BLOCK-NUMBER             19160000
191700     END-IF.                                                      19170000
191800* 10/13/00 END                                                    19180000
191900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19190000
192000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    19200000
192100         MOVE +1                   TO ASC-BLK-SUB                 19210000
192200                                                                  19220000
192300         PERFORM 5100-WRITE-TEMP-STORAGE                          19230000
192400                                                                  19240000
192500         MOVE +1                   TO PV-BLOCK-NUMBER             19250000
192600                                                                  19260000
192700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19270000
192800             PV-FIRST-BLOCK-IN-ARRAY - 1                          19280000
192900                                                                  19290000
193000         PERFORM                                                  19300000
193100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19310000
193200                                                                  19320000
193300             PERFORM 4410-READ-TEMP-STORAGE                       19330000
193400                                                                  19340000
193500             PERFORM 2151-SET-SELECTED-INDS                       19350000
193600                 VARYING ASC-ITEM-SUB                             19360000
193700                 FROM 1 BY 1                                      19370000
193800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19380000
193900                                                                  19390000
194000             PERFORM 5100-WRITE-TEMP-STORAGE                      19400000
194100                                                                  19410000
194200             ADD +1                TO PV-BLOCK-NUMBER             19420000
194300                                                                  19430000
194400         END-PERFORM                                              19440000
194500                                                                  19450000
194600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19460000
194700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19470000
194800                                                                  19480000
194900         PERFORM                                                  19490000
195000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19500000
195100                   ASC-HIGHEST-BLOCK-WRITTEN                      19510000
195200                                                                  19520000
195300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19530000
195400                                   TO PV-BLOCK-NUMBER             19540000
195500                                                                  19550000
195600             PERFORM 4410-READ-TEMP-STORAGE                       19560000
195700                                                                  19570000
195800             PERFORM 2151-SET-SELECTED-INDS                       19580000
195900                 VARYING ASC-ITEM-SUB                             19590000
196000                 FROM 1 BY 1                                      19600000
196100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19610000
196200                                                                  19620000
196300             PERFORM 5100-WRITE-TEMP-STORAGE                      19630000
196400                                                                  19640000
196500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19650000
196600                                                                  19660000
196700         END-PERFORM                                              19670000
196800                                                                  19680000
196900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19690000
197000                                   TO PV-BLOCK-NUMBER             19700000
197100                                                                  19710000
197200         PERFORM 4410-READ-TEMP-STORAGE                           19720000
197300     END-IF.                                                      19730000
197400                                                                  19740000
197500                                                                  19750000
197600     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             19760000
197700                       ASC-NUMBER-OF-SELECTED-ITEMS.              19770000
197800                                                                  19780000
197900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19790000
198000                                                                  19800000
198100 EJECT                                                            19810000
198200*----------------------------------------------------------------*19820000
198300*    MARK EACH ITEM AS BEING SELECTED.                           *19830000
198400*----------------------------------------------------------------*19840000
198500                                                                  19850000
198600 2151-SET-SELECTED-INDS.                                          19860000
198700                                                                  19870000
198800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19880000
198900             NOT EQUAL ZERO                                       19890000
199000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19900000
199100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19910000
199200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        19920000
199300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19930000
199400                               TO  TRUE                           19940000
199500         END-IF                                                   19950000
199600     END-IF.                                                      19960000
199700                                                                  19970000
199800******************************************************************19980000
199900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **19990000
200000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **20000000
200100******************************************************************20010000
200200 2200-MOVE-SCREEN-TO-COMMAREA.                                    20020000
200300                                                                  20030000
200400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             20040000
200500     MOVE +1                       TO PV-SUB.                     20050000
200600                                                                  20060000
200700     PERFORM 3100-SET-SUBSCRIPTS.                                 20070000
200800     IF  ASTRTITL > ZERO                                          20080000
200900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          20090000
201000     ELSE                                                         20100000
201100         IF  ASTRTITF = DP015-ERASE-EOF                           20110000
201200             INITIALIZE ASC-START-ITEM-REQUEST                    20120000
201300         END-IF                                                   20130000
201400     END-IF.                                                      20140000
202200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          20220000
202300         VARYING PV-SUB                                           20230000
202400         FROM 1 BY 1                                              20240000
202500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      20250000
202600******************************************************************20260000
202700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**20270000
202800******************************************************************20280000
202900 2210-MOVE-LINES-TO-COMMAREA.                                     20290000
203000     IF  MR-SELECTL (PV-SUB) > ZERO                               20300000
203100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             20310000
203200         MOVE MR-SELECTI (PV-SUB)                                 20320000
203300                                   TO ASC-TEMP-SELECTED-SW        20330000
203400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      20340000
203500     ELSE                                                         20350000
203600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                20360000
203700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     20370000
203800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        20380000
203900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      20390000
204000         END-IF                                                   20400000
204100     END-IF.                                                      20410000
204200                                                                  20420000
204400                                                                  20440000
204500     ADD +1                        TO ASC-ITEM-SUB.               20450000
204600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20460000
204700         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     20470000
204800             COMPUTE PV-BLOCK-NUMBER  =                           20480000
204900                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         20490000
205000                    PC-ITEMS-PER-PANEL                            20500000
205100             PERFORM 5105-REWRITE-ASC-LISTQ                       20510000
205200         END-IF                                                   20520000
205300         ADD +1                    TO ASC-BLK-SUB                 20530000
205400         MOVE +1                   TO ASC-ITEM-SUB                20540000
205500     ELSE                                                         20550000
205600     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             20560000
205700         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     20570000
205800             COMPUTE PV-BLOCK-NUMBER  =                           20580000
205900                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         20590000
206000                    PC-ITEMS-PER-PANEL                            20600000
206100             PERFORM 5105-REWRITE-ASC-LISTQ                       20610000
206200         END-IF                                                   20620000
206300     END-IF.                                                      20630000
206400*----------------------------------------------------------------*20640000
206500*                                                                 20650000
213400******************************************************************21340000
213500** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **21350000
213600** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **21360000
213700******************************************************************21370000
213800 3000-EDIT-DATA-IN-COMMAREA.                                      21380000
213900     SET PS-NO-ERROR               TO TRUE.                       21390000
214000     PERFORM 3200-RESET-ATTRIBUTES.                               21400000
214100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     21410000
214200**                                                                21420000
214300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              21430000
214400* EDITTING IS DONE FROM THE BOTTOM UP.                            21440000
214500**                                                                21450000
214600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       21460000
214700         ASC-ITEMS-DISPLAYED - 1.                                 21470000
214800     PERFORM 3100-SET-SUBSCRIPTS.                                 21480000
214900                                                                  21490000
215000     IF  PS-NO-ERROR                                              21500000
215100         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        21510000
215200     END-IF.                                                      21520000
215300                                                                  21530000
215400     IF  PS-NO-ERROR                                              21540000
215500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        21550000
215600     END-IF.                                                      21560000
215700                                                                  21570000
215800     IF  ((PS-NO-ERROR)                                           21580000
215900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   21590000
216000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    21600000
216100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  21610000
216200     END-IF.                                                      21620000
216300 EJECT                                                            21630000
216400                                                                  21640000
216500                                                                  21650000
216600*----------------------------------------------------------------*21660000
216700*   3005-EDIT-COMMAREA-BLOCKS                                    *21670000
216800*----------------------------------------------------------------*21680000
216900 3005-EDIT-COMMAREA-BLOCKS.                                       21690000
217000     MOVE +1                       TO PV-BLOCK-NUMBER.            21700000
217100     MOVE +1                       TO ASC-BLK-SUB.                21710000
217200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               21720000
217300                                                                  21730000
217400     COMPUTE PV-BLOCK-NUMBER  =                                   21740000
217500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 21750000
217600            PC-ITEMS-PER-PANEL.                                   21760000
217700                                                                  21770000
217800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          21780000
217900                                                                  21790000
218000     PERFORM                                                      21800000
218100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          21810000
218200          OR PS-ERROR                                             21820000
218300          OR PS-BLOCK-ERROR                                       21830000
218400                                                                  21840000
218500             COMPUTE PV-ITEMS-HOLD  =                             21850000
218600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        21860000
218700                     PC-ITEMS-PER-PANEL - 1                       21870000
218800                                                                  21880000
218900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       21890000
219000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               21900000
219100                     FROM  PV-ITEMS-HOLD                          21910000
219200                   GIVING  PV-ITEMS-DIFF                          21920000
219300                 SUBTRACT  PV-ITEMS-DIFF                          21930000
219400                     FROM  PC-ITEMS-PER-PANEL                     21940000
219500                   GIVING  PV-ITEMS-HOLD                          21950000
219600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              21960000
219700                                              ASC-ITEM-SUB        21970000
219800                                              ASC-ITEMS-DISPLAYED 21980000
219900             ELSE                                                 21990000
220000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              22000000
220100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        22010000
220200             END-IF                                               22020000
220300                                                                  22030000
220400             PERFORM 3300-EDIT-SELECTIONS                         22040000
220500                     VARYING PV-SUB                               22050000
220600                        FROM PV-SUB BY -1                         22060000
220700                       UNTIL PV-SUB < +1                          22070000
220800                                                                  22080000
220900             MOVE +1               TO ASC-BLK-SUB                 22090000
221000                                                                  22100000
221100             PERFORM 5105-REWRITE-ASC-LISTQ                       22110000
221200                                                                  22120000
221300             MOVE +1                TO ASC-BLK-SUB                22130000
221400                                                                  22140000
221500             IF  PS-BLOCK-ERROR                                   22150000
221600                 SET  PS-ERROR     TO TRUE                        22160000
221700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        22170000
221800                                   TO PV-TOP-ITEM                 22180000
221900             ELSE                                                 22190000
222000                 ADD  +1           TO PV-BLOCK-NUMBER             22200000
222100                 IF  PV-BLOCK-NUMBER >                            22210000
222200                     ASC-HIGHEST-BLOCK-WRITTEN                    22220000
222300                     MOVE +2       TO ASC-BLK-SUB                 22230000
222400                     PERFORM 4410-READ-TEMP-STORAGE               22240000
222500                     MOVE +1       TO ASC-BLK-SUB                 22250000
222600                 ELSE                                             22260000
222700                     PERFORM 4410-READ-TEMP-STORAGE               22270000
222800                     ADD  +1        TO PV-BLOCK-NUMBER            22280000
222900                     MOVE +2        TO ASC-BLK-SUB                22290000
223000                     PERFORM 4410-READ-TEMP-STORAGE               22300000
223100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            22310000
223200                     MOVE +1        TO ASC-BLK-SUB                22320000
223300                 END-IF                                           22330000
223400             END-IF                                               22340000
223500     END-PERFORM.                                                 22350000
223600                                                                  22360000
223700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            22370000
223800         PS-ERROR                   OR                            22380000
223900         PS-BLOCK-ERROR                                           22390000
224000         CONTINUE                                                 22400000
224100     ELSE                                                         22410000
224200         MOVE +1                 TO PV-BLOCK-NUMBER               22420000
224300         MOVE +1                 TO ASC-BLK-SUB                   22430000
224400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  22440000
224500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           22450000
224600         PERFORM 4410-READ-TEMP-STORAGE                           22460000
224700                                                                  22470000
224800         PERFORM                                                  22480000
224900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              22490000
225000              OR PS-ERROR                                         22500000
225100              OR PS-BLOCK-ERROR                                   22510000
225200                                                                  22520000
225300                 COMPUTE PV-ITEMS-HOLD  =                         22530000
225400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    22540000
225500                         PC-ITEMS-PER-PANEL - 1                   22550000
225600                                                                  22560000
225700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     22570000
225800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           22580000
225900                         FROM  PV-ITEMS-HOLD                      22590000
226000                       GIVING  PV-ITEMS-DIFF                      22600000
226100                     SUBTRACT  PV-ITEMS-DIFF                      22610000
226200                         FROM  PC-ITEMS-PER-PANEL                 22620000
226300                       GIVING  PV-ITEMS-HOLD                      22630000
226400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            22640000
226500                                                ASC-ITEM-SUB      22650000
226600                                               ASC-ITEMS-DISPLAYED22660000
226700                 ELSE                                             22670000
226800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          22680000
226900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    22690000
227000                 END-IF                                           22700000
227100                                                                  22710000
227200                 PERFORM 3300-EDIT-SELECTIONS                     22720000
227300                         VARYING PV-SUB                           22730000
227400                            FROM PV-SUB BY -1                     22740000
227500                           UNTIL PV-SUB < +1                      22750000
227600                                                                  22760000
227700                 MOVE +1               TO ASC-BLK-SUB             22770000
227800                                                                  22780000
227900                 PERFORM 5105-REWRITE-ASC-LISTQ                   22790000
228000                                                                  22800000
228100                 MOVE +1                TO ASC-BLK-SUB            22810000
228200                                                                  22820000
228300                 IF  PS-BLOCK-ERROR                               22830000
228400                     SET  PS-ERROR     TO TRUE                    22840000
228500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    22850000
228600                                       TO PV-TOP-ITEM             22860000
228700                 ELSE                                             22870000
228800                     ADD  +1            TO PV-BLOCK-NUMBER        22880000
228900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      22890000
229000                         MOVE +2        TO ASC-BLK-SUB            22900000
229100                         PERFORM 4410-READ-TEMP-STORAGE           22910000
229200                         MOVE +1        TO ASC-BLK-SUB            22920000
229300                     ELSE                                         22930000
229400                         PERFORM 4410-READ-TEMP-STORAGE           22940000
229500                         ADD  +1        TO PV-BLOCK-NUMBER        22950000
229600                         MOVE +2        TO ASC-BLK-SUB            22960000
229700                         PERFORM 4410-READ-TEMP-STORAGE           22970000
229800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        22980000
229900                         MOVE +1        TO ASC-BLK-SUB            22990000
230000                     END-IF                                       23000000
230100                 END-IF                                           23010000
230200     END-PERFORM.                                                 23020000
238800*----------------------------------------------------------------*23880000
238900*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *23890000
239000*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*23900000
239100*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *23910000
239200*                                                                *23920000
239300*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *23930000
239400*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *23940000
239500*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *23950000
239600*    US IN THE 2ND BLOCK OF THE ARRAY.                           *23960000
239700*----------------------------------------------------------------*23970000
239800                                                                  23980000
239900 3100-SET-SUBSCRIPTS.                                             23990000
240000                                                                  24000000
240100     COMPUTE ASC-ITEM-SUB =                                       24010000
240200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        24020000
240300                                                                  24030000
240400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         24040000
240500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24050000
240600                                                                  24060000
240700         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               24070000
240800     ELSE                                                         24080000
240900         MOVE +1                     TO ASC-BLK-SUB               24090000
241000     END-IF.                                                      24100000
241100******************************************************************24110000
241200** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **24120000
241300******************************************************************24130000
241400                                                                  24140000
241500 3200-RESET-ATTRIBUTES.                                           24150000
241600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   24160000
241700     MOVE DP015-GREEN              TO ASTRTITC.                   24170000
241800     MOVE DP015-UNDERLINE          TO ASTRTITH.                   24180000
241900                                                                  24190000
242000     PERFORM                                                      24200000
242100         VARYING PV-SUB                                           24210000
242200         FROM 1 BY 1                                              24220000
242300         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        24230000
242700           MOVE DP015-UNP-ALP-NOR-OFF                             24270000
242800                                     TO MR-SELECTA (PV-SUB)       24280000
243000           MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)       24300000
243200           MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)       24320000
243500     END-PERFORM.                                                 24350000
243600******************************************************************24360000
243700** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **24370000
243800** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **24380000
243900** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **24390000
244000** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **24400000
244100******************************************************************24410000
244200 3300-EDIT-SELECTIONS.                                            24420000
244300     EVALUATE TRUE                                                24430000
244400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24440000
244500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         24450000
244600                 CONTINUE                                         24460000
244700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         24470000
244800             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        24480000
244900                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   24490000
245000                 MOVE ASC-TEMP-SELECTED-SW                        24500000
245100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24510000
245200                                TO ASC-SELECTED-SW                24520000
245300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24530000
245400             END-IF                                               24540000
245500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24550000
245600                 = SPACE                                          24560000
245700             EVALUATE TRUE                                        24570000
245800                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       24580000
245900                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS24590000
246000                     MOVE SPACE TO ASC-SELECTED-SW                24600000
246100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24610000
246200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        24620000
246300                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    24630000
246400                     MOVE SPACE TO ASC-SELECTED-SW                24640000
246500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24650000
246600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          24660000
246700                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      24670000
246800                     MOVE SPACE TO ASC-SELECTED-SW                24680000
246900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24690000
247000             END-EVALUATE                                         24700000
247100         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           24710000
247200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24720000
247300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24730000
247400             END-IF                                               24740000
247500             PERFORM 3310-EDIT-RANGE                              24750000
247600         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             24760000
247700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24770000
247800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24780000
247900             END-IF                                               24790000
248000             PERFORM 3310-EDIT-RANGE                              24800000
248100         WHEN OTHER                                               24810000
248200             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           24820000
248300             SET DP020-MSG-FATAL    TO TRUE                       24830000
248400             MOVE -1                TO MR-SELECTL (PV-SUB)        24840000
248500             SET DP030-SET-CURSOR-APPL-1                          24850000
248600                                    TO TRUE                       24860000
248700             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        24870000
248800             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        24880000
248900             SET PS-ERROR TO TRUE                                 24890000
249000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24900000
249100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     24910000
249200                 MOVE SPACE         TO ASC-SELECTED-SW            24920000
249300                                        (ASC-BLK-SUB ASC-ITEM-SUB)24930000
249400             END-IF                                               24940000
249500     END-EVALUATE.                                                24950000
249600                                                                  24960000
251830     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND                25183000
251831         (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR               25183100
251832            DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID))               25183200
251840         MOVE 'SUVNDRKU' TO DP008-FUNCTION-NAME                   25184000
251850         PERFORM 2105-RACF-ACCESS                                 25185000
251851           IF  PS-ACCESS-NOT-ALLOWED                              25185100
251852                SET  PS-ERROR                                     25185200
251853                     DP020-MSG-FATAL TO TRUE                      25185300
251854                IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)         25185400
251855                   MOVE PC-TSYMSG-02843 TO DP020-MSG-NUMBER       25185500
251856                ELSE                                              25185600
251857                   MOVE PC-TSYMSG-02790 TO DP020-MSG-NUMBER       25185700
251858                END-IF                                            25185800
251859                MOVE -1              TO MR-SELECTL (PV-SUB)       25185900
251860                SET  DP030-SET-CURSOR-APPL-1 TO TRUE              25186000
251861                SET  DP030-OVERRIDE-GO TO TRUE                    25186100
251870                SET PS-BLOCK-ERROR   TO TRUE                      25187000
252200           END-IF                                                 25220000
252210     END-IF                                                       25221000
252212                                                                  25221200
252213     IF PS-NO-ERROR                                               25221300
252220         IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                25222000
252230            IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             25223000
252240                IF  ASC-AUDIT-RANK (ASC-BLK-SUB ASC-ITEM-SUB)  =  25224000
252250                                               PC-DEFAULT         25225000
252400                    SET  PS-ERROR                                 25240000
252500                         DP020-MSG-FATAL TO TRUE                  25250000
252600                    MOVE PC-TSYMSG-02855 TO DP020-MSG-NUMBER      25260000
252700                    MOVE -1              TO MR-SELECTL (PV-SUB)   25270000
252800                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          25280000
252900                    SET PS-BLOCK-ERROR   TO TRUE                  25290000
252901                    SET ASC-NO-CONFIRM-DELETE TO TRUE             25290100
252910                ELSE                                              25291000
252920                    SET ASC-CONFIRM-DELETE TO TRUE                25292000
252930                    SET  PS-ERROR                                 25293000
252940                         DP020-MSG-INFORMATIONAL TO TRUE          25294000
252950                    MOVE PC-TSYMSG-02849 TO DP020-MSG-NUMBER      25295000
252960                    MOVE -1              TO MR-SELECTL (PV-SUB)   25296000
252970                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          25297000
252980                    SET PS-BLOCK-ERROR   TO TRUE                  25298000
252990                END-IF                                            25299000
253000            END-IF                                                25300000
253300         END-IF                                                   25330000
253310     END-IF                                                       25331000
253400                                                                  25340000
254125                                                                  25412500
254130                                                                  25413000
254131     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 25413100
254132     SUBTRACT +1 FROM ASC-ITEM-SUB.                               25413200
254133     IF  ASC-ITEM-SUB < 1                                         25413300
254134         SUBTRACT +1 FROM ASC-BLK-SUB                             25413400
254135         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                25413500
254136     END-IF.                                                      25413600
254840******************************************************************25484000
254850** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **25485000
254860** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **25486000
254870** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**25487000
254880** THE ENDING.                                                  **25488000
254890******************************************************************25489000
254900 3310-EDIT-RANGE.                                                 25490000
254901     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                25490100
254902         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   25490200
254903             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)25490300
254904                                   TO ASC-SELECTED-SW             25490400
254905                                        (ASC-BLK-SUB ASC-ITEM-SUB)25490500
254906             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 25490600
254907         ELSE                                                     25490700
254908             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     25490800
254909                 CONTINUE                                         25490900
254910             ELSE                                                 25491000
254920*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        25492000
254930                 MOVE PC-TSYMSG-00054                             25493000
254940                                   TO DP020-MSG-NUMBER            25494000
254950                 SET DP020-MSG-FATAL                              25495000
254960                                   TO TRUE                        25496000
254970                 MOVE -1           TO MR-SELECTL (PV-SUB)         25497000
254980                 SET DP030-SET-CURSOR-APPL-1                      25498000
254990                                   TO TRUE                        25499000
255000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         25500000
255100                 MOVE DP015-UNDERLINE                             25510000
255200                                   TO MR-SELECTH (PV-SUB)         25520000
255300                 SET PS-ERROR      TO TRUE                        25530000
255400             END-IF                                               25540000
255500         END-IF                                                   25550000
255600     ELSE                                                         25560000
255700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25570000
255800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25580000
255900                                   TO ASC-SELECTED-SW             25590000
256000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25600000
256100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   25610000
256200         ELSE                                                     25620000
256300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       25630000
256400                 CONTINUE                                         25640000
256500             ELSE                                                 25650000
256600*                -- ONLY ONE END-OF-RANGE ALLOWED --              25660000
256700                 MOVE PC-TSYMSG-00055                             25670000
256800                                   TO DP020-MSG-NUMBER            25680000
256900                 SET DP020-MSG-FATAL                              25690000
257000                                   TO TRUE                        25700000
257100                 MOVE -1           TO MR-SELECTL (PV-SUB)         25710000
257200                 SET DP030-SET-CURSOR-APPL-1                      25720000
257300                                   TO TRUE                        25730000
257400                 SET PS-ERROR      TO TRUE                        25740000
257500             END-IF                                               25750000
257600         END-IF                                                   25760000
257700     END-IF.                                                      25770000
257800                                                                  25780000
257900******************************************************************25790000
258000** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **25800000
258100** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **25810000
258200******************************************************************25820000
258300 3400-CHECK-RANGE-SEQUENCE.                                       25830000
258400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25840000
258500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      25850000
258600       AND  ASC-START-OF-SELECTED-RANGE >                         25860000
258700                                         ASC-END-OF-SELECTED-RANGE25870000
258800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                25880000
258900         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 25890000
259000         SET DP020-MSG-FATAL TO TRUE                              25900000
259100         SET PS-ERROR TO TRUE                                     25910000
259200         PERFORM 3410-POSITION-AT-ERROR                           25920000
259300     END-IF.                                                      25930000
259400******************************************************************25940000
259500** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **25950000
259600** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **25960000
259700** SHOULD BE POSITIONED ON A RANGE ERROR.                       **25970000
259800******************************************************************25980000
259900 3410-POSITION-AT-ERROR.                                          25990000
260000     SET DP030-SET-CURSOR-APPL-1                                  26000000
260100                                   TO TRUE.                       26010000
260200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 26020000
260300                    - PV-TOP-ITEM + 1.                            26030000
260400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26040000
260500         CONTINUE                                                 26050000
260600     ELSE                                                         26060000
260700         MOVE -1                   TO MR-SELECTL (PV-SUB)         26070000
260800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26080000
260900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         26090000
261000     END-IF.                                                      26100000
261100                                                                  26110000
261200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   26120000
261300                    - PV-TOP-ITEM + 1.                            26130000
261400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26140000
261500         CONTINUE                                                 26150000
261600     ELSE                                                         26160000
261700         MOVE -1                   TO MR-SELECTL (PV-SUB)         26170000
261800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26180000
261900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         26190000
262000     END-IF.                                                      26200000
262100 EJECT                                                            26210000
262200*----------------------------------------------------------------*26220000
262300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *26230000
262400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *26240000
262500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *26250000
262600*----------------------------------------------------------------*26260000
262700                                                                  26270000
262800 3500-MARK-RANGE-AS-SELECTED.                                     26280000
262900     MOVE +1                       TO  ASC-BLK-SUB.               26290000
263000     PERFORM 3510-MARK-SELECTED-INDS                              26300000
263100         VARYING ASC-ITEM-SUB                                     26310000
263200         FROM 1 BY 1                                              26320000
263300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26330000
263400                                                                  26340000
263500     ADD +1                        TO ASC-BLK-SUB.                26350000
263600     PERFORM 3510-MARK-SELECTED-INDS                              26360000
263700         VARYING ASC-ITEM-SUB                                     26370000
263800         FROM 1 BY 1                                              26380000
263900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26390000
264000                                                                  26400000
264100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               26410000
264200                                   TO  PV-LIST-ITEM-NUMBER.       26420000
264300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26430000
264400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         26440000
264500               PC-ITEMS-PER-PANEL).                               26450000
264600                                                                  26460000
264700     MOVE ASC-START-OF-SELECTED-RANGE                             26470000
264800                                   TO PV-START-OF-SELECTED-RANGE. 26480000
264900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            26490000
265000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  26500000
265100               PC-ITEMS-PER-PANEL).                               26510000
265200                                                                  26520000
265300     MOVE ASC-END-OF-SELECTED-RANGE                               26530000
265400                                   TO  PV-END-OF-SELECTED-RANGE.  26540000
265500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             26550000
265600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    26560000
265700               PC-ITEMS-PER-PANEL).                               26570000
265800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             26580000
265900         PV-FIRST-BLOCK-IN-ARRAY + 1.                             26590000
266000                                                                  26600000
266100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    26610000
266200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        26620000
266300         MOVE +1                   TO ASC-BLK-SUB                 26630000
266400         PERFORM 5100-WRITE-TEMP-STORAGE                          26640000
266500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26650000
266600             PV-FIRST-BLOCK-IN-ARRAY - 1                          26660000
266700                                                                  26670000
266800         PERFORM                                                  26680000
266900             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      26690000
267000                   PV-PREV-BLOCK-IN-ARRAY                         26700000
267100             MOVE PV-FIRST-BLOCK-IN-RANGE                         26710000
267200                                   TO PV-BLOCK-NUMBER             26720000
267300             PERFORM 4410-READ-TEMP-STORAGE                       26730000
267400             PERFORM 3510-MARK-SELECTED-INDS                      26740000
267500                 VARYING ASC-ITEM-SUB                             26750000
267600                 FROM 1 BY 1                                      26760000
267700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26770000
267800             PERFORM 5100-WRITE-TEMP-STORAGE                      26780000
267900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     26790000
268000         END-PERFORM                                              26800000
268100                                                                  26810000
268200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         26820000
268300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     26830000
268400         PERFORM                                                  26840000
268500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       26850000
268600                   PV-LAST-BLOCK-IN-RANGE                         26860000
268700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          26870000
268800                                   TO PV-BLOCK-NUMBER             26880000
268900             PERFORM 4410-READ-TEMP-STORAGE                       26890000
269000             PERFORM 3510-MARK-SELECTED-INDS                      26900000
269100                 VARYING ASC-ITEM-SUB                             26910000
269200                 FROM 1 BY 1                                      26920000
269300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26930000
269400             PERFORM 5100-WRITE-TEMP-STORAGE                      26940000
269500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      26950000
269600         END-PERFORM                                              26960000
269700                                                                  26970000
269800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             26980000
269900                                   TO PV-BLOCK-NUMBER             26990000
270000         PERFORM 4410-READ-TEMP-STORAGE                           27000000
270100     END-IF.                                                      27010000
270200                                                                  27020000
270300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 27030000
270400                                      ASC-END-OF-SELECTED-RANGE.  27040000
270500                                                                  27050000
270600 EJECT                                                            27060000
270700*----------------------------------------------------------------*27070000
270800* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *27080000
270900*----------------------------------------------------------------*27090000
271000                                                                  27100000
271100 3510-MARK-SELECTED-INDS.                                         27110000
271200                                                                  27120000
271300     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         27130000
271400                                ASC-ITEM-SUB) >                   27140000
271500         ASC-START-OF-SELECTED-RANGE)                             27150000
271600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         27160000
271700                                ASC-ITEM-SUB) =                   27170000
271800         ASC-START-OF-SELECTED-RANGE)                             27180000
271900                                                                  27190000
272000         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     27200000
272100                                    ASC-ITEM-SUB) <               27210000
272200             ASC-END-OF-SELECTED-RANGE)                           27220000
272300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     27230000
272400                                    ASC-ITEM-SUB) =               27240000
272500             ASC-END-OF-SELECTED-RANGE)                           27250000
272600                                                                  27260000
272700             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27270000
272800                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   27280000
272900                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   27290000
273000                               TO TRUE                            27300000
273100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              27310000
273200                               TO TRUE                            27320000
273300                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    27330000
273400             END-IF                                               27340000
273500         END-IF                                                   27350000
273600     END-IF.                                                      27360000
273700                                                                  27370000
273800 EJECT                                                            27380000
273900                                                                  27390000
274000*----------------------------------------------------------------*27400000
274100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *27410000
274200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *27420000
274300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27430000
274400*    DISPLAY THE PANEL TO USER.                                  *27440000
274500*----------------------------------------------------------------*27450000
274600                                                                  27460000
274700 4000-BUILD-INITIAL-PANEL.                                        27470000
274800                                                                  27480000
274900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            27490000
275000                                 ASC-BLOCK-ENTRIES (2).           27500000
275100     MOVE +1                 TO ASC-BLK-SUB.                      27510000
275200     SET ASC-ITEMS-LEFT-ON-DB                                     27520000
275300                             TO TRUE.                             27530000
275400                                                                  27540000
275500     MOVE +0                 TO ASC-ITEM-SUB                      27550000
275600                                ASC-NUMBER-OF-ITEMS-READ          27560000
275700                                ASC-NUMBER-OF-SELECTED-ITEMS      27570000
275800                                ASC-HIGHEST-BLOCK-WRITTEN         27580000
275900                                ASC-START-OF-SELECTED-RANGE       27590000
276000                                ASC-END-OF-SELECTED-RANGE         27600000
276100                                ASC-ITEM-AT-TOP-OF-PANEL.         27610000
276500                                                                  27650000
276600     PERFORM 4010-OPEN-VEND-RNK-CDE-CSR.                          27660000
276700                                                                  27670000
276800     PERFORM 4300-READ-ITEMS-FROM-DB.                             27680000
276900                                                                  27690000
277000     PERFORM 4020-CLOSE-VEND-RNK-CDE-CSR.                         27700000
277100                                                                  27710000
277200     MOVE +1                   TO  PV-TOP-ITEM.                   27720000
277300     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          27730000
277400         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    27740000
277500         SET DP020-MSG-FATAL   TO  TRUE                           27750000
277600         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               27760000
277700     ELSE                                                         27770000
277800         MOVE -1               TO MR-SELECTL (1)                  27780000
277900         SET DP030-SET-CURSOR-APPL-1                              27790000
278000                               TO TRUE                            27800000
278100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     27810000
278200     END-IF.                                                      27820000
278300 EJECT                                                            27830000
278400*----------------------------------------------------------------*27840000
278500* OPEN THE STORE LIST CURSOR                                     *27850000
278600*----------------------------------------------------------------*27860000
278700                                                                  27870000
278800 4010-OPEN-VEND-RNK-CDE-CSR.                                      27880000
278900                                                                  27890000
279000     PERFORM                                                      27900000
279100         WITH TEST AFTER                                          27910000
279200         VARYING PV-RETRY-COUNTER                                 27920000
279300         FROM 1 BY 1                                              27930000
279400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27940000
279500                   OR (SQLCODE = ZERO))                           27950000
279600                 EXEC SQL                                         27960000
279700                      OPEN VEND_RNK_CDE_CSR                       27970000
279800                 END-EXEC                                         27980000
279900                                                                  27990000
280000                                                                  28000000
280100         EVALUATE TRUE                                            28010000
280200             WHEN SQLCODE = ZERO                                  28020000
280300             WHEN SQLCODE = -904                                  28030000
280400             WHEN SQLCODE = -913                                  28040000
280500                 CONTINUE                                         28050000
280600             WHEN SQLWARN0 NOT = SPACES                           28060000
280700             WHEN SQLCODE < ZERO                                  28070000
280800             WHEN SQLCODE > ZERO                                  28080000
280900                 MOVE '4010-OPEN-VEND-RNK-CDE-CSR'                28090000
281000                                   TO DP013-PARAGRAPH             28100000
281100                 MOVE 'OPEN VEND RANK CURSOR-'                    28110000
281200                                   TO DP013-MESSAGE-TEXT (1)      28120000
281300                 MOVE SQLCA        TO DP013-SQLCA                 28130000
281400                 MOVE 'SUT_VEND_RNK_CDE'                          28140000
281410                                  TO DP013-DB2-TABLE-NAME (1)     28141000
281500                 SET DP013-DB2-ABEND                              28150000
281600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           28160000
281700                 PERFORM DP013-0000-PROCESS-ABEND                 28170000
281800         END-EVALUATE                                             28180000
281900     END-PERFORM.                                                 28190000
282000                                                                  28200000
282100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28210000
282200         SQLCODE NOT = ZERO                                       28220000
282300         MOVE '4010-OPEN-VEND-RNK-CDE-CSR' TO DP013-PARAGRAPH     28230000
282400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   28240000
282500                                   TO DP013-MESSAGE-TEXT (1)      28250000
282600         MOVE SQLCA                TO DP013-SQLCA                 28260000
282700         MOVE 'VEND_RNK_CDE'       TO DP013-DB2-TABLE-NAME (1)    28270000
282800         SET DP013-DB2-ABEND                                      28280000
282900             DP013-XCTL-DISPLAY-RESTART                           28290000
283000                                   TO TRUE                        28300000
283100         PERFORM DP013-0000-PROCESS-ABEND                         28310000
283200     END-IF.                                                      28320000
283300                                                                  28330000
283400 EJECT                                                            28340000
283500******************************************************************28350000
283600*  CLOSE EXPECTED CURSOR                                       * *28360000
283700******************************************************************28370000
283800 4020-CLOSE-VEND-RNK-CDE-CSR.                                     28380000
283900         EXEC SQL                                                 28390000
284000             CLOSE VEND_RNK_CDE_CSR                               28400000
284100         END-EXEC                                                 28410000
284200                                                                  28420000
284300     EVALUATE TRUE                                                28430000
284400         WHEN SQLCODE = ZERO                                      28440000
284500             CONTINUE                                             28450000
284600         WHEN SQLWARN0 NOT = SPACES                               28460000
284700         WHEN SQLCODE < ZERO                                      28470000
284800         WHEN SQLCODE > ZERO                                      28480000
284900             MOVE '4020-CLOSE-VEND-RNK-CDE-CSR'                   28490000
285000                               TO DP013-PARAGRAPH                 28500000
285100             MOVE 'CLOSE VEND RANK CURSOR'                        28510000
285200                               TO DP013-MESSAGE-TEXT (1)          28520000
285300             MOVE SQLCA        TO DP013-SQLCA                     28530000
285400             MOVE 'SUT_VEND_RNK_CDE'                              28540000
285410                               TO DP013-DB2-TABLE-NAME (1)        28541000
285500             SET DP013-DB2-ABEND                                  28550000
285600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28560000
285700             PERFORM DP013-0000-PROCESS-ABEND                     28570000
285800     END-EVALUATE.                                                28580000
285900                                                                  28590000
286000 EJECT                                                            28600000
286100******************************************************************28610000
286200 4150-CHECK-VEND-DEPT-RNKG.                                       28620000
286300******************************************************************28630000
286400                                                                  28640000
286500     EXEC SQL                                                     28650000
286600          SELECT ENT_ID                                           28660000
286800          INTO  :SUT00018-ENT-ID                                  28680000
287000           FROM SUT_VND_DEPT_RNKG                                 28700000
287300          WHERE VND_RNKG_CDE       = :DK-VND-RNKG-CDE             28730000
287600     END-EXEC                                                     28760000
287700                                                                  28770000
287800                                                                  28780000
287900     EVALUATE TRUE                                                28790000
288000         WHEN SQLCODE = ZERO                                      28800000
288010         WHEN SQLCODE = -811                                      28801000
288020              SET PS-VND-DEPT-RNKG-EXISTS TO TRUE                 28802000
288300         WHEN SQLCODE = +100                                      28830000
288310              SET PS-NO-VND-DEPT-RNKG-EXISTS TO TRUE              28831000
288700         WHEN SQLWARN0 NOT = SPACE                                28870000
288800         WHEN SQLCODE NOT = ZERO                                  28880000
288900              MOVE '4150-CHECK-VEND-DEPT-RNKG'                    28890000
289000                               TO DP013-PARAGRAPH                 28900000
289100              MOVE 'SELECT VEND DEPT RANKING '                    28910000
289200                               TO DP013-MESSAGE-TEXT (1)          28920000
289300              MOVE 'SUT_VND_DEPT_RNKG '                           28930000
289310                               TO DP013-DB2-TABLE-NAME (1)        28931000
289400              MOVE SQLCA       TO DP013-SQLCA                     28940000
289500              SET DP013-DB2-ABEND                                 28950000
289600                               TO TRUE                            28960000
289700              PERFORM DP013-0000-PROCESS-ABEND                    28970000
289800     END-EVALUATE.                                                28980000
289900                                                                  28990000
290000******************************************************************29000000
290100 4170-CHECK-VEND-RNKG.                                            29010000
290200******************************************************************29020000
290300                                                                  29030000
290400     EXEC SQL                                                     29040000
290500          SELECT ENT_ID                                           29050000
290600          INTO  :SUT00019-ENT-ID                                  29060000
290700           FROM SUT_VND_RNKG                                      29070000
290800          WHERE VND_RNKG_CDE       = :DK-VND-RNKG-CDE             29080000
290900     END-EXEC                                                     29090000
291000                                                                  29100000
291100                                                                  29110000
291200     EVALUATE TRUE                                                29120000
291300         WHEN SQLCODE = ZERO                                      29130000
291400         WHEN SQLCODE = -811                                      29140000
291500              SET PS-VND-RNKG-EXISTS TO TRUE                      29150000
291600         WHEN SQLCODE = +100                                      29160000
291700              SET PS-NO-VND-RNKG-EXISTS TO TRUE                   29170000
291800         WHEN SQLWARN0 NOT = SPACE                                29180000
291900         WHEN SQLCODE NOT = ZERO                                  29190000
292000              MOVE '4170-CHECK-VEND-RNKG  '                       29200000
292100                               TO DP013-PARAGRAPH                 29210000
292200              MOVE 'SELECT DEPT RANKING '                         29220000
292300                               TO DP013-MESSAGE-TEXT (1)          29230000
292400              MOVE 'SUT_DEPT_RNKG '                               29240000
292500                               TO DP013-DB2-TABLE-NAME (1)        29250000
292600              MOVE SQLCA       TO DP013-SQLCA                     29260000
292700              SET DP013-DB2-ABEND                                 29270000
292800                               TO TRUE                            29280000
292900              PERFORM DP013-0000-PROCESS-ABEND                    29290000
293000     END-EVALUATE.                                                29300000
293100                                                                  29310000
293200******************************************************************29320000
293300 4180-CHECK-PO-AUD-REQ.                                           29330000
293400******************************************************************29340000
293500                                                                  29350000
293600     EXEC SQL                                                     29360000
293700          SELECT PO_NBR                                           29370000
293710               , AUD_STAT_CDE                                     29371000
293800          INTO  :SUT00015-PO-NBR                                  29380000
293810              , :SUT00015-AUD-STAT-CDE                            29381000
293900           FROM SUT_PO_AUD_REQ                                    29390000
294000          WHERE VND_RNKG_CDE       = :DK-VND-RNKG-CDE             29400000
294100     END-EXEC                                                     29410000
294200                                                                  29420000
294300                                                                  29430000
294400     EVALUATE TRUE                                                29440000
294500         WHEN SQLCODE = ZERO                                      29450000
294600         WHEN SQLCODE = -811                                      29460000
294700              SET PS-PO-AUD-REQ-EXISTS TO TRUE                    29470000
294800         WHEN SQLCODE = +100                                      29480000
294900              SET PS-NO-PO-AUD-REQ-EXISTS  TO TRUE                29490000
295000         WHEN SQLWARN0 NOT = SPACE                                29500000
295100         WHEN SQLCODE NOT = ZERO                                  29510000
295200              MOVE '4180-CHECK-PO-AUD-REQ '                       29520000
295300                               TO DP013-PARAGRAPH                 29530000
295400              MOVE 'SELECT PO AUD REQUEST '                       29540000
295500                               TO DP013-MESSAGE-TEXT (1)          29550000
295510              MOVE 'SUT_PO_AUD_REQ'                               29551000
295520                               TO DP013-DB2-TABLE-NAME (1)        29552000
295530              MOVE SQLCA       TO DP013-SQLCA                     29553000
295540              SET DP013-DB2-ABEND                                 29554000
295550                               TO TRUE                            29555000
295560              PERFORM DP013-0000-PROCESS-ABEND                    29556000
295570     END-EVALUATE.                                                29557000
295580                                                                  29558000
295590*----------------------------------------------------------------*29559000
295591*  DELETE THE SUT PO AUDIT PARM TABLE                             29559100
295592*----------------------------------------------------------------*29559200
295593 4200-DELETE-PO-AUDIT-PARM.                                       29559300
295595                                                                  29559500
295596     EXEC SQL                                                     29559600
295597          DELETE FROM SUT_PO_AUD_PARM                             29559700
295598           WHERE VND_RNKG_CDE    = :DK-VND-RNKG-CDE               29559800
295599     END-EXEC.                                                    29559900
295600                                                                  29560000
295601     EVALUATE TRUE                                                29560100
295602         WHEN SQLCODE = ZERO                                      29560200
295603         WHEN SQLCODE = +100                                      29560300
295604              CONTINUE                                            29560400
295614         WHEN SQLCODE = -904                                      29561400
295615         WHEN SQLCODE = -911                                      29561500
295616         WHEN SQLCODE = -913                                      29561600
295617         WHEN SQLWARN0 NOT = SPACE                                29561700
295618         WHEN SQLCODE NOT = ZERO                                  29561800
295619              MOVE '4200-DELETE-PO-AUDIT-PARM '                   29561900
295620                               TO DP013-PARAGRAPH                 29562000
295621              MOVE 'DELETE PO AUDIT PARM TABLE   '                29562100
295622                               TO DP013-MESSAGE-TEXT (1)          29562200
295623              MOVE 'SUT_PO_AUD_PARM  '                            29562300
295624                               TO DP013-DB2-TABLE-NAME (1)        29562400
295625              MOVE SQLCA       TO DP013-SQLCA                     29562500
295626              SET DP013-DB2-ABEND                                 29562600
295627                               TO TRUE                            29562700
295628              PERFORM DP013-0000-PROCESS-ABEND                    29562800
295629     END-EVALUATE.                                                29562900
295630                                                                  29563000
295644                                                                  29564400
295645*----------------------------------------------------------------*29564500
295646*  DELETE THE VENDOR PACKAGING ASSOCIATION TABLE                  29564600
295647*----------------------------------------------------------------*29564700
295648 4210-DELETE-VENDOR-PKNG-ASSN.                                    29564800
295649                                                                  29564900
295650     EXEC SQL                                                     29565000
295651          DELETE FROM SUT_VND_PKGNG_ASSN                          29565100
295652           WHERE VND_RNKG_CDE    = :DK-VND-RNKG-CDE               29565200
295653     END-EXEC.                                                    29565300
295654                                                                  29565400
295655     EVALUATE TRUE                                                29565500
295656         WHEN SQLCODE = ZERO                                      29565600
295657         WHEN SQLCODE = +100                                      29565700
295658              CONTINUE                                            29565800
295659         WHEN SQLCODE = -904                                      29565900
295660         WHEN SQLCODE = -911                                      29566000
295661         WHEN SQLCODE = -913                                      29566100
295662         WHEN SQLWARN0 NOT = SPACE                                29566200
295663         WHEN SQLCODE NOT = ZERO                                  29566300
295664              MOVE '4210-DELETE-VENDOR-PKNG-ASSN'                 29566400
295665                               TO DP013-PARAGRAPH                 29566500
295666              MOVE 'DELETE VENDOR PKGING ASSN'                    29566600
295667                               TO DP013-MESSAGE-TEXT (1)          29566700
295668              MOVE 'SUT_VND_PKGNG_ASSN'                           29566800
295669                               TO DP013-DB2-TABLE-NAME (1)        29566900
295670              MOVE SQLCA       TO DP013-SQLCA                     29567000
295671              SET DP013-DB2-ABEND                                 29567100
295672                               TO TRUE                            29567200
295673              PERFORM DP013-0000-PROCESS-ABEND                    29567300
295674     END-EVALUATE.                                                29567400
295675                                                                  29567500
295676                                                                  29567600
295677*----------------------------------------------------------------*29567700
295678*  DELETE THE SELECTED VENDOR RANKING CODE                        29567800
295679*----------------------------------------------------------------*29567900
295680 4220-DELETE-VENDOR-RNKNG-CDE.                                    29568000
295681                                                                  29568100
295682     EXEC SQL                                                     29568200
295683          DELETE FROM SUT_VND_RNKG_CDE                            29568300
295684           WHERE VND_RNKG_CDE    = :DK-VND-RNKG-CDE               29568400
295685     END-EXEC.                                                    29568500
295686                                                                  29568600
295687     EVALUATE TRUE                                                29568700
295688         WHEN SQLCODE = ZERO                                      29568800
295689         WHEN SQLCODE = +100                                      29568900
295690              CONTINUE                                            29569000
295691         WHEN SQLCODE = -904                                      29569100
295692         WHEN SQLCODE = -911                                      29569200
295693         WHEN SQLCODE = -913                                      29569300
295694         WHEN SQLWARN0 NOT = SPACE                                29569400
295695         WHEN SQLCODE NOT = ZERO                                  29569500
295696              MOVE '4220-DELETE-VENDOR-RNKNG-CDE'                 29569600
295697                               TO DP013-PARAGRAPH                 29569700
295698              MOVE 'DELETE VENDOR RNKNG CODE'                     29569800
295699                               TO DP013-MESSAGE-TEXT (1)          29569900
295700              MOVE 'SUT_VND_RNKG_CDE '                            29570000
295701                               TO DP013-DB2-TABLE-NAME (1)        29570100
295702              MOVE SQLCA       TO DP013-SQLCA                     29570200
295703              SET DP013-DB2-ABEND                                 29570300
295704                               TO TRUE                            29570400
295705              PERFORM DP013-0000-PROCESS-ABEND                    29570500
295706     END-EVALUATE.                                                29570600
295707                                                                  29570700
295708                                                                  29570800
295709*----------------------------------------------------------------*29570900
295710*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29571000
295800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29580000
295900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29590000
296000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29600000
296100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29610000
296200*                                                                *29620000
296300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29630000
296400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29640000
296500*    UPON INITIALIZATION.                                        *29650000
296600*----------------------------------------------------------------*29660000
296700                                                                  29670000
296800 4300-READ-ITEMS-FROM-DB.                                         29680000
296900                                                                  29690000
297000     PERFORM                                                      29700000
297100         VARYING PV-READ-COUNT                                    29710000
297200         FROM 1 BY 1                                              29720000
297300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29730000
297400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29740000
297500                                                                  29750000
297600         PERFORM 4310-FETCH-VEND-RNK-CDE-CSR                      29760000
297700                                                                  29770000
297800         IF  ASC-ITEMS-LEFT-ON-DB                                 29780000
297900                                                                  29790000
298000             PERFORM 5010-OPEN-PACK-TYPE-CSR                      29800000
298100             SET PS-NOT-END-OF-PACK-TYP-CSR TO TRUE               29810000
298200                                                                  29820000
298300             PERFORM 5020-FETCH-PACK-TYPE-CSR                     29830000
298400                         UNTIL PS-END-OF-PACK-TYP-CSR             29840000
298500             PERFORM 5030-CLOSE-PACK-TYPE-CSR                     29850000
301000                                                                  30100000
301100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                30110000
301200                 ADD +1            TO ASC-ITEM-SUB                30120000
301300             ELSE                                                 30130000
301400                 ADD +1            TO ASC-BLK-SUB                 30140000
301500                 MOVE +1           TO ASC-ITEM-SUB                30150000
301600                                                                  30160000
301700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         30170000
301800                     MOVE +1       TO ASC-BLK-SUB                 30180000
301900                     SET ASC-BLOCK-MODIFIED (1)                   30190000
302000                                   TO TRUE                        30200000
302100                     PERFORM 5100-WRITE-TEMP-STORAGE              30210000
302200                     MOVE ASC-BLOCK-ENTRIES                       30220000
302300                               (PC-MAX-BLOCKS-IN-ARRAY)           30230000
302400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 30240000
302500                     ADD +1        TO ASC-BLK-SUB                 30250000
302600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   30260000
302700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      30270000
302800                                   TO TRUE                        30280000
302900                 END-IF                                           30290000
303000             END-IF                                               30300000
303100                                                                  30310000
303200                                                                  30320000
303300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    30330000
303400             MOVE ASC-NUMBER-OF-ITEMS-READ                        30340000
303500                                   TO ASC-LIST-ITEM-NUMBER        30350000
303600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30360000
303700             MOVE SPACES                 TO  ASC-ACTION           30370000
303800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30380000
308400*                                                                 30840000
308700             MOVE SUT00016-VND-RNKG-CDE  TO                       30870000
308800                  ASC-AUDIT-RANK (ASC-BLK-SUB ASC-ITEM-SUB)       30880000
308810             MOVE SUT00016-VND-RNKG-DESC TO                       30881000
308820                  ASC-AUDIT-DESC (ASC-BLK-SUB ASC-ITEM-SUB)       30882000
308821             IF PS-PKGNG-TYP-CDE-BC-YES                           30882100
308830                 MOVE PC-X  TO ASC-RANK-BULK-CSE                  30883000
308840                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30884000
308850             END-IF                                               30885000
308860             IF PS-PKGNG-TYP-CDE-PP-YES                           30886000
308870                 MOVE PC-X  TO ASC-RANK-PREPK                     30887000
308880                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30888000
308890             END-IF                                               30889000
308900             IF PS-PKGNG-TYP-CDE-PS-YES                           30890000
309000                 MOVE PC-X  TO ASC-RANK-PBS                       30900000
309100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30910000
309200             END-IF                                               30920000
      *SB 10/07/13 - BEGIN PR#5148D                                     30920100
                   IF PS-PKGNG-TYP-CDE-RF-YES                           30921000
                       MOVE PC-X  TO ASC-RANK-RFID                      30922000
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     30923000
                   END-IF                                               30924000
      *SB 10/07/13 - END PR#5148D                                       30925000
309300             SET   PS-PKGNG-TYP-CDE-BC-NO                         30930000
309400                   PS-PKGNG-TYP-CDE-PP-NO                         30940000
309500                   PS-PKGNG-TYP-CDE-PS-NO                         30950000
      *SB 10/07/13 - BEGIN PR#5148D                                     30951000
                         PS-PKGNG-TYP-CDE-RF-NO TO TRUE                 30960000
      *SB 10/07/13 - END PR#5148D                                       30970000
315100         END-IF                                                   31510000
315200     END-PERFORM.                                                 31520000
315300                                                                  31530000
315400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          31540000
315500         MOVE +1               TO ASC-BLK-SUB                     31550000
315600         PERFORM 5100-WRITE-TEMP-STORAGE                          31560000
315700         ADD +1                TO ASC-BLK-SUB                     31570000
315800         PERFORM 5100-WRITE-TEMP-STORAGE                          31580000
315900                                                                  31590000
316000         MOVE 1                TO ASC-BLK-SUB                     31600000
316100                                  PV-BLOCK-NUMBER                 31610000
316200         PERFORM 4410-READ-TEMP-STORAGE                           31620000
316300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             31630000
316400             MOVE 2            TO ASC-BLK-SUB                     31640000
316500                                  PV-BLOCK-NUMBER                 31650000
316600             PERFORM 4410-READ-TEMP-STORAGE                       31660000
316700         END-IF                                                   31670000
316800     END-IF.                                                      31680000
316900                                                                  31690000
317000 EJECT                                                            31700000
317140*----------------------------------------------------------------*31714000
317200*    FETCH THE VEND RANK CODE CURSOR                             *31720000
317300*----------------------------------------------------------------*31730000
317400                                                                  31740000
317500 4310-FETCH-VEND-RNK-CDE-CSR.                                     31750000
317600                                                                  31760000
317700         EXEC SQL                                                 31770000
317800             FETCH VEND_RNK_CDE_CSR                               31780000
318110             INTO   :SUT00016-VND-RNKG-CDE                        31811000
318120                  , :SUT00016-VND-RNKG-DESC                       31812000
318200         END-EXEC                                                 31820000
318300                                                                  31830000
318400     EVALUATE TRUE                                                31840000
318500         WHEN SQLCODE = ZERO                                      31850000
318510              CONTINUE                                            31851000
318900         WHEN SQLCODE = +100                                      31890000
319000              SET ASC-NO-ITEMS-LEFT-ON-DB                         31900000
319100                                        TO TRUE                   31910000
319200         WHEN SQLWARN0 NOT = SPACE                                31920000
319300         WHEN SQLCODE NOT = ZERO                                  31930000
319400              MOVE '4310-FETCH-VEND-RNK-CDE-CSR'                  31940000
319500                               TO DP013-PARAGRAPH                 31950000
319600              MOVE 'FETCH VEND RANK CDE CURSOR'                   31960000
319700                               TO DP013-MESSAGE-TEXT (1)          31970000
319800              MOVE 'VEND_RNK_CDE_CSR'                             31980000
319810                               TO DP013-DB2-TABLE-NAME (1)        31981000
319900              MOVE SQLCA       TO DP013-SQLCA                     31990000
320000              SET DP013-DB2-ABEND                                 32000000
320100                               TO TRUE                            32010000
320200              PERFORM DP013-0000-PROCESS-ABEND                    32020000
320300     END-EVALUATE.                                                32030000
320400                                                                  32040000
320500                                                                  32050000
329200*----------------------------------------------------------------*32920000
329300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *32930000
329400*----------------------------------------------------------------*32940000
329500                                                                  32950000
329600 4400-MOVE-COMMAREA-TO-SCREEN.                                    32960000
329700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             32970000
329800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          32980000
329900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          32990000
330000             MOVE +1    TO ASC-BLK-SUB                            33000000
330100             PERFORM 5100-WRITE-TEMP-STORAGE                      33010000
330200             ADD +1     TO ASC-BLK-SUB                            33020000
330300             PERFORM 5100-WRITE-TEMP-STORAGE                      33030000
330400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             33040000
330500                 GIVING PV-BLOCK-NUMBER                           33050000
330600                 REMAINDER PV-REMAINDER                           33060000
330700             IF  PV-REMAINDER > ZERO                              33070000
330800                 ADD +1 TO PV-BLOCK-NUMBER                        33080000
330900             END-IF                                               33090000
331000             MOVE +1    TO ASC-BLK-SUB                            33100000
331100             PERFORM 4410-READ-TEMP-STORAGE                       33110000
331200             ADD +1     TO ASC-BLK-SUB                            33120000
331300                           PV-BLOCK-NUMBER                        33130000
331400             PERFORM 4410-READ-TEMP-STORAGE                       33140000
331500     END-IF.                                                      33150000
331600     MOVE +1            TO ASC-BLK-SUB.                           33160000
331700     COMPUTE ASC-ITEM-SUB =                                       33170000
331800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              33180000
331900         + PC-ITEMS-PER-PANEL).                                   33190000
332000                                                                  33200000
332100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        33210000
332200         ADD +1         TO ASC-BLK-SUB                            33220000
332300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            33230000
332400     END-IF.                                                      33240000
332500                                                                  33250000
332600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           33260000
332700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                33270000
332800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        33280000
332900     PERFORM 4420-FORMAT-LIST-LINES                               33290000
333000         VARYING PV-SUB                                           33300000
333100         FROM PC-ITEMS-PER-PANEL BY -1                            33310000
333200         UNTIL PV-SUB < +1.                                       33320000
333300                                                                  33330000
333400     COMPUTE ASC-ITEMS-DISPLAYED =                                33340000
333500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          33350000
333600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    33360000
333700                                      ASTRTITO.                   33370000
333800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    33380000
333900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    33390000
334000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            33400000
334100                                   TO ASELITO.                    33410000
335200                                                                  33520000
335300     IF  DP020-MSG-NUMBER-X = SPACE                               33530000
335400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  33540000
335500*            --- MORE ITEMS TO DISPLAY ----                       33550000
335600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            33560000
335700             SET DP020-MSG-INFORMATIONAL TO TRUE                  33570000
335800         END-IF                                                   33580000
335900     END-IF.                                                      33590000
336000*----------------------------------------------------------------*33600000
336100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *33610000
336200*----------------------------------------------------------------*33620000
336300                                                                  33630000
336400 4410-READ-TEMP-STORAGE.                                          33640000
336500                                                                  33650000
336600     EXEC CICS                                                    33660000
336700         READQ TS                                                 33670000
336800             QUEUE (ASC-LIST-QUEUE-NAME)                          33680000
336900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33690000
337000             ITEM  (PV-BLOCK-NUMBER)                              33700000
337100             RESP  (PV-CICS-RESP)                                 33710000
337200     END-EXEC.                                                    33720000
337300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       33730000
337400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     33740000
337500         CONTINUE                                                 33750000
337600     ELSE                                                         33760000
337700         SET DP013-CICS-ABEND     TO TRUE                         33770000
337800         SET DP013-NO-ROLLBACK    TO TRUE                         33780000
337900         MOVE '4410-READ-TEMP-STORAGE'                            33790000
338000                                  TO DP013-PARAGRAPH              33800000
338100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33810000
338200                                  TO DP013-MESSAGE-TEXT(1)        33820000
338300         PERFORM DP013-0000-PROCESS-ABEND                         33830000
338400     END-IF.                                                      33840000
338500                                                                  33850000
338600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33860000
338700                                                                  33870000
338800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33880000
338900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33890000
339000     END-IF.                                                      33900000
339100 EJECT                                                            33910000
339200*----------------------------------------------------------------*33920000
339300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33930000
339400*----------------------------------------------------------------*33940000
339500                                                                  33950000
339600 4420-FORMAT-LIST-LINES.                                          33960000
339700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33970000
339800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33980000
339900         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           33990000
340100         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           34010000
340300         MOVE SPACE              TO MR-ACTION  (PV-SUB)           34030000
340400                                    MR-SELECTI (PV-SUB)           34040000
340500                                    MR-AUDIT-RANK (PV-SUB)        34050000
340600                                    MR-AUDIT-DESC (PV-SUB)        34060000
340700                                    MR-RANK-BULK-CSE (PV-SUB)     34070000
340800                                    MR-RANK-PREPK (PV-SUB)        34080000
340900                                    MR-RANK-PBS (PV-SUB)          34090000
      *SB 10/07/13 - BEGIN PR#5148D                                     34090100
                                          MR-RANK-RFID (PV-SUB)         34091000
      *SB 10/07/13 - END PR#5148D                                       34092000
341000     ELSE                                                         34100000
341100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      34110000
341200                                                   > SPACE        34120000
341300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 34130000
341400                                 TO MR-SELECTI (PV-SUB)           34140000
341500         ELSE                                                     34150000
341600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      34160000
341700                                 TO MR-SELECTI (PV-SUB)           34170000
341800         END-IF                                                   34180000
341900                                                                  34190000
342000         IF  DP030-SET-CURSOR-TRAILER                             34200000
342100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)34210000
342200                 > SPACE)                                         34220000
342300               OR (PV-SUB = 1))                                   34230000
342400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               34240000
342500                MOVE -1          TO MR-SELECTL (PV-SUB)           34250000
342600             END-IF                                               34260000
342700         END-IF                                                   34270000
344300                                                                  34430000
344400         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           34440000
344500             MOVE DP015-BLUE   TO MR-ACTIONC (PV-SUB)             34450000
345500             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           34550000
345600                                 TO MR-ACTION (PV-SUB)            34560000
345700             MOVE ASC-AUDIT-RANK (ASC-BLK-SUB ASC-ITEM-SUB)       34570000
345800                                 TO MR-AUDIT-RANK (PV-SUB)        34580000
345900             MOVE ASC-AUDIT-DESC (ASC-BLK-SUB ASC-ITEM-SUB)       34590000
346000                                 TO MR-AUDIT-DESC (PV-SUB)        34600000
346100             MOVE ASC-RANK-BULK-CSE (ASC-BLK-SUB ASC-ITEM-SUB)    34610000
346200                                 TO MR-RANK-BULK-CSE (PV-SUB)     34620000
346300             MOVE ASC-RANK-PREPK (ASC-BLK-SUB ASC-ITEM-SUB)       34630000
346400                                 TO MR-RANK-PREPK (PV-SUB)        34640000
346500             MOVE ASC-RANK-PBS (ASC-BLK-SUB ASC-ITEM-SUB)         34650000
346600                                 TO MR-RANK-PBS (PV-SUB)          34660000
      *SB 10/07/13 - BEGIN PR#5148D                                     34660100
                   MOVE ASC-RANK-RFID (ASC-BLK-SUB ASC-ITEM-SUB)        34661000
                                       TO MR-RANK-RFID (PV-SUB)         34662000
      *SB 10/07/13 - END PR#5148D                                       34663000
346700         ELSE                                                     34670000
346800             IF ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    34680000
346900                 MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)       34690000
347000                                     TO MR-ACTION (PV-SUB)        34700000
347400                                                                  34740000
347500             END-IF                                               34750000
347600         END-IF                                                   34760000
347700     END-IF.                                                      34770000
347800     SUBTRACT +1 FROM ASC-ITEM-SUB                                34780000
347900     IF  ASC-ITEM-SUB < + 1                                       34790000
348000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  34800000
348100         MOVE +1                 TO ASC-BLK-SUB                   34810000
348200     END-IF.                                                      34820000
348300******************************************************************34830000
348400** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **34840000
348500** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **34850000
348600** ISSUE A WARNING.                                             **34860000
348700******************************************************************34870000
348800 4430-CHECK-FOR-BEGIN-AND-END.                                    34880000
348900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34890000
349000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34900000
349100*            -- NO END-OF-RANGE SPECFIED ---                      34910000
349200             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34920000
349300             SET DP020-MSG-WARNING TO TRUE                        34930000
349400             PERFORM 4431-POSITION-AT-WARNING                     34940000
349500         END-IF                                                   34950000
349600     ELSE                                                         34960000
349700         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34970000
349800*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34980000
349900             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34990000
350000             SET DP020-MSG-WARNING TO TRUE                        35000000
350100             PERFORM 4431-POSITION-AT-WARNING                     35010000
350200         END-IF                                                   35020000
350300     END-IF.                                                      35030000
350400******************************************************************35040000
350500** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **35050000
350600** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **35060000
350700** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **35070000
350800** POSITION THE CURSOR THERE.                                   **35080000
350900******************************************************************35090000
351000 4431-POSITION-AT-WARNING.                                        35100000
351100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 35110000
351200                    - PV-TOP-ITEM + 1.                            35120000
351300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      35130000
351400         CONTINUE                                                 35140000
351500     ELSE                                                         35150000
351600         SET DP030-SET-CURSOR-APPL-1                              35160000
351700                                   TO TRUE                        35170000
351800         MOVE -1                   TO MR-SELECTL (PV-SUB)         35180000
351900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         35190000
352000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         35200000
352100     END-IF.                                                      35210000
352200                                                                  35220000
352300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   35230000
352400                    - PV-TOP-ITEM + 1.                            35240000
352500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      35250000
352600         CONTINUE                                                 35260000
352700     ELSE                                                         35270000
352800         SET DP030-SET-CURSOR-APPL-1                              35280000
352900                                   TO TRUE                        35290000
353000         MOVE -1                   TO MR-SELECTL (PV-SUB)         35300000
353100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         35310000
353200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         35320000
353300     END-IF.                                                      35330000
353400 EJECT                                                            35340000
353500*----------------------------------------------------------------*35350000
353600*  PRINT AND UPDATE FUNCTION                                      35360000
353700*----------------------------------------------------------------*35370000
353800 4600-PROCESS-DELETE-FUNCTION.                                    35380000
353900                                                                  35390000
354000                                                                  35400000
354100     MOVE +1                       TO ASC-BLK-SUB.                35410000
354200     PERFORM 5100-WRITE-TEMP-STORAGE.                             35420000
354300     ADD +1                        TO ASC-BLK-SUB.                35430000
354400     PERFORM 5100-WRITE-TEMP-STORAGE.                             35440000
354500                                                                  35450000
354600     PERFORM 6112-READ-LIST-QUEUE.                                35460000
354700                                                                  35470000
354800     SET  LQW-IDX  TO   1.                                        35480000
354900                                                                  35490000
355000       IF PV-CICS-RESP = DFHRESP (NORMAL)                         35500000
355100         PERFORM                                                  35510000
355200         VARYING LQW-IDX  FROM 1 BY 1                             35520000
355300         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     35530000
355400            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            35540000
355500            OR   PS-ERROR                                         35550000
355600             IF  LQW-SELECT (LQW-IDX)                             35560000
355700                 PERFORM 4605-PROCESS-SELECTED-LINES              35570000
355800             END-IF                                               35580000
355900         END-PERFORM                                              35590000
356000       END-IF.                                                    35600000
356100                                                                  35610000
356200     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           35620000
356300     PERFORM 6111-WRITE-LIST-QUEUE.                               35630000
356400                                                                  35640000
356500     MOVE +1                     TO  ASC-BLK-SUB.                 35650000
356600     PERFORM 4410-READ-TEMP-STORAGE.                              35660000
356700                                                                  35670000
356800     ADD +1                      TO  ASC-BLK-SUB                  35680000
356900                                     PV-BLOCK-NUMBER.             35690000
357000                                                                  35700000
357100     PERFORM 4410-READ-TEMP-STORAGE.                              35710000
357200                                                                  35720000
357300*----------------------------------------------------------------*35730000
357400*                                                                 35740000
357500*----------------------------------------------------------------*35750000
357600 4605-PROCESS-SELECTED-LINES.                                     35760000
357700                                                                  35770000
357800     PERFORM 4620-PROCESS-LINES.                                  35780000
357900                                                                  35790000
358000     IF  PS-NO-ERROR                                              35800000
358100         SET  LQW-DESELECT (LQW-IDX) TO TRUE                      35810000
358400         MOVE PC-DEL      TO LQW-ACTION (LQW-IDX)                 35840000
358800                                                                  35880000
361200         SUBTRACT  1                                              36120000
361300             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   36130000
361400         MOVE LQW-SELECTED-SW (LQW-IDX)                           36140000
361500                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   36150000
361600     END-IF.                                                      36160000
361700                                                                  36170000
361800                                                                  36180000
361900*----------------------------------------------------------------*36190000
362000*                                                                 36200000
362100*                                                                 36210000
362200*----------------------------------------------------------------*36220000
362300 4620-PROCESS-LINES.                                              36230000
362400                                                                  36240000
362500                                                                  36250000
362600     IF  PS-NO-ERROR                                              36260000
362700         MOVE LQW-AUDIT-RANK (LQW-IDX) TO DK-VND-RNKG-CDE         36270000
363100                                                                  36310000
363200******************************************************************36320000
363300* PROCESS SELECTED LINES BASED ON FUNCTION SELECTED               36330000
364000* FUNC-03 (DELETE)                                                36400000
364100*  --DELETE SELECTED AUDIT RANK, ONLY IF THERE ARE NO             36410000
364200*       VENDORS OR VENDOR/DEPARTMENTS THAT HAVE THE SELECTED      36420000
364210*       AUDIT RANK/PKING TYPE CLASSIFICATION                      36421000
364220*       --OR--                                                    36422000
364230*       IF THERE IS AN ENTRY IN THE AUDIT REQUEST TABLE           36423000
364300******************************************************************36430000
364900                                                                  36490000
365000                                                                  36500000
365100         IF  LQW-SELECT (LQW-IDX)                                 36510000
365200             IF ASC-CONFIRM-DELETE                                36520000
365201                PERFORM 4150-CHECK-VEND-DEPT-RNKG                 36520100
365202                PERFORM 4170-CHECK-VEND-RNKG                      36520200
365203                PERFORM 4180-CHECK-PO-AUD-REQ                     36520300
365210                IF PS-VND-DEPT-RNKG-EXISTS OR                     36521000
365300                   PS-VND-RNKG-EXISTS OR                          36530000
365310                   PS-PO-AUD-REQ-EXISTS                           36531000
365320                       SET PS-ERROR TO TRUE                       36532000
365330                ELSE                                              36533000
365340                   PERFORM 4200-DELETE-PO-AUDIT-PARM              36534000
365350                   PERFORM 4210-DELETE-VENDOR-PKNG-ASSN           36535000
365360                   PERFORM 4220-DELETE-VENDOR-RNKNG-CDE           36536000
366000                END-IF                                            36600000
372360         END-IF.                                                  37236000
372380                                                                  37238000
372390                                                                  37239000
382700*----------------------------------------------------------------*38270000
382800*----------------------------------------------------------------*38280000
382900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *38290000
383000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *38300000
383100* FOR THE SELECTED ITEMS QUEUE.                                  *38310000
383200*                                                                *38320000
383300* DETERMINE WHICH COPYBOOK WILL BE USED TO PREPARE THE SELECTION *38330000
383400* QUEUE BASED ON THE FUNCTION SELECTED (FUCN02 AND FUNC03 GO TO  *38340000
383500* RC LISTS WHICH USE A DIFFERENT COPYBOOK                        *38350000
383600*                                                                *38360000
383700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *38370000
383800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *38380000
383900* THE ARRAY IS FULL.                                             *38390000
384000*----------------------------------------------------------------*38400000
384100                                                                  38410000
384200 5000-PREPARE-SEL-QUEUE.                                          38420000
384300                                                                  38430000
384400     MOVE +1                   TO  ASC-BLK-SUB.                   38440000
384500     PERFORM 5100-WRITE-TEMP-STORAGE.                             38450000
384600     ADD +1                    TO  ASC-BLK-SUB.                   38460000
384700     PERFORM 5100-WRITE-TEMP-STORAGE.                             38470000
385500     MOVE ASC-SEL-QUEUE-NAME     TO  SU015-SEL-QUEUE-NAME         38550000
385700                                                                  38570000
385800     PERFORM 6010-DELETE-SEL-QUEUE.                               38580000
385900                                                                  38590000
386000     SET ASC-UPDATE-TSQ        TO  TRUE.                          38600000
387200     SET SU016-IDX         TO  1                                  38720000
387300     MOVE ZERO             TO SU015-NUMBER-OF-TS-ITEMS            38730000
387400     INITIALIZE SU016-SELECTED-ITEM-ARRAY                         38740000
387600                                                                  38760000
389000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           38900000
389100       VARYING PV-ITEM FROM 1 BY 1                                38910000
389200         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                38920000
389400                                                                  38940000
389500                                                                  38950000
390900       IF SU016-IDX > 1                                           39090000
391000           PERFORM 5205-WRITE-SEL-QUEUE                           39100000
391100           ADD +1 TO SU015-NUMBER-OF-TS-ITEMS                     39110000
391200       END-IF.                                                    39120000
391400 EJECT                                                            39140000
391500                                                                  39150000
391600**********************************************************        39160000
391700 5010-OPEN-PACK-TYPE-CSR.                                         39170000
392000**********************************************************        39200000
392100                                                                  39210000
392200     PERFORM                                                      39220000
392300         WITH TEST AFTER                                          39230000
392400         VARYING PV-RETRY-COUNTER                                 39240000
392500         FROM 1 BY 1                                              39250000
392600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39260000
392700                   OR (SQLCODE = ZERO))                           39270000
392800                                                                  39280000
392900                 EXEC SQL                                         39290000
393000                      OPEN PACK_TYPE_CSR                          39300000
393100                 END-EXEC                                         39310000
393200                                                                  39320000
393300                                                                  39330000
393400         EVALUATE TRUE                                            39340000
393500             WHEN SQLCODE = ZERO                                  39350000
393600             WHEN SQLCODE = -904                                  39360000
393700             WHEN SQLCODE = -913                                  39370000
393800                 CONTINUE                                         39380000
393900             WHEN SQLWARN0 NOT = SPACES                           39390000
394000             WHEN SQLCODE < ZERO                                  39400000
394100             WHEN SQLCODE > ZERO                                  39410000
394200                 MOVE '5010-OPEN-PACK-TYPE-CSR '                  39420000
394300                                   TO DP013-PARAGRAPH             39430000
394400                 MOVE 'OPEN PACK TYPE CSR - '                     39440000
394500                                   TO DP013-MESSAGE-TEXT (1)      39450000
394600                 MOVE SQLCA        TO DP013-SQLCA                 39460000
394700                 MOVE 'SUT_PO_AUD_PARM'                           39470000
394710                                   TO DP013-DB2-TABLE-NAME (1)    39471000
394800                 SET DP013-DB2-ABEND                              39480000
394900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39490000
395000                 PERFORM DP013-0000-PROCESS-ABEND                 39500000
395100         END-EVALUATE                                             39510000
395200     END-PERFORM.                                                 39520000
395300                                                                  39530000
395400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39540000
395500         SQLCODE NOT = ZERO                                       39550000
395600         MOVE '5010-OPEN-PACK-TYPE-CSR ' TO DP013-PARAGRAPH       39560000
395700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   39570000
395800                                   TO DP013-MESSAGE-TEXT (1)      39580000
395900         MOVE SQLCA                TO DP013-SQLCA                 39590000
396000         MOVE 'SUT_PO_AUD_PARM'    TO DP013-DB2-TABLE-NAME (1)    39600000
396100         SET DP013-DB2-ABEND                                      39610000
396200             DP013-XCTL-DISPLAY-RESTART                           39620000
396300                                   TO TRUE                        39630000
396400         PERFORM DP013-0000-PROCESS-ABEND                         39640000
396500     END-IF.                                                      39650000
396600                                                                  39660000
396700 EJECT                                                            39670000
396710*-----------------------------------------------------------------39671000
396720* FETCH PACK TYPE CURSOR                                          39672000
396730*-----------------------------------------------------------------39673000
396740 5020-FETCH-PACK-TYPE-CSR.                                        39674000
396750                                                                  39675000
396760     EXEC SQL                                                     39676000
396770            FETCH   PACK_TYPE_CSR                                 39677000
396780            INTO   :SUT00017-PKGNG-TYP-CDE                        39678000
396793     END-EXEC                                                     39679300
396794                                                                  39679400
396795                                                                  39679500
396796     EVALUATE TRUE                                                39679600
396797         WHEN SQLCODE = ZERO                                      39679700
396798           EVALUATE TRUE                                          39679800
396799             WHEN SUT00017-PKGNG-TYP-CDE = 'BC'                   39679900
396800                 SET PS-PKGNG-TYP-CDE-BC-YES TO TRUE              39680000
396803             WHEN SUT00017-PKGNG-TYP-CDE = 'PP'                   39680300
396804                 SET PS-PKGNG-TYP-CDE-PP-YES TO TRUE              39680400
396807             WHEN SUT00017-PKGNG-TYP-CDE = 'PS'                   39680700
396808                 SET PS-PKGNG-TYP-CDE-PS-YES TO TRUE              39680800
      *SB 10/07/13 - BEGIN PR#5148D                                     39680900
                   WHEN SUT00017-PKGNG-TYP-CDE = 'RF'                   39681000
                       SET PS-PKGNG-TYP-CDE-RF-YES TO TRUE              39681100
      *SB 10/07/13 - END PR#5148D                                       39681200
396811           END-EVALUATE                                           39681300
396812         WHEN SQLCODE = +100                                      39681400
396813              SET PS-END-OF-PACK-TYP-CSR TO TRUE                  39681500
396814         WHEN SQLWARN0 NOT = SPACE                                39681600
396815         WHEN SQLCODE NOT = ZERO                                  39681700
396816              MOVE '5020-FETCH-PACK-TYPE-CSR'                     39681800
396817                               TO DP013-PARAGRAPH                 39681900
396818              MOVE 'FETCH PACK TYPE CURSOR'                       39682000
396819                               TO DP013-MESSAGE-TEXT (1)          39682100
396820              MOVE SQLCA       TO DP013-SQLCA                     39682200
396821              SET DP013-DB2-ABEND                                 39682300
396822                               TO TRUE                            39682400
396823              PERFORM DP013-0000-PROCESS-ABEND                    39682500
396824     END-EVALUATE.                                                39682600
396830******************************************************************39683000
396900* CLOSE PACK TYPE CURSOR                                       * *39690000
397000******************************************************************39700000
397100 5030-CLOSE-PACK-TYPE-CSR.                                        39710000
397200                                                                  39720000
397300         EXEC SQL                                                 39730000
397400             CLOSE PACK_TYPE_CSR                                  39740000
397500         END-EXEC                                                 39750000
397600                                                                  39760000
397700     EVALUATE TRUE                                                39770000
397800         WHEN SQLCODE = ZERO                                      39780000
397900             CONTINUE                                             39790000
398000         WHEN SQLWARN0 NOT = SPACES                               39800000
398100         WHEN SQLCODE < ZERO                                      39810000
398200         WHEN SQLCODE > ZERO                                      39820000
398300             MOVE '5030-CLOSE-PACK-TYPE-CSR '                     39830000
398400                               TO DP013-PARAGRAPH                 39840000
398500             MOVE 'CLOSE PACK TYPE CSR '                          39850000
398600                               TO DP013-MESSAGE-TEXT (1)          39860000
398700             MOVE SQLCA        TO DP013-SQLCA                     39870000
398800             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        39880000
398900             SET DP013-DB2-ABEND                                  39890000
399000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39900000
399100             PERFORM DP013-0000-PROCESS-ABEND                     39910000
399200     END-EVALUATE.                                                39920000
399210                                                                  39921000
399220 EJECT                                                            39922000
399300*----------------------------------------------------------------*39930000
399400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *39940000
399500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *39950000
399600*----------------------------------------------------------------*39960000
399700                                                                  39970000
399800 5100-WRITE-TEMP-STORAGE.                                         39980000
399900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     39990000
400000                                   TO PV-LIST-ITEM-NUMBER.        40000000
400100     COMPUTE PV-BLOCK-NUMBER =                                    40010000
400200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    40020000
400300                                                                  40030000
400400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             40040000
400500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             40050000
400600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      40060000
400700             PERFORM 5105-REWRITE-ASC-LISTQ                       40070000
400800         END-IF                                                   40080000
400900     ELSE                                                         40090000
401000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       40100000
401100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            40110000
401200         PERFORM 5110-WRITE-ASC-LISTQ                             40120000
401300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   40130000
401400     END-IF.                                                      40140000
401500                                                                  40150000
401600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             40160000
401700******************************************************************40170000
401800** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **40180000
401900** SPECIFIC COMMAREA.                                           **40190000
402000******************************************************************40200000
402100 5105-REWRITE-ASC-LISTQ.                                          40210000
402200     EXEC CICS                                                    40220000
402300         WRITEQ TS                                                40230000
402400             QUEUE (ASC-LIST-QUEUE-NAME)                          40240000
402500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               40250000
402600             ITEM  (PV-BLOCK-NUMBER)                              40260000
402700             REWRITE                                              40270000
402800             RESP  (PV-CICS-RESP)                                 40280000
402900     END-EXEC.                                                    40290000
403000                                                                  40300000
403100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           40310000
403200         CONTINUE                                                 40320000
403300     ELSE                                                         40330000
403400         SET DP013-CICS-ABEND            TO TRUE                  40340000
403500         SET DP013-NO-ROLLBACK           TO TRUE                  40350000
403600         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       40360000
403700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     40370000
403800                                         TO DP013-MESSAGE-TEXT(1) 40380000
403900         PERFORM DP013-0000-PROCESS-ABEND                         40390000
404000     END-IF.                                                      40400000
404100                                                                  40410000
404200******************************************************************40420000
404300** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **40430000
404400** SPECIFIC COMMAREA.                                           **40440000
404500******************************************************************40450000
404600 5110-WRITE-ASC-LISTQ.                                            40460000
404700     EXEC CICS                                                    40470000
404800         WRITEQ TS                                                40480000
404900             QUEUE (ASC-LIST-QUEUE-NAME)                          40490000
405000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               40500000
405100             ITEM  (PV-BLOCK-NUMBER)                              40510000
405200             RESP  (PV-CICS-RESP)                                 40520000
405300     END-EXEC.                                                    40530000
405400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      40540000
405500         SET DP013-CICS-ABEND      TO TRUE                        40550000
405600         SET DP013-NO-ROLLBACK     TO TRUE                        40560000
405700         MOVE '5110-WRITE-ASC-LISTQ'                              40570000
405800                                   TO DP013-PARAGRAPH             40580000
405900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           40590000
406000                                   TO DP013-MESSAGE-TEXT(1)       40600000
406100         PERFORM DP013-0000-PROCESS-ABEND                         40610000
406200     END-IF.                                                      40620000
406300 EJECT                                                            40630000
406400*----------------------------------------------------------------*40640000
406500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *40650000
406600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *40660000
406700*----------------------------------------------------------------*40670000
406800                                                                  40680000
406900 5200-FILL-SEL-QUEUE-RECORD.                                      40690000
407000                                                                  40700000
407100     PERFORM 6112-READ-LIST-QUEUE.                                40710000
407200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       40720000
407300         PERFORM                                                  40730000
407400         VARYING LQW-IDX                                          40740000
407500         FROM 1 BY 1                                              40750000
407600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            40760000
407700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          40770000
407800                                                                  40780000
407900             IF  LQW-SELECT (LQW-IDX)                             40790000
408000               MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)                40800000
408100                                 TO SU016-ITEM (SU016-IDX)        40810000
408200               MOVE SPACE        TO SU016-ACTION-SW (SU016-IDX)   40820000
408300               MOVE LQW-AUDIT-RANK (LQW-IDX)                      40830000
408400                         TO SU016-VEND-RNK-CDE (SU016-IDX)        40840000
408500               MOVE LQW-AUDIT-DESC (LQW-IDX)                      40850000
408600                         TO SU016-VEND-RNK-DESC (SU016-IDX)       40860000
409600                 SET SU016-IDX UP BY 1                            40960000
409700                 IF  SU016-IDX > SU016-MAX-ITEMS                  40970000
409800                     PERFORM 5205-WRITE-SEL-QUEUE                 40980000
409900                     ADD +1        TO SU015-NUMBER-OF-TS-ITEMS    40990000
410000                     INITIALIZE SU016-SELECTED-ITEM-ARRAY         41000000
410100                     SET SU016-IDX TO  1                          41010000
410200                 END-IF                                           41020000
410300             END-IF                                               41030000
410400         END-PERFORM                                              41040000
410500     END-IF.                                                      41050000
410600                                                                  41060000
410700*----------------------------------------------------------------*41070000
410800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *41080000
410900*----------------------------------------------------------------*41090000
411000                                                                  41100000
411100 5205-WRITE-SEL-QUEUE.                                            41110000
411200                                                                  41120000
411300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            41130000
411400                                   TO SU016-SELECTED-ITEMS.       41140000
411500                                                                  41150000
411600     EXEC CICS                                                    41160000
411700          WRITEQ TS                                               41170000
411800              QUEUE (ASC-SEL-QUEUE-NAME)                          41180000
411900              FROM  (SU016-SELECT-RECORD)                         41190000
412000              ITEM  (PV-SEL-QUEUE-ITEM)                           41200000
412100              RESP  (PV-CICS-RESP)                                41210000
412200     END-EXEC.                                                    41220000
412300                                                                  41230000
412400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          41240000
412500         CONTINUE                                                 41250000
412600     ELSE                                                         41260000
412700         SET DP013-CICS-ABEND      TO TRUE                        41270000
412800         SET DP013-NO-ROLLBACK     TO TRUE                        41280000
412900         MOVE '5205-WRITE-SEL-QUEUE'                              41290000
413000                                   TO DP013-PARAGRAPH             41300000
413100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          41310000
413200                                   TO DP013-MESSAGE-TEXT(1)       41320000
413300         PERFORM DP013-0000-PROCESS-ABEND                         41330000
413400     END-IF.                                                      41340000
484342******************************************************************48434200
484343 6000-REFRESH-PANEL-FROM-TEMP.                                    48434300
484344     IF  ASC-UPDATE-TSQ                                           48434400
484350         SET ASC-NO-TSQ-UPDATE TO TRUE                            48435000
484360         MOVE ZERO                 TO PV-SAVE-ITEM                48436000
484370                                      PV-SEL-QUEUE-ITEM           48437000
484380         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        48438000
484390                                   TO PV-HOLD-SELECTED-ITEMS      48439000
484400         MOVE +1                   TO PV-ITEMS-PROCESSED          48440000
485400         PERFORM 6100-UPDATE-TSQ                                  48540000
485500           UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS      48550000
485700                                                                  48570000
485800         SET ASC-FUNC02-RETURN-NO TO TRUE                         48580000
486200                                                                  48620000
486300                                                                  48630000
486400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         48640000
486500                    ASC-BLOCK-ENTRIES (2)                         48650000
486600     END-IF.                                                      48660000
486700                                                                  48670000
486800*----------------------------------------------------------------*48680000
486900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *48690000
487000*----------------------------------------------------------------*48700000
487100 6010-DELETE-SEL-QUEUE.                                           48710000
487200                                                                  48720000
487300     EXEC CICS                                                    48730000
487400         DELETEQ TS                                               48740000
487500             QUEUE (ASC-SEL-QUEUE-NAME)                           48750000
487600             RESP  (PV-CICS-RESP)                                 48760000
487700     END-EXEC.                                                    48770000
487800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      48780000
487900        (PV-CICS-RESP = DFHRESP(QIDERR)))                         48790000
488000         CONTINUE                                                 48800000
488100     ELSE                                                         48810000
488200         SET DP013-CICS-ABEND TO TRUE                             48820000
488300         SET DP013-NO-ROLLBACK TO TRUE                            48830000
488400         MOVE '6010-DELETE-SEL-QUEUE'                             48840000
488500                        TO DP013-PARAGRAPH                        48850000
488600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         48860000
488700                        TO DP013-MESSAGE-TEXT (1)                 48870000
488800         PERFORM DP013-0000-PROCESS-ABEND                         48880000
488900     END-IF.                                                      48890000
489000                                                                  48900000
489100 EJECT                                                            48910000
489200*----------------------------------------------------------------*48920000
489300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *48930000
489400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *48940000
489500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *48950000
489600*    THE TEMP QUEUE.                                             *48960000
489700*----------------------------------------------------------------*48970000
489800                                                                  48980000
489900 6100-UPDATE-TSQ.                                                 48990000
490000                                                                  49000000
490100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             49010000
490200     PERFORM 6105-READ-SEL-QUEUE.                                 49020000
490300     PERFORM                                                      49030000
490400         VARYING SU016-IDX                                        49040000
490500         FROM 1 BY 1                                              49050000
490600         UNTIL ((PV-ITEMS-PROCESSED >                             49060000
490700                              PV-HOLD-SELECTED-ITEMS)             49070000
490800         OR (SU016-IDX GREATER THAN SU016-MAX-ITEMS))             49080000
490900         IF  SU016-ACTION-SW (SU016-IDX) > SPACE                  49090000
491000             PERFORM 6110-PROCESS-ITEMS                           49100000
491100         END-IF                                                   49110000
491200         ADD +1                TO PV-ITEMS-PROCESSED              49120000
491300     END-PERFORM.                                                 49130000
491400     PERFORM 6111-WRITE-LIST-QUEUE.                               49140000
491500*----------------------------------------------------------------*49150000
491600*    READ THE LIST QUEUE RECORD.                                 *49160000
491700*----------------------------------------------------------------*49170000
491800                                                                  49180000
491900 6105-READ-SEL-QUEUE.                                             49190000
492000                                                                  49200000
492100     EXEC CICS                                                    49210000
492200          READQ TS                                                49220000
492300              QUEUE (ASC-SEL-QUEUE-NAME)                          49230000
492400              INTO  (SU016-SELECT-RECORD)                         49240000
492500              ITEM  (PV-SEL-QUEUE-ITEM)                           49250000
492600              RESP  (PV-CICS-RESP)                                49260000
492700     END-EXEC.                                                    49270000
492800*                                                                 49280000
492900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49290000
493000         CONTINUE                                                 49300000
493100     ELSE                                                         49310000
493200         SET DP013-CICS-ABEND      TO  TRUE                       49320000
493300         SET DP013-NO-ROLLBACK     TO  TRUE                       49330000
493400         MOVE '6105-READ-SEL-QUEUE'                               49340000
493500                                   TO  DP013-PARAGRAPH            49350000
493600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           49360000
493700                                   TO  DP013-MESSAGE-TEXT(1)      49370000
493800         PERFORM DP013-0000-PROCESS-ABEND                         49380000
493900     END-IF.                                                      49390000
494000 EJECT                                                            49400000
494100*----------------------------------------------------------------*49410000
494200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*49420000
494300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*49430000
494400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *49440000
494500*----------------------------------------------------------------*49450000
494600                                                                  49460000
494700 6110-PROCESS-ITEMS.                                              49470000
494800                                                                  49480000
494900     COMPUTE PV-ITEM = 1 + ((SU016-ITEM (SU016-IDX) - 1)          49490000
495000                     / PC-ITEMS-PER-PANEL).                       49500000
495100                                                                  49510000
495200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           49520000
495300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          49530000
495400             PERFORM 6111-WRITE-LIST-QUEUE                        49540000
495500         END-IF                                                   49550000
495600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    49560000
495700                                                                  49570000
495800         PERFORM 6112-READ-LIST-QUEUE                             49580000
495900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               49590000
496000             CONTINUE                                             49600000
496100         END-IF                                                   49610000
496200     END-IF.                                                      49620000
496300                                                                  49630000
496400     COMPUTE PV-SUB = (SU016-ITEM (SU016-IDX)                     49640000
496500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              49650000
496600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         49660000
496700     MOVE LQW-SELECTED-SW (PV-SUB)                                49670000
496800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  49680000
496900     EVALUATE TRUE                                                49690000
497000         WHEN SU016-INQ (SU016-IDX)                               49700000
497100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             49710000
497200                                                                  49720000
497300         WHEN SU016-UPD (SU016-IDX)                               49730000
497400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             49740000
497500                                                                  49750000
497600         WHEN SU016-DEL (SU016-IDX)                               49760000
497700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             49770000
497800                                                                  49780000
497900         WHEN SU016-ERR (SU016-IDX)                               49790000
498000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             49800000
498100     END-EVALUATE.                                                49810000
498300     MOVE SU016-VEND-RNK-DESC (SU016-IDX)                         49830000
498400                               TO LQW-AUDIT-DESC (PV-SUB)         49840000
498500     IF SU016-PACK-TYPE-BC (SU016-IDX)                            49850000
498600         MOVE  PC-X            TO LQW-RANK-BULK-CSE (PV-SUB)      49860000
498700     END-IF                                                       49870000
498800     IF SU016-PACK-TYPE-PP (SU016-IDX)                            49880000
498900         MOVE  PC-X            TO LQW-RANK-PREPK (PV-SUB)         49890000
499000     END-IF                                                       49900000
499010     IF SU016-PACK-TYPE-PS (SU016-IDX)                            49901000
499020         MOVE  PC-X            TO LQW-RANK-PBS (PV-SUB)           49902000
499030     END-IF                                                       49903000
      *SB 10/07/13 - BEGIN PR#5148D                                     49903100
499010     IF SU016-PACK-TYPE-RF (SU016-IDX)                            49904000
499020         MOVE  PC-X            TO LQW-RANK-RFID (PV-SUB)          49905000
499030     END-IF                                                       49906000
      *SB 10/07/13 - END PR#5148D                                       49907000
499100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                49910000
499200                                                                  49920000
499300*----------------------------------------------------------------*49930000
499400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *49940000
499500*----------------------------------------------------------------*49950000
499600                                                                  49960000
499700 6111-WRITE-LIST-QUEUE.                                           49970000
499800                                                                  49980000
499900     EXEC CICS                                                    49990000
500000         WRITEQ TS                                                50000000
500100             QUEUE (ASC-LIST-QUEUE-NAME)                          50010000
500200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     50020000
500300             ITEM  (PV-SAVE-ITEM)                                 50030000
500400             REWRITE                                              50040000
500500             RESP  (PV-CICS-RESP)                                 50050000
500600     END-EXEC.                                                    50060000
500700*                                                                 50070000
500800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          50080000
500900         CONTINUE                                                 50090000
501000     ELSE                                                         50100000
501100         SET DP013-CICS-ABEND  TO  TRUE                           50110000
501200         SET DP013-NO-ROLLBACK TO  TRUE                           50120000
501300         MOVE '6111-WRITE-LIST-QUEUE'                             50130000
501400                               TO  DP013-PARAGRAPH                50140000
501500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  50150000
501600                               TO  DP013-MESSAGE-TEXT(1)          50160000
501700         PERFORM DP013-0000-PROCESS-ABEND                         50170000
501800     END-IF.                                                      50180000
501900                                                                  50190000
502000 EJECT                                                            50200000
502100*----------------------------------------------------------------*50210000
502200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*50220000
502300*----------------------------------------------------------------*50230000
502400                                                                  50240000
502500 6112-READ-LIST-QUEUE.                                            50250000
502600                                                                  50260000
502700     EXEC CICS                                                    50270000
502800         READQ TS                                                 50280000
502900             QUEUE (ASC-LIST-QUEUE-NAME)                          50290000
503000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     50300000
503100             ITEM  (PV-ITEM)                                      50310000
503200             RESP  (PV-CICS-RESP)                                 50320000
503300     END-EXEC.                                                    50330000
503400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          50340000
503500         CONTINUE                                                 50350000
503600     ELSE                                                         50360000
503700         SET DP013-CICS-ABEND        TO TRUE                      50370000
503800         SET DP013-NO-ROLLBACK       TO TRUE                      50380000
503900         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           50390000
504000         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    50400000
504100                                     TO DP013-MESSAGE-TEXT(1)     50410000
504200         PERFORM DP013-0000-PROCESS-ABEND                         50420000
504300     END-IF.                                                      50430000
504400                                                                  50440000
569827*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 56982700
569828 9100-READ-SEL-QUEUE.                                             56982800
569829     EXEC CICS                                                    56982900
569830         READQ TS                                                 56983000
569840             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        56984000
569850             INTO  (SU016-SELECT-RECORD)                          56985000
569860             ITEM  (ASC-SEL-ITEM)                                 56986000
569870             RESP  (PV-CICS-RESP)                                 56987000
569880     END-EXEC.                                                    56988000
569890     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        56989000
569900         CONTINUE                                                 56990000
570000     ELSE                                                         57000000
570100         SET DP013-LOGIC-ABEND                                    57010000
570200             DP013-NO-ROLLBACK   TO   TRUE                        57020000
570300         MOVE '9100-READ-SEL-QUEUE'                               57030000
570400                                 TO   DP013-PARAGRAPH             57040000
570500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   57050000
570600                                 TO   DP013-MESSAGE-TEXT (1)      57060000
570700         PERFORM DP013-0000-PROCESS-ABEND                         57070000
570800     END-IF.                                                      57080000
570900                                                                  57090000
571000                                                                  57100000
571100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*57110000
571200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *57120000
571300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 57130000
571400 9200-REWRITE-SEL-QUEUE.                                          57140000
571500                                                                  57150000
571600     EXEC CICS                                                    57160000
571700          WRITEQ TS                                               57170000
571800              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      57180000
571900              FROM   (SU016-SELECT-RECORD)                        57190000
572000              ITEM   (ASC-SEL-ITEM)                               57200000
572100              RESP   (PV-CICS-RESP)                               57210000
572200              REWRITE                                             57220000
572300     END-EXEC.                                                    57230000
572400                                                                  57240000
572500     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   57250000
572600         SET DP013-CICS-ABEND                                     57260000
572700             DP013-NO-ROLLBACK     TO TRUE                        57270000
572800         MOVE '9200-REWRITE-SEL-QUEUE'                            57280000
572900                                   TO DP013-PARAGRAPH             57290000
573000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   57300000
573100                                   TO DP013-MESSAGE-TEXT (1)      57310000
573200         PERFORM DP013-0000-PROCESS-ABEND                         57320000
573300     END-IF.                                                      57330000
573400                                                                  57340000
573500                                                                  57350000
573600*----------------------------------------------------------------*57360000
573700*    CURRENT SYSTEM DATE/TIME MODULE                              57370000
573800*----------------------------------------------------------------*57380000
573900                                                                  57390000
574000     COPY DPPD017.                                                57400000
574100                                                                  57410000
574200*----------------------------------------------------------------*57420000
574300*    ABEND PROCESSOR MODULE                                      *57430000
574400*----------------------------------------------------------------*57440000
574500                                                                  57450000
574600     COPY DPPD013.                                                57460000
574700                                                                  57470000
