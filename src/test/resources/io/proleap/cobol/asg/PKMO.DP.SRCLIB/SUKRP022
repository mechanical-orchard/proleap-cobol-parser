000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400 PROGRAM-ID.             SUKRP022.                                00040001
000500 AUTHOR.                 JOE LAROSA.                              00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN            FEBRUARY, 2000                           00070001
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*  PROGRAM CREATES THE 'INTRA-COMPANY MISDIRECTS FROM UCC128    * 00100001
001100*  SCAN RESULTS BY SCAC, TRAILER' REPORT.                       * 00110001
001200*                                                               * 00120001
001300*  THIS REPORT CAN BE PRINTED WEEKLY OR MONTHLY (PARM CARD).    * 00130001
001400*                                                               * 00140014
001500*  NOTE: INPUT FOR THIS PGM ONLY CONTAINS TYPE '3' MISDIRECTS.  * 00150014
001600***************************************************************** 00160001
000098*  CHANGED 10/14/14 BY CHERI PARMLEY                            * 00161048
000099*   CHG#0098147 EXPAND PO# FROM 7 TO 8 DIGITS                   * 00162050
001700*                                                               * 00170048
001800***************************************************************** 00180001
001900 ENVIRONMENT DIVISION.                                            00190001
002000***************************************************************** 00200001
002100 CONFIGURATION SECTION.                                           00210001
002200                                                                  00220001
002300 SOURCE-COMPUTER.        IBM-3090.                                00230001
002400 OBJECT-COMPUTER.        IBM-3090.                                00240001
002500                                                                  00250001
002600***************************************************************** 00260001
002700 INPUT-OUTPUT SECTION.                                            00270001
002800                                                                  00280001
002900 FILE-CONTROL.                                                    00290001
003000                                                                  00300001
003100     SELECT INPUT-EXTRACT-FILE                                    00310001
003200         ASSIGN TO INP01.                                         00320001
003300                                                                  00330042
003400     SELECT SUMMARY-CHECKIN-FILE                                  00340042
003500         ASSIGN TO INP02.                                         00350042
003600                                                                  00360001
003700     SELECT OUTPUT-REPORT                                         00370001
003800         ASSIGN TO RPT01.                                         00380001
003900                                                                  00390001
004000***************************************************************** 00400001
004100 DATA DIVISION.                                                   00410001
004200***************************************************************** 00420001
004300 FILE SECTION.                                                    00430001
004400                                                                  00440001
004500 FD  INPUT-EXTRACT-FILE                                           00450001
004600     LABEL RECORDS ARE STANDARD                                   00460001
004700     RECORDING MODE IS F                                          00470001
004800     BLOCK CONTAINS 0 RECORDS                                     00480001
004900     RECORD CONTAINS 200 CHARACTERS.                              00490001
005000 01  EXTRACT-REC                     PIC X(200).                  00500001
005100                                                                  00510001
005200 FD  SUMMARY-CHECKIN-FILE                                         00520042
005300     LABEL RECORDS ARE STANDARD                                   00530042
005400     RECORDING MODE IS F                                          00540042
005500     BLOCK CONTAINS 0 RECORDS                                     00550042
005600     RECORD CONTAINS 200 CHARACTERS.                              00560042
005700 01  SUMMARY-REC                     PIC X(200).                  00570042
005800                                                                  00580042
005900 FD  OUTPUT-REPORT                                                00590001
006000     RECORDING MODE IS F                                          00600001
006100     BLOCK CONTAINS 0  RECORDS.                                   00610001
006200 01  OUTPUT-REC                      PIC X(132).                  00620001
006300                                                                  00630001
006400***************************************************************** 00640001
006500 WORKING-STORAGE SECTION.                                         00650001
006600                                                                  00660001
006700 01  PROGRAM-SWITCHES.                                            00670001
006800     05  PS-NORMAL-RUN-SW            PIC X(01) VALUE 'N'.         00680001
006900         88  PS-NORMAL-RUN                     VALUE 'Y'.         00690001
007000         88  PS-SPECIAL-RUN                    VALUE 'N'.         00700001
007100     05  PS-FIRST-TIME-SW            PIC X(01) VALUE 'N'.         00710001
007200         88  PS-FIRST-TIME-YES                 VALUE 'Y'.         00720001
007300         88  PS-FIRST-TIME-NO                  VALUE 'N'.         00730001
007400     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00740001
007500         88  PS-END-OF-INPUT                   VALUE 'Y'.         00750001
007600         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00760001
007700     05  PS-PAGE-SW                  PIC X(01) VALUE 'N'.         00770001
007800         88  PS-NEW-PAGE                       VALUE 'Y'.         00780001
007900         88  PS-SAME-PAGE                      VALUE 'N'.         00790001
008000     05  PS-TYPE-DATA-SW             PIC X(01) VALUE 'N'.         00800001
008100         88  PS-TYPE-DATA-YES                  VALUE 'Y'.         00810001
008200         88  PS-TYPE-DATA-NO                   VALUE 'N'.         00820001
008300     05  PS-ALL-TYPES-PRINTED-SW     PIC X(01) VALUE 'N'.         00830001
008400         88  PS-ALL-TYPES-PRINTED              VALUE 'Y'.         00840001
008500         88  PS-TYPES-PRINTED-NO               VALUE 'N'.         00850001
008600     05  PS-END-OF-CURSOR-SW         PIC X(01) VALUE 'N'.         00860001
008700         88  PS-END-OF-CURSOR                  VALUE 'Y'.         00870001
008800         88  PS-NOT-END-OF-CURSOR              VALUE 'N'.         00880001
008900     05  PS-END-OF-TABLE-SW          PIC X(01) VALUE 'N'.         00890001
009000         88  PS-END-OF-TABLE                   VALUE 'Y'.         00900001
009100         88  PS-NOT-END-OF-TABLE               VALUE 'N'.         00910001
009200     05  PS-END-SUMMARY-SW            PIC X(01) VALUE 'N'.        00920044
009300         88  PS-END-SUMMARY                     VALUE 'Y'.        00930044
009400         88  PS-NOT-END-OF-SUMMARY              VALUE 'N'.        00940044
009500                                                                  00950001
009600 01  PC-PROGRAM-CONSTANTS.                                        00960001
009700     05  PC-SUKRP022                 PIC X(08) VALUE              00970001
009800                                               'SUKRP022'.        00980001
009900     05  PC-TYPE-CODE-01             PIC X(02) VALUE '01'.        00990006
010000     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        01000001
010100     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          01010001
010200                                               COMP-3.            01020001
010300     05  PC-MISDIRECT-DESC-1.                                     01030001
010400         10  FILLER                  PIC X(50) VALUE              01040001
010500         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    01050001
010600         10  FILLER                  PIC X(42) VALUE              01060001
010700         'AT CORRECT DC BASED ON LOCATION MASTER    '.            01070001
010800     05  PC-MISDIRECT-DESC-2.                                     01080001
010900         10  FILLER                  PIC X(50) VALUE              01090001
011000         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    01100001
011100         10  FILLER                  PIC X(42) VALUE              01110001
011200         'AT WRONG DC BASED ON LOCATION MASTER      '.            01120001
011300     05  PC-MISDIRECT-DESC-3.                                     01130001
011400         10  FILLER                  PIC X(50) VALUE              01140001
011500         'ASN DOWNLOADED TO CORRECT DC -- CARTON WAS RECEIVE'.    01150001
011600         10  FILLER                  PIC X(42) VALUE              01160001
011700         'D AT WRONG DC BASED ON LOCATION MASTER    '.            01170001
011800     05  PC-MISDIRECT-DESC-4.                                     01180008
011900         10  FILLER                  PIC X(50) VALUE              01190001
012000         'DC ON ASN DOWNLOAD DOES NOT MATCH RECEIVING DC    '.    01200001
012100         10  FILLER                  PIC X(42) VALUE              01210001
012200         '                                          '.            01220001
012300     05  PC-MISDIRECT-DESC-5.                                     01230008
012400         10  FILLER                  PIC X(50) VALUE              01240008
012500         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    01250008
012600         10  FILLER                  PIC X(42) VALUE              01260008
012700         'AT WRONG DC BASED ON LOCATION MASTER      '.            01270008
012800     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.01280001
012900     05  PC-SYSTEM-DATE              PIC 9(06) VALUE ZEROES.      01290009
013000     05  PC-ONE                      PIC 9(02) VALUE 1.           01300001
013100     05  PC-SEVEN                    PIC 9(02) VALUE 7.           01310001
013200     05  PC-TWENTY-EIGHT             PIC 9(02) VALUE 28.          01320001
013300     05  PC-SPRING                   PIC X(06) VALUE 'SPRING'.    01330001
013400     05  PC-FALL                     PIC X(06) VALUE '  FALL'.    01340001
013500                                                                  01350001
013600 01  PV-PROGRAM-VARIABLES.                                        01360001
013700     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.      01370009
013800     05  PV-SQLCODE                  PIC 9(09) VALUE ZEROES.      01380009
013900     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01390001
014000                                               COMP-3.            01400001
014100     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01410001
014200                                               COMP-3.            01420001
014300     05  PV-DB2-COUNT                PIC S9(9) VALUE ZERO         01430022
014400                                               COMP-3.            01440022
014500     05  PV-CALC-PCT                 PIC S9(9)V9(8).              01450026
014600     05  PV-REC-IN-QTY               PIC 9(07).                   01460001
014700     05  PV-REC-OUT-QTY              PIC 9(07).                   01470001
014800     05  PV-FIELDS.                                               01480001
014900         10  PV-CURR-SCAC            PIC X(04) VALUE SPACES.      01490001
015000         10  PV-CURR-VEH-NBR         PIC X(11) VALUE SPACES.      01500001
015100         10  PV-CURR-TYPE            PIC X(01) VALUE SPACES.      01510001
015200         10  PV-CURR-LOCN            PIC 9(04) VALUE ZEROES.      01520001
015300         10  PV-CURR-PO-NBR          PIC S9(9) VALUE ZEROES.      01530001
015400         10  PV-CURR-REC-SEQ-NBR     PIC S9(9) VALUE ZEROES.      01540001
015500         10  PV-CURR-VEND-NAME       PIC X(30) VALUE SPACES.      01550004
015600                                                                  01560001
015700     05  PV-ACCUMULATORS.                                         01570001
015800         10  PV-ACCUM-TYPE           PIC 9(09) VALUE ZEROES.      01580004
015900         10  PV-ACCUM-VEH-NBR        PIC 9(09) VALUE ZEROES.      01590004
016000         10  PV-ACCUM-SCAC           PIC 9(09) VALUE ZEROES.      01600004
016100         10  PV-ACCUM-TOTL           PIC 9(09) VALUE ZEROES.      01610004
016200         10  PV-ACCUM-ARRIVALS       PIC 9(09) VALUE ZEROES.      01620026
016300                                                                  01630001
016400     05  PV-FORMAT-QTY               PIC ZZZ,ZZZ,ZZ9.             01640001
016500     05  PV-FORMAT-ACCUM             PIC ZZZ,ZZ9.                 01650026
016600     05  PV-FORMAT-PCT               PIC ZZ,ZZ9.999-.             01660026
016700     05  PV-FORMAT-FACILITY          PIC ZZZZ9.                   01670001
016800                                                                  01680001
016900     05  PV-DB2-START-DATE.                                       01690024
017000         10  PV-DB2-DATE-CCYY-FROM   PIC 9(04) VALUE ZEROES.      01700022
017100         10  FILLER                  PIC X(01) VALUE '-'.         01710001
017200         10  PV-DB2-DATE-MM-FROM     PIC 9(02) VALUE ZEROES.      01720022
017300         10  FILLER                  PIC X(01) VALUE '-'.         01730001
017400         10  PV-DB2-DATE-DD-FROM     PIC 9(02) VALUE ZEROES.      01740022
017500     05  PV-DB2-DATE-FROM REDEFINES PV-DB2-START-DATE             01750024
017600                                     PIC X(10).                   01760024
017700     05  PV-DB2-END-DATE.                                         01770024
017800         10  PV-DB2-DATE-CCYY-TO     PIC 9(04) VALUE ZEROES.      01780022
017900         10  FILLER                  PIC X(01) VALUE '-'.         01790022
018000         10  PV-DB2-DATE-MM-TO       PIC 9(02) VALUE ZEROES.      01800022
018100         10  FILLER                  PIC X(01) VALUE '-'.         01810022
018200         10  PV-DB2-DATE-DD-TO       PIC 9(02) VALUE ZEROES.      01820022
018300     05  PV-DB2-DATE-TO REDEFINES PV-DB2-END-DATE                 01830024
018400                                     PIC X(10).                   01840024
018500                                                                  01850022
018600     05  PV-INPUT-DATE.                                           01860022
018700         10  PV-INPUT-DATE-CC        PIC 9(02) VALUE ZEROES.      01870022
018800         10  PV-INPUT-DATE-YY        PIC 9(02) VALUE ZEROES.      01880022
018900         10  FILLER                  PIC X(01) VALUE '-'.         01890022
019000         10  PV-INPUT-DATE-MM        PIC 9(02) VALUE ZEROES.      01900022
019100         10  FILLER                  PIC X(01) VALUE '-'.         01910022
019200         10  PV-INPUT-DATE-DD        PIC 9(02) VALUE ZEROES.      01920022
019300     05  PV-INPUT-TIME.                                           01930001
019400         10  PV-INPUT-TIME-HH        PIC 9(02) VALUE ZEROES.      01940001
019500         10  FILLER                  PIC X(01) VALUE '.'.         01950001
019600         10  PV-INPUT-TIME-MM        PIC 9(02) VALUE ZEROES.      01960001
019700         10  FILLER                  PIC X(01) VALUE '.'.         01970001
019800         10  PV-INPUT-TIME-SS        PIC 9(02) VALUE ZEROES.      01980001
019900                                                                  01990001
020000     05  PV-YEAR-FORMAT.                                          02000001
020100         10  PV-YEAR-FORMAT-CC       PIC 9(02) VALUE 0.           02010001
020200         10  PV-YEAR-FORMAT-YY       PIC 9(02) VALUE 0.           02020001
020300     05  PV-FORMAT-PO.                                            02030001
      *CLP 10/14/14                                                     02031047
020400         10  PV-FORMAT-PO-NBR        PIC 9(08) VALUE ZEROES.      02040047
020500         10  FILLER                  PIC X(01) VALUE '-'.         02050001
020600         10  PV-FORMAT-REC-SEQ       PIC 9(03) VALUE ZEROES.      02060001
020700     05  PV-FORMAT-DATE.                                          02070001
020800         10  PV-FORMAT-DATE-MM       PIC X(02) VALUE SPACES.      02080001
020900         10  FILLER                  PIC X(01) VALUE '/'.         02090001
021000         10  PV-FORMAT-DATE-DD       PIC X(02) VALUE SPACES.      02100001
021100         10  FILLER                  PIC X(01) VALUE '/'.         02110001
021200         10  PV-FORMAT-DATE-YY       PIC X(02) VALUE SPACES.      02120001
021300     05  PV-FORMAT-TIME.                                          02130001
021400         10  PV-FORMAT-TIME-HH       PIC X(02) VALUE SPACES.      02140001
021500         10  FILLER                  PIC X(01) VALUE ':'.         02150001
021600         10  PV-FORMAT-TIME-MM       PIC X(02) VALUE SPACES.      02160001
021700                                                                  02170001
021800     05  PV-SEASON-DESC              PIC X(06) VALUE SPACES.      02180001
021900     05  PV-CURRENT-DB2-DATE-ONE     PIC X(10).                   02190001
022000     05  PV-CURRENT-DB2-DATE         PIC X(10).                   02200001
022100     05  PV-CURRENT-DB2-DATE-ONEYR   PIC X(10) VALUE SPACES.      02210001
022200     05  FILLER REDEFINES PV-CURRENT-DB2-DATE-ONEYR.              02220001
022300         10  PV-CDD-ONEYR-CCYY       PIC 9(04).                   02230001
022400         10  FILLER                  PIC X(06).                   02240001
022500                                                                  02250001
022600     05  PV-CURR-DATE.                                            02260001
022700         10  PV-CURRENT-DB2-CCYY.                                 02270001
022800             15  PV-CURRENT-DB2-CC   PIC 9(02) VALUE 0.           02280001
022900             15  PV-CURRENT-DB2-YY   PIC 9(02) VALUE 0.           02290001
023000         10  FILLER                  PIC X(01) VALUE '-'.         02300001
023100         10  PV-CURRENT-DB2-MM       PIC 9(02) VALUE 0.           02310001
023200         10  FILLER                  PIC X(01) VALUE '-'.         02320001
023300         10  PV-CURRENT-DB2-DD       PIC 9(02) VALUE 0.           02330001
023400                                                                  02340001
023500     05  PV-CURRENT-DATE.                                         02350001
023600         10  PV-CURRENT-CCYY.                                     02360001
023700             15  PV-CURRENT-CC       PIC 9(02) VALUE 0.           02370001
023800             15  PV-CURRENT-YY       PIC 9(02) VALUE 0.           02380001
023900         10  PV-CURRENT-MM           PIC 9(02) VALUE 0.           02390001
024000         10  PV-CURRENT-DD           PIC 9(02) VALUE 0.           02400001
024100                                                                  02410001
024200     05  PV-CURRENT-YYMMDD-DATE.                                  02420001
024300         10  PV-CURRENT-YYMMDD-YY    PIC 9(02) VALUE 0.           02430001
024400         10  PV-CURRENT-YYMMDD-MM    PIC 9(02) VALUE 0.           02440001
024500         10  PV-CURRENT-YYMMDD-DD    PIC 9(02) VALUE 0.           02450001
024600                                                                  02460001
024700     05  PV-TODAYS-DATE.                                          02470001
024800         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZEROES.      02480009
024900         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZEROES.      02490009
025000         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZEROES.      02500009
025100     05  PV-TODAYS-DATE-YYYY.                                     02510001
025200         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          02520001
025300         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZEROES.      02530009
025400                                                                  02540001
025500     05  PV-TODAYS-TIME.                                          02550001
025600         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZEROES.      02560009
025700         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZEROES.      02570009
025800         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZEROES.      02580009
025900         10  FILLER                  PIC 9(02) VALUE ZEROES.      02590009
026000                                                                  02600001
026100     05  PV-DATE-AREA.                                            02610001
026200         10  PV-DATE-AREA-MM         PIC 9(02) VALUE ZEROES.      02620009
026300         10  FILLER                  PIC X(01) VALUE '/'.         02630001
026400         10  PV-DATE-AREA-DD         PIC 9(02) VALUE ZEROES.      02640009
026500         10  FILLER                  PIC X(01) VALUE '/'.         02650001
026600         10  PV-DATE-AREA-YY         PIC 9(02) VALUE ZEROES.      02660009
026700                                                                  02670001
026800     05  PV-BEG-DATE-CYMD.                                        02680001
026900         10  PV-BEG-YMD-CC           PIC 9(02) VALUE ZEROES.      02690009
027000         10  PV-BEG-YMD-YY           PIC 9(02) VALUE ZEROES.      02700009
027100         10  PV-BEG-YMD-MM           PIC 9(02) VALUE ZEROES.      02710009
027200         10  PV-BEG-YMD-DD           PIC 9(02) VALUE ZEROES.      02720009
027300                                                                  02730001
027400     05  PV-END-DATE-CYMD.                                        02740001
027500         10  PV-END-YMD-CC           PIC 9(02) VALUE ZEROES.      02750009
027600         10  PV-END-YMD-YY           PIC 9(02) VALUE ZEROES.      02760009
027700         10  PV-END-YMD-MM           PIC 9(02) VALUE ZEROES.      02770009
027800         10  PV-END-YMD-DD           PIC 9(02) VALUE ZEROES.      02780009
027900                                                                  02790001
028000     05  PV-BEG-DATE.                                             02800001
028100         10  PV-BEG-MM               PIC 9(02) VALUE ZEROES.      02810009
028200         10  FILLER                  PIC X(01) VALUE '/'.         02820001
028300         10  PV-BEG-DD               PIC 9(02) VALUE ZEROES.      02830009
028400         10  FILLER                  PIC X(01) VALUE '/'.         02840001
028500         10  PV-BEG-YY               PIC 9(02) VALUE ZEROES.      02850009
028600                                                                  02860001
028700     05  PV-END-DATE.                                             02870001
028800         10  PV-END-MM               PIC 9(02) VALUE ZEROES.      02880009
028900         10  FILLER                  PIC X(01) VALUE '/'.         02890001
029000         10  PV-END-DD               PIC 9(02) VALUE ZEROES.      02900009
029100         10  FILLER                  PIC X(01) VALUE '/'.         02910001
029200         10  PV-END-YY               PIC 9(02) VALUE ZEROES.      02920009
029300                                                                  02930001
029400     05  PV-START-EXTRACT            PIC X(26) VALUE SPACES.      02940009
029500     05  FILLER  REDEFINES PV-START-EXTRACT.                      02950001
029600         10  PV-START-EXTRACT-YYYY   PIC 9999.                    02960001
029700         10  PV-START-EXTRACT-1ST    PIC X.                       02970001
029800         10  PV-START-EXTRACT-MM     PIC 99.                      02980001
029900         10  PV-START-EXTRACT-2ND    PIC X.                       02990001
030000         10  PV-START-EXTRACT-DD     PIC 99.                      03000001
030100         10  PV-START-EXTRACT-3RD    PIC X.                       03010001
030200         10  PV-START-TIMESTAMP      PIC X(15).                   03020001
030300                                                                  03030001
030400     05  PV-END-EXTRACT              PIC X(26) VALUE SPACES.      03040009
030500     05  FILLER  REDEFINES PV-END-EXTRACT.                        03050001
030600         10  PV-END-EXTRACT-YYYY     PIC 9999.                    03060001
030700         10  PV-END-EXTRACT-YYYY-RE REDEFINES PV-END-EXTRACT-YYYY.03070001
030800             15  PV-END-EXTRACT-CC   PIC 99.                      03080001
030900             15  PV-END-EXTRACT-YY   PIC 99.                      03090001
031000         10  PV-END-EXTRACT-1ST      PIC X.                       03100001
031100         10  PV-END-EXTRACT-MM       PIC 99.                      03110001
031200         10  PV-END-EXTRACT-2ND      PIC X.                       03120001
031300         10  PV-END-EXTRACT-DD       PIC 99.                      03130001
031400         10  PV-END-EXTRACT-3RD      PIC X.                       03140001
031500         10  PV-END-TIMESTAMP        PIC X(15).                   03150001
031600                                                                  03160001
031700     05  WS-START-EXTRACT.                                        03170001
031800         10  WS-START-EXTRACT-YYYY   PIC 9999.                    03180001
031900         10  WS-START-EXTRACT-MM     PIC 99.                      03190001
032000         10  WS-START-EXTRACT-DD     PIC 99.                      03200001
032100                                                                  03210001
032200     05  WS-END-EXTRACT.                                          03220001
032300         10  WS-END-EXTRACT-YYYY     PIC 9999.                    03230001
032400         10  WS-END-EXTRACT-MM       PIC 99.                      03240001
032500         10  WS-END-EXTRACT-DD       PIC 99.                      03250001
032600                                                                  03260001
032700     05  WS-FISCAL-PERIOD-NBR        PIC 9(02) VALUE ZEROES.      03270001
032800     05  WS-FISCAL-PERIOD-WEEK       PIC 9(02) VALUE ZEROES.      03280001
032900     05  WS-FISCAL-QTR-NBR           PIC 9(01) VALUE ZEROES.      03290009
033000     05  WS-FISCAL-WEEK-NBR          PIC 9(02) VALUE ZEROES.      03300001
033100                                                                  03310001
033200     05  WS-ARRIVE-DATE-WORK.                                     03320001
033300         10  WS-WORK-ARRIVE-MM       PIC 9(02) VALUE ZEROES.      03330001
033400         10  FILLER                  PIC X     VALUE '/'.         03340001
033500         10  WS-WORK-ARRIVE-DD       PIC 9(02) VALUE ZEROES.      03350001
033600         10  FILLER                  PIC X     VALUE '/'.         03360001
033700         10  WS-WORK-ARRIVE-CC       PIC 9(02) VALUE ZEROES.      03370001
033800         10  WS-WORK-ARRIVE-YY       PIC 9(02) VALUE ZEROES.      03380001
033900                                                                  03390001
034000     05  WS-ARRIVE-DATE.                                          03400001
034100         10  WS-ARRIVE-CC            PIC 9(02) VALUE ZEROES.      03410001
034200         10  WS-ARRIVE-YY            PIC 9(02) VALUE ZEROES.      03420001
034300         10  FILLER                  PIC X     VALUE '-'.         03430001
034400         10  WS-ARRIVE-MM            PIC 9(02) VALUE ZEROES.      03440001
034500         10  FILLER                  PIC X     VALUE '-'.         03450001
034600         10  WS-ARRIVE-DD            PIC 9(02) VALUE ZEROES.      03460001
034700                                                                  03470001
034800 01  CC-CONTROL-CARD-PARAMETERS.                                  03480001
034900     05  CC-BEG-DATE.                                             03490001
035000         10  CC-BEG-CC               PIC 9(02) VALUE ZEROES.      03500009
035100         10  CC-BEG-YY               PIC 9(02) VALUE ZEROES.      03510009
035200         10  FILLER                  PIC X(01) VALUE SPACES.      03520009
035300         10  CC-BEG-MM               PIC 9(02) VALUE ZEROES.      03530009
035400         10  FILLER                  PIC X(01) VALUE SPACES.      03540009
035500         10  CC-BEG-DD               PIC 9(02) VALUE ZEROES.      03550009
035600     05  FILLER                      PIC X(01) VALUE SPACES.      03560009
035700     05  CC-END-DATE.                                             03570001
035800         10  CC-END-CC               PIC 9(02) VALUE ZEROES.      03580009
035900         10  CC-END-YY               PIC 9(02) VALUE ZEROES.      03590009
036000         10  FILLER                  PIC X(01) VALUE SPACES.      03600009
036100         10  CC-END-MM               PIC 9(02) VALUE ZEROES.      03610009
036200         10  FILLER                  PIC X(01) VALUE SPACES.      03620009
036300         10  CC-END-DD               PIC 9(02) VALUE ZEROES.      03630009
036400     05  FILLER                      PIC X(01) VALUE SPACES.      03640009
036500     05  CC-MODE-IND                 PIC X(01) VALUE SPACES.      03650009
036600         88  CC-VALID-MODE-IND                 VALUE 'W', 'M',    03660001
036700                                                'F', 'C', 'S'.    03670001
036800         88  CC-WEEKLY-EXTRACT                 VALUE 'W'.         03680001
036900         88  CC-MONTHLY-EXTRACT                VALUE 'M'.         03690001
037000         88  CC-FISCAL-EXTRACT                 VALUE 'F'.         03700001
037100         88  CC-CALENDAR-EXTRACT               VALUE 'C'.         03710001
037200         88  CC-SEASONAL-EXTRACT               VALUE 'S'.         03720001
037300     05  FILLER                      PIC X(57) VALUE SPACES.      03730009
037400                                                                  03740001
037500 01  PV-DATETIME-WORK.                                            03750001
037600     05  PV-DATETIME-CC              PIC 9(02).                   03760001
037700     05  PV-DATETIME-YY              PIC 9(02).                   03770001
037800     05  FILLER                      PIC X(01) VALUE '-'.         03780001
037900     05  PV-DATETIME-MM              PIC 9(02).                   03790001
038000     05  FILLER                      PIC X(01) VALUE '-'.         03800001
038100     05  PV-DATETIME-DD              PIC 9(02).                   03810001
038200     05  FILLER                      PIC X(01) VALUE '-'.         03820001
038300     05  PV-DATETIME-HO              PIC 9(02).                   03830001
038400     05  FILLER                      PIC X(01) VALUE '.'.         03840001
038500     05  PV-DATETIME-MI              PIC 9(02).                   03850001
038600     05  FILLER                      PIC X(01) VALUE '.'.         03860001
038700     05  PV-DATETIME-SS              PIC 9(02).                   03870001
038800     05  FILLER                      PIC X(01) VALUE '.'.         03880001
038900     05  PV-DATETIME-MSEC            PIC 9(06).                   03890001
039000                                                                  03900001
039100 01  PV-DATE-RECORD.                                              03910001
039200     05  PV-DATE-START-MM            PIC X(02) VALUE SPACES.      03920009
039300     05  FILLER                      PIC X(01) VALUE '/'.         03930001
039400     05  PV-DATE-START-DD            PIC X(02) VALUE SPACES.      03940009
039500     05  FILLER                      PIC X(01) VALUE '/'.         03950001
039600     05  PV-DATE-START-CCYY          PIC X(04) VALUE SPACES.      03960009
039700     05  FILLER                      PIC X(01) VALUE SPACES.      03970009
039800     05  PV-DATE-END-MM              PIC X(02) VALUE SPACES.      03980009
039900     05  FILLER                      PIC X(01) VALUE '/'.         03990001
040000     05  PV-DATE-END-DD              PIC X(02) VALUE SPACES.      04000009
040100     05  FILLER                      PIC X(01) VALUE '/'.         04010001
040200     05  PV-DATE-END-CCYY            PIC X(04) VALUE SPACES.      04020009
040300     05  FILLER                      PIC X(01) VALUE SPACES.      04030009
040400     05  PV-DATE-FISCAL-PERIOD       PIC 9(02) VALUE ZEROES.      04040001
040500     05  FILLER                      PIC X(01) VALUE SPACES.      04050009
040600     05  PV-DATE-FISCAL-QUARTER      PIC 9(01) VALUE ZEROES.      04060009
040700     05  FILLER                      PIC X(01) VALUE SPACES.      04070009
040800     05  PV-DATE-SEASON              PIC X(06) VALUE SPACES.      04080001
040900     05  FILLER                      PIC X(47) VALUE SPACES.      04090001
041000                                                                  04100001
041100 01  PV-ABEND-FIELDS.                                             04110001
041200     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           04120001
041300                                                     COMP SYNC.   04130009
041400     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP022'.  04140001
041500     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      04150001
041600     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      04160001
041700     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      04170001
041800     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      04180001
041900     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      04190001
042000     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      04200001
042100     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      04210001
042200     05  PV-DB2-TABLE-NAME           PIC X(08) VALUE SPACES.      04220001
042300                                                                  04230001
042400 01  CARRIER-SUMMARY-TABLE.                                       04240015
042500     05  SUMMARY-TABLE  OCCURS 300 TIMES INDEXED BY CS-IDX.       04250015
042600         10  SUMMARY-CARRIER-4       PIC  X(04).                  04260015
042700         10  SUMMARY-CARRIER-NAME    PIC  X(30).                  04270015
042800         10  SUMMARY-TYPE-3          PIC  9(09).                  04280019
042900         10  SUMMARY-ARRIVALS        PIC  9(09).                  04290022
043000                                                                  04300015
043100******************************************************************04310001
043200*  COPYBOOK USED BY CALENDAR ROUTINE                              04320001
043300******************************************************************04330001
043400     COPY DPWS500.                                                04340001
043500                                                                  04350001
043600******************************************************************04360001
043700*  RECORD LAYOUT FOR INPUT FILE                                   04370001
043800******************************************************************04380001
043900     COPY SURD008.                                                04390001
044000                                                                  04400001
044100******************************************************************04410001
044200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               04420001
044300******************************************************************04430001
044400     COPY DPWS132.                                                04440001
044500                                                                  04450001
044600 01  WS-BATCH-PROC-DATE.                                          04460001
044700     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      04470001
044800     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      04480001
044900     05  FILLER                      PIC X(01) VALUE SPACES.      04490001
045000     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      04500001
045100     05  FILLER                      PIC X(01) VALUE SPACES.      04510001
045200     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      04520001
045300*                                                                 04530001
045400 01  HEADING-LINES.                                               04540001
045500     05  HEADING-LINE-1.                                          04550001
045600         10  FILLER                  PIC X(33) VALUE SPACES.      04560001
045700         10  FILLER                  PIC X(49) VALUE              04570001
045800             'INTRA-COMPANY MISDIRECTS FROM UCC128 SCAN RESULTS'. 04580001
045900         10  FILLER                  PIC X(17) VALUE              04590001
046000                                         ' BY SCAC, TRAILER'.     04600001
046100         10  FILLER                  PIC X(33) VALUE SPACES.      04610001
046200                                                                  04620001
046300     05  HEADING-LINE-2.                                          04630001
046400         10  FILLER                  PIC X(43) VALUE SPACES.      04640001
046500         10  FILLER                  PIC X(15) VALUE              04650001
046600                                               'TIME PERIOD OF '. 04660001
046700         10  HL2-FROM-DATE-MM        PIC X(02) VALUE SPACES.      04670001
046800         10  FILLER                  PIC X(01) VALUE '-'.         04680001
046900         10  HL2-FROM-DATE-DD        PIC X(02) VALUE SPACES.      04690001
047000         10  FILLER                  PIC X(01) VALUE '-'.         04700001
047100         10  HL2-FROM-DATE-YYYY      PIC X(04) VALUE SPACES.      04710001
047200         10  FILLER                  PIC X(06) VALUE ' THRU '.    04720001
047300         10  HL2-TO-DATE-MM          PIC X(02) VALUE SPACES.      04730001
047400         10  FILLER                  PIC X(01) VALUE '-'.         04740001
047500         10  HL2-TO-DATE-DD          PIC X(02) VALUE SPACES.      04750001
047600         10  FILLER                  PIC X(01) VALUE '-'.         04760001
047700         10  HL2-TO-DATE-YYYY        PIC X(04) VALUE SPACES.      04770001
047800         10  FILLER                  PIC X(48) VALUE SPACES.      04780001
047900                                                                  04790001
048000     05  HEADING-LINE-3.                                          04800001
048100         10  FILLER                  PIC X(01) VALUE SPACES.      04810001
048200         10  FILLER                  PIC X(07) VALUE              04820001
048300                                               'SCAC : '.         04830001
048400         10  HL3-SCAC                PIC X(04) VALUE SPACES.      04840001
048500         10  FILLER                  PIC X(02) VALUE SPACES.      04850001
048600         10  HL3-SCAC-DESC           PIC X(30) VALUE SPACES.      04860001
048700         10  FILLER                  PIC X(88) VALUE SPACES.      04870001
048800                                                                  04880001
048900     05  HEADING-LINE-3-CS.                                       04890015
049000         10  FILLER                  PIC X(01) VALUE SPACES.      04900015
049100         10  FILLER                  PIC X(07) VALUE              04910015
049200                                               'SCAC : '.         04920015
049300         10  FILLER                  PIC X(20) VALUE              04930015
049400                                     'CARRIER SUMMARY     '.      04940015
049500         10  FILLER                  PIC X(104) VALUE SPACES.     04950015
049600                                                                  04960015
049700     05  HEADING-LINE-4.                                          04970001
049800         10  FILLER                  PIC X(01) VALUE SPACES.      04980001
049900         10  FILLER                  PIC X(10) VALUE              04990001
050000                                               'TRAILER : '.      05000001
050100         10  HL4-TRAILER             PIC X(11) VALUE SPACES.      05010001
050200         10  FILLER                  PIC X(110) VALUE SPACES.     05020001
050300                                                                  05030001
050400     05  HEADING-LINE-4A-CS.                                      05040033
050500         10  FILLER                  PIC X(07) VALUE SPACES.      05050015
050600         10  FILLER                  PIC X(11) VALUE SPACES.      05060019
050700         10  FILLER                  PIC X(29) VALUE SPACES.      05070020
050800         10  FILLER                  PIC X(11) VALUE              05080015
050900                                         ' NUMBER OF '.           05090033
051000         10  FILLER                  PIC X(03) VALUE SPACES.      05100033
051100         10  FILLER                  PIC X(11) VALUE              05110015
051200                                         ' NUMBER OF '.           05120033
051300         10  FILLER                  PIC X(04) VALUE SPACES.      05130033
051400         10  FILLER                  PIC X(11) VALUE              05140015
051500                                         ' PERCENTAGE'.           05150033
051600         10  FILLER                  PIC X(21) VALUE SPACES.      05160021
051700         10  FILLER                  PIC X(24) VALUE SPACES.      05170033
051800                                                                  05180015
051900     05  HEADING-LINE-4B-CS.                                      05190033
052000         10  FILLER                  PIC X(07) VALUE SPACES.      05200033
052100         10  FILLER                  PIC X(11) VALUE SPACES.      05210033
052200         10  FILLER                  PIC X(29) VALUE SPACES.      05220033
052300         10  FILLER                  PIC X(11) VALUE              05230033
052400                                         '   CARTONS '.           05240035
052500         10  FILLER                  PIC X(03) VALUE SPACES.      05250033
052600         10  FILLER                  PIC X(11) VALUE              05260033
052700                                         '    CARTON '.           05270033
052800         10  FILLER                  PIC X(04) VALUE SPACES.      05280033
052900         10  FILLER                  PIC X(11) VALUE              05290033
053000                                         '     OF    '.           05300033
053100         10  FILLER                  PIC X(21) VALUE SPACES.      05310033
053200         10  FILLER                  PIC X(24) VALUE SPACES.      05320033
053300                                                                  05330033
053400     05  HEADING-LINE-5.                                          05340001
053500         10  FILLER                  PIC X(01) VALUE SPACES.      05350001
053600         10  FILLER                  PIC X(16) VALUE              05360001
053700                                     'MISDIRECT TYPE #'.          05370001
053800         10  HL5-MISDIRECT-TYPE      PIC X(01) VALUE SPACES.      05380001
053900         10  FILLER                  PIC X(02) VALUE ': '.        05390001
054000         10  HL5-MISDIRECT-DESC      PIC X(92) VALUE SPACES.      05400001
054100         10  FILLER                  PIC X(20) VALUE SPACES.      05410001
054200                                                                  05420001
054300     05  HEADING-LINE-5-CS.                                       05430015
054400         10  FILLER                  PIC X(07) VALUE SPACES.      05440015
054500         10  FILLER                  PIC X(17) VALUE              05450018
054600                                         'CARRIER ABBR/NAME'.     05460033
054700         10  FILLER                  PIC X(24) VALUE SPACES.      05470033
054800         10  FILLER                  PIC X(10) VALUE              05480033
054900                                         '  SCANNED '.            05490035
055000         10  FILLER                  PIC X(02) VALUE SPACES.      05500033
055100         10  FILLER                  PIC X(12) VALUE              05510033
055200                                         ' MISDIRECTS '.          05520033
055300         10  FILLER                  PIC X(04) VALUE SPACES.      05530033
055400         10  FILLER                  PIC X(12) VALUE              05540033
055500                                         ' MISDIRECTS '.          05550033
055600         10  FILLER                  PIC X(21) VALUE SPACES.      05560021
055700         10  FILLER                  PIC X(23) VALUE SPACES.      05570033
055800                                                                  05580015
055900     05  HEADING-LINE-6.                                          05590001
056000         10  FILLER                  PIC X(01) VALUE SPACES.      05600001
056100         10  FILLER                  PIC X(39) VALUE SPACES.      05610034
056200         10  FILLER                  PIC X(04) VALUE 'STR '.      05620034
056300         10  FILLER                  PIC X(70) VALUE SPACES.      05630034
056400         10  FILLER                  PIC X(17) VALUE              05640001
056500                                     '-ASN INFORMATION-'.         05650001
056600         10  FILLER                  PIC X(01) VALUE SPACES.      05660034
056700                                                                  05670001
056800     05  HEADING-LINE-7.                                          05680001
056900         10  FILLER                  PIC X(01) VALUE SPACES.      05690001
057000         10  FILLER                  PIC X(04) VALUE 'RCVG'.      05700002
      *CLP 10/14/14                                                     05701049
057100         10  FILLER                  PIC X(29) VALUE SPACES.      05710049
057200         10  FILLER                  PIC X(04) VALUE 'DEST'.      05720001
057300         10  FILLER                  PIC X(01) VALUE SPACES.      05730001
057400         10  FILLER                  PIC X(04) VALUE 'PRCS'.      05740034
057500         10  FILLER                  PIC X(01) VALUE SPACES.      05750034
057600         10  FILLER                  PIC X(20) VALUE SPACES.      05760001
057700         10  FILLER                  PIC X(01) VALUE SPACES.      05770001
057800         10  FILLER                  PIC X(05) VALUE 'SCAN '.     05780001
057900         10  FILLER                  PIC X(01) VALUE SPACES.      05790001
058000         10  FILLER                  PIC X(05) VALUE 'SCAN '.     05800001
058100         10  FILLER                  PIC X(01) VALUE SPACES.      05810001
      *CLP 10/14/14                                                     05811049
058200         10  FILLER                  PIC X(07) VALUE ' SCAN  '.   05820049
058300         10  FILLER                  PIC X(01) VALUE SPACES.      05830001
058400         10  FILLER                  PIC X(27) VALUE SPACES.      05840034
058500         10  FILLER                  PIC X(01) VALUE SPACES.      05850001
058600         10  FILLER                  PIC X(11) VALUE              05860001
058700                                     '-DOWNLOAD- '.               05870001
058800         10  FILLER                  PIC X(01) VALUE SPACES.      05880001
058900         10  FILLER                  PIC X(04) VALUE 'RCVG'.      05890001
059000         10  FILLER                  PIC X(01) VALUE SPACES.      05900034
059100                                                                  05910001
059200     05  HEADING-LINE-8.                                          05920001
059300         10  FILLER                  PIC X(01) VALUE SPACES.      05930001
059400         10  FILLER                  PIC X(04) VALUE 'LOC '.      05940001
059500         10  FILLER                  PIC X(01) VALUE SPACES.      05950001
      *CLP 10/14/14                                                     05951047
059600         10  FILLER                  PIC X(12) VALUE              05960047
059700                                     'PO/RECEIVER '.              05970047
059800         10  FILLER                  PIC X(01) VALUE SPACES.      05980001
059900         10  FILLER                  PIC X(16) VALUE              05990002
060000                                     'VENDOR NAME     '.          06000001
060100         10  FILLER                  PIC X(01) VALUE SPACES.      06010001
060200         10  FILLER                  PIC X(04) VALUE 'STR '.      06020001
060300         10  FILLER                  PIC X(01) VALUE SPACES.      06030002
060400         10  FILLER                  PIC X(04) VALUE 'DC  '.      06040034
060500         10  FILLER                  PIC X(01) VALUE SPACES.      06050034
060600         10  FILLER                  PIC X(20) VALUE              06060002
060700                                     'SERIAL SHIP CODE    '.      06070001
060800         10  FILLER                  PIC X(01) VALUE SPACES.      06080001
060900         10  FILLER                  PIC X(05) VALUE 'DATE '.     06090001
061000         10  FILLER                  PIC X(01) VALUE SPACES.      06100001
061100         10  FILLER                  PIC X(05) VALUE 'TIME '.     06110001
061200         10  FILLER                  PIC X(01) VALUE SPACES.      06120001
      *CLP 10/14/14                                                     06121047
061300         10  FILLER                  PIC X(07) VALUE 'USER ID'.   06130047
061400         10  FILLER                  PIC X(01) VALUE SPACES.      06140002
061500         10  FILLER                  PIC X(27) VALUE              06150034
061600             'ASN NUMBER                 '.                       06160034
061700         10  FILLER                  PIC X(01) VALUE SPACES.      06170001
061800         10  FILLER                  PIC X(05) VALUE 'DATE '.     06180001
061900         10  FILLER                  PIC X(01) VALUE SPACES.      06190001
062000         10  FILLER                  PIC X(05) VALUE 'TIME '.     06200001
062100         10  FILLER                  PIC X(01) VALUE SPACES.      06210001
062200         10  FILLER                  PIC X(04) VALUE 'OPER'.      06220001
062300         10  FILLER                  PIC X(01) VALUE SPACES.      06230034
062400                                                                  06240001
062500 01  DETAIL-LINES.                                                06250001
062600     05  DETAIL-LINE-1.                                           06260001
062700         10  FILLER                  PIC X(01) VALUE SPACES.      06270001
062800         10  DL1-RCVG-LOC            PIC X(04) VALUE ZEROES.      06280001
062900         10  FILLER                  PIC X(01) VALUE SPACES.      06290001
      *CLP 10/14/14                                                     06291047
063000         10  DL1-PO-RCVR             PIC X(12) VALUE SPACES.      06300047
063100         10  FILLER                  PIC X(01) VALUE SPACES.      06310001
063200         10  DL1-VEND-NAME           PIC X(16) VALUE SPACES.      06320001
063300         10  FILLER                  PIC X(01) VALUE SPACES.      06330001
063400         10  DL1-DEST-STR            PIC 9(04) VALUE ZEROES.      06340001
063500         10  FILLER                  PIC X(01) VALUE SPACES.      06350001
063600         10  DL1-PROCESS-DC          PIC 9(04) VALUE ZEROES.      06360034
063700         10  FILLER                  PIC X(01) VALUE SPACES.      06370034
063800         10  DL1-SERIAL-SHIP-CODE    PIC 9(18) VALUE ZEROES.      06380001
063900         10  FILLER                  PIC X(03) VALUE SPACES.      06390001
064000         10  DL1-SCAN-DATE           PIC X(05) VALUE SPACES.      06400001
064100         10  FILLER                  PIC X(01) VALUE SPACES.      06410001
064200         10  DL1-SCAN-TIME           PIC X(05) VALUE SPACES.      06420001
064300         10  FILLER                  PIC X(01) VALUE SPACES.      06430001
      *CLP 10/14/14                                                     06431047
064400         10  DL1-SCAN-USERID         PIC X(07) VALUE SPACES.      06440047
064500         10  FILLER                  PIC X(01) VALUE SPACES.      06450001
064600         10  DL1-ASN-NUMBER          PIC X(27) VALUE SPACES.      06460034
064700         10  FILLER                  PIC X(01) VALUE SPACES.      06470001
064800         10  DL1-ASN-DATE            PIC X(05) VALUE SPACES.      06480001
064900         10  FILLER                  PIC X(01) VALUE SPACES.      06490001
065000         10  DL1-ASN-TIME            PIC X(05) VALUE SPACES.      06500001
065100         10  FILLER                  PIC X(01) VALUE SPACES.      06510001
065200         10  DL1-RCVG-OPER           PIC 9(04) VALUE ZEROES.      06520001
065300         10  FILLER                  PIC X(01) VALUE SPACES.      06530034
065400                                                                  06540001
065500     05  DETAIL-LINE-1-CS.                                        06550015
065600         10  FILLER                  PIC X(07) VALUE SPACES.      06560015
065700         10  CS-CARRIER-ABBR         PIC X(04) VALUE SPACES.      06570016
065800         10  FILLER                  PIC X(02) VALUE SPACES.      06580018
065900         10  CS-CARRIER-NAME         PIC X(30) VALUE SPACES.      06590019
066000         10  FILLER                  PIC X(03) VALUE SPACES.      06600019
066100         10  CS-LOCN-ALL             PIC X(11) VALUE SPACES.      06610019
066200         10  FILLER                  PIC X(03) VALUE SPACES.      06620019
066300         10  CS-LOCN-TYPE-3          PIC X(11) VALUE SPACES.      06630019
066400         10  FILLER                  PIC X(04) VALUE SPACES.      06640027
066500         10  CS-LOCN-TOTAL           PIC X(11) VALUE SPACES.      06650015
066600         10  FILLER                  PIC X(01) VALUE '%'.         06660026
066700         10  FILLER                  PIC X(35) VALUE SPACES.      06670033
066800                                                                  06680015
066900 01  TOTAL-LINES.                                                 06690001
067000     05  TOTAL-LINE-1.                                            06700001
067100         10  FILLER                  PIC X(01) VALUE SPACES.      06710001
067200         10  FILLER                  PIC X(26) VALUE              06720001
067300             'TOTAL FOR MISDIRECT TYPE #'.                        06730001
067400         10  TL1-MISDIRECT-TYPE      PIC X(01) VALUE SPACES.      06740001
067500         10  FILLER                  PIC X(02) VALUE ': '.        06750001
067600         10  TL1-TOTAL-TYPE          PIC X(07).                   06760001
067700         10  FILLER                  PIC X(95) VALUE SPACES.      06770001
067800                                                                  06780001
067900     05  TOTAL-LINE-1-CS.                                         06790015
068000         10  FILLER                  PIC X(22) VALUE SPACES.      06800015
068100         10  FILLER                  PIC X(17) VALUE              06810015
068200                                     'CARRIER TOTALS:  '.         06820015
068300         10  FILLER                  PIC X(07) VALUE SPACES.      06830020
068400         10  CS-TOTL-TYPE-ALL        PIC ZZZ,ZZZ,ZZ9.             06840020
068500         10  FILLER                  PIC X(03) VALUE SPACES.      06850020
068600         10  CS-TOTL-TYPE-3          PIC ZZZ,ZZZ,ZZ9.             06860020
068700         10  FILLER                  PIC X(04) VALUE SPACES.      06870027
068800         10  CS-TOTL-PERCENT         PIC X(11).                   06880027
068900         10  FILLER                  PIC X(01) VALUE '%'.         06890027
069000         10  FILLER                  PIC X(45) VALUE SPACES.      06900027
069100                                                                  06910015
069200     05  TOTAL-LINE-2.                                            06920001
069300         10  FILLER                  PIC X(01) VALUE SPACES.      06930001
069400         10  FILLER                  PIC X(29) VALUE              06940001
069500             'TOTAL MISDIRECTS FOR TRAILER:'.                     06950004
069600         10  TL2-TOTAL-VEH-NBR       PIC X(07).                   06960004
069700         10  FILLER                  PIC X(95) VALUE SPACES.      06970001
069800                                                                  06980001
069900     05  TOTAL-LINE-3.                                            06990004
070000         10  FILLER                  PIC X(01) VALUE SPACES.      07000004
070100         10  FILLER                  PIC X(29) VALUE              07010004
070200             'TOTAL MISDIRECTS FOR CARRIER:'.                     07020004
070300         10  TL3-TOTAL-SCAC          PIC X(07).                   07030004
070400         10  FILLER                  PIC X(95) VALUE SPACES.      07040004
070500                                                                  07050004
070600 01  MISCELLANEOUS-LINES.                                         07060001
070700     05  BLANK-LINE.                                              07070001
070800         10  FILLER                  PIC X(132) VALUE SPACES.     07080001
070900                                                                  07090001
071000     05  END-OF-REPORT-LINE.                                      07100001
071100         10  FILLER                  PIC X(44) VALUE SPACES.      07110001
071200         10  FILLER                  PIC X(45) VALUE              07120001
071300             '*******   E N D   O F   R E P O R T   *******'.     07130001
071400         10  FILLER                  PIC X(43) VALUE SPACES.      07140001
071500                                                                  07150001
071600     05  NO-MISDIRECT-DATA-LINE.                                  07160001
071700         10  FILLER                  PIC X(01) VALUE SPACES.      07170001
071800         10  FILLER                  PIC X(23) VALUE              07180001
071900                                     '** NO DATA TO REPORT **'.   07190001
072000         10  FILLER                  PIC X(108) VALUE SPACES.     07200001
072100                                                                  07210001
072200     05  NO-DATA-TO-REPORT-LINE.                                  07220001
072300         10  FILLER                  PIC X(40) VALUE SPACES.      07230001
072400         10  FILLER                  PIC X(52) VALUE              07240009
072500         '*******  N O   D A T A   T O   R E P O R T   *******'.  07250001
072600         10  FILLER                  PIC X(40) VALUE SPACES.      07260009
072700                                                                  07270001
072800******************************************************************07280001
072900*  USED FOR DB2 ERROR MESSAGE BUILDING                            07290001
073000******************************************************************07300001
073100     COPY DPWS004.                                                07310047
073200                                                                  07320001
073300******************************************************************07330001
073400*   DB2 SQL COMMUNICATION AREA                                    07340001
073500******************************************************************07350001
073600     EXEC SQL                                                     07360001
073700          INCLUDE SQLCA                                           07370001
073800     END-EXEC.                                                    07380001
073900                                                                  07390001
074000******************************************************************07400001
074100*  DCLGEN FOR THE COMPANY CONTROL TABLE                           07410001
074200******************************************************************07420001
074300     EXEC SQL                                                     07430001
074400         INCLUDE TCOCNTL                                          07440001
074500     END-EXEC.                                                    07450001
074600                                                                  07460001
074700******************************************************************07470004
074800*  DCLGEN FOR THE ENTITY ID TABLE                                 07480004
074900******************************************************************07490004
075000     EXEC SQL                                                     07500004
075100         INCLUDE TEXTENT                                          07510004
075200     END-EXEC.                                                    07520004
075300                                                                  07530004
075400******************************************************************07540004
075500*  DCLGEN FOR THE ENTITY NAME TABLE                               07550004
075600******************************************************************07560004
075700     EXEC SQL                                                     07570004
075800         INCLUDE TENTNME                                          07580004
075900     END-EXEC.                                                    07590004
076000                                                                  07600004
076100******************************************************************07610025
076200*  DCLGEN FOR THE VEHICLE TRIP TABLE                              07620025
076300******************************************************************07630025
076400     EXEC SQL                                                     07640025
076500         INCLUDE TVHTRIP                                          07650025
076600     END-EXEC.                                                    07660025
076700                                                                  07670025
076800******************************************************************07680025
076900*  DCLGEN FOR THE TRIP STATUS TABLE                               07690025
077000******************************************************************07700025
077100     EXEC SQL                                                     07710025
077200         INCLUDE TTRIPST                                          07720025
077300     END-EXEC.                                                    07730025
077400                                                                  07740025
077500******************************************************************07750033
077600*  DCLGEN FOR THE SHIPMENT UNLOAD TABLE                           07760033
077700******************************************************************07770033
077800     EXEC SQL                                                     07780033
077900         INCLUDE TSHUNLO                                          07790033
078000     END-EXEC.                                                    07800033
078100                                                                  07810033
078200******************************************************************07820001
078300******************************************************************07830001
078400 PROCEDURE DIVISION.                                              07840001
078500     DISPLAY '**** START OF SUKRP022 ****'.                       07850001
078600                                                                  07860001
078700*OPEN FILES.                                                      07870001
078800     OPEN INPUT  INPUT-EXTRACT-FILE                               07880001
078900          INPUT  SUMMARY-CHECKIN-FILE                             07890045
079000          OUTPUT OUTPUT-REPORT.                                   07900001
079100                                                                  07910001
079200*READ FIRST INPUT RECORD.                                         07920001
079300     SET PS-NOT-END-OF-INPUT TO TRUE.                             07930001
079400     SET PS-TYPE-DATA-NO     TO TRUE.                             07940001
079500     MOVE 0 TO PV-REC-IN-QTY.                                     07950001
079600     PERFORM 0100-READ-EXTRACT.                                   07960001
079700                                                                  07970001
079800*SET/PRINT REPORT HEADINGS.                                       07980001
079900     IF NOT PS-END-OF-INPUT                                       07990001
080000         MOVE SU008-SCAC-CDE        TO PV-CURR-SCAC               08000002
080100         MOVE SU008-VEH-NBR         TO PV-CURR-VEH-NBR            08010003
080200         MOVE SU008-MISDIRECT-TYPE  TO PV-CURR-TYPE               08020011
080300         MOVE 1                     TO PV-REC-IN-QTY              08030001
080400     END-IF.                                                      08040001
080500                                                                  08050004
080600     DISPLAY '  ** 1000-INITIALIZATION **'.                       08060001
080700     PERFORM 1000-INITIALIZATION.                                 08070001
080800     DISPLAY '  ** 1000-INITIALIZATION DONE **'.                  08080001
080900                                                                  08090001
081000*PROCESS INPUT FILE.                                              08100001
081100     IF PS-END-OF-INPUT                                           08110001
081200         PERFORM 1300-NO-DETAIL-LINE                              08120001
081300     ELSE                                                         08130001
081400         PERFORM 2000-PROCESS-EXTRACT                             08140001
081500           UNTIL PS-END-OF-INPUT                                  08150001
081600         PERFORM 0200-PRINT-LAST-TOTALS                           08160001
081700     END-IF.                                                      08170001
081800                                                                  08180001
081900     DISPLAY '**** RECORDS READ    ==> ' PV-REC-IN-QTY.           08190001
082000     DISPLAY '**** RECORDS WRITTEN ==> ' PV-REC-OUT-QTY.          08200001
082100                                                                  08210001
082200*WRITE VENDOR SUMMARY.                                            08220017
082300     PERFORM 3000-PRINT-SUMMARY.                                  08230017
082400                                                                  08240017
082500*WRITE END-OF-REPORT LINE.                                        08250001
082600     PERFORM 1400-END-OF-RPT-LINE.                                08260001
082700                                                                  08270001
082800*CLOSE FILES.                                                     08280001
082900     CLOSE INPUT-EXTRACT-FILE                                     08290001
083000           SUMMARY-CHECKIN-FILE                                   08300045
083100           OUTPUT-REPORT.                                         08310001
083200                                                                  08320001
083300     GOBACK.                                                      08330001
083400                                                                  08340001
083500******************************************************************08350001
083600*  READ NEXT INPUT FILE RECORD.                                  *08360001
083700******************************************************************08370001
083800 0100-READ-EXTRACT.                                               08380001
083900                                                                  08390001
084000     READ INPUT-EXTRACT-FILE INTO SU008-EXTRACT-RECORD            08400001
084100       AT END                                                     08410001
084200           SET PS-END-OF-INPUT TO TRUE.                           08420001
084300                                                                  08430001
084400******************************************************************08440001
084500*  PRINT REMAINING TOTAL LINES AFTER LAST RECORD READ.           *08450001
084600******************************************************************08460001
084700 0200-PRINT-LAST-TOTALS.                                          08470001
084800                                                                  08480001
084900*WRITE LAST TOTALS.                                               08490001
085000     PERFORM 2010-TYPE-BREAK.                                     08500001
085100     PERFORM 2020-TRLR-BREAK.                                     08510004
085200     PERFORM 2030-SCAC-BREAK.                                     08520004
085300                                                                  08530002
085400******************************************************************08540043
085500*  READ NEXT CHECKIN FILE RECORD.                              *  08550043
085600******************************************************************08560043
085700 0300-READ-CHECKIN.                                               08570043
085800                                                                  08580043
085900     READ SUMMARY-CHECKIN-FILE INTO SU008-EXTRACT-RECORD          08590044
086000       AT END                                                     08600043
086100           SET PS-END-SUMMARY TO TRUE.                            08610044
086200                                                                  08620043
086300******************************************************************08630001
086400*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *08640001
086500******************************************************************08650001
086600 1000-INITIALIZATION.                                             08660001
086700                                                                  08670001
086800     PERFORM 1010-INITIALIZE-SUMMARY-TABLE.                       08680015
086900                                                                  08690015
087000     ACCEPT PV-TODAYS-DATE FROM DATE.                             08700001
087100     ACCEPT PV-TODAYS-TIME FROM TIME.                             08710001
087200                                                                  08720001
087300     MOVE PV-TODAYS-DATE-MM    TO DP132-RUN-MONTH.                08730001
087400     MOVE PV-TODAYS-DATE-DD    TO DP132-RUN-DAY.                  08740001
087500     MOVE PV-TODAYS-DATE-YY    TO PV-TODAYS-DATE-Y2.              08750001
087600     MOVE PV-TODAYS-DATE-YYYY  TO DP132-RUN-YEAR.                 08760001
087700                                                                  08770001
087800     MOVE PV-TODAYS-TIME-HH    TO DP132-RUN-HOUR.                 08780001
087900     MOVE PV-TODAYS-TIME-MM    TO DP132-RUN-MINUTE.               08790001
088000                                                                  08800001
088100     MOVE PC-SUKRP022          TO DP132-PROGRAM-NAME.             08810001
088200     MOVE PC-REPORT-NBR        TO DP132-REPORT-NUMBER.            08820001
088300                                                                  08830001
088400     SET PS-FIRST-TIME-YES     TO TRUE.                           08840001
088500                                                                  08850001
088600     MOVE +0                   TO PV-REC-OUT-QTY.                 08860001
088700                                                                  08870001
088800     MOVE +0                   TO PV-PAGE-COUNT                   08880001
088900                                  PV-ACCUM-VEH-NBR                08890004
089000                                  PV-ACCUM-SCAC.                  08900004
089100                                                                  08910001
089200     MOVE ZEROES               TO PV-ACCUM-TOTL                   08920026
089300                                  PV-ACCUM-ARRIVALS.              08930026
089400                                                                  08940001
089500     PERFORM 1100-PROCESS-DATECARD.                               08950001
089600                                                                  08960001
089700     PERFORM 1200-PRINT-HEADINGS.                                 08970001
089800                                                                  08980001
089900******************************************************************08990015
090000*   INITIALIZE SUMMARY TABLE.                                    *09000015
090100******************************************************************09010015
090200 1010-INITIALIZE-SUMMARY-TABLE.                                   09020015
090300                                                                  09030015
090400     PERFORM                                                      09040015
090500       VARYING CS-IDX FROM 1 BY 1 UNTIL CS-IDX > 300              09050015
090600         MOVE ZEROES TO SUMMARY-TYPE-3 (CS-IDX)                   09060019
090700                        SUMMARY-ARRIVALS (CS-IDX)                 09070022
090800         MOVE SPACES TO SUMMARY-CARRIER-4 (CS-IDX)                09080015
090900                        SUMMARY-CARRIER-NAME (CS-IDX)             09090015
091000     END-PERFORM.                                                 09100015
091100                                                                  09110015
091200******************************************************************09120001
091300*  READ SYSIN TO DETERMINE DATE RANGE DISPLAYED IN HEADING.      *09130001
091400******************************************************************09140001
091500 1100-PROCESS-DATECARD.                                           09150001
091600                                                                  09160001
091700     EXEC SQL                                                     09170001
091800         SELECT (CURRENT DATE - 1 DAY)                            09180001
091900              , CURRENT DATE                                      09190001
092000              , (CURRENT DATE - 1 YEAR)                           09200001
092100           INTO :PV-CURRENT-DB2-DATE-ONE                          09210001
092200              , :PV-CURRENT-DB2-DATE                              09220001
092300              , :PV-CURRENT-DB2-DATE-ONEYR                        09230001
092400           FROM TCOCNTL                                           09240001
092500          WHERE OPER_UNT_ID = 90                                  09250001
092600     END-EXEC.                                                    09260001
092700                                                                  09270001
092800     EVALUATE TRUE                                                09280001
092900       WHEN SQLCODE = ZERO                                        09290001
093000           MOVE PV-CURRENT-DB2-DATE     TO PV-CURR-DATE           09300001
093100           MOVE PV-CURRENT-DB2-CC       TO PV-CURRENT-CC          09310001
093200           MOVE PV-CURRENT-DB2-YY       TO PV-CURRENT-YY          09320001
093300                                           PV-CURRENT-YYMMDD-YY   09330001
093400           MOVE PV-CURRENT-DB2-MM       TO PV-CURRENT-MM          09340001
093500                                           PV-CURRENT-YYMMDD-MM   09350001
093600           MOVE PV-CURRENT-DB2-DD       TO PV-CURRENT-DD          09360001
093700                                           PV-CURRENT-YYMMDD-DD   09370001
093800       WHEN OTHER                                                 09380001
093900           MOVE '1100-PROCESS-DATECARD' TO PV-ABEND-PARAGRAPH     09390001
094000           MOVE 'SET DATE   ' TO PV-DB2-OPERATION-MESSAGE-1       09400001
094100           MOVE 'TCOCNTL'     TO PV-DB2-TABLE-NAME                09410001
094200           PERFORM 9900-DB2-ABEND                                 09420001
094300      END-EVALUATE.                                               09430001
094400                                                                  09440001
094500     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                09450001
094600                                                                  09460001
094700     DISPLAY '  CONTROL CARD SET-UP FOR THIS RUN IS: '            09470001
094800             CC-CONTROL-CARD-PARAMETERS.                          09480001
094900                                                                  09490001
095000     PERFORM 1110-CHECK-CC-PARAMETERS.                            09500001
095100     PERFORM 1120-SET-DATE-RANGE.                                 09510001
095200                                                                  09520001
095300******************************************************************09530001
095400 1110-CHECK-CC-PARAMETERS.                                        09540001
095500     MOVE '1110-CHECK-CC-PARAMETERS'   TO PV-ABEND-PARAGRAPH.     09550001
095600                                                                  09560001
095700     IF NOT CC-VALID-MODE-IND                                     09570001
095800         DISPLAY '***************************'                    09580001
095900         DISPLAY '**       ABEND           **'                    09590001
096000         DISPLAY '**  IN PROGRAM SUKRP022  **'                    09600001
096100         DISPLAY '***************************'                    09610001
096200         DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH    09620001
096300         DISPLAY '**   ERROR         ** = '                       09630001
096400                 'MODE INDICATOR "' CC-MODE-IND '"'               09640001
096500                 ' IS INVALID'                                    09650001
096600         DISPLAY '***************************'                    09660001
096700         DISPLAY '** CONTROL PARAMETERS = '                       09670001
096800                  CC-CONTROL-CARD-PARAMETERS                      09680001
096900         DISPLAY 'RUN ABORTED'                                    09690001
097000         DISPLAY '***************************'                    09700001
097100         MOVE 4003  TO PV-ABEND-CODE                              09710001
097200         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 09720001
097300         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    09730001
097400     END-IF.                                                      09740001
097500                                                                  09750001
097600     IF CC-BEG-DATE = PC-DEFAULT-CC-DATE                          09760001
097700       AND CC-END-DATE = PC-DEFAULT-CC-DATE                       09770001
097800         SET PS-NORMAL-RUN     TO TRUE                            09780001
097900     ELSE                                                         09790001
098000         SET PS-SPECIAL-RUN    TO TRUE                            09800001
098100         MOVE CC-BEG-CC        TO PV-BEG-YMD-CC                   09810001
098200         MOVE CC-BEG-YY        TO PV-BEG-YY                       09820001
098300         MOVE CC-BEG-YY        TO PV-BEG-YMD-YY                   09830001
098400         MOVE CC-BEG-MM        TO PV-BEG-MM                       09840001
098500         MOVE CC-BEG-MM        TO PV-BEG-YMD-MM                   09850001
098600         MOVE CC-BEG-DD        TO PV-BEG-DD                       09860001
098700         MOVE CC-BEG-DD        TO PV-BEG-YMD-DD                   09870001
098800         MOVE CC-END-CC        TO PV-END-YMD-CC                   09880001
098900         MOVE CC-END-YY        TO PV-END-YY                       09890001
099000         MOVE CC-END-YY        TO PV-END-YMD-YY                   09900001
099100         MOVE CC-END-MM        TO PV-END-MM                       09910001
099200         MOVE CC-END-MM        TO PV-END-YMD-MM                   09920001
099300         MOVE CC-END-DD        TO PV-END-DD                       09930001
099400         MOVE CC-END-DD        TO PV-END-YMD-DD                   09940001
099500                                                                  09950001
099600         IF PV-BEG-DATE-CYMD IS NOT < PV-END-DATE-CYMD            09960001
099700           AND PV-BEG-DATE-CYMD IS NOT = PV-END-DATE-CYMD         09970001
099800             DISPLAY '***************************'                09980001
099900             DISPLAY 'CONTROL PARAMETERS: '                       09990001
100000                     CC-CONTROL-CARD-PARAMETERS                   10000001
100100             DISPLAY 'THE BEGINNING DATE MUST BE LESS THAN '      10010001
100200                     'OR EQUAL TO THE ENDING DATE'                10020001
100300             DISPLAY 'PV-BEG-DATE - ' PV-BEG-DATE                 10030001
100400             DISPLAY 'PV-END-DATE - ' PV-BEG-DATE                 10040001
100500             DISPLAY 'PV-BEG-DATE-CYMD - ' PV-BEG-DATE-CYMD       10050001
100600             DISPLAY 'PV-END-DATE-CYMD - ' PV-BEG-DATE-CYMD       10060001
100700             DISPLAY 'RUN ABORTED'                                10070001
100800             DISPLAY '***************************'                10080001
100900             MOVE 4003  TO PV-ABEND-CODE                          10090001
101000             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             10100001
101100             CALL 'ILBOABN0'   USING PV-ABEND-CODE                10110001
101200         END-IF                                                   10120001
101300                                                                  10130001
101400         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           10140001
101500         SET DPG51-FISCAL-454-CALENDAR   TO TRUE                  10150001
101600         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  10160001
101700         SET DPG52-LK-DTE-GREG-FMT       TO TRUE                  10170001
101800         MOVE PV-BEG-DATE                TO DPG52-LK-DATE-INPUT   10180001
101900         PERFORM 9100-CALL-DATE-MODULE                            10190001
102000         IF DPG54-DATE-INVALID                                    10200001
102100             DISPLAY '***************************'                10210001
102200             DISPLAY 'CONTROL PARAMETERS: '                       10220001
102300                     CC-CONTROL-CARD-PARAMETERS                   10230001
102400             DISPLAY 'BEGINNING DATE  ' CC-BEG-DATE               10240001
102500                     ' IS INVALID.'                               10250001
102600             DISPLAY 'RUN ABORTED'                                10260001
102700             DISPLAY '***************************'                10270001
102800             MOVE 4003  TO PV-ABEND-CODE                          10280001
102900             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             10290001
103000             CALL 'ILBOABN0'   USING PV-ABEND-CODE                10300001
103100         END-IF                                                   10310001
103200                                                                  10320001
103300         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           10330001
103400         SET DPG51-FISCAL-454-CALENDAR   TO TRUE                  10340001
103500         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  10350001
103600         SET DPG52-LK-DTE-GREG-FMT       TO TRUE                  10360001
103700         MOVE PV-END-DATE                TO DPG52-LK-DATE-INPUT   10370001
103800         PERFORM 9100-CALL-DATE-MODULE                            10380001
103900         IF DPG54-DATE-INVALID                                    10390001
104000             DISPLAY '***************************'                10400001
104100             DISPLAY 'CONTROL PARAMETERS: '                       10410001
104200                     CC-CONTROL-CARD-PARAMETERS                   10420001
104300             DISPLAY 'ENDING DATE ' CC-END-DATE                   10430001
104400                     ' IS INVALID.'                               10440001
104500             DISPLAY 'RUN ABORTED'                                10450001
104600             DISPLAY '***************************'                10460001
104700             MOVE 4003  TO PV-ABEND-CODE                          10470001
104800             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             10480001
104900             CALL 'ILBOABN0'   USING PV-ABEND-CODE                10490001
105000         END-IF                                                   10500001
105100     END-IF.                                                      10510001
105200                                                                  10520001
105300     IF PS-SPECIAL-RUN                                            10530001
105400       AND CC-SEASONAL-EXTRACT                                    10540001
105500       AND DPG56-FISCAL-PERIOD-NBR < 7                            10550001
105600         MOVE PC-SPRING TO PV-SEASON-DESC                         10560001
105700     ELSE                                                         10570001
105800     IF PS-SPECIAL-RUN                                            10580001
105900       AND CC-SEASONAL-EXTRACT                                    10590001
106000         MOVE PC-FALL   TO PV-SEASON-DESC                         10600001
106100     END-IF.                                                      10610001
106200                                                                  10620001
106300******************************************************************10630001
106400 1120-SET-DATE-RANGE.                                             10640001
106500     MOVE '1120-SET-DATE-RANGE      ' TO PV-ABEND-PARAGRAPH.      10650001
106600                                                                  10660001
106700     IF PS-NORMAL-RUN                                             10670001
106800         PERFORM 1130-DETERMINE-DATE-RANGE                        10680001
106900     ELSE                                                         10690001
107000         MOVE CC-BEG-DATE TO PV-START-EXTRACT                     10700001
107100         MOVE CC-END-DATE TO PV-END-EXTRACT                       10710001
107200     END-IF.                                                      10720001
107300                                                                  10730001
107400     MOVE PV-START-EXTRACT-YYYY    TO WS-START-EXTRACT-YYYY.      10740001
107500     MOVE PV-START-EXTRACT-MM      TO WS-START-EXTRACT-MM.        10750001
107600     MOVE PV-START-EXTRACT-DD      TO WS-START-EXTRACT-DD.        10760001
107700     MOVE PV-END-EXTRACT-YYYY      TO WS-END-EXTRACT-YYYY.        10770001
107800     MOVE PV-END-EXTRACT-MM        TO WS-END-EXTRACT-MM.          10780001
107900     MOVE PV-END-EXTRACT-DD        TO WS-END-EXTRACT-DD.          10790001
108000                                                                  10800001
108100     MOVE DPG56-FISCAL-PERIOD-NBR  TO WS-FISCAL-PERIOD-NBR.       10810001
108200     MOVE DPG56-FISCAL-PERIOD-WEEK TO WS-FISCAL-PERIOD-WEEK.      10820001
108300     MOVE DPG56-FISCAL-QTR-NBR     TO WS-FISCAL-QTR-NBR.          10830001
108400     MOVE DPG56-FISCAL-WEEK-NBR    TO WS-FISCAL-WEEK-NBR.         10840001
108500                                                                  10850001
108600     MOVE PV-START-EXTRACT-MM      TO PV-DATE-START-MM.           10860001
108700     MOVE PV-START-EXTRACT-DD      TO PV-DATE-START-DD.           10870001
108800     MOVE PV-START-EXTRACT-YYYY    TO PV-DATE-START-CCYY.         10880001
108900     MOVE PV-END-EXTRACT-MM        TO PV-DATE-END-MM.             10890001
109000     MOVE PV-END-EXTRACT-DD        TO PV-DATE-END-DD.             10900001
109100     MOVE PV-END-EXTRACT-YYYY      TO PV-DATE-END-CCYY.           10910001
109200     MOVE WS-FISCAL-PERIOD-NBR     TO PV-DATE-FISCAL-PERIOD.      10920001
109300     MOVE WS-FISCAL-QTR-NBR        TO PV-DATE-FISCAL-QUARTER.     10930001
109400     MOVE PV-SEASON-DESC           TO PV-DATE-SEASON.             10940001
109500                                                                  10950001
109600     DISPLAY '  DATE RANGE SET-UP FOR THIS RUN IS: '              10960001
109700             PV-DATE-RECORD.                                      10970001
109800                                                                  10980001
109900******************************************************************10990001
110000 1130-DETERMINE-DATE-RANGE.                                       11000001
110100     MOVE '1130-DETERMINE-DATE-RANGE' TO PV-ABEND-PARAGRAPH.      11010001
110200                                                                  11020001
110300     EVALUATE TRUE                                                11030001
110400       WHEN CC-WEEKLY-EXTRACT                                     11040001
110500            PERFORM 1131-WEEKLY-RPT-DTE-RANGE                     11050001
110600                                                                  11060001
110700       WHEN CC-MONTHLY-EXTRACT                                    11070001
110800                PERFORM 1132-MONTHLY-RPT-DTE-RANGE                11080001
110900                                                                  11090001
111000       WHEN CC-FISCAL-EXTRACT                                     11100001
111100                PERFORM 1133-FISCAL-RPT-DTE-RANGE                 11110001
111200                                                                  11120001
111300       WHEN CC-CALENDAR-EXTRACT                                   11130001
111400                PERFORM 1134-CALENDAR-RPT-DTE-RANGE               11140001
111500                                                                  11150001
111600       WHEN CC-SEASONAL-EXTRACT                                   11160001
111700                PERFORM 1135-SEASONAL-RPT-DTE-RANGE               11170001
111800                                                                  11180001
111900     END-EVALUATE.                                                11190001
112000                                                                  11200001
112100*--------------------------------------------------------------   11210001
112200**** GET START/END DATES OF THE PREVIOUS WEEK.                    11220001
112300*--------------------------------------------------------------   11230001
112400 1131-WEEKLY-RPT-DTE-RANGE.                                       11240001
112500     MOVE '1131-WEEKLY-RPT-DTE-RANGE'  TO PV-ABEND-PARAGRAPH.     11250001
112600                                                                  11260001
112700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11270001
112800     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               11280001
112900     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               11290001
113000     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               11300001
113100     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           11310001
113200     MOVE   PC-SEVEN           TO DPG51-INCR-DECR-DAYS-9.         11320001
113300                                                                  11330001
113400     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11340001
113500     SET DPG51-DECREMENT-DATE       TO TRUE.                      11350001
113600     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      11360001
113700                                                                  11370001
113800     PERFORM 9100-CALL-DATE-MODULE                                11380001
113900                                                                  11390001
114000     IF DPG54-DATE-VALID                                          11400001
114100         MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO PV-START-EXTRACT      11410001
114200         MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PV-END-EXTRACT        11420001
114300     ELSE                                                         11430001
114400         DISPLAY 'DPG55-1ST-WKDY-DB2ISO-FMT - '                   11440001
114500                  DPG55-1ST-WKDY-DB2ISO-FMT                       11450001
114600         DISPLAY 'DPG55-LAST-WKDY-DB2ISO-FMT - '                  11460001
114700                  DPG55-LAST-WKDY-DB2ISO-FMT                      11470001
114800     END-IF.                                                      11480001
114900                                                                  11490001
115000*--------------------------------------------------------------   11500001
115100*** GET START/END DATES OF THE PREVIOUS MONTH.                    11510001
115200*--------------------------------------------------------------   11520001
115300 1132-MONTHLY-RPT-DTE-RANGE.                                      11530001
115400     MOVE '1132-MONTHLY-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.     11540001
115500                                                                  11550001
115600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11560001
115700     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY                11570001
115800     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM                11580001
115900     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD                11590001
116000     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            11600001
116100                                                                  11610001
116200     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9          11620001
116300                                                                  11630001
116400     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11640001
116500     SET DPG51-DECREMENT-DATE       TO TRUE.                      11650001
116600     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      11660001
116700                                                                  11670001
116800     PERFORM 9100-CALL-DATE-MODULE                                11680001
116900                                                                  11690001
117000     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                           11700001
117100                                  PV-START-EXTRACT                11710001
117200     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO                           11720001
117300                                  PV-END-EXTRACT.                 11730001
117400                                                                  11740001
117500*-------------------------------------------------------------    11750001
117600*** GET START/END DATES OF THE FISCAL PERIOD.                     11760001
117700*-------------------------------------------------------------    11770001
117800 1133-FISCAL-RPT-DTE-RANGE.                                       11780001
117900     MOVE '1133-FISCAL-RPT-DTE-RANGE ' TO PV-ABEND-PARAGRAPH.     11790001
118000                                                                  11800001
118100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11810001
118200     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               11820001
118300     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               11830001
118400     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               11840001
118500     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            11850001
118600                                                                  11860001
118700     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         11870001
118800                                                                  11880001
118900     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11890001
119000     SET DPG51-DECREMENT-DATE       TO TRUE.                      11900001
119100     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      11910001
119200                                                                  11920001
119300     PERFORM 9100-CALL-DATE-MODULE                                11930001
119400                                                                  11940001
119500     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         11950001
119600         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       11960001
119700                                  PV-START-EXTRACT                11970001
119800         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       11980001
119900                                  PV-END-EXTRACT                  11990001
120000     ELSE                                                         12000001
120100         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12010001
120200                                  PV-START-EXTRACT                12020001
120300         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           12030001
120400         MOVE PC-ONE                   TO DPG51-INCR-DECR-DAYS-9  12040001
120500         MOVE PV-DATE-AREA             TO DPG52-LK-DATE-INPUT     12050001
120600         SET DPG51-FISCAL-454-CALENDAR TO TRUE                    12060001
120700         SET DPG51-DECREMENT-DATE      TO TRUE                    12070001
120800         SET DPG52-LK-DTE-GREG-FMT     TO TRUE                    12080001
120900         PERFORM 9100-CALL-DATE-MODULE                            12090001
121000         MOVE DPG55-DB2-ISO-DATE-FMT    TO  PV-END-EXTRACT        12100001
121100     END-IF.                                                      12110001
121200                                                                  12120001
121300*---------------------------------------------------------------- 12130001
121400*** GET START/END DATES OF THE CALENDAR PERIOD.                   12140001
121500*---------------------------------------------------------------- 12150001
121600 1134-CALENDAR-RPT-DTE-RANGE.                                     12160001
121700     MOVE '1134-CALENDAR-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    12170001
121800                                                                  12180001
121900     IF PV-CURRENT-MM = 1 THEN                                    12190001
122000****   IF JANUARY WANT TO CREATE REPORT FOR PREV. CALENDAR YEAR   12200001
122100         MOVE PV-CDD-ONEYR-CCYY         TO PV-START-EXTRACT-YYYY  12210001
122200                                           PV-END-EXTRACT-YYYY    12220001
122300         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   12230001
122400         MOVE  01      TO  PV-START-EXTRACT-MM                    12240001
122500         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   12250001
122600         MOVE  01      TO  PV-START-EXTRACT-DD                    12260001
122700         MOVE  '-'     TO  PV-END-EXTRACT-1ST                     12270001
122800         MOVE   12     TO  PV-END-EXTRACT-MM                      12280001
122900         MOVE  '-'     TO  PV-END-EXTRACT-2ND                     12290001
123000         MOVE   31     TO  PV-END-EXTRACT-DD                      12300001
123100     ELSE                                                         12310001
123200*        CURRENT MONTH > 01                                       12320001
123300*                          BEGINNING DATE = CURRENT YEAR, 01, 01  12330001
123400*                          ENDING DATE    = CURRENT DATE - 1      12340001
123500         MOVE PV-CURRENT-CCYY TO PV-START-EXTRACT-YYYY            12350001
123600         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   12360001
123700         MOVE  01      TO  PV-START-EXTRACT-MM                    12370001
123800         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   12380001
123900         MOVE  01      TO  PV-START-EXTRACT-DD                    12390001
124000                                                                  12400001
124100         MOVE PV-CURRENT-DB2-DATE-ONE TO PV-END-EXTRACT           12410001
124200     END-IF.                                                      12420001
124300                                                                  12430001
124400*-----------------------------------------------------------------12440001
124500* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             12450001
124600*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           12460001
124700* FROM PV-END-EXTRACT DATE.                                       12470001
124800*-----------------------------------------------------------------12480001
124900                                                                  12490001
125000     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     12500001
125100     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     12510001
125200     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     12520001
125300     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     12530001
125400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12540001
125500     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   12550001
125600     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  12560001
125700     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  12570001
125800     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  12580001
125900                                                                  12590001
126000     PERFORM 9100-CALL-DATE-MODULE.                               12600001
126100                                                                  12610001
126200*-------------------------------------------------------------    12620001
126300*** GET START/END DATES SEASONAL                                  12630001
126400*-------------------------------------------------------------    12640001
126500 1135-SEASONAL-RPT-DTE-RANGE.                                     12650001
126600     MOVE '1135-SEASONAL-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    12660001
126700                                                                  12670001
126800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12680001
126900     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               12690001
127000     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               12700001
127100     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               12710001
127200     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           12720001
127300                                                                  12730001
127400     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         12740001
127500                                                                  12750001
127600     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      12760001
127700     SET DPG51-DECREMENT-DATE       TO TRUE.                      12770001
127800     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      12780001
127900                                                                  12790001
128000     PERFORM 9100-CALL-DATE-MODULE                                12800001
128100                                                                  12810001
128200     IF DPG56-FISCAL-PERIOD-NBR < 7                               12820001
128300        MOVE PC-SPRING TO PV-SEASON-DESC                          12830001
128400     ELSE                                                         12840001
128500        MOVE PC-FALL   TO PV-SEASON-DESC                          12850001
128600     END-IF.                                                      12860001
128700     IF DPG56-FISCAL-PERIOD-NBR < 6 THEN                          12870001
128800         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12880001
128900                                  PV-START-EXTRACT                12890001
129000         MOVE PV-CURRENT-DB2-DATE-ONE TO                          12900001
129100                           PV-END-EXTRACT                         12910001
129200     END-IF.                                                      12920001
129300     IF DPG56-FISCAL-PERIOD-NBR = 6 THEN                          12930001
129400         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12940001
129500                                  PV-START-EXTRACT                12950001
129600         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       12960001
129700                                  PV-END-EXTRACT                  12970001
129800     END-IF.                                                      12980001
129900     IF DPG56-FISCAL-PERIOD-NBR = 7 THEN                          12990001
130000         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       13000001
130100                                  PV-START-EXTRACT                13010001
130200         MOVE PV-CURRENT-DB2-DATE-ONE TO                          13020001
130300                                  PV-END-EXTRACT                  13030001
130400     END-IF.                                                      13040001
130500     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          13050001
130600         MOVE PV-CURRENT-DB2-DATE-ONE TO                          13060001
130700                                  PV-END-EXTRACT                  13070001
130800     END-IF.                                                      13080001
130900     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         13090001
131000         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       13100001
131100                                  PV-END-EXTRACT                  13110001
131200     END-IF.                                                      13120001
131300     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          13130001
131400         MOVE DPG56-FIRST-FD-DB2-ISO-FMT-YR                       13140001
131500                               TO  PV-YEAR-FORMAT                 13150001
131600         MOVE PV-YEAR-FORMAT-YY TO PV-DATE-AREA-YY                13160001
131700         MOVE 01               TO  PV-DATE-AREA-MM                13170001
131800         MOVE 01               TO  PV-DATE-AREA-DD                13180001
131900         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           13190001
132000         MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT            13200001
132100         MOVE 220              TO DPG51-INCR-DECR-DAYS-9          13210001
132200         SET DPG51-FISCAL-454-CALENDAR  TO TRUE                   13220001
132300         SET DPG51-INCREMENT-DATE       TO TRUE                   13230001
132400         SET DPG52-LK-DTE-GREG-FMT      TO TRUE                   13240001
132500         PERFORM 9100-CALL-DATE-MODULE                            13250001
132600         MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                       13260001
132700                                  PV-START-EXTRACT                13270001
132800     END-IF.                                                      13280001
132900                                                                  13290001
133000*-----------------------------------------------------------------13300001
133100* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             13310001
133200*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           13320001
133300* FROM PV-END-EXTRACT DATE.                                       13330001
133400*-----------------------------------------------------------------13340001
133500                                                                  13350001
133600     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     13360001
133700     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     13370001
133800     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     13380001
133900     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     13390001
134000     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              13400001
134100     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   13410001
134200     MOVE  ZEROES                      TO  DPG51-INCR-DECR-DAYS-9.13420001
134300     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  13430001
134400     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  13440001
134500     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  13450001
134600                                                                  13460001
134700     PERFORM 9100-CALL-DATE-MODULE.                               13470001
134800                                                                  13480001
134900******************************************************************13490001
135000*  PRINT THE REPORT HEADINGS.                                    *13500001
135100******************************************************************13510001
135200 1200-PRINT-HEADINGS.                                             13520001
135300                                                                  13530001
135400     ADD 1  TO PV-PAGE-COUNT.                                     13540001
135500     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     13550001
135600                                                                  13560001
135700     WRITE OUTPUT-REC                                             13570001
135800       FROM DP132-STANDRD-HEADER-132-COLS                         13580001
135900         AFTER ADVANCING PAGE.                                    13590001
136000                                                                  13600001
136100     MOVE +1 TO PV-LINE-COUNT.                                    13610001
136200                                                                  13620001
136300     WRITE OUTPUT-REC                                             13630001
136400       FROM HEADING-LINE-1                                        13640001
136500         AFTER ADVANCING 2 LINES.                                 13650001
136600                                                                  13660001
136700     MOVE PV-DATE-START-MM   TO HL2-FROM-DATE-MM                  13670022
136800                                PV-DB2-DATE-MM-FROM.              13680022
136900     MOVE PV-DATE-START-DD   TO HL2-FROM-DATE-DD                  13690022
137000                                PV-DB2-DATE-DD-FROM.              13700022
137100     MOVE PV-DATE-START-CCYY TO HL2-FROM-DATE-YYYY                13710022
137200                                PV-DB2-DATE-CCYY-FROM.            13720022
137300     MOVE PV-DATE-END-MM     TO HL2-TO-DATE-MM                    13730022
137400                                PV-DB2-DATE-MM-TO.                13740022
137500     MOVE PV-DATE-END-DD     TO HL2-TO-DATE-DD                    13750022
137600                                PV-DB2-DATE-DD-TO.                13760022
137700     MOVE PV-DATE-END-CCYY   TO HL2-TO-DATE-YYYY                  13770022
137800                                PV-DB2-DATE-CCYY-TO.              13780022
137900     WRITE OUTPUT-REC                                             13790001
138000       FROM HEADING-LINE-2                                        13800001
138100         AFTER ADVANCING 1 LINES.                                 13810001
138200                                                                  13820001
138300     MOVE PV-CURR-SCAC TO HL3-SCAC.                               13830004
138400     PERFORM 1205-GET-SCAC-DESC.                                  13840004
138500     WRITE OUTPUT-REC                                             13850001
138600       FROM HEADING-LINE-3                                        13860001
138700         AFTER ADVANCING 2 LINES.                                 13870001
138800                                                                  13880001
138900     MOVE PV-CURR-VEH-NBR TO HL4-TRAILER.                         13890032
139000     WRITE OUTPUT-REC                                             13900032
139100       FROM HEADING-LINE-4                                        13910032
139200         AFTER ADVANCING 2 LINES.                                 13920032
139300                                                                  13930004
139400     WRITE OUTPUT-REC                                             13940001
139500       FROM HEADING-LINE-6                                        13950001
139600         AFTER ADVANCING 1 LINES.                                 13960001
139700                                                                  13970001
139800     WRITE OUTPUT-REC                                             13980001
139900       FROM HEADING-LINE-7                                        13990001
140000         AFTER ADVANCING 1 LINES.                                 14000001
140100                                                                  14010001
140200     WRITE OUTPUT-REC                                             14020001
140300       FROM HEADING-LINE-8                                        14030001
140400         AFTER ADVANCING 1 LINES.                                 14040001
140500                                                                  14050001
140600     PERFORM 1210-TYPE-HEADING.                                   14060010
140700                                                                  14070010
140800     MOVE +15 TO PV-LINE-COUNT.                                   14080001
140900                                                                  14090001
141000******************************************************************14100001
141100 1205-GET-SCAC-DESC.                                              14110004
141200                                                                  14120004
141300     EXEC SQL                                                     14130004
141400         SELECT B.ENT_NAME_DESC                                   14140006
141500           INTO :ENTNME-ENT-NAME-DESC                             14150004
141600           FROM TEXTENT A,                                        14160004
141700                TENTNME B                                         14170004
141800          WHERE A.SCAC_CDE    = :PV-CURR-SCAC                     14180004
141900            AND A.ENT_ID      = B.ENT_ID                          14190004
142000            AND B.TYPE_CDE    = :PC-TYPE-CODE-01                  14200006
142100     END-EXEC                                                     14210004
142200                                                                  14220004
142300     EVALUATE TRUE                                                14230004
142400       WHEN SQLCODE = ZERO                                        14240004
142500       WHEN SQLCODE = -811                                        14250046
142600           MOVE ENTNME-ENT-NAME-DESC TO HL3-SCAC-DESC             14260004
142700       WHEN SQLCODE = +100                                        14270004
142800           MOVE 'CARRIER NOT FOUND'  TO HL3-SCAC-DESC             14280004
142900       WHEN OTHER                                                 14290004
143000           MOVE '1205-GET-SCAC-DESC' TO PV-ABEND-PARAGRAPH        14300004
143100           MOVE 'GET CARRIER NAME'   TO PV-DB2-OPERATION-MESSAGE-114310004
143200           MOVE 'TEXTENT'            TO PV-DB2-TABLE-NAME         14320004
143300           PERFORM 9900-DB2-ABEND                                 14330004
143400     END-EVALUATE.                                                14340004
143500                                                                  14350004
143600******************************************************************14360004
143700 1210-TYPE-HEADING.                                               14370001
143800                                                                  14380001
143900     MOVE PV-CURR-TYPE TO HL5-MISDIRECT-TYPE.                     14390001
144000                                                                  14400001
144100     IF PV-CURR-TYPE = '1'                                        14410001
144200         MOVE PC-MISDIRECT-DESC-1 TO HL5-MISDIRECT-DESC           14420001
144300     END-IF.                                                      14430001
144400     IF PV-CURR-TYPE = '2'                                        14440001
144500         MOVE PC-MISDIRECT-DESC-2 TO HL5-MISDIRECT-DESC           14450001
144600     END-IF.                                                      14460001
144700     IF PV-CURR-TYPE = '3'                                        14470001
144800         MOVE PC-MISDIRECT-DESC-3 TO HL5-MISDIRECT-DESC           14480001
144900     END-IF.                                                      14490001
145000     IF PV-CURR-TYPE = '4'                                        14500001
145100         MOVE PC-MISDIRECT-DESC-4 TO HL5-MISDIRECT-DESC           14510001
145200     END-IF.                                                      14520001
145300***  IF PV-CURR-TYPE = '5'                                        14530008
145400***      MOVE PC-MISDIRECT-DESC-5 TO HL5-MISDIRECT-DESC           14540008
145500***  END-IF.                                                      14550008
145600                                                                  14560001
145700     WRITE OUTPUT-REC                                             14570001
145800       FROM HEADING-LINE-5                                        14580001
145900         AFTER ADVANCING 2 LINES.                                 14590001
146000                                                                  14600001
146100     WRITE OUTPUT-REC                                             14610032
146200       FROM BLANK-LINE                                            14620032
146300         AFTER ADVANCING 1 LINES.                                 14630032
146400                                                                  14640032
146500******************************************************************14650001
146600*  PRINT A 'NO INPUT' REPORT LINE.                               *14660001
146700******************************************************************14670001
146800 1300-NO-DETAIL-LINE.                                             14680001
146900                                                                  14690001
147000     WRITE OUTPUT-REC                                             14700001
147100       FROM NO-DATA-TO-REPORT-LINE                                14710001
147200         AFTER ADVANCING 3 LINES.                                 14720001
147300                                                                  14730001
147400******************************************************************14740001
147500*  PRINT A 'END OF REPORT' REPORT LINE.                          *14750001
147600******************************************************************14760001
147700 1400-END-OF-RPT-LINE.                                            14770001
147800                                                                  14780001
147900*CHECK FOR OVERFLOW.                                              14790001
148000*    ADD 3 TO PV-LINE-COUNT.                                      14800030
148100*    IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         14810030
148200*        SET PS-NEW-PAGE TO TRUE                                  14820030
148300*        PERFORM 1200-PRINT-HEADINGS                              14830030
148400*    END-IF.                                                      14840030
148500                                                                  14850001
148600*PRINT LINE.                                                      14860001
148700     WRITE OUTPUT-REC                                             14870001
148800       FROM END-OF-REPORT-LINE                                    14880001
148900         AFTER ADVANCING 3 LINES.                                 14890001
149000                                                                  14900001
149100******************************************************************14910001
149200*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR READING THE INPUT  *14920001
149300*  EXTRACT FILE (FORMAT SURD008) AND CREATING THE 'INTRA-COMPANY *14930001
149400*  MISDIRECTS FROM UCC128 SCAN RESULTS BY DC, VENDOR' REPORT.    *14940001
149500******************************************************************14950001
149600 2000-PROCESS-EXTRACT.                                            14960001
149700                                                                  14970001
149800*CHECK FOR BREAKS.                                                14980004
149900     IF SU008-SCAC-CDE NOT = PV-CURR-SCAC                         14990004
150000         PERFORM 2010-TYPE-BREAK                                  15000004
150100         PERFORM 2020-TRLR-BREAK                                  15010004
150200         PERFORM 2030-SCAC-BREAK                                  15020004
150300         MOVE 0 TO PV-PAGE-COUNT                                  15030004
150400         MOVE SU008-MISDIRECT-TYPE TO PV-CURR-TYPE                15040011
150500         MOVE SU008-VEH-NBR        TO PV-CURR-VEH-NBR             15050011
150600         MOVE SU008-SCAC-CDE       TO PV-CURR-SCAC                15060011
150700         PERFORM 1200-PRINT-HEADINGS                              15070004
150800         MOVE ZEROES TO PV-CURR-LOCN                              15080004
150900                        PV-CURR-PO-NBR                            15090004
151000                        PV-CURR-REC-SEQ-NBR                       15100004
151100         MOVE SPACES TO PV-CURR-VEND-NAME                         15110004
151200     ELSE                                                         15120004
151300         IF SU008-VEH-NBR NOT = PV-CURR-VEH-NBR                   15130004
151400             PERFORM 2010-TYPE-BREAK                              15140004
151500             PERFORM 2020-TRLR-BREAK                              15150004
151600             MOVE SU008-MISDIRECT-TYPE TO PV-CURR-TYPE            15160011
151700             MOVE SU008-VEH-NBR        TO PV-CURR-VEH-NBR         15170011
151800*CHECK FOR OVERFLOW.                                              15180032
151900             ADD 3 TO PV-LINE-COUNT                               15190032
152000             IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                 15200032
152100                 SET PS-NEW-PAGE TO TRUE                          15210032
152200                 PERFORM 1200-PRINT-HEADINGS                      15220032
152300             ELSE                                                 15230032
152400                 PERFORM 1210-TYPE-HEADING                        15240032
152500             END-IF                                               15250032
152600             MOVE ZEROES TO PV-CURR-LOCN                          15260004
152700                            PV-CURR-PO-NBR                        15270004
152800                            PV-CURR-REC-SEQ-NBR                   15280004
152900             MOVE SPACES TO PV-CURR-VEND-NAME                     15290004
153000         ELSE                                                     15300004
153100             IF SU008-MISDIRECT-TYPE NOT = PV-CURR-TYPE           15310004
153200                 PERFORM 2010-TYPE-BREAK                          15320004
153300                 MOVE SU008-MISDIRECT-TYPE TO PV-CURR-TYPE        15330032
153400*CHECK FOR OVERFLOW.                                              15340032
153500                 ADD 3 TO PV-LINE-COUNT                           15350032
153600                 IF PV-LINE-COUNT > PC-MAX-LINE-COUNT             15360032
153700                     SET PS-NEW-PAGE TO TRUE                      15370032
153800                     PERFORM 1200-PRINT-HEADINGS                  15380032
153900                 ELSE                                             15390032
154000                     PERFORM 1210-TYPE-HEADING                    15400032
154100                 END-IF                                           15410032
154200                 MOVE ZEROES TO PV-CURR-LOCN                      15420004
154300                                PV-CURR-PO-NBR                    15430004
154400                                PV-CURR-REC-SEQ-NBR               15440004
154500                 MOVE SPACES TO PV-CURR-VEND-NAME                 15450004
154600             END-IF                                               15460004
154700         END-IF                                                   15470004
154800     END-IF.                                                      15480004
154900                                                                  15490004
155000*PRINT DETAIL LINE.                                               15500001
155100     PERFORM 2100-PRINT-DETAIL.                                   15510001
155200     SET PS-FIRST-TIME-NO TO TRUE.                                15520001
155300     ADD +1 TO PV-REC-OUT-QTY.                                    15530001
155400                                                                  15540001
155500*READ NEXT INPUT RECORD.                                          15550001
155600     PERFORM 0100-READ-EXTRACT.                                   15560001
155700     IF NOT PS-END-OF-INPUT                                       15570001
155800         ADD +1 TO PV-REC-IN-QTY                                  15580001
155900     END-IF.                                                      15590001
156000                                                                  15600001
156100******************************************************************15610001
156200*  PRINT A REPORT SUB-TOTAL LINE (BY MISDIRECT TYPE).            *15620001
156300******************************************************************15630001
156400 2010-TYPE-BREAK.                                                 15640001
156500                                                                  15650001
156600*FILL NUMBER OF MISDIRECTS.                                       15660001
156700     MOVE PV-CURR-TYPE    TO TL1-MISDIRECT-TYPE.                  15670001
156800     MOVE PV-ACCUM-TYPE   TO PV-FORMAT-ACCUM.                     15680001
156900     MOVE PV-FORMAT-ACCUM TO TL1-TOTAL-TYPE.                      15690001
157000                                                                  15700001
157100*CHECK FOR OVERFLOW.                                              15710001
157200     ADD 2 TO PV-LINE-COUNT.                                      15720001
157300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         15730001
157400         SET PS-NEW-PAGE TO TRUE                                  15740001
157500         PERFORM 1200-PRINT-HEADINGS                              15750001
157600     END-IF.                                                      15760001
157700                                                                  15770001
157800*WRITE TOTAL LINE.                                                15780001
157900     WRITE OUTPUT-REC                                             15790001
158000       FROM TOTAL-LINE-1                                          15800001
158100         AFTER ADVANCING 2 LINES.                                 15810001
158200                                                                  15820001
158300*RE-INITIALIZE ACCUMULATORS.                                      15830001
158400     MOVE ZEROES TO PV-ACCUM-TYPE.                                15840001
158500                                                                  15850001
158600******************************************************************15860001
158700*  PRINT A REPORT SUB-TOTAL LINE (BY TRAILER).                   *15870004
158800******************************************************************15880004
158900 2020-TRLR-BREAK.                                                 15890004
159000                                                                  15900001
159100*FILL NUMBER OF MISDIRECTS.                                       15910001
159200     MOVE PV-ACCUM-VEH-NBR TO PV-FORMAT-ACCUM.                    15920004
159300     MOVE PV-FORMAT-ACCUM  TO TL2-TOTAL-VEH-NBR.                  15930004
159400                                                                  15940001
159500*CHECK FOR OVERFLOW.                                              15950001
159600     ADD 2 TO PV-LINE-COUNT.                                      15960001
159700     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         15970001
159800         SET PS-NEW-PAGE TO TRUE                                  15980001
159900         PERFORM 1200-PRINT-HEADINGS                              15990001
160000     END-IF.                                                      16000001
160100                                                                  16010001
160200*WRITE TOTAL LINE.                                                16020001
160300     WRITE OUTPUT-REC                                             16030001
160400       FROM TOTAL-LINE-2                                          16040001
160500         AFTER ADVANCING 2 LINES.                                 16050001
160600                                                                  16060032
160700*MINOR BREAK - PRINT NEW TRAILER HEADING.                         16070032
160800     IF SU008-SCAC-CDE = PV-CURR-SCAC                             16080032
160900         IF NOT PS-END-OF-INPUT                                   16090032
161000             ADD 3 TO PV-LINE-COUNT                               16100032
161100             IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                 16110032
161200                 SET PS-NEW-PAGE TO TRUE                          16120032
161300                 PERFORM 1200-PRINT-HEADINGS                      16130032
161400             ELSE                                                 16140032
161500                 MOVE SU008-VEH-NBR TO HL4-TRAILER                16150032
161600                 WRITE OUTPUT-REC                                 16160032
161700                   FROM HEADING-LINE-4                            16170032
161800                     AFTER ADVANCING 3 LINES                      16180032
161900             END-IF                                               16190032
162000         END-IF                                                   16200032
162100     END-IF.                                                      16210032
162200                                                                  16220032
162300*RE-INITIALIZE ACCUMULATORS.                                      16230001
162400     MOVE ZEROES TO PV-ACCUM-VEH-NBR.                             16240004
162500                                                                  16250001
162600******************************************************************16260004
162700*  PRINT A REPORT SUB-TOTAL LINE (BY CARRIER).                   *16270004
162800******************************************************************16280004
162900 2030-SCAC-BREAK.                                                 16290004
163000                                                                  16300004
163100*FILL NUMBER OF MISDIRECTS.                                       16310004
163200     MOVE PV-ACCUM-SCAC   TO PV-FORMAT-ACCUM.                     16320004
163300     MOVE PV-FORMAT-ACCUM TO TL3-TOTAL-SCAC.                      16330004
163400                                                                  16340004
163500*CHECK FOR OVERFLOW.                                              16350004
163600     ADD 2 TO PV-LINE-COUNT.                                      16360004
163700     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         16370004
163800         SET PS-NEW-PAGE TO TRUE                                  16380004
163900         PERFORM 1200-PRINT-HEADINGS                              16390004
164000     END-IF.                                                      16400004
164100                                                                  16410004
164200*WRITE TOTAL LINE.                                                16420004
164300     WRITE OUTPUT-REC                                             16430004
164400       FROM TOTAL-LINE-3                                          16440004
164500         AFTER ADVANCING 2 LINES.                                 16450004
164600                                                                  16460004
164700*SAVE CARRIER DATA TO TABLE.                                      16470015
164800     SET PS-NOT-END-OF-TABLE TO TRUE.                             16480015
164900     PERFORM 2035-SAVE-CARRIER-DATA.                              16490015
165000     IF PS-END-OF-TABLE                                           16500015
165100         MOVE '2035-SAVE-CARRIER-DATA' TO PV-ABEND-PARAGRAPH      16510015
165200         MOVE 'SUMMARY '               TO PV-ABEND-STRUCTURE-1    16520015
165300         MOVE 'TABLE TOO SMALL - OVER 300 CARRIERS PROCESSED'     16530015
165400                                       TO PV-ABEND-OPERATION      16540015
165500         PERFORM 9900-DB2-ABEND                                   16550015
165600     END-IF.                                                      16560015
165700                                                                  16570015
165800*RE-INITIALIZE ACCUMULATORS.                                      16580004
165900     MOVE ZEROES TO PV-ACCUM-SCAC.                                16590015
166000                                                                  16600004
166100******************************************************************16610015
166200 2035-SAVE-CARRIER-DATA.                                          16620015
166300                                                                  16630015
166400     SET CS-IDX TO 1.                                             16640015
166500                                                                  16650015
166600     SEARCH SUMMARY-TABLE                                         16660015
166700       VARYING CS-IDX                                             16670015
166800         AT END SET PS-END-OF-TABLE TO TRUE                       16680015
166900                                                                  16690015
167000         WHEN SUMMARY-CARRIER-4 (CS-IDX) = SPACES                 16700015
167100             MOVE HL3-SCAC       TO SUMMARY-CARRIER-4 (CS-IDX)    16710015
167200             MOVE HL3-SCAC-DESC  TO SUMMARY-CARRIER-NAME (CS-IDX) 16720015
167300             MOVE PV-ACCUM-SCAC  TO SUMMARY-TYPE-3 (CS-IDX)       16730019
167400                 MOVE ZEROES       TO SUMMARY-ARRIVALS (CS-IDX)   16740036
167500                 MOVE ZEROES       TO PV-ACCUM-ARRIVALS           16750041
167600                                                                  16760041
167700     END-SEARCH.                                                  16770015
167800                                                                  16780015
167900******************************************************************16790028
168000******************************************************************16800001
168100*  FILL AND DETAIL REPORT LINE.                                  *16810001
168200******************************************************************16820005
168300 2100-PRINT-DETAIL.                                               16830001
168400                                                                  16840001
168500*FILL RCVG LOCATION.                                              16850001
168600     IF (SU008-SCN-OPER-UNT-ID = PV-CURR-LOCN)                    16860001
168700         MOVE SPACES             TO DL1-RCVG-LOC                  16870001
168800     ELSE                                                         16880001
168900         MOVE SU008-SCN-OPER-UNT-ID TO PV-CURR-LOCN               16890001
169000         MOVE PV-CURR-LOCN          TO DL1-RCVG-LOC               16900001
169100         MOVE ZEROES                TO PV-CURR-PO-NBR             16910004
169200                                       PV-CURR-REC-SEQ-NBR        16920004
169300         MOVE SPACES                TO PV-CURR-VEND-NAME          16930004
169400     END-IF.                                                      16940001
169500*FILL PO/RECEIVER.                                                16950001
169600     IF (SU008-PO-NBR = PV-CURR-PO-NBR)                           16960001
169700       AND (SU008-REC-SEQ-NBR = PV-CURR-REC-SEQ-NBR)              16970001
169800         MOVE SPACES             TO DL1-PO-RCVR                   16980001
169900     ELSE                                                         16990001
170000         MOVE SU008-PO-NBR       TO PV-FORMAT-PO-NBR              17000001
170100                                    PV-CURR-PO-NBR                17010001
170200         MOVE SU008-REC-SEQ-NBR  TO PV-FORMAT-REC-SEQ             17020001
170300                                    PV-CURR-REC-SEQ-NBR           17030001
170400         MOVE PV-FORMAT-PO       TO DL1-PO-RCVR                   17040001
170500         MOVE SPACES             TO PV-CURR-VEND-NAME             17050004
170600     END-IF.                                                      17060001
170700*FILL VENDOR NAME.                                                17070005
170800     IF (SU008-VEND-NAME = PV-CURR-VEND-NAME)                     17080004
170900         MOVE SPACES             TO DL1-VEND-NAME                 17090004
171000     ELSE                                                         17100004
171100         MOVE SU008-VEND-NAME    TO DL1-VEND-NAME                 17110005
171200                                    PV-CURR-VEND-NAME             17120005
171300     END-IF.                                                      17130004
171400                                                                  17140004
171500*FILL DEST STORE.                                                 17150001
171600     MOVE SU008-DEST-OPER-UNT-ID TO DL1-DEST-STR.                 17160001
171700*FILL PROCESS DC NUMBER.                                          17170034
171800     MOVE SU008-PROCESS-DC-NBR   TO DL1-PROCESS-DC.               17180034
171900*FILL SERIAL SHIP CODE.                                           17190001
172000     MOVE SU008-SHIPT-UNT-ID     TO DL1-SERIAL-SHIP-CODE.         17200001
172100*FILL SCAN DATE.                                                  17210001
172200     MOVE SU008-SCN-DATE         TO PV-INPUT-DATE.                17220001
172300     MOVE PV-INPUT-DATE-YY       TO PV-FORMAT-DATE-YY             17230001
172400     MOVE PV-INPUT-DATE-MM       TO PV-FORMAT-DATE-MM             17240001
172500     MOVE PV-INPUT-DATE-DD       TO PV-FORMAT-DATE-DD             17250001
172600     MOVE PV-FORMAT-DATE         TO DL1-SCAN-DATE.                17260001
172700*FILL SCAN TIME.                                                  17270001
172800     MOVE SU008-SCN-TIME         TO PV-INPUT-TIME.                17280001
172900     MOVE PV-INPUT-TIME-HH       TO PV-FORMAT-TIME-HH.            17290001
173000     MOVE PV-INPUT-TIME-MM       TO PV-FORMAT-TIME-MM.            17300001
173100     MOVE PV-FORMAT-TIME         TO DL1-SCAN-TIME.                17310001
173200*FILL SCAN USER ID.                                               17320001
173300     MOVE SU008-SCN-USR-ID       TO DL1-SCAN-USERID.              17330001
173400*FILL ASN NUMBER.                                                 17340001
173500     MOVE SU008-ASN-NBR          TO DL1-ASN-NUMBER.               17350001
173600*FILL ASN DATE.                                                   17360001
173700     MOVE SU008-ASN-CRE-DATE     TO PV-INPUT-DATE.                17370001
173800     MOVE PV-INPUT-DATE-YY       TO PV-FORMAT-DATE-YY             17380001
173900     MOVE PV-INPUT-DATE-MM       TO PV-FORMAT-DATE-MM             17390001
174000     MOVE PV-INPUT-DATE-DD       TO PV-FORMAT-DATE-DD             17400001
174100     MOVE PV-FORMAT-DATE         TO DL1-ASN-DATE.                 17410001
174200*FILL ASN TIME.                                                   17420001
174300     MOVE SU008-ASN-CRE-TIME     TO PV-INPUT-TIME.                17430001
174400     MOVE PV-INPUT-TIME-HH       TO PV-FORMAT-TIME-HH.            17440001
174500     MOVE PV-INPUT-TIME-MM       TO PV-FORMAT-TIME-MM.            17450001
174600     MOVE PV-FORMAT-TIME         TO DL1-ASN-TIME.                 17460001
174700*FILL ASN RECEIVING OPERATOR.                                     17470001
174800     MOVE SU008-ORGN-OPER-UNT-ID TO DL1-RCVG-OPER.                17480001
174900                                                                  17490001
175000*ACCUMULATE QUANTITY FIELDS.                                      17500001
175100     ADD +1                     TO PV-ACCUM-TYPE                  17510001
175200                                   PV-ACCUM-VEH-NBR               17520004
175300                                   PV-ACCUM-SCAC                  17530020
175400                                   PV-ACCUM-TOTL.                 17540020
175500                                                                  17550001
175600*CHECK FOR OVERFLOW.                                              17560001
175700     ADD 1 TO PV-LINE-COUNT.                                      17570001
175800     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         17580001
175900         SET PS-NEW-PAGE TO TRUE                                  17590001
176000         PERFORM 1200-PRINT-HEADINGS                              17600001
176100     END-IF.                                                      17610001
176200                                                                  17620001
176300*IF NEW PAGE, DISPLAY RCVG LOCATION, PO# & VENDOR ON FIRST LINE.  17630010
176400     IF PS-NEW-PAGE                                               17640010
176500         MOVE SU008-SCN-OPER-UNT-ID TO PV-CURR-LOCN               17650010
176600         MOVE PV-CURR-LOCN          TO DL1-RCVG-LOC               17660010
176700         MOVE SU008-PO-NBR          TO PV-FORMAT-PO-NBR           17670010
176800         MOVE SU008-REC-SEQ-NBR     TO PV-FORMAT-REC-SEQ          17680010
176900         MOVE PV-FORMAT-PO          TO DL1-PO-RCVR                17690010
177000         MOVE SU008-VEND-NAME       TO DL1-VEND-NAME              17700010
177100         SET PS-SAME-PAGE           TO TRUE                       17710010
177200     END-IF.                                                      17720010
177300                                                                  17730010
177400*WRITE DETAIL LINE.                                               17740001
177500     WRITE OUTPUT-REC                                             17750001
177600       FROM DETAIL-LINE-1                                         17760001
177700         AFTER ADVANCING 1 LINES.                                 17770001
177800                                                                  17780001
177900*SET SWITCH FOR IDENTIFYING DATA PRESENT FOR MISDIRECT TYPE.      17790001
178000     SET PS-TYPE-DATA-YES TO TRUE.                                17800001
178100                                                                  17810001
178200******************************************************************17820015
178300*  PRINT VENDOR SUMMARY PAGE                                     *17830015
178400******************************************************************17840015
178500 3000-PRINT-SUMMARY.                                              17850015
178600                                                                  17860015
178700     PERFORM 0300-READ-CHECKIN.                                   17870043
178800                                                                  17880043
178900     PERFORM 3200-POPULATE-ARRIVALS-FIELDS UNTIL PS-END-SUMMARY.  17890044
179000                                                                  17900037
179100     MOVE 0 TO PV-PAGE-COUNT.                                     17910029
179200     PERFORM 3100-PRINT-SUMMARY-HDGS.                             17920029
179300                                                                  17930029
179400*PRINT CARRIER SUMMARY DETAIL.                                    17940015
179500     PERFORM VARYING CS-IDX FROM 1 BY 1                           17950015
179600       UNTIL SUMMARY-CARRIER-4 (CS-IDX) = SPACES                  17960015
179700                                                                  17970015
179800         MOVE SUMMARY-CARRIER-4 (CS-IDX)    TO CS-CARRIER-ABBR    17980015
179900         MOVE SUMMARY-CARRIER-NAME (CS-IDX) TO CS-CARRIER-NAME    17990015
180000         MOVE SUMMARY-ARRIVALS (CS-IDX)     TO PV-FORMAT-QTY      18000022
180100         MOVE PV-FORMAT-QTY                 TO CS-LOCN-ALL        18010022
180200         MOVE SUMMARY-TYPE-3 (CS-IDX)       TO PV-FORMAT-QTY      18020022
180300         MOVE PV-FORMAT-QTY                 TO CS-LOCN-TYPE-3     18030022
180400         IF SUMMARY-ARRIVALS (CS-IDX) > ZEROES                    18040027
180500             COMPUTE PV-CALC-PCT = (SUMMARY-TYPE-3 (CS-IDX)       18050027
180600                                  / SUMMARY-ARRIVALS (CS-IDX))    18060027
180700                                 * 100                            18070026
180800         ELSE                                                     18080026
180900             MOVE ZEROES                    TO PV-CALC-PCT        18090026
181000         END-IF                                                   18100026
181100         MOVE PV-CALC-PCT                   TO PV-FORMAT-PCT      18110026
181200         MOVE PV-FORMAT-PCT                 TO CS-LOCN-TOTAL      18120026
181300                                                                  18130015
181400         ADD 1 TO PV-LINE-COUNT                                   18140029
181500         IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                     18150029
181600             PERFORM 3100-PRINT-SUMMARY-HDGS                      18160029
181700         END-IF                                                   18170029
181800                                                                  18180029
181900         WRITE OUTPUT-REC                                         18190015
182000           FROM DETAIL-LINE-1-CS                                  18200015
182100             AFTER ADVANCING 1 LINES                              18210015
182200                                                                  18220029
182300     END-PERFORM.                                                 18230015
182400                                                                  18240015
182500*CHECK FOR OVERFLOW.                                              18250029
182600     ADD 6 TO PV-LINE-COUNT.                                      18260029
182700     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         18270029
182800         PERFORM 3100-PRINT-SUMMARY-HDGS                          18280029
182900     END-IF.                                                      18290029
183000                                                                  18300029
183100*BLANK LINES.                                                     18310015
183200     WRITE OUTPUT-REC                                             18320015
183300       FROM BLANK-LINE                                            18330015
183400         AFTER ADVANCING 5 LINES.                                 18340015
183500                                                                  18350015
183600*PRINT CARRIER SUMMARY TOTALS.                                    18360027
183700     MOVE ZEROES TO CS-TOTL-TYPE-ALL                              18370020
183800                    CS-TOTL-TYPE-3                                18380020
183900                    CS-TOTL-PERCENT.                              18390020
184000     MOVE PV-ACCUM-ARRIVALS TO CS-TOTL-TYPE-ALL.                  18400026
184100     MOVE PV-ACCUM-TOTL     TO CS-TOTL-TYPE-3.                    18410026
184200     IF PV-ACCUM-ARRIVALS > ZEROES                                18420027
184300         COMPUTE PV-CALC-PCT = (PV-ACCUM-TOTL / PV-ACCUM-ARRIVALS)18430027
184400                             * 100                                18440027
184500     ELSE                                                         18450027
184600         MOVE ZEROES        TO PV-CALC-PCT                        18460027
184700     END-IF.                                                      18470027
184800     MOVE PV-CALC-PCT       TO PV-FORMAT-PCT                      18480027
184900     MOVE PV-FORMAT-PCT     TO CS-TOTL-PERCENT                    18490027
185000     WRITE OUTPUT-REC                                             18500015
185100       FROM TOTAL-LINE-1-CS                                       18510015
185200         AFTER ADVANCING 1 LINES.                                 18520015
185300                                                                  18530015
185400******************************************************************18540029
185500*  PRINT CARRIER SUMMARY PAGE HEADINGS                           *18550029
185600******************************************************************18560029
185700 3100-PRINT-SUMMARY-HDGS.                                         18570029
185800                                                                  18580029
185900     ADD 1 TO PV-PAGE-COUNT.                                      18590029
186000     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     18600029
186100                                                                  18610029
186200     WRITE OUTPUT-REC                                             18620029
186300       FROM DP132-STANDRD-HEADER-132-COLS                         18630029
186400         AFTER ADVANCING PAGE.                                    18640029
186500                                                                  18650029
186600     WRITE OUTPUT-REC                                             18660029
186700       FROM HEADING-LINE-1                                        18670029
186800         AFTER ADVANCING 2 LINES.                                 18680029
186900                                                                  18690029
187000     MOVE PV-DATE-START-MM   TO HL2-FROM-DATE-MM.                 18700029
187100     MOVE PV-DATE-START-DD   TO HL2-FROM-DATE-DD.                 18710029
187200     MOVE PV-DATE-START-CCYY TO HL2-FROM-DATE-YYYY.               18720029
187300     MOVE PV-DATE-END-MM     TO HL2-TO-DATE-MM.                   18730029
187400     MOVE PV-DATE-END-DD     TO HL2-TO-DATE-DD.                   18740029
187500     MOVE PV-DATE-END-CCYY   TO HL2-TO-DATE-YYYY.                 18750029
187600     WRITE OUTPUT-REC                                             18760029
187700       FROM HEADING-LINE-2                                        18770029
187800         AFTER ADVANCING 1 LINES.                                 18780029
187900                                                                  18790029
188000     WRITE OUTPUT-REC                                             18800029
188100       FROM HEADING-LINE-3-CS                                     18810029
188200         AFTER ADVANCING 2 LINES.                                 18820029
188300                                                                  18830029
188400*PRINT MISDIRECT TYPE DESCRIPTIONS.                               18840029
188500     MOVE '3' TO HL5-MISDIRECT-TYPE.                              18850029
188600     MOVE PC-MISDIRECT-DESC-3 TO HL5-MISDIRECT-DESC.              18860029
188700     WRITE OUTPUT-REC                                             18870029
188800       FROM HEADING-LINE-5                                        18880029
188900         AFTER ADVANCING 2 LINES.                                 18890029
189000                                                                  18900029
189100*PRINT CARRIER NAME/TYPE HEADINGS.                                18910029
189200     WRITE OUTPUT-REC                                             18920029
189300       FROM HEADING-LINE-4A-CS                                    18930033
189400         AFTER ADVANCING 3 LINES.                                 18940029
189500                                                                  18950029
189600     WRITE OUTPUT-REC                                             18960033
189700       FROM HEADING-LINE-4B-CS                                    18970033
189800         AFTER ADVANCING 1 LINES.                                 18980033
189900                                                                  18990033
190000     WRITE OUTPUT-REC                                             19000029
190100       FROM HEADING-LINE-5-CS                                     19010029
190200         AFTER ADVANCING 1 LINES.                                 19020029
190300                                                                  19030029
190400     WRITE OUTPUT-REC                                             19040029
190500       FROM BLANK-LINE                                            19050029
190600         AFTER ADVANCING 1 LINES.                                 19060029
190700                                                                  19070029
190800*SET PAGE LINE COUNT.                                             19080029
190900     MOVE 13 TO PV-LINE-COUNT.                                    19090029
191000                                                                  19100029
191100******************************************************************19110037
191200*  POPULATE SUMMARY ARRIVALS AND ACCUM ARRIVALS.                 *19120037
191300******************************************************************19130037
191400 3200-POPULATE-ARRIVALS-FIELDS.                                   19140037
191500                                                                  19150037
191600     SET CS-IDX TO 1.                                             19160038
191700                                                                  19170038
191800     SEARCH SUMMARY-TABLE                                         19180038
191900       VARYING CS-IDX                                             19190038
192000         AT END SET PS-END-OF-TABLE TO TRUE                       19200038
192100                                                                  19210038
192200         WHEN SUMMARY-CARRIER-4 (CS-IDX) = SU008-SCAC-CDE         19220038
192300             MOVE SU008-TOT-CHECKIN-SCAC                          19230038
192400                                   TO SUMMARY-ARRIVALS (CS-IDX)   19240038
192500             ADD  SU008-TOT-CHECKIN-SCAC                          19250038
192600                                   TO PV-ACCUM-ARRIVALS           19260038
192700                                                                  19270038
192800     END-SEARCH.                                                  19280038
192900                                                                  19290037
193000     PERFORM 0300-READ-CHECKIN.                                   19300043
193100                                                                  19310043
193200******************************************************************19320037
193300******************************************************************19330040
193400 9100-CALL-DATE-MODULE.                                           19340001
193500     MOVE '9100-CALL-DATE-MODULE   ' TO PV-ABEND-PARAGRAPH.       19350001
193600                                                                  19360001
193700     CALL DP500-KOHLS-CALENDAR-ROUTINE                            19370001
193800                           USING DPG51 DPG52 DPG53                19380001
193900                                 DPG54 DPG55 DPG56.               19390001
194000     EVALUATE TRUE                                                19400001
194100       WHEN DPG54-SEVERE-ERROR                                    19410001
194200           DISPLAY '** ABEND **'                                  19420001
194300           DISPLAY '** PGM = SUKRP022'                            19430007
194400           DISPLAY PV-ABEND-PARAGRAPH                             19440001
194500           DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '    19450001
194600           DISPLAY '** ERROR MESSAGE = '                          19460001
194700                   DPG54-ERROR-MESSAGE                            19470001
194800           DISPLAY '** DPG51 = ' DPG51                            19480001
194900           DISPLAY '** DPG52 = ' DPG52                            19490001
195000           DISPLAY '** DPG53 = ' DPG53                            19500001
195100           DISPLAY '** DPG54 = ' DPG54                            19510001
195200           MOVE +4003 TO PV-ABEND-CODE                            19520001
195300           CALL 'ILBOABN0' USING PV-ABEND-CODE                    19530001
195400       WHEN OTHER                                                 19540001
195500           CONTINUE                                               19550001
195600     END-EVALUATE.                                                19560001
195700                                                                  19570001
195800******************************************************************19580001
195900*  ABEND ROUTINE                                                 *19590001
196000******************************************************************19600001
196100 9900-DB2-ABEND.                                                  19610001
196200                                                                  19620001
196300     MOVE SQLCODE TO PV-SQLCODE.                                  19630001
196400     DISPLAY '*** DB2 ERROR '.                                    19640001
196500     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       19650001
196600     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 19660001
196700     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               19670001
196800     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               19680001
196900     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       19690001
197000     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       19700001
197100     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             19710001
197200                                                                  19720001
197300     COPY DPPD004.                                                19730001
197400                                                                  19740001
197500     MOVE +4013 TO PV-ABEND-CODE.                                 19750001
197600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         19760001
197700                                                                  19770001
197800******************************************************************19780001
197900******************************************************************19790001
