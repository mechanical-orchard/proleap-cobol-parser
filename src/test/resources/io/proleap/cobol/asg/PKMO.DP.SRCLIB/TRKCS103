00001 *-----------------------*                                         08/31/95
00002  IDENTIFICATION DIVISION.                                         TRKCS103
00003 *-----------------------*                                            LV001
00004  PROGRAM-ID.    TRKCS103.                                         TRKCS103
00005  AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     TRKCS103
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          TRKCS103
00007  DATE-WRITTEN.  08-16-95.                                         TRKCS103
00008  DATE-COMPILED.                                                   TRKCS103
00009                                                                   TRKCS103
00010                                                                   TRKCS103
00011 *---------------------------------------------------------------* TRKCS103
00012 *    Y103 - SHIPMENT SUMMARY BE ETA LIST.                       * TRKCS103
00013 *                                                               * TRKCS103
00014 *    THIS PROGRAM GENERATES A LIST OF SHIPMENT COUNTS BY ETA    * TRKCS103
00015 *    AND CARRIER.  COUNTS WILL INCLUDE THE NUMBER OF SHIPMENTS, * TRKCS103
00016 *    THE NUMBER OF PACKAGES WITHIN THOSE SHIPMENTS, AND THE     * TRKCS103
00017 *    TOTAL WEIGHT OF THOSE SHIPMENTS.                           * TRKCS103
00018 *                                                               * TRKCS103
00130 *  CHANGED 10/24/14 BY CHERI PARMLEY       CHG#0094517           *        
00140 *   COMPILE ONLY FOR CHANGED COPYBOOK TRWS001                    *        
00019 *---------------------------------------------------------------* TRKCS103
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697                 
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263697* MAKING THE CALL DYNAMIC VS STATIC.                                      
263697*---------------------------------------------------------------*         
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
00020                                                                   TRKCS103
00021  ENVIRONMENT DIVISION.                                            TRKCS103
00022                                                                   TRKCS103
00023  DATA DIVISION.                                                   TRKCS103
00024                                                                   TRKCS103
00025  WORKING-STORAGE SECTION.                                         TRKCS103
00026                                                                   TRKCS103
00027  01  DK-DB2-KEYS.                                                 TRKCS103
00028      05  DK-SCAC-CDE                    PIC X(04)    VALUE SPACES.TRKCS103
00029      05  DK-SCAC-CDE-IN                 PIC X(04)    VALUE SPACES.TRKCS103
00030      05  DK-OPER-UNT-ID                 PIC S9(04)   VALUE ZEROS  TRKCS103
00031                                                      COMP.        TRKCS103
00032      05  DK-FCLTY-ID                    PIC S9(04)   VALUE ZEROS  TRKCS103
00033                                                      COMP.        TRKCS103
00034      05  DK-ETA-DTE                     PIC X(26)    VALUE SPACES.TRKCS103
00035      05  DK-ETA-TO-DTE                  PIC X(26)    VALUE SPACES.TRKCS103
00036                                                                   TRKCS103
00037                                                                   TRKCS103
00038  01  PC-PROGRAM-CONSTANTS.                                        TRKCS103
00039      05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         TRKCS103
00040                                                     'TR103A  '.   TRKCS103
00041      05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         TRKCS103
00042                                                     'TRKM103 '.   TRKCS103
00043      05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         TRKCS103
00044                                                     'TRKCS103'.   TRKCS103
00045      05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      TRKCS103
00046      05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      TRKCS103
00047      05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      TRKCS103
00048      05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    TRKCS103
00049      05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    TRKCS103
00050      05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     TRKCS103
00051                                                     COMP SYNC.    TRKCS103
00052      05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      TRKCS103
00053                                                     COMP SYNC.    TRKCS103
00054      05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         TRKCS103
00055                                                     +1000000      TRKCS103
00056                                                     COMP-3.       TRKCS103
00057      05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      TRKCS103
00058                                                     COMP SYNC.    TRKCS103
00059      05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      TRKCS103
00060                                                      COMP-3.      TRKCS103
00061      05  PC-01                          PIC S9(04)  VALUE +1      TRKCS103
00062                                                     COMP SYNC.    TRKCS103
00063      05  PC-A                           PIC X(1)     VALUE 'A'.   TRKCS103
00064      05  PC-Y                           PIC X(1)     VALUE 'Y'.   TRKCS103
00065      05  PC-X-01                        PIC X(2)     VALUE '01'.  TRKCS103
00066      05  PC-49                          PIC X(2)     VALUE '49'.  TRKCS103
00067      05  PC-SLASH                       PIC X(1)     VALUE '/'.   TRKCS103
00068      05  PC-DASH                        PIC X(1)     VALUE '-'.   TRKCS103
00069      05  PC-DEFAULT-ETA-DTE-FROM        PIC X(26)    VALUE        TRKCS103
00070                                    '1800-01-01-00.00.00.000000'.  TRKCS103
00071      05  PC-DEFAULT-ETA-DTE-TO          PIC X(26)    VALUE        TRKCS103
00072                                    '9999-01-01-23.59.59.999999'.  TRKCS103
00073      05  PC-DEFAULT-TIME                PIC  X(16)  VALUE         TRKCS103
00074                                              '-00.00.00.000000'.  TRKCS103
00075      05  PC-DEFAULT-TO-TIME             PIC  X(16)  VALUE         TRKCS103
00076                                              '-23.59.59.999999'.  TRKCS103
00077                                                                   TRKCS103
00078  01  PC-TSYMSG-NUMBERS.                                           TRKCS103
00079      05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  TRKCS103
00080      05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  TRKCS103
00081      05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  TRKCS103
00082      05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  TRKCS103
00083      05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  TRKCS103
00084      05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  TRKCS103
00085      05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  TRKCS103
00086      05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  TRKCS103
00087      05  PC-TSYMSG-00752                PIC 9(5)    VALUE 00752.  TRKCS103
00088                                                                   TRKCS103
00089  01  PS-PROGRAM-SUBSCRIPTS.                                       TRKCS103
00090      05  PS-SUB                         PIC S9(04)   VALUE +0     TRKCS103
00091                                                      COMP SYNC.   TRKCS103
00092                                                                   TRKCS103
00093  01  PS-PROGRAM-SWITCHES.                                         TRKCS103
00094      05  PS-FIRST-TIME-SW               PIC X(01)    VALUE 'Y'.   TRKCS103
00095          88  PS-FIRST-TIME                           VALUE 'Y'.   TRKCS103
00096          88  PS-NOT-FIRST-TIME                       VALUE 'N'.   TRKCS103
00097      05  PS-RECORD-TO-PROCESS-SW        PIC X(01)    VALUE 'N'.   TRKCS103
00098          88  PS-RECORD-TO-PROCESS                    VALUE 'Y'.   TRKCS103
00099          88  PS-NO-RECORD-TO-PROCESS                 VALUE 'N'.   TRKCS103
00100      05  PS-ITEMS-LEFT-INDICATOR        PIC  X(01).               TRKCS103
00101          88  PS-ITEMS-LEFT-ON-DB                     VALUE 'Y'.   TRKCS103
00102          88  PS-NO-ITEMS-LEFT-ON-DB                  VALUE 'N'.   TRKCS103
00103      05  PS-CURSOR-SCAC-SW              PIC X(01)    VALUE 'N'.   TRKCS103
00104          88  PS-CURSOR-WITH-SCAC                     VALUE 'Y'.   TRKCS103
00105          88  PS-CURSOR-WITHOUT-SCAC                  VALUE 'N'.   TRKCS103
00106                                                                   TRKCS103
00107  01  PS-PROGRAM-SWITCHES.                                         TRKCS103
00108      05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   TRKCS103
00109          88  PS-NO-ERROR                             VALUE 'Y'.   TRKCS103
00110          88  PS-ERROR                                VALUE 'N'.   TRKCS103
00111      05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   TRKCS103
00112          88  PS-COMMAREA-VALID                       VALUE 'Y'.   TRKCS103
00113          88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   TRKCS103
00114      05  PS-LIST-END-SW                 PIC X(01)    VALUE 'N'.   TRKCS103
00115          88  PS-LIST-END                             VALUE 'Y'.   TRKCS103
00116          88  PS-NO-LIST-END                          VALUE 'N'.   TRKCS103
00117      EJECT                                                        TRKCS103
00118  01  PV-PROGRAM-VARIABLES.                                        TRKCS103
00119      05  PV-REMAINDER                   PIC S9(04)   VALUE +0     TRKCS103
00120                                                      COMP SYNC.   TRKCS103
00121      05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     TRKCS103
00122                                                      COMP-3.      TRKCS103
00123      05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     TRKCS103
00124                                                      COMP-3.      TRKCS103
00125      05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     TRKCS103
00126                                                      COMP-3.      TRKCS103
00127      05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     TRKCS103
00128                                                      COMP SYNC.   TRKCS103
00129      05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     TRKCS103
00130                                                      COMP SYNC.   TRKCS103
00131      05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     TRKCS103
00132                                                      COMP SYNC.   TRKCS103
00133      05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     TRKCS103
00134                                                      COMP SYNC.   TRKCS103
00135      05  PV-SQL-SUB                     PIC S9(4)    COMP.        TRKCS103
00136      05  PV-PREV-SHIPT-ID               PIC S9(9)    VALUE +0     TRKCS103
00137                                                      COMP.        TRKCS103
00138      05  PV-PREV-SCAC-CDE               PIC X(04)    VALUE SPACES.TRKCS103
00139      05  PV-PREV-VEND-NAME              PIC X(20)    VALUE SPACES.TRKCS103
00140      05  PV-PREV-PKG-TYP-CDE            PIC X(03)    VALUE SPACES.TRKCS103
00141      05  PV-SHIPMENTS                   PIC S9(5)    VALUE +0     TRKCS103
00142                                                      COMP-3.      TRKCS103
00143      05  PV-EXPTED-GRO-WGHT             PIC S9(7)    VALUE +0     TRKCS103
00144                                                      COMP-3.      TRKCS103
00145      05  PV-EXPTED-PKG-QTY              PIC S9(7)    VALUE +0     TRKCS103
00146                                                      COMP-3.      TRKCS103
00147  01  PV-DB2-CRITERIA-AREA.                                        TRKCS103
00148      15  PV-DB2-MESSAGE-NUMBER          PIC S9(05)  VALUE ZERO    TRKCS103
00149                                                     COMP-3.       TRKCS103
00150                                                                   TRKCS103
00151  EJECT                                                            TRKCS103
00152 *---------------------------------------------------------------* TRKCS103
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * TRKCS103
00154 *---------------------------------------------------------------* TRKCS103
00155                                                                   TRKCS103
00156      COPY DPWS030.                                                TRKCS103
CICS       COPY DPWS930.                                                TRKCS103
00157  EJECT                                                            TRKCS103
00158 *---------------------------------------------------------------* TRKCS103
00159 *    STANDARD COMMAREA.                                         * TRKCS103
00160 *---------------------------------------------------------------* TRKCS103
00161                                                                   TRKCS103
00162      COPY DPWS020.                                                TRKCS103
00163      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                TRKCS103
00164                                                                   TRKCS103
00165 *---------------------------------------------------------------* TRKCS103
00166 *    INTER-APPLICATION COMMAREA.                                * TRKCS103
00167 *---------------------------------------------------------------* TRKCS103
00168                                                                   TRKCS103
00169          10  INTER-APPL-COMM-AREA       PIC X(200).               TRKCS103
00170      COPY TRWS001.                                                TRKCS103
00171 *---------------------------------------------------------------* TRKCS103
00172 *    SPECIFIC COMMMAREA FOR TRKCS103.                           * TRKCS103
00173 *---------------------------------------------------------------* TRKCS103
00174          10  ASC-SPECIFIC-COMMAREA.                               TRKCS103
00175              15  ASC-LIST-KEYS.                                   TRKCS103
00176                  20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   TRKCS103
00177                                                      COMP.        TRKCS103
00178                  20  ASC-KEY-FCLTY-ID                PIC S9(04)   TRKCS103
00179                                                      COMP.        TRKCS103
00180                  20  ASC-KEY-FCLTY-ID-NME            PIC X(20).   TRKCS103
00181                  20  ASC-KEY-ETA-DTE.                             TRKCS103
00182                      25  ASC-KEY-ETA-MM              PIC X(02).   TRKCS103
00183                      25  ASC-KEY-ETA-SLASH-1         PIC X(01).   TRKCS103
00184                      25  ASC-KEY-ETA-DD              PIC X(02).   TRKCS103
00185                      25  ASC-KEY-ETA-SLASH-2         PIC X(01).   TRKCS103
00186                      25  ASC-KEY-ETA-CCYY            PIC X(04).   TRKCS103
00187                  20  ASC-KEY-ETA-TO-DTE.                          TRKCS103
00188                      25  ASC-KEY-ETA-TO-MM           PIC X(02).   TRKCS103
00189                      25  ASC-KEY-ETA-TO-SLASH-1      PIC X(01).   TRKCS103
00190                      25  ASC-KEY-ETA-TO-DD           PIC X(02).   TRKCS103
00191                      25  ASC-KEY-ETA-TO-SLASH-2      PIC X(01).   TRKCS103
00192                      25  ASC-KEY-ETA-TO-CCYY         PIC X(04).   TRKCS103
00193                  20  ASC-KEY-PRO-SCAC-ID             PIC X(04).   TRKCS103
00194              15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                TRKCS103
00195                  20  ASC-ITEM-ARRAY.                              TRKCS103
00196                                                                   TRKCS103
00197                      25  ASC-ITEM-ENTRIES OCCURS 18 TIMES.        TRKCS103
00198                          30  ASC-LIST-ITEM-NUMBER    PIC S9(09)   TRKCS103
00199                                                      COMP-3.      TRKCS103
00200                          30  ASC-SCAC                PIC X(04).   TRKCS103
00201                          30  ASC-NAME                PIC X(20).   TRKCS103
00202                          30  ASC-SHIPMENTS           PIC S9(5)    TRKCS103
00203                                                          COMP-3.  TRKCS103
00204                          30  ASC-QUANTITY            PIC S9(7)    TRKCS103
00205                                                          COMP-3.  TRKCS103
00206                          30  ASC-PACKAGE             PIC X(03).   TRKCS103
00207                          30  ASC-WEIGHT              PIC S9(7)    TRKCS103
00208                                                          COMP-3.  TRKCS103
00209                                                                   TRKCS103
00210              15  ASC-BLK-SUB                         PIC S9(04)   TRKCS103
00211                                                          COMP     TRKCS103
00212                                                          SYNC.    TRKCS103
00213              15  ASC-ITEM-SUB                        PIC S9(04)   TRKCS103
00214                                                          COMP     TRKCS103
00215                                                          SYNC.    TRKCS103
00216              15  ASC-SEL-SUB                         PIC S9(04)   TRKCS103
00217                                                          COMP.    TRKCS103
00218              15  ASC-SEL-ITEM                        PIC S9(04)   TRKCS103
00219                                                          COMP.    TRKCS103
00220              15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   TRKCS103
00221                                                          COMP-3.  TRKCS103
00222              15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   TRKCS103
00223                                                          COMP-3.  TRKCS103
00224              15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   TRKCS103
00225                                                          COMP-3.  TRKCS103
00226              15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   TRKCS103
00227                                                          COMP-3.  TRKCS103
00228              15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   TRKCS103
00229                                                          COMP-3.  TRKCS103
00230              15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   TRKCS103
00231                                                          COMP-3.  TRKCS103
00232              15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   TRKCS103
00233                                                          COMP     TRKCS103
00234                                                          SYNC.    TRKCS103
00235              15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   TRKCS103
00236                                                          COMP-3.  TRKCS103
00237              15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   TRKCS103
00238                                                          COMP-3.  TRKCS103
00239              15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  TRKCS103
00240                  88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. TRKCS103
00241                  88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. TRKCS103
00242              15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  TRKCS103
00243                  88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. TRKCS103
00244              15  ASC-LIST-QUEUE-NAME.                             TRKCS103
00245                  20  ASC-LIST-TERM-ID                PIC  X(04).  TRKCS103
00246                  20  ASC-LIST-TASK-NUMBER            PIC S9(05)   TRKCS103
00247                                                          COMP-3.  TRKCS103
00248                  20  ASC-LIST-SEQ                    PIC  9(01).  TRKCS103
00249              15  ASC-SEL-QUEUE-NAME.                              TRKCS103
00250                  20  ASC-SEL-TERM-ID                 PIC  X(04).  TRKCS103
00251                  20  ASC-SEL-TASK-NUMBER             PIC S9(05)   TRKCS103
00252                                                           COMP-3. TRKCS103
00253                  20  ASC-SEL-SEQ                     PIC  9(01).  TRKCS103
00254              15  ASC-DTL-QUEUE-NAME.                              TRKCS103
00255                  20  ASC-DTL-TERM-ID                 PIC  X(04).  TRKCS103
00256                  20  ASC-DTL-TASK-NUMBER             PIC S9(05)   TRKCS103
00257                                                          COMP-3.  TRKCS103
00258                  20  ASC-DTL-SEQ                     PIC  9(01).  TRKCS103
00259                                                                   TRKCS103
00260              15  ASC-START-ITEM-REQUEST.                          TRKCS103
00261                  20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  TRKCS103
00262              15  ASC-DB2-CURRENT-DATE.                            TRKCS103
00263                  20  ASC-DC-CC                       PIC XX.      TRKCS103
00264                  20  ASC-DC-YY                       PIC XX.      TRKCS103
00265                  20  FILLER                          PIC X.       TRKCS103
00266                      88  ASC-DC-SLASH1               VALUE '-'.   TRKCS103
00267                  20  ASC-DC-MM                       PIC XX.      TRKCS103
00268                  20  FILLER                          PIC X.       TRKCS103
00269                      88  ASC-DC-SLASH2               VALUE '-'.   TRKCS103
00270                  20  ASC-DC-DD                       PIC XX.      TRKCS103
00271              15  ASC-LAST-ITEM-NUMBER                PIC S9(15)   TRKCS103
00272                                                      COMP-3.      TRKCS103
00273                                                                   TRKCS103
00274              15  ASC-DB2-ETA-DTE                     PIC X(26).   TRKCS103
00275              15  ASC-DB2-FORMAT-ETA-DTE REDEFINES                 TRKCS103
00276                  ASC-DB2-ETA-DTE.                                 TRKCS103
00277                  20  ASC-DB2-ETA-CCYY                PIC X(04).   TRKCS103
00278                  20  ASC-DB2-ETA-DASH-1              PIC X(01).   TRKCS103
00279                  20  ASC-DB2-ETA-MM                  PIC X(02).   TRKCS103
00280                  20  ASC-DB2-ETA-DASH-2              PIC X(01).   TRKCS103
00281                  20  ASC-DB2-ETA-DD                  PIC X(02).   TRKCS103
00282                  20  ASC-DB2-ETA-TIME                PIC X(16).   TRKCS103
00283              15  ASC-DB2-ETA-TO-DTE                  PIC X(26).   TRKCS103
00284              15  ASC-DB2-FORMAT-ETA-TO-DTE REDEFINES              TRKCS103
00285                  ASC-DB2-ETA-TO-DTE.                              TRKCS103
00286                  20  ASC-DB2-ETA-TO-CCYY             PIC X(04).   TRKCS103
00287                  20  ASC-DB2-ETA-TO-DASH-1           PIC X(01).   TRKCS103
00288                  20  ASC-DB2-ETA-TO-MM               PIC X(02).   TRKCS103
00289                  20  ASC-DB2-ETA-TO-DASH-2           PIC X(01).   TRKCS103
00290                  20  ASC-DB2-ETA-TO-DD               PIC X(02).   TRKCS103
00291                  20  ASC-DB2-ETA-TO-TIME             PIC X(16).   TRKCS103
00292                                                                   TRKCS103
00293      EJECT                                                        TRKCS103
00294 *---------------------------------------------------------------* TRKCS103
00295 *    MESSAGE SELECTION TSQ B QUEUE RECORD LAYOUT.               * TRKCS103
00296 *---------------------------------------------------------------* TRKCS103
00297                                                                   TRKCS103
00298      COPY DPWS057.                                                TRKCS103
00299                                                                   TRKCS103
00300      EJECT                                                        TRKCS103
00301 *---------------------------------------------------------------* TRKCS103
00302 *    ABEND PROCESSING COPYBOOK.                                 * TRKCS103
00303 *---------------------------------------------------------------* TRKCS103
00304                                                                   TRKCS103
00305      COPY DPWS013.                                                TRKCS103
00306                                                                   TRKCS103
00307      EJECT                                                        TRKCS103
00308 *---------------------------------------------------------------* TRKCS103
00309 *    ATTRIBUTE SETTINGS COPYBOOK.                               * TRKCS103
00310 *---------------------------------------------------------------* TRKCS103
00311                                                                   TRKCS103
00312      COPY DPWS015.                                                TRKCS103
00313                                                                   TRKCS103
00314 *---------------------------------------------------------------* TRKCS103
00315 *    FUNCTION KEYS COPYBOOK.                                    * TRKCS103
00316 *---------------------------------------------------------------* TRKCS103
00317                                                                   TRKCS103
00318      COPY DPWS016.                                                TRKCS103
00319                                                                   TRKCS103
00320 *---------------------------------------------------------------* TRKCS103
00321 *    NUMERIC EDIT LAYOUT.                                       * TRKCS103
00322 *---------------------------------------------------------------* TRKCS103
00323                                                                   TRKCS103
00324      COPY DPWS010I.                                               TRKCS103
00325                                                                   TRKCS103
00326 *---------------------------------------------------------------* TRKCS103
00327 *    MAP LAYOUT                                                 * TRKCS103
00328 *---------------------------------------------------------------* TRKCS103
00329                                                                   TRKCS103
00330      COPY TRKM103.                                                TRKCS103
00331                                                                   TRKCS103
00332  01  MR-OCCURS-LAYOUT          REDEFINES  TR103AO.                TRKCS103
00333      05  FILLER                PIC X(204).                        TRKCS103
00334      05  MR-SCROLL-AREA OCCURS 13 TIMES.                          TRKCS103
00335          10  MR-SCACL          PIC S9(04) COMP.                   TRKCS103
00336          10  MR-SCACA          PIC  X(01).                        TRKCS103
00337          10  MR-SCACC          PIC  X(01).                        TRKCS103
00338          10  MR-SCACH          PIC  X(01).                        TRKCS103
00339          10  MR-SCAC           PIC  X(04).                        TRKCS103
00340                                                                   TRKCS103
00341          10  MR-NAMEL          PIC S9(04) COMP.                   TRKCS103
00342          10  MR-NAMEA          PIC  X(01).                        TRKCS103
00343          10  MR-NAMEC          PIC  X(01).                        TRKCS103
00344          10  MR-NAMEH          PIC  X(01).                        TRKCS103
00345          10  MR-NAME           PIC  X(20).                        TRKCS103
00346                                                                   TRKCS103
00347          10  MR-SHIPTL         PIC S9(04) COMP.                   TRKCS103
00348          10  MR-SHIPTA         PIC  X(01).                        TRKCS103
00349          10  MR-SHIPTC         PIC  X(01).                        TRKCS103
00350          10  MR-SHIPTH         PIC  X(01).                        TRKCS103
00351          10  MR-SHIPTX.                                           TRKCS103
00352              15  MR-SHIPT      PIC  Z,ZZ9.                        TRKCS103
00353                                                                   TRKCS103
00354          10  MR-QTYL           PIC S9(04) COMP.                   TRKCS103
00355          10  MR-QTYA           PIC  X(01).                        TRKCS103
00356          10  MR-QTYC           PIC  X(01).                        TRKCS103
00357          10  MR-QTYH           PIC  X(01).                        TRKCS103
00358          10  MR-QTYX.                                             TRKCS103
00359              15  MR-QTY        PIC  ZZZ,ZZ9.                      TRKCS103
00360                                                                   TRKCS103
00361          10  MR-PKGL           PIC S9(04) COMP.                   TRKCS103
00362          10  MR-PKGA           PIC  X(01).                        TRKCS103
00363          10  MR-PKGC           PIC  X(01).                        TRKCS103
00364          10  MR-PKGH           PIC  X(01).                        TRKCS103
00365          10  MR-PKG            PIC  X(03).                        TRKCS103
00366                                                                   TRKCS103
00367          10  MR-WEIGHTL        PIC S9(04) COMP.                   TRKCS103
00368          10  MR-WEIGHTA        PIC  X(01).                        TRKCS103
00369          10  MR-WEIGHTC        PIC  X(01).                        TRKCS103
00370          10  MR-WEIGHTH        PIC  X(01).                        TRKCS103
00371          10  MR-WEIGHTX.                                          TRKCS103
00372              15  MR-WEIGHT     PIC  ZZZ,ZZ9.                      TRKCS103
00373                                                                   TRKCS103
00374                                                                   TRKCS103
00375                                                                   TRKCS103
00376  EJECT                                                            TRKCS103
00377 *---------------------------------------------------------------* TRKCS103
00378 *    DB2 AREA FOR SHIPMENT TABLE                                * TRKCS103
00379 *---------------------------------------------------------------* TRKCS103
00380      EXEC SQL                                                     TRKCS103
00381           INCLUDE TSHIPMT                                         TRKCS103
00382      END-EXEC.                                                    TRKCS103
00383                                                                   TRKCS103
00384 *---------------------------------------------------------------* TRKCS103
00385 *    DB2 AREA FOR SHIPMENT STATUS TABLE                         * TRKCS103
00386 *---------------------------------------------------------------* TRKCS103
00387      EXEC SQL                                                     TRKCS103
00388           INCLUDE TSHIPST                                         TRKCS103
00389      END-EXEC.                                                    TRKCS103
00390                                                                   TRKCS103
00391 *---------------------------------------------------------------* TRKCS103
00392 *    DB2 AREA FOR STATUS TYPE TABLE                             * TRKCS103
00393 *---------------------------------------------------------------* TRKCS103
00394      EXEC SQL                                                     TRKCS103
00395           INCLUDE TSHSTYP                                         TRKCS103
00396      END-EXEC.                                                    TRKCS103
00397 *---------------------------------------------------------------* TRKCS103
00398 *    DB2 AREA FOR TRIP STATUS TABLE                             * TRKCS103
00399 *---------------------------------------------------------------* TRKCS103
00400      EXEC SQL                                                     TRKCS103
00401           INCLUDE TTRIPST                                         TRKCS103
00402      END-EXEC.                                                    TRKCS103
00403                                                                   TRKCS103
00404 *---------------------------------------------------------------* TRKCS103
00405 *    DB2 AREA FOR EXTERNAL ENTERPRISE TABLE                     * TRKCS103
00406 *---------------------------------------------------------------* TRKCS103
00407      EXEC SQL                                                     TRKCS103
00408           INCLUDE TEXTENT                                         TRKCS103
00409      END-EXEC.                                                    TRKCS103
00410                                                                   TRKCS103
00411 *---------------------------------------------------------------* TRKCS103
00412 *    DB2 AREA FOR EXTERNAL ENTERPRISE NAME TABLE                * TRKCS103
00413 *---------------------------------------------------------------* TRKCS103
00414      EXEC SQL                                                     TRKCS103
00415           INCLUDE TENTNME                                         TRKCS103
00416      END-EXEC.                                                    TRKCS103
00417                                                                   TRKCS103
00418 *---------------------------------------------------------------* TRKCS103
00419 *    DB2 AREA FOR COMMUNICATIONS                                * TRKCS103
00420 *---------------------------------------------------------------* TRKCS103
00421      EXEC SQL                                                     TRKCS103
00422           INCLUDE SQLCA                                           TRKCS103
00423      END-EXEC.                                                    TRKCS103
00424                                                                   TRKCS103
00425 *---------------------------------------------------------------* TRKCS103
00426 *    CURSOR FOR THE LIST WHEN NO SCAC SPECIFIED.                * TRKCS103
00427 *---------------------------------------------------------------* TRKCS103
00428      EXEC SQL                                                     TRKCS103
00429           DECLARE  ENT-CSR CURSOR FOR                             TRKCS103
00430            SELECT  A.SCAC_CDE,                                    TRKCS103
00431                    B.ENT_NAME_DESC                                TRKCS103
00432              FROM  TEXTENT A,                                     TRKCS103
00433                    TENTNME B                                      TRKCS103
00434             WHERE  A.ENT_ID           = B.ENT_ID                  TRKCS103
00435               AND  A.CARRIER_IND      = :PC-Y                     TRKCS103
00436               AND  A.STATUS_CDE       = :PC-A                     TRKCS103
00437               AND  B.TYPE_CDE         = :PC-X-01                  TRKCS103
00438          ORDER BY  A.SCAC_CDE                                     TRKCS103
00439      END-EXEC.                                                    TRKCS103
00440                                                                   TRKCS103
00441      EXEC SQL                                                     TRKCS103
00442           DECLARE  ENT-SCAC-CSR CURSOR FOR                        TRKCS103
00443            SELECT  A.SCAC_CDE,                                    TRKCS103
00444                    B.ENT_NAME_DESC                                TRKCS103
00445              FROM  TEXTENT A,                                     TRKCS103
00446                    TENTNME B                                      TRKCS103
00447             WHERE  A.ENT_ID           = B.ENT_ID                  TRKCS103
00448               AND  A.CARRIER_IND      = :PC-Y                     TRKCS103
00449               AND  A.STATUS_CDE       = :PC-A                     TRKCS103
00450               AND  B.TYPE_CDE         = :PC-X-01                  TRKCS103
00451               AND  A.SCAC_CDE         = :DK-SCAC-CDE-IN           TRKCS103
00452          ORDER BY  A.SCAC_CDE                                     TRKCS103
00453      END-EXEC.                                                    TRKCS103
00454                                                                   TRKCS103
00455 *---------------------------------------------------------------* TRKCS103
00456 *    CURSOR FOR THE LIST WHEN NO SCAC SPECIFIED.                * TRKCS103
00457 *---------------------------------------------------------------* TRKCS103
00458      EXEC SQL                                                     TRKCS103
00459           DECLARE  LIST-CSR CURSOR FOR                            TRKCS103
00460            SELECT  A.PKG_TYP_CDE,                                 TRKCS103
00461                    COUNT(*),                                      TRKCS103
00462                    SUM (A.EXPTED_GRO_WGHT),                       TRKCS103
00463                    SUM (A.EXPTED_PKG_QTY)                         TRKCS103
00464              FROM  TSHIPMT A,                                     TRKCS103
00465                    TSHIPST B,                                     TRKCS103
00466                    TTRIPST C,                                     TRKCS103
00467                    TSHSTYP D                                      TRKCS103
00468             WHERE  C.OPER_UNT_ID      = :DK-OPER-UNT-ID           TRKCS103
00469               AND  C.FCLTY_ID         = :DK-FCLTY-ID              TRKCS103
00470               AND  A.SHIPT_ID         = B.SHIPT_ID                TRKCS103
00471               AND  A.TRIP_ID          = C.TRIP_ID                 TRKCS103
00472               AND  A.PRO_SCAC_ID      = :DK-SCAC-CDE              TRKCS103
00473               AND (A.EST_AR_TMST BETWEEN                          TRKCS103
00474                    :DK-ETA-DTE AND                                TRKCS103
00475                    :DK-ETA-TO-DTE)                                TRKCS103
00476              AND  D.PRTY_CDE < :PC-49                             TRKCS103
00477              AND  B.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE         TRKCS103
00478              AND  D.PRTY_CDE =                                    TRKCS103
00479                   (SELECT MAX(F.PRTY_CDE)                         TRKCS103
00480                      FROM TSHIPST E                               TRKCS103
00481                          ,TSHSTYP F                               TRKCS103
00482                     WHERE E.SHIPT_ID      = A.SHIPT_ID            TRKCS103
00483                     AND E.SHIPT_STATUS_CDE = F.SHIPT_STATUS_CDE)  TRKCS103
00484             GROUP BY A.PKG_TYP_CDE                                TRKCS103
00485      END-EXEC.                                                    TRKCS103
00486                                                                   TRKCS103
00487  EJECT                                                            TRKCS103
00488  LINKAGE SECTION.                                                 TRKCS103
00489                                                                   TRKCS103
00490  01  DFHCOMMAREA.                                                 TRKCS103
00491      05  FILLER                         OCCURS  1 TO 4072 TIMES   TRKCS103
00492                                         DEPENDING ON EIBCALEN.    TRKCS103
00493          10  FILLER                     PIC X.                    TRKCS103
00494                                                                   TRKCS103
00495  EJECT                                                            TRKCS103
00496  PROCEDURE DIVISION.                                              TRKCS103
00497                                                                   TRKCS103
00498  0000-MAIN-MODULE.                                                TRKCS103
00499                                                                   TRKCS103
00500      INITIALIZE DP030-CICS-API-FIELDS.                            TRKCS103
00501      MOVE +1                      TO DP030-NUMBER-OF-MAPS.        TRKCS103
00502      MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           TRKCS103
00503      MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          TRKCS103
00504      SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        TRKCS103
00505      MOVE LENGTH OF TR103AI       TO DP030-MAP-LENGTH (1).        TRKCS103
00506      MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      TRKCS103
00507      PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS103
00508                                                                   TRKCS103
00509      PERFORM 1000-CONTROL-PROCESSING.                             TRKCS103
00510                                                                   TRKCS103
00511      MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      TRKCS103
00512      PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS103
00513                                                                   TRKCS103
00514 *----------------------------------------------------------------*TRKCS103
00515 *   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *TRKCS103
00516 *   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *TRKCS103
00517 *----------------------------------------------------------------*TRKCS103
00518                                                                   TRKCS103
00519  0001-CALL-CICS-ARCH-API.                                         TRKCS103
00520                                                                   TRKCS103
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
00522                                     DFHCOMMAREA                           
00523                                     DP030-CICS-API-FIELDS                 
00524                                     DP020-STANDARD-COMMAREA               
00525                                     TR103AI.                              
00526                                                                   TRKCS103
00527      IF  DP030-RC-CALL-SUCCESSFUL                                 TRKCS103
00528          CONTINUE                                                 TRKCS103
00529      ELSE                                                         TRKCS103
00530          SET DP013-NO-ROLLBACK TO TRUE                            TRKCS103
00531          SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   TRKCS103
00532          SET DP013-CICS-ABEND TO TRUE                             TRKCS103
00533          MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        TRKCS103
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
00536          MOVE DP030-RETURN-CODE                                   TRKCS103
00537                                TO DP013-MESSAGE-TEXT (3)          TRKCS103
00538          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
00539      END-IF.                                                      TRKCS103
00540                                                                   TRKCS103
00541 *----------------------------------------------------------------*TRKCS103
00542 * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *TRKCS103
00543 * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *TRKCS103
00544 *                                                                *TRKCS103
00545 * NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *TRKCS103
00546 *  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *TRKCS103
00547 *  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *TRKCS103
00548 *  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *TRKCS103
00549 *----------------------------------------------------------------*TRKCS103
00550                                                                   TRKCS103
00551  1000-CONTROL-PROCESSING.                                         TRKCS103
00552                                                                   TRKCS103
00553      EVALUATE TRUE                                                TRKCS103
00554          WHEN DP020-NEXT-ACT-INITIAL                              TRKCS103
00555              PERFORM 1100-PROCESS-INTER-APPL-COMM                 TRKCS103
00556 ***-----$TEMPLATE NOTE$-------------------------------------------TRKCS103
00557 *** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,TRKCS103
00558 *** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  TRKCS103
00559 *** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.TRKCS103
00560 ***---------------------------------------------------------------TRKCS103
00561              IF  PS-COMMAREA-NOT-VALID                            TRKCS103
00562                  CONTINUE                                         TRKCS103
00563              ELSE                                                 TRKCS103
00564                  PERFORM 2050-DELETE-DETAIL-QUEUE                 TRKCS103
00565                  PERFORM 4000-BUILD-INITIAL-PANEL                 TRKCS103
00566              END-IF                                               TRKCS103
00567                                                                   TRKCS103
00568          WHEN DP020-NEXT-ACT-READ-MAP                             TRKCS103
00569              MOVE ASC-ITEM-AT-TOP-OF-PANEL                        TRKCS103
00570                                TO PV-TOP-ITEM                     TRKCS103
00571              PERFORM 2000-PROCESS-PANEL                           TRKCS103
00572                                                                   TRKCS103
00573          WHEN DP020-NEXT-ACT-RETURN                               TRKCS103
00574              MOVE ASC-ITEM-AT-TOP-OF-PANEL                        TRKCS103
00575                                TO PV-TOP-ITEM                     TRKCS103
00576              MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        TRKCS103
00577              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS103
00578                                                                   TRKCS103
00579          WHEN OTHER                                               TRKCS103
00580              SET DP013-LOGIC-ABEND TO TRUE                        TRKCS103
00581              SET DP013-NO-ROLLBACK TO TRUE                        TRKCS103
00582              MOVE '1000-CONTROL-PROCESSING'                       TRKCS103
00583                                TO  DP013-PARAGRAPH                TRKCS103
00584              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    TRKCS103
00585                                TO  DP013-MESSAGE-TEXT(1)          TRKCS103
00586              PERFORM DP013-0000-PROCESS-ABEND                     TRKCS103
00587      END-EVALUATE.                                                TRKCS103
00588                                                                   TRKCS103
00589  EJECT                                                            TRKCS103
00590 *----------------------------------------------------------------*TRKCS103
00591 * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *TRKCS103
00592 * IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *TRKCS103
00593 *----------------------------------------------------------------*TRKCS103
00594                                                                   TRKCS103
00595  1100-PROCESS-INTER-APPL-COMM.                                    TRKCS103
00596                                                                   TRKCS103
00597      SET PS-COMMAREA-VALID     TO TRUE.                           TRKCS103
00598      INITIALIZE ASC-SPECIFIC-COMMAREA.                            TRKCS103
00599      MOVE EIBTRMID             TO ASC-DTL-TERM-ID.                TRKCS103
00600      MOVE DP020-SRC-TASK-NUMBER                                   TRKCS103
00601                                TO ASC-DTL-TASK-NUMBER.            TRKCS103
00602      MOVE PC-DTL-QUEUE-SEQ     TO ASC-DTL-SEQ.                    TRKCS103
00603      MOVE SPACE                TO ASC-START-ITEM-REQUEST.         TRKCS103
00604      IF (TR001-ETA-DTE    = SPACES OR LOW-VALUES) OR              TRKCS103
00605         (TR001-ETA-TO-DTE = SPACES OR LOW-VALUES)                 TRKCS103
00606          SET DP020-NEXT-ACT-APPL-ERROR                            TRKCS103
00607              PS-COMMAREA-NOT-VALID                                TRKCS103
00608              DP020-MSG-FATAL                                      TRKCS103
00609              DP020-SRC-RETURN-W-O-TRAN-ID TO TRUE                 TRKCS103
00610          MOVE PC-TSYMSG-00752                                     TRKCS103
00611                         TO DP020-MSG-NUMBER                       TRKCS103
00612      ELSE                                                         TRKCS103
00613          MOVE TR001-OPER-UNT-ID-N    TO ASC-KEY-OPER-UNT-ID       TRKCS103
00614                                         DK-OPER-UNT-ID            TRKCS103
00615                                                                   TRKCS103
00616          IF TR001-FCLTY-ID-N > 0                                  TRKCS103
00617              MOVE TR001-FCLTY-ID-N   TO DK-FCLTY-ID               TRKCS103
00618                                         ASC-KEY-FCLTY-ID          TRKCS103
00619          ELSE                                                     TRKCS103
00620              MOVE PC-01              TO DK-FCLTY-ID               TRKCS103
00621                                         ASC-KEY-FCLTY-ID          TRKCS103
00622          END-IF                                                   TRKCS103
00623                                                                   TRKCS103
00624          MOVE TR001-FCLTY-NME        TO ASC-KEY-FCLTY-ID-NME      TRKCS103
00625                                                                   TRKCS103
00626          MOVE TR001-ETA-MM       TO ASC-KEY-ETA-MM                TRKCS103
00627                                     ASC-DB2-ETA-MM                TRKCS103
00628          MOVE TR001-ETA-DD       TO ASC-KEY-ETA-DD                TRKCS103
00629                                     ASC-DB2-ETA-DD                TRKCS103
00630          MOVE TR001-ETA-CCYY     TO ASC-KEY-ETA-CCYY              TRKCS103
00631                                     ASC-DB2-ETA-CCYY              TRKCS103
00632          MOVE TR001-ETA-TO-MM    TO ASC-KEY-ETA-TO-MM             TRKCS103
00633                                     ASC-DB2-ETA-TO-MM             TRKCS103
00634          MOVE TR001-ETA-TO-DD    TO ASC-KEY-ETA-TO-DD             TRKCS103
00635                                     ASC-DB2-ETA-TO-DD             TRKCS103
00636          MOVE TR001-ETA-TO-CCYY  TO ASC-KEY-ETA-TO-CCYY           TRKCS103
00637                                     ASC-DB2-ETA-TO-CCYY           TRKCS103
00638          MOVE PC-DEFAULT-TIME    TO ASC-DB2-ETA-TIME              TRKCS103
00639          MOVE PC-DEFAULT-TO-TIME TO ASC-DB2-ETA-TO-TIME           TRKCS103
00640          MOVE PC-SLASH           TO ASC-KEY-ETA-SLASH-1           TRKCS103
00641                                     ASC-KEY-ETA-SLASH-2           TRKCS103
00642                                     ASC-KEY-ETA-TO-SLASH-1        TRKCS103
00643                                     ASC-KEY-ETA-TO-SLASH-2        TRKCS103
00644          MOVE PC-DASH            TO ASC-DB2-ETA-DASH-1            TRKCS103
00645                                     ASC-DB2-ETA-DASH-2            TRKCS103
00646                                     ASC-DB2-ETA-TO-DASH-1         TRKCS103
00647                                     ASC-DB2-ETA-TO-DASH-2         TRKCS103
00648          MOVE ASC-DB2-ETA-DTE    TO DK-ETA-DTE                    TRKCS103
00649          MOVE ASC-DB2-ETA-TO-DTE TO DK-ETA-TO-DTE                 TRKCS103
00650                                                                   TRKCS103
00651          IF TR001-SCAC GREATER THAN SPACES                        TRKCS103
00652              MOVE TR001-SCAC         TO DK-SCAC-CDE-IN            TRKCS103
00653                                         ASC-KEY-PRO-SCAC-ID       TRKCS103
00654              SET PS-CURSOR-WITH-SCAC TO TRUE                      TRKCS103
00655          END-IF                                                   TRKCS103
00656      END-IF.                                                      TRKCS103
00657                                                                   TRKCS103
00658                                                                   TRKCS103
00659 *----------------------------------------------------------------*TRKCS103
00660 *    EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE  *TRKCS103
00661 *    COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY       *TRKCS103
00662 *    ACCEPTED.                                                   *TRKCS103
00663 *----------------------------------------------------------------*TRKCS103
00664                                                                   TRKCS103
00665  1110-EDIT-NAV-KEY.                                               TRKCS103
00666                                                                   TRKCS103
00667      MOVE DP020-NAV-KEY-DATA TO DP010I-UNEDITED-FIELD.            TRKCS103
00668      MOVE PC-MSG-NUMBER-LENGTH     TO DP010I-MAXIMUM-DIGITS.      TRKCS103
00669      MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS.         TRKCS103
00670      SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     TRKCS103
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263697          USING DP010I-NUMERIC-EDIT-AREA.                                 
00672      IF  DP010I-ERROR-DETECTED                                    TRKCS103
00673          SET PS-ERROR TO TRUE                                     TRKCS103
00674          SET DP020-MSG-FATAL TO TRUE                              TRKCS103
00675          MOVE PC-TSYMSG-00302 TO DP020-MSG-NUMBER                 TRKCS103
00676          SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    TRKCS103
00677      END-IF.                                                      TRKCS103
00678                                                                   TRKCS103
00679 *----------------------------------------------------------------*TRKCS103
00680 *    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *TRKCS103
00681 *----------------------------------------------------------------*TRKCS103
00682                                                                   TRKCS103
00683  1120-PREPARE-LIST-ENTRY.                                         TRKCS103
00684                                                                   TRKCS103
00685      MOVE DP057-MAX-ITEMS TO ASC-SEL-SUB.                         TRKCS103
00686      MOVE ZERO            TO ASC-SEL-ITEM.                        TRKCS103
00687      PERFORM 2140-GET-NEXT-MESSAGE.                               TRKCS103
00688  EJECT                                                            TRKCS103
00689 *----------------------------------------------------------------*TRKCS103
00690 *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *TRKCS103
00691 *    ON WHAT FUNCTION KEY WAS SELECTED.                          *TRKCS103
00692 *----------------------------------------------------------------*TRKCS103
00693                                                                   TRKCS103
00694  2000-PROCESS-PANEL.                                              TRKCS103
00695                                                                   TRKCS103
00696      EVALUATE TRUE                                                TRKCS103
00697          WHEN DP020-SRC-AID = DP016-CLEAR                         TRKCS103
00698              MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                TRKCS103
00699              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS103
00700              PERFORM 3200-RESET-ATTRIBUTES                        TRKCS103
00701                                                                   TRKCS103
00702          WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    TRKCS103
00703              PERFORM 2050-DELETE-DETAIL-QUEUE                     TRKCS103
00704              MOVE ASC-KEY-OPER-UNT-ID    TO DK-OPER-UNT-ID        TRKCS103
00705              MOVE ASC-KEY-FCLTY-ID       TO DK-FCLTY-ID           TRKCS103
00706              MOVE ASC-DB2-ETA-DTE        TO DK-ETA-DTE            TRKCS103
00707              MOVE ASC-DB2-ETA-TO-DTE     TO DK-ETA-TO-DTE         TRKCS103
00708              IF ASC-KEY-PRO-SCAC-ID GREATER THAN SPACES           TRKCS103
00709                  MOVE ASC-KEY-PRO-SCAC-ID                         TRKCS103
00710                                          TO DK-SCAC-CDE-IN        TRKCS103
00711                  SET PS-CURSOR-WITH-SCAC TO TRUE                  TRKCS103
00712              END-IF                                               TRKCS103
00713              PERFORM 4000-BUILD-INITIAL-PANEL                     TRKCS103
00714              PERFORM 3200-RESET-ATTRIBUTES                        TRKCS103
00715                                                                   TRKCS103
00716          WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             TRKCS103
00717              IF  ASC-USE-SELECTION-QUEUE                          TRKCS103
00718                  PERFORM 2140-GET-NEXT-MESSAGE                    TRKCS103
00719                  IF PS-LIST-END                                   TRKCS103
00720                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         TRKCS103
00721                      SET PS-NO-LIST-END TO TRUE                   TRKCS103
00722                  ELSE                                             TRKCS103
00723                      PERFORM 2050-DELETE-DETAIL-QUEUE             TRKCS103
00724                      PERFORM 4000-BUILD-INITIAL-PANEL             TRKCS103
00725                  END-IF                                           TRKCS103
00726                  PERFORM 3200-RESET-ATTRIBUTES                    TRKCS103
00727              ELSE                                                 TRKCS103
00728                  MOVE PC-TSYMSG-00070                             TRKCS103
00729                                   TO DP020-MSG-NUMBER             TRKCS103
00730                  SET DP020-MSG-INFORMATIONAL TO TRUE              TRKCS103
00731              END-IF                                               TRKCS103
00732                                                                   TRKCS103
00733          WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             TRKCS103
00734              IF  ASC-USE-SELECTION-QUEUE                          TRKCS103
00735                  PERFORM 2150-GET-PREV-MESSAGE                    TRKCS103
00736                  IF PS-LIST-END                                   TRKCS103
00737                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         TRKCS103
00738                      SET PS-NO-LIST-END TO TRUE                   TRKCS103
00739                  ELSE                                             TRKCS103
00740                      PERFORM 2050-DELETE-DETAIL-QUEUE             TRKCS103
00741                      PERFORM 4000-BUILD-INITIAL-PANEL             TRKCS103
00742                  END-IF                                           TRKCS103
00743                  PERFORM 3200-RESET-ATTRIBUTES                    TRKCS103
00744              ELSE                                                 TRKCS103
00745                  MOVE PC-TSYMSG-00069                             TRKCS103
00746                                   TO DP020-MSG-NUMBER             TRKCS103
00747                  SET DP020-MSG-INFORMATIONAL TO TRUE              TRKCS103
00748              END-IF                                               TRKCS103
00749                                                                   TRKCS103
00750          WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  TRKCS103
00751              MOVE +1 TO PV-TOP-ITEM                               TRKCS103
00752              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS103
00753              PERFORM 3200-RESET-ATTRIBUTES                        TRKCS103
00754                                                                   TRKCS103
00755          WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   TRKCS103
00756              PERFORM 2110-BROWSE-BACKWARD                         TRKCS103
00757              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS103
00758              PERFORM 3200-RESET-ATTRIBUTES                        TRKCS103
00759                                                                   TRKCS103
00760          WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   TRKCS103
00761              PERFORM 2120-BROWSE-FORWARD                          TRKCS103
00762              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS103
00763              PERFORM 3200-RESET-ATTRIBUTES                        TRKCS103
00764                                                                   TRKCS103
00765          WHEN DP020-SRC-AID = DP016-ENTER                         TRKCS103
00766              PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   TRKCS103
00767              IF  PS-ERROR                                         TRKCS103
00768                  CONTINUE                                         TRKCS103
00769              ELSE                                                 TRKCS103
00770                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             TRKCS103
00771                  PERFORM 3200-RESET-ATTRIBUTES                    TRKCS103
00772              END-IF                                               TRKCS103
00773                                                                   TRKCS103
00774          WHEN OTHER                                               TRKCS103
00775              SET DP013-NO-ROLLBACK TO TRUE                        TRKCS103
00776              SET DP013-XCTL-DISPLAY-RESTART TO TRUE               TRKCS103
00777              SET DP013-CICS-ABEND TO TRUE                         TRKCS103
00778              MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    TRKCS103
00779              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      TRKCS103
00780                                    TO DP013-MESSAGE-TEXT (1)      TRKCS103
00781              PERFORM DP013-0000-PROCESS-ABEND                     TRKCS103
00782                                                                   TRKCS103
00783      END-EVALUATE.                                                TRKCS103
00784  EJECT                                                            TRKCS103
00785 *----------------------------------------------------------------*TRKCS103
00786 *    DELETE THE TEMPORARY STORAGE QUEUE.                         *TRKCS103
00787 *----------------------------------------------------------------*TRKCS103
00788                                                                   TRKCS103
00789  2050-DELETE-DETAIL-QUEUE.                                        TRKCS103
00790                                                                   TRKCS103
00791      EXEC CICS                                                    TRKCS103
00792          DELETEQ TS                                               TRKCS103
00793              QUEUE (ASC-DTL-QUEUE-NAME)                           TRKCS103
00794              RESP  (PV-CICS-RESP)                                 TRKCS103
00795      END-EXEC.                                                    TRKCS103
00796                                                                   TRKCS103
00797      IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       TRKCS103
00798         (PV-CICS-RESP = DFHRESP(QIDERR))                          TRKCS103
00799          CONTINUE                                                 TRKCS103
00800      ELSE                                                         TRKCS103
00801          SET DP013-CICS-ABEND TO TRUE                             TRKCS103
00802          SET DP013-NO-ROLLBACK TO TRUE                            TRKCS103
00803                                                                   TRKCS103
00804          MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       TRKCS103
00805          MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  TRKCS103
00806                         TO DP013-MESSAGE-TEXT (1)                 TRKCS103
00807          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
00808      END-IF.                                                      TRKCS103
00809                                                                   TRKCS103
00810      MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        TRKCS103
00811  EJECT                                                            TRKCS103
00812 *----------------------------------------------------------------*TRKCS103
00813 *    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *TRKCS103
00814 *    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *TRKCS103
00815 *    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *TRKCS103
00816 *    MESSAGE.                                                    *TRKCS103
00817 *----------------------------------------------------------------*TRKCS103
00818                                                                   TRKCS103
00819  2110-BROWSE-BACKWARD.                                            TRKCS103
00820                                                                   TRKCS103
00821      SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    TRKCS103
00822          GIVING PV-TOP-ITEM.                                      TRKCS103
00823                                                                   TRKCS103
00824      IF  PV-TOP-ITEM < +1                                         TRKCS103
00825          MOVE +1              TO PV-TOP-ITEM                      TRKCS103
00826 *        -- TOP OF LIST --                                        TRKCS103
00827          MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 TRKCS103
00828          SET DP020-MSG-INFORMATIONAL TO TRUE                      TRKCS103
00829      END-IF.                                                      TRKCS103
00830                                                                   TRKCS103
00831  EJECT                                                            TRKCS103
00832                                                                   TRKCS103
00833 *----------------------------------------------------------------*TRKCS103
00834 *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *TRKCS103
00835 *    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *TRKCS103
00836 *    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *TRKCS103
00837 *----------------------------------------------------------------*TRKCS103
00838                                                                   TRKCS103
00839  2120-BROWSE-FORWARD.                                             TRKCS103
00840                                                                   TRKCS103
00841      ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              TRKCS103
00842          GIVING PV-TOP-ITEM.                                      TRKCS103
00843      IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   TRKCS103
00844          MOVE ASC-ITEM-AT-TOP-OF-PANEL                            TRKCS103
00845                                    TO PV-TOP-ITEM                 TRKCS103
00846 *        -- BOTTOM OF LIST --                                     TRKCS103
00847          MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            TRKCS103
00848          SET DP020-MSG-INFORMATIONAL                              TRKCS103
00849                                    TO TRUE                        TRKCS103
00850      ELSE                                                         TRKCS103
00851          COMPUTE PV-BOTTOM-ITEM =                                 TRKCS103
00852              PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 TRKCS103
00853          IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            TRKCS103
00854 *            -- BOTTOM OF LIST --                                 TRKCS103
00855              MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            TRKCS103
00856              SET DP020-MSG-INFORMATIONAL                          TRKCS103
00857                                    TO TRUE                        TRKCS103
00858          END-IF                                                   TRKCS103
00859      END-IF.                                                      TRKCS103
00860  EJECT                                                            TRKCS103
00861 *----------------------------------------------------------------*TRKCS103
00862 *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *TRKCS103
00863 *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *TRKCS103
00864 *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *TRKCS103
00865 *    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *TRKCS103
00866 *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *TRKCS103
00867 *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *TRKCS103
00868 *----------------------------------------------------------------*TRKCS103
00869                                                                   TRKCS103
00870  2130-CHECK-FOR-JUMP-BROWSE.                                      TRKCS103
00871                                                                   TRKCS103
00872      IF ASTRTITL > ZERO                                           TRKCS103
00873          MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      TRKCS103
00874      ELSE                                                         TRKCS103
00875          IF ASTRTITF = DP015-ERASE-EOF                            TRKCS103
00876              INITIALIZE ASC-START-ITEM-REQUEST                    TRKCS103
00877          END-IF                                                   TRKCS103
00878      END-IF.                                                      TRKCS103
00879                                                                   TRKCS103
00880      SET PS-NO-ERROR               TO TRUE.                       TRKCS103
00881      IF (ASC-START-ITEM-REQUEST = SPACE)                          TRKCS103
00882          MOVE ASC-ITEM-AT-TOP-OF-PANEL                            TRKCS103
00883                                    TO PV-TOP-ITEM                 TRKCS103
00884      ELSE                                                         TRKCS103
00885          MOVE ASC-START-ITEM-REQUEST                              TRKCS103
00886                                    TO DP010I-UNEDITED-FIELD       TRKCS103
00887          MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       TRKCS103
00888          MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     TRKCS103
00889          SET DP010I-NEGATIVE-NOT-ALLOWED                          TRKCS103
00890                                    TO TRUE                        TRKCS103
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
00892                                                                   TRKCS103
00893          IF  NOT DP010I-ERROR-DETECTED                            TRKCS103
00894              MOVE DP010I-NUMERIC-FIELD                            TRKCS103
00895                                    TO  ASC-START-ITEM-REQUEST-N   TRKCS103
00896              IF  ASC-START-ITEM-REQUEST-N > ZERO                  TRKCS103
00897                  IF  ASC-START-ITEM-REQUEST-N >                   TRKCS103
00898                                           ASC-NUMBER-OF-ITEMS-READTRKCS103
00899                      MOVE SPACE TO ASC-START-ITEM-REQUEST         TRKCS103
00900                      COMPUTE PV-TOP-ITEM =                        TRKCS103
00901                              ASC-NUMBER-OF-ITEMS-READ             TRKCS103
00902                              - PC-ITEMS-PER-PANEL + 1             TRKCS103
00903                      IF  PV-TOP-ITEM < +1                         TRKCS103
00904                          MOVE +1   TO PV-TOP-ITEM                 TRKCS103
00905                          MOVE PC-TSYMSG-00070                     TRKCS103
00906                                    TO DP020-MSG-NUMBER            TRKCS103
00907                          SET DP020-MSG-INFORMATIONAL              TRKCS103
00908                                    TO TRUE                        TRKCS103
00909                      END-IF                                       TRKCS103
00910                  ELSE                                             TRKCS103
00911                      MOVE ASC-START-ITEM-REQUEST-N                TRKCS103
00912                                    TO PV-TOP-ITEM                 TRKCS103
00913                      MOVE SPACE    TO ASC-START-ITEM-REQUEST      TRKCS103
00914                      COMPUTE PV-BOTTOM-ITEM =                     TRKCS103
00915                          PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     TRKCS103
00916                      IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READTRKCS103
00917 *                        -- BOTTOM OF LIST --                     TRKCS103
00918                          MOVE PC-TSYMSG-00070                     TRKCS103
00919                                    TO DP020-MSG-NUMBER            TRKCS103
00920                          SET DP020-MSG-INFORMATIONAL              TRKCS103
00921                                    TO TRUE                        TRKCS103
00922                      END-IF                                       TRKCS103
00923                  END-IF                                           TRKCS103
00924              ELSE                                                 TRKCS103
00925 *                --- VALUE OUT OF RANGE ----                      TRKCS103
00926                  MOVE PC-TSYMSG-00101                             TRKCS103
00927                                    TO DP020-MSG-NUMBER            TRKCS103
00928                  MOVE -1           TO ASTRTITL                    TRKCS103
00929                  SET DP030-SET-CURSOR-APPL-1                      TRKCS103
00930                                    TO TRUE                        TRKCS103
00931                  MOVE DP015-REVERSE                               TRKCS103
00932                                    TO ASTRTITH                    TRKCS103
00933                  MOVE DP015-RED    TO ASTRTITC                    TRKCS103
00934                  MOVE DP015-UNP-NUM-BRT-MDT                       TRKCS103
00935                                    TO ASTRTITA                    TRKCS103
00936                  SET DP020-MSG-FATAL                              TRKCS103
00937                                    TO TRUE                        TRKCS103
00938                  SET PS-ERROR      TO TRUE                        TRKCS103
00939              END-IF                                               TRKCS103
00940                                                                   TRKCS103
00941          ELSE                                                     TRKCS103
00942              MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            TRKCS103
00943              MOVE -1               TO ASTRTITL                    TRKCS103
00944              SET DP030-SET-CURSOR-APPL-1 TO TRUE                  TRKCS103
00945              MOVE DP015-REVERSE    TO ASTRTITH                    TRKCS103
00946              MOVE DP015-RED        TO ASTRTITC                    TRKCS103
00947              MOVE DP015-UNP-NUM-BRT-MDT                           TRKCS103
00948                                    TO ASTRTITA                    TRKCS103
00949              SET DP020-MSG-FATAL   TO TRUE                        TRKCS103
00950              SET PS-ERROR          TO TRUE                        TRKCS103
00951          END-IF                                                   TRKCS103
00952      END-IF.                                                      TRKCS103
00953  EJECT                                                            TRKCS103
00954                                                                   TRKCS103
00955 *----------------------------------------------------------------*TRKCS103
00956 *    GET THE NEXT MESSAGE IF A LIST OF MESSAGES IS BEING         *TRKCS103
00957 *    PROCESSED.                                                  *TRKCS103
00958 *----------------------------------------------------------------*TRKCS103
00959                                                                   TRKCS103
00960  2140-GET-NEXT-MESSAGE.                                           TRKCS103
00961                                                                   TRKCS103
00962      ADD +1                       TO ASC-SEL-SUB.                 TRKCS103
00963      IF  ASC-SEL-SUB > DP057-MAX-ITEMS                            TRKCS103
00964          ADD +1                   TO ASC-SEL-ITEM                 TRKCS103
00965          MOVE +1                  TO ASC-SEL-SUB                  TRKCS103
00966      END-IF.                                                      TRKCS103
00967      IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                TRKCS103
00968          PERFORM 9100-READ-SEL-QUEUE                              TRKCS103
00969          IF  DP057-ITEM (ASC-SEL-SUB) > ZERO                      TRKCS103
00970              SET DP057-INQ (ASC-SEL-SUB) TO TRUE                  TRKCS103
00971              PERFORM 9200-REWRITE-SEL-QUEUE                       TRKCS103
00972          ELSE                                                     TRKCS103
00973              SUBTRACT +1 FROM ASC-SEL-SUB                         TRKCS103
00974              MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             TRKCS103
00975              SET DP020-MSG-INFORMATIONAL TO TRUE                  TRKCS103
00976              SET PS-LIST-END             TO TRUE                  TRKCS103
00977          END-IF                                                   TRKCS103
00978      ELSE                                                         TRKCS103
00979          SUBTRACT +1 FROM ASC-SEL-ITEM                            TRKCS103
00980          MOVE DP057-MAX-ITEMS     TO ASC-SEL-SUB                  TRKCS103
00981          MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             TRKCS103
00982          SET DP020-MSG-INFORMATIONAL TO TRUE                      TRKCS103
00983          SET PS-LIST-END             TO TRUE                      TRKCS103
00984      END-IF.                                                      TRKCS103
00985                                                                   TRKCS103
00986 *----------------------------------------------------------------*TRKCS103
00987 *    GET THE PREVIOUS MESSAGE IF A LIST OF MESSAGES IS BEING     *TRKCS103
00988 *    PROCESSED.                                                  *TRKCS103
00989 *----------------------------------------------------------------*TRKCS103
00990                                                                   TRKCS103
00991  2150-GET-PREV-MESSAGE.                                           TRKCS103
00992                                                                   TRKCS103
00993      SUBTRACT +1 FROM ASC-SEL-SUB.                                TRKCS103
00994      IF  ASC-SEL-SUB < +1                                         TRKCS103
00995          SUBTRACT +1 FROM ASC-SEL-ITEM                            TRKCS103
00996          MOVE DP057-MAX-ITEMS     TO ASC-SEL-SUB                  TRKCS103
00997      END-IF.                                                      TRKCS103
00998                                                                   TRKCS103
00999      IF  ASC-SEL-ITEM > ZERO                                      TRKCS103
01000          PERFORM 9100-READ-SEL-QUEUE                              TRKCS103
01001      ELSE                                                         TRKCS103
01002          MOVE +1                  TO ASC-SEL-ITEM                 TRKCS103
01003                                      ASC-SEL-SUB                  TRKCS103
01004          MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             TRKCS103
01005          SET DP020-MSG-INFORMATIONAL TO TRUE                      TRKCS103
01006          SET PS-LIST-END             TO TRUE                      TRKCS103
01007      END-IF.                                                      TRKCS103
01008                                                                   TRKCS103
01009  EJECT                                                            TRKCS103
01010 *----------------------------------------------------------------*TRKCS103
01011 *    RESET ATTRIBUTES.                                           *TRKCS103
01012 *----------------------------------------------------------------*TRKCS103
01013                                                                   TRKCS103
01014  3200-RESET-ATTRIBUTES.                                           TRKCS103
01015                                                                   TRKCS103
01016      MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   TRKCS103
01017      MOVE DP015-GREEN              TO ASTRTITC.                   TRKCS103
01018      MOVE DP015-UNDERLINE          TO ASTRTITH.                   TRKCS103
01019      MOVE -1                       TO ASTRTITL.                   TRKCS103
01020      SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       TRKCS103
01021                                                                   TRKCS103
01022  EJECT                                                            TRKCS103
01023                                                                   TRKCS103
01024 *----------------------------------------------------------------*TRKCS103
01025 *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *TRKCS103
01026 *    INITIALIZE ALL COUNTERS AND FLAGS.                          *TRKCS103
01027 *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *TRKCS103
01028 *    DISPLAY THE PANEL TO USER.                                  *TRKCS103
01029 *----------------------------------------------------------------*TRKCS103
01030                                                                   TRKCS103
01031  4000-BUILD-INITIAL-PANEL.                                        TRKCS103
01032                                                                   TRKCS103
01033      INITIALIZE                  ASC-BLOCK-ENTRIES (1)            TRKCS103
01034                                  ASC-BLOCK-ENTRIES (2).           TRKCS103
01035      MOVE +1                 TO  ASC-BLK-SUB.                     TRKCS103
01036      SET ASC-ITEMS-LEFT-ON-DB                                     TRKCS103
01037                              TO  TRUE.                            TRKCS103
01038                                                                   TRKCS103
01039      MOVE +0                 TO  ASC-ITEM-SUB                     TRKCS103
01040                                  ASC-NUMBER-OF-ITEMS-READ         TRKCS103
01041                                  ASC-NUMBER-OF-SELECTED-ITEMS     TRKCS103
01042                                  ASC-HIGHEST-BLOCK-WRITTEN        TRKCS103
01043                                  ASC-START-OF-SELECTED-RANGE      TRKCS103
01044                                  ASC-END-OF-SELECTED-RANGE        TRKCS103
01045                                  ASC-ITEM-AT-TOP-OF-PANEL.        TRKCS103
01046                                                                   TRKCS103
01047      PERFORM 4010-OPEN-CURSOR.                                    TRKCS103
01048                                                                   TRKCS103
01049      PERFORM 4300-READ-ITEMS-FROM-DB.                             TRKCS103
01050                                                                   TRKCS103
01051      PERFORM 4020-CLOSE-CURSOR.                                   TRKCS103
01052                                                                   TRKCS103
01053      MOVE +1                 TO  PV-TOP-ITEM.                     TRKCS103
01054      IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          TRKCS103
01055          SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    TRKCS103
01056          SET DP020-MSG-FATAL   TO  TRUE                           TRKCS103
01057          MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               TRKCS103
01058      ELSE                                                         TRKCS103
01059          MOVE -1             TO ASTRTITL                          TRKCS103
01060          SET DP030-SET-CURSOR-APPL-1 TO TRUE                      TRKCS103
01061          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     TRKCS103
01062      END-IF.                                                      TRKCS103
01063  EJECT                                                            TRKCS103
01064 *----------------------------------------------------------------*TRKCS103
01065 * OPEN THE CURSOR.                                               *TRKCS103
01066 *----------------------------------------------------------------*TRKCS103
01067                                                                   TRKCS103
01068  4010-OPEN-CURSOR.                                                TRKCS103
01069                                                                   TRKCS103
01070      IF PS-CURSOR-WITH-SCAC                                       TRKCS103
01071          EXEC SQL                                                 TRKCS103
01072               OPEN ENT-SCAC-CSR                                   TRKCS103
01073          END-EXEC                                                 TRKCS103
01074      ELSE                                                         TRKCS103
01075          EXEC SQL                                                 TRKCS103
01076               OPEN ENT-CSR                                        TRKCS103
01077          END-EXEC                                                 TRKCS103
01078      END-IF.                                                      TRKCS103
01079                                                                   TRKCS103
01080      EVALUATE TRUE                                                TRKCS103
01081          WHEN SQLCODE = ZERO                                      TRKCS103
01082               CONTINUE                                            TRKCS103
01083          WHEN SQLWARN0 NOT EQUAL SPACE                            TRKCS103
01084          WHEN SQLCODE NOT EQUAL ZERO                              TRKCS103
01085               MOVE '4010-OPEN-CURSOR'                             TRKCS103
01086                            TO  DP013-PARAGRAPH                    TRKCS103
01087               MOVE 'OPEN MESSAGE CURSOR'                          TRKCS103
01088                            TO  DP013-MESSAGE-TEXT (1)             TRKCS103
01089               MOVE SQLCA   TO  DP013-SQLCA                        TRKCS103
01090               SET DP013-DB2-ABEND                                 TRKCS103
01091                            TO  TRUE                               TRKCS103
01092               PERFORM DP013-0000-PROCESS-ABEND                    TRKCS103
01093      END-EVALUATE.                                                TRKCS103
01094                                                                   TRKCS103
01095  EJECT                                                            TRKCS103
01096 *----------------------------------------------------------------*TRKCS103
01097 * CLOSE THE CURSOR.                                              *TRKCS103
01098 *----------------------------------------------------------------*TRKCS103
01099                                                                   TRKCS103
01100  4020-CLOSE-CURSOR.                                               TRKCS103
01101                                                                   TRKCS103
01102      IF PS-CURSOR-WITH-SCAC                                       TRKCS103
01103          EXEC SQL                                                 TRKCS103
01104               CLOSE ENT-SCAC-CSR                                  TRKCS103
01105          END-EXEC                                                 TRKCS103
01106      ELSE                                                         TRKCS103
01107          EXEC SQL                                                 TRKCS103
01108               CLOSE ENT-CSR                                       TRKCS103
01109          END-EXEC                                                 TRKCS103
01110      END-IF.                                                      TRKCS103
01111                                                                   TRKCS103
01112      EVALUATE TRUE                                                TRKCS103
01113          WHEN SQLCODE = ZERO                                      TRKCS103
01114               CONTINUE                                            TRKCS103
01115          WHEN SQLWARN0 NOT EQUAL SPACE                            TRKCS103
01116          WHEN SQLCODE NOT EQUAL ZERO                              TRKCS103
01117               MOVE '4020-CLOSE-CURSOR'                            TRKCS103
01118                            TO  DP013-PARAGRAPH                    TRKCS103
01119               MOVE 'CLOSE MESSAGE CURSOR'                         TRKCS103
01120                            TO  DP013-MESSAGE-TEXT (1)             TRKCS103
01121               MOVE SQLCA   TO  DP013-SQLCA                        TRKCS103
01122               SET DP013-DB2-ABEND                                 TRKCS103
01123                            TO  TRUE                               TRKCS103
01124               PERFORM DP013-0000-PROCESS-ABEND                    TRKCS103
01125      END-EVALUATE.                                                TRKCS103
01126                                                                   TRKCS103
01127  EJECT                                                            TRKCS103
01128 *----------------------------------------------------------------*TRKCS103
01129 *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *TRKCS103
01130 *    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *TRKCS103
01131 *    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *TRKCS103
01132 *    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *TRKCS103
01133 *    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *TRKCS103
01134 *                                                                *TRKCS103
01135 *    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *TRKCS103
01136 *    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *TRKCS103
01137 *    UPON INITIALIZATION.                                        *TRKCS103
01138 *----------------------------------------------------------------*TRKCS103
01139                                                                   TRKCS103
01140  4300-READ-ITEMS-FROM-DB.                                         TRKCS103
01141                                                                   TRKCS103
01142      PERFORM                                                      TRKCS103
01143          VARYING PV-READ-COUNT                                    TRKCS103
01144          FROM 1 BY 1                                              TRKCS103
01145          UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    TRKCS103
01146             OR (ASC-NO-ITEMS-LEFT-ON-DB))                         TRKCS103
01147          PERFORM 4303-FETCH                                       TRKCS103
01148                                                                   TRKCS103
01149          IF  ASC-ITEMS-LEFT-ON-DB                                 TRKCS103
01150              MOVE EXTENT-SCAC-CDE    TO DK-SCAC-CDE               TRKCS103
01151              SET PS-ITEMS-LEFT-ON-DB TO TRUE                      TRKCS103
01152              PERFORM 4305-OPEN-CURSOR                             TRKCS103
01153              PERFORM                                              TRKCS103
01154                  UNTIL PS-NO-ITEMS-LEFT-ON-DB                     TRKCS103
01155                  PERFORM 4310-FETCH                               TRKCS103
01156                                                                   TRKCS103
01157                  IF PS-ITEMS-LEFT-ON-DB                           TRKCS103
01158                      PERFORM 4320-GET-SUB                         TRKCS103
01159                                                                   TRKCS103
01160                      MOVE EXTENT-SCAC-CDE                         TRKCS103
01161                                          TO ASC-SCAC              TRKCS103
01162                                            (ASC-BLK-SUB           TRKCS103
01163                                             ASC-ITEM-SUB)         TRKCS103
01164                                                                   TRKCS103
01165                      MOVE ENTNME-ENT-NAME-DESC                    TRKCS103
01166                                          TO ASC-NAME              TRKCS103
01167                                            (ASC-BLK-SUB           TRKCS103
01168                                             ASC-ITEM-SUB)         TRKCS103
01169                                                                   TRKCS103
01170                      MOVE PV-SHIPMENTS   TO ASC-SHIPMENTS         TRKCS103
01171                                            (ASC-BLK-SUB           TRKCS103
01172                                             ASC-ITEM-SUB)         TRKCS103
01173                                                                   TRKCS103
01174                      MOVE PV-EXPTED-PKG-QTY                       TRKCS103
01175                                          TO ASC-QUANTITY          TRKCS103
01176                                            (ASC-BLK-SUB           TRKCS103
01177                                             ASC-ITEM-SUB)         TRKCS103
01178                                                                   TRKCS103
01179                      MOVE SHIPMT-PKG-TYP-CDE                      TRKCS103
01180                                          TO ASC-PACKAGE           TRKCS103
01181                                            (ASC-BLK-SUB           TRKCS103
01182                                             ASC-ITEM-SUB)         TRKCS103
01183                                                                   TRKCS103
01184                      MOVE PV-EXPTED-GRO-WGHT                      TRKCS103
01185                                          TO ASC-WEIGHT            TRKCS103
01186                                            (ASC-BLK-SUB           TRKCS103
01187                                             ASC-ITEM-SUB)         TRKCS103
01188                                                                   TRKCS103
01189                  END-IF                                           TRKCS103
01190              END-PERFORM                                          TRKCS103
01191              PERFORM 4315-CLOSE-CURSOR                            TRKCS103
01192          END-IF                                                   TRKCS103
01193      END-PERFORM.                                                 TRKCS103
01194                                                                   TRKCS103
01195      IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          TRKCS103
01196          SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    TRKCS103
01197          SET DP020-MSG-FATAL   TO  TRUE                           TRKCS103
01198          MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               TRKCS103
01199      ELSE                                                         TRKCS103
01200          MOVE +1                       TO  ASC-BLK-SUB            TRKCS103
01201          PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS103
01202          ADD +1                        TO  ASC-BLK-SUB            TRKCS103
01203          PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS103
01204                                                                   TRKCS103
01205          MOVE 1                        TO  ASC-BLK-SUB            TRKCS103
01206                                            PV-BLOCK-NUMBER        TRKCS103
01207          PERFORM 4410-READ-TEMP-STORAGE                           TRKCS103
01208          IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             TRKCS103
01209              MOVE 2                    TO  ASC-BLK-SUB            TRKCS103
01210                                            PV-BLOCK-NUMBER        TRKCS103
01211              PERFORM 4410-READ-TEMP-STORAGE                       TRKCS103
01212          END-IF                                                   TRKCS103
01213      END-IF.                                                      TRKCS103
01214  EJECT                                                            TRKCS103
01215  4303-FETCH.                                                      TRKCS103
01216      PERFORM                                                      TRKCS103
01217          WITH TEST AFTER                                          TRKCS103
01218          VARYING PV-SQL-SUB                                       TRKCS103
01219          FROM 1 BY 1                                              TRKCS103
01220          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             TRKCS103
01221             OR SQLCODE = 0                                        TRKCS103
01222             OR SQLCODE = +100                                     TRKCS103
01223                                                                   TRKCS103
01224          IF PS-CURSOR-WITH-SCAC                                   TRKCS103
01225              EXEC SQL                                             TRKCS103
01226                   FETCH ENT-SCAC-CSR                              TRKCS103
01227                   INTO :EXTENT-SCAC-CDE,                          TRKCS103
01228                        :ENTNME-ENT-NAME-DESC                      TRKCS103
01229              END-EXEC                                             TRKCS103
01230          ELSE                                                     TRKCS103
01231              EXEC SQL                                             TRKCS103
01232                   FETCH ENT-CSR                                   TRKCS103
01233                   INTO :EXTENT-SCAC-CDE,                          TRKCS103
01234                        :ENTNME-ENT-NAME-DESC                      TRKCS103
01235              END-EXEC                                             TRKCS103
01236          END-IF                                                   TRKCS103
01237                                                                   TRKCS103
01238          EVALUATE TRUE                                            TRKCS103
01239              WHEN SQLCODE = ZERO                                  TRKCS103
01240              WHEN SQLCODE = +100                                  TRKCS103
01241              WHEN SQLCODE = -904                                  TRKCS103
01242              WHEN SQLCODE = -913                                  TRKCS103
01243                   CONTINUE                                        TRKCS103
01244              WHEN SQLWARN0 NOT EQUAL SPACE                        TRKCS103
01245              WHEN SQLCODE NOT EQUAL ZERO                          TRKCS103
01246                   MOVE '4303-FETCH-CURSOR'                        TRKCS103
01247                                TO  DP013-PARAGRAPH                TRKCS103
01248                   MOVE 'FETCH MESSAGE CURSOR'                     TRKCS103
01249                                TO  DP013-MESSAGE-TEXT (1)         TRKCS103
01250                   MOVE SQLCA   TO  DP013-SQLCA                    TRKCS103
01251                   SET DP013-DB2-ABEND                             TRKCS103
01252                                TO  TRUE                           TRKCS103
01253                   PERFORM DP013-0000-PROCESS-ABEND                TRKCS103
01254          END-EVALUATE                                             TRKCS103
01255      END-PERFORM.                                                 TRKCS103
01256                                                                   TRKCS103
01257      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   TRKCS103
01258          MOVE '4303-FETCH-CURSOR'                                 TRKCS103
01259                                TO  DP013-PARAGRAPH                TRKCS103
01260          MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             TRKCS103
01261                                TO  DP013-MESSAGE-TEXT (1)         TRKCS103
01262          MOVE SQLCA            TO  DP013-SQLCA                    TRKCS103
01263          SET DP013-DB2-ABEND   TO  TRUE                           TRKCS103
01264          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
01265      END-IF.                                                      TRKCS103
01266                                                                   TRKCS103
01267      IF SQLCODE = +100                                            TRKCS103
01268          SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      TRKCS103
01269      END-IF.                                                      TRKCS103
01270                                                                   TRKCS103
01271 *----------------------------------------------------------------*TRKCS103
01272 * OPEN THE CURSOR.                                               *TRKCS103
01273 *----------------------------------------------------------------*TRKCS103
01274                                                                   TRKCS103
01275  4305-OPEN-CURSOR.                                                TRKCS103
01276                                                                   TRKCS103
01277      EXEC SQL                                                     TRKCS103
01278           OPEN LIST-CSR                                           TRKCS103
01279      END-EXEC.                                                    TRKCS103
01280                                                                   TRKCS103
01281      EVALUATE TRUE                                                TRKCS103
01282          WHEN SQLCODE = ZERO                                      TRKCS103
01283               CONTINUE                                            TRKCS103
01284          WHEN SQLWARN0 NOT EQUAL SPACE                            TRKCS103
01285          WHEN SQLCODE NOT EQUAL ZERO                              TRKCS103
01286               MOVE '4305-OPEN-CURSOR'                             TRKCS103
01287                            TO  DP013-PARAGRAPH                    TRKCS103
01288               MOVE 'OPEN MESSAGE CURSOR'                          TRKCS103
01289                            TO  DP013-MESSAGE-TEXT (1)             TRKCS103
01290               MOVE SQLCA   TO  DP013-SQLCA                        TRKCS103
01291               SET DP013-DB2-ABEND                                 TRKCS103
01292                            TO  TRUE                               TRKCS103
01293               PERFORM DP013-0000-PROCESS-ABEND                    TRKCS103
01294      END-EVALUATE.                                                TRKCS103
01295                                                                   TRKCS103
01296  EJECT                                                            TRKCS103
01297 *----------------------------------------------------------------*TRKCS103
01298 *    FETCH THE TEXT CURSOR.                                      *TRKCS103
01299 *----------------------------------------------------------------*TRKCS103
01300                                                                   TRKCS103
01301  4310-FETCH.                                                      TRKCS103
01302                                                                   TRKCS103
01303      PERFORM                                                      TRKCS103
01304          WITH TEST AFTER                                          TRKCS103
01305          VARYING PV-SQL-SUB                                       TRKCS103
01306          FROM 1 BY 1                                              TRKCS103
01307          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             TRKCS103
01308             OR SQLCODE = 0                                        TRKCS103
01309             OR SQLCODE = +100                                     TRKCS103
01310                                                                   TRKCS103
01311          EXEC SQL                                                 TRKCS103
01312               FETCH LIST-CSR                                      TRKCS103
01313               INTO :SHIPMT-PKG-TYP-CDE,                           TRKCS103
01314                    :PV-SHIPMENTS,                                 TRKCS103
01315                    :PV-EXPTED-GRO-WGHT,                           TRKCS103
01316                    :PV-EXPTED-PKG-QTY                             TRKCS103
01317          END-EXEC                                                 TRKCS103
01318                                                                   TRKCS103
01319          EVALUATE TRUE                                            TRKCS103
01320              WHEN SQLCODE = ZERO                                  TRKCS103
01321              WHEN SQLCODE = +100                                  TRKCS103
01322              WHEN SQLCODE = -904                                  TRKCS103
01323              WHEN SQLCODE = -913                                  TRKCS103
01324                   CONTINUE                                        TRKCS103
01325              WHEN SQLWARN0 NOT EQUAL SPACE                        TRKCS103
01326              WHEN SQLCODE NOT EQUAL ZERO                          TRKCS103
01327                   MOVE '4310-FETCH-CURSOR'                        TRKCS103
01328                                TO  DP013-PARAGRAPH                TRKCS103
01329                   MOVE 'FETCH MESSAGE CURSOR'                     TRKCS103
01330                                TO  DP013-MESSAGE-TEXT (1)         TRKCS103
01331                   MOVE SQLCA   TO  DP013-SQLCA                    TRKCS103
01332                   SET DP013-DB2-ABEND                             TRKCS103
01333                                TO  TRUE                           TRKCS103
01334                   PERFORM DP013-0000-PROCESS-ABEND                TRKCS103
01335          END-EVALUATE                                             TRKCS103
01336      END-PERFORM.                                                 TRKCS103
01337                                                                   TRKCS103
01338      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   TRKCS103
01339          MOVE '4310-FETCH-CURSOR'                                 TRKCS103
01340                                TO  DP013-PARAGRAPH                TRKCS103
01341          MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             TRKCS103
01342                                TO  DP013-MESSAGE-TEXT (1)         TRKCS103
01343          MOVE SQLCA            TO  DP013-SQLCA                    TRKCS103
01344          SET DP013-DB2-ABEND   TO  TRUE                           TRKCS103
01345          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
01346      END-IF.                                                      TRKCS103
01347                                                                   TRKCS103
01348      IF  SQLCODE = +100                                           TRKCS103
01349          SET PS-NO-ITEMS-LEFT-ON-DB                               TRKCS103
01350                              TO TRUE                              TRKCS103
01351      END-IF.                                                      TRKCS103
01352                                                                   TRKCS103
01353 *----------------------------------------------------------------*TRKCS103
01354 * CLOSE THE CURSOR.                                              *TRKCS103
01355 *----------------------------------------------------------------*TRKCS103
01356                                                                   TRKCS103
01357  4315-CLOSE-CURSOR.                                               TRKCS103
01358                                                                   TRKCS103
01359      EXEC SQL                                                     TRKCS103
01360          CLOSE LIST-CSR                                           TRKCS103
01361      END-EXEC.                                                    TRKCS103
01362                                                                   TRKCS103
01363      EVALUATE TRUE                                                TRKCS103
01364          WHEN SQLCODE = ZERO                                      TRKCS103
01365               CONTINUE                                            TRKCS103
01366          WHEN SQLWARN0 NOT EQUAL SPACE                            TRKCS103
01367          WHEN SQLCODE NOT EQUAL ZERO                              TRKCS103
01368               MOVE '4315-CLOSE-CURSOR'                            TRKCS103
01369                            TO  DP013-PARAGRAPH                    TRKCS103
01370               MOVE 'CLOSE MESSAGE CURSOR'                         TRKCS103
01371                            TO  DP013-MESSAGE-TEXT (1)             TRKCS103
01372               MOVE SQLCA   TO  DP013-SQLCA                        TRKCS103
01373               SET DP013-DB2-ABEND                                 TRKCS103
01374                            TO  TRUE                               TRKCS103
01375               PERFORM DP013-0000-PROCESS-ABEND                    TRKCS103
01376      END-EVALUATE.                                                TRKCS103
01377                                                                   TRKCS103
01378                                                                   TRKCS103
01379  EJECT                                                            TRKCS103
01380 *----------------------------------------------------------------*TRKCS103
01381 *    GET THE CORRECT SUBSCRIPTS FOR PLACING THE TEXT LINE.       *TRKCS103
01382 *----------------------------------------------------------------*TRKCS103
01383                                                                   TRKCS103
01384  4320-GET-SUB.                                                    TRKCS103
01385                                                                   TRKCS103
01386      IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        TRKCS103
01387          ADD +1            TO  ASC-ITEM-SUB                       TRKCS103
01388      ELSE                                                         TRKCS103
01389          ADD +1            TO  ASC-BLK-SUB                        TRKCS103
01390          MOVE +1           TO  ASC-ITEM-SUB                       TRKCS103
01391                                                                   TRKCS103
01392          IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 TRKCS103
01393              MOVE +1       TO  ASC-BLK-SUB                        TRKCS103
01394              PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS103
01395              MOVE ASC-BLOCK-ENTRIES                               TRKCS103
01396                        (PC-MAX-BLOCKS-IN-ARRAY)                   TRKCS103
01397              TO   ASC-BLOCK-ENTRIES(ASC-BLK-SUB)                  TRKCS103
01398              ADD +1        TO  ASC-BLK-SUB                        TRKCS103
01399              INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           TRKCS103
01400          END-IF                                                   TRKCS103
01401      END-IF.                                                      TRKCS103
01402                                                                   TRKCS103
01403      ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               TRKCS103
01404      MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        TRKCS103
01405                                       (ASC-BLK-SUB                TRKCS103
01406                                        ASC-ITEM-SUB).             TRKCS103
01407                                                                   TRKCS103
01408 *----------------------------------------------------------------*TRKCS103
01409 *    DATA IS SUMMED TO THE SCAC/PACKAGE TYPE CODE LEVEL          *TRKCS103
01410 *----------------------------------------------------------------*TRKCS103
01411                                                                   TRKCS103
01412  4340-SUM-TOTALS.                                                 TRKCS103
01413                                                                   TRKCS103
01414      IF PS-FIRST-TIME                                             TRKCS103
01415          SET PS-NOT-FIRST-TIME   TO TRUE                          TRKCS103
01416          ADD 1                   TO PV-SHIPMENTS                  TRKCS103
01417          ADD SHIPMT-EXPTED-GRO-WGHT                               TRKCS103
01418                                  TO PV-EXPTED-GRO-WGHT            TRKCS103
01419          ADD SHIPMT-EXPTED-PKG-QTY                                TRKCS103
01420                                  TO PV-EXPTED-PKG-QTY             TRKCS103
01421          MOVE SHIPMT-SHIPT-ID    TO PV-PREV-SHIPT-ID              TRKCS103
01422          MOVE SHIPMT-PRO-SCAC-ID TO PV-PREV-SCAC-CDE              TRKCS103
01423          MOVE ENTNME-ENT-NAME-DESC                                TRKCS103
01424                                  TO PV-PREV-VEND-NAME             TRKCS103
01425          MOVE SHIPMT-PKG-TYP-CDE TO PV-PREV-PKG-TYP-CDE           TRKCS103
01426      END-IF.                                                      TRKCS103
01427                                                                   TRKCS103
01428      IF SHIPMT-PRO-SCAC-ID  = PV-PREV-SCAC-CDE AND                TRKCS103
01429         SHIPMT-PKG-TYP-CDE  = PV-PREV-PKG-TYP-CDE                 TRKCS103
01430          IF SHIPMT-SHIPT-ID = PV-PREV-SHIPT-ID                    TRKCS103
01431              CONTINUE                                             TRKCS103
01432          ELSE                                                     TRKCS103
01433              ADD 1               TO PV-SHIPMENTS                  TRKCS103
01434              ADD SHIPMT-EXPTED-GRO-WGHT                           TRKCS103
01435                                  TO PV-EXPTED-GRO-WGHT            TRKCS103
01436              ADD SHIPMT-EXPTED-PKG-QTY                            TRKCS103
01437                                  TO PV-EXPTED-PKG-QTY             TRKCS103
01438              MOVE SHIPMT-SHIPT-ID                                 TRKCS103
01439                                  TO PV-PREV-SHIPT-ID              TRKCS103
01440          END-IF                                                   TRKCS103
01441      ELSE                                                         TRKCS103
01442          SET PS-RECORD-TO-PROCESS                                 TRKCS103
01443                                  TO TRUE                          TRKCS103
01444      END-IF.                                                      TRKCS103
01445                                                                   TRKCS103
01446  EJECT                                                            TRKCS103
01447 *----------------------------------------------------------------*TRKCS103
01448 *    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *TRKCS103
01449 *----------------------------------------------------------------*TRKCS103
01450                                                                   TRKCS103
01451  4400-MOVE-COMMAREA-TO-SCREEN.                                    TRKCS103
01452                                                                   TRKCS103
01453      IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             TRKCS103
01454          AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          TRKCS103
01455          OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          TRKCS103
01456              DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             TRKCS103
01457                  GIVING PV-BLOCK-NUMBER                           TRKCS103
01458                  REMAINDER PV-REMAINDER                           TRKCS103
01459              IF  PV-REMAINDER > ZERO                              TRKCS103
01460                  ADD +1 TO PV-BLOCK-NUMBER                        TRKCS103
01461              END-IF                                               TRKCS103
01462              MOVE +1    TO ASC-BLK-SUB                            TRKCS103
01463              PERFORM 4410-READ-TEMP-STORAGE                       TRKCS103
01464              ADD +1     TO ASC-BLK-SUB                            TRKCS103
01465                            PV-BLOCK-NUMBER                        TRKCS103
01466              PERFORM 4410-READ-TEMP-STORAGE                       TRKCS103
01467      END-IF.                                                      TRKCS103
01468      MOVE +1                       TO ASC-BLK-SUB.                TRKCS103
01469      COMPUTE ASC-ITEM-SUB =                                       TRKCS103
01470          ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              TRKCS103
01471          + PC-ITEMS-PER-PANEL).                                   TRKCS103
01472                                                                   TRKCS103
01473      IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        TRKCS103
01474          ADD +1   TO ASC-BLK-SUB                                  TRKCS103
01475          SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            TRKCS103
01476      END-IF.                                                      TRKCS103
01477                                                                   TRKCS103
01478      COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           TRKCS103
01479          ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                TRKCS103
01480      PERFORM 4420-FORMAT-LIST-LINES                               TRKCS103
01481          VARYING PS-SUB                                           TRKCS103
01482          FROM PC-ITEMS-PER-PANEL BY -1                            TRKCS103
01483          UNTIL PS-SUB < +1.                                       TRKCS103
01484                                                                   TRKCS103
01485      COMPUTE ASC-ITEMS-DISPLAYED =                                TRKCS103
01486          ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          TRKCS103
01487      MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    TRKCS103
01488                                       ASTRTITO.                   TRKCS103
01489      MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    TRKCS103
01490      MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    TRKCS103
01491                                                                   TRKCS103
01492      MOVE ASC-KEY-OPER-UNT-ID      TO AOPERO.                     TRKCS103
01493      MOVE ASC-KEY-FCLTY-ID         TO AFCLTYO.                    TRKCS103
01494      MOVE ASC-KEY-FCLTY-ID-NME     TO AFDESCO.                    TRKCS103
01495      MOVE ASC-KEY-ETA-DTE          TO AETAO.                      TRKCS103
01496      MOVE ASC-KEY-ETA-TO-DTE       TO ATOO.                       TRKCS103
01497      IF  DP020-MSG-NUMBER-X = SPACE                               TRKCS103
01498          IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  TRKCS103
01499 *            --- MORE ITEMS TO DISPLAY ----                       TRKCS103
01500              MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            TRKCS103
01501              SET DP020-MSG-INFORMATIONAL TO TRUE                  TRKCS103
01502          END-IF                                                   TRKCS103
01503      END-IF.                                                      TRKCS103
01504                                                                   TRKCS103
01505 *----------------------------------------------------------------*TRKCS103
01506 *    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *TRKCS103
01507 *----------------------------------------------------------------*TRKCS103
01508                                                                   TRKCS103
01509  4410-READ-TEMP-STORAGE.                                          TRKCS103
01510                                                                   TRKCS103
01511      EXEC CICS                                                    TRKCS103
01512          READQ TS                                                 TRKCS103
01513              QUEUE (ASC-DTL-QUEUE-NAME)                           TRKCS103
01514              INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               TRKCS103
01515              ITEM  (PV-BLOCK-NUMBER)                              TRKCS103
01516              RESP  (PV-CICS-RESP)                                 TRKCS103
01517      END-EXEC.                                                    TRKCS103
01518                                                                   TRKCS103
01519      IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       TRKCS103
01520        OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     TRKCS103
01521          CONTINUE                                                 TRKCS103
01522      ELSE                                                         TRKCS103
01523          SET DP013-CICS-ABEND TO  TRUE                            TRKCS103
01524          SET DP013-NO-ROLLBACK TO  TRUE                           TRKCS103
01525          MOVE '4410-READ-TEMP-STORAGE'                            TRKCS103
01526                                TO  DP013-PARAGRAPH                TRKCS103
01527          MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      TRKCS103
01528                                TO  DP013-MESSAGE-TEXT(1)          TRKCS103
01529          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
01530      END-IF.                                                      TRKCS103
01531                                                                   TRKCS103
01532 *    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             TRKCS103
01533                                                                   TRKCS103
01534      IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         TRKCS103
01535          INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               TRKCS103
01536      END-IF.                                                      TRKCS103
01537  EJECT                                                            TRKCS103
01538 *----------------------------------------------------------------*TRKCS103
01539 *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *TRKCS103
01540 *----------------------------------------------------------------*TRKCS103
01541                                                                   TRKCS103
01542  4420-FORMAT-LIST-LINES.                                          TRKCS103
01543                                                                   TRKCS103
01544      IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      TRKCS103
01545          SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                TRKCS103
01546          MOVE SPACES             TO MR-SCAC              (PS-SUB) TRKCS103
01547                                     MR-NAME              (PS-SUB) TRKCS103
01548                                     MR-SHIPTX            (PS-SUB) TRKCS103
01549                                     MR-QTYX              (PS-SUB) TRKCS103
01550                                     MR-PKG               (PS-SUB) TRKCS103
01551                                     MR-WEIGHTX           (PS-SUB) TRKCS103
01552      ELSE                                                         TRKCS103
01553          IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           TRKCS103
01554              MOVE ASC-SCAC          (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS103
01555                                  TO MR-SCAC              (PS-SUB) TRKCS103
01556                                                                   TRKCS103
01557              MOVE ASC-NAME          (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS103
01558                                  TO MR-NAME              (PS-SUB) TRKCS103
01559                                                                   TRKCS103
01560              MOVE ASC-SHIPMENTS     (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS103
01561                                  TO MR-SHIPT             (PS-SUB) TRKCS103
01562                                                                   TRKCS103
01563              MOVE ASC-QUANTITY      (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS103
01564                                  TO MR-QTY               (PS-SUB) TRKCS103
01565                                                                   TRKCS103
01566              MOVE ASC-PACKAGE       (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS103
01567                                  TO MR-PKG               (PS-SUB) TRKCS103
01568                                                                   TRKCS103
01569              MOVE ASC-WEIGHT        (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS103
01570                                  TO MR-WEIGHT            (PS-SUB) TRKCS103
01571                                                                   TRKCS103
01572          END-IF                                                   TRKCS103
01573      END-IF.                                                      TRKCS103
01574      SUBTRACT +1 FROM ASC-ITEM-SUB.                               TRKCS103
01575      IF  ASC-ITEM-SUB < + 1                                       TRKCS103
01576          MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  TRKCS103
01577          MOVE +1                 TO ASC-BLK-SUB                   TRKCS103
01578      END-IF.                                                      TRKCS103
01579                                                                   TRKCS103
01580 *----------------------------------------------------------------*TRKCS103
01581 *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *TRKCS103
01582 *----------------------------------------------------------------*TRKCS103
01583                                                                   TRKCS103
01584  5100-WRITE-TEMP-STORAGE.                                         TRKCS103
01585                                                                   TRKCS103
01586      MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     TRKCS103
01587                                TO  PV-LIST-ITEM-NUMBER.           TRKCS103
01588      COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           TRKCS103
01589          ASC-HIGHEST-BLOCK-WRITTEN + 1.                           TRKCS103
01590                                                                   TRKCS103
01591      EXEC CICS                                                    TRKCS103
01592          WRITEQ TS                                                TRKCS103
01593              QUEUE (ASC-DTL-QUEUE-NAME)                           TRKCS103
01594              FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               TRKCS103
01595              ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     TRKCS103
01596              RESP  (PV-CICS-RESP)                                 TRKCS103
01597      END-EXEC.                                                    TRKCS103
01598                                                                   TRKCS103
01599      IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      TRKCS103
01600          SET DP013-CICS-ABEND                                     TRKCS103
01601                        TO  TRUE                                   TRKCS103
01602          SET DP013-NO-ROLLBACK                                    TRKCS103
01603                        TO  TRUE                                   TRKCS103
01604          MOVE '5100-WRITE-TEMP-STORAGE'                           TRKCS103
01605                        TO  DP013-PARAGRAPH                        TRKCS103
01606          MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       TRKCS103
01607                        TO  DP013-MESSAGE-TEXT(1)                  TRKCS103
01608          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
01609      END-IF.                                                      TRKCS103
01610      ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             TRKCS103
01611                                                                   TRKCS103
01612  EJECT                                                            TRKCS103
01613 *----------------------------------------------------------------*TRKCS103
01614 * READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *TRKCS103
01615 *----------------------------------------------------------------*TRKCS103
01616                                                                   TRKCS103
01617  9100-READ-SEL-QUEUE.                                             TRKCS103
01618      EXEC CICS                                                    TRKCS103
01619          READQ TS                                                 TRKCS103
01620              QUEUE (ASC-SEL-QUEUE-NAME)                           TRKCS103
01621              INTO  (DP057-MESSAGE-SEL-REC)                        TRKCS103
01622              ITEM  (ASC-SEL-ITEM)                                 TRKCS103
01623              RESP  (PV-CICS-RESP)                                 TRKCS103
01624      END-EXEC.                                                    TRKCS103
01625                                                                   TRKCS103
01626      IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       TRKCS103
01627          CONTINUE                                                 TRKCS103
01628      ELSE                                                         TRKCS103
01629          SET DP013-LOGIC-ABEND                                    TRKCS103
01630              DP013-NO-ROLLBACK     TO TRUE                        TRKCS103
01631          MOVE '9100-READ-SEL-QUEUE'                               TRKCS103
01632                                    TO DP013-PARAGRAPH             TRKCS103
01633          MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   TRKCS103
01634                                    TO DP013-MESSAGE-TEXT (1)      TRKCS103
01635          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
01636      END-IF.                                                      TRKCS103
01637 *----------------------------------------------------------------*TRKCS103
01638 * UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *TRKCS103
01639 *----------------------------------------------------------------*TRKCS103
01640  9200-REWRITE-SEL-QUEUE.                                          TRKCS103
01641      EXEC CICS                                                    TRKCS103
01642           WRITEQ TS                                               TRKCS103
01643               QUEUE  (ASC-SEL-QUEUE-NAME)                         TRKCS103
01644               FROM   (DP057-MESSAGE-SEL-REC)                      TRKCS103
01645               ITEM   (ASC-SEL-ITEM)                               TRKCS103
01646               RESP   (PV-CICS-RESP)                               TRKCS103
01647               REWRITE                                             TRKCS103
01648      END-EXEC.                                                    TRKCS103
01649                                                                   TRKCS103
01650      IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   TRKCS103
01651          SET DP013-CICS-ABEND                                     TRKCS103
01652              DP013-NO-ROLLBACK     TO TRUE                        TRKCS103
01653          MOVE '9200-REWRITE-SEL-QUEUE'                            TRKCS103
01654                                    TO DP013-PARAGRAPH             TRKCS103
01655          MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   TRKCS103
01656                                    TO DP013-MESSAGE-TEXT (1)      TRKCS103
01657          PERFORM DP013-0000-PROCESS-ABEND                         TRKCS103
01658      END-IF.                                                      TRKCS103
01659                                                                   TRKCS103
01660  EJECT                                                            TRKCS103
01661 *----------------------------------------------------------------*TRKCS103
01662 *    ABEND PROCESSOR MODULE                                      *TRKCS103
01663 *----------------------------------------------------------------*TRKCS103
01664                                                                   TRKCS103
01665      COPY DPPD013.                                                TRKCS103
