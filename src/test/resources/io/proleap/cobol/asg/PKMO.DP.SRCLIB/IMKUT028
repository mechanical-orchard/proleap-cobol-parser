000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID.             IMKUT028.                                        
000600 AUTHOR.                 D. THEEL                                         
000700 INSTALLATION.           KOHLS.                                           
000800 DATE-WRITTEN            9/9/2002.                                        
000900 DATE-COMPILED.                     .                                     
001000                                                                          
001100*                                                                         
001200*-----------------------------------------------------------------        
001300*    CREATE ITEM DOMAIN STYLE EXTRACT RECORDS                             
001400*-----------------------------------------------------------------        
001500*    THE PURPOSE OF THIS PROGRAM IS TO READ IN THE BMC UNLOAD ITEM        
001600*    STYLE EXTRACT FILE, GET DEFAULT CHARACTERISTIC DESCS AND THE         
001700*    PRIVATE LABEL INDICATOR, AND THEN WRITE OUT THE ITEM STYLE           
001800*    DOMAIN EXTRACT THAT WILL BE USED BY OTHER DOMAINS FOR                
001900*    CONVERSION AND / OR DATA INTEGRITY.                                  
002000*                                                                         
002100*    WR/PITS#     DATE        DESCRIPTION                                 
002200*    --------   --------     ---------------------------------            
002300*    P000573025 09/11/03     CHANGED RMS STYL ID DISPLAY TO               
002400*                            NUMERIC                                      
002500*    WR25951    11/12/03     CHANGES FOR REPORT HIERARCHY                 
002600*                            PROJECT - CHANGE OUTPUT 1                    
002700*                            FROM SLHTT TO KY CLSN, ADD WRITING           
002800*                            NEW OUTPUT FILE WITH IMRD058.                
002900*                            CHANGE INPUT FILE FROM 90 TO 106,            
003000*                            SLHTT TO KY CLSN, ADD NEW ATTRIBUTES         
003100*                            FOR REPORT HIER AND COLLECTIONS.             
003200*    WR26741    04/26/04     P. KEBER - ADD NEW MAP RETAIL AMOUNT         
003300*                            COLUMN TO THE EXTRACT 2 FILE                 
003400*    WR27886    03/08/05     D. THEEL - ADD NEW LBL ABBR NM TO            
003500*                            TO THE EXTRACT 2 FILE AND PROCESSING.        
003600*    WR29786    12/28/05     D. THEEL -  REMOVED ALL LOGIC FOR OLD        
003700*                            OUTPUT 1 FILE.  NEW OUTPUT 1 FILE IS         
003800*                            OLD EXTRACT 2 FILE. ADDED LOGIC FOR          
003900*                            NEW PRICE TIER AND LIFESTYLE DESCS.          
004000*    WR29810    01/19/06     D. THEEL -  CHANGE PRVT-LBL-IND              
004100*                            TO LBL-TYP-CDE.                              
004200*    WR31557    12/06/06     D. THEEL -  INCREASED INPUT FILE             
004300*                            LRECL. ADDED LOGIC TO MOVE NEW               
004400*                            CUST-INTFC-DESC FROM INPUT TO OUTPUT.        
004200*    WR33492    10/03/07     P. KEBER - INCREASED INPUT FILE SIZE.        
004200*               07/14/15     C. PARMLEY - ADDED IM058-LBL-SEQ-NBR         
004700*-----------------------------------------------------------------        
004800                                                                          
004900******************************************************************        
005000 ENVIRONMENT DIVISION.                                                    
005100******************************************************************        
005200                                                                          
005300 CONFIGURATION SECTION.                                                   
005400                                                                          
005500 SOURCE-COMPUTER.        IBM-3090.                                        
005600 OBJECT-COMPUTER.        IBM-3090.                                        
005700                                                                          
005800 INPUT-OUTPUT SECTION.                                                    
005900                                                                          
006000 FILE-CONTROL.                                                            
006100                                                                          
006200     SELECT STYLE-UNLOAD-IN                                               
006300         ASSIGN TO INP01.                                                 
006400                                                                          
006500     SELECT STYLE-EXTRACT-OUT1                                            
006600         ASSIGN TO OUT01.                                                 
006700                                                                          
006800******************************************************************        
006900 DATA DIVISION.                                                           
007000******************************************************************        
007100                                                                          
007200 FILE SECTION.                                                            
007300                                                                          
007400 FD  STYLE-UNLOAD-IN                                                      
007500     RECORDING MODE IS F                                                  
007600     BLOCK CONTAINS 0 RECORDS                                             
007700     LABEL RECORDS ARE STANDARD.                                          
007800 01  STYLE-UNLOAD-IN-REC                PIC X(145).                       
007900                                                                          
008000 FD  STYLE-EXTRACT-OUT1                                                   
008100     RECORDING MODE IS F                                                  
008200     BLOCK CONTAINS 0 RECORDS                                             
008300     LABEL RECORDS ARE STANDARD.                                          
008400 01  STYLE-EXTRACT-OUT1-REC             PIC X(510).                       
008500                                                                          
008600******************************************************************        
008700 WORKING-STORAGE SECTION.                                                 
008800******************************************************************        
008900 01  ABEND-CODE                         PIC S9(04)  VALUE +0              
009000                                                    COMP SYNC.            
009100 01  PC-PROGRAM-CONSTANTS.                                                
009200     05  PC-PGM-NAME             PIC  X(08)     VALUE 'IMKUT028'.         
009300     05  PC-MAX-RETRIES          PIC S9(04)     VALUE +2                  
009400                                                     COMP SYNC.           
009500                                                                          
009600 01  PS-PROGRAM-SWITCHES.                                                 
009700     05  PS-INPUT-IND                   PIC X(01)    VALUE 'N'.           
009800         88  END-OF-INPUT                            VALUE 'Y'.           
009900     05  PS-SQL-ERROR-SW                PIC X(01)    VALUE 'N'.           
010000         88  PS-SQL-ERROR                            VALUE 'Y'.           
010100         88  PS-NO-SQL-ERROR                         VALUE 'N'.           
010200     05  PS-VENDOR-STYLE-FOUND-SW       PIC X(01)    VALUE 'N'.           
010300         88  PS-VENDOR-STYLE-FOUND                   VALUE 'Y'.           
010400         88  PS-VENDOR-STYLE-NOT-FOUND               VALUE 'N'.           
010500                                                                          
010600 01  PV-PROGRAM-VARIABLES.                                                
010700     05  PV-STYLE-RECS1-WRITTEN         PIC S9(09) VALUE +0  COMP.        
010800     05  PV-STYLE-RECS-READ             PIC S9(09) VALUE +0  COMP.        
010900     05  PV-PARAGRAPH-NAME              PIC  X(30)  VALUE SPACE.          
011000     05  PV-DB2-OPERATION               PIC  X(30)  VALUE SPACE.          
011100     05  PV-RETRY-COUNT                 PIC S9(04)  VALUE ZERO            
011200                                                    COMP SYNC.            
011300     05  PV-DISPLAY-RMS-STYL-ID         PIC  9(8) VALUE ZERO.             
011400                                                                          
011500*--------------------------------------------------                       
011600*  COPYBOOK FOR BMC STYLE UNLOAD INPUT FILE.                              
011700*--------------------------------------------------                       
011800     COPY IMRD050.                                                        
011900                                                                          
012000*--------------------------------------------------                       
012100*  COPYBOOK FOR ITEM DOMAIN STYLE EXTRACT OUTPUT FILE.                    
012200*--------------------------------------------------                       
012300     COPY IMRD058.                                                        
012400                                                                          
012500*--------------------------------------------------                       
012600*  VENDOR STYLE CHARACTERISTIC VALUE TABLE                                
012700*--------------------------------------------------                       
012800     EXEC SQL                                                             
012900         INCLUDE TVSCHVL                                                  
013000     END-EXEC.                                                            
013100                                                                          
013200*--------------------------------------------------                       
013300*  VENDOR STYLE PRIVATE LABEL TABLE                                       
013400*--------------------------------------------------                       
013500     EXEC SQL                                                             
013600         INCLUDE IMT00000                                                 
013700     END-EXEC.                                                            
013800                                                                          
013900*--------------------------------------------------                       
014000*  COMMUNICATION AREA FOR DB2                                             
014100*--------------------------------------------------                       
014200     EXEC SQL                                                             
014300         INCLUDE SQLCA                                                    
014400     END-EXEC.                                                            
014500                                                                          
014600*--------------------------------------------------                       
014700*  DB2 SQL ERROR ROUTINE                                                  
014800*--------------------------------------------------                       
014900     COPY DPWS004.                                                        
015000                                                                          
015100 PROCEDURE DIVISION.                                                      
015200*-----------------------------------------------------------------        
015300*  MAIN LINE OF THE PROGRAM PERFORMS THE                                  
015400*  INITIALIZATION ROUTINE AND CONTROLS THE PROCESSING OF THE PGM.         
015500*-----------------------------------------------------------------        
015600 0000-MAINLINE.                                                           
015700                                                                          
015800     PERFORM 0100-HOUSEKEEPING.                                           
015900                                                                          
016000     PERFORM 1000-PROCESS-INPUT-FILE                                      
016100         UNTIL END-OF-INPUT.                                              
016200                                                                          
016300     PERFORM 9000-EOJ.                                                    
016400     GOBACK.                                                              
016500                                                                          
016600*-----------------------------------------------------------------        
016700*  OPEN FILES AND PERFORM FIRST READ FROM INPUT FILE                      
016800*-----------------------------------------------------------------        
016900 0100-HOUSEKEEPING.                                                       
017000     MOVE '0100-HOUSEKEEPING               ' TO PV-PARAGRAPH-NAME.        
017100                                                                          
017200     OPEN INPUT STYLE-UNLOAD-IN                                           
017300          OUTPUT STYLE-EXTRACT-OUT1.                                      
017400                                                                          
017500     PERFORM 6000-READ-STYLE-UNLOAD-FILE.                                 
017600                                                                          
017700     IF END-OF-INPUT                                                      
017800        DISPLAY '*** '                                                    
017900        DISPLAY '*** IMKUT028 - NO INPUT STYLE RECS FOUND'                
018000        DISPLAY '*** '                                                    
018100        MOVE +4003 TO ABEND-CODE                                          
018200        PERFORM 9999-ABEND                                                
018300     END-IF.                                                              
018400                                                                          
018500*-----------------------------------------------------------------        
018600*  PROCESS ALL INPUT RECORDS AND FORMAT ITEM STYLE DOMAIN EXTRACT         
018700*  RECORDS UNTIL END OF INPUT FILE.                                       
018800*-----------------------------------------------------------------        
018900 1000-PROCESS-INPUT-FILE.                                                 
019000     MOVE '1000-PROCESS-INPUT-FILE         ' TO PV-PARAGRAPH-NAME.        
019100                                                                          
019200     MOVE IM050-RMS-STYL-ID TO PV-DISPLAY-RMS-STYL-ID.                    
019300     PERFORM 1300-GET-TKT-TYP-DESC.                                       
019400     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-TKT-TYP-DESC.                  
019500                                                                          
019600     PERFORM 1400-GET-LBL-AND-IND.                                        
019700     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-LBL-DESC.                      
019800     MOVE IMT00000-LBL-TYP-CDE    TO IM058-LBL-TYP-CDE.                   
019900     MOVE IMT00000-LBL-ABBR-NM    TO IM058-LBL-ABBR-NM.                   
020000                                                                          
020100     PERFORM 1500-GET-HNG-FOLD-DESC.                                      
020200     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-HNG-FOLD-DESC.                 
020300                                                                          
020400     PERFORM 1600-GET-KY-CLSN-DESC.                                       
020500     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-KY-CLSN-DESC.                  
020600                                                                          
020700     PERFORM 1700-GET-FBRCN-DESC.                                         
020800     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-FBRCN-DESC.                    
020900                                                                          
021000     PERFORM 1800-GET-FNSH-DESC.                                          
021100     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-FNSH-DESC.                     
021200                                                                          
021300     PERFORM 1900-GET-RTL-CLSN-DESC.                                      
021400     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-RTL-CLSN-DESC.                 
021500                                                                          
021600     PERFORM 2100-GET-ESL-DESC.                                           
021700     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-ESL-DESC.                      
021800                                                                          
021900     PERFORM 2200-GET-RPT-HIER-DESC.                                      
022000     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-RPT-HIER-DESC.                 
022100                                                                          
022200     PERFORM 2300-GET-BDY-STYL-DESC.                                      
022300     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-BDY-STYL-DESC.                 
022400                                                                          
022500     PERFORM 2400-GET-CONST-DESC.                                         
022600     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-CONST-DESC.                    
022700                                                                          
022800     PERFORM 2500-GET-FUNC-DESC.                                          
022900     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-FUNC-DESC.                     
023000                                                                          
023100     PERFORM 2600-GET-GNDR-DESC.                                          
023200     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-GNDR-DESC.                     
023300                                                                          
023400     PERFORM 2700-GET-PATRN-DESC.                                         
023500     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-PATRN-DESC.                    
023600                                                                          
023700     PERFORM 2800-GET-SLHTT-DESC.                                         
023800     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-SLHTT-DESC.                    
023900                                                                          
024000     PERFORM 2900-GET-CLLCTN-DESC.                                        
024100     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-CLLCTN-DESC.                   
024200                                                                          
024300     PERFORM 3100-GET-PRIC-TIER-DESC.                                     
024400     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-PRIC-TIER-DESC.                
024500                                                                          
024600     PERFORM 3200-GET-LFSTYL-DESC.                                        
024700     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM058-LFSTYL-DESC.                   
024800                                                                          
024900     PERFORM 1200-MOVE-DATA-TO-OUTPUT-REC.                                
025000                                                                          
025100***  WRITE STYLE OUTPUT RECORD                                            
025200     PERFORM 7000-WRITE-STYLE-OUTPUT-REC.                                 
025300                                                                          
025400     PERFORM 6000-READ-STYLE-UNLOAD-FILE.                                 
025500                                                                          
025600*-----------------------------------------------------------------        
025700* MOVE VALUES TO OUTPUT RECORD                                            
025800*-----------------------------------------------------------------        
025900 1200-MOVE-DATA-TO-OUTPUT-REC.                                            
026000     MOVE '1200-MOVE-DATA-TO-OUTPUT-REC    ' TO PV-PARAGRAPH-NAME.        
026100                                                                          
026200     MOVE IM050-RMS-STYL-ID       TO IM058-RMS-STYL-ID.                   
026300     MOVE IM050-DEPT-NBR          TO IM058-DEPT-NBR.                      
026400     MOVE IM050-MAJ-CL-NBR        TO IM058-MAJ-CL-NBR.                    
026500     MOVE IM050-SUB-CL-NBR        TO IM058-SUB-CL-NBR.                    
026600     MOVE IM050-VS-ID             TO IM058-VS-ID.                         
026700     MOVE IM050-ENT-ID            TO IM058-ENT-ID.                        
026800     MOVE IM050-VS-NBR            TO IM058-VS-NBR.                        
026900     MOVE IM050-STKR-NBR          TO IM058-STKR-NBR.                      
027000     MOVE IM050-VS-DESC           TO IM058-VS-DESC.                       
027100     MOVE IM050-MAP-UNT-RTL-AMT   TO IM058-MAP-UNT-RTL-AMT.               
027200     MOVE IM050-CUST-INTFC-DESC   TO IM058-CUST-INTFC-DESC.               
      *CLP 07/14/2015 START                                                     
027200     MOVE IM050-LBL-SEQ-NBR       TO IM058-LBL-SEQ-NBR.                   
      *CLP 07/14/2015 END                                                       
027300                                                                          
027400     MOVE SPACES                  TO IM058-ITEM-STYLE-FILLER.             
027600                                                                          
027700                                                                          
027800*-----------------------------------------------------------------        
027900* GET THE TICKET TYPE DESCRIPTION BASED ON THE TKT-TYP-SEQ-NBR            
028000* FROM THE INPUT FILE.                                                    
028100*-----------------------------------------------------------------        
028200 1300-GET-TKT-TYP-DESC.                                                   
028300     MOVE '1300-GET-TKT-TYP-DESC           ' TO PV-PARAGRAPH-NAME.        
028400                                                                          
028500     INITIALIZE DCLTVSCHVL.                                               
028600                                                                          
028700     PERFORM WITH TEST AFTER                                              
028800         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
028900           UNTIL SQLCODE = +0                                             
029000              OR SQLCODE = +100                                           
029100              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
029200         EXEC SQL                                                         
029300             SELECT CHARTC_VAL_DESC                                       
029400               INTO :VSCHVL-CHARTC-VAL-DESC                               
029500               FROM TVSCHVL                                               
029600              WHERE CHARTC_CDE     = 2                                    
029700                AND CHARTC_SEQ_NBR = :IM050-TKT-TYP-SEQ-NBR               
029800              WITH UR                                                     
029900         END-EXEC                                                         
030000                                                                          
030100         EVALUATE TRUE                                                    
030200             WHEN SQLCODE = -904                                          
030300             WHEN SQLCODE = -913                                          
030400                 CONTINUE                                                 
030500             WHEN SQLCODE = ZERO                                          
030600                 CONTINUE                                                 
030700             WHEN SQLCODE = +100                                          
030800                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
030900             WHEN OTHER                                                   
031000                 DISPLAY '** '                                            
031100                         PC-PGM-NAME                                      
031200                         ' - RMS STYL ID: '                               
031300                         PV-DISPLAY-RMS-STYL-ID                           
031400                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
031500                 PERFORM 9998-SQL-ERROR                                   
031600         END-EVALUATE                                                     
031700     END-PERFORM.                                                         
031800                                                                          
031900     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
032000         DISPLAY '** '                                                    
032100                 PC-PGM-NAME                                              
032200                 ' - RMS STYL ID: '                                       
032300                 PV-DISPLAY-RMS-STYL-ID                                   
032400         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
032500         PERFORM 9998-SQL-ERROR                                           
032600     END-IF.                                                              
032700                                                                          
032800*-----------------------------------------------------------------        
032900* GET THE LABEL DESCRIPTION AND THE PRIVATE LABEL INDICATOR               
033000* BASED ON THE INPUT FILE LABEL SEQ NBR.                                  
033100*-----------------------------------------------------------------        
033200 1400-GET-LBL-AND-IND.                                                    
033300     MOVE '1400-GET-LBL-AND-IND            ' TO PV-PARAGRAPH-NAME.        
033400                                                                          
033500     INITIALIZE DCLTVSCHVL.                                               
033600                                                                          
033700     PERFORM WITH TEST AFTER                                              
033800         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
033900           UNTIL SQLCODE = +0                                             
034000              OR SQLCODE = +100                                           
034100              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
034200         EXEC SQL                                                         
034300             SELECT A.CHARTC_VAL_DESC                                     
034400                   ,B.LBL_TYP_CDE                                         
034500                   ,B.LBL_ABBR_NM                                         
034600               INTO :VSCHVL-CHARTC-VAL-DESC                               
034700                   ,:IMT00000-LBL-TYP-CDE                                 
034800                   ,:IMT00000-LBL-ABBR-NM                                 
034900               FROM TVSCHVL A                                             
035000                   ,IMT_LBL B                                             
035100              WHERE A.CHARTC_CDE     = 3                                  
035200                AND A.CHARTC_SEQ_NBR = :IM050-LBL-SEQ-NBR                 
035300                AND A.CHARTC_SEQ_NBR = B.LBL_SEQ_NBR                      
035400              WITH UR                                                     
035500         END-EXEC                                                         
035600                                                                          
035700         EVALUATE TRUE                                                    
035800             WHEN SQLCODE = -904                                          
035900             WHEN SQLCODE = -913                                          
036000                 CONTINUE                                                 
036100             WHEN SQLCODE = ZERO                                          
036200                 CONTINUE                                                 
036300             WHEN SQLCODE = +100                                          
036400                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
036500                 MOVE ' ' TO IMT00000-LBL-TYP-CDE                         
036600                 MOVE SPACES TO IMT00000-LBL-ABBR-NM                      
036700             WHEN OTHER                                                   
036800                 DISPLAY '** '                                            
036900                         PC-PGM-NAME                                      
037000                         ' - RMS STYL ID: '                               
037100                         PV-DISPLAY-RMS-STYL-ID                           
037200                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
037300                 PERFORM 9998-SQL-ERROR                                   
037400         END-EVALUATE                                                     
037500     END-PERFORM.                                                         
037600                                                                          
037700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
037800         DISPLAY '** '                                                    
037900                 PC-PGM-NAME                                              
038000                 ' - RMS STYL ID: '                                       
038100                 PV-DISPLAY-RMS-STYL-ID                                   
038200         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
038300         PERFORM 9998-SQL-ERROR                                           
038400     END-IF.                                                              
038500                                                                          
038600*-----------------------------------------------------------------        
038700* GET THE HANG FOLD DESCRIPTION BASED ON THE HNG-FOLD-SEQ-NBR             
038800* FROM THE INPUT FILE.                                                    
038900*-----------------------------------------------------------------        
039000 1500-GET-HNG-FOLD-DESC.                                                  
039100     MOVE '1500-GET-HNG-FOLD-DESC          ' TO PV-PARAGRAPH-NAME.        
039200                                                                          
039300     INITIALIZE DCLTVSCHVL.                                               
039400                                                                          
039500     PERFORM WITH TEST AFTER                                              
039600         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
039700           UNTIL SQLCODE = +0                                             
039800              OR SQLCODE = +100                                           
039900              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
040000         EXEC SQL                                                         
040100             SELECT CHARTC_VAL_DESC                                       
040200               INTO :VSCHVL-CHARTC-VAL-DESC                               
040300               FROM TVSCHVL                                               
040400              WHERE CHARTC_CDE     = 10                                   
040500                AND CHARTC_SEQ_NBR = :IM050-HNG-FOLD-SEQ-NBR              
040600              WITH UR                                                     
040700         END-EXEC                                                         
040800                                                                          
040900         EVALUATE TRUE                                                    
041000             WHEN SQLCODE = -904                                          
041100             WHEN SQLCODE = -913                                          
041200                 CONTINUE                                                 
041300             WHEN SQLCODE = ZERO                                          
041400                 CONTINUE                                                 
041500             WHEN SQLCODE = +100                                          
041600                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
041700             WHEN OTHER                                                   
041800                 DISPLAY '** '                                            
041900                         PC-PGM-NAME                                      
042000                         ' - RMS STYL ID: '                               
042100                         PV-DISPLAY-RMS-STYL-ID                           
042200                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
042300                 PERFORM 9998-SQL-ERROR                                   
042400         END-EVALUATE                                                     
042500     END-PERFORM.                                                         
042600                                                                          
042700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
042800         DISPLAY '** '                                                    
042900                 PC-PGM-NAME                                              
043000                 ' - RMS STYL ID: '                                       
043100                 PV-DISPLAY-RMS-STYL-ID                                   
043200         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
043300         PERFORM 9998-SQL-ERROR                                           
043400     END-IF.                                                              
043500                                                                          
043600*-----------------------------------------------------------------        
043700* GET THE KEY CLASSIFICTION DESCRIPTION BASED ON THE KY-CLSN-SEQ          
043800* -NBR FROM THE INPUT FILE.                                               
043900*-----------------------------------------------------------------        
044000 1600-GET-KY-CLSN-DESC.                                                   
044100     MOVE '1600-GET-KY-CLSN-DESC           ' TO PV-PARAGRAPH-NAME.        
044200                                                                          
044300     INITIALIZE DCLTVSCHVL.                                               
044400                                                                          
044500     PERFORM WITH TEST AFTER                                              
044600         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
044700           UNTIL SQLCODE = +0                                             
044800              OR SQLCODE = +100                                           
044900              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
045000         EXEC SQL                                                         
045100             SELECT CHARTC_VAL_DESC                                       
045200               INTO :VSCHVL-CHARTC-VAL-DESC                               
045300               FROM TVSCHVL                                               
045400              WHERE CHARTC_CDE     = 8                                    
045500                AND CHARTC_SEQ_NBR = :IM050-KY-CLSN-SEQ-NBR               
045600              WITH UR                                                     
045700         END-EXEC                                                         
045800                                                                          
045900         EVALUATE TRUE                                                    
046000             WHEN SQLCODE = -904                                          
046100             WHEN SQLCODE = -913                                          
046200                 CONTINUE                                                 
046300             WHEN SQLCODE = ZERO                                          
046400                 CONTINUE                                                 
046500             WHEN SQLCODE = +100                                          
046600                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
046700             WHEN OTHER                                                   
046800                 DISPLAY '** '                                            
046900                         PC-PGM-NAME                                      
047000                         ' - RMS STYL ID: '                               
047100                         PV-DISPLAY-RMS-STYL-ID                           
047200                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
047300                 PERFORM 9998-SQL-ERROR                                   
047400         END-EVALUATE                                                     
047500     END-PERFORM.                                                         
047600                                                                          
047700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
047800         DISPLAY '** '                                                    
047900                 PC-PGM-NAME                                              
048000                 ' - RMS STYL ID: '                                       
048100                 PV-DISPLAY-RMS-STYL-ID                                   
048200         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
048300         PERFORM 9998-SQL-ERROR                                           
048400     END-IF.                                                              
048500                                                                          
048600*-----------------------------------------------------------------        
048700* GET THE FABRICATION DESCRIPTION BASED ON THE FBRCN-SEQ-NBR              
048800* FROM THE INPUT FILE.                                                    
048900*-----------------------------------------------------------------        
049000 1700-GET-FBRCN-DESC.                                                     
049100     MOVE '1700-GET-FBRCN-DESC             ' TO PV-PARAGRAPH-NAME.        
049200                                                                          
049300     INITIALIZE DCLTVSCHVL.                                               
049400                                                                          
049500     PERFORM WITH TEST AFTER                                              
049600         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
049700           UNTIL SQLCODE = +0                                             
049800              OR SQLCODE = +100                                           
049900              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
050000         EXEC SQL                                                         
050100             SELECT CHARTC_VAL_DESC                                       
050200               INTO :VSCHVL-CHARTC-VAL-DESC                               
050300               FROM TVSCHVL                                               
050400              WHERE CHARTC_CDE     = 1                                    
050500                AND CHARTC_SEQ_NBR = :IM050-FBRCN-SEQ-NBR                 
050600              WITH UR                                                     
050700         END-EXEC                                                         
050800                                                                          
050900         EVALUATE TRUE                                                    
051000             WHEN SQLCODE = -904                                          
051100             WHEN SQLCODE = -913                                          
051200                 CONTINUE                                                 
051300             WHEN SQLCODE = ZERO                                          
051400                 CONTINUE                                                 
051500             WHEN SQLCODE = +100                                          
051600                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
051700             WHEN OTHER                                                   
051800                 DISPLAY '** '                                            
051900                         PC-PGM-NAME                                      
052000                         ' - RMS STYL ID: '                               
052100                         PV-DISPLAY-RMS-STYL-ID                           
052200                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
052300                 PERFORM 9998-SQL-ERROR                                   
052400         END-EVALUATE                                                     
052500     END-PERFORM.                                                         
052600                                                                          
052700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
052800         DISPLAY '** '                                                    
052900                 PC-PGM-NAME                                              
053000                 ' - RMS STYL ID: '                                       
053100                 PV-DISPLAY-RMS-STYL-ID                                   
053200         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
053300         PERFORM 9998-SQL-ERROR                                           
053400     END-IF.                                                              
053500                                                                          
053600*-----------------------------------------------------------------        
053700* GET THE FINISH DESCRIPTION BASED ON THE FNSH-SEQ-NBR                    
053800* FROM THE INPUT FILE.                                                    
053900*-----------------------------------------------------------------        
054000 1800-GET-FNSH-DESC.                                                      
054100     MOVE '1800-GET-FNSH-DESC              ' TO PV-PARAGRAPH-NAME.        
054200                                                                          
054300     INITIALIZE DCLTVSCHVL.                                               
054400                                                                          
054500     PERFORM WITH TEST AFTER                                              
054600         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
054700           UNTIL SQLCODE = +0                                             
054800              OR SQLCODE = +100                                           
054900              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
055000         EXEC SQL                                                         
055100             SELECT CHARTC_VAL_DESC                                       
055200               INTO :VSCHVL-CHARTC-VAL-DESC                               
055300               FROM TVSCHVL                                               
055400              WHERE CHARTC_CDE     = 9                                    
055500                AND CHARTC_SEQ_NBR = :IM050-FNSH-SEQ-NBR                  
055600              WITH UR                                                     
055700         END-EXEC                                                         
055800                                                                          
055900         EVALUATE TRUE                                                    
056000             WHEN SQLCODE = -904                                          
056100             WHEN SQLCODE = -913                                          
056200                 CONTINUE                                                 
056300             WHEN SQLCODE = ZERO                                          
056400                 CONTINUE                                                 
056500             WHEN SQLCODE = +100                                          
056600                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
056700             WHEN OTHER                                                   
056800                 DISPLAY '** '                                            
056900                         PC-PGM-NAME                                      
057000                         ' - RMS STYL ID: '                               
057100                         PV-DISPLAY-RMS-STYL-ID                           
057200                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
057300                 PERFORM 9998-SQL-ERROR                                   
057400         END-EVALUATE                                                     
057500     END-PERFORM.                                                         
057600                                                                          
057700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
057800         DISPLAY '** '                                                    
057900                 PC-PGM-NAME                                              
058000                 ' - RMS STYL ID: '                                       
058100                 PV-DISPLAY-RMS-STYL-ID                                   
058200         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
058300         PERFORM 9998-SQL-ERROR                                           
058400     END-IF.                                                              
058500                                                                          
058600*-----------------------------------------------------------------        
058700* GET THE RETAIL CLASSIFICATION DESCRIPTION BASED ON THE                  
058800* RTL-CLSN-SEQ-NBR FROM THE INPUT FILE.  (SIGNING)                        
058900*-----------------------------------------------------------------        
059000 1900-GET-RTL-CLSN-DESC.                                                  
059100     MOVE '1900-GET-RTL-CLSN-DESC          ' TO PV-PARAGRAPH-NAME.        
059200                                                                          
059300     INITIALIZE DCLTVSCHVL.                                               
059400                                                                          
059500     PERFORM WITH TEST AFTER                                              
059600         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
059700           UNTIL SQLCODE = +0                                             
059800              OR SQLCODE = +100                                           
059900              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
060000         EXEC SQL                                                         
060100             SELECT CHARTC_VAL_DESC                                       
060200               INTO :VSCHVL-CHARTC-VAL-DESC                               
060300               FROM TVSCHVL                                               
060400              WHERE CHARTC_CDE     = 6                                    
060500                AND CHARTC_SEQ_NBR = :IM050-RTL-CLSN-SEQ-NBR              
060600              WITH UR                                                     
060700         END-EXEC                                                         
060800                                                                          
060900         EVALUATE TRUE                                                    
061000             WHEN SQLCODE = -904                                          
061100             WHEN SQLCODE = -913                                          
061200                 CONTINUE                                                 
061300             WHEN SQLCODE = ZERO                                          
061400                 CONTINUE                                                 
061500             WHEN SQLCODE = +100                                          
061600                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
061700             WHEN OTHER                                                   
061800                 DISPLAY '** '                                            
061900                         PC-PGM-NAME                                      
062000                         ' - RMS STYL ID: '                               
062100                         PV-DISPLAY-RMS-STYL-ID                           
062200                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
062300                 PERFORM 9998-SQL-ERROR                                   
062400         END-EVALUATE                                                     
062500     END-PERFORM.                                                         
062600                                                                          
062700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
062800         DISPLAY '** '                                                    
062900                 PC-PGM-NAME                                              
063000                 ' - RMS STYL ID: '                                       
063100                 PV-DISPLAY-RMS-STYL-ID                                   
063200         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
063300         PERFORM 9998-SQL-ERROR                                           
063400     END-IF.                                                              
063500                                                                          
063600*-----------------------------------------------------------------        
063700* GET THE ESL DESCRIPTION BASED ON THE ESL SEQ NBR FROM THE               
063800* INPUT FILE.                                                             
063900*-----------------------------------------------------------------        
064000 2100-GET-ESL-DESC.                                                       
064100     MOVE '2100-GET-ESL-DESC               ' TO PV-PARAGRAPH-NAME.        
064200                                                                          
064300     INITIALIZE DCLTVSCHVL.                                               
064400                                                                          
064500     PERFORM WITH TEST AFTER                                              
064600         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
064700           UNTIL SQLCODE = +0                                             
064800              OR SQLCODE = +100                                           
064900              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
065000         EXEC SQL                                                         
065100             SELECT CHARTC_VAL_DESC                                       
065200               INTO :VSCHVL-CHARTC-VAL-DESC                               
065300               FROM TVSCHVL                                               
065400              WHERE CHARTC_CDE     = 19                                   
065500                AND CHARTC_SEQ_NBR = :IM050-ESL-SEQ-NBR                   
065600              WITH UR                                                     
065700         END-EXEC                                                         
065800                                                                          
065900         EVALUATE TRUE                                                    
066000             WHEN SQLCODE = -904                                          
066100             WHEN SQLCODE = -913                                          
066200                 CONTINUE                                                 
066300             WHEN SQLCODE = ZERO                                          
066400                 CONTINUE                                                 
066500             WHEN SQLCODE = +100                                          
066600                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
066700             WHEN OTHER                                                   
066800                 DISPLAY '** '                                            
066900                         PC-PGM-NAME                                      
067000                         ' - RMS STYL ID: '                               
067100                         PV-DISPLAY-RMS-STYL-ID                           
067200                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
067300                 PERFORM 9998-SQL-ERROR                                   
067400         END-EVALUATE                                                     
067500     END-PERFORM.                                                         
067600                                                                          
067700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
067800         DISPLAY '** '                                                    
067900                 PC-PGM-NAME                                              
068000                 ' - RMS STYL ID: '                                       
068100                 PV-DISPLAY-RMS-STYL-ID                                   
068200         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
068300         PERFORM 9998-SQL-ERROR                                           
068400     END-IF.                                                              
068500                                                                          
068600                                                                          
068700*-----------------------------------------------------------------        
068800* GET THE REPORT HIERARCHY DESCRIPTION BASED ON THE HIER SEQ NBR          
068900* FROM THE INPUT FILE.                                                    
069000*-----------------------------------------------------------------        
069100 2200-GET-RPT-HIER-DESC.                                                  
069200     MOVE '2200-GET-RPT-HIER-DESC          ' TO PV-PARAGRAPH-NAME.        
069300                                                                          
069400     INITIALIZE DCLTVSCHVL.                                               
069500                                                                          
069600     PERFORM WITH TEST AFTER                                              
069700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
069800           UNTIL SQLCODE = +0                                             
069900              OR SQLCODE = +100                                           
070000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
070100         EXEC SQL                                                         
070200             SELECT CHARTC_VAL_DESC                                       
070300               INTO :VSCHVL-CHARTC-VAL-DESC                               
070400               FROM TVSCHVL                                               
070500              WHERE CHARTC_CDE     = 21                                   
070600                AND CHARTC_SEQ_NBR = :IM050-RPT-HIER-SEQ-NBR              
070700              WITH UR                                                     
070800         END-EXEC                                                         
070900                                                                          
071000         EVALUATE TRUE                                                    
071100             WHEN SQLCODE = -904                                          
071200             WHEN SQLCODE = -913                                          
071300                 CONTINUE                                                 
071400             WHEN SQLCODE = ZERO                                          
071500                 CONTINUE                                                 
071600             WHEN SQLCODE = +100                                          
071700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
071800             WHEN OTHER                                                   
071900                 DISPLAY '** '                                            
072000                         PC-PGM-NAME                                      
072100                         ' - RMS STYL ID: '                               
072200                         PV-DISPLAY-RMS-STYL-ID                           
072300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
072400                 PERFORM 9998-SQL-ERROR                                   
072500         END-EVALUATE                                                     
072600     END-PERFORM.                                                         
072700                                                                          
072800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
072900         DISPLAY '** '                                                    
073000                 PC-PGM-NAME                                              
073100                 ' - RMS STYL ID: '                                       
073200                 PV-DISPLAY-RMS-STYL-ID                                   
073300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
073400         PERFORM 9998-SQL-ERROR                                           
073500     END-IF.                                                              
073600                                                                          
073700*-----------------------------------------------------------------        
073800* GET THE BODY STYLE DESCRIPTION BASED ON THE BDY STYL SEQ NBR            
073900* FROM THE INPUT FILE.                                                    
074000*-----------------------------------------------------------------        
074100 2300-GET-BDY-STYL-DESC.                                                  
074200     MOVE '2300-GET-BDY-STYL-DESC          ' TO PV-PARAGRAPH-NAME.        
074300                                                                          
074400     INITIALIZE DCLTVSCHVL.                                               
074500                                                                          
074600     PERFORM WITH TEST AFTER                                              
074700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
074800           UNTIL SQLCODE = +0                                             
074900              OR SQLCODE = +100                                           
075000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
075100         EXEC SQL                                                         
075200             SELECT CHARTC_VAL_DESC                                       
075300               INTO :VSCHVL-CHARTC-VAL-DESC                               
075400               FROM TVSCHVL                                               
075500              WHERE CHARTC_CDE     = 24                                   
075600                AND CHARTC_SEQ_NBR = :IM050-BDY-STYL-SEQ-NBR              
075700              WITH UR                                                     
075800         END-EXEC                                                         
075900                                                                          
076000         EVALUATE TRUE                                                    
076100             WHEN SQLCODE = -904                                          
076200             WHEN SQLCODE = -913                                          
076300                 CONTINUE                                                 
076400             WHEN SQLCODE = ZERO                                          
076500                 CONTINUE                                                 
076600             WHEN SQLCODE = +100                                          
076700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
076800             WHEN OTHER                                                   
076900                 DISPLAY '** '                                            
077000                         PC-PGM-NAME                                      
077100                         ' - RMS STYL ID: '                               
077200                         PV-DISPLAY-RMS-STYL-ID                           
077300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
077400                 PERFORM 9998-SQL-ERROR                                   
077500         END-EVALUATE                                                     
077600     END-PERFORM.                                                         
077700                                                                          
077800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
077900         DISPLAY '** '                                                    
078000                 PC-PGM-NAME                                              
078100                 ' - RMS STYL ID: '                                       
078200                 PV-DISPLAY-RMS-STYL-ID                                   
078300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
078400         PERFORM 9998-SQL-ERROR                                           
078500     END-IF.                                                              
078600                                                                          
078700*-----------------------------------------------------------------        
078800* GET THE CONSTRUCTION DESCRIPTION BASED ON THE CONSTR SEQ NBR            
078900* FROM THE INPUT FILE.                                                    
079000*-----------------------------------------------------------------        
079100 2400-GET-CONST-DESC.                                                     
079200     MOVE '2400-GET-CONST-DESC             ' TO PV-PARAGRAPH-NAME.        
079300                                                                          
079400     INITIALIZE DCLTVSCHVL.                                               
079500                                                                          
079600     PERFORM WITH TEST AFTER                                              
079700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
079800           UNTIL SQLCODE = +0                                             
079900              OR SQLCODE = +100                                           
080000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
080100         EXEC SQL                                                         
080200             SELECT CHARTC_VAL_DESC                                       
080300               INTO :VSCHVL-CHARTC-VAL-DESC                               
080400               FROM TVSCHVL                                               
080500              WHERE CHARTC_CDE     = 25                                   
080600                AND CHARTC_SEQ_NBR = :IM050-CONST-SEQ-NBR                 
080700              WITH UR                                                     
080800         END-EXEC                                                         
080900                                                                          
081000         EVALUATE TRUE                                                    
081100             WHEN SQLCODE = -904                                          
081200             WHEN SQLCODE = -913                                          
081300                 CONTINUE                                                 
081400             WHEN SQLCODE = ZERO                                          
081500                 CONTINUE                                                 
081600             WHEN SQLCODE = +100                                          
081700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
081800             WHEN OTHER                                                   
081900                 DISPLAY '** '                                            
082000                         PC-PGM-NAME                                      
082100                         ' - RMS STYL ID: '                               
082200                         PV-DISPLAY-RMS-STYL-ID                           
082300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
082400                 PERFORM 9998-SQL-ERROR                                   
082500         END-EVALUATE                                                     
082600     END-PERFORM.                                                         
082700                                                                          
082800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
082900         DISPLAY '** '                                                    
083000                 PC-PGM-NAME                                              
083100                 ' - RMS STYL ID: '                                       
083200                 PV-DISPLAY-RMS-STYL-ID                                   
083300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
083400         PERFORM 9998-SQL-ERROR                                           
083500     END-IF.                                                              
083600                                                                          
083700*-----------------------------------------------------------------        
083800* GET THE FUNCTION DESCRIPTION BASED ON THE FUNC SEQ NBR                  
083900* FROM THE INPUT FILE.                                                    
084000*-----------------------------------------------------------------        
084100 2500-GET-FUNC-DESC.                                                      
084200     MOVE '2500-GET-FUNC-DESC              ' TO PV-PARAGRAPH-NAME.        
084300                                                                          
084400     INITIALIZE DCLTVSCHVL.                                               
084500                                                                          
084600     PERFORM WITH TEST AFTER                                              
084700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
084800           UNTIL SQLCODE = +0                                             
084900              OR SQLCODE = +100                                           
085000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
085100         EXEC SQL                                                         
085200             SELECT CHARTC_VAL_DESC                                       
085300               INTO :VSCHVL-CHARTC-VAL-DESC                               
085400               FROM TVSCHVL                                               
085500              WHERE CHARTC_CDE     = 22                                   
085600                AND CHARTC_SEQ_NBR = :IM050-FUNC-SEQ-NBR                  
085700              WITH UR                                                     
085800         END-EXEC                                                         
085900                                                                          
086000         EVALUATE TRUE                                                    
086100             WHEN SQLCODE = -904                                          
086200             WHEN SQLCODE = -913                                          
086300                 CONTINUE                                                 
086400             WHEN SQLCODE = ZERO                                          
086500                 CONTINUE                                                 
086600             WHEN SQLCODE = +100                                          
086700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
086800             WHEN OTHER                                                   
086900                 DISPLAY '** '                                            
087000                         PC-PGM-NAME                                      
087100                         ' - RMS STYL ID: '                               
087200                         PV-DISPLAY-RMS-STYL-ID                           
087300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
087400                 PERFORM 9998-SQL-ERROR                                   
087500         END-EVALUATE                                                     
087600     END-PERFORM.                                                         
087700                                                                          
087800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
087900         DISPLAY '** '                                                    
088000                 PC-PGM-NAME                                              
088100                 ' - RMS STYL ID: '                                       
088200                 PV-DISPLAY-RMS-STYL-ID                                   
088300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
088400         PERFORM 9998-SQL-ERROR                                           
088500     END-IF.                                                              
088600                                                                          
088700*-----------------------------------------------------------------        
088800* GET THE GENDER DESCRIPTION BASED ON THE GNDR SEQ NBR                    
088900* FROM THE INPUT FILE.                                                    
089000*-----------------------------------------------------------------        
089100 2600-GET-GNDR-DESC.                                                      
089200     MOVE '2600-GET-GNDR-DESC              ' TO PV-PARAGRAPH-NAME.        
089300                                                                          
089400     INITIALIZE DCLTVSCHVL.                                               
089500                                                                          
089600     PERFORM WITH TEST AFTER                                              
089700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
089800           UNTIL SQLCODE = +0                                             
089900              OR SQLCODE = +100                                           
090000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
090100         EXEC SQL                                                         
090200             SELECT CHARTC_VAL_DESC                                       
090300               INTO :VSCHVL-CHARTC-VAL-DESC                               
090400               FROM TVSCHVL                                               
090500              WHERE CHARTC_CDE     = 26                                   
090600                AND CHARTC_SEQ_NBR = :IM050-GNDR-SEQ-NBR                  
090700              WITH UR                                                     
090800         END-EXEC                                                         
090900                                                                          
091000         EVALUATE TRUE                                                    
091100             WHEN SQLCODE = -904                                          
091200             WHEN SQLCODE = -913                                          
091300                 CONTINUE                                                 
091400             WHEN SQLCODE = ZERO                                          
091500                 CONTINUE                                                 
091600             WHEN SQLCODE = +100                                          
091700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
091800             WHEN OTHER                                                   
091900                 DISPLAY '** '                                            
092000                         PC-PGM-NAME                                      
092100                         ' - RMS STYL ID: '                               
092200                         PV-DISPLAY-RMS-STYL-ID                           
092300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
092400                 PERFORM 9998-SQL-ERROR                                   
092500         END-EVALUATE                                                     
092600     END-PERFORM.                                                         
092700                                                                          
092800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
092900         DISPLAY '** '                                                    
093000                 PC-PGM-NAME                                              
093100                 ' - RMS STYL ID: '                                       
093200                 PV-DISPLAY-RMS-STYL-ID                                   
093300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
093400         PERFORM 9998-SQL-ERROR                                           
093500     END-IF.                                                              
093600                                                                          
093700*-----------------------------------------------------------------        
093800* GET THE PATTERN DESCRIPTION BASED ON THE PATRN SEQ NBR                  
093900* FROM THE INPUT FILE.                                                    
094000*-----------------------------------------------------------------        
094100 2700-GET-PATRN-DESC.                                                     
094200     MOVE '2700-GET-PATRN-DESC             ' TO PV-PARAGRAPH-NAME.        
094300                                                                          
094400     INITIALIZE DCLTVSCHVL.                                               
094500                                                                          
094600     PERFORM WITH TEST AFTER                                              
094700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
094800           UNTIL SQLCODE = +0                                             
094900              OR SQLCODE = +100                                           
095000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
095100         EXEC SQL                                                         
095200             SELECT CHARTC_VAL_DESC                                       
095300               INTO :VSCHVL-CHARTC-VAL-DESC                               
095400               FROM TVSCHVL                                               
095500              WHERE CHARTC_CDE     = 7                                    
095600                AND CHARTC_SEQ_NBR = :IM050-PATRN-SEQ-NBR                 
095700              WITH UR                                                     
095800         END-EXEC                                                         
095900                                                                          
096000         EVALUATE TRUE                                                    
096100             WHEN SQLCODE = -904                                          
096200             WHEN SQLCODE = -913                                          
096300                 CONTINUE                                                 
096400             WHEN SQLCODE = ZERO                                          
096500                 CONTINUE                                                 
096600             WHEN SQLCODE = +100                                          
096700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
096800             WHEN OTHER                                                   
096900                 DISPLAY '** '                                            
097000                         PC-PGM-NAME                                      
097100                         ' - RMS STYL ID: '                               
097200                         PV-DISPLAY-RMS-STYL-ID                           
097300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
097400                 PERFORM 9998-SQL-ERROR                                   
097500         END-EVALUATE                                                     
097600     END-PERFORM.                                                         
097700                                                                          
097800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
097900         DISPLAY '** '                                                    
098000                 PC-PGM-NAME                                              
098100                 ' - RMS STYL ID: '                                       
098200                 PV-DISPLAY-RMS-STYL-ID                                   
098300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
098400         PERFORM 9998-SQL-ERROR                                           
098500     END-IF.                                                              
098600                                                                          
098700*-----------------------------------------------------------------        
098800* GET THE SILHOUETTE DESCRIPTION BASED ON THE SLHTT SEQ NBR               
098900* FROM THE INPUT FILE.                                                    
099000*-----------------------------------------------------------------        
099100 2800-GET-SLHTT-DESC.                                                     
099200     MOVE '2800-GET-SLHTT-DESC             ' TO PV-PARAGRAPH-NAME.        
099300                                                                          
099400     INITIALIZE DCLTVSCHVL.                                               
099500                                                                          
099600     PERFORM WITH TEST AFTER                                              
099700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
099800           UNTIL SQLCODE = +0                                             
099900              OR SQLCODE = +100                                           
100000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
100100         EXEC SQL                                                         
100200             SELECT CHARTC_VAL_DESC                                       
100300               INTO :VSCHVL-CHARTC-VAL-DESC                               
100400               FROM TVSCHVL                                               
100500              WHERE CHARTC_CDE     = 23                                   
100600                AND CHARTC_SEQ_NBR = :IM050-SLHTT-SEQ-NBR                 
100700              WITH UR                                                     
100800         END-EXEC                                                         
100900                                                                          
101000         EVALUATE TRUE                                                    
101100             WHEN SQLCODE = -904                                          
101200             WHEN SQLCODE = -913                                          
101300                 CONTINUE                                                 
101400             WHEN SQLCODE = ZERO                                          
101500                 CONTINUE                                                 
101600             WHEN SQLCODE = +100                                          
101700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
101800             WHEN OTHER                                                   
101900                 DISPLAY '** '                                            
102000                         PC-PGM-NAME                                      
102100                         ' - RMS STYL ID: '                               
102200                         PV-DISPLAY-RMS-STYL-ID                           
102300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
102400                 PERFORM 9998-SQL-ERROR                                   
102500         END-EVALUATE                                                     
102600     END-PERFORM.                                                         
102700                                                                          
102800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
102900         DISPLAY '** '                                                    
103000                 PC-PGM-NAME                                              
103100                 ' - RMS STYL ID: '                                       
103200                 PV-DISPLAY-RMS-STYL-ID                                   
103300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
103400         PERFORM 9998-SQL-ERROR                                           
103500     END-IF.                                                              
103600                                                                          
103700*-----------------------------------------------------------------        
103800* GET THE COLLECTION DESCRIPTION BASED ON THE CLLCTN SEQ NBR              
103900* FROM THE INPUT FILE.                                                    
104000*-----------------------------------------------------------------        
104100 2900-GET-CLLCTN-DESC.                                                    
104200     MOVE '2900-GET-CLLCTN-DESC            ' TO PV-PARAGRAPH-NAME.        
104300                                                                          
104400     INITIALIZE DCLTVSCHVL.                                               
104500                                                                          
104600     PERFORM WITH TEST AFTER                                              
104700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
104800           UNTIL SQLCODE = +0                                             
104900              OR SQLCODE = +100                                           
105000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
105100         EXEC SQL                                                         
105200             SELECT CHARTC_VAL_DESC                                       
105300               INTO :VSCHVL-CHARTC-VAL-DESC                               
105400               FROM TVSCHVL                                               
105500              WHERE CHARTC_CDE     = 20                                   
105600                AND CHARTC_SEQ_NBR = :IM050-CLLCTN-SEQ-NBR                
105700              WITH UR                                                     
105800         END-EXEC                                                         
105900                                                                          
106000         EVALUATE TRUE                                                    
106100             WHEN SQLCODE = -904                                          
106200             WHEN SQLCODE = -913                                          
106300                 CONTINUE                                                 
106400             WHEN SQLCODE = ZERO                                          
106500                 CONTINUE                                                 
106600             WHEN SQLCODE = +100                                          
106700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
106800             WHEN OTHER                                                   
106900                 DISPLAY '** '                                            
107000                         PC-PGM-NAME                                      
107100                         ' - RMS STYL ID: '                               
107200                         PV-DISPLAY-RMS-STYL-ID                           
107300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
107400                 PERFORM 9998-SQL-ERROR                                   
107500         END-EVALUATE                                                     
107600     END-PERFORM.                                                         
107700                                                                          
107800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
107900         DISPLAY '** '                                                    
108000                 PC-PGM-NAME                                              
108100                 ' - RMS STYL ID: '                                       
108200                 PV-DISPLAY-RMS-STYL-ID                                   
108300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
108400         PERFORM 9998-SQL-ERROR                                           
108500     END-IF.                                                              
108600                                                                          
108700*-----------------------------------------------------------------        
108800* GET THE PRICE TIER DESCRIPTION BASED ON THE PRIC TIER SEQ NBR           
108900* FROM THE INPUT FILE.                                                    
109000*-----------------------------------------------------------------        
109100 3100-GET-PRIC-TIER-DESC.                                                 
109200     MOVE '3100-GET-PRIC-TIER-DESC         ' TO PV-PARAGRAPH-NAME.        
109300                                                                          
109400     INITIALIZE DCLTVSCHVL.                                               
109500                                                                          
109600     PERFORM WITH TEST AFTER                                              
109700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
109800           UNTIL SQLCODE = +0                                             
109900              OR SQLCODE = +100                                           
110000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
110100         EXEC SQL                                                         
110200             SELECT CHARTC_VAL_DESC                                       
110300               INTO :VSCHVL-CHARTC-VAL-DESC                               
110400               FROM TVSCHVL                                               
110500              WHERE CHARTC_CDE     = 31                                   
110600                AND CHARTC_SEQ_NBR = :IM050-PRIC-TIER-SEQ-NBR             
110700              WITH UR                                                     
110800         END-EXEC                                                         
110900                                                                          
111000         EVALUATE TRUE                                                    
111100             WHEN SQLCODE = -904                                          
111200             WHEN SQLCODE = -913                                          
111300                 CONTINUE                                                 
111400             WHEN SQLCODE = ZERO                                          
111500                 CONTINUE                                                 
111600             WHEN SQLCODE = +100                                          
111700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
111800             WHEN OTHER                                                   
111900                 DISPLAY '** '                                            
112000                         PC-PGM-NAME                                      
112100                         ' - RMS STYL ID: '                               
112200                         PV-DISPLAY-RMS-STYL-ID                           
112300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
112400                 PERFORM 9998-SQL-ERROR                                   
112500         END-EVALUATE                                                     
112600     END-PERFORM.                                                         
112700                                                                          
112800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
112900         DISPLAY '** '                                                    
113000                 PC-PGM-NAME                                              
113100                 ' - RMS STYL ID: '                                       
113200                 PV-DISPLAY-RMS-STYL-ID                                   
113300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
113400         PERFORM 9998-SQL-ERROR                                           
113500     END-IF.                                                              
113600                                                                          
113700*-----------------------------------------------------------------        
113800* GET THE LIFESTYLE DESCRIPTION BASED ON THE LFSTYL SEQ NBR               
113900* FROM THE INPUT FILE.                                                    
114000*-----------------------------------------------------------------        
114100 3200-GET-LFSTYL-DESC.                                                    
114200     MOVE '3200-GET-LFSTYL-DESC            ' TO PV-PARAGRAPH-NAME.        
114300                                                                          
114400     INITIALIZE DCLTVSCHVL.                                               
114500                                                                          
114600     PERFORM WITH TEST AFTER                                              
114700         VARYING PV-RETRY-COUNT FROM 1 BY 1                               
114800           UNTIL SQLCODE = +0                                             
114900              OR SQLCODE = +100                                           
115000              OR PV-RETRY-COUNT > PC-MAX-RETRIES                          
115100         EXEC SQL                                                         
115200             SELECT CHARTC_VAL_DESC                                       
115300               INTO :VSCHVL-CHARTC-VAL-DESC                               
115400               FROM TVSCHVL                                               
115500              WHERE CHARTC_CDE     = 32                                   
115600                AND CHARTC_SEQ_NBR = :IM050-LFSTYL-SEQ-NBR                
115700              WITH UR                                                     
115800         END-EXEC                                                         
115900                                                                          
116000         EVALUATE TRUE                                                    
116100             WHEN SQLCODE = -904                                          
116200             WHEN SQLCODE = -913                                          
116300                 CONTINUE                                                 
116400             WHEN SQLCODE = ZERO                                          
116500                 CONTINUE                                                 
116600             WHEN SQLCODE = +100                                          
116700                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                    
116800             WHEN OTHER                                                   
116900                 DISPLAY '** '                                            
117000                         PC-PGM-NAME                                      
117100                         ' - RMS STYL ID: '                               
117200                         PV-DISPLAY-RMS-STYL-ID                           
117300                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION         
117400                 PERFORM 9998-SQL-ERROR                                   
117500         END-EVALUATE                                                     
117600     END-PERFORM.                                                         
117700                                                                          
117800     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                                  
117900         DISPLAY '** '                                                    
118000                 PC-PGM-NAME                                              
118100                 ' - RMS STYL ID: '                                       
118200                 PV-DISPLAY-RMS-STYL-ID                                   
118300         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION         
118400         PERFORM 9998-SQL-ERROR                                           
118500     END-IF.                                                              
118600                                                                          
118700*-----------------------------------------------------------------        
118800* READ THE TVNDSTL/TMDARVS UNLOAD INPUT FILE                              
118900*-----------------------------------------------------------------        
119000 6000-READ-STYLE-UNLOAD-FILE.                                             
119100     MOVE '6000-READ-STYLE-UNLOAD-FILE     ' TO PV-PARAGRAPH-NAME.        
119200                                                                          
119300     INITIALIZE IM050-ITEM-STYLE-UNLD-REC.                                
119400                                                                          
119500     READ STYLE-UNLOAD-IN INTO IM050-ITEM-STYLE-UNLD-REC                  
119600        AT END                                                            
119700           SET END-OF-INPUT TO TRUE                                       
119800        NOT AT END                                                        
119900           ADD +1   TO PV-STYLE-RECS-READ.                                
120000                                                                          
120100*-----------------------------------------------------------------        
120200 7000-WRITE-STYLE-OUTPUT-REC.                                             
120300     MOVE '7000-WRITE-STYLE-OUTPUT-REC     ' TO PV-PARAGRAPH-NAME.        
120400                                                                          
120500     WRITE STYLE-EXTRACT-OUT1-REC                                         
120600                              FROM IM058-ITEM-STYLE-DOMAIN-REC.           
120700                                                                          
120800     ADD +1 TO PV-STYLE-RECS1-WRITTEN.                                    
120900                                                                          
121000*-----------------------------------------------------------------        
121100* 9000-EOJ-ROUTINE - CLOSES THE FILES ASSOCIATED WITH THE JOB.            
121200*-----------------------------------------------------------------        
121300 9000-EOJ.                                                                
121400     MOVE '9000-EOJ                        ' TO PV-PARAGRAPH-NAME.        
121500                                                                          
121600     DISPLAY ' '.                                                         
121700     DISPLAY '============================================='.             
121800     DISPLAY ' '.                                                         
121900     DISPLAY ' ******  IMKUT028 PROCESSING SUMMARY  ******  '.            
122000     PERFORM 9100-DISPLAY-PROCESSING-INFO.                                
122100     DISPLAY '============================================='.             
122200                                                                          
122300                                                                          
122400     CLOSE STYLE-UNLOAD-IN                                                
122500           STYLE-EXTRACT-OUT1.                                            
122600                                                                          
122700*-----------------------------------------------------------------        
122800* DISPLAY PROCESSED RECORDS COUNTS                                        
122900*-----------------------------------------------------------------        
123000 9100-DISPLAY-PROCESSING-INFO.                                            
123100     MOVE '9100-DISPLAY-PROCESSING-INFO    ' TO PV-PARAGRAPH-NAME.        
123200                                                                          
123300     DISPLAY ' '.                                                         
123400     DISPLAY '    STYLE RECORDS READ     = '                              
123500           PV-STYLE-RECS-READ.                                            
123600     DISPLAY '    STYLE RECS1   WRITTEN  = '                              
123700           PV-STYLE-RECS1-WRITTEN.                                        
123800     DISPLAY ' '.                                                         
123900*-----------------------------------------------------------------        
124000* 9800-SQL-ABEND - DISPLAY DB2 ABEND INFO                                 
124100*-----------------------------------------------------------------        
124200 9998-SQL-ERROR.                                                          
124300                                                                          
124400     SET PS-SQL-ERROR TO TRUE.                                            
124500                                                                          
124600     DISPLAY '** '                                                        
124700             PC-PGM-NAME                                                  
124800             ' ABEND IN PARAGRAPH '                                       
124900             PV-PARAGRAPH-NAME.                                           
125000     DISPLAY '** '                                                        
125100             PC-PGM-NAME                                                  
125200             ' OPERATION = ' PV-DB2-OPERATION.                            
125300                                                                          
125400*    THE FOLLOWING COPYBOOK UTILIZES MODULE DSNTIAR TO FORMAT             
125500*    THE INFO IN SQLCA INTO UNDERSTANDABLE VERBAGE.                       
125600     COPY DPPD004.                                                        
125700                                                                          
125800     EXEC SQL                                                             
125900         ROLLBACK                                                         
126000     END-EXEC.                                                            
126100                                                                          
126200     MOVE +4013 TO ABEND-CODE                                             
126300     PERFORM 9999-ABEND.                                                  
126400                                                                          
126500*-----------------------------------------------------------------        
126600* 9999-ABEND - FORCES PROGRAM ABEND WITH RETURN CODE                      
126700*-----------------------------------------------------------------        
126800 9999-ABEND.                                                              
126900                                                                          
127000     CALL 'ILBOABN0' USING ABEND-CODE.                                    
127100                                                                          
