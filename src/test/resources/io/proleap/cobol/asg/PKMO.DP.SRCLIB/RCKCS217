000100 IDENTIFICATION DIVISION.                                         00010016
000200 PROGRAM-ID.    RCKCS217.                                         00020016
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030016
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040016
000500 DATE-WRITTEN.  02/10/94.                                         00050016
000600 DATE-COMPILED.                                                   00060016
000700                                                                  00070016
000800*---------------------------------------------------------------* 00080016
000900*    TRANID      - E217                                         * 00090016
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100016
001100*    DESCRIPTION - ADD/CHANGE/DELETE PACK SLIP LINE ITEM        * 00110016
001200*    MAPSET      - RCKM217                                      * 00120016
001300*                                                               * 00130016
001400*    THIS PROGRAM ALLOWS THE USER TO ADD, CHANGE OR DELETE      * 00140016
001500*    A PACK SLIP LINE ITEM.                                     * 00150016
001600*                                                               * 00160016
001700*    AN 88 LEVEL SWITCH WAS CREATED TO DRIVE THE LOGIC WHICH    * 00170016
001800*    DICTATES WHAT "MODE" THE PROGRAM IS CURRENTLY IN.  THIS    * 00180016
001900*    PROGRAM CAN BE IN AN "ADD", "UPDATE" OR "DELETE" MODE      *F00190024
002000*    AT ANY GIVEN TIME.                                         * 00200016
002100*                                                               * 00210016
002200*    ALL "ADD" LOGIC IS CONTAINED IN THE 5000- SERIES           * 00220016
002300*    PARAGRAPHS.                                                * 00230016
002400*                                                               * 00240016
002500*    ALL "UPDATE" LOGIC IS CONTAINED IN THE 6000- SERIES        * 00250016
002600*    PARAGRAPHS.                                                * 00260016
002700*                                                               * 00270016
002800*    ALL "DELETE" LOGIC IS CONTAINED IN THE 7000- SERIES        * 00280016
002900*    PARAGRAPHS.                                                * 00290016
003000*                                                               * 00300016
003100*---------------------------------------------------------------* 00310016
003101*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              * 00310174
003102*     DATE:    10/17/2014                                       * 00310273
003103*                                                               * 00310373
003104*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# * 00310473
003105*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/17/2014    * 00310573
003110*---------------------------------------------------------------* 00311073
003130* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00313074
003140* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00314074
003150* MAKING THE CALL DYNAMIC VS STATIC.                              00315074
003160*---------------------------------------------------------------* 00316074
003200                                                                  00320016
003300 ENVIRONMENT DIVISION.                                            00330016
003400 DATA DIVISION.                                                   00340016
003500                                                                  00350016
003600 WORKING-STORAGE SECTION.                                         00360016
003700                                                                  00370016
003800 01  DK-DB2-KEYS.                                                 00380016
003900     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00390016
004000     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00400016
004100     05  DK-PKSL-LNE-NBR              PIC S9(9) COMP VALUE +0.    00410016
004200     05  DK-PKSL-LNE-NBR-SMALLINT     PIC S9(4) COMP VALUE +0.    00420016
004300     05  DK-UNT-COST-AMT              PIC S9(4)V9(3) VALUE +0     00430016
004400                                                     COMP-3.      00440016
004500     05  DK-ITM-NBR                   PIC S9(15)V    VALUE +0     00450016
004600                                                     COMP-3.      00460016
004700*---------------------------------------------------------------* 00470016
004800 01  PC-PROGRAM-CONSTANTS.                                        00480016
004900     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E217'.    00490016
005000     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS217'.00500016
005100     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC217A  '.00510016
005200     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM217 '.00520016
005300     05  PC-RCKUP006                  PIC  X(08) VALUE 'RCKUP006'.00530060
005400     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        00540016
005500                                                 COMP.            00550016
005600     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00560016
005700                                                 COMP.            00570016
005800     05  PC-1                         PIC S9(09) VALUE +1         00580016
005900                                                 COMP.            00590016
006000     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       00600016
006100     05  PC-A                         PIC X(01)  VALUE 'A'.       00610060
006200     05  PC-INACTIVE                  PIC X(01)  VALUE 'I'.       00620016
006300     05  PC-AC                        PIC X(02)  VALUE 'AC'.      00630016
006400     05  PC-CM                        PIC X(02)  VALUE 'CM'.      00640016
006500     05  PC-IN                        PIC X(02)  VALUE 'IN'.      00650016
006600     05  PC-IP                        PIC X(02)  VALUE 'IP'.      00660016
006700     05  PC-01                        PIC X(02)  VALUE '01'.      00670016
006800     05  PC-DPKUT500                  PIC X(08)  VALUE 'DPKUT500'.00680016
006900     05  PC-INTER-APPL-CODES.                                     00690016
007000         10  PC-INTER-APPL-ADD        PIC X(01)  VALUE '1'.       00700016
007100         10  PC-INTER-APPL-UPDATE     PIC X(01)  VALUE '2'.       00710016
007200         10  PC-INTER-APPL-DELETE     PIC X(01)  VALUE '3'.       00720016
007300     05  PC-999                       PIC 9(04)  VALUE 999.       00730016
007400     05  PC-1000                      PIC 9(04)  VALUE 1000.      00740016
007500     05  PC-8999                      PIC 9(04)  VALUE 8999.      00750016
007600     05  PC-9000                      PIC 9(04)  VALUE 9000.      00760016
007700     05  PC-X-000                     PIC X(03)  VALUE '000'.     00770016
007800     05  PC-X-999                     PIC X(03)  VALUE '999'.     00780016
007900*---------------------------------------------------------------**00790016
008000                                                                  00800016
008100     05  PC-TSYMSG-NUMBERS.                                       00810016
008200         10  PC-TSYMSG-00004          PIC 9(05)  VALUE 00004.     00820016
008300*            PRESS F2 TO CONFIRM REQUEST                          00830016
008400         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00840016
008500*            INVALID VALUE                                        00850016
008600         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     00860016
008700*            REQUIRED ENTRY                                       00870016
008800         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     00880016
008900*            MUST BE NUMERIC                                      00890016
009000         10  PC-TSYMSG-00009          PIC 9(05)  VALUE 00009.     00900016
009100*            INVALID DATE                                         00910016
009200         10  PC-TSYMSG-00034          PIC 9(05)  VALUE 00034.     00920016
009300*            ADD SUCCESSFUL                                       00930016
009400         10  PC-TSYMSG-00045          PIC 9(05)  VALUE 00045.     00940016
009500*            INVALID FUNCTION KEY                                 00950016
009600         10  PC-TSYMSG-00046          PIC 9(05)  VALUE 00046.     00960016
009700*            DATA NOT CHANGED; NO UPDATE PERFORMED                00970016
009800         10  PC-TSYMSG-00047          PIC 9(05)  VALUE 00047.     00980016
009900*            ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION 00990016
010000         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01000016
010100*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       01010016
010200         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01020016
010300*            UPDATE(S) SUCCESSFUL                                 01030016
010400         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01040016
010500*            TOP OF LIST                                          01050016
010600         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01060016
010700*            BOTTOM OF LIST                                       01070016
010800         10  PC-TSYMSG-00083          PIC 9(05)  VALUE 00083.     01080016
010900*            PURCHASE ORDER DOES NOT EXIST                        01090016
011000         10  PC-TSYMSG-00084          PIC 9(05)  VALUE 00084.     01100016
011100*            PURCHASE ORDER LINE DOES NOT EXIST                   01110016
011200         10  PC-TSYMSG-00115          PIC 9(05)  VALUE 00115.     01120016
011300*            DELETE SUCCESSFUL                                    01130016
011400         10  PC-TSYMSG-00116          PIC 9(05)  VALUE 00116.     01140016
011500*            CANNOT DELETE - RECORD DOES NOT EXIST                01150016
011600         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     01160016
011700*            CANNOT ADD - RECORD ALREADY EXISTS                   01170016
011800         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01180016
011900*            DATA DOES NOT EXIST                                  01190016
012000         10  PC-TSYMSG-00254          PIC 9(05)  VALUE 00254.     01200016
012100*            ERRORS OCCURRED; NO UPDATE PERFORMED                 01210016
012200         10  PC-TSYMSG-00308          PIC 9(05)  VALUE 00308.     01220016
012300*            AT LEAST ONE ENTRY IS REQUIRED                       01230016
012400         10  PC-TSYMSG-00342          PIC 9(05)  VALUE 00342.     01240016
012500*            MUST BE NUMERIC AND > ZERO                           01250016
012600         10  PC-TSYMSG-00461          PIC 9(05)  VALUE 00461.     01260016
012700*            PURCHASE ORDER NUMBER REQUIRED                       01270016
012800         10  PC-TSYMSG-00532          PIC 9(05)  VALUE 00532.     01280016
012900*            ONE OR MORE UPDATES UNSUCCESSFUL.  REFRESH TO SEE    01290016
013000         10  PC-TSYMSG-00723          PIC 9(05)  VALUE 00723.     01300016
013100*            FUNCTION VALID ONLY FOR INACTIVE                     01310016
013200         10  PC-TSYMSG-00724          PIC 9(05)  VALUE 00724.     01320016
013300*            UPDATE / DELETE IS ONLY VALID FOR ACTIVE AND INACTIVE01330016
013400         10  PC-TSYMSG-00729          PIC 9(05)  VALUE 00729.     01340016
013500*            MULTIPLE PACK SLIPS EXIST; USE THE LIST SCREEN       01350016
013600         10  PC-TSYMSG-03207          PIC 9(05)  VALUE 03207.     01360054
013700*            FUNCTION MAY NOT BE USED TO DELETE SYSTEM CREATED    01370051
013800*            F/A PACKSLIPS                                        01380051
013900         10  PC-TSYMSG-03213          PIC 9(05)  VALUE 03213.     01390054
014000*            FUNCTION MAY NOT BE USED TO UPDATE SYSTEM CREATED    01400051
014100*            F/A PACKSLIPS                                        01410051
014200         10  PC-TSYMSG-03214          PIC 9(05)  VALUE 03214.     01420054
014300*            FUNCTION MAY NOT BE USED TO ADD ITEMS FOR SYSTEM     01430051
014400*            CREATED F/A PACKSLIPS                                01440051
014500 01  PS-PROGRAM-SWITCHES.                                         01450016
014600     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01460016
014700         88  PS-ERROR                            VALUE 'Y'.       01470016
014800         88  PS-NO-ERROR                         VALUE 'N'.       01480016
014900     05  PS-PREPACK-SW                PIC X(01)  VALUE 'N'.       01490033
015000         88  PREPACK-PO                          VALUE 'Y'.       01500033
015100         88  NOT-PREPACK-PO                      VALUE 'N'.       01510033
015200     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01520016
015300         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01530016
015400         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01540016
015500     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X     VALUE 'N'.       01550060
015600         88  PS-ORIG-ASN-PKSLIP-YES              VALUE 'Y'.       01560060
015700         88  PS-ORIG-ASN-PKSLIP-NO               VALUE 'N'.       01570060
015800     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       01580016
015900         88  PS-LIST-END                         VALUE 'Y'.       01590016
016000         88  PS-NO-LIST-END                      VALUE 'N'.       01600016
016100     05  PS-PKITEM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01610016
016200         88  PS-PKITEM-FOUND                     VALUE 'Y'.       01620016
016300         88  PS-PKITEM-NOT-FOUND                 VALUE 'N'.       01630016
016400         88  PS-MULTI-PKITEM-FOUND               VALUE 'M'.       01640016
016500     05  PS-PURITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01650016
016600         88  PS-PURITM-FOUND                     VALUE 'Y'.       01660016
016700         88  PS-PURITM-NOT-FOUND                 VALUE 'N'.       01670016
016800     05  PS-PREV-UPDATE-SW            PIC X(01)  VALUE 'N'.       01680016
016900         88  PS-PREV-UPDATE                      VALUE 'Y'.       01690016
017000         88  PS-NO-PREV-UPDATE                   VALUE 'N'.       01700016
017100                                                                  01710016
017200 01  PV-PROGRAM-VARIABLES.                                        01720016
017300     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         01730016
017400                                                 COMP SYNC.       01740016
017500     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         01750016
017600                                                 COMP SYNC.       01760016
017700     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         01770016
017800                                                 COMP-3.          01780016
017900     05  PV-NULL-IND                  PIC S9(04) VALUE +0         01790016
018000                                                 COMP SYNC.       01800016
018100     05  PV-LINE-NBR-IND              PIC S9(04) VALUE +0         01810016
018200                                                 COMP SYNC.       01820016
018300     05  PV-MAX-LINE-NBR              PIC S9(04) VALUE +0         01830016
018400                                                 COMP.            01840016
018500     05  PV-NEXT-LINE-NBR             PIC S9(04) VALUE +0         01850016
018600                                                 COMP.            01860016
018700     05  PV-ORIG-PKSL-ITM-QTY         PIC S9(9) VALUE +0 COMP.    01870060
018800     05  PV-ABSTIME                   PIC S9(15) COMP.            01880016
018900     05  PV-CURRENT-TIME              PIC  9(06).                 01890016
019000     05  PV-CURRENT-DATE              PIC  9(06).                 01900016
019100     05  FILLER REDEFINES PV-CURRENT-DATE.                        01910016
019200         10  PV-CURRENT-DATE-YY       PIC  X(02).                 01920016
019300         10  PV-CURRENT-DATE-MM       PIC  X(02).                 01930016
019400         10  PV-CURRENT-DATE-DD       PIC  X(02).                 01940016
019500                                                                  01950016
019600     05  PV-CURRENT-DATE-ISO          PIC  X(10).                 01960016
019700     05  FILLER REDEFINES PV-CURRENT-DATE-ISO.                    01970016
019800         10  PV-CD-ISO-YEAR           PIC  9(04).                 01980016
019900         10  FILLER                   PIC  X(01).                 01990016
020000         10  PV-CD-ISO-MM             PIC  9(02).                 02000016
020100         10  FILLER                   PIC  X(01).                 02010016
020200         10  PV-CD-ISO-DD             PIC  9(02).                 02020016
020300                                                                  02030016
020400     05  PV-COMPARE-DATE1             PIC  X(04).                 02040016
020500     05  FILLER REDEFINES PV-COMPARE-DATE1.                       02050016
020600         10  PV-CD-YY-N               PIC  9(02).                 02060016
020700         10  PV-CD-MM-N               PIC  9(02).                 02070016
020800     05  PV-COMPARE-DATE2             PIC  X(04).                 02080016
020900     05  PV-DB2-RETURN-AREAS.                                     02090016
021000         10  PV-DB2-MONTH             PIC S9(09)   VALUE +0       02100016
021100                                                   COMP.          02110016
021200         10  PV-DB2-DAY               PIC S9(09)   VALUE +0       02120016
021300                                                   COMP.          02130016
021400         10  PV-DB2-YEAR              PIC S9(09)   VALUE +0       02140016
021500                                                   COMP.          02150016
021600         10  PV-DB2-HOUR              PIC S9(09)   VALUE +0       02160016
021700                                                   COMP.          02170016
021800         10  PV-DB2-MINUTE            PIC S9(09)   VALUE +0       02180016
021900                                                   COMP.          02190016
022000     05  PV-DISPLAY-DATE.                                         02200016
022100         10  PV-MONTH                 PIC  9(02)   VALUE ZEROES.  02210016
022200         10  FILLER                   PIC  X(01)   VALUE '-'.     02220016
022300         10  PV-DAY                   PIC  9(02)   VALUE ZEROES.  02230016
022400         10  FILLER                   PIC  X(01)   VALUE '-'.     02240016
022500         10  PV-YEAR                  PIC  9(04)   VALUE ZEROES.  02250016
022600     05  PV-DISPLAY-TIME.                                         02260016
022700         10  PV-HOUR                  PIC  9(02)   VALUE ZEROES.  02270016
022800         10  FILLER                   PIC  X(01)   VALUE ':'.     02280016
022900         10  PV-MINUTE                PIC  9(02)   VALUE ZEROES.  02290016
023000     05  PV-DB2-DATE-HOST             PIC  X(10).                 02300016
023100     05  PV-DB2-DATE                  PIC  X(10).                 02310016
023200     05  FILLER  REDEFINES PV-DB2-DATE.                           02320016
023300         10  PV-DB2-DATE-CC           PIC  X(02).                 02330016
023400         10  PV-DB2-DATE-YY           PIC  X(02).                 02340016
023500         10  FILLER                   PIC  X(01).                 02350016
023600         10  PV-DB2-DATE-MM           PIC  X(02).                 02360016
023700         10  FILLER                   PIC  X(01).                 02370016
023800         10  PV-DB2-DATE-DD           PIC  X(02).                 02380016
023900     05  PV-INTEGER                   PIC  9(6).                  02390016
024000     05  PV-REMAINDER                 PIC  9(3).                  02400016
024100     05  WS-PUBLISH-MESSAGE.                                      02410021
024200         10  FILLER                   PIC X(9)  VALUE 'RCKCS217 '.02420038
024300         10  WS-PUBLISH-PO            PIC 9(8)  VALUE 0.          02430042
024400         10  FILLER                   PIC X(14) VALUE             02440040
024500             'PSLPCK        '.                                    02450039
024600         10  FILLER                   PIC X(20) VALUE             02460027
024700             'PACKSLIP PACK RECPT '.                              02470027
024800         10  WS-PUBLISH-SKU           PIC 9(8)  VALUE 0.          02480021
024900     05  PV-PKSL-STAT-CDE             PIC  X(02)   VALUE SPACES.  02490016
025000         88 PV-PKSL-STAT-CDE-BEING-WORKED          VALUES         02500016
025100            'IP', 'CM'.                                           02510016
025200     05  PV-NIS-SKU-NBR               PIC  9(08)   VALUE ZEROES.  02520016
025300     05  PV-COMMAREA-LENGTH           PIC S9(04)   VALUE +0       02530069
025400                                                   COMP SYNC.     02540069
025500     05  PV-CICS-MSG-AREA             PIC  X(80)   VALUE SPACE.   02550071
025600     05  PV-CICS-MSG-AREA2            PIC  X(100)  VALUE SPACE.   02560070
025700     05  PV-DISPLAY-PO-NBR            PIC  9(08)   VALUE ZEROES.  02570068
025800     05  PV-DISPLAY-RCVR-SEQ-NBR      PIC  9(04)   VALUE ZEROES.  02580068
025900     05  PV-DISPLAY-LNE-NBR           PIC  9(04)   VALUE ZEROES.  02590068
026000     05  PV-DISPLAY-OPER              PIC  9(04)   VALUE ZEROES.  02600068
026100*---------------------------------------------------------------**02610016
026200                                                                  02620016
026300*----------------------------------------------------------------*02630016
026400*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *02640016
026500*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *02650016
026600*----------------------------------------------------------------*02660016
026700                                                                  02670016
026800     COPY RCWS013.                                                02680049
026900/                                                                 02690016
027000                                                                  02700016
027100*----------------------------------------------------------------*02710016
027200*    MAP LAYOUT                                                  *02720016
027300*----------------------------------------------------------------*02730016
027400                                                                  02740016
027500     COPY RCKM217.                                                02750016
027600                                                                  02760016
027700/                                                                 02770016
027800*----------------------------------------------------------------*02780016
027900*    ATTRIBUTE SETTINGS COPYBOOK.                                *02790016
028000*----------------------------------------------------------------*02800016
028100                                                                  02810016
028200     COPY DPWS015.                                                02820049
028300                                                                  02830016
028400/                                                                 02840016
028500*----------------------------------------------------------------*02850016
028600*    FUNCTION KEYS COPYBOOK                                      *02860016
028700*----------------------------------------------------------------*02870016
028800                                                                  02880016
028900     COPY DPWS016.                                                02890049
029000                                                                  02900016
029100/                                                                 02910016
029200*----------------------------------------------------------------*02920016
029300*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *02930016
029400*    SUB-ROUTINE (POKUT100).                                     *02940016
029500*----------------------------------------------------------------*02950016
029600     COPY DPWS010I.                                               02960049
029700                                                                  02970016
029800/                                                                 02980016
029900*----------------------------------------------------------------*02990016
030000*  WORK AREA PASSED IN CALL TO DPKUT500                          *03000016
030100*----------------------------------------------------------------*03010016
030200     COPY DPWS500.                                                03020049
030300                                                                  03030016
030400/                                                                 03040016
030500******************************************************************03050075
030600** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **03060075
030700** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **03070075
030800******************************************************************03080075
030900     COPY DPWS030.                                                03090049
030910     COPY DPWS930.                                                03091075
031000                                                                  03100016
031100/                                                                 03110016
031200*----------------------------------------------------------------*03120016
031300*    STANDARD COMMAREA.                                          *03130016
031400*----------------------------------------------------------------*03140016
031500                                                                  03150016
031600     COPY DPWS020.                                                03160049
031700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03170016
031800                                                                  03180016
031900*----------------------------------------------------------------*03190016
032000*    INTER-APPLICATION COMMAREA.                                 *03200016
032100*----------------------------------------------------------------*03210016
032200                                                                  03220016
032300         10  INTER-APPL-COMM-AREA PIC X(200).                     03230016
032400     COPY RCWS015.                                                03240049
032500*----------------------------------------------------------------*03250016
032600*    SPECIFIC COMMMAREA FOR RCKCS217.                            *03260016
032700*----------------------------------------------------------------*03270016
032800         10  ASC-SPECIFIC-COMMAREA.                               03280016
032900             15  ASC-USE-SELECTION-QUEUE-IND                      03290016
033000                                            PIC X(01).            03300016
033100                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        03310016
033200             15  ASC-SEL-QUEUE-NAME         PIC X(08).            03320016
033300             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    03330016
033400             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03340016
033500                                            PIC S9(09) COMP-3.    03350016
033600             15  ASC-SEL-SUB                PIC S9(04) COMP.      03360016
033700             15  ASC-SEL-ITEM               PIC S9(04) COMP.      03370016
033800             15  ASC-CURRENT-DATE           PIC X(10).            03380016
033900             15  ASC-ACTION-SW              PIC X(03).            03390016
034000                 88  ASC-ADD-PENDING        VALUE 'ADD'.          03400016
034100                 88  ASC-DELETE-PENDING     VALUE 'DEL'.          03410016
034200                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.          03420016
034300             15  ASC-DELETE-SUCCESSFUL-SW   PIC X(01).            03430016
034400                 88  ASC-DELETE-SUCCESSFUL  VALUE 'Y'.            03440016
034500             15  ASC-ADD-SUCCESSFUL-SW      PIC X(01).            03450016
034600                 88  ASC-ADD-NOT-SUCCESSFUL VALUE ' '.            03460016
034700                 88  ASC-ADD-SUCCESSFUL     VALUE 'Y'.            03470016
034800                                                                  03480016
034900             15  ASC-KEY-FIELDS.                                  03490016
035000                 20  ASC-KEY-PO-NBR.                              03500016
035100*PS 10/17/2014 CHANGE STARTS                                      03510073
035110                     25  ASC-KEY-PO-NBR-N   PIC 9(08).            03511073
035120*PS 10/17/2014 CHANGE ENDS                                        03512073
035200                 20  ASC-KEY-PKSL-NBR       PIC X(10).            03520016
035300                 20  ASC-KEY-REC-SEQ-NBRI   PIC S9(09) COMP.      03530016
035400                 20  ASC-KEY-REC-SEQ-NBR.                         03540016
035500                     25  ASC-KEY-REC-SEQ-NBR-N                    03550016
035600                                            PIC 9(04).            03560016
035700                 20  ASC-KEY-VENDOR-NAME    PIC X(30).            03570016
035800                 20  ASC-KEY-SEQ-NBR        PIC S9(04) COMP.      03580016
035900                 20  ASC-KEY-PKSL-LNE-NBR   PIC S9(09) COMP.      03590016
036000             15  ASC-SCREEN-FIELDS.                               03600016
036100                 20  ASC-PKSL-ITM-QTY.                            03610016
036200                     25  ASC-PKSL-ITM-QTY-N PIC 9(07).            03620016
036300                 20  ASC-VEND-STYL-NAME     PIC X(20).            03630016
036400                 20  ASC-VEND-DESC          PIC X(25).            03640016
036500                 20  ASC-SIZE-DESC          PIC X(25).            03650016
036600                 20  ASC-COLOR-DESC         PIC X(25).            03660016
036700                 20  ASC-UNT-COST-AMT.                            03670016
036800                     25  ASC-UNT-COST-AMT-N PIC 9(05)V9(3).       03680016
036900                 20  ASC-PKSL-LNE-NBR.                            03690016
037000                     25  ASC-PKSL-LNE-NBR-N PIC 9(04).            03700016
037100                 20  ASC-CLASS-NBR          PIC X(02).            03710016
037200                 20  ASC-SKU-SEQ-NBR        PIC X(08).            03720016
037300                 20  ASC-CREATED-BY-UID     PIC X(08).            03730016
037400                 20  ASC-CREATED-BY-DTE     PIC X(10).            03740016
037500                 20  ASC-CREATED-BY-TME     PIC X(05).            03750016
037600                 20  ASC-LAST-UPD-BY-UID    PIC X(08).            03760016
037700                 20  ASC-LAST-UPD-BY-DTE    PIC X(10).            03770016
037800                 20  ASC-LAST-UPD-BY-TME    PIC X(05).            03780016
037900                 20  ASC-PO-NBR.                                  03790016
038000*PS 10/17/2014 CHANGE STARTS                                      03800073
038010                     25  ASC-PO-NBR-N       PIC 9(08).            03801073
038020*PS 10/17/2014 CHANGE ENDS                                        03802073
038100                 20  ASC-REC-SEQ-NBR.                             03810016
038200                     25  ASC-REC-SEQ-NBR-N  PIC 9(04).            03820016
038300                 20  ASC-PKSL-NBR           PIC X(10).            03830016
038400             15  ASC-PURITM-VER-NBR         PIC S9(9)   COMP.     03840016
038500/                                                                 03850016
038600*----------------------------------------------------------------*03860016
038700*    ABEND PROCESSING COPYBOOK.                                  *03870016
038800*----------------------------------------------------------------*03880016
038900                                                                  03890016
039000     COPY DPWS013.                                                03900049
039100/                                                                 03910016
039200                                                                  03920016
039300*----------------------------------------------------------------*03930016
039400*    SYSTEM MESSAGE COPYBOOK                                     *03940016
039500*----------------------------------------------------------------*03950016
039600                                                                  03960016
039700     COPY DPRD507I.                                               03970049
039800/                                                                 03980016
039900*----------------------------------------------------------------*03990016
040000* LOGICTICS DOMAIN MODULE COPY BOOK                               04000016
040100*----------------------------------------------------------------*04010016
040200     COPY XLWS001.                                                04020049
040300/                                                                 04030016
040400******************************************************************04040068
040500*    COMMAREA COPYBOOK FOR PO-RCVR TRKNG MODULE                   04050068
040600******************************************************************04060068
040700     COPY RCWS071.                                                04070068
040800                                                                  04080068
040900*----------------------------------------------------------------*04090016
041000*    DB2 SQL COMMUNICATION AREA                                   04100016
041100*----------------------------------------------------------------*04110016
041200     EXEC SQL                                                     04120016
041300          INCLUDE SQLCA                                           04130016
041400     END-EXEC.                                                    04140016
041500                                                                  04150016
041600/                                                                 04160016
041700*----------------------------------------------------------------*04170016
041800*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        04180016
041900*----------------------------------------------------------------*04190016
042000     EXEC SQL                                                     04200016
042100          INCLUDE TPKSLIP                                         04210016
042200     END-EXEC.                                                    04220016
042300                                                                  04230016
042400/                                                                 04240016
042500*----------------------------------------------------------------*04250016
042600*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          04260016
042700*----------------------------------------------------------------*04270016
042800     EXEC SQL                                                     04280016
042900          INCLUDE TPKITEM                                         04290016
043000     END-EXEC.                                                    04300016
043100                                                                  04310016
043200/                                                                 04320016
043300*----------------------------------------------------------------*04330016
043400*    DB2 DCLGEN FOR UNMATCHED PACK SLIP ITEM TABLE                04340016
043500*----------------------------------------------------------------*04350016
043600     EXEC SQL                                                     04360016
043700          INCLUDE TUNPKSL                                         04370016
043800     END-EXEC.                                                    04380016
043900                                                                  04390016
044000/                                                                 04400016
044100*----------------------------------------------------------------*04410016
044200*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          04420016
044300*----------------------------------------------------------------*04430016
044400     EXEC SQL                                                     04440016
044500          INCLUDE TPURCHS                                         04450016
044600     END-EXEC.                                                    04460016
044700                                                                  04470016
044800/                                                                 04480016
044900*----------------------------------------------------------------*04490016
045000*    DB2 DCLGEN FOR PURCHASE ORDER LINE ITEM TABLE                04500016
045100*----------------------------------------------------------------*04510016
045200     EXEC SQL                                                     04520016
045300          INCLUDE TPURITM                                         04530016
045400     END-EXEC.                                                    04540016
045500/                                                                 04550016
045600*----------------------------------------------------------------*04560016
045700*    DB2 DCLGEN FOR THE EXTERNAL ENTERPRISE NAME TABLE            04570016
045800*----------------------------------------------------------------*04580016
045900     EXEC SQL                                                     04590016
046000          INCLUDE TENTNME                                         04600016
046100     END-EXEC.                                                    04610016
046200                                                                  04620016
046300/                                                                 04630022
046400*----------------------------------------------------------------*04640022
046500*    DB2 DCLGEN WFT_LOD_CNTL                                      04650023
046600*----------------------------------------------------------------*04660022
046700     EXEC SQL                                                     04670022
046800          INCLUDE WFT00001                                        04680023
046900     END-EXEC.                                                    04690022
047000                                                                  04700022
047100/                                                                 04710023
047200*----------------------------------------------------------------*04720023
047300*    DB2 DCLGEN WFT_LOD_XFER                                      04730023
047400*----------------------------------------------------------------*04740023
047500     EXEC SQL                                                     04750023
047600          INCLUDE WFT00002                                        04760023
047700     END-EXEC.                                                    04770023
047800                                                                  04780023
047900/                                                                 04790023
048000*----------------------------------------------------------------*04800023
048100*    DB2 DCLGEN TPOPRPK                                           04810023
048200*----------------------------------------------------------------*04820023
048300     EXEC SQL                                                     04830023
048400          INCLUDE TPOPRPK                                         04840023
048500     END-EXEC.                                                    04850023
048600                                                                  04860023
048700/                                                                 04870023
048800 LINKAGE SECTION.                                                 04880016
048900                                                                  04890016
049000 01  DFHCOMMAREA.                                                 04900016
049100     05  FILLER                       OCCURS  1 TO 4072 TIMES     04910016
049200                                      DEPENDING ON EIBCALEN.      04920016
049300         10  FILLER                   PIC X.                      04930016
049400                                                                  04940016
049500/                                                                 04950016
049600 PROCEDURE DIVISION.                                              04960016
049700                                                                  04970016
049800*----------------------------------------------------------------*04980016
049900*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *04990016
050000*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *05000016
050100*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *05010016
050200*                                                                *05020016
050300*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *05030016
050400*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *05040016
050500*----------------------------------------------------------------*05050016
050600 0000-MAIN-MODULE.                                                05060016
050700                                                                  05070016
050800     INITIALIZE DP030-CICS-API-FIELDS.                            05080016
050900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05090016
051000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05100016
051100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05110016
051200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05120016
051300     MOVE LENGTH OF RC217AI        TO DP030-MAP-LENGTH (1).       05130016
051400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05140016
051500     PERFORM 0001-CALL-CICS-ARCH-API.                             05150016
051600                                                                  05160016
051700     PERFORM 1000-CONTROL-PROCESSING.                             05170016
051800                                                                  05180016
051900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05190016
052000     PERFORM 0001-CALL-CICS-ARCH-API.                             05200016
052100                                                                  05210016
052200/                                                                 05220016
052300 0001-CALL-CICS-ARCH-API.                                         05230016
052400                                                                  05240016
052510     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05251075
052600                                    DFHCOMMAREA                   05260075
052700                                    DP030-CICS-API-FIELDS         05270075
052800                                    DP020-STANDARD-COMMAREA       05280075
052900                                    RC217AI.                      05290075
053000                                                                  05300016
053100     IF  DP030-RC-CALL-SUCCESSFUL                                 05310016
053200         CONTINUE                                                 05320016
053300     ELSE                                                         05330016
053400         SET DP013-NO-ROLLBACK                                    05340016
053500             DP013-XCTL-DISPLAY-RESTART                           05350016
053600             DP013-CICS-ABEND      TO TRUE                        05360016
053700         MOVE 'BEFORE 0000-MAIN-MODULE'                           05370016
053800                                   TO DP013-PARAGRAPH             05380016
053810         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O05381075
053820-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05382075
054100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05410016
054200         PERFORM DP013-0000-PROCESS-ABEND                         05420016
054300     END-IF.                                                      05430016
054400                                                                  05440016
054500/                                                                 05450016
054600*----------------------------------------------------------------*05460016
054700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05470016
054800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05480016
054900*----------------------------------------------------------------*05490016
055000                                                                  05500016
055100 1000-CONTROL-PROCESSING.                                         05510016
055200                                                                  05520016
055300     EVALUATE TRUE                                                05530016
055400         WHEN DP020-NEXT-ACT-INITIAL                              05540016
055500              INITIALIZE ASC-SPECIFIC-COMMAREA                    05550016
055600              PERFORM 1100-PROCESS-INTER-APPL-COMM                05560016
055700              PERFORM 4000-BUILD-INITIAL-PANEL                    05570016
055800              PERFORM 3200-RESET-ATTRIBUTES                       05580016
055900                                                                  05590016
056000         WHEN DP020-NEXT-ACT-READ-MAP                             05600016
056100              PERFORM 2000-PROCESS-PANEL                          05610016
056200                                                                  05620016
056300         WHEN DP020-NEXT-ACT-RETURN                               05630016
056400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05640016
056500                                                                  05650016
056600         WHEN OTHER                                               05660016
056700              SET DP013-LOGIC-ABEND                               05670016
056800                  DP013-NO-ROLLBACK                               05680016
056900                                   TO TRUE                        05690016
057000              MOVE '1000-CONTROL-PROCESSING'                      05700016
057100                                   TO DP013-PARAGRAPH             05710016
057200              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  05720016
057300                                   TO DP013-MESSAGE-TEXT(1)       05730016
057400              MOVE DP020-NEXT-APPL-ACTIVITY                       05740016
057500                                   TO DP013-MESSAGE-TEXT(2)       05750016
057600              PERFORM DP013-0000-PROCESS-ABEND                    05760016
057700     END-EVALUATE.                                                05770016
057800                                                                  05780016
057900/                                                                 05790016
058000*----------------------------------------------------------------*05800016
058100*    SAVE THE KEYS PASSED IN THE INTER-APPL COMMAREA             *05810016
058200*----------------------------------------------------------------*05820016
058300 1100-PROCESS-INTER-APPL-COMM.                                    05830016
058400                                                                  05840016
058500     SET PS-COMMAREA-VALID         TO TRUE.                       05850016
058600                                                                  05860016
058700     MOVE RC015-PO-NBR             TO DK-PO-NBR                   05870016
058800                                      ASC-KEY-PO-NBR-N            05880016
058900                                      ASC-PO-NBR-N.               05890016
059000                                                                  05900016
059100     MOVE RC015-REC-SEQ-NBR        TO ASC-KEY-REC-SEQ-NBR-N       05910016
059200                                      ASC-REC-SEQ-NBR-N           05920016
059300                                      DK-REC-SEQ-NBR.             05930016
059400                                                                  05940016
059500     MOVE RC015-PKSL-NBR           TO ASC-KEY-PKSL-NBR            05950016
059600                                      ASC-PKSL-NBR.               05960016
059700     MOVE RC015-SEQ-NBR            TO ASC-KEY-SEQ-NBR.            05970016
059800                                                                  05980016
059900     EVALUATE DP020-INT-APPL-FORMAT-IND                           05990016
060000         WHEN PC-INTER-APPL-ADD                                   06000016
060100             SET ASC-ADD-PENDING   TO TRUE                        06010016
060200         WHEN PC-INTER-APPL-UPDATE                                06020016
060300         WHEN PC-INTER-APPL-DELETE                                06030016
060400             IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO             06040016
060500                 MOVE PC-TSYMSG-00057                             06050016
060600                                   TO DP020-MSG-NUMBER            06060016
060700                 SET DP020-MSG-FATAL                              06070016
060800                                   TO TRUE                        06080016
060900                 SET DP020-NEXT-ACT-APPL-ERROR                    06090016
061000                                   TO TRUE                        06100016
061100                 SET PS-ERROR      TO TRUE                        06110016
061200             ELSE                                                 06120016
061300                 SET ASC-USE-SELECTION-QUEUE                      06130016
061400                                   TO TRUE                        06140016
061500                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              06150016
061600                                   TO ASC-NUMBER-OF-SELECTED-ITEMS06160016
061700                 MOVE RC015-NUMBER-OF-TS-ITEMS                    06170016
061800                                   TO ASC-NUMBER-OF-TS-ITEMS      06180016
061900                 MOVE RC015-SEL-QUEUE-NAME                        06190016
062000                                   TO ASC-SEL-QUEUE-NAME          06200016
062100                 PERFORM 1120-PREPARE-LIST-ENTRY                  06210016
062200                 IF DP020-INT-APPL-FORMAT-IND =                   06220016
062300                    PC-INTER-APPL-UPDATE                          06230016
062400                     SET ASC-UPDATE-PENDING                       06240016
062500                                   TO TRUE                        06250016
062600                 ELSE                                             06260016
062700                     IF RC013-PKSL-STAT-CDE (ASC-SEL-SUB) = 'AC'  06270016
062800                         MOVE PC-TSYMSG-00723                     06280016
062900                                   TO DP020-MSG-NUMBER            06290016
063000                         SET DP020-MSG-FATAL                      06300016
063100                             DP020-NEXT-ACT-APPL-ERROR            06310016
063200                             PS-ERROR                             06320016
063300                                   TO TRUE                        06330016
063400                     ELSE                                         06340016
063500                         SET ASC-DELETE-PENDING                   06350016
063600                         DP020-MSG-INFORMATIONAL                  06360016
063700                                   TO TRUE                        06370016
063800                         MOVE PC-TSYMSG-00004                     06380016
063900                                   TO DP020-MSG-NUMBER            06390016
064000                     END-IF                                       06400016
064100                 END-IF                                           06410016
064200             END-IF                                               06420016
064300     END-EVALUATE.                                                06430016
064400                                                                  06440016
064500/                                                                 06450016
064600*----------------------------------------------------------------*06460016
064700*    ENTRY IS FROM A LIST.  GET THE PO NUMBER FROM THE           *06470016
064800*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *06480016
064900*----------------------------------------------------------------*06490016
065000 1120-PREPARE-LIST-ENTRY.                                         06500016
065100                                                                  06510016
065200     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                06520016
065300     MOVE ZERO                     TO ASC-SEL-ITEM.               06530016
065400                                                                  06540016
065500     PERFORM 2110-GET-NEXT-PACK-SLIP-SELECT.                      06550016
065600                                                                  06560016
065700/                                                                 06570016
065800*----------------------------------------------------------------*06580016
065900*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*06590016
066000*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*06600016
066100*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *06610016
066200*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *06620016
066300*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *06630016
066400*----------------------------------------------------------------*06640016
066500                                                                  06650016
066600 2000-PROCESS-PANEL.                                              06660016
066700                                                                  06670016
066800     EVALUATE TRUE                                                06680016
066900                                                                  06690016
067000         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    06700016
067100             IF  ASC-DELETE-SUCCESSFUL                            06710016
067200                 MOVE PC-TSYMSG-00116                             06720016
067300                                   TO DP020-MSG-NUMBER            06730016
067400                 SET DP020-MSG-FATAL                              06740016
067500                     PS-ERROR      TO TRUE                        06750016
067600                 PERFORM 3200-RESET-ATTRIBUTES                    06760016
067700             ELSE                                                 06770016
067800                 SET DP030-CONTINUE-GO                            06780016
067900                                   TO TRUE                        06790016
068000                 PERFORM 7000-DELETE-PACK-SLIP-SELECT             06800016
068100             END-IF                                               06810016
068200                                                                  06820016
068300         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  06830016
068400             MOVE ASC-KEY-PO-NBR-N TO RC015-PO-NBR                06840016
068500             IF ASC-KEY-REC-SEQ-NBR NUMERIC                       06850016
068600                 MOVE ASC-KEY-REC-SEQ-NBR-N                       06860016
068700                                   TO RC015-REC-SEQ-NBR           06870016
068800             ELSE                                                 06880016
068900                 MOVE ZEROES       TO RC015-REC-SEQ-NBR           06890016
069000             END-IF                                               06900016
069100             MOVE ASC-KEY-PKSL-NBR TO RC015-PKSL-NBR              06910016
069200                                                                  06920016
069300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06930016
069400             IF  ASC-ADD-PENDING AND                              06940016
069500                 DP020-SRC-AID = DP016-PF13                       06950016
069600                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             06960016
069700                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               06970016
069800                 IF  PS-NO-ERROR                                  06980016
069900                     SET DP030-CONTINUE-GO                        06990016
070000                                   TO TRUE                        07000016
070100                     PERFORM 5000-ADD-PACK-SLIP-SELECT            07010016
070200                 ELSE                                             07020016
070300                     SET DP030-OVERRIDE-GO                        07030016
070400                                   TO TRUE                        07040016
070500                 END-IF                                           07050016
070600             END-IF                                               07060016
070700                                                                  07070016
070800         WHEN DP020-SRC-AID = DP016-CLEAR                         07080016
070900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07090016
071000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07100016
071100                                                                  07110016
071200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07120016
071300             IF  ASC-DELETE-SUCCESSFUL                            07130016
071400                 MOVE PC-TSYMSG-00116                             07140016
071500                                   TO DP020-MSG-NUMBER            07150016
071600                 SET DP030-DONT-ERASE                             07160016
071700                     DP030-SEND-DATAONLY (PC-APPL-MAP)            07170016
071800                     DP020-MSG-FATAL                              07180016
071900                                   TO TRUE                        07190016
072000             ELSE                                                 07200016
072100                 INITIALIZE ASC-SCREEN-FIELDS                     07210016
072200                 MOVE ASC-KEY-PO-NBR-N                            07220016
072300                                   TO DK-PO-NBR                   07230016
072400                                      ASC-PO-NBR-N                07240016
072500                 MOVE ASC-KEY-PKSL-NBR                            07250016
072600                                   TO ASC-PKSL-NBR                07260016
072700                                                                  07270016
072800                 IF (ASC-ADD-PENDING                              07280016
072900                 AND ASC-ADD-NOT-SUCCESSFUL)                      07290016
073000                     PERFORM 4500-BUILD-INITIAL-ADD-PANEL         07300016
073100                 ELSE                                             07310016
073200                     MOVE ASC-KEY-PKSL-LNE-NBR                    07320016
073300                                   TO ASC-PKSL-LNE-NBR-N          07330016
073400                                      DK-PKSL-LNE-NBR             07340016
073500                     PERFORM 4000-BUILD-INITIAL-PANEL             07350016
073600                 END-IF                                           07360016
073700                 PERFORM 3200-RESET-ATTRIBUTES                    07370016
073800             END-IF                                               07380016
073900                                                                  07390016
074000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07400016
074100             IF  ASC-USE-SELECTION-QUEUE                          07410016
074200                 PERFORM 2110-GET-NEXT-PACK-SLIP-SELECT           07420016
074300                 IF PS-LIST-END                                   07430016
074400                    SET PS-NO-LIST-END                            07440016
074500                                   TO TRUE                        07450016
074600                 ELSE                                             07460016
074700                     MOVE ASC-KEY-PO-NBR-N                        07470016
074800                                   TO DK-PO-NBR                   07480016
074900                                      ASC-PO-NBR-N                07490016
075000                     MOVE ASC-KEY-REC-SEQ-NBR-N                   07500016
075100                                   TO ASC-REC-SEQ-NBR-N           07510016
075200                                      DK-REC-SEQ-NBR              07520016
075300                                                                  07530016
075400                     MOVE ASC-KEY-PKSL-NBR                        07540016
075500                                   TO ASC-PKSL-NBR                07550016
075600                     PERFORM 4000-BUILD-INITIAL-PANEL             07560016
075700                     PERFORM 3200-RESET-ATTRIBUTES                07570016
075800                     MOVE SPACES   TO ASC-DELETE-SUCCESSFUL-SW    07580016
075900                 END-IF                                           07590016
076000             ELSE                                                 07600016
076100*                --- BOTTOM OF LIST ---                           07610016
076200                 MOVE PC-TSYMSG-00070                             07620016
076300                                   TO DP020-MSG-NUMBER            07630016
076400                 SET DP020-MSG-INFORMATIONAL                      07640016
076500                     PS-LIST-END   TO TRUE                        07650016
076600             END-IF                                               07660016
076700                                                                  07670016
076800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             07680016
076900             IF  ASC-USE-SELECTION-QUEUE                          07690016
077000                 PERFORM 2120-GET-PREV-PACK-SLIP-SELECT           07700016
077100                 IF PS-LIST-END                                   07710016
077200                     SET PS-NO-LIST-END                           07720016
077300                                   TO TRUE                        07730016
077400                 ELSE                                             07740016
077500                     MOVE ASC-KEY-PO-NBR-N                        07750016
077600                                   TO DK-PO-NBR                   07760016
077700                                      ASC-PO-NBR-N                07770016
077800                     MOVE ASC-KEY-REC-SEQ-NBR-N                   07780016
077900                                   TO ASC-REC-SEQ-NBR-N           07790016
078000                                      DK-REC-SEQ-NBR              07800016
078100                                                                  07810016
078200                     MOVE ASC-KEY-PKSL-NBR                        07820016
078300                                   TO ASC-PKSL-NBR                07830016
078400                     PERFORM 4000-BUILD-INITIAL-PANEL             07840016
078500                     PERFORM 3200-RESET-ATTRIBUTES                07850016
078600                     MOVE SPACES   TO ASC-DELETE-SUCCESSFUL-SW    07860016
078700                 END-IF                                           07870016
078800             ELSE                                                 07880016
078900*                --- TOP OF LIST ---                              07890016
079000                 MOVE PC-TSYMSG-00069                             07900016
079100                                   TO DP020-MSG-NUMBER            07910016
079200                 SET DP020-MSG-INFORMATIONAL                      07920016
079300                     PS-LIST-END   TO TRUE                        07930016
079400             END-IF                                               07940016
079500                                                                  07950016
079600         WHEN OTHER                                               07960016
079700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07970016
079800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07980016
079900             IF  PS-NO-ERROR                                      07990016
080000                 SET DP030-CONTINUE-GO                            08000016
080100                                   TO TRUE                        08010016
080200                 PERFORM 2100-CHECK-FUNCTION-KEY                  08020016
080300             ELSE                                                 08030016
080400                 SET DP030-OVERRIDE-GO                            08040016
080500                                   TO TRUE                        08050016
080600             END-IF                                               08060016
080700     END-EVALUATE.                                                08070016
080800                                                                  08080016
080900/                                                                 08090016
081000*----------------------------------------------------------------*08100016
081100*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *08110016
081200*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*08120016
081300*    FROM THE CICS ARCHITECTURE API.                             *08130016
081400*----------------------------------------------------------------*08140016
081500                                                                  08150016
081600 2100-CHECK-FUNCTION-KEY.                                         08160016
081700                                                                  08170016
081800     EVALUATE TRUE                                                08180016
081900         WHEN DP020-SRC-AID = DP016-ENTER                         08190016
082000             CONTINUE                                             08200016
082100                                                                  08210016
082200         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              08220016
082300             SET DP030-CONTINUE-GO TO TRUE                        08230016
082400             PERFORM 6000-UPDATE-PACK-SLIP-SELECT                 08240016
082500                                                                  08250016
082600         WHEN OTHER                                               08260016
082700             SET DP013-NO-ROLLBACK                                08270016
082800                 DP013-XCTL-DISPLAY-RESTART                       08280016
082900                 DP013-CICS-ABEND  TO TRUE                        08290016
083000             MOVE '2100-CHECK-FUNCTION-KEY'                       08300016
083100                                   TO DP013-PARAGRAPH             08310016
083200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08320016
083300                                   TO DP013-MESSAGE-TEXT (1)      08330016
083400             PERFORM DP013-0000-PROCESS-ABEND                     08340016
083500     END-EVALUATE.                                                08350016
083600                                                                  08360016
083700/                                                                 08370016
083800*----------------------------------------------------------------*08380016
083900*    GET THE PACK SLIP NUMBER (KEY) OF THE NEXT SELECTED OBJECT  *08390016
084000*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *08400016
084100*----------------------------------------------------------------*08410016
084200 2110-GET-NEXT-PACK-SLIP-SELECT.                                  08420016
084300                                                                  08430016
084400     ADD +1                        TO ASC-SEL-SUB.                08440016
084500     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            08450016
084600         ADD +1                    TO ASC-SEL-ITEM                08460016
084700         MOVE +1                   TO ASC-SEL-SUB                 08470016
084800     END-IF.                                                      08480016
084900                                                                  08490016
085000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08500016
085100         PERFORM 9100-READ-SEL-QUEUE                              08510016
085200         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      08520016
085300             MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)              08530016
085400                                   TO ASC-PKSL-LNE-NBR-N          08540016
085500                                      ASC-KEY-PKSL-LNE-NBR        08550016
085600                                      DK-PKSL-LNE-NBR             08560016
085700             SET RC013-INQ             (ASC-SEL-SUB)              08570016
085800                                   TO TRUE                        08580016
085900             PERFORM 9200-REWRITE-SEL-QUEUE                       08590016
086000         ELSE                                                     08600016
086100             SUBTRACT +1 FROM ASC-SEL-SUB                         08610016
086200*            --- BOTTOM OF LIST ---                               08620016
086300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            08630016
086400             SET DP020-MSG-INFORMATIONAL                          08640016
086500                 PS-LIST-END                                      08650016
086600                                   TO TRUE                        08660016
086700         END-IF                                                   08670016
086800     ELSE                                                         08680016
086900         SUBTRACT +1 FROM ASC-SEL-ITEM                            08690016
087000         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 08700016
087100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            08710016
087200         SET DP020-MSG-INFORMATIONAL                              08720016
087300             PS-LIST-END                                          08730016
087400                                   TO TRUE                        08740016
087500     END-IF.                                                      08750016
087600                                                                  08760016
087700/                                                                 08770016
087800*----------------------------------------------------------------*08780016
087900*    GET THE PO NUMBER (KEY) OF THE PREVIOUS SELECTED            *08790016
088000*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *08800016
088100*----------------------------------------------------------------*08810016
088200 2120-GET-PREV-PACK-SLIP-SELECT.                                  08820016
088300                                                                  08830016
088400     SUBTRACT +1 FROM ASC-SEL-SUB.                                08840016
088500     IF  ASC-SEL-SUB < +1                                         08850016
088600         SUBTRACT +1 FROM ASC-SEL-ITEM                            08860016
088700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 08870016
088800     END-IF.                                                      08880016
088900                                                                  08890016
089000     IF  ASC-SEL-ITEM > ZERO                                      08900016
089100         PERFORM 9100-READ-SEL-QUEUE                              08910016
089200         INITIALIZE ASC-SCREEN-FIELDS                             08920016
089300         MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)                  08930016
089400                                   TO ASC-PKSL-LNE-NBR-N          08940016
089500                                      ASC-KEY-PKSL-LNE-NBR        08950016
089600                                      DK-PKSL-LNE-NBR             08960016
089700     ELSE                                                         08970016
089800         MOVE +1                   TO ASC-SEL-ITEM                08980016
089900                                      ASC-SEL-SUB                 08990016
090000*        --- TOP OF LIST ---                                      09000016
090100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            09010016
090200         SET DP020-MSG-INFORMATIONAL                              09020016
090300             PS-LIST-END           TO TRUE                        09030016
090400     END-IF.                                                      09040016
090500/                                                                 09050016
090600*----------------------------------------------------------------*09060016
090700*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *09070016
090800*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *09080016
090900*----------------------------------------------------------------*09090016
091000 2200-MOVE-SCREEN-TO-COMMAREA.                                    09100016
091100                                                                  09110016
091200     IF AQTYL > ZERO                                              09120016
091300         MOVE AQTYI                TO ASC-PKSL-ITM-QTY            09130016
091400     ELSE                                                         09140016
091500         IF AQTYF = DP015-ERASE-EOF                               09150016
091600             MOVE ZEROS            TO ASC-PKSL-ITM-QTY-N          09160016
091700         END-IF                                                   09170016
091800     END-IF.                                                      09180016
091900                                                                  09190016
092000     IF ASTYLEL > ZERO                                            09200016
092100         MOVE ASTYLEI              TO ASC-VEND-STYL-NAME          09210016
092200     ELSE                                                         09220016
092300         IF ASTYLEF = DP015-ERASE-EOF                             09230016
092400             MOVE SPACES           TO ASC-VEND-STYL-NAME          09240016
092500         END-IF                                                   09250016
092600     END-IF.                                                      09260016
092700                                                                  09270016
092800     IF ADESCL > ZERO                                             09280016
092900         MOVE ADESCI               TO ASC-VEND-DESC               09290016
093000     ELSE                                                         09300016
093100         IF ADESCF = DP015-ERASE-EOF                              09310016
093200             MOVE SPACES           TO ASC-VEND-DESC               09320016
093300         END-IF                                                   09330016
093400     END-IF.                                                      09340016
093500                                                                  09350016
093600     IF ASIZEL > ZERO                                             09360016
093700         MOVE ASIZEI               TO ASC-SIZE-DESC               09370016
093800     ELSE                                                         09380016
093900         IF ASIZEF = DP015-ERASE-EOF                              09390016
094000             MOVE SPACES           TO ASC-SIZE-DESC               09400016
094100         END-IF                                                   09410016
094200     END-IF.                                                      09420016
094300                                                                  09430016
094400     IF ACOLORL > ZERO                                            09440016
094500         MOVE ACOLORI              TO ASC-COLOR-DESC              09450016
094600     ELSE                                                         09460016
094700         IF ACOLORF = DP015-ERASE-EOF                             09470016
094800             MOVE SPACES           TO ASC-COLOR-DESC              09480016
094900         END-IF                                                   09490016
095000     END-IF.                                                      09500016
095100                                                                  09510016
095200     IF ACOSTL > ZERO                                             09520016
095300         MOVE ACOSTI               TO ASC-UNT-COST-AMT            09530016
095400     ELSE                                                         09540016
095500         IF ACOSTF = DP015-ERASE-EOF                              09550016
095600             MOVE ZEROS            TO ASC-UNT-COST-AMT-N          09560016
095700         END-IF                                                   09570016
095800     END-IF.                                                      09580016
095900                                                                  09590016
096000     IF ALINEL > ZERO                                             09600016
096100         MOVE ALINEI               TO ASC-PKSL-LNE-NBR            09610016
096200     ELSE                                                         09620016
096300         IF ALINEF = DP015-ERASE-EOF                              09630016
096400             MOVE SPACES           TO ASC-PKSL-LNE-NBR            09640016
096500         END-IF                                                   09650016
096600     END-IF.                                                      09660016
096700                                                                  09670016
096800/                                                                 09680016
096900*----------------------------------------------------------------*09690016
097000*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *09700016
097100*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *09710016
097200*----------------------------------------------------------------*09720016
097300 3000-EDIT-DATA-IN-COMMAREA.                                      09730016
097400                                                                  09740016
097500     SET PS-NO-ERROR               TO TRUE.                       09750016
097600                                                                  09760016
097700     PERFORM 3200-RESET-ATTRIBUTES.                               09770016
097800                                                                  09780016
097900     IF ASC-DELETE-PENDING                                        09790016
098000         CONTINUE                                                 09800016
098100     ELSE                                                         09810016
098200         IF ASC-PKSL-LNE-NBR = SPACES                             09820016
098300             SET DP020-MSG-FATAL                                  09830016
098400                 PS-ERROR  TO TRUE                                09840016
098500             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      09850016
098600             MOVE DP015-UNP-NUM-BRT-OFF  TO ALINEA                09860016
098700             MOVE DP015-RED              TO ALINEC                09870016
098800             MOVE DP015-REVERSE          TO ALINEH                09880016
098900             MOVE -1                     TO ALINEL                09890016
099000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09900016
099100         ELSE                                                     09910016
099200             IF  ASC-UNT-COST-AMT > SPACES                        09920016
099300                 MOVE ASC-UNT-COST-AMT                            09930016
099400                                   TO DP010I-UNEDITED-FIELD       09940016
099500                 MOVE LENGTH OF ASC-UNT-COST-AMT                  09950016
099600                                   TO DP010I-MAXIMUM-DIGITS       09960016
099700                 MOVE +3           TO DP010I-MAXIMUM-DECIMALS     09970016
099800                 SET DP010I-NEGATIVE-NOT-ALLOWED                  09980016
099900                                   TO TRUE                        09990016
100010                 CALL DP010I-NUMERIC-EDIT-ROUTINE                 10001074
100020                      USING DP010I-NUMERIC-EDIT-AREA              10002074
100100                                                                  10010016
100200                 IF  DP010I-ERROR-DETECTED                        10020016
100300                     SET DP020-MSG-FATAL                          10030016
100400                         PS-ERROR  TO TRUE                        10040016
100500                     MOVE PC-TSYMSG-00008                         10050016
100600                                   TO DP020-MSG-NUMBER            10060016
100700                     MOVE DP015-UNP-NUM-BRT-OFF                   10070016
100800                                   TO ACOSTA                      10080016
100900                     MOVE DP015-RED                               10090016
101000                                   TO ACOSTC                      10100016
101100                     MOVE DP015-REVERSE                           10110016
101200                                   TO ACOSTH                      10120016
101300                     MOVE -1       TO ACOSTL                      10130016
101400                     SET DP030-SET-CURSOR-APPL-1                  10140016
101500                                   TO TRUE                        10150016
101600                 ELSE                                             10160016
101700                     MOVE DP010I-NUMERIC-FIELD                    10170016
101800                                   TO ASC-UNT-COST-AMT-N          10180016
101900                                      DK-UNT-COST-AMT             10190016
102000                     MOVE ASC-UNT-COST-AMT-N                      10200016
102100                                   TO ACOSTO                      10210016
102200                     MOVE ACOSTO   TO ASC-UNT-COST-AMT            10220016
102300                 END-IF                                           10230016
102400             END-IF                                               10240016
102500         END-IF                                                   10250016
102600     END-IF.                                                      10260016
102700                                                                  10270016
102800     IF  ASC-PKSL-LNE-NBR > SPACES                                10280016
102900         MOVE ASC-PKSL-LNE-NBR     TO DP010I-UNEDITED-FIELD       10290016
103000         MOVE LENGTH OF ASC-PKSL-LNE-NBR                          10300016
103100                                   TO DP010I-MAXIMUM-DIGITS       10310016
103200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     10320016
103300         SET DP010I-NEGATIVE-NOT-ALLOWED                          10330016
103400                                   TO TRUE                        10340016
103510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10351074
103520              USING DP010I-NUMERIC-EDIT-AREA                      10352074
103600                                                                  10360016
103700         IF  DP010I-ERROR-DETECTED                                10370016
103800             SET PS-ERROR                                         10380016
103900                 DP020-MSG-FATAL   TO TRUE                        10390016
104000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10400016
104100             MOVE DP015-UNP-NUM-BRT-OFF                           10410016
104200                                   TO ALINEA                      10420016
104300             MOVE DP015-RED        TO ALINEC                      10430016
104400             MOVE DP015-REVERSE    TO ALINEH                      10440016
104500             MOVE -1               TO ALINEL                      10450016
104600             SET DP030-SET-CURSOR-APPL-1                          10460016
104700                                   TO TRUE                        10470016
104800         ELSE                                                     10480016
104900             MOVE DP010I-NUMERIC-FIELD TO ASC-PKSL-LNE-NBR-N      10490016
105000             MOVE ASC-PKSL-LNE-NBR TO ALINEO                      10500016
105100             EVALUATE TRUE                                        10510016
105200                 WHEN ASC-PKSL-LNE-NBR > PC-999                   10520016
105300                     IF ASC-ADD-PENDING                           10530016
105400                         SET PS-ERROR                             10540016
105500                         DP020-MSG-FATAL                          10550016
105600                                   TO TRUE                        10560016
105700                         MOVE PC-TSYMSG-00005                     10570016
105800                                   TO DP020-MSG-NUMBER            10580016
105900                         MOVE DP015-UNP-NUM-BRT-OFF               10590016
106000                                   TO ALINEA                      10600016
106100                         MOVE DP015-RED                           10610016
106200                                   TO ALINEC                      10620016
106300                         MOVE DP015-REVERSE                       10630016
106400                                   TO ALINEH                      10640016
106500                         MOVE -1   TO ALINEL                      10650016
106600                         SET DP030-SET-CURSOR-APPL-1              10660016
106700                                   TO TRUE                        10670016
106800                     END-IF                                       10680016
106900                 WHEN ASC-PKSL-LNE-NBR = ZERO                     10690016
107000                     SET PS-ERROR                                 10700016
107100                         DP020-MSG-FATAL                          10710016
107200                                   TO TRUE                        10720016
107300                     MOVE PC-TSYMSG-00342                         10730016
107400                               TO DP020-MSG-NUMBER                10740016
107500                     MOVE DP015-UNP-NUM-BRT-OFF                   10750016
107600                               TO ALINEA                          10760016
107700                     MOVE DP015-RED                               10770016
107800                               TO ALINEC                          10780016
107900                     MOVE DP015-REVERSE                           10790016
108000                               TO ALINEH                          10800016
108100                     MOVE -1   TO ALINEL                          10810016
108200                     SET DP030-SET-CURSOR-APPL-1                  10820016
108300                               TO TRUE                            10830016
108400                 WHEN OTHER                                       10840016
108500                     INITIALIZE XL001-ITEM-COMMAREA               10850016
108600                     PERFORM 9050-GET-PURITM                      10860016
108700                     IF PS-PURITM-FOUND                           10870016
108800                         MOVE PURITM-VER-NBR                      10880016
108900                                   TO ASC-PURITM-VER-NBR          10890016
109000*                        MOVE PURITM-SKU-SEQ-NBR                  10900016
109100*                                  TO ASC-SKU-SEQ-NBR             10910016
109200                                                                  10920016
109300                         IF  PURITM-SKU-SEQ-NBR = PC-X-000        10930016
109400                             MOVE '00000000' TO ASC-SKU-SEQ-NBR   10940016
109500                         ELSE                                     10950016
109600                             IF PURITM-SKU-SEQ-NBR = PC-X-999     10960016
109700                               MOVE '99999999' TO ASC-SKU-SEQ-NBR 10970016
109800                             ELSE                                 10980016
109900                                PERFORM 9070-CALL-CICS-API-ARCH   10990016
110000                     ELSE                                         11000016
110100                         SET PS-ERROR                             11010016
110200                         DP020-MSG-FATAL                          11020016
110300                                   TO TRUE                        11030016
110400                         MOVE PC-TSYMSG-00084                     11040016
110500                                   TO DP020-MSG-NUMBER            11050016
110600                         MOVE DP015-UNP-NUM-BRT-OFF               11060016
110700                                   TO ALINEA                      11070016
110800                         MOVE DP015-RED                           11080016
110900                                   TO ALINEC                      11090016
111000                         MOVE DP015-REVERSE                       11100016
111100                                   TO ALINEH                      11110016
111200                         MOVE -1   TO ALINEL                      11120016
111300                         SET DP030-SET-CURSOR-APPL-1              11130016
111400                                   TO TRUE                        11140016
111500                     END-IF                                       11150016
111600             END-EVALUATE                                         11160016
111700         END-IF                                                   11170016
111800     END-IF.                                                      11180016
111900                                                                  11190016
112000*    IF (ASC-ADD-PENDING    AND ASC-PKSL-LNE-NBR = SPACES) OR     11200016
112100*       (ASC-UPDATE-PENDING AND ASC-PKSL-LNE-NBR > PC-8999)       11210016
112200*        IF ASC-VEND-STYL-NAME = SPACES AND                       11220016
112300*           ASC-VEND-DESC      = SPACES                           11230016
112400*            SET PS-ERROR                                         11240016
112500*                DP020-MSG-FATAL   TO TRUE                        11250016
112600*            MOVE PC-TSYMSG-00308  TO DP020-MSG-NUMBER            11260016
112700*            MOVE DP015-UNP-ALP-BRT-OFF                           11270016
112800*                                  TO ASTYLEA                     11280016
112900*                                     ADESCA                      11290016
113000*            MOVE DP015-RED        TO ASTYLEC                     11300016
113100*                                     ADESCC                      11310016
113200*            MOVE DP015-REVERSE    TO ASTYLEH                     11320016
113300*                                     ADESCH                      11330016
113400*            MOVE -1               TO ASTYLEL                     11340016
113500*            SET DP030-SET-CURSOR-APPL-1                          11350016
113600*                                  TO TRUE                        11360016
113700*        END-IF                                                   11370016
113800*    END-IF.                                                      11380016
113900                                                                  11390016
114000     IF ASC-ADD-PENDING                                           11400016
114100         IF ASC-PKSL-LNE-NBR > ZEROS                              11410016
114200             IF ASC-VEND-STYL-NAME > SPACES OR                    11420016
114300                ASC-VEND-DESC      > SPACES OR                    11430016
114400                ASC-SIZE-DESC      > SPACES OR                    11440016
114500                ASC-COLOR-DESC     > SPACES OR                    11450016
114600                ASC-UNT-COST-AMT   > ZEROES                       11460016
114700                 SET DP020-MSG-FATAL                              11470016
114800                     PS-ERROR      TO TRUE                        11480016
114900                 MOVE PC-TSYMSG-00005                             11490016
115000                                   TO DP020-MSG-NUMBER            11500016
115100                 MOVE DP015-UNP-NUM-BRT-OFF                       11510016
115200                                   TO ALINEA                      11520016
115300                 MOVE DP015-RED    TO ALINEC                      11530016
115400                 MOVE DP015-REVERSE                               11540016
115500                                   TO ALINEH                      11550016
115600                 MOVE -1           TO ALINEL                      11560016
115700                 SET DP030-SET-CURSOR-APPL-1                      11570016
115800                                   TO TRUE                        11580016
115900             END-IF                                               11590016
116000         END-IF                                                   11600016
116100     END-IF.                                                      11610016
116200                                                                  11620016
116300     IF  ASC-PKSL-ITM-QTY > SPACES                                11630016
116400         MOVE ASC-PKSL-ITM-QTY     TO DP010I-UNEDITED-FIELD       11640016
116500         MOVE LENGTH OF ASC-PKSL-ITM-QTY                          11650016
116600                                   TO DP010I-MAXIMUM-DIGITS       11660016
116700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11670016
116800         SET DP010I-NEGATIVE-NOT-ALLOWED                          11680016
116900                                   TO TRUE                        11690016
117010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11701074
117020              USING DP010I-NUMERIC-EDIT-AREA                      11702074
117100                                                                  11710016
117200         IF  DP010I-ERROR-DETECTED  OR                            11720016
117300             DP010I-NUMERIC-FIELD = ZEROS                         11730016
117400             SET PS-ERROR                                         11740016
117500                 DP020-MSG-FATAL   TO TRUE                        11750016
117600             MOVE PC-TSYMSG-00342  TO DP020-MSG-NUMBER            11760016
117700             MOVE DP015-UNP-NUM-BRT-OFF                           11770016
117800                                   TO AQTYA                       11780016
117900             MOVE DP015-RED        TO AQTYC                       11790016
118000             MOVE DP015-REVERSE    TO AQTYH                       11800016
118100             MOVE -1               TO AQTYL                       11810016
118200             SET DP030-SET-CURSOR-APPL-1                          11820016
118300                                   TO TRUE                        11830016
118400         ELSE                                                     11840016
118500             MOVE DP010I-NUMERIC-FIELD                            11850016
118600                                   TO ASC-PKSL-ITM-QTY-N          11860016
118700             MOVE ASC-PKSL-ITM-QTY-N                              11870016
118800                                   TO AQTYO                       11880016
118900         END-IF                                                   11890016
119000     ELSE                                                         11900016
119100         SET PS-ERROR                                             11910016
119200             DP020-MSG-FATAL       TO TRUE                        11920016
119300         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            11930016
119400         MOVE DP015-UNP-NUM-BRT-OFF                               11940016
119500                                   TO AQTYA                       11950016
119600         MOVE DP015-RED            TO AQTYC                       11960016
119700         MOVE DP015-REVERSE        TO AQTYH                       11970016
119800         MOVE -1                   TO AQTYL                       11980016
119900         SET DP030-SET-CURSOR-APPL-1                              11990016
120000                                   TO TRUE                        12000016
120100     END-IF.                                                      12010016
120200                                                                  12020016
120300     IF  PS-NO-ERROR                                              12030016
120400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     12040016
120500         EVALUATE TRUE                                            12050016
120600             WHEN ASC-ADD-PENDING                                 12060016
120700                 MOVE -1           TO AQTYL                       12070016
120800                 SET DP030-SET-CURSOR-APPL-1                      12080016
120900                                   TO TRUE                        12090016
121000             WHEN ASC-UPDATE-PENDING                              12100016
121100                 MOVE -1           TO AQTYL                       12110016
121200                 SET DP030-SET-CURSOR-APPL-1                      12120016
121300                                   TO TRUE                        12130016
121400             WHEN ASC-DELETE-PENDING                              12140016
121500                 SET DP030-SET-CURSOR-TRAILER                     12150016
121600                                   TO TRUE                        12160016
121700         END-EVALUATE                                             12170016
121800     END-IF.                                                      12180016
121900                                                                  12190016
122000/                                                                 12200016
122100*----------------------------------------------------------------*12210016
122200*    GET THE PURCHASE ORDER HEADER INFORMATION                   *12220016
122300*----------------------------------------------------------------*12230016
122400 3010-VALIDATE-PO.                                                12240016
122500                                                                  12250016
122600     PERFORM                                                      12260016
122700         WITH TEST AFTER                                          12270016
122800         VARYING PV-RETRY-COUNTER                                 12280016
122900         FROM 1 BY 1                                              12290016
123000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12300016
123100             OR (SQLCODE = +0)                                    12310016
123200             OR (SQLCODE = +100))                                 12320016
123300                                                                  12330016
123400         EXEC SQL                                                 12340016
123500              SELECT VER_STATUS_CDE                               12350016
123600                INTO :PURCHS-VER-STATUS-CDE                       12360016
123700                FROM TPURCHS                                      12370016
123800               WHERE PO_NBR         = :DK-PO-NBR                  12380016
123900                 AND VER_STATUS_CDE = :PC-ACTIVE                  12390016
124000         END-EXEC                                                 12400016
124100                                                                  12410016
124200         EVALUATE TRUE                                            12420016
124300             WHEN SQLCODE = +0                                    12430016
124400             WHEN SQLCODE = +100                                  12440016
124500             WHEN SQLCODE = -904                                  12450016
124600             WHEN SQLCODE = -913                                  12460016
124700                  CONTINUE                                        12470016
124800                                                                  12480016
124900             WHEN SQLWARN0 NOT = SPACES                           12490016
125000             WHEN SQLCODE < +0                                    12500016
125100             WHEN SQLCODE > +0                                    12510016
125200                  MOVE '3010-VALIDATE-PO'                         12520016
125300                                   TO DP013-PARAGRAPH             12530016
125400                  MOVE 'UNSUCCESSFUL SELECT PO HEADER'            12540016
125500                                   TO DP013-MESSAGE-TEXT (1)      12550016
125600                  MOVE SQLCA       TO DP013-SQLCA                 12560016
125700                  MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)    12570016
125800                  SET DP013-DB2-ABEND                             12580016
125900                      DP013-XCTL-DISPLAY-RESTART                  12590016
126000                                   TO TRUE                        12600016
126100                  PERFORM DP013-0000-PROCESS-ABEND                12610016
126200         END-EVALUATE                                             12620016
126300     END-PERFORM.                                                 12630016
126400                                                                  12640016
126500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12650016
126600         MOVE '3010-VALIDATE-PO'   TO DP013-PARAGRAPH             12660016
126700         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO HEADER'          12670016
126800                                   TO DP013-MESSAGE-TEXT (1)      12680016
126900         MOVE SQLCA                TO DP013-SQLCA                 12690016
127000         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    12700016
127100         SET DP013-DB2-ABEND                                      12710016
127200             DP013-XCTL-DISPLAY-RESTART                           12720016
127300                                   TO TRUE                        12730016
127400         PERFORM DP013-0000-PROCESS-ABEND                         12740016
127500     END-IF.                                                      12750016
127600                                                                  12760016
127700/                                                                 12770016
127800*----------------------------------------------------------------*12780016
127900*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *12790016
128000*----------------------------------------------------------------*12800016
128100                                                                  12810016
128200 3200-RESET-ATTRIBUTES.                                           12820016
128300                                                                  12830016
128400     EVALUATE TRUE                                                12840016
128500         WHEN ASC-ADD-PENDING                                     12850016
128600              MOVE DP015-UNP-ALP-NOR-OFF                          12860016
128700                                   TO ASTYLEA                     12870016
128800                                      ADESCA                      12880016
128900                                      ASIZEA                      12890016
129000                                      ACOLORA                     12900016
129100              MOVE DP015-UNP-NUM-NOR-OFF                          12910016
129200                                   TO AQTYA                       12920016
129300                                      ACOSTA                      12930016
129400                                      ALINEA                      12940016
129500              MOVE DP015-GREEN     TO AQTYC                       12950016
129600                                      ASTYLEC                     12960016
129700                                      ADESCC                      12970016
129800                                      ASIZEC                      12980016
129900                                      ACOLORC                     12990016
130000                                      ACOSTC                      13000016
130100                                      ALINEC                      13010016
130200              MOVE DP015-UNDERLINE TO AQTYH                       13020016
130300                                      ASTYLEH                     13030016
130400                                      ADESCH                      13040016
130500                                      ASIZEH                      13050016
130600                                      ACOLORH                     13060016
130700                                      ACOSTH                      13070016
130800                                      ALINEH                      13080016
130900                                                                  13090016
131000         WHEN ASC-UPDATE-PENDING                                  13100016
131100              IF ASC-PKSL-LNE-NBR < PC-1000                       13110016
131200                  MOVE DP015-PRO-NOR-OFF                          13120016
131300                                   TO ASTYLEA                     13130016
131400                                      ADESCA                      13140016
131500                                      ASIZEA                      13150016
131600                                      ACOLORA                     13160016
131700                                      ACOSTA                      13170016
131800                                      ALINEA                      13180016
131900                  MOVE DP015-UNP-NUM-NOR-OFF                      13190016
132000                                   TO AQTYA                       13200016
132100                  MOVE DP015-GREEN TO AQTYC                       13210016
132200                  MOVE DP015-BLUE  TO ASTYLEC                     13220016
132300                                      ADESCC                      13230016
132400                                      ASIZEC                      13240016
132500                                      ACOLORC                     13250016
132600                                      ACOSTC                      13260016
132700                                      ALINEC                      13270016
132800                  MOVE DP015-UNDERLINE                            13280016
132900                                   TO AQTYH                       13290016
133000                  MOVE DP015-HL-OFF                               13300016
133100                                   TO ASTYLEH                     13310016
133200                                      ADESCH                      13320016
133300                                      ASIZEH                      13330016
133400                                      ACOLORH                     13340016
133500                                      ACOSTH                      13350016
133600                                      ALINEH                      13360016
133700             MOVE -1               TO AQTYL                       13370016
133800             SET DP030-SET-CURSOR-APPL-1                          13380016
133900                                   TO TRUE                        13390016
134000             ELSE                                                 13400016
134100                  MOVE DP015-UNP-ALP-NOR-OFF                      13410016
134200                                   TO ASTYLEA                     13420016
134300                                      ADESCA                      13430016
134400                                      ASIZEA                      13440016
134500                                      ACOLORA                     13450016
134600                  MOVE DP015-UNP-NUM-NOR-OFF                      13460016
134700                                   TO AQTYA                       13470016
134800                                      ACOSTA                      13480016
134900                                      ALINEA                      13490016
135000                  MOVE DP015-GREEN TO AQTYC                       13500016
135100                                      ASTYLEC                     13510016
135200                                      ADESCC                      13520016
135300                                      ASIZEC                      13530016
135400                                      ACOLORC                     13540016
135500                                      ACOSTC                      13550016
135600                                      ALINEC                      13560016
135700                  MOVE DP015-UNDERLINE                            13570016
135800                                   TO AQTYH                       13580016
135900                                      ASTYLEH                     13590016
136000                                      ADESCH                      13600016
136100                                      ASIZEH                      13610016
136200                                      ACOLORH                     13620016
136300                                      ACOSTH                      13630016
136400                                      ALINEH                      13640016
136500             END-IF                                               13650016
136600                                                                  13660016
136700       WHEN  ASC-DELETE-PENDING                                   13670016
136800             MOVE DP015-PRO-NOR-OFF                               13680016
136900                                   TO AQTYA                       13690016
137000                                      ASTYLEA                     13700016
137100                                      ADESCA                      13710016
137200                                      ASIZEA                      13720016
137300                                      ACOLORA                     13730016
137400                                      ACOSTA                      13740016
137500                                      ALINEA                      13750016
137600             MOVE DP015-BLUE       TO AQTYC                       13760016
137700                                      ASTYLEC                     13770016
137800                                      ADESCC                      13780016
137900                                      ASIZEC                      13790016
138000                                      ACOLORC                     13800016
138100                                      ACOSTC                      13810016
138200                                      ALINEC                      13820016
138300             MOVE DP015-HL-OFF     TO AQTYH                       13830016
138400                                      ASTYLEH                     13840016
138500                                      ADESCH                      13850016
138600                                      ASIZEH                      13860016
138700                                      ACOLORH                     13870016
138800                                      ACOSTH                      13880016
138900                                      ALINEH                      13890016
139000     END-EVALUATE.                                                13900016
139100                                                                  13910016
139200     IF  DP020-NEXT-ACT-INITIAL                                   13920016
139300         EVALUATE TRUE                                            13930016
139400            WHEN ASC-UPDATE-PENDING                               13940016
139500            WHEN ASC-ADD-PENDING                                  13950016
139600                MOVE -1            TO AQTYL                       13960016
139700                SET DP030-SET-CURSOR-APPL-1                       13970016
139800                                   TO TRUE                        13980016
139900            WHEN ASC-DELETE-PENDING                               13990016
140000                SET DP030-SET-CURSOR-TRAILER                      14000016
140100                                   TO TRUE                        14010016
140200         END-EVALUATE                                             14020016
140300     END-IF.                                                      14030016
140400/                                                                 14040016
140500*----------------------------------------------------------------*14050016
140600*  THIS PARAGRAPH BUILDS THE SCREEN FOR THE FOLLOWING MODES:     *14060016
140700*  "UPDATE" AND "DELETE".                                        *14070016
140800*----------------------------------------------------------------*14080016
140900                                                                  14090016
141000 4000-BUILD-INITIAL-PANEL.                                        14100016
141100                                                                  14110016
141200     PERFORM 4010-GET-VENDOR-NAME.                                14120016
141300                                                                  14130016
141400     IF ASC-PKSL-LNE-NBR-N < PC-9000                              14140016
141500         PERFORM 4100-BUILD-PKITEM-SCREEN                         14150016
141600     ELSE                                                         14160016
141700         PERFORM 4200-BUILD-UNPKSL-SCREEN                         14170016
141800     END-IF.                                                      14180016
141900                                                                  14190016
142000                                                                  14200016
142100     INITIALIZE XL001-ITEM-COMMAREA.                              14210016
142200                                                                  14220016
142300     PERFORM 9050-GET-PURITM.                                     14230016
142400                                                                  14240016
142500     IF PS-PURITM-FOUND                                           14250016
142600*----------------------------------------------------------------*14260016
142700*  CHECK FOR DUMMY SKUS.  IF NOT CALL THE                         14270016
142800*  MODULE TO RETRIEVE THE 8 DIGIT SKU#                            14280016
142900*----------------------------------------------------------------*14290016
143000         IF PURITM-SKU-SEQ-NBR     = PC-X-000                     14300016
143100            MOVE '00000000'        TO ASC-SKU-SEQ-NBR             14310016
143200         ELSE                                                     14320016
143300            IF PURITM-SKU-SEQ-NBR  = PC-X-999                     14330016
143400               MOVE '99999999'     TO ASC-SKU-SEQ-NBR             14340016
143500            ELSE                                                  14350016
143600                 PERFORM 9070-CALL-CICS-API-ARCH                  14360016
143700         END-IF                                                   14370016
143800     END-IF.                                                      14380016
143900                                                                  14390016
144000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14400016
144100                                                                  14410016
144200 4010-GET-VENDOR-NAME.                                            14420016
144300                                                                  14430016
144400     PERFORM WITH TEST AFTER                                      14440016
144500         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    14450016
144600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             14460016
144700                 SQLCODE = ZERO OR                                14470016
144800                 SQLCODE = +100                                   14480016
144900                                                                  14490016
145000         EXEC SQL                                                 14500016
145100              SELECT B.ENT_NAME_DESC                              14510016
145200                INTO :ENTNME-ENT-NAME-DESC                        14520016
145300                FROM TPURCHS A,                                   14530016
145400                     TENTNME B                                    14540016
145500               WHERE A.VER_STATUS_CDE = :PC-ACTIVE                14550016
145600                 AND A.PO_NBR         = :DK-PO-NBR                14560016
145700                 AND A.ENT_ID         = B.ENT_ID                  14570016
145800                 AND B.TYPE_CDE       = :PC-01                    14580016
145900         END-EXEC                                                 14590016
146000                                                                  14600016
146100         EVALUATE TRUE                                            14610016
146200             WHEN SQLCODE = ZERO                                  14620016
146300             WHEN SQLCODE = +100                                  14630016
146400             WHEN SQLCODE = -904                                  14640016
146500             WHEN SQLCODE = -913                                  14650016
146600                  CONTINUE                                        14660016
146700                                                                  14670016
146800             WHEN SQLWARN0 NOT = SPACES                           14680016
146900             WHEN SQLCODE  NOT = ZERO                             14690016
147000                  MOVE '4010-GET-VENDOR-NAME'                     14700016
147100                                 TO DP013-PARAGRAPH               14710016
147200                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       14720016
147300                                 TO DP013-MESSAGE-TEXT (1)        14730016
147400                  MOVE SQLCA     TO DP013-SQLCA                   14740016
147500                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      14750016
147600                  SET DP013-DB2-ABEND                             14760016
147700                      DP013-XCTL-DISPLAY-RESTART                  14770016
147800                                 TO TRUE                          14780016
147900                                                                  14790016
148000                  PERFORM DP013-0000-PROCESS-ABEND                14800016
148100         END-EVALUATE                                             14810016
148200     END-PERFORM.                                                 14820016
148300                                                                  14830016
148400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14840016
148500         MOVE '4010-GET-VENDOR-NAME'                              14850016
148600                                 TO DP013-PARAGRAPH               14860016
148700         MOVE 'MAX RETRIES EXCEEDED ON SELECT VENDOR NAME'        14870016
148800                                 TO DP013-MESSAGE-TEXT (1)        14880016
148900         MOVE SQLCA              TO DP013-SQLCA                   14890016
149000         MOVE 'TENTNME '         TO DP013-DB2-TABLE-NAME (1)      14900016
149100         SET DP013-XCTL-DISPLAY-RESTART                           14910016
149200             DP013-DB2-ABEND     TO TRUE                          14920016
149300                                                                  14930016
149400         PERFORM DP013-0000-PROCESS-ABEND                         14940016
149500     END-IF.                                                      14950016
149600                                                                  14960016
149700     IF SQLCODE = ZERO                                            14970016
149800         MOVE ENTNME-ENT-NAME-DESC                                14980016
149900                                 TO ASC-KEY-VENDOR-NAME           14990016
150000     ELSE                                                         15000016
150100         IF SQLCODE = +100                                        15010016
150200             MOVE 'VENDOR NOT FOUND'                              15020016
150300                                 TO ASC-KEY-VENDOR-NAME           15030016
150400         END-IF                                                   15040016
150500     END-IF.                                                      15050016
150600                                                                  15060016
150700 4100-BUILD-PKITEM-SCREEN.                                        15070016
150800                                                                  15080016
150900     PERFORM 5110-SELECT-TPKITEM.                                 15090016
151000                                                                  15100016
151100     MOVE PV-DB2-MONTH             TO PV-MONTH.                   15110016
151200     MOVE PV-DB2-DAY               TO PV-DAY.                     15120016
151300     MOVE PV-DB2-YEAR              TO PV-YEAR.                    15130016
151400     MOVE PV-DISPLAY-DATE          TO ASC-LAST-UPD-BY-DTE.        15140016
151500     MOVE PV-DB2-HOUR              TO PV-HOUR.                    15150016
151600     MOVE PV-DB2-MINUTE            TO PV-MINUTE.                  15160016
151700     MOVE PV-DISPLAY-TIME          TO ASC-LAST-UPD-BY-TME.        15170016
151800     MOVE PKITEM-CRE-UID           TO ASC-LAST-UPD-BY-UID.        15180016
151900                                                                  15190016
152000     PERFORM 4110-SELECT-ORIG-PKITEM.                             15200016
152100                                                                  15210016
152200     IF PS-PREV-UPDATE                                            15220016
152300         MOVE PV-DB2-MONTH         TO PV-MONTH                    15230016
152400         MOVE PV-DB2-DAY           TO PV-DAY                      15240016
152500         MOVE PV-DB2-YEAR          TO PV-YEAR                     15250016
152600         MOVE PV-DISPLAY-DATE      TO ASC-CREATED-BY-DTE          15260016
152700         MOVE PV-DB2-HOUR          TO PV-HOUR                     15270016
152800         MOVE PV-DB2-MINUTE        TO PV-MINUTE                   15280016
152900         MOVE PV-DISPLAY-TIME      TO ASC-CREATED-BY-TME          15290016
153000         MOVE PKITEM-CRE-UID       TO ASC-CREATED-BY-UID          15300016
153100     ELSE                                                         15310016
153200         MOVE ASC-LAST-UPD-BY-UID  TO ASC-CREATED-BY-UID          15320016
153300         MOVE ASC-LAST-UPD-BY-DTE  TO ASC-CREATED-BY-DTE          15330016
153400         MOVE ASC-LAST-UPD-BY-TME  TO ASC-CREATED-BY-TME          15340016
153500     END-IF.                                                      15350016
153600                                                                  15360016
153700/                                                                 15370016
153800                                                                  15380016
153900/                                                                 15390016
154000*----------------------------------------------------------------*15400016
154100*    READ THE ORIGINAL PACK SLIP ITEMS.                          *15410016
154200*----------------------------------------------------------------*15420016
154300 4110-SELECT-ORIG-PKITEM.                                         15430016
154400                                                                  15440016
154500     PERFORM                                                      15450016
154600         WITH TEST AFTER                                          15460016
154700         VARYING PV-RETRY-COUNTER                                 15470016
154800         FROM 1 BY 1                                              15480016
154900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15490016
155000             OR (SQLCODE = +0)                                    15500016
155100             OR (SQLCODE = +100))                                 15510016
155200                                                                  15520016
155300         EXEC SQL                                                 15530016
155400              SELECT  MONTH (A.CRE_TMST),                         15540016
155500                      DAY   (A.CRE_TMST),                         15550016
155600                      YEAR  (A.CRE_TMST),                         15560016
155700                      HOUR  (A.CRE_TMST),                         15570016
155800                      MINUTE(A.CRE_TMST),                         15580016
155900                     A.CRE_UID                                    15590016
156000                INTO :PV-DB2-MONTH,                               15600016
156100                     :PV-DB2-DAY,                                 15610016
156200                     :PV-DB2-YEAR,                                15620016
156300                     :PV-DB2-HOUR,                                15630016
156400                     :PV-DB2-MINUTE,                              15640016
156500                     :PKITEM-CRE-UID                              15650016
156600                FROM TPKITEM A                                    15660016
156700               WHERE A.PO_NBR       = :DK-PO-NBR                  15670016
156800                 AND A.SEQ_NBR      = :ASC-KEY-SEQ-NBR            15680016
156900                 AND A.PKSL_LNE_NBR = :DK-PKSL-LNE-NBR            15690016
157000                 AND A.VER_STAT_CDE = :PC-INACTIVE                15700016
157100                 AND A.CRE_TMST =                                 15710016
157200                     (SELECT MIN (B.CRE_TMST)                     15720016
157300                        FROM TPKITEM B                            15730016
157400                       WHERE A.PO_NBR       = B.PO_NBR            15740016
157500                         AND A.SEQ_NBR      = B.SEQ_NBR           15750016
157600                         AND A.PKSL_LNE_NBR = B.PKSL_LNE_NBR)     15760016
157700         END-EXEC                                                 15770016
157800                                                                  15780016
157900         EVALUATE TRUE                                            15790016
158000             WHEN SQLCODE = +0                                    15800016
158100                  SET PS-PREV-UPDATE                              15810016
158200                                   TO TRUE                        15820016
158300                                                                  15830016
158400             WHEN SQLCODE = +100                                  15840016
158500                  SET PS-NO-PREV-UPDATE                           15850016
158600                                   TO TRUE                        15860016
158700                                                                  15870016
158800             WHEN SQLCODE = -904                                  15880016
158900             WHEN SQLCODE = -913                                  15890016
159000                  CONTINUE                                        15900016
159100                                                                  15910016
159200             WHEN SQLWARN0 NOT = SPACES                           15920016
159300             WHEN SQLCODE < +0                                    15930016
159400             WHEN SQLCODE > +0                                    15940016
159500                  MOVE '4110-SELECT-ORIG-PKITEM'                  15950016
159600                                   TO DP013-PARAGRAPH             15960016
159700                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP ITEM'       15970016
159800                                   TO DP013-MESSAGE-TEXT (1)      15980016
159900                  MOVE SQLCA       TO DP013-SQLCA                 15990016
160000                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    16000016
160100                  SET DP013-DB2-ABEND                             16010016
160200                      DP013-XCTL-DISPLAY-RESTART                  16020016
160300                                   TO TRUE                        16030016
160400                  PERFORM DP013-0000-PROCESS-ABEND                16040016
160500         END-EVALUATE                                             16050016
160600     END-PERFORM.                                                 16060016
160700                                                                  16070016
160800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16080016
160900         MOVE '4110-SELECT-ORIG-PKITEM'                           16090016
161000                                   TO DP013-PARAGRAPH             16100016
161100         MOVE 'MAX RETRIES EXCEEDED ON SELECT PACK SLIP ITEM'     16110016
161200                                   TO DP013-MESSAGE-TEXT (1)      16120016
161300         MOVE SQLCA                TO DP013-SQLCA                 16130016
161400         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    16140016
161500         SET DP013-DB2-ABEND                                      16150016
161600             DP013-XCTL-DISPLAY-RESTART                           16160016
161700                                   TO TRUE                        16170016
161800         PERFORM DP013-0000-PROCESS-ABEND                         16180016
161900     END-IF.                                                      16190016
162000                                                                  16200016
162100/                                                                 16210016
162200                                                                  16220016
162300 4200-BUILD-UNPKSL-SCREEN.                                        16230016
162400                                                                  16240016
162500     PERFORM 4210-SELECT-UNPKSL.                                  16250016
162600                                                                  16260016
162700     MOVE PV-DB2-MONTH             TO PV-MONTH.                   16270016
162800     MOVE PV-DB2-DAY               TO PV-DAY.                     16280016
162900     MOVE PV-DB2-YEAR              TO PV-YEAR.                    16290016
163000     MOVE PV-DISPLAY-DATE          TO ASC-LAST-UPD-BY-DTE.        16300016
163100     MOVE PV-DB2-HOUR              TO PV-HOUR.                    16310016
163200     MOVE PV-DB2-MINUTE            TO PV-MINUTE.                  16320016
163300     MOVE PV-DISPLAY-TIME          TO ASC-LAST-UPD-BY-TME.        16330016
163400     MOVE UNPKSL-CRE-UID           TO ASC-LAST-UPD-BY-UID.        16340016
163500                                                                  16350016
163600     PERFORM 4220-SELECT-ORIG-UNPKSL.                             16360016
163700                                                                  16370016
163800     IF PS-PREV-UPDATE                                            16380016
163900         MOVE PV-DB2-MONTH         TO PV-MONTH                    16390016
164000         MOVE PV-DB2-DAY           TO PV-DAY                      16400016
164100         MOVE PV-DB2-YEAR          TO PV-YEAR                     16410016
164200         MOVE PV-DISPLAY-DATE      TO ASC-CREATED-BY-DTE          16420016
164300         MOVE PV-DB2-HOUR          TO PV-HOUR                     16430016
164400         MOVE PV-DB2-MINUTE        TO PV-MINUTE                   16440016
164500         MOVE PV-DISPLAY-TIME      TO ASC-CREATED-BY-TME          16450016
164600         MOVE UNPKSL-CRE-UID       TO ASC-CREATED-BY-UID          16460016
164700     ELSE                                                         16470016
164800         MOVE ASC-LAST-UPD-BY-UID  TO ASC-CREATED-BY-UID          16480016
164900         MOVE ASC-LAST-UPD-BY-DTE  TO ASC-CREATED-BY-DTE          16490016
165000         MOVE ASC-LAST-UPD-BY-TME  TO ASC-CREATED-BY-TME          16500016
165100     END-IF.                                                      16510016
165200                                                                  16520016
165300/                                                                 16530016
165400*----------------------------------------------------------------*16540016
165500*    READ THE UNMATCHED PACK SLIP ITEM TO SEE WHEN IT WAS CREATED*16550016
165600*----------------------------------------------------------------*16560016
165700 4210-SELECT-UNPKSL.                                              16570016
165800                                                                  16580016
165900     PERFORM                                                      16590016
166000         WITH TEST AFTER                                          16600016
166100         VARYING PV-RETRY-COUNTER                                 16610016
166200         FROM 1 BY 1                                              16620016
166300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16630016
166400             OR (SQLCODE = +0)                                    16640016
166500             OR (SQLCODE = +100))                                 16650016
166600                                                                  16660016
166700         EXEC SQL                                                 16670016
166800              SELECT  PKSL_ITM_QTY,                               16680016
166900                      UNT_COST_AMT,                               16690016
167000                      COLOR_DESC,                                 16700016
167100                      SIZE_DESC,                                  16710016
167200                      VEND_STYL_NAME,                             16720016
167300                      VEND_DESC,                                  16730016
167400                      MONTH (A.CRE_TMST),                         16740016
167500                      DAY   (A.CRE_TMST),                         16750016
167600                      YEAR  (A.CRE_TMST),                         16760016
167700                      HOUR  (A.CRE_TMST),                         16770016
167800                      MINUTE(A.CRE_TMST),                         16780016
167900                     A.CRE_UID                                    16790016
168000                INTO :UNPKSL-PKSL-ITM-QTY,                        16800016
168100                     :UNPKSL-UNT-COST-AMT,                        16810016
168200                     :ASC-COLOR-DESC,                             16820016
168300                     :ASC-SIZE-DESC,                              16830016
168400                     :ASC-VEND-STYL-NAME,                         16840016
168500                     :ASC-VEND-DESC,                              16850016
168600                     :PV-DB2-MONTH,                               16860016
168700                     :PV-DB2-DAY,                                 16870016
168800                     :PV-DB2-YEAR,                                16880016
168900                     :PV-DB2-HOUR,                                16890016
169000                     :PV-DB2-MINUTE,                              16900016
169100                     :UNPKSL-CRE-UID                              16910016
169200                FROM TUNPKSL A                                    16920016
169300               WHERE A.PO_NBR       = :DK-PO-NBR                  16930016
169400                 AND A.SEQ_NBR      = :ASC-KEY-SEQ-NBR            16940016
169500                 AND A.PKSL_LNE_NBR = :DK-PKSL-LNE-NBR            16950016
169600                 AND A.VER_STAT_CDE = :PC-ACTIVE                  16960016
169700         END-EXEC                                                 16970016
169800                                                                  16980016
169900         EVALUATE TRUE                                            16990016
170000             WHEN SQLCODE = +0                                    17000016
170100                  MOVE UNPKSL-PKSL-ITM-QTY                        17010016
170200                                   TO ASC-PKSL-ITM-QTY-N          17020016
170300                  MOVE UNPKSL-UNT-COST-AMT                        17030016
170400                                   TO ASC-UNT-COST-AMT-N          17040016
170500                  MOVE ASC-UNT-COST-AMT-N                         17050016
170600                                   TO ACOSTO                      17060016
170700                  MOVE ACOSTO      TO ASC-UNT-COST-AMT            17070016
170800             WHEN SQLCODE = +100                                  17080016
170900             WHEN SQLCODE = -904                                  17090016
171000             WHEN SQLCODE = -913                                  17100016
171100                  CONTINUE                                        17110016
171200                                                                  17120016
171300             WHEN SQLWARN0 NOT = SPACES                           17130016
171400             WHEN SQLCODE < +0                                    17140016
171500             WHEN SQLCODE > +0                                    17150016
171600                  MOVE '4210-SELECT-UNPKSL'                       17160016
171700                                   TO DP013-PARAGRAPH             17170016
171800                  MOVE 'UNSUCCESSFUL SELECT UNMTCHD PACK SLIP ITM'17180016
171900                                   TO DP013-MESSAGE-TEXT (1)      17190016
172000                  MOVE SQLCA       TO DP013-SQLCA                 17200016
172100                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    17210016
172200                  SET DP013-DB2-ABEND                             17220016
172300                      DP013-XCTL-DISPLAY-RESTART                  17230016
172400                                   TO TRUE                        17240016
172500                  PERFORM DP013-0000-PROCESS-ABEND                17250016
172600         END-EVALUATE                                             17260016
172700     END-PERFORM.                                                 17270016
172800                                                                  17280016
172900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17290016
173000         MOVE '4210-SELECT-UNPKSL' TO DP013-PARAGRAPH             17300016
173100         MOVE 'MAX RETRIES EXCEEDED ON SELECT UNPKSL'             17310016
173200                                   TO DP013-MESSAGE-TEXT (1)      17320016
173300         MOVE SQLCA                TO DP013-SQLCA                 17330016
173400         MOVE 'TUNPKSL '           TO DP013-DB2-TABLE-NAME (1)    17340016
173500         SET DP013-DB2-ABEND                                      17350016
173600             DP013-XCTL-DISPLAY-RESTART                           17360016
173700                                   TO TRUE                        17370016
173800         PERFORM DP013-0000-PROCESS-ABEND                         17380016
173900     END-IF.                                                      17390016
174000                                                                  17400016
174100/                                                                 17410016
174200*----------------------------------------------------------------*17420016
174300*    READ THE ORIGINAL UNMATCHED PACK SLIP ITEMS.                *17430016
174400*----------------------------------------------------------------*17440016
174500 4220-SELECT-ORIG-UNPKSL.                                         17450016
174600                                                                  17460016
174700     PERFORM                                                      17470016
174800         WITH TEST AFTER                                          17480016
174900         VARYING PV-RETRY-COUNTER                                 17490016
175000         FROM 1 BY 1                                              17500016
175100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17510016
175200             OR (SQLCODE = +0)                                    17520016
175300             OR (SQLCODE = +100))                                 17530016
175400                                                                  17540016
175500         EXEC SQL                                                 17550016
175600              SELECT  MONTH (A.CRE_TMST),                         17560016
175700                      DAY   (A.CRE_TMST),                         17570016
175800                      YEAR  (A.CRE_TMST),                         17580016
175900                      HOUR  (A.CRE_TMST),                         17590016
176000                      MINUTE(A.CRE_TMST),                         17600016
176100                     A.CRE_UID                                    17610016
176200                INTO :PV-DB2-MONTH,                               17620016
176300                     :PV-DB2-DAY,                                 17630016
176400                     :PV-DB2-YEAR,                                17640016
176500                     :PV-DB2-HOUR,                                17650016
176600                     :PV-DB2-MINUTE,                              17660016
176700                     :UNPKSL-CRE-UID                              17670016
176800                FROM TUNPKSL A                                    17680016
176900               WHERE A.PO_NBR       = :DK-PO-NBR                  17690016
177000                 AND A.SEQ_NBR      = :ASC-KEY-SEQ-NBR            17700016
177100                 AND A.PKSL_LNE_NBR = :DK-PKSL-LNE-NBR            17710016
177200                 AND A.VER_STAT_CDE = :PC-INACTIVE                17720016
177300                 AND A.CRE_TMST =                                 17730016
177400                     (SELECT MIN (B.CRE_TMST)                     17740016
177500                        FROM TUNPKSL B                            17750016
177600                       WHERE A.PO_NBR       = B.PO_NBR            17760016
177700                         AND A.SEQ_NBR      = B.SEQ_NBR           17770016
177800                         AND A.PKSL_LNE_NBR = B.PKSL_LNE_NBR)     17780016
177900         END-EXEC                                                 17790016
178000                                                                  17800016
178100         EVALUATE TRUE                                            17810016
178200             WHEN SQLCODE = +0                                    17820016
178300                  SET PS-PREV-UPDATE                              17830016
178400                                   TO TRUE                        17840016
178500                                                                  17850016
178600             WHEN SQLCODE = +100                                  17860016
178700                  SET PS-NO-PREV-UPDATE                           17870016
178800                                   TO TRUE                        17880016
178900                                                                  17890016
179000             WHEN SQLCODE = -904                                  17900016
179100             WHEN SQLCODE = -913                                  17910016
179200                  CONTINUE                                        17920016
179300                                                                  17930016
179400             WHEN SQLWARN0 NOT = SPACES                           17940016
179500             WHEN SQLCODE < +0                                    17950016
179600             WHEN SQLCODE > +0                                    17960016
179700                  MOVE '4220-SELECT-ORIG-UNPKSL'                  17970016
179800                                   TO DP013-PARAGRAPH             17980016
179900                  MOVE 'UNSUCCESSFUL SELECT OF UNPKSL'            17990016
180000                                   TO DP013-MESSAGE-TEXT (1)      18000016
180100                  MOVE SQLCA       TO DP013-SQLCA                 18010016
180200                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    18020016
180300                  SET DP013-DB2-ABEND                             18030016
180400                      DP013-XCTL-DISPLAY-RESTART                  18040016
180500                                   TO TRUE                        18050016
180600                  PERFORM DP013-0000-PROCESS-ABEND                18060016
180700         END-EVALUATE                                             18070016
180800     END-PERFORM.                                                 18080016
180900                                                                  18090016
181000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18100016
181100         MOVE '4220-SELECT-ORIG-UNPKSL'                           18110016
181200                                   TO DP013-PARAGRAPH             18120016
181300         MOVE 'MAX RETRIES EXCEEDED ON SELECT UNPKSL'             18130016
181400                                   TO DP013-MESSAGE-TEXT (1)      18140016
181500         MOVE SQLCA                TO DP013-SQLCA                 18150016
181600         MOVE 'TUNPKSL '           TO DP013-DB2-TABLE-NAME (1)    18160016
181700         SET DP013-DB2-ABEND                                      18170016
181800             DP013-XCTL-DISPLAY-RESTART                           18180016
181900                                   TO TRUE                        18190016
182000         PERFORM DP013-0000-PROCESS-ABEND                         18200016
182100     END-IF.                                                      18210016
182200                                                                  18220016
182300/                                                                 18230016
182400*----------------------------------------------------------------*18240016
182500*  THIS PARAGRAPH BUILDS THE SCREEN FOR "ADD" MODE ONLY.         *18250016
182600*  MOST VALUES HAVE BEEN ALREADY RETRIEVED FROM THE EDIT SECTION.*18260016
182700*  THIS WAS NECESSARY SINCE WE ARE DEFAULTING NUMEROUS VALUES    *18270016
182800*  AND THE FACT THAT ERRORS WILL BE DISPLAYED IMMEDIATELY.       *18280016
182900*----------------------------------------------------------------*18290016
183000                                                                  18300016
183100 4500-BUILD-INITIAL-ADD-PANEL.                                    18310016
183200                                                                  18320016
183300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18330016
183400                                                                  18340016
183500/                                                                 18350016
183600*----------------------------------------------------------------*18360016
183700*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *18370016
183800*----------------------------------------------------------------*18380016
183900 4400-MOVE-COMMAREA-TO-SCREEN.                                    18390016
184000                                                                  18400016
184100     MOVE ASC-PO-NBR               TO APOO.                       18410016
184200     MOVE ASC-REC-SEQ-NBR          TO ARECSEQO.                   18420016
184300     MOVE ASC-KEY-VENDOR-NAME      TO AVENDO.                     18430016
184400     MOVE ASC-PKSL-NBR             TO APKSLIPO.                   18440016
184500     MOVE ASC-PKSL-ITM-QTY-N       TO AQTYO.                      18450016
184600     MOVE ASC-VEND-STYL-NAME       TO ASTYLEO.                    18460016
184700     MOVE ASC-VEND-DESC            TO ADESCO.                     18470016
184800     MOVE ASC-SIZE-DESC            TO ASIZEO.                     18480016
184900     MOVE ASC-COLOR-DESC           TO ACOLORO.                    18490016
185000     MOVE ASC-CLASS-NBR            TO ACLO.                       18500016
185100     MOVE ASC-SKU-SEQ-NBR          TO ASEQO.                      18510016
185200                                                                  18520016
185300     IF ASC-PKSL-LNE-NBR = ZEROS                                  18530016
185400         MOVE SPACES               TO ASC-PKSL-LNE-NBR            18540016
185500                                      ALINEO                      18550016
185600     ELSE                                                         18560016
185700         MOVE ASC-PKSL-LNE-NBR-N   TO ALINEO                      18570016
185800     END-IF.                                                      18580016
185900                                                                  18590016
186000     MOVE ASC-CREATED-BY-UID       TO ACRTBYO.                    18600016
186100     MOVE ASC-CREATED-BY-DTE       TO ACRTDTEO.                   18610016
186200     MOVE ASC-CREATED-BY-TME       TO ACRTTMEO.                   18620016
186300     MOVE ASC-LAST-UPD-BY-UID      TO ALSTBYO.                    18630016
186400     MOVE ASC-LAST-UPD-BY-DTE      TO ALSTDTEO.                   18640016
186500     MOVE ASC-LAST-UPD-BY-TME      TO ALSTTMEO.                   18650016
186600                                                                  18660016
186700/                                                                 18670016
186800*----------------------------------------------------------------*18680016
186900*    PERFORM ADD NEW PACK SLIP ITEM PROCESSING                   *18690016
187000*----------------------------------------------------------------*18700016
187100 5000-ADD-PACK-SLIP-SELECT.                                       18710016
187200                                                                  18720016
187300     IF ASC-PKSL-LNE-NBR = SPACES                                 18730016
187400         PERFORM 5200-SETUP-NEXT-LINE-NBR                         18740016
187500         PERFORM 5210-INSERT-UNMATCHED-ITEM                       18750016
187600     ELSE                                                         18760016
187700         PERFORM 8200-SELECT-TPKSLIP                              18770056
187800         IF PKSLIP-ORIG-PKSL-SEQ-NBR > 0                          18780052
187900            MOVE PC-TSYMSG-03214      TO DP020-MSG-NUMBER         18790052
188000            SET PS-ERROR                                          18800052
188100                DP030-OVERRIDE-GO                                 18810052
188200                DP020-MSG-FATAL       TO TRUE                     18820052
188300         ELSE                                                     18830052
188400            PERFORM 5100-INSERT-MATCHED-ITEM                      18840052
188500         END-IF                                                   18850052
188600     END-IF.                                                      18860016
188700/                                                                 18870016
188800*----------------------------------------------------------------*18880016
188900*    PERFORM ADD NEW MATCHED PACK SLIP ITEM PROCESSING           *18890016
189000*----------------------------------------------------------------*18900016
189100 5100-INSERT-MATCHED-ITEM.                                        18910016
189200                                                                  18920016
189300     MOVE ASC-PKSL-LNE-NBR-N       TO DK-PKSL-LNE-NBR.            18930016
189400                                                                  18940016
189500     PERFORM 5110-SELECT-TPKITEM.                                 18950016
189600                                                                  18960016
189700     IF  PS-PKITEM-FOUND                                          18970016
189800         SET PS-ERROR              TO TRUE                        18980016
189900         SET DP020-MSG-FATAL       TO TRUE                        18990016
190000         MOVE PC-TSYMSG-00117      TO DP020-MSG-NUMBER            19000016
190100         MOVE DP015-UNP-NUM-BRT-OFF                               19010016
190200                                   TO ALINEA                      19020016
190300         MOVE DP015-RED            TO ALINEC                      19030016
190400         MOVE DP015-REVERSE        TO ALINEH                      19040016
190500         SET DP030-SET-CURSOR-TRAILER                             19050016
190600                                   TO TRUE                        19060016
190700     ELSE                                                         19070016
190800         INITIALIZE DCLTPKITEM                                    19080016
190900         MOVE ASC-PO-NBR-N         TO PKITEM-PO-NBR               19090016
191000         MOVE ASC-KEY-SEQ-NBR      TO PKITEM-SEQ-NBR              19100016
191100         MOVE ASC-PKSL-LNE-NBR-N   TO PKITEM-PKSL-LNE-NBR         19110016
191200         MOVE ASC-PKSL-ITM-QTY-N   TO PKITEM-PKSL-ITM-QTY         19120016
191300         MOVE ASC-PURITM-VER-NBR   TO PKITEM-PURITM-VER-NBR       19130016
191400         PERFORM 5120-INSERT-TPKITEM                              19140016
191500         MOVE PC-TSYMSG-00034      TO DP020-MSG-NUMBER            19150016
191600         SET DP020-MSG-INFORMATIONAL                              19160016
191700             ASC-ADD-SUCCESSFUL    TO TRUE                        19170016
191800     END-IF.                                                      19180016
191900                                                                  19190016
192000*----------------------------------------------------------------*19200016
192100*    READ THE PACK SLIP ITEM TO SEE WHEN IT WAS CREATED          *19210016
192200*----------------------------------------------------------------*19220016
192300 5110-SELECT-TPKITEM.                                             19230016
192400     PERFORM                                                      19240016
192500         WITH TEST AFTER                                          19250016
192600         VARYING PV-RETRY-COUNTER                                 19260016
192700         FROM 1 BY 1                                              19270016
192800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19280016
192900             OR (SQLCODE = +0)                                    19290016
193000             OR (SQLCODE = +100))                                 19300016
193100                                                                  19310016
193200         EXEC SQL                                                 19320016
193300              SELECT  PKSL_ITM_QTY,                               19330016
193400                      MONTH (A.CRE_TMST),                         19340016
193500                      DAY   (A.CRE_TMST),                         19350016
193600                      YEAR  (A.CRE_TMST),                         19360016
193700                      HOUR  (A.CRE_TMST),                         19370016
193800                      MINUTE(A.CRE_TMST),                         19380016
193900                     A.CRE_UID                                    19390016
194000                INTO :PKITEM-PKSL-ITM-QTY,                        19400016
194100                     :PV-DB2-MONTH,                               19410016
194200                     :PV-DB2-DAY,                                 19420016
194300                     :PV-DB2-YEAR,                                19430016
194400                     :PV-DB2-HOUR,                                19440016
194500                     :PV-DB2-MINUTE,                              19450016
194600                     :PKITEM-CRE-UID                              19460016
194700                FROM TPKITEM A                                    19470016
194800               WHERE A.PO_NBR       = :DK-PO-NBR                  19480016
194900                 AND A.SEQ_NBR      = :ASC-KEY-SEQ-NBR            19490016
195000                 AND A.PKSL_LNE_NBR = :DK-PKSL-LNE-NBR            19500016
195100                 AND A.VER_STAT_CDE = :PC-ACTIVE                  19510016
195200         END-EXEC                                                 19520016
195300                                                                  19530016
195400         EVALUATE TRUE                                            19540016
195500             WHEN SQLCODE = +0                                    19550016
195600                  MOVE PKITEM-PKSL-ITM-QTY                        19560016
195700                                   TO ASC-PKSL-ITM-QTY-N          19570016
195800                  SET PS-PKITEM-FOUND                             19580016
195900                                   TO TRUE                        19590016
196000             WHEN SQLCODE = +100                                  19600016
196100             WHEN SQLCODE = -904                                  19610016
196200             WHEN SQLCODE = -913                                  19620016
196300                  CONTINUE                                        19630016
196400                                                                  19640016
196500             WHEN SQLWARN0 NOT = SPACES                           19650016
196600             WHEN SQLCODE < +0                                    19660016
196700             WHEN SQLCODE > +0                                    19670016
196800                  MOVE '5110-SELECT-TPKITEM'                      19680016
196900                                   TO DP013-PARAGRAPH             19690016
197000                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP ITEM'       19700016
197100                                   TO DP013-MESSAGE-TEXT (1)      19710016
197200                  MOVE SQLCA       TO DP013-SQLCA                 19720016
197300                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    19730016
197400                  SET DP013-DB2-ABEND                             19740016
197500                      DP013-XCTL-DISPLAY-RESTART                  19750016
197600                                   TO TRUE                        19760016
197700                  PERFORM DP013-0000-PROCESS-ABEND                19770016
197800         END-EVALUATE                                             19780016
197900     END-PERFORM.                                                 19790016
198000                                                                  19800016
198100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19810016
198200         MOVE '5110-SELECT-TPKITEM'                               19820016
198300                                   TO DP013-PARAGRAPH             19830016
198400         MOVE 'MAX RETRIES EXCEEDED ON SELECT PACK SLIP ITEM'     19840016
198500                                   TO DP013-MESSAGE-TEXT (1)      19850016
198600         MOVE SQLCA                TO DP013-SQLCA                 19860016
198700         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    19870016
198800         SET DP013-DB2-ABEND                                      19880016
198900             DP013-XCTL-DISPLAY-RESTART                           19890016
199000                                   TO TRUE                        19900016
199100         PERFORM DP013-0000-PROCESS-ABEND                         19910016
199200     END-IF.                                                      19920016
199300                                                                  19930016
199400/                                                                 19940016
199500*----------------------------------------------------------------*19950016
199600*    INSERT A PACK SLIP ITEM ROW                                 *19960016
199700*----------------------------------------------------------------*19970016
199800                                                                  19980016
199900 5120-INSERT-TPKITEM.                                             19990016
200000                                                                  20000060
200100*TCR  AUTOVE                                                      20010060
200200         SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE.                     20020060
200300         PERFORM 5125-CHECK-ASN.                                  20030061
200400         MOVE 0 TO PV-ORIG-PKSL-ITM-QTY.                          20040060
200500         IF PS-ORIG-ASN-PKSLIP-YES                                20050060
200600            MOVE PKITEM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY      20060060
200700         END-IF.                                                  20070060
200800*TCR  AUTOVE                                                      20080060
200900                                                                  20090060
201000     PERFORM                                                      20100016
201100         WITH TEST AFTER                                          20110016
201200         VARYING PV-RETRY-COUNTER                                 20120016
201300         FROM 1 BY 1                                              20130016
201400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20140016
201500             OR (SQLCODE = +0))                                   20150016
201600                                                                  20160016
201700         EXEC SQL                                                 20170016
201800              INSERT INTO TPKITEM                                 20180016
201900                     (PO_NBR,                                     20190016
202000                      SEQ_NBR,                                    20200016
202100                      PKSL_LNE_NBR,                               20210016
202200                      CRE_TMST,                                   20220016
202300                      VER_STAT_CDE,                               20230016
202400                      PKSL_ITM_QTY,                               20240016
202500                      CRE_UID,                                    20250016
202600                      PURITM_VER_NBR,                             20260058
202700                      ORIG_PKSL_ITM_QTY)                          20270058
202800              VALUES (:PKITEM-PO-NBR,                             20280016
202900                      :PKITEM-SEQ-NBR,                            20290016
203000                      :PKITEM-PKSL-LNE-NBR,                       20300016
203100                       CURRENT TIMESTAMP,                         20310016
203200                      :PC-ACTIVE,                                 20320016
203300                      :PKITEM-PKSL-ITM-QTY,                       20330016
203400                      :DP020-USERID,                              20340016
203500                      :PKITEM-PURITM-VER-NBR,                     20350058
203600                      :PV-ORIG-PKSL-ITM-QTY)                      20360060
203700         END-EXEC                                                 20370016
203800                                                                  20380016
203900         EVALUATE TRUE                                            20390016
204000             WHEN SQLCODE = +0                                    20400016
204100                PERFORM 5700-CHECK-PREPACK                        20410033
204200                IF PREPACK-PO                                     20420033
204300                   PERFORM 5400-GET-PACK-SKU                      20430033
204400                ELSE                                              20440072
204500                   MOVE 0   TO POPRPK-PK-SKU-NBR                  20450072
204600                   PERFORM 5600-INSERT-WFT-LOD-XFER               20460072
204700                   PERFORM 5500-INSERT-WFT-LOD-CNTL               20470072
204800                END-IF                                            20480033
204900             WHEN SQLCODE = -904                                  20490016
205000             WHEN SQLCODE = -913                                  20500016
205100                  CONTINUE                                        20510016
205200                                                                  20520016
205300             WHEN SQLWARN0 NOT = SPACES                           20530016
205400             WHEN SQLCODE < +0                                    20540016
205500             WHEN SQLCODE > +0                                    20550016
205600                  MOVE '5120-INSERT-TPKITEM'                      20560016
205700                                   TO DP013-PARAGRAPH             20570016
205800                  MOVE 'UNSUCCESSFUL INSERT FOR TPKITEM'          20580016
205900                                   TO DP013-MESSAGE-TEXT (1)      20590016
206000                  MOVE SQLCA       TO DP013-SQLCA                 20600016
206100                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    20610016
206200                  SET DP013-DB2-ABEND                             20620016
206300                      DP013-XCTL-DISPLAY-RESTART                  20630016
206400                                   TO TRUE                        20640016
206500                  PERFORM DP013-0000-PROCESS-ABEND                20650016
206600         END-EVALUATE                                             20660016
206700     END-PERFORM.                                                 20670016
206800                                                                  20680016
206900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20690016
207000         MOVE '5120-INSERT-TPKITEM'                               20700016
207100                                   TO DP013-PARAGRAPH             20710016
207200         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TPKITEM'        20720016
207300                                   TO DP013-MESSAGE-TEXT (1)      20730016
207400         MOVE SQLCA                TO DP013-SQLCA                 20740016
207500         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    20750016
207600         SET DP013-XCTL-DISPLAY-RESTART                           20760016
207700             DP013-DB2-ABEND       TO TRUE                        20770016
207800         PERFORM DP013-0000-PROCESS-ABEND                         20780016
207900     END-IF.                                                      20790016
208000                                                                  20800016
208100******************************************************************20810060
208200**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **20820060
208300******************************************************************20830060
208400 5125-CHECK-ASN.                                                  20840060
208500                                                                  20850060
208600         EXEC SQL                                                 20860060
208700           SELECT A.CRE_UID                                       20870067
208800           INTO  :PKSLIP-CRE-UID                                  20880060
208900           FROM   TPKSLIP A                                       20890060
209000           WHERE  A.PO_NBR       = :DK-PO-NBR                     20900067
209100             AND  A.SEQ_NBR      = :ASC-KEY-SEQ-NBR               20910067
209200             AND  A.CRE_TMST =                                    20920067
209300                (SELECT MIN(CRE_TMST)                             20930067
209400                  FROM   TPKSLIP B                                20940067
209500                  WHERE A.PO_NBR = B.PO_NBR                       20950067
209600                  AND   A.SEQ_NBR = B.SEQ_NBR)                    20960067
209700         END-EXEC.                                                20970060
209800                                                                  20980060
209900         EVALUATE TRUE                                            20990060
210000             WHEN SQLCODE = ZERO                                  21000060
210100                  IF PKSLIP-CRE-UID = PC-RCKUP006                 21010060
210200                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          21020060
210300                  END-IF                                          21030060
210400             WHEN SQLCODE = +100                                  21040060
210500                  CONTINUE                                        21050060
210600             WHEN SQLCODE = -904                                  21060060
210700             WHEN SQLCODE = -911                                  21070060
210800             WHEN SQLCODE = -913                                  21080060
210900                  CONTINUE                                        21090062
211000                                                                  21100060
211100             WHEN SQLWARN0 NOT = SPACES                           21110060
211200             WHEN SQLCODE  NOT = ZERO                             21120060
211300                  MOVE '5125-CHECK-ASN'                           21130061
211400                                   TO DP013-PARAGRAPH             21140061
211500                  MOVE 'UNSUCCESSFUL SELECT FOR TPKSLIP'          21150061
211600                                   TO DP013-MESSAGE-TEXT (1)      21160061
211700                  MOVE SQLCA       TO DP013-SQLCA                 21170061
211800                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    21180061
211900                  SET DP013-DB2-ABEND                             21190061
212000                      DP013-XCTL-DISPLAY-RESTART                  21200061
212100                                   TO TRUE                        21210061
212200                  PERFORM DP013-0000-PROCESS-ABEND                21220061
212300         END-EVALUATE.                                            21230060
212400                                                                  21240060
212500/                                                                 21250016
212600*----------------------------------------------------------------*21260016
212700*    PERFORM THE ROUTINE TO GET THE MAX LINE NBR.                *21270016
212800*----------------------------------------------------------------*21280016
212900 5200-SETUP-NEXT-LINE-NBR.                                        21290016
213000                                                                  21300016
213100     INITIALIZE DCLTUNPKSL.                                       21310016
213200                                                                  21320016
213300     MOVE ASC-PO-NBR-N             TO DK-PO-NBR.                  21330016
213400                                                                  21340016
213500     PERFORM 5220-GET-NEXT-LINE-NBR.                              21350016
213600                                                                  21360016
213700     MOVE PV-NEXT-LINE-NBR         TO UNPKSL-PKSL-LNE-NBR.        21370016
213800                                                                  21380016
213900/                                                                 21390016
214000*----------------------------------------------------------------*21400016
214100*    PERFORM ADD NEW UNMATCHED PACK SLIP ITEM PROCESSING         *21410016
214200*----------------------------------------------------------------*21420016
214300 5210-INSERT-UNMATCHED-ITEM.                                      21430016
214400                                                                  21440016
214500     MOVE ASC-PO-NBR-N             TO UNPKSL-PO-NBR.              21450016
214600     MOVE ASC-KEY-SEQ-NBR          TO UNPKSL-SEQ-NBR.             21460016
214700     MOVE ASC-PKSL-ITM-QTY-N       TO UNPKSL-PKSL-ITM-QTY.        21470016
214800     MOVE DK-UNT-COST-AMT          TO UNPKSL-UNT-COST-AMT.        21480016
214900     MOVE ASC-COLOR-DESC           TO UNPKSL-COLOR-DESC.          21490016
215000     MOVE ASC-SIZE-DESC            TO UNPKSL-SIZE-DESC.           21500016
215100     MOVE ASC-VEND-STYL-NAME       TO UNPKSL-VEND-STYL-NAME.      21510016
215200     MOVE ASC-VEND-DESC            TO UNPKSL-VEND-DESC.           21520016
215300     MOVE PC-ACTIVE                TO UNPKSL-VER-STAT-CDE.        21530016
215400                                                                  21540016
215500     PERFORM 5230-INSERT-TUNPKSL.                                 21550016
215600                                                                  21560016
215700     IF  SQLCODE = +0                                             21570016
215800         MOVE PC-TSYMSG-00034      TO DP020-MSG-NUMBER            21580016
215900         SET DP020-MSG-INFORMATIONAL                              21590016
216000             ASC-ADD-SUCCESSFUL    TO TRUE                        21600016
216100     END-IF.                                                      21610016
216200                                                                  21620016
216300*----------------------------------------------------------------*21630016
216400*    FIND THE ROW WITH THE HIGHEST LINE NBR.                     *21640016
216500*----------------------------------------------------------------*21650016
216600                                                                  21660016
216700 5220-GET-NEXT-LINE-NBR.                                          21670016
216800                                                                  21680016
216900     PERFORM                                                      21690016
217000         WITH TEST AFTER                                          21700016
217100         VARYING PV-RETRY-COUNTER                                 21710016
217200         FROM 1 BY 1                                              21720016
217300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21730016
217400             OR (SQLCODE = +0)                                    21740016
217500             OR (SQLCODE = -305))                                 21750016
217600                                                                  21760016
217700         EXEC SQL                                                 21770016
217800              SELECT MAX (PKSL_LNE_NBR)                           21780016
217900                INTO :PV-MAX-LINE-NBR :PV-LINE-NBR-IND            21790016
218000                FROM TUNPKSL                                      21800016
218100               WHERE PO_NBR = :DK-PO-NBR                          21810016
218200         END-EXEC                                                 21820016
218300                                                                  21830016
218400         EVALUATE TRUE                                            21840016
218500             WHEN SQLCODE = +0                                    21850016
218600                  IF PV-LINE-NBR-IND = -1                         21860016
218700                      MOVE PC-9000 TO PV-NEXT-LINE-NBR            21870016
218800                  ELSE                                            21880016
218900                      COMPUTE PV-NEXT-LINE-NBR =                  21890016
219000                              PV-MAX-LINE-NBR + 1                 21900016
219100                  END-IF                                          21910016
219200                                                                  21920016
219300             WHEN SQLCODE = +100                                  21930016
219400                  MOVE PC-9000     TO PV-NEXT-LINE-NBR            21940016
219500                                                                  21950016
219600             WHEN SQLCODE = -904                                  21960016
219700             WHEN SQLCODE = -913                                  21970016
219800                  CONTINUE                                        21980016
219900                                                                  21990016
220000             WHEN SQLWARN0 NOT = SPACES                           22000016
220100             WHEN SQLCODE < +0                                    22010016
220200             WHEN SQLCODE > +0                                    22020016
220300                  MOVE '5220-GET-NEXT-LINE-NBR'                   22030016
220400                                   TO DP013-PARAGRAPH             22040016
220500                  MOVE 'UNSUCCESSFUL SELECT MAX LINE NBR'         22050016
220600                                   TO DP013-MESSAGE-TEXT (1)      22060016
220700                  MOVE SQLCA       TO DP013-SQLCA                 22070016
220800                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    22080016
220900                  SET DP013-DB2-ABEND                             22090016
221000                      DP013-XCTL-DISPLAY-RESTART                  22100016
221100                                   TO TRUE                        22110016
221200                  PERFORM DP013-0000-PROCESS-ABEND                22120016
221300         END-EVALUATE                                             22130016
221400     END-PERFORM.                                                 22140016
221500                                                                  22150016
221600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22160016
221700         MOVE '5220-GET-NEXT-LINE-NBR'                            22170016
221800                                   TO DP013-PARAGRAPH             22180016
221900         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX LINE NBR'       22190016
222000                                   TO DP013-MESSAGE-TEXT (1)      22200016
222100         MOVE SQLCA                TO DP013-SQLCA                 22210016
222200         MOVE 'TUNPKSL '           TO DP013-DB2-TABLE-NAME (1)    22220016
222300         SET DP013-DB2-ABEND                                      22230016
222400             DP013-XCTL-DISPLAY-RESTART                           22240016
222500                                   TO TRUE                        22250016
222600         PERFORM DP013-0000-PROCESS-ABEND                         22260016
222700     END-IF.                                                      22270016
222800                                                                  22280016
222900/                                                                 22290016
223000                                                                  22300016
223100*----------------------------------------------------------------*22310016
223200*    INSERT AN UNMATCHED PACK SLIP ITEM ROW                      *22320016
223300*----------------------------------------------------------------*22330016
223400                                                                  22340016
223500 5230-INSERT-TUNPKSL.                                             22350016
223600                                                                  22360016
223700     PERFORM                                                      22370016
223800         WITH TEST AFTER                                          22380016
223900         VARYING PV-RETRY-COUNTER                                 22390016
224000         FROM 1 BY 1                                              22400016
224100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22410016
224200             OR (SQLCODE = +0))                                   22420016
224300                                                                  22430016
224400         EXEC SQL                                                 22440016
224500              INSERT INTO TUNPKSL                                 22450016
224600                     (PO_NBR,                                     22460016
224700                      SEQ_NBR,                                    22470016
224800                      PKSL_LNE_NBR,                               22480016
224900                      CRE_TMST,                                   22490016
225000                      VER_STAT_CDE,                               22500016
225100                      PKSL_ITM_QTY,                               22510016
225200                      UNT_COST_AMT,                               22520016
225300                      COLOR_DESC,                                 22530016
225400                      SIZE_DESC,                                  22540016
225500                      VEND_STYL_NAME,                             22550016
225600                      VEND_DESC,                                  22560016
225700                      CRE_UID)                                    22570016
225800              VALUES (:UNPKSL-PO-NBR,                             22580016
225900                      :ASC-KEY-SEQ-NBR,                           22590016
226000                      :UNPKSL-PKSL-LNE-NBR,                       22600016
226100                       CURRENT TIMESTAMP,                         22610016
226200                      :UNPKSL-VER-STAT-CDE,                       22620016
226300                      :UNPKSL-PKSL-ITM-QTY,                       22630016
226400                      :UNPKSL-UNT-COST-AMT,                       22640016
226500                      :UNPKSL-COLOR-DESC,                         22650016
226600                      :UNPKSL-SIZE-DESC,                          22660016
226700                      :UNPKSL-VEND-STYL-NAME,                     22670016
226800                      :UNPKSL-VEND-DESC,                          22680016
226900                      :DP020-USERID)                              22690016
227000         END-EXEC                                                 22700016
227100                                                                  22710016
227200         EVALUATE TRUE                                            22720016
227300             WHEN SQLCODE = +0                                    22730016
227400             WHEN SQLCODE = -904                                  22740016
227500             WHEN SQLCODE = -913                                  22750016
227600                  CONTINUE                                        22760016
227700                                                                  22770016
227800             WHEN SQLWARN0 NOT = SPACES                           22780016
227900             WHEN SQLCODE < +0                                    22790016
228000             WHEN SQLCODE > +0                                    22800016
228100                  MOVE '5230-INSERT-TUNPKSL'                      22810016
228200                                   TO DP013-PARAGRAPH             22820016
228300                  MOVE 'UNSUCCESSFUL INSERT FOR TUNPKSL'          22830016
228400                                   TO DP013-MESSAGE-TEXT (1)      22840016
228500                  MOVE SQLCA       TO DP013-SQLCA                 22850016
228600                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    22860016
228700                  SET DP013-DB2-ABEND                             22870016
228800                      DP013-XCTL-DISPLAY-RESTART                  22880016
228900                                   TO TRUE                        22890016
229000                  PERFORM DP013-0000-PROCESS-ABEND                22900016
229100         END-EVALUATE                                             22910016
229200     END-PERFORM.                                                 22920016
229300                                                                  22930016
229400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22940016
229500         MOVE '5230-INSERT-TUNPKSL'                               22950016
229600                                   TO DP013-PARAGRAPH             22960016
229700         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TUNPKSL'        22970016
229800                                   TO DP013-MESSAGE-TEXT (1)      22980016
229900         MOVE SQLCA                TO DP013-SQLCA                 22990016
230000         MOVE 'TUNPKSL '           TO DP013-DB2-TABLE-NAME (1)    23000016
230100         SET DP013-XCTL-DISPLAY-RESTART                           23010016
230200             DP013-DB2-ABEND       TO TRUE                        23020016
230300         PERFORM DP013-0000-PROCESS-ABEND                         23030016
230400     END-IF.                                                      23040016
230500                                                                  23050016
230600/                                                                 23060016
230700*----------------------------------------------------------------*23070016
230800* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *23080016
230900* OBJECT WAS UDPATED.                                            *23090016
231000*----------------------------------------------------------------*23100016
231100                                                                  23110016
231200 5300-UPDATE-SELECTION-QUEUE.                                     23120016
231300                                                                  23130016
231400     PERFORM 9100-READ-SEL-QUEUE.                                 23140016
231500                                                                  23150016
231600     IF  ASC-DELETE-SUCCESSFUL                                    23160016
231700         SET RC013-DEL (ASC-SEL-SUB)                              23170016
231800                                   TO TRUE                        23180016
231900     ELSE                                                         23190016
232000         SET RC013-UPD (ASC-SEL-SUB)                              23200016
232100                                   TO TRUE                        23210016
232200     END-IF.                                                      23220016
232300                                                                  23230016
232400     PERFORM 9200-REWRITE-SEL-QUEUE.                              23240016
232500                                                                  23250016
232600/                                                                 23260016
232700***************************************************************** 23270018
232800*     CHECK PACK UPC                                              23280018
232900***************************************************************** 23290018
233000 5400-GET-PACK-SKU.                                               23300018
233100                                                                  23310018
233200     MOVE PKITEM-PO-NBR TO PURITM-PO-NBR.                         23320033
233300     MOVE PKITEM-PKSL-LNE-NBR TO PURITM-PO-LNE-NBR.               23330033
233400     EXEC SQL                                                     23340047
233500        SELECT  B.PO_NBR, B.PK_SKU_NBR                            23350047
233600          INTO :POPRPK-PO-NBR,                                    23360047
233700               :POPRPK-PK-SKU-NBR                                 23370047
233800          FROM TPURITM A,                                         23380047
233900               TPOPRPK B                                          23390047
234000          WHERE A.PO_NBR      = :PURITM-PO-NBR       AND          23400047
234100                A.APP_PO_LNE_NBR = :PURITM-PO-LNE-NBR   AND       23410047
234200                A.PO_NBR      = B.PO_NBR             AND          23420047
234300                A.PO_PREPK_ID = B.PO_PREPK_ID        AND          23430047
234400                A.VER_STATUS_CDE = 'A'                            23440048
234500     END-EXEC.                                                    23450047
234600     EVALUATE TRUE                                                23460047
234700        WHEN SQLCODE = +0                                         23470047
234800           PERFORM 5600-INSERT-WFT-LOD-XFER                       23480047
234900           PERFORM 5500-INSERT-WFT-LOD-CNTL                       23490047
235000        WHEN SQLCODE = +100                                       23500047
235100           MOVE 0 TO SQLCODE                                      23510049
235200        WHEN SQLWARN0 NOT = SPACES                                23520047
235300        WHEN SQLCODE < +0                                         23530047
235400        WHEN SQLCODE > +0                                         23540047
235500             MOVE '5400-GET-PACK-SKU'                             23550047
235600                              TO DP013-PARAGRAPH                  23560047
235700             MOVE 'UNSUCCESSFUL SELECT PACK SKU'                  23570047
235800                              TO DP013-MESSAGE-TEXT (1)           23580047
235900             MOVE SQLCA       TO DP013-SQLCA                      23590047
236000             MOVE 'TPOPRPK '  TO DP013-DB2-TABLE-NAME (1)         23600047
236100             SET DP013-DB2-ABEND                                  23610047
236200                 DP013-XCTL-DISPLAY-RESTART                       23620047
236300                              TO TRUE                             23630047
236400             PERFORM DP013-0000-PROCESS-ABEND                     23640047
236500     END-EVALUATE.                                                23650047
236600 5500-INSERT-WFT-LOD-CNTL.                                        23660019
236700                                                                  23670019
236800                                                                  23680021
236900     EXEC SQL                                                     23690047
237000         INSERT INTO WFT_LOD_CNTL                                 23700047
237100             ( PRC_CNTL_TMST                                      23710047
237200              ,TRN_TYP_CDE                                        23720047
237300              ,STAT_CDE                                           23730047
237400              ,INIT_PRCG_BEG_TMST                                 23740047
237500              ,END_TMST                                           23750047
237600              ,ARCH_DAT_IND                                       23760047
237700              ,DAT_LOD_VER_NBR                                    23770047
237800              ,STR_NBR                                            23780047
237900             )                                                    23790047
238000         VALUES                                                   23800047
238100             (:WFT00002-PRC-CNTL-TMST                             23810047
238200             ,'PSLPCK'                                            23820047
238300             ,'READY'                                             23830047
238400             ,'0001-01-01-00.00.00.000000'                        23840047
238500             ,'0001-01-01-00.00.00.000000'                        23850047
238600             ,'N'                                                 23860047
238700             ,10.01                                               23870047
238800             ,0900                                                23880047
238900             )                                                    23890047
239000     END-EXEC.                                                    23900047
239100                                                                  23910047
239200     EVALUATE TRUE                                                23920047
239300        WHEN SQLCODE = +0                                         23930047
239400        WHEN SQLCODE = +100                                       23940047
239500        WHEN SQLCODE = -904                                       23950047
239600        WHEN SQLCODE = -913                                       23960047
239700             CONTINUE                                             23970047
239800        WHEN SQLWARN0 NOT = SPACES                                23980047
239900        WHEN SQLCODE < +0                                         23990047
240000        WHEN SQLCODE > +0                                         24000047
240100             MOVE '5500-INSERT-WFT-LOD-CNTL'                      24010047
240200                              TO DP013-PARAGRAPH                  24020047
240300             MOVE 'UNSUCCESSFUL INSERT WFT-LOD-CNTL'              24030047
240400                              TO DP013-MESSAGE-TEXT (1)           24040047
240500             MOVE SQLCA       TO DP013-SQLCA                      24050047
240600             MOVE 'WFT_LOD-CNTL'  TO DP013-DB2-TABLE-NAME (1)     24060047
240700             SET DP013-DB2-ABEND                                  24070047
240800                 DP013-XCTL-DISPLAY-RESTART                       24080047
240900                              TO TRUE                             24090047
241000             PERFORM DP013-0000-PROCESS-ABEND                     24100047
241100     END-EVALUATE.                                                24110047
241200                                                                  24120019
241300 5600-INSERT-WFT-LOD-XFER.                                        24130019
241400                                                                  24140019
241500     INITIALIZE WFT00002-LOD-DAT-TXT.                             24150019
241600                                                                  24160019
241700     EXEC SQL                                                     24170028
241800         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          24180028
241900     END-EXEC.                                                    24190028
242000                                                                  24200028
242100     MOVE POPRPK-PO-NBR TO WS-PUBLISH-PO.                         24210041
242200     MOVE POPRPK-PK-SKU-NBR TO WS-PUBLISH-SKU.                    24220041
242300     MOVE LENGTH OF WS-PUBLISH-MESSAGE TO                         24230019
242400        WFT00002-LOD-DAT-TXT-LEN.                                 24240019
242500                                                                  24250019
242600     MOVE WS-PUBLISH-MESSAGE TO                                   24260019
242700        WFT00002-LOD-DAT-TXT-TEXT.                                24270019
242800                                                                  24280019
242900                                                                  24290021
243000     EXEC SQL                                                     24300047
243100         INSERT INTO WFT_LOD_XFER                                 24310047
243200             ( PRC_CNTL_TMST                                      24320047
243300              ,TRN_TYP_CDE                                        24330047
243400              ,BTCH_LOD_SEQ_ID                                    24340047
243500              ,LOD_DAT_TXT                                        24350047
243600             )                                                    24360047
243700         VALUES                                                   24370047
243800             (:WFT00002-PRC-CNTL-TMST                             24380047
243900             ,'PSLPCK'                                            24390047
244000             ,1                                                   24400047
244100             ,:WFT00002-LOD-DAT-TXT                               24410047
244200             )                                                    24420047
244300     END-EXEC.                                                    24430047
244400                                                                  24440047
244500     EVALUATE TRUE                                                24450047
244600        WHEN SQLCODE = +0                                         24460047
244700        WHEN SQLCODE = +100                                       24470047
244800        WHEN SQLCODE = -904                                       24480047
244900        WHEN SQLCODE = -913                                       24490047
245000             CONTINUE                                             24500047
245100        WHEN SQLWARN0 NOT = SPACES                                24510047
245200        WHEN SQLCODE < +0                                         24520047
245300        WHEN SQLCODE > +0                                         24530047
245400             MOVE '5600-INSERT-WFT-LOD-XFER'                      24540047
245500                              TO DP013-PARAGRAPH                  24550047
245600             MOVE 'UNSUCCESSFUL INSERT WFT-LOD-XFER'              24560047
245700                              TO DP013-MESSAGE-TEXT (1)           24570047
245800             MOVE SQLCA       TO DP013-SQLCA                      24580047
245900             MOVE 'WFT_LOD-XFER'  TO DP013-DB2-TABLE-NAME (1)     24590047
246000             SET DP013-DB2-ABEND                                  24600047
246100                 DP013-XCTL-DISPLAY-RESTART                       24610047
246200                              TO TRUE                             24620047
246300             PERFORM DP013-0000-PROCESS-ABEND                     24630047
246400     END-EVALUATE.                                                24640047
246500/                                                                 24650030
246600***************************************************************** 24660030
246700*     CHECK PREPACK                                               24670030
246800*                                                                 24680030
246900***************************************************************** 24690030
247000 5700-CHECK-PREPACK.                                              24700030
247100     MOVE PKITEM-PO-NBR TO POPRPK-PO-NBR.                         24710030
247200     EXEC SQL                                                     24720030
247300        SELECT A.PO_PREPK_ID                                      24730030
247400          INTO :POPRPK-PO-PREPK-ID                                24740030
247500          FROM TPOPRPK A                                          24750030
247600          WHERE A.PO_NBR = :POPRPK-PO-NBR                         24760030
247700     END-EXEC.                                                    24770030
247800                                                                  24780030
247900     EVALUATE TRUE                                                24790030
248000        WHEN SQLCODE = +0                                         24800030
248100        WHEN SQLCODE = -811                                       24810031
248200           SET PREPACK-PO TO TRUE                                 24820032
248300        WHEN SQLCODE = +100                                       24830031
248400           SET NOT-PREPACK-PO TO TRUE                             24840032
248500        WHEN SQLCODE = -904                                       24850031
248600        WHEN SQLCODE = -913                                       24860031
248700             CONTINUE                                             24870031
248800        WHEN SQLWARN0 NOT = SPACES                                24880031
248900        WHEN SQLCODE < +0                                         24890031
249000        WHEN SQLCODE > +0                                         24900031
249100             MOVE '5700-CHECK-PREPACK'                            24910031
249200                              TO DP013-PARAGRAPH                  24920031
249300             MOVE 'UNSUCCESSFUL SELECT TPOPRPK'                   24930031
249400                              TO DP013-MESSAGE-TEXT (1)           24940031
249500             MOVE SQLCA       TO DP013-SQLCA                      24950031
249600             MOVE 'TPOPRPK'  TO DP013-DB2-TABLE-NAME (1)          24960031
249700             SET DP013-DB2-ABEND                                  24970031
249800                 DP013-XCTL-DISPLAY-RESTART                       24980031
249900                              TO TRUE                             24990031
250000             PERFORM DP013-0000-PROCESS-ABEND                     25000031
250100     END-EVALUATE.                                                25010034
250200     MOVE 0 TO SQLCODE.                                           25020046
250300                                                                  25030019
250400/                                                                 25040018
250500*----------------------------------------------------------------*25050016
250600*    PERFORM UPDATE PACK SLIP ITEM PROCESSING                    *25060016
250700*----------------------------------------------------------------*25070016
250800 6000-UPDATE-PACK-SLIP-SELECT.                                    25080016
250900                                                                  25090016
251000     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  25100016
251100     MOVE ASC-PKSL-LNE-NBR-N       TO DK-PKSL-LNE-NBR.            25110016
251200                                                                  25120016
251300     IF ASC-PKSL-LNE-NBR-N < PC-9000                              25130016
251400         IF ASC-KEY-PKSL-LNE-NBR < PC-9000                        25140016
251500            PERFORM 8200-SELECT-TPKSLIP                           25150056
251600            IF PKSLIP-ORIG-PKSL-SEQ-NBR > 0                       25160055
251700               MOVE PC-TSYMSG-03213      TO DP020-MSG-NUMBER      25170055
251800               SET PS-ERROR                                       25180055
251900                   DP030-OVERRIDE-GO                              25190055
252000                   DP020-MSG-FATAL       TO TRUE                  25200055
252100            ELSE                                                  25210055
252200               PERFORM 6100-UPDATE-MATCHED-ITEM                   25220055
252300            END-IF                                                25230055
252400         ELSE                                                     25240016
252500             PERFORM 6300-CHG-UNMATCHED-TO-MATCHED                25250016
252600         END-IF                                                   25260055
252700     ELSE                                                         25270016
252800         PERFORM 6200-UPDATE-UNMATCHED-ITEM                       25280055
252900     END-IF.                                                      25290016
253000                                                                  25300016
253100/                                                                 25310016
253200*----------------------------------------------------------------*25320016
253300*    PERFORM UPDATE PACK SLIP ITEM PROCESSING                    *25330016
253400*----------------------------------------------------------------*25340016
253500 6100-UPDATE-MATCHED-ITEM.                                        25350016
253600                                                                  25360016
253700     PERFORM 8000-SELECT-TPKITEM.                                 25370016
253800     PERFORM 6110-SET-TPKITEM-INACT.                              25380016
253900                                                                  25390016
254000     MOVE ASC-PKSL-LNE-NBR-N       TO PKITEM-PKSL-LNE-NBR.        25400016
254100     MOVE ASC-PKSL-ITM-QTY-N       TO PKITEM-PKSL-ITM-QTY.        25410016
254200                                                                  25420016
254300     PERFORM 5120-INSERT-TPKITEM.                                 25430016
254400                                                                  25440016
254500     IF  SQLCODE = +0                                             25450016
254600         MOVE PC-TSYMSG-00059      TO DP020-MSG-NUMBER            25460016
254700         SET DP020-MSG-INFORMATIONAL                              25470016
254800                                   TO TRUE                        25480016
254900         IF  ASC-USE-SELECTION-QUEUE                              25490016
255000             PERFORM 5300-UPDATE-SELECTION-QUEUE                  25500016
255100         END-IF                                                   25510016
255200     END-IF.                                                      25520016
255300                                                                  25530016
255400/                                                                 25540016
255500*----------------------------------------------------------------*25550016
255600*    SET THE CURRENT VERSION OF THE PACK SLIP ITEM TO INACTIVE   *25560016
255700*    BEFORE THE INSERT OF THE NEW PACK SLIP ITEM ROW IS DONE.    *25570016
255800*----------------------------------------------------------------*25580016
255900                                                                  25590016
256000 6110-SET-TPKITEM-INACT.                                          25600016
256100                                                                  25610016
256200     PERFORM                                                      25620016
256300         WITH TEST AFTER                                          25630016
256400         VARYING PV-RETRY-COUNTER                                 25640016
256500         FROM 1 BY 1                                              25650016
256600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25660016
256700             OR (SQLCODE = +0))                                   25670016
256800                                                                  25680016
256900         EXEC SQL                                                 25690016
257000              UPDATE TPKITEM                                      25700016
257100                 SET VER_STAT_CDE   = :PC-INACTIVE                25710016
257200               WHERE PO_NBR         = :DK-PO-NBR                  25720016
257300                 AND SEQ_NBR        = :PKITEM-SEQ-NBR             25730016
257400                 AND PKSL_LNE_NBR   = :PKITEM-PKSL-LNE-NBR        25740016
257500                 AND VER_STAT_CDE   = :PC-ACTIVE                  25750016
257600         END-EXEC                                                 25760016
257700                                                                  25770016
257800         EVALUATE TRUE                                            25780016
257900             WHEN SQLCODE = +0                                    25790016
258000             WHEN SQLCODE = -904                                  25800016
258100             WHEN SQLCODE = -913                                  25810016
258200                  CONTINUE                                        25820016
258300                                                                  25830016
258400             WHEN SQLWARN0 NOT = SPACES                           25840016
258500             WHEN SQLCODE < +0                                    25850016
258600             WHEN SQLCODE > +0                                    25860016
258700                  MOVE '6110-SET-TPKITEM-INACT'                   25870016
258800                                   TO DP013-PARAGRAPH             25880016
258900                  MOVE 'UNSUCCESSFUL UPDATE FOR TPKITEM'          25890016
259000                                   TO DP013-MESSAGE-TEXT (1)      25900016
259100                  MOVE SQLCA       TO DP013-SQLCA                 25910016
259200                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    25920016
259300                  SET DP013-DB2-ABEND                             25930016
259400                      DP013-XCTL-DISPLAY-RESTART                  25940016
259500                                   TO TRUE                        25950016
259600                  PERFORM DP013-0000-PROCESS-ABEND                25960016
259700         END-EVALUATE                                             25970016
259800     END-PERFORM.                                                 25980016
259900                                                                  25990016
260000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26000016
260100         MOVE '6110-SET-TPKITEM-INACT'                            26010016
260200                                   TO DP013-PARAGRAPH             26020016
260300         MOVE 'MAX RETRIES EXCEEDED FOR UPDATE ON TPKITEM'        26030016
260400                                   TO DP013-MESSAGE-TEXT (1)      26040016
260500         MOVE SQLCA                TO DP013-SQLCA                 26050016
260600         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    26060016
260700         SET DP013-DB2-ABEND                                      26070016
260800             DP013-XCTL-DISPLAY-RESTART                           26080016
260900                                   TO TRUE                        26090016
261000         PERFORM DP013-0000-PROCESS-ABEND                         26100016
261100     END-IF.                                                      26110016
261200                                                                  26120016
261300/                                                                 26130016
261400*----------------------------------------------------------------*26140016
261500*    PERFORM UPDATE UNMATCHED PACK SLIP ITEM PROCESSING          *26150016
261600*----------------------------------------------------------------*26160016
261700 6200-UPDATE-UNMATCHED-ITEM.                                      26170016
261800                                                                  26180016
261900     PERFORM 8100-SELECT-TUNPKSL.                                 26190016
262000     PERFORM 6210-UPDATE-TUNPKSL.                                 26200016
262100                                                                  26210016
262200     MOVE ASC-PKSL-LNE-NBR-N       TO UNPKSL-PKSL-LNE-NBR.        26220016
262300                                                                  26230016
262400     PERFORM 5210-INSERT-UNMATCHED-ITEM.                          26240016
262500                                                                  26250016
262600     IF  SQLCODE = +0                                             26260016
262700         MOVE PC-TSYMSG-00059      TO DP020-MSG-NUMBER            26270016
262800         SET DP020-MSG-INFORMATIONAL                              26280016
262900                                   TO TRUE                        26290016
263000         IF  ASC-USE-SELECTION-QUEUE                              26300016
263100             PERFORM 5300-UPDATE-SELECTION-QUEUE                  26310016
263200         END-IF                                                   26320016
263300     END-IF.                                                      26330016
263400                                                                  26340016
263500/                                                                 26350016
263600*----------------------------------------------------------------*26360016
263700*    SET THE CURRENT VERSION OF THE UNMATCHED PACK SLIP ITEM TO  *26370016
263800*    INACTIVE BEFORE THE INSERT OF THE NEW UNMATCHED PACK SLIP   *26380016
263900*    ITEM ROW IS DONE.                                           *26390016
264000*----------------------------------------------------------------*26400016
264100                                                                  26410016
264200 6210-UPDATE-TUNPKSL.                                             26420016
264300                                                                  26430016
264400     PERFORM                                                      26440016
264500         WITH TEST AFTER                                          26450016
264600         VARYING PV-RETRY-COUNTER                                 26460016
264700         FROM 1 BY 1                                              26470016
264800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26480016
264900             OR (SQLCODE = +0))                                   26490016
265000                                                                  26500016
265100         EXEC SQL                                                 26510016
265200              UPDATE TUNPKSL                                      26520016
265300                 SET VER_STAT_CDE   = :PC-INACTIVE                26530016
265400               WHERE PO_NBR         = :DK-PO-NBR                  26540016
265500                 AND SEQ_NBR        = :UNPKSL-SEQ-NBR             26550016
265600                 AND PKSL_LNE_NBR   = :UNPKSL-PKSL-LNE-NBR        26560016
265700                 AND VER_STAT_CDE   = :PC-ACTIVE                  26570016
265800         END-EXEC                                                 26580016
265900                                                                  26590016
266000         EVALUATE TRUE                                            26600016
266100             WHEN SQLCODE = +0                                    26610016
266200             WHEN SQLCODE = -904                                  26620016
266300             WHEN SQLCODE = -913                                  26630016
266400                  CONTINUE                                        26640016
266500                                                                  26650016
266600             WHEN SQLWARN0 NOT = SPACES                           26660016
266700             WHEN SQLCODE < +0                                    26670016
266800             WHEN SQLCODE > +0                                    26680016
266900                  MOVE '6210-UPDATE-TUNPKSL'                      26690016
267000                                   TO DP013-PARAGRAPH             26700016
267100                  MOVE 'UNSUCCESSFUL UPDATE FOR TUNPKSL'          26710016
267200                                   TO DP013-MESSAGE-TEXT (1)      26720016
267300                  MOVE SQLCA       TO DP013-SQLCA                 26730016
267400                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    26740016
267500                  SET DP013-DB2-ABEND                             26750016
267600                      DP013-XCTL-DISPLAY-RESTART                  26760016
267700                                   TO TRUE                        26770016
267800                  PERFORM DP013-0000-PROCESS-ABEND                26780016
267900         END-EVALUATE                                             26790016
268000     END-PERFORM.                                                 26800016
268100                                                                  26810016
268200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26820016
268300         MOVE '6210-UPDATE-TUNPKSL'                               26830016
268400                                   TO DP013-PARAGRAPH             26840016
268500         MOVE 'MAX RETRIES EXCEEDED FOR UPDATE ON TUNPKSL'        26850016
268600                                   TO DP013-MESSAGE-TEXT (1)      26860016
268700         MOVE SQLCA                TO DP013-SQLCA                 26870016
268800         MOVE 'TUNPKSL '           TO DP013-DB2-TABLE-NAME (1)    26880016
268900         SET DP013-DB2-ABEND                                      26890016
269000             DP013-XCTL-DISPLAY-RESTART                           26900016
269100                                   TO TRUE                        26910016
269200         PERFORM DP013-0000-PROCESS-ABEND                         26920016
269300     END-IF.                                                      26930016
269400                                                                  26940016
269500/                                                                 26950016
269600*----------------------------------------------------------------*26960016
269700*    CHANGE FROM AN UNMATCHED PO LINE TO A MATCHED               *26970016
269800*----------------------------------------------------------------*26980016
269900 6300-CHG-UNMATCHED-TO-MATCHED.                                   26990016
270000                                                                  27000016
270100     MOVE ASC-KEY-PKSL-LNE-NBR     TO DK-PKSL-LNE-NBR.            27010016
270200                                                                  27020016
270300     PERFORM 8100-SELECT-TUNPKSL.                                 27030016
270400     PERFORM 6210-UPDATE-TUNPKSL.                                 27040016
270500                                                                  27050016
270600     MOVE PC-INACTIVE              TO UNPKSL-VER-STAT-CDE.        27060016
270700     PERFORM 5230-INSERT-TUNPKSL.                                 27070016
270800                                                                  27080016
270900     INITIALIZE DCLTPKITEM.                                       27090016
271000                                                                  27100016
271100     MOVE ASC-PKSL-LNE-NBR-N       TO DK-PKSL-LNE-NBR.            27110016
271200     PERFORM 8000-SELECT-TPKITEM.                                 27120016
271300                                                                  27130016
271400     IF PS-PKITEM-FOUND                                           27140016
271500         PERFORM 6110-SET-TPKITEM-INACT                           27150016
271600         COMPUTE PKITEM-PKSL-ITM-QTY =                            27160016
271700             PKITEM-PKSL-ITM-QTY + ASC-PKSL-ITM-QTY-N             27170016
271800     ELSE                                                         27180016
271900         MOVE DK-PO-NBR            TO PKITEM-PO-NBR               27190016
272000         MOVE ASC-KEY-SEQ-NBR      TO PKITEM-SEQ-NBR              27200016
272100         MOVE ASC-PKSL-LNE-NBR-N   TO PKITEM-PKSL-LNE-NBR         27210016
272200         MOVE ASC-PKSL-ITM-QTY-N   TO PKITEM-PKSL-ITM-QTY         27220016
272300         MOVE ASC-PURITM-VER-NBR   TO PKITEM-PURITM-VER-NBR       27230016
272400     END-IF.                                                      27240016
272500                                                                  27250016
272600     PERFORM 5120-INSERT-TPKITEM.                                 27260016
272700                                                                  27270016
272800     IF  SQLCODE = +0                                             27280016
272900         MOVE PC-TSYMSG-00059      TO DP020-MSG-NUMBER            27290016
273000         SET DP020-MSG-INFORMATIONAL                              27300016
273100                                   TO TRUE                        27310016
273200         IF  ASC-USE-SELECTION-QUEUE                              27320016
273300             PERFORM 5300-UPDATE-SELECTION-QUEUE                  27330016
273400         END-IF                                                   27340016
273500     END-IF.                                                      27350016
273600                                                                  27360016
273700/                                                                 27370016
273800*----------------------------------------------------------------*27380016
273900*    PERFORM DELETE PACK SLIP ITEM PROCESSING                    *27390016
274000*----------------------------------------------------------------*27400016
274100 7000-DELETE-PACK-SLIP-SELECT.                                    27410016
274200                                                                  27420016
274300     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  27430016
274400     MOVE ASC-PKSL-LNE-NBR-N       TO DK-PKSL-LNE-NBR.            27440016
274500                                                                  27450016
274600     PERFORM 8200-SELECT-TPKSLIP.                                 27460056
274700                                                                  27470056
274800     IF PKSLIP-ORIG-PKSL-SEQ-NBR > 0                              27480056
274900        MOVE PC-TSYMSG-03207      TO DP020-MSG-NUMBER             27490056
275000        SET PS-ERROR                                              27500056
275100            DP030-OVERRIDE-GO                                     27510056
275200            DP020-MSG-FATAL       TO TRUE                         27520056
275300     ELSE                                                         27530056
275400        PERFORM 7009-CHECK-INACTIVE-TPKSLIP                       27540057
275500                                                                  27550050
275600        IF  PV-DB2-COUNT EQUAL ZERO                               27560056
275700            PERFORM 7001-ACTUAL-DELETE-PACK-SLIP                  27570056
275800        ELSE                                                      27580056
275900            MOVE PC-TSYMSG-00723      TO DP020-MSG-NUMBER         27590056
276000            SET DP020-MSG-FATAL                                   27600056
276100                PS-ERROR              TO TRUE                     27610056
276200        END-IF                                                    27620056
276300     END-IF.                                                      27630056
276400                                                                  27640056
276500 7001-ACTUAL-DELETE-PACK-SLIP.                                    27650016
276600                                                                  27660016
276700     IF ASC-PKSL-LNE-NBR < PC-9000                                27670016
276800         PERFORM 7010-DELETE-TPKITEM                              27680016
276900         PERFORM 7050-CALL-PO-RCVR-TRKING-MOD                     27690068
277000     ELSE                                                         27700016
277100         PERFORM 7020-DELETE-TUNPKSL                              27710016
277200     END-IF.                                                      27720016
277300                                                                  27730016
277400     MOVE PC-TSYMSG-00115          TO DP020-MSG-NUMBER.           27740016
277500     SET DP020-MSG-INFORMATIONAL                                  27750016
277600         ASC-DELETE-SUCCESSFUL     TO TRUE.                       27760016
277700                                                                  27770016
277800     IF  ASC-USE-SELECTION-QUEUE                                  27780016
277900         PERFORM 5300-UPDATE-SELECTION-QUEUE                      27790016
278000     END-IF.                                                      27800016
278100                                                                  27810016
278200 7009-CHECK-INACTIVE-TPKSLIP.                                     27820016
278300                                                                  27830016
278400     MOVE ASC-REC-SEQ-NBR-N      TO ASC-KEY-REC-SEQ-NBRI.         27840016
278500     INITIALIZE PV-DB2-COUNT.                                     27850016
278600                                                                  27860016
278700     EXEC SQL                                                     27870016
278800          SELECT COUNT(*)                                         27880016
278900           INTO  :PV-DB2-COUNT :PV-NULL-IND                       27890016
279000           FROM TPKSLIP                                           27900016
279100           WHERE PO_NBR          = :DK-PO-NBR                     27910016
279200             AND REC_SEQ_NBR     = :ASC-KEY-REC-SEQ-NBRI          27920016
279300             AND SEQ_NBR         = :ASC-KEY-SEQ-NBR               27930016
279400             AND VER_STAT_CDE    = :PC-ACTIVE                     27940016
279500             AND PKSL_STAT_CDE  ^= :PC-IN                         27950016
279600     END-EXEC.                                                    27960016
279700                                                                  27970016
279800     EVALUATE TRUE                                                27980016
279900         WHEN SQLCODE = ZERO                                      27990016
280000         WHEN SQLCODE = +100                                      28000016
280100              CONTINUE                                            28010016
280200                                                                  28020016
280300         WHEN SQLWARN0 NOT = SPACES                               28030016
280400         WHEN SQLCODE  NOT = ZERO                                 28040016
280500              MOVE '7009-CHECK-INACTIVE-TPKSLIP'                  28050016
280600                                 TO DP013-PARAGRAPH               28060016
280700              MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP'                28070016
280800                                 TO DP013-MESSAGE-TEXT (1)        28080016
280900              MOVE SQLCA         TO DP013-SQLCA                   28090016
281000              MOVE 'TPKSLIP'     TO DP013-DB2-TABLE-NAME (1)      28100016
281100              SET DP013-DB2-ABEND                                 28110016
281200                  DP013-XCTL-DISPLAY-RESTART                      28120016
281300                                 TO TRUE                          28130016
281400              PERFORM DP013-0000-PROCESS-ABEND                    28140016
281500     END-EVALUATE.                                                28150016
281600/                                                                 28160016
281700*----------------------------------------------------------------*28170016
281800*    DELETE PACK SLIP LINE ITEMS                                 *28180016
281900*----------------------------------------------------------------*28190016
282000                                                                  28200016
282100 7010-DELETE-TPKITEM.                                             28210016
282200                                                                  28220016
282300     PERFORM                                                      28230016
282400         WITH TEST AFTER                                          28240016
282500         VARYING PV-RETRY-COUNTER                                 28250016
282600         FROM 1 BY 1                                              28260016
282700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28270016
282800             OR (SQLCODE = +0)                                    28280016
282900             OR (SQLCODE = +100))                                 28290016
283000                                                                  28300016
283100         EXEC SQL                                                 28310016
283200              DELETE                                              28320016
283300                FROM TPKITEM                                      28330016
283400               WHERE PO_NBR       = :DK-PO-NBR                    28340016
283500                 AND SEQ_NBR      = :ASC-KEY-SEQ-NBR              28350016
283600                 AND PKSL_LNE_NBR = :DK-PKSL-LNE-NBR              28360016
283700                 AND VER_STAT_CDE = :PC-ACTIVE                    28370016
283800         END-EXEC                                                 28380016
283900                                                                  28390016
284000         EVALUATE TRUE                                            28400016
284100             WHEN SQLCODE = +0                                    28410016
284200             WHEN SQLCODE = +100                                  28420016
284300             WHEN SQLCODE = -904                                  28430016
284400             WHEN SQLCODE = -913                                  28440016
284500                  CONTINUE                                        28450016
284600                                                                  28460016
284700             WHEN SQLWARN0 NOT = SPACES                           28470016
284800             WHEN SQLCODE < +0                                    28480016
284900             WHEN SQLCODE > +0                                    28490016
285000                  MOVE '7010-DELETE-TPKITEM'                      28500016
285100                                   TO DP013-PARAGRAPH             28510016
285200                  MOVE 'UNSUCCESSFUL DELETE ON TPKITEM'           28520016
285300                                   TO DP013-MESSAGE-TEXT (1)      28530016
285400                  MOVE SQLCA       TO DP013-SQLCA                 28540016
285500                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    28550016
285600                  SET DP013-DB2-ABEND                             28560016
285700                      DP013-XCTL-DISPLAY-RESTART                  28570016
285800                                   TO TRUE                        28580016
285900                  PERFORM DP013-0000-PROCESS-ABEND                28590016
286000         END-EVALUATE                                             28600016
286100     END-PERFORM.                                                 28610016
286200                                                                  28620016
286300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28630016
286400         MOVE '7010-DELETE-TPKITEM'                               28640016
286500                                   TO DP013-PARAGRAPH             28650016
286600         MOVE 'MAX RETRIES EXCEEDED ON DELETE ON TPKITEM'         28660016
286700                                   TO DP013-MESSAGE-TEXT (1)      28670016
286800         MOVE SQLCA                TO DP013-SQLCA                 28680016
286900         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    28690016
287000         SET DP013-DB2-ABEND                                      28700016
287100             DP013-XCTL-DISPLAY-RESTART                           28710016
287200                                   TO TRUE                        28720016
287300         PERFORM DP013-0000-PROCESS-ABEND                         28730016
287400     END-IF.                                                      28740016
287500                                                                  28750016
287600/                                                                 28760016
287700*----------------------------------------------------------------*28770016
287800*    DELETE PACK SLIP UNMATCHED ITEMS                            *28780016
287900*----------------------------------------------------------------*28790016
288000                                                                  28800016
288100 7020-DELETE-TUNPKSL.                                             28810016
288200                                                                  28820016
288300     PERFORM                                                      28830016
288400         WITH TEST AFTER                                          28840016
288500         VARYING PV-RETRY-COUNTER                                 28850016
288600         FROM 1 BY 1                                              28860016
288700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28870016
288800             OR (SQLCODE = +0)                                    28880016
288900             OR (SQLCODE = +100))                                 28890016
289000                                                                  28900016
289100         EXEC SQL                                                 28910016
289200              DELETE                                              28920016
289300                FROM TUNPKSL                                      28930016
289400               WHERE PO_NBR       = :DK-PO-NBR                    28940016
289500                 AND SEQ_NBR      = :ASC-KEY-SEQ-NBR              28950016
289600                 AND PKSL_LNE_NBR = :DK-PKSL-LNE-NBR              28960016
289700                 AND VER_STAT_CDE = :PC-ACTIVE                    28970016
289800         END-EXEC                                                 28980016
289900                                                                  28990016
290000         EVALUATE TRUE                                            29000016
290100             WHEN SQLCODE = +0                                    29010016
290200             WHEN SQLCODE = +100                                  29020016
290300             WHEN SQLCODE = -904                                  29030016
290400             WHEN SQLCODE = -913                                  29040016
290500                  CONTINUE                                        29050016
290600                                                                  29060016
290700             WHEN SQLWARN0 NOT = SPACES                           29070016
290800             WHEN SQLCODE < +0                                    29080016
290900             WHEN SQLCODE > +0                                    29090016
291000                  MOVE '7020-DELETE-TUNPKSL'                      29100016
291100                                   TO DP013-PARAGRAPH             29110016
291200                  MOVE 'UNSUCCESSFUL DELETE ON TUNPKSL'           29120016
291300                                   TO DP013-MESSAGE-TEXT (1)      29130016
291400                  MOVE SQLCA       TO DP013-SQLCA                 29140016
291500                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    29150016
291600                  SET DP013-DB2-ABEND                             29160016
291700                      DP013-XCTL-DISPLAY-RESTART                  29170016
291800                                   TO TRUE                        29180016
291900                  PERFORM DP013-0000-PROCESS-ABEND                29190016
292000         END-EVALUATE                                             29200016
292100     END-PERFORM.                                                 29210016
292200                                                                  29220016
292300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29230016
292400         MOVE '7020-DELETE-TUNPKSL'                               29240016
292500                                   TO DP013-PARAGRAPH             29250016
292600         MOVE 'MAX RETRIES EXCEEDED ON DELETE ON TUNPKSL'         29260016
292700                                   TO DP013-MESSAGE-TEXT (1)      29270016
292800         MOVE SQLCA                TO DP013-SQLCA                 29280016
292900         MOVE 'TUNPKSL '           TO DP013-DB2-TABLE-NAME (1)    29290016
293000         SET DP013-XCTL-DISPLAY-RESTART                           29300016
293100             DP013-DB2-ABEND       TO TRUE                        29310016
293200         PERFORM DP013-0000-PROCESS-ABEND                         29320016
293300     END-IF.                                                      29330016
293400                                                                  29340016
293500/                                                                 29350016
293600 7050-CALL-PO-RCVR-TRKING-MOD.                                    29360068
293700                                                                  29370068
293800     INITIALIZE RC071-FIELDS.                                     29380068
293900     MOVE DK-PO-NBR                 TO RC071-PO-NBR               29390068
294000     MOVE ASC-KEY-REC-SEQ-NBR-N     TO RC071-PO-RCVR              29400068
294100     MOVE ASC-KEY-SEQ-NBR           TO RC071-PKSL-SEQ-NBR         29410068
294200     MOVE DK-PKSL-LNE-NBR           TO RC071-PO-LINE              29420068
294300     MOVE ZERO                      TO RC071-PREPK-ID             29430068
294400                                                                  29440068
294500     MOVE PKSLIP-OPER-UNT-ID        TO RC071-SIGNON-LOCATION      29450068
294600     MOVE DP020-USERID              TO RC071-USER-ID              29460068
294700     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      29470068
294800     SET  RC071-PACK-ITEM-DELETE    TO TRUE                       29480068
294900                                                                  29490068
295000     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        29500068
295100                                                                  29510068
295200     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  29520068
295300                                        RC071-COMMAREA            29530068
295400                                        RC071-FIELDS.             29540068
295500     EVALUATE TRUE                                                29550068
295600        WHEN RC071-SUCCESSFUL                                     29560068
295700            CONTINUE                                              29570068
295800        WHEN RC071-DATABASE-BUSY                                  29580068
295900          MOVE PKSLIP-OPER-UNT-ID    TO  PV-DISPLAY-OPER          29590068
296000          MOVE DK-PO-NBR             TO  PV-DISPLAY-PO-NBR        29600068
296100          MOVE ASC-KEY-REC-SEQ-NBR-N TO  PV-DISPLAY-RCVR-SEQ-NBR  29610068
296200          INITIALIZE PV-CICS-MSG-AREA                             29620068
296300          STRING ' RCKCS217-7050- '                               29630068
296400                  PV-DISPLAY-OPER   '-'                           29640068
296500                  PV-DISPLAY-PO-NBR '-'                           29650068
296600                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   29660068
296700                 ' - CONTENTION'            DELIMITED BY SIZE     29670068
296800                                       INTO PV-CICS-MSG-AREA2     29680068
296900           MOVE LENGTH OF PV-CICS-MSG-AREA2                       29690068
297000                                         TO PV-COMMAREA-LENGTH    29700068
297100           EXEC CICS                                              29710068
297200                WRITEQ TD                                         29720068
297300                 QUEUE  ('CSSL')                                  29730068
297400                  FROM  (PV-CICS-MSG-AREA2)                       29740068
297500                LENGTH  (PV-COMMAREA-LENGTH)                      29750068
297600                  RESP  (PV-CICS-RESPONSE)                        29760070
297700           END-EXEC                                               29770068
297800                                                                  29780068
297900        WHEN OTHER                                                29790068
298000          MOVE PKSLIP-OPER-UNT-ID    TO  PV-DISPLAY-OPER          29800068
298100          MOVE DK-PO-NBR             TO  PV-DISPLAY-PO-NBR        29810068
298200          MOVE ASC-KEY-REC-SEQ-NBR-N TO  PV-DISPLAY-RCVR-SEQ-NBR  29820068
298300          INITIALIZE PV-CICS-MSG-AREA                             29830068
298400          STRING ' RCKCS217-7050- '                               29840068
298500                  PV-DISPLAY-OPER   '-'                           29850068
298600                  PV-DISPLAY-PO-NBR '-'                           29860068
298700                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   29870068
298800                 ' - SUCCESS IND - '                              29880068
298900                  RC071-SUCCESS-IND     DELIMITED BY SIZE         29890068
299000                                       INTO PV-CICS-MSG-AREA2     29900068
299100           MOVE LENGTH OF PV-CICS-MSG-AREA2                       29910068
299200                                         TO PV-COMMAREA-LENGTH    29920068
299300           EXEC CICS                                              29930068
299400                WRITEQ TD                                         29940068
299500                 QUEUE  ('CSSL')                                  29950068
299600                  FROM  (PV-CICS-MSG-AREA2)                       29960068
299700                LENGTH  (PV-COMMAREA-LENGTH)                      29970068
299800                  RESP  (PV-CICS-RESPONSE)                        29980070
299900           END-EXEC.                                              29990068
300000                                                                  30000068
300100                                                                  30010068
300200*----------------------------------------------------------------*30020016
300300*    SELECT THE PACK SLIP ITEM.                                  *30030016
300400*----------------------------------------------------------------*30040016
300500 8000-SELECT-TPKITEM.                                             30050016
300600                                                                  30060016
300700     PERFORM                                                      30070016
300800         WITH TEST AFTER                                          30080016
300900         VARYING PV-RETRY-COUNTER                                 30090016
301000         FROM 1 BY 1                                              30100016
301100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30110016
301200             OR (SQLCODE = +0)                                    30120016
301300             OR (SQLCODE = +100))                                 30130016
301400                                                                  30140016
301500         EXEC SQL                                                 30150016
301600              SELECT  PO_NBR,                                     30160016
301700                      SEQ_NBR,                                    30170016
301800                      PKSL_LNE_NBR,                               30180016
301900                      CRE_TMST,                                   30190016
302000                      VER_STAT_CDE,                               30200016
302100                      PKSL_ITM_QTY,                               30210016
302200                      CRE_UID,                                    30220016
302300                      PURITM_VER_NBR                              30230016
302400                INTO :PKITEM-PO-NBR,                              30240016
302500                     :PKITEM-SEQ-NBR,                             30250016
302600                     :PKITEM-PKSL-LNE-NBR,                        30260016
302700                     :PKITEM-CRE-TMST,                            30270016
302800                     :PKITEM-VER-STAT-CDE,                        30280016
302900                     :PKITEM-PKSL-ITM-QTY,                        30290016
303000                     :PKITEM-CRE-UID,                             30300016
303100                     :PKITEM-PURITM-VER-NBR                       30310016
303200                FROM TPKITEM                                      30320016
303300               WHERE PO_NBR       = :DK-PO-NBR                    30330016
303400                 AND SEQ_NBR      = :ASC-KEY-SEQ-NBR              30340016
303500                 AND PKSL_LNE_NBR = :DK-PKSL-LNE-NBR              30350016
303600                 AND VER_STAT_CDE = :PC-ACTIVE                    30360016
303700         END-EXEC                                                 30370016
303800                                                                  30380016
303900         EVALUATE TRUE                                            30390016
304000             WHEN SQLCODE = +0                                    30400016
304100                  SET PS-PKITEM-FOUND                             30410016
304200                                   TO TRUE                        30420016
304300                                                                  30430016
304400             WHEN SQLCODE = +100                                  30440016
304500                  SET PS-PKITEM-NOT-FOUND                         30450016
304600                                   TO TRUE                        30460016
304700                                                                  30470016
304800             WHEN SQLCODE = -904                                  30480016
304900             WHEN SQLCODE = -913                                  30490016
305000                  CONTINUE                                        30500016
305100                                                                  30510016
305200             WHEN SQLWARN0 NOT = SPACES                           30520016
305300             WHEN SQLCODE < +0                                    30530016
305400             WHEN SQLCODE > +0                                    30540016
305500                  MOVE '8000-SELECT-PKITEM'                       30550016
305600                                   TO DP013-PARAGRAPH             30560016
305700                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP ITEM'       30570016
305800                                   TO DP013-MESSAGE-TEXT (1)      30580016
305900                  MOVE SQLCA       TO DP013-SQLCA                 30590016
306000                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    30600016
306100                  SET DP013-DB2-ABEND                             30610016
306200                      DP013-XCTL-DISPLAY-RESTART                  30620016
306300                                   TO TRUE                        30630016
306400                  PERFORM DP013-0000-PROCESS-ABEND                30640016
306500         END-EVALUATE                                             30650016
306600     END-PERFORM.                                                 30660016
306700                                                                  30670016
306800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30680016
306900         MOVE '8000-SELECT-TPKITEM'                               30690016
307000                                   TO DP013-PARAGRAPH             30700016
307100         MOVE 'MAX RETRIES EXCEEDED ON SELECT PACK SLIP ITEM'     30710016
307200                                   TO DP013-MESSAGE-TEXT (1)      30720016
307300         MOVE SQLCA                TO DP013-SQLCA                 30730016
307400         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    30740016
307500         SET DP013-DB2-ABEND                                      30750016
307600             DP013-XCTL-DISPLAY-RESTART                           30760016
307700                                   TO TRUE                        30770016
307800         PERFORM DP013-0000-PROCESS-ABEND                         30780016
307900     END-IF.                                                      30790016
308000                                                                  30800016
308100/                                                                 30810016
308200*---------------------------------------------------------------* 30820016
308300*    SELECT THE UNMATCHED PACK SLIP LINE ITEM                   * 30830016
308400*---------------------------------------------------------------* 30840016
308500 8100-SELECT-TUNPKSL.                                             30850016
308600                                                                  30860016
308700     PERFORM                                                      30870016
308800         WITH TEST AFTER                                          30880016
308900         VARYING PV-RETRY-COUNTER                                 30890016
309000         FROM 1 BY 1                                              30900016
309100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30910016
309200             OR (SQLCODE = +0))                                   30920016
309300                                                                  30930016
309400         EXEC SQL                                                 30940016
309500             SELECT  PO_NBR,                                      30950016
309600                     SEQ_NBR,                                     30960016
309700                     PKSL_LNE_NBR,                                30970016
309800                     PKSL_ITM_QTY,                                30980016
309900                     UNT_COST_AMT,                                30990016
310000                     COLOR_DESC,                                  31000016
310100                     SIZE_DESC,                                   31010016
310200                     VEND_STYL_NAME,                              31020016
310300                     VEND_DESC                                    31030016
310400               INTO :UNPKSL-PO-NBR,                               31040016
310500                    :UNPKSL-SEQ-NBR,                              31050016
310600                    :UNPKSL-PKSL-LNE-NBR,                         31060016
310700                    :UNPKSL-PKSL-ITM-QTY,                         31070016
310800                    :UNPKSL-UNT-COST-AMT,                         31080016
310900                    :UNPKSL-COLOR-DESC,                           31090016
311000                    :UNPKSL-SIZE-DESC,                            31100016
311100                    :UNPKSL-VEND-STYL-NAME,                       31110016
311200                    :UNPKSL-VEND-DESC                             31120016
311300               FROM  TUNPKSL                                      31130016
311400              WHERE  PO_NBR       = :DK-PO-NBR                    31140016
311500                AND  SEQ_NBR      = :ASC-KEY-SEQ-NBR              31150016
311600                AND  PKSL_LNE_NBR = :DK-PKSL-LNE-NBR              31160016
311700                AND  VER_STAT_CDE = :PC-ACTIVE                    31170016
311800         END-EXEC                                                 31180016
311900                                                                  31190016
312000         EVALUATE TRUE                                            31200016
312100             WHEN SQLCODE = +0                                    31210016
312200             WHEN SQLCODE = -904                                  31220016
312300             WHEN SQLCODE = -913                                  31230016
312400                  CONTINUE                                        31240016
312500                                                                  31250016
312600             WHEN SQLCODE = +100                                  31260016
312700                  CONTINUE                                        31270016
312800*&                SET PS-TUNPKSL-NOT-FOUND                        31280016
312900*&                                 TO TRUE                        31290016
313000                                                                  31300016
313100             WHEN SQLWARN0 NOT = SPACE                            31310016
313200             WHEN SQLCODE < +0                                    31320016
313300             WHEN SQLCODE > +0                                    31330016
313400                  MOVE '8100-SELECT-TUNPKSL'                      31340016
313500                                   TO DP013-PARAGRAPH             31350016
313600                  MOVE 'SELECT TUNPKSL'                           31360016
313700                                   TO DP013-MESSAGE-TEXT (1)      31370016
313800                  MOVE SQLCA       TO DP013-SQLCA                 31380016
313900                  MOVE 'TUNPKSL'   TO DP013-DB2-TABLE-NAME (1)    31390016
314000                  SET DP013-DB2-ABEND                             31400016
314100                                   TO TRUE                        31410016
314200                  PERFORM DP013-0000-PROCESS-ABEND                31420016
314300         END-EVALUATE                                             31430016
314400     END-PERFORM.                                                 31440016
314500                                                                  31450016
314600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31460016
314700         MOVE '8100-SELECT-TUNPKSL'                               31470016
314800                                   TO DP013-PARAGRAPH             31480016
314900         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TUNPKSL'        31490016
315000                                   TO DP013-MESSAGE-TEXT (1)      31500016
315100         MOVE SQLCA                TO DP013-SQLCA                 31510016
315200         SET DP013-XCTL-DISPLAY-RESTART                           31520016
315300             DP013-DB2-ABEND       TO TRUE                        31530016
315400         PERFORM DP013-0000-PROCESS-ABEND                         31540016
315500     END-IF.                                                      31550016
315600                                                                  31560016
315700/                                                                 31570016
315800*---------------------------------------------------------------* 31580056
315900*    SELECT TPKSLIP FOR PO, PKSL SEQ NBR                        * 31590056
316000*---------------------------------------------------------------* 31600056
316100 8200-SELECT-TPKSLIP.                                             31610056
316200                                                                  31620056
316300         EXEC SQL                                                 31630056
316400              SELECT PO_NBR,                                      31640056
316500                     SEQ_NBR,                                     31650056
316600                     CRE_TMST,                                    31660056
316700                     VER_STAT_CDE,                                31670056
316800                     OPER_UNT_ID,                                 31680056
316900                     FCLTY_ID,                                    31690056
317000                     PKSL_NBR,                                    31700056
317100                     STR_DEST_NBR,                                31710056
317200                     REC_SEQ_NBR,                                 31720056
317300                     SHIPT_ID,                                    31730056
317400                     BOL_NBR,                                     31740056
317500                     PRO_NBR,                                     31750056
317600                     PKSL_STAT_CDE,                               31760056
317700                     CRE_UID,                                     31770056
317800                     PO_VER_NBR,                                  31780056
317900                     CRE_SRC_CDE,                                 31790056
318000                     EXPTED_PKG_QTY,                              31800056
318100                     OWNER_SCAC_ID,                               31810056
318200                     ASN_NBR,                                     31820056
318300                     VEND_SHIP_DTE,                               31830056
318400                     PKSL_PG_CNT,                                 31840056
318500                     CONTNR_ID,                                   31850056
318600                     ORIG_PKSL_SEQ_NBR                            31860056
318700                INTO :PKSLIP-PO-NBR,                              31870056
318800                     :PKSLIP-SEQ-NBR,                             31880056
318900                     :PKSLIP-CRE-TMST,                            31890056
319000                     :PKSLIP-VER-STAT-CDE,                        31900056
319100                     :PKSLIP-OPER-UNT-ID,                         31910056
319200                     :PKSLIP-FCLTY-ID,                            31920056
319300                     :PKSLIP-PKSL-NBR,                            31930056
319400                     :PKSLIP-STR-DEST-NBR,                        31940056
319500                     :PKSLIP-REC-SEQ-NBR,                         31950056
319600                     :PKSLIP-SHIPT-ID,                            31960056
319700                     :PKSLIP-BOL-NBR,                             31970056
319800                     :PKSLIP-PRO-NBR,                             31980056
319900                     :PKSLIP-PKSL-STAT-CDE,                       31990056
320000                     :PKSLIP-CRE-UID,                             32000056
320100                     :PKSLIP-PO-VER-NBR,                          32010056
320200                     :PKSLIP-CRE-SRC-CDE,                         32020056
320300                     :PKSLIP-EXPTED-PKG-QTY,                      32030056
320400                     :PKSLIP-OWNER-SCAC-ID,                       32040056
320500                     :PKSLIP-ASN-NBR,                             32050056
320600                     :PKSLIP-VEND-SHIP-DTE,                       32060056
320700                     :PKSLIP-PKSL-PG-CNT,                         32070056
320800                     :PKSLIP-CONTNR-ID,                           32080056
320900                     :PKSLIP-ORIG-PKSL-SEQ-NBR                    32090056
321000                FROM TPKSLIP                                      32100056
321100               WHERE PO_NBR       = :DK-PO-NBR                    32110056
321200                 AND SEQ_NBR      = :ASC-KEY-SEQ-NBR              32120056
321300                 AND VER_STAT_CDE = :PC-ACTIVE                    32130056
321400         END-EXEC                                                 32140056
321500                                                                  32150056
321600         EVALUATE TRUE                                            32160056
321700             WHEN SQLCODE = ZERO                                  32170056
321800             WHEN SQLCODE = +100                                  32180056
321900                  CONTINUE                                        32190056
322000             WHEN SQLWARN0 NOT = SPACES                           32200056
322100             WHEN SQLCODE < +0                                    32210056
322200             WHEN SQLCODE > +0                                    32220056
322300                  MOVE '8200-SELECT-TPKSLIP'                      32230056
322400                                   TO DP013-PARAGRAPH             32240056
322500                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP'            32250056
322600                                   TO DP013-MESSAGE-TEXT (1)      32260056
322700                  MOVE SQLCA       TO DP013-SQLCA                 32270056
322800                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    32280056
322900                  SET DP013-DB2-ABEND                             32290056
323000                      DP013-XCTL-DISPLAY-RESTART                  32300056
323100                                   TO TRUE                        32310056
323200                  PERFORM DP013-0000-PROCESS-ABEND                32320056
323300         END-EVALUATE.                                            32330056
323400                                                                  32340056
323500*----------------------------------------------------------------*32350016
323600*    RETRIEVE THE VERSION NUMBER, CLASS AND SEQUENCE NUMBER      *32360016
323700*    AND ITEM NUMBER OF THE PURCHASE ORDER LINE                  *32370016
323800*----------------------------------------------------------------*32380016
323900 9050-GET-PURITM.                                                 32390016
324000                                                                  32400016
324100     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  32410016
324200     MOVE ASC-PKSL-LNE-NBR-N       TO DK-PKSL-LNE-NBR-SMALLINT.   32420016
324300                                                                  32430016
324400     PERFORM                                                      32440016
324500         WITH TEST AFTER                                          32450016
324600         VARYING PV-RETRY-COUNTER                                 32460016
324700         FROM 1 BY 1                                              32470016
324800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32480016
324900             OR (SQLCODE = +0)                                    32490016
325000             OR (SQLCODE = +100))                                 32500016
325100                                                                  32510016
325200         EXEC SQL                                                 32520016
325300              SELECT VER_NBR,                                     32530016
325400                     SKU_SEQ_NBR,                                 32540016
325500                     ITM_NBR                                      32550016
325600                INTO :PURITM-VER-NBR,                             32560016
325700                     :PURITM-SKU-SEQ-NBR,                         32570016
325800                     :PURITM-ITM-NBR                              32580016
325900                FROM TPURITM                                      32590016
326000               WHERE PO_NBR         = :DK-PO-NBR                  32600016
326100                 AND APP_PO_LNE_NBR = :DK-PKSL-LNE-NBR-SMALLINT   32610016
326200                 AND VER_STATUS_CDE = :PC-ACTIVE                  32620016
326300         END-EXEC                                                 32630016
326400                                                                  32640016
326500         EVALUATE TRUE                                            32650016
326600             WHEN SQLCODE = +0                                    32660016
326700                  SET PS-PURITM-FOUND                             32670016
326800                                   TO TRUE                        32680016
326900                                                                  32690016
327000             WHEN SQLCODE = +100                                  32700016
327100                  SET PS-PURITM-NOT-FOUND                         32710016
327200                                   TO TRUE                        32720016
327300             WHEN SQLCODE = -904                                  32730016
327400             WHEN SQLCODE = -913                                  32740016
327500                  CONTINUE                                        32750016
327600                                                                  32760016
327700             WHEN SQLWARN0 NOT = SPACES                           32770016
327800             WHEN SQLCODE < +0                                    32780016
327900             WHEN SQLCODE > +0                                    32790016
328000                  MOVE '9050-GET-PURITM'                          32800016
328100                                   TO DP013-PARAGRAPH             32810016
328200                  MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'           32820016
328300                                   TO DP013-MESSAGE-TEXT (1)      32830016
328400                  MOVE SQLCA       TO DP013-SQLCA                 32840016
328500                  MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)    32850016
328600                  SET DP013-DB2-ABEND                             32860016
328700                      DP013-XCTL-DISPLAY-RESTART                  32870016
328800                                   TO TRUE                        32880016
328900                  PERFORM DP013-0000-PROCESS-ABEND                32890016
329000         END-EVALUATE                                             32900016
329100     END-PERFORM.                                                 32910016
329200                                                                  32920016
329300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32930016
329400         MOVE '9050-GET-PURITM'    TO DP013-PARAGRAPH             32940016
329500         MOVE 'MAX RETRIES EXCEEDED ON SELECT FOR PO ITEM VER NBR'32950016
329600                                   TO DP013-MESSAGE-TEXT (1)      32960016
329700         MOVE SQLCA                TO DP013-SQLCA                 32970016
329800         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    32980016
329900         SET DP013-DB2-ABEND                                      32990016
330000             DP013-XCTL-DISPLAY-RESTART                           33000016
330100                                   TO TRUE                        33010016
330200         PERFORM DP013-0000-PROCESS-ABEND                         33020016
330300     END-IF.                                                      33030016
330400                                                                  33040016
330500/                                                                 33050016
330600*----------------------------------------------------------------*33060016
330700*  CALL THE NEW LOGISTICS MODULE TO RETRIEVE THE 8 DIGIT SKU#    *33070016
330800*  USING THE ITEM NUMBER                                          33080016
330900*----------------------------------------------------------------*33090016
331000 9070-CALL-CICS-API-ARCH.                                         33100016
331100                                                                  33110016
331200     MOVE PURITM-ITM-NBR  TO XL001-KEY-ITM-NBR.                   33120016
331300     SET XL001-SELECT-SKU                                         33130016
331400         XL001-SELECT-VND-STYL                                    33140067
331500         XL001-BY-ITEM TO TRUE.                                   33150016
331600     CALL XL001-VSM-PGM   USING  DFHEIBLK                         33160016
331700                                   XL001-COMMAREA                 33170016
331800                                   XL001-ITEM-COMMAREA.           33180016
331900     EVALUATE TRUE                                                33190016
332000         WHEN XL001-SUCCESSFUL                                    33200016
332100             MOVE XL001-SKU-NBR TO PV-NIS-SKU-NBR                 33210016
332200             MOVE PV-NIS-SKU-NBR TO ASC-SKU-SEQ-NBR               33220016
332300             MOVE XL001-SUB-CL-NBR-2CH                            33230067
332400                                 TO ASC-CLASS-NBR                 33240016
332500         WHEN XL001-SKU-SQLCODE = +100                            33250016
332600             CONTINUE                                             33260016
332700         WHEN XL001-SKU-SQLCODE = -904                            33270016
332800         WHEN XL001-SKU-SQLCODE = -911                            33280016
332900         WHEN XL001-SKU-SQLCODE = -913                            33290016
333000             MOVE '9070-CALL-CICS-API-ARCH'                       33300016
333100                              TO DP013-PARAGRAPH                  33310016
333200             MOVE 'SELECT FROM XLKUT001 TIMED OUT'                33320016
333300                              TO DP013-MESSAGE-TEXT (1)           33330016
333400             MOVE SQLCA            TO DP013-SQLCA                 33340016
333500             MOVE 'XLKUT001'       TO DP013-DB2-TABLE-NAME (1)    33350016
333600             SET DP013-DB2-ABEND                                  33360016
333700                 DP013-XCTL-DISPLAY-RESTART                       33370016
333800                              TO TRUE                             33380016
333900             PERFORM DP013-0000-PROCESS-ABEND                     33390016
334000         WHEN XL001-INVALID-ACCESS                                33400016
334100             MOVE '9070-CALL-CICS-API-ARCH'                       33410016
334200                              TO DP013-PARAGRAPH                  33420016
334300             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            33430016
334400                              TO DP013-MESSAGE-TEXT (1)           33440016
334500             MOVE SQLCA            TO DP013-SQLCA                 33450016
334600             MOVE 'XLKUT001'       TO DP013-DB2-TABLE-NAME (1)    33460016
334700             SET DP013-DB2-ABEND                                  33470016
334800                 DP013-XCTL-DISPLAY-RESTART                       33480016
334900                              TO TRUE                             33490016
335000             PERFORM DP013-0000-PROCESS-ABEND                     33500016
335100         WHEN OTHER                                               33510016
335200             MOVE '9070-CALL-CICS-API-ARCH'                       33520016
335300                              TO DP013-PARAGRAPH                  33530016
335400             MOVE 'UNSUCCESSFUL SELECT FROM XLKUT001'             33540016
335500                              TO DP013-MESSAGE-TEXT (1)           33550016
335600             MOVE XL001-SKU-SQLCODE                               33560016
335700                              TO SQLCODE                          33570016
335800             MOVE SQLCA            TO DP013-SQLCA                 33580016
335900             MOVE 'XLKUT001'       TO DP013-DB2-TABLE-NAME (1)    33590016
336000             SET DP013-DB2-ABEND                                  33600016
336100                 DP013-XCTL-DISPLAY-RESTART                       33610016
336200                              TO TRUE                             33620016
336300             PERFORM DP013-0000-PROCESS-ABEND                     33630016
336400     END-EVALUATE.                                                33640016
336500/                                                                 33650016
336600*----------------------------------------------------------------*33660016
336700*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *33670016
336800*----------------------------------------------------------------*33680016
336900                                                                  33690016
337000 9100-READ-SEL-QUEUE.                                             33700016
337100                                                                  33710016
337200     EXEC CICS                                                    33720016
337300         READQ TS                                                 33730016
337400             QUEUE (ASC-SEL-QUEUE-NAME)                           33740016
337500             INTO  (RC013-DC-SELECT-RECORD)                       33750016
337600             ITEM  (ASC-SEL-ITEM)                                 33760016
337700             RESP  (PV-CICS-RESPONSE)                             33770016
337800     END-EXEC.                                                    33780016
337900                                                                  33790016
338000     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       33800016
338100         CONTINUE                                                 33810016
338200     ELSE                                                         33820016
338300         SET DP013-LOGIC-ABEND                                    33830016
338400             DP013-NO-ROLLBACK     TO TRUE                        33840016
338500         MOVE '9100-READ-SEL-QUEUE'                               33850016
338600                                   TO DP013-PARAGRAPH             33860016
338700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   33870016
338800                                   TO DP013-MESSAGE-TEXT (1)      33880016
338900         PERFORM DP013-0000-PROCESS-ABEND                         33890016
339000     END-IF.                                                      33900016
339100                                                                  33910016
339200/                                                                 33920016
339300*----------------------------------------------------------------*33930016
339400*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *33940016
339500*----------------------------------------------------------------*33950016
339600 9200-REWRITE-SEL-QUEUE.                                          33960016
339700                                                                  33970016
339800     EXEC CICS                                                    33980016
339900          WRITEQ TS                                               33990016
340000              QUEUE  (ASC-SEL-QUEUE-NAME)                         34000016
340100              FROM   (RC013-DC-SELECT-RECORD)                     34010016
340200              ITEM   (ASC-SEL-ITEM)                               34020016
340300              RESP   (PV-CICS-RESPONSE)                           34030016
340400              REWRITE                                             34040016
340500     END-EXEC.                                                    34050016
340600                                                                  34060016
340700     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   34070016
340800         SET DP013-CICS-ABEND                                     34080016
340900             DP013-NO-ROLLBACK     TO TRUE                        34090016
341000         MOVE '9200-REWRITE-SEL-QUEUE'                            34100016
341100                                   TO DP013-PARAGRAPH             34110016
341200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   34120016
341300                                   TO DP013-MESSAGE-TEXT (1)      34130016
341400         PERFORM DP013-0000-PROCESS-ABEND                         34140016
341500     END-IF.                                                      34150016
341600                                                                  34160016
341700/                                                                 34170016
341800*----------------------------------------------------------------*34180016
341900*    ABEND PROCESSOR MODULE                                      *34190016
342000*----------------------------------------------------------------*34200016
342100                                                                  34210016
342200     COPY DPPD013.                                                34220049
