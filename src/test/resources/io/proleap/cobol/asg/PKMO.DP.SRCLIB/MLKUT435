       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    MLKUT435.                                         00020000
       AUTHOR.        SCOTT JACKSON.                                    00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  05-26-99.                                         00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00070000
      *                                                                 00080000
      * MLKUT435 - DESCRIPTION.............                             00090000
      *                                                                 00100000
      * THIS PROGRAM WILL COMPARE TWO DATA INTEGRITY EXTRACT FILES AND  00110000
      * CREATE A REPORT FILE OF THE DIFFERENCES.                        00120000
      *                                                                 00130000
      * ONE EXTRACT FILE WILL CONTAIN INFORMATION FROM TWKSHNK.         00140000
      * THE OTHER EXTRACT FILE WIL CONTAIN INFORMATION FROM TWKSCLS.    00150000
      * THE FILES WILL BE COMPARED ON SALES DOLLAR TOTALS BETWEEN THE   00160000
      * TWO TABLE AT THE FSCL MNTH END DATE, DEPT, SUBCLASS, STORE LEVEL00170000
      *                                                                 00180000
W26603******************************************************************00190016
W26603* CHG ID   DATE        DESCRIPTION                               *00200016
W26603* ------   ----------  ----------------------------------------- *00210016
W26603* 26603    03-17-2004  STORE EXPANSION.                          *00220016
W26603*                      INCREASED LRECL FOR INP02, INP03, OUT01   *00230016
W26603*                      BECAUSE OF CHANGES TO MLRD111, MLRD112,   *00240016
W26603*                      AND MLRD125.                              *00250016
W26603*                      EXPANDED WORKING STORAGE VARIABLES.       *00260016
W26603*                      - RONNA MCDONALD                          *00270016
      ******************************************************************00280000
      *                                                                 00290000
      *                                                                 00300000
       ENVIRONMENT DIVISION.                                            00310000
      *                                                                 00320000
       CONFIGURATION SECTION.                                           00330000
      *                                                                 00340000
       SOURCE-COMPUTER.        IBM-3090.                                00350000
       OBJECT-COMPUTER.        IBM-3090.                                00360000
      *                                                                 00370000
       INPUT-OUTPUT SECTION.                                            00380000
       FILE-CONTROL.                                                    00390000
                                                                        00400000
           SELECT COMPARE-TABLES-CTL-FILE                               00410000
               ASSIGN TO INP01.                                         00420000
                                                                        00430000
           SELECT TWKSHNK-INTEGRITY-EXTR-FILE                           00440000
               ASSIGN TO INP02.                                         00450000
                                                                        00460000
           SELECT TWKSCLS-INTEGRITY-EXTR-FILE                           00470000
               ASSIGN TO INP03.                                         00480000
                                                                        00490000
           SELECT DATA-INTEGRITY-DIFF-FILE                              00500000
               ASSIGN TO OUT01.                                         00510000
                                                                        00520000
      ******************************************************************00530000
       DATA DIVISION.                                                   00540000
      ******************************************************************00550000
                                                                        00560000
       FILE SECTION.                                                    00570000
                                                                        00580000
       FD  COMPARE-TABLES-CTL-FILE                                      00590000
           LABEL RECORDS ARE STANDARD                                   00600000
           RECORDING MODE IS F                                          00610000
           BLOCK CONTAINS 0 RECORDS.                                    00620000
       01  COMPARE-TABLES-CTL-REC      PIC X(80).                       00630000
                                                                        00640000
       FD  TWKSHNK-INTEGRITY-EXTR-FILE                                  00650000
           LABEL RECORDS ARE STANDARD                                   00660000
           RECORDING MODE IS F                                          00670000
           BLOCK CONTAINS 0 RECORDS.                                    00680000
W26603 01  TWKSHNK-INTEGRITY-EXTR-REC  PIC X(80).                       00690016
                                                                        00700000
       FD  TWKSCLS-INTEGRITY-EXTR-FILE                                  00710000
           LABEL RECORDS ARE STANDARD                                   00720000
           RECORDING MODE IS F                                          00730000
           BLOCK CONTAINS 0 RECORDS.                                    00740000
W26603 01  TWKSCLS-INTEGRITY-EXTR-REC  PIC X(120).                      00750016
                                                                        00760000
       FD  DATA-INTEGRITY-DIFF-FILE                                     00770000
           RECORDING MODE IS F                                          00780000
           LABEL RECORDS ARE STANDARD                                   00790000
           BLOCK CONTAINS 0 RECORDS.                                    00800000
                                                                        00810000
W26603 01  DATA-INTEGRITY-DIFF-REC     PIC X(80).                       00820016
                                                                        00830000
      *                                                                 00840000
      ******************************************************************00850000
       WORKING-STORAGE SECTION.                                         00860000
      ******************************************************************00870000
                                                                        00880000
       01  PS-PROGRAM-SWITCHES.                                         00890000
           05  PS-MORE-TWKSHNK-RECS-SW                                  00900000
                                       PIC X       VALUE 'Y'.           00910000
               88  PS-MORE-TWKSHNK-RECS            VALUE 'Y'.           00920000
               88  PS-NO-MORE-TWKSHNK-RECS         VALUE 'N'.           00930000
           05  PS-MORE-TWKSCLS-RECS-SW                                  00940000
                                       PIC X       VALUE 'Y'.           00950000
               88  PS-MORE-TWKSCLS-RECS            VALUE 'Y'.           00960000
               88  PS-NO-MORE-TWKSCLS-RECS         VALUE 'N'.           00970000
           05  PS-BYPASS-0-DOLLARS-SW  PIC X.                           00980000
               88  PS-BYPASS-0-DOLLARS             VALUE 'Y'.           00990000
               88  PS-NO-BYPASS-DOLLARS            VALUE 'N'.           01000000
                                                                        01010000
       01  PA-PROGRAM-ACCUMULATORS                 COMP-3.              01020000
           05  PA-TWKSHNK-READ         PIC S9(13)  VALUE ZERO.          01030000
           05  PA-TWKSCLS-READ         PIC S9(13)  VALUE ZERO.          01040000
           05  PA-KEY-MATCHES          PIC S9(13)  VALUE ZERO.          01050000
           05  PA-REPORT-RECS-WRITTEN  PIC S9(13)  VALUE ZERO.          01060000
                                                                        01070000
       01  CD-COUNTER-DISPLAY.                                          01080000
           05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           01090000
                                                                        01100000
       01  PV-PROGRAM-VARIABLES.                                        01110000
           05  PV-TWKSHNK-KEY.                                          01120000
               10  PV-TWKSHNK-FSCL-MN-END-DTE     PIC X(10).            01130000
               10  PV-TWKSHNK-DEPT-NBR            PIC X(03).            01140000
               10  PV-TWKSHNK-SUB-CL-NBR          PIC X(02).            01150000
               10  PV-TWKSHNK-STR-NBR             PIC S9(4) COMP.       01160000
      *                                                                 01170000
           05  PV-TWKSCLS-KEY.                                          01180000
               10  PV-TWKSCLS-FSCL-MN-END-DTE     PIC X(10).            01190000
               10  PV-TWKSCLS-DEPT-NBR            PIC X(03).            01200000
               10  PV-TWKSCLS-SUB-CL-NBR          PIC X(02).            01210000
               10  PV-TWKSCLS-STR-NBR             PIC S9(4) COMP.       01220000
                                                                        01230000
           05  PV-SALES-DOLLARS.                                        01240000
               10  PV-TWKSHNK-RTL-AMT             PIC S9(11)V99 COMP-3. 01250000
               10  PV-TWKSCLS-RTL-AMT             PIC S9(11)V99 COMP-3. 01260000
               10  PV-DIFF-SALES-RTL-AMT          PIC S9(11)V99 COMP-3. 01270000
W26603         10  PV-TWKSHNK-DOLLARS-FMT      PIC ZZ,ZZZ,ZZZ,ZZ9.99- . 01280016
W26603         10  PV-TWKSCLS-DOLLARS-FMT      PIC ZZ,ZZZ,ZZZ,ZZ9.99- . 01290016
                                                                        01300000
       01 ABEND-AREAS.                                                  01310000
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO           01320000
                                                   COMP SYNC.           01330000
               88  AC-BAD-DATA                     VALUE +4003.         01340000
               88  AC-DB2-ERROR                    VALUE +4013.         01350000
           05  AA-ABEND-LIT            PIC X(40)   VALUE                01360000
                 '*****       ABEND'.                                   01370000
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                01380000
                   '*****   PROGRAM: MLKUT435'.                         01390000
           05  AA-PARAGRAPH-LIT.                                        01400000
               10  FILLER              PIC X(17)   VALUE                01410000
                   '***** PARAGRAPH: '.                                 01420000
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        01430000
           05  AA-MESSAGE-LINE.                                         01440000
               10  FILLER              PIC X(06)   VALUE '*****'.       01450000
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        01460000
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                01470000
                   '*****    DB2 ERROR'.                                01480000
           05  AA-DB2-OPERATION-LIT.                                    01490000
               10  FILLER              PIC X(17)   VALUE                01500000
                   '***** OPERATION: '.                                 01510000
               10  AA-DB2-OPERATION.                                    01520000
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        01530000
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        01540000
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        01550000
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        01560000
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        01570000
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        01580000
                                                                        01590000
       EJECT                                                            01600000
                                                                        01610000
      *** DATA INTEGRITY COMPARE TABLES CONTROL CARD                    01620000
       01  CC-CONTROL-CARD-REC.                                         01630000
           05  CC-TWKSHNK-TABLE        PIC X(7).                        01640000
           05  FILLER                  PIC X.                           01650000
           05  CC-TWKSCLS-TABLE        PIC X(7).                        01660000
           05  FILLER                  PIC X(65).                       01670000
                                                                        01680000
      * TWKSHNK EXTRACT FILE LAYOUT                                     01690000
           COPY MLRD125.                                                01700000
                                                                        01710000
      * TWKSCLS EXTRACT FILE LAYOUT                                     01720000
           COPY MLRD111.                                                01730000
                                                                        01740000
      *** DATA INTEGRITY DIFFERENCE REPORT FILE                         01750000
           COPY MLRD112.                                                01760000
                                                                        01770000
       EJECT                                                            01780000
                                                                        01790000
      ******************************************************************01800000
       PROCEDURE DIVISION.                                              01810000
      ******************************************************************01820000
                                                                        01830000
      ******************************************************************01840000
       0000-MAINLINE-MLKUT435.                                          01850000
      ******************************************************************01860000
      *                                                                 01870000
           PERFORM 1000-INITIALIZATION.                                 01880000
                                                                        01890000
           PERFORM 2000-MAIN-PROCESS.                                   01900000
                                                                        01910000
           PERFORM 8000-EOJ.                                            01920000
                                                                        01930000
           STOP RUN.                                                    01940000
                                                                        01950000
       EJECT                                                            01960000
                                                                        01970000
      ******************************************************************01980000
       1000-INITIALIZATION.                                             01990000
      ******************************************************************02000000
      *                                                                 02010000
           OPEN INPUT  COMPARE-TABLES-CTL-FILE                          02020000
                       TWKSHNK-INTEGRITY-EXTR-FILE                      02030000
                       TWKSCLS-INTEGRITY-EXTR-FILE.                     02040000
           OPEN OUTPUT DATA-INTEGRITY-DIFF-FILE.                        02050000
                                                                        02060000
           PERFORM 4000-READ-CONTROL-CARD.                              02070000
                                                                        02080000
           DISPLAY ' '.                                                 02090000
           DISPLAY '*** MLKUT435 INPUT CONTROL CARD VALUES ***'         02100000
           DISPLAY CC-CONTROL-CARD-REC.                                 02110000
                                                                        02120000
           INITIALIZE PA-PROGRAM-ACCUMULATORS.                          02130000
           INITIALIZE PV-PROGRAM-VARIABLES.                             02140000
                                                                        02150000
       EJECT                                                            02160000
                                                                        02170000
      ******************************************************************02180000
       2000-MAIN-PROCESS.                                               02190000
      ******************************************************************02200000
      *                                                                 02210000
           PERFORM 4100-READ-TWKSHNK-FILE.                              02220000
                                                                        02230000
           IF PS-NO-MORE-TWKSHNK-RECS                                   02240000
               MOVE '2000-MAIN-PROCESS'           TO AA-PARAGRAPH-NAME  02250000
               MOVE 'EMPTY TWKSHNK EXTRACT FILE'  TO AA-MESSAGE         02260000
               MOVE +4002                         TO ABEND-CODE         02270000
               PERFORM 9900-COMMON-ABEND-ROUTINE                        02280000
           END-IF.                                                      02290000
                                                                        02300000
           PERFORM 4200-READ-TWKSCLS-FILE.                              02310000
                                                                        02320000
           IF PS-NO-MORE-TWKSCLS-RECS                                   02330000
               MOVE '2000-MAIN-PROCESS'           TO AA-PARAGRAPH-NAME  02340000
               MOVE 'EMPTY TWKSCLS EXTRACT FILE'  TO AA-MESSAGE         02350000
               MOVE +4003                         TO ABEND-CODE         02360000
               PERFORM 9900-COMMON-ABEND-ROUTINE                        02370000
           END-IF.                                                      02380000
                                                                        02390000
           PERFORM                                                      02400000
             UNTIL PS-NO-MORE-TWKSHNK-RECS                              02410000
               AND PS-NO-MORE-TWKSCLS-RECS                              02420000
                   PERFORM 2100-COMPARE-FILES                           02430000
           END-PERFORM.                                                 02440000
                                                                        02450000
       EJECT                                                            02460000
                                                                        02470000
      ******************************************************************02480000
       2100-COMPARE-FILES.                                              02490000
      ******************************************************************02500000
      *                                                                 02510000
           PERFORM 3000-BUILD-FILE-KEYS.                                02520000
                                                                        02530000
           IF PV-TWKSHNK-KEY = PV-TWKSCLS-KEY                           02540000
               ADD 1                   TO PA-KEY-MATCHES                02550000
               PERFORM 5100-COMPARE-SALES-AMTS                          02560003
               PERFORM 4100-READ-TWKSHNK-FILE                           02570000
               PERFORM 4200-READ-TWKSCLS-FILE                           02580000
           ELSE                                                         02590000
               IF PV-TWKSHNK-KEY < PV-TWKSCLS-KEY                       02600000
                   PERFORM 5200-PROCESS-ONLY-TWKSHNK                    02610000
                   PERFORM 4100-READ-TWKSHNK-FILE                       02620000
               ELSE                                                     02630000
                   PERFORM 5300-PROCESS-ONLY-TWKSCLS                    02640000
                   PERFORM 4200-READ-TWKSCLS-FILE                       02650000
               END-IF                                                   02660000
           END-IF.                                                      02670000
                                                                        02680000
       EJECT                                                            02690000
                                                                        02700000
      ******************************************************************02710000
       3000-BUILD-FILE-KEYS.                                            02720000
      ******************************************************************02730000
      *                                                                 02740000
           INITIALIZE PV-TWKSHNK-KEY                                    02750011
                      PV-TWKSCLS-KEY                                    02760011
                      PV-SALES-DOLLARS.                                 02770011
                                                                        02780011
           IF ML125-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               02790011
               MOVE HIGH-VALUES        TO PV-TWKSHNK-KEY                02800011
           ELSE                                                         02810011
               MOVE ML125-FSCL-MN-END-DTE  TO PV-TWKSHNK-FSCL-MN-END-DTE02820011
               MOVE ML125-DEPT-NBR         TO PV-TWKSHNK-DEPT-NBR       02830011
               MOVE ML125-SUB-CL-NBR       TO PV-TWKSHNK-SUB-CL-NBR     02840011
               MOVE ML125-STR-NBR          TO PV-TWKSHNK-STR-NBR        02850011
               MOVE ML125-SHNK-RTL-AMT     TO PV-TWKSHNK-RTL-AMT        02860013
           END-IF.                                                      02870011
      *                                                                 02880000
           IF ML111-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               02890011
               MOVE HIGH-VALUES        TO PV-TWKSCLS-KEY                02900012
           ELSE                                                         02910011
               MOVE ML111-FSCL-MN-END-DTE  TO PV-TWKSCLS-FSCL-MN-END-DTE02920011
               MOVE ML111-DEPT-NBR         TO PV-TWKSCLS-DEPT-NBR       02930011
               MOVE ML111-SUB-CL-NBR       TO PV-TWKSCLS-SUB-CL-NBR     02940011
               MOVE ML111-STR-NBR          TO PV-TWKSCLS-STR-NBR        02950011
               MOVE ML111-SHNK-RTL-AMT     TO PV-TWKSCLS-RTL-AMT        02960014
           END-IF.                                                      02970011
      *                                                                 02980000
      * SALES DOLLARS AMOUNTS                                           02990005
      *    MOVE ML125-SLS-RTL-AMT      TO PV-TWKSHNK-RTL-AMT.           03000013
      *    MOVE ML111-SLS-RTL-AMT      TO PV-TWKSCLS-RTL-AMT.           03010013
                                                                        03020000
       EJECT                                                            03030000
                                                                        03040000
      ******************************************************************03050000
       4000-READ-CONTROL-CARD.                                          03060000
      ******************************************************************03070000
      *                                                                 03080000
           READ COMPARE-TABLES-CTL-FILE                                 03090000
             INTO CC-CONTROL-CARD-REC                                   03100000
               AT END                                                   03110000
                   MOVE '4000-READ-CONTROL-CARD'   TO AA-PARAGRAPH-NAME 03120000
                   MOVE 'CONTROL CARD IS MISSING'  TO AA-MESSAGE        03130000
                   MOVE +4001                      TO ABEND-CODE        03140000
                   PERFORM 9900-COMMON-ABEND-ROUTINE                    03150000
           END-READ.                                                    03160000
                                                                        03170000
       EJECT                                                            03180000
                                                                        03190000
      ******************************************************************03200000
       4100-READ-TWKSHNK-FILE.                                          03210000
      ******************************************************************03220000
      *                                                                 03230000
           IF PS-MORE-TWKSHNK-RECS                                      03240000
               READ TWKSHNK-INTEGRITY-EXTR-FILE                         03250000
                 INTO ML125-DATA-INTEGRITY-EXTR-REC                     03260000
                   AT END                                               03270000
                       SET PS-NO-MORE-TWKSHNK-RECS TO TRUE              03280000
1099                   MOVE HIGH-VALUES                                 03290010
1099                                   TO ML125-DATA-INTEGRITY-EXTR-REC 03300010
1099           END-READ                                                 03310013
           END-IF.                                                      03320000
                                                                        03330000
           IF PS-MORE-TWKSHNK-RECS                                      03340000
               ADD 1                   TO PA-TWKSHNK-READ               03350000
           END-IF.                                                      03360000
      *                                                                 03370000
      ******************************************************************03380000
       4200-READ-TWKSCLS-FILE.                                          03390000
      ******************************************************************03400000
      *                                                                 03410000
           IF PS-MORE-TWKSCLS-RECS                                      03420000
               READ TWKSCLS-INTEGRITY-EXTR-FILE                         03430000
                 INTO ML111-DATA-INTEGRITY-EXTR-REC                     03440000
                   AT END                                               03450000
                       SET PS-NO-MORE-TWKSCLS-RECS TO TRUE              03460000
1099                   MOVE HIGH-VALUES                                 03470010
1099                                   TO ML125-DATA-INTEGRITY-EXTR-REC 03480010
1099           END-READ                                                 03490013
           END-IF.                                                      03500000
                                                                        03510000
           IF PS-MORE-TWKSCLS-RECS                                      03520000
               ADD 1                   TO PA-TWKSCLS-READ               03530000
           END-IF.                                                      03540000
      *                                                                 03550000
      ******************************************************************03560000
       5100-COMPARE-SALES-AMTS.                                         03570003
      ******************************************************************03580000
      *                                                                 03590000
           IF ML125-SLS-RTL-AMT NOT EQUAL ML111-SLS-RTL-AMT             03600000
      *    IF SALES $ ARE DIFFERENT - THIS IS AN ERROR                  03610003
               MOVE ML111-FSCL-MN-END-DTE TO ML112-FSCL-MN-END-DTE      03620000
               MOVE ML111-FSCL-MN-NBR     TO ML112-FSCL-MN-NBR          03630000
               MOVE ML111-DEPT-NBR        TO ML112-DEPT-NBR             03640000
               MOVE ML111-MAJ-CL-NBR      TO ML112-MAJ-CL-NBR           03650000
               MOVE ML111-SUB-CL-NBR      TO ML112-SUB-CL-NBR           03660000
               MOVE ML111-STR-NBR         TO ML112-STR-NBR              03670000
               MOVE ML125-SLS-RTL-AMT     TO ML112-LOW-TBL-AMT          03680000
               MOVE ML111-SLS-RTL-AMT     TO ML112-HIGH-TBL-AMT         03690000
               MOVE 03                    TO ML112-ERR-MSG-NBR          03700008
               WRITE DATA-INTEGRITY-DIFF-REC                            03710000
                   FROM ML112-DATA-INTEGRITY-DIFF-REC                   03720000
               DISPLAY 'SALES$ DIFFERENCES FOUND : ', ML111-DEPT-NBR,   03730006
                        ' ', ML111-SUB-CL-NBR, ' ', ML111-STR-NBR       03740002
               MOVE ML125-SLS-RTL-AMT     TO PV-TWKSHNK-DOLLARS-FMT     03750006
               MOVE ML111-SLS-RTL-AMT     TO PV-TWKSCLS-DOLLARS-FMT     03760006
               DISPLAY 'TWKSHNK SALES $ : ', ML125-SLS-RTL-AMT, ' ',    03770006
                       'TWKSCLS SALES $ : ', ML111-SLS-RTL-AMT          03780006
                       ADD 1              TO PA-REPORT-RECS-WRITTEN     03790000
           END-IF.                                                      03800000
      *                                                                 03810003
      *                                                                 03820003
      ******************************************************************03830000
       5200-PROCESS-ONLY-TWKSHNK.                                       03840000
      ******************************************************************03850000
           IF ML125-SLS-RTL-AMT = 0                                     03860000
               SET PS-BYPASS-0-DOLLARS TO TRUE                          03870000
           ELSE                                                         03880000
               SET PS-NO-BYPASS-DOLLARS TO TRUE                         03890000
           END-IF.                                                      03900000
                                                                        03910000
           IF PS-BYPASS-0-DOLLARS                                       03920000
               CONTINUE                                                 03930000
           ELSE                                                         03940000
               PERFORM 5220-PROCESS-NO-HIGH-RECD-ERR                    03950000
           END-IF.                                                      03960000
                                                                        03970000
                                                                        03980000
      ******************************************************************03990000
       5220-PROCESS-NO-HIGH-RECD-ERR.                                   04000000
      ******************************************************************04010000
      *                                                                 04020000
           INITIALIZE ML112-DATA-INTEGRITY-DIFF-REC.                    04030000
      *                                                                 04040000
           MOVE ML125-FSCL-MN-END-DTE TO ML112-FSCL-MN-END-DTE.         04050000
      *    MOVE SPACES                TO ML112-FSCL-MN-NBR.             04060000
           MOVE ML125-DEPT-NBR        TO ML112-DEPT-NBR.                04070000
      *    MOVE '00'                  TO ML112-MAJ-CL-NBR.              04080000
           MOVE ML125-SUB-CL-NBR      TO ML112-SUB-CL-NBR.              04090000
           MOVE ML125-STR-NBR         TO ML112-STR-NBR.                 04100000
           MOVE 0                     TO ML112-LOW-TBL-AMT              04110000
                                         ML112-HIGH-TBL-AMT.            04120000
           MOVE 1                     TO ML112-ERR-MSG-NBR.             04130000
                                                                        04140000
           WRITE DATA-INTEGRITY-DIFF-REC                                04150000
               FROM ML112-DATA-INTEGRITY-DIFF-REC.                      04160000
                                                                        04170000
           ADD 1                      TO PA-REPORT-RECS-WRITTEN.        04180000
      *                                                                 04190000
      ******************************************************************04200000
       5300-PROCESS-ONLY-TWKSCLS.                                       04210000
      ******************************************************************04220000
           IF ML111-SLS-RTL-AMT = 0                                     04230000
               SET PS-BYPASS-0-DOLLARS TO TRUE                          04240000
           ELSE                                                         04250000
               SET PS-NO-BYPASS-DOLLARS TO TRUE                         04260000
           END-IF.                                                      04270000
                                                                        04280000
           IF PS-BYPASS-0-DOLLARS                                       04290000
               CONTINUE                                                 04300000
           ELSE                                                         04310000
               PERFORM 5320-PROCESS-NO-LOW-RECD-ERR                     04320000
           END-IF.                                                      04330000
                                                                        04340000
      *                                                                 04350000
                                                                        04360000
      ******************************************************************04370000
       5320-PROCESS-NO-LOW-RECD-ERR.                                    04380000
      ******************************************************************04390000
      *                                                                 04400000
           INITIALIZE ML112-DATA-INTEGRITY-DIFF-REC.                    04410000
      *                                                                 04420000
           MOVE ML111-FSCL-MN-END-DTE TO ML112-FSCL-MN-END-DTE.         04430000
           MOVE ML111-FSCL-MN-NBR     TO ML112-FSCL-MN-NBR.             04440000
           MOVE ML111-DEPT-NBR        TO ML112-DEPT-NBR.                04450000
           MOVE ML111-MAJ-CL-NBR      TO ML112-MAJ-CL-NBR.              04460000
           MOVE ML111-SUB-CL-NBR      TO ML112-SUB-CL-NBR.              04470000
           MOVE ML111-STR-NBR         TO ML112-STR-NBR.                 04480000
           MOVE 0                     TO ML112-LOW-TBL-AMT              04490000
                                         ML112-HIGH-TBL-AMT.            04500000
           MOVE 2                     TO ML112-ERR-MSG-NBR.             04510000
                                                                        04520000
           WRITE DATA-INTEGRITY-DIFF-REC                                04530000
               FROM ML112-DATA-INTEGRITY-DIFF-REC.                      04540000
                                                                        04550000
           ADD 1                       TO PA-REPORT-RECS-WRITTEN.       04560000
                                                                        04570000
       EJECT                                                            04580000
                                                                        04590000
      ******************************************************************04600000
       8000-EOJ.                                                        04610000
      ******************************************************************04620000
      *                                                                 04630000
           DISPLAY ' '.                                                 04640000
           DISPLAY '  PROGRAM MLKUT435 PROCESSING SUMMARY'.             04650000
           DISPLAY '  -----------------------------------'.             04660000
           DISPLAY ' '.                                                 04670000
      *                                                                 04680000
           MOVE PA-TWKSHNK-READ        TO CD-COUNT-HOLD1.               04690000
           DISPLAY 'TWKSHNK EXTR RECORDS READ =       ' CD-COUNT-HOLD1. 04700000
      *                                                                 04710000
           MOVE PA-TWKSCLS-READ        TO CD-COUNT-HOLD1.               04720000
           DISPLAY 'TWKSCLS EXTR RECORDS READ =       ' CD-COUNT-HOLD1. 04730009
      *                                                                 04740000
           MOVE PA-KEY-MATCHES         TO CD-COUNT-HOLD1.               04750000
           DISPLAY 'KEY MATCHES =            ' CD-COUNT-HOLD1.          04760000
      *                                                                 04770000
           MOVE PA-REPORT-RECS-WRITTEN TO CD-COUNT-HOLD1.               04780000
           DISPLAY 'REPORT RECORDS WRITTEN = ' CD-COUNT-HOLD1.          04790000
      *                                                                 04800000
           DISPLAY ' '.                                                 04810000
                                                                        04820000
           CLOSE COMPARE-TABLES-CTL-FILE.                               04830000
           CLOSE TWKSHNK-INTEGRITY-EXTR-FILE.                           04840000
           CLOSE TWKSCLS-INTEGRITY-EXTR-FILE.                           04850000
           CLOSE DATA-INTEGRITY-DIFF-FILE.                              04860000
                                                                        04870000
       EJECT                                                            04880000
                                                                        04890000
      ******************************************************************04900000
       9900-COMMON-ABEND-ROUTINE.                                       04910000
      ******************************************************************04920000
      *                                                                 04930000
           DISPLAY AA-ABEND-LIT.                                        04940000
           DISPLAY AA-PROGRAM-LIT.                                      04950000
           DISPLAY AA-PARAGRAPH-LIT.                                    04960000
           DISPLAY AA-MESSAGE-LINE.                                     04970000
           DISPLAY ABEND-CODE.                                          04980000
                                                                        04990000
           CALL 'ILBOABN0' USING ABEND-CODE.                            05000000
                                                                        05010000
