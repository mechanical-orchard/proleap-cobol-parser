000100 IDENTIFICATION DIVISION.                                         00010001
000200                                                                  00020000
000300 PROGRAM-ID.             DBKUT200.                                00030002
000400 AUTHOR.                 BRAD DORN.                               00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN.           FEBRUARY 2017.                           00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900****************************************************************  00090000
001200***  THIS PROGRAM WILL CALL DSNACCOX TO IDENTIFY ANY          **  00120002
001300***  TABLESPACES OR INDEXES IN A RESTRICTED STATE.            **  00130002
001310***                                                           **  00131002
001320***  RESTRICTED OBJECT INFORMATION WILL BE WRITTEN TO A       **  00132002
001330***  FLAT FILE FOR INPUT INTO A REXX ROUTINE THAT WILL        **  00133002
001340***  GENERATE -STA COMMANDS.                                  **  00134002
001400****************************************************************  00140000
001500                                                                  00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700                                                                  00170000
001800 CONFIGURATION SECTION.                                           00180000
001900                                                                  00190000
002000 SOURCE-COMPUTER.    IBM.                                         00200000
002100 OBJECT-COMPUTER.    IBM.                                         00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400                                                                  00240000
002500 FILE-CONTROL.                                                    00250000
002600                                                                  00260000
002601     SELECT RESTRICTED-OBJECTS-FILE                               00260102
002602         ASSIGN TO OUT01.                                         00260202
002620                                                                  00262002
002630                                                                  00263002
002700 DATA DIVISION.                                                   00270000
002800                                                                  00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003001 FD  RESTRICTED-OBJECTS-FILE                                      00300102
003002     RECORDING MODE IS F                                          00300202
003003     BLOCK CONTAINS 0 RECORDS.                                    00300302
003010                                                                  00301002
003011 01  RESTRICTED-OBJECTS-RECORD   PIC X(080).                      00301102
003020                                                                  00302002
003100                                                                  00310000
003200 WORKING-STORAGE SECTION.                                         00320000
003300                                                                  00330000
003400 01  WS-NO-MORE-C1-ROWS      PIC X(1)      VALUE SPACES.          00340001
003500 01  WS-NO-MORE-C2-ROWS      PIC X(1)      VALUE SPACES.          00350001
003600                                                                  00360001
003700 01  LOC1  USAGE SQL TYPE IS RESULT-SET-LOCATOR VARYING.          00370001
003800 01  LOC2  USAGE SQL TYPE IS RESULT-SET-LOCATOR VARYING.          00380001
003900                                                                  00390001
004000 01  WS-ABEND-CODE           PIC S9(04)    VALUE +0 COMP SYNC.    00400001
004100     88  SP-CALL-ERROR                       VALUE +4013.         00410001
004200     88  C1-FETCH-ERROR                      VALUE +4015.         00420001
004300     88  C2-FETCH-ERROR                      VALUE +4016.         00430001
004400     88  ASSOC-LOCATORS-ERROR                VALUE +4017.         00440001
004500     88  ALLOCATE-C1-CSR-ERROR               VALUE +4018.         00450001
004600     88  ALLOCATE-C2-CSR-ERROR               VALUE +4019.         00460001
004700     88  CLOSE-C1-CSR-ERROR                  VALUE +4020.         00470001
004800     88  CLOSE-C2-CSR-ERROR                  VALUE +4021.         00480001
004900                                                                  00490001
004920 01  WS-RESTRICTED-REC-LINE.                                      00492002
004930     05  WS-OUT-DBNAME           PIC X(8)  VALUE SPACES.          00493002
004931     05  FILLER                  PIC X(1)  VALUE SPACE.           00493102
004932     05  WS-OUT-NAME             PIC X(8)  VALUE SPACES.          00493202
004933     05  FILLER                  PIC X(1)  VALUE SPACE.           00493302
004934     05  WS-OUT-PARTITION        PIC 9(4)  VALUE 0.               00493402
004935     05  FILLER                  PIC X(1)  VALUE SPACE.           00493502
004936     05  WS-OUT-OBJECTTYPE       PIC X(2)  VALUE SPACES.          00493602
004937     05  FILLER                  PIC X(1)  VALUE SPACE.           00493702
004938     05  WS-OUT-OBJECTSTATUS     PIC X(40) VALUE SPACES.          00493802
004940                                                                  00494002
005000 01 DP004-DB2-ERROR-FIELDS.                                       00500001
005100     05  DP004-ASTERISK-LINE       PIC  X(80)  VALUE ALL '*'.     00510001
005200     05  DP004-MAX-MESSAGE-LINES   PIC S9(04)  VALUE +12          00520001
005300                                               COMP SYNC.         00530001
005400     05  DP004-ERROR-LINE-LENGTH   PIC S9(09)  VALUE +75          00540001
005500                                               COMP SYNC.         00550001
005600     05  DP004-FORMATTED-MESSAGE.                                 00560001
005700         10  FILLER                PIC S9(04)  VALUE +900         00570001
005800                                               COMP SYNC.         00580001
005900         10  DP004-MESSAGE-LINE    OCCURS 12 TIMES                00590001
006000                                   INDEXED BY DP004-MSG-IDX       00600001
006100                                   PIC  X(75).                    00610001
006200                                                                  00620001
006300*-----------------------------------------------------------------00630002
006400* DSNACCOX PARAMETERS                                             00640002
006402*-----------------------------------------------------------------00640202
006420*   QUERYTYPE  = RESTRICT                                         00642002
006430*   OBJECTTYPE = ALL (TABLE SPACES AND INDEX SPACES)              00643002
006431*   CHKLVL     = 8 (CHECK FOR OBJECTS THAT HAVE RESTRICTED STATES)00643102
006500*-----------------------------------------------------------------00650002
006600 01  QUERYTYPE.                                                   00660000
006700     49   QUERYTYPE-LN        PICTURE S9(4)    COMP VALUE 40.     00670002
006800     49   QUERYTYPE-DTA       PICTURE X(40)    VALUE 'RESTRICT'.  00680002
006900 01  OBJECTTYPE.                                                  00690000
007000     49   OBJECTTYPE-LN       PICTURE S9(4)    COMP VALUE 3.      00700002
007100     49   OBJECTTYPE-DTA      PICTURE X(3)     VALUE 'ALL'.       00710002
007200 01  ICTYPE.                                                      00720000
007300     49   ICTYPE-LN           PICTURE S9(4)    COMP VALUE 1.      00730002
007400     49   ICTYPE-DTA          PICTURE X(1)     VALUE SPACE.       00740002
007500 01  CATLGSCHEMA.                                                 00750000
007600     49   CATLGSCHEMA-LN      PICTURE S9(4)    COMP VALUE 128.    00760002
007700     49   CATLGSCHEMA-DTA     PICTURE X(128)   VALUE 'SYSIBM'.    00770002
007800 01  LOCALSCHEMA.                                                 00780000
007900     49   LOCALSCHEMA-LN      PICTURE S9(4)    COMP VALUE 128.    00790002
008000     49   LOCALSCHEMA-DTA     PICTURE X(128)   VALUE 'DSNACC'.    00800002
008100 01  CHKLVL                   PICTURE S9(9)    COMP VALUE +8.     00810002
008200 01  CRITERIA.                                                    00820000
008300     49   CRITERIA-LN         PICTURE S9(4)    COMP VALUE 4096.   00830002
008400     49   CRITERIA-DTA        PICTURE X(4096)  VALUE SPACES.      00840000
008500 01  SPECIALPARM.                                                 00850000
008600     49   SPECIALPARM-LN      PICTURE S9(4)    COMP VALUE 80.     00860002
008700     49   SPECIALPARM-DTA     PICTURE X(80)    VALUE SPACES.      00870002
008800 01  CRUPDATEDPAGESPCT        USAGE COMP-2     VALUE +0.          00880002
008900 01  CRUPDATEDPAGESABS        PICTURE S9(9)    COMP VALUE +0.     00890002
009000 01  CRCHANGESPCT             USAGE COMP-2     VALUE +0.          00900002
009100 01  CRDAYSNCLASTCOPY         PICTURE S9(9)    COMP VALUE +0.     00910002
009200 01  ICRUPDATEDPAGESPCT       USAGE COMP-2     VALUE +0.          00920002
009300 01  ICRUPDATEDPAGESABS       PICTURE S9(9)    COMP VALUE +0.     00930002
009400 01  ICRCHANGESPCT            PICTURE S9(9)    COMP VALUE +0.     00940002
009500 01  CRINDEXSIZE              PICTURE S9(9)    COMP VALUE +0.     00950002
009600 01  RRTINSERTSPCT            USAGE COMP-2     VALUE +0.          00960002
009700 01  RRTINSERTSABS            PICTURE S9(9)    COMP VALUE +0.     00970002
009800 01  RRTDELETESPCT            USAGE COMP-2     VALUE +0.          00980002
009900 01  RRTDELETESABS            PICTURE S9(9)    COMP VALUE +0.     00990002
010000 01  RRTUNCLUSTINSPCT         USAGE COMP-2     VALUE +0.          01000002
010100 01  RRTDISORGLOBPCT          USAGE COMP-2     VALUE +0.          01010002
010200 01  RRTDATASPACERAT          PICTURE S9(9)    COMP VALUE +0.     01020002
010300 01  RRTMASSDELLIMIT          PICTURE S9(9)    COMP VALUE +0.     01030002
010400 01  RRTINDREFLIMIT           PICTURE S9(9)    COMP VALUE +0.     01040002
010500 01  RRIINSERTSPCT            USAGE COMP-2     VALUE +0.          01050002
010600 01  RRIINSERTSABS            PICTURE S9(9)    COMP VALUE +0.     01060002
010700 01  RRIDELETESPCT            USAGE COMP-2     VALUE +0.          01070002
010800 01  RRIDELETESABS            PICTURE S9(9)    COMP VALUE +0.     01080002
010900 01  RRIAPPENDINSERTPCT       USAGE COMP-2     VALUE +0.          01090002
011000 01  RRIPSEUDODELETEPCT       USAGE COMP-2     VALUE +0.          01100002
011100 01  RRIMASSDELLIMIT          PICTURE S9(9)    COMP VALUE +0.     01110002
011200 01  RRILEAFLIMIT             PICTURE S9(9)    COMP VALUE +0.     01120002
011300 01  RRINUMLEVELSLIMIT        PICTURE S9(9)    COMP VALUE +0.     01130002
011400 01  SRTINSDELUPDPCT          PICTURE S9(9)    COMP VALUE +0.     01140002
011500 01  SRTINSDELUPDABS          PICTURE S9(9)    COMP VALUE +0.     01150002
011600 01  SRTMASSDELLIMIT          PICTURE S9(9)    COMP VALUE +0.     01160002
011700 01  SRIINSDELPCT             USAGE COMP-2     VALUE +0.          01170002
011800 01  SRIINSDELABS             PICTURE S9(9)    COMP VALUE +0.     01180002
011900 01  SRIMASSDELLIMIT          PICTURE S9(9)    COMP VALUE +0.     01190002
012000 01  EXTENTLIMIT              PICTURE S9(9)    COMP VALUE +0.     01200002
012100 01  LASTSTATEMENT.                                               01210000
012200     49   LASTSTATEMENT-LN    PICTURE S9(4)    COMP VALUE +1.     01220002
012300     49   LASTSTATEMENT-DTA   PICTURE X(8012)  VALUE SPACES.      01230000
012400 01  RETURNCODE               PICTURE S9(9)    COMP VALUE +0.     01240002
012500 01  ERRORMSG.                                                    01250000
012600     49   ERRORMSG-LN         PICTURE S9(4)    COMP VALUE +1.     01260002
012700     49   ERRORMSG-DTA        PICTURE X(1331)  VALUE SPACES.      01270000
012800 01  IFCARETCODE              PICTURE S9(9)    COMP VALUE +0.     01280002
012900 01  IFCARESCODE              PICTURE S9(9)    COMP VALUE +0.     01290002
013000 01  XSBYTES                  PICTURE S9(9)    COMP VALUE +0.     01300002
013100                                                                  01310000
013200                                                                  01320000
013300*----------------------------------------                         01330002
013400* DSNACCOX INDICATOR VARIABLES.                                   01340002
013401*----------------------------------------                         01340102
013900 01  QUERYTYPE-IND            PICTURE S9(4) COMP-4 VALUE +0.      01390000
014000 01  OBJECTTYPE-IND           PICTURE S9(4) COMP-4 VALUE +0.      01400000
014100 01  ICTYPE-IND               PICTURE S9(4) COMP-4 VALUE -1.      01410002
014200 01  CATLGSCHEMA-IND          PICTURE S9(4) COMP-4 VALUE -1.      01420000
014300 01  LOCALSCHEMA-IND          PICTURE S9(4) COMP-4 VALUE -1.      01430000
014400 01  CHKLVL-IND               PICTURE S9(4) COMP-4 VALUE +0.      01440002
014500 01  CRITERIA-IND             PICTURE S9(4) COMP-4 VALUE -1.      01450000
014600 01  SPECIALPARM-IND          PICTURE S9(4) COMP-4 VALUE -1.      01460000
014700 01  CRUPDATEDPAGESPCT-IND    PICTURE S9(4) COMP-4 VALUE -1.      01470000
014800 01  CRUPDATEDPAGESABS-IND    PICTURE S9(4) COMP-4 VALUE -1.      01480000
014900 01  CRCHANGESPCT-IND         PICTURE S9(4) COMP-4 VALUE -1.      01490000
015000 01  CRDAYSNCLASTCOPY-IND     PICTURE S9(4) COMP-4 VALUE -1.      01500000
015100 01  ICRUPDATEDPAGESPCT-IND   PICTURE S9(4) COMP-4 VALUE -1.      01510000
015200 01  ICRUPDATEDPAGESABS-IND   PICTURE S9(4) COMP-4 VALUE -1.      01520000
015300 01  ICRCHANGESPCT-IND        PICTURE S9(4) COMP-4 VALUE -1.      01530000
015400 01  CRINDEXSIZE-IND          PICTURE S9(4) COMP-4 VALUE -1.      01540000
015500 01  RRTINSERTSPCT-IND        PICTURE S9(4) COMP-4 VALUE -1.      01550000
015600 01  RRTINSERTSABS-IND        PICTURE S9(4) COMP-4 VALUE -1.      01560000
015700 01  RRTDELETESPCT-IND        PICTURE S9(4) COMP-4 VALUE -1.      01570000
015800 01  RRTDELETESABS-IND        PICTURE S9(4) COMP-4 VALUE -1.      01580000
015900 01  RRTUNCLUSTINSPCT-IND     PICTURE S9(4) COMP-4 VALUE -1.      01590000
016000 01  RRTDISORGLOBPCT-IND      PICTURE S9(4) COMP-4 VALUE -1.      01600000
016100 01  RRTDATASPACERAT-IND      PICTURE S9(4) COMP-4 VALUE -1.      01610000
016200 01  RRTMASSDELLIMIT-IND      PICTURE S9(4) COMP-4 VALUE -1.      01620000
016300 01  RRTINDREFLIMIT-IND       PICTURE S9(4) COMP-4 VALUE -1.      01630000
016400 01  RRIINSERTSPCT-IND        PICTURE S9(4) COMP-4 VALUE -1.      01640000
016500 01  RRIINSERTSABS-IND        PICTURE S9(4) COMP-4 VALUE -1.      01650000
016600 01  RRIDELETESPCT-IND        PICTURE S9(4) COMP-4 VALUE -1.      01660000
016700 01  RRIDELETESABS-IND        PICTURE S9(4) COMP-4 VALUE -1.      01670000
016800 01  RRIAPPENDINSERTPCT-IND   PICTURE S9(4) COMP-4 VALUE -1.      01680000
016900 01  RRIPSEUDODELETEPCT-IND   PICTURE S9(4) COMP-4 VALUE -1.      01690000
017000 01  RRIMASSDELLIMIT-IND      PICTURE S9(4) COMP-4 VALUE -1.      01700000
017100 01  RRILEAFLIMIT-IND         PICTURE S9(4) COMP-4 VALUE -1.      01710000
017200 01  RRINUMLEVELSLIMIT-IND    PICTURE S9(4) COMP-4 VALUE -1.      01720000
017300 01  SRTINSDELUPDPCT-IND      PICTURE S9(4) COMP-4 VALUE -1.      01730000
017400 01  SRTINSDELUPDABS-IND      PICTURE S9(4) COMP-4 VALUE -1.      01740000
017500 01  SRTMASSDELLIMIT-IND      PICTURE S9(4) COMP-4 VALUE -1.      01750000
017600 01  SRIINSDELPCT-IND         PICTURE S9(4) COMP-4 VALUE -1.      01760000
017700 01  SRIINSDELABS-IND         PICTURE S9(4) COMP-4 VALUE -1.      01770000
017800 01  SRIMASSDELLIMIT-IND      PICTURE S9(4) COMP-4 VALUE -1.      01780000
017900 01  EXTENTLIMIT-IND          PICTURE S9(4) COMP-4 VALUE -1.      01790000
018000 01  LASTSTATEMENT-IND        PICTURE S9(4) COMP-4 VALUE +0.      01800000
018100 01  RETURNCODE-IND           PICTURE S9(4) COMP-4 VALUE +0.      01810000
018200 01  ERRORMSG-IND             PICTURE S9(4) COMP-4 VALUE +0.      01820000
018300 01  IFCARETCODE-IND          PICTURE S9(4) COMP-4 VALUE +0.      01830000
018400 01  IFCARESCODE-IND          PICTURE S9(4) COMP-4 VALUE +0.      01840000
018500 01  XSBYTES-IND              PICTURE S9(4) COMP-4 VALUE +0.      01850000
018600                                                                  01860000
018700                                                                  01870000
018800*------------------------------------                             01880002
018900* DSNACCOX RESULT SET NULL INDICATORS                             01890002
018910*------------------------------------                             01891002
019100 01  RS1-SEQUENCE-NULLIND         PIC S9(4) COMP VALUE +0.        01910000
019200 01  RS1-DATA-NULLIND             PIC S9(4) COMP VALUE +0.        01920000
019300 01  RS2-CLONE-NULLIND            PIC S9(4) COMP VALUE +0.        01930000
019400 01  RS2-INDEXSPACE-NULLIND       PIC S9(4) COMP VALUE +0.        01940000
019500 01  RS2-CREATOR-NULLIND          PIC S9(4) COMP VALUE +0.        01950000
019600 01  RS2-OBJECTSTATUS-NULLIND     PIC S9(4) COMP VALUE +0.        01960000
019700 01  RS2-IMAGECOPY-NULLIND        PIC S9(4) COMP VALUE +0.        01970000
019800 01  RS2-RUNSTATS-NULLIND         PIC S9(4) COMP VALUE +0.        01980000
019900 01  RS2-EXTENTS-NULLIND          PIC S9(4) COMP VALUE +0.        01990000
020000 01  RS2-REORG-NULLIND            PIC S9(4) COMP VALUE +0.        02000000
020100 01  RS2-INEXCEPTTABLE-NULLIND    PIC S9(4) COMP VALUE +0.        02010000
020200 01  RS2-ASSOCIATEDTS-NULLIND     PIC S9(4) COMP VALUE +0.        02020000
020300 01  RS2-COPYLASTTIME-NULLIND     PIC S9(4) COMP VALUE +0.        02030000
020400 01  RS2-LOADRLASTTIME-NULLIND    PIC S9(4) COMP VALUE +0.        02040000
020500 01  RS2-REBUILDLASTTIME-NULLIND  PIC S9(4) COMP VALUE +0.        02050000
020600 01  RS2-CRUPDPGSPCT-NULLIND      PIC S9(4) COMP VALUE +0.        02060000
020700 01  RS2-CRUPDPGSABS-NULLIND      PIC S9(4) COMP VALUE +0.        02070000
020800 01  RS2-CRCPYCHGPCT-NULLIND      PIC S9(4) COMP VALUE +0.        02080000
020900 01  RS2-CRDAYSCELSTCPY-NULLIND   PIC S9(4) COMP VALUE +0.        02090000
021000 01  RS2-CRINDEXSIZE-NULLIND      PIC S9(4) COMP VALUE +0.        02100000
021100 01  RS2-REORGLASTTIME-NULLIND    PIC S9(4) COMP VALUE +0.        02110000
021200 01  RS2-RRTINSERTSPCT-NULLIND    PIC S9(4) COMP VALUE +0.        02120000
021300 01  RS2-RRTINSERTSABS-NULLIND    PIC S9(4) COMP VALUE +0.        02130000
021400 01  RS2-RRTDELETESPCT-NULLIND    PIC S9(4) COMP VALUE +0.        02140000
021500 01  RS2-RRTDELETESABS-NULLIND    PIC S9(4) COMP VALUE +0.        02150000
021600 01  RS2-RRTUNCINSPCT-NULLIND     PIC S9(4) COMP VALUE +0.        02160000
021700 01  RS2-RRTDISORGLOBPCT-NULLIND  PIC S9(4) COMP VALUE +0.        02170000
021800 01  RS2-RRTDATSPRAT-NULLIND      PIC S9(4) COMP VALUE +0.        02180000
021900 01  RS2-RRTMASSDELETE-NULLIND    PIC S9(4) COMP VALUE +0.        02190000
022000 01  RS2-INDREF-NULLIND           PIC S9(4) COMP VALUE +0.        02200000
022100 01  RS2-RRIINSERTPCT-NULLIND     PIC S9(4) COMP VALUE +0.        02210000
022200 01  RS2-RRIINSERTABS-NULLIND     PIC S9(4) COMP VALUE +0.        02220000
022300 01  RS2-RRIDELETESPCT-NULLIND    PIC S9(4) COMP VALUE +0.        02230000
022400 01  RS2-RRIDELETABS-NULLIND      PIC S9(4) COMP VALUE +0.        02240000
022500 01  RS2-RRIAPPINSPCT-NULLIND     PIC S9(4) COMP VALUE +0.        02250000
022600 01  RS2-RRIPSDDELPCT-NULLIND     PIC S9(4) COMP VALUE +0.        02260000
022700 01  RS2-RRIMASSDELETE-NULLIND    PIC S9(4) COMP VALUE +0.        02270000
022800 01  RS2-RRILEAF-NULLIND          PIC S9(4) COMP VALUE +0.        02280000
022900 01  RS2-RRINUMLEVELS-NULLIND     PIC S9(4) COMP VALUE +0.        02290000
023000 01  RS2-STATSLASTTIME-NULLIND    PIC S9(4) COMP VALUE +0.        02300000
023100 01  RS2-SRTINSDELUPDPCT-NULLIND  PIC S9(4) COMP VALUE +0.        02310000
023200 01  RS2-SRTINSDELUPDABS-NULLIND  PIC S9(4) COMP VALUE +0.        02320000
023300 01  RS2-SRTMASSDELETE-NULLIND    PIC S9(4) COMP VALUE +0.        02330000
023400 01  RS2-SRIINSDELPCT-NULLIND     PIC S9(4) COMP VALUE +0.        02340000
023500 01  RS2-SRIINSDELABS-NULLIND     PIC S9(4) COMP VALUE +0.        02350000
023600 01  RS2-SRIMASSDELETE-NULLIND    PIC S9(4) COMP VALUE +0.        02360000
023700 01  RS2-TOTALEXTENTS-NULLIND     PIC S9(4) COMP VALUE +0.        02370000
023800 01  RS2-RRIEMPTYLIMIT-NULLIND    PIC S9(4) COMP VALUE +0.        02380000
023900 01  RS2-RRTHASHOVRFLWRAT-NULLIND PIC S9(4) COMP VALUE +0.        02390000
024000                                                                  02400000
024100                                                                  02410000
024200*-------------------------------                                  02420002
024300* DSNACCOX RESULT SET #1 FIELDS                                   02430002
024310*-------------------------------                                  02431002
024500 01  RS1-SEQUENCE             PIC S9(9) COMP VALUE +0.            02450000
024600 01  RS1-DATA                 PIC X(80) VALUE SPACES.             02460000
024700                                                                  02470000
024800                                                                  02480000
024810*-------------------------------                                  02481002
025000* DSNACCOX RESULT SET #2 FIELDS                                   02500002
025010*-------------------------------                                  02501002
025200 01  DCL-RESULT-SET2.                                             02520000
025300     10 RS2-DBNAME.                                               02530000
025400        49 RS2-DBNAME-LEN        PIC S9(4)  COMP VALUE +0.        02540000
025500        49 RS2-DBNAME-TEXT       PIC X(24)  VALUE SPACES.         02550000
025600     10 RS2-NAME.                                                 02560000
025700        49  RS2-NAME-LEN         PIC S9(4)  COMP VALUE +0.        02570000
025800        49  RS2-NAME-TEXT        PIC X(128) VALUE SPACES.         02580000
025900     10 RS2-PARTITION            PIC S9(9)  COMP VALUE +0.        02590000
026000     10 RS2-INSTANCE             PIC S9(4)  COMP VALUE +0.        02600000
026100     10 RS2-CLONE                PIC X(01)  VALUE SPACES.         02610000
026200     10 RS2-OBJECTTYPE           PIC X(02)  VALUE SPACES.         02620000
026300     10 RS2-INDEXSPACE.                                           02630000
026400        49 RS2-INDEXSPACE-LEN    PIC S9(4)  COMP VALUE +0.        02640000
026500        49 RS2-INDEXSPACE-TEXT   PIC X(24)  VALUE SPACES.         02650000
026600     10 RS2-CREATOR.                                              02660000
026700        49 RS2-CREATOR-LEN       PIC S9(4)  COMP VALUE +0.        02670000
026800        49 RS2-CREATOR-TEXT      PIC X(128) VALUE SPACES.         02680000
026900     10 RS2-OBJECTSTATUS         PIC X(40)  VALUE SPACES.         02690000
027000     10 RS2-IMAGECOPY            PIC X(04)  VALUE SPACES.         02700000
027100     10 RS2-RUNSTATS             PIC X(03)  VALUE SPACES.         02710000
027200     10 RS2-EXTENTS              PIC X(03)  VALUE SPACES.         02720000
027300     10 RS2-REORG                PIC X(03)  VALUE SPACES.         02730000
027400     10 RS2-INEXCEPTTABLE        PIC X(40)  VALUE SPACES.         02740000
027500     10 RS2-ASSOCIATEDTS.                                         02750000
027600        49 RS2-ASSOCIATEDTS-LEN  PIC S9(4)  COMP VALUE +0.        02760000
027700        49 RS2-ASSOCIATEDTS-TEXT PIC X(24)  VALUE SPACES.         02770000
027800     10 RS2-COPYLASTTIME         PIC X(26)  VALUE SPACES.         02780000
027900     10 RS2-LOADRLASTTIME        PIC X(26)  VALUE SPACES.         02790000
028000     10 RS2-REBUILDLASTTIME      PIC X(26)  VALUE SPACES.         02800000
028100     10 RS2-CRUPDPGSPCT          USAGE COMP-2 VALUE +0.           02810000
028200     10 RS2-CRUPDPGSABS          PIC S9(9)  COMP VALUE +0.        02820000
028300     10 RS2-CRCPYCHGPCT          USAGE COMP-2 VALUE +0.           02830000
028400     10 RS2-CRDAYSCELSTCPY       PIC S9(9)  COMP VALUE +0.        02840000
028500     10 RS2-CRINDEXSIZE          PIC S9(9)  COMP VALUE +0.        02850000
028600     10 RS2-REORGLASTTIME        PIC X(26)  VALUE SPACES.         02860000
028700     10 RS2-RRTINSERTSPCT        USAGE COMP-2 VALUE +0.           02870000
028800     10 RS2-RRTINSERTSABS        PIC S9(9)  COMP VALUE +0.        02880000
028900     10 RS2-RRTDELETESPCT        USAGE COMP-2 VALUE +0.           02890000
029000     10 RS2-RRTDELETESABS        PIC S9(9)  COMP  VALUE +0.       02900000
029100     10 RS2-RRTUNCINSPCT         USAGE COMP-2 VALUE +0.           02910000
029200     10 RS2-RRTDISORGLOBPCT      USAGE COMP-2 VALUE +0.           02920000
029300     10 RS2-RRTDATSPRAT          USAGE COMP-2 VALUE +0.           02930000
029400     10 RS2-RRTMASSDELETE        PIC S9(9)  COMP VALUE +0.        02940000
029500     10 RS2-INDREF               USAGE COMP-2 VALUE +0.           02950000
029600     10 RS2-RRIINSERTPCT         USAGE COMP-2 VALUE +0.           02960000
029700     10 RS2-RRIINSERTABS         PIC S9(9)  COMP VALUE +0.        02970000
029800     10 RS2-RRIDELETESPCT        USAGE COMP-2 VALUE +0.           02980000
029900     10 RS2-RRIDELETABS          PIC S9(9)  COMP VALUE +0.        02990000
030000     10 RS2-RRIAPPINSPCT         USAGE COMP-2 VALUE +0.           03000000
030100     10 RS2-RRIPSDDELPCT         USAGE COMP-2 VALUE +0.           03010000
030200     10 RS2-RRIMASSDELETE        PIC S9(9)  COMP VALUE +0.        03020000
030300     10 RS2-RRILEAF              USAGE COMP-2 VALUE +0.           03030000
030400     10 RS2-RRINUMLEVELS         PIC S9(9)  COMP VALUE +0.        03040000
030500     10 RS2-STATSLASTTIME        PIC X(26)  VALUE SPACES.         03050000
030600     10 RS2-SRTINSDELUPDPCT      USAGE COMP-2 VALUE +0.           03060000
030700     10 RS2-SRTINSDELUPDABS      PIC S9(9)  COMP VALUE +0.        03070000
030800     10 RS2-SRTMASSDELETE        PIC S9(9)  COMP VALUE +0.        03080000
030900     10 RS2-SRIINSDELPCT         USAGE COMP-2 VALUE +0.           03090000
031000     10 RS2-SRIINSDELABS         PIC S9(9)  COMP VALUE +0.        03100000
031100     10 RS2-SRIMASSDELETE        PIC S9(9)  COMP VALUE +0.        03110000
031200     10 RS2-TOTALEXTENTS         PIC S9(4)  COMP VALUE +0.        03120000
031300     10 RS2-RRIEMPTYLIMIT        USAGE COMP-2 VALUE +0.           03130000
031400     10 RS2-RRTHASHOVRFLWRAT     USAGE COMP-2 VALUE +0.           03140000
031500                                                                  03150000
031600                                                                  03160000
031700     EXEC SQL                                                     03170000
031800        INCLUDE SQLCA                                             03180000
031900     END-EXEC.                                                    03190000
032000                                                                  03200000
032200                                                                  03220000
032300 PROCEDURE DIVISION.                                              03230000
032400                                                                  03240000
032500 0000-PROGRAM-MAINLINE SECTION.                                   03250000
032600                                                                  03260000
032610     OPEN OUTPUT RESTRICTED-OBJECTS-FILE.                         03261002
032700                                                                  03270002
032800     PERFORM 1000-CALL-DSNACCOX THRU 1000-EXIT.                   03280002
032810                                                                  03281002
032900     PERFORM 2000-PROCESS-RESULT-SETS THRU 2000-EXIT.             03290002
033000                                                                  03300000
033001     CLOSE RESTRICTED-OBJECTS-FILE.                               03300102
033010                                                                  03301002
033100     GOBACK.                                                      03310000
033200                                                                  03320000
033500                                                                  03350000
041800                                                                  04180000
041900 1000-CALL-DSNACCOX.                                              04190002
042000                                                                  04200000
042100     EXEC SQL                                                     04210000
042200       CALL SYSPROC.DSNACCOX                                      04220000
042300       (:QUERYTYPE           :QUERYTYPE-IND,                      04230000
042400        :OBJECTTYPE          :OBJECTTYPE-IND,                     04240000
042500        :ICTYPE              :ICTYPE-IND,                         04250000
042600        :CATLGSCHEMA         :CATLGSCHEMA-IND,                    04260000
042700        :LOCALSCHEMA         :LOCALSCHEMA-IND,                    04270000
042800        :CHKLVL              :CHKLVL-IND,                         04280000
042900        :CRITERIA            :CRITERIA-IND,                       04290000
043000        :SPECIALPARM         :SPECIALPARM-IND,                    04300000
043100        :CRUPDATEDPAGESPCT   :CRUPDATEDPAGESPCT-IND,              04310000
043200        :CRUPDATEDPAGESABS   :CRUPDATEDPAGESABS-IND,              04320000
043300        :CRCHANGESPCT        :CRCHANGESPCT-IND,                   04330000
043400        :CRDAYSNCLASTCOPY    :CRDAYSNCLASTCOPY-IND,               04340000
043500        :ICRUPDATEDPAGESPCT  :ICRUPDATEDPAGESPCT-IND,             04350000
043600        :ICRUPDATEDPAGESABS  :ICRUPDATEDPAGESABS-IND,             04360000
043700        :ICRCHANGESPCT       :ICRCHANGESPCT-IND,                  04370000
043800        :CRINDEXSIZE         :CRINDEXSIZE-IND,                    04380000
043900        :RRTINSERTSPCT       :RRTINSERTSPCT-IND,                  04390000
044000        :RRTINSERTSABS       :RRTINSERTSABS-IND,                  04400000
044100        :RRTDELETESPCT       :RRTDELETESPCT-IND,                  04410000
044200        :RRTDELETESABS       :RRTDELETESABS-IND,                  04420000
044300        :RRTUNCLUSTINSPCT    :RRTUNCLUSTINSPCT-IND,               04430000
044400        :RRTDISORGLOBPCT     :RRTDISORGLOBPCT-IND,                04440000
044500        :RRTDATASPACERAT     :RRTDATASPACERAT-IND,                04450000
044600        :RRTMASSDELLIMIT     :RRTMASSDELLIMIT-IND,                04460000
044700        :RRTINDREFLIMIT      :RRTINDREFLIMIT-IND,                 04470000
044800        :RRIINSERTSPCT       :RRIINSERTSPCT-IND,                  04480000
044900        :RRIINSERTSABS       :RRIINSERTSABS-IND,                  04490000
045000        :RRIDELETESPCT       :RRIDELETESPCT-IND,                  04500000
045100        :RRIDELETESABS       :RRIDELETESABS-IND,                  04510000
045200        :RRIAPPENDINSERTPCT  :RRIAPPENDINSERTPCT-IND,             04520000
045300        :RRIPSEUDODELETEPCT  :RRIPSEUDODELETEPCT-IND,             04530000
045400        :RRIMASSDELLIMIT     :RRIMASSDELLIMIT-IND,                04540000
045500        :RRILEAFLIMIT        :RRILEAFLIMIT-IND,                   04550000
045600        :RRINUMLEVELSLIMIT   :RRINUMLEVELSLIMIT-IND,              04560000
045700        :SRTINSDELUPDPCT     :SRTINSDELUPDPCT-IND,                04570000
045800        :SRTINSDELUPDABS     :SRTINSDELUPDABS-IND,                04580000
045900        :SRTMASSDELLIMIT     :SRTMASSDELLIMIT-IND,                04590000
046000        :SRIINSDELPCT        :SRIINSDELPCT-IND,                   04600000
046100        :SRIINSDELABS        :SRIINSDELABS-IND,                   04610000
046200        :SRIMASSDELLIMIT     :SRIMASSDELLIMIT-IND,                04620000
046300        :EXTENTLIMIT         :EXTENTLIMIT-IND,                    04630000
046400        :LASTSTATEMENT       :LASTSTATEMENT-IND,                  04640000
046500        :RETURNCODE          :RETURNCODE-IND,                     04650000
046600        :ERRORMSG            :ERRORMSG-IND,                       04660000
046700        :IFCARETCODE         :IFCARETCODE-IND,                    04670000
046800        :IFCARESCODE         :IFCARESCODE-IND,                    04680000
046900        :XSBYTES             :XSBYTES-IND)                        04690000
047000     END-EXEC.                                                    04700000
047100                                                                  04710000
047300     IF (SQLCODE = +0 OR SQLCODE = +466)                          04730002
047400         NEXT SENTENCE                                            04740000
047500     ELSE                                                         04750000
048000         SET SP-CALL-ERROR TO TRUE                                04800002
048100         DISPLAY '*****************************************'      04810002
048200         DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'      04820002
048300         DISPLAY '***                                   ***'      04830002
048400         DISPLAY '*** PARAGRAPH 1000-CALL-DSNACCOX      ***'      04840002
048500         DISPLAY '*** BAD SQLCODE FROM DSNACCOX         ***'      04850002
048600         DISPLAY '*****************************************'      04860002
048900         PERFORM 9999-ERROR-ROUTINE.                              04890002
049000                                                                  04900000
049001                                                                  04900102
049002     IF RETURNCODE = 0                                            04900202
049003         NEXT SENTENCE                                            04900302
049004     ELSE                                                         04900402
049005         IF RETURNCODE = 4                                        04900502
049006             DISPLAY 'RETURNCODE FROM DSNACCOX CALL: ' RETURNCODE 04900602
049007             DISPLAY 'ERROR MESSAGE: ' ERRORMSG                   04900702
049008         ELSE                                                     04900802
049009             SET SP-CALL-ERROR TO TRUE                            04900902
049010             DISPLAY '*****************************************'  04901002
049011             DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'  04901102
049012             DISPLAY '***                                   ***'  04901202
049013             DISPLAY '*** PARAGRAPH 1000-CALL-DSNACCOX      ***'  04901302
049014             DISPLAY '*** BAD RETURNCODE FROM DSNACCOX      ***'  04901402
049015             DISPLAY '*****************************************'  04901502
049016             DISPLAY 'RETURNCODE = ' RETURNCODE                   04901602
049017             DISPLAY 'ERROR MESSAGE: ' ERRORMSG                   04901702
049018             PERFORM 9999-ERROR-ROUTINE.                          04901802
049019                                                                  04901902
049020 1000-EXIT.                                                       04902002
049021      EXIT.                                                       04902102
049030                                                                  04903002
049100                                                                  04910000
049200 2000-PROCESS-RESULT-SETS.                                        04920002
049800                                                                  04980000
049900*-------------------------------------------                      04990002
049910* LINK EACH RESULT SET TO A LOCATOR VARIABLE                      04991002
049920*-------------------------------------------                      04992002
050000                                                                  05000000
050100     EXEC SQL ASSOCIATE LOCATORS (:LOC1, :LOC2)                   05010000
050200       WITH PROCEDURE SYSPROC.DSNACCOX                            05020000
050300     END-EXEC.                                                    05030000
050400                                                                  05040000
050500     IF SQLCODE = +0                                              05050000
050600         NEXT SENTENCE                                            05060000
050700     ELSE                                                         05070000
050800         SET ASSOC-LOCATORS-ERROR TO TRUE                         05080000
050900         DISPLAY '******************************************'     05090000
051000         DISPLAY '*** PROGRAM ERROR - DBKUT200           ***'     05100002
051100         DISPLAY '***                                    ***'     05110000
051200         DISPLAY '*** PARAGRAPH 2000-PROCESS-RESULT-SETS ***'     05120002
051300         DISPLAY '*** ASSOCIATE LOCATORS ERROR           ***'     05130000
051400         DISPLAY '******************************************'     05140000
051500         PERFORM 9999-ERROR-ROUTINE.                              05150000
051600                                                                  05160000
051640                                                                  05164002
051650*-------------------------------------------                      05165002
051700* LINK A CURSOR TO EACH RESULT SET                                05170000
051710*-------------------------------------------                      05171002
051800                                                                  05180000
051900     EXEC SQL ALLOCATE C1 CURSOR FOR RESULT SET :LOC1             05190000
052000     END-EXEC.                                                    05200000
052100                                                                  05210000
052200     IF SQLCODE = +0                                              05220000
052300         NEXT SENTENCE                                            05230000
052400     ELSE                                                         05240000
052500         SET ALLOCATE-C1-CSR-ERROR TO TRUE                        05250000
052600         DISPLAY '*****************************************'      05260000
052700         DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'      05270002
052800         DISPLAY '***                                   ***'      05280000
052900         DISPLAY '*** PARAGRAPH 2000-PROCESS-RESULT-SETS***'      05290002
053000         DISPLAY '*** ALLOCATE C1 CURSOR ERROR          ***'      05300000
053100         DISPLAY '*****************************************'      05310000
053200         PERFORM 9999-ERROR-ROUTINE.                              05320000
053300                                                                  05330000
053400                                                                  05340000
053500     EXEC SQL ALLOCATE C2 CURSOR FOR RESULT SET :LOC2             05350000
053600     END-EXEC.                                                    05360000
053700                                                                  05370000
053800     IF SQLCODE = +0                                              05380000
053900         NEXT SENTENCE                                            05390000
054000     ELSE                                                         05400000
054100         SET ALLOCATE-C2-CSR-ERROR TO TRUE                        05410000
054200         DISPLAY '*****************************************'      05420000
054300         DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'      05430002
054400         DISPLAY '***                                   ***'      05440000
054500         DISPLAY '*** PARAGRAPH 2000-PROCESS-RESULT-SETS***'      05450002
054600         DISPLAY '*** ALLOCATE C2 CURSOR ERROR          ***'      05460000
054700         DISPLAY '*****************************************'      05470000
054800         PERFORM 9999-ERROR-ROUTINE.                              05480000
054900                                                                  05490000
055000                                                                  05500000
055010*------------------------------------------------------------     05501002
055100* PERFORM C1 FETCHES TO RETRIEVE ALL ROWS FROM 1ST RESULT SET     05510000
055101*------------------------------------------------------------     05510102
055200                                                                  05520000
055300     MOVE 'N' TO WS-NO-MORE-C1-ROWS.                              05530000
055400     PERFORM 3000-FETCH-C1-ROWS THRU 3000-EXIT                    05540003
055500         UNTIL WS-NO-MORE-C1-ROWS = 'Y'.                          05550000
055600                                                                  05560000
055700     EXEC SQL CLOSE C1  END-EXEC.                                 05570000
055800                                                                  05580000
055900     IF SQLCODE = +0                                              05590000
056000         NEXT SENTENCE                                            05600000
056100     ELSE                                                         05610000
056200         SET CLOSE-C1-CSR-ERROR TO TRUE                           05620000
056300         DISPLAY '*****************************************'      05630000
056400         DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'      05640002
056500         DISPLAY '***                                   ***'      05650000
056600         DISPLAY '*** PARAGRAPH 2000-PROCESS-RESULT-SETS***'      05660002
056700         DISPLAY '*** CLOSE C1 CURSOR ERROR             ***'      05670000
056800         DISPLAY '*****************************************'      05680000
056900         PERFORM 9999-ERROR-ROUTINE.                              05690000
057000                                                                  05700000
057100                                                                  05710000
057200                                                                  05720000
057210*------------------------------------------------------------     05721002
057220* PERFORM C2 FETCHES TO RETRIEVE ALL ROWS FROM 2ND RESULT SET     05722002
057230*------------------------------------------------------------     05723002
057400                                                                  05740000
057500     MOVE 'N' TO WS-NO-MORE-C2-ROWS.                              05750000
057600     PERFORM 4000-FETCH-C2-ROWS THRU 4000-EXIT                    05760003
057700         UNTIL WS-NO-MORE-C2-ROWS = 'Y'.                          05770000
057800                                                                  05780000
057900     EXEC SQL CLOSE C2  END-EXEC.                                 05790000
058000                                                                  05800000
058100     IF SQLCODE = +0                                              05810000
058200         NEXT SENTENCE                                            05820000
058300     ELSE                                                         05830000
058400         SET CLOSE-C2-CSR-ERROR TO TRUE                           05840000
058500         DISPLAY '*****************************************'      05850000
058600         DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'      05860002
058700         DISPLAY '***                                   ***'      05870000
058800         DISPLAY '*** PARAGRAPH 2000-PROCESS-RESULT-SETS***'      05880002
058900         DISPLAY '*** CLOSE C2 CURSOR ERROR             ***'      05890000
059000         DISPLAY '*****************************************'      05900000
059100         PERFORM 9999-ERROR-ROUTINE.                              05910000
059200                                                                  05920000
059210 2000-EXIT.                                                       05921002
059220      EXIT.                                                       05922002
059230                                                                  05923002
059300                                                                  05930000
059400 3000-FETCH-C1-ROWS.                                              05940002
059500                                                                  05950000
059600     EXEC SQL                                                     05960000
059700         FETCH C1 INTO :RS1-SEQUENCE                              05970000
059800                        INDICATOR :RS1-SEQUENCE-NULLIND,          05980000
059900                       :RS1-DATA                                  05990000
060000                        INDICATOR :RS1-DATA-NULLIND               06000000
060100     END-EXEC.                                                    06010000
060200                                                                  06020000
060300     IF SQLCODE = +0                                              06030000
060400         PERFORM 3100-PROCESS-C1-ROW THRU 3100-EXIT               06040003
060500     ELSE                                                         06050000
060600         IF SQLCODE = +100                                        06060000
060700             MOVE 'Y' TO WS-NO-MORE-C1-ROWS                       06070000
060800         ELSE                                                     06080000
060900             SET C1-FETCH-ERROR TO TRUE                           06090000
061000             DISPLAY '*****************************************'  06100000
061100             DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'  06110002
061200             DISPLAY '***                                   ***'  06120000
061300             DISPLAY '*** PARAGRAPH 3000-FETCH-C1-ROWS      ***'  06130002
061400             DISPLAY '*** FETCH C1 ERROR                    ***'  06140000
061500             DISPLAY '*****************************************'  06150000
061600             PERFORM 9999-ERROR-ROUTINE.                          06160000
061700                                                                  06170000
061710 3000-EXIT.                                                       06171002
061720      EXIT.                                                       06172002
061730                                                                  06173002
061800                                                                  06180000
061900 3100-PROCESS-C1-ROW.                                             06190002
062000                                                                  06200000
062100     IF RS1-SEQUENCE-NULLIND < 0                                  06210000
062200         DISPLAY 'NULL RETURNED FOR RS1-SEQUENCE'                 06220000
062300     ELSE                                                         06230000
062400        DISPLAY 'RS1-SEQUENCE = ' RS1-SEQUENCE                    06240000
062500     END-IF.                                                      06250000
062600                                                                  06260000
062700     IF RS1-DATA-NULLIND < 0                                      06270000
062800         DISPLAY 'NULL RETURNED FOR RS1-DATA'                     06280000
062900     ELSE                                                         06290000
063000         DISPLAY 'RS1-DATA = ' RS1-DATA                           06300000
063100     END-IF.                                                      06310000
063200                                                                  06320000
063210 3100-EXIT.                                                       06321002
063220      EXIT.                                                       06322002
063230                                                                  06323002
063300                                                                  06330000
063400                                                                  06340000
063500 4000-FETCH-C2-ROWS.                                              06350002
063600                                                                  06360000
063700     MOVE SPACES TO RS2-DBNAME-TEXT.                              06370000
063800     MOVE SPACES TO RS2-NAME-TEXT.                                06380000
063900     MOVE SPACES TO RS2-INDEXSPACE-TEXT.                          06390000
064000     MOVE SPACES TO RS2-CREATOR-TEXT.                             06400000
064100     MOVE SPACES TO RS2-ASSOCIATEDTS-TEXT.                        06410000
064200                                                                  06420000
064300     EXEC SQL                                                     06430000
064400      FETCH C2 INTO                                               06440000
064500       :RS2-DBNAME,                                               06450000
064600       :RS2-NAME,                                                 06460000
064700       :RS2-PARTITION,                                            06470000
064800       :RS2-INSTANCE,                                             06480000
064900       :RS2-CLONE              :RS2-CLONE-NULLIND,                06490000
065000       :RS2-OBJECTTYPE,                                           06500000
065100       :RS2-INDEXSPACE         :RS2-INDEXSPACE-NULLIND,           06510000
065200       :RS2-CREATOR            :RS2-CREATOR-NULLIND,              06520000
065300       :RS2-OBJECTSTATUS       :RS2-OBJECTSTATUS-NULLIND,         06530000
065400       :RS2-IMAGECOPY          :RS2-IMAGECOPY-NULLIND,            06540000
065500       :RS2-RUNSTATS           :RS2-RUNSTATS-NULLIND,             06550000
065600       :RS2-EXTENTS            :RS2-EXTENTS-NULLIND,              06560000
065700       :RS2-REORG              :RS2-REORG-NULLIND,                06570000
065800       :RS2-INEXCEPTTABLE      :RS2-INEXCEPTTABLE-NULLIND,        06580000
065900       :RS2-ASSOCIATEDTS       :RS2-ASSOCIATEDTS-NULLIND,         06590000
066000       :RS2-COPYLASTTIME       :RS2-COPYLASTTIME-NULLIND,         06600000
066100       :RS2-LOADRLASTTIME      :RS2-LOADRLASTTIME-NULLIND,        06610000
066200       :RS2-REBUILDLASTTIME    :RS2-REBUILDLASTTIME-NULLIND,      06620000
066300       :RS2-CRUPDPGSPCT        :RS2-CRUPDPGSPCT-NULLIND,          06630000
066400       :RS2-CRUPDPGSABS        :RS2-CRUPDPGSABS-NULLIND,          06640000
066500       :RS2-CRCPYCHGPCT        :RS2-CRCPYCHGPCT-NULLIND,          06650000
066600       :RS2-CRDAYSCELSTCPY     :RS2-CRDAYSCELSTCPY-NULLIND,       06660000
066700       :RS2-CRINDEXSIZE        :RS2-CRINDEXSIZE-NULLIND,          06670000
066800       :RS2-REORGLASTTIME      :RS2-REORGLASTTIME-NULLIND,        06680000
066900       :RS2-RRTINSERTSPCT      :RS2-RRTINSERTSPCT-NULLIND,        06690000
067000       :RS2-RRTINSERTSABS      :RS2-RRTINSERTSABS-NULLIND,        06700000
067100       :RS2-RRTDELETESPCT      :RS2-RRTDELETESPCT-NULLIND,        06710000
067200       :RS2-RRTDELETESABS      :RS2-RRTDELETESABS-NULLIND,        06720000
067300       :RS2-RRTUNCINSPCT       :RS2-RRTUNCINSPCT-NULLIND,         06730000
067400       :RS2-RRTDISORGLOBPCT    :RS2-RRTDISORGLOBPCT-NULLIND,      06740000
067500       :RS2-RRTDATSPRAT        :RS2-RRTDATSPRAT-NULLIND,          06750000
067600       :RS2-RRTMASSDELETE      :RS2-RRTMASSDELETE-NULLIND,        06760000
067700       :RS2-INDREF             :RS2-INDREF-NULLIND,               06770000
067800       :RS2-RRIINSERTPCT       :RS2-RRIINSERTPCT-NULLIND,         06780000
067900       :RS2-RRIINSERTABS       :RS2-RRIINSERTABS-NULLIND,         06790000
068000       :RS2-RRIDELETESPCT      :RS2-RRIDELETESPCT-NULLIND,        06800000
068100       :RS2-RRIDELETABS        :RS2-RRIDELETABS-NULLIND,          06810000
068200       :RS2-RRIAPPINSPCT       :RS2-RRIAPPINSPCT-NULLIND,         06820000
068300       :RS2-RRIPSDDELPCT       :RS2-RRIPSDDELPCT-NULLIND,         06830000
068400       :RS2-RRIMASSDELETE      :RS2-RRIMASSDELETE-NULLIND,        06840000
068500       :RS2-RRILEAF            :RS2-RRILEAF-NULLIND,              06850000
068600       :RS2-RRINUMLEVELS       :RS2-RRINUMLEVELS-NULLIND,         06860000
068700       :RS2-STATSLASTTIME      :RS2-STATSLASTTIME-NULLIND,        06870000
068800       :RS2-SRTINSDELUPDPCT    :RS2-SRTINSDELUPDPCT-NULLIND,      06880000
068900       :RS2-SRTINSDELUPDABS    :RS2-SRTINSDELUPDABS-NULLIND,      06890000
069000       :RS2-SRTMASSDELETE      :RS2-SRTMASSDELETE-NULLIND,        06900000
069100       :RS2-SRIINSDELPCT       :RS2-SRIINSDELPCT-NULLIND,         06910000
069200       :RS2-SRIINSDELABS       :RS2-SRIINSDELABS-NULLIND,         06920000
069300       :RS2-SRIMASSDELETE      :RS2-SRIMASSDELETE-NULLIND,        06930000
069400       :RS2-TOTALEXTENTS       :RS2-TOTALEXTENTS-NULLIND,         06940000
069500       :RS2-RRIEMPTYLIMIT      :RS2-RRIEMPTYLIMIT-NULLIND,        06950000
069600       :RS2-RRTHASHOVRFLWRAT   :RS2-RRTHASHOVRFLWRAT-NULLIND      06960000
069700     END-EXEC.                                                    06970000
069800                                                                  06980000
069900     IF SQLCODE = +0                                              06990000
070000         PERFORM 4100-PROCESS-C2-ROW THRU 4100-EXIT               07000003
070100     ELSE                                                         07010000
070200         IF SQLCODE = +100                                        07020000
070300             MOVE 'Y' TO WS-NO-MORE-C2-ROWS                       07030000
070400         ELSE                                                     07040000
070500             SET C2-FETCH-ERROR TO TRUE                           07050000
070600             DISPLAY '*****************************************'  07060000
070700             DISPLAY '*** PROGRAM ERROR - DBKUT200          ***'  07070002
070800             DISPLAY '***                                   ***'  07080000
070900             DISPLAY '*** PARAGRAPH 4000-FETCH-C2-ROWS      ***'  07090002
071000             DISPLAY '*** FETCH C2 ERROR                    ***'  07100000
071100             DISPLAY '*****************************************'  07110000
071200             PERFORM 9999-ERROR-ROUTINE.                          07120000
071300                                                                  07130000
071310 4000-EXIT.                                                       07131002
071320      EXIT.                                                       07132002
071330                                                                  07133002
071400                                                                  07140000
071500 4100-PROCESS-C2-ROW.                                             07150002
071600                                                                  07160000
071610     MOVE SPACES TO WS-RESTRICTED-REC-LINE.                       07161003
071700                                                                  07170003
071810     MOVE RS2-DBNAME-TEXT TO WS-OUT-DBNAME.                       07181003
071910     MOVE RS2-NAME-TEXT   TO WS-OUT-NAME.                         07191003
072010     MOVE RS2-PARTITION   TO WS-OUT-PARTITION.                    07201003
072110     MOVE RS2-OBJECTTYPE  TO WS-OUT-OBJECTTYPE.                   07211003
073400                                                                  07340000
073500     IF RS2-OBJECTSTATUS-NULLIND < 0                              07350000
073510         DISPLAY ' '                                              07351003
073600         DISPLAY 'NULL RETURNED FOR OBJECTSTATUS'                 07360000
073610         DISPLAY 'DATABASE = ' RS2-DBNAME-TEXT                    07361003
073620         DISPLAY 'NAME     = ' RS2-NAME-TEXT                      07362003
073630         DISPLAY ' '                                              07363003
073700     ELSE                                                         07370000
073800         MOVE RS2-OBJECTSTATUS TO WS-OUT-OBJECTSTATUS             07380003
073810         WRITE RESTRICTED-OBJECTS-RECORD                          07381003
073820           FROM WS-RESTRICTED-REC-LINE                            07382003
073900     END-IF.                                                      07390000
074000                                                                  07400000
074300                                                                  07430000
074310 4100-EXIT.                                                       07431002
074320      EXIT.                                                       07432002
074330                                                                  07433002
074400                                                                  07440000
074500 9999-ERROR-ROUTINE.                                              07450000
074600                                                                  07460000
074700     CALL 'DSNTIAR' USING SQLCA                                   07470000
074800                          DP004-FORMATTED-MESSAGE                 07480000
074900                          DP004-ERROR-LINE-LENGTH.                07490000
075000                                                                  07500000
075100     DISPLAY DP004-ASTERISK-LINE.                                 07510000
075200                                                                  07520000
075300     PERFORM                                                      07530000
075400         VARYING DP004-MSG-IDX                                    07540000
075500         FROM 1 BY 1                                              07550000
075600         UNTIL DP004-MSG-IDX > DP004-MAX-MESSAGE-LINES            07560000
075700             DISPLAY '**'                                         07570000
075800                     DP004-MESSAGE-LINE (DP004-MSG-IDX)           07580000
075900                     ' **'                                        07590000
076000             END-PERFORM.                                         07600000
076100                                                                  07610000
076200     DISPLAY DP004-ASTERISK-LINE.                                 07620000
076300     CALL 'ILBOABN0' USING WS-ABEND-CODE.                         07630000
076400                                                                  07640000
076500                                                                  07650000
