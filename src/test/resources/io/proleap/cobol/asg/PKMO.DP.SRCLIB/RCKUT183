000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.    RCKUT183.                                         00050001
000600 AUTHOR.        DENISE HAHN                                       00060001
000700 INSTALLATION.  KOHLS.                                            00070001
000800 DATE-WRITTEN   JULY, 2021.                                       00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200* THIS PROGRAM RECEIVES A SORTED FILE (SSCC SEQUENCE) FROM        00120001
001300* RCKUT181.  THIS FILE CONTAINS CARTONS FROM RETAIL DC ASN'S FOR  00130001
001400* BULK PO'S.                                                      00140001
001401*                                                                 00140101
001402* THE PROGRAM RECEIVES IN A CONTROL CARD INDICATE IS WE ARE       00140201
001403* CREATING A NEW ASN FOR A SINGLE SKU ASN.  OR IF WE ARE CREATING 00140301
001404* A NEW ASN FOR A MULTIP SKU ASN.                                 00140401
001405*                                                                 00140501
001410* THIS PROGRAM WILL CREATE THE NEW ASN IN REVERSE ORDER.          00141001
001420*   - CASES                                                       00142001
001430*   - CASE DETAIL - PO-LINE                                       00143001
001431*   - ASN HEADER                                                  00143101
001440*                                                                 00144001
001450*  IF WE ARE PROCESSING FOR MULTI SKU                             00145001
001460*     - FREIGHT BILL (PRO) WILL BE 'MULTISKU'                     00146001
001470*     - STORE NUMBER WILL BE 9999                                 00147001
001480*     - WILL GENERATE AN OUTPUT FILE TO BE USED FOR REPORT        00148001
001490*     - WILL GENERATE AN OUTPUT FILE TO BE USED TO SEND DATA      00149001
001491*       TO THE SKU SORT APPLICATION.                              00149101
001510******************************************************************00151001
001600                                                                  00160001
001700******************************************************************00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900******************************************************************00190001
002000                                                                  00200001
002100 CONFIGURATION SECTION.                                           00210001
002200                                                                  00220001
002300 SOURCE-COMPUTER.        IBM-3090.                                00230001
002400 OBJECT-COMPUTER.        IBM-3090.                                00240001
002500                                                                  00250001
002600 INPUT-OUTPUT SECTION.                                            00260001
002700                                                                  00270001
002800 FILE-CONTROL.                                                    00280001
002900                                                                  00290001
002910     SELECT INPUT-FILE                                            00291001
002920        ASSIGN TO INP01.                                          00292001
002930                                                                  00293001
002931     SELECT CONTROL-CARD-FILE                                     00293108
002932         ASSIGN TO INP02.                                         00293201
002933                                                                  00293301
002940     SELECT  ASN-OUTPUT-FILE                                      00294003
002950        ASSIGN TO OUT01.                                          00295001
002960                                                                  00296001
002970     SELECT  ASN-MULTI-SKU-RPT-FILE                               00297003
002980        ASSIGN TO OUT02.                                          00298001
002990                                                                  00299001
003000     SELECT  ASN-SKU-SORT-FILE                                    00300003
003100        ASSIGN TO OUT03.                                          00310003
003200                                                                  00320003
003300                                                                  00330001
003400******************************************************************00340001
003500 DATA DIVISION.                                                   00350001
003600******************************************************************00360001
003700                                                                  00370001
003800 FILE SECTION.                                                    00380001
003900                                                                  00390001
004000                                                                  00400001
004100 FD  INPUT-FILE                                                   00410001
004200     LABEL RECORDS ARE STANDARD                                   00420001
004300     RECORDING MODE IS F                                          00430001
004400     BLOCK CONTAINS 0 RECORDS                                     00440001
004500     RECORD CONTAINS 1100 CHARACTERS.                             00450062
004600                                                                  00460001
004610 01  ASN-INPUT-RECORD            PIC  X(1100).                    00461062
004620                                                                  00462001
004630                                                                  00463001
004632 FD  CONTROL-CARD-FILE                                            00463202
004633     RECORDING MODE IS F                                          00463301
004634     LABEL RECORDS ARE STANDARD                                   00463401
004635     BLOCK CONTAINS 0 RECORDS.                                    00463501
004636 01  CONTROL-CARD-RECORD             PIC  X(80).                  00463602
004637                                                                  00463701
004638                                                                  00463801
004640 FD  ASN-OUTPUT-FILE                                              00464003
004650     LABEL RECORDS ARE STANDARD                                   00465001
004660     RECORDING MODE IS F                                          00466001
004670     BLOCK CONTAINS 0 RECORDS                                     00467001
004680     RECORD CONTAINS 600 CHARACTERS.                              00468022
004690                                                                  00469001
004691 01  ASN-OUTPUT-FILE-RECORD      PIC  X(600).                     00469103
004693                                                                  00469301
004694                                                                  00469401
004695 FD  ASN-MULTI-SKU-RPT-FILE                                       00469503
004696     RECORDING MODE IS F                                          00469601
004697     LABEL RECORDS ARE STANDARD                                   00469701
004698     RECORD CONTAINS 1100 CHARACTERS.                             00469862
004700                                                                  00470001
004701 01  ASN-MULTI-SKU-RPT-RECORD   PIC  X(1100).                     00470162
004702                                                                  00470201
004703                                                                  00470301
004704 FD  ASN-SKU-SORT-FILE                                            00470403
004705     RECORDING MODE IS F                                          00470503
004706     LABEL RECORDS ARE STANDARD                                   00470603
004707     RECORD CONTAINS 100 CHARACTERS.                              00470711
004708                                                                  00470803
004709 01  ASN-SKU-SORT-RECORD        PIC  X(100).                      00470911
004710                                                                  00471003
004711                                                                  00471103
004720                                                                  00472001
004800******************************************************************00480001
004900 WORKING-STORAGE SECTION.                                         00490001
005000******************************************************************00500001
005100*-----------------------------------------------------------------00510001
005200*                                                                 00520001
005300*-----------------------------------------------------------------00530001
005400 01  ABEND-CODE                     PIC S9(04) VALUE +0           00540001
005500                                               COMP SYNC.         00550001
005600                                                                  00560001
005610*-----------------------------------------------------------------00561001
005620*  CONTROL CARD                                                   00562002
005630*-----------------------------------------------------------------00563001
005640 01  CC-CONTROL-CARD.                                             00564002
005641     05  CC-PROCESS-SW              PIC  X(01).                   00564102
005642         88  CC-MULTI-SKU                      VALUE 'M'.         00564202
005643         88  CC-SINGLE-SKU                     VALUE 'S'.         00564302
005644     05  FILLER                     PIC  X(79).                   00564401
005650                                                                  00565001
005703                                                                  00570301
005710*-----------------------------------------------------------------00571001
005800* PROGRAM CONSTANTS                                               00580001
005900*-----------------------------------------------------------------00590001
006000 01  PC-PROGRAM-CONSTANTS.                                        00600001
006100     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08) VALUE              00610001
006200         'RCKUT183'.                                              00620001
006400                                                                  00640001
006500*-----------------------------------------------------------------00650001
006600* PROGRAM SWITCHES                                                00660001
006700*-----------------------------------------------------------------00670001
006800 01  PS-PROGRAM-SWITCHES.                                         00680001
006900     05  PS-END-OF-FILE-SW          PIC  X(01) VALUE 'N'.         00690001
007000         88  PS-END-OF-FILE                    VALUE 'Y'.         00700001
007100         88  PS-END-OF-FILE-NO                 VALUE 'N'.         00710001
007200     05  PS-ERROR-SW                PIC  X(01) VALUE 'N'.         00720001
007300         88  PS-ERROR                          VALUE 'Y'.         00730001
007400         88  PS-ERROR-NO                       VALUE 'N'.         00740001
007500     05  PS-ASN-HAS-SSCC-SW         PIC  X(01) VALUE 'Y'.         00750078
007600         88  PS-ASN-HAS-SSCC                   VALUE 'Y'.         00760078
007700         88  PS-ASN-HAS-SSCC-NO                VALUE 'N'.         00770078
008400                                                                  00840001
008500*-----------------------------------------------------------------00850001
008600* PROGRAM VARIABLES                                               00860001
008700*-----------------------------------------------------------------00870001
008800                                                                  00880001
008900 01  PV-PROGRAM-VARIABLES.                                        00890001
009000     05  PV-READ-COUNT              PIC  9(09)  VALUE ZEROS.      00900001
009010     05  PV-OUT-HDR-REC-CNT         PIC  9(09)  VALUE ZEROS.      00901003
009020     05  PV-OUT-DTL-REC-CNT         PIC  9(09)  VALUE ZEROS.      00902003
009030     05  PV-OUT-CRTN-REC-CNT        PIC  9(09)  VALUE ZEROS.      00903003
009031     05  PV-OUT-ASN-CRTN-REC-CNT    PIC  9(09)  VALUE ZEROS.      00903198
009032     05  PV-IN-CRTN-REC-PROCESS-CNT PIC  9(09)  VALUE ZEROS.      00903298
009040                                                                  00904003
009050     05  PV-ASN-HDR-CART-CNT        PIC  9(09)  VALUE ZEROS.      00905006
009060     05  PV-ASN-HDR-CART-UNT-QTY    PIC  9(09)  VALUE ZEROS.      00906006
009061     05  PV-ASN-DTL-CART-CNT        PIC  9(09)  VALUE ZEROS.      00906106
009062     05  PV-ASN-DTL-CART-UNT-QTY    PIC  9(09)  VALUE ZEROS.      00906206
009070                                                                  00907003
009400     05  PV-ASN-DTL-NO-SSCC-CNT     PIC  9(09)  VALUE ZEROS.      00940079
009401     05  PV-OUT01-COUNT             PIC  9(09)  VALUE ZEROS.      00940179
009410     05  PV-OUT02-COUNT             PIC  9(09)  VALUE ZEROS.      00941001
009411     05  PV-OUT03-COUNT             PIC  9(09)  VALUE ZEROS.      00941101
009413                                                                  00941301
009414     05  PV-ASN-SSCC-COUNT          PIC  9(09)  VALUE ZEROS.      00941401
009415                                                                  00941501
009416     05  PV-VENDOR-PO               PIC  9(09)  VALUE ZEROS.      00941619
009417     05  PV-DEPT                    PIC  X(03)  VALUE SPACES.     00941777
009418     05  PV-DEPT-R REDEFINES PV-DEPT.                             00941877
009419         10  PV-DEPT-NBR            PIC  9(03).                   00941977
009420     05  PV-PO-SEQ                  PIC  9(04)  VALUE ZEROS.      00942077
009421                                                                  00942177
009422     05  PV-DISP-ASN-CRTN-SUB       PIC  ZZZZ.                    00942289
009423     05  PV-DISP-SUB                PIC  ZZZZ.                    00942389
009424     05  PV-DISP-SUB-2              PIC  ZZZZ.                    00942489
009425     05  PV-DISP-SSCC               PIC  Z(18).                   00942589
009426     05  PV-DISP-SQLCODE            PIC -ZZZ.                     00942689
009427     05  PV-DISP-COUNT              PIC  ZZZ,ZZZ,ZZ9              00942789
009428                                                VALUE ZEROS.      00942889
009430     05  PV-CRTN-SEQ                PIC  9(09)  VALUE ZEROS.      00943009
009431     05  PV-SEQ-NBR                 PIC  9(09)  VALUE ZEROS.      00943109
009440     05  PV-SUB                         PIC S9(04)  VALUE +0      00944008
009450                                                    COMP SYNC.    00945008
009460     05  PV-SUB2                        PIC S9(04)  VALUE +0      00946008
009470                                                    COMP SYNC.    00947008
009471     05  PV-SUB3                        PIC S9(04)  VALUE +0      00947154
009472                                                    COMP SYNC.    00947254
009473     05  PV-ASN-CRTN-SUB                PIC S9(04)  VALUE +0      00947332
009474                                                    COMP SYNC.    00947432
009480                                                                  00948013
009490     05  PV-PARAGRAPH-NAME          PIC  X(30) VALUE SPACES.      00949013
009491     05  PV-DB2-OPERATION-ATTEMPTED PIC  X(30) VALUE SPACES.      00949113
009492     05  PV-PO-INSTR-1              PIC  X(150) VALUE SPACES.     00949214
009493     05  PV-PO-INSTR-1-R REDEFINES PV-PO-INSTR-1.                 00949314
009494         10  FILLER                 PIC  X(12).                   00949414
009495         10  PV-PO-INSTR-VND-PO     PIC  9(09).                   00949514
009496         10  FILLER                 PIC  X(129).                  00949614
009497     05  PV-PO-INSTR-2              PIC  X(150) VALUE SPACES.     00949714
009498     05  PV-PO-INSTR-2-R REDEFINES PV-PO-INSTR-2.                 00949814
009500         10  PV-PO-INSTR-OPER       PIC  9(04).                   00950014
009501         10  FILLER                 PIC  X(146).                  00950114
009502*                                                                 00950201
009503*  SV - SAVED RECORD                                              00950301
009509 01  SV-ASN-TRANSCRIPTION-RECORD.                                 00950905
009510     05  SV-ASN-TRANSCRIPTION-KEY.                                00951005
009511         10  SV-OPERATING-COMPANY     PIC  X(02)  VALUE SPACES.   00951105
009513         10  SV-DIST-CNTR             PIC  9(04)  VALUE ZEROES.   00951305
009514         10  SV-EDI-VEND-ID           PIC  9(09)  VALUE ZEROS.    00951405
009515         10  SV-CARRIER-SCAC-CODE     PIC  X(04)  VALUE SPACES.   00951505
009517         10  SV-BILL-OF-LADING-NBR    PIC  X(30)  VALUE SPACES.   00951705
009519         10  SV-PO-NBR                PIC  9(09)  VALUE ZEROS.    00951905
009520         10  SV-STORE-NBR             PIC  9(04)  VALUE ZEROS.    00952005
009521         10  SV-PO-LINE-NBR           PIC  X(04)  VALUE SPACES.   00952105
009525         10  SV-SEQUENCE-NBR          PIC  9(07)  VALUE ZEROS.    00952505
009526         10  SV-CARTON-IND            PIC  X(01)  VALUE SPACES.   00952605
009529*                                                                 00952905
009530     05  SV-ASN-COMMON-FIELDS-LAYOUT.                             00953005
009531         10  SV-ASNHDR-NBR            PIC  X(30)  VALUE SPACES.   00953105
009532         10  SV-EDI-VEND-NAME         PIC  X(25)  VALUE SPACES.   00953205
009533         10  SV-ORIG-BOL-NBR          PIC  X(30)  VALUE SPACES.   00953305
009534         10  SV-SEQ-NBR-IND           PIC  X(01)  VALUE SPACES.   00953405
009537                                                                  00953705
009538     05  FILLER                       PIC  X(02)  VALUE SPACES.   00953805
009539*                                                                 00953905
009540     05  SV-HEADER-LAYOUT.                                        00954005
009541         10  SV-DEPT-NBR              PIC  9(03).                 00954105
009542         10  SV-DEPT-DESC             PIC  X(25).                 00954205
009543         10  SV-BUYER-NBR             PIC  9(03).                 00954305
009544         10  SV-BUYER-NAME            PIC  X(32).                 00954405
009545         10  SV-ANALYST-NAME          PIC  X(32).                 00954505
009546         10  SV-DATE-SHIPPED          PIC  9(08).                 00954605
009547         10  SV-PO-DATE               PIC  9(06).                 00954705
009548         10  SV-REQ-SHIP-DATE         PIC  9(06).                 00954805
009549         10  SV-CANCEL-DATE           PIC  9(06).                 00954905
009550         10  SV-CANCEL-EXT-DATE       PIC  9(06).                 00955005
009551         10  SV-AD-DATE               PIC  9(06).                 00955105
009552         10  SV-CARR-VEND-ID          PIC S9(09)    COMP-3.       00955205
009553         10  SV-CARRIER-NAME          PIC  X(35).                 00955305
009554         10  SV-PRO-NBR               PIC  X(30).                 00955405
009555         10  SV-TRAILER-NBR           PIC  X(15).                 00955505
009556         10  SV-SHIPMENT-WEIGHT       PIC S9(09)    COMP-3.       00955605
009557         10  SV-SHIP-WEIGHT-UM        PIC  X(02).                 00955705
009558         10  SV-CARTON-CNT-STORE      PIC S9(09)    COMP-3.       00955805
009559         10  SV-CARTON-CNT-PO         PIC S9(09)    COMP-3.       00955905
009560         10  SV-CARTON-CNT-SHPMT      PIC S9(09)    COMP-3.       00956005
009561         10  SV-SPECIAL-INSTR-1       PIC  X(25).                 00956105
009562         10  SV-SPECIAL-INSTR-2       PIC  X(25).                 00956205
009563         10  SV-SPECIAL-INSTR-3       PIC  X(25).                 00956305
009564         10  FILLER                   PIC  X(02).                 00956405
009565         10  SV-ASNORD-EARLY-LTE-CDE  PIC  X(01).                 00956505
009569         10  SV-ASNORD-MTCH-PO-CDE    PIC  X(01).                 00956905
009573         10  SV-VENDOR-TRSCP-IND      PIC  X(01).                 00957305
009577         10  SV-LINE-ERROR-IND        PIC  X(01).                 00957705
009578         10  SV-CONT-NBR              PIC  X(12).                 00957805
009579         10  SV-ISA-NBR               PIC S9(9) COMP-3.           00957905
009580         10  SV-MAN-SEG-IND           PIC  X(01).                 00958005
009581         10  SV-CARR-AUTH-ID          PIC  X(30).                 00958105
009582         10  SV-HDR-FILLER            PIC  X(31).                 00958205
009583*                                                                 00958305
009584     05  FILLER                       PIC  X(02)  VALUE SPACES.   00958405
009585*                                                                 00958505
009586     05  SV-DETAIL-LAYOUT.                                        00958605
009587         10  SV-SKU-DEPT-NBR          PIC  X(03).                 00958705
009588         10  SV-SKU-CLASS-NBR         PIC  X(02).                 00958805
009589         10  SV-SKU-SEQ-NBR           PIC  X(03).                 00958905
009590         10  SV-DIST-PACK-QTY         PIC S9(05)    COMP-3.       00959005
009591         10  SV-UPC-NBR               PIC S9(15)    COMP-3.       00959105
009592         10  SV-UPC-DESC              PIC  X(25).                 00959205
009593         10  SV-VENDOR-STYLE          PIC  X(15).                 00959305
009594         10  SV-SIZE                  PIC  X(10).                 00959405
009595         10  SV-COLOR                 PIC  X(10).                 00959505
009596         10  SV-UNIT-COST             PIC S9(06)V99 COMP-3.       00959605
009597         10  SV-UNIT-RETAIL           PIC S9(06)V99 COMP-3.       00959705
009598         10  SV-QTY-ORDERED           PIC S9(07)    COMP-3.       00959805
009599         10  SV-QTY-ORDERED-UM        PIC  X(03).                 00959905
009600         10  SV-QTY-SHIPPED           PIC S9(07)    COMP-3.       00960005
009601         10  SV-QTY-SHIPPED-UM        PIC  X(03).                 00960105
009602         10  SV-QTY-SHIPPED-VAR       PIC S9(07)    COMP-3.       00960205
009603         10  SV-PR-CHG-EFF-DAYS       PIC S9(03)    COMP-3.       00960305
009604         10  SV-ASDTPL-ALLOC-IND      PIC  X(01).                 00960405
009605         10  SV-ASDTPL-MATCH-IND      PIC  X(01).                 00960505
009608         10  SV-ASDTPL-PR-DISC-IND    PIC  X(01).                 00960805
009612         10  SV-ASDTPL-PR-VAR-IND     PIC  X(01).                 00961205
009616         10  SV-SKU-NBR               PIC  X(08).                 00961605
009617         10  SV-DTL-FILLER            PIC  X(279).                00961705
009618*                                                                 00961805
009619     05  FILLER                       PIC  X(02)    VALUE SPACES. 00961905
009620*                                                                 00962005
009621     05  SV-DETAIL-CARTON-LAYOUT.                                 00962106
009622             15  SV-CARTON-NBR        PIC  9(18).                 00962260
009623             15  SV-CARTON-QTY        PIC S9(09)  COMP-3.         00962305
009624             15  SV-CTN-UPC           PIC S9(15)  COMP-3.         00962405
009625             15  SV-CARTON-FIL        PIC  X(07).                 00962505
009626*                                                                 00962605
009627     05  FILLER                       PIC  X(04)    VALUE SPACES. 00962705
010160*                                                                 01016001
010170 01  CT-CARTON-TABLE-LAYOUT.                                      01017006
010190     10  CT-CARTON-TABLE OCCURS 10 TIMES.                         01019006
010200         15  CT-CARTON-NBR   PIC  9(18).                          01020059
010300         15  CT-CARTON-QTY   PIC S9(09)  COMP-3.                  01030006
010400         15  CT-CTN-UPC      PIC S9(15)  COMP-3.                  01040006
010500         15  CT-CARTON-FIL   PIC  X(07).                          01050006
010600     10  CT-CARTON-FILLER    PIC  X(100).                         01060006
010700*                                                                 01070006
011160*-----------------------------------------------------------------01116001
011170*  INPUT LAYOUT                                                   01117001
011180*-----------------------------------------------------------------01118001
011190     COPY RCRD109.                                                01119001
011200                                                                  01120001
011300*-----------------------------------------------------------------01130001
011400*  ASN - OUTPUT LAYOUT                                            01140001
011500*-----------------------------------------------------------------01150001
011600     COPY RCRD001.                                                01160001
011700                                                                  01170001
012300*-----------------------------------------------------------------01230003
012400*  ASN SKU SORT FILE LAYOUT                                       01240003
012500*-----------------------------------------------------------------01250003
012600     COPY RCRD103.                                                01260064
012700                                                                  01270003
012800*-----------------------------------------------------------------01280013
012900*  DB2 FORMATTED MESSAGE AREA                                     01290013
013000*-----------------------------------------------------------------01300013
013100     COPY DPWS004.                                                01310013
013200                                                                  01320013
013210*-----------------------------------------------------------------01321013
013220*  PO INSTRUCTION                                                 01322013
013230*-----------------------------------------------------------------01323013
013240     EXEC SQL                                                     01324013
013250          INCLUDE TPOINST                                         01325013
013260     END-EXEC.                                                    01326013
013270                                                                  01327013
013280*-----------------------------------------------------------------01328013
013290*  PO INSTRUCTION CODE                                            01329013
013291*-----------------------------------------------------------------01329113
013292     EXEC SQL                                                     01329213
013293          INCLUDE TINSTCD                                         01329313
013294     END-EXEC.                                                    01329413
013295                                                                  01329513
013296*-----------------------------------------------------------------01329613
013297*  PURCHASE ORDER                                                 01329713
013298*-----------------------------------------------------------------01329813
013299     EXEC SQL                                                     01329913
013300          INCLUDE TPURCHS                                         01330013
013301     END-EXEC.                                                    01330113
013302                                                                  01330213
013310*-----------------------------------------------------------------01331013
013400*  COMMUNICATIONS AREA FOR DB2                                    01340013
013500*-----------------------------------------------------------------01350013
013600     EXEC SQL                                                     01360013
013700          INCLUDE SQLCA                                           01370013
013800     END-EXEC.                                                    01380013
013900                                                                  01390013
014000                                                                  01400013
028300******************************************************************02830001
028400 PROCEDURE DIVISION.                                              02840001
028500******************************************************************02850001
028600                                                                  02860001
028700                                                                  02870001
028800*-----------------------------------------------------------------02880001
028900* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     02890001
029000*      PROGRAM.                                                   02900001
029100*-----------------------------------------------------------------02910001
029200 0000-PROGRAM-MAINLINE.                                           02920001
029300                                                                  02930001
029400     DISPLAY ' '.                                                 02940001
029500     DISPLAY ' RCKUT183 - START'                                  02950001
029600     DISPLAY ' '.                                                 02960001
029700                                                                  02970001
029800     SET PS-END-OF-FILE-NO  TO  TRUE.                             02980009
029900                                                                  02990001
030000     OPEN INPUT  INPUT-FILE                                       03000001
030010          INPUT  CONTROL-CARD-FILE                                03001002
030040          OUTPUT ASN-OUTPUT-FILE                                  03004003
030070          OUTPUT ASN-MULTI-SKU-RPT-FILE                           03007003
030080          OUTPUT ASN-SKU-SORT-FILE                                03008003
030100                                                                  03010001
030110     PERFORM 8010-READ-CONTROL-REC.                               03011001
030200     PERFORM 8000-READ-INPUT.                                     03020001
030201                                                                  03020103
030202     IF  NOT PS-END-OF-FILE                                       03020230
030206         MOVE  RC109-ASN-TRANSCRIPTION-RECORD                     03020631
030207           TO  SV-ASN-TRANSCRIPTION-RECORD                        03020731
030208         MOVE  RC109-PRO-NBR                                      03020871
030209           TO  SV-PRO-NBR                                         03020971
030213     END-IF.                                                      03021330
030220                                                                  03022030
030600     IF  PS-END-OF-FILE                                           03060030
030700         DISPLAY '*                                            *' 03070030
030800         DISPLAY '* NO RDC-BULK ASN TO PROCESS - EMPTY FILE    *' 03080030
030900         DISPLAY '*                                            *' 03090030
031000     ELSE                                                         03100001
031020         MOVE  1  TO  PV-SEQ-NBR                                  03102006
031100         PERFORM 2000-PROCESS-FILE                                03110001
031200             UNTIL PS-END-OF-FILE                                 03120001
031300                OR PS-ERROR                                       03130001
031310         IF  PV-ASN-CRTN-SUB  > 0                                 03131034
031311             PERFORM 6000-BUILD-ASN-CARTON                        03131134
031314             PERFORM 6100-BUILD-ASN-DETAIL                        03131434
031315             PERFORM 6200-BUILD-ASN-HEADER                        03131534
031316         ELSE                                                     03131678
031317             IF  PV-OUT-CRTN-REC-CNT > 0                          03131798
031318                 PERFORM 6100-BUILD-ASN-DETAIL                    03131898
031319                 PERFORM 6200-BUILD-ASN-HEADER                    03131998
031320             ELSE                                                 03132098
031321                 IF  PS-ASN-HAS-SSCC-NO                           03132198
031322                     PERFORM 6100-BUILD-ASN-DETAIL                03132298
031323                     PERFORM 6200-BUILD-ASN-HEADER                03132398
031330                     DISPLAY 'NO SSCC: '                          03133098
031340                             RC001-ASN-TRANSCRIPTION-KEY          03134098
031350                 END-IF                                           03135098
031400             END-IF                                               03140078
031401         END-IF                                                   03140178
031410     END-IF.                                                      03141034
031500*                                                                 03150003
031517     CLOSE INPUT-FILE                                             03151701
031518           CONTROL-CARD-FILE                                      03151802
031520           ASN-OUTPUT-FILE                                        03152003
031530           ASN-MULTI-SKU-RPT-FILE                                 03153003
031540           ASN-SKU-SORT-FILE.                                     03154003
031700                                                                  03170001
031800     DISPLAY ' '                                                  03180001
031900     MOVE PV-READ-COUNT           TO  PV-DISP-COUNT               03190001
032000     DISPLAY ' RECORDS READ:    '     PV-DISP-COUNT               03200001
032010     DISPLAY ' '                                                  03201001
032100                                                                  03210001
032110     DISPLAY ' NEW ASN - BREAKDOWN'                               03211037
032200     MOVE PV-OUT-HDR-REC-CNT      TO  PV-DISP-COUNT               03220003
032300     DISPLAY ' ASN HEADER RECORDS WRITTEN:  '     PV-DISP-COUNT   03230098
032500                                                                  03250001
032600     MOVE PV-OUT-DTL-REC-CNT      TO PV-DISP-COUNT                03260003
032700     DISPLAY ' ASN DETAIL RECORDS WRITTEN:  '    PV-DISP-COUNT    03270098
032900                                                                  03290001
032910     MOVE PV-OUT-ASN-CRTN-REC-CNT TO PV-DISP-COUNT                03291098
032920     DISPLAY ' ASN CARTON RECORDS WRITTEN:  '    PV-DISP-COUNT    03292098
032930     DISPLAY ' '                                                  03293001
032940                                                                  03294001
032990     MOVE PV-OUT01-COUNT          TO PV-DISP-COUNT                03299003
032991     DISPLAY ' OUT01 - ASN RECORDS WRITTEN: '    PV-DISP-COUNT    03299198
032992     MOVE PV-ASN-DTL-NO-SSCC-CNT  TO PV-DISP-COUNT                03299279
032993     DISPLAY ' ASN DTL NO SSCC            : '    PV-DISP-COUNT    03299398
032994     DISPLAY ' '                                                  03299479
032995                                                                  03299579
032996     MOVE PV-OUT02-COUNT          TO PV-DISP-COUNT                03299679
032997     DISPLAY ' OUT02 - RPT REC: '    PV-DISP-COUNT                03299779
032998                                                                  03299879
032999     MOVE PV-OUT03-COUNT          TO PV-DISP-COUNT                03299979
033000     DISPLAY ' OUT03 - SKU SORT:'    PV-DISP-COUNT                03300079
033001     DISPLAY ' '                                                  03300179
033002                                                                  03300279
033003     MOVE PV-IN-CRTN-REC-PROCESS-CNT TO PV-DISP-COUNT             03300398
033004     DISPLAY ' TOTAL INPUT ACTUAL CARTON RECORDS PROCESSED: '     03300499
033005             PV-DISP-COUNT                                        03300598
033006     DISPLAY ' '                                                  03300698
033007                                                                  03300798
033010     DISPLAY ' RCKUT183 - END'.                                   03301001
033100     DISPLAY ' '.                                                 03310001
033200                                                                  03320001
033300     STOP RUN.                                                    03330001
033400                                                                  03340001
033500                                                                  03350001
033600*-----------------------------------------------------------------03360001
033700*  PROCESS ASN INPUT FILE                                         03370001
033800*-----------------------------------------------------------------03380001
033900 2000-PROCESS-FILE.                                               03390001
034000*** TEST ONLY                                                     03400089
034001***                                                               03400196
034002***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              03400296
034003***  DISPLAY ' 2000-PROCESS-FILE          ' PV-DISP-ASN-CRTN-SUB  03400396
034004***          '   PV-OUT-CRTN-REC-CNT: '     PV-OUT-CRTN-REC-CNT   03400496
034005***  DISPLAY '                            '                       03400596
034006***  DISPLAY RC109-OPERATING-COMPANY  ' VS ' SV-OPERATING-COMPANY 03400696
034007***  DISPLAY RC109-DIST-CNTR          ' VS ' SV-DIST-CNTR         03400796
034008***  DISPLAY RC109-EDI-VEND-ID        ' VS ' SV-EDI-VEND-ID       03400896
034009***  DISPLAY RC109-CARRIER-SCAC-CODE  ' VS ' SV-CARRIER-SCAC-CODE 03400996
034010***  DISPLAY RC109-BILL-OF-LADING-NBR ' VS ' SV-BILL-OF-LADING-NBR03401096
034011***  DISPLAY RC109-ASNHDR-NBR         ' VS ' SV-ASNHDR-NBR        03401196
034012***  DISPLAY RC109-PO-NBR             ' VS ' SV-PO-NBR            03401296
034013***  DISPLAY RC109-STORE-NBR          ' VS ' SV-STORE-NBR         03401396
034014***  DISPLAY '                            '.                      03401496
034015*** TEST ONLY                                                     03401594
034016*                                                                 03401694
034017*** SAME HEADER                                                   03401794
034018*                                                                 03401894
034019     IF  RC109-OPERATING-COMPANY   =  SV-OPERATING-COMPANY  AND   03401994
034020         RC109-DIST-CNTR           =  SV-DIST-CNTR          AND   03402094
034021         RC109-EDI-VEND-ID         =  SV-EDI-VEND-ID        AND   03402194
034022         RC109-CARRIER-SCAC-CODE   =  SV-CARRIER-SCAC-CODE  AND   03402294
034023         RC109-BILL-OF-LADING-NBR  =  SV-BILL-OF-LADING-NBR AND   03402394
034024         RC109-ASNHDR-NBR          =  SV-ASNHDR-NBR         AND   03402494
034025         RC109-PO-NBR              =  SV-PO-NBR             AND   03402594
034026         RC109-STORE-NBR           =  SV-STORE-NBR                03402694
034027*                                                                 03402794
034028*** SAME LINE                                                     03402894
034029*                                                                 03402994
034030         IF  RC109-OPERATING-COMPANY  = SV-OPERATING-COMPANY  AND 03403094
034031             RC109-DIST-CNTR          = SV-DIST-CNTR          AND 03403194
034032             RC109-EDI-VEND-ID        = SV-EDI-VEND-ID        AND 03403294
034033             RC109-CARRIER-SCAC-CODE  = SV-CARRIER-SCAC-CODE  AND 03403394
034034             RC109-BILL-OF-LADING-NBR = SV-BILL-OF-LADING-NBR AND 03403494
034035             RC109-ASNHDR-NBR         = SV-ASNHDR-NBR         AND 03403594
034036             RC109-PO-NBR             = SV-PO-NBR             AND 03403694
034037             RC109-STORE-NBR          = SV-STORE-NBR          AND 03403794
034038             RC109-PO-LINE-NBR        = SV-PO-LINE-NBR            03403894
034039             CONTINUE                                             03403994
034040         ELSE                                                     03404094
034041             IF  PS-ASN-HAS-SSCC                                  03404194
034042                 PERFORM 6000-BUILD-ASN-CARTON                    03404294
034043             END-IF                                               03404394
034044             PERFORM 6100-BUILD-ASN-DETAIL                        03404494
034045             MOVE  RC109-ASN-TRANSCRIPTION-RECORD                 03404594
034046               TO  SV-ASN-TRANSCRIPTION-RECORD                    03404694
034047             MOVE  RC109-PRO-NBR                                  03404794
034048               TO  SV-PRO-NBR                                     03404894
034049             MOVE  ZEROES  TO  PV-SUB                             03404994
034050             MOVE  ZEROES  TO  PV-CRTN-SEQ                        03405094
034051             MOVE  ZEROES  TO  PV-ASN-DTL-CART-CNT                03405194
034052         END-IF                                                   03405294
034053     ELSE                                                         03405394
034054         IF  PS-ASN-HAS-SSCC                                      03405494
034055*                                                                 03405594
034056*** TEST ONLY                                                     03405694
034057***         DISPLAY ' DIFFERENT ASN'                              03405796
034058*** TEST ONLY                                                     03405894
034059*                                                                 03405994
034060*                                                                 03406094
034061* PV-OUT-CRTN-REC-CNT > 0 --- THERE ARE SSCC'S FOR THIS ASN       03406194
034062* PV-ASN-CRTN-SUB = 0 --- THEN THE LAST CARTON REC HAD 10         03406295
034063* SSCC'S - THERE ARE NO ADDITIONAL SSCC'S                         03406394
034064* DO NOT CREATE A 0 SSCC CARTON RECORD                            03406494
034065* YOU JUST NEED TO CREATE THE ASN DETAIL & HEADER                 03406594
034066*                                                                 03406694
034067             IF  PV-OUT-CRTN-REC-CNT  > 0  AND                    03406794
034068                 PV-ASN-CRTN-SUB      > 0                         03406894
034069                 PERFORM 6000-BUILD-ASN-CARTON                    03406994
034070                 MOVE ZEROES  TO  PV-OUT-CRTN-REC-CNT             03407095
034071             END-IF                                               03407194
034072         END-IF                                                   03407294
034073         PERFORM 6100-BUILD-ASN-DETAIL                            03407394
034074         PERFORM 6200-BUILD-ASN-HEADER                            03407494
034075         MOVE  RC109-ASN-TRANSCRIPTION-RECORD                     03407594
034076           TO  SV-ASN-TRANSCRIPTION-RECORD                        03407694
034077         MOVE  RC109-PRO-NBR                                      03407794
034078           TO  SV-PRO-NBR                                         03407894
034079*                                                                 03407994
034080         MOVE  ZEROES  TO  PV-SUB                                 03408094
034081         MOVE  ZEROES  TO  PV-CRTN-SEQ                            03408194
034082*                                                                 03408294
034083         MOVE  ZEROES  TO  PV-ASN-HDR-CART-CNT                    03408394
034084     END-IF.                                                      03408494
034085                                                                  03408594
034086     IF  RC109-CRTN-UNIQUE                                        03408694
034087         ADD  1  TO  PV-ASN-HDR-CART-CNT                          03408794
034088                     PV-ASN-DTL-CART-CNT                          03408894
034089     END-IF.                                                      03408994
034090                                                                  03409094
034091     ADD  RC109-CARTON-QTY  TO  PV-ASN-HDR-CART-UNT-QTY.          03409194
034092     ADD  RC109-CARTON-QTY  TO  PV-ASN-DTL-CART-UNT-QTY.          03409294
034093                                                                  03409394
034094                                                                  03409494
034095     IF  RC109-CARTON-NBR > 0                                     03409594
034096         SET  PS-ASN-HAS-SSCC     TO  TRUE                        03409694
034097         ADD  1  TO  PV-OUT-CRTN-REC-CNT                          03409795
034098         ADD  1  TO  PV-IN-CRTN-REC-PROCESS-CNT                   03409898
034099         PERFORM  2100-CREATE-ASN-CRTN                            03409994
034100     ELSE                                                         03410094
034101         SET  PS-ASN-HAS-SSCC-NO  TO  TRUE                        03410194
034102         ADD  1  TO  PV-ASN-DTL-NO-SSCC-CNT                       03410294
034103         DISPLAY 'NO SSCC: '  RC001-ASN-TRANSCRIPTION-KEY         03410394
034104     END-IF.                                                      03410494
034105                                                                  03410594
034106*                                                                 03410694
034107*** TEST ONLY                                                     03410794
034108***  DISPLAY ' PS-ASN-HAS-SSCC-SW: '     PS-ASN-HAS-SSCC-SW.      03410896
034109*** TEST ONLY                                                     03410994
034110*                                                                 03411094
034111                                                                  03411194
034112     IF  CC-MULTI-SKU                                             03411294
034113         PERFORM 8110-WRITE-OUT02                                 03411394
034114     END-IF.                                                      03411494
034115                                                                  03411594
034120                                                                  03412094
034200     PERFORM 8000-READ-INPUT.                                     03420001
035011                                                                  03501101
035020                                                                  03502001
035021*----------------------------------------------------------------*03502106
035022* CREATE THE ASN-CARTON RECORD                                   *03502206
035023*----------------------------------------------------------------*03502306
035030 2100-CREATE-ASN-CRTN.                                            03503006
035031*** TEST ONLY                                                     03503189
035032***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              03503296
035033***  DISPLAY ' 2100-CREATE-ASN-CRTN       ' PV-DISP-ASN-CRTN-SUB  03503396
035034*** TEST ONLY                                                     03503489
035038                                                                  03503806
035039     ADD 1  TO PV-SUB.                                            03503906
035040     ADD 1  TO PV-ASN-CRTN-SUB.                                   03504032
035041                                                                  03504132
035046     MOVE RC109-CARTON-NBR        TO  CT-CARTON-NBR(PV-SUB).      03504668
035047     MOVE RC109-CARTON-QTY        TO  CT-CARTON-QTY(PV-SUB).      03504768
035048     MOVE RC109-CTN-UPC           TO  CT-CTN-UPC(PV-SUB).         03504868
035049     MOVE SPACES                  TO  CT-CARTON-FIL(PV-SUB).      03504968
035050     MOVE SPACES                  TO  CT-CARTON-FILLER.           03505068
035051                                                                  03505168
035052     MOVE RC109-CARTON-NBR        TO  PV-DISP-SSCC.               03505268
035053     MOVE PV-SUB                  TO  PV-DISP-SUB.                03505368
035054                                                                  03505468
035055                                                                  03505568
035056     IF  PV-SUB = 10                                              03505668
035057         ADD  1  TO  PV-CRTN-SEQ                                  03505768
035058         PERFORM 6000-BUILD-ASN-CARTON                            03505868
035059         MOVE 0  TO PV-ASN-CRTN-SUB                               03505968
035060                    PV-SUB                                        03506068
035070     END-IF.                                                      03507068
035150                                                                  03515006
035151                                                                  03515113
035152*----------------------------------------------------------------*03515213
035153* GET VENDOR PO FOR SEPHORA PO                                   *03515313
035154*----------------------------------------------------------------*03515413
035160 3000-GET-VENDOR-PO.                                              03516013
035161*** TEST ONLY                                                     03516189
035162***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              03516296
035163***  DISPLAY ' 3000-GET-VENDOR-PO         ' PV-DISP-ASN-CRTN-SUB  03516396
035164*** TEST ONLY                                                     03516489
035170                                                                  03517013
035181     MOVE ZEROES            TO  PV-VENDOR-PO                      03518177
035182                                PV-PO-SEQ                         03518277
035183                                PV-DEPT-NBR.                      03518377
035190     MOVE SV-PO-NBR         TO  PURCHS-PO-NBR.                    03519013
035191                                                                  03519113
035192     EXEC SQL                                                     03519213
035193          SELECT B.INSTR_DESC                                     03519314
035194               , E.INSTR_DESC                                     03519416
035195            INTO :PV-PO-INSTR-1                                   03519513
035196               , :PV-PO-INSTR-2                                   03519613
035197            FROM TPOINST A                                        03519713
035198               , TINSTCD B                                        03519813
035199               , TPURCHS C                                        03519913
035200               , TPOINST D                                        03520013
035201               , TINSTCD E                                        03520113
035202           WHERE UPPER(B.INSTR_DESC) LIKE 'SEPHORA PO #%'         03520213
035203             AND A.INSTR_NBR            = B.INSTR_NBR             03520313
035204             AND A.RECIP_CDE            = 'VN'                    03520413
035205             AND C.PO_NBR               = A.PO_NBR                03520513
035206             AND C.DEPT_NBR IN ('700','701','702','703','704',    03520618
035207                                '705','707','707','708','709',    03520718
035208                                '710','711')                      03520818
035209             AND C.VER_STATUS_CDE       = 'A'                     03520913
035210             AND D.INSTR_NBR            = E.INSTR_NBR             03521013
035211             AND D.INSTR_NBR           <> B.INSTR_NBR             03521113
035212             AND D.RECIP_CDE            = 'VN'                    03521213
035213             AND C.PO_NBR               = D.PO_NBR                03521315
035214             AND C.PO_NBR               = :PURCHS-PO-NBR          03521413
035226            WITH  UR                                              03522613
035227     END-EXEC.                                                    03522713
035228                                                                  03522813
035229     EVALUATE TRUE                                                03522913
035230         WHEN SQLCODE = +0                                        03523013
035238              MOVE PV-PO-INSTR-VND-PO  TO  PV-VENDOR-PO           03523814
035239              MOVE PV-PO-INSTR-OPER    TO  PV-PO-SEQ              03523914
035240                                                                  03524013
035241         WHEN SQLCODE = +100                                      03524113
035242         WHEN SQLCODE = -305                                      03524213
035243              MOVE  ZEROES        TO  PV-VENDOR-PO                03524313
035244              MOVE  SV-DIST-CNTR  TO  PV-PO-SEQ                   03524413
035245                                                                  03524513
035246         WHEN SQLWARN0 NOT = SPACES                               03524613
035247         WHEN SQLCODE < +0                                        03524713
035248         WHEN SQLCODE > +0                                        03524813
035249              MOVE  ZEROES        TO  PV-VENDOR-PO                03524913
035250              MOVE  SV-DIST-CNTR  TO  PV-PO-SEQ                   03525013
035251             DISPLAY ' '                                          03525113
035252             DISPLAY 'SQL ERROR - PO:'   SV-PO-NBR                03525214
035253                                                                  03525313
035254             MOVE SQLCODE          TO  PV-DISP-SQLCODE            03525413
035256             SET PS-ERROR          TO  TRUE                       03525613
035257             DISPLAY '******************************************' 03525713
035258             DISPLAY '*ABEND                                   *' 03525813
035259             DISPLAY '*PROGRAM   = RCKUT183                    *' 03525913
035260             DISPLAY '*DB2 OPER  = SELECT ON XLT_LOC           *' 03526013
035261             DISPLAY '*PARAGRAPH = 3000-GET-VENDOR-PO          *' 03526113
035262             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03526213
035263             DISPLAY '*PO_NBR    ' SV-PO-NBR                      03526321
035264             DISPLAY '******************************************' 03526413
035265             PERFORM 9100-SQL-ABEND                               03526513
035266     END-EVALUATE.                                                03526613
035267                                                                  03526713
035268                                                                  03526813
035269*----------------------------------------------------------------*03526977
035270* GET PO DEPT                                                    *03527077
035271*----------------------------------------------------------------*03527177
035272 3010-GET-DEPT.                                                   03527277
035273*** TEST ONLY                                                     03527389
035274***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              03527496
035275***  DISPLAY ' 3010-GET-DEPT              ' PV-DISP-ASN-CRTN-SUB  03527596
035276*** TEST ONLY                                                     03527689
035280                                                                  03528077
035281     MOVE ZEROES            TO  PV-DEPT-NBR.                      03528177
035282                                                                  03528277
035283     EXEC SQL                                                     03528377
035284          SELECT  DEPT_NBR                                        03528477
035285            INTO :PV-DEPT                                         03528577
035286            FROM  TPURCHS                                         03528677
035288           WHERE  PO_NBR               = :PURCHS-PO-NBR           03528877
035289             AND  VER_STATUS_CDE       = 'A'                      03528977
035290            WITH  UR                                              03529077
035303     END-EXEC.                                                    03530377
035304                                                                  03530477
035305     EVALUATE TRUE                                                03530577
035306         WHEN SQLCODE = +0                                        03530677
035307              CONTINUE                                            03530777
035309                                                                  03530977
035310         WHEN SQLCODE = +100                                      03531077
035311         WHEN SQLCODE = -305                                      03531177
035312              MOVE  ZEROES        TO  PV-DEPT-NBR                 03531277
035314                                                                  03531477
035315         WHEN SQLWARN0 NOT = SPACES                               03531577
035316         WHEN SQLCODE < +0                                        03531677
035317         WHEN SQLCODE > +0                                        03531777
035318              MOVE  ZEROES        TO  PV-DEPT-NBR                 03531877
035320                                                                  03532077
035321             DISPLAY ' '                                          03532177
035322             DISPLAY 'SQL ERROR - PO:'   SV-PO-NBR                03532277
035323             MOVE SQLCODE          TO  PV-DISP-SQLCODE            03532377
035324             SET PS-ERROR          TO  TRUE                       03532477
035325             DISPLAY '******************************************' 03532577
035326             DISPLAY '*ABEND                                   *' 03532677
035327             DISPLAY '*PROGRAM   = RCKUT183                    *' 03532777
035328             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 03532877
035329             DISPLAY '*PARAGRAPH = 3010-GET-DEPT               *' 03532977
035330             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03533077
035331             DISPLAY '*PO_NBR    ' SV-PO-NBR                      03533177
035332             DISPLAY '******************************************' 03533277
035333             PERFORM 9100-SQL-ABEND                               03533377
035334     END-EVALUATE.                                                03533477
035335                                                                  03533577
035336                                                                  03533677
035337*----------------------------------------------------------------*03533713
035338* BUILD ASN-CARTON RECORD                                        *03533813
035339*----------------------------------------------------------------*03533913
035340 6000-BUILD-ASN-CARTON.                                           03534006
035341*** TEST ONLY                                                     03534189
035342***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              03534296
035343***  DISPLAY ' 6000-BUILD-ASN-CARTON      ' PV-DISP-ASN-CRTN-SUB  03534396
035344*** TEST ONLY                                                     03534489
035348                                                                  03534806
035349     ADD  1       TO  PV-SEQ-NBR.                                 03534906
035350     MOVE SPACES  TO  RC001-ASN-TRANSCRIPTION-RECORD.             03535006
035351                                                                  03535106
035352     MOVE SV-OPERATING-COMPANY    TO  RC001-OPERATING-COMPANY.    03535206
035353     MOVE SV-DIST-CNTR            TO  RC001-DIST-CNTR.            03535306
035354     MOVE SV-EDI-VEND-ID          TO  RC001-EDI-VEND-ID.          03535406
035355     MOVE SV-CARRIER-SCAC-CODE    TO  RC001-CARRIER-SCAC-CODE.    03535506
035356     MOVE SV-BILL-OF-LADING-NBR   TO  RC001-BILL-OF-LADING-NBR    03535607
035357     MOVE SV-ASNHDR-NBR           TO  RC001-ASNHDR-NBR            03535787
035358                                                                  03535806
035359     IF  CC-MULTI-SKU                                             03535906
035360         MOVE 9999                TO  RC001-STORE-NBR             03536053
035361     ELSE                                                         03536106
035362         MOVE SV-STORE-NBR        TO  RC001-STORE-NBR             03536206
035363     END-IF.                                                      03536306
035364                                                                  03536406
035365     MOVE SV-PO-NBR               TO  RC001-PO-NBR.               03536506
035366     MOVE SV-PO-LINE-NBR          TO  RC001-PO-LINE-NBR.          03536606
035367     MOVE PV-SEQ-NBR              TO  RC001-SEQUENCE-NBR.         03536706
035368     SET  RC001-CARTON-RECORD     TO  TRUE.                       03536806
035369*                                                                 03536906
035370     MOVE SV-ASNHDR-NBR           TO  RC001-ASNHDR-NBR.           03537006
035371     MOVE SV-EDI-VEND-NAME        TO  RC001-EDI-VEND-NAME.        03537106
035372     MOVE SV-ORIG-BOL-NBR         TO  RC001-ORIG-BOL-NBR.         03537206
035373     MOVE SV-SEQ-NBR-IND          TO  RC001-SEQ-NBR-IND.          03537306
035374                                                                  03537454
035375* CLEAR OUT RCRD001 CARTON TABLE                                  03537554
035376                                                                  03537654
035377     PERFORM VARYING PV-SUB3                                      03537754
035378             FROM 1 BY 1                                          03537854
035379       UNTIL PV-SUB3 > 10                                         03537954
035380             MOVE ZEROES            TO RC001-CARTON-NBR(PV-SUB3)  03538054
035381                                       RC001-CARTON-QTY(PV-SUB3)  03538154
035382                                       RC001-CTN-UPC(PV-SUB3)     03538254
035383             MOVE SPACES            TO RC001-CARTON-FIL(PV-SUB3)  03538354
035384         END-PERFORM.                                             03538454
035385                                                                  03538554
035386     MOVE ZEROES  TO  PV-SUB3.                                    03538654
035387                                                                  03538754
035388*                                                                 03538806
035389     PERFORM VARYING PV-SUB2                                      03538906
035390             FROM 1 BY 1                                          03539006
035391       UNTIL PV-SUB2 > 10                                         03539106
035392          OR PV-SUB2 > PV-ASN-CRTN-SUB                            03539232
035393             MOVE CT-CARTON-NBR(PV-SUB2)                          03539332
035394                                    TO RC001-CARTON-NBR(PV-SUB2)  03539432
035395             MOVE CT-CARTON-QTY(PV-SUB2)                          03539532
035396                                    TO RC001-CARTON-QTY(PV-SUB2)  03539632
035397             MOVE CT-CTN-UPC(PV-SUB2)                             03539732
035398                                    TO RC001-CTN-UPC(PV-SUB2)     03539832
035399             MOVE CT-CARTON-FIL(PV-SUB2)                          03539932
035400                                    TO RC001-CARTON-FIL(PV-SUB2)  03540032
035401         END-PERFORM.                                             03540132
035402     MOVE SPACES                    TO RC001-CARTON-FILLER.       03540232
035410                                                                  03541006
035415     PERFORM 8100-WRITE-ASN-RECORD.                               03541506
035416                                                                  03541606
035417***  ADD  1  TO  PV-OUT-CRTN-REC-CNT.                             03541795
035418     ADD  1  TO  PV-OUT-ASN-CRTN-REC-CNT.                         03541898
035419                                                                  03541906
035420* CLEAR OUT CARTON INTERNAL TABLE                                 03542049
035421                                                                  03542149
035422     PERFORM VARYING PV-SUB2                                      03542249
035423             FROM 1 BY 1                                          03542349
035424       UNTIL PV-SUB2 > 10                                         03542449
035425             MOVE ZEROES            TO CT-CARTON-NBR(PV-SUB2)     03542549
035426                                       CT-CARTON-QTY(PV-SUB2)     03542649
035427                                       CT-CTN-UPC(PV-SUB2)        03542749
035428             MOVE SPACES            TO CT-CARTON-FIL(PV-SUB2)     03542849
035429         END-PERFORM.                                             03542949
035430                                                                  03543049
035431     MOVE ZEROES  TO  PV-ASN-CRTN-SUB                             03543149
035432                      PV-SUB2.                                    03543249
035433                                                                  03543349
035434                                                                  03543449
035435*----------------------------------------------------------------*03543549
035436* BUILD ASN-DETAIL RECORD                                        *03543649
035437*----------------------------------------------------------------*03543749
035438 6100-BUILD-ASN-DETAIL.                                           03543849
035439*** TEST ONLY                                                     03543989
035440***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              03544096
035441***  DISPLAY ' 6100-BUILD-ASN-DETAIL      ' PV-DISP-ASN-CRTN-SUB  03544196
035442*** TEST ONLY                                                     03544289
035445                                                                  03544549
035446     MOVE 1       TO  PV-SEQ-NBR.                                 03544649
035447     MOVE SPACES  TO  RC001-ASN-TRANSCRIPTION-RECORD.             03544749
035448                                                                  03544849
035449     MOVE SV-OPERATING-COMPANY    TO  RC001-OPERATING-COMPANY.    03544949
035450     MOVE SV-DIST-CNTR            TO  RC001-DIST-CNTR.            03545049
035451     MOVE SV-EDI-VEND-ID          TO  RC001-EDI-VEND-ID.          03545149
035452     MOVE SV-CARRIER-SCAC-CODE    TO  RC001-CARRIER-SCAC-CODE.    03545249
035453     MOVE SV-BILL-OF-LADING-NBR   TO  RC001-BILL-OF-LADING-NBR.   03545349
035455     MOVE SV-PO-NBR               TO  RC001-PO-NBR.               03545506
035456     MOVE SV-PO-LINE-NBR          TO  RC001-PO-LINE-NBR.          03545606
035457     MOVE PV-SEQ-NBR              TO  RC001-SEQUENCE-NBR.         03545706
035458                                                                  03545807
035459     IF  CC-MULTI-SKU                                             03545907
035460         MOVE 9999                TO  RC001-STORE-NBR             03546053
035461     ELSE                                                         03546107
035462         MOVE SV-STORE-NBR        TO  RC001-STORE-NBR             03546207
035463     END-IF.                                                      03546307
035464                                                                  03546407
035465*                                                                 03546506
035466     SET  RC001-DETAIL-RECORD     TO  TRUE.                       03546606
035467*                                                                 03546706
035468     MOVE SV-ASNHDR-NBR           TO  RC001-ASNHDR-NBR.           03546806
035469     MOVE SV-EDI-VEND-NAME        TO  RC001-EDI-VEND-NAME.        03546906
035470     MOVE SV-ORIG-BOL-NBR         TO  RC001-ORIG-BOL-NBR.         03547006
035471     MOVE SV-SEQ-NBR-IND          TO  RC001-SEQ-NBR-IND.          03547106
035480*                                                                 03548006
035506     MOVE SV-SKU-DEPT-NBR         TO  RC001-SKU-DEPT-NBR.         03550606
035507     MOVE SV-SKU-CLASS-NBR        TO  RC001-SKU-CLASS-NBR.        03550706
035508     MOVE SV-SKU-SEQ-NBR          TO  RC001-SKU-SEQ-NBR.          03550806
035509     MOVE SV-DIST-PACK-QTY        TO  RC001-DIST-PACK-QTY.        03550906
035510     MOVE SV-UPC-NBR              TO  RC001-UPC-NBR.              03551006
035511     MOVE SV-UPC-DESC             TO  RC001-UPC-DESC.             03551106
035512     MOVE SV-VENDOR-STYLE         TO  RC001-VENDOR-STYLE.         03551206
035513     MOVE SV-SIZE                 TO  RC001-SIZE.                 03551306
035514     MOVE SV-COLOR                TO  RC001-COLOR.                03551406
035515     MOVE SV-UNIT-COST            TO  RC001-UNIT-COST.            03551506
035516     MOVE SV-UNIT-RETAIL          TO  RC001-UNIT-RETAIL.          03551606
035517                                                                  03551780
035518     IF  PS-ASN-HAS-SSCC-NO                                       03551880
035519         MOVE SV-QTY-ORDERED          TO  RC001-QTY-ORDERED       03551980
035520         MOVE SV-QTY-SHIPPED          TO  RC001-QTY-SHIPPED       03552080
035521     ELSE                                                         03552180
035522         MOVE PV-ASN-DTL-CART-UNT-QTY TO  RC001-QTY-ORDERED       03552280
035523         MOVE PV-ASN-DTL-CART-UNT-QTY TO  RC001-QTY-SHIPPED       03552380
035524     END-IF.                                                      03552480
035525                                                                  03552580
035526     MOVE SV-QTY-ORDERED-UM       TO  RC001-QTY-ORDERED-UM.       03552680
035527     MOVE SV-QTY-SHIPPED-UM       TO  RC001-QTY-SHIPPED-UM.       03552780
035528     MOVE SV-QTY-SHIPPED-VAR      TO  RC001-QTY-SHIPPED-VAR.      03552880
035529     MOVE SV-PR-CHG-EFF-DAYS      TO  RC001-PR-CHG-EFF-DAYS.      03552980
035530     MOVE SV-ASDTPL-ALLOC-IND     TO  RC001-ASDTPL-ALLOC-IND.     03553080
035531     MOVE SV-ASDTPL-MATCH-IND     TO  RC001-ASDTPL-MATCH-IND.     03553180
035532     MOVE SV-ASDTPL-PR-DISC-IND   TO  RC001-ASDTPL-PR-DISC-IND.   03553280
035533     MOVE SV-ASDTPL-PR-VAR-IND    TO  RC001-ASDTPL-PR-VAR-IND.    03553306
035535     MOVE SV-SKU-NBR              TO  RC001-SKU-NBR.              03553506
035536     MOVE SPACES                  TO  RC001-DTL-FILLER.           03553652
035545                                                                  03554506
035547     PERFORM 8100-WRITE-ASN-RECORD.                               03554706
035548                                                                  03554806
035549     ADD  1  TO  PV-OUT-DTL-REC-CNT.                              03554906
035550                                                                  03555010
035551     IF  CC-MULTI-SKU                                             03555110
035552         PERFORM 3000-GET-VENDOR-PO                               03555213
035553         PERFORM 3010-GET-DEPT                                    03555377
035554         PERFORM 8120-WRITE-OUT03                                 03555477
035555     END-IF.                                                      03555577
035556                                                                  03555677
035557     MOVE ZEROES  TO  PV-ASN-DTL-CART-CNT.                        03555777
035558     MOVE ZEROES  TO  PV-ASN-DTL-CART-UNT-QTY.                    03555877
035559                                                                  03555977
035560                                                                  03556077
035561*----------------------------------------------------------------*03556177
035562* BUILD ASN-HEADER RECORD                                        *03556277
035563*----------------------------------------------------------------*03556377
035564 6200-BUILD-ASN-HEADER.                                           03556477
035565*** TEST ONLY                                                     03556589
035566***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              03556696
035567***  DISPLAY ' 6200-BUILD-ASN-HEADER      ' PV-DISP-ASN-CRTN-SUB  03556796
035568*** TEST ONLY                                                     03556889
035572                                                                  03557206
035573     MOVE SPACES  TO  RC001-ASN-TRANSCRIPTION-RECORD.             03557306
035574                                                                  03557406
035575     MOVE SV-OPERATING-COMPANY    TO  RC001-OPERATING-COMPANY.    03557506
035576     MOVE SV-DIST-CNTR            TO  RC001-DIST-CNTR.            03557606
035577     MOVE SV-EDI-VEND-ID          TO  RC001-EDI-VEND-ID.          03557706
035578     MOVE SV-CARRIER-SCAC-CODE    TO  RC001-CARRIER-SCAC-CODE.    03557806
035579     MOVE SV-BILL-OF-LADING-NBR   TO  RC001-BILL-OF-LADING-NBR    03557942
035580                                                                  03558006
035581     IF  CC-MULTI-SKU                                             03558106
035582         MOVE 'MIXEDSKU'          TO  RC001-PRO-NBR               03558208
035583         MOVE 9999                TO  RC001-STORE-NBR             03558353
035584     ELSE                                                         03558406
035585         IF  SV-PRO-NBR  > SPACES                                 03558597
035586             MOVE SV-PRO-NBR      TO  RC001-PRO-NBR               03558697
035587         ELSE                                                     03558797
035588             MOVE 'SINGLESKU'     TO  RC001-PRO-NBR               03558897
035589         END-IF                                                   03558997
035590                                                                  03559097
035591         MOVE SV-STORE-NBR        TO  RC001-STORE-NBR             03559106
035592     END-IF.                                                      03559206
035593                                                                  03559306
035594     MOVE SV-PO-NBR               TO  RC001-PO-NBR.               03559406
035595     MOVE ZEROES                  TO  RC001-PO-LINE-NBR.          03559538
035596     MOVE ZEROES                  TO  RC001-SEQUENCE-NBR.         03559606
035597     MOVE SPACE                   TO  RC001-CARTON-IND.           03559706
035598*                                                                 03559806
035599     MOVE SV-ASNHDR-NBR           TO  RC001-ASNHDR-NBR.           03559906
035600     MOVE SV-EDI-VEND-NAME        TO  RC001-EDI-VEND-NAME.        03560006
035601     MOVE SV-ORIG-BOL-NBR         TO  RC001-ORIG-BOL-NBR.         03560106
035602     MOVE SV-SEQ-NBR-IND          TO  RC001-SEQ-NBR-IND.          03560206
035603*                                                                 03560306
035604     MOVE SV-DEPT-NBR             TO  RC001-DEPT-NBR.             03560406
035605     MOVE SV-DEPT-DESC            TO  RC001-DEPT-DESC.            03560506
035606     MOVE SV-BUYER-NBR            TO  RC001-BUYER-NBR.            03560606
035607     MOVE SV-BUYER-NAME           TO  RC001-BUYER-NAME.           03560706
035608     MOVE SV-ANALYST-NAME         TO  RC001-ANALYST-NAME.         03560806
035609     MOVE SV-DATE-SHIPPED         TO  RC001-DATE-SHIPPED.         03560906
035610     MOVE SV-PO-DATE              TO  RC001-PO-DATE.              03561006
035611     MOVE SV-REQ-SHIP-DATE        TO  RC001-REQ-SHIP-DATE.        03561106
035612     MOVE SV-CANCEL-DATE          TO  RC001-CANCEL-DATE.          03561206
035613     MOVE SV-CANCEL-EXT-DATE      TO  RC001-CANCEL-EXT-DATE.      03561306
035614     MOVE SV-AD-DATE              TO  RC001-AD-DATE.              03561406
035615     MOVE SV-CARR-VEND-ID         TO  RC001-CARR-VEND-ID.         03561530
035616     MOVE SV-CARRIER-NAME         TO  RC001-CARRIER-NAME.         03561606
035617     MOVE SV-TRAILER-NBR          TO  RC001-TRAILER-NBR.          03561706
035618     MOVE SV-SHIPMENT-WEIGHT      TO  RC001-SHIPMENT-WEIGHT.      03561830
035619     MOVE SV-SHIP-WEIGHT-UM       TO  RC001-SHIP-WEIGHT-UM.       03561906
035620                                                                  03562080
035621     IF  PS-ASN-HAS-SSCC-NO                                       03562180
035622         MOVE SV-CARTON-CNT-STORE     TO  RC001-CARTON-CNT-STORE  03562280
035623         MOVE SV-CARTON-CNT-PO        TO  RC001-CARTON-CNT-PO     03562380
035624         MOVE SV-CARTON-CNT-SHPMT     TO  RC001-CARTON-CNT-SHPMT  03562480
035625     ELSE                                                         03562580
035626         MOVE PV-ASN-HDR-CART-CNT     TO  RC001-CARTON-CNT-STORE  03562680
035627         MOVE PV-ASN-HDR-CART-CNT     TO  RC001-CARTON-CNT-PO     03562780
035628         MOVE PV-ASN-HDR-CART-CNT     TO  RC001-CARTON-CNT-SHPMT  03562880
035629     END-IF.                                                      03562980
035630                                                                  03563080
035631     MOVE SV-SPECIAL-INSTR-1      TO  RC001-SPECIAL-INSTR-1.      03563106
035632     MOVE SV-SPECIAL-INSTR-2      TO  RC001-SPECIAL-INSTR-2.      03563206
035633     MOVE SV-SPECIAL-INSTR-3      TO  RC001-SPECIAL-INSTR-3.      03563306
035634     MOVE SV-ASNORD-EARLY-LTE-CDE TO  RC001-ASNORD-EARLY-LTE-CDE. 03563406
035635     MOVE SV-ASNORD-MTCH-PO-CDE   TO  RC001-ASNORD-MTCH-PO-CDE.   03563506
035636     MOVE SV-VENDOR-TRSCP-IND     TO  RC001-VENDOR-TRSCP-IND.     03563606
035637     MOVE SV-LINE-ERROR-IND       TO  RC001-LINE-ERROR-IND.       03563706
035638     MOVE SV-CONT-NBR             TO  RC001-CONT-NBR.             03563806
035639     MOVE SV-ISA-NBR              TO  RC001-ISA-NBR.              03563906
035640     MOVE SV-MAN-SEG-IND          TO  RC001-MAN-SEG-IND.          03564006
035641     MOVE SV-CARR-AUTH-ID         TO  RC001-CARR-AUTH-ID.         03564106
035642     MOVE SPACES                  TO  RC001-HDR-FILLER.           03564252
035643*                                                                 03564306
035644     PERFORM 8100-WRITE-ASN-RECORD.                               03564406
035645     ADD  1  TO  PV-OUT-HDR-REC-CNT.                              03564506
035646     MOVE ZEROES  TO  PV-ASN-HDR-CART-CNT.                        03564606
035650     MOVE ZEROES  TO  PV-ASN-HDR-CART-UNT-QTY.                    03565006
035667                                                                  03566706
035668                                                                  03566806
052900*----------------------------------------------------------------*05290001
053000* READ INPUT ASN FILE                                            *05300001
053100*----------------------------------------------------------------*05310001
053200 8000-READ-INPUT.                                                 05320001
053210*** TEST ONLY                                                     05321089
053220***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              05322096
053221***  DISPLAY '                            '                       05322196
053222***  DISPLAY ' 8000-READ-INPUT            ' PV-DISP-ASN-CRTN-SUB  05322296
053223*** TEST ONLY                                                     05322391
053230                                                                  05323023
053300     READ  INPUT-FILE                                             05330001
053400           INTO  RC109-ASN-TRANSCRIPTION-RECORD                   05340001
053500           AT END                                                 05350001
053600                 SET PS-END-OF-FILE  TO  TRUE                     05360001
053700           NOT AT END                                             05370001
053710*** TEST ONLY                                                     05371090
053720***  DISPLAY ' 8000-READ-INPUT            ' RC109-CARTON-NBR      05372096
053740*** TEST ONLY                                                     05374090
053800                 ADD 1  TO  PV-READ-COUNT                         05380001
053830                                                                  05383067
053900     END-READ.                                                    05390001
055300                                                                  05530001
056400                                                                  05640001
056401*-----------------------------------------------------------------05640101
056402*  READ CONTROL RECORD                                            05640201
056403*-----------------------------------------------------------------05640301
056404 8010-READ-CONTROL-REC.                                           05640401
056405*** TEST ONLY                                                     05640589
056406***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              05640696
056407***  DISPLAY ' 8010-READ-CONTROL-REC      ' PV-DISP-ASN-CRTN-SUB  05640796
056408*** TEST ONLY                                                     05640889
056413                                                                  05641301
056414     READ CONTROL-CARD-FILE     INTO                              05641402
056415           CC-CONTROL-CARD                                        05641508
056416     AT END                                                       05641601
056417         DISPLAY 'PROGRAM:  RCKUT183'                             05641701
056418         DISPLAY 'NO CONTROL CARD'                                05641801
056419         DISPLAY ' '                                              05641901
056420     NOT AT END                                                   05642001
056421         DISPLAY 'PROGRAM:  SUKUT183'                             05642101
056422         DISPLAY 'CONTROL CARD: '                                 05642201
056423                 CC-CONTROL-CARD                                  05642308
056424         DISPLAY ' '                                              05642401
056425     END-READ.                                                    05642501
056426                                                                  05642601
056427*----------------------------------------------------------------*05642701
056428* OUTPUT FILE 1 - NEW ASN RECORD                                 *05642807
056430*----------------------------------------------------------------*05643001
056431 8100-WRITE-ASN-RECORD.                                           05643107
056432*** TEST ONLY                                                     05643289
056433***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              05643396
056434***  DISPLAY ' 8100-WRITE-ASN-RECORD      ' PV-DISP-ASN-CRTN-SUB  05643496
056435***          '    RC001-CARTON-IND: '       RC001-CARTON-IND      05643596
056436*** TEST ONLY                                                     05643691
056450                                                                  05645001
056460     WRITE ASN-OUTPUT-FILE-RECORD                                 05646007
056470           FROM  RC001-ASN-TRANSCRIPTION-RECORD.                  05647007
056480                                                                  05648001
056490     ADD  1  TO  PV-OUT01-COUNT.                                  05649001
056491                                                                  05649107
056497                                                                  05649701
056500*----------------------------------------------------------------*05650001
056600* OUTPUT FILE 2 - REPORT FILE                                    *05660007
056700*----------------------------------------------------------------*05670001
056800 8110-WRITE-OUT02.                                                05680007
056801*** TEST ONLY                                                     05680189
056802***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              05680296
056803***  DISPLAY ' 8110-WRITE-OUT02           ' PV-DISP-ASN-CRTN-SUB  05680396
056804*** TEST ONLY                                                     05680489
056808                                                                  05680801
056811     WRITE ASN-MULTI-SKU-RPT-RECORD                               05681107
056820           FROM  RC109-ASN-TRANSCRIPTION-RECORD.                  05682007
056830                                                                  05683001
056840     ADD  1  TO  PV-OUT02-COUNT.                                  05684001
056900                                                                  05690001
066300                                                                  06630001
066400*----------------------------------------------------------------*06640007
066500* OUTPUT FILE 3 - SKU SORT FILE  = RCRD104                       *06650007
066600*----------------------------------------------------------------*06660007
066700 8120-WRITE-OUT03.                                                06670008
066701*** TEST ONLY                                                     06670189
066702***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              06670296
066703***  DISPLAY ' 8120-WRITE-OUT03           ' PV-DISP-ASN-CRTN-SUB  06670396
066704*** TEST ONLY                                                     06670489
066710                                                                  06671010
066720     MOVE SV-PO-NBR                TO  RC103-KOHLS-ORD-NBR        06672064
066730     MOVE PV-VENDOR-PO             TO  RC103-VEND-ORD-NBR         06673065
066740     MOVE SV-DIST-CNTR             TO  RC103-DC-NBR               06674064
066750     MOVE PV-DEPT-NBR              TO  RC103-DEPT-NBR             06675077
066800                                                                  06680007
067000     WRITE ASN-SKU-SORT-RECORD                                    06700007
067100           FROM  RC103-ASN-SKU-SORT-REC.                          06710064
067200                                                                  06720007
067300     ADD  1  TO  PV-OUT03-COUNT.                                  06730007
067400                                                                  06740007
067500                                                                  06750007
067600*-----------------------------------------------------------------06760013
067700*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    06770013
067800*  ERROR OR WARNING CODE OCCURS.                                  06780013
067900*-----------------------------------------------------------------06790013
068000 9100-SQL-ABEND.                                                  06800013
068010*** TEST ONLY                                                     06801089
068020***  MOVE  PV-ASN-CRTN-SUB  TO  PV-DISP-ASN-CRTN-SUB              06802096
068030***  DISPLAY ' 9100-SQL-ABEND             ' PV-DISP-ASN-CRTN-SUB  06803096
068040*** TEST ONLY                                                     06804089
068100                                                                  06810013
068200     DISPLAY '9100-SQL-ABEND'.                                    06820013
068300     DISPLAY '** ABEND     **'.                                   06830013
068400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        06840013
068500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              06850013
068600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     06860013
068700                                                                  06870013
068800******************************************************************06880013
068900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    06890013
069000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         06900013
069100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     06910013
069200* FORMAT.                                                         06920013
069300******************************************************************06930013
069400     COPY DPPD004.                                                06940013
069500                                                                  06950013
069600     MOVE +4013                  TO ABEND-CODE.                   06960013
069700     CALL 'ILBOABN0' USING ABEND-CODE.                            06970013
069800                                                                  06980013
