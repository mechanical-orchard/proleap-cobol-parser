000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS704.                                         00040000
000500 AUTHOR.        DENISE HAHN.                                      00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  04-24-98.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    E704 - PACK-TO-LIGHT STATUS REPORTS                         *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00120000
001300*    SUBSEQUENT PROGRAMS TO CREATE PACK-TO-LIGHT DOWNLOAD REPORTS*00130002
001400*    BY STORE ZONE OR BY PACK-TO-LIGHT MODULE.  BOTH REPORTS     *00140002
001500*    WOULD BE FOR A GIVEN DISTRIBUTION CENTER.                   *00150002
001600*----------------------------------------------------------------*00160000
001610* DATE  11/04/2021                                                00161081
001620*            - CHANGE CALL OF 'DPKUT100' TO                     * 00162081
001630*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00163081
001640*              MAKING THE CALL DYNAMIC VS STATIC                * 00164081
001650*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00165082
001660*-----------------------------------------------------------------00166081
1122RM* DATE  11/07/2022                                              * 00167083
1122RM*            - ADD COPYBOOK DPWS930                             * 00168083
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00169083
1122RM*              DYNAMIC.                                         * 00169183
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00169283
1122RM*-----------------------------------------------------------------00169383
001700                                                                  00170007
001800*----------------------------------------------------------------*00180016
001900 ENVIRONMENT DIVISION.                                            00190007
002000*----------------------------------------------------------------*00200016
002100                                                                  00210007
002200*----------------------------------------------------------------*00220016
002300 DATA DIVISION.                                                   00230007
002400*----------------------------------------------------------------*00240016
002500                                                                  00250007
002600 WORKING-STORAGE SECTION.                                         00260007
002700                                                                  00270007
002800*-----------------------------------------------------------------00280007
002900*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 00290007
003000*-----------------------------------------------------------------00300007
003100     COPY DPWS010I.                                               00310007
003200                                                                  00320007
003300*-----------------------------------------------------------------00330007
003400*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00340007
003500*-----------------------------------------------------------------00350007
003600     COPY DPWS013.                                                00360007
003700                                                                  00370007
003800*-----------------------------------------------------------------00380007
003900*  CICS ATTRIBUTES COPYBOOK                                       00390007
004000*-----------------------------------------------------------------00400007
004100     COPY DPWS015.                                                00410007
004200                                                                  00420007
004300*-----------------------------------------------------------------00430007
004400*  FUNCTION KEYS COPYBOOK                                         00440007
004500*-----------------------------------------------------------------00450007
004600     COPY DPWS016.                                                00460007
004700                                                                  00470007
004800     COPY DPWS017.                                                00480007
004900                                                                  00490007
005000*-----------------------------------------------------------------00500007
005100*  STANDARD ATTENTION IDENTIFIER LIST                             00510007
005200*-----------------------------------------------------------------00520007
005300     COPY DFHAID.                                                 00530007
005400                                                                  00540007
005500*-----------------------------------------------------------------00550007
005600*  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          00560007
005700*-----------------------------------------------------------------00570007
005800     COPY DFHBMSCA.                                               00580007
005900                                                                  00590007
006000*-----------------------------------------------------------------00600007
006100*  DSECT FOR THE PCKM704 MAPSET                                   00610007
006200*-----------------------------------------------------------------00620007
006300     COPY PCKM704.                                                00630007
006400                                                                  00640007
006500*----------------------------------------------------------------*00650016
006600*  SENDING/RECEIVING AREA FOR THE                                 00660016
006700*  PRINTER VALIDATION ROUTING (DPKCS060)                          00670016
006800*----------------------------------------------------------------*00680016
006900     COPY DPWS072.                                                00690016
007000                                                                  00700016
007100*-----------------------------------------------------------------00710007
007200*                                                                 00720007
007300*-----------------------------------------------------------------00730007
007400  01  PS-INTERNAL-READER-ENQ-DEQ-IND                              00740007
007500                              PIC X(1)     VALUE 'N'.             00750007
007600      88  PS-INTERNAL-READER-ENQUEUED      VALUE 'Y'.             00760007
007700      88  PS-INTERNAL-READER-DEQUEUED      VALUE 'N'.             00770007
007800                                                                  00780007
007900*-----------------------------------------------------------------00790007
008000*                                                                 00800007
008100*-----------------------------------------------------------------00810007
008200 01  DK-DB2-KEYS.                                                 00820007
008300     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.00830007
008400     05  DK-FCLTY-ID                    PIC S9(04)  COMP VALUE +0.00840007
008800                                                                  00880007
008900*-----------------------------------------------------------------00890007
009000*                                                                 00900007
009100*-----------------------------------------------------------------00910007
009200 01  WS-DATE.                                                     00920007
009300     10  WS-CCYY.                                                 00930007
009400         15 WS-CC                   PIC 99      VALUE  0.         00940007
009500         15 WS-YY                   PIC 99      VALUE  0.         00950007
009600     10 WS-MM                       PIC 99      VALUE  0.         00960007
009700     10 WS-DD                       PIC 99      VALUE  0.         00970007
009800                                                                  00980007
009900*-----------------------------------------------------------------00990007
010000*                                                                 01000007
010100*-----------------------------------------------------------------01010007
010200 01  TD-TRANSIENT-DATA-AREA.                                      01020007
010300     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            01030007
010400                                 COMP SYNC.                       01040007
010500     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           01050007
010600                                 COMP SYNC.                       01060007
010700     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       01070007
010800     05  TD-JCL-LINE             PIC X(80)    VALUE SPACES.       01080007
010900                                                                  01090007
011000*-----------------------------------------------------------------01100007
011100*                                                                 01110007
011200*-----------------------------------------------------------------01120007
011300 01  PS-PROGRAM-SWITCHES.                                         01130007
011400     05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          01140007
011500         88  PS-NO-EDIT-ERROR                 VALUE 'N'.          01150007
011600         88  PS-EDIT-ERROR                    VALUE 'Y'.          01160007
011700                                                                  01170007
011800*-----------------------------------------------------------------01180007
011900*                                                                 01190007
012000*-----------------------------------------------------------------01200007
012100 01  PC-PROGRAM-CONSTANTS.                                        01210007
012200     05  PC-01                   PIC X(02)    VALUE '01'.         01220017
012300     05  PC-TEST                 PIC X(01)    VALUE 'T'.          01230019
012310     05  PC-QA                   PIC X(01)    VALUE 'Q'.          01231074
012320     05  PC-LEARN                PIC X(01)    VALUE 'L'.          01232074
012400     05  PC-PRTR-VALIDATION-PGM  PIC X(08)    VALUE 'DPKCS060'.   01240074
012500     05  PC-REPORT-PGM           PIC X(08)    VALUE 'PCKRP009'.   01250074
012600     05  PC-CURRENT-PROGRAM-NAME PIC X(08)    VALUE 'PCKCS704'.   01260074
012700     05  PC-CURRENT-MAPSET-NAME  PIC X(08)    VALUE 'PCKM704'.    01270074
012800     05  PC-CURRENT-MAP-NAME     PIC X(08)    VALUE 'PC704A'.     01280074
012900     05  PC-DPKCS030             PIC X(08)    VALUE 'DPKCS030'.   01290074
013000     05  PC-MAX-RETRIES          PIC S9(4)    VALUE +2.           01300074
013100     05  PC-KOHLS-OPERATING-COMPANY                               01310074
013200                                 PIC X(2)     VALUE '03'.         01320074
013300                                                                  01330074
013400     05  PC-STATUS-REPORT-DESC   PIC  X(13)  VALUE                01340074
013500         'STATUS REPORT'.                                         01350074
013600     05  PC-STATUS-REPORT-PROC   PIC  X(07)  VALUE                01360074
013700         'PCK9101'.                                               01370074
013800     05  PC-STATUS-REPORT-JOB    PIC  X(07)  VALUE                01380074
013900         'PCK910 '.                                               01390074
014000                                                                  01400074
014100*-----------------------------------------------------------------01410074
014200*  SYSTEM MESSAGES - FROM TSYMSG TABLE                            01420074
014300*-----------------------------------------------------------------01430074
014400 01  PC-TSYMSG-AREA.                                              01440074
014500*  INVALID VALUE                                                  01450074
014600     05  PC-TSYMSG-00005      PIC 9(5) VALUE 00005.               01460074
014700*  REQUIRED ENTRY                                                 01470074
014800     05  PC-TSYMSG-00007      PIC 9(5) VALUE 00007.               01480074
014900*  MUST BE NUMERIC                                                01490074
015000     05  PC-TSYMSG-00008      PIC 9(5) VALUE 00008.               01500074
015100*  PRINT REQUEST HAS BEEN SUBMITTED                               01510074
015200     05  PC-TSYMSG-00098      PIC 9(5) VALUE 00098.               01520074
015300*  REPORT REQUEST SUCCESSFULLY SUBMITTED                          01530074
015400     05  PC-TSYMSG-00458      PIC 9(5) VALUE 00458.               01540074
015500*  INVALID PRINTER DESTINATION                                    01550074
015600     05  PC-TSYMSG-00746      PIC 9(5) VALUE 00746.               01560074
015700*  PRINTER ID MUST BE ENTERED FOR THIS SELECTION                  01570074
015800     05  PC-TSYMSG-01563      PIC 9(5) VALUE 01563.               01580074
015900*  REPORT(S) MUST BE SENT TO INFOPAC OR TO A PRINTER              01590074
016000     05  PC-TSYMSG-01736      PIC 9(5) VALUE 01736.               01600074
016100*  REPORTS MUST BE SENT TO INFOPAC OR A PRINTER - NOT BOTH        01610074
016200     05  PC-TSYMSG-01737      PIC 9(5) VALUE 01737.               01620074
016300*  ONE OR BOTH OF THE STATUS REPORTS MUST BE SELECTED             01630074
016400     05  PC-TSYMSG-01738      PIC 9(5) VALUE 01738.               01640074
016500                                                                  01650074
016600*-----------------------------------------------------------------01660074
016700*                                                                 01670074
016800*-----------------------------------------------------------------01680074
016900 01  PV-PROGRAM-VARIABLES.                                        01690074
017000     05  PV-PRINTER-DESTINATION    PIC  X(05)  VALUE SPACES.      01700074
017100     05  PV-SQL-SUB              PIC S9(04)   COMP VALUE +0.      01710074
017200     05  PV-TRANSFER-PROGRAM     PIC X(8)     VALUE SPACES.       01720074
017300     05  PV-LEAVE-SYSTEM-MESSAGE PIC X(400)   VALUE SPACES.       01730074
017400     05  PV-CICS-RESPONSE        PIC S9(9)    VALUE ZERO          01740074
017500                                 COMP SYNC.                       01750074
017600     05  PV-RETRY-COUNT          PIC S9(4)    VALUE ZERO          01760074
017700                                 COMP SYNC.                       01770074
017800     05  PV-CURRENT-YEAR         PIC S9(9)    VALUE ZERO          01780074
017900                                 COMP SYNC.                       01790074
018000     05  PV-KEY-FEEDBACK-AREA    PIC X(11)    VALUE SPACES.       01800074
018100     05  PV-MESSAGE-NBR          PIC 9(05)    VALUE ZEROES.       01810074
018200     05  PV-DEPT-NMBR            PIC X(03)    VALUE SPACES.       01820074
018300     05  PV-DP020-NAV-KEY-DATA   PIC X(25)    VALUE SPACES.       01830074
018400     05  PV-USER-ID              PIC X(8)     VALUE SPACES.       01840074
018500                                                                  01850074
018600     05  PV-SYSTEM-ID.                                            01860074
018700         10  FILLER              PIC  X(04)  VALUE SPACE.         01870074
018800         10  PV-REGION-IND       PIC  X(01).                      01880074
018900             88  PV-TEST-CICS                VALUE 'T'.           01890074
019000             88  PV-QA-CICS                  VALUE 'Q'.           01900074
019100             88  PV-PROD-CICS                VALUE 'P'.           01910074
019200             88  PV-LEARN-CICS               VALUE 'L'.           01920074
019300         10  FILLER              PIC  X(03)  VALUE SPACES.        01930074
019400                                                                  01940074
019500     05  PV-DP020-INT-APPL-FORMAT-IND                             01950074
019600                                 PIC X(1)     VALUE SPACES.       01960074
019700                                                                  01970074
020100                                                                  02010074
020200     05  PV-JOB-DESCRIPTION      PIC  X(13)  VALUE SPACES.        02020074
020300     05  PV-JOB-PROC             PIC  X(07)  VALUE SPACES.        02030074
020400     05  PV-JOB-NAME             PIC  X(07)  VALUE SPACES.        02040074
020500                                                                  02050074
020600*-----------------------------------------------------------------02060074
020700*  JCL LINES FOR A STATUS REPORTS REQUEST                         02070074
020800*-----------------------------------------------------------------02080074
020900  01  JL-JCL-LINE-AREA.                                           02090074
021000      05  JL-JCL-LINE-1           PIC X(80)    VALUE SPACE.       02100074
021100      05  JL-JOB-LINE-PROD.                                       02110074
021200          10  FILLER              PIC X(02)    VALUE '//'.        02120074
021300          10  JL-PROD-JOB-NAME    PIC X(07)    VALUE SPACE.       02130074
021400          10  FILLER              PIC X(12)    VALUE              02140074
021500              '  JOB KOHLS,'.                                     02150074
021600          10  FILLER              PIC X(1)     VALUE QUOTE.       02160074
021700          10  JL-PROD-JOB-DESC    PIC X(13)    VALUE SPACES.      02170074
021800          10  FILLER              PIC X(1)     VALUE QUOTE.       02180074
021900          10  FILLER              PIC X(29)    VALUE              02190074
022000              ',MSGCLASS=P,CLASS=P'.                              02200079
022100          10  FILLER              PIC X(15)    VALUE SPACES.      02210074
022200      05  JL-JOB-LINE-TEST.                                       02220074
022300          10  FILLER              PIC X(02)    VALUE '//'.        02230074
022400          10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACE.       02240074
022500          10  FILLER              PIC X(01)    VALUE 'Q'.         02250074
022600          10  FILLER              PIC X(11)    VALUE              02260074
022700              ' JOB KOHLS,'.                                      02270074
022800          10  FILLER              PIC X(1)     VALUE QUOTE.       02280074
022900          10  JL-TEST-JOB-DESC    PIC X(13)    VALUE SPACES.      02290074
023000          10  FILLER              PIC X(1)     VALUE QUOTE.       02300074
023100          10  FILLER              PIC X(29)    VALUE              02310074
023200              ',MSGCLASS=X,CLASS=E'.                              02320079
023300      05  JL-JCL-LINE-2-PROD.                                     02330074
023400          10  FILLER              PIC X(13)    VALUE              02340074
023500               '/*JOBPARM K=0'.                                   02350074
023600          10  FILLER              PIC X(67)    VALUE SPACES.      02360074
023700      05  JL-JCL-LINE-3.                                          02370074
023800          10  FILLER              PIC X(34)    VALUE              02380074
023900          '//JOBOUT01 OUTPUT FORMS=STD,CLASS='.                   02390074
024000          10  JL-LINE-3-CLASS     PIC X(1)     VALUE SPACES.      02400074
024100          10  FILLER              PIC X(15)    VALUE              02410074
024200          ',COPIES=1,DEST='.                                      02420074
024300          10  JL-LINE-3-PRINTER   PIC X(8)     VALUE SPACES.      02430074
024400          10  FILLER              PIC X(22)    VALUE SPACES.      02440074
024500      05  JL-JCL-LINE-4-PROD.                                     02450074
024600          10  FILLER              PIC X(40)    VALUE              02460074
024700               '//JOBLIB    DD DSN=PKMO.LOADLIB,DISP=SHR'.        02470074
024800          10  FILLER              PIC X(40)    VALUE SPACES.      02480074
024900      05  JL-JCL-LINE-4-TEST.                                     02490074
025000          10  FILLER              PIC X(40)    VALUE              02500074
025100               '//JOBLIB    DD DSN=TKMA.LOADLIB,DISP=SHR'.        02510074
025200          10  FILLER              PIC X(40)    VALUE SPACES.      02520074
025700      05  JL-JCL-LINE-6.                                          02570074
025800          10  FILLER              PIC X(16)    VALUE              02580074
025900              '//PS020    EXEC '.                                 02590074
026000          10  JL-LINE-6-PROC      PIC X(07)    VALUE SPACES.      02600074
026100          10  JL-LINE-6-PROC-T    PIC X(01)    VALUE SPACE.       02610074
026200          10  FILLER              PIC X(56)    VALUE SPACES.      02620074
026300      05  JL-JCL-LINE-7.                                          02630074
026400          10  FILLER              PIC X(18)    VALUE              02640074
026500              '//S010.SYSUT1 DD *'.                               02650074
026600          10  FILLER              PIC X(62)    VALUE SPACES.      02660074
026700      05  JL-JCL-LINE-8.                                          02670074
026800          10  JL-LINE-8-USER-ID   PIC X(07)    VALUE SPACES.      02680074
026900          10  FILLER              PIC X(01)    VALUE SPACES.      02690074
027000          10  JL-LINE-8-DC-NUMBER PIC X(04)    VALUE SPACES.      02700074
027100          10  FILLER              PIC X(01)    VALUE SPACES.      02710074
027200          10  JL-LINE-8-RPT-1     PIC X(01)    VALUE SPACES.      02720074
027300          10  JL-LINE-8-RPT-2     PIC X(01)    VALUE SPACES.      02730074
027400          10  JL-LINE-8-INFOPAC   PIC X(01)    VALUE SPACES.      02740074
027500          10  JL-LINE-8-PRINTER   PIC X(08)    VALUE SPACES.      02750074
027600          10  JL-LINE-8-PRTR-CNTL PIC X(01)    VALUE SPACES.      02760074
027700          10  JL-LINE-8-TRACK-NBR PIC 9(01)    VALUE ZEROES.      02770074
027800          10  FILLER              PIC X(54)    VALUE SPACES.      02780074
027900*DP   05  JL-JCL-AUTO-SCHD.                                       02790074
028000*DP       10  FILLER              PIC X(40)    VALUE              02800074
028100*DP           '//$AUTO    EXEC PGM=$A,COND=(4,LE),PARM='.         02810074
028200*DP       10  FILLER              PIC X(01)    VALUE QUOTE.       02820074
028300*DP       10  FILLER              PIC X(01)    VALUE '>'.         02830074
028400*DP       10  FILLER              PIC X(01)    VALUE QUOTE.       02840074
028500*DP       10  FILLER              PIC X(37)    VALUE SPACES.      02850074
028600      05  JL-JCL-LINE-EOF.                                        02860074
028700          10  FILLER              PIC X(5)     VALUE '/*EOF'.     02870074
028800          10  FILLER              PIC X(75)    VALUE SPACES.      02880074
028900                                                                  02890074
029000                                                                  02900074
029100*-----------------------------------------------------------------02910074
029200*                                                                 02920074
029300*-----------------------------------------------------------------02930074
029400 01  RF-ROLLBACK-FAILURE-MESSAGE.                                 02940074
029500     05  FILLER                  PIC X(5)     VALUE SPACES.       02950074
029600     05  FILLER                  PIC X(61)    VALUE               02960074
029700     '**  THE ATTEMPTED ROLLBACK FAILED  **'.                     02970074
029800     05  FILLER                  PIC X(10)    VALUE 'EIBRESP = '. 02980074
029900     05  RF-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         02990074
030000                                                                  03000074
030100*-----------------------------------------------------------------03010074
030200*                                                                 03020074
030300*-----------------------------------------------------------------03030074
030400 01  IC-ISO-CURRENT-DATE-AREA.                                    03040074
030500     05  IC-ISO-CURRENT-DATE-X.                                   03050074
030600         10  IC-CURRENT-YEAR     PIC 9(4)     VALUE ZERO.         03060074
030700         10  FILLER              PIC X(6)     VALUE SPACES.       03070074
030800     05  FILLER                  REDEFINES IC-ISO-CURRENT-DATE-X. 03080074
030900         10  FILLER              PIC X(2).                        03090074
031000         10  IC-CURRENT-YY-MM-DD PIC X(8).                        03100074
031100     05  IC-ISO-CURRENT-DATE     REDEFINES IC-ISO-CURRENT-DATE-X  03110074
031200                                 PIC X(10).                       03120074
031300                                                                  03130074
031400*-----------------------------------------------------------------03140074
031500*                                                                 03150074
031600*-----------------------------------------------------------------03160074
031700 01  SE-SYSTEM-ERROR-MESSAGE.                                     03170074
031800     05  FILLER                  PIC X(51)    VALUE               03180074
031900         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - PROGRAM '.   03190074
032000     05  SE-CURRENT-PROGRAM-NAME PIC X(8)     VALUE SPACES.       03200074
032100     05  FILLER                  PIC X(7)     VALUE SPACES.       03210074
032200     05  FILLER                  PIC X(10)    VALUE 'EIBRESP = '. 03220074
032300     05  SE-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         03230074
032400     05  FILLER                  PIC X(5)     VALUE SPACES.       03240074
032500     05  FILLER                  PIC X(14)    VALUE               03250074
032600         'ATTEMPTING TO '.                                        03260074
032700     05  SE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       03270074
032800                                                                  03280074
032900*-----------------------------------------------------------------03290074
033000*                                                                 03300074
033100*-----------------------------------------------------------------03310074
033200 01  DRU-DB2-RESOURCE-UNAVAIL-MSG.                                03320074
033300     05  FILLER                  PIC X(85)    VALUE               03330074
033400         'A RESOURCE WAS NOT AVAILABLE.  PLEASE TRY AGAIN.'.      03340074
033500     05  FILLER                  PIC X(45)    VALUE               03350074
033600         'IF THE PROBLEM PERSISTS, CONTACT DP (PROGRAM '.         03360074
033700     05  DRU-CURRENT-PROGRAM-NAME                                 03370074
033800                                 PIC X(8)     VALUE SPACES.       03380074
033900     05  FILLER                  PIC X(22)    VALUE ').'.         03390074
034000                                                                  03400074
034100 01  DE-DB2-ERROR-MESSAGE.                                        03410074
034200     05  FILLER                  PIC X(48)    VALUE               03420074
034300         'A DB2 ERROR HAS OCCURRED - CONTACT DP - PROGRAM '.      03430074
034400     05  DE-CURRENT-PROGRAM-NAME PIC X(8)     VALUE SPACES.       03440074
034500     05  FILLER                  PIC X(29)    VALUE SPACES.       03450074
034600     05  FILLER                  PIC X(11)    VALUE               03460074
034700         'SQLCODE = ('.                                           03470074
034800     05  DE-SQLCODE              PIC Z(8)9-   VALUE ZERO.         03480074
034900     05  FILLER                  PIC X(21)    VALUE               03490074
035000         ')  ROWS PROCESSED = ('.                                 03500074
035100     05  DE-ROWS-PROCESSED       PIC Z(8)9-   VALUE ZERO.         03510074
035200     05  FILLER                  PIC X(23)    VALUE ')'.          03520074
035300     05  FILLER                  PIC X(5)     VALUE SPACES.       03530074
035400     05  FILLER                  PIC X(14)    VALUE               03540074
035500         'ATTEMPTING TO '.                                        03550074
035600     05  DE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       03560074
035700                                                                  03570074
035800 01  DW-DB2-WARNING-MESSAGE.                                      03580074
035900     05  FILLER                  PIC X(50)    VALUE               03590074
036000         'A DB2 WARNING HAS OCCURRED - CONTACT DP - PROGRAM '.    03600074
036100     05  DW-CURRENT-PROGRAM-NAME PIC X(8)     VALUE SPACES.       03610074
036200     05  FILLER                  PIC X(27)    VALUE SPACES.       03620074
036300     05  FILLER                  PIC X(11)    VALUE               03630074
036400         'SQLCODE = ('.                                           03640074
036500     05  DW-SQLCODE              PIC Z(8)9-   VALUE ZERO.         03650074
036600     05  FILLER                  PIC X(21)    VALUE               03660074
036700         ')  ROWS PROCESSED = ('.                                 03670074
036800     05  DW-ROWS-PROCESSED       PIC Z(8)9-   VALUE ZERO.         03680074
036900     05  FILLER                  PIC X(14)    VALUE               03690074
037000         ')  SQLWARN = ('.                                        03700074
037100     05  DW-SQLWARN              PIC X(8)     VALUE SPACES.       03710074
037200     05  FILLER                  PIC X(1)     VALUE ')'.          03720074
037300     05  FILLER                  PIC X(5)     VALUE SPACES.       03730074
037400     05  FILLER                  PIC X(14)    VALUE               03740074
037500         'ATTEMPTING TO '.                                        03750074
037600     05  DW-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       03760074
037700                                                                  03770074
037800 01  ST-SYSTEM-TIME-AREA.                                         03780074
037900     05  ST-ABSTIME              PIC S9(18)   VALUE ZERO          03790074
038000                                 COMP SYNC.                       03800074
038100     05  ST-TIME-EDIT.                                            03810074
038200         10  ST-TIME-HHMM        PIC X(5)     VALUE SPACES.       03820074
038300         10  FILLER              PIC X(3)     VALUE SPACES.       03830074
038400                                                                  03840074
038500                                                                  03850074
038600*-----------------------------------------------------------------03860074
038700*    STANDARD COMAREA DEFINITION                                  03870074
038800*-----------------------------------------------------------------03880074
038900     COPY DPWS030.                                                03890074
1122RM     COPY DPWS930.                                                03891083
039000     COPY DPWS020.                                                03900074
039100    05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                 03910074
039200*----------------------------------------------------------------*03920074
039300*       APPLICATION COMMAREA.                                    *03930074
039400*----------------------------------------------------------------*03940074
039500         10  INTER-APPL-COMM-AREA.                                03950074
039600             15  FILLER                      PIC X(02).           03960074
039700             15  ACA-OPER-UNIT-ID            PIC X(04).           03970074
039800             15  ACA-OPER-UNIT-ID-N REDEFINES                     03980074
039900                 ACA-OPER-UNIT-ID            PIC 9(04).           03990074
040000             15  ACA-FCLTY-ID                PIC X(04).           04000074
040100             15  ACA-FCLTY-ID-N REDEFINES                         04010074
040200                 ACA-FCLTY-ID                PIC 9(04).           04020074
040300             15  ACA-FCLTY-NAME              PIC X(24).           04030074
040400             15  ACA-ZONE                    PIC X(01).           04040074
040500             15  ACA-P2L                     PIC X(01).           04050074
040600             15  ACA-TO-INFOPAC              PIC X(01).           04060074
040700             15  ACA-PRINTER-DESTINATION     PIC X(08).           04070074
040800             15  ACA-ORIG-OPER-UNIT-ID       PIC X(04).           04080074
040900             15  FILLER                      PIC X(151).          04090074
041000*-------------------------------------------------------------*   04100074
041100*    APPLICATION SPECIFIC COMMAREA.                           *   04110074
041200*-------------------------------------------------------------*   04120074
041300         10  ASC-PGM-SPECIFIC-COMAREA.                            04130074
041400             15  FILLER                    PIC X(02).             04140074
041500             15  ASC-OPER-UNT-ID           PIC X(04).             04150074
041600             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      04160074
041700                                           PIC 9(04).             04170074
041800             15  ASC-FCLTY-ID              PIC X(04).             04180074
041900             15  ASC-FCLTY-ID-N    REDEFINES ASC-FCLTY-ID         04190074
042000                                           PIC 9(04).             04200074
042100             15  ASC-FCLTY-NME             PIC X(24).             04210074
042200             15  ASC-ZONE                  PIC X.                 04220074
042300             15  ASC-P2L                   PIC X.                 04230074
042400             15  ASC-TO-INFOPAC            PIC X.                 04240074
042500             15  ASC-PRINTER-DESTINATION   PIC X(08).             04250074
042600             15  ASC-ORIG-OPER-UNIT-ID     PIC X(04).             04260074
042700             15  FILLER                    PIC X(151).            04270074
042800         10  ASC-HOLD-INTER-APPL           PIC X(200).            04280074
042900                                                                  04290074
043000                                                                  04300074
043100*---------------------------------------------------------------- 04310074
043200*  SQL AND COBOL DECLARATIONS FOR THE STORE TABLE (XLT_LOC)       04320075
043300*---------------------------------------------------------------- 04330074
043400     EXEC SQL                                                     04340074
043500         INCLUDE XLT00010                                         04350075
043600     END-EXEC.                                                    04360074
043700                                                                  04370074
043800                                                                  04380074
044700*---------------------------------------------------------------- 04470074
044800*  SQL AND COBOL DECLARATIONS FOR THE RECEIVER TABLE (TRECEIV)    04480074
044900*---------------------------------------------------------------- 04490074
045000     EXEC SQL                                                     04500074
045100         INCLUDE TRECEIV                                          04510074
045200     END-EXEC.                                                    04520074
045300                                                                  04530074
045400                                                                  04540074
045500*---------------------------------------------------------------- 04550074
045600*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                04560074
045700*---------------------------------------------------------------- 04570074
045800     EXEC SQL                                                     04580074
045900         INCLUDE SQLCA                                            04590074
046000     END-EXEC.                                                    04600074
046100                                                                  04610074
046200                                                                  04620074
046300*---------------------------------------------------------------- 04630074
046400 LINKAGE SECTION.                                                 04640074
046500*---------------------------------------------------------------- 04650074
046600 01  DFHCOMMAREA.                                                 04660074
046700     05  FILLER                       OCCURS 1 TO 4072 TIMES      04670074
046800                                      DEPENDING ON EIBCALEN.      04680074
046900         10  FILLER                   PIC X.                      04690074
047000                                                                  04700074
047100                                                                  04710074
047200*---------------------------------------------------------------- 04720074
047300 PROCEDURE DIVISION.                                              04730074
047400*---------------------------------------------------------------- 04740074
047500 0000-MAIN-MODULE.                                                04750074
047600     INITIALIZE DP030-CICS-API-FIELDS.                            04760074
047700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04770074
047800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04780074
047900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04790074
048000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04800074
048100     MOVE LENGTH OF PC704AI        TO DP030-MAP-LENGTH (1).       04810074
048200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04820074
048300     PERFORM 0001-CALL-CICS-ARCH-API.                             04830074
048400*                                                                 04840074
048500     PERFORM 1000-CONTROL-PROCESSING                              04850074
048600                                                                  04860074
048700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04870074
048800     PERFORM 0001-CALL-CICS-ARCH-API.                             04880074
048900                                                                  04890074
049000     EJECT                                                        04900074
049100 0001-CALL-CICS-ARCH-API.                                         04910074
1122RM*    CALL PC-DPKCS030 USING DFHEIBLK                              04920083
1122RM     CALL DP930-CICS-ARCH-API                                     04921083
1122RM                     USING DFHEIBLK                               04922083
049300                            DFHCOMMAREA                           04930074
049400                            DP030-CICS-API-FIELDS                 04940074
049500                            DP020-STANDARD-COMMAREA               04950074
049600                            PC704AI.                              04960074
049700*                                                                 04970074
049800     IF  DP030-RC-CALL-SUCCESSFUL                                 04980074
049900         CONTINUE                                                 04990074
050000     ELSE                                                         05000074
050100         SET DP013-NO-ROLLBACK                                    05010074
050200             DP013-XCTL-DISPLAY-RESTART                           05020074
050300             DP013-CICS-ABEND      TO TRUE                        05030074
050400         MOVE 'BEFORE 0000-MAIN-MODULE'                           05040074
050500                                   TO DP013-PARAGRAPH             05050074
1122RM*        MOVE 'CALL TO PCKCS704 NOT SUCCESSFUL, RETURN-CODE ON NEX05060083
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      05070083
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05071083
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05072083
050800         MOVE DP030-RETURN-CODE                                   05080074
050900                                   TO DP013-MESSAGE-TEXT (3)      05090074
051000         PERFORM DP013-0000-PROCESS-ABEND                         05100074
051100     END-IF.                                                      05110074
051200                                                                  05120074
051300                                                                  05130074
051400*----------------------------------------------------------------*05140074
051500*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05150074
051600*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05160074
051700*----------------------------------------------------------------*05170074
051800 1000-CONTROL-PROCESSING.                                         05180074
051900                                                                  05190074
052000     EVALUATE TRUE                                                05200074
052100         WHEN DP020-NEXT-ACT-INITIAL                              05210074
052200             MOVE INTER-APPL-COMM-AREA  TO ASC-HOLD-INTER-APPL    05220074
052300         WHEN OTHER                                               05230074
052400             MOVE ASC-HOLD-INTER-APPL   TO INTER-APPL-COMM-AREA   05240074
052500         END-EVALUATE.                                            05250074
052600                                                                  05260074
052700     EVALUATE TRUE                                                05270074
052800         WHEN DP020-NEXT-ACT-INITIAL                              05280074
052900             INITIALIZE ASC-PGM-SPECIFIC-COMAREA                  05290074
053000             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID           05300075
053200             MOVE 0001           TO ASC-FCLTY-ID                  05320074
053300             PERFORM 3200-RESET-ATTRIBUTES                        05330074
053400             PERFORM 4000-BUILD-INITIAL-PANEL                     05340074
053500                                                                  05350074
053600         WHEN DP020-NEXT-ACT-READ-MAP                             05360074
053700             PERFORM 2000-FKEY-PROCESSING                         05370074
053800                                                                  05380074
053900         WHEN DP020-NEXT-ACT-RETURN                               05390074
054000             PERFORM 4400-MOVE-COMAREA-TO-SCREEN                  05400074
054100             PERFORM 3000-EDIT-DATA-IN-COMAREA                    05410074
054200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05420074
054300             MOVE -1      TO MZONEL                               05430074
054400                                                                  05440074
054500         WHEN OTHER                                               05450074
054600             SET DP013-LOGIC-ABEND                                05460074
054700                 DP013-NO-ROLLBACK TO TRUE                        05470074
054800             MOVE '1000-CONTROL-PROCESSING'                       05480074
054900                                   TO  DP013-PARAGRAPH            05490074
055000             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05500074
055100                                   TO  DP013-MESSAGE-TEXT(1)      05510074
055200             MOVE DP020-NEXT-APPL-ACTIVITY                        05520074
055300                                   TO DP013-MESSAGE-TEXT(2)       05530074
055400             PERFORM DP013-0000-PROCESS-ABEND                     05540074
055500     END-EVALUATE.                                                05550074
055600                                                                  05560074
055700                                                                  05570074
055800*----------------------------------------------------------------*05580074
055900* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*05590074
056000* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*05600074
056100* EDITS.                                                         *05610074
056200*----------------------------------------------------------------*05620074
056300 2000-FKEY-PROCESSING.                                            05630074
056400                                                                  05640074
056500     EVALUATE TRUE                                                05650074
056600                                                                  05660074
056700         WHEN DP020-SRC-AID = DP016-CLEAR                         05670074
056800             PERFORM 3000-EDIT-DATA-IN-COMAREA                    05680074
056900                                                                  05690074
057000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05700074
057100             INITIALIZE ASC-PGM-SPECIFIC-COMAREA                  05710074
057110             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID           05711075
057400             MOVE 0001           TO ASC-FCLTY-ID                  05740074
057500             PERFORM 4000-BUILD-INITIAL-PANEL                     05750074
057600             PERFORM 3200-RESET-ATTRIBUTES                        05760074
057700                                                                  05770074
057800                                                                  05780074
057900         WHEN OTHER                                               05790074
058000             PERFORM 2200-MOVE-SCREEN-TO-COMAREA                  05800074
058100             PERFORM 3000-EDIT-DATA-IN-COMAREA                    05810074
058200             IF  PS-NO-EDIT-ERROR                                 05820074
058300                 SET DP030-CONTINUE-GO TO TRUE                    05830074
058400                 MOVE -1      TO MZONEL                           05840074
058500                 PERFORM 2100-CHECK-FUNCTION-KEY                  05850074
058600             ELSE                                                 05860074
058700                 SET DP030-OVERRIDE-GO TO TRUE                    05870074
058800             END-IF                                               05880074
058900     END-EVALUATE.                                                05890074
059000                                                                  05900074
059100                                                                  05910074
059200*---------------------------------------------------------------- 05920074
059300*  PERFORM THIS PARAGRAPH AFTER ALL THE EDITS HAVE BEEN MADE AND  05930074
059400*  THEN CHECK THE INT-APPL-FORMAT-IND TO SEE WHAT PF KEY HAS BEEN 05940074
059500*  SELECTED.                                                      05950074
059600*                                                                 05960074
059700*  CURRENTLY PROGRAM IS ONLY SET UP FOR ENTER & F18 KEYS.         05970074
059800*     ENTER - ONLY EDITS SCREEN                                   05980074
059900*     F18 --- REQUEST REPORTS TO PRINT                            05990074
060000*---------------------------------------------------------------- 06000074
060100 2100-CHECK-FUNCTION-KEY.                                         06010074
060200     EVALUATE TRUE                                                06020074
060300         WHEN DP020-SRC-AID = DP016-ENTER                         06030074
060400              CONTINUE                                            06040074
060500         WHEN DP020-SRC-AID = DP016-PF18                          06050074
060600              PERFORM 4600-SUBMIT-JOB                             06060074
060700     END-EVALUATE.                                                06070074
060800                                                                  06080074
060900                                                                  06090074
061000*----------------------------------------------------------------*06100074
061100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06110074
061200* THE APPLICATION-SPECIFIC COMAREA.   ALL EDITS ARE DONE IN THE  *06120074
061300* APPLICATION-SPECIFIC COMAREA, NOT ON THE SCREEN.               *06130074
061400*----------------------------------------------------------------*06140074
061500 2200-MOVE-SCREEN-TO-COMAREA.                                     06150074
061600                                                                  06160074
061700     IF  MOPIDL > ZERO                                            06170074
061800         MOVE MOPIDI               TO ASC-OPER-UNT-ID             06180074
061900     ELSE                                                         06190074
062000         IF  MOPIDF = DP015-ERASE-EOF                             06200074
062100             MOVE SPACE            TO ASC-OPER-UNT-ID             06210074
062200         END-IF                                                   06220074
062300     END-IF.                                                      06230074
062400                                                                  06240074
062500     IF  MFACIDL > ZERO                                           06250074
062600         MOVE MFACIDI              TO ASC-FCLTY-ID                06260074
062700     ELSE                                                         06270074
062800         IF  MFACIDF = DP015-ERASE-EOF                            06280074
062900             MOVE SPACE            TO ASC-FCLTY-ID                06290074
063000         END-IF                                                   06300074
063100     END-IF.                                                      06310074
063200                                                                  06320074
063300     IF  MZONEL > ZERO                                            06330074
063400         MOVE MZONEI               TO ASC-ZONE                    06340074
063500     ELSE                                                         06350074
063600         IF  MZONEF = DP015-ERASE-EOF                             06360074
063700             MOVE SPACE            TO ASC-ZONE                    06370074
063800         END-IF                                                   06380074
063900     END-IF.                                                      06390074
064000                                                                  06400074
064100     IF  MP2LL  > ZERO                                            06410074
064200         MOVE MP2LI                TO ASC-P2L                     06420074
064300     ELSE                                                         06430074
064400         IF  MP2LF  = DP015-ERASE-EOF                             06440074
064500             MOVE SPACE            TO ASC-P2L                     06450074
064600         END-IF                                                   06460074
064700     END-IF.                                                      06470074
064800                                                                  06480074
064900     IF  MINFOL   > ZERO                                          06490074
065000         MOVE MINFOI               TO ASC-TO-INFOPAC              06500074
065100     ELSE                                                         06510074
065200         IF  MINFOF   = DP015-ERASE-EOF                           06520074
065300             MOVE SPACE            TO ASC-TO-INFOPAC              06530074
065400         END-IF                                                   06540074
065500     END-IF.                                                      06550074
065600                                                                  06560074
065700     IF  MPRTIDL > ZERO                                           06570074
065800         MOVE MPRTIDI              TO ASC-PRINTER-DESTINATION     06580074
065900     ELSE                                                         06590074
066000         IF  MPRTIDF = DP015-ERASE-EOF                            06600074
066100             MOVE SPACE            TO ASC-PRINTER-DESTINATION     06610074
066200         END-IF                                                   06620074
066300     END-IF.                                                      06630074
066400                                                                  06640074
066500                                                                  06650074
066600                                                                  06660074
066700*----------------------------------------------------------------*06670074
066800* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *06680074
066900* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *06690074
067000* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*06700074
067100* IN THE DESTINATION PROGRAM, NOT HERE.                          *06710074
067200*----------------------------------------------------------------*06720074
067300 3000-EDIT-DATA-IN-COMAREA.                                       06730074
067400                                                                  06740074
067500     PERFORM 3200-RESET-ATTRIBUTES.                               06750074
067600                                                                  06760074
067700*                                                                 06770074
067800*** VALIDATE OPERATING UNIT ID                                    06780074
067900*                                                                 06790074
068000     IF  ASC-OPER-UNT-ID  > SPACE                                 06800074
068100         MOVE ASC-OPER-UNT-ID      TO DP010I-UNEDITED-FIELD       06810074
068200         MOVE LENGTH OF ASC-OPER-UNT-ID  TO DP010I-MAXIMUM-DIGITS 06820074
068300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     06830074
068400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06840074
068510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06851080
068520                         USING DP010I-NUMERIC-EDIT-AREA           06852080
068600         IF  DP010I-ERROR-DETECTED                                06860074
068700             SET PS-EDIT-ERROR                                    06870074
068800                 DP020-MSG-FATAL   TO TRUE                        06880074
068900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06890074
069000             MOVE DP015-UNP-ALP-BRT-OFF                           06900074
069100                                   TO MOPIDA                      06910074
069200             MOVE DP015-RED        TO MOPIDC                      06920074
069300             MOVE DP015-REVERSE    TO MOPIDH                      06930074
069400             MOVE -1               TO MOPIDL                      06940074
069500             MOVE SPACES           TO ASC-FCLTY-NME               06950074
069600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06960074
069700         ELSE                                                     06970074
069800             MOVE DP010I-NUMERIC-FIELD                            06980074
069900                                   TO ASC-OPER-UNT-ID-N           06990074
070000                                      DK-OPER-UNT-ID              07000074
070100             MOVE ASC-OPER-UNT-ID  TO MOPIDO                      07010074
070200     ELSE                                                         07020074
070300         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            07030074
070400         MOVE DP015-UNP-ALP-BRT-OFF                               07040074
070500                                   TO MOPIDA                      07050074
070600         MOVE DP015-RED            TO MOPIDC                      07060074
070700         MOVE DP015-REVERSE        TO MOPIDH                      07070074
070800         MOVE -1                   TO MOPIDL                      07080074
070900         MOVE SPACES               TO ASC-FCLTY-NME               07090074
071000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07100074
071100     END-IF.                                                      07110074
071200                                                                  07120074
071300*                                                                 07130074
071400*** VALIDATE FACILITY ID                                          07140074
071500*                                                                 07150074
071600     IF  ASC-FCLTY-ID     > SPACE                                 07160074
071700         MOVE ASC-FCLTY-ID         TO DP010I-UNEDITED-FIELD       07170074
071800         MOVE LENGTH OF ASC-FCLTY-ID     TO DP010I-MAXIMUM-DIGITS 07180074
071900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     07190074
072000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07200074
072110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07211080
072120                         USING DP010I-NUMERIC-EDIT-AREA           07212080
072200         IF  DP010I-ERROR-DETECTED                                07220074
072300             SET PS-EDIT-ERROR                                    07230074
072400                 DP020-MSG-FATAL   TO TRUE                        07240074
072500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07250074
072600             MOVE DP015-UNP-ALP-BRT-OFF                           07260074
072700                                   TO MFACIDA                     07270074
072800             MOVE DP015-RED        TO MFACIDC                     07280074
072900             MOVE DP015-REVERSE    TO MFACIDH                     07290074
073000             MOVE -1               TO MFACIDL                     07300074
073100             MOVE SPACES           TO ASC-FCLTY-NME               07310074
073200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07320074
073300         ELSE                                                     07330074
073400             MOVE DP010I-NUMERIC-FIELD                            07340074
073500                                   TO ASC-FCLTY-ID-N              07350074
073600                                      DK-FCLTY-ID                 07360074
073700     ELSE                                                         07370074
073800         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            07380074
073900         MOVE DP015-UNP-ALP-BRT-OFF                               07390074
074000                               TO MFACIDA                         07400074
074100         MOVE DP015-RED            TO MFACIDC                     07410074
074200         MOVE DP015-REVERSE        TO MFACIDH                     07420074
074300         MOVE -1                   TO MFACIDL                     07430074
074400         MOVE SPACES               TO ASC-FCLTY-NME               07440074
074500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07450074
074600     END-IF.                                                      07460074
074700                                                                  07470074
074800     IF  PS-NO-EDIT-ERROR                                         07480074
074900         IF  ASC-OPER-UNT-ID = SPACES                             07490074
075000             CONTINUE                                             07500074
075100         ELSE                                                     07510074
075200             MOVE ASC-OPER-UNT-ID      TO XLT00010-LOC-NBR        07520075
075300             PERFORM 3400-VALIDATE-OPER-UNT-ID                    07530074
075400             IF  PS-EDIT-ERROR                                    07540074
075500                 SET DP020-MSG-FATAL   TO TRUE                    07550074
075600                MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER         07560074
075700                 MOVE DP015-UNP-ALP-BRT-OFF                       07570074
075800                                       TO MOPIDA                  07580074
075900                 MOVE DP015-RED        TO MOPIDC                  07590074
076000                 MOVE DP015-REVERSE    TO MOPIDH                  07600074
076100                 MOVE -1               TO MOPIDL                  07610074
076200                 MOVE SPACES           TO ASC-FCLTY-NME           07620074
076300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07630074
076400             ELSE                                                 07640074
076500                 IF  ASC-FCLTY-ID = SPACES                        07650074
076600                     CONTINUE                                     07660074
076700                 ELSE                                             07670074
076800                     PERFORM 3500-VALIDATE-FCLTY-ID               07680074
076900                     IF  PS-EDIT-ERROR                            07690074
077000                         SET DP020-MSG-FATAL   TO TRUE            07700074
077100                         MOVE PC-TSYMSG-00005  TO                 07710074
077200                                               DP020-MSG-NUMBER   07720074
077300                         MOVE DP015-UNP-ALP-BRT-OFF               07730074
077400                                               TO MFACIDA         07740074
077500                         MOVE DP015-RED        TO MFACIDC         07750074
077600                         MOVE DP015-REVERSE    TO MFACIDH         07760074
077700                         MOVE -1               TO MFACIDL         07770074
077800                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      07780074
077900                     END-IF                                       07790074
078000                 END-IF                                           07800074
078100             END-IF                                               07810074
078200         END-IF                                                   07820074
078300     END-IF.                                                      07830074
078400                                                                  07840074
078500                                                                  07850074
078600*                                                                 07860074
078700*** VALIDATE ZONE - IF SELECTED MUST BE "S" OR 'X'                07870074
078800*                                                                 07880074
078900     IF  ASC-ZONE        > SPACE  AND                             07890074
079000         (ASC-ZONE  NOT EQUAL 'S' AND NOT = 'X')                  07900074
079100             SET PS-EDIT-ERROR                                    07910074
079200                 DP020-MSG-FATAL   TO TRUE                        07920074
079300             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            07930074
079400             MOVE DP015-UNP-ALP-BRT-MDT                           07940074
079500                                   TO MZONEA                      07950074
079600             MOVE DP015-RED        TO MZONEC                      07960074
079700             MOVE DP015-REVERSE    TO MZONEH                      07970074
079800             MOVE -1               TO MZONEL                      07980074
079900             MOVE SPACES           TO ASC-ZONE                    07990074
080000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08000074
080100     END-IF.                                                      08010074
080200                                                                  08020074
080300                                                                  08030074
080400*                                                                 08040074
080500*** VALIDATE P2L - IF SELECTED MUST BE "S"                        08050074
080600*                                                                 08060074
080700     IF  ASC-P2L         > SPACE   AND                            08070074
080800        (ASC-P2L   NOT EQUAL 'S' AND NOT = 'X')                   08080074
080900             SET PS-EDIT-ERROR                                    08090074
081000                 DP020-MSG-FATAL   TO TRUE                        08100074
081100             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            08110074
081200             MOVE DP015-UNP-ALP-BRT-MDT                           08120074
081300                                   TO MP2LA                       08130074
081400             MOVE DP015-RED        TO MP2LC                       08140074
081500             MOVE DP015-REVERSE    TO MP2LH                       08150074
081600             MOVE -1               TO MP2LL                       08160074
081700             MOVE SPACES           TO ASC-P2L                     08170074
081800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08180074
081900     END-IF.                                                      08190074
082000                                                                  08200074
082100                                                                  08210074
082200*                                                                 08220074
082300*** VALIDATE TO-INFOPAC - IF SELECTED MUST BE "Y"                 08230074
082400***   IF GOING TO A PRINTER CAN BE - 'N' OR SPACE.                08240074
082500*                                                                 08250074
082600     IF  ASC-TO-INFOPAC  > SPACE       AND                        08260074
082700         (ASC-TO-INFOPAC NOT EQUAL 'N'  AND                       08270074
082800          ASC-TO-INFOPAC NOT EQUAL 'Y')                           08280074
082900             SET PS-EDIT-ERROR                                    08290074
083000                 DP020-MSG-FATAL   TO TRUE                        08300074
083100             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            08310074
083200             MOVE DP015-UNP-ALP-BRT-MDT                           08320074
083300                                   TO MINFOA                      08330074
083400             MOVE DP015-RED        TO MINFOC                      08340074
083500             MOVE DP015-REVERSE    TO MINFOH                      08350074
083600             MOVE -1               TO MINFOL                      08360074
083700             MOVE SPACES           TO ASC-TO-INFOPAC              08370074
083800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08380074
083900     END-IF.                                                      08390074
084000                                                                  08400074
084100                                                                  08410074
084200*                                                                 08420074
084300*** VERIFY THAT REPORT DESTINATION HAS BEEN SELECTED.             08430074
084400*                                                                 08440074
084500     IF  ASC-TO-INFOPAC  NOT =  'N'  AND                          08450074
084600         ASC-TO-INFOPAC  NOT =  'Y'  AND                          08460074
084700         ASC-PRINTER-DESTINATION  NOT > SPACE                     08470074
084800             SET PS-EDIT-ERROR                                    08480074
084900                 DP020-MSG-FATAL   TO TRUE                        08490074
085000             MOVE PC-TSYMSG-01736  TO DP020-MSG-NUMBER            08500074
085100             MOVE DP015-UNP-ALP-BRT-MDT                           08510074
085200                                   TO MINFOA                      08520074
085300                                      MPRTIDA                     08530074
085400             MOVE DP015-RED        TO MINFOC                      08540074
085500                                      MPRTIDC                     08550074
085600             MOVE DP015-REVERSE    TO MINFOH                      08560074
085700                                      MPRTIDH                     08570074
085800             MOVE -1               TO MINFOL                      08580074
085900                                      MPRTIDL                     08590074
086000             MOVE SPACES           TO ASC-TO-INFOPAC              08600074
086100                                      ASC-PRINTER-DESTINATION     08610074
086200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08620074
086300     END-IF.                                                      08630074
086400                                                                  08640074
086500                                                                  08650074
086600*                                                                 08660074
086700*** VERIFY ONLY ONE REPORT DESTINATION HAS BEEN SELECTED          08670074
086800*                                                                 08680074
086900     IF  ASC-PRINTER-DESTINATION   >  SPACE  AND                  08690074
087000         ASC-TO-INFOPAC  = 'Y'                                    08700074
087100             SET PS-EDIT-ERROR                                    08710074
087200                 DP020-MSG-FATAL   TO TRUE                        08720074
087300             MOVE PC-TSYMSG-01737  TO DP020-MSG-NUMBER            08730074
087400             MOVE DP015-UNP-ALP-BRT-MDT                           08740074
087500                                   TO MINFOA                      08750074
087600             MOVE DP015-RED        TO MINFOC                      08760074
087700             MOVE DP015-RED        TO MPRTIDC                     08770074
087800             MOVE DP015-REVERSE    TO MINFOH                      08780074
087900             MOVE DP015-REVERSE    TO MPRTIDH                     08790074
088000             MOVE -1               TO MINFOL                      08800074
088100             MOVE SPACES           TO ASC-TO-INFOPAC              08810074
088200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08820074
088300     END-IF.                                                      08830074
088400                                                                  08840074
088500                                                                  08850074
088600*                                                                 08860074
088700*** IF GOING TO A PRINTER (INFOPAC = 'N' OR SPACE) PRINTER        08870074
088800*** DESTINATION NEEDS TO BE FILLED IN.                            08880074
088900*                                                                 08890074
089000     IF   ASC-TO-INFOPAC  = 'N'         AND                       08900074
089100         ASC-PRINTER-DESTINATION  NOT >  SPACE                    08910074
089200             SET PS-EDIT-ERROR                                    08920074
089300                 DP020-MSG-FATAL   TO TRUE                        08930074
089400             MOVE PC-TSYMSG-01563  TO DP020-MSG-NUMBER            08940074
089500             MOVE DP015-UNP-ALP-BRT-MDT                           08950074
089600                                   TO MPRTIDA                     08960074
089700             MOVE DP015-RED        TO MPRTIDC                     08970074
089800             MOVE DP015-REVERSE    TO MPRTIDH                     08980074
089900             MOVE -1               TO MPRTIDL                     08990074
090000             MOVE SPACES           TO ASC-PRINTER-DESTINATION     09000074
090100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09010074
090200     END-IF.                                                      09020074
090300                                                                  09030074
090400                                                                  09040074
090500*                                                                 09050074
090600*** IF PRINTER DESTINATION SELECTED AND TO-INFOPAC = 'N' OR SPACE 09060074
090700***   VALIDATE PRINTER ID                                         09070074
090800*                                                                 09080074
090900     IF   ASC-PRINTER-DESTINATION > SPACES  AND                   09090074
091000          ASC-TO-INFOPAC    NOT =  'Y'                            09100074
091100          PERFORM 3600-VALIDATE-PRINTER                           09110074
091200              IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'          09120074
091300                 CONTINUE                                         09130074
091400              ELSE                                                09140074
091500                 SET PS-EDIT-ERROR                                09150074
091600                     DP020-MSG-FATAL                              09160074
091700                                  TO TRUE                         09170074
091800                 MOVE PC-TSYMSG-00746                             09180074
091900                                  TO DP020-MSG-NUMBER             09190074
092000                     MOVE DP015-UNP-ALP-BRT-MDT                   09200074
092100                                  TO MPRTIDA                      09210074
092200                                     MINFOA                       09220074
092300                 MOVE DP015-RED   TO MPRTIDC                      09230074
092400                 MOVE DP015-REVERSE                               09240074
092500                                  TO MPRTIDH                      09250074
092600                 MOVE -1          TO MPRTIDL                      09260074
092700                 MOVE SPACES      TO ASC-PRINTER-DESTINATION      09270074
092800                 SET DP030-SET-CURSOR-APPL-1                      09280074
092900                                  TO TRUE                         09290074
093000              END-IF                                              09300074
093100     END-IF.                                                      09310074
093200                                                                  09320074
093300                                                                  09330074
093400*                                                                 09340074
093500*** REPORT FORMAT MUST BE SELECTED                                09350074
093600*                                                                 09360074
093700     IF   ASC-ZONE  =  SPACE  AND                                 09370074
093800          ASC-P2L   =  SPACE                                      09380074
093900             SET PS-EDIT-ERROR                                    09390074
094000                 DP020-MSG-FATAL   TO TRUE                        09400074
094100             MOVE PC-TSYMSG-01738  TO DP020-MSG-NUMBER            09410074
094200             MOVE DP015-UNP-ALP-BRT-MDT                           09420074
094300                                   TO MZONEA                      09430074
094400                                      MP2LA                       09440074
094500             MOVE DP015-RED        TO MZONEC                      09450074
094600                                      MP2LC                       09460074
094700             MOVE DP015-REVERSE    TO MZONEH                      09470074
094800                                      MP2LH                       09480074
094900             MOVE -1               TO MZONEL                      09490074
095000                                      MP2LL                       09500074
095100             MOVE SPACES           TO ASC-ZONE                    09510074
095200                                      ASC-P2L                     09520074
095300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09530074
095400     END-IF.                                                      09540074
095500                                                                  09550074
095600                                                                  09560074
095700*                                                                 09570074
095800***                                                               09580074
095900*                                                                 09590074
096000*    IF  PS-NO-EDIT-ERROR                                         09600074
096100*        MOVE ASC-PGM-SPECIFIC-COMAREA TO INTER-APPL-COMM-AREA    09610074
096200*        PERFORM 4400-MOVE-COMAREA-TO-SCREEN                      09620074
096300*        SET DP030-SET-CURSOR-APPL-1 TO TRUE                      09630074
096400*    END-IF.                                                      09640074
096500                                                                  09650074
096600     MOVE ASC-PGM-SPECIFIC-COMAREA TO INTER-APPL-COMM-AREA        09660074
096700     PERFORM 4400-MOVE-COMAREA-TO-SCREEN                          09670074
096800     MOVE -1                       TO MZONEL                      09680074
096900     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         09690074
097000                                                                  09700074
097100                                                                  09710074
097200*---------------------------------------------------------------- 09720074
097300** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **09730074
097400** MAP.                                                         **09740074
097500*---------------------------------------------------------------- 09750074
097600 3200-RESET-ATTRIBUTES.                                           09760074
097700                                                                  09770074
097800     MOVE DP015-UNP-ALP-NOR-MDT    TO MOPIDA                      09780074
097900                                      MFACIDA                     09790074
098000     MOVE DP015-UNP-ALP-NOR-OFF    TO MZONEA                      09800074
098100                                      MP2LA                       09810074
098200                                      MINFOA                      09820074
098300                                      MPRTIDA                     09830074
098400     MOVE DP015-UNDERLINE          TO MOPIDH                      09840074
098500                                      MFACIDH                     09850074
098600                                      MZONEH                      09860074
098700                                      MP2LH                       09870074
098800                                      MINFOH                      09880074
098900                                      MPRTIDH.                    09890074
099000      MOVE DP015-GREEN             TO MOPIDC                      09900074
099100                                      MFACIDC                     09910074
099200                                      MZONEC                      09920074
099300                                      MP2LC                       09930074
099400                                      MINFOC                      09940074
099500                                      MPRTIDC.                    09950074
099600                                                                  09960074
099700                                                                  09970074
099800*----------------------------------------------------------------*09980074
099900*  VALIDATE THE OPERATING UNIT ID TO MAKE SURE THAT IT IS A      *09990074
100000*  VALID DISTRIBUTION CENTER.                                    *10000074
100100*----------------------------------------------------------------*10010074
100200 3400-VALIDATE-OPER-UNT-ID.                                       10020074
100300                                                                  10030074
100400     PERFORM                                                      10040074
100500         WITH TEST AFTER                                          10050074
100600         VARYING PV-SQL-SUB                                       10060074
100700         FROM 1 BY 1                                              10070074
100800         UNTIL  (PV-SQL-SUB > PC-MAX-RETRIES                      10080074
100900            OR   SQLCODE = +0                                     10090074
101000            OR   SQLCODE = +100)                                  10100074
101100                                                                  10110074
101200         EXEC SQL                                                 10120074
101300            SELECT LOC_5_ABBR_NM                                  10130075
101400              INTO :XLT00010-LOC-5-ABBR-NM                        10140075
101500              FROM XLT_LOC                                        10150075
101600             WHERE LOC_TYP_CDE  = 'DC'                            10160075
101700               AND LOC_NBR      = :XLT00010-LOC-NBR               10170075
101900         END-EXEC                                                 10190074
102000                                                                  10200074
102100         EVALUATE TRUE                                            10210074
102200             WHEN SQLCODE = -904                                  10220074
102300             WHEN SQLCODE = -913                                  10230074
102400                 CONTINUE                                         10240074
102500             WHEN SQLCODE = +100                                  10250074
102600                 SET PS-EDIT-ERROR TO TRUE                        10260074
102700             WHEN SQLCODE = +0                                    10270074
102800                 CONTINUE                                         10280074
102900             WHEN SQLCODE < +0                                    10290074
103000             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     10300074
103100             WHEN SQLWARN0 NOT = SPACES                           10310074
103200                  MOVE '3400-VALIDATE-OPER-UNT-ID'                10320074
103300                                   TO DP013-PARAGRAPH             10330074
103400                  MOVE 'SELECT OPERATING UNIT ID'                 10340074
103500                                   TO DP013-MESSAGE-TEXT (1)      10350074
103600                  MOVE SQLCA       TO DP013-SQLCA                 10360074
103700                  MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)    10370077
103800                  SET DP013-DB2-ABEND                             10380074
103900                      DP013-XCTL-DISPLAY-RESTART                  10390074
104000                                   TO TRUE                        10400074
104100                  PERFORM DP013-0000-PROCESS-ABEND                10410074
104200         END-EVALUATE                                             10420074
104300     END-PERFORM.                                                 10430074
104400                                                                  10440074
104500     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   10450074
104600         MOVE '3400-VALIDATE-OPER-UNT-ID'                         10460074
104700                               TO  DP013-PARAGRAPH                10470074
104800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   10480074
104900                               TO  DP013-MESSAGE-TEXT (1)         10490074
105000         MOVE 'OF AN OPERATING UNIT ID        '                   10500074
105100                               TO  DP013-MESSAGE-TEXT (2)         10510074
105200         MOVE SQLCA            TO  DP013-SQLCA                    10520074
105300         MOVE 'XLT_LOC '       TO DP013-DB2-TABLE-NAME (1)        10530077
105400         SET DP013-DB2-ABEND                                      10540074
105500             DP013-XCTL-DISPLAY-RESTART                           10550074
105600                               TO  TRUE                           10560074
105700         PERFORM DP013-0000-PROCESS-ABEND                         10570074
105800     END-IF.                                                      10580074
105900                                                                  10590074
106000                                                                  10600074
106100*----------------------------------------------------------------*10610074
106200*  VALIDATE THE OPERATING UNIT ID TO MAKE SURE THAT IT IS A      *10620074
106300*  VALID DISTRIBUTION CENTER.                                    *10630074
106400*----------------------------------------------------------------*10640074
106500 3500-VALIDATE-FCLTY-ID.                                          10650074
106600                                                                  10660074
106700     PERFORM                                                      10670074
106800         WITH TEST AFTER                                          10680074
106900         VARYING PV-SQL-SUB                                       10690074
107000         FROM 1 BY 1                                              10700074
107100         UNTIL  (PV-SQL-SUB > PC-MAX-RETRIES                      10710074
107200            OR   SQLCODE = +0                                     10720074
107300            OR   SQLCODE = +100)                                  10730074
107400                                                                  10740074
107500         EXEC SQL                                                 10750074
107600            SELECT LOC_NM                                         10760076
107900             INTO  :XLT00010-LOC-NM                               10790076
108000              FROM XLT_LOC                                        10800076
108100             WHERE LOC_NBR    = :DK-OPER-UNT-ID                   10810076
108300         END-EXEC                                                 10830074
108400                                                                  10840074
108500         EVALUATE TRUE                                            10850074
108600             WHEN SQLCODE = -904                                  10860074
108700             WHEN SQLCODE = -913                                  10870074
108800                 CONTINUE                                         10880074
108900             WHEN SQLCODE = +100                                  10890074
109000                 SET PS-EDIT-ERROR TO TRUE                        10900074
109100                 MOVE SPACES       TO ASC-FCLTY-NME               10910074
109200             WHEN SQLCODE = +0                                    10920074
109300                 MOVE XLT00010-LOC-NM                             10930076
109400                                   TO ASC-FCLTY-NME               10940074
109500             WHEN SQLCODE < +0                                    10950074
109600             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     10960074
109700             WHEN SQLWARN0 NOT = SPACES                           10970074
109800                  MOVE '3500-VALIDATE-FCLTY-ID'                   10980074
109900                                   TO DP013-PARAGRAPH             10990074
110000                  MOVE 'SELECT FACILITY ID'                       11000074
110100                                   TO DP013-MESSAGE-TEXT (1)      11010074
110200                  MOVE SQLCA       TO DP013-SQLCA                 11020074
110300                  MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)    11030076
110400                  SET DP013-DB2-ABEND                             11040074
110500                      DP013-XCTL-DISPLAY-RESTART                  11050074
110600                                   TO TRUE                        11060074
110700                  PERFORM DP013-0000-PROCESS-ABEND                11070074
110800         END-EVALUATE                                             11080074
110900     END-PERFORM.                                                 11090074
111000                                                                  11100074
111100     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   11110074
111200         MOVE '3500-VALIDATE-FCLTY-ID'                            11120074
111300                               TO  DP013-PARAGRAPH                11130074
111400         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   11140074
111500                               TO  DP013-MESSAGE-TEXT (1)         11150074
111600         MOVE 'OF A FACILITY ID               '                   11160074
111700                               TO  DP013-MESSAGE-TEXT (2)         11170074
111800         MOVE SQLCA            TO  DP013-SQLCA                    11180074
111900         MOVE 'XLT_LOC '       TO DP013-DB2-TABLE-NAME (1)        11190076
112000         SET DP013-DB2-ABEND                                      11200074
112100             DP013-XCTL-DISPLAY-RESTART                           11210074
112200                               TO  TRUE                           11220074
112300         PERFORM DP013-0000-PROCESS-ABEND                         11230074
112400     END-IF.                                                      11240074
112500                                                                  11250074
112600                                                                  11260074
112700*-----------------------------------------------------------------11270074
112800*  3600-VALIDATE-PRINTER.                                         11280074
112900*      CALLS SPKCS060 TO VALIDATE THE PRINTER ID                  11290074
113000*-----------------------------------------------------------------11300074
113100 3600-VALIDATE-PRINTER.                                           11310074
113200     MOVE ASC-PRINTER-DESTINATION    TO DP072-PRINTER-ID.         11320074
113300                                                                  11330074
113400     MOVE PC-REPORT-PGM              TO DP072-RPT-PGM-NME.        11340074
113500     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     11350074
113600     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 11360078
113700     MOVE ASC-OPER-UNT-ID            TO DP072-OPER-UNT-ID.        11370074
113800     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     11380074
113900                                        DP072-FCLTY-ID.           11390074
114000     SET DP072-VALIDATE              TO TRUE.                     11400074
114100                                                                  11410074
114200     EXEC CICS                                                    11420074
114300          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  11430074
114400               COMMAREA (DP072-COMM-AREA)                         11440074
114500               RESP     (PV-CICS-RESPONSE)                        11450074
114600     END-EXEC                                                     11460074
114700                                                                  11470074
114800     EVALUATE TRUE                                                11480074
114900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11490074
115000             CONTINUE                                             11500074
115100         WHEN OTHER                                               11510074
115200             MOVE '1310-VALIDATE-PRINTER'                         11520074
115300                                 TO DP013-PARAGRAPH               11530074
115400             MOVE PV-CICS-RESPONSE                                11540074
115500                                 TO DP013-MESSAGE-TEXT(1)         11550074
115600             SET DP013-LINK-RETURN                                11560074
115700                 DP013-CICS-ABEND                                 11570074
115800                 DP013-NO-ROLLBACK TO TRUE                        11580074
115900             PERFORM DP013-0000-PROCESS-ABEND                     11590074
116000     END-EVALUATE.                                                11600074
116100                                                                  11610074
116200                                                                  11620074
116300*----------------------------------------------------------------*11630074
116400*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *11640074
116500*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *11650074
116600*  IT HERE.                                                      *11660074
116700*----------------------------------------------------------------*11670074
116800 4000-BUILD-INITIAL-PANEL.                                        11680074
116900                                                                  11690074
117000     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        11700074
117100     MOVE -1                       TO MZONEL.                     11710074
117200                                                                  11720074
117300     MOVE ASC-OPER-UNT-ID-N        TO MOPIDO                      11730074
117400                                      DK-OPER-UNT-ID.             11740074
117500     MOVE ASC-FCLTY-ID-N           TO MFACIDO                     11750074
117600                                      DK-FCLTY-ID.                11760074
117700                                                                  11770074
117800     PERFORM 4010-GET-FCLTY-NAME.                                 11780074
117900                                                                  11790074
118000     MOVE ASC-FCLTY-NME            TO MOPDESCO.                   11800074
118100*                                                                 11810074
118200*----------------------------------------------------------------*11820074
118300*    GET THE FACILITY NAME                                       *11830074
118400*----------------------------------------------------------------*11840074
118500 4010-GET-FCLTY-NAME.                                             11850074
118600                                                                  11860074
118700     PERFORM                                                      11870074
118800         WITH TEST AFTER                                          11880074
118900         VARYING PV-RETRY-COUNT                                   11890074
119000         FROM 1 BY 1                                              11900074
119100         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 11910074
119200             OR (SQLCODE = +0)                                    11920074
119300             OR (SQLCODE = +100))                                 11930074
119400                                                                  11940074
119500         EXEC SQL                                                 11950074
119600              SELECT LOC_NM                                       11960076
119700                INTO :XLT00010-LOC-NM                             11970076
119800                FROM XLT_LOC                                      11980076
119900               WHERE LOC_NBR     = :DK-OPER-UNT-ID                11990076
120100         END-EXEC                                                 12010074
120200                                                                  12020074
120300         EVALUATE TRUE                                            12030074
120400             WHEN SQLCODE = +0                                    12040074
120500                  MOVE XLT00010-LOC-NM                            12050076
120600                                  TO ASC-FCLTY-NME                12060074
120700                                                                  12070074
120800             WHEN SQLCODE = +100                                  12080074
120900                  MOVE SPACES     TO ASC-FCLTY-NME                12090074
121000                                                                  12100074
121100             WHEN SQLCODE = -904                                  12110074
121200             WHEN SQLCODE = -913                                  12120074
121300                  CONTINUE                                        12130074
121400                                                                  12140074
121500             WHEN SQLWARN0 NOT = SPACES                           12150074
121600             WHEN SQLCODE < +0                                    12160074
121700             WHEN SQLCODE > +0                                    12170074
121800                  MOVE '4010-GET-FCLTY-NAME'                      12180074
121900                                  TO DP013-PARAGRAPH              12190074
122000                  MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'    12200074
122100                                  TO DP013-MESSAGE-TEXT (1)       12210074
122200                  MOVE SQLCA      TO DP013-SQLCA                  12220074
122300                  MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)     12230076
122400                  SET DP013-DB2-ABEND                             12240074
122500                      DP013-XCTL-DISPLAY-RESTART                  12250074
122600                                  TO TRUE                         12260074
122700                  PERFORM DP013-0000-PROCESS-ABEND                12270074
122800         END-EVALUATE                                             12280074
122900     END-PERFORM.                                                 12290074
123000                                                                  12300074
123100     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          12310074
123200         MOVE '4010-GET-FCLTY-NAME'                               12320074
123300                                  TO DP013-PARAGRAPH              12330074
123400         MOVE 'MAX RETRIES EXCEEDED ON SELECT FACILITY TABLE'     12340074
123500                                  TO DP013-MESSAGE-TEXT (1)       12350074
123600         MOVE SQLCA               TO DP013-SQLCA                  12360074
123700         MOVE 'XLT_LOC'           TO DP013-DB2-TABLE-NAME (1)     12370076
123800         SET DP013-DB2-ABEND                                      12380074
123900             DP013-XCTL-DISPLAY-RESTART                           12390074
124000                                  TO TRUE                         12400074
124100         PERFORM DP013-0000-PROCESS-ABEND                         12410074
124200     END-IF.                                                      12420074
124300                                                                  12430074
124400                                                                  12440074
124500*----------------------------------------------------------------*12450074
124600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12460074
124700*----------------------------------------------------------------*12470074
124800 4400-MOVE-COMAREA-TO-SCREEN.                                     12480074
124900                                                                  12490074
125000     IF  ASC-OPER-UNT-ID = SPACES                                 12500074
125100         MOVE ZEROES               TO MOPIDO                      12510074
125200                                      ACA-OPER-UNIT-ID            12520074
125300         MOVE 9999                 TO ACA-OPER-UNIT-ID            12530074
125400     ELSE                                                         12540074
125500         MOVE ASC-OPER-UNT-ID      TO MOPIDO                      12550074
125600                                      ACA-OPER-UNIT-ID.           12560074
125700                                                                  12570074
125800     IF  ASC-FCLTY-ID = SPACES                                    12580074
125900         MOVE ZEROES               TO MFACIDO                     12590074
126000                                      ACA-FCLTY-ID                12600074
126100         MOVE 9999                 TO ACA-FCLTY-ID                12610074
126200     ELSE                                                         12620074
126300         MOVE ASC-FCLTY-ID         TO MFACIDO                     12630074
126400                                      ACA-FCLTY-ID.               12640074
126500                                                                  12650074
126600*    MOVE MOPDESCO                 TO ACA-FCLTY-NAME.             12660074
126700     MOVE ASC-FCLTY-NME            TO MOPDESCO.                   12670074
126800                                                                  12680074
126900     MOVE ASC-ZONE                 TO MZONEO                      12690074
127000                                      ACA-ZONE.                   12700074
127100                                                                  12710074
127200     MOVE ASC-P2L                  TO MP2LO                       12720074
127300                                      ACA-P2L.                    12730074
127400                                                                  12740074
127500     MOVE ASC-TO-INFOPAC           TO MINFOO                      12750074
127600                                      ACA-TO-INFOPAC.             12760074
127700                                                                  12770074
127800     MOVE ASC-PRINTER-DESTINATION  TO MPRTIDO                     12780074
127900                                      ACA-PRINTER-DESTINATION.    12790074
128000                                                                  12800074
128100     MOVE ASC-ORIG-OPER-UNIT-ID    TO ACA-ORIG-OPER-UNIT-ID.      12810074
128200                                                                  12820074
128300     EJECT                                                        12830074
128400                                                                  12840074
128500                                                                  12850074
128600*-----------------------------------------------------------      12860074
128700*                                                                 12870074
128800*-----------------------------------------------------------      12880074
128900 4600-SUBMIT-JOB.                                                 12890074
129000                                                                  12900074
129100     MOVE  PC-STATUS-REPORT-DESC TO PV-JOB-DESCRIPTION.           12910074
129200     MOVE  PC-STATUS-REPORT-PROC TO PV-JOB-PROC.                  12920074
129300     MOVE  PC-STATUS-REPORT-JOB  TO PV-JOB-NAME.                  12930074
129400                                                                  12940074
129500      EXEC CICS                                                   12950074
129600          ASSIGN                                                  12960074
129700              APPLID(PV-SYSTEM-ID)                                12970074
129800              USERID (PV-USER-ID)                                 12980074
129900      END-EXEC.                                                   12990074
130000                                                                  13000074
130100      PERFORM 4610-ENQUEUE-INTERNAL-READER.                       13010074
130200                                                                  13020074
130300      MOVE '*4600-SUBMIT-JOB            *' TO DP013-PARAGRAPH     13030074
130400                                                                  13040074
130500*-----------------------------------------------------------      13050074
130600* PROD/LEARN JCL SETUP                                            13060074
130700*     //PCK910   JOB KOHLS,'STATUS REPORT',MSGCLASS=P,CLASS=U     13070074
130800*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S,DEST=UNNNNNNN            13080074
130900*     //JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR                     13090074
131100*     //PS020    EXEC PCK9101                                     13110074
131200*     //S010.SYSUT1 DD *                                          13120074
131300*     TKXXXXX DDDD SSYUNNNNNNN                                    13130074
131400*     //$AUTO    EXEC PGM=$A,COND=(4,LE),PARM='>'                 13140074
131500*     /*EOF                                                       13150074
131600*-----------------------------------------------------------      13160074
131700* TEST JCL SETUP                                                  13170074
131800*     //XXXXXXXQ JOB KOHLS,'STATUS REPORT',MSGCLASS=X,CLASS=E     13180074
131900*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S,DEST=UNNNNNNN            13190074
132000*     //JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR                     13200074
132100*     //PS020    EXEC PCK9101T                                    13210074
132200*     //S010.SYSUT1 DD *                                          13220074
132300*     TKXXXXX DDDD SSYUNNNNNNN                                    13230074
132400*     //$AUTO    EXEC PGM=$A,COND=(4,LE),PARM='>'                 13240074
132500*     /*EOF                                                       13250074
132600*-----------------------------------------------------------      13260074
132700                                                                  13270074
132800      IF  ACA-PRINTER-DESTINATION  =  SPACES                      13280074
132900          MOVE 'LOCAL'  TO  PV-PRINTER-DESTINATION                13290074
133000      ELSE                                                        13300074
133100          MOVE ACA-PRINTER-DESTINATION                            13310074
133200                        TO  PV-PRINTER-DESTINATION.               13320074
133300                                                                  13330074
133400      IF PV-PROD-CICS                                             13340074
133600          MOVE PV-JOB-NAME            TO  JL-PROD-JOB-NAME        13360074
133700          MOVE PV-JOB-DESCRIPTION     TO  JL-PROD-JOB-DESC        13370074
133800          MOVE JL-JOB-LINE-PROD       TO  JL-JCL-LINE-1           13380074
133900          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             13390074
134000          PERFORM 4620-WRITE-TD-LINE                              13400074
134100          MOVE 'A'                    TO  JL-LINE-3-CLASS         13410074
134200          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-3-PRINTER       13420074
134300          MOVE JL-JCL-LINE-3          TO  TD-JCL-LINE             13430074
134400          PERFORM 4620-WRITE-TD-LINE                              13440074
134500          MOVE JL-JCL-LINE-4-PROD     TO  TD-JCL-LINE             13450074
134600          PERFORM 4620-WRITE-TD-LINE                              13460074
134900          MOVE PV-JOB-PROC            TO  JL-LINE-6-PROC          13490074
135000          MOVE SPACE                  TO  JL-LINE-6-PROC-T        13500074
135100          MOVE JL-JCL-LINE-6          TO  TD-JCL-LINE             13510074
135200          PERFORM 4620-WRITE-TD-LINE                              13520074
135300          MOVE JL-JCL-LINE-7          TO  TD-JCL-LINE             13530074
135400          PERFORM 4620-WRITE-TD-LINE                              13540074
135500      ELSE                                                        13550074
135510      IF PV-TEST-CICS                                             13551074
135600          MOVE DP020-USERID           TO  JL-TEST-JOB-NAME        13560074
135700          MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC        13570074
135800          MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1           13580074
135900          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             13590074
136000          PERFORM 4620-WRITE-TD-LINE                              13600074
136100          MOVE 'A'                    TO  JL-LINE-3-CLASS         13610074
136200          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-3-PRINTER       13620074
136300          MOVE JL-JCL-LINE-3          TO  TD-JCL-LINE             13630074
136400          PERFORM 4620-WRITE-TD-LINE                              13640074
136500          MOVE JL-JCL-LINE-4-TEST     TO  TD-JCL-LINE             13650074
136600          PERFORM 4620-WRITE-TD-LINE                              13660074
136700          MOVE PV-JOB-PROC            TO  JL-LINE-6-PROC          13670074
136800          MOVE PC-TEST                TO  JL-LINE-6-PROC-T        13680074
136900          MOVE JL-JCL-LINE-6          TO  TD-JCL-LINE             13690074
137000          PERFORM 4620-WRITE-TD-LINE                              13700074
137100          MOVE JL-JCL-LINE-7          TO  TD-JCL-LINE             13710074
137200          PERFORM 4620-WRITE-TD-LINE                              13720074
137210      ELSE                                                        13721074
137220      IF PV-QA-CICS                                               13722074
137230          MOVE DP020-USERID           TO  JL-TEST-JOB-NAME        13723074
137240          MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC        13724074
137250          MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1           13725074
137260          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             13726074
137270          PERFORM 4620-WRITE-TD-LINE                              13727074
137280          MOVE 'A'                    TO  JL-LINE-3-CLASS         13728074
137290          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-3-PRINTER       13729074
137291          MOVE JL-JCL-LINE-3          TO  TD-JCL-LINE             13729174
137292          PERFORM 4620-WRITE-TD-LINE                              13729274
137293          MOVE JL-JCL-LINE-4-TEST     TO  TD-JCL-LINE             13729374
137294          PERFORM 4620-WRITE-TD-LINE                              13729474
137295          MOVE PV-JOB-PROC            TO  JL-LINE-6-PROC          13729574
137296          MOVE PC-QA                  TO  JL-LINE-6-PROC-T        13729674
137297          MOVE JL-JCL-LINE-6          TO  TD-JCL-LINE             13729774
137298          PERFORM 4620-WRITE-TD-LINE                              13729874
137299          MOVE JL-JCL-LINE-7          TO  TD-JCL-LINE             13729974
137300          PERFORM 4620-WRITE-TD-LINE                              13730074
137301      ELSE                                                        13730174
137303          MOVE DP020-USERID           TO  JL-TEST-JOB-NAME        13730374
137304          MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC        13730474
137305          MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1           13730574
137306          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             13730674
137307          PERFORM 4620-WRITE-TD-LINE                              13730774
137308          MOVE 'A'                    TO  JL-LINE-3-CLASS         13730874
137309          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-3-PRINTER       13730974
137310          MOVE JL-JCL-LINE-3          TO  TD-JCL-LINE             13731074
137311          PERFORM 4620-WRITE-TD-LINE                              13731174
137312          MOVE JL-JCL-LINE-4-TEST     TO  TD-JCL-LINE             13731274
137313          PERFORM 4620-WRITE-TD-LINE                              13731374
137314          MOVE PV-JOB-PROC            TO  JL-LINE-6-PROC          13731474
137315          MOVE PC-LEARN               TO  JL-LINE-6-PROC-T        13731574
137316          MOVE JL-JCL-LINE-6          TO  TD-JCL-LINE             13731674
137317          PERFORM 4620-WRITE-TD-LINE                              13731774
137318          MOVE JL-JCL-LINE-7          TO  TD-JCL-LINE             13731874
137319          PERFORM 4620-WRITE-TD-LINE.                             13731974
137400                                                                  13740074
137500     MOVE DP020-USERID                TO  JL-LINE-8-USER-ID.      13750074
137600     MOVE ACA-OPER-UNIT-ID            TO  JL-LINE-8-DC-NUMBER.    13760074
137700                                                                  13770074
137800     IF  ACA-ZONE = 'S' OR 'X'                                    13780074
137900         MOVE ACA-ZONE                TO  JL-LINE-8-RPT-1         13790074
138000     ELSE                                                         13800074
138100         MOVE 'N'                     TO  JL-LINE-8-RPT-1.        13810074
138200                                                                  13820074
138300     IF  ACA-P2L  = 'S' OR 'X'                                    13830074
138400         MOVE ACA-P2L                 TO  JL-LINE-8-RPT-2         13840074
138500     ELSE                                                         13850074
138600         MOVE 'N'                     TO  JL-LINE-8-RPT-2.        13860074
138700                                                                  13870074
138800     IF  ACA-TO-INFOPAC  = 'Y'                                    13880074
138900         MOVE 'I'                     TO  JL-LINE-8-INFOPAC       13890074
139000     ELSE                                                         13900074
139100         MOVE 'P'                     TO  JL-LINE-8-INFOPAC.      13910074
139200                                                                  13920074
139300     MOVE ACA-PRINTER-DESTINATION     TO  JL-LINE-8-PRINTER.      13930074
139400     MOVE DP072-PRTR-PRTR-CNTL-IND    TO  JL-LINE-8-PRTR-CNTL.    13940074
139500     MOVE DP072-PRTR-TRACK-NBR        TO  JL-LINE-8-TRACK-NBR.    13950074
139600     MOVE JL-JCL-LINE-8               TO  TD-JCL-LINE.            13960074
139700     PERFORM 4620-WRITE-TD-LINE.                                  13970074
139800                                                                  13980074
139900*DP  MOVE JL-JCL-AUTO-SCHD            TO  TD-JCL-LINE.            13990074
140000*DP  PERFORM 4620-WRITE-TD-LINE.                                  14000074
140100                                                                  14010074
140200     MOVE JL-JCL-LINE-EOF             TO  TD-JCL-LINE.            14020074
140300     PERFORM 4620-WRITE-TD-LINE.                                  14030074
140400                                                                  14040074
140500     PERFORM 9800-DEQUEUE-INTERNAL-READER.                        14050074
140600                                                                  14060074
140700     MOVE PC-TSYMSG-00458        TO DP020-MSG-NUMBER.             14070074
140800                                                                  14080074
140900     SET DP020-MSG-INFORMATIONAL TO TRUE.                         14090074
141000*    SET DP030-SEND-MAPONLY(1)   TO TRUE.                         14100074
141100                                                                  14110074
141200                                                                  14120074
141300*-----------------------------------------------------------      14130074
141400*                                                                 14140074
141500*-----------------------------------------------------------      14150074
141600  4610-ENQUEUE-INTERNAL-READER.                                   14160074
141700      MOVE '*4610-ENQUEUE-INTERNAL-READER.   *' TO DP013-PARAGRAPH14170074
141800      EXEC CICS                                                   14180074
141900          ENQ                                                     14190074
142000              RESOURCE(TD-QUEUE-NAME)                             14200074
142100              LENGTH(TD-QUEUE-NAME-LENGTH)                        14210074
142200              RESP(PV-CICS-RESPONSE)                              14220074
142300      END-EXEC.                                                   14230074
142400                                                                  14240074
142500      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   14250074
142600          STRING 'ENQUEUE '            DELIMITED BY SIZE          14260074
142700                 TD-QUEUE-NAME         DELIMITED BY SIZE          14270074
142800                 ' (INTERNAL READER)'  DELIMITED BY SIZE          14280074
142900              INTO DP013-MESSAGE-TEXT(1)                          14290074
143000          PERFORM 9920-CICS-ERROR                                 14300074
143100      END-IF.                                                     14310074
143200                                                                  14320074
143300      SET PS-INTERNAL-READER-ENQUEUED TO TRUE.                    14330074
143400                                                                  14340074
143500                                                                  14350074
143600*-----------------------------------------------------------      14360074
143700*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL  14370074
143800*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER, DELETE     14380074
143900*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST            14390074
144000*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST),  14400074
144100*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE      14410074
144200*  CICS.                                                          14420074
144300*-----------------------------------------------------------      14430074
144400  4620-WRITE-TD-LINE.                                             14440074
144500      MOVE '*4620-WRITE-TD-LINE.             *' TO DP013-PARAGRAPH14450074
144600      EXEC CICS                                                   14460074
144700          WRITEQ TD                                               14470074
144800              QUEUE(TD-QUEUE-NAME)                                14480074
144900              FROM(TD-JCL-LINE)                                   14490074
145000              LENGTH(TD-JCL-LINE-LENGTH)                          14500074
145100              RESP(PV-CICS-RESPONSE)                              14510074
145200      END-EXEC.                                                   14520074
145300                                                                  14530074
145400      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   14540074
145500          STRING 'WRITE TO TRANSIENT DATA QUEUE '                 14550074
145600                                                 DELIMITED BY SIZE14560074
145700                 TD-QUEUE-NAME                   DELIMITED BY SIZE14570074
145800                 ' (INTERNAL READER)'            DELIMITED BY SIZE14580074
145900              INTO DP013-MESSAGE-TEXT(1)                          14590074
146000          PERFORM 9800-DEQUEUE-INTERNAL-READER                    14600074
146100          PERFORM 9920-CICS-ERROR                                 14610074
146200      END-IF.                                                     14620074
146300                                                                  14630074
146400                                                                  14640074
146500*-----------------------------------------------------------      14650074
146600**  ROLL BACK ALL RESOURCES, FOLLOWING A DB2 ERROR.  FORMAT       14660074
146700**  INFORMATION RELATIVE TO THE ERROR.                            14670074
146800*-----------------------------------------------------------      14680074
146900  9920-CICS-ERROR.                                                14690074
147000                                                                  14700074
147100      SET DP013-ROLLBACK                                          14710074
147200          DP013-XCTL-DISPLAY-RESTART                              14720074
147300          DP013-CICS-ABEND      TO TRUE                           14730074
147400                                                                  14740074
147500      PERFORM DP013-0000-PROCESS-ABEND.                           14750074
147600                                                                  14760074
147700                                                                  14770074
147800*-----------------------------------------------------------      14780074
147900**  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     14790074
148000**  THIS SHOULD BE DONE FOLLOWING A SUCCESSFUL REPORT REQUEST     14800074
148100**  SUBMISSION, A CANCELLATION OF THE CURRENT REPORT REQUEST, OR  14810074
148200**  ANY DETECTED ABENDS.  THIS WILL FREE UP THE INTERNAL READER   14820074
148300**  FOR THE NEXT USER.  IF ANY ERRORS OCCUR, CHECK TO SEE IF      14830074
148400**  ANY OTHER ABEND SITUATIONS HAVE ALREADY OCCURRED.  IF SO, DO  14840074
148500**  NOT FORCE THE ABEND FOR THIS ERROR, AND ALLOW PROGRAM CONTROL 14850074
148600**  TO RETURN TO THE POINT WHERE THE FIRST ABEND OCCURRED, AND    14860074
148700**  DISPLAY THE MESSAGE RELATING TO THAT ABEND.  IF NOT, DELETE   14870074
148800**  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           14880074
148900**  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), 14890074
149000**  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     14900074
149100**  CICS.                                                         14910074
149200*-----------------------------------------------------------      14920074
149300  9800-DEQUEUE-INTERNAL-READER.                                   14930074
149400                                                                  14940074
149500      SET PS-INTERNAL-READER-DEQUEUED TO TRUE.                    14950074
149600                                                                  14960074
149700      EXEC CICS                                                   14970074
149800          DEQ                                                     14980074
149900              RESOURCE(TD-QUEUE-NAME)                             14990074
150000              LENGTH(TD-QUEUE-NAME-LENGTH)                        15000074
150100              RESP(PV-CICS-RESPONSE)                              15010074
150200      END-EXEC.                                                   15020074
150300                                                                  15030074
150400      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   15040074
150500          STRING 'DEQUEUE '                DELIMITED BY SIZE      15050074
150600                 TD-QUEUE-NAME             DELIMITED BY SIZE      15060074
150700                 ' (INTERNAL READER)'      DELIMITED BY SIZE      15070074
150800              INTO DP013-MESSAGE-TEXT(1)                          15080074
150900          PERFORM 9920-CICS-ERROR                                 15090074
151000      END-IF.                                                     15100074
151100                                                                  15110074
151200      EJECT                                                       15120074
151300                                                                  15130074
151400                                                                  15140074
151500*----------------------------------------------------------------*15150074
151600*    ABEND PROCESSOR MODULE                                      *15160074
151700*----------------------------------------------------------------*15170074
151800                                                                  15180074
151900     COPY DPPD013.                                                15190074
152000                                                                  15200074
152100     COPY DPPD017.                                                15210074
152200                                                                  15220074
152300                                                                  15230074
