000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.             PCKCS013.                                00050099
000600 AUTHOR.                 JUDY OZBURN.                             00060099
000700 INSTALLATION.           KOHLS.                                   00070099
000800 DATE-WRITTEN.           DECEMBER, 1995.                          00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100*    ANY CHANGES THAT MAY EFFECT THE LAYOUT OF THIS REPORT SHOULD 00110099
001200*    BE TESTED ON EVERY MODEL OF PRINTER.  THERE MIGHT BE         00120099
001300*    DIFFERENCES IN CARRIAGE CONTROL AND GRAPHICS PRINTING FOR    00130099
001400*    EACH MODEL.  ALSO BE AWARE THAT WHEN USING PROGRAM DRS1INTC  00140099
001500*    TO PRINT THE REPORT, A NON-BLANK CHARACTER IN PRINT POSITION 00150099
001600*    132 WILL CAUSE A DOUBLE-SPACE TO OCCUR REGARDLESS OF THE     00160099
001700*    VALUE OF THE CARRIAGE CONTROL.                               00170099
001800                                                                  00180099
001900******************************************************************00190099
002000* THIS PROGRAM PRODUCES THE MARKING APRON HEADER REPORT.          00200099
002100******************************************************************00210099
002200*                                                               * 00220099
002300*  CHANGED 02/12/98 BY PAUL JORGENSEN                             00230099
002400*   WR# 4650 ADD THE PRINTING OF SPECIAL INSTRUCTIONS             00240099
002500*---------------------------------------------------------------* 00250099
002600* DATE  12/15/2022                                              * 00260099
002700*            - COMMENTED OUT DPWS030 - NOT USED                 * 00270099
002800*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00280099
002900******************************************************************00290099
003000 ENVIRONMENT DIVISION.                                            00300099
003100******************************************************************00310099
003200                                                                  00320099
003300******************************************************************00330099
003400 DATA DIVISION.                                                   00340099
003500******************************************************************00350099
003600                                                                  00360099
003700******************************************************************00370099
003800 WORKING-STORAGE SECTION.                                         00380099
003900******************************************************************00390099
004000                                                                  00400099
004100*                                                                 00410099
004200*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00420099
004300*                                                                 00430099
004400     COPY DFHAID.                                                 00440099
004500                                                                  00450099
004600*                                                                 00460099
004700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00470099
004800*                                                                 00480099
004900     COPY DPWS013.                                                00490099
005000                                                                  00500099
005100*                                                                 00510099
005200*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *00520099
005300*  SUB-ROUTINE (DPKUT100).                                       *00530099
005400*                                                                 00540099
005500     COPY DPWS010I.                                               00550099
005600                                                                  00560099
005700*                                                                 00570099
005800*  THE WORKING STORAGE FOR THE RECEIVING PRINT PACKAGE ROUTINE   *00580099
005900*                                                                 00590099
006000     COPY DSWS004.                                                00600099
006100                                                                  00610099
006200                                                                  00620099
006300*                                                                 00630099
006400*  THE CALLING PARAMETER LIST (DPWS072) FOR THE RECEIVING PRINT  *00640099
006500*  PACKAGE PRINTER CONTROL SUB-ROUTINE (DPKCS060)                *00650099
006600*                                                                 00660099
006700     COPY DPWS072.                                                00670099
006800                                                                  00680099
006900*                                                                 00690099
007000*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*00700099
007100*  APPLICATION PROGRAMMING INTERFACE MODULE -- DPKCS030.         *00710099
007200*                                                                 00720099
007300*    COPY DPWS030.                                                00730099
007400                                                                  00740099
007500*                                                                 00750099
007600*    STANDARD COMMAREA.                                          *00760099
007700*                                                                 00770099
007800                                                                  00780099
007801     COPY DPWS020.                                                00780199
007802/                                                                 00780212
007803*---------------------------------------------------------------* 00780312
007804* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 00780412
007805*---------------------------------------------------------------* 00780512
007806     COPY XLWS001.                                                00780612
007807                                                                  00780712
007808/                                                                 00780812
007809*                                                                 00780999
007810*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00781099
007820*  TABLE.                                                         00782099
007830*                                                                 00783099
007840     EXEC SQL                                                     00784099
007850          INCLUDE TRECITM                                         00785099
007860     END-EXEC.                                                    00786099
007870                                                                  00787099
007880*                                                                 00788099
007890*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     00789099
007900*                                                                 00790099
008000     EXEC SQL                                                     00800099
008100         INCLUDE TRECEIV                                          00810099
008200     END-EXEC.                                                    00820099
008300                                                                  00830099
008400******************************************************************00840099
008500* DCLGEN OF XLT_LOC                                               00850099
008600******************************************************************00860099
008700*                                                                 00870099
008800     EXEC SQL                                                     00880099
008900         INCLUDE XLT00010                                         00890099
009000     END-EXEC.                                                    00900099
009100*                                                                 00910099
009200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER DISTRO TAB00920099
009300*                                                                 00930099
009400     EXEC SQL                                                     00940099
009500         INCLUDE TRECDIS                                          00950099
009600     END-EXEC.                                                    00960099
009700                                                                  00970099
009800*                                                                 00980099
009900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00990099
010000*  HEADER TABLE                                                   01000099
010100*                                                                 01010099
010200     EXEC SQL                                                     01020099
010300          INCLUDE TPURCHS                                         01030099
010400     END-EXEC.                                                    01040099
010500                                                                  01050099
010600*                                                                 01060099
010700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01070099
010800*  ITEM TABLE                                                     01080099
010900*                                                                 01090099
011000     EXEC SQL                                                     01100099
011100          INCLUDE TPURITM                                         01110099
011200     END-EXEC.                                                    01120099
011300                                                                  01130099
011400*                                                                 01140099
011500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PACK SLIP          01150099
011600*  TABLE                                                          01160099
011700*                                                                 01170099
011800     EXEC SQL                                                     01180099
011900          INCLUDE TPKSLIP                                         01190099
012000     END-EXEC.                                                    01200099
012100                                                                  01210099
012200*                                                                 01220099
012300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PACK SLIP ITEM     01230099
012400*  TABLE                                                          01240099
012500*                                                                 01250099
012600     EXEC SQL                                                     01260099
012700          INCLUDE TPKITEM                                         01270099
012800     END-EXEC.                                                    01280099
012900                                                                  01290099
013000*                                                                 01300099
013100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT TABLE     01310099
013200*                                                                 01320099
013300     EXEC SQL                                                     01330099
013400          INCLUDE TSHIPMT                                         01340099
013500     END-EXEC.                                                    01350099
013600                                                                  01360099
013700*                                                                 01370099
013800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIP PO TABLE      01380099
013900*                                                                 01390099
014000     EXEC SQL                                                     01400099
014100          INCLUDE TSHPTPO                                         01410099
014200     END-EXEC.                                                    01420099
014300                                                                  01430099
014400*                                                                 01440099
014500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VEHICLE TRIP       01450099
014600*  TABLE                                                          01460099
014700*                                                                 01470099
014800     EXEC SQL                                                     01480099
014900          INCLUDE TVHTRIP                                         01490099
015000     END-EXEC.                                                    01500099
015100                                                                  01510099
015200*                                                                 01520099
015300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRIZE NAME    01530099
015400*  TABLE.                                                         01540099
015500*                                                                 01550099
015600     EXEC SQL                                                     01560099
015700          INCLUDE TENTNME                                         01570099
015800     END-EXEC.                                                    01580099
015900                                                                  01590099
016000*                                                                 01600099
016100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            01610099
016200*  NOTIFICATION TABLE                                             01620099
016300*                                                                 01630099
016400     EXEC SQL                                                     01640099
016500          INCLUDE TTRBNTF                                         01650099
016600     END-EXEC.                                                    01660099
016700                                                                  01670099
016800*                                                                 01680099
016900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            01690099
017000*  REASON CODE TABLE                                              01700099
017100*                                                                 01710099
017200     EXEC SQL                                                     01720099
017300          INCLUDE TTRBRSN                                         01730099
017400     END-EXEC.                                                    01740099
017500                                                                  01750099
017600*----------------------------------------------------------------*01760099
017700*    DB2 DCLGEN FOR THE TMDSEAR TABLE                             01770099
017800*----------------------------------------------------------------*01780099
017900*    EXEC SQL                                                     01790099
018000*         INCLUDE TMDSEAR                                         01800099
018100*    END-EXEC.                                                    01810099
018200/                                                                 01820099
018300/                                                                 01830099
018400*----------------------------------------------------------------*01840099
018500*    DB2 DCLGEN FOR THE TDCVSVL TABLE                             01850099
018600*----------------------------------------------------------------*01860099
018700*    EXEC SQL                                                     01870099
018800*         INCLUDE TDCVSVL                                         01880099
018900*    END-EXEC.                                                    01890099
019000/                                                                 01900099
019100*----------------------------------------------------------------*01910099
019200*    DB2 DCLGEN FOR THE TVSCHVL TABLE                             01920099
019300*----------------------------------------------------------------*01930099
019400*    EXEC SQL                                                     01940099
019500*         INCLUDE TVSCHVL                                         01950099
019600*    END-EXEC.                                                    01960099
019700/                                                                 01970099
019800*----------------------------------------------------------------*01980099
019900*    DB2 DCLGEN FOR THE TVNDSTL TABLE                             01990099
020000*----------------------------------------------------------------*02000099
020100*    EXEC SQL                                                     02010099
020200*         INCLUDE TVNDSTL                                         02020099
020300*    END-EXEC.                                                    02030099
020400/                                                                 02040099
020500*----------------------------------------------------------------*02050099
020600*    DB2 DCLGEN FOR THE TMDARVS TABLE                             02060099
020700*----------------------------------------------------------------*02070099
020800     EXEC SQL                                                     02080099
020900          INCLUDE TMDARVS                                         02090099
021000     END-EXEC.                                                    02100099
021100/                                                                 02110099
021200*----------------------------------------------------------------*02120099
021300*    DB2 DCLGEN FOR PURCHASE INSTRUCTIONS                        *02130099
021400*----------------------------------------------------------------*02140099
021500     EXEC SQL                                                     02150099
021600          INCLUDE TPOINST                                         02160099
021700     END-EXEC.                                                    02170099
021800*----------------------------------------------------------------*02180099
021900*    DB2 DCLGEN FOR INSTRUCTIONS                                 *02190099
022000*----------------------------------------------------------------*02200099
022100     EXEC SQL                                                     02210099
022200          INCLUDE TINSTCD                                         02220099
022300     END-EXEC.                                                    02230099
022400*----------------------------------------------------------------*02240099
022500*    DB2 DCLGEN FOR INSTRUCTION RECIPIENTS                       *02250099
022600*----------------------------------------------------------------*02260099
022700     EXEC SQL                                                     02270099
022800          INCLUDE TINRCCD                                         02280099
022900     END-EXEC.                                                    02290099
023000*                                                                 02300099
023100*  COMMUNICATIONS AREA FOR DB2                                    02310099
023200*                                                                 02320099
023300     EXEC SQL                                                     02330099
023400         INCLUDE SQLCA                                            02340099
023500     END-EXEC.                                                    02350099
023600                                                                  02360099
023700*                                                                 02370099
023800*---------------------------------------------------------------* 02380099
023900*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02390099
024000*---------------------------------------------------------------* 02400099
024100                                                                  02410099
024200     COPY PCWS016.                                                02420099
024300                                                                  02430099
024400*                                                                 02440099
024500*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            02450099
024600*                                                                 02460099
024700     COPY DRRD001O.                                               02470099
024800                                                                  02480099
024900*                                                                 02490099
025000*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        02500099
025100*                                                                 02510099
025200     COPY DRRD002O.                                               02520099
025300                                                                  02530099
025400 01  CA-PCKCS014-COMMAREA.                                        02540099
025500     03  CA-COMMAREA.                                             02550099
025600       05  CA-PCKCS013-COMMAREA.                                  02560099
025700         07  CA-PCKCS010-COMMAREA.                                02570099
025800             10 CA-ORD-NBR-X           PIC  X(08)  VALUE SPACE.   02580099
025900             10 CA-ORD-NBR REDEFINES CA-ORD-NBR-X                 02590099
026000                                       PIC  9(08).                02600099
026100             10 CA-RCVR-SEQ-NBR-X      PIC  X(03)  VALUE SPACE.   02610099
026200             10 CA-RCVR-SEQ-NBR REDEFINES CA-RCVR-SEQ-NBR-X       02620099
026300                                       PIC  9(03).                02630099
026400             10 CA-ORD-LNE-NBR-X       PIC  X(04)  VALUE SPACE.   02640099
026500             10 CA-ORD-LNE-NBR REDEFINES CA-ORD-LNE-NBR-X         02650099
026600                                       PIC  9(04).                02660099
026700             10 CA-WORK-ORD-SEQ-NBR-X  PIC  X(03)  VALUE SPACE.   02670099
026800             10 CA-WORK-ORD-SEQ-NBR REDEFINES                     02680099
026900                                       CA-WORK-ORD-SEQ-NBR-X      02690099
027000                                       PIC  9(03).                02700099
027100             10  CA-PRINTER-DESTINATION                           02710099
027200                                       PIC  X(08)  VALUE SPACE.   02720099
027300             10  CA-USER-ID            PIC  X(08)  VALUE SPACE.   02730099
027400             10  CA-OPERATING-ID       PIC  X(04)  VALUE SPACE.   02740099
027500             10  CA-FACILITY-ID        PIC  X(04)  VALUE SPACE.   02750099
027600             10  FILLER                PIC  X(01)  VALUE SPACE.   02760099
027700             10  CA-PRTR-AUTO-CUTTER-IND                          02770099
027800                                       PIC  X(01)  VALUE SPACE.   02780099
027900             10  CA-PRTR-PRTR-BRCDE-IND                           02790099
028000                                       PIC  X(01)  VALUE SPACE.   02800099
028100             10  CA-PRTR-PRTR-CNTL-IND PIC  X(01)  VALUE SPACE.   02810099
028200             10  CA-PRINT-PACKAGE-IND  PIC  X(01)  VALUE SPACE.   02820099
028300                 88 CA-FROM-PRINT-PACKAGE          VALUE 'Y'.     02830099
028400                 88 CA-NOT-FROM-PRINT-PACKAGE      VALUE 'N'.     02840099
028500             10  CA-LINES-PER-INCH     PIC  X(03)  VALUE SPACE.   02850099
028600             10  FILLER                PIC  S9(09) COMP-3.        02860099
028700             10  FILLER                PIC  S9(05) COMP-3.        02870099
028800             10  CA-SEL-QUEUE-NAME     PIC  X(08)  VALUE SPACE.   02880099
028900             10  FILLER                PIC  S9(04) COMP.          02890099
029000             10  CA-MRKG-APRON-HDR-IND PIC  X(01)  VALUE SPACE.   02900099
029100                 88  CA-PRINT-MRKG-APRON-HDR       VALUE 'Y'.     02910099
029200             10  CA-MRKG-APRON-IND     PIC  X(01)  VALUE SPACE.   02920099
029300                 88  CA-PRINT-MRKG-APRON           VALUE 'Y'.     02930099
029400                 88  CA-PRINT-PACK-APRON           VALUE 'P'.     02940099
029500     05  CA-DRIB-AREA                  PIC X(480).                02950099
029600   02  CA-LINE-TABLE.                                             02960099
029700     05  CA-LINE-ENTRY OCCURS 999 TIMES INDEXED BY                02970099
029800                                      LINE-IDX.                   02980099
029900       10  CA-LINE-NBR             PIC S9(4) COMP.                02990099
030000                                                                  03000099
030100 01  DK-DB2-KEYS.                                                 03010099
030200     05  DK-ORD-NBR                  PIC S9(09)  VALUE ZEROS      03020099
030300                                                 COMP.            03030099
030400     05  DK-REC-SEQ-NBR              PIC S9(09)  VALUE ZEROS      03040099
030500                                                 COMP.            03050099
030600     05  DK-OPER-UNT-ID              PIC S9(04)  VALUE ZEROS      03060099
030700                                                 COMP.            03070099
030800     05  DK-FCLTY-ID                 PIC S9(04)  VALUE ZEROS      03080099
030900                                                 COMP.            03090099
031000     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    03100099
031100     05  DK-TYP-CDE                   PIC S9(04) VALUE +0         03110099
031200                                                  COMP.           03120099
031300     05  DK-HNG-TYP-SEQ-NBR           PIC S9(4) COMP VALUE +0.    03130099
031400     05  DK-MDSEAR-ID                 PIC S9(9) COMP VALUE +0.    03140099
031500     05  DK-SUBCLASS-NBR              PIC X(03) VALUE SPACE.      03150099
031600     05  DK-MAJCLASS-NBR              PIC X(02) VALUE SPACE.      03160099
031700     05  DK-CHARTC-SEQ-NBR            PIC S9(4) COMP VALUE +0.    03170099
031800     05  DK-ENT-ID                    PIC S9(09) COMP VALUE +0.   03180099
031900     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    03190099
032000     05  DK-VS-NBR                    PIC X(20)  VALUE SPACES.    03200099
032100     05  DK-ITM-NBR                   PIC X(20)  VALUE SPACES.    03210099
032200     05  DK-VS-ID                     PIC S9(09) COMP VALUE +0.   03220099
032300/                                                                 03230099
032400 01  TL1-TROUBLE-LINE.                                            03240099
032500     05  FILLER                      PIC X(01)   VALUE SPACES.    03250099
032600     05  FILLER                      PIC X(19)   VALUE            03260099
032700         'T R O U B L E  **  '.                                   03270099
032800     05  FILLER                      PIC X(19)   VALUE            03280099
032900         'T R O U B L E  **  '.                                   03290099
033000     05  FILLER                      PIC X(19)   VALUE            03300099
033100         'T R O U B L E  **  '.                                   03310099
033200     05  FILLER                      PIC X(19)   VALUE            03320099
033300         'T R O U B L E  **  '.                                   03330099
033400     05  FILLER                      PIC X(19)   VALUE            03340099
033500         'T R O U B L E  **  '.                                   03350099
033600     05  FILLER                      PIC X(19)   VALUE            03360099
033700         'T R O U B L E  **  '.                                   03370099
033800     05  FILLER                      PIC X(13)   VALUE            03380099
033900         'T R O U B L E'.                                         03390099
034000                                                                  03400099
034100 01  TL2-TROUBLE-LINE.                                            03410099
034200     05  FILLER                      PIC X(01)   VALUE SPACES.    03420099
034300     05  TL2-TRBL-DESC-TABLE OCCURS 5 TIMES INDEXED BY            03430099
034400                                        TRBL-IDX.                 03440099
034500         10  FILLER                  PIC X(05)   VALUE SPACES.    03450099
034600         10  TL2-TRBL-DESC           PIC X(20).                   03460099
034700     05  FILLER                      PIC X(02)   VALUE SPACES.    03470099
034800                                                                  03480099
034900 01  TL3-TROUBLE-LINE.                                            03490099
035000     05  FILLER                      PIC X(01)   VALUE SPACES.    03500099
035100     05  FILLER                      PIC X(03)   VALUE '***'.     03510099
035200     05  FILLER                      PIC X(01)   VALUE SPACES.    03520099
035300     05  TL3-NBR-LINES-IN-TRBL       PIC ZZ9     VALUE ZEROES.    03530099
035400     05  FILLER                      PIC X(20)   VALUE            03540099
035500         ' PO LINES IN TROUBLE'.                                  03550099
035600     05  FILLER                      PIC X(01)   VALUE SPACES.    03560099
035700     05  FILLER                      PIC X(03)   VALUE '***'.     03570099
035800     05  FILLER                      PIC X(01)   VALUE SPACES.    03580099
035900     05  FILLER                      PIC X(03)   VALUE '***'.     03590099
036000     05  FILLER                      PIC X(01)   VALUE SPACES.    03600099
036100     05  TL3-NBR-PACKS-IN-TRBL       PIC ZZ9     VALUE ZEROES.    03610099
036200     05  FILLER                      PIC X(20)   VALUE            03620099
036300         ' PO PACKS IN TROUBLE'.                                  03630099
036400     05  FILLER                      PIC X(01)   VALUE SPACES.    03640099
036500     05  FILLER                      PIC X(03)   VALUE '***'.     03650099
036600     05  FILLER                      PIC X(42)   VALUE SPACES.    03660099
036700     05  TL3-MULT-SHIPS              PIC X(26)   VALUE SPACES.    03670099
036800     05  FILLER                      PIC X(01)   VALUE SPACES.    03680099
036900                                                                  03690099
037000 01  RL1-REPRINT-LINE.                                            03700099
037100     05  FILLER                      PIC X(01)   VALUE SPACES.    03710099
037200     05  FILLER                      PIC X(19)   VALUE            03720099
037300         'R E P R I N T  **  '.                                   03730099
037400     05  FILLER                      PIC X(19)   VALUE            03740099
037500         'R E P R I N T  **  '.                                   03750099
037600     05  FILLER                      PIC X(19)   VALUE            03760099
037700         'R E P R I N T  **  '.                                   03770099
037800     05  FILLER                      PIC X(19)   VALUE            03780099
037900         'R E P R I N T  **  '.                                   03790099
038000     05  FILLER                      PIC X(19)   VALUE            03800099
038100         'R E P R I N T  **  '.                                   03810099
038200     05  FILLER                      PIC X(19)   VALUE            03820099
038300         'R E P R I N T  **  '.                                   03830099
038400     05  FILLER                      PIC X(13)   VALUE            03840099
038500         'R E P R I N T'.                                         03850099
038600     05  FILLER                      PIC X(06)   VALUE SPACES.    03860099
038700                                                                  03870099
038800 01  RT1-RTV-DISTRO-LINE-1.                                       03880099
038900     05  FILLER                          PIC X(38)   VALUE        03890099
039000         'R T V   D I S T R I B U T I O N   **  '.                03900099
039100     05  FILLER                          PIC X(49)   VALUE        03910099
039200         'RTV SHEETS LOCATED AT END OF MARKING APRON PACKET'.     03920099
039300     05  FILLER                          PIC X(38)   VALUE        03930099
039400         '   **  R T V   D I S T R I B U T I O N'.                03940099
039500     05  FILLER                          PIC X(07)  VALUE SPACE.  03950099
039600                                                                  03960099
039700 01  RT2-RTV-DISTRO-LINE-2.                                       03970099
039800     05  RT2-DISTRO-HEADING              PIC X(41)   VALUE        03980099
039900         '** PO/REC LINE NUMBERS WITH RTV DISTROS: '.             03990099
040000     05  RT2-RTV-LINE-TABLE OCCURS 15 TIMES.                      04000099
040100         10  RT2-RTV-LINE                PIC ZZZZ.                04010099
040200         10  RT2-RTV-COMMA               PIC X(02)   VALUE SPACES.04020099
040300     05  FILLER                          PIC X(01)   VALUE SPACES.04030099
040400                                                                  04040099
040500 01  RT3-RTV-DISTRO-LINE-3.                                       04050099
040600     05  FILLER                          PIC X(45)   VALUE        04060099
040700         'MORE THAN 60 LINES WITH RTV DISTRIBUTION - '.           04070099
040800     05  FILLER                          PIC X(31)   VALUE        04080099
040900         'PLEASE SEE DETAIL MARKING APRON'.                       04090099
041000     05  FILLER                          PIC X(56)   VALUE SPACES.04100099
041100                                                                  04110099
041200 01  HL1-HEADING-LINE.                                            04120099
041300     05  FILLER                      PIC  X(01)  VALUE SPACES.    04130099
041400     05  HL1-RUN-DATE.                                            04140099
041500         10  HL1-RUN-MONTH           PIC  9(02)  VALUE ZERO.      04150099
041600         10  FILLER                  PIC  X(01)  VALUE '/'.       04160099
041700         10  HL1-RUN-DAY             PIC  9(02)  VALUE ZERO.      04170099
041800         10  FILLER                  PIC  X(01)  VALUE '/'.       04180099
041900         10  HL1-RUN-YEAR            PIC  9(02)  VALUE ZERO.      04190099
042000     05  FILLER                      PIC  X(02)  VALUE SPACE.     04200099
042100     05  HL1-RUN-TIME.                                            04210099
042200         10  HL1-RUN-HOUR            PIC  9(02)  VALUE ZERO.      04220099
042300         10  FILLER                  PIC  X(01)  VALUE ':'.       04230099
042400         10  HL1-RUN-MINUTE          PIC  9(02)  VALUE ZERO.      04240099
042500     05  FILLER                      PIC  X(20)  VALUE SPACE.     04250099
042600     05  FILLER                      PIC  X(43)  VALUE            04260099
042700         'K O H L S    M A R K I N G    A P R O N '.              04270099
042800     05  FILLER                      PIC  X(11)  VALUE            04280099
042900         'H E A D E R'.                                           04290099
043000     05  FILLER                      PIC  X(17)  VALUE SPACE.     04300099
043100     05  HL1-PGM-NME                 PIC  X(08)  VALUE SPACE.     04310099
043200     05  FILLER                      PIC  X(01)  VALUE '-'.       04320099
043300     05  HL1-RPT-NBR                 PIC  9(01)  VALUE ZERO.      04330099
043400     05  FILLER                      PIC  X(03)  VALUE SPACE.     04340099
043500     05  FILLER                      PIC  X(05)  VALUE            04350099
043600         'PAGE '.                                                 04360099
043700     05  HL1-PGE-NBR                 PIC  9(01)  VALUE ZERO.      04370099
043800     05  FILLER                      PIC  X(01)  VALUE SPACE.     04380099
043900     05  FILLER                      PIC  X(02)  VALUE 'OF'.      04390099
044000     05  FILLER                      PIC  X(01)  VALUE SPACE.     04400099
044100     05  HL1-PGE-NBR2                PIC  9(01)  VALUE ZERO.      04410099
044200     05  FILLER                      PIC  X(03)  VALUE SPACE.     04420099
044300                                                                  04430099
044400 01  HL1A-HEADING-LINE.                                           04440099
044500     05  FILLER                      PIC  X(15)  VALUE            04450099
044600         '***************'.                                       04460099
044700     05  FILLER                      PIC  X(117) VALUE SPACE.     04470099
044800                                                                  04480099
044900 01  HL2-HEADING-LINE.                                            04490099
045000     05  FILLER                      PIC  X(15)  VALUE            04500099
045100         '*PO/SEQ NUMBER*'.                                       04510099
045200     05  FILLER                      PIC  X(02)  VALUE SPACE.     04520099
045300     05  FILLER                      PIC  X(11)  VALUE            04530099
045400         'OPER/FAC'.                                              04540099
045500     05  FILLER                      PIC  X(05)  VALUE SPACE.     04550099
045600     05  FILLER                      PIC  X(11)  VALUE            04560099
045700         'VENDOR NAME'.                                           04570099
045800     05  FILLER                      PIC  X(24)  VALUE SPACE.     04580099
045900     05  FILLER                      PIC  X(12)  VALUE            04590099
046000         'ARRIVED DATE'.                                          04600099
046100     05  FILLER                      PIC  X(05)  VALUE SPACE.     04610099
046200     05  FILLER                      PIC  X(04)  VALUE            04620099
046300         'DEPT'.                                                  04630099
046400     05  FILLER                      PIC  X(03)  VALUE SPACE.     04640099
046500     05  FILLER                      PIC  X(14)  VALUE            04650099
046600         'RECVR EXP CTNS'.                                        04660099
046700     05  FILLER                      PIC  X(02)  VALUE SPACE.     04670099
046800     05  FILLER                      PIC  X(08)  VALUE            04680099
046900         'ADJ CTNS'.                                              04690099
047000     05  FILLER                      PIC  X(04)  VALUE SPACE.     04700099
047100     05  FILLER                      PIC  X(11)  VALUE            04710099
047200         'ARCHIVED BY'.                                           04720099
047300     05  FILLER                      PIC  X(03)  VALUE SPACE.     04730099
047400                                                                  04740099
047500 01  HL3-HEADING-LINE.                                            04750099
047600     05  FILLER                      PIC  X(01)  VALUE '*'.       04760099
047700     05  HL3-PO-NBR                  PIC  X(08)  VALUE SPACE.     04770099
047800     05  FILLER                      PIC  X(01)  VALUE '-'.       04780099
047900     05  HL3-REC-SEQ-NBR             PIC  X(03)  VALUE SPACE.     04790099
048000     05  FILLER                      PIC  X(02)  VALUE ' *'.      04800099
048100     05  FILLER                      PIC  X(02)  VALUE SPACE.     04810099
048200     05  HL3-OPERATING-ID            PIC  X(04)  VALUE SPACE.     04820099
048300     05  FILLER                      PIC  X(01)  VALUE '/'.       04830099
048400     05  HL3-FACILITY-ID             PIC  X(04)  VALUE SPACE.     04840099
048500     05  FILLER                      PIC  X(07)  VALUE SPACE.     04850099
048600     05  HL3-VENDOR-NAME             PIC  X(30)  VALUE SPACE.     04860099
048700     05  FILLER                      PIC  X(07)  VALUE SPACE.     04870099
048800     05  HL3-ARRIVED-DATE            PIC  X(08)  VALUE SPACE.     04880099
048900     05  FILLER                      PIC  X(08)  VALUE SPACE.     04890099
049000     05  HL3-DEPT-NBR                PIC  X(03)  VALUE SPACE.     04900099
049100     05  FILLER                      PIC  X(10)  VALUE SPACE.     04910099
049200     05  HL3-EXPT-CARTONS            PIC  ZZZ9   VALUE ZERO.      04920099
049300     05  FILLER                      PIC  X(09)  VALUE SPACE.     04930099
049400     05  HL3-ADJ-CARTONS             PIC  ZZZ9   VALUE ZERO.      04940099
049500     05  FILLER                      PIC  X(07)  VALUE SPACE.     04950099
049600     05  HL3-ARCHIVED-BY             PIC  X(08)  VALUE SPACE.     04960099
049700     05  FILLER                      PIC  X(04)  VALUE SPACE.     04970099
049800                                                                  04980099
049900 01  HL3A-HEADING-LINE.                                           04990099
050000     05  FILLER                      PIC  X(15)  VALUE            05000099
050100         '***************'.                                       05010099
050200     05  FILLER                      PIC  X(117) VALUE SPACE.     05020099
050300                                                                  05030099
050400 01  HL4-HEADING-LINE.                                            05040099
050500     05  FILLER                      PIC  X(01)  VALUE SPACES.    05050099
050600     05  FILLER                      PIC  X(04)  VALUE            05060099
050700         'SCAC'.                                                  05070099
050800     05  FILLER                      PIC  X(04)  VALUE SPACE.     05080099
050900     05  FILLER                      PIC  X(07)  VALUE            05090099
051000         'TRAILER'.                                               05100099
051100     05  FILLER                      PIC  X(08)  VALUE SPACE.     05110099
051200     05  FILLER                      PIC  X(07)  VALUE            05120099
051300         'TRIP ID'.                                               05130099
051400     05  FILLER                      PIC  X(07)  VALUE SPACE.     05140099
051500     05  FILLER                      PIC  X(12)  VALUE            05150099
051600         'FREIGHT BILL'.                                          05160099
051700     05  FILLER                      PIC  X(14)  VALUE SPACE.     05170099
051800     05  FILLER                      PIC  X(14)  VALUE            05180099
051900         'BILL OF LADING'.                                        05190099
052000     05  FILLER                      PIC  X(30)  VALUE SPACE.     05200099
052100     05  FILLER                      PIC  X(10)  VALUE            05210099
052200         'PRINTER ID'.                                            05220099
052300     05  FILLER                      PIC  X(03)  VALUE SPACE.     05230099
052400     05  FILLER                      PIC  X(09)  VALUE            05240099
052500         'APRON LOC'.                                             05250099
052600     05  FILLER                      PIC  X(02)  VALUE SPACE.     05260099
052700                                                                  05270099
052800 01  HL5-HEADING-LINE.                                            05280099
052900     05  FILLER                      PIC  X(01)  VALUE SPACE.     05290099
053000     05  HL5-SCAC                    PIC  X(04)  VALUE SPACE.     05300099
053100     05  FILLER                      PIC  X(04)  VALUE SPACE.     05310099
053200     05  HL5-TRAILER                 PIC  X(10)  VALUE SPACE.     05320099
053300     05  FILLER                      PIC  X(04)  VALUE SPACE.     05330099
053400     05  HL5-TRIP-ID                 PIC  ZZZZZZZZ9.              05340099
053500     05  FILLER                      PIC  X(06)  VALUE SPACE.     05350099
053600     05  HL5-FOB                     PIC  X(22)  VALUE SPACE.     05360099
053700     05  FILLER                      PIC  X(04)  VALUE SPACE.     05370099
053800     05  HL5-BOL                     PIC  X(30)  VALUE SPACE.     05380099
053900     05  FILLER                      PIC  X(17)  VALUE SPACE.     05390099
054000     05  HL5-PRINTER-ID              PIC  X(08)  VALUE SPACE.     05400099
054100     05  FILLER                      PIC  X(03)  VALUE SPACE.     05410099
054200     05  HL5-APRON-LOC               PIC  X(08)  VALUE SPACE.     05420099
054300     05  FILLER                      PIC  X(02)  VALUE SPACE.     05430099
054400                                                                  05440099
054500 01  HL6-HEADING-LINE.                                            05450099
054600     05  FILLER                      PIC  X(01)  VALUE SPACES.    05460099
054700     05  FILLER                      PIC  X(06)  VALUE            05470099
054800         'HANGER'.                                                05480099
054900     05  FILLER                      PIC  X(02)  VALUE SPACE.     05490099
055000     05  FILLER                      PIC  X(09)  VALUE            05500099
055100         'PRETICKET'.                                             05510099
055200     05  FILLER                      PIC  X(02)  VALUE SPACE.     05520099
055300     05  FILLER                      PIC  X(03)  VALUE            05530099
055400         'PBS'.                                                   05540099
055500     05  FILLER                      PIC  X(02)  VALUE SPACE.     05550099
055600     05  FILLER                      PIC  X(12)  VALUE            05560099
055700         'PRESENTATION'.                                          05570099
055800     05  FILLER                      PIC  X(03)  VALUE SPACE.     05580099
055900     05  FILLER                      PIC  X(07)  VALUE            05590099
056000         'AD DATE'.                                               05600099
056100     05  FILLER                      PIC  X(17)  VALUE SPACE.     05610099
056200     05  FILLER                      PIC  X(14)  VALUE            05620099
056300         'PACKAGING TYPE'.                                        05630099
056400     05  FILLER                      PIC  X(14)  VALUE SPACE.     05640099
056500     05  FILLER                      PIC  X(06)  VALUE            05650099
056600         'BOX ID'.                                                05660099
056700     05  FILLER                      PIC  X(03)  VALUE SPACE.     05670099
056800     05  FILLER                      PIC  X(03)  VALUE            05680099
056900         'SET'.                                                   05690099
057000     05  FILLER                      PIC  X(30)  VALUE SPACE.     05700099
057100*    05  FILLER                      PIC  X(087) VALUE SPACE.     05710099
057200                                                                  05720099
057300 01  HL7-HEADING-LINE.                                            05730099
057400     05  FILLER                      PIC  X(03)  VALUE SPACES.    05740099
057500     05  HL7-HANGER-IND              PIC  X(01)  VALUE SPACES.    05750099
057600     05  FILLER                      PIC  X(09)  VALUE SPACE.     05760099
057700     05  HL7-PRETICKET-IND           PIC  X(01)  VALUE SPACE.     05770099
057800     05  FILLER                      PIC  X(07)  VALUE SPACE.     05780099
057900     05  HL7-PBS-IND                 PIC  X(01)  VALUE SPACES.    05790099
058000     05  FILLER                      PIC  X(06)  VALUE SPACE.     05800099
058100*    05  HL7-PRESENTATION            PIC  X(05)  VALUE SPACES.    05810099
058200     05  HL7-PRESENTATION            PIC  X(07)  VALUE SPACES.    05820099
058300*    05  FILLER                      PIC  X(06)  VALUE SPACE.     05830099
058400     05  FILLER                      PIC  X(04)  VALUE SPACE.     05840099
058500     05  HL7-AD-DATE                 PIC  X(10)  VALUE SPACES.    05850099
058600     05  FILLER                      PIC  X(01)  VALUE SPACE.     05860099
058700     05  FILLER                      PIC  X(01)  VALUE '('.       05870099
058800     05  HL7-AD-DATE-INFO            PIC  X(04)  VALUE SPACES.    05880099
058900     05  FILLER                      PIC  X(01)  VALUE ')'.       05890099
059000     05  FILLER                      PIC  X(08)  VALUE SPACE.     05900099
059100     05  HL7-PACK-TYPE-DESC          PIC  X(22)  VALUE SPACES.    05910099
059200     05  FILLER                      PIC  X(06)  VALUE SPACE.     05920099
059300     05  HL7-BOX-ID                  PIC  X(05)  VALUE SPACE.     05930099
059400     05  FILLER                      PIC  X(04)  VALUE SPACE.     05940099
059500     05  HL7-SEASON-SET-NAME         PIC  X(05)  VALUE SPACE.     05950099
059600     05  FILLER                      PIC  X(23)  VALUE SPACE.     05960099
059700*    05  FILLER                      PIC  X(076) VALUE SPACE.     05970099
059800                                                                  05980099
059900 01  DH1-DETAIL-HEADING-LINE.                                     05990099
060000     05  FILLER                      PIC  X(01)  VALUE SPACE.     06000099
060100     05  FILLER                      PIC  X(09)  VALUE            06010099
060200         'PACK SLIP'.                                             06020099
060300     05  FILLER                      PIC  X(03)  VALUE SPACE.     06030099
060400     05  FILLER                      PIC  X(08)  VALUE            06040099
060500         'KEYED BY'.                                              06050099
060600     05  FILLER                      PIC  X(02)  VALUE SPACE.     06060099
060700     05  FILLER                      PIC  X(10)  VALUE            06070099
060800         'TRANSCR BY'.                                            06080099
060900     05  FILLER                      PIC  X(03)  VALUE SPACE.     06090099
061000     05  FILLER                      PIC  X(05)  VALUE            06100099
061100         'PAGES'.                                                 06110099
061200     05  FILLER                      PIC  X(11)  VALUE SPACE.     06120099
061300     05  FILLER                      PIC  X(10)  VALUE            06130099
061400         'TOTAL COST'.                                            06140099
061500     05  FILLER                      PIC  X(13)  VALUE SPACE.     06150099
061600     05  FILLER                      PIC  X(12)  VALUE            06160099
061700         'TOTAL RETAIL'.                                          06170099
061800     05  FILLER                      PIC  X(03)  VALUE SPACE.     06180099
061900     05  FILLER                      PIC  X(05)  VALUE            06190099
062000         'STORE'.                                                 06200099
062100     05  FILLER                      PIC  X(04)  VALUE SPACE.     06210099
062200     05  FILLER                      PIC  X(10)  VALUE            06220099
062300         'CTNS/STORE'.                                            06230099
062400     05  FILLER                      PIC  X(05)  VALUE SPACE.     06240099
062500     05  FILLER                      PIC  X(11)  VALUE            06250099
062600         'UNITS/STORE'.                                           06260099
062700     05  FILLER                      PIC  X(03)  VALUE SPACE.     06270099
062800                                                                  06280099
062900 01  DH2-DETAIL-HEADING-LINE.                                     06290099
063000     05  FILLER                      PIC  X(05)  VALUE SPACE.     06300099
063100     05  FILLER                      PIC  X(05)  VALUE '***'.     06310099
063200     05  FILLER                      PIC  X(01)  VALUE SPACE.     06320099
063300     05  FILLER                      PIC  X(44)  VALUE            06330099
063400         'MARKING APRON HEADER COULD NOT BE PRINTED.'.            06340099
063500     05  FILLER                      PIC  X(02)  VALUE SPACE.     06350099
063600     05  DH2-MESSAGE                 PIC  X(70)  VALUE SPACE.     06360099
063700     05  FILLER                      PIC  X(03)  VALUE SPACE.     06370099
063800                                                                  06380099
063900 01  DL1-DETAIL-LINE.                                             06390099
064000     05  FILLER                    PIC  X(01)  VALUE SPACE.       06400099
064100     05  DL-PACK-SLIP              PIC  X(10)  VALUE SPACE.       06410099
064200     05  FILLER                    PIC  X(02)  VALUE SPACE.       06420099
064300     05  DL-KEYED-BY               PIC  X(08)  VALUE SPACE.       06430099
064400     05  FILLER                    PIC  X(03)  VALUE SPACE.       06440099
064500     05  DL-TRANS-BY               PIC  X(08)  VALUE SPACE.       06450099
064600     05  FILLER                    PIC  X(05)  VALUE SPACE.       06460099
064700     05  DL-PAGES                  PIC  ZZZ9   VALUE ZERO.        06470099
064800     05  FILLER                    PIC  X(01)  VALUE SPACE.       06480099
064900     05  DL-TOTAL-COST             PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.99       06490099
065000                                               VALUE ZERO.        06500099
065100     05  FILLER                    PIC  X(01)  VALUE SPACE.       06510099
065200     05  DL-TOTAL-RETAIL           PIC Z,ZZZ,ZZZ,ZZZ,ZZZ,ZZ9.99   06520099
065300                                               VALUE ZERO.        06530099
065400     05  FILLER                    PIC  X(04)  VALUE SPACE.       06540099
065500     05  DL-STORE                  PIC  ZZZ9   VALUE ZEROES.      06550099
065600     05  FILLER                    PIC  X(03)  VALUE SPACE.       06560099
065700     05  DL-CTN-PER-STORE          PIC ZZZ,ZZZ,ZZ9                06570099
065800                                               VALUE ZERO.        06580099
065900     05  FILLER                    PIC  X(02)  VALUE SPACE.       06590099
066000     05  DL-UNITS-PER-STORE        PIC ZZ,ZZZ,ZZZ,ZZ9             06600099
066100                                               VALUE ZERO.        06610099
066200     05  FILLER                    PIC  X(09)  VALUE SPACE.       06620099
066300                                                                  06630099
066400 01  DL2-DETAIL-LINE.                                             06640099
066500     05  FILLER                    PIC  X(01)  VALUE SPACE.       06650099
066600     05  FILLER                    PIC  X(05)  VALUE 'AREA'.      06660099
066700     05  FILLER                    PIC  X(32)  VALUE              06670099
066800         '________________________________'.                      06680099
066900     05  FILLER                    PIC  X(02)  VALUE SPACE.       06690099
067000     05  FILLER                    PIC  X(11)  VALUE              06700099
067100         'APPROVED BY'.                                           06710099
067200     05  FILLER                    PIC  X(06)  VALUE              06720099
067300         '______'.                                                06730099
067400     05  FILLER                    PIC  X(02)  VALUE SPACE.       06740099
067500     05  FILLER                    PIC  X(19)  VALUE              06750099
067600         'PACK ID''S INCORRECT'.                                  06760099
067700     05  FILLER                    PIC  X(43)  VALUE              06770099
067800         '___________________________________________'.           06780099
067900     05  FILLER                    PIC  X(10)  VALUE              06790099
068000         '__________'.                                            06800099
068100                                                                  06810099
068200 01  DL3-DETAIL-LINE.                                             06820099
068300     05  FILLER                    PIC  X(06)  VALUE SPACE.       06830099
068400     05  FILLER                    PIC  X(11)  VALUE              06840099
068500         'QTY CORRECT'.                                           06850099
068600     05  FILLER                    PIC  X(08)  VALUE              06860099
068700         '________'.                                              06870099
068800     05  FILLER                    PIC  X(02)  VALUE SPACE.       06880099
068900     05  FILLER                    PIC  X(03)  VALUE              06890099
069000         'PCS'.                                                   06900099
069100     05  FILLER                    PIC  X(08)  VALUE              06910099
069200         '________'.                                              06920099
069300     05  FILLER                    PIC  X(02)  VALUE SPACE.       06930099
069400     05  FILLER                    PIC  X(11)  VALUE              06940099
069500         'VERIFIED BY'.                                           06950099
069600     05  FILLER                    PIC  X(06)  VALUE              06960099
069700         '______'.                                                06970099
069800     05  FILLER                    PIC  X(02)  VALUE SPACE.       06980099
069900     05  FILLER                    PIC  X(11)  VALUE              06990099
070000         'CHECKED BY'.                                            07000099
070100     05  FILLER                    PIC  X(10)  VALUE              07010099
070200         '__________'.                                            07020099
070300     05  FILLER                    PIC  X(02)  VALUE SPACE.       07030099
070400     05  FILLER                    PIC  X(04)  VALUE              07040099
070500         'DATE'.                                                  07050099
070600     05  FILLER                    PIC  X(10)  VALUE              07060099
070700         '__________'.                                            07070099
070800     05  FILLER                    PIC  X(35)  VALUE SPACE.       07080099
070900                                                                  07090099
071000 01  DL4-DETAIL-LINE.                                             07100099
071100     05  FILLER                    PIC  X(01)  VALUE SPACE.       07110099
071200     05  FILLER                    PIC  X(24)  VALUE              07120099
071300         'SPECIAL INSTRUCTIONS ***'.                              07130099
071400     05  DL4-CONTINUED-MSG         PIC  X(11)  VALUE              07140099
071500         '***********'.                                           07150099
071600     05  FILLER                    PIC  X(36)  VALUE              07160099
071700         '************************************'.                  07170099
071800     05  FILLER                    PIC  X(62)  VALUE SPACE.       07180099
071900 01  DL5-DETAIL-LINE.                                             07190099
072000     05  FILLER                    PIC  X(01)  VALUE SPACE.       07200099
072100     05  FILLER                    PIC  X(50)  VALUE              07210099
072200         '*    RECIPIENT                   INSTRUCTION      '.    07220099
072300     05  FILLER                    PIC  X(20)  VALUE SPACE.       07230099
072400     05  FILLER                    PIC  X(01)  VALUE              07240099
072500         '*'.                                                     07250099
072600     05  FILLER                    PIC  X(62)  VALUE SPACE.       07260099
072700 01  DL6-DETAIL-LINE.                                             07270099
072800     05  FILLER                    PIC  X(03)  VALUE              07280099
072900         ' * '.                                                   07290099
073000     05  DL-RECIPIENT              PIC  X(15).                    07300099
073100     05  FILLER                    PIC  X(02)  VALUE SPACE.       07310099
073200     05  DL-INSTRUCTION            PIC  X(50).                    07320099
073300     05  FILLER                    PIC  X(02)  VALUE              07330099
073400         ' *'.                                                    07340099
073500     05  FILLER                    PIC  X(60)  VALUE SPACE.       07350099
073600 01  DL7-DETAIL-LINE.                                             07360099
073700     05  FILLER                    PIC  X(01)  VALUE SPACE.       07370099
073800     05  FILLER                    PIC  X(50)  VALUE              07380099
073900         '**************************************************'.    07390099
074000     05  FILLER                    PIC  X(21)  VALUE              07400099
074100         '*********************'.                                 07410099
074200     05  FILLER                    PIC  X(62)  VALUE SPACE.       07420099
074300                                                                  07430099
074400 01  DL8-DETAIL-LINE.                                             07440099
074500     05  FILLER                    PIC  X(59)  VALUE SPACE.       07450099
074600     05  FILLER                    PIC  X(16)  VALUE              07460099
074700         'LINES INCORRECT'.                                       07470099
074800     05  FILLER                    PIC  X(46)  VALUE              07480099
074900         '______________________________________________'.        07490099
075000     05  FILLER                    PIC  X(10)  VALUE              07500099
075100         '__________'.                                            07510099
075200                                                                  07520099
075300 01  TL1-TOTAL-LINE.                                              07530099
075400     05  FILLER                    PIC  X(10)  VALUE SPACE.       07540099
075500     05  FILLER                    PIC  X(06)  VALUE              07550099
075600         'TOTALS'.                                                07560099
075700     05  FILLER                    PIC  X(79)  VALUE SPACE.       07570099
075800     05  TL-CTN-QTY                PIC ZZ,ZZZ,ZZZ,ZZ9             07580099
075900                                               VALUE ZERO.        07590099
076000     05  FILLER                    PIC  X(02)  VALUE SPACE.       07600099
076100     05  TL-UNIT-QTY               PIC ZZ,ZZZ,ZZZ,ZZ9             07610099
076200                                               VALUE ZERO.        07620099
076300     05  FILLER                    PIC  X(23)  VALUE SPACE.       07630099
076400                                                                  07640099
076500/                                                                 07650099
076600 01  DN-DB2-NULL-INDICATORS.                                      07660099
076700     05  DN-VEH-NBR                  PIC S9(04)  COMP VALUE +0.   07670099
076800                                                                  07680099
076900 01  PC-PROGRAM-CONSTANTS.                                        07690099
077000     05  PC-VS-HNGFLD-TYPE-CDE       PIC S9(04) COMP              07700099
077100                                                VALUE +10.        07710099
077200     05  PC-DB2-DUMMY-DATE-TIME      PIC  X(26)  VALUE            07720099
077300         '9999-09-09-09.09.09.999999'.                            07730099
077400     05  PC-ASTERISKS                PIC  X(04)  VALUE '*** '.    07740099
077500     05  PC-ROW-NOT-FOUND            PIC S9(04)  VALUE +100       07750099
077600                                                 COMP SYNC.       07760099
077700     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE            07770099
077800         'PCKCS013'.                                              07780099
077900     05  PC-PCKCS010                 PIC  X(08)  VALUE            07790099
078000                                                'PCKCS010'.       07800099
078100     05  PC-PCKCS014                 PIC  X(08)  VALUE            07810099
078200                                                'PCKCS014'.       07820099
078300     05  PC-PCKCS708                 PIC  X(08)  VALUE            07830099
078400                                                'PCKCS708'.       07840099
078500     05  PC-DPKCS060                 PIC  X(08)  VALUE            07850099
078600                                                'DPKCS060'.       07860099
078700     05  PC-MAX-PKSLIP-TBL-OCCURS    PIC S9(04)  VALUE +200       07870099
078800                                                 COMP SYNC.       07880099
078900*    05  PC-PKSLIPS-PER-PAGE         PIC S9(04)  VALUE +16        07890099
079000     05  PC-PKSLIPS-PER-PAGE         PIC S9(04)  VALUE +14        07900099
079100                                                 COMP SYNC.       07910099
079200     05  PC-INSTR-PER-PAGE           PIC S9(04)  VALUE +43        07920099
079300                                                 COMP SYNC.       07930099
079400     05  PC-MAX-RETRIES              PIC S9(04)  VALUE +3         07940099
079500                                                 COMP SYNC.       07950099
079600     05  PC-PUT                      PIC  X(03)  VALUE 'PUT'.     07960099
079700     05  PC-INIT                     PIC  X(04)  VALUE 'INIT'.    07970099
079800     05  PC-TERM                     PIC  X(04)  VALUE 'TERM'.    07980099
079900     05  PC-COMMA                    PIC  X(02)  VALUE ', '.      07990099
080000     05  PC-01                       PIC  X(02)  VALUE '01'.      08000099
080100     05  PC-A                        PIC  X(02)  VALUE 'A'.       08010099
080200     05  PC-B                        PIC  X(02)  VALUE 'B'.       08020099
080300     05  PC-C                        PIC  X(02)  VALUE 'C'.       08030099
080400     05  PC-Y                        PIC  X(02)  VALUE 'Y'.       08040099
080500     05  PC-I                        PIC  X(02)  VALUE 'I'.       08050099
080600     05  PC-M                        PIC  X(02)  VALUE 'M'.       08060099
080700     05  PC-N                        PIC  X(02)  VALUE 'N'.       08070099
080800     05  PC-S                        PIC  X(02)  VALUE 'S'.       08080099
080900     05  PC-AC                       PIC  X(02)  VALUE 'AC'.      08090099
081000     05  PC-AN                       PIC  X(02)  VALUE 'AN'.      08100099
081100     05  PC-DE                       PIC  X(02)  VALUE 'DE'.      08110099
081200     05  PC-VE                       PIC  X(02)  VALUE 'VE'.      08120099
081300     05  PC-VN                       PIC  X(02)  VALUE 'VN'.      08130099
081400     05  PC-IP                       PIC  X(02)  VALUE 'IP'.      08140099
081500     05  PC-IN                       PIC  X(02)  VALUE 'IN'.      08150099
081600     05  PC-CM                       PIC  X(02)  VALUE 'CM'.      08160099
081700     05  PC-DC                       PIC  X(02)  VALUE 'DC'.      08170099
081800     05  PC-RV                       PIC  X(02)  VALUE 'RV'.      08180099
081900     05  PC-ZERO                     PIC S9(09)  COMP VALUE       08190099
082000         ZERO.                                                    08200099
082100     05  PC-ZERO-ONE                 PIC  X(02)  VALUE '01'.      08210099
082200     05  PC-ONE                      PIC  9(01)  VALUE 1.         08220099
082300     05  PC-TOP-OF-PAGE              PIC  X(01)  VALUE '1'.       08230099
082400     05  PC-SINGLE-SPACE             PIC  X(01)  VALUE ' '.       08240099
082500     05  PC-DOUBLE-SPACE             PIC  X(01)  VALUE '0'.       08250099
082600     05  PC-TRIPLE-SPACE             PIC  X(01)  VALUE '-'.       08260099
082700     05  PC-SUBCLASS-MDSELV-CDE      PIC  X(03) VALUE 'SCL'.      08270099
082800     05  PC-MAJCLASS-MDSELV-CDE      PIC  X(03) VALUE 'MCL'.      08280099
082900     05  PC-DPT-MDSELV-CDE           PIC  X(03) VALUE 'DPT'.      08290099
083000     05  PC-CURRENT-DATE              PIC X(10) VALUE SPACE.      08300099
083100     05  PC-MULTI                     PIC X(05) VALUE 'MULTI'.    08310099
083200                                                                  08320099
083300     05  PC-MULTIPLE-SKU-PPK             PIC  X(21)  VALUE        08330099
083400         'M - MULTI SKU PREPACK'.                                 08340099
083500     05  PC-SINGLE-SKU-PPK               PIC  X(22)  VALUE        08350099
083600         'S - SINGLE SKU PREPACK'.                                08360099
083700     05  PC-INNER-PPK                    PIC  X(17)  VALUE        08370099
083800         'I - INNER PREPACK'.                                     08380099
083900     05  PC-BULK-PPK                     PIC  X(13)  VALUE        08390099
084000         'B - BULK PACK'.                                         08400099
084100     05  PC-CASEPACK                     PIC  X(12)  VALUE        08410099
084200         'C - CASEPACK'.                                          08420099
084300     05  PC-MULT-SHIPS-MSG               PIC  X(18)  VALUE        08430099
084400         'MULTIPLE SHIPMENTS'.                                    08440099
084500                                                                  08450099
084600     05  PC-RETRIEVE-MSG                 PIC  X(28)  VALUE        08460099
084700         'CICS ERROR IN PASSING DATA. '.                          08470099
084800     05  PC-DELETE-Q-MSG                 PIC  X(28)  VALUE        08480099
084900         'CICS ERROR IN DELETEING QUE.'.                          08490099
085000     05  PC-NOT-TRANSCRIBED-MSG          PIC  X(46)  VALUE        08500099
085100         'ONE OR MORE PACK SLIPS ARE NOT TRANSCRIBED. '.          08510099
085200     05  PC-TIMESTAMP-MSG                PIC  X(54)  VALUE        08520099
085300         'MARKING APRON HEADER TIMESTAMP COULD NOT BE UPDATED. '. 08530099
085400     05  PC-CONTENTION-MSG               PIC  X(30)  VALUE        08540099
085500         'SYSTEM IS BUSY.  TRY AGAIN. '.                          08550099
085600                                                                  08560099
085700     05  PC-SELECT-PRIM-SHIP-MSG         PIC  X(36)  VALUE        08570099
085800         'ERROR - SELECTING PRIMARY SHIPMENT '.                   08580099
085900     05  PC-SELECT-PO-DATA-MSG           PIC  X(39)  VALUE        08590099
086000         'ERROR - SELECTING PURCHASE ORDER DATA '.                08600099
086100     05  PC-SELECT-MKNG-TMST-MSG         PIC  X(43)  VALUE        08610099
086200         'ERROR - SELECTING MARKING APRON TIMESTAMP '.            08620099
086300                                                                  08630099
086400     05  PC-CNT-SHIPMENTS-MSG            PIC  X(29)  VALUE        08640099
086500         'ERROR - COUNTING SHIPMENTS '.                           08650099
086600     05  PC-CNT-LINE-TRBL-MSG            PIC  X(41)  VALUE        08660099
086700         'ERROR - COUNTING LINE-LEVEL TROUBLE '.                  08670099
086800                                                                  08680099
086900     05  PC-PKSLIP-CSR1-MSG              PIC  X(39)  VALUE        08690099
087000         'ERROR - RETRIEVING PACK SLIP SEQ NBR '.                 08700099
087100     05  PC-PKSLIP-CSR2-MSG              PIC  X(36)  VALUE        08710099
087200         'ERROR - RETRIEVING PACK SLIP DATA '.                    08720099
087300     05  PC-RECITM-CSR-MSG               PIC  X(40)  VALUE        08730099
087400         'ERROR - RETRIEVING RECEIVER ITEM DATA '.                08740099
087500     05  PC-PKITEM-CSR-MSG               PIC  X(31)  VALUE        08750099
087600         'ERROR - RETRIEVING COST DATA '.                         08760099
087700     05  PC-TRBL-CSR-MSG                 PIC  X(32)  VALUE        08770099
087800         'ERROR - RETRIEVING TROUBLE DATA '.                      08780099
087900     05  PC-SELECT-ADEVENT-MSG           PIC  X(36)  VALUE        08790099
088000         'ERROR - SELECTING AD ENVENT DATE   '.                   08800099
088100     05  PC-INSTRUCTION-ERROR-MSG        PIC  X(33)  VALUE        08810099
088200         'ERROR - RETRIEVING INSTRUCTIONS '.                      08820099
088300     05  PC-SELECT-TSK-MSG               PIC  X(36)  VALUE        08830099
088400         'ERROR - SELECTING TSK              '.                   08840099
088500     05  PC-SELECT-XLV-MSG               PIC  X(40)  VALUE        08850099
088600         'ERROR - INCORRECT DATA FOR XLV VIEW'.                   08860099
088700     05  PC-SELECT-XLV-SKU-MSG           PIC  X(40)  VALUE        08870099
088800         'ERROR - INCORRECT DATA FOR XLV_SKU'.                    08880099
088900     05  PC-ABEND-MESSAGE                PIC  X(62)  VALUE        08890099
089000          '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    08900099
089100 05  PC-CONTINUED-MSG                PIC  X(11)  VALUE            08910099
089200          ' CONTINUED '.                                          08920099
089300     05  PC-000                         PIC  9(03)  VALUE 000.    08930099
089400     05  PC-999                         PIC  9(03)  VALUE 999.    08940099
089500*                                                                 08950099
089600 01  PS-PROGRAM-SWITCHES.                                         08960099
089700     05  PS-DONE-SW                      PIC  X      VALUE 'N'.   08970099
089800         88  PS-NOT-DONE                             VALUE 'N'.   08980099
089900         88  PS-DONE                                 VALUE 'Y'.   08990099
090000     05  PS-TOP-OF-PAGE-SET-SW           PIC  X(01)  VALUE 'N'.   09000099
090100         88  PS-TOP-OF-PAGE-SET                      VALUE 'Y'.   09010099
090200         88  PS-TOP-OF-PAGE-NOT-SET                  VALUE 'N'.   09020099
090300     05  PS-DRS-INITIALIZED-SW           PIC  X      VALUE 'N'.   09030099
090400         88  PS-DRS-INITIALIZED                      VALUE 'Y'.   09040099
090500         88  PS-DRS-NOT-INITIALIZED                  VALUE 'N'.   09050099
090600     05  PS-VSM-SW                        PIC  X     VALUE 'N'.   09060099
090700         88  PS-NOT-VSM                              VALUE 'N'.   09070099
090800         88  PS-VSM                                  VALUE 'Y'.   09080099
090900     05  PS-PRINT-INSTRUCTIONS-SW         PIC  X     VALUE SPACE. 09090099
091000         88  PS-PRINT-INSTRUCTIONS                   VALUE 'Y'.   09100099
091100     05  PS-INSTRUCTIONS-DONE-SW          PIC  X     VALUE SPACE. 09110099
091200         88  PS-INSTRUCTIONS-NOT-DONE                VALUE SPACE. 09120099
091300         88  PS-INSTRUCTIONS-DONE                    VALUE 'Y'.   09130099
091400     05  PS-START-NEXT-PAGE-SW            PIC  X     VALUE SPACE. 09140099
091500         88  PS-START-NEXT-PAGE                      VALUE 'Y'.   09150099
091600     05  PS-FIRST-PACK-SLIP-DETAIL-SW     PIC  X     VALUE 'Y'.   09160099
091700         88  PS-FIRST-PACK-SLIP-DETAIL               VALUE 'Y'.   09170099
091800     05  PS-FIRST-TIME-SW                PIC  X      VALUE 'Y'.   09180099
091900         88  PS-FIRST-TIME                           VALUE 'Y'.   09190099
092000         88  PS-NOT-FIRST-TIME                       VALUE 'N'.   09200099
092100     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        09210099
092200         88  PS-CALL-API-NO                     VALUE 'N'.        09220099
092300         88  PS-CALL-API-YES                    VALUE 'Y'.        09230099
092400*                                                                 09240099
092500 01  PS-PROGRAM-SUBSCRIPTS.                                       09250099
092600     05  PS-PAGE-SUB                     PIC S9(04)  VALUE +0     09260099
092700                                                     COMP SYNC.   09270099
092800     05  PS-DTL-LNE-SUB                  PIC S9(04)  VALUE +0     09280099
092900                                                     COMP SYNC.   09290099
093000                                                                  09300099
093100 01  PV-PROGRAM-VARIABLES.                                        09310099
093200     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         09320099
093300                                                COMP-3.           09330099
093400     05  PV-PKSLIPS-PER-PAGE             PIC S9(04) VALUE +0      09340099
093500                                                    COMP SYNC.    09350099
093600     05  PV-ERROR-MSG                    PIC  X(66) VALUE SPACE.  09360099
093700     05  PV-PKSLIP-TRANS-UID             PIC  X(08) VALUE SPACE.  09370099
093800     05  PV-PKSLIP-KEYD-UID              PIC  X(08) VALUE SPACE.  09380099
093900     05  PV-PKSLIP-PKSL-NBR              PIC  X(10) VALUE SPACE.  09390099
094000     05  PV-TRBNTF-PO-LNE-NBR            PIC S9(09) VALUE ZERO    09400099
094100                                                    COMP.         09410099
094200     05  PV-TRBNTF-PREPK-ID              PIC S9(04) VALUE ZERO    09420099
094300                                                    COMP.         09430099
094400     05  PV-PKSLIP-PKSL-PG-CNT           PIC S9(04) VALUE ZERO    09440099
094500                                                    COMP.         09450099
094600     05  PV-PKSLIP-SEQ-NBR               PIC S9(04) VALUE ZERO    09460099
094700                                                    COMP.         09470099
094800     05  PV-PKSLIP-STR-DEST-NBR          PIC S9(04) VALUE ZERO    09480099
094900                                                    COMP.         09490099
095000     05  PV-PKSLIP-EXPTED-PKG-QTY        PIC S9(09) VALUE ZERO    09500099
095100                                                    COMP.         09510099
095200     05  PV-PKITEM-PKSL-ITM-QTY          PIC S9(11) VALUE ZERO    09520099
095300                                                    COMP.         09530099
095400     05  PV-SUM-COST-BY-LINE             PIC S9(13)V99 VALUE ZERO.09540099
095500     05  PV-SUM-RETAIL-BY-LINE           PIC S9(16)V99 VALUE ZERO.09550099
095600     05  PV-TOT-COST-BY-STORE            PIC S9(13)V99 VALUE ZERO.09560099
095700     05  PV-TOT-RETAIL-BY-STORE          PIC S9(16)V99 VALUE ZERO.09570099
095800     05  PV-TOT-CTN-QTY                  PIC S9(11)  VALUE ZERO.  09580099
095900     05  PV-TOT-UNIT-QTY                 PIC S9(11)  VALUE ZERO.  09590099
096000     05  PV-PKSLIP-PAGES-REQ             PIC  9(04)  VALUE ZERO.  09600099
096100     05  PV-TOTAL-PAGES-REQ              PIC  9(04)  VALUE ZERO.  09610099
096200     05  PV-INDX                         PIC  9(04)  VALUE ZERO.  09620099
096300     05  PV-RTV-INDX                     PIC  9(04)  VALUE ZERO.  09630099
096400     05  PV-PKSLIP-IDX                   USAGE IS INDEX.          09640099
096500     05  PV-ERROR-IDX                    USAGE IS INDEX.          09650099
096600     05  PV-LINE-TRBL-CNT                PIC S9(09)  VALUE ZERO   09660099
096700                                                     COMP.        09670099
096800     05  PV-PACK-TRBL-CNT                PIC S9(09)  VALUE ZERO   09680099
096900                                                     COMP.        09690099
097000     05  PV-SHIPMENTS-CNT                PIC S9(09)  VALUE ZERO   09700099
097100                                                     COMP.        09710099
097200     05  PV-STR-CNT                      PIC S9(09)  VALUE ZERO   09720099
097300                                                     COMP.        09730099
097400     05  PV-COUNT                        PIC S9(09)  VALUE +0     09740099
097500                                                     COMP-3.      09750099
097600     05  PV-INSTR-COUNT                  PIC S9(09)  VALUE +0     09760099
097700                                                     COMP-3.      09770099
097800     05  PV-REMAINDER                    PIC S9(3)   VALUE +0     09780099
097900                                                     COMP-3.      09790099
098000     05  PV-WORK-QTY                     PIC S9(5)   VALUE +0     09800099
098100                                                     COMP-3.      09810099
098200     05  PV-WORK-QTY-2                   PIC S9(5)   VALUE +0     09820099
098300                                                     COMP-3.      09830099
098400     05  PV-WORK-QTY-3                   PIC S9(5)   VALUE +0     09840099
098500                                                     COMP-3.      09850099
098600     05  PV-REC-TMST                     PIC  X(26).              09860099
098700     05  PV-REC-TMST-R REDEFINES PV-REC-TMST.                     09870099
098800         10  FILLER                      PIC  X(02).              09880099
098900         10  PV-REC-YY                   PIC  X(02).              09890099
099000         10  FILLER                      PIC  X(01).              09900099
099100         10  PV-REC-MM                   PIC  X(02).              09910099
099200         10  FILLER                      PIC  X(01).              09920099
099300         10  PV-REC-DD                   PIC  X(02).              09930099
099400         10  FILLER                      PIC  X(16).              09940099
099500                                                                  09950099
099600     05  PV-DB2-DATE-HOST             PIC  X(10).                 09960099
099700     05  PV-DB2-DATE                  PIC  X(10).                 09970099
099800     05  FILLER  REDEFINES PV-DB2-DATE.                           09980099
099900         10  PV-DB2-DATE-CC           PIC  X(02).                 09990099
100000         10  PV-DB2-DATE-YY           PIC  X(02).                 10000099
100100         10  FILLER                   PIC  X(01).                 10010099
100200         10  PV-DB2-DATE-MM           PIC  X(02).                 10020099
100300         10  FILLER                   PIC  X(01).                 10030099
100400         10  PV-DB2-DATE-DD           PIC  X(02).                 10040099
100500     05  PV-DISPLAY-DATE.                                         10050099
100600         10  PV-DISPLAY-DATE-MM       PIC  X(02).                 10060099
100700         10  FILLER                   PIC  X(01) VALUE '/'.       10070099
100800         10  PV-DISPLAY-DATE-DD       PIC  X(02).                 10080099
100900         10  FILLER                   PIC  X(01) VALUE '/'.       10090099
101000         10  PV-DISPLAY-DATE-CC       PIC  X(02).                 10100099
101100         10  PV-DISPLAY-DATE-YY       PIC  X(02).                 10110099
101200                                                                  10120099
101300                                                                  10130099
101400     05  PV-ARRIVED-DATE.                                         10140099
101500         10  PV-ARRIVED-MM               PIC  9(02)  VALUE ZERO.  10150099
101600         10  FILLER                      PIC  X(01)  VALUE '/'.   10160099
101700         10  PV-ARRIVED-DD               PIC  9(02)  VALUE ZERO.  10170099
101800         10  FILLER                      PIC  X(01)  VALUE '/'.   10180099
101900         10  PV-ARRIVED-YY               PIC  9(02)  VALUE ZERO.  10190099
102000     05  PV-ARRIVED-DATE-RDF REDEFINES PV-ARRIVED-DATE            10200099
102100                                         PIC  X(08).              10210099
102200                                                                  10220099
102300     05  PV-LINE-LEFT                    PIC S9(04)  VALUE +0     10230099
102400                                                     COMP SYNC.   10240099
102500     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  10250099
102600                                                     COMP SYNC.   10260099
102700     05  PV-CURRENT-DATE-X.                                       10270099
102800         10  PV-CURRENT-CENTURY-YEAR     PIC  9(04)  VALUE ZEROS. 10280099
102900         10  FILLER                      PIC  X(01)  VALUE '-'.   10290099
103000         10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 10300099
103100         10  FILLER                      PIC  X(01)  VALUE '-'.   10310099
103200         10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 10320099
103300     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            10330099
103400                                         PIC  X(10).              10340099
103500     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        10350099
103600                                                COMP SYNC.        10360099
103700     05  PV-INSTRUCTION.                                          10370099
103800         10  PV-INSTR-PART1           PIC X(50).                  10380099
103900         10  PV-INSTR-PART2           PIC X(50).                  10390099
104000         10  PV-INSTR-PART3           PIC X(50).                  10400099
104100                                                                  10410099
104200***** CHANGED PV-BOX-ID TO NUMERIC                                10420099
104300     05  TEMP-STICKER-NBR                PIC 9(05) VALUE ZEROES.  10430099
104400     05       STICKER-NBR                PIC X(05) VALUE SPACES.  10440099
104500     05  PV-BOX-ID                       PIC X(05) VALUE SPACES.  10450099
104600                                                                  10460099
104700     05  PV-DRS-ABEND-DISPLAY-LINE1.                              10470099
104800         10  FILLER                      PIC  X(14)  VALUE        10480099
104900             'DRRB ID = DRRB'.                                    10490099
105000         10  FILLER                      PIC  X(02)  VALUE SPACE. 10500099
105100         10  FILLER                      PIC  X(12)  VALUE        10510099
105200             'DRRB FUNC = '.                                      10520099
105300         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 10530099
105400         10  FILLER                      PIC  X(02)  VALUE SPACE. 10540099
105500         10  FILLER                      PIC  X(11)  VALUE        10550099
105600             'DRRB RID = '.                                       10560099
105700         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 10570099
105800         10  FILLER                      PIC  X(02)  VALUE SPACE. 10580099
105900         10  FILLER                      PIC  X(15)  VALUE        10590099
106000             'DRRB OPTIONS = '.                                   10600099
106100         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 10610099
106200                                                                  10620099
106300     05  PV-DRS-ABEND-DISPLAY-LINE.                               10630099
106400         10  FILLER                      PIC  X(10)  VALUE        10640099
106500             'DRRB RC = '.                                        10650099
106600         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 10660099
106700         10  FILLER                      PIC  X(02)  VALUE SPACE. 10670099
106800         10  FILLER                      PIC  X(18)  VALUE        10680099
106900             'DRRB ATTR-ERROR = '.                                10690099
107000         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 10700099
107100         10  FILLER                      PIC  X(02)  VALUE SPACE. 10710099
107200         10  FILLER                      PIC  X(12)  VALUE        10720099
107300             'DRRB DRDC = '.                                      10730099
107400         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 10740099
107500         10  FILLER                      PIC  X(02)  VALUE SPACE. 10750099
107600         10  FILLER                      PIC  X(13)  VALUE        10760099
107700             'DRRB LINES = '.                                     10770099
107800         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 10780099
107900                                                                  10790099
108000     05  PV-DISPLAY-KEYS.                                         10800099
108100         10  PV-DISPLAY-USER-ID          PIC  X(08)  VALUE SPACE. 10810099
108200         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  10820099
108300                                                BLANK WHEN ZEROS. 10830099
108400         10  FILLER                      PIC  X(02)  VALUE SPACE. 10840099
108500         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  10850099
108600                                                BLANK WHEN ZEROS. 10860099
108700         10  FILLER                      PIC  X(02)  VALUE SPACE. 10870099
108800         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  10880099
108900                                                BLANK WHEN ZEROS. 10890099
109000         10  FILLER                      PIC  X(02)  VALUE SPACE. 10900099
109100         10  PV-DISPLAY-REC-SEQ-NBR      PIC  9(09)  VALUE ZEROS  10910099
109200                                                BLANK WHEN ZEROS. 10920099
109300         10  FILLER                      PIC  X(02)  VALUE SPACE. 10930099
109400         10  PV-DISPLAY-PKSL-NBR         PIC  X(10)  VALUE SPACE. 10940099
109500         10  FILLER                      PIC  X(02)  VALUE SPACE. 10950099
109600         10  PV-DISPLAY-STR-DEST-NBR     PIC  9(04)  VALUE ZEROS  10960099
109700                                                BLANK WHEN ZEROS. 10970099
109800                                                                  10980099
109900 01  PS-PKSLIP-TABLE.                                             10990099
110000     05  PS-PKSLIP-ENTRY              OCCURS 200 TIMES            11000099
110100                                      INDEXED BY PS-PKSLIP-IDX.   11010099
110200         10  PS-PKSLIP-PKSL-NBR       PIC  X(10)    VALUE SPACE.  11020099
110300         10  PS-PKSLIP-KEYD-BY        PIC  X(08)    VALUE SPACE.  11030099
110400         10  PS-PKSLIP-TRANS-BY       PIC  X(08)    VALUE SPACE.  11040099
110500         10  PS-PKSLIP-PKSL-PG-CNT    PIC  9(04)    VALUE ZERO.   11050099
110600         10  PS-TOT-COST-BY-STORE     PIC  9(13)V99 VALUE ZERO.   11060099
110700         10  PS-TOT-RETAIL-BY-STORE   PIC  9(16)V99 VALUE ZERO.   11070099
110800         10  PS-PKSLIP-STR-DEST-NBR   PIC  9(04)    VALUE ZERO.   11080099
110900         10  PS-PKSLIP-EXPTED-PKG-QTY PIC  9(09)    VALUE ZERO.   11090099
111000         10  PS-PKITEM-PKSL-ITM-QTY   PIC  9(11)    VALUE ZERO.   11100099
111100                                                                  11110099
111200 01  PS-COST-TABLE.                                               11120099
111300     05  PS-COST-ENTRY                OCCURS 999 TIMES            11130099
111400                                     INDEXED BY PS-COST-IDX.      11140099
111500         10  PS-COST-PO-LNE-NBR      PIC  S9(09) COMP VALUE ZERO. 11150099
111600         10  PS-COST-PO-VER-NBR      PIC  S9(09) COMP VALUE ZERO. 11160099
111700         10  PS-COST-UNT-COST-AMT    PIC  S9(04)V9(3) COMP-3      11170099
111800                                                 VALUE ZERO.      11180099
111900         10  PS-COST-UNT-RTL-AMT     PIC  S9(06)V9(2) COMP-3      11190099
112000                                                 VALUE ZERO.      11200099
112100         10  PS-COST-GP-RTL-AMT      PIC  S9(05)V9(2) COMP-3      11210099
112200                                                 VALUE ZERO.      11220099
112300         10  PS-COST-GP-QTY          PIC  S9(04) VALUE ZERO.      11230099
112400                                                                  11240099
112500 01  ST-SYSTEM-TIME-DATE-AREA.                                    11250099
112600     05  ST-ABSTIME                      PIC S9(16)  VALUE +0     11260099
112700                                                     COMP SYNC.   11270099
112800     05  ST-SYSTEM-TIME.                                          11280099
112900         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 11290099
113000         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 11300099
113100             15  ST-SYSTEM-HOUR          PIC  X(02).              11310099
113200             15  FILLER                  PIC  X(01).              11320099
113300             15  ST-SYSTEM-MINUTE        PIC  X(02).              11330099
113400             15  FILLER                  PIC  X(01).              11340099
113500             15  ST-SYSTEM-SECOND        PIC  X(02).              11350099
113600     05  SD-SYSTEM-DATE.                                          11360099
113700         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 11370099
113800         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 11380099
113900             15  SD-SYSTEM-MONTH         PIC  X(02).              11390099
114000             15  FILLER                  PIC  X(01).              11400099
114100             15  SD-SYSTEM-DAY           PIC  X(02).              11410099
114200             15  FILLER                  PIC  X(01).              11420099
114300             15  SD-SYSTEM-YEAR          PIC  X(02).              11430099
114400         10  FILLER                      PIC  X(02)  VALUE SPACE. 11440099
114500     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       11450099
114600         10  FILLER                      PIC  X(06).              11460099
114700         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              11470099
114800     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     11480099
114900                                                     COMP.        11490099
115000                                                                  11500099
115100 01  PS-PROGRAM-SWITCHES.                                         11510099
115200     05  PS-COMMAREA-SW                  PIC  X(01)  VALUE 'N'.   11520099
115300         88  PS-COMMAREA-VALID                       VALUE 'Y'.   11530099
115400         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   11540099
115500     05  PS-ERROR-PRINT-SW               PIC  X(01)  VALUE 'N'.   11550099
115600         88  PS-ERROR-PRINT                          VALUE 'Y'.   11560099
115700     05  PS-CONTENTION-SW                PIC  X(01)  VALUE 'N'.   11570099
115800         88  PS-CONTENTION                           VALUE 'Y'.   11580099
115900     05  PS-DRS-SW                       PIC  X(01)  VALUE 'N'.   11590099
116000         88  PS-DRS                                  VALUE 'Y'.   11600099
116100     05  PS-FIRST-CSR1-ROW-SW            PIC  X(01)  VALUE 'Y'.   11610099
116200         88  PS-FIRST-CSR1-ROW                       VALUE 'Y'.   11620099
116300         88  PS-NOT-FIRST-CSR1-ROW                   VALUE 'N'.   11630099
116400     05  PS-FIRST-CSR2-ROW-SW            PIC  X(01)  VALUE 'Y'.   11640099
116500         88  PS-FIRST-CSR2-ROW                       VALUE 'Y'.   11650099
116600         88  PS-NOT-FIRST-CSR2-ROW                   VALUE 'N'.   11660099
116700     05  PS-TRBL-CURSOR-SW               PIC  X(01)  VALUE 'N'.   11670099
116800         88  PS-EOF-TRBL-CSR                         VALUE 'Y'.   11680099
116900     05  PS-LINE-CURSOR-SW               PIC  X(01)  VALUE 'N'.   11690099
117000         88  PS-EOF-LINE-CSR                         VALUE 'Y'.   11700099
117100     05  PS-TPKSLIP-CURSOR1-SW           PIC  X(01)  VALUE 'N'.   11710099
117200         88  PS-EOF-TPKSLIP-CSR1                     VALUE 'Y'.   11720099
117300     05  PS-TPKSLIP-CURSOR2-SW           PIC  X(01)  VALUE 'N'.   11730099
117400         88  PS-EOF-TPKSLIP-CSR2                     VALUE 'Y'.   11740099
117500         88  PS-NOT-EOF-TPKSLIP-CSR2                 VALUE 'N'.   11750099
117600     05  PS-TRECITM-CURSOR-SW            PIC  X(01)  VALUE 'N'.   11760099
117700         88  PS-EOF-TRECITM-CSR                      VALUE 'Y'.   11770099
117800     05  PS-COST-CURSOR-SW               PIC  X(01)  VALUE 'N'.   11780099
117900         88  PS-NOT-EOF-PKITEM-CSR                   VALUE 'N'.   11790099
118000         88  PS-EOF-PKITEM-CSR                       VALUE 'Y'.   11800099
118100                                                                  11810099
118200                                                                  11820099
118300 01  PRV-PROGRAM-RETURN-VARIABLES.                                11830099
118400     05  PRV-00                       PIC X(42) VALUE             11840099
118500         '00PROGRAM CALL WAS SUCCESSFUL            '.             11850099
118600                                                                  11860099
118700     05  PRV-2A                       PIC X(42) VALUE             11870099
118800         '2A-ERROR - LINK PCKCS010.                '.             11880099
118900     05  PRV-2B                       PIC X(42) VALUE             11890099
119000         '2A-ERROR - LINK PCKCS014.                '.             11900099
119100     05  PRV-3A                       PIC X(42) VALUE             11910099
119200         '3A-ERROR - RETRIEVE COMMAREA DATA.       '.             11920099
119300     05  PRV-3B                       PIC X(42) VALUE             11930099
119400         '3B-ERROR - DELETE TS QUEUE.              '.             11940099
119500     05  PRV-4A                       PIC X(42) VALUE             11950099
119600         '4A-ERROR - INACTIVE PACK SLIPS.          '.             11960099
119700     05  PRV-5A                       PIC X(42) VALUE             11970099
119800         '5A-ERROR - DRS ERROR.                    '.             11980099
119900     05  PRV-6A                       PIC X(42) VALUE             11990099
120000         '6A-ERROR - INVALID ACCESS.               '.             12000099
120100     05  PRV-7A                       PIC X(42) VALUE             12010099
120200         '7A-ERROR - SELECT XLV_SKU.               '.             12020099
120300                                                                  12030099
120400     05  PRV-10A                      PIC X(42) VALUE             12040099
120500         '10ADB2-ERROR - SELECT ON TRECEIV         '.             12050099
120600     05  PRV-11A                      PIC X(42) VALUE             12060099
120700         '11ADB2-ERROR - UPDATE TMST ON TRECEIV.   '.             12070099
120800     05  PRV-12A                       PIC X(42) VALUE            12080099
120900         '12ADB2-ERROR - SELECT PO/RECEIVER DATA   '.             12090099
121000     05  PRV-13A                       PIC X(42) VALUE            12100099
121100         '13ADB2-ERROR - COUNT SHIPMENTS           '.             12110099
121200     05  PRV-13B                       PIC X(42) VALUE            12120099
121300         '13BDB2-ERROR - SHIPMENT NOT FOUND        '.             12130099
121400     05  PRV-13C                       PIC X(42) VALUE            12140099
121500         '13CDB2-ERROR - SELECT PRIMARY SHIPMENT   '.             12150099
121600     05  PRV-14A                       PIC X(42) VALUE            12160099
121700         '14ADB2-ERROR - SELECT PURCHASE ITEM DATA '.             12170099
121800     05  PRV-15A                       PIC X(42) VALUE            12180099
121900         '15ADB2-ERROR - SELECT PKSLIP SEQUENCE    '.             12190099
122000                                                                  12200099
122100     05  PRV-18A                       PIC X(42) VALUE            12210099
122200         '18ADB2-ERROR - TRBL-CSR OPEN             '.             12220099
122300     05  PRV-18B                       PIC X(42) VALUE            12230099
122400         '18BDB2-ERROR - TRBL-CSR FETCH            '.             12240099
122500     05  PRV-18C                       PIC X(42) VALUE            12250099
122600         '18CDB2-ERROR - TRBL-CSR CLOSE            '.             12260099
122700     05  PRV-18D                        PIC X(42) VALUE           12270099
122800         '18DDB2-ERROR - COUNT ON TTRBNTF          '.             12280099
122900                                                                  12290099
123000     05  PRV-19A                        PIC X(42) VALUE           12300099
123100         '19ADB2-ERROR - PKSLIP-CSR1 OPEN           '.            12310099
123200     05  PRV-19B                        PIC X(42) VALUE           12320099
123300         '19BDB2-ERROR - PKSLIP-CSR1 FETCH          '.            12330099
123400     05  PRV-19C                        PIC X(42) VALUE           12340099
123500         '19CDB2-ERROR - PKSLIP-CSR1 CLOSE          '.            12350099
123600                                                                  12360099
123700     05  PRV-20A                        PIC X(42) VALUE           12370099
123800         '20ADB2-ERROR - PKITEM-CSR OPEN           '.             12380099
123900     05  PRV-20B                        PIC X(42) VALUE           12390099
124000         '20BDB2-ERROR - PKITEM-CSR FETCH          '.             12400099
124100     05  PRV-20C                        PIC X(42) VALUE           12410099
124200         '20CDB2-ERROR - PKITEM-CSR CLOSE          '.             12420099
124300                                                                  12430099
124400     05  PRV-21A                        PIC X(42) VALUE           12440099
124500         '21ADB2-ERROR - RECITM-CSR OPEN           '.             12450099
124600     05  PRV-21B                        PIC X(42) VALUE           12460099
124700         '21BDB2-ERROR - RECITM-CSR FETCH          '.             12470099
124800     05  PRV-21C                        PIC X(42) VALUE           12480099
124900         '21CDB2-ERROR - RECITM-CSR CLOSE          '.             12490099
125000                                                                  12500099
125100     05  PRV-22A                        PIC X(42) VALUE           12510099
125200         '22ADB2-ERROR - PKSLIP-CSR2 OPEN           '.            12520099
125300     05  PRV-22B                        PIC X(42) VALUE           12530099
125400         '22BDB2-ERROR - PKSLIP-CSR2 FETCH          '.            12540099
125500     05  PRV-22C                        PIC X(42) VALUE           12550099
125600         '22CDB2-ERROR - PKSLIP-CSR2 CLOSE          '.            12560099
125700                                                                  12570099
125800     05  PRV-23A                        PIC X(42) VALUE           12580099
125900         '23ADB2-ERROR - INSTRUCTIONS-CSR OPEN      '.            12590099
126000     05  PRV-23B                        PIC X(42) VALUE           12600099
126100         '23BDB2-ERROR - INSTRUCTIONS-CSR FETCH     '.            12610099
126200     05  PRV-23C                        PIC X(42) VALUE           12620099
126300         '23CDB2-ERROR - INSTRUCTIONS-CSR CLOSE     '.            12630099
126400     05  PRV-23D                        PIC X(42) VALUE           12640099
126500         '23DDB2-ERROR - INSTRUCTIONS-COUNT         '.            12650099
126600                                                                  12660099
126700     05  PRV-24C                       PIC X(42) VALUE            12670099
126800         '24CDB2-ERROR - SELECT TPURITM            '.             12680099
126900     05  PRV-25A                       PIC X(42) VALUE            12690099
127000         '25ADB2-ERROR - SELECT XLV_VND_STYL       '.             12700099
127100/                                                                 12710099
127200******************************************************************12720099
127300*    DECLARE TROUBLE CURSOR THAT GETS ALL 'NEW' OR 'IN PROGRESS'  12730099
127400*    TROUBLE.                                                     12740099
127500******************************************************************12750099
127600     EXEC SQL                                                     12760099
127700          DECLARE TRBL-CSR CURSOR FOR                             12770099
127800              SELECT  B.TRBL_LONG_DESC                            12780099
127900                    , A.PO_LNE_NBR                                12790099
128000                    , A.PREPK_ID                                  12800099
128100                FROM  TTRBNTF A                                   12810099
128200                    , TTRBRSN B                                   12820099
128300               WHERE   A.PO_NBR          =  :DK-ORD-NBR           12830099
128400                 AND   A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR       12840099
128500                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       12850099
128600                 AND   A.FCLTY_ID        =  :DK-FCLTY-ID          12860099
128700                 AND   A.RESOLVED_IND    IN (:PC-N, :PC-I)        12870099
128800                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE        12880099
128900     END-EXEC.                                                    12890099
129000                                                                  12900099
129100******************************************************************12910099
129200*    DECLARE PACK SLIP CURSOR THAT WILL GET THE SEQUENCE NUMBER   12920099
129300*    FOR EACH ACTIVE RECEIVER ON THE PACK SLIP TABLE.             12930099
129400******************************************************************12940099
129500     EXEC SQL                                                     12950099
129600          DECLARE PKSLIP-CSR1 CURSOR FOR                          12960099
129700             SELECT  SEQ_NBR                                      12970099
129800                   , STR_DEST_NBR                                 12980099
129900                   , PKSL_NBR                                     12990099
130000               FROM  TPKSLIP                                      13000099
130100              WHERE  PO_NBR             =  :DK-ORD-NBR            13010099
130200                AND  REC_SEQ_NBR        =  :DK-REC-SEQ-NBR        13020099
130300                AND  OPER_UNT_ID        =  :DK-OPER-UNT-ID        13030099
130400                AND  FCLTY_ID           =  :DK-FCLTY-ID           13040099
130500                AND  VER_STAT_CDE       =  :PC-A                  13050099
130600              ORDER BY STR_DEST_NBR, PKSL_NBR                     13060099
130700     END-EXEC.                                                    13070099
130800                                                                  13080099
130900******************************************************************13090099
131000*    DECLARE PACK SLIP CURSOR THAT WILL PACK SLIP DATA FOR ALL    13100099
131100*    ROWS FOR A SEQUENCE NUMBER.                                  13110099
131200******************************************************************13120099
131300     EXEC SQL                                                     13130099
131400          DECLARE PKSLIP-CSR2 CURSOR FOR                          13140099
131500             SELECT  CRE_TMST                                     13150099
131600                   , PKSL_NBR                                     13160099
131700                   , VER_STAT_CDE                                 13170099
131800                   , PKSL_STAT_CDE                                13180099
131900                   , STR_DEST_NBR                                 13190099
132000                   , EXPTED_PKG_QTY                               13200099
132100                   , CRE_UID                                      13210099
132200                   , PKSL_PG_CNT                                  13220099
132300                   , SEQ_NBR                                      13230099
132400               FROM  TPKSLIP                                      13240099
132500              WHERE  PO_NBR             =  :DK-ORD-NBR            13250099
132600                AND  SEQ_NBR            =  :PKSLIP-SEQ-NBR        13260099
132700              ORDER BY CRE_TMST DESC                              13270099
132800     END-EXEC.                                                    13280099
132900                                                                  13290099
133000******************************************************************13300099
133100*    DECLARE PKITEM CURSOR THAT WILL GET THE QUANTITY PER LINE    13310099
133200*    FOR EACH STORE ON THE PURCHASE ORDER.  THIS DATA IS THEN     13320099
133300*    USED TO READ THE TABLE OF COST AND RETAIL PER LINE.          13330099
133400******************************************************************13340099
133500     EXEC SQL                                                     13350099
133600          DECLARE PKITEM-CSR CURSOR FOR                           13360099
133700             SELECT  PKSL_LNE_NBR                                 13370099
133800                   , PKSL_ITM_QTY                                 13380099
133900               FROM  TPKITEM                                      13390099
134000              WHERE  PO_NBR          =  :DK-ORD-NBR               13400099
134100                AND  SEQ_NBR         =  :PKSLIP-SEQ-NBR           13410099
134200                AND  VER_STAT_CDE    =  :PC-A                     13420099
134300     END-EXEC.                                                    13430099
134400                                                                  13440099
134500******************************************************************13450099
134600*    DECLARE RECITM CURSOR THAT WILL GET ALL LINES RECEIVED FOR   13460099
134700*    THE PURCHASE ORDER AND THE PURCHASE ORDER VERSION NUMBER     13470099
134800*    TO BE USED WHEN RETRIEVING THE COST AND RETAIL FROM TPURCHS. 13480099
134900******************************************************************13490099
135000     EXEC SQL                                                     13500099
135100          DECLARE RECITM-CSR CURSOR FOR                           13510099
135200             SELECT  ORD_LNE_NBR                                  13520099
135300                   , PO_VER_NBR                                   13530099
135400              FROM   TRECITM                                      13540099
135500              WHERE  ORD_NBR           =  :DK-ORD-NBR             13550099
135600                AND  OPER_UNT_ID       =  :DK-OPER-UNT-ID         13560099
135700                AND  FCLTY_ID          =  :DK-FCLTY-ID            13570099
135800                AND  REC_SEQ_NBR       =  :DK-REC-SEQ-NBR         13580099
135900                AND  VER_STATUS_CDE    =  :PC-A                   13590099
136000                AND  NOT STATUS_CDE    =  :PC-DE                  13600099
136100     END-EXEC.                                                    13610099
136200                                                                  13620099
136300     EXEC SQL                                                     13630099
136400          DECLARE LINE-CSR CURSOR FOR                             13640099
136500             SELECT  DISTINCT                                     13650099
136600                     A.ORD_LNE_NBR                                13660099
136700              FROM   TRECDIS A                                    13670099
136800                   , XLT_LOC B                                    13680099
136900              WHERE  (A.ORD_NBR           =  :DK-ORD-NBR          13690099
137000                AND   A.REC_SEQ_NBR       =  :DK-REC-SEQ-NBR      13700099
137100                AND   A.OPER_UNT_ID       =  :DK-OPER-UNT-ID      13710099
137200                AND   A.FCLTY_ID          =  :DK-FCLTY-ID         13720099
137400                AND   A.EXPTED_ITM_QTY    >  :PC-ZERO             13740099
137500                AND   A.STR_NBR           =  B.LOC_NBR            13750099
137600                AND   B.LOC_TYP_CDE     IN (:PC-DC, :PC-RV))      13760099
137700     END-EXEC.                                                    13770099
137800                                                                  13780099
137900/                                                                 13790099
138000******************************************************************13800099
138100*  CURSOR FOR INSTRUCTIONS                                        13810099
138200******************************************************************13820099
138300     EXEC SQL                                                     13830099
138400         DECLARE INST-CSR CURSOR FOR                              13840099
138500         SELECT B.INSTR_DESC,                                     13850099
138600                B.INSTR_NBR,                                      13860099
138700                C.RECIP_CDE,                                      13870099
138800                C.RECIP_DESC                                      13880099
138900         FROM   TPOINST A,                                        13890099
139000                TINSTCD B,                                        13900099
139100                TINRCCD C                                         13910099
139200          WHERE A.PO_NBR = :POINST-PO-NBR                         13920099
139300           AND A.RECIP_CDE = :PC-DC                               13930099
139400           AND B.INSTR_NBR = A.INSTR_NBR                          13940099
139500           AND C.RECIP_CDE = A.RECIP_CDE                          13950099
139600          ORDER BY RECIP_CDE, INSTR_NBR                           13960099
139700     END-EXEC.                                                    13970099
139800******************************************************************13980099
139900 LINKAGE SECTION.                                                 13990099
140000******************************************************************14000099
140100 01  DFHCOMMAREA.                                                 14010099
140200     05  FILLER                         OCCURS  1 TO 2537 TIMES   14020099
140300                                        DEPENDING ON EIBCALEN.    14030099
140400         10  FILLER                     PIC X.                    14040099
140500                                                                  14050099
140600/                                                                 14060099
140700******************************************************************14070099
140800 PROCEDURE DIVISION.                                              14080099
140900******************************************************************14090099
141000 0000-PROGRAM-MAINLINE.                                           14100099
141100                                                                  14110099
141200     PERFORM 1000-RETRIEVE-STORED-DATA.                           14120099
141300                                                                  14130099
141400*    SET ABEND LINE-RETURN FLAG TO RETURN TO THE PROGRAM WHICH    14140099
141500*    CALLED THIS ONE IF AN ABEND SHOULD OCCUR                     14150099
141600     SET DP013-LINK-RETURN  TO TRUE.                              14160099
141700                                                                  14170099
141800     IF CA-NOT-FROM-PRINT-PACKAGE                                 14180099
141900         PERFORM 1200-INIT-PRINTER                                14190099
142000     END-IF.                                                      14200099
142100                                                                  14210099
142200     IF CA-PRINT-MRKG-APRON-HDR                                   14220099
142300        PERFORM 1400-INITIALIZE                                   14230099
142400        PERFORM 2000-MAIN-PROCESS.                                14240099
142500                                                                  14250099
142600     IF CA-PRINT-PACK-APRON                                       14260099
142700         PERFORM 7700-LINK-PCKCS708                               14270099
142800     END-IF.                                                      14280099
142900     IF CA-PRINT-MRKG-APRON                                       14290099
143000         PERFORM 7800-START-TRANID-E010                           14300099
143100     END-IF.                                                      14310099
143200     IF CA-PRINT-MRKG-APRON-HDR                                   14320099
143300         IF PV-COUNT > 0                                          14330099
143400             PERFORM 7900-START-TRANID-E014                       14340099
143500         END-IF                                                   14350099
143600     END-IF.                                                      14360099
143700                                                                  14370099
143800     PERFORM 1300-TERM-PRINTER.                                   14380099
143900                                                                  14390099
144000     PERFORM 9300-DELETE-TS-QUEUE.                                14400099
144100                                                                  14410099
144200     GOBACK.                                                      14420099
144300                                                                  14430099
144400/                                                                 14440099
144500 1000-RETRIEVE-STORED-DATA.                                       14450099
144600                                                                  14460099
144700     EXEC CICS                                                    14470099
144800         RETRIEVE                                                 14480099
144900             INTO  (CA-PCKCS013-COMMAREA)                         14490099
145000             RESP  (PV-CICS-RESPONSE)                             14500099
145100     END-EXEC.                                                    14510099
145200                                                                  14520099
145300     EVALUATE TRUE                                                14530099
145400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14540099
145500             CONTINUE                                             14550099
145600         WHEN PV-CICS-RESPONSE = DFHRESP (ENDDATA)                14560099
145700             PERFORM 1100-MOVE-COMMAREA                           14570099
145800         WHEN OTHER                                               14580099
145900             SET PS-ERROR-PRINT    TO TRUE                        14590099
146000             STRING PC-RETRIEVE-MSG PC-ASTERISKS                  14600099
146100                DELIMITED BY SIZE                                 14610099
146200                INTO PV-ERROR-MSG                                 14620099
146300             MOVE '1000-RETRIEVE-STORED-DATA'                     14630099
146400                                   TO DP013-PARAGRAPH             14640099
146500             MOVE PRV-3A           TO DP013-MESSAGE-TEXT (1)      14650099
146600             PERFORM 9000-RETURN-MSG                              14660099
146700             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      14670099
146800             SET DP013-CICS-ABEND                                 14680099
146900                 DP013-NO-ROLLBACK TO TRUE                        14690099
147000             PERFORM DP013-0000-PROCESS-ABEND                     14700099
147100     END-EVALUATE.                                                14710099
147200                                                                  14720099
147300 1100-MOVE-COMMAREA.                                              14730099
147400     INITIALIZE CA-PCKCS013-COMMAREA.                             14740099
147500     MOVE DFHCOMMAREA           TO CA-PCKCS014-COMMAREA.          14750099
147600*  THIS RESTORES THE DRIB WORK AREAS THAT WERE INITIALIZED        14760099
147700*  IN DSKCS606                                                    14770099
147800     MOVE CA-DRIB-AREA          TO DRS01-COMMAREA.                14780099
147900     MOVE DRS01-COMM-DRIB-HDR   TO DRS02-DRIB-HEADER.             14790099
148000     MOVE DRS01-COMM-DRIB-AT1   TO DRS02-DRIB-ATTRIB.             14800099
148100                                                                  14810099
148200/                                                                 14820099
148300******************************************************************14830099
148400* THE HEADER AND DETAIL REPORTS WILL BE PRINTED AS ONE REPORT     14840099
148500* NO MATTER WHICH ONE WAS REQUESTED.  OPENING AND CLOSING THE     14850099
148600* PRINTER IS DONE HERE AND NOT AT ALL IN PCKCS010.                14860099
148700******************************************************************14870099
148800 1200-INIT-PRINTER.                                               14880099
148900                                                                  14890099
149000     IF CA-PRINTER-DESTINATION = 'XXXXXXXX'                       14900099
149100         MOVE 'R'     TO DRS02-DRIB-CLASS                         14910099
149200         MOVE 'N'     TO DRS02-DRIB-HOLD                          14920099
149300         MOVE 'LOCAL' TO DRS02-DRIB-DEST                          14930099
149400     ELSE                                                         14940099
149500         MOVE 'A'            TO DRS02-DRIB-CLASS                  14950099
149600         MOVE 'N'            TO DRS02-DRIB-HOLD                   14960099
149700         MOVE CA-PRINTER-DESTINATION                              14970099
149800                             TO DRS02-DRIB-DEST                   14980099
149900     END-IF.                                                      14990099
150000                                                                  15000099
150100*    IF THIS PROGRAM WAS CALLED FROM THE PRINT PACKAGE, THE INIT  15010099
150200*    IS TAKEN CARE OF THERE.                                      15020099
150300     IF CA-NOT-FROM-PRINT-PACKAGE                                 15030099
150400         MOVE PC-INIT           TO DRS01-DRRB-FUNC                15040099
150500         MOVE DRS02-DRIB-HEADER TO DRS01-COMM-DRIB-HDR            15050099
150600         MOVE DRS02-DRIB-ATTRIB TO DRS01-COMM-DRIB-AT1            15060099
150700     END-IF.                                                      15070099
150800                                                                  15080099
150900     PERFORM 8000-LINK-TO-DRS.                                    15090099
151000                                                                  15100099
151100     MOVE PC-PUT            TO  DRS01-DRRB-FUNC.                  15110099
151200                                                                  15120099
151300     IF  CA-PRTR-PRTR-CNTL-IND = 'P'                              15130099
151400         PERFORM 1250-LOAD-FORM-TO-DRS                            15140099
151500     END-IF.                                                      15150099
151600                                                                  15160099
151700     SET PS-DRS-INITIALIZED TO TRUE.                              15170099
151800                                                                  15180099
151900                                                                  15190099
152000***************************************************************   15200099
152100**  1250-LOAD-FORM-TO-DRS. -- CALL THE PRINT-PACKAGE PRINTER **   15210099
152200**  CONTROL MODULE TO GET THE FORM FOR SEND TO THE PRINTER.  **   15220099
152300**  THIS PARAGRAPH IS EXECUTED ONLY IF THE PRINTER ACCEPTS   **   15230099
152400**  PRINTER CONTROL COMMANDS                                 **   15240099
152500***************************************************************   15250099
152600 1250-LOAD-FORM-TO-DRS.                                           15260099
152700     INITIALIZE DP072-COMM-AREA.                                  15270099
152800     MOVE CA-PRINTER-DESTINATION     TO DP072-PRINTER-ID.         15280099
152900     MOVE PC-CURRENT-PROGRAM-NAME    TO DP072-RPT-PGM-NME.        15290099
153000     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     15300099
153100                                                                  15310099
153200     SET DP072-SELECT TO TRUE.                                    15320099
153300     PERFORM 1251-LINK-DPKCS060.                                  15330099
153400     MOVE DP072-PRTR-TRACK-NBR       TO DS004-PLC-LF-FORM-NBR.    15340099
153500     MOVE DS004-PES-8LPI             TO DS004-PLC-LF-LPI          15350099
153600                                        CA-LINES-PER-INCH.        15360099
153700                                                                  15370099
153800*    SEND THE FORM TO THE PRINTER IF THIS PROGRAM WAS NOT CALLED F15380099
153900*    THE PRINT PACKAGE.                                           15390099
154000     IF CA-NOT-FROM-PRINT-PACKAGE                                 15400099
154100         MOVE PC-PUT                     TO DRS01-DRRB-FUNC       15410099
154200         MOVE DS004-PLC-LOAD-FORM        TO DRS01-COMM-DATA       15420099
154300         MOVE SPACE                      TO DRS01-COMM-CTL        15430099
154400         PERFORM 8000-LINK-TO-DRS                                 15440099
154500     END-IF.                                                      15450099
154600                                                                  15460099
154700 1251-LINK-DPKCS060.                                              15470099
154800***************************************************************   15480099
154900**  1251-LINK-DPKCS060 -- LINK TO THE PRINT-PACKACGE PRINTER **   15490099
155000**  CONTROL MODULE (DPKCS060)                                **   15500099
155100***************************************************************   15510099
155200     EXEC CICS                                                    15520099
155300         LINK PROGRAM  (PC-DPKCS060)                              15530099
155400              COMMAREA (DP072-COMM-AREA)                          15540099
155500              RESP     (PV-CICS-RESPONSE)                         15550099
155600     END-EXEC.                                                    15560099
155700                                                                  15570099
155800     EVALUATE TRUE                                                15580099
155900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15590099
156000             CONTINUE                                             15600099
156100         WHEN OTHER                                               15610099
156200               MOVE '1251-LINK-DPKCS060'                          15620099
156300                                    TO DP013-PARAGRAPH            15630099
156400               MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT (1)    15640099
156500               MOVE SQLCA           TO DP013-SQLCA                15650099
156600               SET DP013-CICS-ABEND                               15660099
156700                   DP013-NO-ROLLBACK TO TRUE                      15670099
156800               PERFORM DP013-0000-PROCESS-ABEND                   15680099
156900     END-EVALUATE.                                                15690099
157000                                                                  15700099
157100******************************************************************15710099
157200******************************************************************15720099
157300 1300-TERM-PRINTER.                                               15730099
157400                                                                  15740099
157500*    IF THE PRINTER IS FROM THE PRINT PACKAGE, ALL CUTTING AND    15750099
157600*    DRS TERMINATION WILL TAKE PLACE THERE.                       15760099
157700     IF CA-NOT-FROM-PRINT-PACKAGE                                 15770099
157800*        CUT PAPER IF THE PRINTER HAS THE ABILITY                 15780099
157900         IF CA-PRTR-AUTO-CUTTER-IND = 'Y'                         15790099
158000             MOVE PC-PUT             TO DRS01-DRRB-FUNC           15800099
158100             MOVE DS004-PLC-CUT-FORM TO DRS01-COMM-DATA           15810099
158200             MOVE PC-TOP-OF-PAGE     TO DRS01-COMM-CTL            15820099
158300             PERFORM 8000-LINK-TO-DRS                             15830099
158400         END-IF                                                   15840099
158500                                                                  15850099
158600*    TERMINATE DRS -- SENDING THE REPORT TO THE PRINTER           15860099
158700         MOVE PC-TERM TO DRS01-DRRB-FUNC                          15870099
158800         PERFORM 8000-LINK-TO-DRS                                 15880099
158900     END-IF.                                                      15890099
159000                                                                  15900099
159100/                                                                 15910099
159200******************************************************************15920099
159300******************************************************************15930099
159400 1400-INITIALIZE.                                                 15940099
159500                                                                  15950099
159600     INITIALIZE DCLTTRBNTF                                        15960099
159700                DCLTTRBRSN                                        15970099
159800                DCLTRECEIV                                        15980099
159900                DCLTPURCHS                                        15990099
160000                DCLTENTNME                                        16000099
160100                DCLTSHPTPO                                        16010099
160200                DCLTSHIPMT                                        16020099
160300                DCLTVHTRIP                                        16030099
160400                DCLTPKSLIP                                        16040099
160500                DCLTPKITEM                                        16050099
160600                DCLTRECITM                                        16060099
160700                DCLTPURITM.                                       16070099
160800                                                                  16080099
160900     MOVE PC-PKSLIPS-PER-PAGE   TO  PV-PKSLIPS-PER-PAGE.          16090099
161000     MOVE CA-ORD-NBR            TO  DK-ORD-NBR.                   16100099
161100     MOVE CA-RCVR-SEQ-NBR       TO  DK-REC-SEQ-NBR.               16110099
161200                                                                  16120099
161300     MOVE CA-OPERATING-ID       TO  DK-OPER-UNT-ID.               16130099
161400     MOVE CA-FACILITY-ID        TO  DK-FCLTY-ID.                  16140099
161500                                                                  16150099
161600     PERFORM 8100-FORMAT-TIME.                                    16160099
161700                                                                  16170099
161800     INITIALIZE PS-PKSLIP-TABLE                                   16180099
161900        REPLACING NUMERIC DATA BY ZEROES.                         16190099
162000                                                                  16200099
162100     INITIALIZE PS-PKSLIP-TABLE                                   16210099
162200        REPLACING ALPHANUMERIC DATA BY SPACES.                    16220099
162300                                                                  16230099
162400     SET PS-PKSLIP-IDX TO 1.                                      16240099
162500                                                                  16250099
162600     INITIALIZE TL2-TROUBLE-LINE.                                 16260099
162700     SET TRBL-IDX  TO 1.                                          16270099
162800                                                                  16280099
162900                                                                  16290099
163000******************************************************************16300099
163100*** THIS PARAGRAPH RETRIEVES ALL DATA FOR THE HEADER, UPDATES     16310099
163200*** THE MARKING APRON TIMESTAMP, AND PRINTS THE HEADER AND THE    16320099
163300*** TRAILER STAMP.  IF ERRORS OCCURRED, THE HEADER IS PRINTED     16330099
163400*** WITH AN ERROR MESSAGE AND THE INFORMATION IS WRITTEN TO THE   16340099
163500*** CICS LOG.                                                     16350099
163600***                                                               16360099
163700*** ONCE AN ERROR IS ENCOUNTERED, THE DATA FOR THE TOP PORTION    16370099
163800*** OF THE HEADER IS RETRIEVED BUT THE PACK SLIP DETAIL IS        16380099
163900*** BYPASSED.  ERROR MESSAGES ARE WRITTEN ON THE REPORT AND TO    16390099
164000*** THE CICS LOG.                                                 16400099
164100***                                                               16410099
164200*** THERE A FEW CONDITIONS WHERE THE TIMESTAMP WILL NOT BE        16420099
164300*** UPDATED.                                                      16430099
164400*** 1) THERE WAS AN ERROR WHEN RETRIEVING DATA IN THE OPEN, FETCH,16440099
164500***    CLOSE, OR SELECT.  IT IS ALSO CONSIDERED AN ERROR IF ANY OR16450099
164600***    ALL OF THE PACK SLIPS ARE NOT TRANSCRIBED.                 16460099
164700*** 2) THE HEADER WAS PREVIOUSLY PRINTED.                         16470099
164800*** 3) PO-LEVEL TROUBLE EXISTS.                                   16480099
164900******************************************************************16490099
165000 2000-MAIN-PROCESS.                                               16500099
165100                                                                  16510099
165200     IF PS-ERROR-PRINT                                            16520099
165300        CONTINUE                                                  16530099
165400     ELSE                                                         16540099
165500        PERFORM 2800-SELECT-RCVR-DATA.                            16550099
165600                                                                  16560099
165700     IF PS-ERROR-PRINT                                            16570099
165800        CONTINUE                                                  16580099
165900     ELSE                                                         16590099
166000        PERFORM 3200-PROCESS-TRBL.                                16600099
166100                                                                  16610099
166200     IF PS-ERROR-PRINT                                            16620099
166300        CONTINUE                                                  16630099
166400     ELSE                                                         16640099
166500        PERFORM 3600-SELECT-DEPT-VENDOR.                          16650099
166600                                                                  16660099
166700     IF PS-ERROR-PRINT                                            16670099
166800        CONTINUE                                                  16680099
166900     ELSE                                                         16690099
167000        PERFORM 4000-PROCESS-SHIP-DATA.                           16700099
167100                                                                  16710099
167200     IF PS-ERROR-PRINT                                            16720099
167300        CONTINUE                                                  16730099
167400     ELSE                                                         16740099
167500        PERFORM 4400-BUILD-COST-RTL-TBL.                          16750099
167600                                                                  16760099
167700     IF PS-ERROR-PRINT                                            16770099
167800        CONTINUE                                                  16780099
167900     ELSE                                                         16790099
168000        PERFORM 4700-BUILD-PKSLIP-DTL.                            16800099
168100                                                                  16810099
168200     IF PS-ERROR-PRINT                                            16820099
168300        CONTINUE                                                  16830099
168400     ELSE                                                         16840099
168500        IF RECEIV-MKNG-APRN-PRT-TMST = PC-DB2-DUMMY-DATE-TIME     16850099
168600           PERFORM 7000-UPDATE-TRECEIV-TMST                       16860099
168700           PERFORM 7400-SYNCPOINT.                                16870099
168800                                                                  16880099
168900     PERFORM 6100-COUNT-RTV-DISTROS.                              16890099
169000     IF (PV-COUNT > 0 AND PV-COUNT < 16) OR                       16900099
169100         PV-COUNT > 60                                            16910099
169200         SUBTRACT 4 FROM PV-PKSLIPS-PER-PAGE                      16920099
169300     ELSE                                                         16930099
169400         IF (PV-COUNT > 15 AND PV-COUNT < 31)                     16940099
169500             SUBTRACT 5 FROM PV-PKSLIPS-PER-PAGE                  16950099
169600         ELSE                                                     16960099
169700             IF (PV-COUNT > 30 AND PV-COUNT < 46)                 16970099
169800                 SUBTRACT 6 FROM PV-PKSLIPS-PER-PAGE              16980099
169900             ELSE                                                 16990099
170000                 IF (PV-COUNT > 45 AND PV-COUNT < 61)             17000099
170100                     SUBTRACT 7 FROM PV-PKSLIPS-PER-PAGE          17010099
170200                 END-IF                                           17020099
170300             END-IF                                               17030099
170400         END-IF                                                   17040099
170500     END-IF.                                                      17050099
170600                                                                  17060099
170700*    COMPUTE PV-PKSLIP-PAGES-REQ =                                17070099
170800*       (((PV-STR-CNT - 1) / (PV-PKSLIPS-PER-PAGE)) + 1).         17080099
170900     MOVE PV-STR-CNT TO PV-WORK-QTY-3                             17090099
171000     PERFORM 2100-TOTAL-PAGES-REQUIRED                            17100099
171100                                                                  17110099
171200     PERFORM 6000-CREATE-HDR                                      17120099
171300        VARYING PS-PAGE-SUB                                       17130099
171400        FROM 1 BY 1                                               17140099
171500*       UNTIL PS-PAGE-SUB > PV-PKSLIP-PAGES-REQ.                  17150099
171600        UNTIL PS-PAGE-SUB > PV-TOTAL-PAGES-REQ.                   17160099
171700                                                                  17170099
171800/                                                                 17180099
171900 2100-TOTAL-PAGES-REQUIRED.                                       17190099
172000     MOVE CA-ORD-NBR TO POINST-PO-NBR                             17200099
172100                                                                  17210099
172200     MOVE ZERO TO PV-INSTR-COUNT.                                 17220099
172300     EXEC SQL                                                     17230099
172400          SELECT  COUNT(*)                                        17240099
172500            INTO  :PV-INSTR-COUNT                                 17250099
172600            FROM  TPOINST                                         17260099
172700          WHERE PO_NBR = :POINST-PO-NBR                           17270099
172800            AND RECIP_CDE = :PC-DC                                17280099
172900     END-EXEC.                                                    17290099
173000     EVALUATE TRUE                                                17300099
173100         WHEN SQLCODE = +0                                        17310099
173200             CONTINUE                                             17320099
173300         WHEN SQLWARN NOT = SPACE                                 17330099
173400         WHEN SQLCODE NOT = +0                                    17340099
173500             SET PS-ERROR-PRINT    TO TRUE                        17350099
173600             STRING PC-INSTRUCTION-ERROR-MSG PC-ASTERISKS         17360099
173700                DELIMITED BY SIZE                                 17370099
173800                INTO PV-ERROR-MSG                                 17380099
173900             MOVE '2100-TOTAL-PAGES-REQUIRED'                     17390099
174000                                   TO DP013-PARAGRAPH             17400099
174100             MOVE PRV-23D          TO DP013-MESSAGE-TEXT (1)      17410099
174200             PERFORM 9000-RETURN-MSG                              17420099
174300             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      17430099
174400             MOVE SQLCA            TO DP013-SQLCA                 17440099
174500             MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)    17450099
174600             SET DP013-DB2-ABEND                                  17460099
174700                 DP013-NO-ROLLBACK TO TRUE                        17470099
174800             PERFORM DP013-0000-PROCESS-ABEND                     17480099
174900     END-EVALUATE.                                                17490099
175000     IF PV-INSTR-COUNT > ZERO                                     17500099
175100         SET PS-PRINT-INSTRUCTIONS TO TRUE                        17510099
175200* * *  EACH INSTRUCTION TAKES 3 PRINT LINES,                      17520099
175300* * *  AND ADD 5 MORE FOR HEADER, TRAILER, AND TRIPLE SPACE LINES 17530099
175400         COMPUTE PV-INSTR-COUNT = (PV-INSTR-COUNT * 3) + 5        17540099
175500         DIVIDE PV-INSTR-COUNT BY PC-INSTR-PER-PAGE               17550099
175600                           GIVING PV-TOTAL-PAGES-REQ              17560099
175700                        REMAINDER PV-REMAINDER                    17570099
175800         IF PV-REMAINDER > ZERO                                   17580099
175900             ADD +1            TO PV-TOTAL-PAGES-REQ              17590099
176000             PERFORM 2110-PARTIAL-PAGE                            17600099
176100         ELSE                                                     17610099
176200             SET PS-START-NEXT-PAGE TO TRUE                       17620099
176300             PERFORM 2120-PKSLIP-PAGES                            17630099
176400         END-IF                                                   17640099
176500     ELSE                                                         17650099
176600         PERFORM 2120-PKSLIP-PAGES                                17660099
176700     END-IF.                                                      17670099
176800     ADD PV-PKSLIP-PAGES-REQ TO PV-TOTAL-PAGES-REQ.               17680099
176900                                                                  17690099
177000 2110-PARTIAL-PAGE.                                               17700099
177100* * * CAN WE GET THE DETAIL HEADER LINE AND 1 LINE OF             17710099
177200* * * PACK SLIP DETAIL ON THE CURRENT PAGE?                       17720099
177300* * * IF SO, DETERMINE HOW MANY                                   17730099
177400* * * PACK SLIP DETAIL LINES TO FINISH THE CURRENT PAGE AND       17740099
177500* * * SUBTRACT THOSE FROM THE TOTAL PACK SLIP DETAIL LINES.       17750099
177600     MULTIPLY PV-PKSLIPS-PER-PAGE BY 2 GIVING PV-WORK-QTY-2       17760099
177700     IF (PV-REMAINDER + 5) > PV-WORK-QTY-2                        17770099
177800         SET PS-START-NEXT-PAGE TO TRUE                           17780099
177900         PERFORM 2120-PKSLIP-PAGES                                17790099
178000     ELSE                                                         17800099
178100         MOVE PV-REMAINDER TO PV-WORK-QTY                         17810099
178200         DIVIDE PV-WORK-QTY BY 2 GIVING PV-WORK-QTY-2             17820099
178300                   REMAINDER PV-REMAINDER                         17830099
178400         IF PV-REMAINDER > 0                                      17840099
178500             ADD +1       TO PV-WORK-QTY-2                        17850099
178600         END-IF                                                   17860099
178700         SUBTRACT PV-WORK-QTY-2 FROM PV-PKSLIPS-PER-PAGE          17870099
178800                              GIVING PV-LINE-LEFT                 17880099
178900         IF PV-STR-CNT > PV-LINE-LEFT                             17890099
179000             SUBTRACT PV-LINE-LEFT FROM PV-WORK-QTY-3             17900099
179100             PERFORM 2120-PKSLIP-PAGES                            17910099
179200         END-IF                                                   17920099
179300     END-IF.                                                      17930099
179400                                                                  17940099
179500 2120-PKSLIP-PAGES.                                               17950099
179600     DIVIDE PV-WORK-QTY-3 BY PV-PKSLIPS-PER-PAGE                  17960099
179700                      GIVING PV-PKSLIP-PAGES-REQ                  17970099
179800                   REMAINDER PV-REMAINDER                         17980099
179900     IF PV-REMAINDER > 0                                          17990099
180000         ADD +1           TO PV-PKSLIP-PAGES-REQ.                 18000099
180100                                                                  18010099
180200                                                                  18020099
180300******************************************************************18030099
180400*  THIS MODULE RETRIEVES DATA FROM THE ACTIVE TRECEIV ROW THAT    18040099
180500*  IS PRINTED ON THE TOP PORTION OF THE HEADER.                   18050099
180600******************************************************************18060099
180700 2800-SELECT-RCVR-DATA.                                           18070099
180800                                                                  18080099
180900     EXEC SQL                                                     18090099
181000         SELECT MKNG_APRN_PRT_TMST                                18100099
181100              , EXPTED_CART_CNT                                   18110099
181200              , ACTL_CART_CNT                                     18120099
181300              , REC_TMST                                          18130099
181400              , APRON_LOC_DESC                                    18140099
181500              , AD_INFO_DESC                                      18150099
181600              , PACK_BY_ST_IND                                    18160099
181700              , PRE_TKT_IND                                       18170099
181800              , GOH_IND                                           18180099
181900              , PKGNG_CDE                                         18190099
182000           INTO :RECEIV-MKNG-APRN-PRT-TMST                        18200099
182100              , :RECEIV-EXPTED-CART-CNT                           18210099
182200              , :RECEIV-ACTL-CART-CNT                             18220099
182300              , :RECEIV-REC-TMST                                  18230099
182400              , :RECEIV-APRON-LOC-DESC                            18240099
182500              , :RECEIV-AD-INFO-DESC                              18250099
182600              , :RECEIV-PACK-BY-ST-IND                            18260099
182700              , :RECEIV-PRE-TKT-IND                               18270099
182800              , :RECEIV-GOH-IND                                   18280099
182900              , :RECEIV-PKGNG-CDE                                 18290099
183000           FROM  TRECEIV                                          18300099
183100           WHERE ORD_NBR         = :DK-ORD-NBR                    18310099
183200             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                18320099
183300             AND FCLTY_ID        = :DK-FCLTY-ID                   18330099
183400             AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR                18340099
183500             AND VER_STATUS_CDE  = :PC-A                          18350099
183600             AND NOT STATUS_CDE  = :PC-DE                         18360099
183700     END-EXEC.                                                    18370099
183800                                                                  18380099
183900     EVALUATE TRUE                                                18390099
184000         WHEN SQLCODE = ZERO                                      18400099
184100              CONTINUE                                            18410099
184200         WHEN SQLCODE = -904                                      18420099
184300         WHEN SQLCODE = -911                                      18430099
184400         WHEN SQLCODE = -913                                      18440099
184500              SET PS-CONTENTION     TO TRUE                       18450099
184600              SET PS-ERROR-PRINT    TO TRUE                       18460099
184700              STRING PC-CONTENTION-MSG PC-ASTERISKS               18470099
184800                 DELIMITED BY SIZE                                18480099
184900                 INTO PV-ERROR-MSG                                18490099
185000              MOVE '2800-SELECT-RCVR-DATA'                        18500099
185100                                    TO DP013-PARAGRAPH            18510099
185200              MOVE PRV-10A          TO DP013-MESSAGE-TEXT (1)     18520099
185300              PERFORM 9000-RETURN-MSG                             18530099
185400              MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)     18540099
185500              MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME (1)   18550099
185600              MOVE SQLCA            TO DP013-SQLCA                18560099
185700              SET DP013-DB2-ABEND                                 18570099
185800                  DP013-NO-ROLLBACK TO TRUE                       18580099
185900              PERFORM DP013-0000-PROCESS-ABEND                    18590099
186000         WHEN SQLWARN0 NOT = SPACES                               18600099
186100         WHEN SQLCODE < ZERO                                      18610099
186200         WHEN SQLCODE > ZERO                                      18620099
186300              SET PS-ERROR-PRINT    TO TRUE                       18630099
186400              STRING PC-SELECT-MKNG-TMST-MSG PC-ASTERISKS         18640099
186500                 DELIMITED BY SIZE                                18650099
186600                 INTO PV-ERROR-MSG                                18660099
186700              MOVE '2800-SELECT-RCVR-DATA'                        18670099
186800                                    TO DP013-PARAGRAPH            18680099
186900              MOVE PRV-10A          TO DP013-MESSAGE-TEXT (1)     18690099
187000              PERFORM 9000-RETURN-MSG                             18700099
187100              MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)     18710099
187200              MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME (1)   18720099
187300              MOVE SQLCA            TO DP013-SQLCA                18730099
187400              SET DP013-DB2-ABEND                                 18740099
187500                  DP013-NO-ROLLBACK TO TRUE                       18750099
187600              PERFORM DP013-0000-PROCESS-ABEND                    18760099
187700     END-EVALUATE.                                                18770099
187800                                                                  18780099
187900/                                                                 18790099
188000******************************************************************18800099
188100* THIS MODULE RETRIEVES PURCHASE ORDER LEVEL TROUBLE DESCRIPTIONS.18810099
188200******************************************************************18820099
188300 3200-PROCESS-TRBL.                                               18830099
188400                                                                  18840099
188500     PERFORM 3210-OPEN-TRBL-CSR.                                  18850099
188600                                                                  18860099
188700     IF PS-ERROR-PRINT                                            18870099
188800        CONTINUE                                                  18880099
188900     ELSE                                                         18890099
189000        PERFORM 3300-PROCESS-TRBL-CSR                             18900099
189100           UNTIL PS-EOF-TRBL-CSR OR PS-ERROR-PRINT.               18910099
189200                                                                  18920099
189300     PERFORM 3230-CLOSE-TRBL-CSR.                                 18930099
189400                                                                  18940099
189500                                                                  18950099
189600 3300-PROCESS-TRBL-CSR.                                           18960099
189700                                                                  18970099
189800     PERFORM 3220-FETCH-TRBL-CSR.                                 18980099
189900                                                                  18990099
190000     IF PS-EOF-TRBL-CSR OR PS-ERROR-PRINT                         19000099
190100        CONTINUE                                                  19010099
190200     ELSE                                                         19020099
190300        IF TRBNTF-PO-LNE-NBR = PC-ZERO                            19030099
190400           AND TRBNTF-PREPK-ID = PC-ZERO                          19040099
190500           AND TRBL-IDX < 6                                       19050099
190600             MOVE TRBRSN-TRBL-LONG-DESC                           19060099
190700                              TO TL2-TRBL-DESC (TRBL-IDX)         19070099
190800             SET TRBL-IDX UP BY 1                                 19080099
190900        ELSE                                                      19090099
191000           IF TRBNTF-PO-LNE-NBR > PC-ZERO                         19100099
191100              IF TRBNTF-PO-LNE-NBR = PV-TRBNTF-PO-LNE-NBR         19110099
191200                 CONTINUE                                         19120099
191300              ELSE                                                19130099
191400                 ADD +1 TO PV-LINE-TRBL-CNT                       19140099
191500                 MOVE TRBNTF-PO-LNE-NBR TO PV-TRBNTF-PO-LNE-NBR   19150099
191600              END-IF                                              19160099
191700           END-IF                                                 19170099
191800           IF TRBNTF-PREPK-ID > PC-ZERO                           19180099
191900              IF TRBNTF-PREPK-ID = PV-TRBNTF-PREPK-ID             19190099
192000                 CONTINUE                                         19200099
192100              ELSE                                                19210099
192200                 ADD +1 TO PV-PACK-TRBL-CNT                       19220099
192300                 MOVE TRBNTF-PREPK-ID TO PV-TRBNTF-PREPK-ID       19230099
192400              END-IF                                              19240099
192500           END-IF.                                                19250099
192600                                                                  19260099
192700 3210-OPEN-TRBL-CSR.                                              19270099
192800                                                                  19280099
192900     EXEC SQL                                                     19290099
193000         OPEN TRBL-CSR                                            19300099
193100     END-EXEC.                                                    19310099
193200                                                                  19320099
193300     EVALUATE TRUE                                                19330099
193400         WHEN SQLCODE = ZERO                                      19340099
193500             CONTINUE                                             19350099
193600         WHEN SQLCODE = -904                                      19360099
193700         WHEN SQLCODE = -911                                      19370099
193800         WHEN SQLCODE = -913                                      19380099
193900             IF PS-CONTENTION                                     19390099
194000                CONTINUE                                          19400099
194100             ELSE                                                 19410099
194200                SET PS-ERROR-PRINT   TO TRUE                      19420099
194300                SET PS-CONTENTION    TO TRUE                      19430099
194400                STRING PC-CONTENTION-MSG PC-ASTERISKS             19440099
194500                   DELIMITED BY SIZE                              19450099
194600                   INTO PV-ERROR-MSG                              19460099
194700                MOVE '3210-OPEN-TRBL-CSR'                         19470099
194800                                     TO DP013-PARAGRAPH           19480099
194900                MOVE PRV-18A TO DP013-MESSAGE-TEXT (1)            19490099
195000                PERFORM 9000-RETURN-MSG                           19500099
195100                MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)    19510099
195200                MOVE 'TTRBNTF'       TO DP013-DB2-TABLE-NAME (1)  19520099
195300                MOVE 'TTRBRSN'       TO DP013-DB2-TABLE-NAME (2)  19530099
195400                MOVE SQLCA TO DP013-SQLCA                         19540099
195500                SET DP013-DB2-ABEND                               19550099
195600                    DP013-NO-ROLLBACK TO TRUE                     19560099
195700                PERFORM DP013-0000-PROCESS-ABEND                  19570099
195800              END-IF                                              19580099
195900         WHEN SQLWARN0 NOT = SPACE                                19590099
196000         WHEN SQLCODE < ZERO                                      19600099
196100         WHEN SQLCODE > ZERO                                      19610099
196200               SET PS-ERROR-PRINT   TO TRUE                       19620099
196300               STRING PC-TRBL-CSR-MSG PC-ASTERISKS                19630099
196400                  DELIMITED BY SIZE                               19640099
196500                  INTO PV-ERROR-MSG                               19650099
196600               MOVE '3210-OPEN-TRBL-CSR'                          19660099
196700                                    TO DP013-PARAGRAPH            19670099
196800               MOVE PRV-18A         TO DP013-MESSAGE-TEXT (1)     19680099
196900               PERFORM 9000-RETURN-MSG                            19690099
197000               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     19700099
197100               MOVE SQLCA           TO DP013-SQLCA                19710099
197200               MOVE 'TTRBNTF'       TO DP013-DB2-TABLE-NAME (1)   19720099
197300               MOVE 'TTRBRSN'       TO DP013-DB2-TABLE-NAME (2)   19730099
197400               SET DP013-DB2-ABEND                                19740099
197500                   DP013-NO-ROLLBACK TO TRUE                      19750099
197600               PERFORM DP013-0000-PROCESS-ABEND                   19760099
197700     END-EVALUATE.                                                19770099
197800                                                                  19780099
197900                                                                  19790099
198000 3220-FETCH-TRBL-CSR.                                             19800099
198100                                                                  19810099
198200     EXEC SQL                                                     19820099
198300         FETCH  TRBL-CSR                                          19830099
198400          INTO  :TRBRSN-TRBL-LONG-DESC                            19840099
198500              , :TRBNTF-PO-LNE-NBR                                19850099
198600              , :TRBNTF-PREPK-ID                                  19860099
198700     END-EXEC.                                                    19870099
198800                                                                  19880099
198900     EVALUATE TRUE                                                19890099
199000         WHEN SQLCODE = ZERO                                      19900099
199100             CONTINUE                                             19910099
199200         WHEN SQLCODE = +100                                      19920099
199300             SET PS-EOF-TRBL-CSR TO TRUE                          19930099
199400         WHEN SQLCODE = -904                                      19940099
199500         WHEN SQLCODE = -911                                      19950099
199600         WHEN SQLCODE = -913                                      19960099
199700             IF PS-CONTENTION                                     19970099
199800              CONTINUE                                            19980099
199900             ELSE                                                 19990099
200000               SET PS-ERROR-PRINT  TO TRUE                        20000099
200100               SET PS-CONTENTION   TO TRUE                        20010099
200200               STRING PC-CONTENTION-MSG PC-ASTERISKS              20020099
200300                  DELIMITED BY SIZE                               20030099
200400                  INTO PV-ERROR-MSG                               20040099
200500               MOVE '3220-FETCH-TRBL-CSR'                         20050099
200600                                   TO DP013-PARAGRAPH             20060099
200700               MOVE PRV-18B        TO DP013-MESSAGE-TEXT (1)      20070099
200800               PERFORM 9000-RETURN-MSG                            20080099
200900               MOVE PV-DISPLAY-KEYS                               20090099
201000                                   TO DP013-MESSAGE-TEXT (2)      20100099
201100               MOVE SQLCA          TO DP013-SQLCA                 20110099
201200               MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)    20120099
201300               MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)    20130099
201400               SET DP013-DB2-ABEND                                20140099
201500                   DP013-NO-ROLLBACK TO TRUE                      20150099
201600               PERFORM DP013-0000-PROCESS-ABEND                   20160099
201700             END-IF                                               20170099
201800         WHEN SQLWARN0 NOT = SPACE                                20180099
201900         WHEN SQLCODE < ZERO                                      20190099
202000         WHEN SQLCODE > ZERO                                      20200099
202100               SET PS-ERROR-PRINT    TO TRUE                      20210099
202200               STRING PC-TRBL-CSR-MSG PC-ASTERISKS                20220099
202300                  DELIMITED BY SIZE                               20230099
202400                  INTO PV-ERROR-MSG                               20240099
202500               MOVE '3220-FETCH-TRBL-CSR'                         20250099
202600                                     TO DP013-PARAGRAPH           20260099
202700               MOVE PRV-18B          TO DP013-MESSAGE-TEXT (1)    20270099
202800               PERFORM 9000-RETURN-MSG                            20280099
202900               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    20290099
203000               MOVE SQLCA            TO DP013-SQLCA               20300099
203100               MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)  20310099
203200               MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)  20320099
203300               SET DP013-DB2-ABEND                                20330099
203400                   DP013-NO-ROLLBACK TO TRUE                      20340099
203500               PERFORM DP013-0000-PROCESS-ABEND                   20350099
203600     END-EVALUATE.                                                20360099
203700                                                                  20370099
203800                                                                  20380099
203900 3230-CLOSE-TRBL-CSR.                                             20390099
204000                                                                  20400099
204100     EXEC SQL                                                     20410099
204200         CLOSE TRBL-CSR                                           20420099
204300     END-EXEC.                                                    20430099
204400                                                                  20440099
204500     EVALUATE TRUE                                                20450099
204600         WHEN SQLCODE = ZERO                                      20460099
204700         WHEN SQLCODE = -501                                      20470099
204800             CONTINUE                                             20480099
204900         WHEN SQLCODE = -904                                      20490099
205000         WHEN SQLCODE = -911                                      20500099
205100         WHEN SQLCODE = -913                                      20510099
205200             IF PS-CONTENTION                                     20520099
205300              CONTINUE                                            20530099
205400             ELSE                                                 20540099
205500               SET PS-ERROR-PRINT    TO TRUE                      20550099
205600               SET PS-CONTENTION     TO TRUE                      20560099
205700               STRING PC-CONTENTION-MSG PC-ASTERISKS              20570099
205800                  DELIMITED BY SIZE                               20580099
205900                  INTO PV-ERROR-MSG                               20590099
206000               MOVE '3230-CLOSE-TRBL-CSR'                         20600099
206100                                     TO DP013-PARAGRAPH           20610099
206200               MOVE PRV-18C          TO DP013-MESSAGE-TEXT (1)    20620099
206300               PERFORM 9000-RETURN-MSG                            20630099
206400               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    20640099
206500               MOVE SQLCA            TO DP013-SQLCA               20650099
206600               MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)  20660099
206700               MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)  20670099
206800               SET DP013-DB2-ABEND                                20680099
206900                   DP013-NO-ROLLBACK TO TRUE                      20690099
207000               PERFORM DP013-0000-PROCESS-ABEND                   20700099
207100            END-IF                                                20710099
207200         WHEN SQLWARN0 NOT = SPACE                                20720099
207300         WHEN SQLCODE < ZERO                                      20730099
207400         WHEN SQLCODE > ZERO                                      20740099
207500             SET PS-ERROR-PRINT    TO TRUE                        20750099
207600             STRING PC-TRBL-CSR-MSG PC-ASTERISKS                  20760099
207700                DELIMITED BY SIZE                                 20770099
207800                INTO PV-ERROR-MSG                                 20780099
207900             MOVE '3230-CLOSE-TRBL-CSR'                           20790099
208000                                   TO DP013-PARAGRAPH             20800099
208100             MOVE PRV-18C          TO DP013-MESSAGE-TEXT (1)      20810099
208200             PERFORM 9000-RETURN-MSG                              20820099
208300             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      20830099
208400             MOVE SQLCA            TO DP013-SQLCA                 20840099
208500             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    20850099
208600             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    20860099
208700             SET DP013-DB2-ABEND                                  20870099
208800                 DP013-NO-ROLLBACK TO TRUE                        20880099
208900             PERFORM DP013-0000-PROCESS-ABEND                     20890099
209000     END-EVALUATE.                                                20900099
209100                                                                  20910099
209200/                                                                 20920099
209300******************************************************************20930099
209400*  THIS MODULE RETRIEVES THE DEPARTMENT AND VENDOR NAME.          20940099
209500*                                                                 20950099
209600*  THE PURCHASE ORDER VERSION NUMBER WAS NOT ADDED TO THIS SELECT 20960099
209700*  IN ORDER TO AVOID A THREE-WAY JOIN.  THE DEPARTMENT NUMBER     20970099
209800*  CANNOT BE CHANGED ONLINE FOR A PURCHASE ORDER.                 20980099
209900******************************************************************20990099
210000 3600-SELECT-DEPT-VENDOR.                                         21000099
210100                                                                  21010099
210200     EXEC SQL                                                     21020099
210300         SELECT  A.DEPT_NBR,                                      21030099
210400                 B.ENT_NAME_DESC,                                 21040099
210500                 B.ENT_ID,                                        21050099
210600                 A.SEASET_SHRT_NM                                 21060099
210700           INTO  :PURCHS-DEPT-NBR,                                21070099
210800                 :ENTNME-ENT-NAME-DESC                            21080099
210900                ,:ENTNME-ENT-ID                                   21090099
211000                ,:PURCHS-SEASET-SHRT-NM                           21100099
211100           FROM  TPURCHS A                                        21110099
211200               , TENTNME B                                        21120099
211300          WHERE  A.PO_NBR          = :DK-ORD-NBR                  21130099
211400            AND  A.ENT_ID          =  B.ENT_ID                    21140099
211500            AND  A.VER_STATUS_CDE  = :PC-A                        21150099
211600            AND  B.TYPE_CDE        = :PC-ZERO-ONE                 21160099
211700     END-EXEC.                                                    21170099
211800                                                                  21180099
211900      EVALUATE TRUE                                               21190099
212000             WHEN SQLCODE = +0                                    21200099
212100                  CONTINUE                                        21210099
212200             WHEN SQLCODE = -904                                  21220099
212300             WHEN SQLCODE = -911                                  21230099
212400             WHEN SQLCODE = -913                                  21240099
212500                IF PS-CONTENTION                                  21250099
212600                  CONTINUE                                        21260099
212700                ELSE                                              21270099
212800                  SET PS-ERROR-PRINT TO TRUE                      21280099
212900                  SET PS-CONTENTION  TO TRUE                      21290099
213000                  STRING PC-CONTENTION-MSG PC-ASTERISKS           21300099
213100                     DELIMITED BY SIZE                            21310099
213200                     INTO PV-ERROR-MSG                            21320099
213300                  MOVE '3600-SELECT-DEPT-VENDOR'                  21330099
213400                                     TO DP013-PARAGRAPH           21340099
213500                  MOVE PRV-12A       TO DP013-MESSAGE-TEXT (1)    21350099
213600                  PERFORM 9000-RETURN-MSG                         21360099
213700                  MOVE PV-DISPLAY-KEYS                            21370099
213800                                     TO DP013-MESSAGE-TEXT (2)    21380099
213900                  MOVE SQLCA         TO DP013-SQLCA               21390099
214000                  MOVE 'TPURCHS'     TO DP013-DB2-TABLE-NAME (1)  21400099
214100                  MOVE 'TENTNME'     TO DP013-DB2-TABLE-NAME (2)  21410099
214200                  SET DP013-DB2-ABEND                             21420099
214300                      DP013-NO-ROLLBACK TO TRUE                   21430099
214400                  PERFORM DP013-0000-PROCESS-ABEND                21440099
214500               END-IF                                             21450099
214600             WHEN SQLWARN0 NOT = SPACES                           21460099
214700             WHEN SQLCODE < ZERO                                  21470099
214800             WHEN SQLCODE > ZERO                                  21480099
214900                  SET PS-ERROR-PRINT TO TRUE                      21490099
215000                  STRING PC-SELECT-PO-DATA-MSG PC-ASTERISKS       21500099
215100                     DELIMITED BY SIZE                            21510099
215200                     INTO PV-ERROR-MSG                            21520099
215300                  MOVE '3600-SELECT-DEPT-VENDOR'                  21530099
215400                                     TO DP013-PARAGRAPH           21540099
215500                  MOVE PRV-12A       TO DP013-MESSAGE-TEXT (1)    21550099
215600                  PERFORM 9000-RETURN-MSG                         21560099
215700                  MOVE PV-DISPLAY-KEYS                            21570099
215800                                     TO DP013-MESSAGE-TEXT (2)    21580099
215900                  MOVE SQLCA         TO DP013-SQLCA               21590099
216000                  MOVE 'TPURCHS'     TO DP013-DB2-TABLE-NAME (1)  21600099
216100                  MOVE 'TENTNME'     TO DP013-DB2-TABLE-NAME (2)  21610099
216200                  SET DP013-DB2-ABEND                             21620099
216300                      DP013-NO-ROLLBACK TO TRUE                   21630099
216400                  PERFORM DP013-0000-PROCESS-ABEND                21640099
216500      END-EVALUATE.                                               21650099
216600                                                                  21660099
216700/                                                                 21670099
216800******************************************************************21680099
216900*  THIS MODULE COUNTS THE SHIPMENTS AND SELECTS DATA FROM THE     21690099
217000*  PRIMARY SHIPMENT.  THE SHIPMENT COUNT IS USED TO DETERMINE     21700099
217100*  IF THERE ARE MULTIPLES.                                        21710099
217200******************************************************************21720099
217300 4000-PROCESS-SHIP-DATA.                                          21730099
217400                                                                  21740099
217500     PERFORM 4010-COUNT-SHIPMENTS.                                21750099
217600                                                                  21760099
217700     IF PS-ERROR-PRINT                                            21770099
217800        CONTINUE                                                  21780099
217900     ELSE                                                         21790099
218000        PERFORM 4020-SELECT-PRIM-SHIP.                            21800099
218100                                                                  21810099
218200                                                                  21820099
218300 4010-COUNT-SHIPMENTS.                                            21830099
218400                                                                  21840099
218500     EXEC SQL                                                     21850099
218600        SELECT COUNT(*)                                           21860099
218700           INTO :PV-SHIPMENTS-CNT                                 21870099
218800            FROM TSHPTPO A                                        21880099
218900               , TSHIPMT B                                        21890099
219000               , TVHTRIP C                                        21900099
219100           WHERE A.PO_NBR         = :DK-ORD-NBR                   21910099
219200             AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               21920099
219300             AND A.SHIPT_ID       = B.SHIPT_ID                    21930099
219400             AND B.TRIP_ID        = C.TRIP_ID                     21940099
219500     END-EXEC.                                                    21950099
219600                                                                  21960099
219700     EVALUATE TRUE                                                21970099
219800            WHEN SQLCODE = +0                                     21980099
219900                 CONTINUE                                         21990099
220000            WHEN SQLCODE = -904                                   22000099
220100            WHEN SQLCODE = -911                                   22010099
220200            WHEN SQLCODE = -913                                   22020099
220300               IF PS-CONTENTION                                   22030099
220400                  CONTINUE                                        22040099
220500               ELSE                                               22050099
220600                  SET PS-ERROR-PRINT TO TRUE                      22060099
220700                  SET PS-CONTENTION  TO TRUE                      22070099
220800                  STRING PC-CONTENTION-MSG PC-ASTERISKS           22080099
220900                     DELIMITED BY SIZE                            22090099
221000                     INTO PV-ERROR-MSG                            22100099
221100                  MOVE '4010-COUNT-SHIPMENTS'                     22110099
221200                                     TO DP013-PARAGRAPH           22120099
221300                  MOVE PRV-13A       TO DP013-MESSAGE-TEXT (1)    22130099
221400                  PERFORM 9000-RETURN-MSG                         22140099
221500                  MOVE PV-DISPLAY-KEYS                            22150099
221600                                     TO DP013-MESSAGE-TEXT (2)    22160099
221700                  MOVE SQLCA         TO DP013-SQLCA               22170099
221800                  MOVE 'TSHPTPO'     TO DP013-DB2-TABLE-NAME (1)  22180099
221900                  MOVE 'TSHIPMT'     TO DP013-DB2-TABLE-NAME (2)  22190099
222000                  MOVE 'TVHTRIP'     TO DP013-DB2-TABLE-NAME (3)  22200099
222100                  SET DP013-DB2-ABEND                             22210099
222200                      DP013-NO-ROLLBACK TO TRUE                   22220099
222300                  PERFORM DP013-0000-PROCESS-ABEND                22230099
222400               END-IF                                             22240099
222500            WHEN SQLWARN0 NOT = SPACES                            22250099
222600            WHEN SQLCODE < ZERO                                   22260099
222700            WHEN SQLCODE > ZERO                                   22270099
222800                  SET PS-ERROR-PRINT TO TRUE                      22280099
222900                  STRING PC-CNT-SHIPMENTS-MSG PC-ASTERISKS        22290099
223000                     DELIMITED BY SIZE                            22300099
223100                     INTO PV-ERROR-MSG                            22310099
223200                  MOVE '4010-COUNT-SHIPMENTS'                     22320099
223300                                     TO DP013-PARAGRAPH           22330099
223400                  MOVE PRV-13A       TO DP013-MESSAGE-TEXT (1)    22340099
223500                  PERFORM 9000-RETURN-MSG                         22350099
223600                  MOVE PV-DISPLAY-KEYS                            22360099
223700                                     TO DP013-MESSAGE-TEXT (2)    22370099
223800                  MOVE SQLCA         TO DP013-SQLCA               22380099
223900                  MOVE 'TSHPTPO'     TO DP013-DB2-TABLE-NAME (1)  22390099
224000                  MOVE 'TSHIPMT'     TO DP013-DB2-TABLE-NAME (2)  22400099
224100                  MOVE 'TVHTRIP'     TO DP013-DB2-TABLE-NAME (3)  22410099
224200                  SET DP013-DB2-ABEND                             22420099
224300                      DP013-NO-ROLLBACK TO TRUE                   22430099
224400                  PERFORM DP013-0000-PROCESS-ABEND                22440099
224500     END-EVALUATE.                                                22450099
224600                                                                  22460099
224700     IF PV-SHIPMENTS-CNT = 0                                      22470099
224800         SET PS-ERROR-PRINT    TO TRUE                            22480099
224900         STRING PC-CNT-SHIPMENTS-MSG PC-ASTERISKS                 22490099
225000            DELIMITED BY SIZE                                     22500099
225100            INTO PV-ERROR-MSG                                     22510099
225200         MOVE '4010-COUNT-SHIPMENTS'                              22520099
225300                               TO DP013-PARAGRAPH                 22530099
225400         MOVE PRV-13B          TO DP013-MESSAGE-TEXT (1)          22540099
225500         PERFORM 9000-RETURN-MSG                                  22550099
225600         MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)          22560099
225700         MOVE SQLCA            TO DP013-SQLCA                     22570099
225800         MOVE 'TSHPTPO'        TO DP013-DB2-TABLE-NAME (1)        22580099
225900         MOVE 'TSHIPMT'        TO DP013-DB2-TABLE-NAME (2)        22590099
226000         MOVE 'TVHTRIP'        TO DP013-DB2-TABLE-NAME (3)        22600099
226100         SET DP013-DB2-ABEND                                      22610099
226200             DP013-NO-ROLLBACK TO TRUE                            22620099
226300         PERFORM DP013-0000-PROCESS-ABEND.                        22630099
226400                                                                  22640099
226500                                                                  22650099
226600 4020-SELECT-PRIM-SHIP.                                           22660099
226700                                                                  22670099
226800     EXEC SQL                                                     22680099
226900         SELECT C.VEH_NBR                                         22690099
227000              , B.PRO_SCAC_ID                                     22700099
227100              , B.PRO_NBR                                         22710099
227200              , B.BOL_NBR                                         22720099
227300              , C.TRIP_ID                                         22730099
227400          INTO  :VHTRIP-VEH-NBR :DN-VEH-NBR                       22740099
227500              , :SHIPMT-PRO-SCAC-ID                               22750099
227600              , :SHIPMT-PRO-NBR                                   22760099
227700              , :SHIPMT-BOL-NBR                                   22770099
227800              , :VHTRIP-TRIP-ID                                   22780099
227900           FROM TSHPTPO A                                         22790099
228000              , TSHIPMT B                                         22800099
228100              , TVHTRIP C                                         22810099
228200          WHERE A.PO_NBR         = :DK-ORD-NBR                    22820099
228300            AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                22830099
228400            AND A.SHIPT_ID       = B.SHIPT_ID                     22840099
228500            AND B.TRIP_ID        = C.TRIP_ID                      22850099
228600            AND A.PRIM_SHIPT_IND = :PC-Y                          22860099
228700     END-EXEC.                                                    22870099
228800                                                                  22880099
228900     EVALUATE TRUE                                                22890099
229000         WHEN SQLCODE = ZERO                                      22900099
229100             CONTINUE                                             22910099
229200         WHEN SQLCODE = -904                                      22920099
229300         WHEN SQLCODE = -911                                      22930099
229400         WHEN SQLCODE = -913                                      22940099
229500            IF PS-CONTENTION                                      22950099
229600               CONTINUE                                           22960099
229700            ELSE                                                  22970099
229800               SET PS-ERROR-PRINT  TO TRUE                        22980099
229900               SET PS-CONTENTION   TO TRUE                        22990099
230000               STRING PC-CONTENTION-MSG PC-ASTERISKS              23000099
230100                  DELIMITED BY SIZE                               23010099
230200                  INTO PV-ERROR-MSG                               23020099
230300               MOVE '4020-SELECT-PRIM-SHIP'                       23030099
230400                                   TO DP013-PARAGRAPH             23040099
230500               MOVE PRV-13C        TO DP013-MESSAGE-TEXT (1)      23050099
230600               PERFORM 9000-RETURN-MSG                            23060099
230700               MOVE PV-DISPLAY-KEYS                               23070099
230800                                   TO DP013-MESSAGE-TEXT (2)      23080099
230900               MOVE SQLCA          TO DP013-SQLCA                 23090099
231000               MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (1)    23100099
231100               MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (2)    23110099
231200               MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (3)    23120099
231300               SET DP013-DB2-ABEND                                23130099
231400                   DP013-NO-ROLLBACK TO TRUE                      23140099
231500               PERFORM DP013-0000-PROCESS-ABEND                   23150099
231600            END-IF                                                23160099
231700         WHEN SQLWARN0 NOT = SPACE                                23170099
231800         WHEN SQLCODE < ZERO                                      23180099
231900         WHEN SQLCODE > ZERO                                      23190099
232000               SET PS-ERROR-PRINT   TO TRUE                       23200099
232100               STRING PC-SELECT-PRIM-SHIP-MSG PC-ASTERISKS        23210099
232200                  DELIMITED BY SIZE                               23220099
232300                  INTO PV-ERROR-MSG                               23230099
232400               MOVE '4020-SELECT-PRIM-SHIP'                       23240099
232500                                    TO DP013-PARAGRAPH            23250099
232600               MOVE PRV-13C         TO DP013-MESSAGE-TEXT (1)     23260099
232700               PERFORM 9000-RETURN-MSG                            23270099
232800               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     23280099
232900               MOVE SQLCA           TO DP013-SQLCA                23290099
233000               MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (1)   23300099
233100               MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (2)   23310099
233200               MOVE 'TVHTRIP'       TO DP013-DB2-TABLE-NAME (3)   23320099
233300               SET DP013-DB2-ABEND                                23330099
233400                   DP013-NO-ROLLBACK TO TRUE                      23340099
233500               PERFORM DP013-0000-PROCESS-ABEND                   23350099
233501     END-EVALUATE.                                                23350199
233502                                                                  23350214
233503*----------------------------------------------------------------*23350314
233504*    GET THE EARLIEST AD DATE                                    *23350414
233505*----------------------------------------------------------------*23350514
233506 4140-GET-AD-DATE.                                                23350614
233507                                                                  23350714
233508     EXEC SQL                                                     23350899
233509          SELECT MIN(AD_EVNT_DTE)                                 23350999
233510            INTO :PV-DB2-DATE-HOST:PV-NULL-IND                    23351099
233520            FROM TPURITM                                          23352099
233530           WHERE PO_NBR         = :DK-ORD-NBR                     23353099
233540             AND VER_STATUS_CDE = 'A'                             23354099
233550             AND AD_EVNT_DTE > '0001-01-01'                       23355099
233560             AND STATUS_CDE NOT IN ('CA')                         23356099
233570     END-EXEC                                                     23357099
233580                                                                  23358099
233590     EVALUATE TRUE                                                23359099
233600         WHEN SQLCODE = +100                                      23360099
233700                  MOVE SPACES           TO                        23370099
233800                                         HL7-AD-DATE              23380099
233900                                         HL7-AD-DATE-INFO         23390099
234000                                                                  23400099
234100         WHEN SQLCODE = +0                                        23410099
234200              IF  PV-NULL-IND < +0                                23420099
234300                  MOVE SPACES        TO  HL7-AD-DATE              23430099
234400                                         HL7-AD-DATE-INFO         23440099
234500              ELSE                                                23450099
234600                  MOVE PV-DB2-DATE-HOST TO PV-DB2-DATE            23460099
234700                  MOVE PV-DB2-DATE-MM   TO PV-DISPLAY-DATE-MM     23470099
234800                  MOVE PV-DB2-DATE-DD   TO PV-DISPLAY-DATE-DD     23480099
234900                  MOVE PV-DB2-DATE-YY   TO PV-DISPLAY-DATE-YY     23490099
235000                  MOVE PV-DB2-DATE-CC   TO PV-DISPLAY-DATE-CC     23500099
235100                  MOVE PV-DISPLAY-DATE  TO HL7-AD-DATE            23510099
235200              END-IF                                              23520099
235300                                                                  23530099
235400          WHEN SQLCODE = -904                                     23540099
235500          WHEN SQLCODE = -911                                     23550099
235600          WHEN SQLCODE = -913                                     23560099
235700             IF PS-CONTENTION                                     23570099
235800                CONTINUE                                          23580099
235900             ELSE                                                 23590099
236000                SET PS-ERROR-PRINT  TO TRUE                       23600099
236100                SET PS-CONTENTION   TO TRUE                       23610099
236200                STRING PC-CONTENTION-MSG PC-ASTERISKS             23620099
236300                   DELIMITED BY SIZE                              23630099
236400                   INTO PV-ERROR-MSG                              23640099
236500                MOVE '4140-GET-AD-DATE'                           23650099
236600                                    TO DP013-PARAGRAPH            23660099
236700                MOVE PRV-24C        TO DP013-MESSAGE-TEXT (1)     23670099
236800                PERFORM 9000-RETURN-MSG                           23680099
236900                MOVE PV-DISPLAY-KEYS                              23690099
237000                                    TO DP013-MESSAGE-TEXT (2)     23700099
237100                MOVE SQLCA          TO DP013-SQLCA                23710099
237200                MOVE 'TPURITM'      TO DP013-DB2-TABLE-NAME (1)   23720099
237300                SET DP013-DB2-ABEND                               23730099
237400                    DP013-NO-ROLLBACK TO TRUE                     23740099
237500                PERFORM DP013-0000-PROCESS-ABEND                  23750099
237600             END-IF                                               23760099
237700          WHEN SQLWARN0 NOT = SPACE                               23770099
237800          WHEN SQLCODE < ZERO                                     23780099
237900          WHEN SQLCODE > ZERO                                     23790099
238000                SET PS-ERROR-PRINT   TO TRUE                      23800099
238100                STRING PC-SELECT-ADEVENT-MSG PC-ASTERISKS         23810099
238200                   DELIMITED BY SIZE                              23820099
238300                   INTO PV-ERROR-MSG                              23830099
238400                MOVE '4140-GET-AD-DATE'                           23840099
238500                                     TO DP013-PARAGRAPH           23850099
238600                MOVE PRV-24C         TO DP013-MESSAGE-TEXT (1)    23860099
238700                PERFORM 9000-RETURN-MSG                           23870099
238800                MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)    23880099
238900                MOVE SQLCA           TO DP013-SQLCA               23890099
239000                MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)  23900099
239100                SET DP013-DB2-ABEND                               23910099
239200                    DP013-NO-ROLLBACK TO TRUE                     23920099
239300                PERFORM DP013-0000-PROCESS-ABEND                  23930099
239400      END-EVALUATE.                                               23940099
239500                                                                  23950099
239600/                                                                 23960099
239700******************************************************************23970099
239800*  THIS MODULE UPDATES A TABLE OF COST AND RETAIL AMOUNTS FOR     23980099
239900*  EACH PURCHASE ORDER LINE.                                      23990099
240000******************************************************************24000099
240100 4400-BUILD-COST-RTL-TBL.                                         24010099
240200                                                                  24020099
240300     PERFORM 4410-OPEN-RECITM-CSR.                                24030099
240400                                                                  24040099
240500     IF PS-ERROR-PRINT                                            24050099
240600        CONTINUE                                                  24060099
240700     ELSE                                                         24070099
240800        PERFORM 4600-PROCESS-RECITM-CSR                           24080099
240900           UNTIL PS-EOF-TRECITM-CSR OR                            24090099
241000                 PS-ERROR-PRINT.                                  24100099
241100                                                                  24110099
241200     PERFORM 4420-CLOSE-RECITM-CSR.                               24120099
241300                                                                  24130099
241400                                                                  24140099
241500 4410-OPEN-RECITM-CSR.                                            24150099
241600                                                                  24160099
241700     EXEC SQL                                                     24170099
241800         OPEN RECITM-CSR                                          24180099
241900     END-EXEC.                                                    24190099
242000                                                                  24200099
242100     EVALUATE TRUE                                                24210099
242200         WHEN SQLCODE = ZERO                                      24220099
242300             CONTINUE                                             24230099
242400         WHEN SQLCODE = -904                                      24240099
242500         WHEN SQLCODE = -911                                      24250099
242600         WHEN SQLCODE = -913                                      24260099
242700            IF PS-CONTENTION                                      24270099
242800               CONTINUE                                           24280099
242900            ELSE                                                  24290099
243000               SET PS-ERROR-PRINT    TO TRUE                      24300099
243100               SET PS-CONTENTION     TO TRUE                      24310099
243200               STRING PC-CONTENTION-MSG PC-ASTERISKS              24320099
243300                  DELIMITED BY SIZE                               24330099
243400                  INTO PV-ERROR-MSG                               24340099
243500               MOVE '4410-OPEN-RECITM-CSR'                        24350099
243600                                     TO DP013-PARAGRAPH           24360099
243700               MOVE PRV-21A          TO DP013-MESSAGE-TEXT (1)    24370099
243800               PERFORM 9000-RETURN-MSG                            24380099
243900               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    24390099
244000               MOVE SQLCA            TO DP013-SQLCA               24400099
244100               MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)  24410099
244200               SET DP013-DB2-ABEND                                24420099
244300                   DP013-NO-ROLLBACK TO TRUE                      24430099
244400              PERFORM DP013-0000-PROCESS-ABEND                    24440099
244500           END-IF                                                 24450099
244600         WHEN SQLWARN0 NOT = SPACE                                24460099
244700         WHEN SQLCODE < ZERO                                      24470099
244800         WHEN SQLCODE > ZERO                                      24480099
244900               SET PS-ERROR-PRINT    TO TRUE                      24490099
245000               STRING PC-RECITM-CSR-MSG PC-ASTERISKS              24500099
245100                  DELIMITED BY SIZE                               24510099
245200                  INTO PV-ERROR-MSG                               24520099
245300               MOVE '4410-OPEN-RECITM-CSR'                        24530099
245400                                     TO DP013-PARAGRAPH           24540099
245500               MOVE PRV-21A          TO DP013-MESSAGE-TEXT (1)    24550099
245600               PERFORM 9000-RETURN-MSG                            24560099
245700               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    24570099
245800               MOVE SQLCA            TO DP013-SQLCA               24580099
245900               MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)  24590099
246000               SET DP013-DB2-ABEND                                24600099
246100                   DP013-NO-ROLLBACK TO TRUE                      24610099
246200              PERFORM DP013-0000-PROCESS-ABEND                    24620099
246300     END-EVALUATE.                                                24630099
246400                                                                  24640099
246500 4420-CLOSE-RECITM-CSR.                                           24650099
246600                                                                  24660099
246700     EXEC SQL                                                     24670099
246800         CLOSE RECITM-CSR                                         24680099
246900     END-EXEC.                                                    24690099
247000                                                                  24700099
247100     EVALUATE TRUE                                                24710099
247200         WHEN SQLCODE = ZERO                                      24720099
247300         WHEN SQLCODE = -501                                      24730099
247400             CONTINUE                                             24740099
247500         WHEN SQLCODE = -904                                      24750099
247600         WHEN SQLCODE = -911                                      24760099
247700         WHEN SQLCODE = -913                                      24770099
247800            IF PS-CONTENTION                                      24780099
247900               CONTINUE                                           24790099
248000            ELSE                                                  24800099
248100               SET PS-ERROR-PRINT    TO TRUE                      24810099
248200               SET PS-CONTENTION     TO TRUE                      24820099
248300               STRING PC-CONTENTION-MSG PC-ASTERISKS              24830099
248400                  DELIMITED BY SIZE                               24840099
248500                  INTO PV-ERROR-MSG                               24850099
248600               MOVE '4420-CLOSE-RECITM-CSR'                       24860099
248700                                     TO DP013-PARAGRAPH           24870099
248800               MOVE PRV-21C          TO DP013-MESSAGE-TEXT (1)    24880099
248900               PERFORM 9000-RETURN-MSG                            24890099
249000               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    24900099
249100               MOVE SQLCA            TO DP013-SQLCA               24910099
249200               MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)  24920099
249300               SET DP013-DB2-ABEND                                24930099
249400                   DP013-NO-ROLLBACK TO TRUE                      24940099
249500               PERFORM DP013-0000-PROCESS-ABEND                   24950099
249600            END-IF                                                24960099
249700         WHEN SQLWARN0 NOT = SPACE                                24970099
249800         WHEN SQLCODE < ZERO                                      24980099
249900         WHEN SQLCODE > ZERO                                      24990099
250000               SET PS-ERROR-PRINT     TO TRUE                     25000099
250100               STRING PC-RECITM-CSR-MSG PC-ASTERISKS              25010099
250200                  DELIMITED BY SIZE                               25020099
250300                  INTO PV-ERROR-MSG                               25030099
250400               MOVE '4420-CLOSE-RECITM-CSR'                       25040099
250500                                      TO DP013-PARAGRAPH          25050099
250600               MOVE PRV-21C           TO DP013-MESSAGE-TEXT (1)   25060099
250700               PERFORM 9000-RETURN-MSG                            25070099
250800               MOVE PV-DISPLAY-KEYS   TO DP013-MESSAGE-TEXT (2)   25080099
250900               MOVE SQLCA             TO DP013-SQLCA              25090099
251000               MOVE 'TRECITM'         TO DP013-DB2-TABLE-NAME (1) 25100099
251100               SET DP013-DB2-ABEND                                25110099
251200                   DP013-NO-ROLLBACK TO TRUE                      25120099
251300               PERFORM DP013-0000-PROCESS-ABEND                   25130099
251400     END-EVALUATE.                                                25140099
251500                                                                  25150099
251600                                                                  25160099
251700******************************************************************25170099
251800*  THIS MODULE GETS THE PURCHASE ORDER LINE NUMBER AND PURCHASE   25180099
251900*  ORDER VERSION NUMBER TO BE USED AGAINST TPURITM.               25190099
252000*  THE TABLE IS UPDATED WITH THE LINE AND VERSION NUMBER.         25200099
252100******************************************************************25210099
252200 4600-PROCESS-RECITM-CSR.                                         25220099
252300                                                                  25230099
252400     PERFORM 4610-FETCH-RECITM-CSR.                               25240099
252500                                                                  25250099
252600     IF PS-ERROR-PRINT OR PS-EOF-TRECITM-CSR                      25260099
252700        CONTINUE                                                  25270099
252800     ELSE                                                         25280099
252900        SET PS-COST-IDX  TO RECITM-ORD-LNE-NBR                    25290099
253000        MOVE RECITM-ORD-LNE-NBR                                   25300099
253100                         TO PS-COST-PO-LNE-NBR (PS-COST-IDX)      25310099
253200        MOVE RECITM-PO-VER-NBR                                    25320099
253300                         TO PS-COST-PO-VER-NBR (PS-COST-IDX)      25330099
253400        PERFORM 4650-GET-PURITM-DATA.                             25340099
253500                                                                  25350099
253600                                                                  25360099
253700 4610-FETCH-RECITM-CSR.                                           25370099
253800                                                                  25380099
253900     EXEC SQL                                                     25390099
254000         FETCH  RECITM-CSR                                        25400099
254100          INTO  :RECITM-ORD-LNE-NBR                               25410099
254200              , :RECITM-PO-VER-NBR                                25420099
254300     END-EXEC.                                                    25430099
254400                                                                  25440099
254500     EVALUATE TRUE                                                25450099
254600         WHEN SQLCODE = ZERO                                      25460099
254700             CONTINUE                                             25470099
254800         WHEN SQLCODE = +100                                      25480099
254900             SET PS-EOF-TRECITM-CSR TO TRUE                       25490099
255000         WHEN SQLCODE = -904                                      25500099
255100         WHEN SQLCODE = -911                                      25510099
255200         WHEN SQLCODE = -913                                      25520099
255300             IF PS-CONTENTION                                     25530099
255400              CONTINUE                                            25540099
255500             ELSE                                                 25550099
255600               SET PS-ERROR-PRINT    TO TRUE                      25560099
255700               SET PS-CONTENTION     TO TRUE                      25570099
255800               STRING PC-CONTENTION-MSG PC-ASTERISKS              25580099
255900                  DELIMITED BY SIZE                               25590099
256000                  INTO PV-ERROR-MSG                               25600099
256100               MOVE '4610-FETCH-RECITM-CSR'                       25610099
256200                                     TO DP013-PARAGRAPH           25620099
256300               MOVE PRV-21B          TO DP013-MESSAGE-TEXT (1)    25630099
256400               PERFORM 9000-RETURN-MSG                            25640099
256500               MOVE PV-DISPLAY-KEYS                               25650099
256600                                     TO DP013-MESSAGE-TEXT (2)    25660099
256700               MOVE SQLCA            TO DP013-SQLCA               25670099
256800               MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)  25680099
256900               SET DP013-DB2-ABEND                                25690099
257000                   DP013-NO-ROLLBACK TO TRUE                      25700099
257100               PERFORM DP013-0000-PROCESS-ABEND                   25710099
257200             END-IF                                               25720099
257300         WHEN SQLWARN0 NOT = SPACE                                25730099
257400         WHEN SQLCODE < ZERO                                      25740099
257500         WHEN SQLCODE > ZERO                                      25750099
257600               SET PS-ERROR-PRINT     TO TRUE                     25760099
257700               STRING PC-RECITM-CSR-MSG PC-ASTERISKS              25770099
257800                  DELIMITED BY SIZE                               25780099
257900                  INTO PV-ERROR-MSG                               25790099
258000               MOVE '4610-FETCH-RECITM-CSR'                       25800099
258100                                      TO DP013-PARAGRAPH          25810099
258200               MOVE PRV-21B           TO DP013-MESSAGE-TEXT (1)   25820099
258300               PERFORM 9000-RETURN-MSG                            25830099
258400               MOVE PV-DISPLAY-KEYS   TO DP013-MESSAGE-TEXT (2)   25840099
258500               MOVE SQLCA             TO DP013-SQLCA              25850099
258600               MOVE 'TRECITM'         TO DP013-DB2-TABLE-NAME (1) 25860099
258700               SET DP013-DB2-ABEND                                25870099
258800                   DP013-NO-ROLLBACK TO TRUE                      25880099
258900               PERFORM DP013-0000-PROCESS-ABEND                   25890099
259000     END-EVALUATE.                                                25900099
259100                                                                  25910099
259200******************************************************************25920099
259300*  THIS MODULE GETS THE UNIT COST AND RETAIL AMOUNTS AND UPDATES  25930099
259400*  THE TABLE.                                                     25940099
259500******************************************************************25950099
259600 4650-GET-PURITM-DATA.                                            25960099
259700                                                                  25970099
259800     PERFORM 4660-SELECT-PURITM.                                  25980099
259900                                                                  25990099
260000     INITIALIZE XL001-ITEM-COMMAREA.                              26000099
260100                                                                  26010099
260200     IF PS-ERROR-PRINT                                            26020099
260300        CONTINUE                                                  26030099
260400     ELSE                                                         26040099
260500        IF (PURITM-SKU-SEQ-NBR = PC-000  OR                       26050099
260600            PURITM-SKU-SEQ-NBR = PC-999)                          26060099
260700            MOVE SPACES TO HL7-PRESENTATION                       26070099
260800                           HL7-BOX-ID                             26080099
260900                            PV-BOX-ID                             26090099
261000        ELSE                                                      26100099
261100            IF  PS-CALL-API-YES                  AND              26110099
261200               (PURITM-SKU-SEQ-NBR NOT = PC-000  AND              26120099
261300                PURITM-SKU-SEQ-NBR NOT = PC-999)                  26130099
261400                                                                  26140099
261500                PERFORM 4665-CALL-CICS-API-ARCH                   26150099
261600            END-IF                                                26160099
261700        END-IF                                                    26170099
261800        MOVE PURITM-UNT-COST-AMT                                  26180099
261900                    TO PS-COST-UNT-COST-AMT (PS-COST-IDX)         26190099
262000        MOVE PURITM-UNT-RTL-PR-AMT                                26200099
262100                    TO PS-COST-UNT-RTL-AMT (PS-COST-IDX)          26210099
262200        MOVE PURITM-GP-RTL-AMT                                    26220099
262300                    TO PS-COST-GP-RTL-AMT (PS-COST-IDX)           26230099
262400        MOVE PURITM-GP-QTY                                        26240099
262500                    TO PS-COST-GP-QTY (PS-COST-IDX)               26250099
262600     END-IF.                                                      26260099
262700                                                                  26270099
262800                                                                  26280099
262900 4660-SELECT-PURITM.                                              26290099
263000                                                                  26300099
263100     EXEC SQL                                                     26310099
263200        SELECT UNT_COST_AMT                                       26320099
263300             , UNT_RTL_PR_AMT                                     26330099
263400             , GP_RTL_AMT                                         26340099
263500             , GP_QTY                                             26350099
263600             , VEND_STYL_NAME                                     26360099
263700             , ITM_NBR                                            26370099
263800             , SKU_SEQ_NBR                                        26380099
263900         INTO :PURITM-UNT-COST-AMT                                26390099
264000            , :PURITM-UNT-RTL-PR-AMT                              26400099
264100            , :PURITM-GP-RTL-AMT                                  26410099
264200            , :PURITM-GP-QTY                                      26420099
264300            , :PURITM-VEND-STYL-NAME                              26430099
264400            , :PURITM-ITM-NBR                                     26440099
264500            , :PURITM-SKU-SEQ-NBR                                 26450099
264600         FROM  TPURITM                                            26460099
264700         WHERE PO_NBR         =  :DK-ORD-NBR                      26470099
264800           AND APP_PO_LNE_NBR =  :RECITM-ORD-LNE-NBR              26480099
264900           AND VER_NBR        =  :RECITM-PO-VER-NBR               26490099
265000     END-EXEC.                                                    26500099
265100                                                                  26510099
265200     EVALUATE TRUE                                                26520099
265300         WHEN SQLCODE = +0                                        26530099
265400              SET PS-CALL-API-YES TO TRUE                         26540099
265500         WHEN SQLCODE = -904                                      26550099
265600         WHEN SQLCODE = -911                                      26560099
265700         WHEN SQLCODE = -913                                      26570099
265800            IF PS-CONTENTION                                      26580099
265900              CONTINUE                                            26590099
266000            ELSE                                                  26600099
266100              SET PS-ERROR-PRINT    TO TRUE                       26610099
266200              SET PS-CONTENTION     TO TRUE                       26620099
266300              STRING PC-CONTENTION-MSG PC-ASTERISKS               26630099
266400                 DELIMITED BY SIZE                                26640099
266500                 INTO PV-ERROR-MSG                                26650099
266600              MOVE '4660-SELECT-PURITM'                           26660099
266700                                    TO DP013-PARAGRAPH            26670099
266800              MOVE PRV-14A          TO DP013-MESSAGE-TEXT (1)     26680099
266900              PERFORM 9000-RETURN-MSG                             26690099
267000              MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)     26700099
267100              MOVE SQLCA            TO DP013-SQLCA                26710099
267200              MOVE 'TPURITM'        TO DP013-DB2-TABLE-NAME (1)   26720099
267300              SET DP013-DB2-ABEND                                 26730099
267400                  DP013-NO-ROLLBACK TO TRUE                       26740099
267500              PERFORM DP013-0000-PROCESS-ABEND                    26750099
267600           END-IF                                                 26760099
267700         WHEN SQLWARN0 NOT = SPACES                               26770099
267800         WHEN SQLCODE < ZERO                                      26780099
267900         WHEN SQLCODE > ZERO                                      26790099
268000              SET PS-ERROR-PRINT    TO TRUE                       26800099
268100              STRING PC-SELECT-PO-DATA-MSG PC-ASTERISKS           26810099
268200                 DELIMITED BY SIZE                                26820099
268300                 INTO PV-ERROR-MSG                                26830099
268400              MOVE '4660-SELECT-PURITM'                           26840099
268500                                    TO DP013-PARAGRAPH            26850099
268600              MOVE PRV-14A          TO DP013-MESSAGE-TEXT (1)     26860099
268700              PERFORM 9000-RETURN-MSG                             26870099
268800              MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)     26880099
268900              MOVE SQLCA            TO DP013-SQLCA                26890099
269000              MOVE 'TPURITM'        TO DP013-DB2-TABLE-NAME (1)   26900099
269100              SET DP013-DB2-ABEND                                 26910099
269200                  DP013-NO-ROLLBACK TO TRUE                       26920099
269300              PERFORM DP013-0000-PROCESS-ABEND                    26930099
269301     END-EVALUATE.                                                26930199
269302                                                                  26930212
269303*----------------------------------------------------------------*26930312
269304* CODE FOR LOGISTICS DOMAIN ITEM ACCESS MODULE                   *26930412
269305*----------------------------------------------------------------*26930512
269306                                                                  26930612
269307 4665-CALL-CICS-API-ARCH.                                         26930712
269308                                                                  26930812
269309            MOVE PURITM-ITM-NBR        TO XL001-KEY-ITM-NBR.      26930912
269310                                                                  26931012
269311            SET  XL001-BY-ITEM                                    26931112
269312                 XL001-SELECT-SKU                                 26931212
269313                 XL001-SELECT-VND-STYL TO TRUE.                   26931312
269314                                                                  26931412
269315            CALL XL001-VSM-PGM USING  DFHEIBLK                    26931512
269316                                      XL001-COMMAREA              26931612
269317                                      XL001-ITEM-COMMAREA.        26931712
269318         EVALUATE TRUE                                            26931812
269319                                                                  26931912
269320              WHEN XL001-SKU-SQLCODE = +0                         26932012
269330                  PERFORM 4666-XLV-VND-STYL                       26933099
269331                                                                  26933199
269332              WHEN XL001-SKU-SQLCODE = +100                       26933212
269333                  MOVE SPACES TO HL7-BOX-ID                       26933312
269334                  MOVE SPACES TO  HL7-PRESENTATION                26933499
269335                                                                  26933512
269336              WHEN XL001-SKU-SQLCODE = -904                       26933612
269337              WHEN XL001-SKU-SQLCODE = -911                       26933712
269338              WHEN XL001-SKU-SQLCODE = -913                       26933812
269339                  IF PS-CONTENTION                                26933999
269340                    CONTINUE                                      26934099
269350                  ELSE                                            26935099
269360                    SET PS-ERROR-PRINT TO TRUE                    26936099
269370                    SET PS-CONTENTION TO TRUE                     26937099
269380                    STRING PC-CONTENTION-MSG PC-ASTERISKS         26938099
269390                       DELIMITED BY SIZE                          26939099
269400                       INTO PV-ERROR-MSG                          26940099
269500                    MOVE '4665-CALL-CICS-API-ARCH'                26950099
269600                                          TO DP013-PARAGRAPH      26960099
269700                    MOVE PRV-6A     TO DP013-MESSAGE-TEXT (1)     26970099
269800                    PERFORM 9000-RETURN-MSG                       26980099
269900                    MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)26990099
270000                    MOVE XL001-SKU-SQLCODE                        27000099
270100                                    TO SQLCODE                    27010099
270200                    MOVE SQLCA      TO DP013-SQLCA                27020099
270300                    MOVE 'XLV_SKU' TO DP013-DB2-TABLE-NAME (1)    27030099
270400                    SET DP013-DB2-ABEND                           27040099
270500                        DP013-NO-ROLLBACK TO TRUE                 27050099
270600                    PERFORM DP013-0000-PROCESS-ABEND              27060099
270601                 END-IF                                           27060199
270602                                                                  27060212
270603              WHEN XL001-INVALID-ACCESS                           27060312
270604                    SET PS-ERROR-PRINT TO TRUE                    27060499
270605                    STRING PC-SELECT-XLV-MSG PC-ASTERISKS         27060599
270606                       DELIMITED BY SIZE                          27060699
270607                       INTO PV-ERROR-MSG                          27060799
270608                    MOVE '4665-CALL-CICS-API-ARCH'                27060899
270609                                          TO DP013-PARAGRAPH      27060999
270610                    MOVE PRV-6A    TO DP013-MESSAGE-TEXT (1)      27061099
270620                    PERFORM 9000-RETURN-MSG                       27062099
270630                    MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)27063099
270640                    MOVE SQLCA      TO DP013-SQLCA                27064099
270650                    MOVE 'XLV_SKU' TO DP013-DB2-TABLE-NAME (1)    27065099
270660                    SET DP013-DB2-ABEND                           27066099
270670                        DP013-NO-ROLLBACK TO TRUE                 27067099
270671                    PERFORM DP013-0000-PROCESS-ABEND              27067199
270672                                                                  27067212
270673              WHEN OTHER                                          27067312
270674                   SET PS-ERROR-PRINT TO TRUE                     27067499
270675                   STRING PC-SELECT-XLV-SKU-MSG PC-ASTERISKS      27067599
270676                      DELIMITED BY SIZE                           27067699
270677                      INTO PV-ERROR-MSG                           27067799
270678                   MOVE '4665-CALL-CICS-API-ARCH'                 27067899
270679                                   TO DP013-PARAGRAPH             27067999
270680                   MOVE PRV-7A                                    27068099
270690                                   TO DP013-MESSAGE-TEXT (1)      27069099
270700                   PERFORM 9000-RETURN-MSG                        27070099
270800                   MOVE PV-DISPLAY-KEYS                           27080099
270900                                   TO DP013-MESSAGE-TEXT (2)      27090099
271000                   MOVE XL001-SKU-SQLCODE                         27100099
271100                                   TO SQLCODE                     27110099
271200                   MOVE SQLCA TO DP013-SQLCA                      27120099
271300                   MOVE 'XLV_SKU'                                 27130099
271400                                   TO DP013-DB2-TABLE-NAME (1)    27140099
271500                   SET DP013-DB2-ABEND                            27150099
271600                       DP013-NO-ROLLBACK TO TRUE                  27160099
271601                   PERFORM DP013-0000-PROCESS-ABEND               27160199
271602             END-EVALUATE.                                        27160212
271603                                                                  27160312
271604 4666-XLV-VND-STYL.                                               27160412
271605                                                                  27160512
271606         EVALUATE TRUE                                            27160612
271607                                                                  27160712
271608              WHEN XL001-VND-STYL-SQLCODE = +0                    27160812
271609                   MOVE XL001-HNG-FOLD-DESC TO                    27160999
271610                                       HL7-PRESENTATION           27161099
271620                   MOVE XL001-STKR-NBR TO TEMP-STICKER-NBR        27162099
271630                   IF PS-FIRST-TIME                               27163099
271640                       SET PS-NOT-FIRST-TIME TO TRUE              27164099
271650                       IF TEMP-STICKER-NBR = ZEROS                27165099
271660                           MOVE SPACES TO STICKER-NBR             27166099
271670                       ELSE                                       27167099
271680                           MOVE TEMP-STICKER-NBR TO PV-BOX-ID     27168099
271690                           MOVE TEMP-STICKER-NBR TO STICKER-NBR   27169099
271700                       END-IF                                     27170099
271800                   ELSE                                           27180099
271900                       IF TEMP-STICKER-NBR = ZEROS                27190099
272000                           MOVE ZEROES TO TEMP-STICKER-NBR        27200099
272100                       ELSE                                       27210099
272200                           MOVE TEMP-STICKER-NBR TO STICKER-NBR   27220099
272300                       END-IF                                     27230099
272400                   END-IF                                         27240099
272500                   IF PV-BOX-ID = STICKER-NBR                     27250099
272600                       CONTINUE                                   27260099
272700                   ELSE                                           27270099
272800                       IF PV-BOX-ID = 'MULTI'                     27280099
272900                           CONTINUE                               27290099
273000                       ELSE                                       27300099
273100                           MOVE PC-MULTI TO HL7-BOX-ID            27310099
273200                                            PV-BOX-ID             27320099
273300                       END-IF                                     27330099
273400                   END-IF                                         27340099
273401                                                                  27340199
273402              WHEN XL001-VND-STYL-SQLCODE = +100                  27340212
273403                  MOVE SPACES   TO  HL7-BOX-ID                    27340312
273404                  MOVE SPACES   TO  HL7-PRESENTATION              27340499
273405                                                                  27340512
273406              WHEN XL001-VND-STYL-SQLCODE = -904                  27340612
273407              WHEN XL001-VND-STYL-SQLCODE = -911                  27340712
273408              WHEN XL001-VND-STYL-SQLCODE = -913                  27340812
273409                   IF PS-CONTENTION                               27340999
273410                      CONTINUE                                    27341099
273420                   ELSE                                           27342099
273430                      SET PS-ERROR-PRINT TO TRUE                  27343099
273440                      SET PS-CONTENTION TO TRUE                   27344099
273450                      STRING PC-CONTENTION-MSG PC-ASTERISKS       27345099
273460                         DELIMITED BY SIZE                        27346099
273470                         INTO PV-ERROR-MSG                        27347099
273480                      MOVE '4666-XLV-VND-STYL'                    27348099
273490                                      TO DP013-PARAGRAPH          27349099
273500                      MOVE PRV-25A                                27350099
273600                                      TO DP013-MESSAGE-TEXT (1)   27360099
273700                      PERFORM 9000-RETURN-MSG                     27370099
273800                      MOVE PURITM-ITM-NBR                         27380099
273900                                      TO DP013-MESSAGE-TEXT (2)   27390099
274000                      MOVE XL001-VND-STYL-SQLCODE                 27400099
274100                                      TO SQLCODE                  27410099
274200                      MOVE SQLCA TO DP013-SQLCA                   27420099
274300                      MOVE 'XLV_VND_STYL'                         27430099
274400                                      TO DP013-DB2-TABLE-NAME (1) 27440099
274500                      SET DP013-DB2-ABEND                         27450099
274600                          DP013-NO-ROLLBACK TO TRUE               27460099
274700                      PERFORM DP013-0000-PROCESS-ABEND            27470099
274701                   END-IF                                         27470199
274702                                                                  27470212
274703              WHEN OTHER                                          27470312
274704                   SET PS-ERROR-PRINT TO TRUE                     27470499
274705                   STRING PC-SELECT-TSK-MSG PC-ASTERISKS          27470599
274706                      DELIMITED BY SIZE                           27470699
274707                      INTO PV-ERROR-MSG                           27470799
274708                   MOVE '4666-XLV-VND-STYL'                       27470899
274709                                    TO DP013-PARAGRAPH            27470999
274710                   MOVE PRV-25A                                   27471099
274720                                    TO DP013-MESSAGE-TEXT (1)     27472099
274730                   PERFORM 9000-RETURN-MSG                        27473099
274740                   MOVE PURITM-ITM-NBR                            27474099
274750                                    TO DP013-MESSAGE-TEXT (2)     27475099
274760                   MOVE XL001-VND-STYL-SQLCODE                    27476099
274770                                    TO SQLCODE                    27477099
274780                   MOVE SQLCA    TO DP013-SQLCA                   27478099
274790                   MOVE 'XLV_VND_STYL'                            27479099
274800                                    TO DP013-DB2-TABLE-NAME (1)   27480099
274900                   SET DP013-DB2-ABEND                            27490099
275000                       DP013-NO-ROLLBACK TO TRUE                  27500099
275001                   PERFORM DP013-0000-PROCESS-ABEND               27500199
275002             END-EVALUATE.                                        27500212
275003                                                                  27500312
275004******************************************************************27500499
275005*  THIS MODULE RETRIEVES THE PACK SLIP SEQUENCE NUMBER FOR EACH   27500599
275006*  ACTIVE ROW FOR THE RECEIVER.  THIS CURSOR WILL RETRIEVE ONE    27500699
275007*  ROW FOR EACH STORE FOR PACK-BY-STORE ORDERS.                   27500799
275008*                                                                 27500899
275009*  ONCE THIS CURSOR IS BUILT, A SECOND PACK SLIP CURSOR IS OPENED 27500999
275010*  TO RETRIEVE ALL PACK SLIP ROWS FOR EACH SEQUENCE NUMBER.       27501099
275020*  THIS WAS NECESSARY BECAUSE A STORE COULD HAVE A PACK SLIP ROW  27502099
275030*  WITH A RECEIVER SEQUENCE NUMBER OF ZERO.  THE FIRST CURSOR     27503099
275040*  RETRIEVES THE SEQUENCE NUMBER FOR EACH ACTIVE ROW WHICH WILL   27504099
275050*  BE ONE ROW PER STORE.  THE SECOND CURSOR RETRIEVES ALL ROWS    27505099
275060*  FOR THE SEQUENCE NUMBER.                                       27506099
275070******************************************************************27507099
275080 4700-BUILD-PKSLIP-DTL.                                           27508099
275090                                                                  27509099
275100     PERFORM 4710-OPEN-PKSLIP-CSR1.                               27510099
275200                                                                  27520099
275300     IF PS-ERROR-PRINT                                            27530099
275400        CONTINUE                                                  27540099
275500     ELSE                                                         27550099
275600        PERFORM 4750-PROCESS-PKSLIP-CSR1                          27560099
275700           UNTIL PS-EOF-TPKSLIP-CSR1 OR                           27570099
275800                 PS-ERROR-PRINT.                                  27580099
275900                                                                  27590099
276000     PERFORM 4720-CLOSE-PKSLIP-CSR1.                              27600099
276100                                                                  27610099
276200                                                                  27620099
276300 4710-OPEN-PKSLIP-CSR1.                                           27630099
276400                                                                  27640099
276500     EXEC SQL                                                     27650099
276600         OPEN PKSLIP-CSR1                                         27660099
276700     END-EXEC.                                                    27670099
276800                                                                  27680099
276900     EVALUATE TRUE                                                27690099
277000         WHEN SQLCODE = ZERO                                      27700099
277100             CONTINUE                                             27710099
277200         WHEN SQLCODE = -904                                      27720099
277300         WHEN SQLCODE = -911                                      27730099
277400         WHEN SQLCODE = -913                                      27740099
277500            IF PS-CONTENTION                                      27750099
277600               CONTINUE                                           27760099
277700            ELSE                                                  27770099
277800               SET PS-ERROR-PRINT    TO TRUE                      27780099
277900               SET PS-CONTENTION     TO TRUE                      27790099
278000               STRING PC-CONTENTION-MSG PC-ASTERISKS              27800099
278100                  DELIMITED BY SIZE                               27810099
278200                  INTO PV-ERROR-MSG                               27820099
278300               MOVE '4710-OPEN-PKSLIP-CSR1'                       27830099
278400                                     TO DP013-PARAGRAPH           27840099
278500               MOVE PRV-19A          TO DP013-MESSAGE-TEXT (1)    27850099
278600               PERFORM 9000-RETURN-MSG                            27860099
278700               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    27870099
278800               MOVE SQLCA            TO DP013-SQLCA               27880099
278900               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  27890099
279000               SET DP013-DB2-ABEND                                27900099
279100                   DP013-NO-ROLLBACK TO TRUE                      27910099
279200               PERFORM DP013-0000-PROCESS-ABEND                   27920099
279300            END-IF                                                27930099
279400         WHEN SQLWARN0 NOT = SPACE                                27940099
279500         WHEN SQLCODE < ZERO                                      27950099
279600         WHEN SQLCODE > ZERO                                      27960099
279700               SET PS-ERROR-PRINT    TO TRUE                      27970099
279800               STRING PC-PKSLIP-CSR1-MSG PC-ASTERISKS             27980099
279900                  DELIMITED BY SIZE                               27990099
280000                  INTO PV-ERROR-MSG                               28000099
280100               MOVE '4710-OPEN-PKSLIP-CSR1'                       28010099
280200                                      TO DP013-PARAGRAPH          28020099
280300               MOVE PRV-19A          TO DP013-MESSAGE-TEXT (1)    28030099
280400               PERFORM 9000-RETURN-MSG                            28040099
280500               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    28050099
280600               MOVE SQLCA            TO DP013-SQLCA               28060099
280700               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  28070099
280800               SET DP013-DB2-ABEND                                28080099
280900                   DP013-NO-ROLLBACK TO TRUE                      28090099
281000               PERFORM DP013-0000-PROCESS-ABEND                   28100099
281100     END-EVALUATE.                                                28110099
281200                                                                  28120099
281300                                                                  28130099
281400 4720-CLOSE-PKSLIP-CSR1.                                          28140099
281500                                                                  28150099
281600     EXEC SQL                                                     28160099
281700         CLOSE PKSLIP-CSR1                                        28170099
281800     END-EXEC.                                                    28180099
281900                                                                  28190099
282000     EVALUATE TRUE                                                28200099
282100         WHEN SQLCODE = ZERO                                      28210099
282200         WHEN SQLCODE = -501                                      28220099
282300             CONTINUE                                             28230099
282400         WHEN SQLCODE = -904                                      28240099
282500         WHEN SQLCODE = -911                                      28250099
282600         WHEN SQLCODE = -913                                      28260099
282700            IF PS-CONTENTION                                      28270099
282800               CONTINUE                                           28280099
282900            ELSE                                                  28290099
283000               SET PS-ERROR-PRINT   TO TRUE                       28300099
283100               SET PS-CONTENTION     TO TRUE                      28310099
283200               STRING PC-CONTENTION-MSG PC-ASTERISKS              28320099
283300                  DELIMITED BY SIZE                               28330099
283400                  INTO PV-ERROR-MSG                               28340099
283500               MOVE '4720-CLOSE-PKSLIP-CSR1'                      28350099
283600                                     TO DP013-PARAGRAPH           28360099
283700               MOVE PRV-19C          TO DP013-MESSAGE-TEXT (1)    28370099
283800               PERFORM 9000-RETURN-MSG                            28380099
283900               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    28390099
284000               MOVE SQLCA            TO DP013-SQLCA               28400099
284100               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  28410099
284200               SET DP013-DB2-ABEND                                28420099
284300                   DP013-NO-ROLLBACK TO TRUE                      28430099
284400               PERFORM DP013-0000-PROCESS-ABEND                   28440099
284500            END-IF                                                28450099
284600         WHEN SQLWARN0 NOT = SPACE                                28460099
284700         WHEN SQLCODE < ZERO                                      28470099
284800         WHEN SQLCODE > ZERO                                      28480099
284900               SET PS-ERROR-PRINT TO TRUE                         28490099
285000               STRING PC-PKSLIP-CSR1-MSG PC-ASTERISKS             28500099
285100                  DELIMITED BY SIZE                               28510099
285200                  INTO PV-ERROR-MSG                               28520099
285300               MOVE '4720-CLOSE-PKSLIP-CSR1'                      28530099
285400                                  TO DP013-PARAGRAPH              28540099
285500               MOVE PRV-19C       TO DP013-MESSAGE-TEXT (1)       28550099
285600               PERFORM 9000-RETURN-MSG                            28560099
285700               MOVE PV-DISPLAY-KEYS                               28570099
285800                                  TO DP013-MESSAGE-TEXT (2)       28580099
285900               MOVE SQLCA         TO DP013-SQLCA                  28590099
286000               MOVE 'TPKSLIP'     TO DP013-DB2-TABLE-NAME (1)     28600099
286100               SET DP013-DB2-ABEND                                28610099
286200                   DP013-NO-ROLLBACK TO TRUE                      28620099
286300               PERFORM DP013-0000-PROCESS-ABEND                   28630099
286400     END-EVALUATE.                                                28640099
286500                                                                  28650099
286600                                                                  28660099
286700******************************************************************28670099
286800*  THIS MODULE RETRIEVES THE PACK SLIP ROWS FOR EACH SEQUENCE     28680099
286900*  NUMBER RETRIEVED IN THE FIRST PACK SLIP CURSOR.                28690099
287000******************************************************************28700099
287100 4750-PROCESS-PKSLIP-CSR1.                                        28710099
287200                                                                  28720099
287300     PERFORM 4760-FETCH-PKSLIP-CSR1.                              28730099
287400                                                                  28740099
287500     IF PS-ERROR-PRINT OR                                         28750099
287600        PS-EOF-TPKSLIP-CSR1                                       28760099
287700           CONTINUE                                               28770099
287800     ELSE                                                         28780099
287900        SET PS-NOT-FIRST-CSR1-ROW TO TRUE                         28790099
288000        PERFORM 4800-GET-PKSLIP-DATA.                             28800099
288100                                                                  28810099
288200     IF PS-EOF-TPKSLIP-CSR1                                       28820099
288300        IF PS-FIRST-CSR1-ROW                                      28830099
288400           SET PS-ERROR-PRINT    TO TRUE                          28840099
288500           STRING PC-NOT-TRANSCRIBED-MSG PC-ASTERISKS             28850099
288600              DELIMITED BY SIZE                                   28860099
288700              INTO PV-ERROR-MSG                                   28870099
288800           MOVE '4750-PROCESS-PKSLIP-CSR1'                        28880099
288900                                 TO DP013-PARAGRAPH               28890099
289000           MOVE PRV-19B          TO DP013-MESSAGE-TEXT (1)        28900099
289100           PERFORM 9000-RETURN-MSG                                28910099
289200           MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)        28920099
289300           MOVE SQLCA            TO DP013-SQLCA                   28930099
289400           MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)      28940099
289500           SET DP013-DB2-ABEND                                    28950099
289600               DP013-NO-ROLLBACK TO TRUE                          28960099
289700           PERFORM DP013-0000-PROCESS-ABEND.                      28970099
289800                                                                  28980099
289900                                                                  28990099
290000 4760-FETCH-PKSLIP-CSR1.                                          29000099
290100                                                                  29010099
290200     EXEC SQL                                                     29020099
290300         FETCH  PKSLIP-CSR1                                       29030099
290400          INTO  :PKSLIP-SEQ-NBR                                   29040099
290500     END-EXEC.                                                    29050099
290600                                                                  29060099
290700     EVALUATE TRUE                                                29070099
290800         WHEN SQLCODE = ZERO                                      29080099
290900             CONTINUE                                             29090099
291000         WHEN SQLCODE = +100                                      29100099
291100             SET PS-EOF-TPKSLIP-CSR1 TO TRUE                      29110099
291200         WHEN SQLCODE = -904                                      29120099
291300         WHEN SQLCODE = -911                                      29130099
291400         WHEN SQLCODE = -913                                      29140099
291500            IF PS-CONTENTION                                      29150099
291600               CONTINUE                                           29160099
291700            ELSE                                                  29170099
291800               SET PS-ERROR-PRINT    TO TRUE                      29180099
291900               SET PS-CONTENTION     TO TRUE                      29190099
292000               STRING PC-CONTENTION-MSG PC-ASTERISKS              29200099
292100                  DELIMITED BY SIZE                               29210099
292200                  INTO PV-ERROR-MSG                               29220099
292300               MOVE '4760-FETCH-PKSLIP-CSR1'                      29230099
292400                                     TO DP013-PARAGRAPH           29240099
292500               MOVE PRV-19B          TO DP013-MESSAGE-TEXT (1)    29250099
292600               PERFORM 9000-RETURN-MSG                            29260099
292700               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    29270099
292800               MOVE SQLCA            TO DP013-SQLCA               29280099
292900               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  29290099
293000               SET DP013-DB2-ABEND                                29300099
293100                   DP013-NO-ROLLBACK TO TRUE                      29310099
293200               PERFORM DP013-0000-PROCESS-ABEND                   29320099
293300             END-IF                                               29330099
293400         WHEN SQLWARN0 NOT = SPACE                                29340099
293500         WHEN SQLCODE < ZERO                                      29350099
293600         WHEN SQLCODE > ZERO                                      29360099
293700               SET PS-ERROR-PRINT    TO TRUE                      29370099
293800               STRING PC-PKSLIP-CSR1-MSG PC-ASTERISKS             29380099
293900                  DELIMITED BY SIZE                               29390099
294000                  INTO PV-ERROR-MSG                               29400099
294100               MOVE '4760-FETCH-PKSLIP-CSR1'                      29410099
294200                                     TO DP013-PARAGRAPH           29420099
294300               MOVE PRV-19B          TO DP013-MESSAGE-TEXT (1)    29430099
294400               PERFORM 9000-RETURN-MSG                            29440099
294500               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    29450099
294600               MOVE SQLCA            TO DP013-SQLCA               29460099
294700               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  29470099
294800               SET DP013-DB2-ABEND                                29480099
294900                   DP013-NO-ROLLBACK TO TRUE                      29490099
295000               PERFORM DP013-0000-PROCESS-ABEND                   29500099
295100     END-EVALUATE.                                                29510099
295200                                                                  29520099
295300                                                                  29530099
295400******************************************************************29540099
295500*  THIS MODULE SELECTS PACK SLIP DATA FROM TPKSLIP AND THEN       29550099
295600*  SELECTS COST AND RETAIL DATA FOR EACH STORE FROM TPURITM.      29560099
295700******************************************************************29570099
295800 4800-GET-PKSLIP-DATA.                                            29580099
295900                                                                  29590099
296000     SET PS-NOT-EOF-TPKSLIP-CSR2 TO TRUE.                         29600099
296100                                                                  29610099
296200     PERFORM 4810-OPEN-PKSLIP-CSR2.                               29620099
296300                                                                  29630099
296400     IF PS-ERROR-PRINT                                            29640099
296500        CONTINUE                                                  29650099
296600     ELSE                                                         29660099
296700        INITIALIZE PV-PKSLIP-TRANS-UID                            29670099
296800        PERFORM 5200-PROCESS-PKSLIP-CSR2                          29680099
296900           UNTIL PS-EOF-TPKSLIP-CSR2 OR                           29690099
297000                 PS-ERROR-PRINT.                                  29700099
297100                                                                  29710099
297200     PERFORM 4820-CLOSE-PKSLIP-CSR2.                              29720099
297300                                                                  29730099
297400                                                                  29740099
297500 4810-OPEN-PKSLIP-CSR2.                                           29750099
297600                                                                  29760099
297700     EXEC SQL                                                     29770099
297800         OPEN PKSLIP-CSR2                                         29780099
297900     END-EXEC.                                                    29790099
298000                                                                  29800099
298100     EVALUATE TRUE                                                29810099
298200         WHEN SQLCODE = ZERO                                      29820099
298300             CONTINUE                                             29830099
298400         WHEN SQLCODE = -904                                      29840099
298500         WHEN SQLCODE = -911                                      29850099
298600         WHEN SQLCODE = -913                                      29860099
298700            IF PS-CONTENTION                                      29870099
298800               CONTINUE                                           29880099
298900            ELSE                                                  29890099
299000               SET PS-ERROR-PRINT    TO TRUE                      29900099
299100               SET PS-CONTENTION     TO TRUE                      29910099
299200               STRING PC-CONTENTION-MSG PC-ASTERISKS              29920099
299300                  DELIMITED BY SIZE                               29930099
299400                  INTO PV-ERROR-MSG                               29940099
299500               MOVE '4810-OPEN-PKSLIP-CSR2'                       29950099
299600                                     TO DP013-PARAGRAPH           29960099
299700               MOVE PRV-22A          TO DP013-MESSAGE-TEXT (1)    29970099
299800               PERFORM 9000-RETURN-MSG                            29980099
299900               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    29990099
300000               MOVE SQLCA            TO DP013-SQLCA               30000099
300100               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  30010099
300200               SET DP013-DB2-ABEND                                30020099
300300                   DP013-NO-ROLLBACK TO TRUE                      30030099
300400               PERFORM DP013-0000-PROCESS-ABEND                   30040099
300500            END-IF                                                30050099
300600         WHEN SQLWARN0 NOT = SPACE                                30060099
300700         WHEN SQLCODE < ZERO                                      30070099
300800         WHEN SQLCODE > ZERO                                      30080099
300900               SET PS-ERROR-PRINT    TO TRUE                      30090099
301000               STRING PC-PKSLIP-CSR2-MSG PC-ASTERISKS             30100099
301100                  DELIMITED BY SIZE                               30110099
301200                  INTO PV-ERROR-MSG                               30120099
301300               MOVE '4810-OPEN-PKSLIP-CSR2'                       30130099
301400                                      TO DP013-PARAGRAPH          30140099
301500               MOVE PRV-22A          TO DP013-MESSAGE-TEXT (1)    30150099
301600               PERFORM 9000-RETURN-MSG                            30160099
301700               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    30170099
301800               MOVE SQLCA            TO DP013-SQLCA               30180099
301900               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  30190099
302000               SET DP013-DB2-ABEND                                30200099
302100                   DP013-NO-ROLLBACK TO TRUE                      30210099
302200               PERFORM DP013-0000-PROCESS-ABEND                   30220099
302300     END-EVALUATE.                                                30230099
302400                                                                  30240099
302500                                                                  30250099
302600 4820-CLOSE-PKSLIP-CSR2.                                          30260099
302700                                                                  30270099
302800     EXEC SQL                                                     30280099
302900         CLOSE PKSLIP-CSR2                                        30290099
303000     END-EXEC.                                                    30300099
303100                                                                  30310099
303200     EVALUATE TRUE                                                30320099
303300         WHEN SQLCODE = ZERO                                      30330099
303400         WHEN SQLCODE = -501                                      30340099
303500             CONTINUE                                             30350099
303600         WHEN SQLCODE = -904                                      30360099
303700         WHEN SQLCODE = -911                                      30370099
303800         WHEN SQLCODE = -913                                      30380099
303900            IF PS-CONTENTION                                      30390099
304000               CONTINUE                                           30400099
304100            ELSE                                                  30410099
304200               SET PS-ERROR-PRINT   TO TRUE                       30420099
304300               SET PS-CONTENTION     TO TRUE                      30430099
304400               STRING PC-CONTENTION-MSG PC-ASTERISKS              30440099
304500                  DELIMITED BY SIZE                               30450099
304600                  INTO PV-ERROR-MSG                               30460099
304700               MOVE '4820-CLOSE-PKSLIP-CSR2'                      30470099
304800                                     TO DP013-PARAGRAPH           30480099
304900               MOVE PRV-22C          TO DP013-MESSAGE-TEXT (1)    30490099
305000               PERFORM 9000-RETURN-MSG                            30500099
305100               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    30510099
305200               MOVE SQLCA            TO DP013-SQLCA               30520099
305300               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  30530099
305400               SET DP013-DB2-ABEND                                30540099
305500                   DP013-NO-ROLLBACK TO TRUE                      30550099
305600               PERFORM DP013-0000-PROCESS-ABEND                   30560099
305700            END-IF                                                30570099
305800         WHEN SQLWARN0 NOT = SPACE                                30580099
305900         WHEN SQLCODE < ZERO                                      30590099
306000         WHEN SQLCODE > ZERO                                      30600099
306100               SET PS-ERROR-PRINT TO TRUE                         30610099
306200               STRING PC-PKSLIP-CSR2-MSG PC-ASTERISKS             30620099
306300                  DELIMITED BY SIZE                               30630099
306400                  INTO PV-ERROR-MSG                               30640099
306500               MOVE '4820-CLOSE-PKSLIP-CSR2'                      30650099
306600                                  TO DP013-PARAGRAPH              30660099
306700               MOVE PRV-22C       TO DP013-MESSAGE-TEXT (1)       30670099
306800               PERFORM 9000-RETURN-MSG                            30680099
306900               MOVE PV-DISPLAY-KEYS                               30690099
307000                                  TO DP013-MESSAGE-TEXT (2)       30700099
307100               MOVE SQLCA         TO DP013-SQLCA                  30710099
307200               MOVE 'TPKSLIP'     TO DP013-DB2-TABLE-NAME (1)     30720099
307300               SET DP013-DB2-ABEND                                30730099
307400                   DP013-NO-ROLLBACK TO TRUE                      30740099
307500               PERFORM DP013-0000-PROCESS-ABEND                   30750099
307600     END-EVALUATE.                                                30760099
307700                                                                  30770099
307800/                                                                 30780099
307900******************************************************************30790099
308000*  THIS MODULE SELECTS PACK SLIP DATA FROM TPKSLIP AND THEN       30800099
308100*  SELECTS COST AND RETAIL DATA FOR EACH STORE.  BULK ORDERS      30810099
308200*  CONTAIN ONE ROW ON TPKSLIP AND ARE NOT KEYED WITH A STORE      30820099
308300*  NUMBER.                                                        30830099
308400*                                                                 30840099
308500*  THE PACK SLIP CURSOR RETRIEVES ROWS IN DESCENDING ORDER        30850099
308600*  FOR EACH SEQUENCE NUMBER (STORE NUMBER).                       30860099
308700*                                                                 30870099
308800*  VARIOUS PIECES OF INFORMATION ARE REQUIRED FROM TPKSLIP:       30880099
308900*                                                                 30890099
309000*  1) THE USERID ON THE LAST ROW RETRIEVED (EARLIEST ROW) IS      30900099
309100*     NEEDED FOR 'KEYED BY'.                                      30910099
309200*  2) THE FIRST ROW WITH PACK SLIP STATUS OF 'AC' IS NEEDED FOR   30920099
309300*     'TRANSCRIBED BY'.                                           30930099
309400*  3) IF THE FIRST ROW FOR EACH STORE HAS PACK SLIP SLIP STATUS   30940099
309500*     OF 'IN', IT IS NOT TRANSCRIBED, PROCESSING ON THE           30950099
309600*     HEADER IS STOPPED, AND THE TOP PORTION OF THE HEADER IS     30960099
309700*     PRINTED ALONG WITH AN ERROR MESSAGE.                        30970099
309800*  4) ALL OTHER DATA ON THE BOTTOM PORTION OF THE HEADER IS       30980099
309900*     RETRIEVED FROM THE FIRST ROW FOR EACH STORE WITH PACK SLIP  30990099
310000*     OF 'AC'.                                                    31000099
310100*                                                                 31010099
310200* PROCESSING STOPS IF THERE AREN'T ANY PACK SLIPS AND THE REPORT  31020099
310300* IS PRINTED WITH AN ERROR MESSAGE.                               31030099
310400*                                                                 31040099
310500* IF THE PACK SLIP STATUS ON THE FIRST ROW IN THE CURSOR IS       31050099
310600* 'IN', THE PACK SLIP FOR THE STORE IS NOT CURRENTLY TRANSCRIBED, 31060099
310700* PROCESSING STOPS, AND THE REPORT IS PRINTED WITH AN ERROR       31070099
310800* MESSAGE.  IF STATUS IS NOT 'IN', A FEW NEEDED FIELDS ARE        31080099
310900* UPDATED IN WORKING STORAGE, THE COST AND RETAIL ARE CALCULATED, 31090099
311000* AND THE ROW IS CHECKED TO SEE IF IT HAS THE CORRECT STATUS TO   31100099
311100* TO FILL IN 'TRANSCRIBED BY' OR 'KEYED BY'.                      31110099
311200*                                                                 31120099
311300* THE TPKITEM ROWS FOR THE STORE ARE FETCHED.  THE COST AND       31130099
311400* RETAIL ARE GATHERED FOR EACH LINE AND ACCUMULATED FOR THE       31140099
311500* STORE.                                                          31150099
311600*                                                                 31160099
311700* IF THE NEXT ROW IS FOR THE SAME STORE, THE ROW IS CHECKED TO    31170099
311800* SEE IF THE 'TRANSCRIBED BY' OR 'KEYED BY' SHOULD BE UPDATED.    31180099
311900*                                                                 31190099
312000* THE 'KEYED BY' FIELD WILL BE OVERLAID EACH TIME A ROW FOR A     31200099
312100* STORE IS FETCHED UNTIL IT HAS THE USERID OF THE EARLIEST ROW    31210099
312200* FOR THAT STORE.                                                 31220099
312300*                                                                 31230099
312400* THE 'TRANSCRIBED BY' FIELD MIGHT BE OVERLAID IF AN EARLIER ROW  31240099
312500* CONTAINS A STATUS OF 'AC'.  THIS WILL OCCUR IF A PACK SLIP WAS  31250099
312600* TRANSCRIBED, INACTIVATED, AND RETRANSCRIBED.                    31260099
312700* 5/99 - NOT ANY MORE.  THE PROGRAM WAS CHANGED TO STICK WITH THE 31270099
312800*        MOST RECENT 'TRANSCRIBED BY' ID.                         31280099
312900*                                                                 31290099
313000* WHEN A ROW FOR THE NEXT STORE IS FETCHED, THE DATA THAT WAS     31300099
313100* GATHERED FOR THE PREVIOUS STORE IS MOVED TO A TABLE THAT WILL   31310099
313200* LATER BE USED TO PRINTING THE REPORT.                           31320099
313300******************************************************************31330099
313400 5200-PROCESS-PKSLIP-CSR2.                                        31340099
313500                                                                  31350099
313600     PERFORM 5210-FETCH-PKSLIP-CSR2.                              31360099
313700                                                                  31370099
313800     IF PS-ERROR-PRINT                                            31380099
313900        CONTINUE                                                  31390099
314000     ELSE                                                         31400099
314100        IF PS-EOF-TPKSLIP-CSR2                                    31410099
314200           IF PS-FIRST-CSR2-ROW                                   31420099
314300              SET PS-ERROR-PRINT    TO TRUE                       31430099
314400              STRING PC-NOT-TRANSCRIBED-MSG PC-ASTERISKS          31440099
314500                 DELIMITED BY SIZE                                31450099
314600                 INTO PV-ERROR-MSG                                31460099
314700              MOVE '5200-PROCESS-PKSLIP-CSR2'                     31470099
314800                                    TO DP013-PARAGRAPH            31480099
314900              MOVE PRV-19B          TO DP013-MESSAGE-TEXT (1)     31490099
315000              PERFORM 9000-RETURN-MSG                             31500099
315100              MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)     31510099
315200              MOVE SQLCA            TO DP013-SQLCA                31520099
315300              MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)   31530099
315400              SET DP013-DB2-ABEND                                 31540099
315500                  DP013-NO-ROLLBACK TO TRUE                       31550099
315600              PERFORM DP013-0000-PROCESS-ABEND                    31560099
315700           END-IF                                                 31570099
315800        ELSE                                                      31580099
315900           IF PS-FIRST-CSR2-ROW                                   31590099
316000              MOVE PKSLIP-SEQ-NBR TO PV-PKSLIP-SEQ-NBR            31600099
316100              PERFORM 5250-CHECK-FIRST-STAT                       31610099
316200              IF PS-ERROR-PRINT                                   31620099
316300                 CONTINUE                                         31630099
316400              ELSE                                                31640099
316500                 PERFORM 5400-PROCESS-PKITEM                      31650099
316600                 IF PS-ERROR-PRINT                                31660099
316700                    CONTINUE                                      31670099
316800                 ELSE                                             31680099
316900                    PERFORM 5260-CHECK-PKSLIP-STAT.               31690099
317000                                                                  31700099
317100     IF PS-EOF-TPKSLIP-CSR2 OR                                    31710099
317200        PS-ERROR-PRINT OR                                         31720099
317300        PS-FIRST-CSR2-ROW                                         31730099
317400           CONTINUE                                               31740099
317500     ELSE                                                         31750099
317600        IF PKSLIP-SEQ-NBR = PV-PKSLIP-SEQ-NBR                     31760099
317700           CONTINUE                                               31770099
317800        ELSE                                                      31780099
317900           MOVE PKSLIP-SEQ-NBR TO PV-PKSLIP-SEQ-NBR               31790099
318000           PERFORM 5250-CHECK-FIRST-STAT                          31800099
318100           IF PS-ERROR-PRINT                                      31810099
318200              CONTINUE                                            31820099
318300           ELSE                                                   31830099
318400              PERFORM 5400-PROCESS-PKITEM                         31840099
318500           END-IF                                                 31850099
318600        END-IF                                                    31860099
318700        IF PS-ERROR-PRINT                                         31870099
318800           CONTINUE                                               31880099
318900        ELSE                                                      31890099
319000           PERFORM 5260-CHECK-PKSLIP-STAT.                        31900099
319100                                                                  31910099
319200     IF PS-ERROR-PRINT OR                                         31920099
319300        PS-EOF-TPKSLIP-CSR2                                       31930099
319400           CONTINUE                                               31940099
319500     ELSE                                                         31950099
319600        IF PS-FIRST-CSR2-ROW                                      31960099
319700           SET PS-NOT-FIRST-CSR2-ROW TO TRUE.                     31970099
319800                                                                  31980099
319900     IF PS-ERROR-PRINT                                            31990099
320000           CONTINUE                                               32000099
320100     ELSE                                                         32010099
320200        IF PS-EOF-TPKSLIP-CSR2                                    32020099
320300           PERFORM 5270-MOVE-TO-TABLE.                            32030099
320400                                                                  32040099
320500/                                                                 32050099
320600 5210-FETCH-PKSLIP-CSR2.                                          32060099
320700                                                                  32070099
320800     EXEC SQL                                                     32080099
320900         FETCH  PKSLIP-CSR2                                       32090099
321000          INTO  :PKSLIP-CRE-TMST                                  32100099
321100               ,:PKSLIP-PKSL-NBR                                  32110099
321200               ,:PKSLIP-VER-STAT-CDE                              32120099
321300               ,:PKSLIP-PKSL-STAT-CDE                             32130099
321400               ,:PKSLIP-STR-DEST-NBR                              32140099
321500               ,:PKSLIP-EXPTED-PKG-QTY                            32150099
321600               ,:PKSLIP-CRE-UID                                   32160099
321700               ,:PKSLIP-PKSL-PG-CNT                               32170099
321800               ,:PKSLIP-SEQ-NBR                                   32180099
321900     END-EXEC.                                                    32190099
322000                                                                  32200099
322100     EVALUATE TRUE                                                32210099
322200         WHEN SQLCODE = ZERO                                      32220099
322300             CONTINUE                                             32230099
322400         WHEN SQLCODE = +100                                      32240099
322500             SET PS-EOF-TPKSLIP-CSR2 TO TRUE                      32250099
322600         WHEN SQLCODE = -904                                      32260099
322700         WHEN SQLCODE = -911                                      32270099
322800         WHEN SQLCODE = -913                                      32280099
322900            IF PS-CONTENTION                                      32290099
323000               CONTINUE                                           32300099
323100            ELSE                                                  32310099
323200               SET PS-ERROR-PRINT    TO TRUE                      32320099
323300               SET PS-CONTENTION     TO TRUE                      32330099
323400               STRING PC-CONTENTION-MSG PC-ASTERISKS              32340099
323500                  DELIMITED BY SIZE                               32350099
323600                  INTO PV-ERROR-MSG                               32360099
323700               MOVE '5210-FETCH-PKSLIP-CSR2'                      32370099
323800                                     TO DP013-PARAGRAPH           32380099
323900               MOVE PRV-22B          TO DP013-MESSAGE-TEXT (1)    32390099
324000               PERFORM 9000-RETURN-MSG                            32400099
324100               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    32410099
324200               MOVE SQLCA            TO DP013-SQLCA               32420099
324300               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  32430099
324400               SET DP013-DB2-ABEND                                32440099
324500                   DP013-NO-ROLLBACK TO TRUE                      32450099
324600               PERFORM DP013-0000-PROCESS-ABEND                   32460099
324700             END-IF                                               32470099
324800         WHEN SQLWARN0 NOT = SPACE                                32480099
324900         WHEN SQLCODE < ZERO                                      32490099
325000         WHEN SQLCODE > ZERO                                      32500099
325100               SET PS-ERROR-PRINT    TO TRUE                      32510099
325200               STRING PC-PKSLIP-CSR2-MSG PC-ASTERISKS             32520099
325300                  DELIMITED BY SIZE                               32530099
325400                  INTO PV-ERROR-MSG                               32540099
325500               MOVE '5210-FETCH-PKSLIP-CSR2'                      32550099
325600                                     TO DP013-PARAGRAPH           32560099
325700               MOVE PRV-22B          TO DP013-MESSAGE-TEXT (1)    32570099
325800               PERFORM 9000-RETURN-MSG                            32580099
325900               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    32590099
326000               MOVE SQLCA            TO DP013-SQLCA               32600099
326100               MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)  32610099
326200               SET DP013-DB2-ABEND                                32620099
326300                   DP013-NO-ROLLBACK TO TRUE                      32630099
326400               PERFORM DP013-0000-PROCESS-ABEND                   32640099
326500     END-EVALUATE.                                                32650099
326600                                                                  32660099
326700                                                                  32670099
326800 5250-CHECK-FIRST-STAT.                                           32680099
326900                                                                  32690099
327000        IF PKSLIP-PKSL-STAT-CDE = 'IN'                            32700099
327100           SET PS-ERROR-PRINT    TO TRUE                          32710099
327200           STRING PC-NOT-TRANSCRIBED-MSG PC-ASTERISKS             32720099
327300              DELIMITED BY SIZE                                   32730099
327400              INTO PV-ERROR-MSG                                   32740099
327500           MOVE '5250-PROCESS-PKSLIP-CSR2'                        32750099
327600                                 TO DP013-PARAGRAPH               32760099
327700           MOVE PRV-4A           TO DP013-MESSAGE-TEXT (1)        32770099
327800           PERFORM 9000-RETURN-MSG                                32780099
327900           MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)        32790099
328000           MOVE SQLCA            TO DP013-SQLCA                   32800099
328100           MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)      32810099
328200           SET DP013-DB2-ABEND                                    32820099
328300               DP013-NO-ROLLBACK TO TRUE                          32830099
328400           PERFORM DP013-0000-PROCESS-ABEND                       32840099
328500        ELSE                                                      32850099
328600           IF PKSLIP-VER-STAT-CDE = 'A' AND                       32860099
328700              PKSLIP-PKSL-STAT-CDE = 'AC'                         32870099
328800                 MOVE PKSLIP-PKSL-NBR                             32880099
328900                                TO PV-PKSLIP-PKSL-NBR             32890099
329000                 MOVE PKSLIP-PKSL-PG-CNT                          32900099
329100                                TO PV-PKSLIP-PKSL-PG-CNT          32910099
329200                 MOVE PKSLIP-STR-DEST-NBR                         32920099
329300                                TO PV-PKSLIP-STR-DEST-NBR         32930099
329400                 MOVE PKSLIP-EXPTED-PKG-QTY                       32940099
329500                                TO PV-PKSLIP-EXPTED-PKG-QTY       32950099
329600                 ADD +1         TO PV-STR-CNT.                    32960099
329700                                                                  32970099
329800******************************************************************32980099
329900* IF STATUS IS ACTIVE, THE USERID IS SAVED TO BE USED AS THE      32990099
330000* TRANSCRIBED USERID.  THE EARLIEST 'AC' ROW IS NEEDED.  THE ROWS 33000099
330100* 5/99 - NOT ANY MORE. THE PROGRAM WAS CHANGED TO TAKE THE MOST   33010099
330200*        RECENT USERID.                                           33020099
330300* ARE READ IN DESCENDING ORDER AND THE VALUE IS MOVED FOR EACH    33030099
330400* 'AC' ROW FOUND.                                                 33040099
330500* IF VERSION STATUS IS INACTIVE, THE CREATE TIMESTAMP IS SAVED    33050099
330600* TO BE USED AS THE KEYED BY DATE.  THE EARLIEST 'I' ROW IS       33060099
330700* NEEDED.  THE ROWS ARE READ IN DESCENDING ORDER AND THE VALUE    33070099
330800* IS MOVED FOR EACH 'I' ROW FOUND.                                33080099
330900******************************************************************33090099
331000 5260-CHECK-PKSLIP-STAT.                                          33100099
331100                                                                  33110099
331200     IF PKSLIP-PKSL-STAT-CDE = 'AC'                               33120099
331300       AND PV-PKSLIP-TRANS-UID = SPACES                           33130099
331400        MOVE PKSLIP-CRE-UID  TO PV-PKSLIP-TRANS-UID.              33140099
331500                                                                  33150099
331600     MOVE PKSLIP-CRE-UID     TO PV-PKSLIP-KEYD-UID.               33160099
331700                                                                  33170099
331800                                                                  33180099
331900 5270-MOVE-TO-TABLE.                                              33190099
332000                                                                  33200099
332100     IF PS-ERROR-PRINT                                            33210099
332200        CONTINUE                                                  33220099
332300     ELSE                                                         33230099
332400         MOVE PV-PKSLIP-PKSL-NBR                                  33240099
332500                   TO PS-PKSLIP-PKSL-NBR (PS-PKSLIP-IDX)          33250099
332600         MOVE PV-PKSLIP-KEYD-UID                                  33260099
332700                   TO PS-PKSLIP-KEYD-BY (PS-PKSLIP-IDX)           33270099
332800         MOVE PV-PKSLIP-TRANS-UID                                 33280099
332900                   TO PS-PKSLIP-TRANS-BY (PS-PKSLIP-IDX)          33290099
333000         MOVE PV-PKSLIP-PKSL-PG-CNT                               33300099
333100                   TO PS-PKSLIP-PKSL-PG-CNT (PS-PKSLIP-IDX)       33310099
333200         MOVE PV-PKSLIP-STR-DEST-NBR                              33320099
333300                   TO PS-PKSLIP-STR-DEST-NBR (PS-PKSLIP-IDX)      33330099
333400         MOVE PV-PKSLIP-EXPTED-PKG-QTY                            33340099
333500                   TO PS-PKSLIP-EXPTED-PKG-QTY (PS-PKSLIP-IDX)    33350099
333600         MOVE PV-PKITEM-PKSL-ITM-QTY                              33360099
333700                   TO PS-PKITEM-PKSL-ITM-QTY (PS-PKSLIP-IDX)      33370099
333800                                                                  33380099
333900         MOVE PV-TOT-COST-BY-STORE                                33390099
334000                   TO PS-TOT-COST-BY-STORE (PS-PKSLIP-IDX)        33400099
334100         MOVE PV-TOT-RETAIL-BY-STORE                              33410099
334200                   TO PS-TOT-RETAIL-BY-STORE (PS-PKSLIP-IDX)      33420099
334300                                                                  33430099
334400         ADD PV-PKSLIP-EXPTED-PKG-QTY TO PV-TOT-CTN-QTY           33440099
334500         ADD PV-PKITEM-PKSL-ITM-QTY   TO PV-TOT-UNIT-QTY          33450099
334600                                                                  33460099
334700         SET PS-PKSLIP-IDX UP BY +1.                              33470099
334800                                                                  33480099
334900                                                                  33490099
335000******************************************************************33500099
335100* THE TPKITEM ROWS FOR THE STORE ARE FETCHED TO GET THE PURCHASE  33510099
335200* ORDER LINES FOR EACH STORE.                                     33520099
335300******************************************************************33530099
335400 5400-PROCESS-PKITEM.                                             33540099
335500                                                                  33550099
335600     SET PS-NOT-EOF-PKITEM-CSR TO TRUE.                           33560099
335700                                                                  33570099
335800     INITIALIZE PV-PKITEM-PKSL-ITM-QTY                            33580099
335900                PV-SUM-COST-BY-LINE                               33590099
336000                PV-TOT-COST-BY-STORE                              33600099
336100                PV-SUM-RETAIL-BY-LINE                             33610099
336200                PV-TOT-RETAIL-BY-STORE.                           33620099
336300                                                                  33630099
336400     PERFORM 5410-OPEN-PKITEM-CSR.                                33640099
336500                                                                  33650099
336600     IF PS-ERROR-PRINT                                            33660099
336700        CONTINUE                                                  33670099
336800     ELSE                                                         33680099
336900        PERFORM 5600-PROCESS-PKITEM-CSR                           33690099
337000           UNTIL PS-EOF-PKITEM-CSR OR                             33700099
337100                 PS-ERROR-PRINT.                                  33710099
337200                                                                  33720099
337300     PERFORM 5420-CLOSE-PKITEM-CSR.                               33730099
337400                                                                  33740099
337500                                                                  33750099
337600 5410-OPEN-PKITEM-CSR.                                            33760099
337700                                                                  33770099
337800     EXEC SQL                                                     33780099
337900         OPEN PKITEM-CSR                                          33790099
338000     END-EXEC.                                                    33800099
338100                                                                  33810099
338200     EVALUATE TRUE                                                33820099
338300         WHEN SQLCODE = ZERO                                      33830099
338400             CONTINUE                                             33840099
338500         WHEN SQLCODE = -904                                      33850099
338600         WHEN SQLCODE = -911                                      33860099
338700         WHEN SQLCODE = -913                                      33870099
338800            IF PS-CONTENTION                                      33880099
338900               CONTINUE                                           33890099
339000            ELSE                                                  33900099
339100               SET PS-ERROR-PRINT    TO TRUE                      33910099
339200               SET PS-CONTENTION     TO TRUE                      33920099
339300               STRING PC-CONTENTION-MSG PC-ASTERISKS              33930099
339400                  DELIMITED BY SIZE                               33940099
339500                  INTO PV-ERROR-MSG                               33950099
339600               MOVE '5410-OPEN-PKITEM-CSR'                        33960099
339700                                     TO DP013-PARAGRAPH           33970099
339800               MOVE PRV-20A          TO DP013-MESSAGE-TEXT (1)    33980099
339900               PERFORM 9000-RETURN-MSG                            33990099
340000               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    34000099
340100               MOVE SQLCA            TO DP013-SQLCA               34010099
340200               MOVE 'TPKITEM'        TO DP013-DB2-TABLE-NAME (1)  34020099
340300               SET DP013-DB2-ABEND                                34030099
340400                   DP013-NO-ROLLBACK TO TRUE                      34040099
340500              PERFORM DP013-0000-PROCESS-ABEND                    34050099
340600           END-IF                                                 34060099
340700         WHEN SQLWARN0 NOT = SPACE                                34070099
340800         WHEN SQLCODE < ZERO                                      34080099
340900         WHEN SQLCODE > ZERO                                      34090099
341000               SET PS-ERROR-PRINT    TO TRUE                      34100099
341100               STRING PC-PKITEM-CSR-MSG PC-ASTERISKS              34110099
341200                  DELIMITED BY SIZE                               34120099
341300                  INTO PV-ERROR-MSG                               34130099
341400               MOVE '5410-OPEN-PKITEM-CSR'                        34140099
341500                                     TO DP013-PARAGRAPH           34150099
341600               MOVE PRV-20A          TO DP013-MESSAGE-TEXT (1)    34160099
341700               PERFORM 9000-RETURN-MSG                            34170099
341800               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    34180099
341900               MOVE SQLCA            TO DP013-SQLCA               34190099
342000               MOVE 'TPKITEM'        TO DP013-DB2-TABLE-NAME (1)  34200099
342100               SET DP013-DB2-ABEND                                34210099
342200                   DP013-NO-ROLLBACK TO TRUE                      34220099
342300              PERFORM DP013-0000-PROCESS-ABEND                    34230099
342400     END-EVALUATE.                                                34240099
342500                                                                  34250099
342600                                                                  34260099
342700 5420-CLOSE-PKITEM-CSR.                                           34270099
342800                                                                  34280099
342900     EXEC SQL                                                     34290099
343000         CLOSE PKITEM-CSR                                         34300099
343100     END-EXEC.                                                    34310099
343200                                                                  34320099
343300     EVALUATE TRUE                                                34330099
343400         WHEN SQLCODE = ZERO                                      34340099
343500         WHEN SQLCODE = -501                                      34350099
343600             CONTINUE                                             34360099
343700         WHEN SQLCODE = -904                                      34370099
343800         WHEN SQLCODE = -911                                      34380099
343900         WHEN SQLCODE = -913                                      34390099
344000            IF PS-CONTENTION                                      34400099
344100               CONTINUE                                           34410099
344200            ELSE                                                  34420099
344300               SET PS-ERROR-PRINT    TO TRUE                      34430099
344400               STRING PC-CONTENTION-MSG PC-ASTERISKS              34440099
344500                  DELIMITED BY SIZE                               34450099
344600                  INTO PV-ERROR-MSG                               34460099
344700               SET PS-CONTENTION     TO TRUE                      34470099
344800               MOVE '5420-CLOSE-PKITEM-CSR'                       34480099
344900                                     TO DP013-PARAGRAPH           34490099
345000               MOVE PRV-20C          TO DP013-MESSAGE-TEXT (1)    34500099
345100               PERFORM 9000-RETURN-MSG                            34510099
345200               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    34520099
345300               MOVE SQLCA            TO DP013-SQLCA               34530099
345400               MOVE 'TPKITEM'        TO DP013-DB2-TABLE-NAME (1)  34540099
345500               SET DP013-DB2-ABEND                                34550099
345600                   DP013-NO-ROLLBACK TO TRUE                      34560099
345700               PERFORM DP013-0000-PROCESS-ABEND                   34570099
345800            END-IF                                                34580099
345900         WHEN SQLWARN0 NOT = SPACE                                34590099
346000         WHEN SQLCODE < ZERO                                      34600099
346100         WHEN SQLCODE > ZERO                                      34610099
346200               SET PS-ERROR-PRINT     TO TRUE                     34620099
346300               STRING PC-PKITEM-CSR-MSG PC-ASTERISKS              34630099
346400                  DELIMITED BY SIZE                               34640099
346500                  INTO PV-ERROR-MSG                               34650099
346600               MOVE '5420-CLOSE-PKITEM-CSR'                       34660099
346700                                      TO DP013-PARAGRAPH          34670099
346800               MOVE PRV-20C           TO DP013-MESSAGE-TEXT (1)   34680099
346900               PERFORM 9000-RETURN-MSG                            34690099
347000               MOVE PV-DISPLAY-KEYS   TO DP013-MESSAGE-TEXT (2)   34700099
347100               MOVE SQLCA             TO DP013-SQLCA              34710099
347200               MOVE 'TPKITEM'         TO DP013-DB2-TABLE-NAME (1) 34720099
347300               SET DP013-DB2-ABEND                                34730099
347400                   DP013-NO-ROLLBACK TO TRUE                      34740099
347500               PERFORM DP013-0000-PROCESS-ABEND                   34750099
347600     END-EVALUATE.                                                34760099
347700                                                                  34770099
347800                                                                  34780099
347900 5600-PROCESS-PKITEM-CSR.                                         34790099
348000                                                                  34800099
348100     PERFORM 5610-FETCH-PKITEM-CSR.                               34810099
348200                                                                  34820099
348300     IF PS-ERROR-PRINT OR PS-EOF-PKITEM-CSR                       34830099
348400        CONTINUE                                                  34840099
348500     ELSE                                                         34850099
348600        ADD PKITEM-PKSL-ITM-QTY TO PV-PKITEM-PKSL-ITM-QTY         34860099
348700        PERFORM 5800-CALC-COST-DATA.                              34870099
348800                                                                  34880099
348900                                                                  34890099
349000 5610-FETCH-PKITEM-CSR.                                           34900099
349100                                                                  34910099
349200     EXEC SQL                                                     34920099
349300         FETCH  PKITEM-CSR                                        34930099
349400          INTO  :PKITEM-PKSL-LNE-NBR                              34940099
349500              , :PKITEM-PKSL-ITM-QTY                              34950099
349600     END-EXEC.                                                    34960099
349700                                                                  34970099
349800     EVALUATE TRUE                                                34980099
349900         WHEN SQLCODE = ZERO                                      34990099
350000             CONTINUE                                             35000099
350100         WHEN SQLCODE = +100                                      35010099
350200             SET PS-EOF-PKITEM-CSR TO TRUE                        35020099
350300         WHEN SQLCODE = -904                                      35030099
350400         WHEN SQLCODE = -911                                      35040099
350500         WHEN SQLCODE = -913                                      35050099
350600            IF PS-CONTENTION                                      35060099
350700               CONTINUE                                           35070099
350800            ELSE                                                  35080099
350900               SET PS-ERROR-PRINT    TO TRUE                      35090099
351000               SET PS-CONTENTION     TO TRUE                      35100099
351100               STRING PC-CONTENTION-MSG PC-ASTERISKS              35110099
351200                  DELIMITED BY SIZE                               35120099
351300                  INTO PV-ERROR-MSG                               35130099
351400               MOVE '5610-FETCH-PKITEM-CSR'                       35140099
351500                                     TO DP013-PARAGRAPH           35150099
351600               MOVE PRV-20B          TO DP013-MESSAGE-TEXT (1)    35160099
351700               PERFORM 9000-RETURN-MSG                            35170099
351800               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    35180099
351900               MOVE SQLCA            TO DP013-SQLCA               35190099
352000               MOVE 'TPKITEM'        TO DP013-DB2-TABLE-NAME (1)  35200099
352100               SET DP013-DB2-ABEND                                35210099
352200                   DP013-NO-ROLLBACK TO TRUE                      35220099
352300               PERFORM DP013-0000-PROCESS-ABEND                   35230099
352400            END-IF                                                35240099
352500         WHEN SQLWARN0 NOT = SPACE                                35250099
352600         WHEN SQLCODE < ZERO                                      35260099
352700         WHEN SQLCODE > ZERO                                      35270099
352800               SET PS-ERROR-PRINT     TO TRUE                     35280099
352900               STRING PC-PKITEM-CSR-MSG PC-ASTERISKS              35290099
353000                  DELIMITED BY SIZE                               35300099
353100                  INTO PV-ERROR-MSG                               35310099
353200               MOVE '5610-FETCH-PKITEM-CSR'                       35320099
353300                                      TO DP013-PARAGRAPH          35330099
353400               MOVE PRV-20B           TO DP013-MESSAGE-TEXT (1)   35340099
353500               PERFORM 9000-RETURN-MSG                            35350099
353600               MOVE PV-DISPLAY-KEYS   TO DP013-MESSAGE-TEXT (2)   35360099
353700               MOVE SQLCA             TO DP013-SQLCA              35370099
353800               MOVE 'TPKITEM'         TO DP013-DB2-TABLE-NAME (1) 35380099
353900               MOVE SPACES            TO DP013-DB2-TABLE-NAME (1) 35390099
354000               MOVE SPACES            TO DP013-DB2-TABLE-NAME (1) 35400099
354100               SET DP013-DB2-ABEND                                35410099
354200                   DP013-NO-ROLLBACK TO TRUE                      35420099
354300               PERFORM DP013-0000-PROCESS-ABEND                   35430099
354400     END-EVALUATE.                                                35440099
354500                                                                  35450099
354600                                                                  35460099
354700******************************************************************35470099
354800*  TOTAL COST AND RETAIL ARE CALCULATED FOR EACH PURCHASE ORDER   35480099
354900*  ORDER LINES ON TPKITEM FOR EACH STORE.                         35490099
355000*                                                                 35500099
355100*  TOTAL RETAIL IS CALCULATED DIFFERENTLY IF THE MERCHANDISE IS   35510099
355200*  IN PACKS BY USING THE GROUP RETAIL AMOUNT THAT WAS RETRIEVED   35520099
355300*  FROM TPURITM.                                                  35530099
355400******************************************************************35540099
355500 5800-CALC-COST-DATA.                                             35550099
355600                                                                  35560099
355700     SET PS-COST-IDX TO PKITEM-PKSL-LNE-NBR.                      35570099
355800                                                                  35580099
355900     COMPUTE PV-SUM-COST-BY-LINE ROUNDED =                        35590099
356000             PS-COST-UNT-COST-AMT (PS-COST-IDX) *                 35600099
356100                              PKITEM-PKSL-ITM-QTY.                35610099
356200                                                                  35620099
356300     COMPUTE PV-TOT-COST-BY-STORE =                               35630099
356400             PV-TOT-COST-BY-STORE + PV-SUM-COST-BY-LINE.          35640099
356500                                                                  35650099
356600     IF PS-COST-GP-RTL-AMT (PS-COST-IDX) > ZEROES AND             35660099
356700        PS-COST-GP-QTY (PS-COST-IDX)     > 1                      35670099
356800          COMPUTE PV-SUM-RETAIL-BY-LINE ROUNDED =                 35680099
356900            (PS-COST-GP-RTL-AMT (PS-COST-IDX) /                   35690099
357000                              PS-COST-GP-QTY (PS-COST-IDX)) *     35700099
357100                              PKITEM-PKSL-ITM-QTY                 35710099
357200     ELSE                                                         35720099
357300        COMPUTE PV-SUM-RETAIL-BY-LINE ROUNDED =                   35730099
357400          PS-COST-UNT-RTL-AMT (PS-COST-IDX) *                     35740099
357500                              PKITEM-PKSL-ITM-QTY.                35750099
357600                                                                  35760099
357700     COMPUTE PV-TOT-RETAIL-BY-STORE =                             35770099
357800             PV-TOT-RETAIL-BY-STORE + PV-SUM-RETAIL-BY-LINE.      35780099
357900                                                                  35790099
358000/                                                                 35800099
358100******************************************************************35810099
358200*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        35820099
358300*                                                                 35830099
358400*  THE TROUBLE ERROR LINE WILL PRINT IF THERE IS PO OR LINE       35840099
358500*  LEVEL TROUBLE.                                                 35850099
358600*                                                                 35860099
358700*  A REPRINT MESSAGE LINE WILL PRINT IF THE MARKING APRON HEADER  35870099
358800*  WAS PREVIOUSLY PRINTED (THE TIMESTAMP ON TRECEIV WAS PREVIOUSLY35880099
358900*  UPDATED).                                                      35890099
359000*                                                                 35900099
359100*  IF AN ERROR WAS ENCOUNTERED, THE PACK SLIP DETAIL WILL NOT     35910099
359200*  BE PRINTED AND ERROR MESSAGES WILL PRINT INSTEAD.              35920099
359300*                                                                 35930099
359400*  A 'STAMP' IS PRINTED AT THE BOTTOM OF EACH PAGE.               35940099
359500******************************************************************35950099
359600 6000-CREATE-HDR.                                                 35960099
359700                                                                  35970099
359800     PERFORM 6500-TOP-OF-HDR.                                     35980099
359900                                                                  35990099
360000     IF NOT PS-ERROR-PRINT                                        36000099
360100         IF PS-PRINT-INSTRUCTIONS                                 36010099
360200             PERFORM 6300-PROCESS-INSTRUCTIONS                    36020099
360300             MOVE SPACE             TO PS-PRINT-INSTRUCTIONS-SW   36030099
360400             IF PS-START-NEXT-PAGE                                36040099
360500                 ADD +1             TO PS-PAGE-SUB                36050099
360600                 PERFORM 6500-TOP-OF-HDR                          36060099
360700             END-IF                                               36070099
360800         ELSE                                                     36080099
360900             MOVE +1                TO  PS-DTL-LNE-SUB            36090099
361000         END-IF                                                   36100099
361100     END-IF.                                                      36110099
361200                                                                  36120099
361300     IF PS-ERROR-PRINT                                            36130099
361400        MOVE SPACES                  TO  DRS01-COMM-DATA          36140099
361500        MOVE PC-TRIPLE-SPACE         TO  DRS01-COMM-CTL           36150099
361600        PERFORM 8000-LINK-TO-DRS                                  36160099
361700        PERFORM 6010-MOVE-ERRORS                                  36170099
361800     ELSE                                                         36180099
361900        MOVE DH1-DETAIL-HEADING-LINE TO  DRS01-COMM-DATA          36190099
362000        MOVE PC-TRIPLE-SPACE         TO  DRS01-COMM-CTL           36200099
362100        PERFORM 8000-LINK-TO-DRS                                  36210099
362200* * *  IF WE'RE JUST STARTING TO PRINT THE PACK SLIP DETAIL       36220099
362300* * *  LINES, WE'RE USUALLY ONLY PRINTING A PARTIAL PAGE OF       36230099
362400* * *  THEM BECAUSE THE END OF PRINTING SPECIAL INSTRUCTIONS      36240099
362500* * *  HAS PROBABLY LEFT US IN THE MIDDLE OF THE PAGE SOMEWHERE.  36250099
362600* * *  PS-DTL-LNE-SUB WILL BE SET AFTER PRINTING OF THE           36260099
362700* * *  SPECIAL INSTRUCTIONS                                       36270099
362800*       IF PS-PAGE-SUB = PC-ONE                                   36280099
362900        IF PS-FIRST-PACK-SLIP-DETAIL                              36290099
363000           SET PS-PKSLIP-IDX TO PC-ONE                            36300099
363100           PERFORM 6020-PRINT-PKSLIP-LINE                         36310099
363200              VARYING PS-DTL-LNE-SUB                              36320099
363300              FROM PS-DTL-LNE-SUB BY 1                            36330099
363400              UNTIL PS-DTL-LNE-SUB > PV-PKSLIPS-PER-PAGE          36340099
363500                 OR PS-PKSLIP-IDX  > PV-STR-CNT                   36350099
363600           MOVE SPACE        TO PS-FIRST-PACK-SLIP-DETAIL-SW      36360099
363700        ELSE                                                      36370099
363800           SET PS-PKSLIP-IDX TO PV-PKSLIP-IDX                     36380099
363900           PERFORM 6020-PRINT-PKSLIP-LINE                         36390099
364000              VARYING PS-DTL-LNE-SUB                              36400099
364100              FROM 1 BY 1                                         36410099
364200              UNTIL PS-DTL-LNE-SUB > PV-PKSLIPS-PER-PAGE          36420099
364300                 OR PS-PKSLIP-IDX  > PV-STR-CNT                   36430099
364400        END-IF                                                    36440099
364500        IF PS-PKSLIP-IDX     > PV-STR-CNT                         36450099
364600           PERFORM 6030-PRINT-TOTAL-LINE                          36460099
364700           ADD +1 TO PS-DTL-LNE-SUB                               36470099
364800        END-IF                                                    36480099
364900        PERFORM 6400-CREATE-RPT-TRLR.                             36490099
365000                                                                  36500099
365100                                                                  36510099
365200 6010-MOVE-ERRORS.                                                36520099
365300                                                                  36530099
365400     MOVE PV-ERROR-MSG              TO DH2-MESSAGE.               36540099
365500     MOVE DH2-DETAIL-HEADING-LINE   TO DRS01-COMM-DATA.           36550099
365600     MOVE PC-TRIPLE-SPACE           TO DRS01-COMM-CTL.            36560099
365700     PERFORM 8000-LINK-TO-DRS.                                    36570099
365800* * *  END THE PERFORM OF PARAGRAPH 6000                          36580099
365900     COMPUTE PS-PAGE-SUB = PV-TOTAL-PAGES-REQ + 1.                36590099
366000                                                                  36600099
366100                                                                  36610099
366200 6020-PRINT-PKSLIP-LINE.                                          36620099
366300                                                                  36630099
366400     MOVE PS-PKSLIP-PKSL-NBR (PS-PKSLIP-IDX)                      36640099
366500                                     TO DL-PACK-SLIP.             36650099
366600     MOVE PS-PKSLIP-KEYD-BY (PS-PKSLIP-IDX)                       36660099
366700                                     TO DL-KEYED-BY.              36670099
366800     MOVE PS-PKSLIP-TRANS-BY (PS-PKSLIP-IDX)                      36680099
366900                                     TO DL-TRANS-BY.              36690099
367000     MOVE PS-PKSLIP-PKSL-PG-CNT (PS-PKSLIP-IDX)                   36700099
367100                                     TO DL-PAGES.                 36710099
367200     MOVE PS-TOT-COST-BY-STORE (PS-PKSLIP-IDX)                    36720099
367300                                     TO DL-TOTAL-COST.            36730099
367400     MOVE PS-TOT-RETAIL-BY-STORE (PS-PKSLIP-IDX)                  36740099
367500                                     TO DL-TOTAL-RETAIL.          36750099
367600     MOVE PS-PKSLIP-STR-DEST-NBR (PS-PKSLIP-IDX)                  36760099
367700                                     TO DL-STORE.                 36770099
367800     MOVE PS-PKSLIP-EXPTED-PKG-QTY (PS-PKSLIP-IDX)                36780099
367900                                     TO DL-CTN-PER-STORE.         36790099
368000     MOVE PS-PKITEM-PKSL-ITM-QTY (PS-PKSLIP-IDX)                  36800099
368100                                     TO DL-UNITS-PER-STORE.       36810099
368200                                                                  36820099
368300     MOVE DL1-DETAIL-LINE            TO  DRS01-COMM-DATA.         36830099
368400     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          36840099
368500     PERFORM 8000-LINK-TO-DRS.                                    36850099
368600                                                                  36860099
368700     SET PS-PKSLIP-IDX UP BY +1.                                  36870099
368800     SET PV-PKSLIP-IDX TO PS-PKSLIP-IDX.                          36880099
368900                                                                  36890099
369000                                                                  36900099
369100 6030-PRINT-TOTAL-LINE.                                           36910099
369200                                                                  36920099
369300     MOVE PV-TOT-CTN-QTY             TO  TL-CTN-QTY.              36930099
369400     MOVE PV-TOT-UNIT-QTY            TO  TL-UNIT-QTY.             36940099
369500                                                                  36950099
369600     MOVE TL1-TOTAL-LINE             TO  DRS01-COMM-DATA.         36960099
369700     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          36970099
369800     PERFORM 8000-LINK-TO-DRS.                                    36980099
369900                                                                  36990099
370000*                                                                 37000099
370100 6100-COUNT-RTV-DISTROS.                                          37010099
370200                                                                  37020099
370300     MOVE ZERO TO PV-COUNT.                                       37030099
370400                                                                  37040099
370500     EXEC SQL                                                     37050099
370600          SELECT  COUNT(*)                                        37060099
370700            INTO  :PV-COUNT                                       37070099
370800            FROM  TRECDIS A                                       37080099
370900                , XLT_LOC B                                       37090099
371000           WHERE A.ORD_NBR           =  :DK-ORD-NBR               37100099
371100             AND A.REC_SEQ_NBR       =  :DK-REC-SEQ-NBR           37110099
371200             AND A.OPER_UNT_ID       =  :DK-OPER-UNT-ID           37120099
371300             AND A.FCLTY_ID          =  :DK-FCLTY-ID              37130099
371500             AND A.EXPTED_ITM_QTY    >  :PC-ZERO                  37150099
371600             AND A.STR_NBR           =  B.LOC_NBR                 37160099
371700             AND B.LOC_TYP_CDE     IN (:PC-DC, :PC-RV)            37170099
371800     END-EXEC.                                                    37180099
371900                                                                  37190099
372000     EVALUATE TRUE                                                37200099
372100         WHEN SQLCODE = ZERO                                      37210099
372200             CONTINUE                                             37220099
372300         WHEN SQLWARN0 NOT = SPACE                                37230099
372400         WHEN SQLCODE < ZERO                                      37240099
372500         WHEN SQLCODE > ZERO                                      37250099
372600             MOVE '6100-COUNT-RTV-DISTROS'                        37260099
372700                 TO DP013-PARAGRAPH                               37270099
372800             MOVE 'SELECT A COUNT OR RTV DISTROS'                 37280099
372900                 TO DP013-MESSAGE-TEXT (1)                        37290099
373000             MOVE SQLCA            TO DP013-SQLCA                 37300099
373100             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    37310099
373200             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (2)    37320099
373300             SET DP013-DB2-ABEND                                  37330099
373400                 DP013-NO-ROLLBACK TO TRUE                        37340099
373500             PERFORM DP013-0000-PROCESS-ABEND                     37350099
373600     END-EVALUATE.                                                37360099
373700                                                                  37370099
373800 6200-PRINT-DISTRO-LINES.                                         37380099
373900     PERFORM 6210-OPEN-LINE-CURSOR.                               37390099
374000     PERFORM 6220-FETCH-LINE-CURSOR.                              37400099
374100     PERFORM 6230-PROCESS-LINE-CURSOR                             37410099
374200         UNTIL PS-EOF-LINE-CSR OR                                 37420099
374300               PS-ERROR-PRINT.                                    37430099
374400     PERFORM 6240-CLOSE-LINE-CURSOR.                              37440099
374500                                                                  37450099
374600 6210-OPEN-LINE-CURSOR.                                           37460099
374700     EXEC SQL                                                     37470099
374800         OPEN LINE-CSR                                            37480099
374900     END-EXEC.                                                    37490099
375000                                                                  37500099
375100     EVALUATE TRUE                                                37510099
375200         WHEN SQLCODE = ZERO                                      37520099
375300             CONTINUE                                             37530099
375400         WHEN SQLCODE = -904                                      37540099
375500         WHEN SQLCODE = -911                                      37550099
375600         WHEN SQLCODE = -913                                      37560099
375700             IF PS-CONTENTION                                     37570099
375800                CONTINUE                                          37580099
375900             ELSE                                                 37590099
376000                SET PS-ERROR-PRINT   TO TRUE                      37600099
376100                SET PS-CONTENTION    TO TRUE                      37610099
376200                STRING PC-CONTENTION-MSG PC-ASTERISKS             37620099
376300                   DELIMITED BY SIZE                              37630099
376400                   INTO PV-ERROR-MSG                              37640099
376500                MOVE '6210-OPEN-LINE-CURSOR'                      37650099
376600                                     TO DP013-PARAGRAPH           37660099
376700                MOVE PRV-18A TO DP013-MESSAGE-TEXT (1)            37670099
376800                PERFORM 9000-RETURN-MSG                           37680099
376900                MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)    37690099
377000                MOVE 'TRECDIS'       TO DP013-DB2-TABLE-NAME (1)  37700099
377100                MOVE 'XLT_LOC'       TO DP013-DB2-TABLE-NAME (2)  37710099
377200                MOVE SQLCA TO DP013-SQLCA                         37720099
377300                SET DP013-DB2-ABEND                               37730099
377400                    DP013-NO-ROLLBACK TO TRUE                     37740099
377500                PERFORM DP013-0000-PROCESS-ABEND                  37750099
377600              END-IF                                              37760099
377700         WHEN SQLWARN0 NOT = SPACE                                37770099
377800         WHEN SQLCODE < ZERO                                      37780099
377900         WHEN SQLCODE > ZERO                                      37790099
378000               SET PS-ERROR-PRINT   TO TRUE                       37800099
378100               STRING PC-TRBL-CSR-MSG PC-ASTERISKS                37810099
378200                  DELIMITED BY SIZE                               37820099
378300                  INTO PV-ERROR-MSG                               37830099
378400                MOVE '6210-OPEN-LINE-CURSOR'                      37840099
378500                                    TO DP013-PARAGRAPH            37850099
378600               MOVE PRV-18A         TO DP013-MESSAGE-TEXT (1)     37860099
378700               PERFORM 9000-RETURN-MSG                            37870099
378800               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     37880099
378900               MOVE SQLCA           TO DP013-SQLCA                37890099
379000               MOVE 'TRECDIS'       TO DP013-DB2-TABLE-NAME (1)   37900099
379100               MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (2)   37910099
379200               SET DP013-DB2-ABEND                                37920099
379300                   DP013-NO-ROLLBACK TO TRUE                      37930099
379400               PERFORM DP013-0000-PROCESS-ABEND                   37940099
379500     END-EVALUATE.                                                37950099
379600 6220-FETCH-LINE-CURSOR.                                          37960099
379700                                                                  37970099
379800     EXEC SQL                                                     37980099
379900         FETCH  LINE-CSR                                          37990099
380000          INTO  :RECDIS-ORD-LNE-NBR                               38000099
380100     END-EXEC.                                                    38010099
380200                                                                  38020099
380300     EVALUATE TRUE                                                38030099
380400         WHEN SQLCODE = ZERO                                      38040099
380500             CONTINUE                                             38050099
380600         WHEN SQLCODE = +100                                      38060099
380700             SET PS-EOF-LINE-CSR TO TRUE                          38070099
380800         WHEN SQLCODE = -904                                      38080099
380900         WHEN SQLCODE = -911                                      38090099
381000         WHEN SQLCODE = -913                                      38100099
381100             IF PS-CONTENTION                                     38110099
381200              CONTINUE                                            38120099
381300             ELSE                                                 38130099
381400               SET PS-ERROR-PRINT  TO TRUE                        38140099
381500               SET PS-CONTENTION   TO TRUE                        38150099
381600               STRING PC-CONTENTION-MSG PC-ASTERISKS              38160099
381700                  DELIMITED BY SIZE                               38170099
381800                  INTO PV-ERROR-MSG                               38180099
381900               MOVE '6220-FETCH-LINE-CURSOR'                      38190099
382000                                   TO DP013-PARAGRAPH             38200099
382100               MOVE PRV-18B        TO DP013-MESSAGE-TEXT (1)      38210099
382200               PERFORM 9000-RETURN-MSG                            38220099
382300               MOVE PV-DISPLAY-KEYS                               38230099
382400                                   TO DP013-MESSAGE-TEXT (2)      38240099
382500               MOVE SQLCA          TO DP013-SQLCA                 38250099
382600               MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)    38260099
382700               MOVE 'XLT_LOC'      TO DP013-DB2-TABLE-NAME (2)    38270099
382800               SET DP013-DB2-ABEND                                38280099
382900                   DP013-NO-ROLLBACK TO TRUE                      38290099
383000               PERFORM DP013-0000-PROCESS-ABEND                   38300099
383100             END-IF                                               38310099
383200         WHEN SQLWARN0 NOT = SPACE                                38320099
383300         WHEN SQLCODE < ZERO                                      38330099
383400         WHEN SQLCODE > ZERO                                      38340099
383500               SET PS-ERROR-PRINT    TO TRUE                      38350099
383600               STRING PC-TRBL-CSR-MSG PC-ASTERISKS                38360099
383700                  DELIMITED BY SIZE                               38370099
383800                  INTO PV-ERROR-MSG                               38380099
383900               MOVE '6220-FETCH-LINE-CURSOR'                      38390099
384000                                     TO DP013-PARAGRAPH           38400099
384100               MOVE PRV-18B          TO DP013-MESSAGE-TEXT (1)    38410099
384200               PERFORM 9000-RETURN-MSG                            38420099
384300               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    38430099
384400               MOVE SQLCA            TO DP013-SQLCA               38440099
384500               MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (1)    38450099
384600               MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (2)    38460099
384700               SET DP013-DB2-ABEND                                38470099
384800                   DP013-NO-ROLLBACK TO TRUE                      38480099
384900               PERFORM DP013-0000-PROCESS-ABEND                   38490099
385000     END-EVALUATE.                                                38500099
385100                                                                  38510099
385200 6230-PROCESS-LINE-CURSOR.                                        38520099
385300                                                                  38530099
385400     MOVE 1 TO  PV-RTV-INDX.                                      38540099
385500     PERFORM 6235-PROCESS-LINE-CURSOR                             38550099
385600         VARYING PV-INDX FROM 1 BY 1                              38560099
385700         UNTIL PS-EOF-LINE-CSR.                                   38570099
385800     IF PV-COUNT < 61                                             38580099
385900         MOVE RT2-RTV-DISTRO-LINE-2  TO  DRS01-COMM-DATA          38590099
386000         PERFORM 8000-LINK-TO-DRS                                 38600099
386100         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       38610099
386200     END-IF.                                                      38620099
386300                                                                  38630099
386400 6235-PROCESS-LINE-CURSOR.                                        38640099
386500     IF PV-INDX < 61                                              38650099
386600         IF PV-INDX = 16                                          38660099
386700             MOVE RT2-RTV-DISTRO-LINE-2 TO DRS01-COMM-DATA        38670099
386800             PERFORM 8000-LINK-TO-DRS                             38680099
386900             MOVE PC-SINGLE-SPACE       TO  DRS01-COMM-CTL        38690099
387000             MOVE SPACES                     TO RT2-DISTRO-HEADING38700099
387100             MOVE 1 TO  PV-RTV-INDX                               38710099
387200         ELSE                                                     38720099
387300             IF (PV-INDX = 31 OR PV-INDX = 46)                    38730099
387400                 MOVE RT2-RTV-DISTRO-LINE-2 TO DRS01-COMM-DATA    38740099
387500                 PERFORM 8000-LINK-TO-DRS                         38750099
387600                 MOVE PC-SINGLE-SPACE       TO  DRS01-COMM-CTL    38760099
387700                 MOVE 1 TO  PV-RTV-INDX                           38770099
387800             END-IF                                               38780099
387900         END-IF                                                   38790099
388000         MOVE RECDIS-ORD-LNE-NBR  TO RT2-RTV-LINE (PV-RTV-INDX)   38800099
388100         MOVE PC-COMMA            TO RT2-RTV-COMMA (PV-RTV-INDX)  38810099
388200         ADD 1 TO  PV-RTV-INDX                                    38820099
388300     END-IF.                                                      38830099
388400     MOVE RECDIS-ORD-LNE-NBR  TO CA-LINE-NBR (PV-INDX).           38840099
388500     PERFORM 6220-FETCH-LINE-CURSOR.                              38850099
388600                                                                  38860099
388700                                                                  38870099
388800 6240-CLOSE-LINE-CURSOR.                                          38880099
388900     EXEC SQL                                                     38890099
389000         CLOSE LINE-CSR                                           38900099
389100     END-EXEC.                                                    38910099
389200                                                                  38920099
389300     EVALUATE TRUE                                                38930099
389400         WHEN SQLCODE = ZERO                                      38940099
389500         WHEN SQLCODE = -501                                      38950099
389600             CONTINUE                                             38960099
389700         WHEN SQLCODE = -904                                      38970099
389800         WHEN SQLCODE = -911                                      38980099
389900         WHEN SQLCODE = -913                                      38990099
390000             IF PS-CONTENTION                                     39000099
390100              CONTINUE                                            39010099
390200             ELSE                                                 39020099
390300               SET PS-ERROR-PRINT    TO TRUE                      39030099
390400               SET PS-CONTENTION     TO TRUE                      39040099
390500               STRING PC-CONTENTION-MSG PC-ASTERISKS              39050099
390600                  DELIMITED BY SIZE                               39060099
390700                  INTO PV-ERROR-MSG                               39070099
390800               MOVE '6240-CLOSE-LINE-CURSOR'                      39080099
390900                                     TO DP013-PARAGRAPH           39090099
391000               MOVE PRV-18C          TO DP013-MESSAGE-TEXT (1)    39100099
391100               PERFORM 9000-RETURN-MSG                            39110099
391200               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    39120099
391300               MOVE SQLCA            TO DP013-SQLCA               39130099
391400               MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)  39140099
391500               MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (2)  39150099
391600               SET DP013-DB2-ABEND                                39160099
391700                   DP013-NO-ROLLBACK TO TRUE                      39170099
391800               PERFORM DP013-0000-PROCESS-ABEND                   39180099
391900            END-IF                                                39190099
392000         WHEN SQLWARN0 NOT = SPACE                                39200099
392100         WHEN SQLCODE < ZERO                                      39210099
392200         WHEN SQLCODE > ZERO                                      39220099
392300             SET PS-ERROR-PRINT    TO TRUE                        39230099
392400             STRING PC-TRBL-CSR-MSG PC-ASTERISKS                  39240099
392500                DELIMITED BY SIZE                                 39250099
392600                INTO PV-ERROR-MSG                                 39260099
392700             MOVE '6240-CLOSE-LINE-CURSOR'                        39270099
392800                                   TO DP013-PARAGRAPH             39280099
392900             MOVE PRV-18C          TO DP013-MESSAGE-TEXT (1)      39290099
393000             PERFORM 9000-RETURN-MSG                              39300099
393100             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      39310099
393200             MOVE SQLCA            TO DP013-SQLCA                 39320099
393300             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    39330099
393400             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (2)    39340099
393500             SET DP013-DB2-ABEND                                  39350099
393600                 DP013-NO-ROLLBACK TO TRUE                        39360099
393700             PERFORM DP013-0000-PROCESS-ABEND                     39370099
393800     END-EVALUATE.                                                39380099
393900                                                                  39390099
394000 6300-PROCESS-INSTRUCTIONS.                                       39400099
394100     MOVE ZERO                   TO PV-INSTR-COUNT                39410099
394200     MOVE DL4-DETAIL-LINE        TO  DRS01-COMM-DATA              39420099
394300     MOVE PC-TRIPLE-SPACE        TO  DRS01-COMM-CTL               39430099
394400     PERFORM 8000-LINK-TO-DRS                                     39440099
394500     MOVE DL5-DETAIL-LINE        TO  DRS01-COMM-DATA              39450099
394600     MOVE PC-SINGLE-SPACE        TO  DRS01-COMM-CTL               39460099
394700     PERFORM 8000-LINK-TO-DRS                                     39470099
394800     ADD +4                      TO  PV-INSTR-COUNT               39480099
394900     PERFORM 6320-OPEN-INSTR-CURSOR                               39490099
395000     IF PS-ERROR-PRINT                                            39500099
395100         CONTINUE                                                 39510099
395200     ELSE                                                         39520099
395300         PERFORM 6330-PRINT-INSTRUCTIONS                          39530099
395400             UNTIL PS-INSTRUCTIONS-DONE                           39540099
395500     END-IF                                                       39550099
395600     PERFORM 6340-CLOSE-INSTR-CURSOR                              39560099
395700     MOVE DL7-DETAIL-LINE        TO  DRS01-COMM-DATA              39570099
395800     MOVE PC-SINGLE-SPACE        TO  DRS01-COMM-CTL               39580099
395900     PERFORM 8000-LINK-TO-DRS                                     39590099
396000     ADD +1                      TO  PV-INSTR-COUNT               39600099
396100     IF PS-ERROR-PRINT                                            39610099
396200         MOVE PC-INSTRUCTION-ERROR-MSG                            39620099
396300                                     TO  DL-INSTRUCTION           39630099
396400         MOVE DL6-DETAIL-LINE        TO  DRS01-COMM-DATA          39640099
396500         MOVE PC-SINGLE-SPACE        TO  DRS01-COMM-CTL           39650099
396600         PERFORM 8000-LINK-TO-DRS                                 39660099
396700         ADD +1                      TO  PV-INSTR-COUNT           39670099
396800     END-IF.                                                      39680099
396900     IF PS-START-NEXT-PAGE                                        39690099
397000         MOVE +1                     TO  PS-DTL-LNE-SUB           39700099
397100     ELSE                                                         39710099
397200         PERFORM 6350-SWITCH-TO-PACK-SLIP-COUNT                   39720099
397300     END-IF.                                                      39730099
397400                                                                  39740099
397500                                                                  39750099
397600 6320-OPEN-INSTR-CURSOR.                                          39760099
397700     EXEC SQL                                                     39770099
397800         OPEN INST-CSR                                            39780099
397900     END-EXEC.                                                    39790099
398000                                                                  39800099
398100     EVALUATE TRUE                                                39810099
398200         WHEN SQLCODE = +0                                        39820099
398300             CONTINUE                                             39830099
398400         WHEN SQLCODE = -904                                      39840099
398500         WHEN SQLCODE = -911                                      39850099
398600         WHEN SQLCODE = -913                                      39860099
398700            IF PS-CONTENTION                                      39870099
398800               CONTINUE                                           39880099
398900            ELSE                                                  39890099
399000               SET PS-CONTENTION     TO TRUE                      39900099
399100               SET PS-ERROR-PRINT    TO TRUE                      39910099
399200               STRING PC-CONTENTION-MSG PC-ASTERISKS              39920099
399300                  DELIMITED BY SIZE                               39930099
399400                  INTO PV-ERROR-MSG                               39940099
399500               MOVE '6320-OPEN-INSTR-CURSOR'                      39950099
399600                                     TO DP013-PARAGRAPH           39960099
399700               MOVE PRV-23A          TO DP013-MESSAGE-TEXT (1)    39970099
399800               PERFORM 9000-RETURN-MSG                            39980099
399900               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    39990099
400000               MOVE SQLCA            TO DP013-SQLCA               40000099
400100               MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)  40010099
400200               MOVE 'TINRCCD'        TO DP013-DB2-TABLE-NAME (2)  40020099
400300               MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (3)  40030099
400400               SET DP013-DB2-ABEND                                40040099
400500                   DP013-NO-ROLLBACK TO TRUE                      40050099
400600               PERFORM DP013-0000-PROCESS-ABEND                   40060099
400700            END-IF                                                40070099
400800         WHEN SQLWARN NOT = SPACE                                 40080099
400900         WHEN SQLCODE NOT = +0                                    40090099
401000             SET PS-ERROR-PRINT    TO TRUE                        40100099
401100             STRING PC-INSTRUCTION-ERROR-MSG PC-ASTERISKS         40110099
401200                DELIMITED BY SIZE                                 40120099
401300                INTO PV-ERROR-MSG                                 40130099
401400             MOVE '6320-OPEN-INSTR-CURSOR'                        40140099
401500                                  TO DP013-PARAGRAPH              40150099
401600             MOVE PRV-23A          TO DP013-MESSAGE-TEXT (1)      40160099
401700             PERFORM 9000-RETURN-MSG                              40170099
401800             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      40180099
401900             MOVE SQLCA            TO DP013-SQLCA                 40190099
402000             MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)    40200099
402100             MOVE 'TINRCCD'        TO DP013-DB2-TABLE-NAME (2)    40210099
402200             MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (3)    40220099
402300             SET DP013-DB2-ABEND                                  40230099
402400                 DP013-NO-ROLLBACK TO TRUE                        40240099
402500             PERFORM DP013-0000-PROCESS-ABEND                     40250099
402600     END-EVALUATE.                                                40260099
402700                                                                  40270099
402800 6330-PRINT-INSTRUCTIONS.                                         40280099
402900     EXEC SQL                                                     40290099
403000         FETCH INST-CSR                                           40300099
403100         INTO  :INSTCD-INSTR-DESC,                                40310099
403200               :INSTCD-INSTR-NBR,                                 40320099
403300               :INRCCD-RECIP-CDE,                                 40330099
403400               :INRCCD-RECIP-DESC                                 40340099
403500     END-EXEC.                                                    40350099
403600                                                                  40360099
403700     EVALUATE TRUE                                                40370099
403800         WHEN SQLCODE = +0                                        40380099
403900             CONTINUE                                             40390099
404000         WHEN SQLCODE = +100                                      40400099
404100             SET PS-INSTRUCTIONS-DONE TO TRUE                     40410099
404200         WHEN SQLCODE = -904                                      40420099
404300         WHEN SQLCODE = -911                                      40430099
404400         WHEN SQLCODE = -913                                      40440099
404500            IF PS-CONTENTION                                      40450099
404600               CONTINUE                                           40460099
404700            ELSE                                                  40470099
404800               SET PS-ERROR-PRINT    TO TRUE                      40480099
404900               STRING PC-CONTENTION-MSG PC-ASTERISKS              40490099
405000                  DELIMITED BY SIZE                               40500099
405100                  INTO PV-ERROR-MSG                               40510099
405200               MOVE '6330-PRINT-INSTRUCTIONS'                     40520099
405300                                     TO DP013-PARAGRAPH           40530099
405400               MOVE PRV-23B          TO DP013-MESSAGE-TEXT (1)    40540099
405500               PERFORM 9000-RETURN-MSG                            40550099
405600               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    40560099
405700               MOVE SQLCA            TO DP013-SQLCA               40570099
405800               MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)  40580099
405900               MOVE 'TINRCCD'        TO DP013-DB2-TABLE-NAME (2)  40590099
406000               MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (3)  40600099
406100               SET DP013-DB2-ABEND                                40610099
406200                   DP013-NO-ROLLBACK TO TRUE                      40620099
406300               PERFORM DP013-0000-PROCESS-ABEND                   40630099
406400            END-IF                                                40640099
406500         WHEN SQLWARN NOT = SPACE                                 40650099
406600         WHEN SQLCODE NOT = +0                                    40660099
406700         WHEN SQLCODE NOT = +100                                  40670099
406800             SET PS-ERROR-PRINT    TO TRUE                        40680099
406900             STRING PC-INSTRUCTION-ERROR-MSG PC-ASTERISKS         40690099
407000                DELIMITED BY SIZE                                 40700099
407100                INTO PV-ERROR-MSG                                 40710099
407200             MOVE '6330-PRINT-INSTRUCTIONS'                       40720099
407300                                  TO DP013-PARAGRAPH              40730099
407400             MOVE PRV-23B          TO DP013-MESSAGE-TEXT (1)      40740099
407500             PERFORM 9000-RETURN-MSG                              40750099
407600             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      40760099
407700             MOVE SQLCA            TO DP013-SQLCA                 40770099
407800             MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)    40780099
407900             MOVE 'TINRCCD'        TO DP013-DB2-TABLE-NAME (2)    40790099
408000             MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (3)    40800099
408100             SET DP013-DB2-ABEND                                  40810099
408200                 DP013-NO-ROLLBACK TO TRUE                        40820099
408300             PERFORM DP013-0000-PROCESS-ABEND                     40830099
408400     END-EVALUATE.                                                40840099
408500                                                                  40850099
408600     IF PS-INSTRUCTIONS-NOT-DONE                                  40860099
408700         ADD +3                    TO PV-INSTR-COUNT              40870099
408800         IF PV-INSTR-COUNT > PC-INSTR-PER-PAGE                    40880099
408900             ADD +1                TO PS-PAGE-SUB                 40890099
409000             MOVE +7               TO  PV-INSTR-COUNT             40900099
409100             PERFORM 6500-TOP-OF-HDR                              40910099
409200             MOVE SPACES           TO  DRS01-COMM-DATA            40920099
409300             MOVE PC-TRIPLE-SPACE  TO  DRS01-COMM-CTL             40930099
409400             PERFORM 8000-LINK-TO-DRS                             40940099
409500             MOVE PC-CONTINUED-MSG TO  DL4-CONTINUED-MSG          40950099
409600             MOVE DL4-DETAIL-LINE  TO  DRS01-COMM-DATA            40960099
409700             MOVE PC-TRIPLE-SPACE  TO  DRS01-COMM-CTL             40970099
409800             PERFORM 8000-LINK-TO-DRS                             40980099
409900             MOVE DL5-DETAIL-LINE  TO  DRS01-COMM-DATA            40990099
410000             MOVE PC-SINGLE-SPACE  TO  DRS01-COMM-CTL             41000099
410100             PERFORM 8000-LINK-TO-DRS                             41010099
410200         END-IF                                                   41020099
410300         MOVE INSTCD-INSTR-DESC    TO PV-INSTRUCTION              41030099
410400         MOVE INRCCD-RECIP-DESC    TO DL-RECIPIENT                41040099
410500         MOVE PV-INSTR-PART1       TO DL-INSTRUCTION              41050099
410600         MOVE DL6-DETAIL-LINE      TO DRS01-COMM-DATA             41060099
410700         MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              41070099
410800         PERFORM 8000-LINK-TO-DRS                                 41080099
410900         MOVE SPACES               TO DL-RECIPIENT                41090099
411000         MOVE PV-INSTR-PART2       TO DL-INSTRUCTION              41100099
411100         MOVE DL6-DETAIL-LINE      TO DRS01-COMM-DATA             41110099
411200         PERFORM 8000-LINK-TO-DRS                                 41120099
411300         MOVE PV-INSTR-PART3       TO DL-INSTRUCTION              41130099
411400         MOVE DL6-DETAIL-LINE      TO DRS01-COMM-DATA             41140099
411500         PERFORM 8000-LINK-TO-DRS                                 41150099
411600     END-IF.                                                      41160099
411700                                                                  41170099
411800 6340-CLOSE-INSTR-CURSOR.                                         41180099
411900     EXEC SQL                                                     41190099
412000         CLOSE INST-CSR                                           41200099
412100     END-EXEC.                                                    41210099
412200                                                                  41220099
412300     EVALUATE TRUE                                                41230099
412400         WHEN SQLCODE = +0                                        41240099
412500             CONTINUE                                             41250099
412600         WHEN SQLCODE = -904                                      41260099
412700         WHEN SQLCODE = -911                                      41270099
412800         WHEN SQLCODE = -913                                      41280099
412900            IF PS-CONTENTION                                      41290099
413000               CONTINUE                                           41300099
413100            ELSE                                                  41310099
413200                SET PS-ERROR-PRINT    TO TRUE                     41320099
413300                STRING PC-CONTENTION-MSG PC-ASTERISKS             41330099
413400                   DELIMITED BY SIZE                              41340099
413500                   INTO PV-ERROR-MSG                              41350099
413600               MOVE '6340-CLOSE-INSTR-CURSOR'                     41360099
413700                                     TO DP013-PARAGRAPH           41370099
413800               MOVE PRV-23C          TO DP013-MESSAGE-TEXT (1)    41380099
413900               PERFORM 9000-RETURN-MSG                            41390099
414000               MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)    41400099
414100               MOVE SQLCA            TO DP013-SQLCA               41410099
414200               MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)  41420099
414300               MOVE 'TINRCCD'        TO DP013-DB2-TABLE-NAME (2)  41430099
414400               MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (3)  41440099
414500               SET DP013-DB2-ABEND                                41450099
414600                   DP013-NO-ROLLBACK TO TRUE                      41460099
414700               PERFORM DP013-0000-PROCESS-ABEND                   41470099
414800            END-IF                                                41480099
414900         WHEN SQLWARN NOT = SPACE                                 41490099
415000         WHEN SQLCODE NOT = +0                                    41500099
415100             SET PS-ERROR-PRINT    TO TRUE                        41510099
415200             STRING PC-INSTRUCTION-ERROR-MSG PC-ASTERISKS         41520099
415300                DELIMITED BY SIZE                                 41530099
415400                INTO PV-ERROR-MSG                                 41540099
415500             MOVE '6340-CLOSE-INSTR-CURSOR'                       41550099
415600                                  TO DP013-PARAGRAPH              41560099
415700             MOVE PRV-23C          TO DP013-MESSAGE-TEXT (1)      41570099
415800             PERFORM 9000-RETURN-MSG                              41580099
415900             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      41590099
416000             MOVE SQLCA            TO DP013-SQLCA                 41600099
416100             MOVE 'TPOINST'        TO DP013-DB2-TABLE-NAME (1)    41610099
416200             MOVE 'TINRCCD'        TO DP013-DB2-TABLE-NAME (2)    41620099
416300             MOVE 'TINSTCD'        TO DP013-DB2-TABLE-NAME (3)    41630099
416400             SET DP013-DB2-ABEND                                  41640099
416500                 DP013-NO-ROLLBACK TO TRUE                        41650099
416600             PERFORM DP013-0000-PROCESS-ABEND                     41660099
416700     END-EVALUATE.                                                41670099
416800 6350-SWITCH-TO-PACK-SLIP-COUNT.                                  41680099
416900* * * THE FOLLOWING CALCULATION IS TO MAINTAIN A PROPER VALUE     41690099
417000* * * IN PS-DTL-LNE-SUB, AND PROPER PRINT POSITION ON THE PAGE.   41700099
417100* * * THIS NEEDS TO BE DONE FOR THE CORRECT PRINTING OF THE       41710099
417200* * * PACK SLIP DETAIL LINES.  IN PACK SLIP PRINTING              41720099
417300* * * PS-DTL-LNE-SUB IS ONLY INCREMENTED BY 1 FOR EVERY 2         41730099
417400* * * PRINT LINES USED.                                           41740099
417500     DIVIDE PV-INSTR-COUNT BY 2 GIVING PV-INSTR-COUNT             41750099
417600                             REMAINDER PV-REMAINDER               41760099
417700     IF PV-REMAINDER NOT = ZERO                                   41770099
417800         ADD +1                  TO PV-INSTR-COUNT                41780099
417900         MOVE PV-INSTR-COUNT     TO PS-DTL-LNE-SUB                41790099
418000         MOVE SPACES             TO DRS01-COMM-DATA               41800099
418100         MOVE PC-SINGLE-SPACE    TO DRS01-COMM-CTL                41810099
418200         PERFORM 8000-LINK-TO-DRS                                 41820099
418300     ELSE                                                         41830099
418400         MOVE PV-INSTR-COUNT     TO PS-DTL-LNE-SUB                41840099
418500     END-IF.                                                      41850099
418600* * * ADD 1 BECAUSE PS-DTL-LNE-SUB IS ACTUALLY 1 HIGHER THAN      41860099
418700* * * THE ACTUAL LINES PRINTED.                                   41870099
418800     ADD +1                  TO PS-DTL-LNE-SUB.                   41880099
418900                                                                  41890099
419000 6400-CREATE-RPT-TRLR.                                            41900099
419100                                                                  41910099
419200*    IF PS-DTL-LNE-SUB < PV-PKSLIPS-PER-PAGE                      41920099
419300     IF PS-DTL-LNE-SUB NOT > PV-PKSLIPS-PER-PAGE                  41930099
419400        COMPUTE PV-LINE-LEFT =                                    41940099
419500                   PV-PKSLIPS-PER-PAGE - PS-DTL-LNE-SUB           41950099
419600        PERFORM 6410-LINE-CNTL                                    41960099
419700           VARYING PS-DTL-LNE-SUB                                 41970099
419800           FROM PS-DTL-LNE-SUB BY 1                               41980099
419900           UNTIL PS-DTL-LNE-SUB > PV-PKSLIPS-PER-PAGE.            41990099
420000                                                                  42000099
420100     MOVE SPACES                     TO  DRS01-COMM-DATA.         42010099
420200     MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          42020099
420300     PERFORM 8000-LINK-TO-DRS.                                    42030099
420400                                                                  42040099
420500     MOVE DL2-DETAIL-LINE            TO  DRS01-COMM-DATA.         42050099
420600     MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          42060099
420700     PERFORM 8000-LINK-TO-DRS.                                    42070099
420800                                                                  42080099
420900     MOVE DL8-DETAIL-LINE            TO  DRS01-COMM-DATA.         42090099
421000     MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          42100099
421100     PERFORM 8000-LINK-TO-DRS.                                    42110099
421200                                                                  42120099
421300     MOVE DL3-DETAIL-LINE            TO  DRS01-COMM-DATA.         42130099
421400     MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          42140099
421500     PERFORM 8000-LINK-TO-DRS.                                    42150099
421600                                                                  42160099
421700 6410-LINE-CNTL.                                                  42170099
421800                                                                  42180099
421900     MOVE SPACES                     TO  DRS01-COMM-DATA.         42190099
422000     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          42200099
422100     PERFORM 8000-LINK-TO-DRS.                                    42210099
422200                                                                  42220099
422300 6500-TOP-OF-HDR.                                                 42230099
422400     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         42240099
422500                                                                  42250099
422600     SET PS-TOP-OF-PAGE-NOT-SET      TO TRUE.                     42260099
422700                                                                  42270099
422800     IF PV-SHIPMENTS-CNT > 1                                      42280099
422900        STRING PC-ASTERISKS PC-MULT-SHIPS-MSG PC-ASTERISKS        42290099
423000            DELIMITED BY SIZE                                     42300099
423100            INTO TL3-MULT-SHIPS.                                  42310099
423200                                                                  42320099
423300     MOVE PV-LINE-TRBL-CNT           TO  TL3-NBR-LINES-IN-TRBL.   42330099
423400     MOVE PV-PACK-TRBL-CNT           TO  TL3-NBR-PACKS-IN-TRBL.   42340099
423500                                                                  42350099
423600     MOVE 1                          TO  HL1-RPT-NBR.             42360099
423700                                                                  42370099
423800     MOVE PS-PAGE-SUB                TO  HL1-PGE-NBR.             42380099
423900     MOVE PV-TOTAL-PAGES-REQ         TO  HL1-PGE-NBR2.            42390099
424000                                                                  42400099
424100     MOVE PC-CURRENT-PROGRAM-NAME    TO  HL1-PGM-NME.             42410099
424200     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           42420099
424300     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             42430099
424400     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            42440099
424500     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            42450099
424600     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          42460099
424700                                                                  42470099
424800     MOVE CA-OPERATING-ID            TO  HL3-OPERATING-ID.        42480099
424900     MOVE CA-FACILITY-ID             TO  HL3-FACILITY-ID.         42490099
425000     MOVE CA-USER-ID                 TO  HL3-ARCHIVED-BY.         42500099
425100     MOVE CA-ORD-NBR-X               TO  HL3-PO-NBR.              42510099
425200     MOVE CA-RCVR-SEQ-NBR-X          TO  HL3-REC-SEQ-NBR.         42520099
425300                                                                  42530099
425400     MOVE PURCHS-DEPT-NBR            TO  HL3-DEPT-NBR.            42540099
425500     MOVE ENTNME-ENT-NAME-DESC       TO  HL3-VENDOR-NAME.         42550099
425600     MOVE RECEIV-EXPTED-CART-CNT     TO  HL3-EXPT-CARTONS.        42560099
425700     MOVE RECEIV-ACTL-CART-CNT       TO  HL3-ADJ-CARTONS.         42570099
425800                                                                  42580099
425900     IF RECEIV-REC-TMST = SPACES                                  42590099
426000        CONTINUE                                                  42600099
426100     ELSE                                                         42610099
426200        IF RECEIV-REC-TMST = PC-DB2-DUMMY-DATE-TIME               42620099
426300           MOVE 'ENROUTE'            TO  HL3-ARRIVED-DATE         42630099
426400        ELSE                                                      42640099
426500           MOVE RECEIV-REC-TMST      TO  PV-REC-TMST              42650099
426600           MOVE PV-REC-MM            TO  PV-ARRIVED-MM            42660099
426700           MOVE PV-REC-DD            TO  PV-ARRIVED-DD            42670099
426800           MOVE PV-REC-YY            TO  PV-ARRIVED-YY            42680099
426900           MOVE PV-ARRIVED-DATE      TO  HL3-ARRIVED-DATE.        42690099
427000                                                                  42700099
427100     MOVE CA-PRINTER-DESTINATION     TO  HL5-PRINTER-ID.          42710099
427200     MOVE RECEIV-APRON-LOC-DESC      TO  HL5-APRON-LOC.           42720099
427300                                                                  42730099
427400     IF DN-VEH-NBR = -1                                           42740099
427500        MOVE SPACES                  TO  HL5-TRAILER              42750099
427600     ELSE                                                         42760099
427700        MOVE VHTRIP-VEH-NBR          TO  HL5-TRAILER.             42770099
427800                                                                  42780099
427900     MOVE VHTRIP-TRIP-ID             TO  HL5-TRIP-ID.             42790099
428000                                                                  42800099
428100     MOVE SHIPMT-PRO-SCAC-ID         TO  HL5-SCAC.                42810099
428200     MOVE SHIPMT-PRO-NBR             TO  HL5-FOB.                 42820099
428300     MOVE SHIPMT-BOL-NBR             TO  HL5-BOL.                 42830099
428400     PERFORM 4140-GET-AD-DATE.                                    42840099
428500                                                                  42850099
428600     EVALUATE                                                     42860099
428700              RECEIV-AD-INFO-DESC                                 42870099
428800         WHEN '1'                                                 42880099
428900             MOVE 'HOT '         TO                               42890099
429000                                    HL7-AD-DATE-INFO              42900099
429100         WHEN '2'                                                 42910099
429200             MOVE 'PICT'         TO                               42920099
429300                                    HL7-AD-DATE-INFO              42930099
429400         WHEN '3'                                                 42940099
429500             MOVE 'PREP'         TO                               42950099
429600                                    HL7-AD-DATE-INFO              42960099
429700         WHEN '4'                                                 42970099
429800             MOVE 'RAIN'         TO                               42980099
429900                                    HL7-AD-DATE-INFO              42990099
430000         WHEN '5'                                                 43000099
430100             MOVE 'CUST'         TO                               43010099
430200                                    HL7-AD-DATE-INFO              43020099
430300         WHEN OTHER                                               43030099
430400             MOVE SPACES         TO HL7-AD-DATE-INFO              43040099
430500     END-EVALUATE.                                                43050099
430600                                                                  43060099
430700     MOVE  RECEIV-PRE-TKT-IND    TO HL7-PRETICKET-IND             43070099
430800     MOVE  RECEIV-GOH-IND       TO                                43080099
430900                                    HL7-HANGER-IND                43090099
430901     MOVE  RECEIV-PACK-BY-ST-IND                                  43090199
430902                                 TO HL7-PBS-IND                   43090214
430903     MOVE SPACES                 TO HL7-PACK-TYPE-DESC            43090399
430904     EVALUATE TRUE                                                43090499
430905         WHEN RECEIV-PKGNG-CDE = PC-M                             43090599
430906             MOVE PC-MULTIPLE-SKU-PPK                             43090699
430907                                 TO HL7-PACK-TYPE-DESC            43090799
430908         WHEN RECEIV-PKGNG-CDE = PC-S                             43090899
430909             MOVE PC-SINGLE-SKU-PPK                               43090999
430910                                 TO HL7-PACK-TYPE-DESC            43091099
430920         WHEN RECEIV-PKGNG-CDE = PC-I                             43092099
430930             MOVE PC-INNER-PPK   TO HL7-PACK-TYPE-DESC            43093099
430940         WHEN RECEIV-PKGNG-CDE = PC-B                             43094099
430941             MOVE PC-BULK-PPK    TO HL7-PACK-TYPE-DESC            43094199
430942         WHEN RECEIV-PKGNG-CDE = PC-C                             43094214
430943             MOVE PC-CASEPACK    TO HL7-PACK-TYPE-DESC            43094314
430944     END-EVALUATE.                                                43094414
430945                                                                  43094599
430946     MOVE PV-BOX-ID              TO HL7-BOX-ID.                   43094699
430947                                                                  43094799
430948     MOVE PURCHS-SEASET-SHRT-NM  TO HL7-SEASON-SET-NAME.          43094899
430949                                                                  43094999
430950                                                                  43095099
430960     IF RECEIV-MKNG-APRN-PRT-TMST NOT = PC-DB2-DUMMY-DATE-TIME    43096099
430970         MOVE RL1-REPRINT-LINE       TO  DRS01-COMM-DATA          43097099
430980         IF PS-TOP-OF-PAGE-NOT-SET                                43098099
430990             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           43099099
431000         END-IF                                                   43100099
431100         PERFORM 8000-LINK-TO-DRS                                 43110099
431200         SET PS-TOP-OF-PAGE-SET      TO TRUE.                     43120099
431300                                                                  43130099
431400     IF PV-COUNT > 0                                              43140099
431500         MOVE RT1-RTV-DISTRO-LINE-1 TO  DRS01-COMM-DATA           43150099
431600         IF PS-TOP-OF-PAGE-SET                                    43160099
431700             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           43170099
431800         ELSE                                                     43180099
431900             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           43190099
432000         END-IF                                                   43200099
432100         PERFORM 8000-LINK-TO-DRS                                 43210099
432200         SET PS-TOP-OF-PAGE-SET TO TRUE                           43220099
432300     END-IF.                                                      43230099
432400     IF TL2-TRBL-DESC (1) NOT = SPACES                            43240099
432500        OR PV-LINE-TRBL-CNT > 0                                   43250099
432600        OR PV-PACK-TRBL-CNT > 0                                   43260099
432700         MOVE TL1-TROUBLE-LINE       TO  DRS01-COMM-DATA          43270099
432800         IF PS-TOP-OF-PAGE-SET                                    43280099
432900             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           43290099
433000         ELSE                                                     43300099
433100             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           43310099
433200         END-IF                                                   43320099
433300         PERFORM 8000-LINK-TO-DRS                                 43330099
433400         MOVE TL2-TROUBLE-LINE       TO  DRS01-COMM-DATA          43340099
433500         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           43350099
433600         PERFORM 8000-LINK-TO-DRS                                 43360099
433700         SET PS-TOP-OF-PAGE-SET TO TRUE                           43370099
433800     END-IF.                                                      43380099
433900                                                                  43390099
434000     IF PS-TOP-OF-PAGE-SET                                        43400099
434100         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           43410099
434200     ELSE                                                         43420099
434300         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL.          43430099
434400                                                                  43440099
434500     MOVE TL3-TROUBLE-LINE           TO  DRS01-COMM-DATA.         43450099
434600     PERFORM 8000-LINK-TO-DRS.                                    43460099
434700                                                                  43470099
434800     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          43480099
434900     PERFORM 6200-PRINT-DISTRO-LINES.                             43490099
435000     IF PV-COUNT > 60                                             43500099
435100         MOVE RT3-RTV-DISTRO-LINE-3  TO  DRS01-COMM-DATA          43510099
435200         PERFORM 8000-LINK-TO-DRS                                 43520099
435300     END-IF.                                                      43530099
435400                                                                  43540099
435500     MOVE HL1-HEADING-LINE           TO  DRS01-COMM-DATA.         43550099
435600     MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          43560099
435700     PERFORM 8000-LINK-TO-DRS.                                    43570099
435800                                                                  43580099
435900     MOVE HL1A-HEADING-LINE          TO  DRS01-COMM-DATA.         43590099
436000     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          43600099
436100     PERFORM 8000-LINK-TO-DRS.                                    43610099
436200                                                                  43620099
436300     MOVE HL2-HEADING-LINE           TO  DRS01-COMM-DATA.         43630099
436400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          43640099
436500     PERFORM 8000-LINK-TO-DRS.                                    43650099
436600                                                                  43660099
436700     MOVE HL3-HEADING-LINE           TO  DRS01-COMM-DATA.         43670099
436800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL           43680099
436900     PERFORM 8000-LINK-TO-DRS.                                    43690099
437000                                                                  43700099
437100     MOVE HL3A-HEADING-LINE          TO  DRS01-COMM-DATA.         43710099
437200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL           43720099
437300     PERFORM 8000-LINK-TO-DRS.                                    43730099
437400                                                                  43740099
437500     MOVE HL4-HEADING-LINE           TO  DRS01-COMM-DATA.         43750099
437600     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          43760099
437700     PERFORM 8000-LINK-TO-DRS.                                    43770099
437800                                                                  43780099
437900     MOVE HL5-HEADING-LINE           TO  DRS01-COMM-DATA.         43790099
438000     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL           43800099
438100     PERFORM 8000-LINK-TO-DRS.                                    43810099
438200                                                                  43820099
438300     MOVE HL6-HEADING-LINE           TO  DRS01-COMM-DATA.         43830099
438400     MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL           43840099
438500     PERFORM 8000-LINK-TO-DRS.                                    43850099
438600                                                                  43860099
438700     MOVE HL7-HEADING-LINE           TO  DRS01-COMM-DATA.         43870099
438800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL           43880099
438900     PERFORM 8000-LINK-TO-DRS.                                    43890099
439000/                                                                 43900099
439100 7000-UPDATE-TRECEIV-TMST.                                        43910099
439200                                                                  43920099
439300     EXEC SQL                                                     43930099
439400         UPDATE TRECEIV                                           43940099
439500           SET  MKNG_APRN_PRT_TMST = CURRENT TIMESTAMP            43950099
439600           WHERE ORD_NBR           = :DK-ORD-NBR                  43960099
439700             AND OPER_UNT_ID       = :DK-OPER-UNT-ID              43970099
439800             AND FCLTY_ID          = :DK-FCLTY-ID                 43980099
439900             AND REC_SEQ_NBR       = :DK-REC-SEQ-NBR              43990099
440000             AND VER_STATUS_CDE    = :PC-A                        44000099
440100     END-EXEC.                                                    44010099
440200                                                                  44020099
440300     EVALUATE TRUE                                                44030099
440400         WHEN SQLCODE = +0                                        44040099
440500             CONTINUE                                             44050099
440600         WHEN SQLCODE = -904                                      44060099
440700         WHEN SQLCODE = -911                                      44070099
440800         WHEN SQLCODE = -913                                      44080099
440900            IF PS-CONTENTION                                      44090099
441000               CONTINUE                                           44100099
441100            ELSE                                                  44110099
441200               SET PS-ERROR-PRINT   TO TRUE                       44120099
441300               SET PS-CONTENTION    TO TRUE                       44130099
441400               STRING PC-CONTENTION-MSG PC-ASTERISKS              44140099
441500                  DELIMITED BY SIZE                               44150099
441600                  INTO PV-ERROR-MSG                               44160099
441700               MOVE '7000-UPDATE-TRECEIV-TMST'                    44170099
441800                                    TO DP013-PARAGRAPH            44180099
441900               MOVE PRV-11A         TO DP013-MESSAGE-TEXT (1)     44190099
442000               PERFORM 9000-RETURN-MSG                            44200099
442100               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     44210099
442200               MOVE SQLCA           TO DP013-SQLCA                44220099
442300               MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)   44230099
442400               SET DP013-DB2-ABEND  TO TRUE                       44240099
442500               PERFORM DP013-0000-PROCESS-ABEND                   44250099
442600           END-IF                                                 44260099
442700         WHEN SQLWARN0 NOT = SPACES                               44270099
442800         WHEN SQLCODE < +0                                        44280099
442900         WHEN SQLCODE > +0                                        44290099
443000               SET PS-ERROR-PRINT   TO TRUE                       44300099
443100               STRING PC-TIMESTAMP-MSG PC-ASTERISKS               44310099
443200                  DELIMITED BY SIZE                               44320099
443300                  INTO PV-ERROR-MSG                               44330099
443400               MOVE '7000-UPDATE-TRECEIV-TMST'                    44340099
443500                                    TO DP013-PARAGRAPH            44350099
443600               MOVE PRV-11A         TO DP013-MESSAGE-TEXT (1)     44360099
443700               PERFORM 9000-RETURN-MSG                            44370099
443800               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     44380099
443900               MOVE SQLCA           TO DP013-SQLCA                44390099
444000               MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)   44400099
444100               SET DP013-DB2-ABEND  TO TRUE                       44410099
444200               PERFORM DP013-0000-PROCESS-ABEND                   44420099
444300     END-EVALUATE.                                                44430099
444400                                                                  44440099
444500                                                                  44450099
444600 7400-SYNCPOINT.                                                  44460099
444700                                                                  44470099
444800     EXEC CICS SYNCPOINT                                          44480099
444900     END-EXEC.                                                    44490099
445000                                                                  44500099
445100*----------------------------------------------------------------*44510099
445200*    LINK TO PACK MARKING APRON PROGRAM.                         *44520099
445300*----------------------------------------------------------------*44530099
445400 7700-LINK-PCKCS708.                                              44540099
445500                                                                  44550099
445600     STRING DRS01-COMMAREA DRS02-DRIB DELIMITED BY SIZE           44560099
445700                            INTO CA-DRIB-AREA                     44570099
445800                                                                  44580099
445900     EXEC CICS                                                    44590099
446000         LINK PROGRAM  (PC-PCKCS708)                              44600099
446100              COMMAREA (CA-COMMAREA)                              44610099
446200              RESP     (PV-CICS-RESPONSE)                         44620099
446300     END-EXEC.                                                    44630099
446400                                                                  44640099
446500     EVALUATE TRUE                                                44650099
446600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 44660099
446700             CONTINUE                                             44670099
446800         WHEN OTHER                                               44680099
446900               MOVE '7700-LINK-PCKCS708'                          44690099
447000                                    TO DP013-PARAGRAPH            44700099
447100               MOVE PRV-2A          TO DP013-MESSAGE-TEXT (1)     44710099
447200               PERFORM 9000-RETURN-MSG                            44720099
447300               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     44730099
447400               MOVE SQLCA           TO DP013-SQLCA                44740099
447500               SET DP013-CICS-ABEND                               44750099
447600                   DP013-NO-ROLLBACK TO TRUE                      44760099
447700               PERFORM DP013-0000-PROCESS-ABEND                   44770099
447800     END-EVALUATE.                                                44780099
447900                                                                  44790099
448000*----------------------------------------------------------------*44800099
448100*    START TRANID FOR PCKCS010 (MARKING APRON).                  *44810099
448200*----------------------------------------------------------------*44820099
448300 7800-START-TRANID-E010.                                          44830099
448400                                                                  44840099
448500     STRING DRS01-COMMAREA DRS02-DRIB DELIMITED BY SIZE           44850099
448600                            INTO CA-DRIB-AREA                     44860099
448700                                                                  44870099
448800                                                                  44880099
448900     EXEC CICS                                                    44890099
449000         LINK PROGRAM  (PC-PCKCS010)                              44900099
449100              COMMAREA (CA-COMMAREA)                              44910099
449200              RESP     (PV-CICS-RESPONSE)                         44920099
449300     END-EXEC.                                                    44930099
449400                                                                  44940099
449500     EVALUATE TRUE                                                44950099
449600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 44960099
449700             CONTINUE                                             44970099
449800         WHEN OTHER                                               44980099
449900               MOVE '7800-START-TRANID-E010'                      44990099
450000                                    TO DP013-PARAGRAPH            45000099
450100               MOVE PRV-2A          TO DP013-MESSAGE-TEXT (1)     45010099
450200               PERFORM 9000-RETURN-MSG                            45020099
450300               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     45030099
450400               MOVE SQLCA           TO DP013-SQLCA                45040099
450500               SET DP013-CICS-ABEND                               45050099
450600                   DP013-NO-ROLLBACK TO TRUE                      45060099
450700               PERFORM DP013-0000-PROCESS-ABEND                   45070099
450800     END-EVALUATE.                                                45080099
450900                                                                  45090099
451000*----------------------------------------------------------------*45100099
451100*    START TRANID FOR PCKCS014 (MARKING APRON RTV PAGES)         *45110099
451200*----------------------------------------------------------------*45120099
451300 7900-START-TRANID-E014.                                          45130099
451400                                                                  45140099
451500     STRING DRS01-COMMAREA DRS02-DRIB DELIMITED BY SIZE           45150099
451600                            INTO CA-DRIB-AREA                     45160099
451700                                                                  45170099
451800                                                                  45180099
451900     EXEC CICS                                                    45190099
452000         LINK PROGRAM  (PC-PCKCS014)                              45200099
452100              COMMAREA (CA-PCKCS014-COMMAREA)                     45210099
452200              RESP     (PV-CICS-RESPONSE)                         45220099
452300     END-EXEC.                                                    45230099
452400                                                                  45240099
452500     EVALUATE TRUE                                                45250099
452600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 45260099
452700             CONTINUE                                             45270099
452800         WHEN OTHER                                               45280099
452900               MOVE '7900-START-TRANID-E014'                      45290099
453000                                    TO DP013-PARAGRAPH            45300099
453100               MOVE PRV-2B          TO DP013-MESSAGE-TEXT (1)     45310099
453200               PERFORM 9000-RETURN-MSG                            45320099
453300               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     45330099
453400               MOVE SQLCA           TO DP013-SQLCA                45340099
453500               SET DP013-CICS-ABEND                               45350099
453600                   DP013-NO-ROLLBACK TO TRUE                      45360099
453700               PERFORM DP013-0000-PROCESS-ABEND                   45370099
453800     END-EVALUATE.                                                45380099
453900                                                                  45390099
454000/                                                                 45400099
454100******************************************************************45410099
454200* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     45420099
454300******************************************************************45430099
454400 8000-LINK-TO-DRS.                                                45440099
454500                                                                  45450099
454600*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        45460099
454700*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          45470099
454800*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              45480099
454900     EXEC CICS                                                    45490099
455000         LINK                                                     45500099
455100             PROGRAM   ('DRS1INTC')                               45510099
455200             COMMAREA  (DRS01-COMMAREA)                           45520099
455300     END-EXEC.                                                    45530099
455400                                                                  45540099
455500     EVALUATE TRUE                                                45550099
455600         WHEN DRS01-DRRB-RC = ZERO                                45560099
455700             CONTINUE                                             45570099
455800         WHEN OTHER                                               45580099
455900             SET PS-DRS              TO TRUE                      45590099
456000             MOVE '8000-LINK-TO-DRS'                              45600099
456100                                     TO DP013-PARAGRAPH           45610099
456200             MOVE PRV-5A             TO DP013-MESSAGE-TEXT (1)    45620099
456300             PERFORM 9000-RETURN-MSG                              45630099
456400             MOVE PV-DISPLAY-KEYS    TO DP013-MESSAGE-TEXT (2)    45640099
456500             SET DP013-OTHER-ABEND                                45650099
456600                 DP013-NO-ROLLBACK   TO TRUE                      45660099
456700             MOVE DRS01-DRRB-FUNC    TO PV-DRS-DRRB-FUNC          45670099
456800             MOVE DRS01-DRRB-RID     TO PV-DRS-DRRB-RID           45680099
456900             MOVE DRS01-DRRD-OPTIONS TO PV-DRS-DRRB-OPTIONS       45690099
457000             MOVE DRS01-DRRB-RC      TO PV-DRS-DRRB-RC            45700099
457100             MOVE DRS01-DRRB-ATTR-ERROR                           45710099
457200                                     TO PV-DRS-ATTR-ERROR         45720099
457300             MOVE DRS01-DRRB-DRDC    TO PV-DRS-DRRB-DRDC          45730099
457400             MOVE DRS01-DRRB01-LINES TO PV-DRS-DRRB-LINES         45740099
457500             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      45750099
457600                                     TO DP013-MESSAGE-TEXT (1)    45760099
457700             MOVE PV-DRS-ABEND-DISPLAY-LINE                       45770099
457800                                     TO DP013-MESSAGE-TEXT (2)    45780099
457900             PERFORM DP013-0000-PROCESS-ABEND                     45790099
458000     END-EVALUATE.                                                45800099
458100                                                                  45810099
458200                                                                  45820099
458300 8100-FORMAT-TIME.                                                45830099
458400                                                                  45840099
458500     EXEC CICS                                                    45850099
458600         ASKTIME ABSTIME (ST-ABSTIME)                             45860099
458700     END-EXEC.                                                    45870099
458800                                                                  45880099
458900     EXEC CICS                                                    45890099
459000         FORMATTIME ABSTIME  (ST-ABSTIME)                         45900099
459100                    MMDDYY   (SD-MMDDYY-FORMAT)                   45910099
459200                    DATESEP                                       45920099
459300                    TIME     (ST-HHMMSS-FORMAT)                   45930099
459400                    TIMESEP                                       45940099
459500     END-EXEC.                                                    45950099
459600                                                                  45960099
459700     EXEC CICS                                                    45970099
459800         FORMATTIME ABSTIME  (ST-ABSTIME)                         45980099
459900                       YEAR  (SD-YYYY-FORMAT)                     45990099
460000     END-EXEC.                                                    46000099
460100                                                                  46010099
460200     MOVE SD-YYYY-FORMAT  TO  PV-CURRENT-CENTURY-YEAR.            46020099
460300     MOVE SD-SYSTEM-MONTH TO  PV-CURRENT-MONTH.                   46030099
460400     MOVE SD-SYSTEM-DAY   TO  PV-CURRENT-DAY.                     46040099
460500                                                                  46050099
460600/                                                                 46060099
460700 9000-RETURN-MSG.                                                 46070099
460800                                                                  46080099
460900     MOVE CA-USER-ID          TO PV-DISPLAY-USER-ID.              46090099
461000     MOVE DK-OPER-UNT-ID      TO PV-DISPLAY-OPER-UNT-ID.          46100099
461100     MOVE DK-FCLTY-ID         TO PV-DISPLAY-FCLTY-ID.             46110099
461200     MOVE DK-ORD-NBR          TO PV-DISPLAY-ORD-NBR.              46120099
461300     MOVE DK-REC-SEQ-NBR      TO PV-DISPLAY-REC-SEQ-NBR.          46130099
461400     MOVE PKSLIP-PKSL-NBR     TO PV-DISPLAY-PKSL-NBR.             46140099
461500     MOVE PKSLIP-SEQ-NBR      TO PV-DISPLAY-PKSL-NBR.             46150099
461600     MOVE PKSLIP-STR-DEST-NBR TO PV-DISPLAY-STR-DEST-NBR.         46160099
461700                                                                  46170099
461800/                                                                 46180099
461900******************************************************************46190099
462000* DELETE THE TEMP STORAGE QUEUE.                                  46200099
462100******************************************************************46210099
462200 9300-DELETE-TS-QUEUE.                                            46220099
462300     EXEC CICS                                                    46230099
462400         DELETEQ TS                                               46240099
462500             QUEUE (CA-SEL-QUEUE-NAME)                            46250099
462600             RESP  (PV-CICS-RESPONSE)                             46260099
462700     END-EXEC.                                                    46270099
462800                                                                  46280099
462900     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        46290099
463000        CONTINUE                                                  46300099
463100     ELSE                                                         46310099
463200         SET PS-ERROR-PRINT    TO TRUE                            46320099
463300         STRING PC-DELETE-Q-MSG PC-ASTERISKS                      46330099
463400                DELIMITED BY SIZE                                 46340099
463500                INTO PV-ERROR-MSG                                 46350099
463600             MOVE '9300-DELETE-TS-QUEUE'                          46360099
463700                                   TO DP013-PARAGRAPH             46370099
463800             MOVE PRV-3B           TO DP013-MESSAGE-TEXT (1)      46380099
463900             PERFORM 9000-RETURN-MSG                              46390099
464000             MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      46400099
464100             MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT (3)      46410099
464200             SET DP013-CICS-ABEND                                 46420099
464300                 DP013-NO-ROLLBACK TO TRUE                        46430099
464400             PERFORM DP013-0000-PROCESS-ABEND                     46440099
464500     END-IF.                                                      46450099
464600     EJECT                                                        46460099
464700*----------------------------------------------------------------*46470099
464800*    ABEND PROCESSOR MODULE                                      *46480099
464900*----------------------------------------------------------------*46490099
465000                                                                  46500099
465100     COPY DPPD013.                                                46510099
