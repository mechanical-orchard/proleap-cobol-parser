000100***************************************************************** 02/14/96
000200 IDENTIFICATION DIVISION.                                         FSKUT035
000300*****************************************************************    LV001
000400                                                                  FSKUT035
000500 PROGRAM-ID.             FSKUT035.                                FSKUT035
000600 AUTHOR.                 BOB FORD.                                FSKUT035
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 FSKUT035
000800 DATE-WRITTEN            09-15-2004.                              FSKUT035
000900 DATE-COMPILED.                                                   FSKUT035
001000                                                                  FSKUT035
001100***************************************************************** FSKUT035
001400*  THIS PROGRAM CREATES THE CONTROL CARD USED TO CREATE         * FSKUT035
001500*  MULTIPLE OUTPUT FILES IN A SORT.                             * FSKUT035
001600***************************************************************** FSKUT035
002000* CHANGED 09/30/2004 BY BOB FORD                                  FSKUT035
002100*   WR# 27494                                                     FSKUT035
002200*         NEW PROGRAM                                             FSKUT035
002560***************************************************************** FSKUT035
002600 ENVIRONMENT DIVISION.                                            FSKUT035
002700***************************************************************** FSKUT035
002800                                                                  FSKUT035
002900 CONFIGURATION SECTION.                                           FSKUT035
003000                                                                  FSKUT035
003100 SOURCE-COMPUTER.        IBM-3090.                                FSKUT035
003200 OBJECT-COMPUTER.        IBM-3090.                                FSKUT035
003300                                                                  FSKUT035
003400 INPUT-OUTPUT SECTION.                                            FSKUT035
003500                                                                  FSKUT035
003600 FILE-CONTROL.                                                    FSKUT035
003700*                                                                 FSKUT035
006300     SELECT JCL-CARD-FILE        ASSIGN   TO  OUT01.                      
006400*                                                                         
004500***************************************************************** FSKUT035
004600 DATA DIVISION.                                                   FSKUT035
004700***************************************************************** FSKUT035
004800*                                                                 FSKUT035
004900 FILE SECTION.                                                    FSKUT035
005000*                                                                 FSKUT035
007800 FD  JCL-CARD-FILE                                                        
007900     LABEL RECORDS ARE STANDARD                                           
008000     RECORDING MODE IS F                                                  
008100     RECORD CONTAINS 80 CHARACTERS                                        
008200     BLOCK CONTAINS 0 RECORDS.                                            
008300 01  JCL-CARD-REC1                   PIC  X(80).                          
008400*                                                                         
006300 WORKING-STORAGE SECTION.                                         FSKUT035
006400*                                                                 FSKUT035
006500 01  FILLER.                                                      FSKUT035
006600     05  FILLER                      PIC  X(36)    VALUE          FSKUT035
006700         ' ***** WORKING STORAGE PGM=FSKUT035 '.                  FSKUT035
007400 EJECT                                                            FSKUT035
004200*                                                                         
017200 01  CC-INPUT.                                                            
017300     05  CC-RECORD-COUNT               PIC 9(09).                         
017410     05  FILLER                        PIC X(71).                         
017700                                                                          
008200 01  PC-CONSTANTS.                                                FSKUT035
012500     05  PC-N                        PIC  X(01)  VALUE 'N'.       FSKUT035
006100     05  PC-PROGRAM-NAME         PIC X(8)     VALUE 'FSKUT035'.           
           05  PC-NBR-OF-OUTPUT-FILES  PIC S9(2)    VALUE +6.                   
           05  PC-NUM-1                PIC S9(1)    VALUE +1.                   
           05  PC-LIT-01               PIC X(2)     VALUE '01'.                 
           05  PC-LIT-02               PIC X(2)     VALUE '02'.                 
           05  PC-LIT-03               PIC X(2)     VALUE '03'.                 
           05  PC-LIT-04               PIC X(2)     VALUE '04'.                 
           05  PC-LIT-05               PIC X(2)     VALUE '05'.                 
           05  PC-LIT-06               PIC X(2)     VALUE '06'.                 
           05  PC-LIT-07               PIC X(2)     VALUE '07'.                 
           05  PC-LIT-08               PIC X(2)     VALUE '08'.                 
           05  PC-LIT-09               PIC X(2)     VALUE '09'.                 
           05  PC-LIT-9-9              PIC 9(9)     VALUE 999999999.            
014800 EJECT                                                            FSKUT035
014900*                                                                 FSKUT035
015000 01  PV-MISC-FIELDS.                                              FSKUT035
006600     05  PV-ABEND-MESSAGE          PIC X(50)        VALUE SPACE.          
006700     05  PV-PARA-NAME              PIC X(25)        VALUE SPACE.          
007300     05  ABEND-CODE                PIC S9(04)       VALUE +4003           
014900                                                    COMP SYNC.    FSKUT035
           05  PV-NBR-RECS-PER-FILE    PIC S9(11)      VALUE +0  COMP-3.        
           05  PV-STARTREC             PIC S9(09)      VALUE +0  COMP-3.        
           05  PV-ENDREC               PIC S9(09)      VALUE +0  COMP-3.        
014900*                                                                 FSKUT035
021600 01  OUTPUT-REC1.                                                         
021800     05 FILLER                      PIC X(05) VALUE SPACE.                
021700     05 FILLER                      PIC X(32) VALUE                       
                              'SORT FIELDS=(6,8,PD,A,25,2,BI,A)'.               
021800     05 FILLER                      PIC X(43) VALUE SPACE.                
006200*                                                                 FSKUT035
021600 01  OUTPUT-REC2.                                                         
021800     05 FILLER                      PIC X(05) VALUE SPACE.                
021800     05 FILLER                      PIC X(21) VALUE                       
                    'OUTFIL FNAMES=(SORTOF'.                                    
021800     05 OR2-FILENUM                 PIC X(2)  VALUE SPACE.                
021800     05 FILLER                      PIC X(11) VALUE                       
                    '),STARTREC='.                                              
021800     05 OR2-STARTREC                PIC 9(9)  VALUE ZERO.                 
021800     05 FILLER                      PIC X(08) VALUE ',ENDREC='.           
021800     05 OR2-ENDREC                  PIC 9(9)  VALUE ZERO.                 
021800     05 FILLER                      PIC X(15) VALUE SPACE.                
006200*                                                                 FSKUT035
023601     COPY DPWS500.                                                        
023602*                                                                         
027500 EJECT                                                                    
020400*                                                                 FSKUT035
021300***************************************************************** FSKUT035
021400*PROCEDURE DIVISION.                                              FSKUT035
021500***************************************************************** FSKUT035
021600 PROCEDURE DIVISION.                                              FSKUT035
021700*                                                                 FSKUT035
021800 A000-MAINLINE-PROCESSING.                                        FSKUT035
021900*                                                                 FSKUT035
022000     PERFORM A100-INITIALIZATION.                                 FSKUT035
022100*                                                                 FSKUT035
022200     PERFORM C000-CREATE-OUTPUT-RECORD1.                          FSKUT035
022300*                                                                 FSKUT035
022300*                                                                 FSKUT035
022400     PERFORM Y100-END-ROUTINE.                                    FSKUT035
022500*                                                                 FSKUT035
022600     GOBACK.                                                      FSKUT035
022700*                                                                 FSKUT035
022800 EJECT                                                            FSKUT035
022900******************************************************************FSKUT035
023000** OPEN THE SYSTEM FILE AND ACCEPT CONTROL CARDS.                 FSKUT035
023100** CALL CALENDAR ROUTINES TO RETRIEVE VALUES NEEDED IN PROGRAM    FSKUT035
023200******************************************************************FSKUT035
023300 A100-INITIALIZATION.                                             FSKUT035
023400*                                                                 FSKUT035
023500     OPEN  OUTPUT JCL-CARD-FILE.                                  FSKUT035
019200     INITIALIZE OUTPUT-REC1                                               
019200                OUTPUT-REC2.                                              
           ACCEPT CC-INPUT.                                                     
           DISPLAY 'INPUT REC COUNT = ' CC-RECORD-COUNT.                        
           COMPUTE PV-NBR-RECS-PER-FILE ROUNDED =                               
                  (CC-RECORD-COUNT / PC-NBR-OF-OUTPUT-FILES).                   
           DISPLAY 'RECS PER FILE = ' PV-NBR-RECS-PER-FILE.                     
023700*                                                                 FSKUT035
027500 EJECT                                                            FSKUT035
128000******************************************************************        
128100*   FORMAT DATA & WRITE OUT RECORDS                                       
128200******************************************************************        
128300 C000-CREATE-OUTPUT-RECORD1.                                              
128400     MOVE '*C000-CREATE-OUTPUT-RECORD1      *' TO PV-PARA-NAME.           
128500*                                                                         
129300     WRITE JCL-CARD-REC1 FROM OUTPUT-REC1.                                
129300     DISPLAY 'JCL CARD1 = ' OUTPUT-REC1.                                  
129600*                                                                         
021800     MOVE PC-LIT-01            TO OR2-FILENUM.                            
021800     MOVE PC-NUM-1             TO OR2-STARTREC.                           
021800     MOVE PV-NBR-RECS-PER-FILE TO OR2-ENDREC.                             
129300     WRITE JCL-CARD-REC1 FROM OUTPUT-REC2.                                
129300     DISPLAY 'JCL CARD2 = ' OUTPUT-REC2.                                  
129500                                                                          
021800     MOVE PC-LIT-02            TO OR2-FILENUM.                            
021800     COMPUTE PV-STARTREC = OR2-ENDREC + PC-NUM-1.                         
021800     MOVE PV-STARTREC          TO OR2-STARTREC.                           
021800     COMPUTE PV-ENDREC =                                                  
021800          (PV-STARTREC + PV-NBR-RECS-PER-FILE - PC-NUM-1).                
021800     MOVE PV-ENDREC            TO OR2-ENDREC.                             
129300     WRITE JCL-CARD-REC1 FROM OUTPUT-REC2.                                
129300     DISPLAY 'JCL CARD3 = ' OUTPUT-REC2.                                  
129500                                                                          
021800     MOVE PC-LIT-03            TO OR2-FILENUM.                            
021800     COMPUTE PV-STARTREC = OR2-ENDREC + PC-NUM-1.                         
021800     MOVE PV-STARTREC          TO OR2-STARTREC.                           
021800     COMPUTE PV-ENDREC =                                                  
021800          (PV-STARTREC + PV-NBR-RECS-PER-FILE - PC-NUM-1).                
021800     MOVE PV-ENDREC            TO OR2-ENDREC.                             
129300     WRITE JCL-CARD-REC1 FROM OUTPUT-REC2.                                
129300     DISPLAY 'JCL CARD4 = ' OUTPUT-REC2.                                  
129500                                                                          
021800     MOVE PC-LIT-04            TO OR2-FILENUM.                            
021800     COMPUTE PV-STARTREC = OR2-ENDREC + PC-NUM-1.                         
021800     MOVE PV-STARTREC          TO OR2-STARTREC.                           
021800     COMPUTE PV-ENDREC =                                                  
021800          (PV-STARTREC + PV-NBR-RECS-PER-FILE - PC-NUM-1).                
021800     MOVE PV-ENDREC            TO OR2-ENDREC.                             
129300     WRITE JCL-CARD-REC1 FROM OUTPUT-REC2.                                
129300     DISPLAY 'JCL CARD5 = ' OUTPUT-REC2.                                  
129500                                                                          
021800     MOVE PC-LIT-05            TO OR2-FILENUM.                            
021800     COMPUTE PV-STARTREC = OR2-ENDREC + PC-NUM-1.                         
021800     MOVE PV-STARTREC          TO OR2-STARTREC.                           
021800     COMPUTE PV-ENDREC =                                                  
021800          (PV-STARTREC + PV-NBR-RECS-PER-FILE - PC-NUM-1).                
021800     MOVE PV-ENDREC            TO OR2-ENDREC.                             
129300     WRITE JCL-CARD-REC1 FROM OUTPUT-REC2.                                
129300     DISPLAY 'JCL CARD6 = ' OUTPUT-REC2.                                  
129500                                                                          
021800     MOVE PC-LIT-06            TO OR2-FILENUM.                            
021800     COMPUTE PV-STARTREC = OR2-ENDREC + PC-NUM-1.                         
021800     MOVE PV-STARTREC          TO OR2-STARTREC.                           
021800     MOVE PC-LIT-9-9           TO OR2-ENDREC.                             
129300     WRITE JCL-CARD-REC1 FROM OUTPUT-REC2.                                
129300     DISPLAY 'JCL CARD7 = ' OUTPUT-REC2.                                  
129500                                                                          
129600*                                                                         
129600*                                                                         
051900******************************************************************FSKUT035
052000*   CLOSES FILES AND DISPLAYS MESSAGES.                          *FSKUT035
052100******************************************************************FSKUT035
052200 Y100-END-ROUTINE.                                                FSKUT035
052300*                                                                 FSKUT035
052400     CLOSE  JCL-CARD-FILE.                                        FSKUT035
222900     DISPLAY '*******************************************'                
222800     DISPLAY '**  FSKUT035 COMPLETE **'.                                  
052500*                                                                 FSKUT035
052600 EJECT                                                            FSKUT035
223900*                                                                         
224000*****************************************************************         
