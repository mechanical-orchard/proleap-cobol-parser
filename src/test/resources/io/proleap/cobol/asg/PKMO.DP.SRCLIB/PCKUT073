000100 IDENTIFICATION DIVISION.                                         00010013
000200 PROGRAM-ID.    PCKUT073.                                         00020014
000300 AUTHOR.        JEAN KURKOWSKI.                                   00030014
000400                                                                  00040014
000500******************************************************************00050014
000600* TO BE USED TO TAKE PACK-TO-LIGHT BUSINESS EVENT FOR AN INBOUND  00060014
000700* SCAN AND WRITE THE INFORMATION OUT TO THE EAI BUSINESS          00070014
000800* EVENT EXPORT TABLES                                             00080014
000900*                                                                 00090001
001000* THIS PROGRAM WAS CONVERTED FROM PCKCS763 AND CHGD TO BATCH      00100009
001100*                                                                 00110001
001200******************************************************************00120001
001300                                                                  00130001
001400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00140001
001500 DATE-WRITTEN.  JULY 2007.                                        00150001
001600 DATE-COMPILED.                                                   00160001
001700                                                                  00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900 CONFIGURATION SECTION.                                           00190001
002000 SOURCE-COMPUTER. IBM-3090.                                       00200001
002100 OBJECT-COMPUTER. IBM-3090.                                       00210001
002200                                                                  00220001
002300 DATA DIVISION.                                                   00230001
002400 WORKING-STORAGE SECTION.                                         00240001
002500                                                                  00250001
002600 01  PS-SWITCHES.                                                 00260001
002700     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00270001
002800         88  PS-ERROR-YES                       VALUE 'Y'.        00280001
002900         88  PS-ERROR-NO                        VALUE 'N'.        00290001
003000     05  PS-P4-INTERFACE-SW           PIC X(01) VALUE 'N'.        00300001
003100         88  PS-P4-INTERFACE-YES                VALUE 'Y'.        00310001
003200         88  PS-P4-INTERFACE-NO                 VALUE 'N'.        00320001
003300     05  PS-DUP-CTN-SW                PIC X(01) VALUE 'N'.        00330001
003400         88  PS-DUP-CTN-YES                     VALUE 'Y'.        00340001
003500         88  PS-DUP-CTN-NO                      VALUE 'N'.        00350001
003600     05  PS-DETECT-CHEAT-SW           PIC X(01) VALUE 'N'.        00360001
003700         88  PS-DETECT-CHEAT-YES                VALUE 'Y'.        00370001
003800         88  PS-DETECT-CHEAT-NO                 VALUE 'N'.        00380001
003900     05  PS-USER-FOUND-SW             PIC X(01) VALUE 'N'.        00300001
004000         88  PS-USER-FOUND-YES                  VALUE 'Y'.        00310001
004100         88  PS-USER-FOUND-NO                   VALUE 'N'.        00320001
004200                                                                  00330001
004300                                                                  00390001
004400 01  PC-PROGRAM-CONSTANTS.                                        00400001
004600     05  PC-TEMP                      PIC X(02) VALUE 'TP'.       00420001
004700                                                                  00430001
004800 01  DK-DB2-KEYS.                                                 00440022
004900     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00450001
005000     05  DK-MODU-NBR                  PIC S9(04) COMP.            00460001
005100                                                                  00470001
005200 01  PV-PROGRAM-VARIABLES.                                        00480022
005300     05  PV-DISP-SQLCODE              PIC -999    VALUE ZEROES.   00490021
005400     05  PV-DISP-SQLCODE-2            PIC -999    VALUE ZEROES.   00490121
005500     05  PV-DISP-SQLCODE-3            PIC -999    VALUE ZEROES.   00490228
005600     05  PV-DISP-SQLCODE-4            PIC -999    VALUE ZEROES.   00490333
005700     05  PV-DISP-SQLCODE-5            PIC -999    VALUE ZEROES.   00490433
005800     05  PV-DISP-OPER                 PIC 9(04)   VALUE ZEROES.   00490533
005900                                                                  00491021
006000     05  PV-USER-ID                   PIC X(08)   VALUE SPACES.   00492021
006100                                                                  00500001
006200     05  PV-USER-TYPE.                                            00510001
006300         10 PV-TYPE                   PIC X(02) VALUE SPACES.     00520001
006310             88 PV-KOHLS-ASSOC        VALUE 'TK', 'TV', 'TC'.             
006400         10 FILLER                    PIC X(06) VALUE SPACES.     00530001
006500                                                                  00540001
006600     05  PV-PICK-MADE-TM.                                         00550001
006700         10  PV-PICK-BYTE OCCURS 25   PIC X(01).                  00560001
006800     05  PV-PLACE-PTR                 PIC S9(03) COMP-3.          00570001
006900     05  PV-SUB                       PIC S9(03) COMP-3.          00580001
007000     05  PV-HOLD-TWO                  PIC X(02).                  00590001
007100     05  PV-HOLD-FOUR                 PIC X(04).                  00600001
007200     05  PV-HOLD-PTR                  PIC S9(03) COMP-3.          00610001
007300     05  PV-START-TIMESTAMP.                                      00620001
007400         10 PV-START-DATE.                                        00630001
007500             15 PV-START-CCYY         PIC X(04).                  00640001
007600             15 FILLER                PIC X(01) VALUE '-'.        00650001
007700             15 PV-START-MM           PIC X(02).                  00660001
007800             15 FILLER                PIC X(01) VALUE '-'.        00670001
007900             15 PV-START-DD           PIC X(02).                  00680001
008000         10 PV-START-TIME.                                        00690001
008100             15 FILLER                PIC X(01) VALUE '-'.        00700001
008200             15 PV-START-HOUR.                                    00710001
008300                 20 PV-START-HOUR-N   PIC 9(02).                  00720001
008400             15 FILLER                PIC X(01) VALUE '.'.        00730001
008500             15 PV-START-MIN          PIC X(02).                  00740001
008600             15 FILLER                PIC X(01) VALUE '.'.        00750001
008700             15 PV-START-SEC          PIC X(02).                  00760001
008800             15 FILLER                PIC X(01) VALUE '.'.        00770001
008900             15 FILLER                PIC X(06) VALUE ZERO.       00780001
009000                                                                  00790001
009100     05  PV-HOLD-LOCATION.                                        00800001
009200         10  PV-HOLD-LOCATION-7       PIC X(07).                  00810001
009300         10  PV-HOLD-LOCATION-2       PIC X(02).                  00820001
009400         10  PV-HOLD-LOCATION-1       PIC X(01).                  00830001
009500     05  PV-LENGTH                    PIC S9(03) COMP-3.          00840001
009600     05  PV-DUMMY                     PIC S9(03) COMP-3           00850001
009700                                          VALUE ZERO.             00860001
009800                                                                  00870001
009900     05  PV-LABOR-ASGMT-STRT-DTE      PIC X(10) VALUE SPACES.     00880001
010000     05  PV-LABOR-ASGMT-NBR-TXT       PIC X(10) VALUE SPACES.     00890001
010100     05  PV-LABOR-ASGMT-NBR-SEQ-NBR   PIC S9(09) COMP VALUE ZERO. 00900001
010200     05  PV-LABOR-SEQ-START-NBR       PIC S9(09) COMP VALUE ZERO. 00910001
010300                                                                  00920001
010400     05  PV-CURRENT-TIME.                                         00930001
010500         10  PV-CURRENT-HOUR          PIC 99.                     00940001
010600         10  PV-CURRENT-MINUTE        PIC 99.                     00950001
010700         10  PV-CURRENT-SECOND        PIC 99.                     00960001
010800         10  PV-CURRENT-HUNDRETH      PIC 99.                     00970001
010900                                                                  00980001
011000     05  PV-FORMAT-TIME.                                          00990001
011100         10  PV-FORMAT-HH             PIC 99.                     01000001
011200         10  FILLER                   PIC X(01) VALUE ':'.        01010001
011300         10  PV-FORMAT-MM             PIC 99.                     01020001
011400         10  FILLER                   PIC X(01) VALUE ':'.        01030001
011500         10  PV-FORMAT-SS             PIC 99.                     01040001
011600         10  FILLER                   PIC X(01) VALUE ':'.        01050001
011700         10  PV-FORMAT-HUND           PIC 99.                     01060001
011800     05  PV-LOG-MSG                   PIC X(110) VALUE SPACES.    01070019
011900                                                                  01080001
012000 01  PV-ERROR-MSG.                                                01090001
012100     05  FILLER                       PIC X(12)                   01100001
012200         VALUE ' PCKUT073 '.                                      01110004
012300     05  PV-ERROR-TIME                PIC X(11).                  01120001
012400     05  FILLER                       PIC X(06)                   01130001
012500                                           VALUE ' PARA-'.        01140001
012600     05  PV-ERROR-PARA                PIC X(05) VALUE SPACES.     01150001
012700     05  FILLER                       PIC X(02) VALUE SPACES.     01160001
012800     05  PV-ERROR-TEXT                PIC X(44) VALUE SPACES.     01170001
012900                                                                  01180001
013000 01  PV-SQLCODE-MSG.                                              01190001
013100     05  FILLER                       PIC X(10) VALUE             01200001
013200                                              ' SQLCODE= '.       01210001
013300     05  PV-ERROR-SQLCODE             PIC 9999-.                  01220001
013400                                                                  01230001
013500 01  PV-KEY-MSGS.                                                 01240001
013600     05  PV-OPER-TEXT.                                            01250001
013700         10  FILLER                   PIC X(06)                   01260001
013800             VALUE ' LOC= '.                                      01270001
013900         10  PV-MSG-OPER              PIC 9(04).                  01280001
014000                                                                  01290001
014100*    05  PV-LABOR-CHEAT-TEXT.                                     01300001
014200*        10  FILLER                   PIC X(19)                   01310001
014300*            VALUE ' LABOR CHEAT AT DC '.                         01320001
014400*        10  PV-MSG-DC-CHEAT          PIC 9(04).                  01330001
014500*        10  FILLER                   PIC X(07)                   01340001
014600*            VALUE ' USER= '.                                     01350001
014700*        10  PV-MSG-USER-CHEAT        PIC X(08).                  01360001
014800*        10  FILLER                   PIC X(09)                   01370001
014900*            VALUE ' CARTON= '.                                   01380001
015000*        10  PV-MSG-CART-CHEAT        PIC X(22).                  01390001
015100                                                                  01400001
015200                                                                  01410001
015300     05  PV-MODU-TEXT.                                            01420001
015400         10  FILLER                   PIC X(05)                   01430001
015500             VALUE ' DC= '.                                       01440001
015600         10  PV-MSG-MODU-DC           PIC 9(04).                  01450001
015700         10  FILLER                   PIC X(07)                   01460001
015800             VALUE ' MODU= '.                                     01470001
015900         10  PV-MSG-MODU              PIC 9(02).                  01480001
016000                                                                  01490001
016100     05  PV-DLKUT410-TEXT1.                                       01500011
016200         10  FILLER                   PIC X(07)                   01510001
016300             VALUE ' USER= '.                                     01520001
016400         10  PV-DLKUT410-USER         PIC X(08).                  01530011
016500                                                                  01540001
016600         10  FILLER                   PIC X(08)                   01550001
016700             VALUE ' WKTYP= '.                                    01560001
016800         10  PV-DLKUT410-WK-TYP       PIC X(15).                  01570011
016900                                                                  01580001
017000         10  FILLER                   PIC X(13)                   01590001
017100             VALUE ' WKTYP DESC= '.                               01600001
017200         10  PV-DLKUT410-WK-TYP-DESC  PIC X(15).                  01610011
017300                                                                  01620001
017400     05  PV-DLKUT410-TEXT2.                                       01630011
017500                                                                  01640001
017600         10  FILLER                   PIC X(09)                   01650001
017700             VALUE ' WKAREA= '.                                   01660001
017800         10  PV-DLKUT410-WK-AREA-DESC PIC X(20).                  01670011
017900                                                                  01680001
018000         10  FILLER                   PIC X(08)                   01690001
018100             VALUE ' DC=  '.                                      01700001
018200         10  PV-DLKUT410-DC-NBR       PIC 9(04).                  01710011
018300                                                                  01720001
018400         10  FILLER                   PIC X(10)                   01730001
018500             VALUE ' CRE USER='.                                  01740001
018600         10  PV-DLKUT410-CRE-USERID   PIC X(08).                  01750011
018700                                                                  01760001
018800         10  FILLER                   PIC X(10)                   01770001
018900             VALUE ' USER TYP='.                                  01780001
019000         10  PV-DLKUT410-USER-TYP     PIC X(01).                  01790011
019100                                                                  01800001
019200                                                                  01810001
019300     05  PV-XLKUP046-TEXT1.                                       01820017
019400         10  FILLER                   PIC X(07)                   01830001
019500             VALUE ' USER= '.                                     01840001
019600         10  PV-XLKUP046-USER         PIC X(08).                  01850017
019700                                                                  01860001
019800         10  FILLER                   PIC X(10)                   01870001
019900             VALUE ' OBJ TXT= '.                                  01880001
020000         10  PV-XLKUP046-OBJTXT       PIC X(40).                  01890017
020100                                                                  01900001
020200     05  PV-XLKUP046-TEXT2.                                       01910017
020300         10  FILLER                   PIC X(15)                   01920001
020400             VALUE ' OBJ ACTN TXT= '.                             01930001
020500         10  PV-XLKUP046-OBJACTNTXT   PIC X(40).                  01940017
020600                                                                  01950001
020700     05  PV-XLKUT067-TEXT.                                        01960001
020800         10  FILLER                   PIC X(09)                   01970001
020900             VALUE ' PICKER= '.                                   01980001
021000         10  PV-XLKUT067-USERID       PIC X(10).                  01990001
021100         10  FILLER                   PIC X(16)                   02000001
021200             VALUE ' RETURN FIELDS= '.                            02010001
021300         10  PV-XLKUT067-RETURN-FIELDS                            02020001
021400                                      PIC X(57).                  02030001
021500                                                                  02040001
021600     05  PV-DLKUP024-TEXT.                                        02050017
021700         10  FILLER                   PIC X(12)                   02060001
021800             VALUE ' START DTE= '.                                02070001
021900         10  PV-DLKUP024-DATE         PIC X(10).                  02080017
022000         10  FILLER                   PIC X(12)                   02090001
022100             VALUE ' ASGMT TXT= '.                                02100001
022200         10  PV-DLKUP024-TXT          PIC X(10).                  02110017
022300         10  FILLER                   PIC X(12)                   02120001
022400             VALUE ' ASGMT SEQ= '.                                02130001
022500         10  PV-DLKUP024-SEQ          PIC 9(09).                  02140017
022600                                                                  02150001
022700*    FOR FORMATTING SLQCA INTO SOMETHING READABLE                 02160001
022800     COPY DPWS004.                                                02170001
022900/                                                                 02180001
023000*    DLKUP024 COMMAREA                                            02190017
023100     COPY DLWS020.                                                02201016
023200***  COPY DLWS001.   (COMMAREA FOR CICS VERSION - DLKUP001)       02202016
023300/                                                                 02210001
023400*    DLKUT410 COMMAREA                                            02220011
023500     COPY DLWS019.                                                02230011
023600/                                                                 02240001
023700*    XLKUT067                                                     02250001
023800     COPY XLWS067.                                                02260001
023900/                                                                 02270001
024000*    XLKUP046 COMMAREA                                            02280017
024100     COPY XLWS091.                                                02290015
024200***  COPY XLWS072.  (COMMAREA FOR CICS VERSION - XLKUP033)        02291015
024300/                                                                 02300001
024400*    FORMAT FOR PCT_BUS_EVNT_DTL                                  02310001
024500     COPY PCWS242.                                                02320001
024600                                                                  02330001
024700*    FORMATTING TEMPLATE                                          02340001
024800     COPY DLWS011.                                                02350001
024900                                                                  02360001
025000*    ABEND FIELDS                                                 02370001
025100*    COPY DPWS013.                                                02380001
025200/                                                                 02390001
025300*    CORP PARM TABLE                                              02400001
025400     EXEC SQL                                                     02410001
025500         INCLUDE TKRPRPM                                          02420001
025600     END-EXEC.                                                    02430001
025700                                                                  02440001
025800*    PACK-TO-LITE MODULES                                         02450001
025900     EXEC SQL                                                     02460001
026000         INCLUDE TP2LMOD                                          02470001
026100     END-EXEC.                                                    02480001
026200                                                                  02490001
026300*    P2L CARTON VALIDATION                                        02500001
026400     EXEC SQL                                                     02510001
026500         INCLUDE DLT00010                                         02520001
026600     END-EXEC.                                                    02530001
026700                                                                  02540001
026800*     XLT_USR                                                             
026900     EXEC SQL                                                             
027000         INCLUDE XLT00024                                                 
027100     END-EXEC.                                                            
027200                                                                          
027300*     DLT_TMP_EMP                                                         
027400     EXEC SQL                                                             
027500         INCLUDE DLT00002                                                 
027600     END-EXEC.                                                            
027700                                                                          
027800     EXEC SQL                                                     02550001
027900          INCLUDE SQLCA                                           02560001
028000     END-EXEC.                                                    02570001
028100                                                                  02580001
028200                                                                  02590001
028300 LINKAGE SECTION.                                                 02600001
028400                                                                  02610001
028500     COPY PCWS244.                                                02620001
028600/                                                                 02630001
028700 PROCEDURE DIVISION USING PC244-COMMAREA.                         02640001
028800                                                                  02650001
028900     INITIALIZE PS-SWITCHES                                       02651027
029000                PV-PROGRAM-VARIABLES.                             02651127
029100                                                                  02652027
029200     PERFORM 1000-INITIALIZE.                                     02660001
029300                                                                  02670001
029400     IF PS-ERROR-NO                                               02680001
029500         IF PS-P4-INTERFACE-YES                                   02690001
029600             PERFORM 2000-PROCESS-DA-LAUNCH                       02700001
029700         END-IF                                                   02710001
029800     END-IF.                                                      02720001
029900                                                                  02730001
030000     PERFORM 9999-RETURN.                                         02740001
030100                                                                  02750001
030200 1000-INITIALIZE.                                                 02760001
030300                                                                  02770001
030400     SET PS-ERROR-NO                                              02780001
030500         PS-P4-INTERFACE-NO                                       02790026
030600         PC244-SUCCESSFUL             TO TRUE.                    02791026
030700                                                                  02800001
030800     MOVE FUNCTION UPPER-CASE(PC244-LAUNCH-USER-ID)               02810005
030900                                      TO PV-USER-ID.              02820005
031000     MOVE PV-USER-ID                  TO PV-USER-TYPE.            02830005
031100                                                                  02840001
031200     PERFORM 7030-SELECT-TKRPRPM.                                 02850001
031300                                                                  02860001
031400     IF PS-ERROR-NO                                               02870001
031500         IF KRPRPM-FUNC-TXT = 'Y'                                 02880001
031600             STRING ' PCKUT073 IL - '                             02890019
031700                    PC244-DC-NBR                                  02900007
031800                    ' '                                           02910007
031900                    PC244-AREA-NAME                               02920007
032000                    ' '                                           02930007
032100                    PC244-TAG-BAR-CODE-NBR                        02940007
032200                    ' '                                           02950007
032300                    PC244-PICK-ORDER-NBR                          02960007
032400                    ' '                                           02961019
032500***                     DELIMITED BY SIZE                         02970018
032600***                                     INTO PV-LOG-MSG           02980018
032700***          PERFORM 9900-WRITE-LOG                               02990018
032800                    PC244-LAUNCH-DATE                             03000018
032900                    ' '                                           03010007
033000                    PC244-LAUNCH-TIME                             03020007
033100                    ' '                                           03030007
033200                    PC244-LAUNCH-USER-ID                          03040007
033300                         DELIMITED BY SIZE                        03050007
033400                                        INTO PV-LOG-MSG           03060008
033500             PERFORM 9900-WRITE-LOG                               03070007
033600         END-IF                                                   03080007
033700     END-IF.                                                      03090001
033800                                                                  03100001
033900     IF PS-ERROR-NO                                               03110001
034000         PERFORM 7000-SELECT-TKRPRPM                              03120001
034100     END-IF.                                                      03130001
034200                                                                  03140001
034300     IF PS-ERROR-NO                                               03150001
034400         IF PS-P4-INTERFACE-YES                                   03160001
034500*            PERFORM 8600-CALL-XLKUT067                           03170001
034700             MOVE SPACES              TO XL067-USER-FOUND-CODE            
034800             PERFORM 7200-KOHLS-USER                                      
034900         END-IF                                                   03250001
035000     END-IF.                                                      03260001
035100                                                                  03270001
035200 2000-PROCESS-DA-LAUNCH.                                          03280001
035300     IF KRPRPM-FUNC-TXT = 'Y'                                     03290001
035400         MOVE ' PCKUT073 START 2000- PARA '     TO PV-LOG-MSG     03300009
035500         PERFORM 9900-WRITE-LOG                                   03310002
035600     END-IF.                                                      03320001
035700                                                                  03330001
035800     PERFORM 3000-MANAGE-ASSIGNMENT.                              03340001
035900     IF PS-ERROR-NO                                               03350001
036000         PERFORM 4000-CREATE-BUSINESS-EVENT                       03360001
036100     END-IF.                                                      03370001
036200     IF KRPRPM-FUNC-TXT = 'Y'                                     03380001
036300         MOVE ' PCKUT073 END 2000- PARA '     TO PV-LOG-MSG       03390009
036400         PERFORM 9900-WRITE-LOG                                   03400002
036500     END-IF.                                                      03410001
036600                                                                  03420001
036700 3000-MANAGE-ASSIGNMENT.                                          03430001
036800     IF KRPRPM-FUNC-TXT = 'Y'                                     03440001
036900         MOVE ' PCKUT073 START 3000- PARA '     TO PV-LOG-MSG     03450009
037000         PERFORM 9900-WRITE-LOG                                   03460002
037100     END-IF.                                                      03470001
037200                                                                  03480001
037300     PERFORM 3120-DETERMINE-MOD-NBR.                              03490001
037400                                                                  03500001
037500     PERFORM 7050-SELECT-TP2LMOD.                                 03510001
037600     IF P2LMOD-MODU-MDSE-TYP-CDE = 'H'                            03520001
037700         MOVE 'HRTW '                  TO P2LMOD-DFLT-STR-ZN-ID   03530001
037800     END-IF.                                                      03540001
037900                                                                  03550001
038000*    IF P2LMOD-MODU-MDSE-TYP-CDE = 'F'                            03560001
038100*        MOVE 'JEWEL'                  TO P2LMOD-DFLT-STR-ZN-ID   03570001
038200*    END-IF.                                                      03580001
038300                                                                  03590001
038400*    IF P2LMOD-MODU-MDSE-TYP-CDE = 'C'                            03600001
038500*        MOVE 'CAGE '                  TO P2LMOD-DFLT-STR-ZN-ID   03610001
038600*    END-IF.                                                      03620001
038700                                                                  03630001
038800     IF PS-ERROR-NO                                               03640001
038900         PERFORM 8450-LINK-DLKUT410                               03650011
039000     END-IF.                                                      03660001
039100     IF KRPRPM-FUNC-TXT = 'Y'                                     03670001
039200         MOVE ' PCKUT073 END 3000- PARA '     TO PV-LOG-MSG       03680009
039300         PERFORM 9900-WRITE-LOG                                   03690002
039400     END-IF.                                                      03700001
039500                                                                  03710001
039600/                                                                 03720001
039700 3120-DETERMINE-MOD-NBR.                                          03730001
039800     IF KRPRPM-FUNC-TXT = 'Y'                                     03740001
039900         MOVE ' PCKUT073 START 3120- PARA '     TO PV-LOG-MSG     03750009
040000         PERFORM 9900-WRITE-LOG                                   03760002
040100     END-IF.                                                      03770001
040200                                                                  03780001
040300     MOVE PC244-AREA-NAME             TO PV-HOLD-LOCATION.        03790001
040400     MOVE PV-HOLD-LOCATION-2          TO DK-MODU-NBR.             03800001
040500     IF KRPRPM-FUNC-TXT = 'Y'                                     03810001
040600         MOVE ' PCKUT073 END 3120- PARA '     TO PV-LOG-MSG       03820009
040700         PERFORM 9900-WRITE-LOG                                   03830002
040800     END-IF.                                                      03840001
040900/                                                                 03850001
041000 4000-CREATE-BUSINESS-EVENT.                                      03860001
041100     IF KRPRPM-FUNC-TXT = 'Y'                                     03870001
041200         MOVE ' PCKUT073 START 4000- PARA '     TO PV-LOG-MSG     03880009
041300         PERFORM 9900-WRITE-LOG                                   03890002
041400     END-IF.                                                      03900001
041500                                                                  03910001
041600*    GET THE NEXT ASSIGNMENT SEQUENCE NUMBER                      03920001
041700     PERFORM 8400-CALL-DLKUP024                                   03930017
041800                                                                  03940001
041900*    UPDATE EAI TABLES                                            03950001
042000     IF PS-ERROR-NO                                               03960001
042100         PERFORM 7010-SELECT-TKRPRPM                              03970001
042200         IF PS-DETECT-CHEAT-YES                                   03980001
042300             PERFORM 7100-INSERT-CART-VLDN                        03990001
042400             IF PS-DUP-CTN-NO AND PS-ERROR-NO                     04000001
042500                 PERFORM 8410-CALL-XLKUP046                       04010017
042600             END-IF                                               04020001
042700         ELSE                                                     04030001
042800             PERFORM 8410-CALL-XLKUP046                           04040017
042900         END-IF                                                   04050001
043000     END-IF.                                                      04060001
043100                                                                  04070001
043200     IF KRPRPM-FUNC-TXT = 'Y'                                     04080001
043300         MOVE ' PCKUT073 END 4000- PARA '     TO PV-LOG-MSG       04090009
043400         PERFORM 9900-WRITE-LOG                                   04100002
043500     END-IF.                                                      04110001
043600                                                                  04120001
043700 7000-SELECT-TKRPRPM.                                             04130001
043800     IF KRPRPM-FUNC-TXT = 'Y'                                     04140001
043900         MOVE ' PCKUT073 START 7000- PARA '     TO PV-LOG-MSG     04150009
044000         PERFORM 9900-WRITE-LOG                                   04160002
044100     END-IF.                                                      04170001
044200                                                                  04180001
044300     MOVE PC244-DC-NBR                TO KRPRPM-LOC-ID.           04190001
044400     SET PS-P4-INTERFACE-NO           TO TRUE.                    04200001
044500     EXEC SQL                                                     04210001
044600         SELECT FUNC_TXT                                          04220001
044700         INTO :PS-P4-INTERFACE-SW                                 04230001
044800         FROM                                                     04240001
044900             TKRPRPM                                              04250001
045000         WHERE                                                    04260001
045100             LOC_ID                   = :KRPRPM-LOC-ID            04270001
045200         AND INTFC_SYS_CDE            = 'DLX'                     04280001
045300         AND SYS_PRC_FUNC_CDE         = 'DLP2LI'                  04290001
045400         WITH UR                                                  04300001
045500     END-EXEC.                                                    04310001
045600                                                                  04320001
045700     EVALUATE TRUE                                                04330001
045800         WHEN SQLCODE = ZERO                                      04340001
045900             CONTINUE                                             04350001
046000         WHEN OTHER                                               04360021
046100***                                                               04360121
046200***  DMH ADD DISPLAYS - 8/21/2007                                 04360221
046300***                                                               04360321
046400             MOVE SQLCODE         TO  PV-DISP-SQLCODE             04361021
046500             MOVE KRPRPM-LOC-ID   TO  PV-DISP-OPER                04361121
046600             DISPLAY ' PCKUT073 - 7000 - '                        04361221
046700                     ' SQLCODE: ' PV-DISP-SQLCODE                 04361322
046800             DISPLAY ' PCKUT073 - 7000 - '                        04361421
046900                     ' TKRPRPM - '                                04361521
047000                     ' OPER: '    PV-DISP-OPER                    04361622
047100                     ' DLX  DLP2LI'                               04361721
047200***                                                               04362021
047300             MOVE '7000-'             TO PV-ERROR-PARA            04370001
047400             MOVE 'SQL ERROR - TKRPRPM'                           04380001
047500                                      TO PV-ERROR-TEXT            04390001
047600             PERFORM 9700-SQL-ERROR                               04400001
047700                                                                  04410001
047800     END-EVALUATE.                                                04420001
047900                                                                  04430001
048000     IF KRPRPM-FUNC-TXT = 'Y'                                     04440001
048100         MOVE ' PCKUT073 END 7000- PARA '     TO PV-LOG-MSG       04450009
048200         PERFORM 9900-WRITE-LOG                                   04460002
048300     END-IF.                                                      04470001
048400                                                                  04480001
048500 7010-SELECT-TKRPRPM.                                             04490001
048600     IF KRPRPM-FUNC-TXT = 'Y'                                     04500001
048700         MOVE ' PCKUT073 START 7010- PARA '     TO PV-LOG-MSG     04510009
048800         PERFORM 9900-WRITE-LOG                                   04520002
048900     END-IF.                                                      04530001
049000                                                                  04540001
049100     MOVE PC244-DC-NBR                TO KRPRPM-LOC-ID.           04550001
049200     SET PS-DETECT-CHEAT-NO           TO TRUE.                    04560001
049300     EXEC SQL                                                     04570001
049400         SELECT FUNC_TXT                                          04580001
049500         INTO :PS-DETECT-CHEAT-SW                                 04590001
049600         FROM                                                     04600001
049700             TKRPRPM                                              04610001
049800         WHERE                                                    04620001
049900             LOC_ID                   = :KRPRPM-LOC-ID            04630001
050000         AND INTFC_SYS_CDE            = 'DLX'                     04640001
050100         AND SYS_PRC_FUNC_CDE         = 'DLP2IN'                  04650001
050200         WITH UR                                                  04660001
050300     END-EXEC.                                                    04670001
050400                                                                  04680001
050500     EVALUATE TRUE                                                04690001
050600         WHEN SQLCODE = ZERO                                      04700001
050700             CONTINUE                                             04710001
050800         WHEN OTHER                                               04720001
050900***                                                               04721021
051000***  DMH ADD DISPLAYS - 8/21/2007                                 04722021
051100***                                                               04723021
051200             MOVE SQLCODE         TO  PV-DISP-SQLCODE             04724021
051300             MOVE KRPRPM-LOC-ID   TO  PV-DISP-OPER                04725021
051400             DISPLAY ' PCKUT073 - 7010 - '                        04726021
051500                     ' SQLCODE: ' PV-DISP-SQLCODE                 04727022
051600             DISPLAY ' PCKUT073 - 7010 - '                        04728021
051700                     ' TKRPRPM - '                                04729021
051800                     ' OPER: '    PV-DISP-OPER                    04729122
051900                     ' DLX  DLP2IN'                               04729221
052000***                                                               04729321
052100             MOVE '7010-'             TO PV-ERROR-PARA            04730001
052200             MOVE 'SQL ERROR - TKRPRPM'                           04740001
052300                                      TO PV-ERROR-TEXT            04750001
052400             PERFORM 9700-SQL-ERROR                               04760001
052500                                                                  04770001
052600     END-EVALUATE.                                                04780001
052700                                                                  04790001
052800     IF KRPRPM-FUNC-TXT = 'Y'                                     04800001
052900         MOVE ' PCKUT073 END 7010- PARA '     TO PV-LOG-MSG       04810009
053000         PERFORM 9900-WRITE-LOG                                   04820002
053100     END-IF.                                                      04830001
053200                                                                  04840001
053300 7030-SELECT-TKRPRPM.                                             04850001
053400                                                                  04860001
053500     MOVE PC244-DC-NBR                TO KRPRPM-LOC-ID.           04870001
053600                                                                  04880001
053700     EXEC SQL                                                     04890001
053800         SELECT FUNC_TXT                                          04900001
053900         INTO :KRPRPM-FUNC-TXT                                    04910001
054000         FROM                                                     04920001
054100             TKRPRPM                                              04930001
054200         WHERE                                                    04940001
054300             LOC_ID                   = :KRPRPM-LOC-ID            04950001
054400         AND INTFC_SYS_CDE            = 'DLX'                     04960001
054500         AND SYS_PRC_FUNC_CDE         = 'DLPLDI'                  04970001
054600         AND CURRENT TIMESTAMP BETWEEN                            04980001
054700             FUNC_BEG_TMST AND FUNC_END_TMST                      04990001
054800         WITH UR                                                  05000001
054900     END-EXEC.                                                    05010001
055000                                                                  05020001
055100     EVALUATE TRUE                                                05030001
055200         WHEN SQLCODE = ZERO                                      05040001
055300             CONTINUE                                             05050001
055400         WHEN OTHER                                               05060001
055500***                                                               05061021
055600***  DMH ADD DISPLAYS - 8/21/2007                                 05062021
055700***                                                               05063021
055800             MOVE SQLCODE         TO  PV-DISP-SQLCODE             05064021
055900             MOVE KRPRPM-LOC-ID   TO  PV-DISP-OPER                05065021
056000             DISPLAY ' PCKUT073 - 7030 - '                        05066021
056100                     ' SQLCODE: ' PV-DISP-SQLCODE                 05067022
056200             DISPLAY ' PCKUT073 - 7030 - '                        05068021
056300                     ' TKRPRPM - '                                05069021
056400                     ' OPER: '    PV-DISP-OPER                    05069122
056500                     ' DLX  DLPLDI'                               05069221
056600***                                                               05069321
056700             MOVE '7030-'             TO PV-ERROR-PARA            05070021
056800             MOVE 'SQL ERROR - TKRPRPM'                           05080001
056900                                      TO PV-ERROR-TEXT            05090001
057000             PERFORM 9700-SQL-ERROR                               05100001
057100                                                                  05110001
057200     END-EVALUATE.                                                05120001
057300                                                                  05130001
057400 7050-SELECT-TP2LMOD.                                             05140001
057500     IF KRPRPM-FUNC-TXT = 'Y'                                     05150001
057600         MOVE ' PCKUT073 START 7050- PARA '     TO PV-LOG-MSG     05160009
057700         PERFORM 9900-WRITE-LOG                                   05170002
057800     END-IF.                                                      05180001
057900                                                                  05190001
058000     MOVE PC244-DC-NBR               TO DK-OPER-UNT-ID.           05200001
058100     EXEC SQL                                                     05210001
058200         SELECT                                                   05220001
058300             MODU_NBR                                             05230001
058400            ,DFLT_STR_ZN_ID                                       05240001
058500            ,MODU_MDSE_TYP_CDE                                    05250001
058600         INTO                                                     05260001
058700             :P2LMOD-MODU-NBR                                     05270001
058800            ,:P2LMOD-DFLT-STR-ZN-ID                               05280001
058900            ,:P2LMOD-MODU-MDSE-TYP-CDE                            05290001
059000         FROM                                                     05300001
059100             TP2LMOD                                              05310001
059200         WHERE                                                    05320001
059300             OPER_UNT_ID              = :DK-OPER-UNT-ID           05330001
059400         AND FCLTY_ID                 = 1                         05340001
059500         AND MODU_NBR                 = :DK-MODU-NBR              05350001
059600         WITH UR                                                  05360001
059700     END-EXEC.                                                    05370001
059800                                                                  05380001
059900     EVALUATE TRUE                                                05390001
060000         WHEN SQLCODE = ZERO                                      05400001
060100             CONTINUE                                             05410001
060200         WHEN SQLCODE = +100                                      05420001
060300             MOVE '7050-'             TO PV-ERROR-PARA            05430001
060400             MOVE 'STR ZN NOTFOUND'   TO PV-ERROR-TEXT            05440001
060500             PERFORM 9700-SQL-ERROR                               05450001
060600             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           05460001
060700             MOVE DK-MODU-NBR         TO PV-MSG-MODU              05470001
060800             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               05480001
060900             PERFORM 9900-WRITE-LOG                               05490002
061000                                                                  05500001
061100         WHEN SQLCODE = -904                                      05510001
061200         WHEN SQLCODE = -913                                      05520001
061300         WHEN SQLCODE = -911                                      05530001
061400             MOVE '7050-'             TO PV-ERROR-PARA            05540001
061500             MOVE 'SQL ERROR - TP2LMOD'                           05550001
061600                                      TO PV-ERROR-TEXT            05560001
061700             PERFORM 9700-SQL-ERROR                               05570001
061800             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           05580001
061900             MOVE DK-MODU-NBR         TO PV-MSG-MODU              05590001
062000             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               05600001
062100             PERFORM 9900-WRITE-LOG                               05610002
062200                                                                  05620001
062300         WHEN SQLWARN0 NOT = SPACES                               05630001
062400         WHEN SQLCODE NOT = ZERO                                  05640001
062500             MOVE '7050-'             TO PV-ERROR-PARA            05650001
062600             MOVE 'SQL ERROR - TP2LMOD'                           05660001
062700                                      TO PV-ERROR-TEXT            05670001
062800             PERFORM 9700-SQL-ERROR                               05680001
062900             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           05690001
063000             MOVE DK-MODU-NBR         TO PV-MSG-MODU              05700001
063100             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               05710001
063200             PERFORM 9900-WRITE-LOG                               05720002
063300                                                                  05730001
063400     END-EVALUATE.                                                05740001
063500     IF KRPRPM-FUNC-TXT = 'Y'                                     05750001
063600         MOVE ' PCKUT073 END 7050- PARA '     TO PV-LOG-MSG       05760009
063700         PERFORM 9900-WRITE-LOG                                   05770002
063800     END-IF.                                                      05780001
063900/                                                                 05790001
064000 7100-INSERT-CART-VLDN.                                           05800001
064100     IF KRPRPM-FUNC-TXT = 'Y'                                     05810001
064200         MOVE ' PCKUT073 7100- PARA '  TO PV-LOG-MSG              05820009
064300         PERFORM 9900-WRITE-LOG                                   05830002
064400     END-IF.                                                      05840001
064500                                                                  05850001
064600******************************************                        05860001
064700* MOVE EITHER KOHLS OR TEMPERARY USER ID *                        05870001
064800*   TO DCLGEN FIELDS                     *                        05880001
064900******************************************                        05890001
065000                                                                  05900001
065110     IF PV-KOHLS-ASSOC                                            05910001
065200         MOVE PV-USER-ID          TO DLT00010-USR-ID              05920001
065300     ELSE                                                         05930001
065400         MOVE PV-USER-ID          TO DLT00010-TMP-USR-ID          05940001
065500     END-IF.                                                      05950001
065600                                                                  05960001
065700     MOVE PC244-TAG-BAR-CODE-NBR  TO DLT00010-CART-ID.            05970001
065800     MOVE PC244-DC-NBR            TO DLT00010-LOC-NBR.            05980001
065900                                                                  05990001
066000******************************************                        06000001
066100* INSERT KOHLS TYPE 'TK' REGULAR USER ID *                        06010001
066200******************************************                        06020001
066310     IF PV-KOHLS-ASSOC                                            06030001
066400       EXEC SQL                                                   06040001
066500         INSERT                                                   06050001
066600         INTO DLT_P2L_CART_VLDN                                   06060001
066700         (                                                        06070001
066800             USR_ID                                               06080001
066900            ,CART_ID                                              06090001
067000            ,LOC_NBR                                              06100001
067100            ,CRE_TMST                                             06110001
067200            ,TMP_USR_ID                                           06120001
067300         )                                                        06130001
067400         VALUES                                                   06140001
067500         (                                                        06150001
067600             :DLT00010-USR-ID                                     06160001
067700         ,   :DLT00010-CART-ID                                    06170001
067800         ,   :DLT00010-LOC-NBR                                    06180001
067900         ,    CURRENT TIMESTAMP                                   06190001
068000         ,    NULL                                                06200001
068100         )                                                        06210001
068200       END-EXEC                                                   06220001
068300     ELSE                                                         06230001
068400********************************************                      06240001
068500* INSERT KOHLS TYPE 'TP' TEMPERARY USER ID *                      06250001
068600********************************************                      06260001
068700       EXEC SQL                                                   06270001
068800         INSERT                                                   06280001
068900         INTO DLT_P2L_CART_VLDN                                   06290001
069000         (                                                        06300001
069100             USR_ID                                               06310001
069200            ,CART_ID                                              06320001
069300            ,LOC_NBR                                              06330001
069400            ,CRE_TMST                                             06340001
069500            ,TMP_USR_ID                                           06350001
069600         )                                                        06360001
069700         VALUES                                                   06370001
069800         (                                                        06380001
069900              NULL                                                06390001
070000         ,   :DLT00010-CART-ID                                    06400001
070100         ,   :DLT00010-LOC-NBR                                    06410001
070200         ,    CURRENT TIMESTAMP                                   06420001
070300         ,   :DLT00010-TMP-USR-ID                                 06430001
070400         )                                                        06440001
070500       END-EXEC                                                   06450001
070600     END-IF.                                                      06460001
070700                                                                  06470001
070800     EVALUATE TRUE                                                06480001
070900         WHEN SQLCODE = ZERO OR -530                              06490001
071000             SET PS-DUP-CTN-NO        TO TRUE                     06500001
071100         WHEN SQLCODE = -803                                      06510001
071200             SET PS-DUP-CTN-YES       TO TRUE                     06520001
071300*            MOVE DLT00010-USR-ID     TO PV-MSG-USER-CHEAT        06530001
071400*            MOVE DLT00010-CART-ID    TO PV-MSG-CART-CHEAT        06540001
071500*            MOVE DLT00010-LOC-NBR    TO PV-MSG-DC-CHEAT          06550001
071600*            MOVE PV-LABOR-CHEAT-TEXT TO PV-LOG-MSG               06560001
071700*            PERFORM 9900-WRITE-LOG                               06570002
071800                                                                  06580001
071900         WHEN SQLCODE = -904                                      06590001
072000         WHEN SQLCODE = -913                                      06600001
072100         WHEN SQLCODE = -911                                      06610001
072200             SET PS-ERROR-YES         TO TRUE                     06620001
072300             MOVE '7100-'             TO PV-ERROR-PARA            06630001
072400             MOVE 'SQL ERROR - DLT00010'                          06640001
072500                                      TO PV-ERROR-TEXT            06650001
072600             PERFORM 9700-SQL-ERROR                               06660001
072700             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           06670001
072800             MOVE DK-MODU-NBR         TO PV-MSG-MODU              06680001
072900             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               06690001
073000             PERFORM 9900-WRITE-LOG                               06700002
073100                                                                  06710001
073200         WHEN SQLWARN0 NOT = SPACES                               06720001
073300         WHEN SQLCODE NOT = ZERO                                  06730001
073400             SET PS-ERROR-YES         TO TRUE                     06740001
073500             MOVE '7100-'             TO PV-ERROR-PARA            06750001
073600             MOVE 'SQL ERROR - DLT00010'                          06760001
073700                                      TO PV-ERROR-TEXT            06770001
073800             PERFORM 9700-SQL-ERROR                               06780001
073900             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           06790001
074000             MOVE DK-MODU-NBR         TO PV-MSG-MODU              06800001
074100             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               06810001
074200             PERFORM 9900-WRITE-LOG                               06820002
074300                                                                  06830001
074400     END-EVALUATE.                                                06840001
074500                                                                  06850001
074600     IF KRPRPM-FUNC-TXT = 'Y'                                     06860001
074700         MOVE ' PCKUT073 END 7100- PARA '     TO PV-LOG-MSG       06870009
074800         PERFORM 9900-WRITE-LOG                                   06880002
074900     END-IF.                                                      06890001
075000/                                                                 06900001
075100 7200-KOHLS-USER.                                                         
075200                                                                          
075300     IF KRPRPM-FUNC-TXT = 'Y'                                     07920001
075400         MOVE ' PCKUT073 START 7200- PARA '     TO PV-LOG-MSG     07930008
075500         PERFORM 9900-WRITE-LOG                                   07940002
075600     END-IF.                                                      07950001
075700                                                                  07960001
075800     SET PS-USER-FOUND-NO             TO TRUE                             
075900     MOVE PV-USER-ID                  TO XLT00024-USR-ID                  
076000                                                                          
076100                                                                          
076200     EXEC SQL                                                             
076300         SELECT  'Y'                                                      
076400              INTO  :PS-USER-FOUND-SW                                     
076500              FROM   XLT_USR    USR                                       
076600          WHERE  USR.USR_ID       = :XLT00024-USR-ID                      
076700          WITH UR                                                         
076800     END-EXEC                                                             
076900                                                                          
077000     EVALUATE TRUE                                                        
077100         WHEN SQLCODE = ZERO                                              
077200             SET XL067-USER-IS-KOHLS  TO TRUE                             
077300                                                                          
077400              IF KRPRPM-FUNC-TXT = 'Y'                                    
077500                 MOVE ' PCKUT073 START 7200- KOHLS ASSOCIATE'             
077600                                            TO PV-LOG-MSG                 
077700                 PERFORM 9900-WRITE-LOG                                   
077800               END-IF                                                     
077900                                                                          
078000         WHEN SQLCODE = +100                                              
078100                                                                          
078200              IF KRPRPM-FUNC-TXT = 'Y'                                    
078300                 MOVE ' PCKUT073 START 7200- NOT KOHLS ASSOCIATE'         
078400                                            TO PV-LOG-MSG                 
078500                 PERFORM 9900-WRITE-LOG                                   
078600               END-IF                                                     
078700                                                                          
078800             PERFORM 7205-TEMP-USER                                       
078900                                                                          
079000         WHEN SQLCODE = -904                                              
079100         WHEN SQLCODE = -911                                              
079200         WHEN SQLCODE = -913                                              
079300         WHEN SQLWARN0 NOT = SPACES                                       
079400              AND SQLCODE NOT = ZERO                                      
079500                                                                  08303023
079600             SET PS-ERROR-YES         TO TRUE                             
079700             MOVE SQLCODE             TO  PV-DISP-SQLCODE         08304023
079800             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            08305023
079900             DISPLAY ' PCKUT073 - 7200 - '                        08306023
080000                     ' SQLCODE: '         PV-DISP-SQLCODE         08307023
080100                     ' TP2LMOD '                                  08308023
080200             DISPLAY ' PCKUT073 - 7200 - '                        08309023
080300                     ' OPER: '            PV-DISP-OPER            08309123
080400                     ' MODULE: '          DK-MODU-NBR             08309223
080500                                                                  08309323
080600             MOVE '7200-'             TO PV-ERROR-PARA            08310001
080700             MOVE 'SQL ERROR - TP2LMOD'                           08320001
080800                                      TO PV-ERROR-TEXT            08330001
080900             PERFORM 9700-SQL-ERROR                               08340001
081000             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           08350001
081100             MOVE DK-MODU-NBR         TO PV-MSG-MODU              08360001
081200             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               08370001
081300             PERFORM 9900-WRITE-LOG                               08380002
081400                                                                  08390001
081500     END-EVALUATE.                                                        
081600/                                                                 08570001
081700 7205-TEMP-USER.                                                  08570001
081800                                                                          
081900     IF KRPRPM-FUNC-TXT = 'Y'                                     07920001
082000         MOVE ' PCKUT073 START 7205- PARA '     TO PV-LOG-MSG     07930008
082100         PERFORM 9900-WRITE-LOG                                   07940002
082200     END-IF.                                                      07950001
082300                                                                  07960001
082400                                                                          
082500     SET PS-USER-FOUND-NO             TO TRUE                             
082600     MOVE PV-USER-ID                  TO DLT00002-TMP-USR-ID              
082700                                                                          
082800     EXEC SQL                                                             
082900         SELECT  'Y'                                                      
083000              INTO  :PS-USER-FOUND-SW                                     
083100              FROM   DLT_TMP_EMP                                          
083200          WHERE  TMP_USR_ID       = :DLT00002-TMP-USR-ID                  
083300          WITH UR                                                         
083400     END-EXEC                                                             
083500                                                                          
083600     EVALUATE TRUE                                                        
083700         WHEN SQLCODE = ZERO                                              
083800             SET XL067-USER-IS-TEMP TO TRUE                               
083900                                                                          
084000              IF KRPRPM-FUNC-TXT = 'Y'                                    
084100                 MOVE ' PCKUT073 START 7205- TEMP ASSOCIATE'              
084200                                            TO PV-LOG-MSG                 
084300                 PERFORM 9900-WRITE-LOG                                   
084400               END-IF                                                     
084500                                                                          
084600                                                                          
084700         WHEN SQLCODE = +100                                              
084800             SET PS-ERROR-YES                                     02900001
084900                 XL067-USER-NOT-FOUND                                     
084910                 PC244-UNKNOWN-USER   TO TRUE                             
085000                                                                          
085100              IF KRPRPM-FUNC-TXT = 'Y'                                    
085200                 MOVE ' PCKUT073 START 7205- NOT FOUND ASSOC'             
085300                                            TO PV-LOG-MSG                 
085400                 PERFORM 9900-WRITE-LOG                                   
085500               END-IF                                                     
085600                                                                          
085700         WHEN SQLCODE = -904                                              
085800         WHEN SQLCODE = -911                                              
085900         WHEN SQLCODE = -913                                              
086000         WHEN SQLWARN0 NOT = SPACES                                       
086100              AND SQLCODE NOT = ZERO                                      
086200                                                                  08303023
086300             MOVE SQLCODE             TO  PV-DISP-SQLCODE         08304023
086400             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            08305023
086500             DISPLAY ' PCKUT073 - 7205 - '                        08306023
086600                     ' SQLCODE: '         PV-DISP-SQLCODE         08307023
086700                     ' TP2LMOD '                                  08308023
086800             DISPLAY ' PCKUT073 - 7205 - '                        08309023
086900                     ' OPER: '            PV-DISP-OPER            08309123
087000                     ' MODULE: '          DK-MODU-NBR             08309223
087100                                                                  08309323
087200             MOVE '7205-'             TO PV-ERROR-PARA            08310001
087300             MOVE 'SQL ERROR - TP2LMOD'                           08320001
087400                                      TO PV-ERROR-TEXT            08330001
087500             PERFORM 9700-SQL-ERROR                               08340001
087600             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           08350001
087700             MOVE DK-MODU-NBR         TO PV-MSG-MODU              08360001
087800             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               08370001
087900             PERFORM 9900-WRITE-LOG                               08380002
088000                                                                  08390001
088100     END-EVALUATE.                                                        
088200/                                                                 08570001
088300 8400-CALL-DLKUP024.                                              06920017
088400     IF KRPRPM-FUNC-TXT = 'Y'                                     06930001
088500         MOVE ' PCKUT073 START 8400- PARA '     TO PV-LOG-MSG     06940009
088600         PERFORM 9900-WRITE-LOG                                   06950002
088700     END-IF.                                                      06960001
088800                                                                  06970001
088900     INITIALIZE DL020-ASGMT-COMMAREA.                             06980012
089000                                                                  06990001
089100     SET DL020-BY-ASGMT-KEY                                       07000012
089200         DL020-COMMIT-UPDATE                                      07010012
089300         DL020-FIND-NEXT-ASGMT        TO TRUE.                    07020012
089400                                                                  07030001
089500     MOVE DL019-ESO-ASGMT-START-DTE   TO DL020-KEY-START-DTE      07040012
089600                                         PV-LABOR-ASGMT-STRT-DTE. 07050001
089700     MOVE DL019-ESO-ASGMT-NBR-TXT     TO DL020-KEY-NBR-TXT        07060012
089800                                         PV-LABOR-ASGMT-NBR-TXT.  07070001
089900     MOVE DL019-ESO-ASGMT-NBR-SEQ-NBR TO DL020-KEY-NBR-SEQ-NBR    07080012
090000                                       PV-LABOR-ASGMT-NBR-SEQ-NBR.07090001
090100                                                                  07100001
090200     MOVE 1                          TO DL020-NBR-OF-NBRS-NEED-QTY07110012
090300     MOVE 'PCKUT073'                  TO DL020-ORIG-CALLING-PGM-NM07120012
090400                                                                  07130001
090500     CALL DL020-USER-PGM USING DL020-ASGMT-COMMAREA.              07140012
090600                                                                  07150001
090700     IF DL020-SUCCESSFUL                                          07160012
090800         IF DL020-ASGMT-NEXT-USED                                 07170012
090900             MOVE DL020-NXT-START-DTE                             07180012
091000                                   TO PV-LABOR-ASGMT-STRT-DTE     07190001
091100             MOVE DL020-NXT-NBR-TXT                               07200012
091200                                   TO PV-LABOR-ASGMT-NBR-TXT      07210001
091300             MOVE DL020-NXT-NBR-SEQ-NBR                           07220012
091400                                   TO PV-LABOR-ASGMT-NBR-SEQ-NBR  07230001
091500             MOVE DL020-SEQ-START-NBR                             07240012
091600                                   TO PV-LABOR-SEQ-START-NBR      07250001
091700         ELSE                                                     07260001
091800             MOVE DL020-SEQ-START-NBR                             07270012
091900                                   TO PV-LABOR-SEQ-START-NBR      07280001
092000         END-IF                                                   07290001
092100                                                                  07300001
092200     ELSE                                                         07310001
092300         MOVE '8400-'                 TO PV-ERROR-PARA            07320001
092400         MOVE 'SQL ERROR IN DLKUP024'                             07330017
092500                                      TO PV-ERROR-TEXT            07340001
092600         MOVE DL020-SQLCA             TO SQLCA                    07350012
092700         PERFORM 9700-SQL-ERROR                                   07360001
092800                                                                  07370001
092900         MOVE DL020-KEY-START-DTE     TO PV-DLKUP024-DATE         07380017
093000         MOVE DL020-KEY-NBR-TXT       TO PV-DLKUP024-TXT          07390017
093100         MOVE DL020-KEY-NBR-SEQ-NBR   TO PV-DLKUP024-SEQ          07400017
093200         MOVE PV-DLKUP024-TEXT        TO PV-LOG-MSG               07410017
093300         PERFORM 9900-WRITE-LOG                                   07420002
093400                                                                  07430001
093500         STRING ' PARA= '                                         07440001
093600                DL020-SQL-ERROR-PARA                              07450012
093700                 ' PGM= '                                         07460001
093800               DL020-CALL-MOD-FAIL-NM                             07470012
093900                 ' ERR CODE= '                                    07480001
094000               DL020-CALL-MOD-FAIL-ERR-CDE                        07490012
094100                 DELIMITED BY SIZE INTO PV-LOG-MSG                07500001
094200         PERFORM 9900-WRITE-LOG                                   07510002
094300                                                                  07520001
094400     END-IF.                                                      07530001
094500     IF KRPRPM-FUNC-TXT = 'Y'                                     07540001
094600         MOVE ' PCKUT073 END 8400- PARA '     TO PV-LOG-MSG       07550009
094700         PERFORM 9900-WRITE-LOG                                   07560002
094800     END-IF.                                                      07570001
094900/                                                                 07580001
095000 8410-CALL-XLKUP046.                                              07590017
095100     IF KRPRPM-FUNC-TXT = 'Y'                                     07600001
095200         MOVE ' PCKUT073 START 8410- PARA '     TO PV-LOG-MSG     07610009
095300         PERFORM 9900-WRITE-LOG                                   07620002
095400     END-IF.                                                      07630001
095500                                                                  07640001
095600     INITIALIZE XL091-EAI-EXPORT-COMMAREA                         07650012
095700                PC242-DTL-TXT-AREA.                               07660001
095800                                                                  07670001
095900     SET XL091-PC-APP-ID          TO TRUE.                        07680012
096000     SET XL091-COMMIT-UPDATE      TO TRUE.                        07690012
096100                                                                  07700001
096200     MOVE 'PCKUT073'              TO XL091-ORIG-CALLING-PGM-NM.   07710012
096300     MOVE 'PACKTOLIGHT'           TO XL091-EVNT-OBJ-TXT.          07720012
096400     MOVE 'INBOUND LAUNCH'        TO XL091-EVNT-OBJ-ACTN-TXT.     07730012
096500     MOVE PV-USER-ID              TO XL091-CRE-BY-USR-ID.         07740012
096600     MOVE 'PCKUT073'              TO XL091-CRE-PGM-NM.            07750012
096700                                                                  07760001
096800     MOVE PC244-DC-NBR            TO XL091-EVNT-KY-1-NBR.         07770012
096900     MOVE PC244-HDR-ORD-NBR       TO XL091-EVNT-KY-2-NBR.         07780012
097000     MOVE PC244-HDR-RCVR-SEQ-NBR  TO XL091-EVNT-KY-3-NBR.         07790012
097100     MOVE PC244-HDR-ORD-LNE-NBR   TO XL091-EVNT-KY-4-NBR.         07800012
097200                                                                  07810001
097300     MOVE DK-MODU-NBR             TO XL091-EVNT-KY-1-TXT.         07820012
097400     MOVE PC244-TAG-BAR-CODE-NBR  TO XL091-EVNT-KY-2-TXT.         07830012
097500                                                                  07840001
097600     MOVE PC244-LAUNCH-DATE-YYYY  TO PV-START-CCYY.               07850001
097700     MOVE PC244-LAUNCH-DATE-MM    TO PV-START-MM.                 07860001
097800     MOVE PC244-LAUNCH-DATE-DD    TO PV-START-DD.                 07870001
097900                                                                  07880001
098000     MOVE PC244-LAUNCH-TIME-HH    TO PV-START-HOUR-N.             07890001
098100     MOVE PC244-LAUNCH-TIME-MM    TO PV-START-MIN.                07900001
098200     MOVE PC244-LAUNCH-TIME-SS    TO PV-START-SEC.                07910001
098300     MOVE PV-START-TIMESTAMP      TO XL091-EVNT-KY-1-TMST.        07920012
098400                                                                  07930001
098500*    POPULATE DETAIL AREA                                         07940001
098600     SET XL091-PCWS242-COPYBOOK TO TRUE.                          07950012
098700                                                                  07960001
098800     INITIALIZE PC242-DTL-TXT-AREA.                               07970001
098900                                                                  07980001
099000     SET PC242-P2L-SCAN-INBND-CRTN    TO TRUE.                    07990001
099100                                                                  08000001
099200     MOVE PV-LABOR-ASGMT-STRT-DTE     TO PC242-AK-ASGMT-STRT-DTE. 08010001
099300     MOVE PV-LABOR-ASGMT-NBR-TXT      TO PC242-AK-ASGMT-NBR-TXT.  08020001
099400     MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR  TO                          08030001
099500                                   PC242-AK-ASGMT-NBR-SEQ-NBR.    08040001
099600     MOVE PV-LABOR-SEQ-START-NBR      TO                          08050001
099700                                   PC242-AK-ASGMT-SEQ-DTL-NBR.    08060001
099800                                                                  08070001
099900     MOVE P2LMOD-DFLT-STR-ZN-ID TO PC242-AK-STR-ZN-ID.            08080001
100000                                                                  08090001
100100     MOVE PC242-DTL-TXT-AREA          TO XL091-DTL-TXT.           08100012
100200                                                                  08110001
100300     CALL XL091-USER-PGM USING XL091-EAI-EXPORT-COMMAREA.         08120012
100400                                                                  08130001
100500     IF XL091-SUCCESSFUL                                          08140012
100600        CONTINUE                                                  08150001
100700     ELSE                                                         08160001
100800         MOVE PV-USER-ID              TO PV-XLKUP046-USER         08170017
100900                                                                  08180001
101000         MOVE 'PACKTOLIGHT'           TO PV-XLKUP046-OBJTXT       08190017
101100         MOVE PV-XLKUP046-TEXT1       TO PV-LOG-MSG               08200017
101200         PERFORM 9900-WRITE-LOG                                   08210002
101300                                                                  08220001
101400         MOVE 'INBOUND LAUNCH'        TO PV-XLKUP046-OBJACTNTXT   08230017
101500         MOVE PV-XLKUP046-TEXT2       TO PV-LOG-MSG               08240017
101600         PERFORM 9900-WRITE-LOG                                   08250002
101700                                                                  08260001
101800         IF XL091-SQL-ERROR                                       08270012
101900             MOVE '8410-'             TO PV-ERROR-PARA            08280001
102000             MOVE 'SQL ERROR IN XLKUP046'                         08290017
102100                                      TO PV-ERROR-TEXT            08300001
102200             MOVE XL091-SQLCA         TO SQLCA                    08310012
102300             PERFORM 9700-SQL-ERROR                               08320001
102400                                                                  08330001
102500         END-IF                                                   08340001
102600                                                                  08350001
102700     END-IF.                                                      08360001
102800     IF KRPRPM-FUNC-TXT = 'Y'                                     08370001
102900         MOVE ' PCKUT073 END 8410- PARA '     TO PV-LOG-MSG       08380009
103000         PERFORM 9900-WRITE-LOG                                   08390002
103100     END-IF.                                                      08400001
103200/                                                                 08410001
103300 8450-LINK-DLKUT410.                                              08420011
103400     IF KRPRPM-FUNC-TXT = 'Y'                                     08430001
103500         MOVE ' PCKUT073 START 8450- PARA '     TO PV-LOG-MSG     08440009
103600         PERFORM 9900-WRITE-LOG                                   08450002
103700     END-IF.                                                      08460001
103800                                                                  08470001
103900     INITIALIZE DL019-PGM-COMMAREA.                               08480011
104000                                                                  08490001
104100     SET DL019-ESTABLISH-ASGMT        TO TRUE.                    08500011
104200     SET DL019-COMMIT-UPDATE          TO TRUE.                    08510011
104300     MOVE 'PCKUT073'                  TO DL019-CALLING-PGM-NM.    08520011
104400     MOVE PV-USER-ID                  TO DL019-SIGN-ON-USR-ID.    08530011
104500                                                                  08540001
104600     SET DL011-AN-P2L-WRK-TYP         TO TRUE.                    08550001
104700*    SET DL011-AN-P2L1-WRK-TYP        TO TRUE.                    08560001
104800     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL019-ASGMT-NBR-WRK-TYP. 08570011
104900                                                                  08580001
105000     SET DL011-P2L-WRK-TYP            TO TRUE.                    08590001
105100*    SET DL011-P2L1-WRK-TYP           TO TRUE.                    08600001
105200     MOVE DL011-KEY-WK-TYP            TO DL019-EAI-WK-TYP-DESC.   08610011
105300                                                                  08620001
105400     MOVE P2LMOD-DFLT-STR-ZN-ID       TO DL011-P2-WRK-AREA-5-9.   08630001
105500     MOVE P2LMOD-MODU-NBR             TO DL011-P2-WRK-AREA-MOD-4-608640001
105600     MOVE DL011-P2L-MOD-WRK-AREA      TO DL019-EAI-WK-AREA-DESC.  08650011
105700                                                                  08660001
105800     MOVE PC244-DC-NBR                TO DL019-EAI-DC-NBR.        08670011
105900                                                                  08680001
106000     MOVE PV-USER-ID                  TO DL019-EAI-CRE-BY-USR-ID. 08690011
106100                                                                  08700001
106200                                                                  08710001
106300*    THIS IS KNOWN FROM THE VERIFICATION OF THE USERID            08720001
106400     IF XL067-USER-IS-KOHLS                                       08730001
106500         SET DL019-EAI-USR-IS-KOHLS   TO TRUE                     08740011
106600     ELSE                                                         08750001
106700         SET DL019-EAI-USR-IS-TMP     TO TRUE                     08760011
106800     END-IF.                                                      08770001
106900                                                                  08780001
107000     CALL DL019-USER-PGM USING DL019-PGM-COMMAREA.                08790011
107100                                                                  08800001
107200     EVALUATE TRUE                                                08810001
107300         WHEN DL019-SUCCESSFUL                                    08820011
107400                 CONTINUE                                         08830001
107500                                                                  08840001
107600         WHEN DL019-SQL-ERROR                                     08850011
107700***                                                               08850124
107800*** DMH ADDED DISPLAYS - 8/21/2007                                08850224
107900***                                                               08850324
108000             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           08850424
108100             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        08850524
108200             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    08850628
108300                                       TO  PV-DISP-SQLCODE-3      08850728
108400             DISPLAY ' PCKUT073 - 8450 - CALL TO DLKUT410 - '     08850828
108500             DISPLAY ' PCKUT073 - DLWS019 '                       08850928
108600                     ' PROCESS CODE:'   DL019-PROCESS-CDE         08851028
108700                     ' COMMIT CODE:'    DL019-COMMIT-CDE          08851128
108800                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      08851228
108900                     ' USER ID:'        DL019-SIGN-ON-USR-ID      08851328
109000                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   08851428
109100             DISPLAY ' PCKUT073 - DLWS019 '                       08851528
109200                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     08851628
109300                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    08851728
109400                     ' DC:'             PV-DISP-OPER              08851828
109500                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   08851928
109600                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     08852028
109700             DISPLAY ' PCKUT073 - DLWS019 '                       08852128
109800                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 08852228
109900             DISPLAY ' PCKUT073 - DLWS019 '                       08852328
110000                     ' RETURN CODE:'     DL019-RETURN-CODE        08852428
110100                     ' SQLCODE:'         PV-DISP-SQLCODE          08852528
110200                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    08852628
110300                     '-'          DL019-CALL-MOD-FAIL-NM          08852728
110400                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     08852828
110500                     '-'          PV-DISP-SQLCODE-3               08852928
110600***                                                               08853028
110700             SET PC244-SQL-ERROR                                  08861001
110800                 PS-ERROR-YES         TO TRUE                     08870001
110900             MOVE '8450-'             TO PV-ERROR-PARA            08880001
111000             MOVE 'SQL ERROR IN DLKUT410'                         08890011
111100                                      TO PV-ERROR-TEXT            08900001
111200             MOVE DL019-SQLCA         TO SQLCA                    08910011
111300             PERFORM 9700-SQL-ERROR                               08920001
111400                                                                  08930001
111500         WHEN DL019-CALLED-MODULE-FAILURE AND                     08940011
111600              DL019-CALL-MOD-FAIL-SQL-PARA NOT = SPACES           08950011
111700***                                                               08950124
111800*** DMH ADDED DISPLAYS - 8/21/2007                                08950224
111900***                                                               08950324
112000             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           08950424
112100             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        08950524
112200             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    08950628
112300                                       TO  PV-DISP-SQLCODE-3      08950728
112400             DISPLAY ' PCKUT073 - 8450 - CALL TO DLKUT410 - '     08950824
112500             DISPLAY ' PCKUT073 - DLWS019 '                       08950924
112600                     ' PROCESS CODE:'   DL019-PROCESS-CDE         08951024
112700                     ' COMMIT CODE:'    DL019-COMMIT-CDE          08951124
112800                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      08951224
112900                     ' USER ID:'        DL019-SIGN-ON-USR-ID      08951324
113000                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   08951424
113100             DISPLAY ' PCKUT073 - DLWS019 '                       08951524
113200                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     08951624
113300                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    08951724
113400                     ' DC:'             PV-DISP-OPER              08951824
113500                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   08951924
113600                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     08952024
113700             DISPLAY ' PCKUT073 - DLWS019 '                       08952124
113800                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 08952224
113900             DISPLAY ' PCKUT073 - DLWS019 '                       08952324
114000                     ' RETURN CODE:'     DL019-RETURN-CODE        08952425
114100                     ' SQLCODE:'         PV-DISP-SQLCODE          08952524
114200                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    08952624
114300                     '-'          DL019-CALL-MOD-FAIL-NM          08952724
114400                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     08952824
114500                     '-'          PV-DISP-SQLCODE-3               08952928
114600***                                                               08953024
114700                                                                  08961001
114800             MOVE '8450-'             TO PV-ERROR-PARA            08970001
114900             SET PC244-SQL-ERROR      TO TRUE                     08980001
115000                                                                  08990001
115100*            HANDLE EACH KIND OF SQL ERROR AS NEEDED              09000001
115200             MOVE DL019-CALL-MOD-FAIL-SQL-CDE                     09010011
115300                                      TO SQLCODE                  09020001
115400                                                                  09030001
115500             IF SQLCODE = ZERO                                    09040001
115600                 CONTINUE                                         09050001
115700             ELSE                                                 09060001
115800                 PERFORM 8451-ERROR                               09070001
115900             END-IF                                               09080001
116000                                                                  09090001
116100         WHEN DL019-INVALID-ACCESS                                09100011
116200***                                                               09101021
116300***  DMH ADD DISPLAYS - 8/21/2007                                 09102021
116400***                                                               09103021
116500             MOVE DL019-ASGMT-SQLCODE TO PV-DISP-SQLCODE          09104021
116600             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    09104128
116700                                       TO  PV-DISP-SQLCODE-3      09104228
116800             DISPLAY ' PCKUT073 - 8450 - '                        09105021
116900                     ' SQLCODE: ' PV-DISP-SQLCODE                 09106022
117000             DISPLAY ' PCKUT073 - 8450 - '                        09107021
117100                     ' CALL TO DLKUT410 '                         09108021
117200                     ' PROCESS CODE:' DL019-PROCESS-CDE           09109021
117300                     ' COMMIT CODE:'  DL019-COMMIT-CDE            09109121
117400                     ' CALLING PGM:'  DL019-CALLING-PGM-NM        09109221
117500             DISPLAY ' PCKUT073 - 8450 - '                        09109321
117600                     ' ASGMT FIELDS: '                            09109421
117700                                    DL019-EST-ASGMT-INPUT-FIELDS  09109521
117800             DISPLAY ' PCKUT073 - 8450 - '                        09109621
117900                     ' TEAM FIELDS: '                             09109721
118000                                    DL019-EST-TEAM-INPUT-FIELDS   09109821
118100             DISPLAY ' PCKUT073 - 8450 - '                        09109921
118200                     ' RETURN CODE: ' DL019-RETURN-CODE           09110021
118300                     ' PARA: ' DL019-CALL-MOD-FAIL-SQL-PARA       09110121
118400                     ' MOD FAIL NM:'  DL019-CALL-MOD-FAIL-NM      09110221
118500                     ' MOD FAIL ERR:' DL019-CALL-MOD-FAIL-ERR-CDE 09110321
118600                     ' MOD FAIL SQL:' PV-DISP-SQLCODE-3           09110428
118700***                                                               09110521
118800             SET PS-ERROR-YES         TO TRUE                     09111001
118900             MOVE '8450-'             TO PV-ERROR-PARA            09120001
119000             MOVE 'INVALID ACCESS - DLKUT410'                     09130011
119100                                      TO PV-ERROR-TEXT            09140001
119200             PERFORM 9001-GENERIC-ERROR                           09150001
119300                                                                  09160001
119400                                                                  09170001
119500         WHEN OTHER                                               09180001
119600***                                                               09181021
119700***  DMH ADD DISPLAYS - 8/21/2007                                 09182021
119800***                                                               09183021
119900             MOVE DL019-ASGMT-SQLCODE TO PV-DISP-SQLCODE          09184021
120000             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    09185028
120100                                       TO  PV-DISP-SQLCODE-3      09185128
120200             DISPLAY ' PCKUT073 - 8450 - '                        09186021
120300                     ' SQLCODE: ' PV-DISP-SQLCODE                 09187022
120400             DISPLAY ' PCKUT073 - 8450 - '                        09188021
120500                     ' CALL TO DLKUT410 '                         09189021
120600                     ' PROCESS CODE:' DL019-PROCESS-CDE           09189121
120700                     ' COMMIT CODE:'  DL019-COMMIT-CDE            09189221
120800                     ' CALLING PGM:'  DL019-CALLING-PGM-NM        09189321
120900             DISPLAY ' PCKUT073 - 8450 - '                        09189421
121000                     ' ASGMT FIELDS: '                            09189521
121100                                    DL019-EST-ASGMT-INPUT-FIELDS  09189621
121200             DISPLAY ' PCKUT073 - 8450 - '                        09189721
121300                     ' TEAM FIELDS: '                             09189821
121400                                    DL019-EST-TEAM-INPUT-FIELDS   09189921
121500             DISPLAY ' PCKUT073 - 8450 - '                        09190021
121600                     ' RETURN CODE: ' DL019-RETURN-CODE           09190121
121700                     ' PARA: ' DL019-CALL-MOD-FAIL-SQL-PARA       09190221
121800                     ' MOD FAIL NM:'  DL019-CALL-MOD-FAIL-NM      09190321
121900                     ' MOD FAIL ERR:' DL019-CALL-MOD-FAIL-ERR-CDE 09190421
122000                     ' MOD FAIL SQL:' PV-DISP-SQLCODE-3           09190528
122100***                                                               09190721
122200             SET PS-ERROR-YES         TO TRUE                     09191001
122300             MOVE '8450-'             TO PV-ERROR-PARA            09200001
122400             STRING                                               09210001
122500                  'DLKUT410 - ERROR= '                            09220011
122600                  DL019-RETURN-CODE                               09230011
122700                  ' / MODULE= ' DL019-CALL-MOD-FAIL-NM            09240011
122800                  DELIMITED BY SIZE                               09250001
122900                                    INTO PV-ERROR-TEXT            09260001
123000             PERFORM 9001-GENERIC-ERROR                           09270001
123100     END-EVALUATE.                                                09280001
123200     IF KRPRPM-FUNC-TXT = 'Y'                                     09290001
123300         MOVE ' PCKUT073 END 8450- PARA '     TO PV-LOG-MSG       09300009
123400         PERFORM 9900-WRITE-LOG                                   09310002
123500     END-IF.                                                      09320001
123600                                                                  09330001
123700 8451-ERROR.                                                      09340001
123800     IF KRPRPM-FUNC-TXT = 'Y'                                     09350001
123900         MOVE ' PCKUT073 START 8451- PARA '     TO PV-LOG-MSG     09360009
124000         PERFORM 9900-WRITE-LOG                                   09370002
124100     END-IF.                                                      09380001
124200     PERFORM 9001-GENERIC-ERROR.                                  09390001
124300     MOVE  DL019-CALL-MOD-FAIL-SQL-CDE TO PV-DISP-SQLCODE-3       09391028
124400     STRING 'MODULE ERROR - '                                     09400001
124500         DL019-CALL-MOD-FAIL-SQL-PARA                             09410011
124600      ' / ' DL019-CALL-MOD-FAIL-NM                                09420011
124700      ' / '   DL019-CALL-MOD-FAIL-ERR-CDE                         09430011
124800      ' / '   PV-DISP-SQLCODE-3                                   09440028
124900         DELIMITED BY SIZE                                        09450001
125000         INTO PV-LOG-MSG.                                         09460001
125100     PERFORM 9900-WRITE-LOG.                                      09470002
125200                                                                  09480001
125300     MOVE PV-USER-ID                  TO PV-DLKUT410-USER.        09490011
125400     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO PV-DLKUT410-WK-TYP.      09500011
125500     MOVE DL011-KEY-WK-TYP            TO PV-DLKUT410-WK-TYP-DESC. 09510011
125600     MOVE DL011-P2L-MOD-WRK-AREA      TO PV-DLKUT410-WK-AREA-DESC.09520011
125700     MOVE PC244-DC-NBR                TO PV-DLKUT410-DC-NBR.      09530011
125800     MOVE PV-USER-ID                  TO PV-DLKUT410-CRE-USERID.  09540011
125900     MOVE DL019-EAI-USR-TYP-CDE       TO PV-DLKUT410-USER-TYP.    09550011
126000                                                                  09560001
126100     MOVE PV-DLKUT410-TEXT1           TO PV-LOG-MSG.              09570011
126200     PERFORM 9900-WRITE-LOG.                                      09580002
126300     MOVE PV-DLKUT410-TEXT2           TO PV-LOG-MSG.              09590011
126400     PERFORM 9900-WRITE-LOG.                                      09600002
126500                                                                  09610001
126600     PERFORM 9700-SQL-ERROR.                                      09620001
126700     IF KRPRPM-FUNC-TXT = 'Y'                                     09630001
126800         MOVE ' PCKUT073 END 8451- PARA '     TO PV-LOG-MSG       09640009
126900         PERFORM 9900-WRITE-LOG                                   09650002
127000     END-IF.                                                      09660001
127100/                                                                 09670001
127200 8600-CALL-XLKUT067.                                              09680001
127300*                                                                 09681030
127400*    IF KRPRPM-FUNC-TXT = 'Y'                                     09682033
127500*        MOVE SPACES TO PV-LOG-MSG                                09683033
127600*        STRING ' PCKUT073 START 8600- PARA WITH USER ID:'        09684033
127700*             PV-USER-ID DELIMITED BY SIZE                        09685033
127800*                                   INTO PV-LOG-MSG               09686033
127900*        PERFORM 9900-WRITE-LOG                                   09687033
128000*    END-IF.                                                      09688033
128100*                                                                 09721030
128200*    INITIALIZE XL067-USER-COMMAREA.                              09730001
128300*                                                                 09731132
128400*    MOVE ZEROS   TO  XL067-KOHLS-SQLCODE                         09731232
128500*                     XL067-TEMP-SQLCODE                          09731333
128600*                     XL067-RETURN-CODE.                          09731433
128700*                                                                 09731533
128800*    MOVE SPACES  TO  XL067-USER-FOUND-CODE                       09732029
128900*                     XL067-FIRST-NAME                            09733029
129000*                     XL067-LAST-NAME                             09734029
129100*                     XL067-MIDDLE-INITIAL                        09735029
129200*                     XL067-USERID                                09736029
129300*                     XL067-KEY-USER-ID.                          09737029
129400*                                                                 09738029
129500*    SET XL067-BY-USER-ID                                         09740001
129600*        XL067-SELECT-BOTH-USERS      TO TRUE.                    09750001
129700*                                                                 09760001
129800*    MOVE PV-USER-ID                 TO XL067-KEY-USER-ID.        09770033
129900*    MOVE 'PCKUT073'                 TO XL067-ORIG-CALLING-PGM-NM.09780033
130000*                                                                 09790001
130100*    CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               09800010
130200*                                                                 09801030
130300*    IF KRPRPM-FUNC-TXT = 'Y'                                     09802030
130400*        MOVE  XL067-KOHLS-SQLCODE  TO  PV-DISP-SQLCODE-4         09802133
130500*        MOVE  XL067-TEMP-SQLCODE   TO  PV-DISP-SQLCODE-5         09802233
130600*        MOVE SPACES TO PV-LOG-MSG                                09803030
130700*        STRING ' PCKUT073-XL067-USER-FOUND-CODE:'                09804033
130800*             XL067-USER-FOUND-CODE                               09805033
130900*             ' USER ID:' PV-USER-ID                              09805133
131000*             ' KSQL:' PV-DISP-SQLCODE-4                          09805233
131100*             ' TSQL:' PV-DISP-SQLCODE-5                          09805333
131200*             ' RC:' XL067-RETURN-CODE                            09805433
131300*                                        DELIMITED BY SIZE        09805533
131400*                                   INTO PV-LOG-MSG               09806030
131500*        PERFORM 9900-WRITE-LOG                                   09807030
131600*    END-IF.                                                      09808030
131700*                                                                 09810001
131800***                                                               09811023
131900*** DMH ADDED ADDITIONAL DISPLAYS - 8/21/2007                     09812023
132000***                                                               09813023
132100*    EVALUATE TRUE                                                09814023
132200*        WHEN XL067-SUCCESSFUL                                    09815023
132300*            CONTINUE                                             09816023
132400*        WHEN OTHER                                               09817023
132500*             MOVE  XL067-KOHLS-SQLCODE  TO  PV-DISP-SQLCODE      09818023
132600*             MOVE  XL067-TEMP-SQLCODE   TO  PV-DISP-SQLCODE-2    09819023
132700*             DISPLAY ' PCKUT073 - CALL XLKUT067 '                09819131
132800*             DISPLAY ' XLWS067 - '                               09819223
132900*                     ' ACCESS METHOD:' XL067-ACCESS-METHOD       09819323
133000*                     ' VIEW:'          XL067-VIEW-SELECTION      09819423
133100*             DISPLAY ' XLWS067 - '                               09819523
133200*                     ' KEYS:'          XL067-KEYS                09819623
133300*                     ' RETURN CODE:'   XL067-RETURN-CODE         09819723
133400*                     ' KOHLS SQLCODE:' PV-DISP-SQLCODE           09819823
133500*                     ' TEMP SQLCODE:'  PV-DISP-SQLCODE-2         09819923
133600*             DISPLAY ' XLWS067 - '                               09820023
133700*                     ' CALLING PGM:' XL067-ORIG-CALLING-PGM-NM   09820123
133800*                     ' PARA: '  XL067-KOHLS-NOT-FOUND-NBR        09820223
133900*                     '-'        XL067-KOHLS-CONTENTION-NBR       09820323
134000*                     '-'        XL067-KOHLS-ERROR-NBR            09820423
134100*                     '-'        XL067-TEMP-NOT-FOUND-NBR         09820523
134200*                     '-'        XL067-TEMP-CONTENTION-NBR        09820623
134300*                     '-'        XL067-TEMP-ERROR-NBR             09820723
134400*                     '-'        XL067-CALL-MOD-FAIL-NM           09820823
134500*                     '-'        XL067-CALL-MOD-FAIL-ERR-CDE      09820923
134600*    END-EVALUATE.                                                09821023
134700***                                                               09821123
134800*    EVALUATE TRUE                                                09822001
134900*        WHEN XL067-SUCCESSFUL                                    09830001
135000*            CONTINUE                                             09850001
135100*        WHEN XL067-SQL-ERROR                                     09860001
135200*            DISPLAY 'PCKUT073 - XL067 SQL ERROR'                 09870020
135300***                                                               09871021
135400***  DMH ADD DISPLAYS - 8/21/2007                                 09872021
135500***                                                               09873021
135600*            MOVE XL067-RETURN-CODE   TO PV-DISP-SQLCODE          09874021
135700*            MOVE XL067-TEMP-SQLCODE  TO PV-DISP-SQLCODE-2        09875021
135800*            DISPLAY ' PCKUT073 - 8600 - '                        09876021
135900*                    ' RETURN CDE:' XL067-RETURN-CODE             09877021
136000*                    ' KOHLS SQLCODE: ' PV-DISP-SQLCODE           09878022
136100*                    ' TEMP SQLCODE: '  PV-DISP-SQLCODE-2         09879022
136200*            DISPLAY ' PCKUT073 - 8600 - '                        09879121
136300*                    ' CALL TO XLKUT067 '                         09879221
136400*                    ' ACCESS:'       XL067-ACCESS-METHOD         09879321
136500*                    ' VIEW SELECTION:'                           09879421
136600*                                     XL067-VIEW-SELECTION        09879521
136700*            DISPLAY ' PCKUT073 - 8600 - '                        09879621
136800*                    ' KEYS:'         XL067-KEYS                  09879721
136900*                                   DL019-EST-ASGMT-INPUT-FIELDS  09879821
137000*            DISPLAY ' PCKUT073 - 8600 - '                        09879921
137100*                    ' TEAM FIELDS: '                             09880021
137200*            DISPLAY ' PCKUT073 - 8600 - '                        09880121
137300*                    ' CALLING PGM:' XL067-ORIG-CALLING-PGM-NM    09880221
137400*                    ' PARA: ' XL067-KOHLS-NOT-FOUND-NBR          09880321
137500*                    '-'       XL067-KOHLS-CONTENTION-NBR         09880421
137600*                    '-'       XL067-KOHLS-ERROR-NBR              09880521
137700*                    '-'       XL067-TEMP-NOT-FOUND-NBR           09880621
137800*                    '-'       XL067-TEMP-CONTENTION-NBR          09880721
137900*                    '-'       XL067-TEMP-ERROR-NBR               09880821
138000*                    '-'       XL067-CALL-MOD-FAIL-NM             09880921
138100*                    '-'       XL067-CALL-MOD-FAIL-ERR-CDE        09881021
138200***                                                               09881121
138300*            SET PC244-SQL-ERROR      TO TRUE                     09882001
138400*            PERFORM 8601-ERROR                                   09890001
138500*        WHEN XL067-INVALID-ACCESS                                09900001
138600*            DISPLAY 'PCKUT073 - XL067 INVALID ACCESS'            09910020
138700***                                                               09911021
138800***  DMH ADD DISPLAYS - 8/21/2007                                 09912021
138900***                                                               09913021
139000*            MOVE XL067-RETURN-CODE   TO PV-DISP-SQLCODE          09914021
139100*            MOVE XL067-TEMP-SQLCODE  TO PV-DISP-SQLCODE-2        09915021
139200*            DISPLAY ' PCKUT073 - 8600 - '                        09916021
139300*                    ' RETURN CDE:' XL067-RETURN-CODE             09917021
139400*                    ' KOHLS SQLCODE: ' PV-DISP-SQLCODE           09918022
139500*                    ' TEMP SQLCODE: '  PV-DISP-SQLCODE-2         09919022
139600*            DISPLAY ' PCKUT073 - 8600 - '                        09919121
139700*                    ' CALL TO XLKUT067 '                         09919221
139800*                    ' ACCESS:'       XL067-ACCESS-METHOD         09919321
139900*                    ' VIEW SELECTION:'                           09919421
140000*                                     XL067-VIEW-SELECTION        09919521
140100*            DISPLAY ' PCKUT073 - 8600 - '                        09919621
140200*                    ' KEYS:'         XL067-KEYS                  09919721
140300*                                   DL019-EST-ASGMT-INPUT-FIELDS  09919821
140400*            DISPLAY ' PCKUT073 - 8600 - '                        09919921
140500*                    ' TEAM FIELDS: '                             09920021
140600*            DISPLAY ' PCKUT073 - 8600 - '                        09920121
140700*                    ' CALLING PGM:' XL067-ORIG-CALLING-PGM-NM    09920221
140800*                    ' PARA: ' XL067-KOHLS-NOT-FOUND-NBR          09920321
140900*                    '-'       XL067-KOHLS-CONTENTION-NBR         09920421
141000*                    '-'       XL067-KOHLS-ERROR-NBR              09920521
141100*                    '-'       XL067-TEMP-NOT-FOUND-NBR           09920621
141200*                    '-'       XL067-TEMP-CONTENTION-NBR          09920721
141300*                    '-'       XL067-TEMP-ERROR-NBR               09920821
141400*                    '-'       XL067-CALL-MOD-FAIL-NM             09920921
141500*                    '-'       XL067-CALL-MOD-FAIL-ERR-CDE        09921021
141600***                                                               09921121
141700*            SET PC244-ERROR          TO TRUE                     09922001
141800*            PERFORM 8601-ERROR                                   09930001
141900*        WHEN OTHER                                               09940001
142000***                                                               09941021
142100***  DMH ADD DISPLAYS - 8/21/2007                                 09942021
142200***                                                               09943021
142300*            MOVE XL067-RETURN-CODE   TO PV-DISP-SQLCODE          09944021
142400*            MOVE XL067-TEMP-SQLCODE  TO PV-DISP-SQLCODE-2        09944121
142500*            DISPLAY ' PCKUT073 - 8600 - '                        09945021
142600*                    ' RETURN CDE:' XL067-RETURN-CODE             09946021
142700*                    ' KOHLS SQLCODE: ' PV-DISP-SQLCODE           09946122
142800*                    ' TEMP SQLCODE: '  PV-DISP-SQLCODE-2         09946222
142900*            DISPLAY ' PCKUT073 - 8600 - '                        09947021
143000*                    ' CALL TO XLKUT067 '                         09948021
143100*                    ' ACCESS:'       XL067-ACCESS-METHOD         09949021
143200*                    ' VIEW SELECTION:'                           09949121
143300*                                     XL067-VIEW-SELECTION        09949221
143400*            DISPLAY ' PCKUT073 - 8600 - '                        09949321
143500*                    ' KEYS:'         XL067-KEYS                  09949421
143600*                                   DL019-EST-ASGMT-INPUT-FIELDS  09949521
143700*            DISPLAY ' PCKUT073 - 8600 - '                        09949621
143800*                    ' TEAM FIELDS: '                             09949721
143900*            DISPLAY ' PCKUT073 - 8600 - '                        09949921
144000*                    ' CALLING PGM:' XL067-ORIG-CALLING-PGM-NM    09950021
144100*                    ' PARA: ' XL067-KOHLS-NOT-FOUND-NBR          09950121
144200*                    '-'       XL067-KOHLS-CONTENTION-NBR         09950221
144300*                    '-'       XL067-KOHLS-ERROR-NBR              09950321
144400*                    '-'       XL067-TEMP-NOT-FOUND-NBR           09950421
144500*                    '-'       XL067-TEMP-CONTENTION-NBR          09950521
144600*                    '-'       XL067-TEMP-ERROR-NBR               09950621
144700*                    '-'       XL067-CALL-MOD-FAIL-NM             09950721
144800*                    '-'       XL067-CALL-MOD-FAIL-ERR-CDE        09950821
144900***                                                               09951521
145000*            DISPLAY 'PCKUT073 - XL067 OTHER:'                    09951621
145100*                     XL067-RETURN-CODE                           09952021
145200*            SET PC244-ERROR          TO TRUE                     09960001
145300*            PERFORM 8601-ERROR                                   09970001
145400*    END-EVALUATE.                                                09980001
145500*    IF KRPRPM-FUNC-TXT = 'Y'                                     09990001
145600*        MOVE ' PCKUT073 END 8600- PARA '     TO PV-LOG-MSG       10000009
145700*        PERFORM 9900-WRITE-LOG                                   10010002
145800*    END-IF.                                                      10020001
145900*                                                                 10030001
146000*8601-ERROR.                                                      10040001
146100*                                                                 10050001
146200*    MOVE XL067-SQLCA                 TO SQLCA.                   10060001
146300*    MOVE '8601-'                     TO PV-ERROR-PARA.           10070001
146400*    STRING 'CALL XLKUT067-'                                      10080001
146500*            PC244-DC-NBR                                         10090001
146600*            '-CHK PICKERBARCODE IN PCC'                          10100001
146700*            DELIMITED BY SIZE                                    10110001
146800*       INTO PV-ERROR-TEXT.                                       10120001
146900*    PERFORM 9700-SQL-ERROR.                                      10130001
147000*                                                                 10140001
147100*    MOVE PV-USER-ID                  TO PV-XLKUT067-USERID.      10150001
147200*    STRING                                                       10160001
147300*            XL067-KOHLS-NOT-FOUND-NBR                            10170001
147400*        '/' XL067-KOHLS-CONTENTION-NBR                           10180001
147500*        '/' XL067-KOHLS-ERROR-NBR                                10190001
147600*        '/' XL067-TEMP-NOT-FOUND-NBR                             10200001
147700*        '/' XL067-TEMP-CONTENTION-NBR                            10210001
147800*        '/' XL067-TEMP-ERROR-NBR                                 10220001
147900*        '/' XL067-CALL-MOD-FAIL-NM                               10230001
148000*        '/' XL067-CALL-MOD-FAIL-ERR-CDE                          10240001
148100*            DELIMITED BY SIZE                                    10250001
148200*       INTO PV-XLKUT067-RETURN-FIELDS.                           10260001
148300*                                                                 10270001
148400*    MOVE PV-XLKUT067-TEXT            TO PV-LOG-MSG.              10280001
148500*    PERFORM 9900-WRITE-LOG.                                      10290002
148600*                                                                 10300001
148700/                                                                 10310001
148800 9000-FORMAT-TIME.                                                10320001
148900     ACCEPT PV-CURRENT-TIME FROM TIME.                            10330001
149000     MOVE PV-CURRENT-HOUR             TO PV-FORMAT-HH.            10340001
149100     MOVE PV-CURRENT-MINUTE           TO PV-FORMAT-MM.            10350001
149200     MOVE PV-CURRENT-SECOND           TO PV-FORMAT-SS.            10360001
149300     MOVE PV-CURRENT-HUNDRETH         TO PV-FORMAT-HUND.          10370001
149400                                                                  10380001
149500 9001-GENERIC-ERROR.                                              10390001
149600     SET PC244-ERROR                  TO TRUE.                    10400001
149700     PERFORM 9000-FORMAT-TIME.                                    10410001
149800     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           10420001
149900     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              10430001
150000     PERFORM 9900-WRITE-LOG.                                      10440002
150100                                                                  10450001
150200 9700-SQL-ERROR.                                                  10460001
150300                                                                  10470001
150400     SET PC244-SQL-ERROR                                          10480001
150500         PS-ERROR-YES                 TO TRUE.                    10490001
150600     MOVE SPACES                      TO PV-LOG-MSG.              10500001
150700     PERFORM 9900-WRITE-LOG.                                      10510002
150800     PERFORM 9000-FORMAT-TIME.                                    10520001
150900     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           10530001
151000     MOVE SQLCODE                     TO PV-ERROR-SQLCODE.        10540001
151100     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              10550001
151200     PERFORM 9900-WRITE-LOG.                                      10560002
151300     MOVE PV-SQLCODE-MSG              TO PV-LOG-MSG.              10570001
151400     PERFORM 9900-WRITE-LOG.                                      10580002
151500                                                                  10590001
151600***  PERFORM 9800-WRITE-SQLCA.                                    10600001
151700                                                                  10610001
151800                                                                  10620001
151900 9800-WRITE-SQLCA.                                                10630001
152000*                                                                 10640001
152100**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               10650001
152200*                                                                 10660001
152300     CALL 'DSNTIAR' USING SQLCA                                   10670001
152400                          DP004-FORMATTED-MESSAGE                 10680001
152500                          DP004-ERROR-LINE-LENGTH.                10690001
152600*                                                                 10700001
152700     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG.              10710001
152800     PERFORM 9900-WRITE-LOG.                                      10720002
152900                                                                  10730001
153000     PERFORM                                                      10740001
153100         VARYING DP004-MSG-IDX                                    10750001
153200         FROM 1 BY 1                                              10760001
153300         UNTIL DP004-MSG-IDX > DP004-MAX-MESSAGE-LINES            10770001
153400             MOVE DP004-MESSAGE-LINE (DP004-MSG-IDX)              10780001
153500                                      TO PV-LOG-MSG               10790001
153600             PERFORM 9900-WRITE-LOG                               10800002
153700     END-PERFORM.                                                 10810001
153800                                                                  10820001
153900     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG.              10830001
154000     PERFORM 9900-WRITE-LOG.                                      10840002
154100                                                                  10850001
154200 9900-WRITE-LOG.                                                  10860002
154300                                                                  10870001
154400     DISPLAY PV-LOG-MSG.                                          10880002
154500     MOVE SPACES                      TO PV-LOG-MSG.              10890001
154600                                                                  10900001
154700 9999-RETURN.                                                     10910001
154800                                                                  10920001
154900     GOBACK.                                                      10930001
