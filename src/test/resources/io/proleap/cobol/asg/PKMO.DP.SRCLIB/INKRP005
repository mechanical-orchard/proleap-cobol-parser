       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    INKRP005                                                  
       AUTHOR.        DORSEY JACKSON                                            
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  06-24-2002.                                               
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      * INKRP005 - PHYSICAL INVENTORY STORTAGE RANKING FOR THE COMPANY          
      ******************************************************************        
      *     THIS PROGRAM SEQUENTIALLY PROCESSES SORTED DATA FROM        00290000
      *  PKMO.IN.STORE.SHORTAGE, AND PRODUCE A REPORT AT THE DEPARTMENT 00330000
      *  AND STORE LEVEL.                                               00330000
      *  RECORDS MUST BE SORTED BY STORE, WITHIN DEPARTMENT,                    
      *     RECORDS MUST BE SORTED BY STORE AND SHORT RETAIL.                   
      *  PRE-SUMMED TOTALS FOR SHRINK ALLOWANCE, TOTAL SALES, SHOR      T       
      *     RETAIL, AND PHYSICAL INV RETAIL MUST ALSO BE DONE WITHIN            
      *     STORE, WITHIN DEPARTMENT, BEFORE PROGRAM CAN                        
      *     BE RUN CORRECTLY.                                                   
      ******************************************************************        
                                                                                
      ******************************************************************        
      ******************************************************************        
      ******************************************************************        
      *                        CHANGE LOG                              *        
      *  CHANGE ID    CHANGE DATE   REASON FOR CHANGE                  *        
      *  ---------    ----------    ---------------------------------- *        
      *  W24029       01-25-2003    CHANGE TO CORRECT TRUNCATION       *        
W26600*                                                                *        
W26600*  W26600       04-  -2004    M JOHNSON                          *        
W26600*                             INV LEDGER STORE EXPANSION         *        
W26600*                                                                *        
W33304*  W33304       12-16-2008    SATHISH/INFOSYS                    *        
W33304*                             HOLDING INVENTORY LEDGER OPEN(HILO)*        
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.    IBM-3090.                                            
       OBJECT-COMPUTER.    IBM-3090.                                            
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT INP-STORE-SHORTAGE-FILE                                       
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT INP-CONTROL-FILE                                              
               ASSIGN TO INP02.                                                 
                                                                                
           SELECT OUT-STORE-RANKING-FILE                                        
               ASSIGN TO OUT01.                                                 
                                                                                
           SELECT OUT-REPORT-FILE                                               
               ASSIGN TO RPT01.                                                 
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  INP-STORE-SHORTAGE-FILE                                              
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS   0 RECORDS                                          
W26600*    RECORD CONTAINS 96 CHARACTERS                                        
           DATA RECORD IS INP-STORE-STORTAGE-RECORD.                            
                                                                                
W33304 01  INP-STORE-SHORTAGE-RECORD      PIC X(128).                           
                                                                                
       FD  INP-CONTROL-FILE                                                     
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS   0 RECORDS                                          
           RECORD CONTAINS 80 CHARACTERS                                        
           DATA RECORD IS INP-CONTROL-RECORD.                                   
                                                                                
       01  INP-CONTROL-RECORD             PIC X(80).                            
                                                                                
       FD  OUT-STORE-RANKING-FILE                                               
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS   0 RECORDS                                          
W26600*    RECORD CONTAINS 128 CHARACTERS                                       
           DATA RECORD IS OUT-STORE-RANKING-RECORD.                             
                                                                                
W26600 01  OUT-STORE-RANKING-RECORD       PIC X(145).                           
                                                                                
       FD  OUT-REPORT-FILE                                                      
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           DATA RECORD IS OUT-REPORT-RECORD.                                    
                                                                                
       01  OUT-REPORT-RECORD              PIC X(132).                           
                                                                                
       EJECT                                                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** WORKING STORAGE AREA BEGIN ***'.                                
                                                                                
      *****************************************************************         
      ***************************************************************** 00120000
      *  STORE SHORTAGE RECORD LAYOUT - INPUT.                          00130000
      ***************************************************************** 00140000
           COPY INRD003O.                                               00000400
                                                                                
       01  CR-CONTROL-RECORD.                                                   
           05  CR-TYPE-RUN-IND               PIC X(01)   VALUE SPACE.           
           05  FILLER                        PIC X(79)   VALUE SPACES.          
                                                                                
       01  OR-OUTPUT-RECORD.                                                    
           05  OR-DEPT-NUMBER                PIC X(03)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-DEPT-NAME                  PIC X(20)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE ','.             
W26600     05  OR-STORE-NUMBER               PIC X(05)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-STORE-NAME                 PIC X(10)   VALUE SPACES.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-BV-SIGN                    PIC X(01)   VALUE SPACE.           
W26600     05  OR-BOOK-VALUE                 PIC 9(15)V99 VALUE ZEROS.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-PI-SIGN                    PIC X(01)   VALUE SPACE.           
W26600     05  OR-PHY-INV                    PIC 9(15)V99 VALUE ZEROS.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-ALL-SIGN                   PIC X(01)   VALUE SPACES.          
W26600     05  OR-ALLOWANCE                  PIC 9(15)V99 VALUE ZEROS.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-SB-SIGN                    PIC X(01)   VALUE SPACES.          
W26600     05  OR-SALES-BASE                 PIC 9(15)V99 VALUE ZEROS.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-SD-SIGN                    PIC X(01)   VALUE SPACES.          
W26600     05  OR-SHORT-DOLLAR               PIC 9(15)V99 VALUE ZEROS.          
           05  FILLER                        PIC X(01)   VALUE ','.             
           05  OR-PRIME-DC                   PIC X(02)   VALUE SPACES.          
W26600     05  FILLER                        PIC X(06)   VALUE SPACE.           
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-LINE-MAX                   PIC S9(4)   VALUE +60              
                                                         COMP SYNC.             
           05  PC-PROGRAM-NAME               PIC X(08) VALUE 'INKRP005'.        
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-INPUT-EOF-SW               PIC X(1)     VALUE 'N'.            
               88  PS-INPUT-EOF                           VALUE 'Y'.            
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PAGE-COUNTER            PIC S9(4)   VALUE ZEROES              
                                                         COMP SYNC.             
           05  PV-LINE-COUNTER            PIC S9(4)   VALUE 99                  
                                                         COMP SYNC.             
           05  PV-IN-COUNTER              PIC S9(4)   VALUE ZEROES              
                                                         COMP SYNC.             
           05  PV-RANK                    PIC 9(03) VALUE ZEROES.               
DJ    *    05  PV-SHRTLAST                PIC S9(3)V9999 VALUE ZEROES           
SJ         05  PV-SHRTLAST                PIC S9(3)V99 VALUE ZEROES             
                                                         COMP-3.           CL**1
DJ    *    05  PV-SHRTPCTP                PIC S9(3)V9999 VALUE ZEROES           
SJ         05  PV-SHRTPCTP                PIC S9(4)V9999 VALUE ZEROES           
                                                      COMP-3.              CL**1
DJ    *    05  PV-SHRTPCTX                PIC S9(3)V99 VALUE ZEROES        CL**1
SJ         05  PV-SHRTPCTX                PIC S9(6)V99 VALUE ZEROES        CL**1
                                                      COMP-3.              CL**1
           05  PV-SHORTPCT                PIC S9(3)V99 VALUE ZEROES             
                                                      COMP-3.              CL**1
           05  PV-SHORTTOT                PIC S9(2)V99 VALUE ZEROES             
                                                      COMP-3.              CL**1
W26600     05  PV-SLSTOTAL                PIC S9(13)V99 VALUE ZEROES            
                                                      COMP-3.              CL**1
W26600     05  PV-INVTOTAL                PIC S9(13)V99 VALUE ZEROES            
                                                      COMP-3.              CL**1
           05  PV-MAXPCT                  PIC S9(03)V99 VALUE 999.99.           
W24029*    05  PV-DLRS                    PIC 9(14)V99 VALUE ZEROES.            
W24029*    05  FILLER REDEFINES PV-DLRS.                                        
W24029*        10  PV-DLRS-01-15          PIC 9(13)V99.                         
W24029*        10  PV-DLRS-16             PIC V9.                               
           05  PV-SAVE-DEPT               PIC X(03)    VALUE SPACES.            
                                                                                
      ***************************************************************** 00120000
      *   STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.               00220000
      ***************************************************************** 00230000
           COPY DPWS132O.                                                       
                                                                                
       01  HL-HEADING-LINE1.                                                    
           05  FILLER                        PIC X(49)   VALUE SPACES.          
           05  FILLER                        PIC X(08)   VALUE                  
                                             'PHYSICAL'.                        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(09)   VALUE                  
                                             'INVENTORY'.                       
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(08)   VALUE                  
                                             'SHORTAGE'.                        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(07)   VALUE                  
                                             'RANKING'.                         
       01  HL-HEADING-LINE2.                                                    
           05  FILLER                        PIC X(54)   VALUE SPACES.          
           05  HL-HEADING-LINE2-RPT-DESC     PIC X(24)   VALUE SPACES.          
                                                                                
       01  HL-HEADING-LINE3.                                                    
           05  FILLER                        PIC X(06)   VALUE SPACES.          
           05  FILLER                        PIC X(04)   VALUE                  
                                             'RANK'.                            
           05  FILLER                        PIC X(02)   VALUE SPACES.          
           05  FILLER                        PIC X(05)   VALUE                  
                                             'STORE'.                           
           05  FILLER                        PIC X(02)   VALUE SPACES.          
           05  FILLER                        PIC X(05)   VALUE                  
                                             'STORE'.                           
           05  FILLER                        PIC X(22)   VALUE SPACES.          
           05  FILLER                        PIC X(06)   VALUE                  
                                             'SHRINK'.                          
           05  FILLER                        PIC X(11)   VALUE SPACES.          
           05  FILLER                        PIC X(07)   VALUE                  
                                             'PHY INV'.                         
           05  FILLER                        PIC X(14)   VALUE SPACES.          
           05  FILLER                        PIC X(05)   VALUE                  
                                             'TOTAL'.                           
           05  FILLER                        PIC X(14)   VALUE SPACES.          
           05  FILLER                        PIC X(05)   VALUE                  
                                             'SHORT'.                           
           05  FILLER                        PIC X(10)   VALUE SPACES.          
           05  FILLER                        PIC X(08)   VALUE                  
                                             'SHORTAGE'.                        
       01  HL-HEADING-LINE4.                                                    
           05  FILLER                        PIC X(12)   VALUE SPACES.          
           05  FILLER                        PIC X(04)   VALUE                  
                                             'NUMB'.                            
           05  FILLER                        PIC X(03)   VALUE SPACES.          
           05  FILLER                        PIC X(04)   VALUE                  
                                             'NAME'.                            
           05  FILLER                        PIC X(23)   VALUE SPACES.          
           05  FILLER                        PIC X(05)   VALUE                  
                                             'ALLOW'.                           
           05  FILLER                        PIC X(12)   VALUE SPACES.          
           05  FILLER                        PIC X(06)   VALUE                  
                                             'RETAIL'.                          
           05  FILLER                        PIC X(15)   VALUE SPACES.          
           05  FILLER                        PIC X(06)   VALUE                  
                                             'SALES '.                          
           05  FILLER                        PIC X(13)   VALUE SPACES.          
           05  FILLER                        PIC X(06)   VALUE                  
                                             'RETAIL'.                          
           05  FILLER                        PIC X(09)   VALUE SPACES.          
           05  FILLER                        PIC X(07)   VALUE                  
                                             'PERCENT'.                         
       01  HL-HEADING-LINE5.                                                    
           05  FILLER                        PIC X(12)   VALUE SPACES.          
           05  FILLER                        PIC X(05)   VALUE                  
                                             'DEPT.'.                           
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  HL-HEADING-DEPT-NUMBER        PIC X(03)   VALUE SPACES.          
           05  FILLER                        PIC X(02)   VALUE SPACES.          
           05  HL-HEADING-DEPT-NAME          PIC X(20)   VALUE SPACES.          
                                                                                
       01  FC1-FINANCE-CORP01-HEADING.                                          
           05  FILLER                        PIC X(54) VALUE SPACES.            
           05  FILLER                        PIC X(24) VALUE                    
               'FINANCIAL CORPORATION 01'.                                      
           05  FILLER                        PIC X(54) VALUE SPACES.            
       01  FC2-FINANCE-CORP02-HEADING.                                          
           05  FILLER                        PIC X(54) VALUE SPACES.            
           05  FC2-FINANCE-CORP2-TITLE       PIC X(24) VALUE                    
               'FINANCIAL CORPORATION 02'.                                      
           05  FILLER                        PIC X(54) VALUE SPACES.            
       01  CH-COMPANY-HEADING.                                                  
           05  FILLER                        PIC X(54) VALUE SPACES.            
           05  CH-COMPANY-TITLE              PIC X(24) VALUE                    
               '     FOR THE COMPANY    '.                                      
           05  FILLER                        PIC X(54) VALUE SPACES.            
                                                                                
       01  TT-TOTAL-TITLES.                                                     
           05  FC1-FINANCE-CORP01-TITLE      PIC X(22) VALUE                    
               'FINANCE CORP 01 TOTALS'.                                        
           05  FC2-FINANCE-CORP02-TITLE      PIC X(22) VALUE                    
               'FINANCE CORP 02 TOTALS'.                                        
           05  CT-COMPANY-TITLE              PIC X(22) VALUE                    
               ' COMPANY TOTALS    '.                                           
                                                                                
       01  SL-SPACE-LINE                     PIC X(132)  VALUE SPACES.          
                                                                                
       01  DL-DETAIL-LINE.                                                      
           05  FILLER                        PIC X(05)   VALUE SPACE.           
           05  DL-RANK                       PIC Z(03)   VALUE ZEROES.          
           05  FILLER                        PIC X(03)   VALUE SPACE.           
W26600*    05  DL-STORE-NUMBER               PIC Z(05)   VALUE ZEROES.          
W26600     05  DL-STORE-NUMBER               PIC 9(05)   VALUE ZEROES.          
           05  FILLER                        PIC X(03)   VALUE SPACES.          
           05  DL-STORE-NAME                 PIC X(10)   VALUE SPACES.          
           05  FILLER                        PIC X(09)   VALUE SPACES.          
           05  DL-ALLOWANCE                  PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROS.           
           05  FILLER                        PIC X(05)   VALUE SPACES.          
           05  DL-PHY-INV-RETAIL             PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROS.           
           05  FILLER                        PIC X(08)   VALUE SPACES.          
           05  DL-TOTAL-SALES                PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROS.           
           05  FILLER                        PIC X(02)   VALUE SPACES.          
           05  DL-SHORT-RETAIL               PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROS.           
           05  FILLER                        PIC X(05)   VALUE SPACES.          
           05  DL-PERCENT                    PIC ZZZ.99- VALUE ZEROES.          
                                                                                
       01  DC-DEPARTMENT-COMPANY-LINE.                                          
           05  FILLER                        PIC X(11)   VALUE SPACES.          
           05  CT-TOTAL-TITLE                PIC X(24)   VALUE SPACES.          
           05  CT-TOTAL-ALLOWANCE            PIC ZZ,ZZZ,ZZZ,ZZZ.99-             
                                                 VALUE ZEROES.                  
           05  FILLER                        PIC X(2)   VALUE SPACES.           
           05  CT-TOTAL-PHY-INV-RETAIL       PIC ZZ,ZZZ,ZZZ,ZZZ.99-             
                                                 VALUE ZEROES.                  
           05  FILLER                        PIC X(5)   VALUE SPACES.           
           05  CT-TOTAL-SALES                PIC ZZ,ZZZ,ZZZ,ZZZ.99-             
                                                 VALUE ZEROES.                  
           05  FILLER                        PIC X(02)   VALUE SPACES.          
           05  CT-TOTAL-SHORT-RETAIL         PIC  ZZZ,ZZZ,ZZZ.99-               
                                                 VALUE ZEROES.                  
           05  FILLER                        PIC X(5)   VALUE SPACES.           
           05  CT-TOTAL-PERCENT              PIC ZZZ.99-                        
                                                 VALUE ZEROES.                  
       01  CT-COMPANY-TOTS.                                                     
W26600     05  CT-TOT-ALLOWANCE              PIC S9(15)V99 VALUE ZEROS          
                                                          COMP-3.               
W26600     05  CT-TOT-PHY-INV-RETAIL         PIC S9(15)V99 VALUE ZEROS          
                                                          COMP-3.               
W26600     05  CT-TOT-TOTAL-SALES            PIC S9(15)V99 VALUE ZEROES         
                                                          COMP-3.               
W26600     05  CT-TOT-SHORT-RETAIL           PIC S9(15)V99 VALUE ZEROES         
                                                          COMP-3.               
W26600     05  CT-TOT-BOOK-INV               PIC S9(15)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  DT-DEPARTMENT-TOTS.                                                  
W26600     05  DT-TOT-ALLOWANCE              PIC S9(15)V99 VALUE ZEROS          
                                                          COMP-3.               
W26600     05  DT-TOT-PHY-INV-RETAIL         PIC S9(15)V99 VALUE ZEROS          
                                                          COMP-3.               
W26600     05  DT-TOT-TOTAL-SALES            PIC S9(15)V99 VALUE ZEROES         
                                                          COMP-3.               
W26600     05  DT-TOT-SHORT-RETAIL           PIC S9(15)V99 VALUE ZEROES         
                                                          COMP-3.               
W26600     05  DT-TOT-BOOK-INV               PIC S9(15)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  RUN-TIME.                                                            
           05  R-HR                          PIC 99.                            
           05  R-MIN                         PIC 99.                            
           05  R-SEC                         PIC 99.                            
           05  R-TH                          PIC 99.                            
                                                                                
       01  DATE-IN.                                                             
           05 DATE-IN-YY                     PIC XX.                            
           05 DATE-IN-MM                     PIC XX.                            
           05 DATE-IN-DD                     PIC XX.                            
                                                                                
       EJECT                                                                    
      *                                                                         
       PROCEDURE DIVISION.                                                      
                                                                                
       0000-INKRP005.                                                           
                                                                                
      ****************************************************************          
      *    OPEN ALL FILES.                                                      
      *    INITIALIZE PAGE HEADINGS                                             
      *    PROCESS AND PRINT RECORDS ON IN003O-STORE-SHORTAGE-RECORD            
      *    PRINT THE COMPANY TOTALS AT END OF FILE                              
      *    CLOSE ALL FILES.                                                     
      ****************************************************************          
           OPEN INPUT  INP-STORE-SHORTAGE-FILE                                  
                       INP-CONTROL-FILE                                         
                OUTPUT OUT-STORE-RANKING-FILE                                   
                       OUT-REPORT-FILE.                                         
                                                                                
           PERFORM 1000-INITIALIZE-HEADER.                                      
                                                                                
           PERFORM 2000-PROCESS                                                 
               UNTIL PS-INPUT-EOF.                                              
                                                                                
           IF PV-PAGE-COUNTER = +0                                              
               CONTINUE                                                         
           ELSE                                                                 
               PERFORM B100-PRINT-DEPT-TOTALS                                   
               PERFORM 6000-PRINT-HEADERS                                       
               PERFORM B200-PRINT-COMPANY-TOTALS                                
           END-IF.                                                              
                                                                                
           CLOSE INP-STORE-SHORTAGE-FILE                                        
                 INP-CONTROL-FILE                                               
                 OUT-STORE-RANKING-FILE                                         
                 OUT-REPORT-FILE.                                               
                                                                                
           STOP RUN.                                                            
                                                                                
       1000-INITIALIZE-HEADER.                                                  
                                                                                
      ****************************************************************          
      *    SET UP THE STANDARD PAGE HEADER.                                     
      *    ACCEPT THE RUN DATE AND RUN TIME FROM THE SYSTEM.                    
      *    READ FIRST STORE RECORD.                                             
      *    PERFORMED BY 0000-INKRP005.                                          
      ****************************************************************          
           ACCEPT DATE-IN  FROM DATE.                                           
           ACCEPT RUN-TIME FROM TIME.                                           
           MOVE DATE-IN-MM TO DP132O-RUN-MONTH.                                 
           MOVE DATE-IN-DD TO DP132O-RUN-DAY.                                   
           MOVE DATE-IN-YY TO DP132O-RUN-YEAR.                                  
           MOVE R-HR       TO DP132O-RUN-HOUR.                                  
           MOVE R-MIN      TO DP132O-RUN-MINUTE.                                
           MOVE PC-PROGRAM-NAME TO DP132O-PROGRAM-NAME.                         
           MOVE 1               TO DP132O-REPORT-NUMBER.                        
           PERFORM 3000-READ-CNTL-DATA.                                         
           IF CR-TYPE-RUN-IND = '1'                                             
               MOVE FC1-FINANCE-CORP01-HEADING                                  
                   TO HL-HEADING-LINE2-RPT-DESC                                 
               MOVE FC1-FINANCE-CORP01-TITLE                                    
                   TO CT-TOTAL-TITLE                                            
           END-IF                                                               
           IF CR-TYPE-RUN-IND = '2'                                             
               MOVE FC2-FINANCE-CORP02-HEADING                                  
                   TO HL-HEADING-LINE2-RPT-DESC                                 
               MOVE FC2-FINANCE-CORP02-TITLE                                    
                   TO CT-TOTAL-TITLE                                            
           END-IF                                                               
           IF CR-TYPE-RUN-IND = 'C'                                             
               MOVE CH-COMPANY-TITLE                                            
                   TO HL-HEADING-LINE2-RPT-DESC                                 
               MOVE CT-COMPANY-TITLE                                            
                   TO CT-TOTAL-TITLE                                            
           END-IF                                                               
           PERFORM 4000-READ-STORE-DATA.                                        
           MOVE IN003O-DEPARTMENT-NUMB TO PV-SAVE-DEPT.                         
                                                                                
       EJECT                                                                    
                                                                                
       2000-PROCESS.                                                            
                                                                                
      ****************************************************************          
      *    PRINT DETAIL FOR THE CURRENT STORE RECORD AND                        
      *    READ THE NEXT INPUT RECORD.                                          
      *                                                                         
      *    PERFORMED BY 0000-INKRP005.                                          
      ****************************************************************          
                                                                                
           IF PV-SAVE-DEPT = IN003O-DEPARTMENT-NUMB                             
               CONTINUE                                                         
           ELSE                                                                 
               PERFORM B100-PRINT-DEPT-TOTALS                                   
               MOVE IN003O-DEPARTMENT-NUMB TO PV-SAVE-DEPT                      
               PERFORM 6000-PRINT-HEADERS.                                      
                                                                                
           COMPUTE PV-RANK = PV-RANK + 1.                                       
W24029*    COMPUTE PV-SLSTOTAL = IN003O-TOTAL-SALES + PV-SLSTOTAL.              
W24029*    COMPUTE PV-INVTOTAL = IN003O-TOTAL-SALES + PV-INVTOTAL.              
                                                                                
           MOVE ZEROES TO PV-SHRTPCTX.                                          
           IF IN003O-TOTAL-SALES = 0                                            
               COMPUTE PV-SHRTPCTX = PV-MAXPCT                                  
           ELSE                                                                 
               COMPUTE PV-SHRTPCTP ROUNDED =                                0000
                ((IN003O-SHORT-RETAIL / IN003O-TOTAL-SALES) * 100)          0000
                 ON SIZE ERROR                                                  
                   MOVE 999.99 TO PV-SHRTPCTP                                   
               END-COMPUTE                                                      
               MOVE PV-SHRTPCTP TO PV-SHRTPCTX                                  
           END-IF                                                           0000
                                                                            0000
           IF PV-SHRTPCTX > 999.99                                          0000
               COMPUTE PV-SHORTPCT = PV-MAXPCT                              0000
           ELSE                                                             0000
               IF PV-SHRTPCTX < -999.99                                     0000
                   COMPUTE PV-SHORTPCT ROUNDED = (PV-MAXPCT * -1)           0000
               ELSE                                                         0000
                   MOVE PV-SHRTPCTX TO PV-SHORTPCT                          0000
               END-IF                                                   00002600
           END-IF                                                       00002600
                                                                            0000
           IF IN003O-SHORT-RETAIL > 0                                   00002600
              IF PV-SHORTPCT < 0                                        00002600
                  COMPUTE PV-SHORTPCT ROUNDED = (PV-SHORTPCT * -1)              
              END-IF                                                    00002600
           ELSE                                                         00002600
              IF IN003O-SHORT-RETAIL < 0                                00002600
                  IF PV-SHORTPCT > 0                                    00002600
                      COMPUTE PV-SHORTPCT ROUNDED = (PV-SHORTPCT * -1)          
                  END-IF                                                00002600
              ELSE                                                      00002600
                  MOVE 0 TO PV-SHORTPCT                                 00002600
              END-IF                                                    00002600
           END-IF                                                       00002600
                                                                                
           MOVE PV-RANK                 TO DL-RANK.                             
           MOVE IN003O-STORE-NUMB       TO DL-STORE-NUMBER.                     
           MOVE IN003O-STORE-NAME       TO DL-STORE-NAME.                       
           MOVE IN003O-SHRINK-ALLOWANCE TO DL-ALLOWANCE.                        
           MOVE IN003O-PHY-INV-RETAIL   TO DL-PHY-INV-RETAIL.                   
           MOVE IN003O-TOTAL-SALES      TO DL-TOTAL-SALES.                      
           MOVE IN003O-SHORT-RETAIL     TO DL-SHORT-RETAIL.                     
           MOVE PV-SHORTPCT             TO DL-PERCENT.                          
           PERFORM Z100-PRINT-DETAIL-LINE.                                      
           ADD IN003O-SHRINK-ALLOWANCE  TO DT-TOT-ALLOWANCE.                    
           ADD IN003O-TOTAL-SALES       TO DT-TOT-TOTAL-SALES.                  
           ADD IN003O-SHORT-RETAIL      TO DT-TOT-SHORT-RETAIL.                 
           ADD IN003O-BOOK-INV          TO DT-TOT-BOOK-INV.                     
           ADD IN003O-PHY-INV-RETAIL    TO DT-TOT-PHY-INV-RETAIL.               
      ****************************************************************          
      *    FORMAT OUTPUT RECORD                                                 
      ****************************************************************          
           MOVE IN003O-STORE-NUMB      TO OR-STORE-NUMBER.                      
           MOVE IN003O-STORE-NAME      TO OR-STORE-NAME.                        
           MOVE IN003O-DEPARTMENT-NUMB TO OR-DEPT-NUMBER.                       
           MOVE IN003O-DEPARTMENT-NAME TO OR-DEPT-NAME.                         
           IF IN003O-BOOK-INV < 0                                               
               MOVE '-'    TO  OR-BV-SIGN                                       
           ELSE                                                                 
               MOVE ' '    TO  OR-BV-SIGN                                       
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = IN003O-BOOK-INV * 10                               
W24029*    MOVE PV-DLRS-01-15  TO OR-BOOK-VALUE                                 
W24029     MOVE IN003O-BOOK-INV TO OR-BOOK-VALUE                                
W24029*    MOVE 0              TO PV-DLRS                                       
           IF IN003O-PHY-INV-RETAIL < 0                                         
               MOVE '-'    TO  OR-PI-SIGN                                       
           ELSE                                                                 
               MOVE ' '    TO  OR-PI-SIGN                                       
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = IN003O-PHY-INV-RETAIL * 10                         
W24029*    MOVE PV-DLRS-01-15  TO OR-PHY-INV                                    
W24029     MOVE IN003O-PHY-INV-RETAIL TO OR-PHY-INV                             
W24029*    MOVE 0              TO PV-DLRS                                       
           IF IN003O-SHRINK-ALLOWANCE < 0                                       
               MOVE '-'        TO  OR-ALL-SIGN                                  
           ELSE                                                                 
               MOVE ' '        TO  OR-ALL-SIGN                                  
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = IN003O-SHRINK-ALLOWANCE * 10                       
W24029*    MOVE PV-DLRS-01-15  TO OR-ALLOWANCE                                  
W24029     MOVE IN003O-SHRINK-ALLOWANCE TO OR-ALLOWANCE                         
W24029*    MOVE 0              TO PV-DLRS                                       
           IF IN003O-TOTAL-SALES  < 0                                           
               MOVE '-'        TO  OR-SB-SIGN                                   
           ELSE                                                                 
               MOVE ' '        TO  OR-SB-SIGN                                   
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = IN003O-TOTAL-SALES    * 10                         
W24029*    MOVE PV-DLRS-01-15  TO OR-SALES-BASE                                 
W24029     MOVE IN003O-TOTAL-SALES TO OR-SALES-BASE                             
W24029*    MOVE 0              TO PV-DLRS                                       
           IF IN003O-SHORT-RETAIL < 0                                           
               MOVE '-'        TO  OR-SD-SIGN                                   
           ELSE                                                                 
               MOVE ' '        TO  OR-SD-SIGN                                   
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = IN003O-SHORT-RETAIL    * 10                        
W24029*    MOVE PV-DLRS-01-15   TO OR-SHORT-DOLLAR                              
W24029     MOVE IN003O-SHORT-RETAIL TO OR-SHORT-DOLLAR                          
W24029*    MOVE 0               TO PV-DLRS                                      
           MOVE IN003O-PRIME-DC TO OR-PRIME-DC.                                 
           PERFORM Z200-WRITE-OUTPUT-FILE.                                      
           PERFORM 4000-READ-STORE-DATA.                                        
                                                                                
       3000-READ-CNTL-DATA.                                                     
      ****************************************************************          
      *    READ THE CNTL FILE                                                   
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                                 
      ****************************************************************          
           READ INP-CONTROL-FILE INTO CR-CONTROL-RECORD                         
               AT END                                                           
                   SET PS-INPUT-EOF TO TRUE                                     
                   PERFORM Z300-DISPLAY-CNTL-MESSAGE.                           
                                                                                
       4000-READ-STORE-DATA.                                                    
      ****************************************************************          
      *    READ THE STORE SHORTAGE FILE                                         
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                                 
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
           READ INP-STORE-SHORTAGE-FILE INTO IN003O-STORE-SHORTAGE-REC          
               AT END                                                           
                   SET PS-INPUT-EOF TO TRUE.                                    
                                                                                
       6000-PRINT-HEADERS.                                                      
                                                                                
      ****************************************************************          
      *    PRINT THE PAGE HEADERS.                                              
      *                                                                         
      *    PERFORMED BY Z100-DETAIL-PRINT-LINE                                  
      *    PERFORMED BY Z200-PRINT-COMPANY-TOTALS                               
      ****************************************************************          
                                                                                
           ADD  1               TO PV-PAGE-COUNTER.                             
                                                                                
           MOVE PV-PAGE-COUNTER TO DP132O-PAGE-NUMBER.                          
                                                                                
           WRITE OUT-REPORT-RECORD                                              
               FROM DP132O-STANDRD-HEADER-132-COLS                              
               AFTER ADVANCING PAGE.                                            
                                                                                
           WRITE OUT-REPORT-RECORD                                              
               FROM HL-HEADING-LINE1                                            
               AFTER ADVANCING 2 LINE.                                          
                                                                                
           WRITE OUT-REPORT-RECORD                                              
               FROM HL-HEADING-LINE2                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE OUT-REPORT-RECORD                                              
               FROM HL-HEADING-LINE3                                            
               AFTER ADVANCING 3 LINE.                                          
                                                                                
           WRITE OUT-REPORT-RECORD                                              
               FROM HL-HEADING-LINE4                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           MOVE IN003O-DEPARTMENT-NUMB TO                                       
                HL-HEADING-DEPT-NUMBER.                                         
           MOVE IN003O-DEPARTMENT-NAME TO                                       
                HL-HEADING-DEPT-NAME.                                           
           WRITE OUT-REPORT-RECORD                                              
               FROM HL-HEADING-LINE5                                            
               AFTER ADVANCING 2 LINE.                                          
                                                                                
           WRITE OUT-REPORT-RECORD                                              
               FROM SL-SPACE-LINE                                               
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           MOVE 11 TO PV-LINE-COUNTER.                                          
                                                                                
           EJECT                                                                
                                                                                
       B100-PRINT-DEPT-TOTALS.                                                  
                                                                                
      ****************************************************************          
      *    FORMAT AND PRINT DEPARTMENT TOTAL LINE.                              
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           MOVE DT-TOT-SHORT-RETAIL TO PV-INVTOTAL                              
           MOVE DT-TOT-TOTAL-SALES  TO PV-SLSTOTAL                              
                                                                                
           MOVE ZEROES TO PV-SHRTPCTX                                           
           IF PV-SLSTOTAL = 0                                                   
               MOVE PV-MAXPCT TO PV-SHRTPCTX                                    
           ELSE                                                                 
               COMPUTE PV-SHRTPCTP ROUNDED =                                0000
                       ((PV-INVTOTAL / PV-SLSTOTAL) * 100)                  0000
                 ON SIZE ERROR                                                  
                   MOVE 999.99 TO PV-SHRTPCTP                                   
               END-COMPUTE                                                      
               MOVE PV-SHRTPCTP TO PV-SHRTPCTX                                  
           END-IF                                                           0000
                                                                            0000
           IF PV-SHRTPCTX > 999.99                                          0000
               COMPUTE PV-SHRTLAST = PV-MAXPCT                                  
           ELSE                                                             0000
               IF PV-SHRTPCTX < -999.99                                     0000
                   COMPUTE PV-SHRTLAST ROUNDED = (PV-MAXPCT * -1)               
               ELSE                                                         0000
                   MOVE PV-SHRTPCTX TO PV-SHRTLAST                          0000
               END-IF                                                   00002600
           END-IF                                                       00002600
                                                                            0000
           IF PV-INVTOTAL > 0                                           00002600
              IF PV-SHRTLAST < 0                                        00002600
                  COMPUTE PV-SHRTLAST ROUNDED = (PV-SHRTLAST * -1)              
              END-IF                                                    00002600
           ELSE                                                         00002600
              IF PV-INVTOTAL < 0                                        00002600
                  IF PV-SHRTLAST > 0                                    00002600
                      COMPUTE PV-SHRTLAST ROUNDED = (PV-SHRTLAST * -1)          
                  END-IF                                                00002600
              ELSE                                                      00002600
                  COMPUTE PV-SHRTLAST = 0                               00002600
              END-IF                                                    00002600
           END-IF                                                       00002600
           MOVE DT-TOT-ALLOWANCE        TO CT-TOTAL-ALLOWANCE.                  
           MOVE DT-TOT-PHY-INV-RETAIL   TO CT-TOTAL-PHY-INV-RETAIL.             
           MOVE DT-TOT-TOTAL-SALES      TO CT-TOTAL-SALES.                      
           MOVE DT-TOT-SHORT-RETAIL     TO CT-TOTAL-SHORT-RETAIL                
           MOVE PV-SHRTLAST             TO CT-TOTAL-PERCENT.                    
           MOVE 'DEPARTMENT TOTALS'     TO CT-TOTAL-TITLE.                      
           PERFORM Z400-PRINT-DEPT-TOTALS.                                      
           ADD DT-TOT-ALLOWANCE         TO CT-TOT-ALLOWANCE.                    
           ADD DT-TOT-PHY-INV-RETAIL    TO CT-TOT-PHY-INV-RETAIL.               
           ADD DT-TOT-BOOK-INV          TO CT-TOT-BOOK-INV.                     
           ADD DT-TOT-TOTAL-SALES       TO CT-TOT-TOTAL-SALES.                  
           ADD DT-TOT-SHORT-RETAIL      TO CT-TOT-SHORT-RETAIL.                 
           MOVE ZEROES                  TO DT-TOT-ALLOWANCE                     
                                           DT-TOT-PHY-INV-RETAIL                
                                           DT-TOT-TOTAL-SALES                   
                                           DT-TOT-SHORT-RETAIL                  
                                           DT-TOT-BOOK-INV                      
                                           PV-RANK.                             
                                                                                
       B200-PRINT-COMPANY-TOTALS.                                               
                                                                                
      ****************************************************************          
      *    FORMAT AND PRINT COMPANY TOTAL LINE.                                 
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           MOVE SPACES TO DC-DEPARTMENT-COMPANY-LINE.                           
           MOVE CT-TOT-SHORT-RETAIL TO PV-INVTOTAL                              
           MOVE CT-TOT-TOTAL-SALES  TO PV-SLSTOTAL                              
                                                                                
           MOVE ZEROES TO PV-SHRTPCTX                                           
           IF PV-SLSTOTAL = 0                                                   
               MOVE PV-MAXPCT TO PV-SHRTPCTX                                    
           ELSE                                                                 
               COMPUTE PV-SHRTPCTP ROUNDED =                                0000
                       ((PV-INVTOTAL / PV-SLSTOTAL) * 100)                  0000
                 ON SIZE ERROR                                                  
                   MOVE 999.99 TO PV-SHRTPCTP                                   
               END-COMPUTE                                                      
               ADD PV-SHRTPCTP TO PV-SHRTPCTX ROUNDED                           
           END-IF                                                           0000
                                                                            0000
           IF PV-SHRTPCTX > 999.99                                          0000
               COMPUTE PV-SHORTPCT = PV-MAXPCT                                  
           ELSE                                                             0000
               IF PV-SHRTPCTX < -999.99                                     0000
                   COMPUTE PV-SHORTPCT ROUNDED = (PV-MAXPCT * -1)               
               ELSE                                                         0000
                   MOVE PV-SHRTPCTX TO PV-SHORTPCT                          0000
               END-IF                                                   00002600
           END-IF                                                       00002600
                                                                            0000
           IF PV-INVTOTAL > 0                                           00002600
              IF PV-SHORTPCT < 0                                        00002600
                  COMPUTE PV-SHORTPCT ROUNDED = (PV-SHORTPCT * -1)              
              END-IF                                                    00002600
           ELSE                                                         00002600
              IF PV-INVTOTAL < 0                                        00002600
                  IF PV-SHORTPCT > 0                                    00002600
                      COMPUTE PV-SHORTPCT ROUNDED = (PV-SHORTPCT * -1)          
                  END-IF                                                00002600
              ELSE                                                      00002600
                  COMPUTE PV-SHORTPCT = 0                               00002600
              END-IF                                                    00002600
           END-IF                                                       00002600
                                                                                
           MOVE SPACES            TO OR-STORE-NUMBER                            
                                     OR-DEPT-NUMBER                             
                                     OR-DEPT-NAME.                              
           MOVE 'TOTALS:'         TO OR-STORE-NAME.                             
                                                                                
           IF CT-TOT-BOOK-INV < 0                                               
               MOVE '-'    TO  OR-PI-SIGN                                       
           ELSE                                                                 
               MOVE ' '    TO  OR-PI-SIGN                                       
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = CT-TOT-BOOK-INV * 10                               
W24029*    MOVE PV-DLRS-01-15  TO OR-BOOK-VALUE                                 
W24029     MOVE CT-TOT-BOOK-INV TO OR-BOOK-VALUE                                
W24029*    MOVE 0              TO PV-DLRS                                       
                                                                                
           IF CT-TOT-PHY-INV-RETAIL < 0                                         
               MOVE '-'    TO  OR-PI-SIGN                                       
           ELSE                                                                 
               MOVE ' '    TO  OR-PI-SIGN                                       
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = CT-TOT-PHY-INV-RETAIL * 10                         
W24029*    MOVE PV-DLRS-01-15  TO OR-PHY-INV                                    
W24029     MOVE CT-TOT-PHY-INV-RETAIL TO OR-PHY-INV                             
W24029*    MOVE 0              TO PV-DLRS                                       
                                                                                
           IF CT-TOT-ALLOWANCE < 0                                              
               MOVE '-'        TO  OR-ALL-SIGN                                  
           ELSE                                                                 
               MOVE ' '        TO  OR-ALL-SIGN                                  
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = CT-TOT-ALLOWANCE * 10                              
W24029*    MOVE PV-DLRS-01-15  TO OR-ALLOWANCE                                  
W24029     MOVE CT-TOT-ALLOWANCE TO OR-ALLOWANCE                                
W24029*    MOVE 0              TO PV-DLRS                                       
                                                                                
           IF CT-TOT-TOTAL-SALES < 0                                            
               MOVE '-'        TO  OR-SB-SIGN                                   
           ELSE                                                                 
               MOVE ' '        TO  OR-SB-SIGN                                   
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = CT-TOT-TOTAL-SALES    * 10                         
W24029*    MOVE PV-DLRS-01-15  TO OR-SALES-BASE                                 
W24029     MOVE CT-TOT-TOTAL-SALES TO OR-SALES-BASE                             
W24029*    MOVE 0              TO PV-DLRS                                       
                                                                                
           IF CT-TOT-SHORT-RETAIL < 0                                           
               MOVE '-'        TO  OR-SD-SIGN                                   
           ELSE                                                                 
               MOVE ' '        TO  OR-SD-SIGN                                   
           END-IF                                                               
W24029*    COMPUTE PV-DLRS = CT-TOT-SHORT-RETAIL    * 10                        
W24029*    MOVE PV-DLRS-01-15  TO OR-SHORT-DOLLAR                               
W24029     MOVE CT-TOT-SHORT-RETAIL TO OR-SHORT-DOLLAR                          
W24029*    MOVE 0              TO PV-DLRS                                       
           MOVE CT-TOT-ALLOWANCE        TO CT-TOTAL-ALLOWANCE.                  
           MOVE CT-TOT-PHY-INV-RETAIL   TO CT-TOTAL-PHY-INV-RETAIL.             
           MOVE CT-TOT-TOTAL-SALES      TO CT-TOTAL-SALES.                      
           MOVE CT-TOT-SHORT-RETAIL     TO CT-TOTAL-SHORT-RETAIL                
           MOVE PV-SHORTPCT             TO CT-TOTAL-PERCENT.                    
           MOVE SPACES                  TO OR-PRIME-DC.                         
           IF CR-TYPE-RUN-IND = '1'                                             
               MOVE FC1-FINANCE-CORP01-TITLE                                    
                   TO CT-TOTAL-TITLE                                            
           END-IF                                                               
           IF CR-TYPE-RUN-IND = '2'                                             
               MOVE FC2-FINANCE-CORP02-TITLE                                    
                   TO CT-TOTAL-TITLE                                            
           END-IF                                                               
           IF CR-TYPE-RUN-IND = 'C'                                             
               MOVE CT-COMPANY-TITLE                                            
                   TO CT-TOTAL-TITLE                                            
           END-IF                                                               
           PERFORM Z300-PRINT-COMPANY-TOTALS.                                   
           PERFORM Z200-WRITE-OUTPUT-FILE.                                      
                                                                                
       Z100-PRINT-DETAIL-LINE.                                                  
      ****************************************************************          
      *    PRINT DETAIL LINE.                                                   
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS.                                       
           WRITE OUT-REPORT-RECORD                                              
               FROM DL-DETAIL-LINE                                              
               AFTER ADVANCING 1 LINE.                                          
           ADD 1 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
       Z200-WRITE-OUTPUT-FILE.                                                  
      ****************************************************************          
      *    WRITE STORE SHORTAGE OUTPUT FILE                                     
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
           WRITE OUT-STORE-RANKING-RECORD FROM OR-OUTPUT-RECORD.                
                                                                                
           EJECT                                                                
                                                                                
       Z300-PRINT-COMPANY-TOTALS.                                               
      ****************************************************************          
      *    PRINT COMPANY TOTAL LINE                                             
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS.                                       
           WRITE OUT-REPORT-RECORD                                              
               FROM DC-DEPARTMENT-COMPANY-LINE                                  
               AFTER ADVANCING 3 LINE.                                          
           ADD 1 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
       Z400-PRINT-DEPT-TOTALS.                                                  
      ****************************************************************          
      *    PRINT COMPANY TOTAL LINE                                             
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS.                                       
           WRITE OUT-REPORT-RECORD                                              
               FROM DC-DEPARTMENT-COMPANY-LINE                                  
               AFTER ADVANCING 3 LINE.                                          
           ADD 1 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
       Z300-DISPLAY-CNTL-MESSAGE.                                               
      ****************************************************************          
      *    DISPLAY ERROR MESSAGE                                                
      *    CONTROL RECORD IS MISSING                                            
      *                                                                         
      *    PERFORMED BY 3000-READ-CNTL-DATA                                     
      ****************************************************************          
                                                                                
           DISPLAY 'CONTROL RECORD IS MISSING'.                                 
