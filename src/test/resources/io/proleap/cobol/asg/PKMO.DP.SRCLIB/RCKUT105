000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    RCKUT105.                                         00040000
000500 AUTHOR.        JOE LAROSA.                                       00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   JANUARY 2000.                                     00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM READS IN THE SEQUENTIAL BACKUP OF THE TCEOUT1   * 00100000
001100*  TABLE (CE ITEMS DISTRIBUTED/POSTED FOR A DAY) SORTED IN PULL * 00110000
001200*  NUMBER, LINE NUMBER SEQUENCE.  THE PROGRAM WILL CREATE AN    * 00120000
001300*  EXTRACT RECORD FOR EVERY PULL#/LINE#/STORE. IN ADDITION, AN  * 00130000
001400*  EXTRACT RECORD WILL BE WRITTEN OUT FOR EACH PULL#/LINE# WITH * 00140000
001500*  THE ACCUMULATED STORE(S) QUANTITY (MULTIPLIED BY -1).        * 00150000
001600***************************************************************** 00160000
001700*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00170000
001800*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00180000
001900*                                                               * 00190000
002000***************************************************************** 00200000
002100***************************************************************** 00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300***************************************************************** 00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT CE-FILE        ASSIGN TO UT-S-INP01.                  00280000
002900     SELECT STOREEXT-FILE  ASSIGN TO UT-S-OUT01.                  00290000
003000                                                                  00300000
003100***************************************************************** 00310000
003200 DATA DIVISION.                                                   00320000
003300***************************************************************** 00330000
003400 FILE SECTION.                                                    00340000
003500                                                                  00350000
003600 FD  CE-FILE                                                      00360000
003700     RECORDING MODE IS F                                          00370000
003800     LABEL RECORDS ARE STANDARD                                   00380000
003900     RECORD CONTAINS 100                                          00390000
004000     BLOCK CONTAINS 0 RECORDS                                     00400000
004100     DATA RECORD IS CE-RECORD.                                    00410000
004200 01  CE-RECORD.                                                   00420000
004300     05  FILLER                  PIC  X(10).                      00430000
004400     05  CE-PULL-NBR             PIC  9(08).                      00440000
004500     05  CE-PULL-LNE-NBR         PIC  9(04).                      00450000
004600     05  FILLER                  PIC  X(20).                      00460000
004610     05  CE-DC-STORE-NBR         PIC  9(04).                      00461000
004620     05  FILLER                  PIC  X(54).                      00462000
004700                                                                  00470000
004800 FD  STOREEXT-FILE                                                00480000
004900     RECORDING MODE IS F                                          00490000
005000     LABEL RECORDS ARE STANDARD                                   00500000
005100     RECORD CONTAINS 300                                          00510000
005200     BLOCK CONTAINS 0 RECORDS                                     00520000
005300     DATA RECORD IS STOREEXT-RECORD.                              00530000
005400 01  STOREEXT-RECORD             PIC X(300).                      00540000
005500                                                                  00550000
005600***************************************************************** 00560000
005700 WORKING-STORAGE SECTION.                                         00570000
005800                                                                  00580000
005900 01  PS-PROGRAM-SWITCHES.                                         00590000
006000     05  PS-END-OF-INPUT-SW           PIC X(01)  VALUE 'N'.       00600000
006100         88  PS-END-OF-INPUT                     VALUE 'Y'.       00610000
006200         88  PS-NOT-END-OF-INPUT                 VALUE 'N'.       00620000
006300                                                                  00630000
006400 01  PV-PROGRAM-VARIABLES.                                        00640000
006500     05  PV-RECORDS-READ              PIC S9(8) VALUE ZERO.       00650000
006600     05  PV-ACCUM-RECORDS             PIC S9(8) VALUE ZERO.       00660000
006700     05  PV-RECORDS-WRITTEN           PIC S9(8) VALUE ZERO.       00670000
006800     05  PV-DISPLAY-RECORD            PIC ZZ,ZZZ,ZZZ-.            00680000
006900     05  PV-SAVE-FIELDS.                                          00690000
007000         10  PV-SAVE-PULL             PIC 9(08).                  00700000
007100         10  PV-SAVE-LINE             PIC 9(04).                  00710000
007110         10  PV-SAVE-DC-STORE         PIC 9(04).                  00711000
007200     05  PV-ACCUM-STORE-QTY           PIC S9(6) VALUE ZERO.       00720000
007300     05  PV-STORE-NMBR                PIC X(04).                  00730000
007400     05  FILLER REDEFINES PV-STORE-NMBR.                          00740000
007500         10  PV-STORE-NMBR-1          PIC 9(01).                  00750000
007600         10  PV-STORE-NMBR-3          PIC 9(03).                  00760000
007610     05  PV-SAVE-NEW-SKU.                                         00761020
007620         10  FILLER                   PIC X(05).                  00762016
007630         10  PV-SAVE-NEW-SEQ          PIC X(03).                  00763016
007700                                                                  00770000
007800 01 PC-PROGRAM-CONSTANTS.                                         00780000
007900     05 PC-PROGRAM-NAME               PIC X(08) VALUE 'RCKUT105'. 00790000
008000                                                                  00800000
008100 01  PV-ABEND-FIELDS.                                             00810000
008200     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKUT105'.00820000
008300     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00830000
008400     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00840000
008500     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    00850000
008600                                                                  00860000
008700***********************************************************       00870000
008800*  COPYBOOK USED BY INPUT FILE                            *       00880000
008900***********************************************************       00890000
009000     COPY CERD012.                                                00900021
009100                                                                  00910000
009200***********************************************************       00920000
009300*  COPYBOOK USED IN CREATING EXTRACT FILE.                *       00930000
009400***********************************************************       00940000
009500     COPY STOREEXT.                                               00950021
009600/                                                                 00960000
009700***********************************************************       00970000
009800 PROCEDURE DIVISION.                                              00980000
009900***********************************************************       00990000
010000     DISPLAY '*** BEGINNING RCKUT105 ***'.                        01000000
010100                                                                  01010000
010200     OPEN INPUT  CE-FILE                                          01020000
010300          OUTPUT STOREEXT-FILE.                                   01030000
010400                                                                  01040000
010500*READ FIRST INPUT RECORD.                                         01050000
010600     SET PS-NOT-END-OF-INPUT TO TRUE.                             01060000
010700     READ CE-FILE                                                 01070000
010800*      INTO CE-RECORD                          WR # 230ZZ  *      01080015
010900         AT END                                                   01090000
011000           SET PS-END-OF-INPUT TO TRUE.                           01100000
011100                                                                  01110000
011200*PROCESS INPUT FILE.                                              01120000
011300     IF PS-END-OF-INPUT                                           01130000
011400         DISPLAY '**** NO INPUT FILE FOUND FOR RCKUT105 ****'     01140000
011500     ELSE                                                         01150000
011800         MOVE CE-RECORD          TO CE012-CENTRAL-STK-XFER-RECORD 01180000
011900         MOVE CE012-PULL-NBR     TO PV-SAVE-PULL                  01190000
012000         MOVE CE012-PULL-LNE-NBR TO PV-SAVE-LINE                  01200000
012010         MOVE CE012-DC-STORE-NMBR TO PV-SAVE-DC-STORE             01201000
012100         MOVE ZEROES             TO PV-ACCUM-STORE-QTY            01210000
012200         PERFORM 1000-PROCESS-INPUT                               01220000
012300           UNTIL PS-END-OF-INPUT                                  01230000
012400     END-IF.                                                      01240000
012500                                                                  01250000
012600*WRITE LAST ACCUMULATOR RECORD.                                   01260000
012700     PERFORM 1100-WRITE-ACCUM-EXTRACT-RCD.                        01270000
012800                                                                  01280000
012900     MOVE PV-RECORDS-READ        TO PV-DISPLAY-RECORD.            01290000
013000     DISPLAY '*** RECORDS READ     ==> ' PV-DISPLAY-RECORD.       01300000
013100     MOVE PV-ACCUM-RECORDS       TO PV-DISPLAY-RECORD.            01310000
013200     DISPLAY '*** ACCUM RECORDS    ==> ' PV-DISPLAY-RECORD.       01320000
013300     MOVE PV-RECORDS-WRITTEN     TO PV-DISPLAY-RECORD.            01330000
013400     DISPLAY '*** RECORDS WRITTEN  ==> ' PV-DISPLAY-RECORD.       01340000
013500                                                                  01350000
013600*CLOSE FILES.                                                     01360000
013700     CLOSE CE-FILE                                                01370000
013800           STOREEXT-FILE.                                         01380000
013900                                                                  01390000
014000     GOBACK.                                                      01400000
014100                                                                  01410000
014200                                                                  01420000
014300***************************************************************** 01430000
014400 1000-PROCESS-INPUT.                                              01440000
014500***************************************************************** 01450000
014600     MOVE '1000-PROCESS-INPUT' TO PV-ABEND-PARAGRAPH.             01460000
014700                                                                  01470000
014800     ADD +1 TO PV-RECORDS-READ.                                   01480000
014900                                                                  01490000
015000     IF  (CE-PULL-NBR       NOT = PV-SAVE-PULL)                   01500000
015100     OR  (CE-PULL-LNE-NBR   NOT = PV-SAVE-LINE)                   01510000
015110     OR  (CE-DC-STORE-NBR   NOT = PV-SAVE-DC-STORE)               01511000
015200         PERFORM 1100-WRITE-ACCUM-EXTRACT-RCD                     01520000
015300         MOVE CE-PULL-NBR     TO PV-SAVE-PULL                     01530000
015400         MOVE CE-PULL-LNE-NBR TO PV-SAVE-LINE                     01540000
015410         MOVE CE-DC-STORE-NBR TO PV-SAVE-DC-STORE                 01541000
015500         MOVE ZEROES          TO PV-ACCUM-STORE-QTY               01550000
015600     END-IF.                                                      01560000
015700                                                                  01570000
015800*WRITE EXTRACT RECORD.                                            01580000
015900     IF NOT PS-END-OF-INPUT                                       01590000
016000         MOVE CE-RECORD TO CE012-CENTRAL-STK-XFER-RECORD          01600000
016100     END-IF.                                                      01610000
016200                                                                  01620000
016300     PERFORM 1200-WRITE-DETAIL-EXTRACT-RCD.                       01630000
016400                                                                  01640000
016500*READ NEXT INPUT RECORD.                                          01650000
016600     PERFORM 2000-READ-INPUT-FILE.                                01660000
016700                                                                  01670000
016800***************************************************************** 01680000
016900 1100-WRITE-ACCUM-EXTRACT-RCD.                                    01690000
017000***************************************************************** 01700000
017100     MOVE '1100-WRITE-ACCUM-EXTRACT-RCD' TO PV-ABEND-PARAGRAPH.   01710000
017200                                                                  01720000
017300     MOVE SPACES TO STORE-EXTRACT-LINE.                           01730000
017400     MOVE ZEROES TO SE-STORE                                      01740000
017500                    SE-DEPT                                       01750000
017600                    SE-PO                                         01760000
017700                    SE-DATE-VERIFIED-COUNT                        01770000
017800                    SE-DATE-RECEIVED                              01780000
017900                    SE-UNIT-RETAIL                                01790000
018000                    SE-LOWEST-RETAIL                              01800000
018100                    SE-RETAIL-UNITS-ORDER                         01810000
018200                    SE-RETAIL-UNITS-RECVD                         01820000
018300                    SE-RETAIL-UNITS-MARK                          01830000
018400                    SE-COST-EXTENSION                             01840000
018500                    SE-RETAIL-EXTENSION                           01850000
018600                    SE-INVOICE-QTY-RETAIL                         01860000
018700                    SE-DISCOUNT-DAYS                              01870000
018800                    SE-POLINENO                                   01880000
018900                    SE-REC-SEQ-NBR                                01890000
019000                    SE-NOTIF-NBR                                  01900000
019100                    SE-ADJ-CYC-NBR                                01910000
019200                    SE-OPER-UNT-ID                                01920000
019300                    SE-FCLTY-ID                                   01930000
019400                    SE-CURR-OPER-UNT-ID                           01940000
019500                    SE-CURR-FCLTY-ID                              01950022
019510                    SE-LOC-NBR.                                   01951022
019600                                                                  01960000
019700     MOVE CE012-PULL-NBR                TO SE-PO.                 01970000
019800     MOVE CE012-PULL-LNE-NBR            TO SE-POLINENO.           01980000
019900     MOVE CE012-DEPT                    TO SE-DEPT.               01990000
020000     MOVE CE012-CLASS                   TO SE-CLASS.              02000000
020110     MOVE CE012-SKU-NBR                 TO PV-SAVE-NEW-SKU.       02011016
020111     MOVE PV-SAVE-NEW-SEQ               TO SE-SKU-SEQ.            02011116
020120     MOVE CE012-SKU-NBR                 TO SE-SKU-NBR.            02012020
020200     MOVE CE012-UNIT-PRICE              TO SE-UNIT-RETAIL         02020021
020210                                           SE-LOWEST-RETAIL.      02021021
020300     MOVE CE012-DC-STORE-NMBR           TO PV-STORE-NMBR          02030000
020310                                           SE-LOC-NBR             02031022
020400                                           SE-OPER-UNT-ID         02040000
020500                                           SE-CURR-OPER-UNT-ID.   02050000
020600     MOVE PV-STORE-NMBR-3               TO SE-STORE.              02060000
020700                                                                  02070000
020800     COMPUTE SE-RETAIL-UNITS-MARK = PV-ACCUM-STORE-QTY * -1.      02080000
020900                                                                  02090000
021000     MOVE CE012-FILLED-DATE-MMDDCCYY-MM TO SE-DV-MM.              02100000
021100     MOVE CE012-FILLED-DATE-MMDDCCYY-DD TO SE-DV-DD.              02110000
021200     MOVE CE012-FILLED-DATE-MMDDCCYY-YY TO SE-DV-YY.              02120000
021300                                                                  02130000
021400     WRITE STOREEXT-RECORD    FROM  STORE-EXTRACT-LINE.           02140000
021500***  MOVE SE-RETAIL-UNITS-MARK TO PV-DISPLAY-RECORD.              02150000
021600***  DISPLAY '  ** ACCUM AMT = ' PV-DISPLAY-RECORD.               02160000
021700                                                                  02170000
021800     ADD +1                    TO   PV-RECORDS-WRITTEN.           02180000
021900     ADD +1                    TO   PV-ACCUM-RECORDS.             02190000
022000                                                                  02200000
022100***************************************************************** 02210000
022200 1200-WRITE-DETAIL-EXTRACT-RCD.                                   02220000
022300***************************************************************** 02230000
022400     MOVE '1200-WRITE-DETAIL-EXTRACT-RCD' TO PV-ABEND-PARAGRAPH.  02240000
022500                                                                  02250000
022600     MOVE SPACES TO STORE-EXTRACT-LINE.                           02260000
022700     MOVE ZEROES TO SE-STORE                                      02270000
022800                    SE-DEPT                                       02280000
022900                    SE-PO                                         02290000
023000                    SE-DATE-VERIFIED-COUNT                        02300000
023100                    SE-DATE-RECEIVED                              02310000
023200                    SE-UNIT-RETAIL                                02320000
023300                    SE-LOWEST-RETAIL                              02330000
023400                    SE-RETAIL-UNITS-ORDER                         02340000
023500                    SE-RETAIL-UNITS-RECVD                         02350000
023600                    SE-RETAIL-UNITS-MARK                          02360000
023700                    SE-COST-EXTENSION                             02370000
023800                    SE-RETAIL-EXTENSION                           02380000
023900                    SE-INVOICE-QTY-RETAIL                         02390000
024000                    SE-DISCOUNT-DAYS                              02400000
024100                    SE-POLINENO                                   02410000
024200                    SE-REC-SEQ-NBR                                02420000
024300                    SE-NOTIF-NBR                                  02430000
024400                    SE-ADJ-CYC-NBR                                02440000
024500                    SE-OPER-UNT-ID                                02450000
024600                    SE-FCLTY-ID                                   02460000
024700                    SE-CURR-OPER-UNT-ID                           02470000
024800                    SE-CURR-FCLTY-ID                              02480023
024810                    SE-LOC-NBR.                                   02481023
024900                                                                  02490000
025000     MOVE CE012-PULL-NBR                TO SE-PO.                 02500000
025100     MOVE CE012-PULL-LNE-NBR            TO SE-POLINENO.           02510000
025200                                                                  02520000
025300     MOVE CE012-RECV-STORE-NMBR         TO PV-STORE-NMBR          02530023
025310                                           SE-LOC-NBR.            02531023
025400     MOVE PV-STORE-NMBR-3               TO SE-STORE.              02540000
025500                                                                  02550000
025600     MOVE CE012-DEPT                    TO SE-DEPT.               02560000
025700     MOVE CE012-CLASS                   TO SE-CLASS.              02570000
025801     MOVE CE012-SKU-NBR                 TO PV-SAVE-NEW-SKU.       02580116
025802     MOVE PV-SAVE-NEW-SEQ               TO SE-SKU-SEQ.            02580216
025810     MOVE CE012-SKU-NBR                 TO SE-SKU-NBR.            02581020
025900     MOVE CE012-UNIT-PRICE              TO SE-UNIT-RETAIL         02590021
025910                                           SE-LOWEST-RETAIL.      02591021
026000     MOVE CE012-RECV-STORE-QTY          TO SE-RETAIL-UNITS-MARK.  02600000
026100     MOVE CE012-FILLED-DATE-MMDDCCYY-MM TO SE-DV-MM.              02610000
026200     MOVE CE012-FILLED-DATE-MMDDCCYY-DD TO SE-DV-DD.              02620000
026300     MOVE CE012-FILLED-DATE-MMDDCCYY-YY TO SE-DV-YY.              02630000
026400     MOVE CE012-DC-STORE-NMBR           TO SE-OPER-UNT-ID         02640000
026500                                           SE-CURR-OPER-UNT-ID.   02650000
026600                                                                  02660000
026700     WRITE STOREEXT-RECORD    FROM  STORE-EXTRACT-LINE.           02670000
026800                                                                  02680000
026900     ADD CE012-RECV-STORE-QTY  TO   PV-ACCUM-STORE-QTY.           02690000
027000     ADD +1                    TO   PV-RECORDS-WRITTEN.           02700000
027100                                                                  02710000
027200***************************************************************** 02720000
027300 2000-READ-INPUT-FILE.                                            02730000
027400***************************************************************** 02740000
027500     MOVE '2000-READ-INPUT-FILE' TO PV-ABEND-PARAGRAPH.           02750000
027600                                                                  02760000
027700     READ CE-FILE                                                 02770000
027800*      INTO CE-RECORD                          WR # 230ZZ  *      02780015
027900         AT END                                                   02790000
028000           SET PS-END-OF-INPUT TO TRUE.                           02800000
028100                                                                  02810000
028200***************************************************************** 02820000
028300***************************************************************** 02830000
