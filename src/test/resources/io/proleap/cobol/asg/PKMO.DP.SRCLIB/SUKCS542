000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS542.                                         00040038
000500 AUTHOR.        JIM ARENDT.                                       00050038
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  APRIL, 2017.                                      00070038
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S542 - SHIPPING DOOR STATUS  - SML CARTON FLOW LIST        * 00100038
001100*---------------------------------------------------------------* 00110000
001110* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00111099
001120* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00112099
001130* MAKING THE CALL DYNAMIC VS STATIC.                              00113099
001130*                                                                 00113199
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00113299
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00113399
001140*---------------------------------------------------------------* 00114099
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-TRLR-SRL-NBR                PIC S9(09) COMP.          00170000
001800     05  DK-SCN-CDE                     PIC  X(04).               00180099
001900     05  DK-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00190000
002000     05  DK-KOHLS-BARCODE.                                        00200000
002100         10   FILLER                    PIC X(02)  VALUE '00'.    00210000
002200         10   DK-KOHLS-18               PIC X(18)  VALUE SPACES.  00220000
002300         10   FILLER                    PIC X(02)  VALUE SPACES.  00230000
002400     05  DK-KOHLS-BRCDE REDEFINES DK-KOHLS-BARCODE                00240000
002500                                        PIC X(22).                00250000
002600     05  DK-CRE-DATE.                                             00260000
002700         10   DK-TMST-CCYY              PIC X(04).                00270000
002800         10   FILLER                    PIC X(01).                00280000
002900         10   DK-TMST-MM                PIC X(02).                00290000
003000         10   FILLER                    PIC X(01).                00300000
003100         10   DK-TMST-DD                PIC X(02).                00310000
003200     05  DK-CRE-TIME.                                             00320000
003300         10   DK-TMST-HRS               PIC X(02).                00330000
003400         10   FILLER                    PIC X(01).                00340000
003500         10   DK-TMST-MIN               PIC X(02).                00350000
003600         10   FILLER                    PIC X(01).                00360000
003700         10   DK-TMST-SEC               PIC X(02).                00370000
003800                                                                  00380000
003900 01  PC-PROGRAM-CONSTANTS.                                        00390000
004000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU542A  '.  00400038
004100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM542'.   00410038
004200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS542'.  00420038
004300     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00430000
004400     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00440000
004500     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00450000
004600     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00460000
004700     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00470000
004800                                               COMP SYNC.         00480000
004900     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00490000
005000                                               COMP SYNC.         00500000
005100     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00510000
005200                                               COMP-3.            00520000
005300     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00530000
005400                                               COMP SYNC.         00540000
005500     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00550000
005600                                               COMP-3.            00560000
005700     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00570000
005800     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00580000
005900     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00590000
006000     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00600000
006100     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00610000
006200     05  PC-COLON                  PIC  X(01)  VALUE ':'.         00620043
006300     05  PC-A                      PIC  X(01)  VALUE 'A'.         00630088
006400     05  PC-C                      PIC  X(01)  VALUE 'C'.         00640070
006500     05  PC-D                      PIC  X(01)  VALUE 'D'.         00650068
006600     05  PC-I                      PIC  X(01)  VALUE 'I'.         00660088
006700     05  PC-M                      PIC  X(01)  VALUE 'M'.         00670070
006800     05  PC-N                      PIC  X(01)  VALUE 'N'.         00680087
006900     05  PC-Y                      PIC  X(01)  VALUE 'Y'.         00690088
007000                                                                  00700047
007100*----------------------------------------------------------------*00710000
007200*  SYSTEM MESSAGES                                               *00720000
007300*----------------------------------------------------------------*00730000
007400*   00005 = INVALID VALUE                                        *00740000
007500*   00008 = MUST BE NUMERIC                                      *00750000
007600*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00760000
007700*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00770000
007800*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00780000
007900*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00790000
008000*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00800000
008100*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00810000
008200*   00069 - TOP OF LIST                                          *00820000
008300*   00070 - BOTTOM OF LIST                                       *00830000
008400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00840000
008500*   00279 - MORE ITEMS TO DISPLAY                                *00850000
008600*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00860000
008700*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00870000
008800*   99901 = INVALID COMMAND WAS ENTERED                          *00880000
008900*----------------------------------------------------------------*00890000
009000     05  PC-TSYMSG-NUMBERS.                                       00900000
009100         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00910000
009200         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00920000
009300         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00930000
009400         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00940000
009500         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00950000
009600         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00960000
009700         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00970000
009800         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00980000
009900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00990000
010000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01000000
010100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01010000
010200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01020000
010300         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01030000
010400         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01040000
010500         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01050000
010600         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01060000
010700                                                                  01070050
010800 01  PS-PROGRAM-SWITCHES.                                         01080000
010900     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01090000
011000         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01100000
011100         88  PS-BLOCK-ERROR                         VALUE 'N'.    01110000
011200     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01120000
011300         88  PS-NO-ERROR                            VALUE 'Y'.    01130000
011400         88  PS-ERROR                               VALUE 'N'.    01140000
011500     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01150084
011600         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01160084
011700         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01170084
011800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01180000
011900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01190000
012000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01200000
012100     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01210000
012200         88  PS-DONE                                VALUE 'Y'.    01220000
012300         88  PS-NOT-DONE                            VALUE 'N'.    01230000
012400     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01240084
012500         88  PS-LIST-END                            VALUE 'Y'.    01250084
012600         88  PS-NO-LIST-END                         VALUE 'N'.    01260084
012700     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01270084
012800         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01280084
012900         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01290084
013000                                                                  01300047
013100 01  PV-PROGRAM-VARIABLES.                                        01310000
013200     05  PV-DISPLAY-PARENT               PIC  9(18)  VALUE  0.    01320020
013300     05  PV-DISPLAY-ORIG                 PIC  9(18)  VALUE  0.    01330008
013400     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01340000
013500                                                     COMP SYNC.   01350000
013600     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01360000
013700     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01370000
013800     05  PV-RACF-ERROR-CODE              PIC  9(04)  VALUE ZEROES.01380084
013900     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROES 01390084
014000                                                     COMP SYNC.   01400084
014100     05  PV-NULL-IND-1                   PIC S9(04)  VALUE +0     01410084
014200                                                     COMP.        01420084
014300     05  PV-NULL-IND-2                   PIC S9(04)  VALUE +0     01430084
014400                                                     COMP.        01440084
014500     05  PV-NULL-IND-3                   PIC S9(04)  VALUE +0     01450084
014600                                                     COMP.        01460084
014700     05  PV-NULL-IND-4                   PIC S9(04)  VALUE +0     01470084
014800                                                     COMP.        01480084
014900     05  PV-SUB                          PIC S9(04)  VALUE +0     01490084
015000                                                     COMP SYNC.   01500084
015100     05  PV-REMAINDER                    PIC S9(04)  VALUE +0     01510084
015200                                                     COMP SYNC.   01520084
015300     05  PV-READ-COUNT                   PIC S9(09)  VALUE +0     01530084
015400                                                     COMP-3.      01540084
015500     05  PV-ITEMS-PROCESSED              PIC S9(09)  VALUE +0     01550084
015600                                                     COMP-3.      01560084
015700     05  PV-HOLD-SELECTED-ITEMS          PIC S9(09)  VALUE +0     01570084
015800                                                     COMP-3.      01580084
015900     05  PV-ITEM-IN-USE                  PIC S9(09)  VALUE +0     01590084
016000                                                     COMP-3.      01600084
016100     05  PV-TOP-ITEM                     PIC S9(09)  VALUE +0     01610084
016200                                                     COMP-3.      01620084
016300     05  PV-BOTTOM-ITEM                  PIC S9(09)  VALUE +0     01630084
016400                                                     COMP-3.      01640084
016500     05  PV-TEMP-BLOCK-NUMBER            PIC S9(09)  VALUE +0     01650084
016600                                                     COMP-3.      01660084
016700     05  PV-BLOCK-NUMBER                 PIC S9(04)  VALUE +0     01670084
016800                                                     COMP SYNC.   01680084
016900     05  PV-CICS-RESP                    PIC S9(04)  VALUE +0     01690084
017000                                                     COMP SYNC.   01700084
017100     05  PV-ITEM                         PIC S9(04)  VALUE +0     01710084
017200                                                     COMP SYNC.   01720084
017300     05  PV-SEL-QUEUE-ITEM               PIC S9(04)  VALUE +0     01730084
017400                                                     COMP SYNC.   01740084
017500     05  PV-SAVE-ITEM                    PIC S9(04)  VALUE +0     01750084
017600                                                     COMP SYNC.   01760084
017700     05  PV-HIGHEST-BLOCK-WRITTEN        PIC S9(04)  VALUE +0     01770084
017800                                                     COMP SYNC.   01780084
017900     05  PV-LIST-ITEM-NUMBER             PIC S9(04)  VALUE +0     01790084
018000                                                     COMP SYNC.   01800084
018100     05  PV-FIRST-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0     01810084
018200                                                     COMP SYNC.   01820084
018300     05  PV-NEXT-BLOCK-IN-ARRAY          PIC S9(04)  VALUE +0     01830084
018400                                                     COMP SYNC.   01840084
018500     05  PV-PREV-BLOCK-IN-ARRAY          PIC S9(04)  VALUE +0     01850084
018600                                                     COMP SYNC.   01860084
018700     05  PV-FIRST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0     01870084
018800                                                     COMP SYNC.   01880084
018900     05  PV-LAST-BLOCK-IN-RANGE          PIC S9(04)  VALUE +0     01890084
019000                                                     COMP SYNC.   01900084
019100     05  PV-START-OF-SELECTED-RANGE      PIC S9(04)  VALUE +0     01910084
019200                                                     COMP SYNC.   01920084
019300     05  PV-END-OF-SELECTED-RANGE        PIC S9(04)  VALUE +0     01930084
019400                                                     COMP SYNC.   01940084
019500     05  PV-SQL-SUB                      PIC S9(04)  VALUE +0     01950084
019600                                                     COMP SYNC.   01960084
019700     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE +0     01970084
019800                                                     COMP SYNC.   01980084
019900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01990085
020000                                                     COMP SYNC.   02000085
020100     05  PV-SOFT-ABORT-MSG.                                       02010000
020200         10  FILLER            PIC X(12) VALUE ' SUKCS542 - '.    02020038
020300         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02030000
020400         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02040000
020500         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02050000
020600         10  PV-SOFT-PARAGRAPH PIC X(30).                         02060000
020700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02070000
020800     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02080000
020900     05  PV-CICS-MSG-HOLD.                                        02090000
021000         10  FILLER                      PIC  X(01)  VALUE SPACE. 02100000
021100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02110000
021200     05  PV-CICS-MSG-HOLD2.                                       02120000
021300         10  FILLER                      PIC  X(01)  VALUE SPACE. 02130000
021400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02140000
021500     05  PV-TASK                         PIC  9999.               02150050
021600                                                                  02160000
021700     05  PV-DATE-DISPLAY.                                         02170000
021800         10   PV-DISPLAY-MM              PIC  X(02)  VALUE SPACE. 02180084
021900         10   PV-SLASH-1                 PIC  X(01)  VALUE '/'.   02190084
022000         10   PV-DISPLAY-DD              PIC  X(02)  VALUE SPACE. 02200084
022100         10   PV-SLASH-2                 PIC  X(01)  VALUE '/'.   02210084
022200         10   PV-DISPLAY-CCYY            PIC  X(04)  VALUE SPACE. 02220084
022300     05  PV-TIME-DISPLAY.                                         02230000
022400         10   PV-DISPLAY-HRS             PIC  X(02)  VALUE SPACE. 02240084
022500         10   FILLER                     PIC  X(01)  VALUE ':'.   02250084
022600         10   PV-DISPLAY-MIN             PIC  X(02)  VALUE SPACE. 02260084
022700         10   FILLER                     PIC  X(01)  VALUE ':'.   02270084
022800         10   PV-DISPLAY-SEC             PIC  X(02)  VALUE SPACE. 02280084
022900     05  PV-DATE-DISPLAY2.                                        02290089
023000         10   PV-DISPLAY2-MM             PIC  X(02)  VALUE SPACE. 02300089
023100         10   PV-SLASH2-1                PIC  X(01)  VALUE '/'.   02310089
023200         10   PV-DISPLAY2-DD             PIC  X(02)  VALUE SPACE. 02320089
023300         10   PV-SLASH2-2                PIC  X(01)  VALUE '/'.   02330089
023400         10   PV-DISPLAY2-YY             PIC  X(02)  VALUE SPACE. 02340089
023500     05  PV-DB2-DATE.                                             02350042
023600         10  PV-DB2-CC                   PIC  X(02)  VALUE SPACE. 02360084
023700         10  PV-DATE.                                             02370042
023800             15  PV-DB2-YY               PIC  X(02)  VALUE SPACE. 02380084
023900             15  PV-SLASH1               PIC  X(01).              02390050
024000             15  PV-DB2-MM               PIC  X(02)  VALUE SPACE. 02400084
024100             15  PV-SLASH2               PIC  X(01).              02410050
024200             15  PV-DB2-DD               PIC  X(02)  VALUE SPACE. 02420084
024300         10  FILLER                      PIC  X(01).              02430050
024400         10  PV-TIME.                                             02440042
024500             15  PV-DB2-HR               PIC  X(02)  VALUE SPACE. 02450091
024600             15  PV-COLON                PIC  X(01).              02460050
024700             15  PV-DB2-MIN              PIC  X(02)  VALUE SPACE. 02470091
024800         10  FILLER                      PIC  X(11).              02480050
024900     05  PV-SELECT-LIST-SEQ              PIC  X(01)  VALUE SPACE. 02490084
025000     05  PV-NBR-ITEMS                    PIC  9(05)  VALUE ZEROES.02500084
025100     05  PV-SEL-TERM-ID                  PIC  X(04).              02510000
025200     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02520000
025300     05  PV-SEL-SEQ                      PIC  9(01).              02530000
025400     05  PV-SHPD-QTY                     PIC S9(9)V  COMP-3.      02540084
025500     05  PV-SHPD-QTY-N                   PIC Z(05).               02550000
025600     05  PV-SHPD-QTY-X REDEFINES PV-SHPD-QTY-N                    02560000
025700                                         PIC X(05).               02570000
025800     05  PV-CODE                         PIC  X(01)  VALUE SPACES.02580084
025900     05  PV-SRC-CDE                      PIC  X(03)  VALUE SPACES.02590084
026000     05  PV-CRE-FLOW-TMST                PIC  X(26)  VALUE SPACES.02600084
026100     05  PV-PROCESS-SCAN-CDE             PIC  X(17)  VALUE SPACES.02610084
026200     05  PV-CRE-USR-ID                   PIC  X(08)  VALUE SPACES.02620084
026300     05  PV-ACTIVE-CODE                  PIC  X(01)  VALUE SPACES.02630084
026400     05  PV-SML-SHPD-UNT-ID              PIC S9(18)  VALUE ZERO   02640085
026500                                                     COMP-3.      02650085
026600     05  PV-LOC-NBR                      PIC S9(04)  VALUE ZERO   02660085
026700                                                     COMP.        02670085
026800     05  PV-OTBND-TRIP-ID                PIC S9(09)  VALUE ZERO   02680085
026900                                                     COMP.        02690084
027000     05  PV-INBND-TRIP-ID                PIC S9(09)  VALUE ZERO   02700085
027100                                                     COMP.        02710084
027200     05  PV-DEST                         PIC S9(04)  VALUE ZERO   02720085
027300                                                     COMP.        02730084
027400     05  PV-CRE-PGM-NAME                 PIC  X(08)  VALUE SPACES.02740085
027500     05  PV-DOOR-NBR                     PIC  X(04)  VALUE SPACES.02750085
027600     05  PV-MASTER-TYPE                  PIC  X(17)  VALUE SPACES.02760084
027700     05  PV-CHILD-DESC                   PIC  X(30)  VALUE SPACES.02770084
027800     05  PV-CHILD-TYPE                   PIC  X(03)  VALUE SPACES.02780084
027810     05  PV-PNA-CHECKIN                  PIC  X(17)  VALUE        02781099
027820                                              'PNA CRTN CHECK-IN'.02782099
027830     05  PV-RF-CHECKIN                   PIC  X(17)  VALUE        02783099
027840                                              'RF CRTN CHECK-IN '.02784099
027850     05  PV-3WD-RECV                     PIC  X(17)  VALUE        02785099
027860                                              'RCVD 3RD PTY WHSE'.02786099
027900     05  PV-CARTON-MSG.                                           02790038
028000         10  FILLER                   PIC X(01) VALUE SPACE.      02800038
028100         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 02810038
028200         10  FILLER                   PIC X(01) VALUE '-'.        02820038
028300         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     02830038
028400         10  FILLER                   PIC X(05) VALUE ' REC='.    02840038
028500         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     02850038
028600         10  FILLER                   PIC X(10)                   02860038
028700                             VALUE ' CTN STAT='.                  02870038
028800         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     02880038
028900         10  FILLER                   PIC X(01) VALUE '/'.        02890038
029000         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     02900038
029100         10  FILLER                   PIC X(05) VALUE ' SER='.    02910038
029200         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     02920038
029300         10  FILLER                   PIC X(06) VALUE ' TRIP='.   02930038
029400         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     02940038
029500         10  FILLER                   PIC X(06) VALUE ' STAT='.   02950038
029600         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     02960038
029700         10  FILLER                   PIC X(06) VALUE ' USER='.   02970038
029800         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     02980038
029900                                                                  02990000
030000******************************************************************03000000
030100* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    03010099
030200******************************************************************03020000
030300     COPY PCWS046.                                                03030000
030400                                                                  03040047
030500******************************************************************03050000
030600**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03060000
030700**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03070000
030800**  APPLICATION-SPECIFIC COMMAREA.                              **03080000
030900******************************************************************03090000
031000 01  LQW-LIST-QUEUE-WORK-AREA.                                    03100000
031100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03110000
031200     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03120000
031300                                        INDEXED BY LQW-IDX.       03130000
031400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03140000
031500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03150000
031600         10  LQW-SELECTED-SW            PIC  X(01).               03160000
031700             88  LQW-SELECT                         VALUE 'S'.    03170000
031800             88  LQW-DESELECT                       VALUE ' '.    03180000
031900         10  LQW-ACTION                 PIC  X(03).               03190000
032000             88  LQW-DEL                            VALUE 'DEL'.  03200000
032100             88  LQW-INQ                            VALUE 'INQ'.  03210000
032200             88  LQW-UPD                            VALUE 'UPD'.  03220000
032300             88  LQW-ERR                            VALUE 'ERR'.  03230000
032400         10  LQW-CODE                   PIC  X(01).               03240038
032500         10  LQW-SML-SHPD-UNT-ID        PIC S9(18)  COMP-3.       03250038
032600         10  LQW-SRC-CDE                PIC  X(03).               03260038
032700         10  LQW-CRE-FLOW-TMST          PIC  X(26).               03270038
032800         10  LQW-LOC-NBR                PIC S9(04)  COMP.         03280038
032900         10  LQW-PROCESS-SCAN-CDE       PIC  X(17).               03290063
033000         10  LQW-CRE-USR-ID             PIC  X(08).               03300038
033100         10  LQW-ACTIVE-CODE            PIC  X(01).               03310038
033200         10  LQW-OTBND-TRIP-ID          PIC S9(09)  COMP.         03320038
033300         10  LQW-INBND-TRIP-ID          PIC S9(09)  COMP.         03330038
033400         10  LQW-CRE-PGM-NAME           PIC  X(08).               03340038
033500         10  LQW-DOOR-NBR               PIC  X(04).               03350038
033600         10  LQW-DEST                   PIC S9(04)  COMP.         03360038
033700         10  LQW-MASTER-TYPE            PIC  X(03).               03370038
033800         10  LQW-CHILD-DESC             PIC  X(30).               03380038
033900         10  LQW-CHILD-TYPE             PIC  X(03).               03390038
034000                                                                  03400000
034100*---------------------------------------------------------------* 03410000
034200* SELECTON QUEUE LAYOUT                                         * 03420000
034300*---------------------------------------------------------------* 03430000
034400     COPY SUWS010.                                                03440000
034500                                                                  03450000
034600*---------------------------------------------------------------* 03460000
034700*    MAP LAYOUT                                                 * 03470000
034800*---------------------------------------------------------------* 03480000
034900     COPY SUKM542.                                                03490038
035000                                                                  03500047
035100 01  MR-OCCURS-LAYOUT                   REDEFINES  SU542AO.       03510038
035200     05  FILLER                         PIC X(349).               03520061
035300     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03530000
035400                                                                  03540000
035500         10  MR-DATEL                   PIC S9(04) COMP.          03550038
035600         10  MR-DATEA                   PIC  X(01).               03560038
035700         10  MR-DATEC                   PIC  X(01).               03570038
035800         10  MR-DATEH                   PIC  X(01).               03580038
035900         10  MR-DATE                    PIC  X(08).               03590047
036000                                                                  03600038
036100         10  MR-TIME-L                  PIC S9(04) COMP.          03610038
036200         10  MR-TIME-A                  PIC  X(01).               03620038
036300         10  MR-TIME-C                  PIC  X(01).               03630038
036400         10  MR-TIME-H                  PIC  X(01).               03640038
036500         10  MR-TIME                    PIC  X(05).               03650038
036600                                                                  03660038
036700         10  MR-LOC-L                   PIC S9(04) COMP.          03670038
036800         10  MR-LOC-A                   PIC  X(01).               03680038
036900         10  MR-LOC-C                   PIC  X(01).               03690038
037000         10  MR-LOC-H                   PIC  X(01).               03700038
037100         10  MR-LOC                     PIC  ZZZ9  BLANK ZERO.    03710059
037200                                                                  03720038
037300         10  MR-PROCESS-L               PIC S9(04) COMP.          03730038
037400         10  MR-PROCESS-A               PIC  X(01).               03740038
037500         10  MR-PROCESS-C               PIC  X(01).               03750038
037600         10  MR-PROCESS-H               PIC  X(01).               03760038
037700         10  MR-PROCESS                 PIC  X(17).               03770057
037800                                                                  03780038
037900         10  MR-USERID-L                PIC S9(04) COMP.          03790038
038000         10  MR-USERID-A                PIC  X(01).               03800038
038100         10  MR-USERID-C                PIC  X(01).               03810038
038200         10  MR-USERID-H                PIC  X(01).               03820038
038300         10  MR-USERID                  PIC  X(08).               03830038
038400                                                                  03840038
038500         10  MR-AI-L                    PIC S9(04) COMP.          03850038
038600         10  MR-AI-A                    PIC  X(01).               03860038
038700         10  MR-AI-C                    PIC  X(01).               03870038
038800         10  MR-AI-H                    PIC  X(01).               03880038
038900         10  MR-AI                      PIC  X(01).               03890038
039000                                                                  03900038
039100         10  MR-INBD-TRIP-L             PIC S9(04) COMP.          03910038
039200         10  MR-INBD-TRIP-A             PIC  X(01).               03920038
039300         10  MR-INBD-TRIP-C             PIC  X(01).               03930038
039400         10  MR-INBD-TRIP-H             PIC  X(01).               03940038
039500         10  MR-INBD-TRIP               PIC  ZZZZZZZZ9 BLANK ZERO.03950059
039600                                                                  03960038
039700         10  MR-OUTBD-TRIP-L            PIC S9(04) COMP.          03970050
039800         10  MR-OUTBD-TRIP-A            PIC  X(01).               03980038
039900         10  MR-OUTBD-TRIP-C            PIC  X(01).               03990038
040000         10  MR-OUTBD-TRIP-H            PIC  X(01).               04000038
040100         10  MR-OUTBD-TRIP              PIC  ZZZZZZZZ9 BLANK ZERO.04010059
040200                                                                  04020038
040300         10  MR-DEST-L                  PIC S9(04) COMP.          04030038
040400         10  MR-DEST-A                  PIC  X(01).               04040038
040500         10  MR-DEST-C                  PIC  X(01).               04050038
040600         10  MR-DEST-H                  PIC  X(01).               04060038
040700         10  MR-DEST                    PIC  ZZZ9   BLANK ZERO.   04070047
040800                                                                  04080038
040900         10  MR-MASTER-L                PIC S9(04) COMP.          04090038
041000         10  MR-MASTER-A                PIC  X(01).               04100038
041100         10  MR-MASTER-C                PIC  X(01).               04110038
041200         10  MR-MASTER-H                PIC  X(01).               04120038
041300         10  MR-MASTER                  PIC  X(04).               04130038
041400                                                                  04140000
041500*---------------------------------------------------------------* 04150000
041600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04160000
041700*---------------------------------------------------------------* 04170000
041800     COPY DPWS015.                                                04180000
041900                                                                  04190000
042000*---------------------------------------------------------------* 04200000
042100*    FUNCTION KEYS COPYBOOK.                                    * 04210000
042200*---------------------------------------------------------------* 04220000
042300     COPY DPWS016.                                                04230000
042400                                                                  04240000
042500*---------------------------------------------------------------* 04250000
042600*    NUMERIC EDIT LAYOUT.                                       * 04260000
042700*---------------------------------------------------------------* 04270000
042800     COPY DPWS010I.                                               04280000
042900                                                                  04290000
043000*----------------------------------------------------------------*04300000
043100**  SECURITY SUBROUTINE PARAMETERS                                04310000
043200*----------------------------------------------------------------*04320000
043300     COPY DPWS008.                                                04330000
043400                                                                  04340000
043500*---------------------------------------------------------------* 04350000
043600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04360099
043700*---------------------------------------------------------------* 04370000
043800     COPY DPWS030.                                                04380000
043800     COPY DPWS930.                                                04381099
043900                                                                  04390000
044000*---------------------------------------------------------------* 04400000
044100*    STANDARD COMMAREA.                                         * 04410000
044200*---------------------------------------------------------------* 04420000
044300     COPY DPWS020.                                                04430000
044400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04440000
044500                                                                  04450000
044600*---------------------------------------------------------------* 04460000
044700* INTER-APPLICATION COMMAREA.                                   * 04470000
044800*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04480000
044900*             SPEC SCREEN.                                      * 04490000
045000*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04500000
045100*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04510000
045200*---------------------------------------------------------------* 04520000
045300                                                                  04530000
045400         10  INTER-APPL-COMM-AREA       PIC X(200).               04540000
045500                                                                  04550038
045600*  INPUT FROM SU-OUTBOUND MANIF CTN CRIT SPEC SCREEN, SUKCS595    04560054
045700     COPY SUWS008.                                                04570041
045800                                                                  04580038
045900*  INPUT FROM SU-OUTBOUND PO/RCVR CTN LIST SCREEN, SUKCS596       04590054
046000     COPY SUWS009.                                                04600041
046100                                                                  04610054
046200*---------------------------------------------------------------* 04620000
046300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04630000
046400*---------------------------------------------------------------* 04640000
046500         10  ASC-SPECIFIC-COMMAREA.                               04650000
046600             15  ASC-SML-SHPD-UNT-ID         PIC S9(18) COMP-3.   04660045
046700             15  ASC-OPER-UNT-ID             PIC  X(04).          04670000
046800             15  ASC-OPER-UNT-ID-N REDEFINES                      04680000
046900                     ASC-OPER-UNT-ID         PIC  9(04).          04690000
047000             15  ASC-DOOR-ID                 PIC  X(04).          04700000
047100             15  ASC-TRLR-SRL-NMBR           PIC  9(10).          04710005
047200             15  ASC-SCAC-CODE               PIC  X(04).          04720006
047300             15  ASC-DOOR-DESC               PIC  X(11).          04730006
047400             15  ASC-TRLR-ID                 PIC  X(12).          04740006
047500             15  ASC-STR-NBR-X               PIC  X(04).          04750006
047600             15  ASC-STR-NBR-N  REDEFINES  ASC-STR-NBR-X.         04760054
047700                 20  ASC-STR-NBR             PIC  9(04).          04770006
047800             15  ASC-OUTBOUND-TRIP-ID        PIC  9(09).          04780006
047900             15  ASC-DOOR-TYP-CDE            PIC  X(02).          04790000
048000             15  ASC-TRLR-SEAL               PIC  X(20).          04800000
048100             15  ASC-STATUS-DATE             PIC  X(10).          04810000
048200             15  ASC-STATUS-TIME             PIC  X(05).          04820000
048300             15  ASC-CREATE-ID               PIC  X(03).          04830000
048400             15  ASC-STATUS                  PIC  X(07).          04840000
048500             15  ASC-CRTN-STAT-DESC          PIC  X(19).          04850000
048600             15  ASC-CARTON-STATUS           PIC  X(02).          04860000
048700             15  ASC-TRIP-STATUS             PIC  X(02).          04870000
048800             15  ASC-TRLR-STATUS             PIC  X(10).          04880000
048900             15  ASC-CART-SRC                PIC  X(03).          04890099
048910             15  FILLER                      PIC  X(022).         04891099
049000*-----------------------------------------------------------------04900000
049100             15  ASC-BLK-SUB                  PIC S9(04) COMP     04910000
049200                                                         SYNC.    04920000
049300             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04930000
049400                                                         SYNC.    04940000
049500             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04950000
049600             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04960000
049700             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04970000
049800             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04980000
049900             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04990000
050000             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05000000
050100                                                         SYNC.    05010000
050200             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05020000
050300             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05030000
050400             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05040000
050500                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05050000
050600                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05060000
050700             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05070000
050800                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05080000
050900                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05090000
051000             15  ASC-LIST-QUEUE-NAME.                             05100000
051100                 20  ASC-LIST-TERM-ID         PIC  X(04).         05110000
051200                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05120000
051300                 20  ASC-LIST-SEQ             PIC  9(01).         05130000
051400                                                                  05140000
051500             15  ASC-START-ITEM-REQUEST.                          05150000
051600                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05160000
051700                                                                  05170000
051800             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05180000
051900             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05190000
052000             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05200000
052100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05210000
052200             15  ASC-SEL-QUEUE-NAME-IN.                           05220000
052300                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         05230000
052400                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  05240000
052500                 20  ASC-SEL-SEQ-IN           PIC  9(01).         05250000
052600             15  ASC-SEL-QUEUE-NAME-OUT.                          05260000
052700                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         05270000
052800                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  05280000
052900                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         05290000
053000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05300000
053100                                                                  05310000
053200*-----------------------------------------------------------------05320000
053300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05330000
053400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05340000
053500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05350000
053600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05360000
053700                                                                  05370000
053800                 20  ASC-ITEM-ARRAY.                              05380000
053900                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        05390000
054000                         30  ASC-LIST-ITEM-NUMBER                 05400000
054100                                                     PIC S9(09)   05410000
054200                                                     COMP-3.      05420000
054300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05430000
054400                             88  ASC-VALID-SELECT    VALUE ' '    05440000
054500                                                           'S'    05450000
054600                                                           'B'    05460000
054700                                                           'E'.   05470000
054800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05480000
054900                             88  ASC-TEMP-SELECT     VALUE 'S'.   05490000
055000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05500000
055100                             88  ASC-TEMP-END        VALUE 'E'.   05510000
055200                         30  ASC-SELECTED-SW         PIC  X(01).  05520000
055300                             88  ASC-NO-SELECT       VALUE ' '.   05530000
055400                             88  ASC-SELECT          VALUE 'S'.   05540000
055500                             88  ASC-BEGIN           VALUE 'B'.   05550000
055600                             88  ASC-END             VALUE 'E'.   05560000
055700                         30  ASC-ACTION              PIC  X(03).  05570000
055800                         30  ASC-CODE                PIC  X(01).  05580038
055900                         30  ASC-SRC-CDE             PIC  X(03).  05590038
056000                         30  ASC-CRE-FLOW-TMST       PIC  X(26).  05600038
056100                         30  ASC-LOC-NBR          PIC S9(04) COMP.05610038
056200                         30  ASC-PROCESS-SCAN-CDE    PIC  X(17).  05620063
056300                         30  ASC-CRE-USR-ID          PIC  X(08).  05630038
056400                         30  ASC-ACTIVE-CODE         PIC  X(01).  05640038
056500                         30  ASC-OTBND-TRIP-ID    PIC S9(09) COMP.05650038
056600                         30  ASC-INBND-TRIP-ID    PIC S9(09) COMP.05660038
056700                         30  ASC-CRE-PGM-NAME        PIC  X(08).  05670038
056800                         30  ASC-DOOR-NBR            PIC  X(04).  05680038
056900                         30  ASC-DEST             PIC S9(04) COMP.05690038
057000                         30  ASC-MASTER-TYPE         PIC  X(04).  05700065
057100                         30  ASC-CHILD-DESC          PIC  X(30).  05710038
057200                         30  ASC-CHILD-TYPE          PIC  X(03).  05720038
057300                                                                  05730000
057400*---------------------------------------------------------------* 05740000
057500*    ABEND PROCESSING COPYBOOK.                                 * 05750000
057600*---------------------------------------------------------------* 05760000
057700     COPY DPWS013.                                                05770000
057800                                                                  05780000
057900******************************************************************05790050
058000*    DB2 TABLES                                                   05800050
058100******************************************************************05810050
058200                                                                  05820039
058300** SUT_OTBND_CART                                                 05830039
058400     EXEC SQL                                                     05840039
058500          INCLUDE SUT00024                                        05850039
058600     END-EXEC.                                                    05860039
058700                                                                  05870038
058800** SUT_OTBND_VND                                                  05880040
058900     EXEC SQL                                                     05890040
059000          INCLUDE SUT00026                                        05900040
059100     END-EXEC.                                                    05910040
059200                                                                  05920040
059300** SUT_OTBND_LOC                                                  05930038
059400     EXEC SQL                                                     05940038
059500          INCLUDE SUT00027                                        05950038
059600     END-EXEC.                                                    05960038
059700                                                                  05970038
059800** SUT_OTBND_UPC                                                  05980039
059900     EXEC SQL                                                     05990039
060000          INCLUDE SUT00028                                        06000039
060100     END-EXEC.                                                    06010039
060200                                                                  06020039
060300** SUT_MSTR_SHIPT_TYP                                             06030039
060400     EXEC SQL                                                     06040039
060500          INCLUDE SUT00097                                        06050039
060600     END-EXEC.                                                    06060039
060700                                                                  06070038
060800** SUT_MSTR_SHIPT_UNT                                             06080038
060900     EXEC SQL                                                     06090038
061000          INCLUDE SUT00098                                        06100038
061100     END-EXEC.                                                    06110038
061200                                                                  06120038
061300** SUT_MSTR_SHIPT_CNT                                             06130038
061400     EXEC SQL                                                     06140038
061500          INCLUDE SUT00099                                        06150038
061600     END-EXEC.                                                    06160038
061700                                                                  06170038
061800** SUT_ACTN_TYP                                                   06180038
061900     EXEC SQL                                                     06190038
062000          INCLUDE SUT00100                                        06200038
062100     END-EXEC.                                                    06210038
062200                                                                  06220039
062300** SUT_OTBND_SCN_TYP                                              06230039
062400     EXEC SQL                                                     06240039
062500          INCLUDE SUT00120                                        06250039
062600     END-EXEC.                                                    06260039
062700                                                                  06270038
062800** SUT_OTBND_STR_SCN                                              06280038
062900     EXEC SQL                                                     06290038
063000          INCLUDE SUT00121                                        06300038
063100     END-EXEC.                                                    06310038
063200                                                                  06320039
063300** TSUOBSC                                                        06330039
063400     EXEC SQL                                                     06340039
063500          INCLUDE TSUOBSC                                         06350039
063600     END-EXEC.                                                    06360039
063700                                                                  06370039
063800** TPKSLIP                                                        06380039
063900     EXEC SQL                                                     06390039
064000          INCLUDE TPKSLIP                                         06400039
064100     END-EXEC.                                                    06410039
064200                                                                  06420039
064300** TSUCRDV                                                        06430039
064400     EXEC SQL                                                     06440039
064500          INCLUDE TSUCRDV                                         06450039
064600     END-EXEC.                                                    06460039
064700                                                                  06470038
064800** TCNTRID                                                        06480038
064900     EXEC SQL                                                     06490038
065000          INCLUDE TCNTRID                                         06500038
065100     END-EXEC.                                                    06510038
065200                                                                  06520039
065300** TCNDRTY                                                        06530039
065400     EXEC SQL                                                     06540039
065500          INCLUDE TCNDRTY                                         06550039
065600     END-EXEC.                                                    06560039
065700                                                                  06570038
065710** TSHUNLO                                                        06571099
065720     EXEC SQL                                                     06572099
065730          INCLUDE TSHUNLO                                         06573099
065740     END-EXEC.                                                    06574099
065750                                                                  06575099
065760** SUT00102 - SUT_CART_DIRV_TRKG                                  06576099
065770     EXEC SQL                                                     06577099
065780          INCLUDE SUT00102                                        06578099
065790     END-EXEC.                                                    06579099
065791                                                                  06579199
065800******************************************************************06580038
065900     EXEC SQL                                                     06590038
066000         DECLARE SML-DETAIL-CSR CURSOR FOR                        06600038
066100          SELECT 'A'                                              06610038
066200             , A.SHIPT_UNT_ID     AS SML                          06620038
066300             , C.CART_SRC_CDE     AS SOURCE                       06630038
066400             , A.CRE_TMST         AS FLOW_TMST                    06640038
066500             , A.LOC_NBR          AS LOCATION_NBR                 06650038
066600             , CASE                                               06660074
066700                  WHEN A.SCN_CDE = 'ERDM'                         06670074
066800                                   THEN 'SE RELIEVED - EFC'       06680099
066900                  WHEN A.SCN_CDE = 'NUSE'                         06690074
067000                                   THEN 'NO USE-INACTIVATE'       06700075
067100                  WHEN A.SCN_CDE = 'RECV'                         06710074
067200                                   THEN 'CARTON CHECKED IN'       06720074
067300                  WHEN A.SCN_CDE = 'SHOF'                         06730074
067400                                   THEN 'SCAN OFF OUTBND  '       06740074
067500                  WHEN A.SCN_CDE = 'SHON'                         06750074
067600                                   THEN 'SCAN ON OUTBND   '       06760074
067700                  WHEN A.SCN_CDE = 'USED'                         06770074
067800                                   THEN 'USED             '       06780074
067900                  WHEN A.CRE_USR_ID = 'PCKUT074'                  06790099
068000                                   THEN 'OPEN IN P2L/JWL  '       06800099
068100                  WHEN A.CRE_USR_ID = 'PCKCS723'                  06810099
068200                                   THEN 'CLOSED IN P2L/JWL'       06820099
068300                  WHEN A.SCN_CDE = 'LTP'                          06830099
068400                                   THEN 'FROM P2L/JWL     '       06840099
068500                 ELSE 'OTHER'                                     06850074
068600               END                AS PROCESS                      06860074
068700             , A.CRE_USR_ID       AS USER_ID                      06870038
068800             , A.ACTV_CDE         AS ACTIVE_CDE                   06880038
068900             , A.OTBND_TRIP_ID    AS OTBND_TRIP                   06890038
069000             , A.INBD_TRIP_ID     AS INBND_TRIP                   06900038
069100             , C.CRE_PGM_NM       AS CRE_PGM                      06910038
069200             , ' '                AS DOOR                         06920038
069300             , C.DEST_LOC_NBR     AS DEST                         06930099
069400             , ' '                AS MASTER_TYPE                  06940038
069500             , ' '                AS CHILD_DESC                   06950038
069600             , ' '                AS CHILD_TYPE                   06960038
069700         FROM SUT_OTBND_LOC  A                                    06970038
069800            , SUT_OTBND_CART C                                    06980038
069900        WHERE A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                  06990055
070000          AND A.SHIPT_UNT_ID  =  C.SHIPT_UNT_ID                   07000038
070100    UNION                                                         07010038
070200**                                                                07020038
070300**  'B' FROM CONVEYOR DIVERT RECORD                               07030038
070400**                                                                07040038
070500          SELECT 'B'                                              07050038
070600             , B.SHIPT_UNT_ID     AS SML                          07060038
070710             , ' '                AS SOURCE                       07071099
070800             , B.DIVERT_TMST      AS FLOW_TMST                    07080038
070900             , B.OPER_UNT_ID      AS LOCATION_NBR                 07090038
071000             , 'CONVEYOR DIVERT'  AS PROCESS                      07100077
071100             , B.NACTV_USR_ID     AS USER_ID                      07110038
071200             , B.ACTV_CDE         AS ACTIVE_CDE                   07120038
071300             , 0                  AS OTBND_TRIP                   07130038
071400             , 0                  AS INBND_TRIP                   07140038
071500             , ' '                AS CRE_PGM                      07150038
071600             , B.DOOR_ID          AS DOOR                         07160038
071700             , B.DEST_OPER_UNT_ID AS DEST                         07170038
071800             , ' '                AS MASTER_TYPE                  07180038
071900             , ' '                AS CHILD_DESC                   07190038
072000             , ' '                AS CHILD_TYPE                   07200038
072100         FROM TSUCRDV        B                                    07210038
072300        WHERE B.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                  07230055
072500**                                                                07250038
072600**  'M' FOR MASTER CONTAINER                                      07260038
072700**                                                                07270038
072800    UNION                                                         07280038
072900          SELECT 'M'                                              07290038
073000             , E.MSTR_SHIPT_UNT_ID  AS SML                        07300038
073100             , F.CART_SRC_CDE       AS SOURCE                     07310038
073200             , E.CRE_TMST           AS FLOW_TMST                  07320038
073300             , 0                    AS LOCATION_NBR               07330038
073400             , E.MSTR_SHIPT_TYP_CDE AS PROCESS                    07340038
073500             , E.CRE_BY_USR_ID      AS USER_ID                    07350038
073600             , ' '                  AS ACTIVE_CDE                 07360038
073700             , 0                    AS OTBND_TRIP                 07370038
073800             , 0                    AS INBND_TRIP                 07380038
073900             , ' '                  AS CRE_PGM                    07390038
074000             , ' '                  AS DOOR                       07400038
074100             , 0                    AS DEST                       07410038
074200             , G.MSTR_SHIPT_TYP_DES AS MASTER_TYPE                07420038
074300             , ' '                  AS CHILD_DESC                 07430038
074400             , ' '                  AS CHILD_TYPE                 07440038
074500         FROM SUT_MSTR_SHIPT_UNT E                                07450038
074600            , SUT_OTBND_CART     F                                07460038
074700            , SUT_MSTR_SHIPT_TYP G                                07470038
074800        WHERE E.MSTR_SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID             07480055
074900          AND E.MSTR_SHIPT_UNT_ID  =  F.SHIPT_UNT_ID              07490038
075000          AND E.MSTR_SHIPT_TYP_CDE =  G.MSTR_SHIPT_TYP_CDE        07500038
075100**                                                                07510038
075200**  'C'  FOR CHILD CARTON                                         07520038
075300**                                                                07530038
075400    UNION                                                         07540038
075500          SELECT 'C'                                              07550038
075600             , H.CHLD_SHIPT_UNT_ID    AS SML                      07560038
075700             , I.CART_SRC_CDE         AS SOURCE                   07570038
075800             , H.CRE_TMST             AS FLOW_TMST                07580038
075900             , 0                      AS LOCATION_NBR             07590038
076000             , H.ACTN_TYP_CDE         AS PROCESS                  07600038
076100             , H.CRE_BY_USR_ID        AS USER_ID                  07610038
076200             , ' '                    AS ACTIVE_CDE               07620038
076300             , 0                      AS OTBND_TRIP               07630038
076400             , 0                      AS INBND_TRIP               07640038
076500             , ' '                    AS CRE_PGM                  07650038
076600             , ' '                    AS DOOR                     07660038
076700             , 0                      AS DEST                     07670038
076800             , ' '                    AS MASTER_TYPE              07680038
076900             , J.ACTN_TYP_DES         AS CHILD_DESC               07690038
077000             , H.CHLD_SHIPT_TYP_CDE   AS CHILD_TYPE               07700038
077100         FROM SUT_MSTR_SHIPT_CNT H                                07710038
077200            , SUT_OTBND_CART     I                                07720038
077300            , SUT_ACTN_TYP       J                                07730038
077400        WHERE H.CHLD_SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID             07740055
077500          AND H.CHLD_SHIPT_UNT_ID  =  I.SHIPT_UNT_ID              07750038
077600          AND H.ACTN_TYP_CDE       =  J.ACTN_TYP_CDE              07760038
077700**                                                                07770038
077800**  'P' PHYSICAL LABELS - CPS (CASEPACK SPLIT) SMO (SMOOTHING)    07780038
077900**                                                                07790038
078000    UNION                                                         07800038
078100          SELECT 'P'                                              07810038
078200             , K.SHIPT_UNT_ID     AS SML                          07820038
078300             , K.CART_SRC_CDE     AS SOURCE                       07830038
078400             , CHAR(K.CRE_DTE)||'-'||CHAR(K.CRE_TM)||'.000000'    07840050
078500                                  AS FLOW_TMST                    07850050
078600             , K.ORGN_LOC_NBR     AS LOCATION_NBR                 07860038
078700             , CASE                                               07870038
078800                  WHEN K.CART_SRC_CDE = 'CPS'                     07880073
078900                                        THEN 'CASEPACK SPLIT   '  07890080
079000                  WHEN K.CART_SRC_CDE = 'FXR'                     07900073
079100                                        THEN 'FAST TRANSFER    '  07910080
079200                  WHEN K.CART_SRC_CDE = 'DMG'                     07920073
079300                                        THEN 'DAMAGED CARTON   '  07930080
079400                  WHEN K.CART_SRC_CDE = 'MST'                     07940073
079500                                        THEN 'MASTER CONTAINER '  07950080
079600                  WHEN K.CART_SRC_CDE = 'RDM'                     07960073
079700                                        THEN 'CENTRAL STOCK PUL'  07970080
079800                  WHEN K.CART_SRC_CDE = 'SMO'                     07980073
079900                                        THEN 'SMOOTHING        '  07990080
080000                  WHEN K.CART_SRC_CDE = 'WMC'                     08000073
080100                                        THEN 'EFC MANUAL CREATE'  08010080
080200                  WHEN K.CART_SRC_CDE = 'WMU'                     08020073
080300                                        THEN 'EFC USED UCC128  '  08030080
080310                  WHEN K.CART_SRC_CDE = '3WD'                     08031099
080320                                        THEN '3RD PRTY WHSE DST'  08032099
080400                 ELSE  'OTHER'                                    08040080
080500               END                AS PROCESS                      08050038
080600             , K.CRE_USR_ID       AS USER_ID                      08060038
080700             , K.ACTV_IND         AS ACTIVE_CDE                   08070038
080800             , K.OTBND_TRIP_ID    AS OTBND_TRIP                   08080038
080900             , 0                  AS INBND_TRIP                   08090038
081000             , K.CRE_PGM_NM       AS CRE_PGM                      08100038
081100             , ' '                AS DOOR                         08110038
081200             , 0                  AS DEST                         08120038
081300             , ' '                AS MASTER_TYPE                  08130038
081400             , ' '                AS CHILD_DESC                   08140038
081500             , ' '                AS CHILD_TYPE                   08150038
081600         FROM SUT_OTBND_CART K                                    08160038
081700        WHERE K.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                   08170055
081800          AND CART_SRC_CDE IN ('CPS','DMG','FXR','MST'            08180038
081900                              ,'RDM','SMO','WMC','WMU','3WD')     08190099
082000    UNION                                                         08200038
082100**                                                                08210038
082200**  'D' FROM STORE RECEIVED - OUTBOUND SCAN TYPE & OU             08220038
082300**                                                                08230038
082400          SELECT 'D'                                              08240038
082500             , L.SHIPT_UNT_ID       AS SML                        08250038
082600             , M.SCN_TYP_CDE        AS SOURCE                     08260038
082700             , L.CRE_TMST           AS FLOW_TMST                  08270038
082800             , L.SCN_LOC_NBR        AS LOCATION_NBR               08280038
082900             , M.SCN_TYP_CDE        AS PROCESS                    08290038
083000             , L.CRE_BY_USR_ID      AS USER_ID                    08300038
083100             , L.ACTV_IND           AS ACTIVE_CDE                 08310038
083200             , L.SCN_OTBND_TRIP_ID  AS OTBND_TRIP                 08320038
083300             , L.ORIG_OTBND_TRIP_ID AS INBND_TRIP                 08330038
083400             , 'STR SCAN'           AS CRE_PGM                    08340038
083500             , ' '                  AS DOOR                       08350038
083600             , 0                    AS DEST                       08360038
083700             , ' '                  AS MASTER_TYPE                08370038
083800             , ' '                  AS CHILD_DESC                 08380038
083900             , ' '                  AS CHILD_TYPE                 08390038
084000         FROM SUT_OTBND_STR_SCN L                                 08400038
084100            , SUT_OTBND_SCN_TYP M                                 08410038
084200        WHERE L.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                   08420055
084300          AND L.SCN_TYP_CDE  =  M.SCN_TYP_CDE                     08430038
084400                                                                  08440038
084410    UNION                                                         08441099
084420**                                                                08442099
084430**  'E' FROM TSHUNLO - INBOUND LOCATION DATABASE                  08443099
084440**                                                                08444099
084450          SELECT 'E'                                              08445099
084460             , N.SHIPT_UNT_ID       AS SML                        08446099
084470             , ' '                  AS SOURCE                     08447099
084480             , N.CRE_TMST           AS FLOW_TMST                  08448099
084490             , N.OPER_UNT_ID        AS LOCATION_NBR               08449099
084491             , CASE                                               08449199
084492                   WHEN N.SCN_LOC_ID  = 'RFDC'                    08449299
084493                                 THEN 'RFID/EAS TAG LBL'          08449399
084494                   WHEN N.SCN_LOC_ID  = 'RFDF'                    08449499
084495                                 THEN 'RFID/EAS TAG COMP'         08449599
084496                   ELSE 'OTHER'                                   08449699
084497               END                  AS PROCESS                    08449799
084499             , N.CRE_USR_ID         AS USER_ID                    08449999
084500             , N.ACTV_CDE           AS ACTIVE_CDE                 08450099
084501             , 0                    AS OTBND_TRIP                 08450199
084502             , 0                    AS INBND_TRIP                 08450299
084503             , ' '                  AS CRE_PGM                    08450399
084504             , ' '                  AS DOOR                       08450499
084505             , 0                    AS DEST                       08450599
084506             , ' '                  AS MASTER_TYPE                08450699
084507             , ' '                  AS CHILD_DESC                 08450799
084508             , ' '                  AS CHILD_TYPE                 08450899
084509         FROM TSHUNLO N                                           08450999
084510            , SUT_OTBND_CART O                                    08451099
084511        WHERE O.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                   08451199
084512          AND O.ORIG_CART_ID =  N.SHIPT_UNT_ID                    08451299
084513          AND N.SCN_LOC_ID IN ('RFDC','RFDF')                     08451399
084514                                                                  08451499
084515    UNION                                                         08451599
084516**                                                                08451699
084517**  'F' FROM SUT_CART_DIRV_TRKG - DIRECTIVE TRACKING              08451799
084518**                                                                08451899
084519          SELECT 'F'                                              08451999
084520             , P.SHIPT_UNT_ID       AS SML                        08452099
084521             , ' '                  AS SOURCE                     08452199
084522             , P.CRE_TMST           AS FLOW_TMST                  08452299
084523             , P.OPER_UNT_ID        AS LOCATION_NBR               08452399
084524             , CASE                                               08452499
084525                   WHEN P.DIRV_RSN_CDE  = 'AU%'                   08452599
084526                              THEN 'DIRV-AUD 100%    '            08452699
084527                   WHEN P.DIRV_RSN_CDE  = 'AUN'                   08452799
084528                              THEN 'DIRV-NOT NEEDED  '            08452899
084529                   WHEN P.DIRV_RSN_CDE  = 'AUP'                   08452999
084530                              THEN 'DIRV-AUD PASSED  '            08453099
084531                   WHEN P.DIRV_RSN_CDE  = 'AUQ'                   08453199
084532                              THEN 'DIRV-AUD QA CRTN '            08453299
084533                   WHEN P.DIRV_RSN_CDE  = 'AUR'                   08453399
084534                              THEN 'DIRV-AUD REWORK  '            08453499
084535                   WHEN P.DIRV_RSN_CDE  = 'AUU'                   08453599
084536                              THEN 'DIRV-AUD UNKNOWN '            08453699
084537                   WHEN P.DIRV_RSN_CDE  = 'BRC'                   08453799
084538                              THEN 'DIRV-ROUTE BRCDE '            08453899
084539                   WHEN P.DIRV_RSN_CDE  = 'RCL'                   08453999
084540                              THEN 'DIRV-CRTN RECLAIM'            08454099
084541                   WHEN P.DIRV_RSN_CDE  = 'RFD'                   08454199
084542                              THEN 'DIRV-TAGGING NEED'            08454299
084543                   WHEN P.DIRV_RSN_CDE  = 'RLC'                   08454399
084544                              THEN 'DIRV-RLSE BY AUD '            08454499
084545                   WHEN P.DIRV_RSN_CDE  = 'RLF'                   08454599
084546                              THEN 'DIRV-RLSE BY RF  '            08454699
084547                   WHEN P.DIRV_RSN_CDE  = 'RLO'                   08454799
084548                              THEN 'DIRV-RLSE ONLINE '            08454899
084549                   WHEN P.DIRV_RSN_CDE  = 'RLR'                   08454999
084550                              THEN 'DIRV-RLSE BY RF  '            08455099
084557                   ELSE 'OTHER'                                   08455799
084558               END                  AS PROCESS                    08455899
084559             , P.CRE_BY_USR_ID      AS USER_ID                    08455999
084560             , ' '                  AS ACTIVE_CDE                 08456099
084561             , 0                    AS OTBND_TRIP                 08456199
084562             , 0                    AS INBND_TRIP                 08456299
084563             , ' '                  AS CRE_PGM                    08456399
084564             , ' '                  AS DOOR                       08456499
084565             , 0                    AS DEST                       08456599
084566             , ' '                  AS MASTER_TYPE                08456699
084567             , ' '                  AS CHILD_DESC                 08456799
084568             , ' '                  AS CHILD_TYPE                 08456899
084569         FROM SUT_CART_DIRV_TRKG P                                08456999
084571        WHERE P.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                   08457199
084572          AND NOT (P.CNVYR_PRC_ACTN_NM = 'DELETE'  AND            08457299
084573                   P.DIRV_RSN_CDE  IN ('RLO','AUR','RCL','AUQ'))  08457399
084574                                                                  08457499
084580         ORDER BY 4                                               08458038
084600     END-EXEC.                                                    08460038
084700                                                                  08470038
084800******************************************************************08480038
084900*    DB2 AREA FOR COMMUNICATIONS                                  08490038
085000******************************************************************08500038
085100     EXEC SQL                                                     08510000
085200          INCLUDE SQLCA                                           08520000
085300     END-EXEC.                                                    08530000
085400                                                                  08540000
085500******************************************************************08550038
085600 LINKAGE SECTION.                                                 08560000
085700                                                                  08570000
085800 01  DFHCOMMAREA.                                                 08580000
085900     05  FILLER                         OCCURS  1 TO 4072 TIMES   08590000
086000                                        DEPENDING ON EIBCALEN.    08600000
086100         10  FILLER                     PIC X.                    08610000
086200                                                                  08620000
086300                                                                  08630000
086400 PROCEDURE DIVISION.                                              08640000
086500******************************************************************08650000
086600**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **08660000
086700**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **08670000
086800**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **08680000
086900******************************************************************08690000
087000 0000-MAIN-MODULE.                                                08700000
087100                                                                  08710038
087200     INITIALIZE DP030-CICS-API-FIELDS.                            08720000
087300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08730000
087400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08740000
087500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08750000
087600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08760000
087700     MOVE LENGTH OF SU542AI        TO DP030-MAP-LENGTH (1).       08770038
087800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08780000
087900     PERFORM 0001-CALL-CICS-ARCH-API.                             08790000
088000                                                                  08800038
088100     PERFORM 1000-CONTROL-PROCESSING                              08810000
088200                                                                  08820038
088300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08830000
088400     PERFORM 0001-CALL-CICS-ARCH-API.                             08840000
088500                                                                  08850000
088600******************************************************************08860000
088700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08870000
088800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08880000
088900******************************************************************08890000
089000 0001-CALL-CICS-ARCH-API.                                         08900000
089100                                                                  08910038
089200*    CALL 'DPKCS030' USING DFHEIBLK                               08920099
089200     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08921099
089300                           DFHCOMMAREA                            08930000
089400                           DP030-CICS-API-FIELDS                  08940000
089500                           DP020-STANDARD-COMMAREA                08950000
089600                           SU542AI.                               08960038
089700                                                                  08970038
089800     IF  DP030-RC-CALL-SUCCESSFUL                                 08980000
089900         CONTINUE                                                 08990000
090000                                                                  09000038
090100     ELSE                                                         09010000
090200         SET DP013-NO-ROLLBACK                                    09020000
090300             DP013-XCTL-DISPLAY-RESTART                           09030000
090400             DP013-CICS-ABEND      TO TRUE                        09040000
090500         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        09050000
090600*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX09060099
090700*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      09070099
090600         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O09071099
090700-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09072099
090800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09080000
090900         PERFORM DP013-0000-PROCESS-ABEND                         09090000
091000     END-IF.                                                      09100000
091100                                                                  09110000
091200******************************************************************09120038
091300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09130000
091400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09140000
091500*                                                                *09150000
091600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09160000
091700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09170000
091800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09180000
091900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09190000
092000******************************************************************09200038
092100 1000-CONTROL-PROCESSING.                                         09210000
092200                                                                  09220000
092300     EVALUATE TRUE                                                09230000
092400         WHEN DP020-NEXT-ACT-INITIAL                              09240000
092500             INITIALIZE ASC-SPECIFIC-COMMAREA                     09250000
092600             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09260000
092700                                      ASC-SEL-TERM-ID-OUT         09270000
092800             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   09280000
092900                                        ASC-SEL-TASK-NUMBER-OUT   09290000
093000             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              09300000
093100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             09310000
093200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09320000
093300             PERFORM 4000-BUILD-INITIAL-PANEL                     09330000
093400                                                                  09340000
093500         WHEN DP020-NEXT-ACT-READ-MAP                             09350000
093600             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         09360000
093700             PERFORM 2000-PROCESS-PANEL                           09370000
093800                                                                  09380000
093900         WHEN DP020-NEXT-ACT-RETURN                               09390000
094000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         09400000
094100             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               09410000
094200             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 09420000
094300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09430000
094400                                                                  09440000
094500         WHEN OTHER                                               09450000
094600             SET DP013-LOGIC-ABEND TO TRUE                        09460000
094700             SET DP013-NO-ROLLBACK TO TRUE                        09470000
094800             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    09480000
094900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09490000
095000                                   TO DP013-MESSAGE-TEXT(1)       09500000
095100             PERFORM DP013-0000-PROCESS-ABEND                     09510000
095200     END-EVALUATE.                                                09520000
095300                                                                  09530000
095400******************************************************************09540038
095500* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *09550000
095600* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *09560000
095700******************************************************************09570038
095800 1100-PROCESS-INTER-APPL-COMM.                                    09580000
095900                                                                  09590000
096000     SET PS-COMMAREA-VALID         TO TRUE.                       09600000
096100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09610000
096200                                                                  09620000
096300     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          09630050
096400         MOVE SU008-SML-NBR        TO ASC-SML-SHPD-UNT-ID         09640080
096500         MOVE SU008-OPER-UNT-ID    TO ASC-OPER-UNT-ID-N           09650080
096600     ELSE                                                         09660000
096700         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    09670050
096800         MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                   09680000
096900                                      ASC-NUMBER-OF-SELECTED-ITEMS09690000
097000         MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  09700000
097100         MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   09710000
097200         MOVE SU009-OPER-UNT-ID        TO ASC-OPER-UNT-ID-N       09720000
097300         PERFORM 1120-PREPARE-LIST-ENTRY                          09730000
097400     END-IF.                                                      09740000
097500                                                                  09750000
097600******************************************************************09760038
097700 1101-GET-CARTON-INFO.                                            09770000
097800                                                                  09780038
097900     INITIALIZE PC046-COMMAREA-REC.                               09790038
098000     MOVE ASC-SML-SHPD-UNT-ID          TO PC046-CARTON-ID.        09800050
098100                                                                  09810000
098200     CALL PC046-CARTON-STATUS-MODULE                              09820000
098300          USING DFHEIBLK                                          09830000
098400          PC046-COMMAREA                                          09840000
098500          PC046-COMMAREA-REC                                      09850000
098600     END-CALL.                                                    09860050
098700                                                                  09870000
098800     PERFORM 1101A-VALIDATE-STATUS-CALL.                          09880000
098900                                                                  09890000
099000******************************************************************09900038
099100* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*09910000
099200******************************************************************09920038
099300 1101A-VALIDATE-STATUS-CALL.                                      09930000
099400                                                                  09940000
099500     INITIALIZE ASC-STR-NBR                                       09950045
099600                ASC-CARTON-STATUS                                 09960067
099700                ASC-CRTN-STAT-DESC                                09970067
099800                ASC-TRLR-SRL-NMBR                                 09980067
099900                ASC-OUTBOUND-TRIP-ID                              09990067
100000                ASC-DOOR-ID                                       10000045
100100                ASC-DOOR-TYP-CDE                                  10010067
100200                ASC-SCAC-CODE                                     10020045
100300                ASC-TRIP-STATUS                                   10030045
100400                ASC-CREATE-ID.                                    10040067
100500                                                                  10050000
100600     IF PC046-SUCCESSFUL                                          10060038
100700         MOVE PC046-DEST-OPER-UNT-ID   TO ASC-STR-NBR             10070047
100800         MOVE PC046-CRTN-STATUS        TO ASC-CARTON-STATUS       10080047
100900         MOVE PC046-CRTN-STAT-DESC     TO ASC-CRTN-STAT-DESC      10090047
101000         MOVE PC046-TRLR-SRL           TO ASC-TRLR-SRL-NMBR       10100047
101100         MOVE PC046-OTBD-TRIP-ID       TO ASC-OUTBOUND-TRIP-ID    10110047
101200         MOVE PC046-DOOR-ID            TO ASC-DOOR-ID             10120047
101300         MOVE PC046-DOOR-TYP-CDE       TO ASC-DOOR-TYP-CDE        10130047
101400         MOVE PC046-SCAC               TO ASC-SCAC-CODE           10140047
101500         MOVE PC046-TRIP-STATUS        TO ASC-TRIP-STATUS         10150047
101600         MOVE PC046-SHPUNT-SRC-ID      TO ASC-CREATE-ID           10160047
101700     ELSE                                                         10170000
101800         SET PS-ERROR                  TO TRUE                    10180067
101900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       10190000
102000     END-IF.                                                      10200000
102100                                                                  10210000
102200******************************************************************10220038
102300*  PREPARE LIST ENTRY                                             10230000
102400******************************************************************10240038
102500 1120-PREPARE-LIST-ENTRY.                                         10250000
102600                                                                  10260000
102700     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                10270000
102800     MOVE ZERO                     TO ASC-SEL-ITEM.               10280000
102900     PERFORM 1130-GET-NEXT-RECORD.                                10290000
103000                                                                  10300000
103100******************************************************************10310038
103200*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*10320000
103300******************************************************************10330038
103400 1130-GET-NEXT-RECORD.                                            10340000
103500                                                                  10350038
103600     ADD +1                        TO ASC-SEL-SUB.                10360047
103700                                                                  10370000
103800     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            10380000
103900         ADD +1                    TO ASC-SEL-ITEM                10390047
104000         MOVE +1                   TO ASC-SEL-SUB                 10400047
104100     END-IF.                                                      10410000
104200                                                                  10420000
104300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10430000
104400         PERFORM 9100-READ-SEL-QUEUE                              10440000
104500         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      10450000
104600             MOVE SU010-SML (ASC-SEL-SUB)       TO                10460038
104700                                               ASC-SML-SHPD-UNT-ID10470038
104800             MOVE SU010-CREATE (ASC-SEL-SUB)    TO ASC-CREATE-ID  10480000
104900             MOVE SU010-DEST-NBR  (ASC-SEL-SUB) TO ASC-STR-NBR    10490000
105000             MOVE SU010-LOAD-STATUS (ASC-SEL-SUB) TO ASC-STATUS   10500000
105100             MOVE SU010-STAT-DATE (ASC-SEL-SUB) TO ASC-STATUS-DATE10510000
105200             MOVE SU010-STAT-TIME (ASC-SEL-SUB) TO ASC-STATUS-TIME10520000
105300             IF  ASC-TRLR-SRL-NMBR = ZERO                         10530000
105400                 MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)            10540000
105500                                              TO ASC-TRLR-SRL-NMBR10550000
105600             END-IF                                               10560000
105700             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  10570000
105800             PERFORM 9200-REWRITE-SEL-QUEUE                       10580000
105900         ELSE                                                     10590000
106000             SUBTRACT +1 FROM ASC-SEL-SUB                         10600000
106100             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             10610000
106200             SET DP020-MSG-INFORMATIONAL                          10620000
106300                 PS-LIST-END             TO TRUE                  10630000
106400         END-IF                                                   10640000
106500     ELSE                                                         10650000
106600         SUBTRACT +1 FROM ASC-SEL-ITEM                            10660000
106700         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  10670000
106800         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             10680000
106900         SET DP020-MSG-INFORMATIONAL                              10690000
107000             PS-LIST-END             TO TRUE                      10700000
107100     END-IF.                                                      10710000
107200                                                                  10720000
107300******************************************************************10730038
107400*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *10740000
107500*    PROCESSED.                                                  *10750000
107600******************************************************************10760038
107700 1140-GET-PREV-RECORD.                                            10770000
107800                                                                  10780038
107900     SUBTRACT +1 FROM ASC-SEL-SUB.                                10790000
108000                                                                  10800000
108100     IF  ASC-SEL-SUB < +1                                         10810000
108200         SUBTRACT +1 FROM ASC-SEL-ITEM                            10820000
108300         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  10830000
108400     END-IF.                                                      10840000
108500                                                                  10850000
108600     IF  ASC-SEL-ITEM > ZERO                                      10860000
108700         PERFORM 9100-READ-SEL-QUEUE                              10870000
108800         MOVE SU010-SML (ASC-SEL-SUB)        TO                   10880038
108900                                             ASC-SML-SHPD-UNT-ID  10890047
109000         MOVE SU010-CREATE (ASC-SEL-SUB)     TO ASC-CREATE-ID     10900000
109100         MOVE SU010-DEST-NBR  (ASC-SEL-SUB)  TO ASC-STR-NBR       10910000
109200         MOVE SU010-LOAD-STATUS (ASC-SEL-SUB) TO ASC-STATUS       10920000
109300         MOVE SU010-STAT-DATE (ASC-SEL-SUB)  TO ASC-STATUS-DATE   10930000
109400         MOVE SU010-STAT-TIME (ASC-SEL-SUB)  TO ASC-STATUS-TIME   10940000
109500         SET  SU010-INQ (ASC-SEL-SUB)        TO TRUE              10950038
109600         PERFORM 9200-REWRITE-SEL-QUEUE                           10960000
109700     ELSE                                                         10970000
109800         MOVE +1                  TO ASC-SEL-ITEM                 10980000
109900                                     ASC-SEL-SUB                  10990000
110000         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11000000
110100         SET DP020-MSG-INFORMATIONAL                              11010000
110200             PS-LIST-END             TO TRUE                      11020000
110300     END-IF.                                                      11030000
110400                                                                  11040000
110500******************************************************************11050038
110600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11060000
110700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11070000
110800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11080000
110900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11090000
111000* FUNCTION KEYS CAN GET THIS FAR.                                *11100000
111100******************************************************************11110038
111200 2000-PROCESS-PANEL.                                              11120000
111300                                                                  11130038
111400     EVALUATE TRUE                                                11140000
111500         WHEN DP020-SRC-AID = DP016-CLEAR                         11150000
111600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11160000
111700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11170000
111800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11180000
111900                                                                  11190000
112000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11200000
112100             PERFORM 2050-DELETE-LIST-QUEUE                       11210000
112200             PERFORM 4000-BUILD-INITIAL-PANEL                     11220000
112300                                                                  11230000
112400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11240000
112500             IF  ASC-USE-SELECTION-QUEUE                          11250000
112600                 PERFORM 1130-GET-NEXT-RECORD                     11260000
112700                 IF PS-LIST-END                                   11270000
112800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11280000
112900                     SET PS-NO-LIST-END TO TRUE                   11290000
113000                 ELSE                                             11300000
113100                     PERFORM 2050-DELETE-LIST-QUEUE               11310000
113200                     PERFORM 3200-RESET-ATTRIBUTES                11320000
113300                     PERFORM 4000-BUILD-INITIAL-PANEL             11330000
113400                 END-IF                                           11340000
113500              ELSE                                                11350000
113600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11360000
113700*                --- BOTTOM OF LIST ---                           11370000
113800                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         11380000
113900                 SET DP020-MSG-INFORMATIONAL TO TRUE              11390000
114000             END-IF                                               11400000
114100                                                                  11410000
114200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11420000
114300             IF  ASC-USE-SELECTION-QUEUE                          11430000
114400                 PERFORM 1140-GET-PREV-RECORD                     11440000
114500                 IF PS-LIST-END                                   11450000
114600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11460000
114700                     SET PS-NO-LIST-END TO TRUE                   11470000
114800                 ELSE                                             11480000
114900                     PERFORM 2050-DELETE-LIST-QUEUE               11490000
115000                     PERFORM 3200-RESET-ATTRIBUTES                11500000
115100                     PERFORM 4000-BUILD-INITIAL-PANEL             11510000
115200                 END-IF                                           11520000
115300             ELSE                                                 11530000
115400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11540000
115500                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         11550000
115600                 SET DP020-MSG-INFORMATIONAL TO TRUE              11560000
115700             END-IF                                               11570000
115800                                                                  11580000
115900         WHEN OTHER                                               11590000
116000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11600000
116100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11610000
116200                                                                  11620000
116300             IF  PS-NO-ERROR                                      11630000
116400                 SET DP030-CONTINUE-GO TO TRUE                    11640000
116500                 PERFORM 2100-CHECK-FUNCTION-KEY                  11650000
116600             ELSE                                                 11660000
116700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11670000
116800                 SET DP030-OVERRIDE-GO TO TRUE                    11680000
116900             END-IF                                               11690000
117000     END-EVALUATE.                                                11700000
117100                                                                  11710000
117200******************************************************************11720038
117300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11730000
117400******************************************************************11740038
117500 2050-DELETE-LIST-QUEUE.                                          11750000
117600                                                                  11760000
117700     EXEC CICS                                                    11770000
117800         DELETEQ TS                                               11780000
117900             QUEUE (ASC-LIST-QUEUE-NAME)                          11790000
118000             RESP  (PV-CICS-RESP)                                 11800000
118100     END-EXEC.                                                    11810000
118200                                                                  11820000
118300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11830000
118400        (PV-CICS-RESP = DFHRESP(QIDERR))                          11840000
118500         CONTINUE                                                 11850000
118600                                                                  11860038
118700     ELSE                                                         11870000
118800         SET DP013-CICS-ABEND      TO TRUE                        11880000
118900         SET DP013-NO-ROLLBACK     TO TRUE                        11890000
119000                                                                  11900000
119100         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         11910000
119200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11920000
119300                                   TO DP013-MESSAGE-TEXT (1)      11930000
119400         PERFORM DP013-0000-PROCESS-ABEND                         11940000
119500     END-IF.                                                      11950000
119600                                                                  11960000
119700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11970000
119800                                                                  11980000
119900******************************************************************11990038
120000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12000000
120100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12010000
120200* CICS ARCHITECTURE API.                                         *12020000
120300******************************************************************12030038
120400 2100-CHECK-FUNCTION-KEY.                                         12040000
120500                                                                  12050000
120600     EVALUATE TRUE                                                12060000
120700                                                                  12070038
120800* F6 - FIRST PAGE                                                 12080000
120900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  12090000
121000             MOVE +1               TO PV-TOP-ITEM                 12100000
121100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12110000
121200                                                                  12120038
121300* F7 - PREVIOUS PAGE                                              12130000
121400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12140000
121500             PERFORM 2110-BROWSE-BACKWARD                         12150000
121600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12160000
121700                                                                  12170038
121800* F8 - NEXT PAGE                                                  12180000
121900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12190000
122000             PERFORM 2120-BROWSE-FORWARD                          12200000
122100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12210000
122101                                                                  12210199
122300* ENTER KEY                                                       12230000
122400         WHEN DP020-SRC-AID = DP016-ENTER                         12240000
122500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12250000
122600             IF  PS-ERROR                                         12260000
122700                 CONTINUE                                         12270000
122800             ELSE                                                 12280000
122900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12290000
123000             END-IF                                               12300000
123100                                                                  12310038
123120* F22 - CARTON DETAIL LIST - LOCAL-FUNC-02                        12312099
123130* F18 - SML CRTN PACKED DETAIL - LOCAL-FUNC-01                    12313099
123131* F23 - TRAILER HISTORY - LOCAL-FUNC-03                           12313199
123140         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12314099
123150         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12315099
123151         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12315199
123160                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12316099
123170                 PERFORM 2105-PREPARE-INTER-APPL-COMM             12317099
123190                                                                  12319099
123200         WHEN OTHER                                               12320000
123300             SET DP013-NO-ROLLBACK                                12330000
123400                 DP013-XCTL-DISPLAY-RESTART                       12340000
123500                 DP013-CICS-ABEND  TO TRUE                        12350000
123600             MOVE '2100-CHECK-FUNCTION-KEY'                       12360000
123700                                   TO DP013-PARAGRAPH             12370000
123800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12380000
123900                                   TO DP013-MESSAGE-TEXT (1)      12390000
124000             PERFORM DP013-0000-PROCESS-ABEND                     12400000
124100                                                                  12410038
124200     END-EVALUATE.                                                12420000
124300                                                                  12430038
124310*----------------------------------------------------------------*12431099
124320*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *12432099
124330*  INTER-APPLICATION COMMAREA.                                   *12433099
124331*  DMH - 2017/06/26 ADDED                                        *12433199
124340*----------------------------------------------------------------*12434099
124350 2105-PREPARE-INTER-APPL-COMM.                                    12435099
124375                                                                  12437599
124376     INITIALIZE SU008-INTER-APPL-COMMAREA                         12437699
124380     MOVE ASC-OPER-UNT-ID             TO SU008-OPER-UNT-ID        12438099
124390     MOVE ZEROES                      TO SU008-PO-NBR             12439099
124391     MOVE ZEROES                      TO SU008-RCVR-NBR           12439199
124392                                                                  12439299
124393     MOVE SPACES                      TO SU008-REQUEST-TYPE.      12439399
124394                                                                  12439499
124395     IF ASC-CART-SRC = 'RDM'                                      12439599
124396         MOVE 0                       TO SU008-RCVR-NBR           12439699
124397         SET  SU008-CS-PULL-TRAN      TO TRUE                     12439799
124398     ELSE                                                         12439899
124402         IF ASC-CART-SRC = 'FXR'                                  12440299
124403             MOVE 0                       TO SU008-RCVR-NBR       12440399
124404             SET  SU008-FX-FAST-TRANSFER  TO TRUE                 12440499
124405         END-IF                                                   12440599
124406     END-IF.                                                      12440699
124407                                                                  12440799
124409     MOVE ZEROES                      TO SU008-LINE-NBR.          12440999
124410     MOVE ASC-STR-NBR                 TO SU008-DEST-STR-NBR.      12441099
124411     MOVE ASC-CART-SRC                TO SU008-CREATE-ID.         12441199
124412     MOVE ASC-SML-SHPD-UNT-ID         TO SU008-SML-NBR.           12441299
124416                                                                  12441699
124418     MOVE ASC-TRLR-SRL-NMBR           TO SU008-TRLR-SRL-NBR.      12441899
124419     MOVE ASC-SCAC-CODE               TO SU008-SCAC-CDE.          12441999
124420     MOVE ASC-OUTBOUND-TRIP-ID        TO SU008-TRIP-ID.           12442099
124421     MOVE ASC-TRLR-SEAL               TO SU008-TRLR-SEAL-NBR.     12442199
124422                                                                  12442299
124423                                                                  12442399
124430******************************************************************12443099
124500*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12450000
124600*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12460000
124700*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12470000
124800*    MESSAGE.                                                    *12480000
124900******************************************************************12490038
125000 2110-BROWSE-BACKWARD.                                            12500000
125100                                                                  12510038
125200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12520000
125300         GIVING PV-TOP-ITEM.                                      12530000
125400                                                                  12540038
125500     IF  ((PV-TOP-ITEM < +1)                                      12550000
125600       OR (PV-TOP-ITEM = +1))                                     12560000
125700         MOVE +1                   TO PV-TOP-ITEM                 12570000
125800*        -- TOP OF LIST --                                        12580000
125900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12590000
126000         SET DP020-MSG-INFORMATIONAL TO TRUE                      12600000
126100     END-IF.                                                      12610000
126200                                                                  12620000
126300******************************************************************12630038
126400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12640000
126500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12650000
126600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12660000
126700******************************************************************12670038
126800 2120-BROWSE-FORWARD.                                             12680000
126900                                                                  12690000
127000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12700000
127100         GIVING PV-TOP-ITEM.                                      12710000
127200     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12720000
127300         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12730000
127400*        -- BOTTOM OF LIST --                                     12740000
127500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12750000
127600         SET DP020-MSG-INFORMATIONAL  TO TRUE                     12760000
127700     ELSE                                                         12770000
127800         COMPUTE PV-BOTTOM-ITEM =                                 12780000
127900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12790000
128000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12800000
128100*            -- BOTTOM OF LIST --                                 12810000
128200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12820000
128300             SET DP020-MSG-INFORMATIONAL TO TRUE                  12830000
128400         END-IF                                                   12840000
128500     END-IF.                                                      12850000
128600                                                                  12860000
128700******************************************************************12870038
128800*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12880000
128900*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12890000
129000*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12900000
129100*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12910000
129200*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12920000
129300*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12930000
129400******************************************************************12940038
129500 2130-CHECK-FOR-JUMP-BROWSE.                                      12950000
129600                                                                  12960038
129700     SET PS-NO-ERROR               TO TRUE.                       12970000
129800     IF (ASC-START-ITEM-REQUEST = SPACE)                          12980000
129900         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12990000
130000     ELSE                                                         13000000
130100         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     13010000
130200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13020000
130300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13030000
130400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13040000
130500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13050099
130510              USING DP010I-NUMERIC-EDIT-AREA                      13051099
130600                                                                  13060000
130700         IF  NOT DP010I-ERROR-DETECTED                            13070000
130800             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N13080000
130900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13090000
131000                 IF  ASC-START-ITEM-REQUEST-N >                   13100000
131100                                          ASC-NUMBER-OF-ITEMS-READ13110000
131200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13120000
131300                     COMPUTE PV-TOP-ITEM =                        13130000
131400                             ASC-NUMBER-OF-ITEMS-READ             13140000
131500                             - PC-ITEMS-PER-PANEL + 1             13150000
131600                     IF  PV-TOP-ITEM < +1                         13160000
131700                         MOVE +1   TO PV-TOP-ITEM                 13170000
131800                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 13180000
131900                         SET DP020-MSG-INFORMATIONAL TO TRUE      13190000
132000                     END-IF                                       13200000
132100                 ELSE                                             13210000
132200                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 13220000
132300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13230000
132400                     COMPUTE PV-BOTTOM-ITEM =                     13240000
132500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13250000
132600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13260000
132700*                        -- BOTTOM OF LIST --                     13270000
132800                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 13280000
132900                         SET DP020-MSG-INFORMATIONAL TO TRUE      13290000
133000                     END-IF                                       13300000
133100                 END-IF                                           13310000
133200             ELSE                                                 13320000
133300*                --- VALUE OUT OF RANGE ----                      13330000
133400                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        13340000
133500                 MOVE -1                     TO ASTRTITL          13350047
133600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13360000
133700                 MOVE DP015-REVERSE          TO ASTRTITH          13370047
133800                 MOVE DP015-RED              TO ASTRTITC          13380047
133900                 MOVE DP015-UNP-NUM-BRT-MDT  TO ASTRTITA          13390047
134000                 SET DP020-MSG-FATAL                              13400000
134100                     PS-ERROR                TO TRUE              13410047
134200             END-IF                                               13420000
134300         ELSE                                                     13430000
134400             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      13440047
134500             MOVE -1                     TO ASTRTITL              13450047
134600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13460000
134700             MOVE DP015-REVERSE          TO ASTRTITH              13470047
134800             MOVE DP015-RED              TO ASTRTITC              13480047
134900             MOVE DP015-UNP-NUM-BRT-MDT  TO ASTRTITA              13490047
135000             SET DP020-MSG-FATAL         TO TRUE                  13500047
135100             SET PS-ERROR                TO TRUE                  13510047
135200         END-IF                                                   13520000
135300     END-IF.                                                      13530000
135400                                                                  13540000
135500******************************************************************13550000
135600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13560000
135700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13570000
135800******************************************************************13580000
135900 2200-MOVE-SCREEN-TO-COMMAREA.                                    13590000
136000                                                                  13600000
136100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             13610000
136200     MOVE +1                       TO PV-SUB.                     13620000
136300                                                                  13630038
136400     PERFORM 3100-SET-SUBSCRIPTS.                                 13640000
136500     IF  ASTRTITL > ZERO                                          13650000
136600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          13660000
136700     ELSE                                                         13670000
136800         IF  ASTRTITF = DP015-ERASE-EOF                           13680000
136900             INITIALIZE ASC-START-ITEM-REQUEST                    13690000
137000         END-IF                                                   13700000
137100     END-IF.                                                      13710000
137200                                                                  13720000
137300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          13730000
137400         VARYING PV-SUB                                           13740000
137500         FROM 1 BY 1                                              13750000
137600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      13760000
137700                                                                  13770038
137800******************************************************************13780000
137900** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**13790000
138000******************************************************************13800000
138100 2210-MOVE-LINES-TO-COMMAREA.                                     13810000
138200                                                                  13820038
138300     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE                 13830000
138400     MOVE SPACE        TO ASC-TEMP-SELECTED-SW                    13840000
138500                          (ASC-BLK-SUB, ASC-ITEM-SUB)             13850000
138600                                                                  13860000
138700     ADD +1                        TO ASC-ITEM-SUB.               13870000
138800                                                                  13880000
138900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        13890000
139000         ADD +1                    TO ASC-BLK-SUB                 13900000
139100         MOVE +1                   TO ASC-ITEM-SUB                13910000
139200     END-IF.                                                      13920000
139300                                                                  13930038
139400******************************************************************13940000
139500** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **13950000
139600** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **13960000
139700******************************************************************13970000
139800 3000-EDIT-DATA-IN-COMMAREA.                                      13980000
139900                                                                  13990038
140000     SET PS-NO-ERROR               TO TRUE.                       14000000
140100     PERFORM 3200-RESET-ATTRIBUTES.                               14010000
140200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     14020000
140300                                                                  14030038
140400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              14040000
140500* EDITTING IS DONE FROM THE BOTTOM UP.                            14050000
140600                                                                  14060038
140700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       14070000
140800         ASC-ITEMS-DISPLAYED - 1.                                 14080000
140900     PERFORM 3100-SET-SUBSCRIPTS.                                 14090000
141000                                                                  14100038
141100     IF  PS-NO-ERROR                                              14110000
141200         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        14120000
141300     END-IF.                                                      14130000
141400                                                                  14140000
141500     IF  PS-NO-ERROR                                              14150000
141600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        14160000
141700     END-IF.                                                      14170000
141800                                                                  14180038
141900     IF  ((PS-NO-ERROR)                                           14190000
142000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   14200000
142100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    14210000
142200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  14220000
142300     END-IF.                                                      14230000
142400                                                                  14240000
142500******************************************************************14250038
142600*   3005-EDIT-COMMAREA-BLOCKS                                    *14260000
142700******************************************************************14270038
142800 3005-EDIT-COMMAREA-BLOCKS.                                       14280000
142900                                                                  14290038
143000     MOVE +1                       TO PV-BLOCK-NUMBER.            14300000
143100     MOVE +1                       TO ASC-BLK-SUB.                14310000
143200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               14320000
143300                                                                  14330000
143400     COMPUTE PV-BLOCK-NUMBER  =                                   14340000
143500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 14350000
143600            PC-ITEMS-PER-PANEL.                                   14360000
143700                                                                  14370000
143800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          14380000
143900                                                                  14390000
144000     PERFORM                                                      14400000
144100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          14410000
144200          OR PS-ERROR                                             14420000
144300          OR PS-BLOCK-ERROR                                       14430000
144400                                                                  14440000
144500             COMPUTE PV-ITEMS-HOLD  =                             14450000
144600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        14460000
144700                     PC-ITEMS-PER-PANEL - 1                       14470000
144800                                                                  14480000
144900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       14490000
145000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               14500000
145100                     FROM  PV-ITEMS-HOLD                          14510000
145200                   GIVING  PV-ITEMS-DIFF                          14520000
145300                 SUBTRACT  PV-ITEMS-DIFF                          14530000
145400                     FROM  PC-ITEMS-PER-PANEL                     14540000
145500                   GIVING  PV-ITEMS-HOLD                          14550000
145600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              14560000
145700                                              ASC-ITEM-SUB        14570000
145800                                              ASC-ITEMS-DISPLAYED 14580000
145900             ELSE                                                 14590000
146000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              14600000
146100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        14610000
146200             END-IF                                               14620000
146300                                                                  14630000
146400             PERFORM 3300-EDIT-SELECTIONS                         14640000
146500                     VARYING PV-SUB                               14650000
146600                        FROM PV-SUB BY -1                         14660000
146700                       UNTIL PV-SUB < +1                          14670000
146800                                                                  14680000
146900             MOVE +1               TO ASC-BLK-SUB                 14690000
147000                                                                  14700000
147100             PERFORM 5105-REWRITE-ASC-LISTQ                       14710000
147200                                                                  14720000
147300             MOVE +1                TO ASC-BLK-SUB                14730000
147400                                                                  14740000
147500             IF  PS-BLOCK-ERROR                                   14750000
147600                 SET  PS-ERROR     TO TRUE                        14760000
147700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        14770000
147800                                   TO PV-TOP-ITEM                 14780000
147900             ELSE                                                 14790000
148000                 ADD  +1           TO PV-BLOCK-NUMBER             14800000
148100                 IF  PV-BLOCK-NUMBER >                            14810000
148200                     ASC-HIGHEST-BLOCK-WRITTEN                    14820000
148300                     MOVE +2       TO ASC-BLK-SUB                 14830000
148400                     PERFORM 4410-READ-TEMP-STORAGE               14840000
148500                     MOVE +1       TO ASC-BLK-SUB                 14850000
148600                 ELSE                                             14860000
148700                     PERFORM 4410-READ-TEMP-STORAGE               14870000
148800                     ADD  +1        TO PV-BLOCK-NUMBER            14880000
148900                     MOVE +2        TO ASC-BLK-SUB                14890000
149000                     PERFORM 4410-READ-TEMP-STORAGE               14900000
149100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            14910000
149200                     MOVE +1        TO ASC-BLK-SUB                14920000
149300                 END-IF                                           14930000
149400             END-IF                                               14940000
149500     END-PERFORM.                                                 14950000
149600                                                                  14960000
149700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            14970000
149800         PS-ERROR                   OR                            14980000
149900         PS-BLOCK-ERROR                                           14990000
150000         CONTINUE                                                 15000000
150100     ELSE                                                         15010000
150200         MOVE +1                 TO PV-BLOCK-NUMBER               15020000
150300         MOVE +1                 TO ASC-BLK-SUB                   15030000
150400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  15040000
150500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           15050000
150600         PERFORM 4410-READ-TEMP-STORAGE                           15060000
150700                                                                  15070000
150800         PERFORM                                                  15080000
150900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              15090000
151000              OR PS-ERROR                                         15100000
151100              OR PS-BLOCK-ERROR                                   15110000
151200                                                                  15120000
151300                 COMPUTE PV-ITEMS-HOLD  =                         15130000
151400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    15140000
151500                         PC-ITEMS-PER-PANEL - 1                   15150000
151600                                                                  15160000
151700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     15170000
151800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           15180000
151900                         FROM  PV-ITEMS-HOLD                      15190000
152000                       GIVING  PV-ITEMS-DIFF                      15200000
152100                     SUBTRACT  PV-ITEMS-DIFF                      15210000
152200                         FROM  PC-ITEMS-PER-PANEL                 15220000
152300                       GIVING  PV-ITEMS-HOLD                      15230000
152400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            15240000
152500                                                ASC-ITEM-SUB      15250000
152600                                               ASC-ITEMS-DISPLAYED15260000
152700                 ELSE                                             15270000
152800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          15280000
152900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    15290000
153000                 END-IF                                           15300000
153100                                                                  15310000
153200                 PERFORM 3300-EDIT-SELECTIONS                     15320000
153300                         VARYING PV-SUB                           15330000
153400                            FROM PV-SUB BY -1                     15340000
153500                           UNTIL PV-SUB < +1                      15350000
153600                                                                  15360000
153700                 MOVE +1               TO ASC-BLK-SUB             15370000
153800                                                                  15380000
153900                 PERFORM 5105-REWRITE-ASC-LISTQ                   15390000
154000                                                                  15400000
154100                 MOVE +1                TO ASC-BLK-SUB            15410000
154200                                                                  15420000
154300                 IF  PS-BLOCK-ERROR                               15430000
154400                     SET  PS-ERROR     TO TRUE                    15440000
154500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    15450000
154600                                       TO PV-TOP-ITEM             15460000
154700                 ELSE                                             15470000
154800                     ADD  +1            TO PV-BLOCK-NUMBER        15480000
154900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      15490000
155000                         MOVE +2        TO ASC-BLK-SUB            15500000
155100                         PERFORM 4410-READ-TEMP-STORAGE           15510000
155200                         MOVE +1        TO ASC-BLK-SUB            15520000
155300                     ELSE                                         15530000
155400                         PERFORM 4410-READ-TEMP-STORAGE           15540000
155500                         ADD  +1        TO PV-BLOCK-NUMBER        15550000
155600                         MOVE +2        TO ASC-BLK-SUB            15560000
155700                         PERFORM 4410-READ-TEMP-STORAGE           15570000
155800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        15580000
155900                         MOVE +1        TO ASC-BLK-SUB            15590000
156000                     END-IF                                       15600000
156100                 END-IF                                           15610000
156200     END-PERFORM.                                                 15620000
156300                                                                  15630000
156400******************************************************************15640038
156500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15650000
156600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15660000
156700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15670000
156800*                                                                *15680000
156900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15690000
157000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15700000
157100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15710000
157200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15720000
157300******************************************************************15730038
157400 3100-SET-SUBSCRIPTS.                                             15740000
157500                                                                  15750000
157600     COMPUTE ASC-ITEM-SUB =                                       15760000
157700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15770000
157800                                                                  15780000
157900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15790000
158000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15800000
158100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               15810000
158200     ELSE                                                         15820000
158300         MOVE +1                     TO ASC-BLK-SUB               15830000
158400     END-IF.                                                      15840000
158500                                                                  15850038
158600******************************************************************15860000
158700** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **15870000
158800******************************************************************15880000
158900 3200-RESET-ATTRIBUTES.                                           15890000
159000                                                                  15900038
159100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   15910000
159200     MOVE DP015-GREEN              TO ASTRTITC.                   15920000
159300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15930000
159400                                                                  15940000
159500******************************************************************15950000
159600** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **15960000
159700** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **15970000
159800** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **15980000
159900** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **15990000
160000******************************************************************16000000
160100 3300-EDIT-SELECTIONS.                                            16010000
160200                                                                  16020038
160300     EVALUATE TRUE                                                16030000
160400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16040000
160500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16050000
160600                 CONTINUE                                         16060000
160700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16070000
160800             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16080000
160900                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16090000
161000                 MOVE ASC-TEMP-SELECTED-SW                        16100000
161100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16110000
161200                                TO ASC-SELECTED-SW                16120000
161300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16130000
161400             END-IF                                               16140000
161500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16150000
161600                 = SPACE                                          16160000
161700             EVALUATE TRUE                                        16170000
161800                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       16180000
161900                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16190000
162000                     MOVE SPACE TO ASC-SELECTED-SW                16200000
162100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16210000
162200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        16220000
162300                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    16230000
162400                     MOVE SPACE TO ASC-SELECTED-SW                16240000
162500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16250000
162600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          16260000
162700                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      16270000
162800                     MOVE SPACE TO ASC-SELECTED-SW                16280000
162900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16290000
163000             END-EVALUATE                                         16300000
163100         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           16310000
163200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16320000
163300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16330000
163400             END-IF                                               16340000
163500             PERFORM 3310-EDIT-RANGE                              16350000
163600         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             16360000
163700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16370000
163800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16380000
163900             END-IF                                               16390000
164000             PERFORM 3310-EDIT-RANGE                              16400000
164100         WHEN OTHER                                               16410000
164200             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           16420000
164300             SET DP020-MSG-FATAL    TO TRUE                       16430000
164400             MOVE -1                TO ASTRTITL                   16440000
164500             SET DP030-SET-CURSOR-APPL-1                          16450000
164600                                    TO TRUE                       16460000
164700             SET PS-ERROR TO TRUE                                 16470000
164800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16480000
164900                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     16490000
165000                 MOVE SPACE         TO ASC-SELECTED-SW            16500000
165100                                        (ASC-BLK-SUB ASC-ITEM-SUB)16510000
165200             END-IF                                               16520000
165300     END-EVALUATE.                                                16530000
165400                                                                  16540000
165500     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 16550000
165600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               16560000
165700     IF  ASC-ITEM-SUB < 1                                         16570000
165800         SUBTRACT +1 FROM ASC-BLK-SUB                             16580000
165900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                16590000
166000     END-IF.                                                      16600000
166100                                                                  16610000
166200******************************************************************16620000
166300** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **16630000
166400** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **16640000
166500** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**16650000
166600** THE ENDING.                                                  **16660000
166700******************************************************************16670000
166800 3310-EDIT-RANGE.                                                 16680000
166900                                                                  16690038
167000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                16700000
167100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   16710000
167200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)16720000
167300                                   TO ASC-SELECTED-SW             16730000
167400                                        (ASC-BLK-SUB ASC-ITEM-SUB)16740000
167500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 16750000
167600         ELSE                                                     16760000
167700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     16770000
167800                 CONTINUE                                         16780000
167900             ELSE                                                 16790000
168000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        16800000
168100                 MOVE PC-TSYMSG-00054                             16810000
168200                                       TO DP020-MSG-NUMBER        16820000
168300                 MOVE -1               TO ASTRTITL                16830000
168400                 SET DP020-MSG-FATAL                              16840000
168500                     DP030-SET-CURSOR-APPL-1                      16850000
168600                     PS-ERROR          TO TRUE                    16860000
168700             END-IF                                               16870000
168800         END-IF                                                   16880000
168900     ELSE                                                         16890000
169000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16900000
169100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16910000
169200                                   TO ASC-SELECTED-SW             16920000
169300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16930000
169400             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   16940000
169500         ELSE                                                     16950000
169600             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16960000
169700                 CONTINUE                                         16970000
169800             ELSE                                                 16980000
169900*                -- ONLY ONE END-OF-RANGE ALLOWED --              16990000
170000                 MOVE PC-TSYMSG-00055                             17000000
170100                                        TO DP020-MSG-NUMBER       17010000
170200                 MOVE -1                TO ASTRTITL               17020000
170300                 SET DP020-MSG-FATAL                              17030000
170400                     DP030-SET-CURSOR-APPL-1                      17040000
170500                     PS-ERROR           TO TRUE                   17050000
170600             END-IF                                               17060000
170700         END-IF                                                   17070000
170800     END-IF.                                                      17080000
170900                                                                  17090038
171000******************************************************************17100000
171100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **17110000
171200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **17120000
171300******************************************************************17130000
171400 3400-CHECK-RANGE-SEQUENCE.                                       17140000
171500                                                                  17150038
171600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       17160000
171700       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      17170000
171800       AND  ASC-START-OF-SELECTED-RANGE >                         17180000
171900                                         ASC-END-OF-SELECTED-RANGE17190000
172000*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                17200000
172100         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 17210000
172200         SET DP020-MSG-FATAL TO TRUE                              17220000
172300         SET PS-ERROR TO TRUE                                     17230000
172400         PERFORM 3410-POSITION-AT-ERROR                           17240000
172500     END-IF.                                                      17250000
172600                                                                  17260038
172700******************************************************************17270000
172800** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **17280000
172900** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **17290000
173000** SHOULD BE POSITIONED ON A RANGE ERROR.                       **17300000
173100******************************************************************17310000
173200 3410-POSITION-AT-ERROR.                                          17320000
173300                                                                  17330038
173400     SET DP030-SET-CURSOR-APPL-1                                  17340000
173500                                   TO TRUE.                       17350000
173600     MOVE -1                       TO ASTRTITL                    17360000
173700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 17370000
173800                    - PV-TOP-ITEM + 1.                            17380000
173900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17390000
174000         CONTINUE                                                 17400000
174100     END-IF.                                                      17410000
174200                                                                  17420038
174300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   17430000
174400                    - PV-TOP-ITEM + 1.                            17440000
174500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17450000
174600         CONTINUE                                                 17460000
174700     END-IF.                                                      17470000
174800                                                                  17480000
174900******************************************************************17490038
175000*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *17500000
175100*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *17510000
175200*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *17520000
175300******************************************************************17530038
175400 3500-MARK-RANGE-AS-SELECTED.                                     17540000
175500                                                                  17550038
175600     MOVE +1                       TO  ASC-BLK-SUB.               17560000
175700     PERFORM 3510-MARK-SELECTED-INDS                              17570000
175800         VARYING ASC-ITEM-SUB                                     17580000
175900         FROM 1 BY 1                                              17590000
176000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17600000
176100                                                                  17610000
176200     ADD +1                        TO ASC-BLK-SUB.                17620000
176300     PERFORM 3510-MARK-SELECTED-INDS                              17630000
176400         VARYING ASC-ITEM-SUB                                     17640000
176500         FROM 1 BY 1                                              17650000
176600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17660000
176700                                                                  17670000
176800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17680000
176900                                   TO  PV-LIST-ITEM-NUMBER.       17690000
177000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17700000
177100         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17710000
177200               PC-ITEMS-PER-PANEL).                               17720000
177300                                                                  17730000
177400     MOVE ASC-START-OF-SELECTED-RANGE                             17740000
177500                                   TO PV-START-OF-SELECTED-RANGE. 17750000
177600     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17760000
177700         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17770000
177800               PC-ITEMS-PER-PANEL).                               17780000
177900                                                                  17790000
178000     MOVE ASC-END-OF-SELECTED-RANGE                               17800000
178100                                   TO  PV-END-OF-SELECTED-RANGE.  17810000
178200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17820000
178300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17830000
178400               PC-ITEMS-PER-PANEL).                               17840000
178500     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17850000
178600         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17860000
178700                                                                  17870000
178800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17880000
178900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17890000
179000         MOVE +1                   TO ASC-BLK-SUB                 17900000
179100         PERFORM 5100-WRITE-TEMP-STORAGE                          17910000
179200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17920000
179300             PV-FIRST-BLOCK-IN-ARRAY - 1                          17930000
179400                                                                  17940000
179500         PERFORM                                                  17950000
179600             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17960000
179700                   PV-PREV-BLOCK-IN-ARRAY                         17970000
179800             MOVE PV-FIRST-BLOCK-IN-RANGE                         17980000
179900                                   TO PV-BLOCK-NUMBER             17990000
180000             PERFORM 4410-READ-TEMP-STORAGE                       18000000
180100             PERFORM 3510-MARK-SELECTED-INDS                      18010000
180200                 VARYING ASC-ITEM-SUB                             18020000
180300                 FROM 1 BY 1                                      18030000
180400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18040000
180500             PERFORM 5100-WRITE-TEMP-STORAGE                      18050000
180600             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     18060000
180700         END-PERFORM                                              18070000
180800                                                                  18080000
180900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18090000
181000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18100000
181100         PERFORM                                                  18110000
181200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18120000
181300                   PV-LAST-BLOCK-IN-RANGE                         18130000
181400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18140000
181500                                   TO PV-BLOCK-NUMBER             18150000
181600             PERFORM 4410-READ-TEMP-STORAGE                       18160000
181700             PERFORM 3510-MARK-SELECTED-INDS                      18170000
181800                 VARYING ASC-ITEM-SUB                             18180000
181900                 FROM 1 BY 1                                      18190000
182000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18200000
182100             PERFORM 5100-WRITE-TEMP-STORAGE                      18210000
182200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18220000
182300         END-PERFORM                                              18230000
182400                                                                  18240000
182500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18250000
182600                                   TO PV-BLOCK-NUMBER             18260000
182700         PERFORM 4410-READ-TEMP-STORAGE                           18270000
182800     END-IF.                                                      18280000
182900                                                                  18290000
183000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 18300000
183100                                      ASC-END-OF-SELECTED-RANGE.  18310000
183200                                                                  18320000
183300******************************************************************18330038
183400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *18340000
183500******************************************************************18350038
183600 3510-MARK-SELECTED-INDS.                                         18360000
183700                                                                  18370000
183800     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         18380000
183900                                ASC-ITEM-SUB) >                   18390000
184000         ASC-START-OF-SELECTED-RANGE)                             18400000
184100     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         18410000
184200                                ASC-ITEM-SUB) =                   18420000
184300         ASC-START-OF-SELECTED-RANGE)                             18430000
184400                                                                  18440000
184500         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     18450000
184600                                    ASC-ITEM-SUB) <               18460000
184700             ASC-END-OF-SELECTED-RANGE)                           18470000
184800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     18480000
184900                                    ASC-ITEM-SUB) =               18490000
185000             ASC-END-OF-SELECTED-RANGE)                           18500000
185100                                                                  18510000
185200             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18520000
185300                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   18530000
185400                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   18540000
185500                               TO TRUE                            18550000
185600                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              18560000
185700                               TO TRUE                            18570000
185800                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    18580000
185900             END-IF                                               18590000
186000         END-IF                                                   18600000
186100     END-IF.                                                      18610000
186200                                                                  18620000
186300******************************************************************18630038
186400*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *18640000
186500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *18650000
186600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *18660000
186700*    DISPLAY THE PANEL TO USER.                                  *18670000
186800******************************************************************18680038
186900 4000-BUILD-INITIAL-PANEL.                                        18690000
187000                                                                  18700000
187100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18710000
187200                                 ASC-BLOCK-ENTRIES (2).           18720000
187300     MOVE +1                 TO ASC-BLK-SUB.                      18730000
187400     SET ASC-ITEMS-LEFT-ON-DB                                     18740000
187500                             TO TRUE.                             18750000
187600                                                                  18760000
187700     MOVE +0                 TO ASC-ITEM-SUB                      18770000
187800                                ASC-NUMBER-OF-ITEMS-READ          18780000
187900                                ASC-NUMBER-OF-SELECTED-ITEMS      18790000
188000                                ASC-HIGHEST-BLOCK-WRITTEN         18800000
188100                                ASC-START-OF-SELECTED-RANGE       18810000
188200                                ASC-END-OF-SELECTED-RANGE         18820000
188300                                ASC-ITEM-AT-TOP-OF-PANEL.         18830000
188400                                                                  18840000
188500     EVALUATE ASC-CREATE-ID                                       18850000
188600         WHEN 'ASN'                                               18860000
188700             MOVE  'CREATED IN ASN      '  TO ACREATEO            18870000
188800         WHEN 'CKN'                                               18880000
188900             MOVE  'CREATED IN CHECK-IN '  TO ACREATEO            18890000
189000         WHEN 'P2L'                                               18900000
189100             MOVE  'CREATED IN PCK-2-LTE'  TO ACREATEO            18910000
189200         WHEN 'JWL'                                               18920000
189300             MOVE  'CREATED IN FINE JWLY'  TO ACREATEO            18930000
189400         WHEN 'RDM'                                               18940000
189500             MOVE  'CREATED IN RDM      '  TO ACREATEO            18950000
189600         WHEN 'RCV'                                               18960000
189700             MOVE  'CREATED IN RECEIVING'  TO ACREATEO            18970000
189800         WHEN 'SMO'                                               18980000
189900             MOVE  'CREATED IN SMOOTHING'  TO ACREATEO            18990000
190000         WHEN 'FXR'                                               19000000
190100             MOVE  'CREATED IN FAST XFER'  TO ACREATEO            19010000
190200         WHEN 'MST'                                               19020000
190300             MOVE  'CREATED IN MSTR CRTN'  TO ACREATEO            19030000
190400         WHEN 'MSC'                                               19040000
190500             MOVE  'CREATD IN CRTN BUILD'  TO ACREATEO            19050000
190600         WHEN 'CPS'                                               19060000
190700             MOVE  'CREATED IN CASE PACK'  TO ACREATEO            19070000
190800         WHEN 'DMG'                                               19080000
190900             MOVE  'CREATED IN CRTN ADJ '  TO ACREATEO            19090000
191000         WHEN 'WMC'                                               19100007
191100             MOVE  'CREATED IN WMOS MANL'  TO ACREATEO            19110006
191200         WHEN 'WMU'                                               19120007
191300             MOVE  'CREATED IN WMOS U128'  TO ACREATEO            19130006
191310         WHEN '3WD'                                               19131099
191320             MOVE  'CREATD 3RD PRTY WHSE'  TO ACREATEO            19132099
191400         WHEN OTHER                                               19140006
191500             MOVE  'UNKNOWN'               TO ACREATEO            19150099
191600     END-EVALUATE.                                                19160000
191700                                                                  19170000
191800     MOVE ASC-SML-SHPD-UNT-ID TO DK-SHIPT-UNT-ID.                 19180038
191900     PERFORM 4010-OPEN-CURSOR.                                    19190000
192000                                                                  19200080
192100     PERFORM 4300-READ-ITEMS-FROM-DB.                             19210000
192200                                                                  19220080
192300     PERFORM 4020-CLOSE-CURSOR.                                   19230000
192400                                                                  19240000
192500     MOVE +1                   TO  PV-TOP-ITEM.                   19250000
192600                                                                  19260000
192700*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        19270000
192800*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   19280000
192900*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      19290000
193000*    THE ORIGINAL SCREEN.                                         19300000
193100     EVALUATE TRUE                                                19310000
193200         WHEN SU010-SELECTED-ITEMS > 1                            19320000
193300             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  19330000
193400                 SET DP020-MSG-WARNING TO  TRUE                   19340000
193500                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       19350000
193600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19360000
193700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19370000
193800             ELSE                                                 19380000
193900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19390000
194000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19400000
194100             END-IF                                               19410000
194200         WHEN OTHER                                               19420000
194300             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  19430000
194400                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            19440000
194500                 SET DP020-MSG-FATAL   TO  TRUE                   19450000
194600                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       19460000
194700             ELSE                                                 19470000
194800                 MOVE -1               TO ASTRTITL                19480000
194900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19490000
195000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19500000
195100             END-IF                                               19510000
195200     END-EVALUATE.                                                19520000
195300                                                                  19530000
195400******************************************************************19540038
195500* OPEN THE CURSOR                                                 19550000
195600******************************************************************19560038
195700 4010-OPEN-CURSOR.                                                19570000
195800                                                                  19580000
195900     PERFORM                                                      19590000
196000         WITH TEST AFTER                                          19600000
196100         VARYING PV-RETRY-COUNTER                                 19610000
196200         FROM 1 BY 1                                              19620000
196300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19630000
196400                   OR (SQLCODE = ZERO))                           19640000
196500                                                                  19650000
196600         EXEC SQL                                                 19660038
196700            OPEN SML-DETAIL-CSR                                   19670038
196800         END-EXEC                                                 19680038
196900                                                                  19690000
197000         EVALUATE TRUE                                            19700000
197100             WHEN SQLCODE = ZERO                                  19710000
197200             WHEN SQLCODE = -904                                  19720000
197300             WHEN SQLCODE = -913                                  19730000
197400                 CONTINUE                                         19740000
197500                                                                  19750038
197600             WHEN SQLWARN0 NOT = SPACES                           19760000
197700             WHEN SQLCODE < ZERO                                  19770000
197800             WHEN SQLCODE > ZERO                                  19780000
197900                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       19790000
198000                 MOVE 'OPEN CURSOR PROBLEM    - '                 19800000
198100                                   TO DP013-MESSAGE-TEXT (1)      19810000
198200                 MOVE SQLCA        TO DP013-SQLCA                 19820000
198300                 MOVE 'SUT_OTBND_LOC'                             19830038
198400                                   TO DP013-DB2-TABLE-NAME (1)    19840038
198500                 MOVE 'TSUCRDV'    TO DP013-DB2-TABLE-NAME (2)    19850038
198600                 MOVE 'SUT_MSTR_SHIPT_UNT'                        19860038
198700                                   TO DP013-DB2-TABLE-NAME (3)    19870038
198800                 MOVE 'SUT_MSTR_SHIPT_CNT'                        19880038
198900                                   TO DP013-DB2-TABLE-NAME (4)    19890038
199000                 SET DP013-DB2-ABEND                              19900000
199100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19910000
199200                 PERFORM DP013-0000-PROCESS-ABEND                 19920000
199300         END-EVALUATE                                             19930000
199400     END-PERFORM.                                                 19940000
199500                                                                  19950038
199600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19960000
199700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             19970000
199800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19980000
199900                                   TO DP013-MESSAGE-TEXT (1)      19990000
200000         MOVE SQLCA                TO DP013-SQLCA                 20000000
200100         MOVE 'SUT_OTBND_LOC'      TO DP013-DB2-TABLE-NAME (1)    20010038
200200         MOVE 'TSUCRDV'            TO DP013-DB2-TABLE-NAME (2)    20020038
200300         MOVE 'SUT_MSTR_SHIPT_UNT' TO DP013-DB2-TABLE-NAME (3)    20030038
200400         MOVE 'SUT_MSTR_SHIPT_CNT' TO DP013-DB2-TABLE-NAME (4)    20040038
200500         SET DP013-DB2-ABEND                                      20050000
200600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   20060000
200700         PERFORM DP013-0000-PROCESS-ABEND                         20070000
200800     END-IF.                                                      20080000
200900                                                                  20090000
201000******************************************************************20100038
201100* CLOSE THE CURSOR.                                               20110000
201200******************************************************************20120038
201300 4020-CLOSE-CURSOR.                                               20130000
201400                                                                  20140000
201500     EXEC SQL                                                     20150038
201600          CLOSE SML-DETAIL-CSR                                    20160038
201700     END-EXEC.                                                    20170038
201800                                                                  20180000
201900     EVALUATE TRUE                                                20190000
202000         WHEN SQLCODE = ZERO                                      20200000
202100         WHEN SQLCODE = +100                                      20210000
202200             CONTINUE                                             20220000
202300                                                                  20230038
202400         WHEN SQLWARN0 NOT = SPACES                               20240000
202500         WHEN SQLCODE < ZERO                                      20250000
202600         WHEN SQLCODE > ZERO                                      20260000
202700             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          20270000
202800             MOVE 'CLOSE CURSOR PROBLEM   '                       20280000
202900                               TO DP013-MESSAGE-TEXT (1)          20290000
203000             MOVE SQLCA        TO DP013-SQLCA                     20300000
203100             MOVE 'SUT_OTBND_LOC'                                 20310038
203200                               TO DP013-DB2-TABLE-NAME (1)        20320038
203300             MOVE 'TSUCRDV'    TO DP013-DB2-TABLE-NAME (2)        20330038
203400             MOVE 'SUT_MSTR_SHIPT_UNT'                            20340038
203500                               TO DP013-DB2-TABLE-NAME (3)        20350038
203600             MOVE 'SUT_MSTR_SHIPT_CNT'                            20360038
203700                               TO DP013-DB2-TABLE-NAME (4)        20370038
203800             SET DP013-DB2-ABEND                                  20380000
203900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20390000
204000             PERFORM DP013-0000-PROCESS-ABEND                     20400000
204100     END-EVALUATE.                                                20410000
204200                                                                  20420000
204300******************************************************************20430038
204400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20440000
204500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20450000
204600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20460000
204700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20470000
204800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20480000
204900*                                                                *20490000
205000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20500000
205100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20510000
205200*    UPON INITIALIZATION.                                        *20520000
205300******************************************************************20530038
205400 4300-READ-ITEMS-FROM-DB.                                         20540000
205500                                                                  20550000
205600     PERFORM                                                      20560000
205700         VARYING PV-READ-COUNT                                    20570000
205800         FROM 1 BY 1                                              20580000
205900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20590000
206000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20600000
206100                                                                  20610000
206200         PERFORM 4310-FETCH-CURSOR                                20620047
206300                                                                  20630000
206400         IF  ASC-ITEMS-LEFT-ON-DB                                 20640000
206500             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20650000
206600                 ADD +1            TO ASC-ITEM-SUB                20660000
206700             ELSE                                                 20670000
206800                 ADD +1            TO ASC-BLK-SUB                 20680000
206900                 MOVE +1           TO ASC-ITEM-SUB                20690000
207000                                                                  20700000
207100                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20710000
207200                     MOVE +1       TO ASC-BLK-SUB                 20720000
207300                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           20730000
207400                     PERFORM 5100-WRITE-TEMP-STORAGE              20740000
207500                     MOVE ASC-BLOCK-ENTRIES                       20750000
207600                                   (PC-MAX-BLOCKS-IN-ARRAY)       20760000
207700                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20770000
207800                     ADD +1        TO ASC-BLK-SUB                 20780000
207900                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20790000
208000                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20800000
208100                                                          TO TRUE 20810000
208200                 END-IF                                           20820000
208300             END-IF                                               20830000
208400             ADD +1                   TO ASC-NUMBER-OF-ITEMS-READ 20840038
208500             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          20850000
208600             MOVE ASC-NUMBER-OF-ITEMS-READ                        20860000
208700                                      TO ASC-LIST-ITEM-NUMBER     20870038
208800                                        (ASC-BLK-SUB ASC-ITEM-SUB)20880038
208900             MOVE PV-CODE             TO ASC-CODE                 20890099
209000                                        (ASC-BLK-SUB ASC-ITEM-SUB)20900094
209100             MOVE PV-SRC-CDE          TO ASC-SRC-CDE              20910038
209200                                        (ASC-BLK-SUB ASC-ITEM-SUB)20920038
209300             MOVE PV-CRE-FLOW-TMST    TO ASC-CRE-FLOW-TMST        20930038
209400                                        (ASC-BLK-SUB ASC-ITEM-SUB)20940038
209500             MOVE PV-LOC-NBR          TO ASC-LOC-NBR              20950038
209600                                        (ASC-BLK-SUB ASC-ITEM-SUB)20960064
209700                                                                  20970069
209800             EVALUATE TRUE                                        20980069
209900               WHEN PV-CODE = PC-M                                20990071
210000                 MOVE SPACES          TO ASC-MASTER-TYPE          21000070
210100                                        (ASC-BLK-SUB ASC-ITEM-SUB)21010070
210200                 MOVE PV-MASTER-TYPE  TO ASC-PROCESS-SCAN-CDE     21020070
210300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21030069
210400                                                                  21040069
210500               WHEN PV-CODE = PC-C                                21050071
210600                 MOVE PV-CHILD-TYPE   TO ASC-MASTER-TYPE          21060070
210700                                        (ASC-BLK-SUB ASC-ITEM-SUB)21070070
210800                 MOVE PV-CHILD-DESC   TO ASC-PROCESS-SCAN-CDE     21080070
210900                                        (ASC-BLK-SUB ASC-ITEM-SUB)21090070
211000                                                                  21100070
211100               WHEN PV-CODE = PC-D                                21110071
211200                   MOVE PV-MASTER-TYPE TO ASC-MASTER-TYPE         21120069
211300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21130069
211400                   PERFORM 4315-RETRIEVE-SCAN-DESC                21140069
211500                                                                  21150069
211510               WHEN PV-CODE = PC-A                                21151099
211511                                                                  21151199
211512                    IF  PV-PROCESS-SCAN-CDE = 'CARTON CHECKED IN' 21151299
211513                        IF  PV-CRE-PGM-NAME = 'SUKCS771'          21151399
211514                            MOVE PV-PNA-CHECKIN                   21151499
211515                                      TO ASC-PROCESS-SCAN-CDE     21151599
211516                                        (ASC-BLK-SUB ASC-ITEM-SUB)21151699
211517                        ELSE                                      21151799
211518                            IF  PV-CRE-PGM-NAME = 'SUKRF502'      21151899
211519                                MOVE PV-RF-CHECKIN                21151999
211520                                      TO ASC-PROCESS-SCAN-CDE     21152099
211521                                        (ASC-BLK-SUB ASC-ITEM-SUB)21152199
211522                            ELSE                                  21152299
211523                                IF  PV-SRC-CDE      = '3WD'       21152399
211524                                    MOVE PV-3WD-RECV              21152499
211525                                      TO ASC-PROCESS-SCAN-CDE     21152599
211526                                        (ASC-BLK-SUB ASC-ITEM-SUB)21152699
211527                                ELSE                              21152799
211528                                    MOVE PV-PROCESS-SCAN-CDE      21152899
211529                                      TO ASC-PROCESS-SCAN-CDE     21152999
211530                                        (ASC-BLK-SUB ASC-ITEM-SUB)21153099
211531                                END-IF                            21153199
211532                            END-IF                                21153299
211533                        END-IF                                    21153399
211534                    ELSE                                          21153499
211535                        MOVE PV-PROCESS-SCAN-CDE                  21153599
211536                                      TO ASC-PROCESS-SCAN-CDE     21153699
211537                                        (ASC-BLK-SUB ASC-ITEM-SUB)21153799
211540                    END-IF                                        21154099
211550                                                                  21155099
211600               WHEN OTHER                                         21160071
211700                   MOVE PV-MASTER-TYPE TO ASC-MASTER-TYPE         21170069
211800                                        (ASC-BLK-SUB ASC-ITEM-SUB)21180069
211900                   MOVE PV-PROCESS-SCAN-CDE                       21190069
212000                                      TO ASC-PROCESS-SCAN-CDE     21200063
212100                                        (ASC-BLK-SUB ASC-ITEM-SUB)21210038
212200             END-EVALUATE                                         21220069
212300                                                                  21230067
212400             MOVE PV-CRE-USR-ID       TO ASC-CRE-USR-ID           21240038
212500                                        (ASC-BLK-SUB ASC-ITEM-SUB)21250038
212600             MOVE PV-ACTIVE-CODE      TO ASC-ACTIVE-CODE          21260038
212700                                        (ASC-BLK-SUB ASC-ITEM-SUB)21270038
212800             MOVE PV-OTBND-TRIP-ID    TO ASC-OTBND-TRIP-ID        21280038
212900                                        (ASC-BLK-SUB ASC-ITEM-SUB)21290038
213000             MOVE PV-INBND-TRIP-ID    TO ASC-INBND-TRIP-ID        21300038
213100                                        (ASC-BLK-SUB ASC-ITEM-SUB)21310038
213200             MOVE PV-CRE-PGM-NAME     TO ASC-CRE-PGM-NAME         21320038
213300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21330038
213400             MOVE PV-DOOR-NBR         TO ASC-DOOR-NBR             21340038
213500                                        (ASC-BLK-SUB ASC-ITEM-SUB)21350098
213600             MOVE PV-DEST             TO ASC-DEST                 21360099
213700                                        (ASC-BLK-SUB ASC-ITEM-SUB)21370038
213800             MOVE PV-CHILD-DESC       TO ASC-CHILD-DESC           21380038
213900                                        (ASC-BLK-SUB ASC-ITEM-SUB)21390038
214000             MOVE PV-CHILD-TYPE       TO ASC-CHILD-TYPE           21400038
214100                                        (ASC-BLK-SUB ASC-ITEM-SUB)21410038
214200         END-IF                                                   21420000
214300     END-PERFORM.                                                 21430000
214400                                                                  21440000
214500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21450000
214600         MOVE +1               TO ASC-BLK-SUB                     21460000
214700         PERFORM 5100-WRITE-TEMP-STORAGE                          21470000
214800         ADD +1                TO ASC-BLK-SUB                     21480000
214900         PERFORM 5100-WRITE-TEMP-STORAGE                          21490000
215000         MOVE 1                TO ASC-BLK-SUB                     21500000
215100                                  PV-BLOCK-NUMBER                 21510000
215200         PERFORM 4410-READ-TEMP-STORAGE                           21520000
215300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             21530000
215400             MOVE 2            TO ASC-BLK-SUB                     21540000
215500                                  PV-BLOCK-NUMBER                 21550000
215600             PERFORM 4410-READ-TEMP-STORAGE                       21560000
215700         END-IF                                                   21570000
215800     END-IF.                                                      21580000
215900                                                                  21590000
216000******************************************************************21600038
216100*    FETCH THE CURSOR                                             21610000
216200******************************************************************21620038
216300 4310-FETCH-CURSOR.                                               21630047
216400                                                                  21640038
216500     EXEC SQL                                                     21650038
216600          FETCH SML-DETAIL-CSR                                    21660038
216700          INTO  :PV-CODE                                          21670038
216800              , :PV-SML-SHPD-UNT-ID                               21680038
216900              , :PV-SRC-CDE                                       21690038
217000              , :PV-CRE-FLOW-TMST                                 21700038
217100              , :PV-LOC-NBR                                       21710038
217200                :PV-NULL-IND-1                                    21720080
217300              , :PV-PROCESS-SCAN-CDE                              21730038
217400              , :PV-CRE-USR-ID                                    21740038
217500              , :PV-ACTIVE-CODE                                   21750038
217600              , :PV-OTBND-TRIP-ID                                 21760038
217700                :PV-NULL-IND-2                                    21770080
217800              , :PV-INBND-TRIP-ID                                 21780038
217900                :PV-NULL-IND-3                                    21790080
218000              , :PV-CRE-PGM-NAME                                  21800038
218100              , :PV-DOOR-NBR                                      21810038
218200              , :PV-DEST                                          21820038
218300                :PV-NULL-IND-4                                    21830080
218400              , :PV-MASTER-TYPE                                   21840038
218500              , :PV-CHILD-DESC                                    21850038
218600              , :PV-CHILD-TYPE                                    21860038
218700     END-EXEC.                                                    21870038
218800                                                                  21880000
218900     EVALUATE TRUE                                                21890000
219000         WHEN SQLCODE = ZERO                                      21900000
219100              IF PV-NULL-IND-1  =  -1                             21910080
219200                  MOVE ZEROES     TO PV-LOC-NBR                   21920080
219300              END-IF                                              21930080
219400              IF PV-NULL-IND-2  =  -1                             21940080
219500                  MOVE ZEROES     TO PV-OTBND-TRIP-ID             21950080
219600              END-IF                                              21960056
219700              IF PV-NULL-IND-3  =  -1                             21970080
219800                  MOVE ZEROES     TO PV-INBND-TRIP-ID             21980080
219900              END-IF                                              21990056
220000              IF PV-NULL-IND-4  =  -1                             22000080
220100                  MOVE ZEROES     TO PV-DEST                      22010080
220200              END-IF                                              22020056
220300                                                                  22030038
220400         WHEN SQLCODE = +100                                      22040083
220500              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 22050083
220600                                                                  22060083
220700         WHEN SQLWARN0 NOT = SPACE                                22070000
220800         WHEN SQLCODE  NOT = ZERO                                 22080038
220900              MOVE '4310-FETCH-CURSOR'                            22090038
221000                                  TO DP013-PARAGRAPH              22100038
221100              MOVE 'FETCH CURSOR PROBLEM '                        22110000
221200                                  TO DP013-MESSAGE-TEXT (1)       22120038
221300              MOVE SQLCA          TO DP013-SQLCA                  22130038
221400              MOVE 'SUT_OTBND_LOC'                                22140038
221500                                  TO DP013-DB2-TABLE-NAME (1)     22150038
221600              MOVE 'TSUCRDV'      TO DP013-DB2-TABLE-NAME (2)     22160038
221700              MOVE 'SUT_MSTR_SHIPT_UNT'                           22170038
221800                                  TO DP013-DB2-TABLE-NAME (3)     22180038
221900              MOVE 'SUT_MSTR_SHIPT_CNT'                           22190038
222000                                  TO DP013-DB2-TABLE-NAME (4)     22200038
222100              SET DP013-DB2-ABEND TO TRUE                         22210000
222200              PERFORM DP013-0000-PROCESS-ABEND                    22220000
222300     END-EVALUATE.                                                22230000
222400                                                                  22240000
222500******************************************************************22250038
222600* RETRIEVE THE PROCESS CODE DESCRIPTION                           22260080
222700******************************************************************22270038
222800 4315-RETRIEVE-SCAN-DESC.                                         22280063
222900                                                                  22290038
223000     MOVE PV-PROCESS-SCAN-CDE TO DK-SCN-CDE.                      22300063
223100                                                                  22310038
223200     EXEC SQL                                                     22320000
223300          SELECT SCN_TYP_SHRT_DES                                 22330063
223400            INTO :SUT00120-SCN-TYP-SHRT-DES                       22340063
223500            FROM SUT_OTBND_SCN_TYP                                22350063
223600           WHERE SCN_TYP_CDE  = :DK-SCN-CDE                       22360063
223700             AND ACTV_IND     = :PC-Y                             22370063
223800            WITH UR                                               22380038
223900     END-EXEC.                                                    22390038
224000                                                                  22400038
224100     EVALUATE TRUE                                                22410000
224200         WHEN SQLCODE = ZERO                                      22420000
224300             MOVE SUT00120-SCN-TYP-SHRT-DES                       22430063
224400                                   TO ASC-PROCESS-SCAN-CDE        22440063
224500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22450063
224600                                                                  22460038
224700         WHEN SQLCODE = +100                                      22470000
224800             MOVE PV-PROCESS-SCAN-CDE                             22480063
224900                                   TO ASC-PROCESS-SCAN-CDE        22490063
225000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22500063
225100                                                                  22510038
225200         WHEN SQLWARN0 NOT = SPACE                                22520000
225300         WHEN SQLCODE NOT = ZERO                                  22530000
225400              MOVE '4315-RETRIEVE-SCAN-DESC'                      22540063
225500                                  TO DP013-PARAGRAPH              22550038
225600              MOVE 'GET PROCESS CODE DESC '                       22560063
225700                                  TO DP013-MESSAGE-TEXT (1)       22570038
225800              MOVE SQLCA          TO DP013-SQLCA                  22580038
225900              MOVE 'SUT_OTBND_SCN_TYP'                            22590082
226000                                  TO DP013-DB2-TABLE-NAME (1)     22600082
226100              SET DP013-DB2-ABEND TO TRUE                         22610000
226200              PERFORM DP013-0000-PROCESS-ABEND                    22620000
226300     END-EVALUATE.                                                22630000
226400                                                                  22640000
226500******************************************************************22650063
226600* RETRIEVE CREATE DATE/TIME FROM SUT_OTBND_CART TABLE             22660063
226700******************************************************************22670063
226800 4320-GET-DATE-TIME.                                              22680063
226900                                                                  22690063
227000     INITIALIZE DCLSUT00024.                                      22700063
227100                                                                  22710063
227200     MOVE ASC-SML-SHPD-UNT-ID TO DK-SHIPT-UNT-ID.                 22720063
227300                                                                  22730063
227400     EXEC SQL                                                     22740063
227500          SELECT CRE_DTE                                          22750063
227600                ,CRE_TM                                           22760063
227700                ,ACTV_IND                                         22770063
227800                ,PRNT_CART_ID                                     22780063
227900                ,ORIG_CART_ID                                     22790063
227910                ,CART_SRC_CDE                                     22791099
228000            INTO :SUT00024-CRE-DTE                                22800063
228100                ,:SUT00024-CRE-TM                                 22810063
228200                ,:SUT00024-ACTV-IND                               22820063
228300                ,:SUT00024-PRNT-CART-ID                           22830063
228400                ,:SUT00024-ORIG-CART-ID                           22840063
228410                ,:SUT00024-CART-SRC-CDE                           22841099
228500            FROM SUT_OTBND_CART                                   22850063
228600           WHERE SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                 22860063
228700            WITH UR                                               22870063
228800     END-EXEC.                                                    22880063
228900                                                                  22890063
229000     EVALUATE TRUE                                                22900063
229100         WHEN SQLCODE = ZERO                                      22910063
229200             MOVE SUT00024-CRE-DTE TO DK-CRE-DATE                 22920063
229300             MOVE SUT00024-CRE-TM  TO DK-CRE-TIME                 22930063
229400             MOVE DK-TMST-CCYY     TO PV-DISPLAY-CCYY             22940063
229500             MOVE DK-TMST-MM       TO PV-DISPLAY-MM               22950063
229600             MOVE DK-TMST-DD       TO PV-DISPLAY-DD               22960063
229700             MOVE DK-TMST-HRS      TO PV-DISPLAY-HRS              22970063
229800             MOVE DK-TMST-MIN      TO PV-DISPLAY-MIN              22980063
229900             MOVE DK-TMST-SEC      TO PV-DISPLAY-SEC              22990063
229910             MOVE SUT00024-CART-SRC-CDE                           22991099
229920                                   TO ASC-CART-SRC                22992099
230000                                                                  23000063
230100         WHEN SQLCODE = +100                                      23010063
230200             PERFORM 4325-GET-DATE-TIME                           23020063
230300                                                                  23030063
230400         WHEN SQLWARN0 NOT = SPACE                                23040063
230500         WHEN SQLCODE NOT = ZERO                                  23050063
230600              MOVE '4320-GET-DATE-TIME'                           23060063
230700                                  TO DP013-PARAGRAPH              23070063
230800              MOVE 'GET SHPUNT DATE & TIME '                      23080063
230900                                  TO DP013-MESSAGE-TEXT (1)       23090063
231000              MOVE SQLCA          TO DP013-SQLCA                  23100063
231100              MOVE 'SUT_OTBND_CART'                               23110082
231200                                  TO DP013-DB2-TABLE-NAME (1)     23120082
231300              SET DP013-DB2-ABEND TO TRUE                         23130063
231400              PERFORM DP013-0000-PROCESS-ABEND                    23140063
231500     END-EVALUATE.                                                23150063
231600                                                                  23160063
231700******************************************************************23170038
231800 4325-GET-DATE-TIME.                                              23180000
231900                                                                  23190000
232000     EXEC SQL                                                     23200000
232100          SELECT CRE_DTE                                          23210000
232200                ,CRE_TM                                           23220000
232300                ,ACTV_IND                                         23230000
232310                ,CART_SRC_CDE                                     23231099
232400            INTO :SUT00024-CRE-DTE                                23240038
232500                ,:SUT00024-CRE-TM                                 23250038
232600                ,:SUT00024-ACTV-IND                               23260038
232610                ,:SUT00024-CART-SRC-CDE                           23261099
232700            FROM SUT_OTBND_CART                                   23270038
232800           WHERE ORIG_CART_ID  = :DK-SHIPT-UNT-ID                 23280038
232900            WITH UR                                               23290038
233000     END-EXEC.                                                    23300000
233100                                                                  23310000
233200     EVALUATE TRUE                                                23320000
233300         WHEN SQLCODE = ZERO                                      23330000
233400             MOVE SUT00024-CRE-DTE TO DK-CRE-DATE                 23340000
233500             MOVE SUT00024-CRE-TM  TO DK-CRE-TIME                 23350038
233600             MOVE DK-TMST-CCYY     TO PV-DISPLAY-CCYY             23360038
233700             MOVE DK-TMST-MM       TO PV-DISPLAY-MM               23370038
233800             MOVE DK-TMST-DD       TO PV-DISPLAY-DD               23380038
233900             MOVE DK-TMST-HRS      TO PV-DISPLAY-HRS              23390038
234000             MOVE DK-TMST-MIN      TO PV-DISPLAY-MIN              23400038
234100             MOVE DK-TMST-SEC      TO PV-DISPLAY-SEC              23410038
234110             MOVE SUT00024-CART-SRC-CDE                           23411099
234120                                   TO ASC-CART-SRC                23412099
234200                                                                  23420038
234300         WHEN SQLCODE = +100                                      23430000
234400             MOVE SPACES           TO PV-DATE-DISPLAY             23440038
234500                                      PV-TIME-DISPLAY             23450038
234600                                                                  23460038
234700         WHEN SQLWARN0 NOT = SPACE                                23470000
234800         WHEN SQLCODE  NOT = ZERO                                 23480047
234900              MOVE '4325-GET-DATE-TIME'                           23490038
235000                                   TO DP013-PARAGRAPH             23500038
235100              MOVE 'GET CART DATE & TIME '                        23510047
235200                                   TO DP013-MESSAGE-TEXT (1)      23520038
235300              MOVE SQLCA           TO DP013-SQLCA                 23530038
235400              MOVE 'SUT_OTBND_CART'                               23540047
235500                                   TO DP013-DB2-TABLE-NAME (1)    23550047
235600              SET DP013-DB2-ABEND  TO TRUE                        23560038
235700              PERFORM DP013-0000-PROCESS-ABEND                    23570000
235800     END-EVALUATE.                                                23580000
235900                                                                  23590000
236000******************************************************************23600038
236100* RETRIEVE TRIP STATUS DESCRIPTION FROM TSUOBSC                   23610000
236200******************************************************************23620038
236300 4330-GET-TRIP-STATUS.                                            23630000
236400                                                                  23640038
236500     EXEC SQL                                                     23650000
236600          SELECT STAT_SHRT_DESC                                   23660000
236700            INTO :SUOBSC-STAT-SHRT-DESC                           23670038
236800            FROM TSUOBSC                                          23680038
236900           WHERE TRIP_STAT_CDE = :ASC-TRIP-STATUS                 23690038
237000            WITH UR                                               23700038
237100     END-EXEC.                                                    23710038
237200                                                                  23720038
237300     EVALUATE TRUE                                                23730000
237400         WHEN SQLCODE = ZERO                                      23740000
237500             MOVE SUOBSC-STAT-SHRT-DESC                           23750081
237600                                  TO ASC-TRLR-STATUS              23760081
237700                                                                  23770038
237800         WHEN SQLCODE = +100                                      23780000
237900             MOVE SPACES          TO ASC-TRLR-STATUS              23790081
238000                                                                  23800038
238100         WHEN SQLWARN0 NOT = SPACE                                23810000
238200         WHEN SQLCODE NOT = ZERO                                  23820000
238300              MOVE '4330-GET-TRIP-STATUS'                         23830038
238400                                  TO DP013-PARAGRAPH              23840038
238500              MOVE 'GET TRIP STATUS '                             23850000
238600                                  TO DP013-MESSAGE-TEXT (1)       23860038
238700              MOVE SQLCA          TO DP013-SQLCA                  23870038
238800              MOVE 'TSUOBSC '     TO DP013-DB2-TABLE-NAME (1)     23880038
238900              SET DP013-DB2-ABEND TO TRUE                         23890000
239000              PERFORM DP013-0000-PROCESS-ABEND                    23900000
239100     END-EVALUATE.                                                23910000
239200                                                                  23920000
239300******************************************************************23930099
239400* GET TOTAL CARTON QUANTITY FROM SUT_OTBND_UPC                    23940096
239500******************************************************************23950099
239600 4350-GET-SHPD-QTY.                                               23960000
239700                                                                  23970038
239800     EXEC SQL                                                     23980000
239900          SELECT SUM(SHPD_UNT_QTY)                                23990000
240000            INTO :PV-SHPD-QTY                                     24000038
240100            FROM SUT_OTBND_UPC                                    24010038
240200           WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                  24020038
240300            WITH UR                                               24030038
240400     END-EXEC.                                                    24040038
240500                                                                  24050038
240600     EVALUATE TRUE                                                24060000
240700         WHEN SQLCODE = ZERO                                      24070000
240800             CONTINUE                                             24080000
240900                                                                  24090038
241000         WHEN SQLCODE      = +100                                 24100047
241100         WHEN SQLWARN0 NOT = SPACE                                24110000
241200         WHEN SQLCODE  NOT = ZERO                                 24120047
241300             MOVE ZEROES          TO PV-SHPD-QTY                  24130038
241400     END-EVALUATE.                                                24140000
241500                                                                  24150000
241600******************************************************************24160038
241700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *24170000
241800******************************************************************24180038
241900 4400-MOVE-COMMAREA-TO-SCREEN.                                    24190000
242000                                                                  24200038
242100     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             24210000
242200         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          24220000
242300         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          24230000
242400             MOVE +1    TO ASC-BLK-SUB                            24240000
242500             PERFORM 5100-WRITE-TEMP-STORAGE                      24250000
242600             ADD +1     TO ASC-BLK-SUB                            24260000
242700             PERFORM 5100-WRITE-TEMP-STORAGE                      24270000
242800             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             24280000
242900                 GIVING PV-BLOCK-NUMBER                           24290000
243000                 REMAINDER PV-REMAINDER                           24300000
243100             IF  PV-REMAINDER > ZERO                              24310000
243200                 ADD +1 TO PV-BLOCK-NUMBER                        24320000
243300             END-IF                                               24330000
243400             MOVE +1    TO ASC-BLK-SUB                            24340000
243500             PERFORM 4410-READ-TEMP-STORAGE                       24350000
243600             ADD +1     TO ASC-BLK-SUB                            24360000
243700                           PV-BLOCK-NUMBER                        24370000
243800             PERFORM 4410-READ-TEMP-STORAGE                       24380000
243900     END-IF.                                                      24390000
244000     MOVE +1            TO ASC-BLK-SUB.                           24400000
244100     COMPUTE ASC-ITEM-SUB =                                       24410000
244200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              24420000
244300         + PC-ITEMS-PER-PANEL).                                   24430000
244400                                                                  24440038
244500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24450000
244600         ADD +1         TO ASC-BLK-SUB                            24460000
244700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24470000
244800     END-IF.                                                      24480000
244900                                                                  24490038
245000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           24500000
245100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                24510000
245200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        24520000
245300     PERFORM 4420-FORMAT-LIST-LINES                               24530000
245400         VARYING PV-SUB                                           24540000
245500         FROM PC-ITEMS-PER-PANEL BY -1                            24550000
245600         UNTIL PV-SUB < +1.                                       24560000
245700                                                                  24570038
245800     COMPUTE ASC-ITEMS-DISPLAYED =                                24580000
245900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          24590000
246000                                                                  24600038
246100     MOVE PV-TOP-ITEM                TO ASC-ITEM-AT-TOP-OF-PANEL  24610050
246200                                        ASTRTITO.                 24620050
246300     MOVE ASC-ITEM-AT-BOT-OF-PANEL   TO AENDITO.                  24630050
246400     MOVE ASC-NUMBER-OF-ITEMS-READ   TO ATOTITO.                  24640050
246500                                                                  24650000
246600     PERFORM 4320-GET-DATE-TIME.                                  24660000
246700                                                                  24670038
246800     IF SUT00024-PRNT-CART-ID  = DK-SHIPT-UNT-ID                  24680050
246900     OR SUT00024-PRNT-CART-ID  = 0                                24690050
247000         MOVE SPACES                 TO AMSTO                     24700038
247100                                        AMSTNBRO                  24710038
247200     ELSE                                                         24720000
247300         MOVE 'MASTER SML.:'         TO AMSTO                     24730038
247400         MOVE SUT00024-PRNT-CART-ID  TO PV-DISPLAY-PARENT         24740000
247500         MOVE PV-DISPLAY-PARENT      TO AMSTNBRO                  24750038
247600     END-IF.                                                      24760038
247700                                                                  24770008
247800     IF SUT00024-ORIG-CART-ID  = DK-SHIPT-UNT-ID                  24780050
247900     OR SUT00024-ORIG-CART-ID  = 0                                24790050
248000         MOVE SPACES                 TO ASRLO                     24800038
248100                                        ASRLNBRO                  24810038
248200     ELSE                                                         24820008
248300         MOVE 'SERIAL SHIP CODE:'    TO ASRLO                     24830009
248400         MOVE SUT00024-ORIG-CART-ID  TO PV-DISPLAY-ORIG           24840008
248500         MOVE PV-DISPLAY-ORIG        TO ASRLNBRO                  24850009
248600     END-IF.                                                      24860038
248700                                                                  24870008
248800     MOVE PV-DATE-DISPLAY            TO ACREDTO.                  24880050
248900     MOVE PV-TIME-DISPLAY            TO ACRETMO.                  24890050
249000                                                                  24900000
249100     PERFORM 4350-GET-SHPD-QTY.                                   24910000
249200     MOVE PV-SHPD-QTY                TO PV-SHPD-QTY-N.            24920050
249300     MOVE PV-SHPD-QTY-X              TO ATOTQTYO.                 24930050
249400                                                                  24940000
249500     MOVE ASC-SML-SHPD-UNT-ID        TO ASMLO.                    24950050
249600     IF ASC-SML-SHPD-UNT-ID > ZERO                                24960038
249700         PERFORM 1101-GET-CARTON-INFO                             24970000
249800     END-IF.                                                      24980000
249900                                                                  24990000
250000     EVALUATE ASC-CREATE-ID                                       25000000
250100         WHEN 'ASN'                                               25010000
250200             MOVE  'CREATED IN ASN      '  TO ACREATEO            25020000
250300         WHEN 'CKN'                                               25030000
250400             MOVE  'CREATED IN CHECK-IN '  TO ACREATEO            25040000
250500         WHEN 'P2L'                                               25050000
250600             MOVE  'CREATED IN PCK-2-LTE'  TO ACREATEO            25060000
250700         WHEN 'JWL'                                               25070000
250800             MOVE  'CREATED IN FINE JWLY'  TO ACREATEO            25080000
250900         WHEN 'RDM'                                               25090000
251000             MOVE  'CREATED IN RDM      '  TO ACREATEO            25100000
251100         WHEN 'RCV'                                               25110000
251200             MOVE  'CREATED IN RECEIVING'  TO ACREATEO            25120000
251300         WHEN 'SMO'                                               25130000
251400             MOVE  'CREATED IN SMOOTHING'  TO ACREATEO            25140000
251500         WHEN 'FXR'                                               25150000
251600             MOVE  'CREATED IN FAST XFER'  TO ACREATEO            25160000
251700         WHEN 'MST'                                               25170000
251800             MOVE  'CREATED IN MSTR CRTN'  TO ACREATEO            25180000
251900         WHEN 'MSC'                                               25190000
252000             MOVE  'CREATD IN CRTN BUILD'  TO ACREATEO            25200000
252100         WHEN 'CPS'                                               25210000
252200             MOVE  'CREATED IN CASE PACK'  TO ACREATEO            25220000
252300         WHEN 'DMG'                                               25230000
252400             MOVE  'CREATED IN CRTN ADJ '  TO ACREATEO            25240000
252500         WHEN 'WMC'                                               25250007
252600             MOVE  'CREATED IN WMOS MANL'  TO ACREATEO            25260006
252700         WHEN 'WMU'                                               25270007
252800             MOVE  'CREATED IN WMOS U128'  TO ACREATEO            25280006
252810         WHEN '3WD'                                               25281099
252820             MOVE  'CREATD 3RD PRTY WHSE'  TO ACREATEO            25282099
252900         WHEN OTHER                                               25290000
253000             MOVE  'UNKNOWN'               TO ACREATEO            25300099
253100     END-EVALUATE.                                                25310000
253200                                                                  25320000
253300     MOVE ASC-STR-NBR-X            TO ADESTO.                     25330047
253400     MOVE ASC-DOOR-ID              TO ADOORO.                     25340047
253500     IF ASC-TRIP-STATUS NOT = SPACES                              25350000
253600         PERFORM 4330-GET-TRIP-STATUS                             25360000
253700         MOVE ASC-TRLR-STATUS      TO ATRLSTAO                    25370047
253800     ELSE                                                         25380000
253900         MOVE SPACES               TO ATRLSTAO                    25390047
254000     END-IF.                                                      25400000
254100     MOVE ASC-CRTN-STAT-DESC       TO ACTNSTAO.                   25410047
254200                                                                  25420000
254300***IF THE CARTON IS INACTIVE, MAKE THE DESCRIPTION YELLOW.        25430000
254400     IF ASC-CARTON-STATUS = '02'                                  25440000
254500         MOVE DP015-YELLOW         TO ACTNSTAC                    25450047
254600     ELSE                                                         25460000
254700         MOVE DP015-BLUE           TO ACTNSTAC                    25470047
254800     END-IF.                                                      25480000
254900                                                                  25490000
255000     IF ASC-OUTBOUND-TRIP-ID > 0                                  25500050
255100         MOVE ASC-OUTBOUND-TRIP-ID TO ATRIPO                      25510047
255200     ELSE                                                         25520000
255300         MOVE SPACES               TO ATRIPO                      25530047
255400     END-IF.                                                      25540000
255500                                                                  25550000
255600     IF ASC-DOOR-TYP-CDE > SPACES                                 25560000
255700         EXEC SQL                                                 25570000
255800              SELECT DOOR_TYP_CDE_DESC                            25580000
255900                INTO :ASC-DOOR-DESC                               25590039
256000                FROM TCNDRTY                                      25600039
256100               WHERE DOOR_TYP_CDE = :ASC-DOOR-TYP-CDE             25610039
256200         END-EXEC                                                 25620000
256300                                                                  25630039
256400         EVALUATE TRUE                                            25640000
256500             WHEN SQLCODE = ZERO                                  25650000
256600                 MOVE ASC-DOOR-DESC   TO ADOORTYO                 25660047
256700                                                                  25670039
256800             WHEN SQLCODE      = +100                             25680039
256900             WHEN SQLWARN0 NOT = SPACE                            25690000
257000             WHEN SQLCODE  NOT = ZERO                             25700039
257100                 MOVE SPACES          TO ADOORTYO                 25710047
257200         END-EVALUATE                                             25720000
257300     END-IF.                                                      25730000
257400                                                                  25740000
257500     IF ASC-TRLR-SRL-NMBR > ZEROES                                25750000
257600         IF ASC-SCAC-CODE = SPACES                                25760001
257700             MOVE ASC-TRLR-SRL-NMBR   TO  DK-TRLR-SRL-NBR         25770047
257800             EXEC SQL                                             25780001
257900                  SELECT SCAC_CDE                                 25790001
258000                        ,TRLR_ID                                  25800047
258100                    INTO :ASC-SCAC-CODE                           25810047
258200                        ,:ASC-TRLR-ID                             25820047
258300                    FROM TCNTRID                                  25830047
258400                   WHERE TRLR_SRL_NBR = :DK-TRLR-SRL-NBR          25840047
258500                    WITH UR                                       25850051
258600             END-EXEC                                             25860001
258700                                                                  25870047
258800             EVALUATE TRUE                                        25880001
258900                 WHEN SQLCODE = ZERO                              25890001
259000                     MOVE ASC-SCAC-CODE      TO ASCACO            25900047
259100                     MOVE ASC-TRLR-ID        TO ATRLNBRO          25910047
259200                     MOVE ASC-TRLR-SRL-NMBR  TO ATRLSRLO          25920047
259300                                                                  25930047
259400                 WHEN SQLCODE      = +100                         25940047
259500                 WHEN SQLWARN0 NOT = SPACE                        25950001
259600                 WHEN SQLCODE  NOT = ZERO                         25960047
259700                     MOVE SPACES             TO ASCACO            25970047
259800                                                ATRLNBRO          25980047
259900                                                ATRLSRLO          25990047
260000             END-EVALUATE                                         26000001
260100         ELSE                                                     26010001
260200             MOVE ASC-TRLR-SRL-NMBR          TO DK-TRLR-SRL-NBR   26020047
260300             EXEC SQL                                             26030036
260400                  SELECT TRLR_ID                                  26040036
260500                    INTO :ASC-TRLR-ID                             26050050
260600                    FROM TCNTRID                                  26060050
260700                   WHERE TRLR_SRL_NBR = :DK-TRLR-SRL-NBR          26070050
260800                    WITH UR                                       26080050
260900             END-EXEC                                             26090036
261000                                                                  26100047
261100             EVALUATE TRUE                                        26110036
261200                 WHEN SQLCODE = ZERO                              26120036
261300                     MOVE ASC-SCAC-CODE      TO ASCACO            26130047
261400                     MOVE ASC-TRLR-ID        TO ATRLNBRO          26140047
261500                     MOVE ASC-TRLR-SRL-NMBR  TO ATRLSRLO          26150047
261600                                                                  26160047
261700                 WHEN SQLCODE      = +100                         26170047
261800                 WHEN SQLWARN0 NOT = SPACE                        26180036
261900                 WHEN SQLCODE  NOT = ZERO                         26190047
262000                     MOVE SPACES             TO ASCACO            26200047
262100                                                ATRLNBRO          26210047
262200                                                ATRLSRLO          26220047
262300             END-EVALUATE                                         26230036
262400         END-IF                                                   26240001
262500     ELSE                                                         26250001
262600         MOVE SPACES                         TO ASCACO            26260047
262700                                                ATRLNBRO          26270047
262800                                                ATRLSRLO          26280047
262900     END-IF.                                                      26290000
263000                                                                  26300000
263100     IF  DP020-MSG-NUMBER-X = SPACE                               26310000
263200         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  26320000
263300*            --- MORE ITEMS TO DISPLAY ----                       26330000
263400             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            26340000
263500             SET DP020-MSG-INFORMATIONAL TO TRUE                  26350000
263600         END-IF                                                   26360000
263700     END-IF.                                                      26370000
263800                                                                  26380000
263900******************************************************************26390038
264000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *26400000
264100******************************************************************26410038
264200 4410-READ-TEMP-STORAGE.                                          26420000
264300                                                                  26430000
264400     EXEC CICS                                                    26440000
264500         READQ TS                                                 26450000
264600             QUEUE (ASC-LIST-QUEUE-NAME)                          26460000
264700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26470000
264800             ITEM  (PV-BLOCK-NUMBER)                              26480000
264900             RESP  (PV-CICS-RESP)                                 26490000
265000     END-EXEC.                                                    26500000
265100                                                                  26510000
265200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       26520000
265300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     26530000
265400         CONTINUE                                                 26540000
265500     ELSE                                                         26550000
265600         SET DP013-CICS-ABEND     TO TRUE                         26560000
265700         SET DP013-NO-ROLLBACK    TO TRUE                         26570000
265800         MOVE '4410-READ-TEMP-STORAGE'                            26580000
265900                                  TO DP013-PARAGRAPH              26590000
266000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      26600000
266100                                  TO DP013-MESSAGE-TEXT(1)        26610000
266200         PERFORM DP013-0000-PROCESS-ABEND                         26620000
266300     END-IF.                                                      26630000
266400                                                                  26640000
266500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26650000
266600                                                                  26660038
266700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         26670000
266800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               26680000
266900     END-IF.                                                      26690000
267000                                                                  26700000
267100******************************************************************26710038
267200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *26720000
267300******************************************************************26730038
267400 4420-FORMAT-LIST-LINES.                                          26740000
267500                                                                  26750038
267600     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       26760050
267700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                26770000
267800         MOVE SPACE              TO MR-DATE       (PV-SUB)        26780042
267900                                    MR-TIME       (PV-SUB)        26790042
268000                                    MR-PROCESS    (PV-SUB)        26800042
268100                                    MR-USERID     (PV-SUB)        26810042
268200                                    MR-AI         (PV-SUB)        26820042
268300                                    MR-MASTER     (PV-SUB)        26830042
268400          MOVE ZEROES            TO MR-LOC        (PV-SUB)        26840044
268500                                    MR-DEST       (PV-SUB)        26850044
268600                                    MR-INBD-TRIP  (PV-SUB)        26860044
268700                                    MR-OUTBD-TRIP (PV-SUB)        26870044
268800     ELSE                                                         26880050
268900         IF DP030-SET-CURSOR-TRAILER                              26890050
269000             IF ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 26900050
269100                 > SPACE)                                         26910000
269200             OR (PV-SUB = 1))                                     26920050
269300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               26930000
269400                MOVE -1               TO ASTRTITL                 26940000
269500             END-IF                                               26950000
269600         END-IF                                                   26960000
269700                                                                  26970042
269800         MOVE ASC-CRE-FLOW-TMST(ASC-BLK-SUB ASC-ITEM-SUB)         26980090
269900                                      TO PV-DB2-DATE              26990042
270000         MOVE PV-DB2-YY               TO PV-DISPLAY2-YY           27000099
270100         MOVE PV-DB2-MM               TO PV-DISPLAY2-MM           27010099
270200         MOVE PV-DB2-DD               TO PV-DISPLAY2-DD           27020099
270300         MOVE PC-SLASH                TO PV-SLASH2-1              27030099
270400                                         PV-SLASH2-2              27040099
270500         MOVE PV-DATE-DISPLAY2        TO MR-DATE(PV-SUB)          27050099
270600                                                                  27060089
270700         MOVE PC-COLON                TO PV-COLON                 27070089
270800         MOVE PV-TIME                 TO MR-TIME(PV-SUB)          27080042
270900                                                                  27090042
271000         MOVE ASC-LOC-NBR(ASC-BLK-SUB ASC-ITEM-SUB)               27100042
271100                                      TO MR-LOC(PV-SUB)           27110042
271200         MOVE ASC-PROCESS-SCAN-CDE(ASC-BLK-SUB ASC-ITEM-SUB)      27120042
271300                                      TO MR-PROCESS(PV-SUB)       27130042
271400         MOVE ASC-CRE-USR-ID(ASC-BLK-SUB ASC-ITEM-SUB)            27140042
271500                                      TO MR-USERID(PV-SUB)        27150042
271600         IF ASC-ACTIVE-CODE(ASC-BLK-SUB ASC-ITEM-SUB) = PC-A      27160086
271700         OR ASC-ACTIVE-CODE(ASC-BLK-SUB ASC-ITEM-SUB) = PC-Y      27170086
271800            MOVE PC-A                 TO MR-AI(PV-SUB)            27180086
271900         ELSE                                                     27190086
272000            IF ASC-ACTIVE-CODE(ASC-BLK-SUB ASC-ITEM-SUB) = PC-N   27200086
272100               MOVE PC-I              TO MR-AI(PV-SUB)            27210086
272200            END-IF                                                27220086
272300         END-IF                                                   27230086
272400         MOVE ASC-INBND-TRIP-ID(ASC-BLK-SUB ASC-ITEM-SUB)         27240042
272500                                      TO MR-INBD-TRIP(PV-SUB)     27250042
272600         MOVE ASC-OTBND-TRIP-ID(ASC-BLK-SUB ASC-ITEM-SUB)         27260042
272700                                      TO MR-OUTBD-TRIP(PV-SUB)    27270042
272800         MOVE ASC-DEST(ASC-BLK-SUB ASC-ITEM-SUB)                  27280042
272900                                      TO MR-DEST(PV-SUB)          27290042
273000         MOVE ASC-MASTER-TYPE(ASC-BLK-SUB ASC-ITEM-SUB)           27300042
273100                                      TO MR-MASTER(PV-SUB)        27310042
273200     END-IF.                                                      27320000
273300                                                                  27330038
273400     SUBTRACT +1 FROM ASC-ITEM-SUB                                27340000
273500     IF  ASC-ITEM-SUB < + 1                                       27350000
273600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  27360000
273700         MOVE +1                 TO ASC-BLK-SUB                   27370000
273800     END-IF.                                                      27380000
273900                                                                  27390000
274000******************************************************************27400000
274100** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **27410000
274200** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **27420000
274300** ISSUE A WARNING.                                             **27430000
274400******************************************************************27440000
274500 4430-CHECK-FOR-BEGIN-AND-END.                                    27450000
274600                                                                  27460038
274700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       27470000
274800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     27480000
274900*            -- NO END-OF-RANGE SPECFIED ---                      27490000
275000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            27500000
275100             SET DP020-MSG-WARNING TO TRUE                        27510000
275200             PERFORM 4431-POSITION-AT-WARNING                     27520000
275300         END-IF                                                   27530000
275400     ELSE                                                         27540000
275500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     27550000
275600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                27560000
275700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            27570000
275800             SET DP020-MSG-WARNING TO TRUE                        27580000
275900             PERFORM 4431-POSITION-AT-WARNING                     27590000
276000         END-IF                                                   27600000
276100     END-IF.                                                      27610000
276200                                                                  27620038
276300******************************************************************27630000
276400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **27640000
276500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **27650000
276600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **27660000
276700** POSITION THE CURSOR THERE.                                   **27670000
276800******************************************************************27680000
276900 4431-POSITION-AT-WARNING.                                        27690000
277000                                                                  27700038
277100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 27710000
277200                    - PV-TOP-ITEM + 1.                            27720000
277300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27730000
277400         CONTINUE                                                 27740000
277500     ELSE                                                         27750000
277600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      27760000
277700         MOVE -1                    TO ASTRTITL                   27770000
277800     END-IF.                                                      27780000
277900                                                                  27790038
278000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   27800000
278100                    - PV-TOP-ITEM + 1.                            27810000
278200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27820000
278300         CONTINUE                                                 27830000
278400     ELSE                                                         27840000
278500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      27850000
278600         MOVE -1                   TO ASTRTITL                    27860000
278700     END-IF.                                                      27870000
278800                                                                  27880000
278900******************************************************************27890038
279000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *27900000
279100* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *27910000
279200* FOR THE SELECTED ITEMS QUEUE.                                  *27920000
279300*                                                                *27930000
279400* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *27940000
279500* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *27950000
279600* THE ARRAY IS FULL.                                             *27960000
279700******************************************************************27970038
279800 5000-PREPARE-SEL-QUEUE.                                          27980000
279900                                                                  27990000
280000     MOVE +1                   TO  ASC-BLK-SUB.                   28000000
280100     PERFORM 5100-WRITE-TEMP-STORAGE.                             28010000
280200     ADD +1                    TO  ASC-BLK-SUB.                   28020000
280300     PERFORM 5100-WRITE-TEMP-STORAGE.                             28030000
280400                                                                  28040000
280500     MOVE ASC-SEL-QUEUE-NAME-OUT TO  SU009-SEL-QUEUE-NAME.        28050000
280600     PERFORM 6010-DELETE-SEL-QUEUE.                               28060000
280700                                                                  28070000
280800     SET ASC-UPDATE-TSQ        TO  TRUE.                          28080000
280900                                                                  28090000
281000     SET SU010-IDX             TO  1.                             28100000
281100     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       28110000
281200     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        28120000
281300                                                                  28130000
281400     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           28140000
281500             VARYING PV-ITEM                                      28150000
281600             FROM 1 BY 1                                          28160000
281700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     28170000
281800                                                                  28180000
281900     IF  SU010-IDX > 1                                            28190000
282000         PERFORM 5205-WRITE-SEL-QUEUE                             28200000
282100         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        28210000
282200     END-IF.                                                      28220000
282300                                                                  28230038
282400******************************************************************28240038
282500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *28250000
282600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *28260000
282700******************************************************************28270038
282800 5100-WRITE-TEMP-STORAGE.                                         28280000
282900                                                                  28290038
283000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     28300000
283100                                   TO PV-LIST-ITEM-NUMBER.        28310000
283200     COMPUTE PV-BLOCK-NUMBER =                                    28320000
283300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    28330000
283400                                                                  28340000
283500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             28350000
283600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             28360000
283700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      28370000
283800             PERFORM 5105-REWRITE-ASC-LISTQ                       28380000
283900         END-IF                                                   28390000
284000     ELSE                                                         28400000
284100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       28410000
284200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            28420000
284300         PERFORM 5110-WRITE-ASC-LISTQ                             28430000
284400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   28440000
284500     END-IF.                                                      28450000
284600                                                                  28460000
284700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28470000
284800                                                                  28480000
284900******************************************************************28490000
285000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **28500000
285100** SPECIFIC COMMAREA.                                           **28510000
285200******************************************************************28520000
285300 5105-REWRITE-ASC-LISTQ.                                          28530000
285400                                                                  28540038
285500     EXEC CICS                                                    28550000
285600         WRITEQ TS                                                28560000
285700             QUEUE (ASC-LIST-QUEUE-NAME)                          28570000
285800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28580000
285900             ITEM  (PV-BLOCK-NUMBER)                              28590000
286000             REWRITE                                              28600000
286100             RESP  (PV-CICS-RESP)                                 28610000
286200     END-EXEC.                                                    28620000
286300                                                                  28630000
286400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           28640000
286500         CONTINUE                                                 28650000
286600                                                                  28660038
286700     ELSE                                                         28670000
286800         SET DP013-CICS-ABEND            TO TRUE                  28680000
286900         SET DP013-NO-ROLLBACK           TO TRUE                  28690000
287000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       28700000
287100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     28710000
287200                                         TO DP013-MESSAGE-TEXT(1) 28720000
287300         PERFORM DP013-0000-PROCESS-ABEND                         28730000
287400     END-IF.                                                      28740000
287500                                                                  28750000
287600******************************************************************28760000
287700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **28770000
287800** SPECIFIC COMMAREA.                                           **28780000
287900******************************************************************28790000
288000 5110-WRITE-ASC-LISTQ.                                            28800000
288100                                                                  28810038
288200     EXEC CICS                                                    28820000
288300         WRITEQ TS                                                28830000
288400             QUEUE (ASC-LIST-QUEUE-NAME)                          28840000
288500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28850000
288600             ITEM  (PV-BLOCK-NUMBER)                              28860000
288700             RESP  (PV-CICS-RESP)                                 28870000
288800     END-EXEC.                                                    28880000
288900                                                                  28890047
289000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      28900000
289100         SET DP013-CICS-ABEND      TO TRUE                        28910000
289200         SET DP013-NO-ROLLBACK     TO TRUE                        28920000
289300         MOVE '5110-WRITE-ASC-LISTQ'                              28930000
289400                                   TO DP013-PARAGRAPH             28940000
289500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           28950000
289600                                   TO DP013-MESSAGE-TEXT(1)       28960000
289700         PERFORM DP013-0000-PROCESS-ABEND                         28970000
289800     END-IF.                                                      28980000
289900                                                                  28990000
290000******************************************************************29000038
290100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *29010000
290200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *29020000
290300******************************************************************29030038
290400 5200-FILL-SEL-QUEUE-RECORD.                                      29040000
290500                                                                  29050000
290600     PERFORM 6112-READ-LIST-QUEUE.                                29060000
290700                                                                  29070000
290800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       29080000
290900         PERFORM                                                  29090000
291000         VARYING LQW-IDX                                          29100000
291100         FROM 1 BY 1                                              29110000
291200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            29120000
291300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          29130000
291400                                                                  29140000
291500             IF  LQW-SELECT (LQW-IDX)                             29150000
291600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              29160000
291700                                   TO SU010-ITEM (SU010-IDX)      29170000
291800                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 29180000
291900                                                                  29190000
292000                 SET SU010-IDX UP BY 1                            29200000
292100                 IF  SU010-IDX > SU010-MAX-ITEMS                  29210000
292200                     PERFORM 5205-WRITE-SEL-QUEUE                 29220000
292300                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    29230000
292400                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         29240000
292500                     SET SU010-IDX TO  1                          29250000
292600                 END-IF                                           29260000
292700             END-IF                                               29270000
292800         END-PERFORM                                              29280000
292900     END-IF.                                                      29290000
293000                                                                  29300000
293100******************************************************************29310038
293200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *29320000
293300******************************************************************29330038
293400 5205-WRITE-SEL-QUEUE.                                            29340000
293500                                                                  29350000
293600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            29360000
293700                                   TO SU010-SELECTED-ITEMS.       29370000
293800                                                                  29380000
293900     EXEC CICS                                                    29390000
294000          WRITEQ TS                                               29400000
294100              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      29410000
294200              FROM  (SU010-SELECT-RECORD)                         29420000
294300              ITEM  (PV-SEL-QUEUE-ITEM)                           29430000
294400              RESP  (PV-CICS-RESP)                                29440000
294500     END-EXEC.                                                    29450000
294600                                                                  29460000
294700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29470000
294800         CONTINUE                                                 29480000
294900                                                                  29490038
295000     ELSE                                                         29500000
295100         SET DP013-CICS-ABEND      TO TRUE                        29510000
295200         SET DP013-NO-ROLLBACK     TO TRUE                        29520000
295300         MOVE '5205-WRITE-SEL-QUEUE'                              29530000
295400                                   TO DP013-PARAGRAPH             29540000
295500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          29550000
295600                                   TO DP013-MESSAGE-TEXT(1)       29560000
295700         PERFORM DP013-0000-PROCESS-ABEND                         29570000
295800     END-IF.                                                      29580000
295900                                                                  29590038
296000******************************************************************29600000
296100** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **29610000
296200** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **29620000
296300** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **29630000
296400** THE USER.                                                    **29640000
296500******************************************************************29650000
296600 6000-REFRESH-PANEL-FROM-TEMP.                                    29660000
296700                                                                  29670038
296800     IF  ASC-UPDATE-TSQ                                           29680000
296900         SET ASC-NO-TSQ-UPDATE TO TRUE                            29690000
297000         MOVE ZERO                 TO PV-SAVE-ITEM                29700000
297100                                      PV-SEL-QUEUE-ITEM           29710000
297200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        29720000
297300                                   TO PV-HOLD-SELECTED-ITEMS      29730000
297400         MOVE +1                   TO PV-ITEMS-PROCESSED          29740000
297500         PERFORM 6100-UPDATE-TSQ                                  29750000
297600             UNTIL PV-ITEMS-PROCESSED >                           29760000
297700                                     PV-HOLD-SELECTED-ITEMS       29770000
297800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         29780000
297900                    ASC-BLOCK-ENTRIES (2)                         29790000
298000     END-IF.                                                      29800000
298100                                                                  29810000
298200******************************************************************29820038
298300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *29830000
298400******************************************************************29840038
298500 6010-DELETE-SEL-QUEUE.                                           29850000
298600                                                                  29860000
298700     EXEC CICS                                                    29870000
298800         DELETEQ TS                                               29880000
298900             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       29890000
299000             RESP  (PV-CICS-RESP)                                 29900000
299100     END-EXEC.                                                    29910000
299200                                                                  29920038
299300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      29930000
299400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         29940000
299500         CONTINUE                                                 29950000
299600                                                                  29960038
299700     ELSE                                                         29970000
299800         SET DP013-CICS-ABEND TO TRUE                             29980000
299900         SET DP013-NO-ROLLBACK TO TRUE                            29990000
300000         MOVE '6010-DELETE-SEL-QUEUE'                             30000000
300100                        TO DP013-PARAGRAPH                        30010000
300200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         30020000
300300                        TO DP013-MESSAGE-TEXT (1)                 30030000
300400         PERFORM DP013-0000-PROCESS-ABEND                         30040000
300500     END-IF.                                                      30050000
300600                                                                  30060000
300700******************************************************************30070038
300800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *30080000
300900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *30090000
301000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *30100000
301100*    THE TEMP QUEUE.                                             *30110000
301200******************************************************************30120038
301300 6100-UPDATE-TSQ.                                                 30130000
301400                                                                  30140000
301500     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             30150000
301600     PERFORM 6150-READ-SEL-QUEUE.                                 30160000
301700                                                                  30170047
301800     PERFORM                                                      30180000
301900         VARYING SU010-IDX                                        30190000
302000         FROM 1 BY 1                                              30200000
302100         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     30210000
302200         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             30220000
302300         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  30230000
302400             PERFORM 6110-PROCESS-ITEMS                           30240000
302500         END-IF                                                   30250000
302600         ADD +1                TO PV-ITEMS-PROCESSED              30260000
302700     END-PERFORM.                                                 30270000
302800                                                                  30280047
302900     PERFORM 6111-WRITE-LIST-QUEUE.                               30290000
303000                                                                  30300000
303100******************************************************************30310038
303200*    READ THE LIST QUEUE RECORD.                                 *30320000
303300******************************************************************30330038
303400 6150-READ-SEL-QUEUE.                                             30340000
303500                                                                  30350000
303600     EXEC CICS                                                    30360000
303700          READQ TS                                                30370000
303800              QUEUE (ASC-SEL-QUEUE-NAME-IN)                       30380000
303900              INTO  (SU010-SELECT-RECORD)                         30390000
304000              ITEM  (PV-SEL-QUEUE-ITEM)                           30400000
304100              RESP  (PV-CICS-RESP)                                30410000
304200     END-EXEC.                                                    30420000
304300                                                                  30430038
304400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          30440000
304500         CONTINUE                                                 30450000
304600                                                                  30460038
304700     ELSE                                                         30470000
304800         SET DP013-CICS-ABEND      TO  TRUE                       30480000
304900         SET DP013-NO-ROLLBACK     TO  TRUE                       30490000
305000         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           30500000
305100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           30510000
305200                                   TO  DP013-MESSAGE-TEXT(1)      30520000
305300         PERFORM DP013-0000-PROCESS-ABEND                         30530000
305400     END-IF.                                                      30540000
305500                                                                  30550000
305600******************************************************************30560038
305700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*30570000
305800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*30580000
305900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *30590000
306000******************************************************************30600038
306100 6110-PROCESS-ITEMS.                                              30610000
306200                                                                  30620000
306300     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          30630000
306400                     / PC-ITEMS-PER-PANEL).                       30640000
306500                                                                  30650000
306600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           30660000
306700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          30670000
306800             PERFORM 6111-WRITE-LIST-QUEUE                        30680000
306900         END-IF                                                   30690000
307000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    30700000
307100                                                                  30710000
307200         PERFORM 6112-READ-LIST-QUEUE                             30720000
307300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               30730000
307400             CONTINUE                                             30740000
307500         END-IF                                                   30750000
307600     END-IF.                                                      30760000
307700                                                                  30770000
307800     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     30780000
307900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              30790000
308000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         30800000
308100     MOVE LQW-SELECTED-SW (PV-SUB)                                30810000
308200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  30820000
308300                                                                  30830000
308400     EVALUATE TRUE                                                30840000
308500         WHEN SU010-INQ (SU010-IDX)                               30850000
308600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             30860000
308700                                                                  30870000
308800         WHEN SU010-UPD (SU010-IDX)                               30880000
308900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             30890000
309000                                                                  30900000
309100         WHEN SU010-DEL (SU010-IDX)                               30910000
309200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             30920000
309300                                                                  30930000
309400         WHEN SU010-ERR (SU010-IDX)                               30940000
309500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             30950000
309600     END-EVALUATE.                                                30960000
309700                                                                  30970000
309800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                30980000
309900                                                                  30990000
310000******************************************************************31000038
310100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *31010000
310200******************************************************************31020038
310300 6111-WRITE-LIST-QUEUE.                                           31030000
310400                                                                  31040000
310500     EXEC CICS                                                    31050000
310600         WRITEQ TS                                                31060000
310700             QUEUE (ASC-LIST-QUEUE-NAME)                          31070000
310800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     31080000
310900             ITEM  (PV-SAVE-ITEM)                                 31090000
311000             REWRITE                                              31100000
311100             RESP  (PV-CICS-RESP)                                 31110000
311200     END-EXEC.                                                    31120000
311300                                                                  31130038
311400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31140000
311500         CONTINUE                                                 31150000
311600                                                                  31160038
311700     ELSE                                                         31170000
311800         SET DP013-CICS-ABEND  TO  TRUE                           31180000
311900         SET DP013-NO-ROLLBACK TO  TRUE                           31190000
312000         MOVE '6111-WRITE-LIST-QUEUE'                             31200000
312100                               TO  DP013-PARAGRAPH                31210000
312200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  31220000
312300                               TO  DP013-MESSAGE-TEXT(1)          31230000
312400         PERFORM DP013-0000-PROCESS-ABEND                         31240000
312500     END-IF.                                                      31250000
312600                                                                  31260000
312700******************************************************************31270038
312800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*31280000
312900******************************************************************31290038
313000 6112-READ-LIST-QUEUE.                                            31300000
313100                                                                  31310000
313200     EXEC CICS                                                    31320000
313300         READQ TS                                                 31330000
313400             QUEUE (ASC-LIST-QUEUE-NAME)                          31340000
313500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     31350000
313600             ITEM  (PV-ITEM)                                      31360000
313700             RESP  (PV-CICS-RESP)                                 31370000
313800     END-EXEC.                                                    31380000
313900                                                                  31390038
314000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31400000
314100         CONTINUE                                                 31410000
314200                                                                  31420038
314300     ELSE                                                         31430000
314400         SET DP013-CICS-ABEND        TO TRUE                      31440000
314500         SET DP013-NO-ROLLBACK       TO TRUE                      31450000
314600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           31460000
314700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    31470000
314800                                     TO DP013-MESSAGE-TEXT(1)     31480000
314900         PERFORM DP013-0000-PROCESS-ABEND                         31490000
315000     END-IF.                                                      31500000
315100                                                                  31510000
315200******************************************************************31520038
315300 8000-WRITE-CSSL.                                                 31530000
315400                                                                  31540000
315500     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      31550047
315600                                                                  31560047
315700     EXEC CICS                                                    31570000
315800         WRITEQ TD                                                31580000
315900         QUEUE  ('CSSL')                                          31590000
316000         FROM  (PV-CICS-MSG-AREA)                                 31600000
316100         LENGTH  (PV-COMMAREA-LENGTH)                             31610000
316200         RESP  (PV-CICS-RESP)                                     31620000
316300     END-EXEC.                                                    31630000
316400                                                                  31640038
316500******************************************************************31650038
316600*  READ THE LIST QUEUE RECORD                                     31660000
316700******************************************************************31670038
316800 9100-READ-SEL-QUEUE.                                             31680000
316900                                                                  31690000
317000     EXEC CICS                                                    31700000
317100         READQ TS                                                 31710000
317200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        31720000
317300             INTO  (SU010-SELECT-RECORD)                          31730000
317400             ITEM  (ASC-SEL-ITEM)                                 31740000
317500             RESP  (PV-CICS-RESP)                                 31750000
317600     END-EXEC.                                                    31760000
317700                                                                  31770038
317800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        31780000
317900         CONTINUE                                                 31790000
318000                                                                  31800038
318100     ELSE                                                         31810000
318200         SET DP013-LOGIC-ABEND                                    31820000
318300             DP013-NO-ROLLBACK   TO   TRUE                        31830000
318400         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          31840000
318500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   31850000
318600                                 TO   DP013-MESSAGE-TEXT (1)      31860000
318700         PERFORM DP013-0000-PROCESS-ABEND                         31870000
318800     END-IF.                                                      31880000
318900                                                                  31890000
319000******************************************************************31900038
319100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *31910000
319200******************************************************************31920038
319300 9200-REWRITE-SEL-QUEUE.                                          31930000
319400                                                                  31940000
319500     EXEC CICS                                                    31950000
319600          WRITEQ TS                                               31960000
319700              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      31970000
319800              FROM   (SU010-SELECT-RECORD)                        31980000
319900              ITEM   (ASC-SEL-ITEM)                               31990000
320000              RESP   (PV-CICS-RESP)                               32000000
320100              REWRITE                                             32010000
320200     END-EXEC.                                                    32020000
320300                                                                  32030000
320400     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   32040000
320500         SET DP013-CICS-ABEND                                     32050000
320600             DP013-NO-ROLLBACK     TO TRUE                        32060000
320700         MOVE '9200-REWRITE-SEL-QUEUE'                            32070000
320800                                   TO DP013-PARAGRAPH             32080000
320900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   32090000
321000                                   TO DP013-MESSAGE-TEXT (1)      32100000
321100         PERFORM DP013-0000-PROCESS-ABEND                         32110000
321200     END-IF.                                                      32120000
321300                                                                  32130000
321400******************************************************************32140038
321500*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *32150000
321600*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *32160000
321700******************************************************************32170038
321800 9900-SOFT-ABORT.                                                 32180000
321900                                                                  32190000
322000     EXEC CICS SYNCPOINT                                          32200000
322100          ROLLBACK                                                32210000
322200     END-EXEC.                                                    32220000
322300                                                                  32230000
322400     SET  PS-ERROR                                                32240000
322500          PS-SOFT-ABORT-ERROR                                     32250000
322600          DP020-MSG-FATAL       TO  TRUE.                         32260000
322700                                                                  32270000
322800******************************************************************32280038
322900 9904-WRITE-CRTN-MODULE-MSG.                                      32290000
323000                                                                  32300000
323100     MOVE '1101'                      TO  PV-CTN-PARA             32310047
323200     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          32320000
323300     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           32330000
323400     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        32340000
323500     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      32350000
323600     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             32360000
323700     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        32370000
323800     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      32380000
323900                                                                  32390000
324000     EXEC CICS                                                    32400000
324100         WRITEQ TD                                                32410000
324200             QUEUE ('CSSL')                                       32420050
324300             FROM  (PV-CARTON-MSG)                                32430050
324400             RESP  (PV-CICS-RESPONSE)                             32440050
324500     END-EXEC.                                                    32450000
324600                                                                  32460000
324700     EXEC CICS                                                    32470000
324800         WRITEQ TD                                                32480000
324900             QUEUE  ('CSSL')                                      32490000
325000             FROM   (PC046-CRA-RET-MSG)                           32500000
325100             RESP   (PV-CICS-RESPONSE)                            32510000
325200     END-EXEC.                                                    32520000
325300                                                                  32530000
325400******************************************************************32540038
325500*    ABEND PROCESSOR MODULE                                      *32550000
325600******************************************************************32560038
325700     COPY DPPD013.                                                32570000
325800                                                                  32580038
