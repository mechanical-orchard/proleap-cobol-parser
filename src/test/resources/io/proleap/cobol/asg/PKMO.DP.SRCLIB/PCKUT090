000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             PCKUT090.                                00040000
000500 AUTHOR.                 GERMAN BANDA.                            00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            NOV, 2009.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000* THIS PROGRAM WILL DETERMINE IF A CARTON NEED TO BE AUDITED      00100000
001100* USING THE PARAMETERS SET UP FOR THE VENDOR.                     00110000
001200******************************************************************00120000
001500*    CHANGES                                                     *00130000
      *    MADE BY: SHOBHIT BAIJAL       PR#5148D                      *00140000
      *    DATE:    01/10/2014                                         *00150000
      *                                                                *00160000
      *    CHANGES DONE TO IDENTIFY IF RFID AUDITS NEED TO BE DONE FOR *00170000
      *    THE PO. CHANGES CAN BE FOUND WITH *SB 01/10/14              *00180000
001200******************************************************************00190000
001300 ENVIRONMENT DIVISION.                                            00200000
001400 DATA DIVISION.                                                   00210000
001500******************************************************************00220000
001600 WORKING-STORAGE SECTION.                                         00230000
001700                                                                  00240000
001800 01  DK-DB2-KEYS.                                                 00250000
001900     05  DK-PO-NBR                PIC S9(09)  COMP.               00260000
002000     05  DK-PO-LINE-NBR           PIC S9(09)  COMP.               00270000
002100     05  DK-PO-DRIVER-LINE        PIC S9(09)  COMP.               00280000
002200     05  DK-SHUUPC-LNE-NBR        PIC S9(09)  COMP.               00290000
002300     05  DK-PREPK-ID              PIC S9(04)  COMP.               00300000
002400     05  DK-OPER-UNT-ID           PIC S9(04)  COMP.               00310000
002500     05  DK-INBND-TRIP-ID         PIC S9(09)  COMP.               00320000
002600     05  DK-RCVR-SEQ-NBR          PIC S9(09)  COMP.               00330000
002700     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00340000
002800     05  DK-ENT-ID                PIC S9(09)  COMP.               00350000
002900     05  DK-DEPT-NBR              PIC S9(04)  COMP-4.             00360000
003000     05  DK-PKGNG-TYP-CDE         PIC  X(02).                     00370000
003100     05  DK-AUDIT-CNTL-NBR        PIC S9(09) COMP.                00380000
003200                                                                  00390000
003300 01  DN-DB2-NULL-INDICATORS.                                      00400000
003400     05  DN-SUM-NULL                PIC S9(04) COMP VALUE ZEROES. 00410000
003500     05  DN-SUM-NULL-UPC            PIC S9(04) COMP VALUE ZEROES. 00420000
003600*                                                                 00430000
003700******************************************************************00440000
003800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00450000
003900******************************************************************00460000
004000     COPY DPWS013.                                                00470000
004100                                                                  00480000
004200*----------------------------------------------------------------*00490000
004300*  PROGRAM CONSTANTS                                             *00500000
004400*----------------------------------------------------------------*00510000
004500 01  PC-PROGRAM-CONSTANTS.                                        00520000
004600     05  PC-F                     PIC  X(01)  VALUE 'F'.          00530000
004700     05  PC-P                     PIC  X(01)  VALUE 'P'.          00540000
004800     05  PC-I                     PIC  X(01)  VALUE 'I'.          00550000
004900     05  PC-N                     PIC  X(01)  VALUE 'N'.          00560000
005000     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00570000
005100     05  PC-A                     PIC  X(01)  VALUE 'A'.          00580000
005200     05  PC-D                     PIC  X(01)  VALUE 'D'.          00590000
005300     05  PC-C                     PIC  X(01)  VALUE 'C'.          00600000
005400     05  PC-IP                    PIC  X(02)  VALUE 'IP'.         00610000
005500     05  PC-02                    PIC  X(02)  VALUE '02'.         00620000
005600     05  PC-DEFAULT               PIC  X(06)  VALUE 'DEFALT'.     00630000
005700     05  PC-DEFAULT-DATE          PIC  X(26)  VALUE               00640000
005800                                  '9999-09-09-09.09.09.999999'.   00650000
005900     05  PC-RANDOM-NBR-GENERATOR  PIC  X(08)  VALUE 'DPKUT902'.   00660000
006000     05  PC-LOG-QUEUE             PIC  X(04)  VALUE 'CSSL'.       00670000
006100     05  PC-MSG-TABLE-SIZE            PIC S9(03) COMP-3 VALUE 200.00680000
006200     05  PC-100                       PIC  9(03)V99     VALUE 100.00690000
006300     05  PC-LOGON-TRAN-ID                PIC  X(04)  VALUE 'Z028'.00700000
      *SB 01/10/14 - BEGIN PR#5148D                                     00710000
005400     05  PC-RF                    PIC  X(02)  VALUE 'RF'.         00720000
005400     05  PC-Q                     PIC  X(02)  VALUE 'Q'.          00730000
005400     05  PC-R                     PIC  X(02)  VALUE 'R'.          00740000
      *SB 01/10/14 - END PR#5148D                                       00750000
006400                                                                  00760000
006500*----------------------------------------------------------------*00770000
006600*  PROGRAM SWITCHES                                              *00780000
006700*----------------------------------------------------------------*00790000
006800 01  PS-PROGRAM-SWITCHES.                                         00800000
006900     05  PS-CARTON-ALREADY-EXISTS-SW     PIC  X(01)  VALUE 'N'.   00810000
007000         88  PS-CARTON-ALREADY-EXISTS                VALUE 'Y'.   00820000
007100         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   00830000
007200     05  PS-REQ-REC-FOUND-SW             PIC  X(01)  VALUE 'N'.   00840000
007300         88  PS-REQ-REC-FOUND                        VALUE 'Y'.   00850000
007400         88  PS-NO-REQ-REC-FOUND                     VALUE 'N'.   00860000
007500     05  PS-NO-AUDIT-STARTED-SW          PIC  X(01)  VALUE 'N'.   00870000
007600         88  PS-AUDIT-STARTED                        VALUE 'Y'.   00880000
007700         88  PS-NO-AUDIT-STARTED                     VALUE 'N'.   00890000
007800     05  PS-DEPT-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   00900000
007900         88  PS-DEPT-RANK-FOUND                      VALUE 'Y'.   00910000
008000         88  PS-NO-DEPT-RANK-FOUND                   VALUE 'N'.   00920000
008100     05  PS-PASSED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   00930000
008200         88  PS-PASSED-AUDITS-FOUND                  VALUE 'Y'.   00940000
008300         88  PS-NO-PASSED-AUDITS-FOUND               VALUE 'N'.   00950000
008400     05  PS-FAILED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   00960000
008500         88  PS-FAILED-AUDITS-FOUND                  VALUE 'Y'.   00970000
008600         88  PS-NO-FAILED-AUDITS-FOUND               VALUE 'N'.   00980000
008700     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   00990000
008800         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   01000000
008900         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   01010000
009000     05  PS-VEND-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   01020000
009100         88  PS-VEND-RANK-FOUND                      VALUE 'Y'.   01030000
009200         88  PS-NO-VEND-RANK-FOUND                   VALUE 'N'.   01040000
009300     05  PS-DEFAULT-RANK-FOUND-SW        PIC  X(01)  VALUE 'N'.   01050000
009400         88  PS-DEFAULT-RANK-FOUND                   VALUE 'Y'.   01060000
009500         88  PS-NO-DEFAULT-RANK-FOUND                VALUE 'N'.   01070000
009600     05  PS-PO-INFO-FOUND-SW             PIC  X(01)  VALUE 'N'.   01080000
009700         88  PS-PO-INFO-FOUND                        VALUE 'Y'.   01090000
009800         88  PS-NO-PO-INFO-FOUND                     VALUE 'N'.   01100000
009900     05  PS-LINE-LEVEL-FOUND-SW          PIC  X(01)  VALUE 'N'.   01110000
010000         88  PS-LINE-LEVEL-FOUND                     VALUE 'Y'.   01120000
010100         88  PS-NO-LINE-LEVEL-FOUND                  VALUE 'N'.   01130000
010200     05  PS-PO-LEVEL-FOUND-SW            PIC  X(01)  VALUE 'N'.   01140000
010300         88  PS-PO-LEVEL-FOUND                       VALUE 'Y'.   01150000
010400         88  PS-NO-PO-LEVEL-FOUND                    VALUE 'N'.   01160000
010500     05  PS-AUDIT-IS-REQUIRED-SW         PIC  X(01)  VALUE 'N'.   01170000
010600         88  PS-AUDIT-IS-REQUIRED                    VALUE 'Y'.   01180000
010700         88  PS-AUDIT-IS-NOT-REQUIRED                VALUE 'N'.   01190000
010710     05  PS-TDISTHD-FOUND-SW             PIC  X(01)  VALUE 'N'.   01200000
010720         88  PS-TDISTHD-FOUND-YES                    VALUE 'Y'.   01210000
010730         88  PS-TDISTHD-FOUND-NO                     VALUE 'N'.   01220000
010800     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01230000
010900         88  PS-ERROR                                VALUE 'Y'.   01240000
011000         88  PS-ERROR-NO                             VALUE 'N'.   01250000
011100     05  PS-DUMP-TO-LOG-SW               PIC X(01)   VALUE 'N'.   01260000
011200         88  PS-DONT-DUMP-TO-LOG                     VALUE 'N'.   01270000
011300         88  PS-DUMP-TO-LOG                          VALUE 'Y'.   01280000
011400     05  PS-DB2-ABEND-SW                 PIC X(01)   VALUE 'N'.   01290000
011500         88  PS-DB2-ABEND                            VALUE 'Y'.   01300000
011600         88  PS-DB2-ABEND-NO                         VALUE 'N'.   01310000
      *SB 01/10/14 - BEGIN PR#5148D                                     01320000
007200     05  PS-AUDIT-TYPE-CHECK-SW          PIC  X(01)  VALUE 'Q'.   01330000
007300         88  PS-QC-AUDIT-CHECK                       VALUE 'Q'.   01340000
007400         88  PS-RFID-AUDIT-CHECK                     VALUE 'R'.   01350000
      *SB 01/10/14 - END PR#5148D                                       01360000
011700                                                                  01370000
011800*----------------------------------------------------------------*01380000
011900*  PROGRAM VARIABLES                                             *01390000
012000*----------------------------------------------------------------*01400000
012100 01  PV-PROGRAM-VARIABLES.                                        01410000
012200                                                                  01420000
012300     05  PV-DISPLAY-PO-NBR               PIC 9(09).               01430000
012400     05  PV-DISPLAY-PO-LINE-NBR          PIC 9(09).               01440000
012500     05  PV-DISPLAY-PREPK-ID             PIC 9(04).               01450000
012600     05  PV-DISPLAY-OPER-UNT-ID          PIC 9(04).               01460000
012700     05  PV-DISPLAY-INBND-TRIP-ID        PIC 9(09).               01470000
012800     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 9(09).               01480000
012900     05  PV-DISPLAY-SHIPT-UNT-ID         PIC 9(18).               01490000
013000     05  PV-DISPLAY-ENT-ID               PIC 9(09).               01500000
013100     05  PV-DISPLAY-DEPT-NBR             PIC 9(04).               01510000
013200     05  PV-DISPLAY-CK-AFT-DAY-QTY       PIC 9(04).               01520000
013300     05  PV-DISPLAY-LIMIT-DAYS           PIC 9(09).               01530000
013400     05  PV-DISPLAY-TASK                 PIC 9(07).               01540000
013500     05  PV-DISPLAY-MSG-NBR              PIC 9(03).               01550000
013600     05  PV-DISPLAY-SQLCODE              PIC 9(04).               01560000
013700     05  PV-PARAGRAPH                    PIC X(30).               01570000
013800     05  PV-MESSAGE-TEXT-1               PIC X(79).               01580000
013900     05  PV-MESSAGE-TEXT-2               PIC X(79).               01590000
014000     05  PV-MESSAGE-TEXT-3               PIC X(79).               01600000
014100     05  PV-MESSAGE-TEXT-4               PIC X(79).               01610000
014200     05  PV-DB2-TABLE-NAME-1             PIC X(18).               01620000
014300     05  PV-DB2-TABLE-NAME-2             PIC X(18).               01630000
014400     05  PV-DB2-TABLE-NAME-3             PIC X(18).               01640000
014500     05  PV-SQLCA                        PIC X(136).              01650000
014600                                                                  01660000
014700     05  PV-BTCH-MSG-AREA2               PIC  X(100) VALUE SPACES.01670000
014800                                                                  01680000
014900     05  PV-PASSED-COUNT                 PIC S9(4)  COMP.         01690000
015000     05  PV-PROMPTED-CNT                 PIC S9(4)  COMP.         01700000
015100     05  PV-DB2-COUNT-EXP-SCN            PIC S9(4)  VALUE +0      01710000
015200                                                    COMP.         01720000
015300     05  PV-CARTONS-TO-AUDIT             PIC S9(9)  VALUE +0      01730000
015400                                                    COMP.         01740000
015410     05  PV-CRTNS-TO-AUD-CALC            PIC S9(9)  VALUE +0      01750000
015420                                                    COMP.         01760000
015500     05  PV-UNITS-TO-AUDIT               PIC S9(9)  VALUE +0      01770000
015600                                                    COMP.         01780000
015700     05  PV-TOTAL-CARTONS                PIC S9(9)  VALUE +0      01790000
015800                                                    COMP.         01800000
015900     05  PV-CHECK-IN-COUNT               PIC S9(9)  VALUE +0      01810000
016000                                                    COMP.         01820000
016010     05  PV-AUDIT-FAIL-COUNT             PIC S9(9)  VALUE +0      01830000
016020                                                    COMP.         01840000
016100     05  PV-TOTAL-UNITS                  PIC S9(9)  VALUE +0      01850000
016200                                                    COMP.         01860000
016210     05  PV-OUTR-PK-QTY                  PIC S9(9)  VALUE +0      01870000
016220                                                    COMP.         01880000
016300     05  PV-SUM-EXPTD-ALLOC              PIC S9(9)  VALUE +0      01890000
016400                                                    COMP.         01900000
016500     05  PV-SUM-OF-ALL-LINES             PIC S9(9)  VALUE +0      01910000
016600                                                    COMP.         01920000
016700     05  PV-AUDIT-CNTL-NBR-X             PIC  X(09) VALUE SPACE.  01930000
016800     05  PV-AUDIT-CNTL-NBR  REDEFINES                             01940000
016900         PV-AUDIT-CNTL-NBR-X             PIC  9(09).              01950000
017000     05  PV-LIMIT-DAYS                   PIC S9(09) COMP.         01960000
017100     05  PV-SHPD-QTY-SUM                 PIC S9(09) COMP-3.       01970000
017200     05  PV-CARTON-COUNT                 PIC S9(09) COMP.         01980000
017300     05  PV-BTCH-MSG-AREA                PIC  X(80) VALUE SPACE.  01990000
017400     05  PV-CICS-RESPONSE                PIC S9(08) VALUE ZEROS   02000000
017500                                                    COMP SYNC.    02010000
017600     05  PV-EIBTASKN                     PIC Z(06)9.              02020000
017700     05  PV-PREV-SEQUENCE                PIC S9(05) COMP-3        02030000
017800                                                     VALUE ZERO.  02040000
017900     05  PV-NEXT-SEQUENCE                PIC S9(05) COMP-3        02050000
018000                                                     VALUE ZERO.  02060000
018100     05  PV-UNT-QTY                      PIC  9(05)V99.           02070000
018200     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 02080000
018300     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   02090000
018400                                                     COMP.        02100000
018500     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   02110000
018600                                                     COMP SYNC.   02120000
      *SB 01/10/14 - BEGIN PR#5148D                                     02130000
           05  PV-TEMP-PO-LINE-NBR             PIC S9(09)  COMP.        02140000
           05  PV-TEMP-PREPK-ID                PIC S9(04)  COMP.        02150000
      *SB 01/10/14 - END PR#5148D                                       02160000
018700/                                                                 02170000
018800*                                                                 02180000
018900     COPY DPWS026.                                                02190000
019000                                                                  02200000
019100*---------------------------------------------------------------* 02260000
019200*    DB2 AREA FOR THE PURCHASE TABLE                            * 02270000
019300*---------------------------------------------------------------* 02280000
019400     EXEC SQL                                                     02290000
019500          INCLUDE TPURCHS                                         02300000
019600     END-EXEC.                                                    02310000
019700*---------------------------------------------------------------* 02320000
019800*    DB2 AREA FOR SHIPMENT PO TABLE                             * 02330000
019900*---------------------------------------------------------------* 02340000
020000     EXEC SQL                                                     02350000
020100          INCLUDE TSHPTPO                                         02360000
020200     END-EXEC.                                                    02370000
020300*---------------------------------------------------------------* 02380000
020400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02390000
020500*  (TSHPUNT)                                                      02400000
020600*---------------------------------------------------------------* 02410000
020700     EXEC SQL                                                     02420000
020800         INCLUDE TSHPUNT                                          02430000
020900     END-EXEC.                                                    02440000
021000                                                                  02450000
021100*---------------------------------------------------------------* 02460000
021200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CARTON LOCATION    02470000
021300*  (TSHUNLO)                                                      02480000
021400*---------------------------------------------------------------* 02490000
021500     EXEC SQL                                                     02500000
021600         INCLUDE TSHUNLO                                          02510000
021700     END-EXEC.                                                    02520000
021800                                                                  02530000
021900*---------------------------------------------------------------* 02540000
022000*    DB2 AREA FOR THE INPKSU TABLE                                02550000
022100*---------------------------------------------------------------* 02560000
022200     EXEC SQL                                                     02570000
022300          INCLUDE TINPKSU                                         02580000
022400     END-EXEC.                                                    02590000
022500*---------------------------------------------------------------* 02600000
022600*    DB2 AREA FOR THE PACKSLIP TABLE                            * 02610000
022700*---------------------------------------------------------------* 02620000
022800     EXEC SQL                                                     02630000
022900          INCLUDE TPKSLIP                                         02640000
023000     END-EXEC.                                                    02650000
023100*---------------------------------------------------------------* 02660000
023200*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TABLE                 * 02670000
023300*---------------------------------------------------------------* 02680000
023400     EXEC SQL                                                     02690000
023500         INCLUDE TSUNAUD                                          02700000
023600     END-EXEC.                                                    02710000
023700*---------------------------------------------------------------* 02720000
023800*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TRANSACTION TABLE     * 02730000
023900*---------------------------------------------------------------* 02740000
024000     EXEC SQL                                                     02750000
024100         INCLUDE TSUATRN                                          02760000
024200     END-EXEC.                                                    02770000
024300*---------------------------------------------------------------* 02780000
024400*    DB2 AREA FOR THE PO AUDIT EXC TABLE (SUT_PO_AUD_EXC)       * 02790000
024500*---------------------------------------------------------------* 02800000
024600     EXEC SQL                                                     02810000
024700         INCLUDE SUT00014                                         02820000
024800     END-EXEC.                                                    02830000
024900*---------------------------------------------------------------* 02840000
025000*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 02850000
025100*---------------------------------------------------------------* 02860000
025200     EXEC SQL                                                     02870000
025300         INCLUDE SUT00015                                         02880000
025400     END-EXEC.                                                    02890000
025500*---------------------------------------------------------------* 02900000
025600*    DB2 AREA FOR THE VENDOR AUDIT PARM TABLE (SUT_PO_AUD_PARM) * 02910000
025700*---------------------------------------------------------------* 02920000
025800     EXEC SQL                                                     02930000
025900         INCLUDE SUT00017                                         02940000
026000     END-EXEC.                                                    02950000
026100*---------------------------------------------------------------* 02960000
026200*    DB2 AREA FOR THE VENDOR DEPT RANKING TBL (SUT_VND_DEPT_RNKG) 02970000
026300*---------------------------------------------------------------* 02980000
026400     EXEC SQL                                                     02990000
026500         INCLUDE SUT00018                                         03000000
026600     END-EXEC.                                                    03010000
026700*---------------------------------------------------------------* 03020000
026800*    DB2 AREA FOR THE VENDOR RANKING TABLE (SUT_VND_RNKG)       * 03030000
026900*---------------------------------------------------------------* 03040000
027000     EXEC SQL                                                     03050000
027100         INCLUDE SUT00019                                         03060000
027200     END-EXEC.                                                    03070000
027300*---------------------------------------------------------------* 03080000
027400*    DB2 AREA FOR THE DISTRIBUTION HEADER TABLE                 * 03090000
027500*---------------------------------------------------------------* 03100000
027600     EXEC SQL                                                     03110000
027700          INCLUDE TDISTHD                                         03120000
027800     END-EXEC.                                                    03130000
027900*---------------------------------------------------------------* 03140000
028000*    DB2 AREA FOR THE DISTRIBUTION DETAIL TABLE                 * 03150000
028100*---------------------------------------------------------------* 03160000
028200     EXEC SQL                                                     03170000
028300          INCLUDE TDISTDT                                         03180000
028400     END-EXEC.                                                    03190000
028500*---------------------------------------------------------------* 03200000
028600*    DB2 AREA FOR THE RECEIVER ITEM TABLE                       * 03210000
028700*---------------------------------------------------------------* 03220000
028800     EXEC SQL                                                     03230000
028900          INCLUDE TRECITM                                         03240000
029000     END-EXEC.                                                    03250000
029100*---------------------------------------------------------------* 03260000
029200*    DB2 AREA FOR THE PURCHASE ITEM TABLE                       * 03270000
029300*---------------------------------------------------------------* 03280000
029400     EXEC SQL                                                     03290000
029500          INCLUDE TPURITM                                         03300000
029600     END-EXEC.                                                    03310000
029700*---------------------------------------------------------------* 03320000
029800*    DB2 AREA FOR THE SHIPPING UPC TABLE                        * 03330000
029900*---------------------------------------------------------------* 03340000
030000     EXEC SQL                                                     03350000
030100          INCLUDE TSHUUPC                                         03360000
030200     END-EXEC.                                                    03370000
030300*---------------------------------------------------------------* 03380000
030400*    DB2 AREA FOR THE RECEIVING SYSTEM PARM TABLE               * 03390000
030500*---------------------------------------------------------------* 03400000
030600     EXEC SQL                                                     03410000
030700         INCLUDE TKRPRPM                                          03420000
030800     END-EXEC.                                                    03430000
030900*----------------------------------------------------------------*03440000
030910*---------------------------------------------------------------* 03450000
030920*    DB2 AREA FOR THE XL DOMAIN SKU TABLE                       * 03460000
030930*---------------------------------------------------------------* 03470000
030940     EXEC SQL                                                     03480000
030950         INCLUDE XLT00003                                         03490000
030960     END-EXEC.                                                    03500000
030970*----------------------------------------------------------------*03510000
031000*  COMMUNICATIONS AREA FOR DB2                                   *03520000
031100*----------------------------------------------------------------*03530000
031200     EXEC SQL                                                     03540000
031300         INCLUDE SQLCA                                            03550000
031400     END-EXEC.                                                    03560000
031500******************************************************************03570000
031600 LINKAGE SECTION.                                                 03580000
031700     COPY PCWS259.                                                03590000
031800/                                                                 03600000
031900 PROCEDURE DIVISION USING PC259-AUDIT-FIELDS.                     03610000
032000     SET PC259-SUCCESSFUL  TO TRUE                                03620000
032100     INITIALIZE  PV-PROGRAM-VARIABLES.                            03630000
032200     MOVE 'N' TO PS-CARTON-ALREADY-EXISTS-SW                      03640000
032300                 PS-REQ-REC-FOUND-SW                              03650000
032400                 PS-NO-AUDIT-STARTED-SW                           03660000
032500                 PS-DEPT-RANK-FOUND-SW                            03670000
032600                 PS-PASSED-AUDITS-FOUND-SW                        03680000
032700                 PS-FAILED-AUDITS-FOUND-SW                        03690000
032900                 PS-AUDIT-NBR-IND                                 03700000
033000                 PS-VEND-RANK-FOUND-SW                            03710000
033100                 PS-DEFAULT-RANK-FOUND-SW                         03720000
033200                 PS-PO-INFO-FOUND-SW                              03730000
033300                 PS-LINE-LEVEL-FOUND-SW                           03740000
033400                 PS-PO-LEVEL-FOUND-SW                             03750000
033500                 PS-AUDIT-IS-REQUIRED-SW                          03760000
033600                 PS-ERROR-SW                                      03770000
033700                 PS-DUMP-TO-LOG-SW                                03780000
033800                 PS-DB2-ABEND-SW.                                 03790000
033900     MOVE ' ' TO PC259-COMPLETED-AUDITS                           03800000
033910                 PC259-AUDIT-VALIDATION-SW                        03810000
034000     MOVE  PC259-OPER-UNT-ID      TO DK-OPER-UNT-ID.              03820000
034800     MOVE  PC259-PO-NUMBER        TO DK-PO-NBR.                   03830000
034100     PERFORM 1000-DETERMINE-IF-AUDIT-REQ.                         03910000
034300*                                                                 04630000
034400*-----------------------------------------------------------------04640000
034500*DETERMINE IF AN AUDIT IS NEEDED FOR THIS PO                      04650000
034600*-----------------------------------------------------------------04660000
034700 1000-DETERMINE-IF-AUDIT-REQ.                                     04670000
034800*    MOVE PC259-PO-NUMBER         TO DK-PO-NBR.                   04680000
034900     IF PC259-PKG-TYPE          = 'BC'                            04690000
035000         MOVE PC259-LINE-NBR          TO DK-PO-LINE-NBR           04700000
035100     ELSE                                                         04710000
035200         MOVE 0                       TO DK-PO-LINE-NBR           04720000
035300     END-IF.                                                      04730000
035400     IF PC259-PKG-TYPE       = 'PP'                               04740000
035500         MOVE PC259-PRE-PACK-ID       TO DK-PREPK-ID              04750000
035600     ELSE                                                         04760000
035700         MOVE 0                       TO DK-PREPK-ID              04770000
035800     END-IF.                                                      04780000
035900     MOVE PC259-REC-SEQ-NBR       TO DK-RCVR-SEQ-NBR.             04790000
036000     MOVE PC259-INBOUND-TRIP-ID   TO DK-INBND-TRIP-ID.            04800000
                                                                        04810000
      *SB 01/10/14 - BEGIN PR#5148D                                     04820000
           SET PS-QC-AUDIT-CHECK TO TRUE.                               04830000
      *SB 01/10/14 - END PR#5148D                                       04840000
                                                                        04850000
036100*  CHECK IF SUT_PO_AUD_REQ RECORDS EXIST                          04860000
036200     PERFORM 7000-SELECT-REQ-INFO.                                04870000
036300                                                                  04880000
036400     IF PS-REQ-REC-FOUND                                          04890000
036500         PERFORM 1100-RETREIVE-VENDOR-RANKING                     04900000
036600     END-IF.                                                      04910000
036700*   CHECK IF AUDIT IS ALREADY DONE                                04920000
036800     IF NOT PC259-DB2-ERROR AND                                   04930000
036900        PS-REQ-REC-FOUND AND                                      04940000
037000        (SUT00015-CART-PRMPT-CDE = 'D' OR                         04950000
037100         SUT00015-CART-PRMPT-CDE = 'F')                           04960000
037110                                                                  04970000
037120                                                                  04980000
037130* DMH  AUDIT DONE AND PASS DOES NOT GET AUDIT %                   04990000
037131* DMH  ADD PERFOR OF 7190 TO GET THE AUDIT PARM DATA              05000000
037132*                                                                 05010000
037140                                                                  05020000
037200         IF SUT00015-CART-PRMPT-CDE = 'D'                         05030000
037210             PERFORM 7190-RETREIVE-PO-AUD-PARM                    05040000
037300             IF SUT00015-AUD-STAT-CDE = 'P' OR                    05050000
037400                SUT00015-AUD-STAT-CDE = 'N'                       05060000
037500                 SET PC259-AUDIT-IS-COMPLETE TO TRUE              05070000
037600*                SET PC259-PASSED-AUDITS     TO TRUE              05080000
037700                 SET PC259-PASS-AUDIT-AT-DC  TO TRUE              05090000
037800             ELSE                                                 05100000
037900                 IF SUT00015-AUD-STAT-CDE = 'F'                   05110000
038000                     SET PC259-REWORK  TO TRUE                    05120000
038100                     SET PC259-FAILED-AUDITS TO TRUE              05130000
038200                 ELSE                                             05140000
038300***    SUT00015-AUD-STAT-CDE = 'PP'                               05150000
038400                     SET PC259-AUDIT-PENDING TO TRUE              05160000
      *SB 01/10/14 - BEGIN PR#5148D                                     05161000
                           MOVE SUT00015-CART-QTY TO                    05170000
                                PV-CARTONS-TO-AUDIT                     05180000
      *SB 01/10/14 - END PR#5148D                                       05181000
038500                 END-IF                                           05190000
038600             END-IF                                               05200000
038700         ELSE                                                     05210000
038800             SET PC259-REWORK TO TRUE                             05220000
038900             SET PC259-FAILED-AUDITS TO TRUE                      05230000
039000*                                                                 05240000
039100         END-IF                                                   05250000
039200     ELSE                                                         05260000
039300       IF NOT PC259-DB2-ERROR                                     05270000
039400*   IF NO SUT_PO_AUD_REQ FOUND, GET DEPT AND ENT-ID               05280000
039500         IF PS-NO-REQ-REC-FOUND                                   05290000
039600             PERFORM 7150-RETREIVE-PO-INFO                        05300000
039700             MOVE PURCHS-DEPT-NBR         TO DK-DEPT-NBR          05310000
039800             MOVE PURCHS-ENT-ID           TO DK-ENT-ID            05320000
039900         ELSE                                                     05330000
040000             MOVE SUT00015-DEPT-NBR       TO DK-DEPT-NBR          05340000
040100             MOVE SUT00015-ENT-ID         TO DK-ENT-ID            05350000
040200             SET PS-PO-INFO-FOUND TO TRUE                         05360000
040300         END-IF                                                   05370000
040400         IF PS-PO-INFO-FOUND                                      05380000
040500             IF PS-REQ-REC-FOUND                                  05390000
040600                PERFORM 7190-RETREIVE-PO-AUD-PARM                 05400000
040700             ELSE                                                 05410000
040800                PERFORM 1100-RETREIVE-VENDOR-RANKING              05420000
040900             END-IF                                               05430000
041000             PERFORM 1200-CHECK-PO-AUDIT-EXC                      05440000
041100             IF  SUT00017-AUD-PCT = 0   AND                       05450000
041200                 PS-NO-LINE-LEVEL-FOUND AND                       05460000
041300                 PS-NO-PO-LEVEL-FOUND                             05470000
041400                 IF PS-NO-REQ-REC-FOUND                           05480000
041500                     SET PC259-AUDIT-IS-COMPLETE TO TRUE          05490000
041600                 ELSE                                             05500000
      *SB 01/10/14 - BEGIN PR#5148D                                     05501000
                           PERFORM 1400-CHECK-FOR-IN-PROCES-AUDIT       05510000
      *SB 01/10/14 - END   PR#5148D                                     05511000
041700                     PERFORM 1430-DETERMINE-STAT-CDE              05520000
      *SB 01/10/14 - BEGIN PR#5148D                                     05521000
                           IF PS-AUDIT-STARTED                          05530000
                              MOVE SUT00015-CART-QTY TO                 05540000
                                   PV-CARTONS-TO-AUDIT                  05550000
                           ELSE                                         05560000
                              MOVE 0 TO PV-CARTONS-TO-AUDIT             05570000
                           END-IF                                       05580000
      *SB 01/10/14 - END   PR#5148D                                     05581000
041800                 END-IF                                           05590000
041900             ELSE                                                 05600000
042000               PERFORM 1400-CHECK-FOR-IN-PROCES-AUDIT             05610000
042100*   AUDIT HAS BEEN STARTED FOR THIS DC                            05620000
042200               IF PS-AUDIT-STARTED                                05630000
042300                 PERFORM 1430-DETERMINE-STAT-CDE                  05640000
      *SB 01/10/14 - BEGIN PR#5148D                                     05641000
                       MOVE SUT00015-CART-QTY TO                        05650000
                            PV-CARTONS-TO-AUDIT                         05660000
      *SB 01/10/14 - END   PR#5148D                                     05661000
042400               ELSE                                               05670000
042500                 PERFORM 7850-SELECT-DC-PASSED                    05680000
042600                 IF  PV-PASSED-COUNT > 0    AND                   05690000
042700                     PS-NO-LINE-LEVEL-FOUND AND                   05700000
042800                     PS-NO-PO-LEVEL-FOUND                         05710000
042900                     SET PC259-AUDIT-IS-COMPLETE TO TRUE          05720000
043000                     SET PC259-PASS-AUDIT-AT-DC TO TRUE           05730000
043100                 ELSE                                             05740000
043200*   NO RECORDS EXIST IN THE SUT_PO_AUD_EXC TABLE                  05750000
043300                   IF PS-NO-LINE-LEVEL-FOUND AND                  05760000
043400                      PS-NO-PO-LEVEL-FOUND                        05770000
043500                     PERFORM 1300-CHECK-PO-AUDIT-REQ              05780000
043600                     PERFORM 1410-CHECK-PROMPTED-LINES            05790000
043700*   SOME FAILED AUDITS HAVE BEEN FOUND                            05800000
043800                     IF PS-FAILED-AUDITS-FOUND                    05810000
043900                         SET PC259-AUDIT-REQUIRED                 05820000
044000                             PC259-FAILED-AUDITS   TO TRUE        05830000
044100                         PERFORM 1500-CALCULATE-QUANTITIES        05840000
044200                     ELSE                                         05850000
044300*   SOME PASSED AUDITS HAVE BEEN FOUND FOR THIS ITEM              05860000
044400                       IF PS-PASSED-AUDITS-FOUND                  05870000
044500                         IF SUT00017-CKD-DC-QTY > PV-PASSED-COUNT 05880000
044600*        CHECK THE NUMBER OF LINES FOR THE PO-RCVR PROMPTED       05890000
044700                             IF  PV-PROMPTED-CNT >=               05900000
044800                                 SUT00017-MAX-PO-LNE-QTY AND      05910000
044900                                 SUT00017-MAX-PO-LNE-QTY > 0      05920000
045000                                   SET PC259-AUDIT-IS-COMPLETE    05930000
045100                                       TO TRUE                    05940000
045200                             ELSE                                 05950000
045300                                 SET PC259-AUDIT-REQUIRED         05960000
045400                                     TO TRUE                      05970000
045500                                 PERFORM                          05980000
045600                                     1500-CALCULATE-QUANTITIES    05990000
045700                                 PERFORM                          06000000
045800                                      1600-INSERT-INTO-TABLES     06010000
045900                             END-IF                               06020000
046000                         ELSE                                     06030000
046100                             SET PC259-AUDIT-IS-COMPLETE TO TRUE  06040000
046200                             SET PC259-PASSED-AUDITS TO TRUE      06050000
046300                         END-IF                                   06060000
046400*    NO FAILED OR PASSED AUDITS HAVE BEEN FOUND                   06070000
046500                       ELSE                                       06080000
046600*        CHECK THE NUMBER OF LINES FOR THE PO-RCVR PROMPTED       06090000
046700                         IF  PV-PROMPTED-CNT >=                   06100000
046800                             SUT00017-MAX-PO-LNE-QTY  AND         06110000
046900                             SUT00017-MAX-PO-LNE-QTY > 0          06120000
047000                               SET PC259-AUDIT-IS-COMPLETE        06130000
047100                                       TO TRUE                    06140000
047200                         ELSE                                     06150000
047300                             SET PC259-AUDIT-REQUIRED TO TRUE     06160000
047400                             PERFORM 1500-CALCULATE-QUANTITIES    06170000
047500                             PERFORM 1600-INSERT-INTO-TABLES      06180000
047600                         END-IF                                   06190000
047700                       END-IF                                     06200000
047800                     END-IF                                       06210000
047900*   A RECORD EXIST IN THE SUT_PO_AUD_EXC TABLE                    06220000
048000                   ELSE                                           06230000
048100                     PERFORM 1700-RETURN-WITH-EXC-VALUES          06240000
048200                   END-IF                                         06250000
048300                 END-IF                                           06260000
048400               END-IF                                             06270000
048500             END-IF                                               06280000
048600         ELSE                                                     06290000
048700             SET PC259-DB2-ERROR TO TRUE                          06300000
048800         END-IF                                                   06310000
048900       END-IF                                                     06320000
049000     END-IF.                                                      06330000
049100                                                                  06340000
049200     MOVE  SUT00017-MAX-CART-CKD-QTY TO PC259-MAX-CART-CKD-QTY    06350000
049300     MOVE  SUT00017-MIN-CART-CKD-QTY TO PC259-MIN-CART-CKD-QTY    06360000
049400     MOVE  SUT00017-MIN-CART-CKD-QTY TO PC259-MIN-CART-CKD-QTY    06370000
049410     IF PV-AUDIT-FAIL-COUNT > 0                                   06380000
049411        MOVE SUT00017-MAX-PO-LNE-QTY TO PC259-MAX-PO-LNE-QTY-TABLE06390000
049413        COMPUTE PC259-MAX-PO-LNE-QTY =                            06400000
049414                    SUT00017-MAX-PO-LNE-QTY + PV-AUDIT-FAIL-COUNT 06410000
049420     ELSE                                                         06420000
049500        MOVE  SUT00017-MAX-PO-LNE-QTY TO PC259-MAX-PO-LNE-QTY     06430000
049501                                        PC259-MAX-PO-LNE-QTY-TABLE06440000
049510     END-IF                                                       06450000
049520                                                                  06460000
049600     MOVE  SUT00017-VND-RNKG-CDE     TO PC259-VND-RNKG-CDE        06470000
049700     IF SUT00017-AUD-PCT   > 0                                    06480000
049800        MOVE  SUT00017-AUD-PCT          TO PC259-AUD-PCT          06490000
049900     ELSE                                                         06500000
050000        MOVE 0                          TO PC259-AUD-PCT          06510000
050100     END-IF                                                       06520000
050200     IF PV-CARTONS-TO-AUDIT > PC259-EXPCTD-CRTNS                  06530000
050300        MOVE  PC259-EXPCTD-CRTNS        TO PC259-CARTONS-TO-AUDIT 06540000
050301     ELSE                                                         06550000
050302        MOVE  PV-CARTONS-TO-AUDIT       TO PC259-CARTONS-TO-AUDIT 06560000
050304     END-IF                                                       06570000
050400**   MOVE  PV-TOTAL-UNITS            TO PC259-UNITS-TO-AUDIT      06580000
050410     MOVE  PV-UNITS-TO-AUDIT         TO PC259-UNITS-TO-AUDIT      06590000
050500                                                                  06600000
050600     IF PC259-AUDIT-IS-COMPLETE                                   06610000
050700        MOVE 'N'   TO PC259-AUDIT-VALIDATION-SW                   06620000
050800        IF PC259-PASS-AUDIT-AT-DC                                 06630000
050900           CONTINUE                                               06640000
051000        ELSE                                                      06650000
051100           SET PC259-PASSED-AUDITS  TO TRUE                       06660000
051200        END-IF                                                    06670000
051300     END-IF                                                       06680000
051400                                                                  06690000
051500     IF PS-DUMP-TO-LOG                                            06700000
051600       PERFORM 9995-WRITE-DISPLAYS-2                              06710000
051700     END-IF.                                                      06720000
051800                                                                  06740000
      *SB 01/10/14 - BEGIN PR#5148D                                     06750000
           IF PC259-RFID-CHECK-YES                                      06810000
              SET PS-RFID-AUDIT-CHECK TO TRUE                           06930000
      *  CHECK IF SUT_PO_AUD_REQ RECORDS EXIST                          06940000
              PERFORM 7000-SELECT-REQ-INFO                              06950000
                                                                        06960000
              IF PS-REQ-REC-FOUND                                       06970000
                 PERFORM 1100-RETREIVE-VENDOR-RANKING                   06990000
              END-IF                                                    07000000
      *   CHECK IF AUDIT IS ALREADY DONE                                07010000
           IF NOT PC259-DB2-ERROR AND                                   07020000
              PS-REQ-REC-FOUND AND                                      07030000
              (SUT00015-CART-PRMPT-CDE = 'D' OR                         07040000
               SUT00015-CART-PRMPT-CDE = 'F')                           07050000
                                                                        07080000
      * DMH  AUDIT DONE AND PASS DOES NOT GET AUDIT %                   07090000
      * DMH  ADD PERFOR OF 7190 TO GET THE AUDIT PARM DATA              07100000
                                                                        07120000
               IF SUT00015-CART-PRMPT-CDE = 'D'                         07130000
                   PERFORM 7190-RETREIVE-PO-AUD-PARM                    07150000
                   IF SUT00015-AUD-STAT-CDE = 'P' OR                    07160000
                      SUT00015-AUD-STAT-CDE = 'N'                       07170000
                       SET PC259-RFID-AUDIT-IS-COMPLETE TO TRUE         07190000
                       SET PC259-RFID-PASS-AUDIT-AT-DC  TO TRUE         07210000
                   ELSE                                                 07220000
                       IF SUT00015-AUD-STAT-CDE = 'F'                   07230000
                           SET PC259-RFID-REWORK  TO TRUE               07250000
                           SET PC259-RFID-FAILED-AUDITS TO TRUE         07260000
                       ELSE                                             07270000
      ***    SUT00015-AUD-STAT-CDE = 'PP'                               07290000
                           SET PC259-RFID-AUDIT-PENDING TO TRUE         07300000
                           MOVE SUT00015-CART-QTY TO                    07310000
                                PV-CARTONS-TO-AUDIT                     07320000
                       END-IF                                           07330000
                   END-IF                                               07340000
               ELSE                                                     07350000
                   SET PC259-RFID-REWORK TO TRUE                        07370000
                   SET PC259-RFID-FAILED-AUDITS TO TRUE                 07380000
               END-IF                                                   07400000
           ELSE                                                         07410000
             IF NOT PC259-DB2-ERROR                                     07420000
      *   IF NO SUT_PO_AUD_REQ FOUND, GET DEPT AND ENT-ID               07430000
               IF PS-NO-REQ-REC-FOUND                                   07440000
                   PERFORM 7150-RETREIVE-PO-INFO                        07460000
                   MOVE PURCHS-DEPT-NBR         TO DK-DEPT-NBR          07470000
                   MOVE PURCHS-ENT-ID           TO DK-ENT-ID            07480000
               ELSE                                                     07490000
                   MOVE SUT00015-DEPT-NBR       TO DK-DEPT-NBR          07510000
                   MOVE SUT00015-ENT-ID         TO DK-ENT-ID            07520000
                   SET PS-PO-INFO-FOUND TO TRUE                         07530000
               END-IF                                                   07540000
               IF PS-PO-INFO-FOUND                                      07550000
                   IF PS-REQ-REC-FOUND                                  07560000
                      PERFORM 7190-RETREIVE-PO-AUD-PARM                 07580000
                   ELSE                                                 07590000
                      PERFORM 1100-RETREIVE-VENDOR-RANKING              07610000
                   END-IF                                               07620000
                   PERFORM 1200-CHECK-PO-AUDIT-EXC                      07630000
                   IF  SUT00017-AUD-PCT = 0   AND                       07640000
                       PS-NO-LINE-LEVEL-FOUND AND                       07650000
                       PS-NO-PO-LEVEL-FOUND                             07660000
                       IF PS-NO-REQ-REC-FOUND                           07670000
                           SET PC259-RFID-AUDIT-IS-COMPLETE TO TRUE     07690000
                       ELSE                                             07700000
                           PERFORM 1400-CHECK-FOR-IN-PROCES-AUDIT       07720000
                           PERFORM 1430-DETERMINE-STAT-CDE              07730000
                           IF PS-AUDIT-STARTED                          07740000
                              MOVE SUT00015-CART-QTY TO                 07750000
                                   PV-CARTONS-TO-AUDIT                  07760000
                           ELSE                                         07770000
                              MOVE 0 TO PV-CARTONS-TO-AUDIT             07780000
                           END-IF                                       07790000
                       END-IF                                           07800000
                   ELSE                                                 07810000
                     PERFORM 1400-CHECK-FOR-IN-PROCES-AUDIT             07820000
      *   AUDIT HAS BEEN STARTED FOR THIS DC                            07830000
                     IF PS-AUDIT-STARTED                                07840000
                       PERFORM 1430-DETERMINE-STAT-CDE                  07860000
                       MOVE SUT00015-CART-QTY TO                        07870000
                            PV-CARTONS-TO-AUDIT                         07880000
                     ELSE                                               07890000
                       PERFORM 7850-SELECT-DC-PASSED                    07900000
                       IF  PV-PASSED-COUNT > 0    AND                   07910000
                           PS-NO-LINE-LEVEL-FOUND AND                   07920000
                           PS-NO-PO-LEVEL-FOUND                         07930000
                           SET PC259-RFID-AUDIT-IS-COMPLETE TO TRUE     07950000
                           SET PC259-RFID-PASS-AUDIT-AT-DC TO TRUE      07960000
                       ELSE                                             07970000
      *   NO RECORDS EXIST IN THE SUT_PO_AUD_EXC TABLE                  07980000
                         IF PS-NO-LINE-LEVEL-FOUND AND                  07990000
                            PS-NO-PO-LEVEL-FOUND                        08000000
                           PERFORM 1300-CHECK-PO-AUDIT-REQ              08020000
                           PERFORM 1410-CHECK-PROMPTED-LINES            08030000
      *   SOME FAILED AUDITS HAVE BEEN FOUND                            08040000
                           IF PS-FAILED-AUDITS-FOUND                    08050000
                               SET PC259-RFID-AUDIT-REQUIRED            08070000
                                   PC259-RFID-FAILED-AUDITS   TO TRUE   08080000
                               PERFORM 1500-CALCULATE-QUANTITIES        08090000
                           ELSE                                         08100000
      *   SOME PASSED AUDITS HAVE BEEN FOUND FOR THIS ITEM              08110000
                             IF PS-PASSED-AUDITS-FOUND                  08120000
                               IF SUT00017-CKD-DC-QTY > PV-PASSED-COUNT 08130000
                                  SET PC259-RFID-AUDIT-REQUIRED TO TRUE 08220000
                                  PERFORM 1500-CALCULATE-QUANTITIES     08230000
                                  PERFORM 1600-INSERT-INTO-TABLES       08240000
                               ELSE                                     08260000
                                  SET PC259-RFID-AUDIT-IS-COMPLETE      08280000
                                                               TO TRUE  08290000
                                  SET PC259-RFID-PASSED-AUDITS          08300000
                                                               TO TRUE  08310000
                               END-IF                                   08320000
      *    NO FAILED OR PASSED AUDITS HAVE BEEN FOUND                   08330000
                             ELSE                                       08340000
                               SET PC259-RFID-AUDIT-REQUIRED TO TRUE    08430000
                               PERFORM 1500-CALCULATE-QUANTITIES        08440000
                               PERFORM 1600-INSERT-INTO-TABLES          08450000
                             END-IF                                     08470000
                           END-IF                                       08480000
      *   A RECORD EXIST IN THE SUT_PO_AUD_EXC TABLE                    08490000
                         ELSE                                           08500000
                           PERFORM 1700-RETURN-WITH-EXC-VALUES          08520000
                         END-IF                                         08530000
                       END-IF                                           08540000
                     END-IF                                             08550000
                   END-IF                                               08560000
               ELSE                                                     08570000
                   SET PC259-DB2-ERROR TO TRUE                          08580000
               END-IF                                                   08590000
             END-IF                                                     08600000
           END-IF                                                       08610000
                                                                        08620000
           MOVE  SUT00017-MAX-CART-CKD-QTY                              08630000
                                       TO PC259-RFID-MAX-CART-CKD-QTY   08640000
           MOVE  SUT00017-MIN-CART-CKD-QTY                              08650000
                                       TO PC259-RFID-MIN-CART-CKD-QTY   08660000
           MOVE  SUT00017-VND-RNKG-CDE     TO PC259-RFID-VND-RNKG-CDE   08770000
           IF SUT00017-AUD-PCT   > 0                                    08780000
              MOVE  SUT00017-AUD-PCT          TO PC259-RFID-AUD-PCT     08790000
           ELSE                                                         08800000
              MOVE 0                          TO PC259-RFID-AUD-PCT     08810000
           END-IF                                                       08820000
           IF PV-CARTONS-TO-AUDIT > PC259-RFID-EXPCTD-CRTNS             08840000
              MOVE  PC259-RFID-EXPCTD-CRTNS TO                          08850000
                    PC259-RFID-CARTONS-TO-AUDIT                         08860000
           ELSE                                                         08870000
              MOVE  PV-CARTONS-TO-AUDIT TO PC259-RFID-CARTONS-TO-AUDIT  08880000
           END-IF                                                       08890000
                                                                        08930000
           IF PC259-RFID-AUDIT-IS-COMPLETE                              08940000
              MOVE 'N'   TO PC259-RFID-AUDIT-VALIDATION-SW              08950000
              IF PC259-RFID-PASS-AUDIT-AT-DC                            08960000
                 CONTINUE                                               08970000
              ELSE                                                      08980000
                 SET PC259-RFID-PASSED-AUDITS  TO TRUE                  08990000
              END-IF                                                    09000000
           END-IF                                                       09010000
                                                                        09020000
           IF PS-DUMP-TO-LOG                                            09030000
             PERFORM 9995-WRITE-DISPLAYS-2                              09040000
           END-IF                                                       09050000
           END-IF.                                                      09060000
      *SB 01/10/14 - END PR#5148D                                       09070000
                                                                        09080000
051900***************************************************************** 09090000
052000                                                                  09100000
052100     GOBACK.                                                      09110000
052200                                                                  09120000
052300*-----------------------------------------------------------------09130000
052400*RETRIEVE THE VENDOR RANKING FOR THE PO                           09140000
052500*-----------------------------------------------------------------09150000
052600 1100-RETREIVE-VENDOR-RANKING.                                    09160000
           IF PS-QC-AUDIT-CHECK                                         09170000
052700        MOVE PC259-PKG-TYPE TO DK-PKGNG-TYP-CDE                   09180000
      *SB 01/10/14 - BEGIN PR#5148D                                     09190000
           ELSE IF PS-RFID-AUDIT-CHECK                                  09200000
                   MOVE 'RF'      TO DK-PKGNG-TYP-CDE                   09210000
                END-IF                                                  09220000
           END-IF.                                                      09230000
      *SB 01/10/14 - END PR#5148D                                       09240000
                                                                        09250000
052800     IF PS-REQ-REC-FOUND                                          09260000
052900         PERFORM 7200-RETREIVE-VENDOR-DEPT                        09270000
053000         IF PS-NO-DEPT-RANK-FOUND                                 09280000
053100             PERFORM 7300-RETREIVE-VENDOR-RANK                    09290000
053200             IF PS-NO-VEND-RANK-FOUND                             09300000
053300                 PERFORM 7400-RETREIVE-DEFAULT-RANK               09310000
053400             END-IF                                               09320000
053500         END-IF                                                   09330000
053600     ELSE                                                         09340000
053700         PERFORM 7250-RETREIVE-VENDOR-DEPT                        09350000
053800         IF PS-NO-DEPT-RANK-FOUND                                 09360000
053900             PERFORM 7350-RETREIVE-VENDOR-RANK                    09370000
054000             IF PS-NO-VEND-RANK-FOUND                             09380000
054100                 PERFORM 7450-RETREIVE-DEFAULT-RANK               09390000
054200             END-IF                                               09400000
054300         END-IF                                                   09410000
054400     END-IF.                                                      09420000
054500                                                                  09430000
054600*-----------------------------------------------------------------09440000
054700*CHECK TO SEE IF THE PO NEEDS TO BE AUDITED                       09450000
054800*-----------------------------------------------------------------09460000
054900 1200-CHECK-PO-AUDIT-EXC.                                         09470000
055000*  FOR PRE-PAC 'PP' OR BULK 'BC' ORDERS, PERFORM THE LINE OR PACK 09480000
055100*  ID CHECK                                                       09490000
055200     SET PS-NO-LINE-LEVEL-FOUND                                   09500000
055300         PS-NO-PO-LEVEL-FOUND    TO TRUE.                         09510000
      *SB 01/10/14 - BEGIN PR#5148D                                     09520000
           IF NOT PS-RFID-AUDIT-CHECK                                   09530000
      *SB 01/10/14 - END   PR#5148D                                     09540000
055400        IF PC259-PKG-TYPE = 'BC'                                  09550000
055500           PERFORM 7500-SELECT-BULK                               09560000
055600        ELSE                                                      09570000
055700           IF PC259-PKG-TYPE = 'PP'                               09580000
055800              PERFORM 7550-SELECT-PRE-PACK                        09590000
055900           END-IF                                                 09600000
              END-IF                                                    09610000
056000     END-IF.                                                      09620000
056100     IF PS-NO-LINE-LEVEL-FOUND                                    09630000
056200         PERFORM 7600-SELECT-PO-LEVEL                             09640000
056300     END-IF.                                                      09650000
056400                                                                  09660000
056500*-----------------------------------------------------------------09670000
056600*CHECK TO SEE IF THE PO NEEDS TO BE AUDITED                       09680000
056700*-----------------------------------------------------------------09690000
056800 1300-CHECK-PO-AUDIT-REQ.                                         09700000
056900     SET PS-NO-FAILED-AUDITS-FOUND                                09710000
057000         PS-NO-PASSED-AUDITS-FOUND    TO TRUE.                    09720000
057100     PERFORM 7700-SELECT-FAILED.                                  09730000
057101                                                                  09740000
057110     IF PC259-PKG-TYPE = 'BC'                                     09750000
057120        PERFORM 7750-SELECT-FAILED-COUNT                          09760000
057130     END-IF                                                       09770000
057140                                                                  09780000
057200     IF PS-NO-FAILED-AUDITS-FOUND                                 09790000
057300        PERFORM 7800-SELECT-PASSED                                09800000
057400     END-IF.                                                      09810000
057500                                                                  09820000
057600*  AN AUDIT FOR THIS PO (LINE OR PREPACK-ID) HAS FAILED, SO       09830000
057700*  THIS CARTON MUST BE AUDITED                                    09840000
057800                                                                  09850000
057900     IF PS-FAILED-AUDITS-FOUND                                    09860000
058000         SET PS-AUDIT-IS-REQUIRED TO TRUE                         09870000
058100     END-IF.                                                      09880000
058200                                                                  09890000
058300                                                                  09900000
058400*-----------------------------------------------------------------09910000
058500*                                                                 09920000
058600*                                                                 09930000
058700*-----------------------------------------------------------------09940000
058800 1400-CHECK-FOR-IN-PROCES-AUDIT.                                  09950000
058900     PERFORM 7900-SELECT-THIS-FACILITY.                           09960000
059000                                                                  09970000
059100                                                                  09980000
059200*-----------------------------------------------------------------09990000
059300*                                                                 10000000
059400*                                                                 10010000
059500*-----------------------------------------------------------------10020000
059600 1410-CHECK-PROMPTED-LINES.                                       10030000
059700     PERFORM 7950-SELECT-PROMPTED-LINES.                          10040000
059800                                                                  10050000
059900                                                                  10060000
060000*-----------------------------------------------------------------10070000
060100*                                                                 10080000
060200*                                                                 10090000
060300*-----------------------------------------------------------------10100000
060400 1430-DETERMINE-STAT-CDE.                                         10110000
060500**    AUDIT IS NO LONGER NEEDED OR HAS PASSED AN AUDIT            10120000
060600     IF SUT00015-AUD-STAT-CDE = PC-N OR                           10130000
060700        SUT00015-AUD-STAT-CDE = PC-P                              10140000
               IF PS-QC-AUDIT-CHECK                                     10160000
060800            SET PC259-AUDIT-IS-COMPLETE TO TRUE                   10180000
      *SB 01/10/14 - BEGIN PR#5148D                                     10190000
               ELSE IF PS-RFID-AUDIT-CHECK                              10200000
                       SET PC259-RFID-AUDIT-IS-COMPLETE TO TRUE         10220000
                    END-IF                                              10230000
               END-IF                                                   10240000
      *SB 01/10/14 - END PR#5148D                                       10250000
060900         IF SUT00015-AUD-STAT-CDE = PC-P                          10260000
                  IF PS-QC-AUDIT-CHECK                                  10280000
061000               SET PC259-PASS-AUDIT-AT-DC TO TRUE                 10300000
      *SB 01/10/14 - BEGIN PR#5148D                                     10310000
                  ELSE IF PS-RFID-AUDIT-CHECK                           10320000
                          SET PC259-RFID-PASS-AUDIT-AT-DC  TO TRUE      10340000
                       END-IF                                           10350000
                  END-IF                                                10360000
      *SB 01/10/14 - END PR#5148D                                       10370000
061100         END-IF                                                   10380000
061200     ELSE                                                         10390000
061300**    HAS FAILED AN AUDIT                                         10410000
061400         IF SUT00015-AUD-STAT-CDE = PC-F                          10420000
                  IF PS-QC-AUDIT-CHECK                                  10440000
061500               SET PC259-REWORK TO TRUE                           10460000
061600               SET PC259-FAILED-AUDITS TO TRUE                    10470000
      *SB 01/10/14 - BEGIN PR#5148D                                     10480000
                  ELSE IF PS-RFID-AUDIT-CHECK                           10490000
                          SET PC259-RFID-REWORK TO TRUE                 10510000
                          SET PC259-RFID-FAILED-AUDITS TO TRUE          10520000
                       END-IF                                           10530000
                  END-IF                                                10540000
      *SB 01/10/14 - END PR#5148D                                       10550000
061700         ELSE                                                     10560000
061800**    AN AUDIT IS IN-PROCESS                                      10580000
061900             IF SUT00015-AUD-STAT-CDE = PC-I                      10590000
062000                 MOVE SUT00015-AUD-CNTL-NBR  TO PV-AUDIT-CNTL-NBR 10610000
062100                                                DK-AUDIT-CNTL-NBR 10620000
062200*  IF THIS CARTON HAS ALREADY BEEN SCANNED, GO THROUGH THE LOGIC  10630000
062300*  THIS FAR TO DETERMINBE THE RETURN STATUS - DO NOT DO ANY       10640000
062400*  INSERTS OR UPDATES ON THE DATABASES.                           10650000
062500                 IF PS-CARTON-ALREADY-EXISTS AND                  10660000
062600                    SUT00015-AUD-CNTL-NBR = SUATRN-AUD-CNTL-NBR   10670000
                          IF PS-QC-AUDIT-CHECK                          10690000
062700                       SET PC259-AUDIT-PENDING  TO TRUE           10710000
      *SB 01/10/14 - BEGIN PR#5148D                                     10720000
                          ELSE IF PS-RFID-AUDIT-CHECK                   10730000
                                  SET PC259-RFID-AUDIT-PENDING  TO TRUE 10750000
                               END-IF                                   10760000
                          END-IF                                        10770000
      *SB 01/10/14 - END PR#5148D                                       10780000
062800                 ELSE                                             10790000
062900                     PERFORM 1460-CHECK-IF-PROMPTING-DONE         10810000
063000                 END-IF                                           10820000
063100             END-IF                                               10830000
063200         END-IF                                                   10840000
063300     END-IF.                                                      10850000
063400                                                                  10860000
063500 1460-CHECK-IF-PROMPTING-DONE.                                    10870000
063600*    DETERMINE UNIT COUNT                                         10880000
      *SB 01/10/14 - BEGIN PR#5148D                                     10890000
063700     IF PS-QC-AUDIT-CHECK AND PC259-PKG-TYPE = 'BC'               10900000
      *SB 01/10/14 - END   PR#5148D                                     10910000
063800         PERFORM 8100-SUM-PROMPTED-UNITS                          10920000
063900*        PERFORM 8150-SELECT-CURRENT-CARTON                       10930000
064000         IF PS-DUMP-TO-LOG                                        10940000
064100             CONTINUE                                             10950000
064200         ELSE                                                     10960000
064300*            IF SUT00015-UNT-QTY >                                10970000
064400*                         (SHUUPC-SHPD-QTY + PV-SHPD-QTY-SUM)     10980000
064500*                PERFORM 8200-SUM-CARTONS                         10990000
064600*                IF SUT00015-CART-QTY > PV-CARTON-COUNT           11000000
064700*                    CONTINUE                                     11010000
064800*                ELSE                                             11020000
064900*                    PERFORM 1490-UPDATE-REQ-BY-TYPE              11030000
065000*                END-IF                                           11040000
065100*            ELSE                                                 11050000
065200*                PERFORM 1490-UPDATE-REQ-BY-TYPE                  11060000
065300*            END-IF                                               11070000
      *            IF PS-QC-AUDIT-CHECK                                 11080000
065400             SET PC259-AUDIT-REQUIRED TO TRUE                     11090000
065500         END-IF                                                   11160000
065600     ELSE                                                         11170000
065700         IF PS-QC-AUDIT-CHECK AND PC259-PKG-TYPE = 'PP'           11180000
065800             MOVE PC259-DRIVER-LINE-NBR TO DK-PO-DRIVER-LINE      11190000
065900             PERFORM 8900-SUM-PP-PROMPTED-UNITS                   11200000
066000*            PERFORM 8950-SELECT-CURRENT-PP-CARTON                11210000
066100             IF PS-DUMP-TO-LOG                                    11220000
066200                 CONTINUE                                         11230000
066300             ELSE                                                 11240000
066400*                IF SUT00015-UNT-QTY >                            11250000
066500*                         (SHUUPC-SHPD-QTY + PV-SHPD-QTY-SUM)     11260000
066600*                    PERFORM 8200-SUM-CARTONS                     11270000
066700*                    IF SUT00015-CART-QTY > PV-CARTON-COUNT       11280000
066800*                        CONTINUE                                 11290000
066900*                    ELSE                                         11300000
067000*                        PERFORM 1490-UPDATE-REQ-BY-TYPE          11310000
067100*                    END-IF                                       11320000
067200*                ELSE                                             11330000
067300*                    PERFORM 1490-UPDATE-REQ-BY-TYPE              11340000
067400*                END-IF                                           11350000
      *                IF PS-QC-AUDIT-CHECK                             11360000
065400                 SET PC259-AUDIT-REQUIRED TO TRUE                 11370000
067600             END-IF                                               11440000
067700         ELSE                                                     11450000
067800*    DETERMINE CARTON COUNT                                       11460000
067900             IF PS-DUMP-TO-LOG                                    11470000
068000                 CONTINUE                                         11480000
068100             ELSE                                                 11490000
068200                 PERFORM 8200-SUM-CARTONS                         11500000
                       IF PS-QC-AUDIT-CHECK                             11510000
068300                    SET PC259-AUDIT-REQUIRED TO TRUE              11520000
      *SB 01/10/14 - BEGIN PR#5148D                                     11530000
                       ELSE IF PS-RFID-AUDIT-CHECK                      11540000
                               SET PC259-RFID-AUDIT-REQUIRED TO TRUE    11550000
                            END-IF                                      11560000
                       END-IF                                           11570000
      *SB 01/10/14 - END PR#5148D                                       11580000
068400             END-IF                                               11590000
068500         END-IF                                                   11600000
068600     END-IF.                                                      11610000
068700                                                                  11620000
068800                                                                  11630000
068900*-----------------------------------------------------------------11640000
069000*DETERMINE THE NUMBER OF CARTONS OR UNITS TO BE AUDITED.          11650000
069100*-----------------------------------------------------------------11660000
069200 1500-CALCULATE-QUANTITIES.                                       11670000
069300     IF PC259-PKG-TYPE = 'PS' OR                                  11680000
      *SB 01/10/14 - BEGIN PR#5148D                                     11690000
              PS-RFID-AUDIT-CHECK                                       11700000
      *SB 01/10/14 - END PR#5148D                                       11710000
069400         PERFORM 1530-CALCULATE-PACK-BY-STORE                     11720000
069500     ELSE                                                         11730000
069600         IF PC259-PKG-TYPE = 'BC'                                 11740000
069700             PERFORM 1560-CALCULATE-BULK                          11750000
069800         ELSE                                                     11760000
069900             IF PC259-PKG-TYPE = 'PP'                             11770000
070000                     PERFORM 1590-CALCULATE-PRE-PACK              11780000
070100             END-IF                                               11790000
070200         END-IF                                                   11800000
070300     END-IF.                                                      11810000
070400                                                                  11820000
070500 1530-CALCULATE-PACK-BY-STORE.                                    11830000
070600     MOVE ZERO                 TO PV-UNITS-TO-AUDIT.              11840000
070700     PERFORM 8250-SELECT-EXPECTD-CNT.                             11850000
070800**  ADD 1 CARTON BECAUSE THE SUBSELECT IN THE 8250- PARA          11860000
070900**  REMOVED THE CURRENT CARTON THAT IS BEING PROCESSED            11870000
      *SB 01/10/14 - BEGIN PR#5148D                                     11871000
071000*    COMPUTE PV-DB2-COUNT-EXP-SCN =                               11880000
071100*            PV-DB2-COUNT-EXP-SCN + 1.                            11890000
      *SB 01/10/14 - END   PR#5148D                                     11891000
071200     IF SUT00017-AUD-PCT > 0 AND                                  11900000
071300        PV-DB2-COUNT-EXP-SCN > 0                                  11910000
071400         COMPUTE PV-CARTONS-TO-AUDIT ROUNDED =                    11920000
071500           (PV-DB2-COUNT-EXP-SCN * (SUT00017-AUD-PCT / 100))      11930000
071600         IF PV-CARTONS-TO-AUDIT < 1                               11940000
071700             MOVE 1 TO    PV-CARTONS-TO-AUDIT                     11950000
071800         END-IF                                                   11960000
071900     ELSE                                                         11970000
072000         MOVE PV-DB2-COUNT-EXP-SCN TO PV-CARTONS-TO-AUDIT         11980000
072100     END-IF.                                                      11990000
072200*    IF PV-CARTONS-TO-AUDIT < SUT00017-MIN-CART-CKD-QTY AND       12000000
072200     IF PV-CARTONS-TO-AUDIT < SUT00017-MIN-CART-CKD-QTY           12010000
      *SB 01/10/14 - BEGIN PR#5148D                                     12020000
072300        IF PV-DB2-COUNT-EXP-SCN > SUT00017-MIN-CART-CKD-QTY       12030000
072400           MOVE SUT00017-MIN-CART-CKD-QTY TO PV-CARTONS-TO-AUDIT  12040000
              ELSE                                                      12050000
                 MOVE PV-DB2-COUNT-EXP-SCN      TO PV-CARTONS-TO-AUDIT  12060000
              END-IF                                                    12070000
      *SB 01/10/14 - END PR#5148D                                       12080000
072500     ELSE                                                         12090000
072600         IF PV-CARTONS-TO-AUDIT > SUT00017-MAX-CART-CKD-QTY       12100000
072700             MOVE SUT00017-MAX-CART-CKD-QTY                       12110000
072800                                        TO PV-CARTONS-TO-AUDIT    12120000
072900         END-IF                                                   12130000
073000     END-IF.                                                      12140000
073100                                                                  12150000
073200 1560-CALCULATE-BULK.                                             12160000
073300     PERFORM 8450-SELECT-DIST-HEAD.                               12170000
073310     IF PS-TDISTHD-FOUND-YES                                      12180000
073400        IF DISTHD-OTPK-UNT-QTY = 0                                12190000
073500            PERFORM 8500-SUM-DISTRO-DETAIL                        12200000
073600            MOVE PV-SUM-EXPTD-ALLOC   TO PV-TOTAL-UNITS           12210000
073700        ELSE                                                      12220000
073800            COMPUTE PV-TOTAL-UNITS =                              12230000
073900                 DISTHD-TOT-CART-CNT * DISTHD-OTPK-UNT-QTY        12240000
073901                 MOVE DISTHD-OTPK-UNT-QTY TO PV-OUTR-PK-QTY       12250000
074000        END-IF                                                    12260000
074010     ELSE                                                         12270000
074011        PERFORM 8550-CHECK-OUTER-PACK                             12280000
074012        IF XLT00003-OUTR-PK-QTY > 0 AND PC259-EXPCTD-CRTNS > 0    12290000
074014              COMPUTE PV-TOTAL-UNITS =                            12300000
074016                    PC259-EXPCTD-CRTNS  * XLT00003-OUTR-PK-QTY    12310000
074017                 MOVE XLT00003-OUTR-PK-QTY TO PV-OUTR-PK-QTY      12320000
074018        END-IF                                                    12330000
074020     END-IF.                                                      12340000
074030                                                                  12350000
074400     IF SUT00017-AUD-PCT > 0 AND                                  12360000
074500        PV-TOTAL-UNITS > 0                                        12370000
074600         COMPUTE PV-UNITS-TO-AUDIT ROUNDED =                      12380000
074700           (PV-TOTAL-UNITS * (SUT00017-AUD-PCT / 100))            12390000
074701        IF PV-UNITS-TO-AUDIT > 0 AND                              12400000
074702           PV-OUTR-PK-QTY > 0                                     12410000
074710            COMPUTE PV-CRTNS-TO-AUD-CALC ROUNDED =                12420000
074720              (PV-UNITS-TO-AUDIT / PV-OUTR-PK-QTY)                12430000
074730                                                                  12440000
074731            IF PV-CRTNS-TO-AUD-CALC = 0                           12450000
074732               MOVE 1              TO PV-CRTNS-TO-AUD-CALC        12460000
074740            END-IF                                                12470000
074750        END-IF                                                    12480000
074800        IF PV-UNITS-TO-AUDIT = 0                                  12490000
074900             MOVE 1              TO PV-UNITS-TO-AUDIT             12500000
075000        END-IF                                                    12510000
075100     ELSE                                                         12520000
075200         MOVE PV-TOTAL-UNITS TO PV-UNITS-TO-AUDIT                 12530000
075300     END-IF.                                                      12540000
075400                                                                  12550000
075500     MOVE DK-PO-LINE-NBR            TO DK-SHUUPC-LNE-NBR.         12560000
075600     PERFORM 8800-COUNT-CHECKED-IN-CRTNS.                         12570000
075700**  ADD 1 TO THE TOTAL-CARTON-TO-AUDIT BECAUSE THE CARTON WE ARE  12580000
075800**  PROCESSING  WOULD HAVE BEEN INCLUDED IN THE COUNT COMING      12590000
075900**  FROM THE 8800- PARA - AND WE ARE SUBTRACTING THAT COUNT       12600000
076000     COMPUTE DISTHD-TOT-CART-CNT =                                12610000
      *SB 01/10/14 - BEGIN PR#5148D                                     12611000
076100             DISTHD-TOT-CART-CNT - PV-CHECK-IN-COUNT.             12620000
076100*           (DISTHD-TOT-CART-CNT + 1) - PV-CHECK-IN-COUNT.        12630000
      *SB 01/10/14 - END   PR#5148D                                     12631000
076140                                                                  12640000
076150     IF PV-CRTNS-TO-AUD-CALC > 0                                  12650000
076160        IF PV-CRTNS-TO-AUD-CALC > SUT00017-MAX-CART-CKD-QTY       12660000
076161           MOVE SUT00017-MAX-CART-CKD-QTY                         12670000
076162                                    TO PV-CARTONS-TO-AUDIT        12680000
076170        ELSE                                                      12690000
076171           MOVE PV-CRTNS-TO-AUD-CALC                              12700000
076172                                    TO PV-CARTONS-TO-AUDIT        12710000
076180        END-IF                                                    12720000
076190     ELSE                                                         12730000
076200        IF DISTHD-TOT-CART-CNT > SUT00017-MAX-CART-CKD-QTY        12740000
076300            MOVE SUT00017-MAX-CART-CKD-QTY                        12750000
076400                                       TO PV-CARTONS-TO-AUDIT     12760000
076500        ELSE                                                      12770000
076600            MOVE DISTHD-TOT-CART-CNT   TO PV-CARTONS-TO-AUDIT     12780000
076700        END-IF                                                    12790000
076800     END-IF.                                                      12800000
076900                                                                  12810000
077000 1590-CALCULATE-PRE-PACK.                                         12820000
077100     MOVE PC259-DRIVER-LINE-NBR TO DK-PO-DRIVER-LINE.             12830000
077200     PERFORM 8600-SELECT-DRIVER-LINE-QTY.                         12840000
077210     IF PS-TDISTHD-FOUND-YES                                      12850000
077300        PERFORM 8650-SUM-PRE-PACK-DETAIL                          12860000
077400        IF SUT00017-AUD-PCT > 0 AND                               12870000
077500           PV-SUM-OF-ALL-LINES > 0                                12880000
077600            COMPUTE PV-UNITS-TO-AUDIT ROUNDED =                   12890000
077700              (PV-SUM-OF-ALL-LINES * (SUT00017-AUD-PCT / 100))    12900000
078100        ELSE                                                      12910000
078200            MOVE PV-SUM-OF-ALL-LINES       TO PV-UNITS-TO-AUDIT   12920000
078300        END-IF                                                    12930000
078310        MOVE  DISTHD-OTPK-UNT-QTY TO  PV-OUTR-PK-QTY              12940000
078400     ELSE                                                         12950000
078410        PERFORM 8555-CHECK-ITM-QTY-PREPK                          12960000
078420                                                                  12970000
078423        IF RECITM-PKSL-ITM-QTY > 0 AND SUT00017-AUD-PCT > 0       12980000
078426           COMPUTE PV-UNITS-TO-AUDIT ROUNDED =                    12990000
078427           (RECITM-PKSL-ITM-QTY * (SUT00017-AUD-PCT / 100))       13000000
078428        END-IF                                                    13010000
078429        IF PV-UNITS-TO-AUDIT = 0                                  13020000
078430           MOVE 1              TO PV-UNITS-TO-AUDIT               13030000
078440        END-IF                                                    13040000
078450        MOVE  RECITM-PREPK-RATO-QTY TO  PV-OUTR-PK-QTY            13050000
078500     END-IF                                                       13060000
078600                                                                  13070000
078920     IF PV-UNITS-TO-AUDIT > 0 AND PV-OUTR-PK-QTY > 0              13080000
078940           COMPUTE PV-CRTNS-TO-AUD-CALC ROUNDED =                 13090000
078950             (PV-UNITS-TO-AUDIT / PV-OUTR-PK-QTY)                 13100000
078951          IF PV-CRTNS-TO-AUD-CALC = 0                             13110000
078952               MOVE 1              TO PV-CRTNS-TO-AUD-CALC        13120000
078953          END-IF                                                  13130000
078960     END-IF                                                       13140000
078970                                                                  13150000
079000     MOVE DK-PO-DRIVER-LINE         TO DK-SHUUPC-LNE-NBR.         13160000
079100     PERFORM 8800-COUNT-CHECKED-IN-CRTNS.                         13170000
079200**  ADD 1 TO THE TOTAL-CARTON-TO-AUDIT BECAUSE THE CARTON WE ARE  13180000
079300**  PROCESSING  WOULD HAVE BEEN INCLUDED IN THE COUNT COMING      13190000
079400**  FROM THE 8800- PARA - AND WE ARE SUBTRACTING THAT COUNT       13200000
079500     COMPUTE DISTHD-TOT-CART-CNT =                                13210000
      *SB 01/10/14 - BEGIN PR#5148D                                     13211000
079600             DISTHD-TOT-CART-CNT - PV-CHECK-IN-COUNT.             13220000
079600*           (DISTHD-TOT-CART-CNT + 1) - PV-CHECK-IN-COUNT.        13230000
      *SB 01/10/14 - END   PR#5148D                                     13231000
079601                                                                  13240000
079602     IF PV-CRTNS-TO-AUD-CALC > 0                                  13250000
079603        IF PV-CRTNS-TO-AUD-CALC > SUT00017-MAX-CART-CKD-QTY       13260000
079604           MOVE SUT00017-MAX-CART-CKD-QTY                         13270000
079605                                    TO PV-CARTONS-TO-AUDIT        13280000
079606        ELSE                                                      13290000
079607           MOVE PV-CRTNS-TO-AUD-CALC                              13300000
079608                                    TO PV-CARTONS-TO-AUDIT        13310000
079609        END-IF                                                    13320000
079610     ELSE                                                         13330000
079611        IF DISTHD-TOT-CART-CNT > SUT00017-MAX-CART-CKD-QTY        13340000
079612            MOVE SUT00017-MAX-CART-CKD-QTY                        13350000
079613                                       TO PV-CARTONS-TO-AUDIT     13360000
079614        ELSE                                                      13370000
079615            MOVE DISTHD-TOT-CART-CNT   TO PV-CARTONS-TO-AUDIT     13380000
079616        END-IF                                                    13390000
079617     END-IF.                                                      13400000
080300                                                                  13410000
080400 1600-INSERT-INTO-TABLES.                                         13420000
080500                                                                  13430000
080600     PERFORM 1680-BUILD-SUT-PO-AUD-REQ.                           13440000
080700                                                                  13450000
080800 1680-BUILD-SUT-PO-AUD-REQ.                                       13460000
080900                                                                  13470000
081000     INITIALIZE DCLSUT00015.                                      13480000
081100     MOVE PC259-PO-NUMBER         TO SUT00015-PO-NBR.             13490000
081200     IF PC259-PKG-TYPE = 'BC'                                     13500000
081300         MOVE PC259-LINE-NBR          TO SUT00015-PO-LNE-NBR      13510000
081400     ELSE                                                         13520000
081500         MOVE 0                       TO SUT00015-PO-LNE-NBR      13530000
081600     END-IF.                                                      13540000
081700     IF PC259-PKG-TYPE = 'PP'                                     13550000
081800         MOVE PC259-PRE-PACK-ID       TO SUT00015-PO-PREPK-ID     13560000
081900     ELSE                                                         13570000
082000         MOVE 0                       TO SUT00015-PO-PREPK-ID     13580000
082100     END-IF.                                                      13590000
082200     MOVE PC259-OPER-UNT-ID       TO SUT00015-OPER-UNT-ID.        13600000
082300     MOVE PC259-INBOUND-TRIP-ID   TO SUT00015-INBND-TRIP-ID.      13610000
082400     MOVE PC259-REC-SEQ-NBR       TO SUT00015-RCVR-SEQ-NBR.       13620000
082500     MOVE PV-AUDIT-CNTL-NBR       TO SUT00015-AUD-CNTL-NBR.       13630000
082600     MOVE SUT00017-VND-RNKG-CDE   TO SUT00015-VND-RNKG-CDE.       13640000
082700     MOVE SUT00017-PKGNG-TYP-CDE  TO SUT00015-PKGNG-TYP-CDE.      13650000
082800     MOVE SUT00017-EFF-BEG-TMST   TO SUT00015-EFF-BEG-TMST.       13660000
082900     MOVE PV-CARTONS-TO-AUDIT     TO SUT00015-CART-QTY.           13670000
083000     IF PV-UNITS-TO-AUDIT > 0 AND                                 13680000
083100        SUT00017-CKD-PCT > 0                                      13690000
083200         COMPUTE PV-UNT-QTY ROUNDED =                             13700000
083300                 (PV-UNITS-TO-AUDIT *                             13710000
083400                 ((PC-100 - SUT00017-CKD-PCT) / 100))             13720000
083500         IF PV-UNT-QTY < 1                                        13730000
083600             MOVE 1              TO SUT00015-UNT-QTY              13740000
083700         ELSE                                                     13750000
083800             COMPUTE SUT00015-UNT-QTY ROUNDED =                   13760000
083900                        PV-UNT-QTY * 1                            13770000
084000         END-IF                                                   13780000
084100     ELSE                                                         13790000
084200         MOVE PV-UNITS-TO-AUDIT  TO SUT00015-UNT-QTY              13800000
084300     END-IF.                                                      13810000
084400     MOVE +0                      TO SUT00015-AUD-UNT-QTY.        13820000
084500     MOVE +0                      TO SUT00015-AUD-CART-QTY.       13830000
084600     MOVE PC-I                    TO SUT00015-AUD-STAT-CDE.       13840000
084700     MOVE PURCHS-ENT-ID           TO SUT00015-ENT-ID.             13850000
084800     MOVE PURCHS-DEPT-NBR         TO SUT00015-DEPT-NBR.           13860000
084900                                                                  13870000
085000 1700-RETURN-WITH-EXC-VALUES.                                     13880000
085100     IF SUT00014-AUD-TYP-CDE = PC-N                               13890000
               IF PS-QC-AUDIT-CHECK                                     13900000
085200            SET PC259-AUDIT-IS-COMPLETE TO TRUE                   13910000
      *SB 01/10/14 - BEGIN PR#5148D                                     13920000
               ELSE IF PS-RFID-AUDIT-CHECK                              13930000
                       SET PC259-RFID-AUDIT-IS-COMPLETE TO TRUE         13940000
                    END-IF                                              13950000
               END-IF                                                   13960000
      *SB 01/10/14 - END PR#5148D                                       13970000
085300     ELSE                                                         13980000
085400         IF SUT00014-AUD-TYP-CDE = PC-A                           13990000
                  IF PS-QC-AUDIT-CHECK                                  14000000
085500               SET PC259-100-PC-AUDIT-REQD TO TRUE                14010000
      *SB 01/10/14 - BEGIN PR#5148D                                     14020000
                  ELSE IF PS-RFID-AUDIT-CHECK                           14030000
                          SET PC259-RFID-100-PC-AUDIT-REQD TO TRUE      14040000
                       END-IF                                           14050000
                  END-IF                                                14060000
085600         ELSE                                                     14070000
085400             IF SUT00014-AUD-TYP-CDE = PC-Q                       14080000
                      IF PS-QC-AUDIT-CHECK                              14090000
                         SET PC259-100-PC-AUDIT-REQD TO TRUE            14100000
                      END-IF                                            14110000
                   ELSE                                                 14120000
                       IF SUT00014-AUD-TYP-CDE = PC-R                   14130000
                          IF PS-RFID-AUDIT-CHECK                        14140000
                             SET PC259-RFID-100-PC-AUDIT-REQD TO TRUE   14150000
                          END-IF                                        14160000
      *SB 01/10/14 - END PR#5148D                                       14170000
                       ELSE                                             14180000
085700                    SET PC259-DB2-ERROR TO TRUE                   14190000
                       END-IF                                           14200000
                   END-IF                                               14210000
085800         END-IF                                                   14220000
085900     END-IF.                                                      14230000
086000                                                                  14240000
086100                                                                  14250000
086200 7000-SELECT-REQ-INFO.                                            14260000
086300                                                                  14270000
086400     INITIALIZE DCLSUT00015.                                      14280000
                                                                        14290000
      *SB 01/10/14 - BEGIN PR#5148D                                     14300000
           IF PS-RFID-AUDIT-CHECK                                       14310000
              MOVE DK-PO-LINE-NBR TO PV-TEMP-PO-LINE-NBR                14320000
              MOVE DK-PREPK-ID    TO PV-TEMP-PREPK-ID                   14330000
              MOVE 0     TO DK-PO-LINE-NBR                              14340000
              MOVE -9999 TO DK-PREPK-ID                                 14350000
           END-IF.                                                      14360000
      *SB 01/10/14 - END PR#5148D                                       14370000
086500                                                                  14380000
086600     EXEC SQL                                                     14390000
086700          SELECT AUD_CNTL_NBR                                     14400000
086800             ,   VND_RNKG_CDE                                     14410000
086900             ,   PKGNG_TYP_CDE                                    14420000
087000             ,   EFF_BEG_TMST                                     14430000
087100             ,   AUD_STAT_CDE                                     14440000
087200             ,   CART_PRMPT_CDE                                   14450000
087300             ,   ENT_ID                                           14460000
087400             ,   DEPT_NBR                                         14470000
      *SB 01/10/14 - BEGIN PR#5148D                                     14471000
                   ,   CART_QTY                                         14480000
      *SB 01/10/14 - END PR#5148D                                       14481000
087500          INTO   :SUT00015-AUD-CNTL-NBR                           14490000
087600             ,   :SUT00015-VND-RNKG-CDE                           14500000
087700             ,   :SUT00015-PKGNG-TYP-CDE                          14510000
087800             ,   :SUT00015-EFF-BEG-TMST                           14520000
087900             ,   :SUT00015-AUD-STAT-CDE                           14530000
088000             ,   :SUT00015-CART-PRMPT-CDE                         14540000
088100             ,   :SUT00015-ENT-ID                                 14550000
088200             ,   :SUT00015-DEPT-NBR                               14560000
      *SB 01/10/14 - BEGIN PR#5148D                                     14561000
088200             ,   :SUT00015-CART-QTY                               14570000
      *SB 01/10/14 - END PR#5148D                                       14571000
088300          FROM   SUT_PO_AUD_REQ                                   14580000
088400          WHERE  PO_NBR         = :DK-PO-NBR                      14590000
088500            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 14600000
088600            AND  PO_PREPK_ID    = :DK-PREPK-ID                    14610000
088700            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                14620000
088800            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 14630000
088900           WITH UR                                                14640000
089000     END-EXEC.                                                    14650000
089100                                                                  14660000
089200     EVALUATE TRUE                                                14670000
089300         WHEN SQLCODE = ZERO                                      14680000
089400         WHEN SQLCODE = -811                                      14690000
089500             SET PS-REQ-REC-FOUND TO TRUE                         14700000
089600             MOVE SUT00015-ENT-ID  TO DK-ENT-ID                   14710000
089700             MOVE SUT00015-DEPT-NBR TO DK-DEPT-NBR                14720000
089800         WHEN SQLCODE = +100                                      14730000
089900             SET PS-NO-REQ-REC-FOUND TO TRUE                      14740000
090000         WHEN SQLWARN0 NOT = SPACES                               14750000
090100         WHEN SQLCODE NOT EQUAL ZERO                              14760000
090200             MOVE SQLCODE  TO PC259-SQL-CODE                      14770000
090300                              PV-DISPLAY-SQLCODE                  14780000
090400             MOVE '7000-SELECT-REQ-INFO'                          14790000
090500                             TO PV-PARAGRAPH                      14800000
090600             MOVE 'PCKUT090 - GET BULK REQ RECS'                  14810000
090700                             TO PV-MESSAGE-TEXT-1                 14820000
090800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 14830000
090900             STRING 'PO NBR: '         DELIMITED BY SIZE          14840000
091000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          14850000
091100                           INTO PV-MESSAGE-TEXT-2                 14860000
091200             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        14870000
091300             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          14880000
091400                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          14890000
091500                           INTO PV-MESSAGE-TEXT-3                 14900000
091600             MOVE DK-RCVR-SEQ-NBR                                 14910000
091700                             TO PV-DISPLAY-RCVR-SEQ-NBR           14920000
091800             STRING 'RECV SEQ: '       DELIMITED BY SIZE          14930000
091900                 PV-DISPLAY-RCVR-SEQ-NBR                          14940000
092000                                       DELIMITED BY SIZE          14950000
092100                           INTO PV-MESSAGE-TEXT-4                 14960000
092200             MOVE SQLCA      TO PC259-SQLCA                       14970000
092300             MOVE 'SUT00015' TO PV-DB2-TABLE-NAME-1               14980000
092400                                PC259-ERROR-TABLE-NME             14990000
092500             SET PS-DB2-ABEND                                     15000000
092600                             TO TRUE                              15010000
092700                                                                  15020000
092800             SET PS-DUMP-TO-LOG       TO TRUE                     15030000
092900             SET PC259-DB2-ERROR TO TRUE                          15040000
093000             SET PC259-INVALID-SQL TO TRUE                        15050000
093100             PERFORM 9990-WRITE-DISPLAYS                          15060000
093200     END-EVALUATE.                                                15070000
                                                                        15080000
      *SB 01/10/14 - BEGIN PR#5148D                                     15090000
           IF PS-RFID-AUDIT-CHECK                                       15100000
              MOVE PV-TEMP-PO-LINE-NBR TO DK-PO-LINE-NBR                15110000
              MOVE PV-TEMP-PREPK-ID    TO DK-PREPK-ID                   15120000
           END-IF.                                                      15130000
      *SB 01/10/14 - END PR#5148D                                       15140000
093400                                                                  15150000
093500 7150-RETREIVE-PO-INFO.                                           15160000
093600                                                                  15170000
093700     EXEC SQL                                                     15180000
093800          SELECT DEPT_NBR                                         15190000
093900              ,  ENT_ID                                           15200000
094000          INTO   :PURCHS-DEPT-NBR                                 15210000
094100              ,  :PURCHS-ENT-ID                                   15220000
094200          FROM   TPURCHS                                          15230000
094300          WHERE  PO_NBR   = :DK-PO-NBR                            15240000
094400            AND  VER_STATUS_CDE = 'A'                             15250000
094500           WITH UR                                                15260000
094600     END-EXEC.                                                    15270000
094700                                                                  15280000
094800     EVALUATE TRUE                                                15290000
094900         WHEN SQLCODE = ZERO                                      15300000
095000             SET PS-PO-INFO-FOUND TO TRUE                         15310000
095100         WHEN SQLCODE = +100                                      15320000
095200             SET PS-NO-PO-INFO-FOUND TO TRUE                      15330000
095300         WHEN SQLWARN0 NOT = SPACES                               15340000
095400         WHEN SQLCODE NOT EQUAL ZERO                              15350000
095500             MOVE SQLCODE  TO PC259-SQL-CODE                      15360000
095600             MOVE '7150-RETREIVE-PO-INFO'                         15370000
095700                             TO PV-PARAGRAPH                      15380000
095800             MOVE 'PCKUT090 - GET PO INFO '                       15390000
095900                             TO PV-MESSAGE-TEXT-1                 15400000
096000             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 15410000
096100             STRING 'PO NBR: '         DELIMITED BY SIZE          15420000
096200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          15430000
096300                           INTO PV-MESSAGE-TEXT-2                 15440000
096400             MOVE SQLCA      TO PC259-SQLCA                       15450000
096500             MOVE 'TPURCHS'  TO PV-DB2-TABLE-NAME-1               15460000
096600                                PC259-ERROR-TABLE-NME             15470000
096700             SET PS-DB2-ABEND                                     15480000
096800                             TO TRUE                              15490000
096900                                                                  15500000
097000             SET PS-DUMP-TO-LOG       TO TRUE                     15510000
097100             SET PS-NO-PO-INFO-FOUND TO TRUE                      15520000
097200             SET PC259-DB2-ERROR TO TRUE                          15530000
097300             SET PC259-INVALID-SQL TO TRUE                        15540000
097400             PERFORM 9990-WRITE-DISPLAYS                          15550000
097500     END-EVALUATE.                                                15560000
097600                                                                  15570000
097700 7190-RETREIVE-PO-AUD-PARM.                                       15580000
097800                                                                  15590000
097900     EXEC SQL                                                     15600000
098000          SELECT VND_RNKG_CDE                                     15610000
098100              ,  PKGNG_TYP_CDE                                    15620000
098200              ,  EFF_BEG_TMST                                     15630000
098300              ,  AUD_PCT                                          15640000
098400              ,  CKD_PCT                                          15650000
098500              ,  MAX_CKD_QTY                                      15660000
098600              ,  MAX_CART_CKD_QTY                                 15670000
098700              ,  MIN_CART_CKD_QTY                                 15680000
098800              ,  CKD_DC_QTY                                       15690000
098900              ,  MAX_PO_LNE_QTY                                   15700000
099000              ,  CK_AFT_DAY_QTY                                   15710000
099100              ,  CK_AFT_RCVR_QTY                                  15720000
099200              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         15730000
099300          INTO   :SUT00017-VND-RNKG-CDE                           15740000
099400              ,  :SUT00017-PKGNG-TYP-CDE                          15750000
099500              ,  :SUT00017-EFF-BEG-TMST                           15760000
099600              ,  :SUT00017-AUD-PCT                                15770000
099700              ,  :SUT00017-CKD-PCT                                15780000
099800              ,  :SUT00017-MAX-CKD-QTY                            15790000
099900              ,  :SUT00017-MAX-CART-CKD-QTY                       15800000
100000              ,  :SUT00017-MIN-CART-CKD-QTY                       15810000
100100              ,  :SUT00017-CKD-DC-QTY                             15820000
100200              ,  :SUT00017-MAX-PO-LNE-QTY                         15830000
100300              ,  :SUT00017-CK-AFT-DAY-QTY                         15840000
100400              ,  :SUT00017-CK-AFT-RCVR-QTY                        15850000
100500              ,  :PV-LIMIT-DAYS                                   15860000
100600          FROM   SUT_PO_AUD_PARM A                                15870000
100700          WHERE  A.VND_RNKG_CDE  = :SUT00015-VND-RNKG-CDE         15880000
100800            AND  A.PKGNG_TYP_CDE = :SUT00015-PKGNG-TYP-CDE        15890000
100900            AND  A.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         15900000
101000           WITH UR                                                15910000
101100     END-EXEC.                                                    15920000
101200                                                                  15930000
101300     EVALUATE TRUE                                                15940000
101400         WHEN SQLCODE = ZERO                                      15950000
101500             CONTINUE                                             15960000
101600         WHEN SQLWARN0 NOT = SPACES                               15970000
101700         WHEN SQLCODE NOT EQUAL ZERO                              15980000
101800             MOVE SQLCODE  TO PC259-SQL-CODE                      15990000
101900             MOVE '7190-RETREIVE-PO-AUD-PARM'                     16000000
102000                             TO PV-PARAGRAPH                      16010000
102100             MOVE 'PCKUT090 - GET AUD PARM DATA '                 16020000
102200                             TO PV-MESSAGE-TEXT-1                 16030000
102300             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                16040000
102400             STRING 'ENT ID: '         DELIMITED BY SIZE          16050000
102500                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          16060000
102600                           INTO PV-MESSAGE-TEXT-2                 16070000
102700             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              16080000
102800             STRING 'DEPT NBR: '       DELIMITED BY SIZE          16090000
102900                 PV-DISPLAY-DEPT-NBR   DELIMITED BY SIZE          16100000
103000                           INTO PV-MESSAGE-TEXT-3                 16110000
103100             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          16120000
103200                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          16130000
103300                           INTO PV-MESSAGE-TEXT-4                 16140000
103400             MOVE SQLCA      TO PC259-SQLCA                       16150000
103500             MOVE 'SUT00017' TO PV-DB2-TABLE-NAME-1               16160000
103600                                PC259-ERROR-TABLE-NME             16170000
103700             SET PS-DB2-ABEND                                     16180000
103800                             TO TRUE                              16190000
103900                                                                  16200000
104000             SET PS-DUMP-TO-LOG       TO TRUE                     16210000
104100             SET PS-NO-PO-INFO-FOUND TO TRUE                      16220000
104200             SET PC259-DB2-ERROR TO TRUE                          16230000
104300             SET PC259-INVALID-SQL TO TRUE                        16240000
104400             PERFORM 9990-WRITE-DISPLAYS                          16250000
104500     END-EVALUATE.                                                16260000
104600                                                                  16270000
104700 7200-RETREIVE-VENDOR-DEPT.                                       16280000
104800                                                                  16290000
104900     EXEC SQL                                                     16300000
105000          SELECT B.VND_RNKG_CDE                                   16310000
105100              ,  B.PKGNG_TYP_CDE                                  16320000
105200              ,  EFF_BEG_TMST                                     16330000
105300              ,  AUD_PCT                                          16340000
105400              ,  CKD_PCT                                          16350000
105500              ,  MAX_CKD_QTY                                      16360000
105600              ,  MAX_CART_CKD_QTY                                 16370000
105700              ,  MIN_CART_CKD_QTY                                 16380000
105800              ,  CKD_DC_QTY                                       16390000
105900              ,  MAX_PO_LNE_QTY                                   16400000
106000              ,  CK_AFT_DAY_QTY                                   16410000
106100              ,  CK_AFT_RCVR_QTY                                  16420000
106200              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         16430000
106300          INTO   :SUT00017-VND-RNKG-CDE                           16440000
106400              ,  :SUT00017-PKGNG-TYP-CDE                          16450000
106500              ,  :SUT00017-EFF-BEG-TMST                           16460000
106600              ,  :SUT00017-AUD-PCT                                16470000
106700              ,  :SUT00017-CKD-PCT                                16480000
106800              ,  :SUT00017-MAX-CKD-QTY                            16490000
106900              ,  :SUT00017-MAX-CART-CKD-QTY                       16500000
107000              ,  :SUT00017-MIN-CART-CKD-QTY                       16510000
107100              ,  :SUT00017-CKD-DC-QTY                             16520000
107200              ,  :SUT00017-MAX-PO-LNE-QTY                         16530000
107300              ,  :SUT00017-CK-AFT-DAY-QTY                         16540000
107400              ,  :SUT00017-CK-AFT-RCVR-QTY                        16550000
107500              ,  :PV-LIMIT-DAYS                                   16560000
107600          FROM   SUT_VND_DEPT_RNKG A                              16570000
107700             ,   SUT_PO_AUD_PARM   B                              16580000
107800          WHERE  A.ENT_ID        = :DK-ENT-ID                     16590000
107900            AND  A.DEPT_NBR      = :DK-DEPT-NBR                   16600000
108000            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              16610000
108100            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 16620000
108200            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                16630000
108300            AND  B.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         16640000
108400           WITH UR                                                16650000
108500     END-EXEC.                                                    16660000
108600                                                                  16670000
108700     EVALUATE TRUE                                                16680000
108800         WHEN SQLCODE = ZERO                                      16690000
108900             SET PS-DEPT-RANK-FOUND TO TRUE                       16700000
109000         WHEN SQLCODE = +100                                      16710000
109100             SET PS-NO-DEPT-RANK-FOUND TO TRUE                    16720000
109200         WHEN SQLWARN0 NOT = SPACES                               16730000
109300         WHEN SQLCODE NOT EQUAL ZERO                              16740000
109400             MOVE SQLCODE  TO PC259-SQL-CODE                      16750000
109500             MOVE '7200-RETREIVE-VENDOR-DEPT'                     16760000
109600                             TO PV-PARAGRAPH                      16770000
109700             MOVE 'PCKUT090 - GET VENDOR DEPT'                    16780000
109800                             TO PV-MESSAGE-TEXT-1                 16790000
109900             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                16800000
110000             STRING 'ENT ID: '         DELIMITED BY SIZE          16810000
110100                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          16820000
110200                           INTO PV-MESSAGE-TEXT-2                 16830000
110300             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              16840000
110400             STRING 'DEPT NBR: '       DELIMITED BY SIZE          16850000
110500                 PV-DISPLAY-DEPT-NBR   DELIMITED BY SIZE          16860000
110600                           INTO PV-MESSAGE-TEXT-3                 16870000
110700             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          16880000
110800                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          16890000
110900                           INTO PV-MESSAGE-TEXT-4                 16900000
111000             MOVE SQLCA      TO PC259-SQLCA                       16910000
111100             MOVE 'SUT00018' TO PV-DB2-TABLE-NAME-1               16920000
111200                                PC259-ERROR-TABLE-NME             16930000
111300             MOVE 'SUT00017' TO PV-DB2-TABLE-NAME-2               16940000
111400             SET PS-DB2-ABEND                                     16950000
111500                             TO TRUE                              16960000
111600                                                                  16970000
111700             SET PS-DUMP-TO-LOG       TO TRUE                     16980000
111800             SET PS-NO-PO-INFO-FOUND TO TRUE                      16990000
111900             SET PC259-DB2-ERROR TO TRUE                          17000000
112000             SET PC259-INVALID-SQL TO TRUE                        17010000
112100             PERFORM 9990-WRITE-DISPLAYS                          17020000
112200     END-EVALUATE.                                                17030000
112300                                                                  17040000
112400 7250-RETREIVE-VENDOR-DEPT.                                       17050000
112500                                                                  17060000
112600     EXEC SQL                                                     17070000
112700          SELECT B.VND_RNKG_CDE                                   17080000
112800              ,  B.PKGNG_TYP_CDE                                  17090000
112900              ,  EFF_BEG_TMST                                     17100000
113000              ,  AUD_PCT                                          17110000
113100              ,  CKD_PCT                                          17120000
113200              ,  MAX_CKD_QTY                                      17130000
113300              ,  MAX_CART_CKD_QTY                                 17140000
113400              ,  MIN_CART_CKD_QTY                                 17150000
113500              ,  CKD_DC_QTY                                       17160000
113600              ,  MAX_PO_LNE_QTY                                   17170000
113700              ,  CK_AFT_DAY_QTY                                   17180000
113800              ,  CK_AFT_RCVR_QTY                                  17190000
113900              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         17200000
114000          INTO   :SUT00017-VND-RNKG-CDE                           17210000
114100              ,  :SUT00017-PKGNG-TYP-CDE                          17220000
114200              ,  :SUT00017-EFF-BEG-TMST                           17230000
114300              ,  :SUT00017-AUD-PCT                                17240000
114400              ,  :SUT00017-CKD-PCT                                17250000
114500              ,  :SUT00017-MAX-CKD-QTY                            17260000
114600              ,  :SUT00017-MAX-CART-CKD-QTY                       17270000
114700              ,  :SUT00017-MIN-CART-CKD-QTY                       17280000
114800              ,  :SUT00017-CKD-DC-QTY                             17290000
114900              ,  :SUT00017-MAX-PO-LNE-QTY                         17300000
115000              ,  :SUT00017-CK-AFT-DAY-QTY                         17310000
115100              ,  :SUT00017-CK-AFT-RCVR-QTY                        17320000
115200              ,  :PV-LIMIT-DAYS                                   17330000
115300          FROM   SUT_VND_DEPT_RNKG A                              17340000
115400             ,   SUT_PO_AUD_PARM   B                              17350000
115500          WHERE  A.ENT_ID        = :DK-ENT-ID                     17360000
115600            AND  A.DEPT_NBR      = :DK-DEPT-NBR                   17370000
115700            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              17380000
115800            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 17390000
115900            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                17400000
116000            AND  B.EFF_BEG_TMST  =                                17410000
116100             (SELECT MAX(C.EFF_BEG_TMST)                          17420000
116200              FROM   SUT_PO_AUD_PARM C                            17430000
116300              WHERE  B.VND_RNKG_CDE  = C.VND_RNKG_CDE             17440000
116400                AND  B.PKGNG_TYP_CDE = C.PKGNG_TYP_CDE)           17450000
116500           WITH UR                                                17460000
116600     END-EXEC.                                                    17470000
116700                                                                  17480000
116800     EVALUATE TRUE                                                17490000
116900         WHEN SQLCODE = ZERO                                      17500000
117000             SET PS-DEPT-RANK-FOUND TO TRUE                       17510000
117100         WHEN SQLCODE = +100                                      17520000
117200             SET PS-NO-DEPT-RANK-FOUND TO TRUE                    17530000
117300         WHEN SQLWARN0 NOT = SPACES                               17540000
117400         WHEN SQLCODE NOT EQUAL ZERO                              17550000
117500             MOVE SQLCODE  TO PC259-SQL-CODE                      17560000
117600             MOVE '7250-RETREIVE-VENDOR-DEPT'                     17570000
117700                             TO PV-PARAGRAPH                      17580000
117800             MOVE 'PCKUT090 - GET VENDOR DEPT'                    17590000
117900                             TO PV-MESSAGE-TEXT-1                 17600000
118000             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                17610000
118100             STRING 'ENT ID: '         DELIMITED BY SIZE          17620000
118200                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          17630000
118300                           INTO PV-MESSAGE-TEXT-2                 17640000
118400             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              17650000
118500             STRING 'DEPT NBR: '       DELIMITED BY SIZE          17660000
118600                 PV-DISPLAY-DEPT-NBR   DELIMITED BY SIZE          17670000
118700                           INTO PV-MESSAGE-TEXT-3                 17680000
118800             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          17690000
118900                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          17700000
119000                           INTO PV-MESSAGE-TEXT-4                 17710000
119100             MOVE SQLCA      TO PC259-SQLCA                       17720000
119200             MOVE 'SUT00018' TO PV-DB2-TABLE-NAME-1               17730000
119300                                PC259-ERROR-TABLE-NME             17740000
119400             MOVE 'SUT00017' TO PV-DB2-TABLE-NAME-2               17750000
119500             SET PS-DB2-ABEND                                     17760000
119600                             TO TRUE                              17770000
119700                                                                  17780000
119800             SET PS-DUMP-TO-LOG       TO TRUE                     17790000
119900             SET PS-NO-PO-INFO-FOUND TO TRUE                      17800000
120000             SET PC259-DB2-ERROR TO TRUE                          17810000
120100             SET PC259-INVALID-SQL TO TRUE                        17820000
120200             PERFORM 9990-WRITE-DISPLAYS                          17830000
120300     END-EVALUATE.                                                17840000
120400                                                                  17850000
120500 7300-RETREIVE-VENDOR-RANK.                                       17860000
120600                                                                  17870000
120700     EXEC SQL                                                     17880000
120800          SELECT B.VND_RNKG_CDE                                   17890000
120900              ,  B.PKGNG_TYP_CDE                                  17900000
121000              ,  EFF_BEG_TMST                                     17910000
121100              ,  AUD_PCT                                          17920000
121200              ,  CKD_PCT                                          17930000
121300              ,  MAX_CKD_QTY                                      17940000
121400              ,  MAX_CART_CKD_QTY                                 17950000
121500              ,  MIN_CART_CKD_QTY                                 17960000
121600              ,  CKD_DC_QTY                                       17970000
121700              ,  MAX_PO_LNE_QTY                                   17980000
121800              ,  CK_AFT_DAY_QTY                                   17990000
121900              ,  CK_AFT_RCVR_QTY                                  18000000
122000              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         18010000
122100          INTO   :SUT00017-VND-RNKG-CDE                           18020000
122200              ,  :SUT00017-PKGNG-TYP-CDE                          18030000
122300              ,  :SUT00017-EFF-BEG-TMST                           18040000
122400              ,  :SUT00017-AUD-PCT                                18050000
122500              ,  :SUT00017-CKD-PCT                                18060000
122600              ,  :SUT00017-MAX-CKD-QTY                            18070000
122700              ,  :SUT00017-MAX-CART-CKD-QTY                       18080000
122800              ,  :SUT00017-MIN-CART-CKD-QTY                       18090000
122900              ,  :SUT00017-CKD-DC-QTY                             18100000
123000              ,  :SUT00017-MAX-PO-LNE-QTY                         18110000
123100              ,  :SUT00017-CK-AFT-DAY-QTY                         18120000
123200              ,  :SUT00017-CK-AFT-RCVR-QTY                        18130000
123300              ,  :PV-LIMIT-DAYS                                   18140000
123400          FROM   SUT_VND_RNKG      A                              18150000
123500             ,   SUT_PO_AUD_PARM   B                              18160000
123600          WHERE  A.ENT_ID        = :DK-ENT-ID                     18170000
123700            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              18180000
123800            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 18190000
123900            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                18200000
124000            AND  B.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         18210000
124100           WITH UR                                                18220000
124200     END-EXEC.                                                    18230000
124300                                                                  18240000
124400     EVALUATE TRUE                                                18250000
124500         WHEN SQLCODE = ZERO                                      18260000
124600             SET PS-VEND-RANK-FOUND TO TRUE                       18270000
124700         WHEN SQLCODE = +100                                      18280000
124800             SET PS-NO-VEND-RANK-FOUND TO TRUE                    18290000
124900         WHEN SQLWARN0 NOT = SPACES                               18300000
125000         WHEN SQLCODE NOT EQUAL ZERO                              18310000
125100             MOVE SQLCODE  TO PC259-SQL-CODE                      18320000
125200             MOVE '7300-RETREIVE-VENDOR-RANK'                     18330000
125300                             TO PV-PARAGRAPH                      18340000
125400             MOVE 'PCKUT090 - GET VENDOR RANK'                    18350000
125500                             TO PV-MESSAGE-TEXT-1                 18360000
125600             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                18370000
125700             STRING 'ENT ID: '         DELIMITED BY SIZE          18380000
125800                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          18390000
125900                           INTO PV-MESSAGE-TEXT-2                 18400000
126000             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          18410000
126100                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          18420000
126200                           INTO PV-MESSAGE-TEXT-3                 18430000
126300             STRING 'TIMESTAMP: '      DELIMITED BY SIZE          18440000
126400                 SUT00015-EFF-BEG-TMST DELIMITED BY SIZE          18450000
126500                           INTO PV-MESSAGE-TEXT-4                 18460000
126600             MOVE SQLCA      TO PC259-SQLCA                       18470000
126700             MOVE 'SUT00019' TO PV-DB2-TABLE-NAME-1               18480000
126800                                PC259-ERROR-TABLE-NME             18490000
126900             MOVE 'SUT00017' TO PV-DB2-TABLE-NAME-2               18500000
127000             SET PS-DB2-ABEND                                     18510000
127100                             TO TRUE                              18520000
127200                                                                  18530000
127300             SET PS-DUMP-TO-LOG       TO TRUE                     18540000
127400             SET PS-NO-PO-INFO-FOUND TO TRUE                      18550000
127500             SET PC259-DB2-ERROR TO TRUE                          18560000
127600             SET PC259-INVALID-SQL TO TRUE                        18570000
127700             PERFORM 9990-WRITE-DISPLAYS                          18580000
127800     END-EVALUATE.                                                18590000
127900                                                                  18600000
128000 7350-RETREIVE-VENDOR-RANK.                                       18610000
128100                                                                  18620000
128200     EXEC SQL                                                     18630000
128300          SELECT B.VND_RNKG_CDE                                   18640000
128400              ,  B.PKGNG_TYP_CDE                                  18650000
128500              ,  EFF_BEG_TMST                                     18660000
128600              ,  AUD_PCT                                          18670000
128700              ,  CKD_PCT                                          18680000
128800              ,  MAX_CKD_QTY                                      18690000
128900              ,  MAX_CART_CKD_QTY                                 18700000
129000              ,  MIN_CART_CKD_QTY                                 18710000
129100              ,  CKD_DC_QTY                                       18720000
129200              ,  MAX_PO_LNE_QTY                                   18730000
129300              ,  CK_AFT_DAY_QTY                                   18740000
129400              ,  CK_AFT_RCVR_QTY                                  18750000
129500              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         18760000
129600          INTO   :SUT00017-VND-RNKG-CDE                           18770000
129700              ,  :SUT00017-PKGNG-TYP-CDE                          18780000
129800              ,  :SUT00017-EFF-BEG-TMST                           18790000
129900              ,  :SUT00017-AUD-PCT                                18800000
130000              ,  :SUT00017-CKD-PCT                                18810000
130100              ,  :SUT00017-MAX-CKD-QTY                            18820000
130200              ,  :SUT00017-MAX-CART-CKD-QTY                       18830000
130300              ,  :SUT00017-MIN-CART-CKD-QTY                       18840000
130400              ,  :SUT00017-CKD-DC-QTY                             18850000
130500              ,  :SUT00017-MAX-PO-LNE-QTY                         18860000
130600              ,  :SUT00017-CK-AFT-DAY-QTY                         18870000
130700              ,  :SUT00017-CK-AFT-RCVR-QTY                        18880000
130800              ,  :PV-LIMIT-DAYS                                   18890000
130900          FROM   SUT_VND_RNKG      A                              18900000
131000             ,   SUT_PO_AUD_PARM   B                              18910000
131100          WHERE  A.ENT_ID        = :DK-ENT-ID                     18920000
131200            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              18930000
131300            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 18940000
131400            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                18950000
131500            AND  B.EFF_BEG_TMST  =                                18960000
131600             (SELECT MAX(C.EFF_BEG_TMST)                          18970000
131700              FROM   SUT_PO_AUD_PARM   C                          18980000
131800              WHERE  B.VND_RNKG_CDE  = C.VND_RNKG_CDE             18990000
131900                AND  B.PKGNG_TYP_CDE = C.PKGNG_TYP_CDE)           19000000
132000           WITH UR                                                19010000
132100     END-EXEC.                                                    19020000
132200                                                                  19030000
132300     EVALUATE TRUE                                                19040000
132400         WHEN SQLCODE = ZERO                                      19050000
132500             SET PS-VEND-RANK-FOUND TO TRUE                       19060000
132600         WHEN SQLCODE = +100                                      19070000
132700             SET PS-NO-VEND-RANK-FOUND TO TRUE                    19080000
132800         WHEN SQLWARN0 NOT = SPACES                               19090000
132900         WHEN SQLCODE NOT EQUAL ZERO                              19100000
133000             MOVE SQLCODE  TO PC259-SQL-CODE                      19110000
133100             MOVE '7350-RETREIVE-VENDOR-RANK'                     19120000
133200                             TO PV-PARAGRAPH                      19130000
133300             MOVE 'PCKUT090 - GET VENDOR RANK'                    19140000
133400                             TO PV-MESSAGE-TEXT-1                 19150000
133500             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                19160000
133600             STRING 'ENT ID: '         DELIMITED BY SIZE          19170000
133700                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          19180000
133800                           INTO PV-MESSAGE-TEXT-2                 19190000
133900             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          19200000
134000                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          19210000
134100                           INTO PV-MESSAGE-TEXT-3                 19220000
134200             MOVE SQLCA      TO PC259-SQLCA                       19230000
134300             MOVE 'SUT00019' TO PV-DB2-TABLE-NAME-1               19240000
134400                                PC259-ERROR-TABLE-NME             19250000
134500             MOVE 'SUT00017' TO PV-DB2-TABLE-NAME-2               19260000
134600             SET PS-DB2-ABEND                                     19270000
134700                             TO TRUE                              19280000
134800                                                                  19290000
134900             SET PS-DUMP-TO-LOG       TO TRUE                     19300000
135000             SET PS-NO-PO-INFO-FOUND TO TRUE                      19310000
135100             SET PC259-DB2-ERROR TO TRUE                          19320000
135200             SET PC259-INVALID-SQL TO TRUE                        19330000
135300             PERFORM 9990-WRITE-DISPLAYS                          19340000
135400     END-EVALUATE.                                                19350000
135500                                                                  19360000
135600 7400-RETREIVE-DEFAULT-RANK.                                      19370000
135700                                                                  19380000
135800     EXEC SQL                                                     19390000
135900          SELECT VND_RNKG_CDE                                     19400000
136000              ,  PKGNG_TYP_CDE                                    19410000
136100              ,  EFF_BEG_TMST                                     19420000
136200              ,  AUD_PCT                                          19430000
136300              ,  CKD_PCT                                          19440000
136400              ,  MAX_CKD_QTY                                      19450000
136500              ,  MAX_CART_CKD_QTY                                 19460000
136600              ,  MIN_CART_CKD_QTY                                 19470000
136700              ,  CKD_DC_QTY                                       19480000
136800              ,  MAX_PO_LNE_QTY                                   19490000
136900              ,  CK_AFT_DAY_QTY                                   19500000
137000              ,  CK_AFT_RCVR_QTY                                  19510000
137100              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         19520000
137200          INTO   :SUT00017-VND-RNKG-CDE                           19530000
137300              ,  :SUT00017-PKGNG-TYP-CDE                          19540000
137400              ,  :SUT00017-EFF-BEG-TMST                           19550000
137500              ,  :SUT00017-AUD-PCT                                19560000
137600              ,  :SUT00017-CKD-PCT                                19570000
137700              ,  :SUT00017-MAX-CKD-QTY                            19580000
137800              ,  :SUT00017-MAX-CART-CKD-QTY                       19590000
137900              ,  :SUT00017-MIN-CART-CKD-QTY                       19600000
138000              ,  :SUT00017-CKD-DC-QTY                             19610000
138100              ,  :SUT00017-MAX-PO-LNE-QTY                         19620000
138200              ,  :SUT00017-CK-AFT-DAY-QTY                         19630000
138300              ,  :SUT00017-CK-AFT-RCVR-QTY                        19640000
138400              ,  :PV-LIMIT-DAYS                                   19650000
138500          FROM   SUT_PO_AUD_PARM                                  19660000
138600          WHERE  PKGNG_TYP_CDE   = :DK-PKGNG-TYP-CDE              19670000
138700            AND  VND_RNKG_CDE    = :PC-DEFAULT                    19680000
138800            AND  EFF_BEG_TMST    = :SUT00015-EFF-BEG-TMST         19690000
138900           WITH UR                                                19700000
139000     END-EXEC.                                                    19710000
139100                                                                  19720000
139200     EVALUATE TRUE                                                19730000
139300         WHEN SQLCODE = ZERO                                      19740000
139400             SET PS-DEFAULT-RANK-FOUND TO TRUE                    19750000
139500         WHEN SQLCODE = +100                                      19760000
139600             SET PS-NO-DEFAULT-RANK-FOUND TO TRUE                 19770000
139700         WHEN SQLWARN0 NOT = SPACES                               19780000
139800         WHEN SQLCODE NOT EQUAL ZERO                              19790000
139900             MOVE SQLCODE  TO PC259-SQL-CODE                      19800000
140000             MOVE '7400-RETREIVE-DEFAULT-RANK'                    19810000
140100                             TO PV-PARAGRAPH                      19820000
140200             MOVE 'PCKUT090 - GET DEFAULT RANK'                   19830000
140300                             TO PV-MESSAGE-TEXT-1                 19840000
140400             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                19850000
140500             STRING 'ENT ID: '         DELIMITED BY SIZE          19860000
140600                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          19870000
140700                           INTO PV-MESSAGE-TEXT-2                 19880000
140800             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          19890000
140900                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          19900000
141000                           INTO PV-MESSAGE-TEXT-3                 19910000
141100             STRING 'TIMESTAMP: '      DELIMITED BY SIZE          19920000
141200                 SUT00015-EFF-BEG-TMST DELIMITED BY SIZE          19930000
141300                           INTO PV-MESSAGE-TEXT-4                 19940000
141400             MOVE SQLCA      TO PC259-SQLCA                       19950000
141500             MOVE 'SUT00019' TO PV-DB2-TABLE-NAME-1               19960000
141600                                PC259-ERROR-TABLE-NME             19970000
141700             MOVE 'SUT00017' TO PV-DB2-TABLE-NAME-2               19980000
141800             SET PS-DB2-ABEND                                     19990000
141900                             TO TRUE                              20000000
142000                                                                  20010000
142100             SET PS-DUMP-TO-LOG       TO TRUE                     20020000
142200             SET PS-NO-PO-INFO-FOUND TO TRUE                      20030000
142300             SET PC259-DB2-ERROR TO TRUE                          20040000
142400             SET PC259-INVALID-SQL TO TRUE                        20050000
142500             PERFORM 9990-WRITE-DISPLAYS                          20060000
142600     END-EVALUATE.                                                20070000
142700                                                                  20080000
142800 7450-RETREIVE-DEFAULT-RANK.                                      20090000
142900                                                                  20100000
143000     EXEC SQL                                                     20110000
143100          SELECT VND_RNKG_CDE                                     20120000
143200              ,  PKGNG_TYP_CDE                                    20130000
143300              ,  EFF_BEG_TMST                                     20140000
143400              ,  AUD_PCT                                          20150000
143500              ,  CKD_PCT                                          20160000
143600              ,  MAX_CKD_QTY                                      20170000
143700              ,  MAX_CART_CKD_QTY                                 20180000
143800              ,  MIN_CART_CKD_QTY                                 20190000
143900              ,  CKD_DC_QTY                                       20200000
144000              ,  MAX_PO_LNE_QTY                                   20210000
144100              ,  CK_AFT_DAY_QTY                                   20220000
144200              ,  CK_AFT_RCVR_QTY                                  20230000
144300              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         20240000
144400          INTO   :SUT00017-VND-RNKG-CDE                           20250000
144500              ,  :SUT00017-PKGNG-TYP-CDE                          20260000
144600              ,  :SUT00017-EFF-BEG-TMST                           20270000
144700              ,  :SUT00017-AUD-PCT                                20280000
144800              ,  :SUT00017-CKD-PCT                                20290000
144900              ,  :SUT00017-MAX-CKD-QTY                            20300000
145000              ,  :SUT00017-MAX-CART-CKD-QTY                       20310000
145100              ,  :SUT00017-MIN-CART-CKD-QTY                       20320000
145200              ,  :SUT00017-CKD-DC-QTY                             20330000
145300              ,  :SUT00017-MAX-PO-LNE-QTY                         20340000
145400              ,  :SUT00017-CK-AFT-DAY-QTY                         20350000
145500              ,  :SUT00017-CK-AFT-RCVR-QTY                        20360000
145600              ,  :PV-LIMIT-DAYS                                   20370000
145700          FROM   SUT_PO_AUD_PARM A                                20380000
145800          WHERE  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              20390000
145900            AND  A.VND_RNKG_CDE  = :PC-DEFAULT                    20400000
146000            AND  A.EFF_BEG_TMST  =                                20410000
146100             (SELECT MAX(B.EFF_BEG_TMST)                          20420000
146200              FROM   SUT_PO_AUD_PARM   B                          20430000
146300              WHERE  A.VND_RNKG_CDE  = B.VND_RNKG_CDE             20440000
146400                AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE)           20450000
146500           WITH UR                                                20460000
146600     END-EXEC.                                                    20470000
146700                                                                  20480000
146800     EVALUATE TRUE                                                20490000
146900         WHEN SQLCODE = ZERO                                      20500000
147000             SET PS-DEFAULT-RANK-FOUND TO TRUE                    20510000
147100         WHEN SQLCODE = +100                                      20520000
147200             SET PS-NO-DEFAULT-RANK-FOUND TO TRUE                 20530000
147300         WHEN SQLWARN0 NOT = SPACES                               20540000
147400         WHEN SQLCODE NOT EQUAL ZERO                              20550000
147500             MOVE SQLCODE  TO PC259-SQL-CODE                      20560000
147600             MOVE '7450-RETREIVE-DEFAULT-RANK'                    20570000
147700                             TO PV-PARAGRAPH                      20580000
147800             MOVE 'PCKUT090 - GET DEFAULT RANK'                   20590000
147900                             TO PV-MESSAGE-TEXT-1                 20600000
148000             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                20610000
148100             STRING 'ENT ID: '         DELIMITED BY SIZE          20620000
148200                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          20630000
148300                           INTO PV-MESSAGE-TEXT-2                 20640000
148400             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          20650000
148500                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          20660000
148600                           INTO PV-MESSAGE-TEXT-3                 20670000
148700             MOVE SQLCA      TO PC259-SQLCA                       20680000
148800             MOVE 'SUT00019' TO PV-DB2-TABLE-NAME-1               20690000
148900                                PC259-ERROR-TABLE-NME             20700000
149000             MOVE 'SUT00017' TO PV-DB2-TABLE-NAME-2               20710000
149100             SET PS-DB2-ABEND                                     20720000
149200                             TO TRUE                              20730000
149300                                                                  20740000
149400             SET PS-DUMP-TO-LOG       TO TRUE                     20750000
149500             SET PS-NO-PO-INFO-FOUND TO TRUE                      20760000
149600             SET PC259-DB2-ERROR TO TRUE                          20770000
149700             SET PC259-INVALID-SQL TO TRUE                        20780000
149800             PERFORM 9990-WRITE-DISPLAYS                          20790000
149900     END-EVALUATE.                                                20800000
150000                                                                  20810000
150100 7500-SELECT-BULK.                                                20820000
150200                                                                  20830000
150300     EXEC SQL                                                     20840000
150400          SELECT AUD_TYP_CDE                                      20850000
150500              ,  CRE_TMST                                         20860000
150600              ,  LAST_UPD_TMST                                    20870000
150700              ,  LAST_UPD_BY_USR_ID                               20880000
150800          INTO   :SUT00014-AUD-TYP-CDE                            20890000
150900              ,  :SUT00014-CRE-TMST                               20900000
151000              ,  :SUT00014-LAST-UPD-TMST                          20910000
151100              ,  :SUT00014-LAST-UPD-BY-USR-ID                     20920000
151200          FROM   SUT_PO_AUD_EXC                                   20930000
151300          WHERE  PO_NBR        = :DK-PO-NBR                       20940000
151400            AND  PO_LNE_NBR    = :DK-PO-LINE-NBR                  20950000
151500            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  20960000
151600           WITH UR                                                20970000
151700     END-EXEC.                                                    20980000
151800                                                                  20990000
151900     EVALUATE TRUE                                                21000000
152000         WHEN SQLCODE = ZERO                                      21010000
152100             SET PS-LINE-LEVEL-FOUND  TO TRUE                     21020000
152200             MOVE 'PS-LINE-LEVEL-FOUND ' TO PV-BTCH-MSG-AREA      21030000
152300         WHEN SQLCODE = +100                                      21040000
152400             CONTINUE                                             21050000
152500         WHEN SQLWARN0 NOT = SPACES                               21060000
152600         WHEN SQLCODE NOT EQUAL ZERO                              21070000
152700             MOVE SQLCODE  TO PC259-SQL-CODE                      21080000
152800             MOVE '7500-SELECT-BULK'                              21090000
152900                             TO PV-PARAGRAPH                      21100000
153000             MOVE 'PCKUT090 - GET PRE-PACK'                       21110000
153100                             TO PV-MESSAGE-TEXT-1                 21120000
153200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 21130000
153300             STRING 'PO NBR: '         DELIMITED BY SIZE          21140000
153400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          21150000
153500                           INTO PV-MESSAGE-TEXT-2                 21160000
153600             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        21170000
153700             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          21180000
153800                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          21190000
153900                           INTO PV-MESSAGE-TEXT-3                 21200000
154000             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        21210000
154100             STRING 'OPER UNIT: '      DELIMITED BY SIZE          21220000
154200                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          21230000
154300                           INTO PV-MESSAGE-TEXT-4                 21240000
154400             MOVE SQLCA      TO PC259-SQLCA                       21250000
154500             MOVE 'SUT00014' TO PV-DB2-TABLE-NAME-1               21260000
154600                                PC259-ERROR-TABLE-NME             21270000
154700             SET PS-DB2-ABEND                                     21280000
154800                             TO TRUE                              21290000
154900                                                                  21300000
155000             SET PS-DUMP-TO-LOG       TO TRUE                     21310000
155100             SET PS-NO-PO-INFO-FOUND TO TRUE                      21320000
155200             SET PC259-DB2-ERROR TO TRUE                          21330000
155300             SET PC259-INVALID-SQL TO TRUE                        21340000
155400             PERFORM 9990-WRITE-DISPLAYS                          21350000
155500     END-EVALUATE.                                                21360000
155600                                                                  21370000
155700 7550-SELECT-PRE-PACK.                                            21380000
155800                                                                  21390000
155900     EXEC SQL                                                     21400000
156000          SELECT AUD_TYP_CDE                                      21410000
156100              ,  CRE_TMST                                         21420000
156200              ,  LAST_UPD_TMST                                    21430000
156300              ,  LAST_UPD_BY_USR_ID                               21440000
156400          INTO   :SUT00014-AUD-TYP-CDE                            21450000
156500              ,  :SUT00014-CRE-TMST                               21460000
156600              ,  :SUT00014-LAST-UPD-TMST                          21470000
156700              ,  :SUT00014-LAST-UPD-BY-USR-ID                     21480000
156800          FROM   SUT_PO_AUD_EXC                                   21490000
156900          WHERE  PO_NBR        = :DK-PO-NBR                       21500000
157000            AND  PO_PREPK_ID   = :DK-PREPK-ID                     21510000
157100            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  21520000
157200           WITH UR                                                21530000
157300     END-EXEC.                                                    21540000
157400                                                                  21550000
157500     EVALUATE TRUE                                                21560000
157600         WHEN SQLCODE = ZERO                                      21570000
157700             SET PS-LINE-LEVEL-FOUND  TO TRUE                     21580000
157800             MOVE 'PS-LINE-LEVEL-FOUND ' TO PV-BTCH-MSG-AREA      21590000
157900         WHEN SQLCODE = +100                                      21600000
158000             CONTINUE                                             21610000
158100         WHEN SQLWARN0 NOT = SPACES                               21620000
158200         WHEN SQLCODE NOT EQUAL ZERO                              21630000
158300             MOVE SQLCODE  TO PC259-SQL-CODE                      21640000
158400             MOVE '7550-SELECT-PRE-PACK'                          21650000
158500                             TO PV-PARAGRAPH                      21660000
158600             MOVE 'PCKUT090 - GET PRE-PACK'                       21670000
158700                             TO PV-MESSAGE-TEXT-1                 21680000
158800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 21690000
158900             STRING 'PO NBR: '         DELIMITED BY SIZE          21700000
159000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          21710000
159100                           INTO PV-MESSAGE-TEXT-2                 21720000
159200             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           21730000
159300             STRING 'PRE PACK ID: '    DELIMITED BY SIZE          21740000
159400                PV-DISPLAY-PREPK-ID    DELIMITED BY SIZE          21750000
159500                           INTO PV-MESSAGE-TEXT-3                 21760000
159600             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        21770000
159700             STRING 'OPER UNIT: '      DELIMITED BY SIZE          21780000
159800                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          21790000
159900                           INTO PV-MESSAGE-TEXT-4                 21800000
160000             MOVE SQLCA      TO PC259-SQLCA                       21810000
160100             MOVE 'SUT00014' TO PV-DB2-TABLE-NAME-1               21820000
160200                                PC259-ERROR-TABLE-NME             21830000
160300             SET PS-DB2-ABEND                                     21840000
160400                             TO TRUE                              21850000
160500                                                                  21860000
160600             SET PS-DUMP-TO-LOG       TO TRUE                     21870000
160700             SET PS-NO-PO-INFO-FOUND TO TRUE                      21880000
160800             SET PC259-DB2-ERROR TO TRUE                          21890000
160900             SET PC259-INVALID-SQL TO TRUE                        21900000
161000             PERFORM 9990-WRITE-DISPLAYS                          21910000
161100     END-EVALUATE.                                                21920000
161200                                                                  21930000
161300 7600-SELECT-PO-LEVEL.                                            21940000
161400                                                                  21950000
161500     EXEC SQL                                                     21960000
161600          SELECT AUD_TYP_CDE                                      21970000
161700              ,  CRE_TMST                                         21980000
161800              ,  LAST_UPD_TMST                                    21990000
161900              ,  LAST_UPD_BY_USR_ID                               22000000
162000          INTO   :SUT00014-AUD-TYP-CDE                            22010000
162100              ,  :SUT00014-CRE-TMST                               22020000
162200              ,  :SUT00014-LAST-UPD-TMST                          22030000
162300              ,  :SUT00014-LAST-UPD-BY-USR-ID                     22040000
162400          FROM   SUT_PO_AUD_EXC                                   22050000
162500          WHERE  PO_NBR        = :DK-PO-NBR                       22060000
162600            AND  PO_LNE_NBR    = 0                                22070000
162700            AND  PO_PREPK_ID   = 0                                22080000
162800            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  22090000
162900           WITH UR                                                22100000
163000     END-EXEC.                                                    22110000
163100                                                                  22120000
163200     EVALUATE TRUE                                                22130000
163300         WHEN SQLCODE = ZERO                                      22140000
163400             SET PS-PO-LEVEL-FOUND  TO TRUE                       22150000
163500             MOVE 'PS-PO-LEVEL-FOUND ' TO PV-BTCH-MSG-AREA        22160000
163600         WHEN SQLCODE = +100                                      22170000
163700             CONTINUE                                             22180000
163800         WHEN SQLWARN0 NOT = SPACES                               22190000
163900         WHEN SQLCODE NOT EQUAL ZERO                              22200000
164000             MOVE SQLCODE  TO PC259-SQL-CODE                      22210000
164100             MOVE '7600-SELECT-PO-LEVEL'                          22220000
164200                             TO PV-PARAGRAPH                      22230000
164300             MOVE 'PCKUT090 - GET PRE-PACK'                       22240000
164400                             TO PV-MESSAGE-TEXT-1                 22250000
164500             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 22260000
164600             STRING 'PO NBR: '         DELIMITED BY SIZE          22270000
164700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          22280000
164800                           INTO PV-MESSAGE-TEXT-2                 22290000
164900             MOVE SQLCA      TO PC259-SQLCA                       22300000
165000             MOVE 'SUT00014' TO PV-DB2-TABLE-NAME-1               22310000
165100                                PC259-ERROR-TABLE-NME             22320000
165200             SET PS-DB2-ABEND                                     22330000
165300                             TO TRUE                              22340000
165400                                                                  22350000
165500             SET PS-DUMP-TO-LOG       TO TRUE                     22360000
165600             SET PS-NO-PO-INFO-FOUND TO TRUE                      22370000
165700             SET PC259-DB2-ERROR TO TRUE                          22380000
165800             SET PC259-INVALID-SQL TO TRUE                        22390000
165900             PERFORM 9990-WRITE-DISPLAYS                          22400000
166000     END-EVALUATE.                                                22410000
166100                                                                  22420000
166200 7700-SELECT-FAILED.                                              22430000
166300                                                                  22440000
      *SB 01/10/14 - BEGIN PR#5148D                                     22450000
           IF PS-RFID-AUDIT-CHECK                                       22460000
              MOVE DK-PO-LINE-NBR TO PV-TEMP-PO-LINE-NBR                22470000
              MOVE DK-PREPK-ID    TO PV-TEMP-PREPK-ID                   22480000
              MOVE 0     TO DK-PO-LINE-NBR                              22490000
              MOVE -9999 TO DK-PREPK-ID                                 22500000
           END-IF.                                                      22510000
      *SB 01/10/14 - END PR#5148D                                       22520000
                                                                        22530000
166400     EXEC SQL                                                     22540000
166500          SELECT AUD_CNTL_NBR                                     22550000
166600              ,  UNT_QTY                                          22560000
166700          INTO   :SUT00015-AUD-CNTL-NBR                           22570000
166800              ,  :SUT00015-UNT-QTY                                22580000
166900          FROM   SUT_PO_AUD_REQ                                   22590000
167000          WHERE  PO_NBR         = :DK-PO-NBR                      22600000
167100            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 22610000
167200            AND  PO_PREPK_ID    = :DK-PREPK-ID                    22620000
167300            AND  AUD_STAT_CDE   = :PC-F                           22630000
167400            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  22640000
167500           WITH UR                                                22650000
167600     END-EXEC.                                                    22660000
167700                                                                  22670000
167800     EVALUATE TRUE                                                22680000
167900         WHEN SQLCODE = ZERO                                      22690000
168000         WHEN SQLCODE = -811                                      22700000
168100             SET PS-FAILED-AUDITS-FOUND TO TRUE                   22710000
168200             MOVE 'PS-FAILED-AUDITS-FOUND ' TO PV-BTCH-MSG-AREA   22720000
168300         WHEN SQLCODE = +100                                      22730000
168400             CONTINUE                                             22740000
168500         WHEN SQLWARN0 NOT = SPACES                               22750000
168600         WHEN SQLCODE NOT EQUAL ZERO                              22760000
168700             MOVE SQLCODE  TO PC259-SQL-CODE                      22770000
168800             MOVE '7700-SELECT-FAILED'                            22780000
168900                             TO PV-PARAGRAPH                      22790000
169000             MOVE 'PCKUT090 - GET FAILED AUDITS'                  22800000
169100                             TO PV-MESSAGE-TEXT-1                 22810000
169200             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 22820000
169300             STRING 'PO NBR: '         DELIMITED BY SIZE          22830000
169400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          22840000
169500                           INTO PV-MESSAGE-TEXT-2                 22850000
169600             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        22860000
169700             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          22870000
169800                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          22880000
169900                           INTO PV-MESSAGE-TEXT-3                 22890000
170000             MOVE SQLCA      TO PC259-SQLCA                       22900000
170100             MOVE 'SUT00015' TO PV-DB2-TABLE-NAME-1               22910000
170200                                PC259-ERROR-TABLE-NME             22920000
170300             SET PS-DB2-ABEND                                     22930000
170400                             TO TRUE                              22940000
170500                                                                  22950000
170600             SET PS-DUMP-TO-LOG       TO TRUE                     22960000
170700             SET PC259-DB2-ERROR TO TRUE                          22970000
170800             SET PC259-INVALID-SQL TO TRUE                        22980000
170900             PERFORM 9990-WRITE-DISPLAYS                          22990000
171000     END-EVALUATE.                                                23000000
171100                                                                  23010000
      *SB 01/10/14 - BEGIN PR#5148D                                     23020000
           IF PS-RFID-AUDIT-CHECK                                       23030000
              MOVE PV-TEMP-PO-LINE-NBR TO DK-PO-LINE-NBR                23040000
              MOVE PV-TEMP-PREPK-ID    TO DK-PREPK-ID                   23050000
           END-IF.                                                      23060000
      *SB 01/10/14 - END PR#5148D                                       23070000
                                                                        23080000
171110 7750-SELECT-FAILED-COUNT.                                        23090000
171111                                                                  23100000
171120     MOVE +0  TO PV-AUDIT-FAIL-COUNT.                             23110000
171121                                                                  23120000
           IF PS-QC-AUDIT-CHECK                                         23130000
171130        EXEC SQL                                                  23140000
171140             SELECT COUNT(AUD_CNTL_NBR)                           23150000
171160             INTO   :PV-AUDIT-FAIL-COUNT                          23160000
171180             FROM   SUT_PO_AUD_REQ                                23170000
171190             WHERE  PO_NBR         = :DK-PO-NBR                   23180000
171193               AND  AUD_STAT_CDE   = :PC-F                        23190000
                     AND  PKGNG_TYP_CDE <> :PC-RF                       23200000
171194               AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS               23210000
171195              WITH UR                                             23220000
171196        END-EXEC                                                  23230000
      *SB 01/10/14 - BEGIN PR#5148D                                     23240000
           ELSE IF PS-RFID-AUDIT-CHECK                                  23250000
171130             EXEC SQL                                             23260000
171140                 SELECT COUNT(AUD_CNTL_NBR)                       23270000
171160                 INTO   :PV-AUDIT-FAIL-COUNT                      23280000
171180                 FROM   SUT_PO_AUD_REQ                            23290000
171190                 WHERE  PO_NBR         = :DK-PO-NBR               23300000
171193                   AND  AUD_STAT_CDE   = :PC-F                    23310000
                         AND  PKGNG_TYP_CDE  = :PC-RF                   23320000
171194                   AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS           23330000
171195                  WITH UR                                         23340000
171196            END-EXEC                                              23350000
                END-IF                                                  23360000
      *SB 01/10/14 - END PR#5148D                                       23370000
           END-IF.                                                      23380000
171197                                                                  23390000
171198     EVALUATE TRUE                                                23400000
171199         WHEN SQLCODE = ZERO                                      23410000
171200             CONTINUE                                             23420000
171203         WHEN SQLCODE = +100                                      23430000
171204             CONTINUE                                             23440000
171205         WHEN SQLWARN0 NOT = SPACES                               23450000
171206         WHEN SQLCODE NOT EQUAL ZERO                              23460000
171207             MOVE SQLCODE  TO PC259-SQL-CODE                      23470000
171208             MOVE '7750-SELECT-FAILED-COUNT '                     23480000
171209                             TO PV-PARAGRAPH                      23490000
171210             MOVE 'PCKUT090 -COUNT FAILED AUDITS'                 23500000
171211                             TO PV-MESSAGE-TEXT-1                 23510000
171212             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 23520000
171213             STRING 'PO NBR: '         DELIMITED BY SIZE          23530000
171214                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          23540000
171215                           INTO PV-MESSAGE-TEXT-2                 23550000
171216             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        23560000
171217             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          23570000
171218                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          23580000
171219                           INTO PV-MESSAGE-TEXT-3                 23590000
171220             MOVE SQLCA      TO PC259-SQLCA                       23600000
171221             MOVE 'SUT00015' TO PV-DB2-TABLE-NAME-1               23610000
171222                                PC259-ERROR-TABLE-NME             23620000
171223             SET PS-DB2-ABEND                                     23630000
171224                             TO TRUE                              23640000
171225                                                                  23650000
171226             SET PS-DUMP-TO-LOG       TO TRUE                     23660000
171227             SET PC259-DB2-ERROR TO TRUE                          23670000
171228             SET PC259-INVALID-SQL TO TRUE                        23680000
171229             PERFORM 9990-WRITE-DISPLAYS                          23690000
171230     END-EVALUATE.                                                23700000
171231                                                                  23710000
171240 7800-SELECT-PASSED.                                              23720000
171300                                                                  23730000
171400     MOVE 0         TO PV-PASSED-COUNT.                           23740000
                                                                        23750000
      *SB 01/10/14 - BEGIN PR#5148D                                     23760000
           IF PS-RFID-AUDIT-CHECK                                       23770000
              MOVE DK-PO-LINE-NBR TO PV-TEMP-PO-LINE-NBR                23780000
              MOVE DK-PREPK-ID    TO PV-TEMP-PREPK-ID                   23790000
              MOVE 0     TO DK-PO-LINE-NBR                              23800000
              MOVE -9999 TO DK-PREPK-ID                                 23810000
           END-IF.                                                      23820000
      *SB 01/10/14 - END PR#5148D                                       23830000
                                                                        23840000
171500     EXEC SQL                                                     23850000
171600          SELECT COUNT(DISTINCT OPER_UNT_ID)                      23860000
171700          INTO   :PV-PASSED-COUNT                                 23870000
171800          FROM   SUT_PO_AUD_REQ                                   23880000
171900          WHERE  PO_NBR         = :DK-PO-NBR                      23890000
172000            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 23900000
172100            AND  PO_PREPK_ID    = :DK-PREPK-ID                    23910000
172200            AND  AUD_STAT_CDE   = :PC-P                           23920000
172300            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  23930000
172400           WITH UR                                                23940000
172500     END-EXEC.                                                    23950000
172600                                                                  23960000
172700     EVALUATE TRUE                                                23970000
172800         WHEN SQLCODE = ZERO                                      23980000
172900             IF PV-PASSED-COUNT > 0                               23990000
173000                 SET PS-PASSED-AUDITS-FOUND TO TRUE               24000000
173100                 MOVE 'PS-PASSED-AUDITS-FOUND '                   24010000
173200                                              TO PV-BTCH-MSG-AREA 24020000
173300             END-IF                                               24030000
173400         WHEN SQLWARN0 NOT = SPACES                               24040000
173500         WHEN SQLCODE NOT EQUAL ZERO                              24050000
173600             MOVE SQLCODE  TO PC259-SQL-CODE                      24060000
173700             MOVE '7800-SELECT-PASSED'                            24070000
173800                             TO PV-PARAGRAPH                      24080000
173900             MOVE 'PCKUT090 - GET PASSED AUDITS'                  24090000
174000                             TO PV-MESSAGE-TEXT-1                 24100000
174100             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 24110000
174200             STRING 'PO NBR: '         DELIMITED BY SIZE          24120000
174300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          24130000
174400                           INTO PV-MESSAGE-TEXT-2                 24140000
174500             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        24150000
174600             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          24160000
174700                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          24170000
174800                           INTO PV-MESSAGE-TEXT-3                 24180000
174900             MOVE SQLCA      TO PC259-SQLCA                       24190000
175000             MOVE 'SUT00015' TO PV-DB2-TABLE-NAME-1               24200000
175100                                PC259-ERROR-TABLE-NME             24210000
175200             SET PS-DB2-ABEND                                     24220000
175300                             TO TRUE                              24230000
175400                                                                  24240000
175500             SET PS-DUMP-TO-LOG       TO TRUE                     24250000
175600             SET PC259-DB2-ERROR TO TRUE                          24260000
175700             SET PC259-INVALID-SQL TO TRUE                        24270000
175800             PERFORM 9990-WRITE-DISPLAYS                          24280000
175900     END-EVALUATE.                                                24290000
176000                                                                  24300000
      *SB 01/10/14 - BEGIN PR#5148D                                     24310000
           IF PS-RFID-AUDIT-CHECK                                       24320000
              MOVE PV-TEMP-PO-LINE-NBR TO DK-PO-LINE-NBR                24330000
              MOVE PV-TEMP-PREPK-ID    TO DK-PREPK-ID                   24340000
           END-IF.                                                      24350000
      *SB 01/10/14 - END PR#5148D                                       24360000
176100                                                                  24370000
176200 7850-SELECT-DC-PASSED.                                           24380000
176300                                                                  24390000
176400     MOVE 0         TO PV-PASSED-COUNT.                           24400000
                                                                        24410000
      *SB 01/10/14 - BEGIN PR#5148D                                     24420000
           IF PS-RFID-AUDIT-CHECK                                       24430000
              MOVE DK-PO-LINE-NBR TO PV-TEMP-PO-LINE-NBR                24440000
              MOVE DK-PREPK-ID    TO PV-TEMP-PREPK-ID                   24450000
              MOVE 0     TO DK-PO-LINE-NBR                              24460000
              MOVE -9999 TO DK-PREPK-ID                                 24470000
           END-IF.                                                      24480000
      *SB 01/10/14 - END PR#5148D                                       24490000
                                                                        24500000
176500     EXEC SQL                                                     24510000
176600          SELECT COUNT(*)                                         24520000
176700          INTO   :PV-PASSED-COUNT                                 24530000
176800          FROM   SUT_PO_AUD_REQ                                   24540000
176900          WHERE  PO_NBR         = :DK-PO-NBR                      24550000
177000            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 24560000
177100            AND  PO_PREPK_ID    = :DK-PREPK-ID                    24570000
177200            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 24580000
177300            AND  AUD_STAT_CDE   = :PC-P                           24590000
177400            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  24600000
177500           WITH UR                                                24610000
177600     END-EXEC.                                                    24620000
177700                                                                  24630000
177800     EVALUATE TRUE                                                24640000
177900         WHEN SQLCODE = ZERO                                      24650000
178000             CONTINUE                                             24660000
178100         WHEN SQLWARN0 NOT = SPACES                               24670000
178200         WHEN SQLCODE NOT EQUAL ZERO                              24680000
178300             MOVE SQLCODE  TO PC259-SQL-CODE                      24690000
178400             MOVE '7800-SELECT-PASSED'                            24700000
178500                             TO PV-PARAGRAPH                      24710000
178600             MOVE 'PCKUT090 - GET PASSED AUDITS'                  24720000
178700                             TO PV-MESSAGE-TEXT-1                 24730000
178800             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 24740000
178900             STRING 'PO NBR: '         DELIMITED BY SIZE          24750000
179000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          24760000
179100                           INTO PV-MESSAGE-TEXT-2                 24770000
179200             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        24780000
179300             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          24790000
179400                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          24800000
179500                           INTO PV-MESSAGE-TEXT-3                 24810000
179600             MOVE SQLCA      TO PC259-SQLCA                       24820000
179700             MOVE 'SUT00015' TO PV-DB2-TABLE-NAME-1               24830000
179800             SET PS-DB2-ABEND                                     24840000
179900                             TO TRUE                              24850000
180000                                                                  24860000
180100             SET PS-DUMP-TO-LOG       TO TRUE                     24870000
180200             SET PC259-DB2-ERROR TO TRUE                          24880000
180300             SET PC259-INVALID-SQL TO TRUE                        24890000
180400             PERFORM 9990-WRITE-DISPLAYS                          24900000
180500     END-EVALUATE.                                                24910000
180600                                                                  24920000
      *SB 01/10/14 - BEGIN PR#5148D                                     24930000
           IF PS-RFID-AUDIT-CHECK                                       24940000
              MOVE PV-TEMP-PO-LINE-NBR TO DK-PO-LINE-NBR                24950000
              MOVE PV-TEMP-PREPK-ID    TO DK-PREPK-ID                   24960000
           END-IF.                                                      24970000
      *SB 01/10/14 - END PR#5148D                                       24980000
180700                                                                  24990000
180800                                                                  25000000
180900 7900-SELECT-THIS-FACILITY.                                       25010000
181000                                                                  25020000
      *SB 01/10/14 - BEGIN PR#5148D                                     25030000
           IF PS-RFID-AUDIT-CHECK                                       25040000
              MOVE DK-PO-LINE-NBR TO PV-TEMP-PO-LINE-NBR                25050000
              MOVE DK-PREPK-ID    TO PV-TEMP-PREPK-ID                   25060000
              MOVE 0     TO DK-PO-LINE-NBR                              25070000
              MOVE -9999 TO DK-PREPK-ID                                 25080000
           END-IF.                                                      25090000
      *SB 01/10/14 - END PR#5148D                                       25100000
                                                                        25110000
181100     EXEC SQL                                                     25120000
181200          SELECT AUD_CNTL_NBR                                     25130000
181300             ,   AUD_STAT_CDE                                     25140000
181400             ,   CART_QTY                                         25150000
181500             ,   UNT_QTY                                          25160000
181600          INTO   :SUT00015-AUD-CNTL-NBR                           25170000
181700             ,   :SUT00015-AUD-STAT-CDE                           25180000
181800             ,   :SUT00015-CART-QTY                               25190000
181900             ,   :SUT00015-UNT-QTY                                25200000
182000          FROM   SUT_PO_AUD_REQ                                   25210000
182100          WHERE  PO_NBR         = :DK-PO-NBR                      25220000
182200            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 25230000
182300            AND  PO_PREPK_ID    = :DK-PREPK-ID                    25240000
182400            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                25250000
182500            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 25260000
182600           WITH UR                                                25270000
182700     END-EXEC.                                                    25280000
182800                                                                  25290000
182900     EVALUATE TRUE                                                25300000
183000         WHEN SQLCODE = ZERO                                      25310000
183100             SET PS-AUDIT-STARTED TO TRUE                         25320000
183200             MOVE 'PS-BC-AUDIT-STARTED    '   TO PV-BTCH-MSG-AREA 25330000
183300         WHEN SQLCODE = +100                                      25340000
183400             SET PS-NO-AUDIT-STARTED TO TRUE                      25350000
183500             MOVE 'PS-NO-BC-AUDIT-STARTED '   TO PV-BTCH-MSG-AREA 25360000
183600         WHEN SQLWARN0 NOT = SPACES                               25370000
183700         WHEN SQLCODE NOT EQUAL ZERO                              25380000
183800             MOVE SQLCODE  TO PC259-SQL-CODE                      25390000
183900             MOVE '7900-SELECT-THIS-FACILITY'                     25400000
184000                             TO PV-PARAGRAPH                      25410000
184100             MOVE 'PCKUT090 - GET AUDITS FOR THIS FACILITY'       25420000
184200                             TO PV-MESSAGE-TEXT-1                 25430000
184300             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 25440000
184400             STRING 'PO NBR: '         DELIMITED BY SIZE          25450000
184500                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          25460000
184600                           INTO PV-MESSAGE-TEXT-2                 25470000
184700             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        25480000
184800             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          25490000
184900                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          25500000
185000                           INTO PV-MESSAGE-TEXT-3                 25510000
185100             MOVE DK-RCVR-SEQ-NBR                                 25520000
185200                             TO PV-DISPLAY-RCVR-SEQ-NBR           25530000
185300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          25540000
185400                 PV-DISPLAY-RCVR-SEQ-NBR                          25550000
185500                                       DELIMITED BY SIZE          25560000
185600                           INTO PV-MESSAGE-TEXT-4                 25570000
185700             MOVE SQLCA      TO PC259-SQLCA                       25580000
185800             MOVE 'SUT00015' TO PV-DB2-TABLE-NAME-1               25590000
185900                                PC259-ERROR-TABLE-NME             25600000
186000             SET PS-DB2-ABEND                                     25610000
186100                             TO TRUE                              25620000
186200                                                                  25630000
186300             SET PS-DUMP-TO-LOG       TO TRUE                     25640000
186400             SET PC259-DB2-ERROR TO TRUE                          25650000
186500             SET PC259-INVALID-SQL TO TRUE                        25660000
186600             PERFORM 9990-WRITE-DISPLAYS                          25670000
186700     END-EVALUATE.                                                25680000
186800                                                                  25690000
      *SB 01/10/14 - BEGIN PR#5148D                                     25700000
           IF PS-RFID-AUDIT-CHECK                                       25710000
              MOVE PV-TEMP-PO-LINE-NBR TO DK-PO-LINE-NBR                25720000
              MOVE PV-TEMP-PREPK-ID    TO DK-PREPK-ID                   25730000
           END-IF.                                                      25740000
      *SB 01/10/14 - END PR#5148D                                       25750000
186900                                                                  25760000
187000*----------------------------------------------------------------*25770000
187100* COUNT THE NUMBER OF LINES ALREADY PROMPTED FOR THIS PO-RCVR    *25780000
187200*----------------------------------------------------------------*25790000
187300 7950-SELECT-PROMPTED-LINES.                                      25800000
187400                                                                  25810000
           IF PS-QC-AUDIT-CHECK                                         25820000
187500        EXEC SQL                                                  25830000
187600             SELECT COUNT(*)                                      25840000
187700             INTO   :PV-PROMPTED-CNT                              25850000
187800             FROM   SUT_PO_AUD_REQ                                25860000
187900             WHERE  PO_NBR         = :DK-PO-NBR                   25870000
188000               AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR             25880000
                     AND  PKGNG_TYP_CDE <> :PC-RF                       25890000
188100              WITH UR                                             25900000
188200        END-EXEC                                                  25910000
           ELSE IF PS-RFID-AUDIT-CHECK                                  25920000
187500             EXEC SQL                                             25930000
187600                  SELECT COUNT(*)                                 25940000
187700                  INTO   :PV-PROMPTED-CNT                         25950000
187800                  FROM   SUT_PO_AUD_REQ                           25960000
187900                  WHERE  PO_NBR         = :DK-PO-NBR              25970000
188000                    AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR        25980000
                          AND  PKGNG_TYP_CDE  = :PC-RF                  25990000
188100                   WITH UR                                        26000000
188200             END-EXEC                                             26010000
                END-IF                                                  26020000
           END-IF.                                                      26030000
188300                                                                  26040000
188400     EVALUATE TRUE                                                26050000
188500         WHEN SQLCODE = ZERO                                      26060000
188600         WHEN SQLCODE = +100                                      26070000
188700             CONTINUE                                             26080000
188800         WHEN SQLWARN0 NOT = SPACES                               26090000
188900         WHEN SQLCODE NOT EQUAL ZERO                              26100000
189000             MOVE SQLCODE  TO PC259-SQL-CODE                      26110000
189100             MOVE '7950-SELECT-PROMPTED-LINES'                    26120000
189200                                        TO PV-PARAGRAPH           26130000
189300             MOVE 'PCKUT090 - GET LINE COUNT FOR PO-RCVR  '       26140000
189400                                        TO PV-MESSAGE-TEXT-1      26150000
189500             MOVE DK-PO-NBR             TO PV-DISPLAY-PO-NBR      26160000
189600             MOVE DK-RCVR-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ-NBR26170000
189700             STRING 'PO-RCVR: '            DELIMITED BY SIZE      26180000
189800                 PV-DISPLAY-PO-NBR '-'     DELIMITED BY SIZE      26190000
189900                 PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE      26200000
190000                                      INTO PV-MESSAGE-TEXT-2      26210000
190100             MOVE SQLCA      TO PC259-SQLCA                       26220000
190200             MOVE 'SUT00015' TO PV-DB2-TABLE-NAME-1               26230000
190300                                PC259-ERROR-TABLE-NME             26240000
190400             SET PS-DB2-ABEND                                     26250000
190500                             TO TRUE                              26260000
190600                                                                  26270000
190700             SET PS-DUMP-TO-LOG       TO TRUE                     26280000
190800             SET PC259-DB2-ERROR TO TRUE                          26290000
190900             SET PC259-INVALID-SQL TO TRUE                        26300000
191000             PERFORM 9990-WRITE-DISPLAYS                          26310000
191100     END-EVALUATE.                                                26320000
191200                                                                  26330000
191300******************************************************************26340000
191400* 8000-SELECT-SHPUNT                                              26350000
191500*    GET THE STORE NUMBER FROM THE SHIPPING UNIT TABLE            26360000
191600******************************************************************26370000
191700 8000-SELECT-SHPUNT.                                              26380000
191800                                                                  26390000
191900     EXEC SQL                                                     26400000
192000         SELECT A.DEST_OPER_UNT_ID                                26410000
192100              , A.ACTV_IND                                        26420000
192200         INTO   :SHPUNT-DEST-OPER-UNT-ID                          26430000
192300              , :SHPUNT-ACTV-IND                                  26440000
192400          FROM  TSHPUNT A                                         26450000
192500          WHERE A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID            26460000
192600           WITH UR                                                26470000
192700     END-EXEC.                                                    26480000
192800                                                                  26490000
192900     EVALUATE TRUE                                                26500000
193000        WHEN SQLCODE = ZERO                                       26510000
193100             IF SHPUNT-ACTV-IND  = 'I'                            26520000
193200                 MOVE ZEROS        TO SHPUNT-DEST-OPER-UNT-ID     26530000
193300             END-IF                                               26540000
193400        WHEN SQLCODE = +100                                       26550000
193500             MOVE ZEROS         TO SHPUNT-DEST-OPER-UNT-ID        26560000
193600         WHEN SQLWARN0 NOT = SPACES                               26570000
193700         WHEN SQLCODE NOT EQUAL ZERO                              26580000
193800             MOVE SQLCODE  TO PC259-SQL-CODE                      26590000
193900             MOVE '8000-SELECT-SHPUNT'                            26600000
194000                             TO PV-PARAGRAPH                      26610000
194100             MOVE 'PCKUT090 - GET DEST OPER UNIT'                 26620000
194200                             TO PV-MESSAGE-TEXT-1                 26630000
194300             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      26640000
194400             STRING 'SHIPT UNT ID: '   DELIMITED BY SIZE          26650000
194500               PV-DISPLAY-SHIPT-UNT-ID DELIMITED BY SIZE          26660000
194600                           INTO PV-MESSAGE-TEXT-2                 26670000
194700             MOVE SQLCA      TO PC259-SQLCA                       26680000
194800             MOVE 'TSHPUNT ' TO PV-DB2-TABLE-NAME-1               26690000
194900                                PC259-ERROR-TABLE-NME             26700000
195000             SET PS-DB2-ABEND                                     26710000
195100                             TO TRUE                              26720000
195200                                                                  26730000
195300             SET PS-DUMP-TO-LOG       TO TRUE                     26740000
195400             SET PC259-DB2-ERROR TO TRUE                          26750000
195500             SET PC259-INVALID-SQL TO TRUE                        26760000
195600             PERFORM 9990-WRITE-DISPLAYS                          26770000
195700     END-EVALUATE.                                                26780000
195800                                                                  26790000
195900                                                                  26800000
196000 8100-SUM-PROMPTED-UNITS.                                         26810000
196100                                                                  26820000
196200     EXEC SQL                                                     26830000
196300         SELECT SUM(B.SHPD_QTY)                                   26840000
196400           INTO :PV-SHPD-QTY-SUM :DN-SUM-NULL                     26850000
196500           FROM TSUATRN A                                         26860000
196600             ,  TSHUUPC B                                         26870000
196700         WHERE A.AUD_CNTL_NBR    = :DK-AUDIT-CNTL-NBR             26880000
196800           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 26890000
196900           WITH UR                                                26900000
197000     END-EXEC.                                                    26910000
197100                                                                  26920000
197200     EVALUATE TRUE                                                26930000
197300         WHEN SQLCODE = ZERO                                      26940000
197400             IF DN-SUM-NULL = -1                                  26950000
197500                 MOVE 0     TO PV-SHPD-QTY-SUM                    26960000
197600             END-IF                                               26970000
197700         WHEN SQLWARN0 NOT = SPACES                               26980000
197800         WHEN SQLCODE NOT EQUAL ZERO                              26990000
197900             MOVE SQLCODE  TO PC259-SQL-CODE                      27000000
198000             MOVE '8100-SUM-PROMPTED-UNITS'                       27010000
198100                             TO PV-PARAGRAPH                      27020000
198200             MOVE 'SUM THE PROMPTED CARTONS'                      27030000
198300                             TO PV-MESSAGE-TEXT-1                 27040000
198400             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    27050000
198500                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    27060000
198600                                       INTO PV-MESSAGE-TEXT-2     27070000
198700             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID27080000
198800             STRING 'SHIP UNIT ID: '         DELIMITED BY SIZE    27090000
198900                    PV-DISPLAY-SHIPT-UNT-ID  DELIMITED BY SIZE    27100000
199000                                       INTO PV-MESSAGE-TEXT-3     27110000
199100             MOVE SQLCA      TO PC259-SQLCA                       27120000
199200             MOVE 'TSUATRN'  TO PV-DB2-TABLE-NAME-1               27130000
199300                                PC259-ERROR-TABLE-NME             27140000
199400             MOVE 'TSHUUPC'  TO PV-DB2-TABLE-NAME-2               27150000
199500             SET PS-DB2-ABEND                                     27160000
199600                             TO TRUE                              27170000
199700                                                                  27180000
199800             SET PS-DUMP-TO-LOG       TO TRUE                     27190000
199900             SET PC259-DB2-ERROR TO TRUE                          27200000
200000             SET PC259-INVALID-SQL TO TRUE                        27210000
200100             PERFORM 9990-WRITE-DISPLAYS                          27220000
200200     END-EVALUATE.                                                27230000
200300                                                                  27240000
200400                                                                  27250000
200500                                                                  27260000
200600 8200-SUM-CARTONS.                                                27270000
200700                                                                  27280000
200800     EXEC SQL                                                     27290000
200900         SELECT COUNT(*)                                          27300000
201000           INTO :PV-CARTON-COUNT                                  27310000
201100           FROM TSUATRN                                           27320000
201200         WHERE  AUD_CNTL_NBR     = :DK-AUDIT-CNTL-NBR             27330000
201300           WITH UR                                                27340000
201400     END-EXEC.                                                    27350000
201500                                                                  27360000
201600     EVALUATE TRUE                                                27370000
201700         WHEN SQLCODE = ZERO                                      27380000
201800             CONTINUE                                             27390000
201900         WHEN SQLWARN0 NOT = SPACES                               27400000
202000         WHEN SQLCODE NOT EQUAL ZERO                              27410000
202100             MOVE SQLCODE  TO PC259-SQL-CODE                      27420000
202200             MOVE '8200-SUM-CARTONS'                              27430000
202300                             TO PV-PARAGRAPH                      27440000
202400             MOVE 'SUM THE PROMPTED CARTONS'                      27450000
202500                             TO PV-MESSAGE-TEXT-1                 27460000
202600             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    27470000
202700                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    27480000
202800                                       INTO PV-MESSAGE-TEXT-2     27490000
202900             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID27500000
203000             STRING 'SHIP UNIT ID: '         DELIMITED BY SIZE    27510000
203100                    PV-DISPLAY-SHIPT-UNT-ID  DELIMITED BY SIZE    27520000
203200                                       INTO PV-MESSAGE-TEXT-3     27530000
203300             MOVE SQLCA      TO PC259-SQLCA                       27540000
203400             MOVE 'TSUATRN'  TO PV-DB2-TABLE-NAME-1               27550000
203500                                PC259-ERROR-TABLE-NME             27560000
203600             SET PS-DB2-ABEND                                     27570000
203700                             TO TRUE                              27580000
203800                                                                  27590000
203900             SET PS-DUMP-TO-LOG       TO TRUE                     27600000
204000             SET PC259-DB2-ERROR TO TRUE                          27610000
204100             SET PC259-INVALID-SQL TO TRUE                        27620000
204200             PERFORM 9990-WRITE-DISPLAYS                          27630000
204300     END-EVALUATE.                                                27640000
204400                                                                  27650000
204500                                                                  27660000
204600 8250-SELECT-EXPECTD-CNT.                                         27670000
204700                                                                  27680000
204800     INITIALIZE        PV-DB2-COUNT-EXP-SCN.                      27690000
204900                                                                  27700000
205000     EXEC SQL                                                     27710000
205100          SELECT  COUNT(*)                                        27720000
205200          INTO  :PV-DB2-COUNT-EXP-SCN                             27730000
205300          FROM   TSHPTPO B                                        27740000
205400                ,TPKSLIP C                                        27750000
205500                ,TINPKSU D                                        27760000
205600          WHERE B.PO_NBR         = :DK-PO-NBR                     27770000
205700            AND B.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               27780000
205800            AND B.PO_NBR         = C.PO_NBR                       27790000
205900            AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                  27800000
206000            AND B.PRIM_SHIPT_IND = 'Y'                            27810000
206100            AND C.VER_STAT_CDE   = 'A'                            27820000
206200            AND B.PO_NBR         = D.PO_NBR                       27830000
206300            AND D.SEQ_NBR        = C.SEQ_NBR                      27840000
206400            AND NOT EXISTS                                        27850000
206500             (SELECT *                                            27860000
206600                FROM TSHUNLO E                                    27870000
206700               WHERE  E.SHIPT_UNT_ID   = D.SHIPT_UNT_ID           27880000
206800                 AND  E.ACTV_CDE       = 'A'                      27890000
206900                 AND  E.SCN_LOC_ID     = 'RECV')                  27900000
207000           WITH UR                                                27910000
207100     END-EXEC                                                     27920000
207200                                                                  27930000
207300                                                                  27940000
207400     EVALUATE TRUE                                                27950000
207500         WHEN SQLCODE = ZERO                                      27960000
207600         WHEN SQLCODE = +100                                      27970000
207700              CONTINUE                                            27980000
207800         WHEN SQLWARN0 NOT = SPACE                                27990000
207900         WHEN SQLCODE NOT = ZERO                                  28000000
208000             MOVE SQLCODE  TO PC259-SQL-CODE                      28010000
208100             MOVE '8250-SELECT-EXPECTD-CNT'                       28020000
208200                               TO PV-PARAGRAPH                    28030000
208300             MOVE 'PCKUT090 - GET PO EXPECTED COUNT'              28040000
208400                             TO PV-MESSAGE-TEXT-1                 28050000
208500             MOVE DK-INBND-TRIP-ID TO                             28060000
208600                                PV-DISPLAY-INBND-TRIP-ID          28070000
208700             STRING 'TRIP ID: '        DELIMITED BY SIZE          28080000
208800                 PV-DISPLAY-INBND-TRIP-ID                         28090000
208900                                       DELIMITED BY SIZE          28100000
209000                           INTO PV-MESSAGE-TEXT-2                 28110000
209100             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 28120000
209200             STRING 'PO NBR: '         DELIMITED BY SIZE          28130000
209300                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          28140000
209400                           INTO PV-MESSAGE-TEXT-3                 28150000
209500             MOVE DK-RCVR-SEQ-NBR                                 28160000
209600                             TO PV-DISPLAY-RCVR-SEQ-NBR           28170000
209700             STRING 'RECV SEQ: '       DELIMITED BY SIZE          28180000
209800                 PV-DISPLAY-RCVR-SEQ-NBR                          28190000
209900                                       DELIMITED BY SIZE          28200000
210000                           INTO PV-MESSAGE-TEXT-4                 28210000
210100             MOVE SQLCA      TO PC259-SQLCA                       28220000
210200             MOVE 'TSHPTPO'  TO PV-DB2-TABLE-NAME-1               28230000
210300                                PC259-ERROR-TABLE-NME             28240000
210400             MOVE 'TPKSLIP'  TO PV-DB2-TABLE-NAME-2               28250000
210500             MOVE 'TINPKSU'  TO PV-DB2-TABLE-NAME-3               28260000
210600             SET PS-DB2-ABEND                                     28270000
210700                             TO TRUE                              28280000
210800                                                                  28290000
210900             SET PS-DUMP-TO-LOG       TO TRUE                     28300000
211000             SET PC259-DB2-ERROR TO TRUE                          28310000
211100             SET PC259-INVALID-SQL TO TRUE                        28320000
211200             PERFORM 9990-WRITE-DISPLAYS                          28330000
211300     END-EVALUATE.                                                28340000
211400                                                                  28350000
211500                                                                  28360000
211600                                                                  28370000
211700******************************************************************28380000
211800*  READ THE DISTRIBUTION TRANSACTION HEADER FOR MODULE AND        28390000
211900*  CARTON DATA.                                                   28400000
212000******************************************************************28410000
212100 8450-SELECT-DIST-HEAD.                                           28420000
212200                                                                  28430000
212300     STRING ' 8450-SELECT-DIST-HEAD'                              28440000
212400         DELIMITED BY SIZE                                        28450000
212500         INTO PV-BTCH-MSG-AREA.                                   28460000
212600     INITIALIZE DCLTDISTHD.                                       28470000
212700                                                                  28480000
212800     EXEC SQL                                                     28490000
212900         SELECT  TOT_CART_CNT                                     28500000
213000              ,  OTPK_UNT_QTY                                     28510000
213100           INTO  :DISTHD-TOT-CART-CNT                             28520000
213200              ,  :DISTHD-OTPK-UNT-QTY                             28530000
213300           FROM  TDISTHD                                          28540000
213400          WHERE  ORD_NBR         = :DK-PO-NBR                     28550000
213500            AND  RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR               28560000
213600            AND  ORD_LNE_NBR     = :DK-PO-LINE-NBR                28570000
213700           WITH UR                                                28580000
213800     END-EXEC.                                                    28590000
213900                                                                  28600000
214000     EVALUATE TRUE                                                28610000
214100         WHEN SQLCODE = ZERO                                      28620000
214200             SET PS-TDISTHD-FOUND-YES TO TRUE                     28630000
214300         WHEN SQLCODE = +100                                      28640000
214310             SET PS-TDISTHD-FOUND-NO TO TRUE                      28650000
214400             MOVE +0 TO DISTHD-TOT-CART-CNT                       28660000
214500                        DISTHD-OTPK-UNT-QTY                       28670000
214600         WHEN SQLWARN0 NOT = SPACES                               28680000
214700         WHEN SQLCODE NOT EQUAL ZERO                              28690000
214800             MOVE SQLCODE  TO PC259-SQL-CODE                      28700000
214900             MOVE '8450-SELECT-DIST-HEAD'                         28710000
215000                             TO PV-PARAGRAPH                      28720000
215100             MOVE 'SELECT DIST HEADER'                            28730000
215200                             TO PV-MESSAGE-TEXT-1                 28740000
215300             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            28750000
215400             STRING 'PO NBR: '         DELIMITED BY SIZE          28760000
215500                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          28770000
215600                           INTO PV-MESSAGE-TEXT-2                 28780000
215700             MOVE DK-RCVR-SEQ-NBR                                 28790000
215800                             TO PV-DISPLAY-RCVR-SEQ-NBR           28800000
215900             STRING 'RECV SEQ: '       DELIMITED BY SIZE          28810000
216000                 PV-DISPLAY-RCVR-SEQ-NBR                          28820000
216100                                       DELIMITED BY SIZE          28830000
216200                           INTO PV-MESSAGE-TEXT-3                 28840000
216300             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   28850000
216400             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          28860000
216500                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          28870000
216600                           INTO PV-MESSAGE-TEXT-4                 28880000
216700             MOVE SQLCA      TO PC259-SQLCA                       28890000
216800             MOVE 'TDISTHD'  TO PV-DB2-TABLE-NAME-1               28900000
216900                                PC259-ERROR-TABLE-NME             28910000
217000             SET PS-DB2-ABEND                                     28920000
217100                             TO TRUE                              28930000
217200                                                                  28940000
217300             SET PS-DUMP-TO-LOG       TO TRUE                     28950000
217400             SET PC259-DB2-ERROR TO TRUE                          28960000
217500             SET PC259-INVALID-SQL TO TRUE                        28970000
217600             PERFORM 9990-WRITE-DISPLAYS                          28980000
217700     END-EVALUATE.                                                28990000
217800                                                                  29000000
217900******************************************************************29010000
218000 8500-SUM-DISTRO-DETAIL.                                          29020000
218100                                                                  29030000
218200     STRING ' 8500-SUM-DISTRO-DETAIL'                             29040000
218300         DELIMITED BY SIZE                                        29050000
218400         INTO PV-BTCH-MSG-AREA.                                   29060000
218500     INITIALIZE DCLTDISTDT.                                       29070000
218600                                                                  29080000
218700     EXEC SQL                                                     29090000
218800         SELECT  SUM(EXPTED_ALLOC_QTY)                            29100000
218900           INTO  :PV-SUM-EXPTD-ALLOC :DN-SUM-NULL                 29110000
219000           FROM  TDISTDT                                          29120000
219100          WHERE  ORD_NBR         = :DK-PO-NBR                     29130000
219200            AND  RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR               29140000
219300            AND  ORD_LNE_NBR     = :DK-PO-LINE-NBR                29150000
219400           WITH UR                                                29160000
219500     END-EXEC.                                                    29170000
219600                                                                  29180000
219700     EVALUATE TRUE                                                29190000
219800         WHEN SQLCODE = ZERO                                      29200000
219900             IF DN-SUM-NULL = -1                                  29210000
220000                 MOVE 0     TO PV-SUM-EXPTD-ALLOC                 29220000
220100             END-IF                                               29230000
220200         WHEN SQLWARN0 NOT = SPACES                               29240000
220300         WHEN SQLCODE NOT EQUAL ZERO                              29250000
220400             MOVE SQLCODE  TO PC259-SQL-CODE                      29260000
220500             MOVE '8500-SUM-DISTRO-DETAIL'                        29270000
220600                             TO PV-PARAGRAPH                      29280000
220700             MOVE 'SUM DISTRO DETAIL'                             29290000
220800                             TO PV-MESSAGE-TEXT-1                 29300000
220900             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            29310000
221000             STRING 'PO NBR: '         DELIMITED BY SIZE          29320000
221100                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          29330000
221200                           INTO PV-MESSAGE-TEXT-2                 29340000
221300             MOVE DK-RCVR-SEQ-NBR                                 29350000
221400                             TO PV-DISPLAY-RCVR-SEQ-NBR           29360000
221500             STRING 'RECV SEQ: '       DELIMITED BY SIZE          29370000
221600                 PV-DISPLAY-RCVR-SEQ-NBR                          29380000
221700                                       DELIMITED BY SIZE          29390000
221800                           INTO PV-MESSAGE-TEXT-3                 29400000
221900             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   29410000
222000             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          29420000
222100                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          29430000
222200                           INTO PV-MESSAGE-TEXT-4                 29440000
222300             MOVE SQLCA      TO PC259-SQLCA                       29450000
222400             MOVE 'TDISTDT'  TO PV-DB2-TABLE-NAME-1               29460000
222500                                PC259-ERROR-TABLE-NME             29470000
222600             SET PS-DB2-ABEND                                     29480000
222700                             TO TRUE                              29490000
222800                                                                  29500000
222900             SET PS-DUMP-TO-LOG       TO TRUE                     29510000
223000             SET PC259-DB2-ERROR TO TRUE                          29520000
223100             SET PC259-INVALID-SQL TO TRUE                        29530000
223200             PERFORM 9990-WRITE-DISPLAYS                          29540000
223300     END-EVALUATE.                                                29550000
223400                                                                  29560000
223500****************************************************************  29570000
223600* 8550-CHECK-OUTER-PACK.                                     *    29580000
223900****************************************************************  29590000
224000 8550-CHECK-OUTER-PACK.                                           29600000
224100                                                                  29610000
224200     STRING ' 8550-CHECK-OUTER-PACK  '                            29620000
224300         DELIMITED BY SIZE                                        29630000
224400         INTO PV-BTCH-MSG-AREA.                                   29640000
224500     INITIALIZE DCLXLT00003.                                      29650000
224600                                                                  29660000
224900     EXEC SQL                                                     29670000
225200        SELECT  B.OUTR_PK_QTY                                     29680000
225300          INTO :XLT00003-OUTR-PK-QTY                              29690000
225700          FROM  TRECITM A                                         29700000
225710             ,  XLT_SKU B                                         29710000
225720      WHERE A.ORD_NBR        = :DK-PO-NBR                         29720000
225730        AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                   29730000
225740        AND A.ORD_LNE_NBR    = :DK-PO-LINE-NBR                    29740000
225750        AND A.VER_STATUS_CDE = 'A'                                29750000
225760        AND A.ITM_NBR        = B.ITM_NBR                          29760000
225800           WITH UR                                                29770000
225900     END-EXEC.                                                    29780000
226000                                                                  29790000
226100     EVALUATE TRUE                                                29800000
226200         WHEN SQLCODE = ZERO                                      29810000
226500         WHEN SQLCODE = +100                                      29820000
226501              CONTINUE                                            29830000
226510         WHEN SQLCODE = -305                                      29840000
226520              MOVE +0 TO XLT00003-OUTR-PK-QTY                     29850000
226800         WHEN SQLWARN0 NOT = SPACES                               29860000
226900         WHEN SQLCODE < ZERO                                      29870000
227000         WHEN SQLCODE > ZERO                                      29880000
227100             MOVE SQLCODE  TO PC259-SQL-CODE                      29890000
227200             MOVE '8550-CHECK-OUTER-PACK  '                       29900000
227300                 TO PV-PARAGRAPH                                  29910000
227400             MOVE 'SELECT OF TSUNAUD TABLE'                       29920000
227500                 TO PV-MESSAGE-TEXT-1                             29930000
227600             MOVE PV-AUDIT-CNTL-NBR-X                             29940000
227700                 TO PV-MESSAGE-TEXT-2                             29950000
227800             MOVE SQLCA            TO PC259-SQLCA                 29960000
227900             MOVE 'TRECITM'        TO PV-DB2-TABLE-NAME-1         29970000
228000                                PC259-ERROR-TABLE-NME             29980000
228100             SET PS-DB2-ABEND                                     29990000
228200                             TO TRUE                              30000000
228300                                                                  30010000
228400             SET PS-DUMP-TO-LOG       TO TRUE                     30020000
228500             SET PC259-DB2-ERROR TO TRUE                          30030000
228600             SET PC259-INVALID-SQL TO TRUE                        30040000
228700             PERFORM 9990-WRITE-DISPLAYS                          30050000
228800     END-EVALUATE.                                                30060000
228900                                                                  30070000
228910****************************************************************  30080000
228920* 8555-CHECK-ITM-QTY-PREPK                                   *    30090000
228930****************************************************************  30100000
228940 8555-CHECK-ITM-QTY-PREPK.                                        30110000
228950                                                                  30120000
228960     STRING ' 8550-CHECK-OUTER-PACK  '                            30130000
228970         DELIMITED BY SIZE                                        30140000
228980         INTO PV-BTCH-MSG-AREA.                                   30150000
228991                                                                  30160000
228992     EXEC SQL                                                     30170000
228993        SELECT DISTINCT                                           30180000
228994               SUM(A.PKSL_ITM_QTY)                                30190000
228995              ,SUM(A.PREPK_RATO_QTY)                              30200000
228996         INTO  :RECITM-PKSL-ITM-QTY                               30210000
228997              ,:RECITM-PREPK-RATO-QTY                             30220000
228998          FROM TRECITM A                                          30230000
228999         WHERE A.ORD_NBR           = :DK-PO-NBR                   30240000
229000           AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR             30250000
229001           AND A.PREPK_ID          = :DK-PREPK-ID                 30260000
229009           WITH UR                                                30270000
229010     END-EXEC.                                                    30280000
229011                                                                  30290000
229012     EVALUATE TRUE                                                30300000
229013         WHEN SQLCODE = ZERO                                      30310000
229015         WHEN SQLCODE = +100                                      30320000
229016              CONTINUE                                            30330000
229017         WHEN SQLCODE = -305                                      30340000
229018              MOVE +0 TO RECITM-PKSL-ITM-QTY                      30350000
229019                         RECITM-PREPK-RATO-QTY                    30360000
229020         WHEN SQLWARN0 NOT = SPACES                               30370000
229021         WHEN SQLCODE < ZERO                                      30380000
229022         WHEN SQLCODE > ZERO                                      30390000
229023             MOVE SQLCODE  TO PC259-SQL-CODE                      30400000
229024             MOVE '8555-CHECK-ITM-QTY-PREPK'                      30410000
229025                 TO PV-PARAGRAPH                                  30420000
229026             MOVE 'SELECT OF TRECITM TABLE'                       30430000
229027                 TO PV-MESSAGE-TEXT-1                             30440000
229028             MOVE PV-AUDIT-CNTL-NBR-X                             30450000
229029                 TO PV-MESSAGE-TEXT-2                             30460000
229030             MOVE SQLCA            TO PC259-SQLCA                 30470000
229031             MOVE 'TRECITM'        TO PV-DB2-TABLE-NAME-1         30480000
229032                                PC259-ERROR-TABLE-NME             30490000
229033             SET PS-DB2-ABEND                                     30500000
229034                             TO TRUE                              30510000
229035                                                                  30520000
229036             SET PS-DUMP-TO-LOG       TO TRUE                     30530000
229037             SET PC259-DB2-ERROR TO TRUE                          30540000
229038             SET PC259-INVALID-SQL TO TRUE                        30550000
229039             PERFORM 9990-WRITE-DISPLAYS                          30560000
229040     END-EVALUATE.                                                30570000
229041                                                                  30580000
229050******************************************************************30590000
229100*  READ THE DISTRIBUTION TRANSACTION HEADER FOR MODULE AND        30600000
229200*  CARTON DATA.                                                   30610000
229300******************************************************************30620000
229400 8600-SELECT-DRIVER-LINE-QTY.                                     30630000
229500                                                                  30640000
229600     STRING ' 8600-SELECT-DRIVER-LINE-QTY'                        30650000
229700         DELIMITED BY SIZE                                        30660000
229800         INTO PV-BTCH-MSG-AREA.                                   30670000
229900     INITIALIZE DCLTDISTHD.                                       30680000
230000                                                                  30690000
230100     EXEC SQL                                                     30700000
230200         SELECT  TOT_CART_CNT                                     30710000
230300              ,  OTPK_UNT_QTY                                     30720000
230400          INTO   :DISTHD-TOT-CART-CNT                             30730000
230500              ,  :DISTHD-OTPK-UNT-QTY                             30740000
230600           FROM  TDISTHD                                          30750000
230700          WHERE  ORD_NBR           = :DK-PO-NBR                   30760000
230800            AND  RCVR_SEQ_NBR      = :DK-RCVR-SEQ-NBR             30770000
230900            AND  ORD_LNE_NBR       = :DK-PO-DRIVER-LINE           30780000
231000            AND  PREPK_LNE_PRC_CDE = :PC-D                        30790000
231100           WITH UR                                                30800000
231200     END-EXEC.                                                    30810000
231300                                                                  30820000
231400     EVALUATE TRUE                                                30830000
231500         WHEN SQLCODE = ZERO                                      30840000
231600             SET PS-TDISTHD-FOUND-YES TO TRUE                     30850000
231700         WHEN SQLCODE = +100                                      30860000
231710             SET PS-TDISTHD-FOUND-NO  TO TRUE                     30870000
231800             MOVE +0 TO DISTHD-TOT-CART-CNT                       30880000
231900                        DISTHD-OTPK-UNT-QTY                       30890000
232000         WHEN SQLWARN0 NOT = SPACES                               30900000
232100         WHEN SQLCODE NOT EQUAL ZERO                              30910000
232200             MOVE SQLCODE  TO PC259-SQL-CODE                      30920000
232300             MOVE '8600-SELECT-DRIVER-LINE-QTY'                   30930000
232400                             TO PV-PARAGRAPH                      30940000
232500             MOVE 'SELECT DIST HEADER'                            30950000
232600                             TO PV-MESSAGE-TEXT-1                 30960000
232700             MOVE DK-PO-NBR       TO PV-DISPLAY-PO-NBR            30970000
232800             STRING 'PO NBR: '         DELIMITED BY SIZE          30980000
232900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          30990000
233000                           INTO PV-MESSAGE-TEXT-2                 31000000
233100             MOVE DK-RCVR-SEQ-NBR                                 31010000
233200                             TO PV-DISPLAY-RCVR-SEQ-NBR           31020000
233300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          31030000
233400                 PV-DISPLAY-RCVR-SEQ-NBR                          31040000
233500                                       DELIMITED BY SIZE          31050000
233600                           INTO PV-MESSAGE-TEXT-3                 31060000
233700             MOVE DK-PO-DRIVER-LINE   TO PV-DISPLAY-PO-LINE-NBR   31070000
233800             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31080000
233900                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31090000
234000                           INTO PV-MESSAGE-TEXT-4                 31100000
234100             MOVE SQLCA      TO PC259-SQLCA                       31110000
234200             MOVE 'TDISTHD'  TO PV-DB2-TABLE-NAME-1               31120000
234300                                PC259-ERROR-TABLE-NME             31130000
234400             SET PS-DB2-ABEND                                     31140000
234500                             TO TRUE                              31150000
234600                                                                  31160000
234700             SET PS-DUMP-TO-LOG       TO TRUE                     31170000
234800             SET PC259-DB2-ERROR TO TRUE                          31180000
234900             SET PC259-INVALID-SQL TO TRUE                        31190000
235000             PERFORM 9990-WRITE-DISPLAYS                          31200000
235100     END-EVALUATE.                                                31210000
235200                                                                  31220000
235300 8650-SUM-PRE-PACK-DETAIL.                                        31230000
235400     STRING ' 8650-SUM-PRE-PACK-DETAIL'                           31240000
235500         DELIMITED BY SIZE                                        31250000
235600         INTO PV-BTCH-MSG-AREA.                                   31260000
235700     EXEC SQL                                                     31270000
235800          SELECT SUM(D.EXPTED_ALLOC_QTY)                          31280000
235900           INTO  :PV-SUM-OF-ALL-LINES  :DN-SUM-NULL               31290000
236000            FROM TRECITM A                                        31300000
236100                ,TPURITM B                                        31310000
236200                ,TDISTHD C                                        31320000
236300                ,TDISTDT D                                        31330000
236400           WHERE A.ORD_NBR           = :DK-PO-NBR                 31340000
236500             AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR           31350000
236600             AND A.PREPK_ID          = :DK-PREPK-ID               31360000
236700             AND A.ORD_NBR           = B.PO_NBR                   31370000
236800             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           31380000
236900             AND A.VER_STATUS_CDE    = :PC-A                      31390000
237000             AND A.PO_VER_NBR        = B.VER_NBR                  31400000
237100             AND C.ORD_NBR           = A.ORD_NBR                  31410000
237200             AND C.RCVR_SEQ_NBR      = A.REC_SEQ_NBR              31420000
237300             AND C.ORD_LNE_NBR       = A.ORD_LNE_NBR              31430000
237400             AND D.ORD_NBR           = C.ORD_NBR                  31440000
237500             AND D.RCVR_SEQ_NBR      = C.RCVR_SEQ_NBR             31450000
237600             AND D.ORD_LNE_NBR       = C.ORD_LNE_NBR              31460000
237700           WITH UR                                                31470000
237800     END-EXEC.                                                    31480000
237900                                                                  31490000
238000     EVALUATE TRUE                                                31500000
238100         WHEN SQLCODE = ZERO                                      31510000
238200             IF DN-SUM-NULL = -1                                  31520000
238300                 MOVE 0     TO PV-SUM-OF-ALL-LINES                31530000
238400             END-IF                                               31540000
238500         WHEN SQLWARN0 NOT = SPACES                               31550000
238600         WHEN SQLCODE NOT EQUAL ZERO                              31560000
238700             MOVE SQLCODE  TO PC259-SQL-CODE                      31570000
238800             MOVE '8650-SUM-PRE-PACK-DETAIL'                      31580000
238900                             TO PV-PARAGRAPH                      31590000
239000             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        31600000
239100             STRING 'PO NBR: '         DELIMITED BY SIZE          31610000
239200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31620000
239300                           INTO PV-MESSAGE-TEXT-1                 31630000
239400             MOVE DK-RCVR-SEQ-NBR                                 31640000
239500                             TO PV-DISPLAY-RCVR-SEQ-NBR           31650000
239600             STRING 'RECV SEQ: '       DELIMITED BY SIZE          31660000
239700                 PV-DISPLAY-RCVR-SEQ-NBR                          31670000
239800                                       DELIMITED BY SIZE          31680000
239900                           INTO PV-MESSAGE-TEXT-2                 31690000
240000             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           31700000
240100             STRING 'PREPACK ID: '     DELIMITED BY SIZE          31710000
240200                PV-DISPLAY-PREPK-ID    DELIMITED BY SIZE          31720000
240300                           INTO PV-MESSAGE-TEXT-3                 31730000
240400             MOVE SQLCA      TO PC259-SQLCA                       31740000
240500             MOVE 'TRECITM'  TO PV-DB2-TABLE-NAME-1               31750000
240600                                PC259-ERROR-TABLE-NME             31760000
240700             MOVE 'TPURITM'  TO PV-DB2-TABLE-NAME-2               31770000
240800             MOVE 'TDISTHD'  TO PV-DB2-TABLE-NAME-3               31780000
240900             SET PS-DB2-ABEND                                     31790000
241000                             TO TRUE                              31800000
241100                                                                  31810000
241200             SET PS-DUMP-TO-LOG       TO TRUE                     31820000
241300             SET PC259-DB2-ERROR TO TRUE                          31830000
241400             SET PC259-INVALID-SQL TO TRUE                        31840000
241500             PERFORM 9990-WRITE-DISPLAYS                          31850000
241600     END-EVALUATE.                                                31860000
241700                                                                  31870000
241800                                                                  31880000
241900 8800-COUNT-CHECKED-IN-CRTNS.                                     31890000
242000                                                                  31900000
242100     STRING ' 8800-COUNT-CHECKED-IN-CRTNS'                        31910000
242200         DELIMITED BY SIZE                                        31920000
242300         INTO PV-BTCH-MSG-AREA.                                   31930000
242400                                                                  31940000
242500     EXEC SQL                                                     31950000
242600          SELECT   COUNT (DISTINCT C.SHIPT_UNT_ID)                31960000
242700            INTO  :PV-CHECK-IN-COUNT                              31970000
242800            FROM  TPKSLIP A                                       31980000
242900               ,  TINPKSU B                                       31990000
243000               ,  TSHUUPC C                                       32000000
243100               ,  TSHUNLO D                                       32010000
243200           WHERE  A.PO_NBR         = :DK-PO-NBR                   32020000
243300             AND  A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             32030000
243400             AND  A.VER_STAT_CDE   = 'A'                          32040000
243500             AND  A.PKSL_STAT_CDE  = 'AC'                         32050000
243600             AND  B.PO_NBR         = A.PO_NBR                     32060000
243700             AND  B.SEQ_NBR        = A.SEQ_NBR                    32070000
243800             AND  C.SHIPT_UNT_ID   = B.SHIPT_UNT_ID               32080000
243900             AND  C.TRN_NBR        = B.PO_NBR                     32090000
244000             AND  C.TRN_LNE_NBR    = :DK-SHUUPC-LNE-NBR           32100000
244100             AND  C.SHIPT_UNT_ID   = D.SHIPT_UNT_ID               32110000
244200             AND  D.ACTV_CDE       = 'A'                          32120000
244300             AND  D.SCN_LOC_ID     = 'RECV'                       32130000
244400           WITH UR                                                32140000
244500     END-EXEC.                                                    32150000
244600                                                                  32160000
244700     EVALUATE TRUE                                                32170000
244800         WHEN SQLCODE = ZERO                                      32180000
244900             CONTINUE                                             32190000
245000         WHEN SQLWARN0 NOT = SPACES                               32200000
245100         WHEN SQLCODE NOT EQUAL ZERO                              32210000
245200             MOVE SQLCODE  TO PC259-SQL-CODE                      32220000
245300             MOVE '8800-COUNT-CHECKED-IN-CRTNS'                   32230000
245400                             TO PV-PARAGRAPH                      32240000
245500             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        32250000
245600             MOVE DK-RCVR-SEQ-NBR                                 32260000
245700                             TO PV-DISPLAY-RCVR-SEQ-NBR           32270000
245800             STRING 'PO NBR, RECV: '   DELIMITED BY SIZE          32280000
245900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          32290000
246000                 '  '                  DELIMITED BY SIZE          32300000
246100                PV-DISPLAY-RCVR-SEQ-NBR                           32310000
246200                                       DELIMITED BY SIZE          32320000
246300                           INTO PV-MESSAGE-TEXT-1                 32330000
246400             MOVE SQLCA      TO PC259-SQLCA                       32340000
246500             MOVE 'TPKSLIP ' TO PV-DB2-TABLE-NAME-1               32350000
246600                                PC259-ERROR-TABLE-NME             32360000
246700             MOVE 'TINPKSU ' TO PV-DB2-TABLE-NAME-2               32370000
246800             MOVE 'TSHUUPC ' TO PV-DB2-TABLE-NAME-3               32380000
246900             SET PS-DB2-ABEND                                     32390000
247000                             TO TRUE                              32400000
247100                                                                  32410000
247200             SET PS-DUMP-TO-LOG       TO TRUE                     32420000
247300             SET PC259-DB2-ERROR TO TRUE                          32430000
247400             SET PC259-INVALID-SQL TO TRUE                        32440000
247500             PERFORM 9990-WRITE-DISPLAYS                          32450000
247600     END-EVALUATE.                                                32460000
247700                                                                  32470000
247800                                                                  32480000
247900                                                                  32490000
248000 8900-SUM-PP-PROMPTED-UNITS.                                      32500000
248100                                                                  32510000
248200     EXEC SQL                                                     32520000
248300         SELECT SUM(B.SHPD_QTY)                                   32530000
248400           INTO :PV-SHPD-QTY-SUM :DN-SUM-NULL                     32540000
248500           FROM TSUATRN A                                         32550000
248600             ,  TSHUUPC B                                         32560000
248700         WHERE A.AUD_CNTL_NBR    = :DK-AUDIT-CNTL-NBR             32570000
248800           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 32580000
248900           AND B.TRN_NBR         = :DK-PO-NBR                     32590000
249000           AND B.TRN_LNE_NBR     = :DK-PO-DRIVER-LINE             32600000
249100           WITH UR                                                32610000
249200     END-EXEC.                                                    32620000
249300                                                                  32630000
249400     EVALUATE TRUE                                                32640000
249500         WHEN SQLCODE = ZERO                                      32650000
249600             IF DN-SUM-NULL = -1                                  32660000
249700                 MOVE 0     TO PV-SHPD-QTY-SUM                    32670000
249800             END-IF                                               32680000
249900         WHEN SQLWARN0 NOT = SPACES                               32690000
250000         WHEN SQLCODE NOT EQUAL ZERO                              32700000
250100             MOVE SQLCODE  TO PC259-SQL-CODE                      32710000
250200             MOVE '8900-SUM-PP-PROMPTED-UNITS'                    32720000
250300                             TO PV-PARAGRAPH                      32730000
250400             MOVE 'SUM THE PROMPTED CARTONS'                      32740000
250500                             TO PV-MESSAGE-TEXT-1                 32750000
250600             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    32760000
250700                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    32770000
250800                                       INTO PV-MESSAGE-TEXT-2     32780000
250900             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID32790000
251000             STRING 'SHIP UNIT ID: '         DELIMITED BY SIZE    32800000
251100                    PV-DISPLAY-SHIPT-UNT-ID  DELIMITED BY SIZE    32810000
251200                                       INTO PV-MESSAGE-TEXT-3     32820000
251300             MOVE SQLCA      TO PC259-SQLCA                       32830000
251400             MOVE 'TSUATRN'  TO PV-DB2-TABLE-NAME-1               32840000
251500                                PC259-ERROR-TABLE-NME             32850000
251600             MOVE 'TSHUUPC'  TO PV-DB2-TABLE-NAME-2               32860000
251700             SET PS-DB2-ABEND                                     32870000
251800                             TO TRUE                              32880000
251900                                                                  32890000
252000             SET PS-DUMP-TO-LOG       TO TRUE                     32900000
252100             SET PC259-DB2-ERROR TO TRUE                          32910000
252200             SET PC259-INVALID-SQL TO TRUE                        32920000
252300             PERFORM 9990-WRITE-DISPLAYS                          32930000
252400     END-EVALUATE.                                                32940000
252500                                                                  32950000
252600                                                                  32960000
252700 9990-WRITE-DISPLAYS.                                             32970000
252800          DISPLAY   '************************************'        32980000
252900          DISPLAY   '* ABEND PCKUT090                   *'        32990000
253000          DISPLAY   '* PARAGRAPH ' PV-PARAGRAPH                   33000000
253100          DISPLAY   '* SQLCODE   ' PV-DISPLAY-SQLCODE             33010000
253200          DISPLAY   '* ' PV-MESSAGE-TEXT-1                        33020000
253300          DISPLAY   '* ' PV-MESSAGE-TEXT-2                        33030000
253400          DISPLAY   '* ' PV-MESSAGE-TEXT-3                        33040000
253500          DISPLAY   '* ' PV-MESSAGE-TEXT-4                        33050000
253600          DISPLAY   '* TABLE NAME '                               33060000
253700          DISPLAY   '*' PV-DB2-TABLE-NAME-1                       33070000
253800          DISPLAY   '*' PV-DB2-TABLE-NAME-2                       33080000
253900          DISPLAY   '*' PV-DB2-TABLE-NAME-3                       33090000
254000          DISPLAY   '*  OPER UNT ID ' PV-DISPLAY-OPER-UNT-ID      33100000
254100          DISPLAY   '*  PO NUMBER   ' PV-DISPLAY-PO-NBR           33110000
254200          DISPLAY   '*  REC SEQ NBR ' PV-DISPLAY-RCVR-SEQ-NBR     33120000
254300          DISPLAY   '*  LINE NUMBER ' PV-DISPLAY-PO-LINE-NBR      33130000
254400          DISPLAY   '*  PACK ID     ' PV-DISPLAY-PREPK-ID         33140000
254500          DISPLAY   '*  SQLCA '                                   33150000
254600          DISPLAY   '*' PC259-SQLCA                               33160000
254700          DISPLAY   '************************************'.       33170000
254800 9995-WRITE-DISPLAYS-2.                                           33180000
254900     MOVE PC259-PO-NUMBER   TO PV-DISPLAY-PO-NBR                  33190000
255000     MOVE PC259-LINE-NBR    TO PV-DISPLAY-PO-LINE-NBR             33200000
255100     MOVE PC259-PRE-PACK-ID TO PV-DISPLAY-PREPK-ID                33210000
255200     MOVE PC259-PRE-PACK-ID TO PV-DISPLAY-PREPK-ID                33220000
255300     MOVE PC259-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID             33230000
255400     MOVE PC259-REC-SEQ-NBR TO PV-DISPLAY-RCVR-SEQ-NBR            33240000
255500     DISPLAY 'DC NUMBER       ' PV-DISPLAY-OPER-UNT-ID            33250000
255600     DISPLAY 'PO NUMBER       ' PV-DISPLAY-PO-NBR                 33260000
255700     DISPLAY 'REC SEQ NUMBER  ' PV-DISPLAY-RCVR-SEQ-NBR           33270000
255800     DISPLAY 'PACK TYPE       ' PC259-PKG-TYPE                    33280000
255900     DISPLAY 'PACK ID         ' PV-DISPLAY-PREPK-ID               33290000
256000     DISPLAY 'LINE NUMBER     ' PV-DISPLAY-PO-LINE-NBR            33300000
256100     DISPLAY 'VND-RNKG-CDE    ' SUT00017-VND-RNKG-CDE             33310000
256200     DISPLAY 'PKGNG-TYP-CDE   ' SUT00017-PKGNG-TYP-CDE            33320000
256300     DISPLAY 'AUD-PCT         ' SUT00017-AUD-PCT                  33330000
256400     DISPLAY 'CKD-PCT         ' SUT00017-CKD-PCT                  33340000
256500     DISPLAY 'MAX-CKD-QTY     ' SUT00017-MAX-CKD-QTY              33350000
256600     DISPLAY 'MAX-CART-CKD-QTY ' SUT00017-MAX-CART-CKD-QTY        33360000
256700     DISPLAY ' MIN-CART-CKD-QTY ' SUT00017-MIN-CART-CKD-QTY       33370000
256800     DISPLAY 'CKD-DC-QTY    '   SUT00017-CKD-DC-QTY               33380000
256900     DISPLAY 'MAX-PO-LNE-QTY '  SUT00017-MAX-PO-LNE-QTY           33390000
257000     DISPLAY 'CK-AFT-DAY-QTY '  SUT00017-CK-AFT-DAY-QTY           33400000
257100     DISPLAY 'CK-AFT-RCVR-QTY ' SUT00017-CK-AFT-RCVR-QTY          33410000
257200     DISPLAY 'CARTONS-TO-AUDIT ' PV-CARTONS-TO-AUDIT              33420000
257300     DISPLAY 'UNITS TO AUDIT   ' SUT00015-UNT-QTY                 33430000
257400     DISPLAY 'AUDIT STATUS     ' PC259-AUDIT-VALIDATION-SW        33440000
257500     DISPLAY '                                           '        33450000
257600     DISPLAY '                                           '.       33460000
257700***************************************************************** 33470000
257800***************************************************************** 33480000
