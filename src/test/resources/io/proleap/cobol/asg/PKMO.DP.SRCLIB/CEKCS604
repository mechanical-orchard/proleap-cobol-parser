000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    CEKCS604.                                         00040001
000500 AUTHOR.        DENISE HAHN.                                      00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  11-24-99.                                         00070001
000800 DATE-COMPILED.                                                   00080001
000900*----------------------------------------------------------------*00090001
001000*    S604 - CENTRAL STOCK INTERFACE - CREATE PULL                *00100001
001100*                                                                *00110001
001200*----------------------------------------------------------------*00120001
001300*----------------------------------------------------------------*00130098
001400*DAVID KIEFER 04/29/2010 WR#38216                                 00140098
001401* CHANGES MADE FOR EFC2 PROJECT                                   00140198
001402*----------------------------------------------------------------*00140201
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00140399
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00140499
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00140599
263455*----------------------------------------------------------------*00140699
CICS  * CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00140799
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00140899
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00140999
CICS  *-----------------------------------------------------------------00141099
013000* CHANGED 09/18/2023    BY JEAN KURK       WR: CHG0293403         00141199
013001* PULL NUMBER CANNOT GO OVER 99999.  ONCE THE LIMIT IS SET, START 00141299
013002* OVER WITH 1, BUT VALIDATE THAT IT DOES NOT ALREADY EXIST        00141399
013003*-----------------------------------------------------------------00141499
001403                                                                  00141501
001404 ENVIRONMENT DIVISION.                                            00142001
001500                                                                  00150001
001600 DATA DIVISION.                                                   00160001
001700                                                                  00170001
001800 WORKING-STORAGE SECTION.                                         00180001
001900                                                                  00190001
002000*----------------------------------------------------------------*00200001
002100*   PROGRAM CONSTANTS                                            *00210001
002200*----------------------------------------------------------------*00220001
002300 01  PC-PROGRAM-CONSTANTS.                                        00230001
002400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE604A  '.  00240020
002500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM604 '.  00250020
002600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS604'.  00260020
002700     05  PC-PRINT-PROGRAM          PIC  X(08)  VALUE 'CEKCS609'.  00270020
002800     05  PC-OP-CO-NBR              PIC  X(02)  VALUE '03'.        00280020
002900     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00290001
003000     05  PC-CORPORATE-OFFICE       PIC  9(04)  VALUE  090.        00300053
003100     05  PC-MENO-FALLS-DC          PIC  9(04)  VALUE  0085.       00310001
003200     05  PC-90                     PIC  9(04)  VALUE  0090.       00320022
003300     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00330022
003400     05  PC-MANUAL                 PIC  X(02)  VALUE SPACES.      00340022
003500     05  PC-01                     PIC  X(02)  VALUE '01'.        00350022
003600     05  PC-0001                   PIC  9(04)  VALUE  0001.       00360005
003700     05  PC-CS                     PIC  X(02)  VALUE 'CS'.        00370020
003800     05  PC-DC                     PIC  X(02)  VALUE 'DC'.        00380020
003900     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00390020
004000     05  PC-RV                     PIC  X(02)  VALUE 'RV'.        00400020
004100     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'CEKCS609'.  00410001
004200     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00420001
004300     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00430001
004400     05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00440001
004500     05  PC-A                      PIC  X(01)  VALUE 'A'.         00450001
004600     05  PC-P                      PIC  X(01)  VALUE 'P'.         00460001
004700     05  PC-Y                      PIC  X(01)  VALUE 'Y'.         00470035
004800     05  PC-Z                      PIC  X(01)  VALUE 'Z'.         00480001
004900     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00490005
005000                                                                  00500001
005100     05  PC-DESC-CANCELLED         PIC  X(10)  VALUE 'CANCELLED '.00510001
005200     05  PC-DESC-DISTRIBUTED       PIC  X(10)  VALUE 'DISTRIBUTD'.00520001
005300     05  PC-DESC-IN-PROCESS        PIC  X(10)  VALUE 'IN PROCESS'.00530001
005400     05  PC-DESC-NEW               PIC  X(10)  VALUE 'NEW       '.00540001
005500     05  PC-DESC-POSTED            PIC  X(10)  VALUE 'POSTED    '.00550001
005600                                                                  00560001
005700                                                                  00570001
005800*-----------------------------------------------------------------00580001
005900*  DB2 KEYS                                                       00590001
006000*-----------------------------------------------------------------00600001
006100 01  DK-DB2-KEYS.                                                 00610001
006200                                                                  00620001
006300     05  DK-CURR-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.00630001
006400     05  DK-CURR-FCLTY-ID               PIC S9(04)  COMP VALUE +0.00640001
006500     05  DK-OPER-UNT-ID                 PIC  9(04)  VALUE 0.      00650053
006600     05  DK-PULL-NUMBER                 PIC S9(09)  COMP VALUE +0.00660001
006700     05  DK-LINE-NUMBER                 PIC S9(04)  COMP VALUE +0.00670001
006800     05  DK-STORE-NUMBER                PIC  9(04)  VALUE 0.      00680049
006900                                                                  00690001
007000                                                                  00700001
007100*----------------------------------------------------------------*00710001
007200*  SYSTEM MESSAGES                                               *00720001
007300*----------------------------------------------------------------*00730001
007400*   00005 = INVALID VALUE                                         00740001
007500*   00007 = REQUIRED ENTRY                                        00750001
007600*   00008 = MUST BE NUMERIC                                       00760001
007700*   00009 = INVALID DATE                                          00770001
007800*   00045 = INVALID FUNCTION KEY                                  00780001
007900*   00746 = INVALID PRINTER DESTINATION                           00790001
008000*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION         00800001
008100*   02214 = PULL NUMBER NOT FOUND                                 00810001
008200*   02215 = REFERENCE NUMBER NOT FOUND                            00820001
008300*   02216 = PULL NUMBER/REFERENCE NUMBER NOT FOUND                00830001
008400*   02217 = MULT PULL #'S FOR REQUESTED REFERENCE NUMBER          00840001
008500*   02219 = INVALID CENTRAL STOCK LOCATION                        00850001
008600*   02220 = PULL NUMBER OR REFERENCE NUMBER REQUIRED FOR SELECTION00860001
008700*   02221 = CREATE FROM DATE MUST BE BEFORE CREATE TO DATE        00870001
008800*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           00880001
008900*   02225 = CANNOT CONFIRM DISTRIBUTION - PULL CANCELLED          00890001
009000*   02226 = CANNOT PRINT PULL - PULL STATUS IS CANCELLED          00900001
009100*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                  00910001
009200*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*00920020
009300*   02235 = PRINT REQUEST HAS BEEN COMPLETED                      00930021
009400*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *00940020
009500*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    00950001
009600*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   00960001
009700*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                00970001
009800*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              00980001
009900*   02258 - CONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM       00990001
010000*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01000001
010100*   02260 - CONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM  01010001
010200*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01020001
010300*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01030001
010400*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01040001
010500*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01050001
010600*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01060001
010700*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01070001
010800*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01080001
010900*   02268 - CANNOT CANCEL/UNCANCEL - LINE(S) ALREADY POSTED/DISTRB01090001
011000*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01100001
011100*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01110001
011200*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01120001
011300*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01130001
011400*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01140001
011500*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01150001
011600*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01160001
011700*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01170001
011800*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01180001
011900*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01190001
012000*   02293 - INVALID STORE NUMBER - MUST BE DC, DS, CS OR RTV      01200009
012100*   02294 - INVALID STORE NUMBER                                  01210009
012200*   02295 - CANNOT PRINT PULL FROM -ADD LINE- FUNCTION            01220010
012300*   02296 - PRINT PULL FAILED - NO LINE(S) FOR PULL               01230011
012400*   02297 - PRINT PULL FAILED - LINE(S) MISSING DISTRIBUTION      01240011
012500*   02298 - ADD FAILED - CENTRAL STK LOC. REQUESTED IS NOT OPEN   01250014
012600*   02299 - ADD FAILED - CENTRAL STK LOC. NOT ASSIGNED TO YOUR DC 01260014
012700*   02306 - YOU DO NOT HAVE AUTHORITY TO PRINT                    01270030
012800*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01280030
012900*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01290030
013000*                                                                 01300001
013100*                                                                 01310001
013200*----------------------------------------------------------------*01320001
013300 01  PC-TSYMSG-NUMBERS.                                           01330001
013400     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          01340001
013500     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          01350001
013600     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          01360001
013700     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          01370001
013800     05  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.          01380001
013900     05  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.          01390001
014000     05  PC-TSYMSG-01563       PIC  9(05)  VALUE  01563.          01400001
014100     05  PC-TSYMSG-02214       PIC  9(05)  VALUE  02214.          01410001
014200     05  PC-TSYMSG-02215       PIC  9(05)  VALUE  02215.          01420001
014300     05  PC-TSYMSG-02216       PIC  9(05)  VALUE  02216.          01430001
014400     05  PC-TSYMSG-02217       PIC  9(05)  VALUE  02217.          01440001
014500     05  PC-TSYMSG-02219       PIC  9(05)  VALUE  02219.          01450001
014600     05  PC-TSYMSG-02220       PIC  9(05)  VALUE  02220.          01460001
014700     05  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.          01470001
014800     05  PC-TSYMSG-02224       PIC  9(05)  VALUE  02224.          01480001
014900     05  PC-TSYMSG-02225       PIC  9(05)  VALUE  02225.          01490001
015000     05  PC-TSYMSG-02226       PIC  9(05)  VALUE  02226.          01500001
015100     05  PC-TSYMSG-02227       PIC  9(05)  VALUE  02227.          01510001
015200     05  PC-TSYMSG-02234       PIC  9(05)  VALUE  02234.          01520020
015300     05  PC-TSYMSG-02235       PIC  9(05)  VALUE  02235.          01530021
015400     05  PC-TSYMSG-02238       PIC  9(05)  VALUE  02238.          01540020
015500     05  PC-TSYMSG-02254       PIC  9(05)  VALUE  02254.          01550001
015600     05  PC-TSYMSG-02255       PIC  9(05)  VALUE  02255.          01560001
015700     05  PC-TSYMSG-02256       PIC  9(05)  VALUE  02256.          01570001
015800     05  PC-TSYMSG-02257       PIC  9(05)  VALUE  02257.          01580001
015900     05  PC-TSYMSG-02258       PIC  9(05)  VALUE  02258.          01590001
016000     05  PC-TSYMSG-02259       PIC  9(05)  VALUE  02259.          01600001
016100     05  PC-TSYMSG-02260       PIC  9(05)  VALUE  02260.          01610001
016200     05  PC-TSYMSG-02261       PIC  9(05)  VALUE  02261.          01620001
016300     05  PC-TSYMSG-02262       PIC  9(05)  VALUE  02262.          01630001
016400     05  PC-TSYMSG-02263       PIC  9(05)  VALUE  02263.          01640001
016500     05  PC-TSYMSG-02264       PIC  9(05)  VALUE  02264.          01650001
016600     05  PC-TSYMSG-02265       PIC  9(05)  VALUE  02265.          01660001
016700     05  PC-TSYMSG-02266       PIC  9(05)  VALUE  02266.          01670001
016800     05  PC-TSYMSG-02267       PIC  9(05)  VALUE  02267.          01680001
016900     05  PC-TSYMSG-02268       PIC  9(05)  VALUE  02268.          01690001
017000     05  PC-TSYMSG-02269       PIC  9(05)  VALUE  02269.          01700001
017100     05  PC-TSYMSG-02270       PIC  9(05)  VALUE  02270.          01710001
017200     05  PC-TSYMSG-02271       PIC  9(05)  VALUE  02271.          01720001
017300     05  PC-TSYMSG-02272       PIC  9(05)  VALUE  02272.          01730001
017400     05  PC-TSYMSG-02273       PIC  9(05)  VALUE  02273.          01740001
017500     05  PC-TSYMSG-02274       PIC  9(05)  VALUE  02274.          01750001
017600     05  PC-TSYMSG-02275       PIC  9(05)  VALUE  02275.          01760001
017700     05  PC-TSYMSG-02276       PIC  9(05)  VALUE  02276.          01770001
017800     05  PC-TSYMSG-02287       PIC  9(05)  VALUE  02287.          01780001
017900     05  PC-TSYMSG-02288       PIC  9(05)  VALUE  02288.          01790001
018000     05  PC-TSYMSG-02293       PIC  9(05)  VALUE  02293.          01800009
018100     05  PC-TSYMSG-02294       PIC  9(05)  VALUE  02294.          01810009
018200     05  PC-TSYMSG-02295       PIC  9(05)  VALUE  02295.          01820010
018300     05  PC-TSYMSG-02296       PIC  9(05)  VALUE  02296.          01830011
018400     05  PC-TSYMSG-02297       PIC  9(05)  VALUE  02297.          01840011
018500     05  PC-TSYMSG-02298       PIC  9(05)  VALUE  02298.          01850014
018600     05  PC-TSYMSG-02299       PIC  9(05)  VALUE  02299.          01860014
018700     05  PC-TSYMSG-02306       PIC  9(05)  VALUE  02306.          01870030
018800     05  PC-TSYMSG-02307       PIC  9(05)  VALUE  02307.          01880030
018900     05  PC-TSYMSG-02308       PIC  9(05)  VALUE  02308.          01890030
019000                                                                  01900001
019100                                                                  01910001
019200*----------------------------------------------------------------*01920001
019300*   PROGRAM MESSAGES                                             *01930001
019400*----------------------------------------------------------------*01940001
019500 01  PM-PROGRAM-MESSAGES.                                         01950001
019600     05  PM-ABEND-INFO-A.                                         01960001
019700         10  FILLER                PIC X(15)   VALUE              01970001
019800                                   'DP020-SRC-AID: '.             01980001
019900         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01990001
020000         10  FILLER                PIC X(19)   VALUE              02000001
020100                                   '. DP020-FK-ACTION: '.         02010001
020200         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      02020001
020300         10  FILLER                PIC X(22)   VALUE              02030001
020400                                   '. DP020-FK-DISPN-IND: '.      02040001
020500         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      02050001
020600         10  FILLER                PIC X(01)   VALUE '.'.         02060001
020700         10  FILLER                PIC X(19)   VALUE SPACE.       02070001
020800                                                                  02080001
020900                                                                  02090001
021000*----------------------------------------------------------------*02100001
021100*   SWITCHES                                                     *02110001
021200*----------------------------------------------------------------*02120001
021300 01  PS-PROGRAM-SWITCHES.                                         02130001
021400                                                                  02140001
021500     05  PS-ERROR-SW                    PIC  X(01)  VALUE  'N'.   02150011
021600         88  PS-ERROR                               VALUE  'Y'.   02160011
021700         88  PS-NO-ERROR                            VALUE  'N'.   02170011
021800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02180005
021900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02190005
022000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02200005
022100     05  PS-EOF-LINE-ITEM-CSR-SW        PIC  X(01)  VALUE  'N'.   02210011
022200         88  PS-EOF-LINE-ITEM-CSR                   VALUE  'Y'.   02220011
022300         88  PS-NOT-EOF-LINE-ITEM-CSR               VALUE  'N'.   02230011
022400     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   02240030
022500         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   02250030
022600         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   02260030
022400     05  PS-GOOD-PULL-NBR               PIC  X(01)  VALUE  'N'.   02261099
022500         88  PS-GOOD-PULL-NBR-YES                   VALUE  'Y'.   02262099
022600         88  PS-GOOD-PULL-NBR-NO                    VALUE  'N'.   02263099
022700                                                                  02270001
022800                                                                  02280001
022900*----------------------------------------------------------------*02290001
023000*   PROGRAM VARIABLES                                            *02300001
023100*----------------------------------------------------------------*02310001
023200 01  PV-PROGRAM-VARIABLES.                                        02320001
023300                                                                  02330001
023400     05  PV-4-DIGIT-STORE          PIC  Z(04)  VALUE  ZEROES.     02340001
023500     05  PV-USER-LOCATION          PIC  9(04)  VALUE  ZEROES.     02350001
023600     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0.          02360001
023700     05  PV-CS-LOCATION            PIC S9(04)  VALUE ZEROES.      02370001
023800     05  PV-CS-NAME                PIC  X(25)  VALUE SPACES.      02380001
023900     05  PV-DISPLAY-PULL-NBR       PIC  9(09)  VALUE ZEROES.      02390001
024000     05  PV-REF-NBR-COUNT          PIC S9(09)  COMP.              02400001
024100     05  PV-CEPLDS-COUNT           PIC S9(09)  VALUE ZEROES       02410001
024200                                               COMP.              02420001
024300     05  PV-LINES-POSTED-DISTRB    PIC S9(09)  COMP.              02430001
024400     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       02440001
024500                                   COMP SYNC.                     02450001
024600     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      02460001
024700     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             02470001
024800         10  PV-CURR-YY            PIC  9(04).                    02480001
024900         10  FILLER                PIC  X(01).                    02490001
025000         10  PV-CURR-MM            PIC  9(02).                    02500001
025100         10  FILLER                PIC  X(01).                    02510001
025200         10  PV-CURR-DD            PIC  9(02).                    02520001
025300                                                                  02530001
025400     05  PV-CURRENT-MMDDYY         PIC  X(10)  VALUE SPACES.      02540005
025500     05  PV-CURRENT-MMDDYY-R REDEFINES PV-CURRENT-MMDDYY.         02550005
025600         10  PV-MONTH              PIC  9(02).                    02560005
025700         10  PV-SLASH-1            PIC  X(01).                    02570005
025800         10  PV-DAY                PIC  9(02).                    02580005
025900         10  PV-SLASH-2            PIC  X(01).                    02590005
026000         10  PV-YEAR               PIC  9(04).                    02600005
026100     05  PV-STORE-NAME             PIC  X(25).                    02610009
026200     05  PV-STORE-TYPE             PIC  X(02).                    02620009
026300     05  PV-CENTRAL-STOCK-NBR      PIC  9(04)  VALUE 0.           02630053
026300     05  PV-MAX-PULL-NBR           PIC  S9(9) COMP VALUE 0.       02631099
026300     05  PV-HOLD-PULL-NBR          PIC  S9(9) COMP VALUE 0.       02632099
026400                                                                  02640050
026500*---------------------------------------------------------------* 02650050
026600*    WORK AREAS FOR THE CENTRAL STOCK LOCATION INFORMATION.     * 02660050
026700*---------------------------------------------------------------* 02670050
026800                                                                  02680005
026900     05  PV-CS-STORE-NMBR          PIC  9(04)  VALUE 0.           02690050
027000     05  PV-CS-STORE-NAME          PIC  X(40)  VALUE SPACES.      02700050
027100     05  PV-CS-TYPE-CODE           PIC  X(02)  VALUE SPACES.      02710050
027200     05  PV-CS-E-BUS-LOC-IND       PIC  X(01)  VALUE SPACES.      02720050
027500*DJK 04/29/2010 ADDED NEW FLAG                                    02750020
027501     05  PV-ST-E-BUS-LOC-IND       PIC  X(01)  VALUE SPACES.      02750198
027502     05  PV-CS-CLOSED-DATE         PIC  X(10)  VALUE SPACES.      02750252
027503                                                                  02750301
027504*---------------------------------------------------------------* 02750420
027600* COMMUNICATION AREA FOR PRINT MODULE (CEKCS609)                * 02760020
027700*---------------------------------------------------------------* 02770020
027800     COPY CEWS004.                                                02780020
027900                                                                  02790020
028000*---------------------------------------------------------------* 02800047
028100* COMMUNICATION AREA FOR LOCATION MODUEL (XLKUT071)             * 02810047
028200*---------------------------------------------------------------* 02820047
028300     COPY XLWS071.                                                02830047
028400                                                                  02840047
028500*----------------------------------------------------------------*02850001
028600*    MAP LAYOUT                                                  *02860001
028700*----------------------------------------------------------------*02870001
028800     COPY CEKM604.                                                02880001
028900                                                                  02890001
029000*----------------------------------------------------------------*02900001
029100*    CALENDAR ROUTINE                                            *02910001
029200*----------------------------------------------------------------*02920001
029300     COPY DPWS500.                                                02930001
029400                                                                  02940001
029500                                                                  02950001
029600*----------------------------------------------------------------*02960001
029700*  SENDING/RECEIVING AREA FOR THE                                *02970001
029800*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02980001
029900*----------------------------------------------------------------*02990001
030000     COPY DPWS072.                                                03000001
030100                                                                  03010001
030200                                                                  03020001
030300*----------------------------------------------------------------*03030030
030400**  SECURITY SUBROUTINE PARAMETERS                                03040030
030500*----------------------------------------------------------------*03050030
030600     COPY DPWS008.                                                03060030
030700                                                                  03070030
030800                                                                  03080030
030900*----------------------------------------------------------------*03090001
031000*    ATTRIBUTE SETTINGS COPYBOOK.                                *03100001
031100*----------------------------------------------------------------*03110001
031200     COPY DPWS015.                                                03120001
031300                                                                  03130001
031400                                                                  03140001
031500*----------------------------------------------------------------*03150001
031600*    FUNCTION KEYS COPYBOOK                                      *03160001
031700*----------------------------------------------------------------*03170001
031800     COPY DPWS016.                                                03180001
031900                                                                  03190001
032000                                                                  03200001
032100*----------------------------------------------------------------*03210001
032200*    ABEND PROCESSING COPYBOOK.                                  *03220001
032300*----------------------------------------------------------------*03230001
032400     COPY DPWS013.                                                03240001
032500                                                                  03250001
032600                                                                  03260001
032700*----------------------------------------------------------------*03270001
032800*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *03280001
032900*  SUB-ROUTINE (DPKUT100).                                       *03290001
033000*----------------------------------------------------------------*03300001
033100     COPY DPWS010I.                                               03310001
033200                                                                  03320001
033300                                                                  03330001
033400*----------------------------------------------------------------*03340001
033500*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *03350001
033600*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *03360001
033700*----------------------------------------------------------------*03370001
033800     COPY DPWS030.                                                03380001
CICS       COPY DPWS930.                                                03381099
033900                                                                  03390001
034000                                                                  03400001
034100*----------------------------------------------------------------*03410001
034200*    STANDARD COMMAREA.                                          *03420001
034300*----------------------------------------------------------------*03430001
034400     COPY DPWS020.                                                03440001
034500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03450001
034600                                                                  03460001
034700*----------------------------------------------------------------*03470001
034800*    INTER-APPLICATION COMMAREA.                                 *03480001
034900*----------------------------------------------------------------*03490001
035000                                                                  03500001
035100         10  INTER-APPL-COMM-AREA PIC X(200).                     03510001
035200     COPY CEWS001.                                                03520001
035300     COPY CEWS002.                                                03530005
035400     COPY CEWS006.                                                03540017
035500                                                                  03550001
035600                                                                  03560001
035700*----------------------------------------------------------------*03570001
035800*    SPECIFIC COMMMAREA FOR CEKCS604.                            *03580001
035900*----------------------------------------------------------------*03590001
036000         10  ASC-SPECIFIC-COMMAREA.                               03600001
036100             15  ASC-INT-APPL-FORMAT-IND     PIC  X(01).          03610007
036200                 88  ASC-CRIT-SPEC-FORMAT         VALUE '1'.      03620007
036300                 88  ASC-ITEM-LIST-FORMAT         VALUE '2'.      03630007
036400             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          03640007
036500             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 03650001
036600                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          03660001
036700             15  ASC-CURR-FCLTY-ID           PIC  X(04).          03670001
036800             15  ASC-CURR-FCLTY-ID-N REDEFINES                    03680001
036900                     ASC-CURR-FCLTY-ID       PIC  9(04).          03690001
037000             15  ASC-CS-LOCATION             PIC  X(04).          03700001
037100             15  ASC-CS-LOCATION-R REDEFINES ASC-CS-LOCATION.     03710001
037200                 20  ASC-CS-LOCATION-N       PIC  9(04).          03720001
037300             15  ASC-CS-LOCATION-DESC        PIC  X(25).          03730001
037400             15  ASC-CS-PRINTER-ID           PIC  X(08).          03740001
037500             15  ASC-PULL-NBR                PIC  X(09).          03750001
037600             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           03760001
037700                 20  ASC-PULL-NBR-N          PIC  9(09).          03770001
037800             15  ASC-REF-NBR                 PIC  X(15).          03780001
037900             15  ASC-CREATE-DATE             PIC  X(10).          03790005
038000             15  ASC-CREATE-USER-ID          PIC  X(08).          03800005
038100             15  ASC-STORE-NUMBER            PIC  X(04).          03810009
038200             15  ASC-STORE-NUMBER-R  REDEFINES ASC-STORE-NUMBER.  03820009
038300                 20  ASC-STORE-NUMBER-N      PIC  9(04).          03830009
038400             15  ASC-STORE-NAME              PIC  X(25).          03840005
038500             15  ASC-CURR-PULL-TYPE          PIC  X(02).          03850019
038600             15  ASC-CURR-PULL-STATUS        PIC  X(02).          03860019
038700                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     03870005
038800                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     03880001
038900                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     03890001
039000                 88  ASC-PULL-NEW                 VALUE 'NW'.     03900001
039100                 88  ASC-PULL-POSTED              VALUE 'PD'.     03910001
039200                                                                  03920001
039300             15  FILLER                      PIC  X(125).         03930004
039400         10  ASC-HOLD-INTER-APPL             PIC  X(200).         03940001
039500                                                                  03950001
039600                                                                  03960001
039700*-----------------------------------------------------------------03970001
039800*  SQL AND COBOL DECLARATION FOR COMPANY CONTROL TABLE (TCOCNTL)  03980001
039900*-----------------------------------------------------------------03990001
040000     EXEC SQL                                                     04000001
040100         INCLUDE TCOCNTL                                          04010001
040200     END-EXEC.                                                    04020001
040300                                                                  04030001
040301*-----------------------------------------------------------------04030198
040302*  CENTRAL STOCK - CENTRAL STOCK PULL CONTROL (CET_CSNTK_PL_CNTL) 04030201
040303*-----------------------------------------------------------------04030301
040304     EXEC SQL                                                     04030401
040305         INCLUDE CET00000                                         04030501
040306     END-EXEC.                                                    04030601
040307                                                                  04030701
040308                                                                  04030801
040400*-----------------------------------------------------------------04040001
040500*  CENTRAL STOCK - PULL REQUEST TABLE (TCEPLRQ)                   04050001
040600*-----------------------------------------------------------------04060001
040700     EXEC SQL                                                     04070001
040800          INCLUDE TCEPLRQ                                         04080001
040900     END-EXEC.                                                    04090001
041000                                                                  04100001
041100                                                                  04110001
041200*-----------------------------------------------------------------04120001
041300*  CENTRAL STOCK - PULL STATUS TABLE (TCEPLST)                    04130001
041400*-----------------------------------------------------------------04140001
041500     EXEC SQL                                                     04150001
041600          INCLUDE TCEPLST                                         04160001
041700     END-EXEC.                                                    04170001
041800                                                                  04180001
041900                                                                  04190001
042000*-----------------------------------------------------------------04200004
042100*  CENTRAL STOCK - PULL ITEM TABLE (TCEPLIT)                      04210004
042200*-----------------------------------------------------------------04220004
042300     EXEC SQL                                                     04230004
042400          INCLUDE TCEPLIT                                         04240004
042500     END-EXEC.                                                    04250004
042600                                                                  04260004
042700                                                                  04270004
042800*-----------------------------------------------------------------04280004
042900*  CENTRAL STOCK - PULL DISTRIBUTION TABLE (TCEPLDS)              04290004
043000*-----------------------------------------------------------------04300004
043100     EXEC SQL                                                     04310004
043200          INCLUDE TCEPLDS                                         04320004
043300     END-EXEC.                                                    04330004
043400                                                                  04340004
043500*-----------------------------------------------------------------04350055
043600*    XLT_LOC - LOGISTICS LOCATION TABLE                           04360055
043700*-----------------------------------------------------------------04370055
043800     EXEC SQL                                                     04380055
043900          INCLUDE XLT00010                                        04390055
044000     END-EXEC.                                                    04400055
044100                                                                  04410055
044200*-----------------------------------------------------------------04420055
044300*    XLT_DC_LOC_ASGMT - LOGISTICS DC ASSOCIATION TABLE            04430055
044400*-----------------------------------------------------------------04440055
044500     EXEC SQL                                                     04450055
044600          INCLUDE XLT00014                                        04460055
044700     END-EXEC.                                                    04470055
044800                                                                  04480055
044200*-----------------------------------------------------------------04481099
044300*    TKRPRPM - PROCESSING PARAMETERS                              04482099
044400*-----------------------------------------------------------------04483099
044500     EXEC SQL                                                     04484099
044600          INCLUDE TKRPRPM                                         04485099
044700     END-EXEC.                                                    04486099
044800                                                                  04487099
044900                                                                  04490004
045000*-----------------------------------------------------------------04500001
045100*    CURSOR FOR SELECTING CENTRAL STOCK LOCATION                  04510001
045200*-----------------------------------------------------------------04520001
045300     EXEC SQL                                                     04530055
045400         DECLARE  CS-LOCATION-CSR CURSOR FOR                      04540055
045500          SELECT  ASGMT.LOC_NBR                                   04550055
045600                 ,ASGMT.EFF_BEG_DTE                               04560055
045700                 ,ASGMT.DC_NBR                                    04570055
045800                                                                  04580055
045900                 ,LOC.LOC_NM                                      04590055
046000                 ,LOC.CLO_DTE                                     04600055
046100                 ,LOC.LOC_TYP_CDE                                 04610055
046200                 ,LOC.E_BUS_IND                                   04620055
046300                                                                  04630055
046400            FROM  XLT_DC_LOC_ASGMT  ASGMT                         04640055
046500                 ,XLT_LOC           LOC                           04650055
046600                                                                  04660055
046700           WHERE  ASGMT.DC_NBR = :DK-CURR-OPER-UNT-ID             04670055
046701             AND  ASGMT.LOC_NBR = LOC.LOC_NBR                     04670198
046702             AND ((LOC.LOC_TYP_CDE = 'CS') OR                     04670255
046703                  (LOC.LOC_TYP_CDE = 'DS' AND E_BUS_IND = 'Y'))   04670355
046800             AND (ASGMT.EFF_BEG_DTE =                             04680055
046900                       (SELECT MAX(EFF_BEG_DTE)                   04690055
047000                          FROM XLT_DC_LOC_ASGMT ASGMT2            04700055
047100                         WHERE ASGMT2.LOC_NBR = ASGMT.LOC_NBR))   04710055
047200                                                                  04720055
047300          ORDER BY 1                                              04730055
047400     END-EXEC.                                                    04740001
047500                                                                  04750001
047600                                                                  04760001
047700*---------------------------------------------------------------* 04770011
047800*    LINE ITEM CURSOR                                           * 04780011
047900*---------------------------------------------------------------* 04790011
048000                                                                  04800011
048100     EXEC SQL                                                     04810011
048200          DECLARE PULL-LINE-ITEM-CSR CURSOR FOR                   04820011
048300              SELECT  PL_LNE_NBR                                  04830011
048400                FROM  TCEPLIT                                     04840011
048500               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          04850011
048600                 AND  STAT_CDE        IN ('IP','NW','DS','PD')    04860011
048700            ORDER BY  PL_LNE_NBR                                  04870011
048800     END-EXEC.                                                    04880011
048900                                                                  04890011
049000                                                                  04900011
049100*-----------------------------------------------------------------04910001
049200*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                04920001
049300*-----------------------------------------------------------------04930001
049400     EXEC SQL                                                     04940001
049500          INCLUDE SQLCA                                           04950001
049600     END-EXEC.                                                    04960001
049700                                                                  04970001
049800                                                                  04980001
049900*-----------------------------------------------------------------04990001
050000*                                                                 05000001
050100*-----------------------------------------------------------------05010001
050200                                                                  05020001
050300                                                                  05030001
050400 LINKAGE SECTION.                                                 05040001
050500                                                                  05050001
050600                                                                  05060001
050700 01  DFHCOMMAREA.                                                 05070001
050800     05  FILLER                         OCCURS  1 TO 4072 TIMES   05080001
050900                                        DEPENDING ON EIBCALEN.    05090001
051000         10  FILLER                     PIC X.                    05100001
051100                                                                  05110001
051200                                                                  05120001
051300 PROCEDURE DIVISION.                                              05130001
051400*----------------------------------------------------------------*05140001
051500*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *05150001
051600*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *05160001
051700*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *05170001
051800*                                                                *05180001
051900*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *05190001
052000*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *05200001
052100*----------------------------------------------------------------*05210001
052200 0000-MAIN-MODULE.                                                05220001
052300     INITIALIZE DP030-CICS-API-FIELDS.                            05230001
053000     PERFORM 7100-GET-MAX-PULL-NBR.                               05231099
052400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05240001
052500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05250001
052600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05260001
052700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05270001
052800     MOVE LENGTH OF CE604AI        TO DP030-MAP-LENGTH (1).       05280001
052900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05290001
053000     PERFORM 0001-CALL-CICS-ARCH-API.                             05300001
053100                                                                  05310001
053200     PERFORM 1000-CONTROL-PROCESSING                              05320001
053300                                                                  05330001
053400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05340001
053500     PERFORM 0001-CALL-CICS-ARCH-API.                             05350001
053600                                                                  05360001
053700                                                                  05370001
053800 0001-CALL-CICS-ARCH-API.                                         05380001
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05391099
054000                                    DFHCOMMAREA                   05400099
054100                                    DP030-CICS-API-FIELDS         05410099
054200                                    DP020-STANDARD-COMMAREA       05420099
054300                                    CE604AI.                      05430099
054400                                                                  05440001
054500     IF  DP030-RC-CALL-SUCCESSFUL                                 05450001
054600         CONTINUE                                                 05460001
054700     ELSE                                                         05470001
054800         SET DP013-NO-ROLLBACK                                    05480001
054900             DP013-XCTL-DISPLAY-RESTART                           05490001
055000             DP013-CICS-ABEND      TO TRUE                        05500001
055100         MOVE 'BEFORE 0000-MAIN-MODULE'                           05510001
055200                                   TO DP013-PARAGRAPH             05520001
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05521099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05522099
055500         MOVE  SPACES              TO DP013-MESSAGE-TEXT (3)      05550001
055600         STRING  'RETURN CODE - '     DELIMITED BY SIZE           05560001
055700                  DP030-RETURN-CODE   DELIMITED BY SIZE           05570001
055800                                 INTO DP013-MESSAGE-TEXT (3)      05580001
055900         PERFORM DP013-0000-PROCESS-ABEND                         05590001
056000     END-IF.                                                      05600001
056100                                                                  05610001
056200                                                                  05620001
056300*----------------------------------------------------------------*05630001
056400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05640001
056500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05650001
056600*----------------------------------------------------------------*05660001
056700 1000-CONTROL-PROCESSING.                                         05670001
056800                                                                  05680001
056900     EVALUATE TRUE                                                05690001
057000         WHEN DP020-NEXT-ACT-INITIAL                              05700001
057100             INITIALIZE ASC-SPECIFIC-COMMAREA                     05710001
057200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05720005
057300             PERFORM 3200-RESET-ATTRIBUTES                        05730008
057400             PERFORM 7000-BUILD-INITIAL-PANEL                     05740001
057500                                                                  05750001
057600         WHEN DP020-NEXT-ACT-READ-MAP                             05760001
057700             PERFORM 2000-FKEY-PROCESSING                         05770001
057800                                                                  05780001
057900         WHEN DP020-NEXT-ACT-RETURN                               05790001
058000              IF  DP020-LOCATION-NBR  =  PC-CORPORATE-OFFICE      05800053
058100                  MOVE  PC-MENO-FALLS-DC TO DK-CURR-OPER-UNT-ID   05810001
058200                                            DK-OPER-UNT-ID        05820001
058300                                            ASC-CURR-OPER-UNT-ID  05830001
058400              ELSE                                                05840001
058500                  INITIALIZE PV-USER-LOCATION                     05850001
058600                  MOVE DP020-LOCATION-NBR TO PV-USER-LOCATION     05860053
058700                  MOVE PV-USER-LOCATION TO DK-CURR-OPER-UNT-ID    05870001
058800                                           DK-OPER-UNT-ID         05880001
058900                                           ASC-CURR-OPER-UNT-ID   05890001
059000             END-IF                                               05900001
059100             MOVE PC-FCLTY-ID-0001         TO DK-CURR-FCLTY-ID    05910001
059200             PERFORM 7010-GET-CS-LOCATION                         05920001
059600             MOVE PV-CS-STORE-NMBR          TO MLOCIDO            05960052
059700             MOVE PV-CS-STORE-NAME          TO MLOCDESO           05970052
059800             PERFORM 7020-GET-CS-DEFAULTS                         05980001
059900                                                                  05990005
060000             MOVE PV-CURRENT-MMDDYY         TO MCREDTEO           06000005
060100             MOVE DP020-USERID              TO MUSERIDO           06010005
060200             MOVE COCNTL-DFLT-CNSTK-PRTR-ID TO MPRTIDO            06020005
060300                                                                  06030001
060400             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 06040001
060500             MOVE -1                        TO MLOCIDL            06050005
060600             SET DP030-SET-CURSOR-APPL-1    TO TRUE               06060005
060700             PERFORM 3200-RESET-ATTRIBUTES                        06070001
060800                                                                  06080001
060900         WHEN OTHER                                               06090001
061000             SET DP013-LOGIC-ABEND                                06100001
061100                 DP013-NO-ROLLBACK TO TRUE                        06110001
061200             MOVE 'CEKCS604 - 1000-CONTROL-PROCESSING'            06120001
061300                                   TO  DP013-PARAGRAPH            06130001
061400             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   06140001
061500                                   TO  DP013-MESSAGE-TEXT(1)      06150001
061600             MOVE DP020-NEXT-APPL-ACTIVITY                        06160001
061700                                   TO DP013-MESSAGE-TEXT(2)       06170001
061800             PERFORM DP013-0000-PROCESS-ABEND                     06180001
061900     END-EVALUATE.                                                06190001
062000                                                                  06200001
062100                                                                  06210001
062200*----------------------------------------------------------------*06220005
062300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06230005
062400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06240005
062500*----------------------------------------------------------------*06250005
062600                                                                  06260005
062700 1100-PROCESS-INTER-APPL-COMM.                                    06270005
062800                                                                  06280005
062900     SET PS-COMMAREA-VALID         TO TRUE.                       06290005
063000                                                                  06300007
063100     MOVE DP020-INT-APPL-FORMAT-IND   TO ASC-INT-APPL-FORMAT-IND. 06310007
063200                                                                  06320007
063300     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          06330007
063400         MOVE CE001-CURR-OPER-UNT-ID-N                            06340007
063500                                      TO ASC-CURR-OPER-UNT-ID-N   06350007
063600         MOVE PC-0001                 TO ASC-CURR-FCLTY-ID-N      06360007
063700         MOVE CE001-CS-LOCATION       TO ASC-CS-LOCATION          06370007
063800         MOVE CE001-CS-PRINTER-ID     TO ASC-CS-PRINTER-ID        06380007
063900         MOVE ZEROES                  TO ASC-PULL-NBR-N           06390007
064000         MOVE SPACES                  TO ASC-REF-NBR              06400007
064100     ELSE                                                         06410007
064200         MOVE CE002-CURR-OPER-UNT-ID-N                            06420007
064300                                      TO ASC-CURR-OPER-UNT-ID-N   06430007
064400         MOVE PC-0001                 TO ASC-CURR-FCLTY-ID-N      06440007
064500         MOVE CE002-CS-LOCATION       TO ASC-CS-LOCATION          06450007
064600         MOVE CE002-CS-PRINTER-ID     TO ASC-CS-PRINTER-ID        06460007
064700         MOVE CE002-PULL-NBR          TO ASC-PULL-NBR-N           06470007
064800         MOVE CE002-REF-NBR           TO ASC-REF-NBR              06480007
064900     END-IF.                                                      06490005
065000                                                                  06500005
065100                                                                  06510005
065200*----------------------------------------------------------------*06520001
065300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06530001
065400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06540001
065500* EDITS.                                                         *06550001
065600*----------------------------------------------------------------*06560001
065700 2000-FKEY-PROCESSING.                                            06570001
065800                                                                  06580001
065900     EVALUATE TRUE                                                06590001
066000                                                                  06600001
066100         WHEN DP020-SRC-AID = DP016-CLEAR                         06610001
066200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06620001
066300             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 06630001
066400             MOVE -1                   TO MLOCIDL                 06640007
066500                                                                  06650001
066600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06660001
066700             IF  ASC-CRIT-SPEC-FORMAT                             06670010
066800                 INITIALIZE ASC-SPECIFIC-COMMAREA                 06680010
066900             END-IF                                               06690010
067000             PERFORM 3200-RESET-ATTRIBUTES                        06700008
067100             PERFORM 7000-BUILD-INITIAL-PANEL                     06710001
067200             IF  ASC-CRIT-SPEC-FORMAT                             06720010
067300                 MOVE -1                   TO MLOCIDL             06730010
067400             ELSE                                                 06740010
067500                 MOVE -1                   TO MSTORNOL            06750010
067600             END-IF                                               06760010
067700                                                                  06770001
067800         WHEN OTHER                                               06780001
067900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06790001
068000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06800001
068100                                                                  06810001
068200             IF  PS-NO-ERROR                                      06820001
068300                 SET DP030-CONTINUE-GO TO TRUE                    06830001
068400                 PERFORM 2100-CHECK-FUNCTION-KEY                  06840001
068500             ELSE                                                 06850001
068600                 PERFORM 8000-MOVE-COMMAREA-TO-SCREEN             06860010
068700                 SET DP030-OVERRIDE-GO TO TRUE                    06870001
068800             END-IF                                               06880001
068900     END-EVALUATE.                                                06890001
069000                                                                  06900001
069100                                                                  06910001
069200*----------------------------------------------------------------*06920001
069300*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *06930001
069400*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *06940001
069500*  FROM THE CICS ARCHITECTURE API.                               *06950001
069600*----------------------------------------------------------------*06960001
069700 2100-CHECK-FUNCTION-KEY.                                         06970001
069800     EVALUATE TRUE                                                06980001
069900         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 06990001
070000         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   07000001
070100              PERFORM 2110-PREPARE-INTER-APPL-COMM                07010001
070200*                                                                 07020017
070300* ENTER                                                           07030017
070400*                                                                 07040017
070500         WHEN DP020-SRC-AID = DP016-ENTER                         07050001
070600              PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                07060001
070700              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 07070001
070800              IF  ASC-ITEM-LIST-FORMAT                            07080010
070900                  MOVE -1                 TO MSTORNOL             07090010
071000              ELSE                                                07100010
071100                  MOVE -1                 TO MLOCIDL              07110010
071200              END-IF                                              07120010
071300                                                                  07130001
071400*                                                                 07140019
071500* F23 - PRINT PULL      (LOCAL-FUNC-03)                           07150019
071600*                                                                 07160019
071700         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              07170019
071800                                                                  07180030
071900             MOVE 'CECSPPRT' TO DP008-FUNCTION-NAME               07190030
072000             PERFORM 2105-RACF-ACCESS                             07200030
072100             IF  PS-ACCESS-NOT-ALLOWED                            07210030
072200                 SET  PS-ERROR                                    07220030
072300                      DP020-MSG-FATAL TO TRUE                     07230030
072400                 MOVE PC-TSYMSG-02306 TO DP020-MSG-NUMBER         07240030
072500                 MOVE -1              TO MLOCIDL                  07250030
072600                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             07260030
072700             END-IF                                               07270030
072800                                                                  07280030
072900             IF  PS-NO-ERROR                                      07290030
073000                  PERFORM 4600-PROCESS-PRINT-FUNCTION             07300030
073100                  IF  PS-NO-ERROR                                 07310030
073200                      SET DP020-MSG-INFORMATIONAL  TO  TRUE       07320030
073300                      MOVE PC-TSYMSG-02235 TO DP020-MSG-NUMBER    07330030
073400                  END-IF                                          07340030
073500              END-IF                                              07350030
073600                                                                  07360030
073700* OTHER                                                           07370030
073800*                                                                 07380017
073900         WHEN OTHER                                               07390001
074000              SET DP013-NO-ROLLBACK                               07400001
074100                  DP013-XCTL-DISPLAY-RESTART                      07410001
074200                  DP013-CICS-ABEND  TO TRUE                       07420001
074300              MOVE '2100-CHECK-FUNCTION-KEY'                      07430001
074400                                    TO DP013-PARAGRAPH            07440001
074500              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     07450001
074600                                   TO DP013-MESSAGE-TEXT (1)      07460001
074700             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 07470001
074800                                   TO DP013-MESSAGE-TEXT (2)      07480001
074900             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                07490001
075000             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 07500001
075100                                   TO PM-A-FK-ACTION              07510001
075200             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              07520001
075300                                   TO PM-A-FK-DISPN               07530001
075400             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      07540001
075500             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        07550001
075600                                   TO DP013-MESSAGE-TEXT (4)      07560001
075700             PERFORM DP013-0000-PROCESS-ABEND                     07570001
075800     END-EVALUATE.                                                07580001
075900                                                                  07590001
076000                                                                  07600001
076100*----------------------------------------------------------------*07610030
076200* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     07620030
076300*----------------------------------------------------------------*07630030
076400 2105-RACF-ACCESS.                                                07640030
076500                                                                  07650030
076600      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  07660030
076700      SET DP008-ACCESS-TYPE-USE          TO TRUE                  07670030
076800                                                                  07680030
076900      EXEC CICS                                                   07690030
077000         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 07700030
077100              COMMAREA (DP008-SECURITY-COMMAREA)                  07710030
077200              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             07720030
077300      END-EXEC                                                    07730030
077400                                                                  07740030
077500      IF DP008-CALL-SUCCESSFUL                                    07750030
077600         IF DP008-ACCESS-ALLOWED                                  07760030
077700             SET PS-ACCESS-ALLOWED TO TRUE                        07770030
077800         ELSE                                                     07780030
077900             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    07790030
078000         END-IF                                                   07800030
078100     ELSE                                                         07810030
078200         MOVE '2105-RACF-ACCESS'                                  07820030
078300                               TO DP013-PARAGRAPH                 07830030
078400          MOVE 'UNABLE TO ACCESS CICS'                            07840030
078500                               TO DP013-MESSAGE-TEXT (1)          07850030
078600          MOVE SQLCA                 TO DP013-SQLCA               07860030
078700          SET DP013-DB2-ABEND                                     07870030
078800              DP013-XCTL-DISPLAY-RESTART                          07880030
078900                               TO TRUE                            07890030
079000          PERFORM DP013-0000-PROCESS-ABEND                        07900030
079100      END-IF.                                                     07910030
079200                                                                  07920030
079300                                                                  07930030
079400*----------------------------------------------------------------*07940001
079500*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *07950001
079600*  INTER-APPLICATION COMMAREA.                                   *07960001
079700*----------------------------------------------------------------*07970001
079800 2110-PREPARE-INTER-APPL-COMM.                                    07980001
079900                                                                  07990001
080000     INITIALIZE CE002-INTER-APPL-COMMAREA.                        08000005
080100                                                                  08010001
080200     MOVE ASC-CURR-OPER-UNT-ID-N    TO CE002-CURR-OPER-UNT-ID-N.  08020005
080300     MOVE ASC-CURR-FCLTY-ID-N       TO CE002-CURR-FCLTY-ID-N.     08030005
080400     MOVE ASC-CS-LOCATION           TO CE002-CS-LOCATION.         08040005
080500     MOVE ASC-CS-PRINTER-ID         TO CE002-CS-PRINTER-ID.       08050005
080600     MOVE ASC-PULL-NBR-N            TO CE002-PULL-NBR.            08060005
080700     MOVE ASC-REF-NBR               TO CE002-REF-NBR.             08070005
080800                                                                  08080001
080900*                                                                 08090026
081000* F16 - ADD BY SKU      (LOCAL-FUNC-01)                           08100026
081100*                                                                 08110026
081200     EVALUATE TRUE                                                08120026
081300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08130026
081400                                                                  08140026
081500              IF  ASC-CRIT-SPEC-FORMAT  AND                       08150033
081600                  ASC-PULL-NBR  NOT > SPACE                       08160033
081700                  PERFORM 5000-GET-NEXT-PULL-NBR                  08170026
081800              END-IF                                              08180026
081900              INITIALIZE CE006-INTER-APPL-COMMAREA                08190026
082000              MOVE ASC-CURR-OPER-UNT-ID-N                         08200026
082100                                      TO CE006-CURR-OPER-UNT-ID-N 08210026
082200              MOVE ASC-CURR-FCLTY-ID-N                            08220026
082300                                      TO CE006-CURR-FCLTY-ID-N    08230026
082400              MOVE ASC-CS-LOCATION-N  TO CE006-CS-LOCATION        08240026
082500              MOVE ASC-CS-PRINTER-ID  TO CE006-CS-PRINTER-ID      08250026
082600              MOVE ASC-PULL-NBR-N     TO CE006-PULL-NBR           08260026
082700              MOVE ASC-REF-NBR        TO CE006-REF-NBR            08270026
082800              MOVE ASC-CREATE-USER-ID TO CE006-USER-ID            08280029
082900              MOVE ASC-STORE-NUMBER-N TO CE006-STORE-NBR          08290026
082910              MOVE ASC-CURR-PULL-TYPE TO CE006-PULL-TYPE          08291098
083000*                                                                 08300026
083100* F22 - ADD BY UPC      (LOCAL-FUNC-02)                           08310026
083200*                                                                 08320026
083300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              08330026
083400                                                                  08340026
083500              IF  ASC-CRIT-SPEC-FORMAT                            08350026
083600                  PERFORM 5000-GET-NEXT-PULL-NBR                  08360026
083700              END-IF                                              08370026
083800              INITIALIZE CE006-INTER-APPL-COMMAREA                08380026
083900              MOVE ASC-CURR-OPER-UNT-ID-N                         08390026
084000                                      TO CE006-CURR-OPER-UNT-ID-N 08400026
084100              MOVE ASC-CURR-FCLTY-ID-N                            08410026
084200                                      TO CE006-CURR-FCLTY-ID-N    08420026
084300              MOVE ASC-CS-LOCATION-N  TO CE006-CS-LOCATION        08430026
084400              MOVE ASC-CS-PRINTER-ID  TO CE006-CS-PRINTER-ID      08440026
084500              MOVE ASC-PULL-NBR-N     TO CE006-PULL-NBR           08450026
084600              MOVE ASC-REF-NBR        TO CE006-REF-NBR            08460026
084700              MOVE ASC-REF-NBR        TO CE006-USER-ID            08470026
084800              MOVE ASC-STORE-NUMBER-N TO CE006-STORE-NBR          08480026
084810              MOVE ASC-CURR-PULL-TYPE TO CE006-PULL-TYPE          08481098
084900*                                                                 08490033
085000* F17 - ITEM LIST       (LOCAL-FUNC-04)                           08500033
085100*                                                                 08510033
085200         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              08520033
085300                                                                  08530033
085400              INITIALIZE CE001-INTER-APPL-COMMAREA                08540033
085500              MOVE ASC-CURR-OPER-UNT-ID-N                         08550033
085600                                      TO CE001-CURR-OPER-UNT-ID-N 08560033
085700              MOVE ASC-CURR-FCLTY-ID-N                            08570033
085800                                      TO CE001-CURR-FCLTY-ID-N    08580033
085900              MOVE ASC-CS-LOCATION-N  TO CE001-CS-LOCATION        08590033
086000              MOVE ASC-CS-PRINTER-ID  TO CE001-CS-PRINTER-ID      08600033
086100              MOVE ASC-PULL-NBR-N     TO CE001-PULL-NBR           08610033
086200              MOVE ASC-REF-NBR        TO CE001-REF-NBR            08620033
086300              MOVE ASC-CURR-PULL-STATUS                           08630033
086400                                      TO CE001-CURR-PULL-STATUS   08640033
086500              MOVE ASC-CURR-PULL-TYPE TO CE001-CURR-PULL-TYPE     08650033
086600     END-EVALUATE.                                                08660033
086700                                                                  08670001
086800                                                                  08680001
086900*----------------------------------------------------------------*08690001
087000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*08700001
087100* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *08710001
087200* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *08720001
087300*----------------------------------------------------------------*08730001
087400 2200-MOVE-SCREEN-TO-COMMAREA.                                    08740001
087500                                                                  08750001
087600* CENTRAL STOCK LOCATION                                          08760001
087700     IF  MLOCIDL > ZERO                                           08770001
087800         MOVE MLOCIDI              TO ASC-CS-LOCATION             08780001
087900     ELSE                                                         08790001
088000         MOVE ZEROES               TO ASC-CS-LOCATION             08800001
088100     END-IF.                                                      08810001
088200                                                                  08820001
088300* PRINTER ID                                                      08830001
088400     IF  MPRTIDL > ZERO                                           08840001
088500         MOVE MPRTIDI              TO ASC-CS-PRINTER-ID           08850001
088600     ELSE                                                         08860001
088700         MOVE SPACES               TO ASC-CS-PRINTER-ID           08870031
088800     END-IF.                                                      08880001
088900                                                                  08890001
089000* PULL NUMBER                                                     08900001
089100     IF  MLOCIDL > ZERO                                           08910007
089200         MOVE MPULLNOI             TO ASC-PULL-NBR                08920001
089300     ELSE                                                         08930001
089400         IF  MPULLNOF = DP015-ERASE-EOF                           08940001
089500             MOVE ZEROES           TO ASC-PULL-NBR                08950001
089600         END-IF                                                   08960001
089700     END-IF.                                                      08970001
089800                                                                  08980001
089900* REFERENCE NUMBER                                                08990001
090000     IF  MREFNOL > ZERO                                           09000001
090100         MOVE MREFNOI             TO ASC-REF-NBR                  09010001
090200     ELSE                                                         09020001
090300         IF  MREFNOF = DP015-ERASE-EOF                            09030001
090400             MOVE SPACES          TO ASC-REF-NBR                  09040001
090500         END-IF                                                   09050001
090600     END-IF.                                                      09060001
090700                                                                  09070001
090800* PULL CREATE DATE                                                09080005
090900     IF  MCREDTEL > ZERO                                          09090005
091000         MOVE MCREDTEI            TO ASC-CREATE-DATE              09100005
091100     ELSE                                                         09110001
091200         IF  MCREDTEF = DP015-ERASE-EOF                           09120005
091300             MOVE ZEROES          TO ASC-CREATE-DATE              09130005
091400         END-IF                                                   09140001
091500     END-IF.                                                      09150001
091600                                                                  09160001
091700* PULL CREATE USERID                                              09170005
091800     IF  MUSERIDL > ZERO                                          09180005
091900         MOVE MUSERIDI            TO ASC-CREATE-USER-ID           09190005
092000     ELSE                                                         09200001
092100         IF  MUSERIDF = DP015-ERASE-EOF                           09210005
092200             MOVE ZEROES          TO ASC-CREATE-USER-ID           09220005
092300         END-IF                                                   09230001
092400     END-IF.                                                      09240001
092500                                                                  09250001
092600* PULL STORE NUMBER                                               09260005
092700     IF  MSTORNOL > ZERO                                          09270005
092800         MOVE MSTORNOI            TO ASC-STORE-NUMBER             09280005
092900     ELSE                                                         09290001
093000         IF  MSTORNOF = DP015-ERASE-EOF                           09300005
093100             MOVE ZEROES          TO ASC-STORE-NUMBER             09310005
093200         END-IF                                                   09320001
093300     END-IF.                                                      09330001
093400                                                                  09340001
093500                                                                  09350001
093600*----------------------------------------------------------------*09360001
093700* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *09370001
093800* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *09380001
093900* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*09390001
094000* IN THE DESTINATION PROGRAM, NOT HERE.                          *09400001
094100*----------------------------------------------------------------*09410001
094200 3000-EDIT-DATA-IN-COMMAREA.                                      09420001
094300                                                                  09430001
094400     PERFORM 3200-RESET-ATTRIBUTES.                               09440001
094500                                                                  09450001
094600*-----------------------------------------------------------------09460001
094700* VERIFY THAT CENTRAL STOCK LOCATION IS NUMERIC                   09470001
094800*-----------------------------------------------------------------09480001
094900     IF  ASC-CS-LOCATION >  SPACES                                09490001
095000         MOVE ASC-CS-LOCATION          TO DP010I-UNEDITED-FIELD   09500001
095100         MOVE LENGTH OF ASC-CS-LOCATION                           09510001
095200                                       TO DP010I-MAXIMUM-DIGITS   09520001
095300         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09530001
095400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09540001
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09551099
263455              USING DP010I-NUMERIC-EDIT-AREA                      09552099
095600         IF  DP010I-ERROR-DETECTED                                09560001
095700             SET PS-ERROR                                         09570001
095800                 DP020-MSG-FATAL       TO TRUE                    09580001
095900             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        09590001
096000             MOVE DP015-UNP-ALP-BRT-OFF                           09600001
096100                                       TO MLOCIDA                 09610001
096200             MOVE DP015-RED            TO MLOCIDC                 09620001
096300             MOVE DP015-REVERSE        TO MLOCIDH                 09630001
096400             MOVE -1                   TO MLOCIDL                 09640001
096500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09650001
096600         ELSE                                                     09660001
096700             MOVE DP010I-NUMERIC-FIELD TO ASC-CS-LOCATION-N       09670001
096800             MOVE ASC-CS-LOCATION      TO MLOCIDO                 09680001
096900         END-IF                                                   09690001
097000     END-IF.                                                      09700001
097100                                                                  09710001
097200                                                                  09720001
097300*-----------------------------------------------------------------09730001
097400* VERIFY THAT CENTRAL STOCK LOCATION ENTERED IS VALID             09740001
097500*-----------------------------------------------------------------09750001
097600     IF  PS-NO-ERROR                                              09760001
097700         PERFORM 3030-FIND-CS-LOCATION                            09770050
097800     END-IF.                                                      09780001
097900                                                                  09790001
098000                                                                  09800001
098100*-----------------------------------------------------------------09810001
098200* VALIDATE PRINTER ID                                             09820001
098300* PRINTER ID ONLY REQUIRED FOR LOCAL-03 (F23-PRT PULL)            09830032
098400*-----------------------------------------------------------------09840001
098500     IF  PS-NO-ERROR                                              09850001
098600         EVALUATE TRUE                                            09860031
098700             WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)          09870031
098800                  PERFORM 3010-VALIDATE-PRINTER-ID                09880031
098900         END-EVALUATE                                             09890031
099000     END-IF.                                                      09900001
099100                                                                  09910001
099200                                                                  09920001
099300*-----------------------------------------------------------------09930001
099400* VERIFY THAT PULL NUMBER (IF ENTERED) IS NUMERIC                 09940001
099500*-----------------------------------------------------------------09950001
099600     IF  ASC-PULL-NBR  >  SPACES                                  09960001
099700         MOVE ASC-PULL-NBR             TO DP010I-UNEDITED-FIELD   09970001
099800         MOVE LENGTH OF ASC-PULL-NBR   TO DP010I-MAXIMUM-DIGITS   09980001
099900         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09990001
100000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10000001
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10011099
263455              USING DP010I-NUMERIC-EDIT-AREA                      10012099
100200         IF  DP010I-ERROR-DETECTED                                10020001
100300             SET PS-ERROR                                         10030001
100400                 DP020-MSG-FATAL       TO TRUE                    10040001
100500             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        10050001
100600             MOVE DP015-UNP-ALP-BRT-OFF                           10060001
100700                                       TO MPULLNOA                10070001
100800             MOVE DP015-RED            TO MPULLNOC                10080001
100900             MOVE DP015-REVERSE        TO MPULLNOH                10090001
101000             MOVE -1                   TO MLOCIDL                 10100007
101100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10110001
101200         ELSE                                                     10120001
101300             MOVE DP010I-NUMERIC-FIELD                            10130001
101400                                   TO ASC-PULL-NBR-N              10140001
101500                                      MPULLNOO                    10150001
101600         END-IF                                                   10160001
101700     END-IF.                                                      10170001
101800                                                                  10180001
101900*-----------------------------------------------------------------10190001
102000* VERIFY PULL NUMBER (IF ENTERED) IS VALID                        10200001
102100*-----------------------------------------------------------------10210001
102200     IF  ASC-PULL-NBR > ZEROES                                    10220001
102300         MOVE ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                  10230001
102400         IF PS-NO-ERROR                                           10240001
102500             EXEC SQL                                             10250001
102600                 SELECT CNSTK_REQ_PL_NBR                          10260001
102700                       ,CNSTK_LOC_ID                              10270001
102800                       ,SRC_REF_NBR                               10280001
102900                       ,SRC_TYP_CDE                               10290001
103000                       ,STAT_CDE                                  10300001
103100                   INTO :CEPLRQ-CNSTK-REQ-PL-NBR                  10310001
103200                       ,:CEPLRQ-CNSTK-LOC-ID                      10320001
103300                       ,:CEPLRQ-SRC-REF-NBR                       10330001
103400                       ,:CEPLRQ-SRC-TYP-CDE                       10340001
103500                       ,:CEPLRQ-STAT-CDE                          10350001
103600                   FROM TCEPLRQ                                   10360001
103700                  WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER      10370001
103800             END-EXEC                                             10380001
103900                                                                  10390001
104000             EVALUATE TRUE                                        10400001
104100                 WHEN SQLCODE = +0                                10410001
104200                      MOVE  CEPLRQ-STAT-CDE                       10420001
104300                            TO  ASC-CURR-PULL-STATUS              10430001
104400                      MOVE  CEPLRQ-SRC-TYP-CDE                    10440019
104500                            TO  ASC-CURR-PULL-TYPE                10450019
104600                 WHEN SQLCODE = +100                              10460001
104700                     SET PS-ERROR                                 10470001
104800                         DP020-MSG-FATAL   TO TRUE                10480001
104900                     MOVE PC-TSYMSG-02214  TO DP020-MSG-NUMBER    10490001
105000                     MOVE DP015-UNP-ALP-BRT-OFF                   10500001
105100                                           TO MPULLNOA            10510001
105200                     MOVE DP015-RED        TO MPULLNOC            10520001
105300                     MOVE DP015-REVERSE    TO MPULLNOH            10530001
105400                     MOVE -1               TO MLOCIDL             10540007
105500                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          10550001
105600                 WHEN OTHER                                       10560001
105700                      MOVE  ASC-PULL-NBR   TO PV-DISPLAY-PULL-NBR 10570001
105800                      MOVE '3000-EDIT-DATA-IN-COMMAREA'           10580001
105900                                       TO DP013-PARAGRAPH         10590001
106000                      MOVE 'VERIFY PULL NUMBER IN SYSTEM'         10600001
106100                                       TO DP013-MESSAGE-TEXT (1)  10610001
106200                      STRING ' PULL NBR-'  DELIMITED BY SIZE      10620001
106300                              PV-DISPLAY-PULL-NBR                 10630001
106400                                           DELIMITED BY SIZE      10640001
106500                                     INTO DP013-MESSAGE-TEXT (2)  10650001
106600                      MOVE SQLCA   TO DP013-SQLCA                 10660001
106700                      MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1) 10670001
106800                      SET DP013-DB2-ABEND                         10680001
106900                          DP013-XCTL-DISPLAY-RESTART              10690001
107000                                       TO TRUE                    10700001
107100                      PERFORM DP013-0000-PROCESS-ABEND            10710001
107200             END-EVALUATE                                         10720001
107300         END-IF                                                   10730001
107400     END-IF.                                                      10740001
107500                                                                  10750001
107600     IF  PS-NO-ERROR                                              10760001
107700         IF  ASC-REF-NBR  > SPACES                                10770001
107800             CONTINUE                                             10780001
107900         ELSE                                                     10790001
108000             IF  CEPLRQ-SRC-REF-NBR  >  SPACES                    10800001
108100                 MOVE  CEPLRQ-SRC-REF-NBR  TO  ASC-REF-NBR        10810001
108200             END-IF                                               10820001
108300         END-IF                                                   10830001
108400         MOVE  CEPLRQ-STAT-CDE     TO  ASC-CURR-PULL-STATUS       10840001
108500     END-IF.                                                      10850001
108600                                                                  10860001
108700*-----------------------------------------------------------------10870009
108800* VERIFY THAT STORE NUMBER (IF ENTERED) IS NUMERIC                10880009
108900*-----------------------------------------------------------------10890009
109000     IF  ASC-STORE-NUMBER  >  SPACES                              10900009
109100         MOVE ASC-STORE-NUMBER         TO DP010I-UNEDITED-FIELD   10910009
109200         MOVE LENGTH OF ASC-STORE-NUMBER                          10920009
109300                                       TO DP010I-MAXIMUM-DIGITS   10930009
109400         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 10940009
109500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10950009
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10961099
263455              USING DP010I-NUMERIC-EDIT-AREA                      10962099
109700         IF  DP010I-ERROR-DETECTED                                10970009
109800             SET PS-ERROR                                         10980009
109900                 DP020-MSG-FATAL       TO TRUE                    10990009
110000             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        11000009
110100             MOVE DP015-UNP-ALP-BRT-OFF                           11010009
110200                                       TO MSTORNOA                11020009
110300             MOVE DP015-RED            TO MSTORNOC                11030009
110400             MOVE DP015-REVERSE        TO MSTORNOH                11040009
110500             MOVE -1                   TO MSTORNOL                11050009
110600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11060009
110700         ELSE                                                     11070009
110800             MOVE DP010I-NUMERIC-FIELD TO ASC-STORE-NUMBER-N      11080009
110900             MOVE ASC-STORE-NUMBER     TO MSTORNOO                11090009
111000         END-IF                                                   11100009
111100     END-IF.                                                      11110009
111200                                                                  11120009
111300                                                                  11130009
111400*-----------------------------------------------------------------11140009
111500* VERIFY THAT STORE NUMBER (IF ENTERED) IS VALID/GET STORE NAME   11150009
111600*-----------------------------------------------------------------11160009
111700     IF  PS-NO-ERROR                                              11170009
111800       IF ASC-STORE-NUMBER-N  >  ZEROES                           11180051
111900          MOVE  ASC-STORE-NUMBER-N  TO  DK-STORE-NUMBER           11190051
112000          PERFORM 3500-GET-STORE-INFORMATION                      11200051
112100                                                                  11210009
112200          EVALUATE TRUE                                           11220009
112300              WHEN XL071-NO-ERRORS                                11230051
112400                   MOVE XL071-LOC-NM      TO PV-STORE-NAME        11240051
112500                   MOVE XL071-LOC-TYP-CDE TO PV-STORE-TYPE        11250051
112600                                                                  11260051
112700                   MOVE  PV-STORE-NAME   TO  MSTRNMEO             11270009
112800                                             ASC-STORE-NAME       11280009
112801*DJK 04/20/2010 BEGIN                                             11280198
112802                   MOVE XL071-E-BUS-IND   TO PV-ST-E-BUS-LOC-IND  11280251
112803*DJK 04/20/2010 END                                               11280398
112804                                                                  11280498
112900                   IF (PV-STORE-TYPE      =  PC-CS)  OR           11290009
113000                      (PV-STORE-TYPE      =  PC-DC)  OR           11300009
113100                      (PV-STORE-TYPE      =  PC-DS)  OR           11310009
113200                      (PV-STORE-TYPE      =  PC-RV)               11320009
113300                       CONTINUE                                   11330009
113400                   ELSE                                           11340009
113500                       MOVE  SPACES      TO  MSTRNMEO             11350009
113600                                             ASC-STORE-NAME       11360009
113700                       SET PS-ERROR                               11370009
113800                           DP020-MSG-FATAL   TO TRUE              11380009
113900                       MOVE PC-TSYMSG-02293  TO DP020-MSG-NUMBER  11390009
114000                       MOVE DP015-UNP-ALP-BRT-OFF                 11400009
114100                                             TO MSTORNOA          11410009
114200                       MOVE DP015-RED        TO MSTORNOC          11420009
114300                       MOVE DP015-REVERSE    TO MSTORNOH          11430009
114400                       MOVE -1               TO MSTORNOL          11440009
114500                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        11450009
114600                   END-IF                                         11460009
114700              WHEN XL071-LOC-NOT-FOUND                            11470051
114800                   MOVE  SPACES              TO  MSTRNMEO         11480009
114900                                                 ASC-STORE-NAME   11490009
115000                   SET PS-ERROR                                   11500009
115100                       DP020-MSG-FATAL       TO TRUE              11510009
115200                   MOVE PC-TSYMSG-02294      TO DP020-MSG-NUMBER  11520009
115300                   MOVE DP015-UNP-ALP-BRT-OFF                     11530009
115400                                             TO MSTORNOA          11540009
115500                   MOVE DP015-RED            TO MSTORNOC          11550009
115600                   MOVE DP015-REVERSE        TO MSTORNOH          11560009
115700                   MOVE -1                   TO MSTORNOL          11570009
115800                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            11580009
115900         END-EVALUATE                                             11590009
116000       END-IF                                                     11600010
116100     END-IF.                                                      11610010
116200                                                                  11620098
116201*DJK 04/29/2010 BEGIN                                             11620198
116202     IF ASC-CS-LOCATION = ASC-STORE-NUMBER-N                      11620201
116203         SET PS-ERROR                                             11620309
116204             DP020-MSG-FATAL       TO TRUE                        11620409
116205         MOVE PC-TSYMSG-02294      TO DP020-MSG-NUMBER            11620509
116206         MOVE DP015-UNP-NUM-BRT-MDT                               11620609
116207                                   TO MSTORNOA                    11620709
116208                                      MLOCIDA                     11620898
116209         MOVE DP015-RED            TO MSTORNOC                    11620909
116210                                      MLOCIDC                     11621098
116220         MOVE DP015-REVERSE        TO MSTORNOH                    11622009
116221                                      MLOCIDH                     11622198
116222         MOVE -1                   TO MSTORNOL                    11622209
116223                                      MLOCIDL                     11622398
116224         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11622409
116225     END-IF.                                                      11622598
116226                                                                  11622610
116227     IF PV-ST-E-BUS-LOC-IND = 'Y'                                 11622798
116228       AND PV-CS-E-BUS-LOC-IND = 'Y'                              11622898
116229         MOVE 'XF'  TO PC-MANUAL                                  11622998
116230                       ASC-CURR-PULL-TYPE                         11623098
116240     ELSE                                                         11624098
116250         MOVE 'UC'  TO PC-MANUAL                                  11625098
116260     END-IF.                                                      11626098
116270*DJK 04/29/2010 END                                               11627098
116300                                                                  11630001
116400*-----------------------------------------------------------------11640001
116500* VERIFY NECESSARY FIELDS ENTERED FOR "ADD BY SKU"                11650005
116600*  F16 - LOCAL-01                                                 11660005
116700*-----------------------------------------------------------------11670001
116800     IF  DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)                    11680005
116900         IF  PS-NO-ERROR                                          11690001
117000             PERFORM 3300-ADD-BY-SKU-FIELDS                       11700005
117100         END-IF                                                   11710001
117200     END-IF.                                                      11720001
117400                                                                  11740001
117500                                                                  11750001
117600*-----------------------------------------------------------------11760001
117700* VERIFY NECESSARY FIELDS ENTERED FOR "ADD BY UPD"                11770005
117800*  F22 - LOCAL-02                                                 11780005
117900*-----------------------------------------------------------------11790001
118000     IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)                    11800005
118100         IF  PS-NO-ERROR                                          11810001
118200             PERFORM 3310-ADD-BY-UPC-FIELDS                       11820005
118300         END-IF                                                   11830001
118400     END-IF.                                                      11840001
118500                                                                  11850001
118600                                                                  11860001
118700*-----------------------------------------------------------------11870001
118800* VERIFY NECESSARY FIELDS ENTERED FOR "PRINT PULL"                11880001
118900*  F23 - LOCAL-03                                                 11890005
119000*-----------------------------------------------------------------11900001
119100     IF  DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)                    11910005
119200         IF  PS-NO-ERROR                                          11920001
119300             PERFORM 3320-PRT-PULL-FIELDS                         11930001
119400         END-IF                                                   11940001
119500     END-IF.                                                      11950001
119600                                                                  11960001
119700                                                                  11970001
119800*----------------------------------------------------------------*11980001
119900* VALIDATE PRINTER ID                                            *11990001
120000*   PRINTER REQUIRED FOR - PRINT PULL  - F23 (LOCAL-03)          *12000032
120100*----------------------------------------------------------------*12010001
120200 3010-VALIDATE-PRINTER-ID.                                        12020001
120300                                                                  12030001
120400     IF  ASC-CS-PRINTER-ID  =  SPACES                             12040001
120500         SET PS-ERROR                                             12050032
120600             DP020-MSG-FATAL           TO TRUE                    12060032
120700         MOVE PC-TSYMSG-01563          TO DP020-MSG-NUMBER        12070032
120800         MOVE DP015-UNP-ALP-BRT-OFF  TO MPRTIDA                   12080032
120900         MOVE DP015-RED                TO MPRTIDC                 12090032
121000         MOVE DP015-REVERSE            TO MPRTIDH                 12100032
121100         MOVE -1                       TO MPRTIDL                 12110032
121200         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    12120032
121300     ELSE                                                         12130001
121400         PERFORM 3020-VALIDATE-PRINTER                            12140001
121500         IF  DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'              12150001
121600             CONTINUE                                             12160001
121700         ELSE                                                     12170001
121800             SET PS-ERROR                                         12180001
121900                 DP020-MSG-FATAL           TO TRUE                12190001
122000             MOVE PC-TSYMSG-00746          TO DP020-MSG-NUMBER    12200001
122100             MOVE DP015-UNP-ALP-BRT-OFF    TO MPRTIDA             12210001
122200             MOVE DP015-RED                TO MPRTIDC             12220001
122300             MOVE DP015-REVERSE            TO MPRTIDH             12230001
122400             MOVE -1                       TO MPRTIDL             12240001
122500             SET DP030-SET-CURSOR-APPL-1   TO TRUE                12250001
122600         END-IF                                                   12260001
122700     END-IF.                                                      12270001
122800                                                                  12280001
122900*----------------------------------------------------------------*12290001
123000*   3020-VALIDATE-PRINTER                                        *12300001
123100* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *12310001
123200*----------------------------------------------------------------*12320001
123300 3020-VALIDATE-PRINTER.                                           12330001
123400                                                                  12340001
123500     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     12350001
123600     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 12360053
123700     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        12370053
123800     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     12380001
123900                                        DP072-FCLTY-ID.           12390001
124000     MOVE ASC-CS-PRINTER-ID          TO DP072-PRINTER-ID          12400001
124100     MOVE PC-REPORT-PGM-1            TO DP072-RPT-PGM-NME         12410001
124200     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     12420001
124300     SET DP072-VALIDATE              TO TRUE.                     12430001
124400                                                                  12440001
124500     EXEC CICS                                                    12450001
124600          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  12460001
124700               COMMAREA (DP072-COMM-AREA)                         12470001
124800               RESP     (PV-CICS-RESPONSE)                        12480001
124900     END-EXEC                                                     12490001
125000                                                                  12500001
125100     EVALUATE TRUE                                                12510001
125200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12520001
125300              CONTINUE                                            12530001
125400         WHEN OTHER                                               12540001
125500             SET PS-ERROR                                         12550001
125600                 DP020-MSG-FATAL       TO TRUE                    12560001
125700             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        12570001
125800             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              12580001
125900                 MOVE DP015-UNP-ALP-BRT-OFF                       12590001
126000                                       TO MPRTIDA                 12600001
126100                 MOVE DP015-RED        TO MPRTIDC                 12610001
126200                 MOVE DP015-REVERSE    TO MPRTIDH                 12620001
126300                 MOVE -1               TO MPRTIDL                 12630001
126400             ELSE                                                 12640001
126500                 MOVE DP015-UNP-ALP-BRT-OFF                       12650001
126600                                       TO MPRTIDA                 12660001
126700                 MOVE DP015-RED        TO MPRTIDC                 12670001
126800                 MOVE DP015-REVERSE    TO MPRTIDH                 12680001
126900                 MOVE -1               TO MPRTIDL                 12690001
127000             END-IF                                               12700001
127100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12710001
127200     END-EVALUATE.                                                12720001
127300                                                                  12730001
127400                                                                  12740038
127500*----------------------------------------------------------------*12750038
127600*   3030-FIND-CS-LOCATION.                                        12760050
127700*----------------------------------------------------------------*12770038
127800 3030-FIND-CS-LOCATION.                                           12780050
127900                                                                  12790038
128000     MOVE  ASC-CS-LOCATION-N  TO  DK-STORE-NUMBER.                12800038
128100     PERFORM 3500-GET-STORE-INFORMATION.                          12810050
128200                                                                  12820038
128300      EVALUATE TRUE                                               12830038
128400          WHEN XL071-NO-ERRORS                                    12840050
128500               MOVE XL071-LOCATION-NUMBER TO PV-CS-STORE-NMBR     12850098
128600               MOVE XL071-LOC-NM  TO PV-CS-STORE-NAME             12860098
128700               MOVE XL071-LOC-TYP-CDE TO PV-CS-TYPE-CODE          12870050
128800               MOVE XL071-E-BUS-IND   TO PV-CS-E-BUS-LOC-IND      12880050
128900               MOVE PV-CS-STORE-NAME  TO  MLOCDESO                12890050
129000                                          ASC-CS-LOCATION-DESC    12900050
129100               IF PV-CS-TYPE-CODE     =  PC-CS OR                 12910050
129200                 (PV-CS-TYPE-CODE     =  PC-DS AND                12920050
129300                  PV-CS-E-BUS-LOC-IND = PC-Y)                     12930050
129400                   CONTINUE                                       12940038
129500               ELSE                                               12950038
129600                   SET PS-ERROR                                   12960038
129700                       DP020-MSG-FATAL   TO TRUE                  12970038
129800                   MOVE PC-TSYMSG-02219  TO DP020-MSG-NUMBER      12980038
129900                   MOVE DP015-UNP-ALP-BRT-OFF                     12990038
130000                                         TO MLOCIDA               13000038
130100                   MOVE DP015-RED        TO MLOCIDC               13010038
130200                   MOVE DP015-REVERSE    TO MLOCIDH               13020038
130300                   MOVE -1               TO MLOCIDL               13030038
130400                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            13040038
130500               END-IF                                             13050038
130600          WHEN XL071-LOC-NOT-FOUND                                13060050
130700               SET PS-ERROR                                       13070038
130800                   DP020-MSG-FATAL       TO TRUE                  13080038
130900               MOVE PC-TSYMSG-02219      TO DP020-MSG-NUMBER      13090038
131000               MOVE DP015-UNP-ALP-BRT-OFF                         13100038
131100                                         TO MLOCIDA               13110038
131200               MOVE DP015-RED            TO MLOCIDC               13120038
131300               MOVE DP015-REVERSE        TO MLOCIDH               13130038
131400               MOVE -1                   TO MLOCIDL               13140038
131500               SET DP030-SET-CURSOR-APPL-1 TO TRUE                13150038
131600     END-EVALUATE.                                                13160038
131700                                                                  13170038
131800*----------------------------------------------------------------*13180038
131900*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *13190001
132000*  MAP.                                                          *13200001
132100*----------------------------------------------------------------*13210001
132200 3200-RESET-ATTRIBUTES.                                           13220001
132300                                                                  13230001
132400     MOVE DP015-ASK-NOR-MDT        TO MLOCDESA                    13240005
132500                                      MPULLNOA                    13250005
132600                                      MCREDTEA                    13260005
132700                                      MUSERIDA.                   13270005
132800                                                                  13280001
132900     MOVE DP015-UNP-ALP-NOR-MDT    TO MPRTIDA                     13290005
133000                                      MREFNOA.                    13300005
133100                                                                  13310001
133200     MOVE DP015-UNP-NUM-NOR-MDT    TO MLOCIDA                     13320009
133300                                      MSTORNOA.                   13330009
133400                                                                  13340001
133500     MOVE DP015-GREEN              TO MLOCIDC                     13350001
133600                                      MPRTIDC                     13360001
133700                                      MREFNOC                     13370005
133800                                      MSTORNOC.                   13380005
133900                                                                  13390001
134000     MOVE DP015-BLUE               TO MLOCDESC                    13400005
134100                                      MPULLNOC                    13410005
134200                                      MCREDTEC.                   13420005
134300                                                                  13430001
134400     MOVE DP015-UNDERLINE          TO MLOCIDH                     13440001
134500                                      MPRTIDH                     13450001
134600                                      MREFNOH                     13460001
134700                                      MSTORNOH.                   13470005
134800                                                                  13480001
134900                                                                  13490001
135000*-----------------------------------------------------------------13500005
135100* VERIFY NECESSARY FIELDS ENTERED FOR "ADD BY SKU"                13510005
135200*  F16 - LOCAL-01                                                 13520005
135300*  REQUIRED FIELDS:                                               13530005
135400*                                                                 13540005
135500*-----------------------------------------------------------------13550001
135600 3300-ADD-BY-SKU-FIELDS.                                          13560005
135700                                                                  13570005
135800     PERFORM 3400-CHECK-CS-LOC-OPEN.                              13580014
135900                                                                  13590014
136000     IF  PS-NO-ERROR                                              13600014
136100         IF  DP020-LOCATION-NBR  =  PC-CORPORATE-OFFICE           13610053
136200             CONTINUE                                             13620043
136300         ELSE                                                     13630043
136400             PERFORM 3410-CHECK-CS-FOR-DC                         13640043
136500         END-IF                                                   13650043
136600     END-IF.                                                      13660043
136700                                                                  13670014
136800                                                                  13680014
136900*-----------------------------------------------------------------13690001
137000* VERIFY NECESSARY FIELDS ENTERED FOR "ADD BY UPC                 13700005
137100*  F22 - LOCAL-02                                                 13710005
137200*  REQUIRED FIELDS:                                               13720005
137300*-----------------------------------------------------------------13730001
137400 3310-ADD-BY-UPC-FIELDS.                                          13740005
137500                                                                  13750005
137600     PERFORM 3400-CHECK-CS-LOC-OPEN.                              13760014
137700                                                                  13770014
137800     IF  PS-NO-ERROR                                              13780014
137900         IF  DP020-LOCATION-NBR  =  PC-CORPORATE-OFFICE           13790053
138000             CONTINUE                                             13800043
138100         ELSE                                                     13810043
138200             PERFORM 3410-CHECK-CS-FOR-DC                         13820043
138300         END-IF                                                   13830043
138400     END-IF.                                                      13840014
138500                                                                  13850014
138600                                                                  13860014
138700*-----------------------------------------------------------------13870001
138800* VERIFY NECESSARY FIELDS ENTERED FOR "PRINT PULL"                13880001
138900*  F23 - LOCAL-03                                                 13890005
139000*  REQUIRED FIELDS: PULL NUMBER OR REFERENCE NUMBER               13900001
139100*-----------------------------------------------------------------13910001
139200 3320-PRT-PULL-FIELDS.                                            13920005
139300                                                                  13930005
139400     IF  ASC-PULL-NBR  >  ZEROES OR                               13940006
139500         ASC-REF-NBR   >  SPACES                                  13950006
139600         CONTINUE                                                 13960006
139700     ELSE                                                         13970006
139800         SET PS-ERROR                                             13980006
139900             DP020-MSG-FATAL   TO TRUE                            13990006
140000         MOVE PC-TSYMSG-02220  TO DP020-MSG-NUMBER                14000006
140100         MOVE DP015-UNP-ALP-BRT-OFF                               14010006
140200                               TO MPULLNOA                        14020006
140300                                  MREFNOA                         14030006
140400         MOVE DP015-RED        TO MPULLNOC                        14040006
140500                                  MREFNOC                         14050006
140600         MOVE DP015-REVERSE    TO MPULLNOH                        14060006
140700                                  MREFNOH                         14070006
140800         MOVE -1               TO MLOCIDL                         14080007
140900                                  MREFNOL                         14090006
141000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      14100006
141100     END-IF.                                                      14110006
141200                                                                  14120006
141300     IF  PS-NO-ERROR                                              14130006
141400         IF  ASC-PULL-CANCELLED                                   14140006
141500             SET PS-ERROR                                         14150006
141600                 DP020-MSG-FATAL   TO TRUE                        14160006
141700             MOVE PC-TSYMSG-02226  TO DP020-MSG-NUMBER            14170006
141800             MOVE -1               TO MLOCIDL                     14180007
141900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14190006
142000         END-IF                                                   14200006
142100     END-IF.                                                      14210006
142200                                                                  14220001
142300     IF  PS-NO-ERROR                                              14230011
142400         IF  ASC-ITEM-LIST-FORMAT                                 14240011
142500             SET PS-ERROR                                         14250011
142600                 DP020-MSG-FATAL   TO TRUE                        14260011
142700             MOVE PC-TSYMSG-02295  TO DP020-MSG-NUMBER            14270011
142800             MOVE -1               TO MSTORNOL                    14280011
142900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14290011
143000         END-IF                                                   14300011
143100     END-IF.                                                      14310010
143200                                                                  14320011
143300     IF  PS-NO-ERROR                                              14330011
143400         PERFORM 3322-CHECK-ALL-LINES                             14340011
143500     END-IF.                                                      14350011
143600                                                                  14360019
143700                                                                  14370011
143800*-----------------------------------------------------------------14380011
143900* CHECK TO MAKE SURE THAT PULL HAS LINE ITEMS ENTERED AND EACH   *14390011
144000* LINE HAS DISTRIBUTION                                          *14400011
144100*-----------------------------------------------------------------14410011
144200 3322-CHECK-ALL-LINES.                                            14420011
144300                                                                  14430011
144400     MOVE  ASC-PULL-NBR  TO  DK-PULL-NUMBER.                      14440011
144500                                                                  14450011
144600     IF  PS-NO-ERROR                                              14460011
144700         PERFORM 7050-OPEN-LINE-LNE-CSR                           14470011
144800     END-IF.                                                      14480011
144900                                                                  14490011
145000     IF  PS-NO-ERROR                                              14500011
145100         PERFORM 7055-FETCH-LINE-ITEM-CSR                         14510011
145200     END-IF.                                                      14520011
145300                                                                  14530011
145400     IF  PS-EOF-LINE-ITEM-CSR                                     14540011
145500         SET  PS-ERROR                                            14550011
145600              DP020-MSG-FATAL TO TRUE                             14560011
145700         MOVE PC-TSYMSG-02296 TO DP020-MSG-NUMBER                 14570011
145800         MOVE -1              TO MSTORNOL                         14580011
145900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      14590011
146000     END-IF.                                                      14600011
146100                                                                  14610011
146200     IF  PS-NO-ERROR                                              14620011
146300         PERFORM                                                  14630011
146400           UNTIL PS-ERROR                                         14640011
146500              OR PS-EOF-LINE-ITEM-CSR                             14650011
146600                 PERFORM 3324-CHECK-DISTRO                        14660011
146700                 IF  PS-NO-ERROR                                  14670011
146800                     PERFORM 7055-FETCH-LINE-ITEM-CSR             14680011
146900                 END-IF                                           14690011
147000         END-PERFORM                                              14700011
147100     END-IF.                                                      14710011
147200                                                                  14720011
147300     IF  PS-NO-ERROR                                              14730011
147400         PERFORM 7060-CLOSE-LINE-ITEM-CSR                         14740011
147500     END-IF.                                                      14750011
147600                                                                  14760011
147700                                                                  14770011
147800*-----------------------------------------------------------------14780011
147900* CHECK TO MAKE SURE THAT EACH ACTIVE LINE HAS DISTRIBUTION      -14790011
148000*-----------------------------------------------------------------14800011
148100 3324-CHECK-DISTRO.                                               14810011
148200                                                                  14820011
148300     MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER.                 14830011
148400     MOVE  ZEROES             TO  PV-CEPLDS-COUNT.                14840011
148500                                                                  14850011
148600     EXEC SQL                                                     14860011
148700         SELECT  COUNT(*)                                         14870011
148800           INTO  :PV-CEPLDS-COUNT                                 14880011
148900           FROM  TCEPLDS                                          14890011
149000          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             14900011
149100            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             14910011
149200     END-EXEC.                                                    14920011
149300                                                                  14930011
149400     EVALUATE TRUE                                                14940011
149500         WHEN SQLCODE = ZERO                                      14950011
149600         WHEN SQLCODE = +100                                      14960011
149700              CONTINUE                                            14970011
149800                                                                  14980011
149900         WHEN SQLWARN0 NOT = SPACE                                14990011
150000         WHEN SQLCODE NOT = ZERO                                  15000011
150100              SET PS-ERROR     TO TRUE                            15010011
150200              MOVE '3324-CHECK-DISTRO       '                     15020011
150300                               TO DP013-PARAGRAPH                 15030011
150400              MOVE 'COUNT NUMBER DISTRO ROWS FOR LINE  '          15040011
150500                               TO DP013-MESSAGE-TEXT (1)          15050011
150600              MOVE SQLCA       TO DP013-SQLCA                     15060011
150700              MOVE 'TCEPLDS'   TO DP013-DB2-TABLE-NAME (1)        15070011
150800              SET DP013-DB2-ABEND                                 15080011
150900                               TO TRUE                            15090011
151000              PERFORM DP013-0000-PROCESS-ABEND                    15100011
151100     END-EVALUATE.                                                15110011
151200                                                                  15120011
151300     IF  PS-NO-ERROR                                              15130011
151400         IF  PV-CEPLDS-COUNT  >  0                                15140011
151500             CONTINUE                                             15150011
151600         ELSE                                                     15160011
151700             SET  PS-ERROR                                        15170011
151800                  DP020-MSG-FATAL TO TRUE                         15180011
151900             MOVE PC-TSYMSG-02297 TO DP020-MSG-NUMBER             15190011
152000             MOVE -1              TO MSTORNOL                     15200011
152100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15210011
152200        END-IF                                                    15220011
152300     END-IF.                                                      15230011
152400                                                                  15240011
152500                                                                  15250019
152600*----------------------------------------------------------------*15260019
152700* CHECK TO MAKE SURE THAT THE CENTRAL STOCK LOCATION REQUESTED   *15270019
152800* IS OPEN TO RECEIVE.                                            *15280019
152900*----------------------------------------------------------------*15290019
153000 3400-CHECK-CS-LOC-OPEN.                                          15300014
153100                                                                  15310010
153200     MOVE  ASC-CS-LOCATION-N  TO  DK-STORE-NUMBER.                15320014
153300     PERFORM 3500-GET-STORE-INFORMATION.                          15330052
153400                                                                  15340014
153500     EVALUATE TRUE                                                15350014
153600         WHEN XL071-NO-ERRORS                                     15360052
153700              MOVE XL071-LOCATION-NUMBER TO PV-CENTRAL-STOCK-NBR  15370098
153800              MOVE XL071-LOC-TYP-CDE TO PV-CS-TYPE-CODE           15380052
153900              MOVE XL071-CLO-DTE     TO PV-CS-CLOSED-DATE         15390052
154000                                                                  15400052
154100              IF PV-CURRENT-DATE < PV-CS-CLOSED-DATE              15410052
154200                 IF  PV-CS-TYPE-CODE  =  PC-CS OR                 15420052
154300                    (PV-CS-TYPE-CODE  =  PC-DS AND                15430052
154400                     PV-CS-E-BUS-LOC-IND = PC-Y)                  15440052
154500                     CONTINUE                                     15450052
154600                 ELSE                                             15460052
154700                     SET  PS-ERROR                                15470052
154800                          DP020-MSG-FATAL TO TRUE                 15480052
154900                     MOVE PC-TSYMSG-02298 TO DP020-MSG-NUMBER     15490052
155000                     MOVE -1              TO MSTORNOL             15500052
155100                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          15510052
155200                 END-IF                                           15520052
155300              ELSE                                                15530052
155400                 SET  PS-ERROR                                    15540052
155500                      DP020-MSG-FATAL TO TRUE                     15550052
155600                 MOVE PC-TSYMSG-02298 TO DP020-MSG-NUMBER         15560052
155700                 MOVE -1              TO MSTORNOL                 15570052
155800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15580052
155900              END-IF                                              15590052
156000                                                                  15600014
156100         WHEN XL071-LOC-NOT-FOUND                                 15610052
156200             SET  PS-ERROR                                        15620014
156300                  DP020-MSG-FATAL TO TRUE                         15630014
156400             MOVE PC-TSYMSG-02298 TO DP020-MSG-NUMBER             15640014
156500             MOVE -1              TO MSTORNOL                     15650014
156600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15660014
156700                                                                  15670014
156800     END-EVALUATE.                                                15680014
156900                                                                  15690014
157000                                                                  15700014
157100*----------------------------------------------------------------*15710014
157200* CHECK TO MAKE SURE THAT THE CENTRAL STOCK LOCATION IS ASSIGNED *15720014
157300* TO USERS DC. USED BY F16 AND F22.                              *15730054
157400*----------------------------------------------------------------*15740014
157500 3410-CHECK-CS-FOR-DC.                                            15750014
157600                                                                  15760014
157700     MOVE  ASC-CS-LOCATION-N     TO  DK-STORE-NUMBER.             15770014
157800     MOVE  ASC-CURR-OPER-UNT-ID  TO  DK-CURR-OPER-UNT-ID          15780014
157900                                     DK-OPER-UNT-ID.              15790014
157901                                                                  15790157
157910     PERFORM 3500-GET-STORE-INFORMATION.                          15791057
157920                                                                  15792057
159600     EVALUATE TRUE                                                15960014
159700         WHEN XL071-NO-ERRORS                                     15970057
159710              MOVE XL071-LOCATION-NUMBER TO PV-CENTRAL-STOCK-NBR  15971098
159800              IF  XL071-LOC-TYP-CDE  =  PC-CS OR                  15980057
159900                 (XL071-LOC-TYP-CDE  =  PC-DS AND                 15990057
160000                  XL071-E-BUS-IND    = PC-Y)                      16000098
160100                  CONTINUE                                        16010036
160200              ELSE                                                16020036
160300                  SET  PS-ERROR                                   16030036
160400                       DP020-MSG-FATAL TO TRUE                    16040036
160500                  MOVE PC-TSYMSG-02298 TO DP020-MSG-NUMBER        16050036
160600                  MOVE -1              TO MSTORNOL                16060036
160700                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             16070036
160800              END-IF                                              16080036
160900                                                                  16090014
161000         WHEN XL071-LOC-NOT-FOUND                                 16100057
161100             SET  PS-ERROR                                        16110014
161200                  DP020-MSG-FATAL TO TRUE                         16120014
161300             MOVE PC-TSYMSG-02299 TO DP020-MSG-NUMBER             16130014
161400             MOVE -1              TO MSTORNOL                     16140014
161500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16150014
161600                                                                  16160014
161700         WHEN OTHER                                               16170057
161900              SET PS-ERROR     TO TRUE                            16190014
162000              MOVE '3410-CHECK-CS-FOR-DC    '                     16200014
162100                               TO DP013-PARAGRAPH                 16210014
162200              MOVE 'CHECK IF CS LOCATION FOR CURRENT DC  '        16220014
162300                               TO DP013-MESSAGE-TEXT (1)          16230014
162510              MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)         16251057
162520              MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2) 16252057
162600              SET DP013-DB2-ABEND                                 16260014
162700                               TO TRUE                            16270014
162800              PERFORM DP013-0000-PROCESS-ABEND                    16280014
162900     END-EVALUATE.                                                16290014
163000                                                                  16300014
163100                                                                  16310047
163200****************************************************************  16320047
163300*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION FOR        *  16330047
163400*                                                              *  16340047
163500****************************************************************  16350047
163600 3500-GET-STORE-INFORMATION.                                      16360047
163700                                                                  16370047
163800     INITIALIZE XL071-COMMAREA.                                   16380052
163900     MOVE  DK-STORE-NUMBER  TO  XL071-LOCATION-NUMBER.            16390049
164000                                                                  16400048
164100     CALL XL071-LOCATION-MODULE USING                             16410047
164200                                DFHEIBLK                          16420047
164300                                XL071-COMMAREA                    16430047
164400                                XL071-COMMAREA-REC.               16440047
164500                                                                  16450047
164600     EVALUATE TRUE                                                16460047
164700         WHEN XL071-NO-ERRORS                                     16470047
164800              CONTINUE                                            16480048
164900                                                                  16490047
165000         WHEN XL071-LOC-NOT-FOUND                                 16500047
165100              CONTINUE                                            16510050
165200                                                                  16520047
165300         WHEN OTHER                                               16530047
165400              MOVE  ASC-PULL-NBR      TO PV-DISPLAY-PULL-NBR      16540047
165500              MOVE '3500-GET-STORE-INFORMATION'                   16550047
165600                                  TO DP013-PARAGRAPH              16560047
165700              MOVE 'VERIFY LOCATION IS CENTRAL STOCK'             16570047
165800                                  TO DP013-MESSAGE-TEXT (1)       16580047
165900              STRING ' LOCATION - '                               16590047
166000                      XL071-LOCATION-NUMBER                       16600047
166100                     ' PULL NBR - '                               16610047
166200                      PV-DISPLAY-PULL-NBR                         16620047
166210                     ' RETURN CODE - '                            16621057
166220                      XL071-RETURN-CODE                           16622057
166300                      DELIMITED BY SIZE                           16630047
166400                      INTO DP013-MESSAGE-TEXT (2)                 16640047
166500              MOVE XL071-SQLCODE TO SQLCODE                       16650047
166600              MOVE XL071-SQLCA   TO DP013-SQLCA                   16660047
166700              MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)         16670047
166710              MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2) 16671056
166800              SET DP013-DB2-ABEND                                 16680047
166900                  DP013-XCTL-DISPLAY-RESTART TO TRUE              16690047
167000              PERFORM DP013-0000-PROCESS-ABEND                    16700047
167100                                                                  16710047
167200     END-EVALUATE.                                                16720047
167300                                                                  16730047
167400                                                                  16740014
167500*----------------------------------------------------------------*16750019
167600*  PRINT PULL FUNCTION                                           *16760019
167700*----------------------------------------------------------------*16770019
167800 4600-PROCESS-PRINT-FUNCTION.                                     16780019
167900     INITIALIZE CE004-COMMAREA-REC.                               16790019
168000                                                                  16800019
168100     SET  CE004-CICS-LINK                                         16810019
168200          CE004-FROM-PULL-CRE     TO TRUE.                        16820019
168300                                                                  16830019
168400     MOVE ASC-CURR-OPER-UNT-ID-N  TO CE004-CURR-OPER-UNT-ID.      16840019
168500     MOVE ASC-CURR-FCLTY-ID-N     TO CE004-CURR-FCLTY-ID.         16850019
168600     MOVE ASC-CS-PRINTER-ID       TO CE004-CS-PRINTER-ID.         16860019
168700     MOVE ASC-CURR-PULL-STATUS    TO CE004-PULL-SELECT-STATUS.    16870019
168800     MOVE ASC-CURR-PULL-TYPE      TO CE004-PULL-SELECT-TYPE.      16880019
168900     SET  CE004-LIST-SEQ-PL-NBR   TO TRUE.                        16890019
169000     MOVE ASC-PULL-NBR-N          TO CE004-PULL-NBR.              16900020
169100     MOVE ASC-REF-NBR             TO CE004-REF-NBR.               16910019
169200     MOVE ZEROES                  TO CE004-LINE-NBR.              16920019
169300     MOVE ASC-CURR-PULL-STATUS    TO CE004-PULL-STATUS.           16930019
169400     MOVE ASC-CURR-PULL-TYPE      TO CE004-PULL-SOURCE.           16940019
169500     MOVE ASC-CS-LOCATION-N       TO CE004-CS-LOCATION.           16950019
169600     MOVE ZEROES                  TO CE004-NBR-ITEMS.             16960019
169700     MOVE ZEROES                  TO CE004-REQ-PULL-UNITS.        16970019
169800     MOVE ZEROES                  TO CE004-ACT-PULL-UNITS.        16980019
169900     MOVE ZEROES                  TO CE004-DISTRBUTED-UNITS.      16990019
170000     MOVE DP020-USERID            TO CE004-USER-ID.               17000027
170100                                                                  17010019
170200     MOVE LENGTH OF CE004-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    17020019
170300                                                                  17030019
170400     EXEC CICS                                                    17040019
170500         LINK                                                     17050019
170600             PROGRAM   (PC-PRINT-PROGRAM)                         17060019
170700             COMMAREA  (CE004-COMMAREA-REC)                       17070019
170800             RESP      (PV-CICS-RESPONSE)                         17080020
170900     END-EXEC.                                                    17090019
171000                                                                  17100019
171100     EVALUATE TRUE                                                17110019
171200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17120020
171300              PERFORM 4640-VALIDATE-PRT-REQ-CALL                  17130019
171400         WHEN OTHER                                               17140019
171500              SET  PS-ERROR                                       17150020
171600                   DP020-MSG-FATAL TO TRUE                        17160020
171700              MOVE PC-TSYMSG-02238 TO DP020-MSG-NUMBER            17170020
171800              MOVE -1              TO MSTORNOL                    17180020
171900              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 17190020
172000     END-EVALUATE.                                                17200019
172100                                                                  17210019
172200                                                                  17220019
172300*----------------------------------------------------------------*17230019
172400* CHECK RETURN CODE FROM LABEL PRINT PROGRAM TO SEE IF SUCCESSFUL*17240019
172500*----------------------------------------------------------------*17250019
172600 4640-VALIDATE-PRT-REQ-CALL.                                      17260019
172700                                                                  17270019
172800     IF  CE004-PRT-SUCCESSFUL                                     17280019
172900         CONTINUE                                                 17290019
173000     ELSE                                                         17300019
173100          SET  PS-ERROR                                           17310020
173200               DP020-MSG-FATAL TO TRUE                            17320020
173300          MOVE PC-TSYMSG-02238 TO DP020-MSG-NUMBER                17330020
173400          MOVE -1              TO MSTORNOL                        17340020
173500          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     17350020
173600     END-IF.                                                      17360019
173700                                                                  17370022
173800                                                                  17380022
173900*----------------------------------------------------------------*17390022
174000* ASSIGN NEXT PULL NUMBER - FROM CRIT SPEC ONLY                  *17400022
174100*----------------------------------------------------------------*17410022
174200 5000-GET-NEXT-PULL-NBR.                                          17420022
174300                                                                  17430022
174400*    IF  PS-NO-ERROR                                              17440022
174500*        PERFORM 5005-SELECT-TCOCNTL                              17450022
174600*    END-IF.                                                      17460022
174601     IF  PS-NO-ERROR                                              17460198
174602         SET PS-GOOD-PULL-NBR-NO    TO TRUE                       17460299
174602         PERFORM 5005-SELECT-CNSTK-PL-NBR                         17460399
180411         MOVE CET00000-CNSTK-PL-NBR TO PV-HOLD-PULL-NBR           17460499
180411         PERFORM 5030-CHECK-CNSTK-PL-NBR                          17460699
174602             UNTIL PS-GOOD-PULL-NBR-YES                           17460799
180412         MOVE CET00000-CNSTK-PL-NBR TO ASC-PULL-NBR-N             17460899
174603     END-IF.                                                      17460999
174700                                                                  17470022
174800*    IF  PS-NO-ERROR                                              17480022
174900*        PERFORM 5010-UPDATE-TCOCNTL                              17490022
175000*    END-IF.                                                      17500022
175001     IF  PS-NO-ERROR                                              17500198
175002         PERFORM 5010-UPDATE-CNSTK-PL-NBR                         17500222
175003     END-IF.                                                      17500322
175100                                                                  17510022
175200     IF  PS-NO-ERROR                                              17520022
175300         PERFORM 5015-INSERT-TCEPLRQ                              17530022
175400     END-IF.                                                      17540022
175500                                                                  17550022
175600     IF  PS-NO-ERROR                                              17560022
175700         PERFORM 5020-INSERT-TCEPLST                              17570022
175800     END-IF.                                                      17580022
175900                                                                  17590022
176000     IF  PS-NO-ERROR                                              17600022
176100         EXEC CICS                                                17610022
176200              SYNCPOINT                                           17620022
176300         END-EXEC                                                 17630022
176400     END-IF.                                                      17640022
176500                                                                  17650022
176600                                                                  17660022
176700*----------------------------------------------------------------*17670022
176800* ASSIGN THE NEXT PULL NUMBER                                    *17680022
176900*----------------------------------------------------------------*17690022
177000*5005-SELECT-TCOCNTL.                                             17700022
177100                                                                  17710022
177200*    MOVE PC-90             TO  DK-CURR-OPER-UNT-ID.              17720022
177300*    MOVE PC-FCLTY-ID-0001  TO  DK-CURR-FCLTY-ID.                 17730022
177400                                                                  17740022
177500*    EXEC SQL                                                     17750022
177600*        SELECT  CNSTK_PL_NBR                                     17760022
177700*          INTO  :COCNTL-CNSTK-PL-NBR                             17770022
177800*          FROM  TCOCNTL                                          17780022
177900*         WHERE  OPER_UNT_ID = :DK-CURR-OPER-UNT-ID               17790022
178000*           AND  FCLTY_ID    = :DK-CURR-FCLTY-ID                  17800022
178100*    END-EXEC.                                                    17810022
178200                                                                  17820022
178300*    EVALUATE TRUE                                                17830022
178400*        WHEN SQLCODE = +0                                        17840022
178500*             ADD  1                   TO COCNTL-CNSTK-PL-NBR     17850028
178600*             MOVE COCNTL-CNSTK-PL-NBR TO ASC-PULL-NBR-N          17860028
178700                                                                  17870022
178800*        WHEN SQLWARN0 NOT = +0                                   17880022
178900*        WHEN SQLCODE < +0                                        17890022
179000*        WHEN SQLCODE > +0                                        17900022
179100*             SET PS-ERROR    TO TRUE                             17910022
179200*             MOVE '5005-SELECT-TCOCNTL '                         17920022
179300*                             TO DP013-PARAGRAPH                  17930022
179400*             MOVE 'UNSUCCESSFUL SELECT ON CONTROL TABLE'         17940022
179500*                             TO DP013-MESSAGE-TEXT (1)           17950022
179600*             MOVE 'GET NEXT PULL NUMBER                '         17960022
179700*                             TO DP013-MESSAGE-TEXT (2)           17970022
179800*             MOVE SQLCA      TO DP013-SQLCA                      17980022
179900*             MOVE 'TCOCNTL ' TO DP013-DB2-TABLE-NAME (1)         17990022
180000*             SET DP013-DB2-ABEND                                 18000022
180100*                 DP013-XCTL-DISPLAY-RESTART  TO  TRUE            18010022
180200*         PERFORM DP013-0000-PROCESS-ABEND                        18020022
180300*    END-EVALUATE.                                                18030022
180400                                                                  18040022
176700*----------------------------------------------------------------*18040199
176800* ASSIGN THE NEXT PULL NUMBER                                    *18040299
176900*----------------------------------------------------------------*18040399
180401 5005-SELECT-CNSTK-PL-NBR.                                        18040498
180402                                                                  18040522
180403     EXEC SQL                                                     18040622
180404         SELECT  CNSTK_PL_NBR                                     18040722
180405           INTO  :CET00000-CNSTK-PL-NBR                           18040822
180406           FROM  CET_CNSTK_PL_CNTL                                18040922
180407     END-EXEC.                                                    18041022
180408                                                                  18041122
180409     EVALUATE TRUE                                                18041222
180410         WHEN SQLCODE = +0                                        18041322
180411              CONTINUE                                            18041699
180412*             MOVE CET00000-CNSTK-PL-NBR TO ASC-PULL-NBR-N        18041799
180413                                                                  18041899
180414         WHEN SQLWARN0 NOT = +0                                   18041999
180415         WHEN SQLCODE < +0                                        18042099
180416         WHEN SQLCODE > +0                                        18042199
180417              SET PS-ERROR    TO TRUE                             18042299
180418              MOVE '5005-SELECT-CNSTK-PL-NBR'                     18042399
180419                              TO DP013-PARAGRAPH                  18042499
180420              MOVE 'UNSUCCESSFUL SELECT ON CE CONTROL TABLE'      18042599
180421                              TO DP013-MESSAGE-TEXT (1)           18042699
180422              MOVE 'GET NEXT PULL NUMBER                '         18042799
180423                              TO DP013-MESSAGE-TEXT (2)           18042899
180424              MOVE SQLCA      TO DP013-SQLCA                      18042999
180425              MOVE 'CET_CNSTK_PL_CNTL'                            18043099
180426                              TO DP013-DB2-TABLE-NAME (1)         18043199
180427              SET DP013-DB2-ABEND                                 18043299
180428                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            18043399
180429          PERFORM DP013-0000-PROCESS-ABEND                        18043499
180430     END-EVALUATE.                                                18044099
180500                                                                  18050022
180510                                                                  18051098
180600*----------------------------------------------------------------*18062022
180700* UPDATE NEXT PULL NUMBER ON TCOCNTL TABLE                       *18070022
180800*----------------------------------------------------------------*18080022
180900*5010-UPDATE-TCOCNTL.                                             18090022
181000                                                                  18100022
181100*    MOVE PC-90             TO  DK-CURR-OPER-UNT-ID.              18110022
181200*    MOVE PC-FCLTY-ID-0001  TO  DK-CURR-FCLTY-ID.                 18120022
181300                                                                  18130022
181400*    EXEC SQL                                                     18140022
181500*        UPDATE  TCOCNTL                                          18150022
181600*           SET  CNSTK_PL_NBR  = :COCNTL-CNSTK-PL-NBR             18160022
181700*         WHERE  OPER_UNT_ID   = :DK-CURR-OPER-UNT-ID             18170022
181800*           AND  FCLTY_ID      = :DK-CURR-FCLTY-ID                18180022
181900*    END-EXEC.                                                    18190022
182000                                                                  18200022
182100*    EVALUATE TRUE                                                18210022
182200*        WHEN SQLCODE = +0                                        18220022
182300*             CONTINUE                                            18230022
182400                                                                  18240022
182500*        WHEN SQLWARN0 NOT = +0                                   18250022
182600*        WHEN SQLCODE < +0                                        18260022
182700*        WHEN SQLCODE > +0                                        18270022
182800*             SET PS-ERROR    TO TRUE                             18280022
182900*             MOVE '5010-UPDATE-TCOCNTL '                         18290022
183000*                             TO DP013-PARAGRAPH                  18300022
183100*             MOVE 'UNSUCCESSFUL UPDATE ON CONTROL TABLE'         18310022
183200*                             TO DP013-MESSAGE-TEXT (1)           18320022
183300*             MOVE 'UPDATE NEXT PULL NUMBER             '         18330022
183400*                             TO DP013-MESSAGE-TEXT (2)           18340022
183500*             MOVE SQLCA      TO DP013-SQLCA                      18350022
183600*             MOVE 'TCOCNTL ' TO DP013-DB2-TABLE-NAME (1)         18360022
183700*             SET DP013-DB2-ABEND                                 18370022
183800*                 DP013-XCTL-DISPLAY-RESTART  TO  TRUE            18380022
183900*         PERFORM DP013-0000-PROCESS-ABEND                        18390022
184000*    END-EVALUATE.                                                18400022
184100                                                                  18410022
184101*----------------------------------------------------------------*18410198
184102* UPDATE NEXT PULL NUMBER ON CET_CNSTK_PL_CNTL                   *18410222
184103*----------------------------------------------------------------*18410322
184104 5010-UPDATE-CNSTK-PL-NBR.                                        18410422
184105                                                                  18410522
184106     EXEC SQL                                                     18410622
184107         UPDATE  CET_CNSTK_PL_CNTL                                18410722
184108            SET  CNSTK_PL_NBR     = :CET00000-CNSTK-PL-NBR        18410822
184109          WHERE  CNSTK_PL_NBR     = :PV-HOLD-PULL-NBR             18410999
184109*         WHERE  CNSTK_PL_NBR + 1 = :CET00000-CNSTK-PL-NBR        18411099
184110     END-EXEC.                                                    18411199
184111                                                                  18411299
184112     EVALUATE TRUE                                                18411399
184113         WHEN SQLCODE = +0                                        18411499
184114              CONTINUE                                            18411599
184115                                                                  18411699
184116         WHEN SQLWARN0 NOT = +0                                   18411799
184117         WHEN SQLCODE < +0                                        18411899
184118         WHEN SQLCODE > +0                                        18411999
184119              SET PS-ERROR    TO TRUE                             18412099
184120              MOVE '5010-UPDATE-CNSTK-PO-NBR'                     18412199
184121                              TO DP013-PARAGRAPH                  18412299
184122              MOVE 'UNSUCCESSFUL UPDATE ON CE CONTROL TABLE'      18412399
184123                              TO DP013-MESSAGE-TEXT (1)           18412499
184124              MOVE 'UPDATE NEXT PULL NUMBER             '         18412599
184125                              TO DP013-MESSAGE-TEXT (2)           18412699
184126              MOVE SQLCA      TO DP013-SQLCA                      18412799
184127              MOVE 'CET_CNSTK_PL_CNTL'                            18412899
184128                              TO DP013-DB2-TABLE-NAME (1)         18412999
184129              SET DP013-DB2-ABEND                                 18413099
184130                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            18413199
184131          PERFORM DP013-0000-PROCESS-ABEND                        18413299
184132     END-EVALUATE.                                                18413399
184200                                                                  18420022
184210                                                                  18421098
184300*----------------------------------------------------------------*18430022
184400* INSERT ROW INTO CS PULL REQUEST TABLE (TCEPLRQ)                *18440022
184500*----------------------------------------------------------------*18450022
184600 5015-INSERT-TCEPLRQ.                                             18460022
184700                                                                  18470022
184800     MOVE  ASC-PULL-NBR-N      TO  CEPLRQ-CNSTK-REQ-PL-NBR.       18480022
184900     MOVE  ASC-CS-LOCATION-N   TO  CEPLRQ-CNSTK-LOC-ID.           18490022
185000     MOVE  ASC-REF-NBR         TO  CEPLRQ-SRC-REF-NBR.            18500024
185100     MOVE  PC-MANUAL           TO  CEPLRQ-SRC-TYP-CDE.            18510022
185200     MOVE  PC-NEW              TO  CEPLRQ-STAT-CDE.               18520022
185300                                                                  18530022
185400     EXEC SQL                                                     18540022
185500          INSERT                                                  18550022
185600          INTO  TCEPLRQ                                           18560022
185700               (CNSTK_REQ_PL_NBR                                  18570022
185800               ,CNSTK_LOC_ID                                      18580022
185900               ,SRC_REF_NBR                                       18590024
186000               ,SRC_TYP_CDE                                       18600022
186100               ,STAT_CDE)                                         18610022
186200        VALUES                                                    18620022
186300              (:CEPLRQ-CNSTK-REQ-PL-NBR                           18630022
186400              ,:CEPLRQ-CNSTK-LOC-ID                               18640022
186500              ,:CEPLRQ-SRC-REF-NBR                                18650024
186600              ,:CEPLRQ-SRC-TYP-CDE                                18660022
186700              ,:CEPLRQ-STAT-CDE)                                  18670022
186800     END-EXEC.                                                    18680022
186900                                                                  18690022
187000     EVALUATE TRUE                                                18700022
187100         WHEN SQLCODE = ZERO                                      18710022
187200              CONTINUE                                            18720022
187300                                                                  18730022
187400         WHEN SQLWARN0 NOT = +0                                   18740022
187500         WHEN SQLCODE < +0                                        18750022
187600         WHEN SQLCODE > +0                                        18760022
187700              SET PS-ERROR    TO TRUE                             18770022
187800              MOVE '5015-INSERT-TCEPLRQ '                         18780022
187900                              TO DP013-PARAGRAPH                  18790022
188000              MOVE 'UNSUCCESSFUL INSERT IN CS REQUEST   '         18800022
188100                              TO DP013-MESSAGE-TEXT (1)           18810022
188200              MOVE 'INSERT NEW REQUEST                  '         18820022
188300                              TO DP013-MESSAGE-TEXT (2)           18830022
188400              MOVE SQLCA      TO DP013-SQLCA                      18840022
188500              MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1)         18850022
188600              SET DP013-DB2-ABEND                                 18860022
188700                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            18870022
188800          PERFORM DP013-0000-PROCESS-ABEND                        18880022
188900     END-EVALUATE.                                                18890022
189000                                                                  18900022
189100                                                                  18910022
189200*----------------------------------------------------------------*18920022
189300* INSERT ROW INTO CS PULL STATUS TABLE (TCEPLST)                 *18930022
189400*----------------------------------------------------------------*18940022
189500 5020-INSERT-TCEPLST.                                             18950022
189600                                                                  18960022
189700     MOVE  ASC-PULL-NBR-N      TO  CEPLST-CNSTK-REQ-PL-NBR.       18970022
189800     MOVE  ZEROES              TO  CEPLST-PL-LNE-NBR.             18980023
189900     MOVE  PC-NEW              TO  CEPLST-STAT-CDE.               18990023
190000     MOVE  ASC-CREATE-USER-ID  TO  CEPLST-CRE-BY-USR-ID.          19000023
190100                                                                  19010023
190200     EXEC SQL                                                     19020023
190300          INSERT                                                  19030023
190400          INTO  TCEPLST                                           19040023
190500               (CNSTK_REQ_PL_NBR                                  19050023
190600               ,PL_LNE_NBR                                        19060023
190700               ,CRE_TMST                                          19070023
190800               ,STAT_CDE                                          19080023
190900               ,CRE_BY_USR_ID)                                    19090023
191000        VALUES                                                    19100023
191100              (:CEPLST-CNSTK-REQ-PL-NBR                           19110023
191200              ,:CEPLST-PL-LNE-NBR                                 19120023
191300              , CURRENT TIMESTAMP                                 19130023
191400              ,:CEPLST-STAT-CDE                                   19140023
191500              ,:CEPLST-CRE-BY-USR-ID)                             19150023
191600     END-EXEC.                                                    19160023
191700                                                                  19170023
191800     EVALUATE TRUE                                                19180023
191900         WHEN SQLCODE = ZERO                                      19190023
192000              CONTINUE                                            19200023
192100                                                                  19210023
192200         WHEN SQLWARN0 NOT = +0                                   19220023
192300         WHEN SQLCODE < +0                                        19230023
192400         WHEN SQLCODE > +0                                        19240023
192500              SET PS-ERROR    TO TRUE                             19250023
192600              MOVE '5020-INSERT-TCEPLST '                         19260023
192700                              TO DP013-PARAGRAPH                  19270023
192800              MOVE 'UNSUCCESSFUL INSERT IN CS STATUS TBL'         19280023
192900                              TO DP013-MESSAGE-TEXT (1)           19290023
193000              MOVE 'INSERT STATUS FOR LINE 0            '         19300023
193100                              TO DP013-MESSAGE-TEXT (2)           19310023
193200              MOVE SQLCA      TO DP013-SQLCA                      19320023
193300              MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1)         19330023
193400              SET DP013-DB2-ABEND                                 19340023
193500                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            19350023
193600          PERFORM DP013-0000-PROCESS-ABEND                        19360023
193700     END-EVALUATE.                                                19370023
193800                                                                  19380023
193900                                                                  19390023
180600*----------------------------------------------------------------*19391099
180700* INCREMENT AND CHECK PULL NUMBER                                 19392099
180800*----------------------------------------------------------------*19393099
180401 5030-CHECK-CNSTK-PL-NBR.                                         19394099
180402                                                                  19395099
180411     ADD  1                     TO CET00000-CNSTK-PL-NBR.         19395199
180403     IF CET00000-CNSTK-PL-NBR > PV-MAX-PULL-NBR                   19396099
180404         MOVE 1 TO CET00000-CNSTK-PL-NBR                          19397099
180407     END-IF.                                                      19398099
180408                                                                  19399099
180408     PERFORM 5040-CHECK-FOR-PULL-NBR.                             19399199
180500                                                                  19399299
180510                                                                  19399399
180600*----------------------------------------------------------------*19399499
180700* CHECKS IF PULL NUMBER ALREADY EXISTS                            19399599
180800*----------------------------------------------------------------*19399699
180401 5040-CHECK-FOR-PULL-NBR.                                         19399799
180402                                                                  19399899
180403     EXEC SQL                                                     19399999
180404         SELECT  CNSTK_REQ_PL_NBR                                 19400099
180405           INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                         19400199
180406           FROM  TCEPLRQ                                          19400299
180406           WHERE CNSTK_REQ_PL_NBR = :CET00000-CNSTK-PL-NBR        19400399
180407     END-EXEC.                                                    19400499
180408                                                                  19400599
180409     EVALUATE TRUE                                                19400699
180410         WHEN SQLCODE = +0                                        19400799
180411              SET PS-GOOD-PULL-NBR-NO    TO TRUE                  19400899
180410         WHEN SQLCODE = +100                                      19400999
180411              SET PS-GOOD-PULL-NBR-YES   TO TRUE                  19401199
180414         WHEN SQLWARN0 NOT = +0                                   19401299
180415         WHEN SQLCODE < +0                                        19401399
180416         WHEN SQLCODE > +0                                        19401499
180417              SET PS-ERROR    TO TRUE                             19401599
180418              MOVE '5040-CHECK-FOR-PULL-NBR'                      19401699
180419                              TO DP013-PARAGRAPH                  19401799
180420              MOVE 'UNSUCCESSFUL SELECT ON TCEPLRQ'               19401899
180421                              TO DP013-MESSAGE-TEXT (1)           19401999
180422              MOVE 'DUPLICATE PULL NUMBER CHECK  '                19402099
180423                              TO DP013-MESSAGE-TEXT (2)           19402199
180424              MOVE SQLCA      TO DP013-SQLCA                      19402299
180425              MOVE 'TCEPLRQ'                                      19402399
180426                              TO DP013-DB2-TABLE-NAME (1)         19402499
180427              SET DP013-DB2-ABEND                                 19402599
180428                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            19402699
180429          PERFORM DP013-0000-PROCESS-ABEND                        19402799
180430     END-EVALUATE.                                                19402899
180500                                                                  19403399
180510                                                                  19403499
194000*----------------------------------------------------------------*19404023
194100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *19410023
194200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *19420023
194300*  IT HERE.                                                      *19430023
194400*----------------------------------------------------------------*19440001
194500 7000-BUILD-INITIAL-PANEL.                                        19450001
194600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        19460001
194700                                                                  19470001
194800     MOVE SPACE                    TO MSTRNMEO                    19480005
194900                                      MREFNOO.                    19490001
195000                                                                  19500001
195100     MOVE ZEROES                   TO MPULLNOO                    19510005
195200                                      MSTORNOO.                   19520005
195300                                                                  19530005
195400     IF  DP020-LOCATION-NBR =  PC-CORPORATE-OFFICE                19540053
195500         MOVE  PC-MENO-FALLS-DC    TO DK-CURR-OPER-UNT-ID         19550001
195600                                      DK-OPER-UNT-ID              19560001
195700                                      ASC-CURR-OPER-UNT-ID        19570001
195800     ELSE                                                         19580001
195900         INITIALIZE PV-USER-LOCATION                              19590001
196000         MOVE DP020-LOCATION-NBR   TO PV-USER-LOCATION            19600053
196100         MOVE PV-USER-LOCATION     TO DK-CURR-OPER-UNT-ID         19610001
196200                                      DK-OPER-UNT-ID              19620001
196300                                      ASC-CURR-OPER-UNT-ID        19630001
196400     END-IF.                                                      19640001
196500                                                                  19650001
196600     MOVE PC-FCLTY-ID-0001         TO DK-CURR-FCLTY-ID.           19660001
196700                                                                  19670001
196800     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          19680037
196900         PERFORM 3030-FIND-CS-LOCATION                            19690050
197000     ELSE                                                         19700037
197100         PERFORM 7010-GET-CS-LOCATION                             19710037
197200     END-IF.                                                      19720037
197300     PERFORM 7020-GET-CS-DEFAULTS.                                19730005
197400                                                                  19740005
197500     MOVE PV-CURRENT-MMDDYY         TO MCREDTEO.                  19750007
197600     MOVE DP020-USERID              TO MUSERIDO.                  19760007
197700                                                                  19770005
197900     IF  PV-CS-STORE-NMBR = 0                                     19790099
198000         MOVE ASC-CS-LOCATION       TO MLOCIDO                    19800099
198100     ELSE                                                         19810099
198110         MOVE PV-CS-STORE-NMBR      TO MLOCIDO                    19811099
198120     END-IF.                                                      19812099
198130                                                                  19813099
198300     MOVE PV-CS-STORE-NAME          TO MLOCDESO.                  19830052
198400                                                                  19840001
198500     MOVE COCNTL-DFLT-CNSTK-PRTR-ID TO MPRTIDO.                   19850007
198600                                                                  19860007
198700     IF  ASC-ITEM-LIST-FORMAT                                     19870007
198800         MOVE -1                    TO MSTORNOL                   19880010
198900         MOVE ASC-PULL-NBR-N        TO MPULLNOO                   19890007
199000         MOVE ASC-REF-NBR           TO MREFNOO                    19900007
199100         MOVE DP015-ASK-NOR-MDT     TO MREFNOA                    19910008
199200                                       MLOCIDA                    19920010
199300         MOVE DP015-BLUE            TO MREFNOC                    19930008
199400                                       MLOCIDC                    19940010
199500         MOVE DP015-HL-OFF          TO MREFNOH                    19950009
199600                                       MLOCIDH                    19960010
199700                                                                  19970009
199800         PERFORM 7030-GET-PULL-STATUS                             19980009
199900         MOVE  SPACES               TO MPULDESO                   19990009
200000         IF  ASC-PULL-CANCELLED                                   20000009
200100             STRING 'STATUS: '         DELIMITED BY SIZE          20010009
200200             PC-DESC-CANCELLED         DELIMITED BY SIZE          20020009
200300                                  INTO MPULDESO                   20030009
200400         ELSE                                                     20040009
200500         IF  ASC-PULL-DISTRIBUTED                                 20050009
200600             STRING 'STATUS: '         DELIMITED BY SIZE          20060009
200700             PC-DESC-DISTRIBUTED       DELIMITED BY SIZE          20070009
200800                                  INTO MPULDESO                   20080009
200900         ELSE                                                     20090009
201000         IF  ASC-PULL-IN-PROCESS                                  20100009
201100             STRING 'STATUS: '         DELIMITED BY SIZE          20110009
201200             PC-DESC-IN-PROCESS        DELIMITED BY SIZE          20120009
201300                                  INTO MPULDESO                   20130009
201400         ELSE                                                     20140009
201500         IF  ASC-PULL-NEW                                         20150009
201600             STRING 'STATUS: '         DELIMITED BY SIZE          20160009
201700             PC-DESC-NEW               DELIMITED BY SIZE          20170009
201800                                  INTO MPULDESO                   20180009
201900         ELSE                                                     20190009
202000         IF  ASC-PULL-POSTED                                      20200009
202100             STRING 'STATUS: '         DELIMITED BY SIZE          20210009
202200             PC-DESC-POSTED            DELIMITED BY SIZE          20220009
202300                                  INTO MPULDESO                   20230009
202400         END-IF                                                   20240009
202500         END-IF                                                   20250009
202600         END-IF                                                   20260009
202700         END-IF                                                   20270009
202800         END-IF                                                   20280009
202900     ELSE                                                         20290010
203000         MOVE -1                   TO MLOCIDL                     20300010
203100     END-IF.                                                      20310007
203200                                                                  20320001
203300                                                                  20330001
203400*----------------------------------------------------------------*20340001
203500*       GET CENTRAL STOCK LOCATION                               *20350001
203600*----------------------------------------------------------------*20360001
203700 7010-GET-CS-LOCATION.                                            20370001
203800                                                                  20380001
203900     PERFORM 7012-OPEN-LOCATION-CSR.                              20390001
204000     PERFORM 7014-FETCH-LOCATION-CSR THRU 7014-EXIT               20400001
204100     PERFORM 7016-CLOSE-LOCATION-CSR.                             20410001
204200                                                                  20420001
204300*----------------------------------------------------------------*20430001
204400*   OPEN CENTRAL STOCK LOCATION CURSOR                           *20440001
204500*----------------------------------------------------------------*20450001
204600 7012-OPEN-LOCATION-CSR.                                          20460001
204700      EXEC SQL                                                    20470001
204800           OPEN CS-LOCATION-CSR                                   20480001
204900      END-EXEC                                                    20490001
205000                                                                  20500001
205100     EVALUATE TRUE                                                20510001
205200         WHEN SQLCODE = ZERO                                      20520001
205300             CONTINUE                                             20530001
205400         WHEN SQLWARN0 NOT = SPACES                               20540001
205500         WHEN SQLCODE < ZERO                                      20550001
205600         WHEN SQLCODE > ZERO                                      20560001
205700             MOVE '7012-OPEN-LOCATION-CURSOR'                     20570001
205800                               TO DP013-PARAGRAPH                 20580001
205900             MOVE 'OPEN CENTRAL STOCK LOCATION CURSOR - '         20590001
206000                               TO DP013-MESSAGE-TEXT (1)          20600001
206100             MOVE 'CURSOR:  CS-LOCATION-CSR         '             20610001
206200                               TO DP013-MESSAGE-TEXT (2)          20620001
206300             MOVE SQLCA        TO DP013-SQLCA                     20630001
206400             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (1)        20640056
206500             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  20650056
206600             SET DP013-DB2-ABEND                                  20660001
206700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20670001
206800             PERFORM DP013-0000-PROCESS-ABEND                     20680001
206900     END-EVALUATE.                                                20690001
207000                                                                  20700001
207100                                                                  20710001
207200*----------------------------------------------------------------*20720001
207300*  FETCH CENTRAL STOCK LOCATION CURSOR                           *20730001
207400*----------------------------------------------------------------*20740001
207500 7014-FETCH-LOCATION-CSR.                                         20750001
207600******THESE LINES WERE ADDED TO KEEP FROM ABENDING.               20760098
207700******TAKE LINES OUT BEFORE PRODUCTION                            20770098
207800*****IF DK-CURR-OPER-UNT-ID = 873                                 20780098
207900*****    MOVE  'E COMMERCE ' TO ASC-CS-LOCATION-DESC              20790098
208000*****    MOVE  'E COMMERCE ' TO PV-CS-STORE-NAME                  20800098
208100*****    GO TO 7014-EXIT                                          20810098
208200*****END-IF.                                                      20820098
208201                                                                  20820198
208202                                                                  20820201
208203     EXEC SQL                                                     20820301
208204          FETCH CS-LOCATION-CSR                                   20820401
208205           INTO :XLT00014-LOC-NBR                                 20820556
208206               ,:XLT00014-EFF-BEG-DTE                             20820656
208300               ,:XLT00014-DC-NBR                                  20830056
208400               ,:XLT00010-LOC-NM                                  20840056
208500               ,:XLT00010-CLO-DTE                                 20850056
208600               ,:XLT00010-LOC-TYP-CDE                             20860056
208700               ,:XLT00010-E-BUS-IND                               20870056
208800                                                                  20880056
208900     END-EXEC.                                                    20890001
209000                                                                  20900001
209100     EVALUATE TRUE                                                20910001
209200         WHEN SQLCODE = ZERO                                      20920001
209300              MOVE  XLT00010-LOC-NM TO ASC-CS-LOCATION-DESC       20930056
209310              MOVE  XLT00010-LOC-NM TO PV-CS-STORE-NAME           20931098
209400         WHEN SQLWARN0 NOT = SPACE                                20940001
209500         WHEN SQLCODE NOT = ZERO                                  20950001
209600              MOVE '7014-FETCH-LOCATION-CSR.'                     20960001
209700                               TO DP013-PARAGRAPH                 20970001
209800              MOVE 'FETCH CENTRAL STOCK LOCATION CURSOR'          20980001
209900                               TO DP013-MESSAGE-TEXT (1)          20990001
210000              MOVE 'CURSOR:  CS-LOCATION-CSR     '                21000001
210100                               TO DP013-MESSAGE-TEXT (2)          21010001
210200              MOVE SQLCA       TO DP013-SQLCA                     21020001
210210              MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (1)       21021056
210220              MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2) 21022056
210400              SET DP013-DB2-ABEND                                 21040001
210500                               TO TRUE                            21050001
210600              PERFORM DP013-0000-PROCESS-ABEND                    21060001
210700     END-EVALUATE.                                                21070001
210800                                                                  21080001
210801 7014-EXIT.                                                       21080198
210802     EXIT.                                                        21080201
210900                                                                  21090001
211000*----------------------------------------------------------------*21100001
211100*  CLOSE CENTRAL STOCK LOCATION CURSOR                           *21110001
211200*----------------------------------------------------------------*21120001
211300 7016-CLOSE-LOCATION-CSR.                                         21130001
211400     EXEC SQL                                                     21140001
211500          CLOSE CS-LOCATION-CSR                                   21150001
211600     END-EXEC                                                     21160001
211700                                                                  21170001
211800     EVALUATE TRUE                                                21180001
211900         WHEN SQLCODE = ZERO                                      21190001
212000             CONTINUE                                             21200001
212100         WHEN SQLWARN0 NOT = SPACES                               21210001
212200         WHEN SQLCODE < ZERO                                      21220001
212300         WHEN SQLCODE > ZERO                                      21230001
212400             MOVE '7016-CLOSE-LOCATION-CSR '                      21240001
212500                               TO DP013-PARAGRAPH                 21250001
212600             MOVE 'CLOSE CENTRAL STOCK LOCATION CSR'              21260001
212700                               TO DP013-MESSAGE-TEXT (1)          21270001
212800             MOVE 'CURSOR:  CS-LOCATION-CSR'                      21280001
212900                               TO DP013-MESSAGE-TEXT (2)          21290001
213000             MOVE SQLCA        TO DP013-SQLCA                     21300001
213010             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (1)        21301056
213020             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  21302056
213200             SET DP013-DB2-ABEND                                  21320001
213300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21330001
213400             PERFORM DP013-0000-PROCESS-ABEND                     21340001
213500     END-EVALUATE.                                                21350001
213600                                                                  21360001
213700                                                                  21370001
213800*----------------------------------------------------------------*21380001
213900* GET DC DEFAULTS FROM TCOCNTL                                   *21390001
214000*----------------------------------------------------------------*21400001
214100 7020-GET-CS-DEFAULTS.                                            21410001
214200                                                                  21420001
214300     INITIALIZE DCLTCOCNTL.                                       21430001
214400                                                                  21440001
214500     EXEC SQL                                                     21450001
214600         SELECT  DFLT_CNSTK_PRTR_ID                               21460001
214700                ,CURRENT DATE                                     21470001
214800           INTO  :COCNTL-DFLT-CNSTK-PRTR-ID                       21480001
214900                ,:PV-CURRENT-DATE                                 21490001
215000           FROM  TCOCNTL                                          21500001
215100          WHERE  OPER_UNT_ID = :DK-CURR-OPER-UNT-ID               21510001
215200            AND  FCLTY_ID    = :DK-CURR-FCLTY-ID                  21520001
215300     END-EXEC.                                                    21530001
215400                                                                  21540001
215500     EVALUATE TRUE                                                21550001
215600         WHEN SQLCODE = +0                                        21560001
215700              MOVE  PV-CURR-YY         TO  PV-YEAR                21570005
215800              MOVE  PV-CURR-MM         TO  PV-MONTH               21580005
215900              MOVE  PV-CURR-DD         TO  PV-DAY                 21590005
216000              MOVE  '/'                TO  PV-SLASH-1             21600005
216100                                           PV-SLASH-2             21610005
216200              MOVE  PV-CURRENT-MMDDYY  TO  ASC-CREATE-DATE        21620005
216300                                                                  21630005
216400         WHEN SQLCODE = -904                                      21640001
216500         WHEN SQLCODE = -913                                      21650001
216600              CONTINUE                                            21660001
216700         WHEN SQLWARN0 NOT = +0                                   21670001
216800         WHEN SQLCODE < +0                                        21680001
216900         WHEN SQLCODE > +0                                        21690001
217000              SET PS-ERROR    TO TRUE                             21700001
217100              MOVE '7020-GET-CS-DEFAULTS'                         21710001
217200                              TO DP013-PARAGRAPH                  21720001
217300              MOVE 'UNSUCCESSFUL SELECT ON CONTROL TABLE'         21730001
217400                              TO DP013-MESSAGE-TEXT (1)           21740001
217500              MOVE SQLCA      TO DP013-SQLCA                      21750001
217600              MOVE 'TCOCNTL ' TO DP013-DB2-TABLE-NAME (1)         21760001
217700              SET DP013-DB2-ABEND                                 21770001
217800                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            21780001
217900          PERFORM DP013-0000-PROCESS-ABEND                        21790001
218000     END-EVALUATE.                                                21800001
218100                                                                  21810001
218200                                                                  21820007
218300*-----------------------------------------------------------------21830007
218400* GET CURRENT PULL STATUS                                         21840007
218500*-----------------------------------------------------------------21850007
218600 7030-GET-PULL-STATUS.                                            21860007
218700     MOVE ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                      21870007
218800     IF PS-NO-ERROR                                               21880007
218900         EXEC SQL                                                 21890007
219000              SELECT STAT_CDE                                     21900007
219100                INTO :CEPLRQ-STAT-CDE                             21910007
219200                FROM TCEPLRQ                                      21920007
219300               WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER         21930007
219400         END-EXEC                                                 21940007
219500                                                                  21950007
219600         EVALUATE TRUE                                            21960007
219700             WHEN SQLCODE = +0                                    21970007
219800                  MOVE  CEPLRQ-STAT-CDE                           21980007
219900                        TO  ASC-CURR-PULL-STATUS                  21990007
220000             WHEN OTHER                                           22000007
220100                  MOVE  ASC-PULL-NBR   TO PV-DISPLAY-PULL-NBR     22010007
220200                  MOVE '7030-GET-PULL-STATUS      '               22020007
220300                                       TO DP013-PARAGRAPH         22030007
220400                  MOVE 'GET PULL CURRENT STATUS     '             22040007
220500                                       TO DP013-MESSAGE-TEXT (1)  22050007
220600                  STRING ' PULL NBR-'      DELIMITED BY SIZE      22060007
220700                          PV-DISPLAY-PULL-NBR                     22070007
220800                                           DELIMITED BY SIZE      22080007
220900                                     INTO DP013-MESSAGE-TEXT (2)  22090007
221000                  MOVE SQLCA   TO DP013-SQLCA                     22100007
221100                  MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1)     22110007
221200                  SET DP013-DB2-ABEND                             22120007
221300                      DP013-XCTL-DISPLAY-RESTART                  22130007
221400                                       TO TRUE                    22140007
221500                  PERFORM DP013-0000-PROCESS-ABEND                22150007
221600         END-EVALUATE                                             22160007
221700     END-IF.                                                      22170007
221800                                                                  22180001
221900                                                                  22190011
222000*----------------------------------------------------------------*22200011
222100* OPEN LINE CURSOR FOR PRINT PULL FUNCTION                       *22210011
222200*----------------------------------------------------------------*22220011
222300 7050-OPEN-LINE-LNE-CSR.                                          22230011
222400                                                                  22240011
222500      EXEC SQL                                                    22250011
222600           OPEN PULL-LINE-ITEM-CSR                                22260011
222700      END-EXEC                                                    22270011
222800                                                                  22280011
222900     EVALUATE TRUE                                                22290011
223000         WHEN SQLCODE = ZERO                                      22300011
223100             CONTINUE                                             22310011
223200         WHEN SQLWARN0 NOT = SPACES                               22320011
223300         WHEN SQLCODE < ZERO                                      22330011
223400         WHEN SQLCODE > ZERO                                      22340011
223500              SET PS-ERROR    TO TRUE                             22350011
223600              MOVE '7050-OPEN-LINE-ITEM-CURSOR'                   22360011
223700                              TO DP013-PARAGRAPH                  22370011
223800              MOVE 'OPEN CS PULL LINE ITEM CURSOR - '             22380011
223900                              TO DP013-MESSAGE-TEXT (1)           22390011
224000              MOVE 'CURSOR:  PULL-LINE-ITEM-CSR      '            22400011
224100                              TO DP013-MESSAGE-TEXT (2)           22410011
224200              MOVE SQLCA      TO DP013-SQLCA                      22420011
224300              MOVE 'TCEPLIT ' TO DP013-DB2-TABLE-NAME (1)         22430011
224400              SET DP013-DB2-ABEND                                 22440011
224500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              22450011
224600              PERFORM DP013-0000-PROCESS-ABEND                    22460011
224700     END-EVALUATE.                                                22470011
224800                                                                  22480011
224900                                                                  22490011
225000*----------------------------------------------------------------*22500011
225100* FETCH LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION            *22510011
225200*----------------------------------------------------------------*22520011
225300 7055-FETCH-LINE-ITEM-CSR.                                        22530011
225400                                                                  22540011
225500     EXEC SQL                                                     22550011
225600          FETCH PULL-LINE-ITEM-CSR                                22560011
225700           INTO :CEPLIT-PL-LNE-NBR                                22570011
225800     END-EXEC.                                                    22580011
225900                                                                  22590011
226000     EVALUATE TRUE                                                22600011
226100         WHEN SQLCODE = ZERO                                      22610011
226200              CONTINUE                                            22620011
226300                                                                  22630011
226400         WHEN SQLCODE = +100                                      22640011
226500              SET PS-EOF-LINE-ITEM-CSR  TO  TRUE                  22650011
226600                                                                  22660011
226700         WHEN SQLWARN0 NOT = SPACE                                22670011
226800         WHEN SQLCODE NOT = ZERO                                  22680011
226900              SET PS-ERROR     TO TRUE                            22690011
227000              MOVE '7055-FETCH-LINE-ITEM-CSR.'                    22700011
227100                               TO DP013-PARAGRAPH                 22710011
227200              MOVE 'FETCH CS PULL LINE-ITEM CURSOR'               22720011
227300                               TO DP013-MESSAGE-TEXT (1)          22730011
227400              MOVE 'CURSOR:  PULL-LINE-ITEM-CSR  '                22740011
227500                               TO DP013-MESSAGE-TEXT (2)          22750011
227600              MOVE SQLCA       TO DP013-SQLCA                     22760011
227700              MOVE 'TCEPLIT'   TO DP013-DB2-TABLE-NAME (1)        22770011
227800              SET DP013-DB2-ABEND                                 22780011
227900                               TO TRUE                            22790011
228000              PERFORM DP013-0000-PROCESS-ABEND                    22800011
228100     END-EVALUATE.                                                22810011
228200                                                                  22820011
228300                                                                  22830011
228400*----------------------------------------------------------------*22840011
228500* CLOSE LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION            *22850011
228600*----------------------------------------------------------------*22860011
228700 7060-CLOSE-LINE-ITEM-CSR.                                        22870011
228800                                                                  22880011
228900     EXEC SQL                                                     22890011
229000          CLOSE PULL-LINE-ITEM-CSR                                22900011
229100     END-EXEC                                                     22910011
229200                                                                  22920011
229300     EVALUATE TRUE                                                22930011
229400         WHEN SQLCODE = ZERO                                      22940011
229500             CONTINUE                                             22950011
229600         WHEN SQLWARN0 NOT = SPACES                               22960011
229700         WHEN SQLCODE < ZERO                                      22970011
229800         WHEN SQLCODE > ZERO                                      22980011
229900             MOVE '7060-CLOSE-LINE-ITEM-CSR '                     22990011
230000                               TO DP013-PARAGRAPH                 23000011
230100             MOVE 'CLOSE CS PULL LINE ITEM CSR'                   23010011
230200                               TO DP013-MESSAGE-TEXT (1)          23020011
230300             MOVE 'CURSOR:  PULL-LINE-ITEM-CSR'                   23030011
230400                               TO DP013-MESSAGE-TEXT (2)          23040011
230500             MOVE SQLCA        TO DP013-SQLCA                     23050011
230600             MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)        23060011
230700             SET DP013-DB2-ABEND                                  23070011
230800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23080011
230900             PERFORM DP013-0000-PROCESS-ABEND                     23090011
231000     END-EVALUATE.                                                23100011
231100                                                                  23110011
231200                                                                  23120011
228400*----------------------------------------------------------------*23121099
228500* CLOSE LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION            *23122099
228600*----------------------------------------------------------------*23123099
228700 7100-GET-MAX-PULL-NBR.                                           23124099
228800                                                                  23125099
228900     EXEC SQL                                                     23126099
229000          SELECT FUNC_QTY                                         23127099
229000            INTO :PV-MAX-PULL-NBR                                 23127199
229000            FROM  TKRPRPM                                         23127299
229000           WHERE  INTFC_SYS_CDE    = 'RDM'                        23127399
229000             AND  SYS_PRC_FUNC_CDE = 'MXPLNR'                     23127499
229100     END-EXEC                                                     23128099
229200                                                                  23129099
229300     EVALUATE TRUE                                                23129199
229400         WHEN SQLCODE = ZERO                                      23129299
229500             CONTINUE                                             23129399
229600         WHEN SQLWARN0 NOT = SPACES                               23129499
229700         WHEN SQLCODE < ZERO                                      23129599
229800         WHEN SQLCODE > ZERO                                      23129699
229900             MOVE '7100-GET-MAX-PULL-NBR '                        23129799
230000                               TO DP013-PARAGRAPH                 23129899
230100             MOVE 'GET MAX PULL NBR'                              23129999
230200                               TO DP013-MESSAGE-TEXT (1)          23130099
230300             MOVE SPACES                                          23130199
230400                               TO DP013-MESSAGE-TEXT (2)          23130299
230500             MOVE SQLCA        TO DP013-SQLCA                     23130399
230600             MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)        23130499
230700             SET DP013-DB2-ABEND                                  23130599
230800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23130699
230900             PERFORM DP013-0000-PROCESS-ABEND                     23130799
231000     END-EVALUATE.                                                23130899
231100                                                                  23130999
231200                                                                  23131099
231300*----------------------------------------------------------------*23132001
231400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *23140001
231500*----------------------------------------------------------------*23150001
231600 8000-MOVE-COMMAREA-TO-SCREEN.                                    23160001
231700                                                                  23170001
231800     IF  ASC-CS-LOCATION  =  PC-ALL                               23180001
231900         MOVE ASC-CS-LOCATION      TO MLOCIDO                     23190001
232000     ELSE                                                         23200001
232100         MOVE ASC-CS-LOCATION-N    TO PV-4-DIGIT-STORE            23210048
232200         MOVE PV-4-DIGIT-STORE     TO MLOCIDO                     23220098
232400     END-IF.                                                      23240001
232500     MOVE ASC-CS-LOCATION-DESC     TO MLOCDESO.                   23250001
232600     MOVE ASC-CS-PRINTER-ID        TO MPRTIDO.                    23260001
232700     MOVE ASC-PULL-NBR             TO MPULLNOO.                   23270001
232800     MOVE ASC-REF-NBR              TO MREFNOO.                    23280001
232900     MOVE ASC-CREATE-DATE          TO MCREDTEO.                   23290005
233000                                                                  23300001
233100     MOVE  SPACES                  TO MPULDESO.                   23310001
233200                                                                  23320001
233300     IF  ASC-PULL-CANCELLED                                       23330001
233400         STRING 'STATUS: '            DELIMITED BY SIZE           23340001
233500         PC-DESC-CANCELLED            DELIMITED BY SIZE           23350001
233600                                 INTO MPULDESO                    23360001
233700     ELSE                                                         23370001
233800     IF  ASC-PULL-DISTRIBUTED                                     23380001
233900         STRING 'STATUS: '            DELIMITED BY SIZE           23390001
234000         PC-DESC-DISTRIBUTED          DELIMITED BY SIZE           23400001
234100                                 INTO MPULDESO                    23410001
234200     ELSE                                                         23420001
234300     IF  ASC-PULL-IN-PROCESS                                      23430001
234400         STRING 'STATUS: '            DELIMITED BY SIZE           23440001
234500         PC-DESC-IN-PROCESS           DELIMITED BY SIZE           23450001
234600                                 INTO MPULDESO                    23460001
234700     ELSE                                                         23470001
234800     IF  ASC-PULL-NEW                                             23480001
234900         STRING 'STATUS: '            DELIMITED BY SIZE           23490001
235000         PC-DESC-NEW                  DELIMITED BY SIZE           23500001
235100                                 INTO MPULDESO                    23510001
235200     ELSE                                                         23520001
235300     IF  ASC-PULL-POSTED                                          23530001
235400         STRING 'STATUS: '            DELIMITED BY SIZE           23540001
235500         PC-DESC-POSTED               DELIMITED BY SIZE           23550001
235600                                 INTO MPULDESO                    23560001
235700     END-IF                                                       23570001
235800     END-IF                                                       23580001
235900     END-IF                                                       23590001
236000     END-IF                                                       23600001
236100     END-IF.                                                      23610001
236200                                                                  23620009
236300     IF  ASC-ITEM-LIST-FORMAT                                     23630009
236400         MOVE DP015-ASK-NOR-MDT     TO MREFNOA                    23640009
236500                                       MLOCIDA                    23650010
236600         MOVE DP015-BLUE            TO MREFNOC                    23660009
236700                                       MLOCIDC                    23670010
236800         MOVE DP015-HL-OFF          TO MREFNOH                    23680009
236900                                       MLOCIDH                    23690010
237000     END-IF.                                                      23700009
237100                                                                  23710001
237200                                                                  23720001
237300*----------------------------------------------------------------*23730001
237400*    ABEND PROCESSOR MODULE                                      *23740001
237500*----------------------------------------------------------------*23750001
237600                                                                  23760001
237700     COPY DPPD013.                                                23770001
