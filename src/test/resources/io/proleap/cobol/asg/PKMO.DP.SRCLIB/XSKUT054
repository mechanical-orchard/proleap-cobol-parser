000100*----------------------------------------------------------       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.      XSKUT054.                                       00040000
000500 AUTHOR.          SCOTT BARTELT.                                  00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    04-30-2003.                                     00070000
000800                                                                  00080000
000900*----------------------------------------------------------       00090000
000910*       XS DOMAIN PROMO DATA QUEUE READER SHUT DOWN               00091000
000910*                    AND                                          00091100
000910*       XS DOMAIN REBATE DATA QUEUE READER SHUT DOWN              00091200
000920*----------------------------------------------------------       00092000
000930* THIS PROGRAM WILL PUT A MESSAGE ONTO THE SPECIFIED QUEUE.       00093000
000940* THE MESSAGE WILL THEN BE READ BY THE STARTED TASK PROGRAM       00094000
000941* (XSKUT034) WHICH WILL THEN END ITS EXECUTION FOR MQPROMO        00094100
000941* (XSKUT134) FOR XSREBATE.                                        00094200
000953*                                                                 00095300
000989*----------------------------------------------------------       00098900
000990* HISTORY LOG:                                                    00099000
000991*                                                                 00099100
000992*----------------------------------------------------------       00099200
000993* DATE:        06/21/2010                                         00099300
000994* WR/IR#:      WR38172                                            00099400
000995* PROGRAMMER:  CHERI PARMLEY                                      00099500
000996* DESCRIPTION: JUST COMMENT CHANGE TO INCLUDE NEW USE OF          00099600
000996*              PROGRAM FOR THE XSREBATE TASK.                     00099700
000997*                                                                 00099800
000998*----------------------------------------------------------       00099900
004700*----------------------------------------------------------       00470000
004800 ENVIRONMENT DIVISION.                                            00480000
004900*----------------------------------------------------------       00490000
005000                                                                  00500000
005100 CONFIGURATION SECTION.                                           00510000
005200                                                                  00520000
005300 SOURCE-COMPUTER.       IBM-3090.                                 00530000
005400 OBJECT-COMPUTER.       IBM-3090.                                 00540000
005500                                                                  00550000
005600 INPUT-OUTPUT SECTION.                                            00560000
005700                                                                  00570000
005800 FILE-CONTROL.                                                    00580000
005900     SELECT CC-QUEUE-MANAGER                                      00590000
006000       ASSIGN TO INP01.                                           00600000
006100     SELECT CC-OUTPUT-QUEUE                                       00610000
006200       ASSIGN TO INP02.                                           00620000
006300                                                                  00630000
006310*----------------------------------------------------------       00631000
006500 DATA DIVISION.                                                   00650000
006510*----------------------------------------------------------       00651000
006700 FILE SECTION.                                                    00670000
006800                                                                  00680000
006900 FD  CC-QUEUE-MANAGER                                             00690000
007000     RECORDING MODE F                                             00700000
007100     BLOCK CONTAINS 0 RECORDS                                     00710000
007200     LABEL RECORDS ARE OMITTED.                                   00720000
007300 01  CC-QUEUE-MANAGER-NAME              PIC  X(080).              00730000
007400                                                                  00740000
007500 FD  CC-OUTPUT-QUEUE                                              00750000
007600     RECORDING MODE F                                             00760000
007700     BLOCK CONTAINS 0 RECORDS                                     00770000
007800     LABEL RECORDS ARE OMITTED.                                   00780000
007900 01  CC-OUTPUT-QUEUE-NAME               PIC  X(080).              00790000
008000                                                                  00800000
008200 WORKING-STORAGE SECTION.                                         00820000
008300                                                                  00830000
008400*----------------------------------------------------------       00840000
008410* AB - ABEND CODES                                                00841000
008411*----------------------------------------------------------       00841100
008500 01  AB-ABEND-CODES.                                              00850000
008510   05  AB-CODES                         PIC S9(004)               00851000
008511                                         VALUE ZEROES             00851100
008512                                         COMP SYNC.               00851200
008600     88  AB-MQ-ERROR                     VALUE +4020.             00860000
008700                                                                  00870000
008710*----------------------------------------------------------       00871000
008900* PV - PROGRAM VARIABLES                                          00890000
008910*----------------------------------------------------------       00891000
009200 01  PV-PROGRAM-VARIABLES.                                        00920000
009210   05  PV-QUEUE-MANAGER-CC-LAYOUT.                                00921000
009220     10  PV-QMGR-NAME                   PIC  X(048).              00922000
009230     10  FILLER                         PIC  X(032).              00923000
009240                                                                  00924000
009250   05  PV-OUTPUT-QUEUE-CC-LAYOUT.                                 00925000
009260     10  PV-OUTPUT-QUEUE-NAME           PIC  X(048).              00926000
009270     10  FILLER                         PIC  X(032).              00927000
009280                                                                  00928000
009300   05  PV-PARAGRAPH                     PIC  X(030)               00930000
009310                                         VALUE SPACES.            00931000
009400   05  PV-QM-NAME                       PIC  X(048).              00940000
009500   05  PV-MSGBUFFER.                                              00950000
009600     10  PV-MSGBUFFER-ARRAY             PIC  X(001)               00960000
009610                                         OCCURS 4096 TIMES.       00961000
009700   05  PV-MSGLENGTH                     PIC S9(009)               00970000
009710                                         BINARY                   00971000
009720                                         VALUE 50.                00972000
009900   05  PV-ERROR-MESSAGE                 PIC  X(048)               00990000
009910                                         VALUE SPACES.            00991000
010000   05  PV-HCONN                         PIC S9(009)               01000000
010010                                         BINARY                   01001000
010020                                         VALUE 0.                 01002000
010100   05  PV-PQ-HANDLE                     PIC S9(009)               01010000
010110                                         BINARY                   01011000
010120                                         VALUE 0.                 01012000
010200   05  PV-OPEN-OPTIONS                  PIC S9(009)               01020000
010210                                         BINARY.                  01021000
010300   05  PV-COMPLETION-CODE               PIC S9(009)               01030000
010310                                         BINARY.                  01031000
010400   05  PV-REASON                        PIC S9(009)               01040000
010410                                         BINARY.                  01041000
010500   05  PV-CON-REASON                    PIC S9(009)               01050000
010510                                         BINARY.                  01051000
010600                                                                  01060000
011010*----------------------------------------------------------       01101000
011020* MQ - MQ PROGRAM VARIABLES                                       01102000
011030*----------------------------------------------------------       01103000
011100 01  MQ-PROGRAM-VARIABLES.                                        01110000
011200   05  MQ-MQCONN                        PIC  X(008)               01120000
011210                                         VALUE 'CSQBCONN'.        01121000
011300   05  MQ-MQOPEN                        PIC  X(008)               01130000
011310                                         VALUE 'CSQBOPEN'.        01131000
011400   05  MQ-MQPUT                         PIC  X(008)               01140000
011410                                         VALUE 'CSQBPUT'.         01141000
011500   05  MQ-MQCLOSE                       PIC  X(008)               01150000
011510                                         VALUE 'CSQBCLOS'.        01151000
011600   05  MQ-MQDISC                        PIC  X(008)               01160000
011610                                         VALUE 'CSQBDISC'.        01161000
011700                                                                  01170000
011710*----------------------------------------------------------       01171000
011800* API control blocks                                              01180000
011810*----------------------------------------------------------       01181000
012000 01  MQM-OBJECT-DESCRIPTOR.                                       01200000
012100     COPY CMQODV.                                                 01210000
012200 01  MQM-MESSAGE-DESCRIPTOR.                                      01220000
012300     COPY CMQMDV.                                                 01230000
012400 01  MQM-PUT-MESSAGE-OPTIONS.                                     01240000
012500     COPY CMQPMOV.                                                01250000
013000 01  MQM-CONSTANTS.                                               01300000
013100     COPY CMQV.                                                   01310000
013200                                                                  01320000
014310*----------------------------------------------------------       01431000
014500* PC - PROGRAM CONSTANTS                                          01450000
014510*----------------------------------------------------------       01451000
014700 01  PC-PROGRAM-CONSTANTS.                                        01470000
014800   05  PC-PGM-NAME                      PIC  X(009)               01480000
014810                                         VALUE 'XSKUT054 '.       01481000
014900   05  PC-FIFTY-STARS                   PIC  X(050)               01490000
014910                                         VALUE ALL '*'.           01491000
014920   05  PC-SHUT-DWN-MSG-TEXT.                                      01492000
014921     10  PC-SHUT-DWN-EVNT-ID            PIC  X(003)               01492100
014922                                         VALUE '999'.             01492200
014923     10  PC-SHUT-DWN-TXT                PIC  X(018)               01492300
014924           VALUE 'END RUN OF PROGRAM'.                            01492400
014925     10  FILLER                         PIC  X(279)               01492500
014926                                         VALUE SPACES.            01492600
015300   05  PC-CORRELID-ASCII                PIC  X(024)               01530000
015500       VALUE X'45504B555430303400000000000000000000000000000000'. 01550000
015500                                                                  01550100
015510*----------------------------------------------------------       01551000
015700* PS - PROGRAM SWITCHES                                           01570000
015710*----------------------------------------------------------       01571000
015900 01  PS-PROGRAM-SWITCHES.                                         01590000
016000   05  PS-CC-QUEUE-MANAGER-SW           PIC  X(001)               01600000
016010                                         VALUE 'N'.               01601000
016100     88  PS-CC-QUEUE-MANAGER-END         VALUE 'Y'.               01610000
016200     88  PS-CC-QUEUE-MANAGER-START       VALUE 'N'.               01620000
016300   05  PS-CC-OUTPUT-QUEUE-SW            PIC  X(001)               01630000
016310                                         VALUE 'N'.               01631000
016400     88  PS-CC-OUTPUT-QUEUE-END          VALUE 'Y'.               01640000
016500     88  PS-CC-OUTPUT-QUEUE-START        VALUE 'N'.               01650000
016510   05  PS-EXIT-PROGRAM-SW               PIC  X(001)               01651000
016520                                         VALUE 'N'.               01652000
016530     88  PS-EXIT-PROGRAM                 VALUE 'Y'.               01653000
016540     88  PS-DONT-EXIT-PROGRAM            VALUE 'N'.               01654000
016600                                                                  01660000
016610*----------------------------------------------------------       01661000
016800 PROCEDURE DIVISION.                                              01680000
016810*----------------------------------------------------------       01681000
017000 0000-MAIN.                                                       01700000
017001                                                                  01700100
017002     PERFORM 1000-INITIALIZATION.                                 01700200
017003                                                                  01700300
017004     IF PS-DONT-EXIT-PROGRAM                                      01700400
017005       PERFORM 2000-CONNECT-QUEUE-MANAGER                         01700500
017006     END-IF.                                                      01700600
017007                                                                  01700700
017008     IF PS-DONT-EXIT-PROGRAM                                      01700800
017009       PERFORM 3000-OPEN-QUEUE                                    01700900
017010     END-IF.                                                      01701000
017011                                                                  01701100
017012     IF PS-DONT-EXIT-PROGRAM                                      01701200
017013       PERFORM 4000-MQPUT-MSG                                     01701300
017014     END-IF.                                                      01701400
017015                                                                  01701500
017016     PERFORM 5000-CLOSE-QUEUE.                                    01701600
017017                                                                  01701700
017018     PERFORM 6000-DISCONNECT-QMGR.                                01701800
017019                                                                  01701900
017020     GOBACK.                                                      01702000
017021                                                                  01702100
017022*0000-EXIT.                                                       01702200
017023 EJECT.                                                           01702300
017024                                                                  01702400
017025*----------------------------------------------------------       01702500
017026* 1000-INITIALIZATION.                                            01702600
017027*     - SET INITIAL VARIABLES AND READ CONTROL CARDS              01702700
017028*----------------------------------------------------------       01702800
017030 1000-INITIALIZATION.                                             01703000
017100                                                                  01710000
017200     SET PS-DONT-EXIT-PROGRAM TO TRUE.                            01720000
017201                                                                  01720100
017202     OPEN INPUT CC-QUEUE-MANAGER                                  01720200
017203                CC-OUTPUT-QUEUE.                                  01720300
017210                                                                  01721000
017300*** READ CONTROL CARD TO GET QUEUE MANAGER NAME                   01730000
017500     SET PS-CC-QUEUE-MANAGER-START TO TRUE.                       01750000
017700     READ CC-QUEUE-MANAGER INTO PV-QUEUE-MANAGER-CC-LAYOUT        01770000
017800       AT END                                                     01780000
017900         SET PS-CC-QUEUE-MANAGER-END TO TRUE.                     01790000
018100                                                                  01810000
018200     IF PS-CC-QUEUE-MANAGER-END                                   01820000
018300       DISPLAY PC-PGM-NAME                                        01830000
018400         'CONTROL CARD MISSING - FOR QMGR NAME'                   01840000
018410       SET PS-EXIT-PROGRAM TO TRUE                                01841000
018600     ELSE                                                         01860000
018700       DISPLAY PC-PGM-NAME                                        01870000
018800         '- '                                                     01880000
018900         PC-FIFTY-STARS                                           01890000
019000       DISPLAY PC-PGM-NAME                                        01900000
019100         '- CONTROL CARD: '                                       01910000
019110         PV-QUEUE-MANAGER-CC-LAYOUT                               01911000
019300     END-IF.                                                      01930000
019400                                                                  01940000
019800*** READ CONTROL CARD TO GET XS DOMAIN PROMO DATA LOAD QUEUE NAME 01980000
020100     SET PS-CC-OUTPUT-QUEUE-START TO TRUE.                        02010000
020300     READ CC-OUTPUT-QUEUE INTO PV-OUTPUT-QUEUE-CC-LAYOUT          02030000
020400       AT END                                                     02040000
020500         SET PS-CC-OUTPUT-QUEUE-END TO TRUE.                      02050000
020700                                                                  02070000
020710     IF PS-CC-OUTPUT-QUEUE-END                                    02071000
020900       DISPLAY PC-PGM-NAME                                        02090000
021000         'CONTROL CARD MISSING - FOR XS DOMAIN PROMO QUEUE NAME'  02100000
021010       SET PS-EXIT-PROGRAM TO TRUE                                02101000
021200     ELSE                                                         02120000
021300       DISPLAY PC-PGM-NAME                                        02130000
021400         '- '                                                     02140000
021500         PC-FIFTY-STARS                                           02150000
021600       DISPLAY PC-PGM-NAME                                        02160000
021700         '- CONTROL CARD: '                                       02170000
021710         PV-OUTPUT-QUEUE-CC-LAYOUT                                02171000
021900     END-IF.                                                      02190000
022000                                                                  02200000
022010     CLOSE CC-QUEUE-MANAGER                                       02201000
022100           CC-OUTPUT-QUEUE.                                       02210000
023400                                                                  02340000
023401*1000-EXIT.                                                       02340100
023402 EJECT.                                                           02340200
023403                                                                  02340300
023404*----------------------------------------------------------       02340400
023405* 2000-CONNECT-QUEUE-MANAGER.                                     02340500
023406*     - CONNECT TO THE QUEUE MANAGER.                             02340600
023407*----------------------------------------------------------       02340700
023900 2000-CONNECT-QUEUE-MANAGER.                                      02390000
024000                                                                  02400000
024100     MOVE PV-QMGR-NAME TO PV-QM-NAME.                             02410000
024200     CALL MQ-MQCONN USING PV-QM-NAME                              02420000
024300                          PV-HCONN                                02430000
024400                          PV-COMPLETION-CODE                      02440000
024500                          PV-REASON.                              02450000
024600                                                                  02460000
024700*** IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE AND EXIT      02470000
024900                                                                  02490000
025000     MOVE PV-REASON TO PV-CON-REASON.                             02500000
025100     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        02510000
025200       MOVE 'MQCONN ERROR'               TO PV-ERROR-MESSAGE      02520000
025300       MOVE '1000-CONNECT-QUEUE-MANAGER' TO PV-PARAGRAPH          02530000
025400       PERFORM 9000-DISPLAY-ERROR-MESSAGE                         02540000
025500       SET PS-EXIT-PROGRAM TO TRUE                                02550000
025600     END-IF.                                                      02560000
025700     DISPLAY 'MQCONN SUCCESSFUL TO ', PV-QM-NAME.                 02570000
025701                                                                  02570100
025710*2000-EXIT.                                                       02571000
025720 EJECT.                                                           02572000
025800                                                                  02580000
025900*----------------------------------------------------------       02590000
026000* 3000-OPEN-QUEUE.                                                02600000
026001*     - OPEN THE QUEUE FOR OUTPUT.                                02600100
026002*----------------------------------------------------------       02600200
026500 3000-OPEN-QUEUE.                                                 02650000
026600                                                                  02660000
026700     COMPUTE PV-OPEN-OPTIONS = MQOO-OUTPUT +                      02670000
026800                            MQOO-FAIL-IF-QUIESCING +              02680000
026900                            MQOO-SET-IDENTITY-CONTEXT.            02690000
027000     MOVE PV-OUTPUT-QUEUE-NAME TO MQOD-OBJECTNAME.                02700000
027100     MOVE PV-QM-NAME           TO MQOD-OBJECTQMGRNAME.            02710000
027200                                                                  02720000
027300     CALL MQ-MQOPEN USING PV-HCONN                                02730000
027400                          MQM-OBJECT-DESCRIPTOR                   02740000
027500                          PV-OPEN-OPTIONS                         02750000
027600                          PV-PQ-HANDLE                            02760000
027700                          PV-COMPLETION-CODE                      02770000
027800                          PV-REASON.                              02780000
027900                                                                  02790000
028000*** IF OPEN FIALED THEN DISPLAY ERROR MESSAGE AND EXIT            02800000
028300     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        02830000
028400        MOVE 'MQOPEN ERROR'    TO PV-ERROR-MESSAGE                02840000
028500        MOVE '1000-OPEN-QUEUE' TO PV-PARAGRAPH                    02850000
028600        PERFORM 9000-DISPLAY-ERROR-MESSAGE                        02860000
028700        PERFORM 6000-DISCONNECT-QMGR                              02870000
028800        SET PS-EXIT-PROGRAM TO TRUE                               02880000
028900     END-IF.                                                      02890000
029000     DISPLAY 'MQOPEN SUCCESSFUL'.                                 02900000
029100                                                                  02910000
029210*3000-EXIT.                                                       02921000
029220 EJECT.                                                           02922000
029300                                                                  02930000
029400*----------------------------------------------------------       02940000
029401* 4000-MQPUT-MSG.                                                 02940100
029402*     - PUT MESSAGE ON LOCAL QUEUE TO END THE XS PROMO DATA       02940200
029403*       READ PROCESS                                              02940300
029404*----------------------------------------------------------       02940400
029700 4000-MQPUT-MSG.                                                  02970000
029800                                                                  02980000
029900*** SET PERSISTENCE                                               02990000
030100     MOVE MQMI-NONE            TO MQMD-MSGID.                     03010000
030200     MOVE MQCI-NONE            TO MQMD-CORRELID.                  03020000
030300     MOVE PC-CORRELID-ASCII    TO MQMD-CORRELID.                  03030000
030400     MOVE PC-SHUT-DWN-MSG-TEXT TO PV-MSGBUFFER.                   03040000
030500     MOVE PC-PGM-NAME          TO MQMD-USERIDENTIFIER.            03050000
030600     MOVE MQPER-PERSISTENT     TO MQMD-PERSISTENCE.               03060000
030700     COMPUTE MQPMO-OPTIONS  = MQPMO-SYNCPOINT +                   03070000
030800                              MQPMO-SET-IDENTITY-CONTEXT.         03080000
030900                                                                  03090000
031000     CALL MQ-MQPUT USING PV-HCONN                                 03100000
031100                         PV-PQ-HANDLE                             03110000
031200                         MQM-MESSAGE-DESCRIPTOR                   03120000
031300                         MQM-PUT-MESSAGE-OPTIONS                  03130000
031400                         PV-MSGLENGTH                             03140000
031500                         PV-MSGBUFFER                             03150000
031600                         PV-COMPLETION-CODE                       03160000
031700                         PV-REASON.                               03170000
031800                                                                  03180000
031900*** IF PUT FAILED THEN DISPLAY ERROR MESSAGE AND BREAK OUT        03190000
032000*** OF LOOP                                                       03200000
032200     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        03220000
032300       MOVE 'MQPUT ERROR'    TO PV-ERROR-MESSAGE                  03230000
032400       MOVE '4000-MQPUT-MSG' TO PV-PARAGRAPH                      03240000
032500       PERFORM 9000-DISPLAY-ERROR-MESSAGE                         03250000
032800     END-IF.                                                      03280000
032900                                                                  03290000
033010*4000-EXIT.                                                       03301000
033020 EJECT.                                                           03302000
033100                                                                  03310000
033101*----------------------------------------------------------       03310100
033102* 5000-CLOSE-QUEUE.                                               03310200
033103*     - CLOSE THE QUEUE                                           03310300
033105*----------------------------------------------------------       03310500
033600 5000-CLOSE-QUEUE.                                                03360000
033610                                                                  03361000
033700     CALL MQ-MQCLOSE USING PV-HCONN                               03370000
033800                          PV-PQ-HANDLE                            03380000
033900                          MQCO-NONE                               03390000
034000                          PV-COMPLETION-CODE                      03400000
034100                          PV-REASON.                              03410000
034110                                                                  03411000
034120*** IF CLOSE FAILED THEN DISPLAY ERROR MESSAGE AND EXIT           03412000
034200     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        03420000
034300       MOVE 'MQCLOSE ERROR'     TO PV-ERROR-MESSAGE               03430000
034400       MOVE '5000-CLOSE-QUEUE ' TO PV-PARAGRAPH                   03440000
034500       PERFORM 9000-DISPLAY-ERROR-MESSAGE                         03450000
034600     ELSE                                                         03460000
034700       DISPLAY 'MQCLOSE SUCCESSFUL'                               03470000
034800     END-IF.                                                      03480000
034900                                                                  03490000
034910*5000-EXIT.                                                       03491000
034920 EJECT.                                                           03492000
035000                                                                  03500000
035001*----------------------------------------------------------       03500100
035002* 6000-DISCONNECT-QMGR                                            03500200
035003*     - DISCONNECT FROM THE MQ QUEUE MANAGER                      03500300
035004*----------------------------------------------------------       03500400
035400 6000-DISCONNECT-QMGR.                                            03540000
035500                                                                  03550000
035600     IF PV-CON-REASON IS NOT EQUAL TO MQRC-ALREADY-CONNECTED      03560000
035700       CALL MQ-MQDISC USING PV-HCONN                              03570000
035800                            PV-COMPLETION-CODE                    03580000
035900                            PV-REASON                             03590000
036000       IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                 03600000
036100         MOVE 'MQDISC ERROR'         TO PV-ERROR-MESSAGE          03610000
036200         MOVE '6000-DISCONNECT-QMGR' TO PV-PARAGRAPH              03620000
036300         PERFORM 9000-DISPLAY-ERROR-MESSAGE                       03630000
036400       ELSE                                                       03640000
036500         DISPLAY 'MQDISC SUCCESSFUL'                              03650000
036600       END-IF                                                     03660000
036700     END-IF.                                                      03670000
036800                                                                  03680000
037000*6000-EXIT.                                                       03700000
037001 EJECT.                                                           03700100
037002                                                                  03700200
038104*----------------------------------------------------------       03810400
038105* 9000-DISPLAY-ERROR-MESSAGE.                                     03810500
038107*     - DISPLAY THE VALUES OF A FIALED MQ API COMMAND             03810700
038108*----------------------------------------------------------       03810800
038500 9000-DISPLAY-ERROR-MESSAGE.                                      03850000
038700                                                                  03870000
038800     DISPLAY '** ABEND ***********************************'.      03880000
038900     DISPLAY '** PROGRAM:   ', PC-PGM-NAME.                       03890000
039000     DISPLAY '** PARAGRAPH: ', PV-PARAGRAPH.                      03900000
039100     DISPLAY '** MESSAGE:   ', PV-ERROR-MESSAGE.                  03910000
039200     DISPLAY '** COMP CODE: ', PV-COMPLETION-CODE.                03920000
039300     DISPLAY '** RSN CODE:  ', PV-REASON.                         03930000
039400     DISPLAY '********************************************'.      03940000
039500     SET AB-MQ-ERROR TO TRUE.                                     03950000
039600     CALL 'ILBOABN0' USING AB-CODES.                              03960000
039700                                                                  03970000
039801*9000-EXIT.                                                       03980100
039802 EJECT.                                                           03980200
