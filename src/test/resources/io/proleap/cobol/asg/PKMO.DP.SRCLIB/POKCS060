00001 *-----------------------*                                         00010004
00002  IDENTIFICATION DIVISION.                                         00020004
00003 *-----------------------*                                         00030004
00004  PROGRAM-ID.    POKCS060.                                         00040004
00005  AUTHOR.        TIM SMITH                                         00050004
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
00007  DATE-WRITTEN.  02-02-94.                                         00070004
00008  DATE-COMPILED.                                                   00080004
00009 *----------------------------------------------------------------*00090004
00010 *    W060 - DC SPLIT CRITERIA SPEC                               *00100004
00011 *                                                                *00110004
00012 *----------------------------------------------------------------*00120004
C98147*  11-13-14   LINDA FRIESS                 CHG0098147             00130007
C98147*  CHANGE: EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND COMMAREA     00140006
C98147*---------------------------------------------------------------* 00150006
076319* DATE  10/27/2021                                                00151009
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00152009
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00153009
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00154009
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00155010
076312*                                                               * 00156009
076318*---------------------------------------------------------------* 00157009
CICS  *  CHANGED 11/14/2022    BY BARB SCHULTZ    WR: CHG0278485        00158013
CICS  *                                                               * 00159011
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00159111
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00159211
CICS  *---------------------------------------------------------------* 00159511
00013                                                                   00160004
00014  ENVIRONMENT DIVISION.                                            00170004
00015                                                                   00180004
00016  DATA DIVISION.                                                   00190004
00017                                                                   00200004
00018  WORKING-STORAGE SECTION.                                         00210004
00019 *                                                                 00220004
00020  01  PC-PROGRAM-CONSTANTS.                                        00230004
00021      05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'PO060A  '. 00240004
00022      05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'POKM060 '. 00250004
00023      05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'POKCS060'. 00260004
00024      05  PC-TSYMSG-NUMBERS.                                       00270004
00025          10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00280004
00026          10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00290004
00027          10  PC-TSYMSG-00095       PIC  9(05)  VALUE  00095.      00300004
00028          10  PC-TSYMSG-00224       PIC  9(05)  VALUE  00224.      00310004
00029 *                                                                 00320004
00030  01  PS-PROGRAM-SWITCHES.                                         00330004
00031      05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00340004
00032          88  PS-ERROR                          VALUE  'Y'.        00350004
00033          88  PS-NO-ERROR                       VALUE  'N'.        00360004
00034                                                                   00370004
00035 *----------------------------------------------------------------*00380004
00036 *    MAP LAYOUT                                                  *00390004
00037 *----------------------------------------------------------------*00400004
00038                                                                   00410004
00039      COPY POKM060.                                                00420004
00040      EJECT                                                        00430004
00041 *----------------------------------------------------------------*00440004
00042 *    ATTRIBUTE SETTINGS COPYBOOK.                                *00450004
00043 *----------------------------------------------------------------*00460004
00044                                                                   00470004
00045      COPY DPWS015.                                                00480004
00046                                                                   00490004
00047 *----------------------------------------------------------------*00500004
00048 *    FUNCTION KEYS COPYBOOK                                      *00510004
00049 *----------------------------------------------------------------*00520004
00050                                                                   00530004
00051      COPY DPWS016.                                                00540004
00052  EJECT                                                            00550004
00053 ******************************************************************00560004
00054 ** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00570004
00055 ** SUB-ROUTINE (DPKUT100).                                      **00580004
00056 ******************************************************************00590004
00057      COPY DPWS010I.                                               00600004
00058  EJECT                                                            00610004
00059 ******************************************************************00620004
CICS  ** PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            **00630014
00062 ******************************************************************00650004
00063      COPY DPWS030.                                                00660004
CICS       COPY DPWS930.                                                00661011
00064  EJECT                                                            00670004
00065 ***************************************************************** 00680004
00066 *    STANDARD COMMAREA.                                           00690004
00067 ***************************************************************** 00700004
00068                                                                   00710004
00069      COPY DPWS020.                                                00720004
00070      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                00730004
00071                                                                   00740004
00072 ***************************************************************** 00750004
00073 *    INTER-APPLICATION COMMAREA.                                  00760004
00074 ***************************************************************** 00770004
00075                                                                   00780004
00076          10  INTER-APPL-COMM-AREA PIC X(200).                     00790004
00077      COPY POWS060.                                                00800004
00078 ***************************************************************** 00810004
00079 *    SPECIFIC COMMMAREA FOR POKCS060.                             00820004
00080 ***************************************************************** 00830004
00081          10  ASC-SPECIFIC-COMMAREA.                               00840004
00082              15  ASC-DPT-NUMBER.                                  00850004
00083                  20  ASC-DPT-NUMBER-N        PIC  9(03).          00860004
00084              15  ASC-DAYS-RELEASE.                                00870004
00085                  20  ASC-DAYS-RELEASE-N      PIC  9(03).          00880004
00086              15  ASC-STATUS                  PIC  X(01).          00890004
00087              15  ASC-DMM-NAME                PIC  X(20).          00900004
00088              15  ASC-PO-NUMBER.                                   00910004
C98147                 20  ASC-PO-NUMBER-N         PIC  9(08).          00920007
C98147         10  FILLER                          PIC  X(2830).        00930007
00091      EJECT                                                        00940004
00092 *----------------------------------------------------------------*00950004
00093 *    ABEND PROCESSING COPYBOOK.                                  *00960004
00094 *----------------------------------------------------------------*00970004
00095                                                                   00980004
00096      COPY DPWS013.                                                00990004
00097                                                                   01000004
00098                                                                   01010004
00099  EJECT                                                            01020004
00100  LINKAGE SECTION.                                                 01030004
00101                                                                   01040004
00102  01  DFHCOMMAREA.                                                 01050004
00103      05  FILLER                         OCCURS  1 TO 4072 TIMES   01060004
00104                                         DEPENDING ON EIBCALEN.    01070004
00105          10  FILLER                     PIC X.                    01080004
00106                                                                   01090004
00107                                                                   01100004
00108  PROCEDURE DIVISION.                                              01110004
00109 ***************************************************************** 01120004
00110 ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01130004
00111 ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01140004
00112 ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01150004
00113 **                                                             ** 01160004
00114 ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01170004
00115 ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01180004
00116 ***************************************************************** 01190004
00117  0000-MAIN-MODULE.                                                01200004
00118      INITIALIZE DP030-CICS-API-FIELDS.                            01210004
00119      MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01220004
00120      MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01230004
00121      MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01240004
00122      SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01250004
00123      MOVE LENGTH OF PO060AI        TO DP030-MAP-LENGTH (1).       01260004
00124      MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01270004
00125      PERFORM 0001-CALL-CICS-ARCH-API.                             01280004
00126 *                                                                 01290004
00127      PERFORM 1000-CONTROL-PROCESSING                              01300004
00128 *                                                                 01310004
00129      MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01320004
00130      PERFORM 0001-CALL-CICS-ARCH-API.                             01330004
00131                                                                   01340004
00132  0001-CALL-CICS-ARCH-API.                                         01350004
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      01360011
00134                                     DFHCOMMAREA                   01370011
00135                                     DP030-CICS-API-FIELDS         01380011
00136                                     DP020-STANDARD-COMMAREA       01390011
00137                                     PO060AI.                      01400011
00138 *                                                                 01410004
00139      IF  DP030-RC-CALL-SUCCESSFUL                                 01420004
00140          CONTINUE                                                 01430004
00141      ELSE                                                         01440004
00142          SET DP013-NO-ROLLBACK                                    01450004
00143              DP013-XCTL-DISPLAY-RESTART                           01460004
00144              DP013-CICS-ABEND      TO TRUE                        01470004
CICS           MOVE '0001-CALL-CICS-ARCH-API'                           01480011
00146                                    TO DP013-PARAGRAPH             01490004
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O01500011
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      01510011
00149          MOVE DP030-RETURN-CODE                                   01520004
00150                                    TO DP013-MESSAGE-TEXT (3)      01530004
00151          PERFORM DP013-0000-PROCESS-ABEND                         01540004
00152      END-IF.                                                      01550004
00153  EJECT                                                            01560004
00154 *----------------------------------------------------------------*01570004
00155 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *01580004
00156 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *01590004
00157 *----------------------------------------------------------------*01600004
00158                                                                   01610004
00159  1000-CONTROL-PROCESSING.                                         01620004
00160                                                                   01630004
00161      EVALUATE TRUE                                                01640004
00162          WHEN DP020-NEXT-ACT-INITIAL                              01650004
00163              INITIALIZE ASC-SPECIFIC-COMMAREA                     01660004
00164              PERFORM 4000-BUILD-INITIAL-PANEL                     01670004
00165                                                                   01680004
00166          WHEN DP020-NEXT-ACT-READ-MAP                             01690004
00167              PERFORM 2000-FKEY-PROCESSING                         01700004
00168                                                                   01710004
00169          WHEN DP020-NEXT-ACT-RETURN                               01720004
00170              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 01730004
00171              PERFORM 3000-EDIT-DATA-IN-COMMAREA                   01740004
00172                                                                   01750004
00173          WHEN OTHER                                               01760004
00174              SET DP013-LOGIC-ABEND                                01770004
00175                  DP013-NO-ROLLBACK TO TRUE                        01780004
00176              MOVE '1000-CONTROL-PROCESSING'                       01790004
00177                                    TO  DP013-PARAGRAPH            01800004
00178              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   01810004
00179                                    TO  DP013-MESSAGE-TEXT(1)      01820004
00180              MOVE DP020-NEXT-APPL-ACTIVITY                        01830004
00181                                    TO DP013-MESSAGE-TEXT(2)       01840004
00182              PERFORM DP013-0000-PROCESS-ABEND                     01850004
00183      END-EVALUATE.                                                01860004
00184                                                                   01870004
00185 *----------------------------------------------------------------*01880004
00186 * FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*01890004
00187 * SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*01900004
00188 * EDITS.                                                         *01910004
00189 *----------------------------------------------------------------*01920004
00190                                                                   01930004
00191  2000-FKEY-PROCESSING.                                            01940004
00192                                                                   01950004
00193      EVALUATE TRUE                                                01960004
00194                                                                   01970004
00195          WHEN DP020-SRC-AID = DP016-CLEAR                         01980004
00196              PERFORM 3000-EDIT-DATA-IN-COMMAREA                   01990004
00197              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02000004
00198                                                                   02010004
00199          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02020004
00200              INITIALIZE ASC-SPECIFIC-COMMAREA                     02030004
00201              PERFORM 4000-BUILD-INITIAL-PANEL                     02040004
00202              PERFORM 3200-RESET-ATTRIBUTES                        02050004
00203                                                                   02060004
00204          WHEN OTHER                                               02070004
00205              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02080004
00206              PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02090004
00207              IF  PS-NO-ERROR                                      02100004
00208                  SET DP030-CONTINUE-GO TO TRUE                    02110004
00209                  PERFORM 2100-CHECK-FUNCTION-KEY                  02120004
00210              ELSE                                                 02130004
00211                  SET DP030-OVERRIDE-GO TO TRUE                    02140004
00212              END-IF                                               02150004
00213      END-EVALUATE.                                                02160004
00214 ******************************************************************02170004
00215 ** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **02180004
00216 ** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **02190004
00217 ** FROM THE CICS ARCHITECTURE API.                              **02200004
00218 ******************************************************************02210004
00219  2100-CHECK-FUNCTION-KEY.                                         02220004
00220      EVALUATE TRUE                                                02230004
00221          WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 02240004
00222              PERFORM 2110-PREPARE-INTER-APPL-COMM                 02250004
00223                                                                   02260004
00224          WHEN DP020-SRC-AID = DP016-ENTER                         02270004
00225              CONTINUE                                             02280004
00226                                                                   02290004
00227          WHEN OTHER                                               02300004
00228              SET DP013-NO-ROLLBACK                                02310004
00229                  DP013-XCTL-DISPLAY-RESTART                       02320004
00230                  DP013-CICS-ABEND  TO TRUE                        02330004
00231              MOVE '2100-CHECK-FUNCTION-KEY'                       02340004
00232                                    TO DP013-PARAGRAPH             02350004
00233              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      02360004
00234                                    TO DP013-MESSAGE-TEXT (1)      02370004
00235              PERFORM DP013-0000-PROCESS-ABEND                     02380004
00236      END-EVALUATE.                                                02390004
00237 ******************************************************************02400004
00238 *  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **02410004
00239 *  INTER-APPLICATION COMMAREA.                                  **02420004
00240 ******************************************************************02430004
00241  2110-PREPARE-INTER-APPL-COMM.                                    02440004
00242      INITIALIZE PO060-INTER-APPL-COMMAREA.                        02450004
00243      MOVE ASC-DPT-NUMBER-N         TO PO060-DPT-NUMBER.           02460004
00244      MOVE ASC-DAYS-RELEASE-N       TO PO060-DAYS-RELEASE.         02470004
00245      MOVE ASC-STATUS               TO PO060-STATUS.               02480004
00246      MOVE ASC-DMM-NAME             TO PO060-DMM-NAME.             02490004
00247      MOVE ASC-PO-NUMBER-N          TO PO060-PO-NUMBER.            02500004
00248  EJECT                                                            02510004
00249 *----------------------------------------------------------------*02520004
00250 * MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*02530004
00251 * THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *02540004
00252 * APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *02550004
00253 *----------------------------------------------------------------*02560004
00254                                                                   02570004
00255  2200-MOVE-SCREEN-TO-COMMAREA.                                    02580004
00256      IF  ADEPTL   > ZERO                                          02590004
00257          MOVE ADEPTI               TO ASC-DPT-NUMBER              02600004
00258      ELSE                                                         02610004
00259          IF  ADEPTF = DP015-ERASE-EOF                             02620004
00260              MOVE SPACE            TO ASC-DPT-NUMBER              02630004
00261          END-IF                                                   02640004
00262      END-IF.                                                      02650004
00263                                                                   02660004
00264      IF  ARLSDYSL > ZERO                                          02670004
00265          MOVE ARLSDYSI             TO ASC-DAYS-RELEASE            02680004
00266      ELSE                                                         02690004
00267          IF  ARLSDYSF = DP015-ERASE-EOF                           02700004
00268              MOVE SPACE            TO ASC-DAYS-RELEASE            02710004
00269          END-IF                                                   02720004
00270      END-IF.                                                      02730004
00271                                                                   02740004
      *  THIS FIELD IS NO LONGER EDITABLE.                              02750004
00272 *    IF  ASTATUSL > ZERO                                          02760004
00273 *        MOVE ASTATUSI             TO ASC-STATUS                  02770004
00274 *    ELSE                                                         02780004
00275 *        IF  ASTATUSF = DP015-ERASE-EOF                           02790004
00276 *            MOVE SPACE            TO ASC-STATUS                  02800004
00277 *        END-IF                                                   02810004
00278 *    END-IF.                                                      02820004
00279                                                                   02830004
00280      IF  ADMML > ZERO                                             02840004
00281          MOVE ADMMI                TO ASC-DMM-NAME                02850004
00282      ELSE                                                         02860004
00283          IF  ADMMF = DP015-ERASE-EOF                              02870004
00284              MOVE SPACE            TO ASC-DMM-NAME                02880004
00285          END-IF                                                   02890004
00286      END-IF.                                                      02900004
00287                                                                   02910004
00288      IF  APONBRL  > ZERO                                          02920004
00289          MOVE APONBRI              TO ASC-PO-NUMBER               02930004
00290      ELSE                                                         02940004
00291          IF  APONBRF = DP015-ERASE-EOF                            02950004
00292              MOVE SPACE            TO ASC-PO-NUMBER               02960004
00293          END-IF                                                   02970004
00294      END-IF.                                                      02980004
00295 *----------------------------------------------------------------*02990004
00296 * ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *03000004
00297 * CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *03010004
00298 * A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*03020004
00299 * IN THE DESTINATION PROGRAM, NOT HERE.                          *03030004
00300 *----------------------------------------------------------------*03040004
00301                                                                   03050004
00302  3000-EDIT-DATA-IN-COMMAREA.                                      03060004
00303      PERFORM 3200-RESET-ATTRIBUTES.                               03070004
00304      IF  ASC-PO-NUMBER > SPACE                                    03080004
00305          MOVE ASC-PO-NUMBER        TO DP010I-UNEDITED-FIELD       03090004
00306          MOVE LENGTH OF ASC-PO-NUMBER TO DP010I-MAXIMUM-DIGITS    03100004
00307          MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     03110004
00308          SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  03120004
26422          CALL DP010I-NUMERIC-EDIT-ROUTINE                         03131008
26423                          USING DP010I-NUMERIC-EDIT-AREA           03132008
00310          IF  DP010I-ERROR-DETECTED                                03140004
00311              SET PS-ERROR                                         03150004
00312                  DP020-MSG-FATAL   TO TRUE                        03160004
00313              MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            03170004
00314              MOVE DP015-UNP-ALP-BRT-OFF                           03180004
00315                                    TO APONBRA                     03190004
00316              MOVE DP015-RED        TO APONBRC                     03200004
00317              MOVE DP015-REVERSE    TO APONBRH                     03210004
00318              MOVE -1               TO APONBRL                     03220004
00319              SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03230004
00320          ELSE                                                     03240004
00321              MOVE DP010I-NUMERIC-FIELD                            03250004
00322                                    TO ASC-PO-NUMBER-N             03260004
00323                                       APONBRO                     03270004
00324          END-IF                                                   03280004
00325      END-IF.                                                      03290004
00326 *  1, 2, AND 3 WERE ONCE OPTIONS FOR THIS PROGRAM.  THEY HAVE     03300004
      *  BEEN LEFT IN FOR POSSIBLE FUTURE REENTRY.  THIS FIELD IS       03310004
      *  IS NO LONGER EDITABLE.                                         03320004
00327 *    IF  ASC-STATUS NOT EQUAL '1'                                 03330004
00328 *    AND ASC-STATUS NOT EQUAL '2'                                 03340004
00329 *    AND ASC-STATUS NOT EQUAL '3'                                 03350004
00329 *    AND ASC-STATUS NOT EQUAL '4'                                 03360004
00330 *        SET PS-ERROR                                             03370004
00331 *            DP020-MSG-FATAL       TO TRUE                        03380004
00332 *        MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            03390004
00333 *        MOVE DP015-UNP-ALP-BRT-OFF                               03400004
00334 *                                  TO ASTATUSA                    03410004
00335 *        MOVE DP015-RED            TO ASTATUSC                    03420004
00336 *        MOVE DP015-REVERSE        TO ASTATUSH                    03430004
00337 *        MOVE -1                   TO ASTATUSL                    03440004
00338 *        SET DP030-SET-CURSOR-APPL-1 TO TRUE                      03450004
00339 *    END-IF.                                                      03460004
00340 *                                                                 03470004
00341      IF  ASC-DAYS-RELEASE > SPACE                                 03480004
00342          MOVE ASC-DAYS-RELEASE     TO DP010I-UNEDITED-FIELD       03490004
00343          MOVE LENGTH OF ASC-DAYS-RELEASE TO DP010I-MAXIMUM-DIGITS 03500004
00344          MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     03510004
00345          SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  03520004
26422          CALL DP010I-NUMERIC-EDIT-ROUTINE                         03531008
26423                          USING DP010I-NUMERIC-EDIT-AREA           03532008
00347          IF  DP010I-ERROR-DETECTED                                03540004
00348              SET PS-ERROR                                         03550004
00349                  DP020-MSG-FATAL   TO TRUE                        03560004
00350              MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            03570004
00351              MOVE DP015-UNP-ALP-BRT-OFF                           03580004
00352                                    TO ARLSDYSA                    03590004
00353              MOVE DP015-RED        TO ARLSDYSC                    03600004
00354              MOVE DP015-REVERSE    TO ARLSDYSH                    03610004
00355              MOVE -1               TO ARLSDYSL                    03620004
00356              SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03630004
00357          ELSE                                                     03640004
00358              MOVE DP010I-NUMERIC-FIELD                            03650004
00359                                    TO ASC-DAYS-RELEASE-N          03660004
00360                                       ARLSDYSO                    03670004
00361          END-IF                                                   03680004
00362      END-IF.                                                      03690004
00363 *                                                                 03700004
00364      IF  ASC-DPT-NUMBER > SPACE                                   03710004
00365          MOVE ASC-DPT-NUMBER       TO DP010I-UNEDITED-FIELD       03720004
00366          MOVE LENGTH OF ASC-DPT-NUMBER TO DP010I-MAXIMUM-DIGITS   03730004
00367          MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     03740004
00368          SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  03750004
26422          CALL DP010I-NUMERIC-EDIT-ROUTINE                         03761008
26423                          USING DP010I-NUMERIC-EDIT-AREA           03762008
00370          IF  DP010I-ERROR-DETECTED                                03770004
00371              SET PS-ERROR                                         03780004
00372                  DP020-MSG-FATAL   TO TRUE                        03790004
00373              MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            03800004
00374              MOVE DP015-UNP-ALP-BRT-OFF                           03810004
00375                                    TO ADEPTA                      03820004
00376              MOVE DP015-RED        TO ADEPTC                      03830004
00377              MOVE DP015-REVERSE    TO ADEPTH                      03840004
00378              MOVE -1               TO ADEPTL                      03850004
00379              SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03860004
00380          ELSE                                                     03870004
00381              MOVE DP010I-NUMERIC-FIELD                            03880004
00382                                    TO ASC-DPT-NUMBER-N            03890004
00383                                       ADEPTO                      03900004
00384          END-IF                                                   03910004
00385      END-IF.                                                      03920004
00386 *                                                                 03930004
00387      IF  PS-NO-ERROR                                              03940004
00388          MOVE -1                   TO ADEPTL                      03950004
00389          SET DP030-SET-CURSOR-APPL-1                              03960004
00390                                    TO TRUE                        03970004
00391      END-IF.                                                      03980004
00392 ******************************************************************03990004
00393 ** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **04000004
00394 ** MAP.                                                         **04010004
00395 ******************************************************************04020004
00396  3200-RESET-ATTRIBUTES.                                           04030004
00397      MOVE DP015-UNP-NUM-NOR-OFF    TO ADEPTA                      04040004
00398                                       ARLSDYSA                    04050004
00399 *                                     ASTATUSA                    04060004
00401                                       APONBRA.                    04070004
           MOVE DP015-UNP-ALP-NOR-OFF    TO ADMMA.                      04080004
00402      MOVE DP015-GREEN              TO ADEPTC                      04090004
00403                                       ARLSDYSC                    04100004
00404 *                                     ASTATUSC                    04110004
00405                                       ADMMC                       04120004
00406                                       APONBRC.                    04130004
00407      MOVE DP015-UNDERLINE          TO ADEPTH                      04140004
00408                                       ARLSDYSH                    04150004
00409 *                                     ASTATUSH                    04160004
00410                                       ADMMH                       04170004
00411                                       APONBRH.                    04180004
00412 *                                                                 04190004
00413 *----------------------------------------------------------------*04200004
00414 *  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *04210004
00415 *  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *04220004
00416 *  IT HERE.                                                      *04230004
00417 *----------------------------------------------------------------*04240004
00418  4000-BUILD-INITIAL-PANEL.                                        04250004
00419      MOVE '4'                      TO ASTATUSO                    04260004
00420                                       ASC-STATUS.                 04270004
00421      MOVE 15                       TO ARLSDYSO                    04280004
00422                                       ASC-DAYS-RELEASE-N.         04290004
00423      SET DP030-SET-CURSOR-APPL-1   TO TRUE                        04300004
00424      MOVE -1                       TO ADEPTL.                     04310004
00425 *                                                                 04320004
00426 *----------------------------------------------------------------*04330004
00427 *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *04340004
00428 *----------------------------------------------------------------*04350004
00429  4400-MOVE-COMMAREA-TO-SCREEN.                                    04360004
00430      MOVE ASC-DPT-NUMBER-N         TO ADEPTO.                     04370004
00431      MOVE ASC-DAYS-RELEASE-N       TO ARLSDYSO.                   04380004
00432      MOVE ASC-STATUS               TO ASTATUSO.                   04390004
00433      MOVE ASC-DMM-NAME             TO ADMMO.                      04400004
00434      MOVE ASC-PO-NUMBER-N          TO APONBRO.                    04410004
00435  EJECT                                                            04420004
00436 *----------------------------------------------------------------*04430004
00437 *    ABEND PROCESSOR MODULE                                      *04440004
00438 *----------------------------------------------------------------*04450004
00439                                                                   04460004
00440      COPY DPPD013.                                                04470004
