000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    IQKCS401.                                         00040002
000500 AUTHOR.        GREG SHEFF.                                       00050002
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
000700 DATE-WRITTEN.  02-18-03.                                         00070002
000800 DATE-COMPILED.                                                   00080002
000900*----------------------------------------------------------------*00090002
001000*    I401 - SKU VERIFICATION CRITERIA SPEC                       *00100002
001100*                                                                *00110002
001200*    THIS SYSTEM WAS DEVELOPED TO HELP STORE PERSONNEL ASSIGN A  *00120002
001300*    SKU NUMBER TO ANY ITEM THAT WAS RETURNED WITHOUT A TICKET.  *00130002
001400*                                                                *00140002
001500*    BEGIN THE SKU VERIFICATION DRILL DOWN PROCESS HAS THREE     *00150002
001600*    OPTIONS AVAILABLE.                                          *00160002
001700*                                                                *00170002
001800*        1 - F19 - ENTER 1 TO 5 POSITIONS OF THE VENDOR LABEL    *00180002
001900*                  OR VENDOR NAME.                               *00190002
002000*            GOES TO IQLVEND - IQKCS402 - VENDOR/LABEL NAME LIST *00200002
002100*                 FORMAT CODE IS SPACE.                          *00210002
002200*            LISTS VENDORS THAT START WITH ENTERED CHARACTERS.   *00220002
002300*                                                                *00230002
002400*        2 - F20 - DON'T ENTER ANY VENDOR CHARACTERS.            *00240002
002500*            GOES TO IQLBUSGP - IQKCS403 - BUSINESS GROUP LIST   *00250002
002600*                 FORMAT CODE IS SPACE.                          *00260002
002700*            LISTS BUSINESS GROUPS FOR ALL VENDORS.              *00270002
002800*                                                                *00280002
002900*        3 - F21 - ENTER THE COMPLETE UPC NUMBER AND ALL UPCS    *00290002
003000*                  WITH A SIMILAR SKU WILL BE DISPLAYED.         *00300002
003100*            GOES TO IQLSKU   - IQKCS408 - UPC LIST              *00310002
003200*                 FORMAT CODE IS 4.                              *00320002
003300*            LISTS STYLE RELATED UPC NUMBERS.                    *00330002
003400*                                                                *00340002
003500*        4 - F17 - ENTER THE STYLE AND ALL UPCS WITH THE SAME    *00350002
003600*                  STYLE WILL BE DISPLAYED.                      *00360002
003700*            GOES TO IQLSKU   - IQKCS408 - UPC LIST              *00370002
003800*                 FORMAT CODE IS 6.                              *00380029
003900*                                                                *00390029
004000*        5 - F22 - ENTER DEPARTMENT AND EITHER MAJOR OR SUB      *00400029
004100*                  CLASS.  ALL OF THE UPCS WILL BE DISPLAYED.    *00410029
004200*            GOES TO IQLSKU   - IQKCS408 - UPC LIST              *00420029
004300*                 FORMAT CODE IS 6.                              *00430029
004400*                                                                *00440029
004500*        6 - F23 - ENTER THE COMPLETE UPC NUMBER AND THE RELATED *00450029
004600*                  INFORMATION WILL BE DISPLAYED.                *00460029
004700*            GOES TO IQIUPCST - IQKCS414 - UPC                   *00470029
004800*                 FORMAT CODE IS SPACE.                          *00480029
004900*                                                                *00490029
005000*        7 - F16 - ENTER DEPARTMENT AND EITHER MAJOR OR SUB      *00500029
005100*                  CLASS.  ALL UPCS & ONHANDS WILL BE DISPLAYED. *00510029
005200*            GOES TO IQLONHND - IQKCS416 - ON HAND LIST          *00520029
005300*                                                                *00530002
005400*----------------------------------------------------------------*00540002
005500* DATE:        11/01/2012                                         00550029
005600* WR/IR#:      CRQ000000034042                                    00560029
005700* PROGRAMMER:  COGNIZANT                                          00570029
005800* DESCRIPTION: INTRODUCED UPC & SKU VALIDATION LOGIC.             00580029
005900*                                                                 00590029
006000******************************************************************00600029
006100* DATE:        04/01/2013                                         00610029
006200* WR/IR#:      CHG0053622                                         00620029
006300* PROGRAMMER:  JIM ARENDT                                         00630029
006400* DESCRIPTION: REMOVED PILOT RFID CODE                            00640029
006401******************************************************************00640129
006403* DATE:        09/14/2021                                         00640330
006404* WR/IR#:      CHG0261678                                         00640431
006405* PROGRAMMER:  GERMAN BANDA                                       00640530
006407* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00640730
006408*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00640830
006409*              MAKING THE CALL DYNAMIC VS STATIC                  00640930
006410******************************************************************00641030
006403* DATE:        01/10/2022                                         00641132
006404* WR/IR#:      CHG0263774                                         00641232
006405* PROGRAMMER:  JEAN KURK                                          00641332
006407* DESCRIPTION: REMOVE FUNCTIONALITY FOR TICKET PRINTING           00641432
006410******************************************************************00641732
CICS  * CHANGED 10/31/2022    BY JIM HUNTER      WR: CHG0277565         00641843
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00641942
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00642042
CICS  ******************************************************************00642142
006403* DATE:        02/14/2023                                         00642244
006404* WR/IR#:      CHG0281369                                         00642344
006405* PROGRAMMER:  JEAN KURK                                          00642444
006407* DESCRIPTION: CHANGE CALL TO UPC CHECK DIGIT ROUTINE TO DYNAMIC  00642545
006408******************************************************************00642645
006412                                                                  00642702
006413 ENVIRONMENT DIVISION.                                            00642802
006414                                                                  00642902
006415 DATA DIVISION.                                                   00643002
006416                                                                  00643102
006417 WORKING-STORAGE SECTION.                                         00643202
006418                                                                  00643302
006419 01  PC-PROGRAM-CONSTANTS.                                        00643402
006420     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'IQ401A  '. 00643502
006430     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'IQKM401 '. 00644002
006500     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'IQKCS401'. 00650002
006600     05  PC-MAX-RETRIES            PIC S9(03) COMP-3 VALUE 3.     00660002
006700     05  PC-TSYMSG-NUMBERS.                                       00670029
006800         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00680002
006900         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00690002
007000         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00700002
007100         10  PC-TSYMSG-00036       PIC  9(05)  VALUE  00036.      00710029
007210         10  PC-TSYMSG-00073       PIC  9(05)  VALUE  00073.      00721029
007310         10  PC-TSYMSG-00100       PIC  9(05)  VALUE  00100.      00731029
007400         10  PC-TSYMSG-00308       PIC  9(05)  VALUE  00308.      00740029
007500         10  PC-TSYMSG-00414       PIC  9(05)  VALUE  00414.      00750002
007700         10  PC-TSYMSG-00588       PIC  9(05)  VALUE  00588.      00770029
007800         10  PC-TSYMSG-00695       PIC  9(05)  VALUE  00695.      00780029
007900         10  PC-TSYMSG-03105       PIC  9(05)  VALUE  03105.      00790002
009000                                                                  00900002
009100 01  DK-PROGRAM-VARIABLES.                                        00910029
009200     05  DK-DEPT-NBR               PIC S9(04)  VALUE +0 COMP-3.   00920029
009300     05  DK-MAJ-CL-NBR             PIC S9(04)  VALUE +0 COMP-3.   00930029
009400     05  DK-SUB-CL-NBR             PIC S9(04)  VALUE +0 COMP-3.   00940029
009401     05  DK-UPC-NBR                PIC S9(15)  VALUE +0 COMP-3.   00940129
009402     05  DK-SKU-NBR                PIC S9(09)  VALUE  0.          00940229
009403     05  DK-UPC-NBR-PIC9           PIC  9(15)  VALUE  0.          00940329
009500                                                                  00950029
009600 01  PV-PROGRAM-VARIABLES.                                        00960029
009700     05  PV-UPC1-INIT              PIC  X(02)  VALUE  '0 '.       00970029
009800     05  PV-UPC-NO                 PIC  X(13)  VALUE  SPACES.     00980002
009900     05  PV-UPC-NO-PIC9  REDEFINES PV-UPC-NO                      00990002
010000                                   PIC  9(13).                    01000002
010300     05  PV-RETRY-COUNTER          PIC  S9(4)  COMP    VALUE 0.   01030002
010400     05  PV-CICS-RESP              PIC S9(04)  COMP    VALUE +0.  01040029
010500                                                                  01050029
010600 01  IV-INDICATOR-VARIABLES.                                      01060002
010700     05  IV-LAST-NCLR-RTL-AMT      PIC  S9(4)  COMP    VALUE 0.   01070002
010800                                                                  01080002
010900 01  PS-PROGRAM-SWITCHES.                                         01090002
011000     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01100002
011100         88  PS-ERROR                          VALUE  'Y'.        01110002
011200         88  PS-NO-ERROR                       VALUE  'N'.        01120002
011300* SW USED TO INDICATE WHETHER SCREEN INPUT VALUE IS VALID; I.E.   01130002
011400* ONE TO FIVE CHARACTERS LONG SCREEN INPUT VALUE IS VALID; I.E.   01140002
011500     05  PS-LBL-ERROR-SW           PIC  X(01)  VALUE  'N'.        01150002
011600         88  PS-LBL-ERROR                      VALUE  'Y'.        01160002
011700         88  PS-LBL-NO-ERROR                   VALUE  'N'.        01170002
011800     05  PS-CHECK-DIGIT-SW         PIC  X(01)  VALUE  ' '.        01180002
011900         88  PS-CHECK-DIGIT-VALID              VALUE  'A'.        01190002
012000         88  PS-CHECK-DIGIT-INVALID            VALUE  'B'.        01200002
012100     05  PS-UPC-SW                 PIC  X(01)  VALUE  ' '.        01210002
012200         88  PS-UPC-VALID                      VALUE  'A'.        01220002
012300         88  PS-UPC-INVALID                    VALUE  'B'.        01230002
012400     05  PS-DEPT-SW                PIC  X(01)  VALUE  ' '.        01240029
012500         88  PS-DEPARTMENT-FOUND               VALUE  'A'.        01250029
012600         88  PS-DEPARTMENT-NOT-FOUND           VALUE  'B'.        01260029
012700     05  PS-MAJOR-CLS-SW           PIC  X(01)  VALUE  ' '.        01270029
012800         88  PS-MAJOR-CLASS-FOUND              VALUE  'A'.        01280029
012900         88  PS-MAJOR-CLASS-NOT-FOUND          VALUE  'B'.        01290029
013000     05  PS-SUB-CLS-SW             PIC  X(01)  VALUE  ' '.        01300029
013100         88  PS-SUB-CLASS-FOUND                VALUE  'A'.        01310029
013200         88  PS-SUB-CLASS-NOT-FOUND            VALUE  'B'.        01320029
013300     05  PS-DISPLAY-UPC-SW         PIC  X(01)  VALUE  ' '.        01330029
013400         88  PS-DISPLAY-UPC-01                 VALUE  '1'.        01340029
014200     05  PS-UPC-FOUND-SW           PIC  X(01)  VALUE  'N'.        01420029
014300         88  PS-UPC-FOUND                      VALUE  'Y'.        01430029
014400         88  PS-UPC-NOT-FOUND                  VALUE  'N'.        01440029
014500     05  PS-SKU-FOUND-SW           PIC  X(01)  VALUE  'N'.        01450029
014600         88  PS-SKU-FOUND                      VALUE  'Y'.        01460029
014601         88  PS-SKU-NOT-FOUND                  VALUE  'N'.        01460129
014602                                                                  01460202
014603 01  PM-PROGRAM-MESSAGES.                                         01460302
014604     05  PM-ABEND-INFO-A.                                         01460402
014605         10  FILLER                PIC X(15)   VALUE              01460502
014606                                   'DP020-SRC-AID: '.             01460602
014700         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01470002
014800         10  FILLER                PIC X(19)   VALUE              01480002
014900                                   '. DP020-FK-ACTION: '.         01490002
015000         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01500002
015100         10  FILLER                PIC X(22)   VALUE              01510002
015200                                   '. DP020-FK-DISPN-IND: '.      01520002
015300         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01530002
015400         10  FILLER                PIC X(01)   VALUE '.'.         01540002
015500         10  FILLER                PIC X(19)   VALUE SPACE.       01550002
015600                                                                  01560002
015700                                                                  01570002
015800*----------------------------------------------------------------*01580002
015900*    MAP LAYOUT                                                  *01590002
016000*----------------------------------------------------------------*01600002
016100                                                                  01610002
016200     COPY IQKM401.                                                01620002
016300     EJECT                                                        01630002
016400*----------------------------------------------------------------*01640002
016500*    ATTRIBUTE SETTINGS COPYBOOK.                                *01650002
016600*----------------------------------------------------------------*01660002
016700                                                                  01670002
016800     COPY DPWS015.                                                01680002
016900                                                                  01690002
018900*----------------------------------------------------------------*01890002
019000*    FUNCTION KEYS COPYBOOK                                      *01900002
019100*----------------------------------------------------------------*01910002
019200                                                                  01920002
019300     COPY DPWS016.                                                01930002
019400 EJECT                                                            01940002
019500*----------------------------------------------------------------*01950002
019600*    NUMERIC EDIT ROUTING COPYBOOK                               *01960002
019700*----------------------------------------------------------------*01970002
019800                                                                  01980002
019900     COPY DPWS010I.                                               01990002
020000 EJECT                                                            02000002
020100******************************************************************02010002
020200** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **02020002
020300** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02030002
020400******************************************************************02040002
020500     COPY DPWS030.                                                02050002
CICS       COPY DPWS930.                                                02051042
020600 EJECT                                                            02060002
020700***************************************************************** 02070002
020800*    STANDARD COMMAREA.                                           02080002
020900***************************************************************** 02090002
021000                                                                  02100002
021100     COPY DPWS020.                                                02110002
021200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02120002
021300                                                                  02130002
021400***************************************************************** 02140002
021500*    INTER-APPLICATION COMMAREA.                                  02150002
021600***************************************************************** 02160002
021700                                                                  02170002
021800         10  INTER-APPL-COMM-AREA PIC X(200).                     02180002
021900     COPY IQWS001.                                                02190002
022000     COPY IQWS016.                                                02200002
022100***************************************************************** 02210002
022200*    SPECIFIC COMMMAREA FOR DPKCS035.                             02220002
022300*        CURRENT LENGTH IS  040 FOR IQSVEND MNEMONIC.             02230002
022400*        YOU MUST CHECK THE COMMAREA LENGTH FOR THE MNEMONIC      02240002
022500*            IF YOU ADD ANY MORE FIELDS.                          02250002
022600***************************************************************** 02260002
022700                                                                  02270002
022800         10  ASC-SPECIFIC-COMMAREA.                               02280002
022900             15  ASC-VENDOR-ABBREV.                               02290002
023000                 20  ASC-VENDOR-POS1         PIC  X(01).          02300002
023100                 20  ASC-VENDOR-POS2         PIC  X(01).          02310002
023200                 20  ASC-VENDOR-POS3         PIC  X(01).          02320002
023300                 20  ASC-FILLER-01           PIC  X(02).          02330002
023400             15  ASC-UPC-NUMBER              PIC  9(15).          02340002
023500             15  ASC-VS-NBR                  PIC  X(20).          02350002
023600             15  ASC-PRT-QTY                 PIC  X(04).          02360034
023700             15  ASC-PRT-QTY-N REDEFINES ASC-PRT-QTY              02370034
023800                                             PIC  9(04).          02380034
023900             15  ASC-UPC-NO                  PIC  9(13).          02390029
024000             15  ASC-STORE-NUMBER            PIC  9(05).          02400002
024100             15  ASC-UPC-VALID-SW            PIC  X(01).          02410002
024200                 88  ASC-UPC-VALID           VALUE 'Y'.           02420002
024300                 88  ASC-UPC-INVALID         VALUE 'N'.           02430002
024400             15  ASC-UPC-PRT-SIM-SW          PIC  X(01).          02440034
024500                 88  ASC-PRT-UPC             VALUE 'Y'.           02450034
024600                 88  ASC-SIM-UPC             VALUE 'N'.           02460034
024700             15  ASC-PRT-QTY-SW              PIC  X(01).          02470034
024800                 88  ASC-PRT-QTY-VALID       VALUE 'Y'.           02480034
024900                 88  ASC-PRT-QTY-INVALID     VALUE 'N'.           02490034
025000             15  ASC-CLEARANCE-SW            PIC  X(01).          02500029
025100                 88  ASC-CLEARANCE           VALUE 'Y'.           02510029
025200                 88  ASC-NON-CLEARANCE       VALUE 'N'.           02520029
025300             15  ASC-DEPT-NBR-X.                                  02530029
025400                 20  ASC-DEPT-NBR            PIC  9(04).          02540029
025500             15  ASC-MAJOR-CLS-X.                                 02550029
025600                 20  ASC-MAJOR-CLS           PIC  9(04).          02560029
025700             15  ASC-SUB-CLS-X.                                   02570029
025800                 20  ASC-SUB-CLS             PIC  9(04).          02580029
025900             15  ASC-STATUS                  PIC  X(02).          02590029
026000             15  ASC-DIRECT-UPC-NBR          PIC  9(15).          02600029
026100             15  ASC-DIRECT-UPC-NBR-DEF REDEFINES                 02610029
026200                            ASC-DIRECT-UPC-NBR.                   02620029
026300                 20  ASC-DIRECT-UPC-FILLER   PIC  9(02).          02630029
026400                 20  ASC-DIRECT-UPC-01-X.                         02640029
026500                     25  ASC-DIRECT-UPC-01   PIC  9(02).          02650029
026600                 20  ASC-DIRECT-UPC-02-X.                         02660029
026700                     25  ASC-DIRECT-UPC-02   PIC  9(05).          02670029
026800                 20  ASC-DIRECT-UPC-03-X.                         02680029
026900                     25  ASC-DIRECT-UPC-03   PIC  9(05).          02690029
027000                 20  ASC-DIRECT-UPC-04-X.                         02700029
027100                     25  ASC-DIRECT-UPC-04   PIC  9(01).          02710029
027200             15  ASC-SKU-NBR-X.                                   02720029
027300                 20  ASC-SKU-NBR             PIC  9(08).          02730029
027400         10  ASC-FILLER-02                   PIC  X(2762).        02740029
027500                                                                  02750029
027600*----------------------------------------------------------------*02760029
027700*    ABEND PROCESSING COPYBOOK.                                  *02770029
027800*----------------------------------------------------------------*02780029
027900                                                                  02790029
028000     COPY DPWS013.                                                02800029
028100                                                                  02810029
028200     COPY DPWS040I.                                               02820029
028300*---------------------------------------------------------------* 02830029
028400*    DB2 AREA                                                   * 02840029
028600*        XST00010 - XST_SKU                                     * 02860029
028800*        XST00012 - XST_UPC                                     * 02880029
029000*        XST00013 - XST_VND_STYL                                * 02900032
029000*        XST00014 - XST_SUB_CL                                  * 02901032
029100*        XST00015 - XST_DEPT                                    * 02910029
029200*---------------------------------------------------------------* 02920029
029600                                                                  02960029
029700     EXEC SQL                                                     02970029
029800          INCLUDE XST00010                                        02980029
029900     END-EXEC.                                                    02990029
030000                                                                  03000029
030500     EXEC SQL                                                     03050029
030600          INCLUDE XST00012                                        03060029
030700     END-EXEC.                                                    03070029
030800                                                                  03080029
030500     EXEC SQL                                                     03090032
030600          INCLUDE XST00013                                        03100032
030700     END-EXEC.                                                    03110032
030800                                                                  03120032
031300     EXEC SQL                                                     03130029
031400          INCLUDE XST00014                                        03140029
031500     END-EXEC.                                                    03150029
031600                                                                  03160029
031700     EXEC SQL                                                     03170029
031800          INCLUDE XST00015                                        03180029
031900     END-EXEC.                                                    03190029
032000*---------------------------------------------------------------* 03200029
032100*    DB2 AREA FOR TSK                                             03210029
032200*---------------------------------------------------------------* 03220029
032300     EXEC SQL                                                     03230029
032400          INCLUDE TSK                                             03240029
032500     END-EXEC.                                                    03250029
032600*---------------------------------------------------------------* 03260029
032700*    DB2 AREA FOR TUPCSKU                                         03270029
032800*---------------------------------------------------------------* 03280029
032900     EXEC SQL                                                     03290029
033000          INCLUDE TUPCSKU                                         03300029
033100     END-EXEC.                                                    03310029
033800*---------------------------------------------------------------* 03380029
033900*    DB2 AREA FOR COMMUNICATIONS                                * 03390029
034000*---------------------------------------------------------------* 03400029
034100     EXEC SQL                                                     03410029
034200          INCLUDE SQLCA                                           03420029
034300     END-EXEC.                                                    03430029
034400                                                                  03440029
034500 EJECT                                                            03450029
034600 LINKAGE SECTION.                                                 03460029
034700                                                                  03470029
034800 01  DFHCOMMAREA.                                                 03480029
034900     05  FILLER                         OCCURS  1 TO 4072 TIMES   03490029
035000                                        DEPENDING ON EIBCALEN.    03500029
035100         10  FILLER                     PIC X.                    03510029
035200                                                                  03520029
035300                                                                  03530029
035400 PROCEDURE DIVISION.                                              03540029
035500***************************************************************** 03550029
035600** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03560029
035700** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03570029
035800** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03580029
035900**                                                             ** 03590029
036000** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03600029
036100** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03610029
036200***************************************************************** 03620029
036300 0000-MAIN-MODULE.                                                03630029
036400     INITIALIZE DP030-CICS-API-FIELDS.                            03640029
036500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03650029
036600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03660029
036700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03670029
036800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03680029
036900                                                                  03690029
037000     MOVE LENGTH OF IQ401AI        TO DP030-MAP-LENGTH (1).       03700029
037100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03710029
037200     PERFORM 0001-CALL-CICS-ARCH-API.                             03720029
037300*                                                                 03730029
037400     PERFORM 1000-CONTROL-PROCESSING                              03740029
037500*                                                                 03750029
037600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03760029
037700     PERFORM 0001-CALL-CICS-ARCH-API.                             03770029
037800                                                                  03780029
037900 0001-CALL-CICS-ARCH-API.                                         03790029
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03800042
038100                                    DFHCOMMAREA                   03810042
038200                                    DP030-CICS-API-FIELDS         03820042
038300                                    DP020-STANDARD-COMMAREA       03830042
038400                                    IQ401AI.                      03840042
038500*                                                                 03850029
038600     IF  DP030-RC-CALL-SUCCESSFUL                                 03860029
038700         CONTINUE                                                 03870029
038800     ELSE                                                         03880029
038900         SET DP013-NO-ROLLBACK                                    03890029
039000             DP013-XCTL-DISPLAY-RESTART                           03900029
039100             DP013-CICS-ABEND      TO TRUE                        03910029
039200         MOVE 'BEFORE 0000-MAIN-MODULE'                           03920029
039300                                   TO DP013-PARAGRAPH             03930029
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03931042
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03932042
039600         MOVE DP030-RETURN-CODE                                   03960029
039700                                   TO DP013-MESSAGE-TEXT (3)      03970029
039800         PERFORM DP013-0000-PROCESS-ABEND                         03980029
039900     END-IF.                                                      03990029
040000 EJECT                                                            04000029
040100*----------------------------------------------------------------*04010029
040200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04020029
040300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04030029
040400*----------------------------------------------------------------*04040029
040500                                                                  04050029
040600 1000-CONTROL-PROCESSING.                                         04060029
040700                                                                  04070029
040800     EVALUATE TRUE                                                04080029
040900         WHEN DP020-NEXT-ACT-INITIAL                              04090029
041000             INITIALIZE ASC-SPECIFIC-COMMAREA                     04100029
041100             PERFORM 4000-BUILD-INITIAL-PANEL                     04110029
041200                                                                  04120029
041300         WHEN DP020-NEXT-ACT-READ-MAP                             04130029
041400             PERFORM 2000-FKEY-PROCESSING                         04140029
041500                                                                  04150029
041600         WHEN DP020-NEXT-ACT-RETURN                               04160029
041700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04170029
041800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04180029
041900                                                                  04190029
042000         WHEN OTHER                                               04200029
042100             SET DP013-LOGIC-ABEND                                04210029
042200                 DP013-NO-ROLLBACK TO TRUE                        04220029
042300             MOVE '1000-CONTROL-PROCESSING'                       04230029
042400                                   TO  DP013-PARAGRAPH            04240029
042500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04250029
042600                                   TO  DP013-MESSAGE-TEXT(1)      04260029
042700             MOVE DP020-NEXT-APPL-ACTIVITY                        04270029
042800                                   TO DP013-MESSAGE-TEXT(2)       04280029
042900             PERFORM DP013-0000-PROCESS-ABEND                     04290029
043000     END-EVALUATE.                                                04300029
043100                                                                  04310029
043200*----------------------------------------------------------------*04320029
043300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04330029
043400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04340029
043500* EDITS.                                                         *04350029
043600*----------------------------------------------------------------*04360029
043700                                                                  04370029
043800 2000-FKEY-PROCESSING.                                            04380029
043900                                                                  04390029
044000     EVALUATE TRUE                                                04400029
044100                                                                  04410029
044200         WHEN DP020-SRC-AID = DP016-CLEAR                         04420029
044300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04430029
044400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04440029
044500                                                                  04450029
044600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04460029
044700             INITIALIZE ASC-SPECIFIC-COMMAREA                     04470029
044800             PERFORM 4000-BUILD-INITIAL-PANEL                     04480029
044900             PERFORM 3200-RESET-ATTRIBUTES                        04490029
045000                                                                  04500029
045100         WHEN OTHER                                               04510029
045200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04520029
045300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04530029
045400             IF  PS-NO-ERROR                                      04540002
045500                 SET DP030-CONTINUE-GO TO TRUE                    04550002
045600                 PERFORM 2100-CHECK-FUNCTION-KEY                  04560002
045700             ELSE                                                 04570002
045800                 SET DP030-OVERRIDE-GO TO TRUE                    04580002
045900             END-IF                                               04590002
046000     END-EVALUATE.                                                04600002
046100                                                                  04610002
046200******************************************************************04620002
046300** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **04630002
046400** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **04640002
046500** FROM THE CICS ARCHITECTURE API.                              **04650002
046600******************************************************************04660002
046700                                                                  04670002
046800 2100-CHECK-FUNCTION-KEY.                                         04680002
046900                                                                  04690002
047000     EVALUATE TRUE                                                04700002
047100*    LOCAL-01   F19  VEND LST   IQLVEND  IQKCS402                 04710029
047200*    EDIT CHECK: FIRST ONE, MAXIMUM FIVE CHARACTERS, REQUIRED     04720002
047300*    EDIT CHECK: CHARACTER, SPACE, CHARACTER IS VALID; E.G.'A T'  04730002
047400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04740002
047500              SET PS-LBL-NO-ERROR TO TRUE                         04750002
047600            IF ((ASC-VS-NBR = SPACES)                             04760002
047800               AND (ASUPC01I NOT > SPACES))                       04780002
047900              EVALUATE TRUE                                       04790002
048000                  WHEN ASC-VENDOR-POS1 = SPACE                    04800002
048100                       SET PS-LBL-ERROR TO TRUE                   04810002
048200                                                                  04820002
048300                  WHEN OTHER                                      04830002
048400                       CONTINUE                                   04840002
048500                                                                  04850002
048600              END-EVALUATE                                        04860002
048700                                                                  04870002
048800              IF PS-LBL-ERROR                                     04880002
048900                 SET PS-LBL-NO-ERROR TO TRUE                      04890002
049000                 SET PS-ERROR                                     04900002
049100                     DP020-MSG-FATAL                              04910002
049200                     DP030-OVERRIDE-GO TO TRUE                    04920002
049300*----PC-TSYMSG-00005 - INVALID VALUE                              04930002
049400                 MOVE PC-TSYMSG-00005     TO DP020-MSG-NUMBER     04940002
049500                 MOVE DP015-UNP-ALP-BRT-OFF                       04950002
049600                                          TO AVENDORA             04960002
049700                 MOVE DP015-RED           TO AVENDORC             04970002
049800                 MOVE DP015-REVERSE       TO AVENDORH             04980002
049900                 MOVE -1                  TO AVENDORL             04990002
050000                 SET DP030-SET-CURSOR-APPL-1  TO TRUE             05000002
050100              ELSE                                                05010002
050200                 INITIALIZE IQ016-INTER-APPL-COMMAREA             05020029
050300                 MOVE ASC-VENDOR-ABBREV TO AVENDORO               05030002
050400              END-IF                                              05040002
050500            ELSE                                                  05050002
050600                SET PS-ERROR                                      05060002
050700                    DP020-MSG-FATAL                               05070002
050800                    DP030-OVERRIDE-GO TO TRUE                     05080002
050900*----PC-TSYMSG-03105 - INVALID VALUE                              05090002
051000                MOVE PC-TSYMSG-03105     TO DP020-MSG-NUMBER      05100002
051100                MOVE DP015-UNP-ALP-BRT-OFF                        05110002
051200                                         TO ASTYLEA               05120002
051700                                            ASUPC01A              05170002
051800                                            ASUPC02A              05180002
051900                                            ASUPC03A              05190002
052000                                            ASUPC04A              05200002
052100                MOVE DP015-RED           TO ASTYLEC               05210002
052600                                            ASUPC01C              05260002
052700                                            ASUPC02C              05270002
052800                                            ASUPC03C              05280002
052900                                            ASUPC04C              05290002
053000                MOVE DP015-REVERSE       TO ASTYLEH               05300002
053500                                            ASUPC01H              05350002
053600                                            ASUPC02H              05360002
053700                                            ASUPC03H              05370002
053800                                            ASUPC04H              05380002
054000                SET DP030-SET-CURSOR-APPL-1  TO TRUE              05400002
054100             END-IF                                               05410002
054200                                                                  05420002
054300              IF PS-NO-ERROR                                      05430002
054400                 MOVE -1                   TO AVENDORL            05440002
054500                 SET DP030-SET-CURSOR-APPL-1                      05450002
054600                                            TO TRUE               05460002
054700              END-IF                                              05470002
054800                                                                  05480002
054900              PERFORM 2110-PREPARE-INTER-APPL-COMM                05490002
055000                                                                  05500002
055100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              05510002
055200***          IQLBUSGP - IQKCS403 - F20                            05520002
055300***                     LIST ALL BUSINESS GROUPS                  05530029
055400             IF (ASC-VENDOR-ABBREV = SPACES                       05540002
055500                AND ASC-VS-NBR = SPACES)                          05550002
055600                INITIALIZE IQ016-INTER-APPL-COMMAREA              05560002
055700             ELSE                                                 05570002
055800                SET PS-ERROR                                      05580002
055900                    DP020-MSG-FATAL                               05590002
056000                    DP030-OVERRIDE-GO TO TRUE                     05600002
056100*----PC-TSYMSG-03105 - INVALID VALUE                              05610002
056200                MOVE PC-TSYMSG-03105     TO DP020-MSG-NUMBER      05620002
056300                MOVE DP015-UNP-ALP-BRT-OFF                        05630002
056400                                         TO AVENDORA              05640002
056500                                            ASTYLEA               05650002
056600                MOVE DP015-RED           TO AVENDORC              05660002
056700                                            ASTYLEC               05670002
056800                MOVE DP015-REVERSE       TO AVENDORH              05680002
056900                                            ASTYLEH               05690002
057000                MOVE -1                  TO ASTYLEL               05700002
057100                SET DP030-SET-CURSOR-APPL-1  TO TRUE              05710002
057200             END-IF                                               05720002
057300                                                                  05730002
057400         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              05740002
057500***           IQLSKU   - IQKCS408 - F17                           05750002
057600***                      LIST SKUS FOR VENDOR STYLE               05760029
057700            IF ((ASC-VENDOR-ABBREV = SPACES)                      05770002
057900                 AND (ASUPC01I NOT > SPACES))                     05790002
058000              IF ASC-VS-NBR = SPACES                              05800002
058100                 SET PS-ERROR                                     05810002
058200                     DP020-MSG-FATAL                              05820002
058300                     DP030-OVERRIDE-GO TO TRUE                    05830002
058400*----PC-TSYMSG-00007 - REQUIRED ENTRY                             05840002
058500                 MOVE PC-TSYMSG-00007     TO DP020-MSG-NUMBER     05850002
058600                 MOVE DP015-UNP-ALP-BRT-OFF                       05860002
058700                                          TO ASTYLEA              05870002
058800                 MOVE DP015-RED           TO ASTYLEC              05880002
058900                 MOVE DP015-REVERSE       TO ASTYLEH              05890002
059000                 MOVE -1                  TO ASTYLEL              05900002
059100                 SET DP030-SET-CURSOR-APPL-1  TO TRUE             05910002
059200              ELSE                                                05920002
059300                 INITIALIZE IQ016-INTER-APPL-COMMAREA             05930002
059400                 MOVE ASC-VS-NBR TO IQ016-VS-NBR                  05940002
059500              END-IF                                              05950002
059600            ELSE                                                  05960002
059700                SET PS-ERROR                                      05970002
059800                    DP020-MSG-FATAL                               05980002
059900                    DP030-OVERRIDE-GO TO TRUE                     05990002
060000*----PC-TSYMSG-03105 - INVALID VALUE                              06000002
060100                MOVE PC-TSYMSG-03105     TO DP020-MSG-NUMBER      06010002
060200                MOVE DP015-UNP-ALP-BRT-OFF                        06020002
060300                                         TO AVENDORA              06030002
060800                                            ASUPC01A              06080002
060900                                            ASUPC02A              06090002
061000                                            ASUPC03A              06100002
061100                                            ASUPC04A              06110002
061200                MOVE DP015-RED           TO AVENDORC              06120002
061700                                            ASUPC01C              06170002
061800                                            ASUPC02C              06180002
061900                                            ASUPC03C              06190002
062000                                            ASUPC04C              06200002
062100                MOVE DP015-REVERSE       TO AVENDORH              06210002
062600                                            ASUPC01H              06260002
062700                                            ASUPC02H              06270002
062800                                            ASUPC03H              06280002
062900                                            ASUPC04H              06290002
063100                SET DP030-SET-CURSOR-APPL-1  TO TRUE              06310002
063200             END-IF                                               06320002
063300                                                                  06330002
063400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06340002
063500**           IQLSKU   - IQKCS408 - F21                            06350002
063600**                      SIMILAR UPC LIST                          06360029
063700             IF (ASC-VENDOR-ABBREV = SPACES                       06370002
063800                AND ASC-VS-NBR = SPACES)                          06380002
063900                 PERFORM 2400-VALIDATE-UPC                        06390002
064000             ELSE                                                 06400002
064100                SET PS-ERROR                                      06410002
064200                    DP020-MSG-FATAL                               06420002
064300                    DP030-OVERRIDE-GO TO TRUE                     06430002
064400*----PC-TSYMSG-03105 - INVALID VALUE                              06440002
064500                MOVE PC-TSYMSG-03105     TO DP020-MSG-NUMBER      06450002
064600                MOVE DP015-UNP-ALP-BRT-OFF                        06460002
064700                                         TO AVENDORA              06470002
064800                                            ASTYLEA               06480002
064900                MOVE DP015-RED           TO AVENDORC              06490002
065000                                            ASTYLEC               06500002
065100                MOVE DP015-REVERSE       TO AVENDORH              06510002
065200                                            ASTYLEH               06520002
065300                MOVE -1                  TO ASTYLEL               06530002
065400                SET DP030-SET-CURSOR-APPL-1  TO TRUE              06540002
065500             END-IF                                               06550002
065600                                                                  06560002
072100         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              07210029
072200**           IQLSKU   - IQKCS408 - F22                            07220029
072300**                      LIST ALL UPCS FOR DEPT AND                07230029
072400**                               (MAJOR OR SUB) CLASS             07240029
072500             INITIALIZE IQ016-INTER-APPL-COMMAREA                 07250029
072600             MOVE ASC-DEPT-NBR  TO IQ016-DEPT-NBR                 07260029
072700             MOVE ASC-MAJOR-CLS TO IQ016-MAJ-CL                   07270029
072800             MOVE ASC-SUB-CLS   TO IQ016-SUB-CL                   07280029
072900             MOVE ASC-STATUS    TO IQ016-STATUS                   07290029
073000             MOVE DP020-LOCATION-NBR TO IQ016-STORE-NO            07300029
073100                                                                  07310029
073200         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              07320029
073300**           IQISKUST - IQKCS414 - F23                            07330029
073400**                      SHOW UPC INFORMATION                      07340029
073500             INITIALIZE IQ016-INTER-APPL-COMMAREA                 07350029
073600             MOVE ASC-DIRECT-UPC-NBR TO IQ016-UPC-NO              07360029
073700             MOVE DP020-LOCATION-NBR TO IQ016-STORE-NO            07370029
073800             MOVE ASC-SKU-NBR        TO IQ016-SKU-NBR             07380029
073900                                                                  07390029
074000         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              07400029
074100**           IQLONHND - IQKCS416 - F16                            07410029
074200**                      LIST UPCS AND ONHANDS FOR DEPT AND        07420029
074300**                                  (MAJOR OR SUB) CLASS          07430029
074400             INITIALIZE IQ016-INTER-APPL-COMMAREA                 07440029
074500             MOVE ASC-DEPT-NBR  TO IQ016-DEPT-NBR                 07450029
074600             MOVE ASC-MAJOR-CLS TO IQ016-MAJ-CL                   07460029
074700             MOVE ASC-SUB-CLS   TO IQ016-SUB-CL                   07470029
074800             MOVE ASC-STATUS    TO IQ016-STATUS                   07480029
074900             MOVE DP020-LOCATION-NBR TO IQ016-STORE-NO            07490029
075000                                                                  07500029
075100         WHEN DP020-SRC-AID = DP016-ENTER                         07510029
075200              CONTINUE                                            07520029
075300                                                                  07530029
075400         WHEN OTHER                                               07540029
075500             SET DP013-NO-ROLLBACK                                07550029
075600                 DP013-XCTL-DISPLAY-RESTART                       07560029
075700                 DP013-CICS-ABEND  TO TRUE                        07570029
075800             MOVE '2100-CHECK-FUNCTION-KEY'                       07580029
075900                                   TO DP013-PARAGRAPH             07590029
076000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07600029
076100                                   TO DP013-MESSAGE-TEXT (1)      07610029
076200             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 07620029
076300                                   TO DP013-MESSAGE-TEXT (2)      07630029
076400             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                07640029
076500             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 07650029
076600                                   TO PM-A-FK-ACTION              07660029
076700             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              07670029
076800                                   TO PM-A-FK-DISPN               07680029
076900             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      07690029
077000             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        07700029
077100                                   TO DP013-MESSAGE-TEXT (4)      07710029
077200             PERFORM DP013-0000-PROCESS-ABEND                     07720029
077300     END-EVALUATE.                                                07730029
077400******************************************************************07740029
077500** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **07750029
077600** INTER-APPLICATION COMMAREA.                                  **07760029
077700******************************************************************07770029
077800 2110-PREPARE-INTER-APPL-COMM.                                    07780029
077900                                                                  07790029
078000     INITIALIZE IQ001-INTER-APPL-COMMAREA.                        07800029
078100     MOVE ASC-VENDOR-ABBREV        TO IQ001-VENDOR-ABBREV.        07810029
078200                                                                  07820029
091600*----------------------------------------------------------------*09160029
091700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*09170029
091800* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *09180029
091900* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *09190029
092000*----------------------------------------------------------------*09200029
092100                                                                  09210029
092200 2200-MOVE-SCREEN-TO-COMMAREA.                                    09220029
092300                                                                  09230029
092400**   F19 - VENDOR LABEL / NAME LIST                               09240029
092500     IF  AVENDORL > ZERO                                          09250029
092600         MOVE AVENDORI             TO ASC-VENDOR-ABBREV           09260029
092700     ELSE                                                         09270029
092800         IF  AVENDORF = DP015-ERASE-EOF                           09280029
092900             MOVE SPACE            TO ASC-VENDOR-ABBREV           09290029
093000         END-IF                                                   09300029
093100     END-IF.                                                      09310029
093200                                                                  09320029
093300**   F17 - VENDOR STYLE LIST                                      09330029
093400     IF  ASTYLEL > ZERO                                           09340029
093500         MOVE ASTYLEI              TO ASC-VS-NBR                  09350029
093600     ELSE                                                         09360029
093700         IF  ASTYLEF = DP015-ERASE-EOF                            09370029
093800             MOVE SPACE            TO ASC-VS-NBR                  09380029
093900         END-IF                                                   09390029
094000     END-IF.                                                      09400029
094100                                                                  09410029
094200**   F22 - DEPARTMENT, MAJOR AND / OR SUB CLASS LIST              09420029
094300     IF  ADPTNBRL > ZERO                                          09430029
094400         MOVE ADPTNBRI             TO ASC-DEPT-NBR-X              09440029
094500     ELSE                                                         09450029
094600         IF  ADPTNBRF = DP015-ERASE-EOF                           09460029
094700             MOVE SPACE            TO ASC-DEPT-NBR-X              09470029
094800         END-IF                                                   09480029
094900     END-IF.                                                      09490029
095000                                                                  09500029
095100     IF  AMAJCLSL > ZERO                                          09510029
095200         MOVE AMAJCLSI             TO ASC-MAJOR-CLS-X             09520029
095300     ELSE                                                         09530029
095400         IF  AMAJCLSF = DP015-ERASE-EOF                           09540029
095500             MOVE SPACE            TO ASC-MAJOR-CLS-X             09550029
095600         END-IF                                                   09560029
095700     END-IF.                                                      09570029
095800                                                                  09580029
095900     IF  ASUBCLSL > ZERO                                          09590029
096000         MOVE ASUBCLSI             TO ASC-SUB-CLS-X               09600029
096100     ELSE                                                         09610029
096200         IF  ASUBCLSF = DP015-ERASE-EOF                           09620029
096300             MOVE SPACE            TO ASC-SUB-CLS-X               09630029
096400         END-IF                                                   09640029
096500     END-IF.                                                      09650029
096600                                                                  09660029
096700     IF  ASTATUSL > ZERO                                          09670029
096800         MOVE ASTATUSI             TO ASC-STATUS                  09680029
096900     ELSE                                                         09690029
097000         IF  ASTATUSF = DP015-ERASE-EOF                           09700029
097100             MOVE SPACE            TO ASC-STATUS                  09710029
097200         END-IF                                                   09720029
097300     END-IF.                                                      09730029
097400                                                                  09740029
097500**   F23 - DIRECT UPC INQUIRY                                     09750029
097600     IF  ADUPC01L > ZERO                                          09760029
097700         MOVE ADUPC01I             TO ASC-DIRECT-UPC-01-X         09770029
097800     ELSE                                                         09780029
097900         IF  ADUPC01F = DP015-ERASE-EOF                           09790029
098000             MOVE SPACE            TO ASC-DIRECT-UPC-01-X         09800029
098100         END-IF                                                   09810029
098200     END-IF.                                                      09820029
098300                                                                  09830029
098400     IF  ADUPC02L > ZERO                                          09840029
098500         MOVE ADUPC02I             TO ASC-DIRECT-UPC-02-X         09850029
098600     ELSE                                                         09860029
098700         IF  ADUPC02F = DP015-ERASE-EOF                           09870029
098800             MOVE SPACE            TO ASC-DIRECT-UPC-02-X         09880029
098900         END-IF                                                   09890029
099000     END-IF.                                                      09900029
099100                                                                  09910029
099200     IF  ADUPC03L > ZERO                                          09920029
099300         MOVE ADUPC03I             TO ASC-DIRECT-UPC-03-X         09930029
099400     ELSE                                                         09940029
099500         IF  ADUPC03F = DP015-ERASE-EOF                           09950029
099600             MOVE SPACE            TO ASC-DIRECT-UPC-03-X         09960029
099700         END-IF                                                   09970029
099800     END-IF.                                                      09980029
099900                                                                  09990029
100000     IF  ADUPC04L > ZERO                                          10000029
100100         MOVE ADUPC04I             TO ASC-DIRECT-UPC-04-X         10010029
100200     ELSE                                                         10020029
100300         IF  ADUPC04F = DP015-ERASE-EOF                           10030029
100400             MOVE SPACE            TO ASC-DIRECT-UPC-04-X         10040029
100500         END-IF                                                   10050029
100600     END-IF.                                                      10060029
100700                                                                  10070029
100800     IF  ASKUNBRL > ZERO                                          10080029
100900         MOVE ASKUNBRI             TO ASC-SKU-NBR-X               10090029
101000     ELSE                                                         10100029
101100         IF  ASKUNBRF = DP015-ERASE-EOF                           10110029
101200             MOVE SPACE            TO ASC-SKU-NBR-X               10120029
101300         END-IF                                                   10130029
101400     END-IF.                                                      10140029
101500                                                                  10150029
101600*----------------------------------------------------------------*10160029
101700*    UPC NUMBER ENTERED FOR F21 MUST BE NUMERIC AND IT MUST      *10170029
101800*    HAVE A VALID CHECK DIGIT.                                   *10180029
101900*----------------------------------------------------------------*10190029
102000                                                                  10200029
102100 2400-VALIDATE-UPC.                                               10210029
102200                                                                  10220029
102300     SET ASC-UPC-VALID     TO TRUE.                               10230034
102500                                                                  10250029
106800     IF ((ASUPC01L > 0) AND (ASUPC01I > SPACES))                  10680041
106900         STRING ASUPC01I                                          10690041
107000                ASUPC02I                                          10700041
107100                ASUPC03I                                          10710041
107200                ASUPC04I                                          10720041
107300                DELIMITED BY SIZE                                 10730041
107400                INTO ASC-UPC-NO                                   10740041
107500         SET ASC-SIM-UPC TO TRUE                                  10750041
107600         PERFORM 2500-NUMERIC-EDIT                                10760041
107700     ELSE                                                         10770041
107800         SET ASC-UPC-INVALID                                      10780041
107900             DP020-MSG-FATAL                                      10790041
108000             DP030-OVERRIDE-GO TO TRUE                            10800041
108100         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                10810041
109800         MOVE DP015-UNP-ALP-BRT-MDT                               10980041
109900                               TO  ASUPC01A                       10990041
110000                                   ASUPC02A                       11000041
110100                                   ASUPC03A                       11010041
110200                                   ASUPC04A                       11020041
110300         MOVE DP015-RED        TO  ASUPC01C                       11030041
110400                                   ASUPC02C                       11040041
110500                                   ASUPC03C                       11050041
110600                                   ASUPC04C                       11060041
110700         MOVE DP015-REVERSE    TO  ASUPC01H                       11070041
110800                                   ASUPC02H                       11080041
110900                                   ASUPC03H                       11090041
111000                                   ASUPC04H                       11100041
111100         MOVE -1               TO ASUPC01L                        11110041
111300         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    11130041
111500     END-IF.                                                      11150041
111600                                                                  11160029
113100     IF ASC-UPC-VALID                                             11310029
113200        PERFORM 2450-VALIDATE-CHECK-DIGIT                         11320029
113300        MOVE ASC-UPC-NO        TO IQ016-UPC-NO                    11330029
113400                                  ASC-UPC-NUMBER                  11340029
113500                                                                  11350029
113600        IF PS-CHECK-DIGIT-VALID                                   11360029
113700           INITIALIZE IQ016-INTER-APPL-COMMAREA                   11370029
114000           MOVE PV-UPC-NO-PIC9 TO IQ016-UPC-NO                    11400029
114100                                  ASC-UPC-NUMBER                  11410029
114200        END-IF                                                    11420029
114300     END-IF.                                                      11430029
114400                                                                  11440029
114500     IF (ASC-UPC-VALID                                            11450029
114700        AND PS-CHECK-DIGIT-VALID)                                 11470029
114800        SET PS-NO-ERROR TO TRUE                                   11480029
114900     ELSE                                                         11490029
115000        SET PS-ERROR TO TRUE                                      11500029
115100     END-IF.                                                      11510029
115200                                                                  11520029
115300*----------------------------------------------------------------*11530029
115400*    ROUTINE USED TO VALIDATE THE CHECK DIGIT ENTERED.           *11540029
115500*----------------------------------------------------------------*11550029
115600                                                                  11560029
115700 2450-VALIDATE-CHECK-DIGIT.                                       11570029
115800                                                                  11580029
115900     INITIALIZE DP040I-UPC-CHECK-DIGIT-PARMS.                     11590029
116000     SET DP040I-COMP-CHECK-DIGIT-OPTION TO TRUE.                  11600029
116100                                                                  11610029
116200     MOVE PV-UPC-NO-PIC9 TO DP040I-UPC-CODE.                      11620029
116300                                                                  11630029
116400     CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          11640044
116400                     USING DP040I-UPC-CHECK-DIGIT-PARMS.          11641044
116500                                                                  11650029
116600     IF DP040I-COMPUTED-UPC-CHK-DIGIT = DP040I-UPC-CHECK-DIGIT    11660029
116700        SET PS-CHECK-DIGIT-VALID   TO TRUE                        11670029
116800     ELSE                                                         11680029
116900        SET PS-CHECK-DIGIT-INVALID TO TRUE                        11690029
117000        SET PS-ERROR                                              11700029
117100            DP020-MSG-FATAL                                       11710029
117200            DP030-OVERRIDE-GO TO TRUE                             11720029
118100        MOVE DP015-UNP-ALP-BRT-OFF TO ASUPC04A                    11810041
118200        MOVE DP015-RED           TO ASUPC04C                      11820041
118300        MOVE DP015-REVERSE       TO ASUPC04H                      11830041
118400        MOVE -1                  TO ASUPC04L                      11840041
118500        SET DP030-SET-CURSOR-APPL-1                               11850041
118600                                 TO TRUE                          11860041
118800        MOVE DP040I-COMPUTED-UPC-CHK-DIGIT TO DP020-MSG-TEXT      11880029
118900        MOVE PC-TSYMSG-00414               TO DP020-MSG-NUMBER    11890036
116800     END-IF.                                                      11891036
119000                                                                  11900029
119100*----------------------------------------------------------------*11910029
119200*    CALL TO NUMERIC EDIT ROUTING - DPKUT100                      11920029
119300*----------------------------------------------------------------*11930029
119400                                                                  11940029
119500 2500-NUMERIC-EDIT.                                               11950029
119600     IF  ASC-UPC-NO > SPACE                                       11960029
119700         MOVE ASC-UPC-NO    TO DP010I-UNEDITED-FIELD              11970029
119800         MOVE 13            TO DP010I-MAXIMUM-DIGITS              11980029
119900         MOVE  ZERO         TO DP010I-MAXIMUM-DECIMALS            11990029
120000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12000029
120100         SET DP010I-17-DIG-0-DEC-FORMAT  TO TRUE                  12010029
120210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12021030
120220                         USING DP010I-NUMERIC-EDIT-AREA           12022030
120300         IF  DP010I-ERROR-DETECTED                                12030029
120400             SET ASC-UPC-INVALID  TO TRUE                         12040029
120500             SET DP020-MSG-FATAL TO TRUE                          12050029
120600             IF ASC-SIM-UPC                                       12060036
120700                MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER         12070029
120800                MOVE DP015-UNP-ALP-BRT-MDT TO ASUPC01A            12080029
120900                                              ASUPC02A            12090029
121000                                              ASUPC03A            12100029
121100                                              ASUPC04A            12110029
121200                MOVE DP015-RED             TO ASUPC01C            12120029
121300                                              ASUPC02C            12130029
121400                                              ASUPC03C            12140029
121500                                              ASUPC04C            12150029
121600                MOVE DP015-REVERSE         TO ASUPC01H            12160029
121700                                              ASUPC02H            12170029
121800                                              ASUPC03H            12180029
121900                                              ASUPC04H            12190029
122000                MOVE -1                    TO ASUPC01L            12200029
122100                SET DP030-SET-CURSOR-APPL-1                       12210029
122200                    DP030-OVERRIDE-GO       TO TRUE               12220029
124000             END-IF                                               12400036
124100         ELSE                                                     12410029
124200             MOVE DP010I-NUM-FIELD-13-DIG-4-DEC                   12420029
124300                                         TO PV-UPC-NO-PIC9        12430029
124400                                            ASC-UPC-NO            12440029
124500             SET DP030-SET-CURSOR-APPL-1                          12450029
124600                                         TO TRUE                  12460029
124700         END-IF                                                   12470029
124800     ELSE                                                         12480029
124900         SET ASC-UPC-INVALID             TO TRUE                  12490029
125000     END-IF.                                                      12500029
125100                                                                  12510029
128420*----------------------------------------------------------------*12842029
128500* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *12850029
128600* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *12860029
128700* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*12870029
128800* IN THE DESTINATION PROGRAM, NOT HERE.                          *12880029
128900*----------------------------------------------------------------*12890029
129000                                                                  12900029
129100 3000-EDIT-DATA-IN-COMMAREA.                                      12910029
129200     PERFORM 3200-RESET-ATTRIBUTES.                               12920029
129300                                                                  12930029
129400     EVALUATE TRUE                                                12940029
129500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12950029
129600**  F19  VENDOR LIST - IQLVEND  - IQKCS402 - FORMAT CODE IS SPACE 12960029
129700              CONTINUE                                            12970029
129800                                                                  12980029
129900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12990029
130000**  F20  BUSINESS GRP - IQLBUSGP - IQLCS403 - FORMAT CODE SPACE   13000029
130100              CONTINUE                                            13010029
130200                                                                  13020029
130300         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              13030029
130400**  F21  SIMILAR UPC - IQLSKU - IQKCS408 - FORMAT CODE IS '4'     13040029
130500              CONTINUE                                            13050029
130600                                                                  13060029
130700         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              13070029
130800**  F17  UPC LIST - IQLSKU - IQLCS408 - FORMAT CODE IS '6'        13080029
130900              CONTINUE                                            13090029
131000                                                                  13100029
131100*        WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              13110035
131200**  F18  PRINT LABEL                                              13120029
131300*             CONTINUE                                            13130035
131400                                                                  13140029
131500         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              13150029
131600         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              13160029
131700**  F22 OR F16  DEPT AND MAJOR AND / OR SUB CLASS                 13170029
131800**            DEPARTMENT AND EITHER MAJOR OR SUB CLASS IS REQUIRED13180029
131900              PERFORM 3110-VALIDATE-DEPARTMENT                    13190029
132000                                                                  13200029
132100              IF PS-NO-ERROR                                      13210029
132200                 PERFORM 3140-VALIDATE-MAJOR-CLASS                13220029
132300              END-IF                                              13230029
132400                                                                  13240029
132500              IF PS-NO-ERROR                                      13250029
132600                 PERFORM 3170-VALIDATE-SUB-CLASS                  13260029
132700              END-IF                                              13270029
132800                                                                  13280029
132900              IF PS-NO-ERROR                                      13290029
133000                 IF (ASC-MAJOR-CLS-X = SPACES OR                  13300029
133100                     ASC-MAJOR-CLS-X = ZEROS) AND                 13310029
133200                    (ASC-SUB-CLS-X = SPACES OR                    13320029
133300                     ASC-SUB-CLS-X = ZEROS)                       13330029
133400                     MOVE PC-TSYMSG-00308  TO DP020-MSG-NUMBER    13340029
133500                     PERFORM 3190-SUB-CLASS-ERROR                 13350029
133600                     PERFORM 3160-MAJOR-CLASS-ERROR               13360029
133700                 END-IF                                           13370029
133800              END-IF                                              13380029
133900                                                                  13390029
134000         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              13400029
134100**  F23  DIRECT UPC INQUIRY                                       13410029
134200              PERFORM 3030-VALIDATE-DIRECT-UPC                    13420029
134300                                                                  13430029
134400     END-EVALUATE.                                                13440029
134500                                                                  13450029
134600****************************************************************  13460029
134700*                                                              *  13470029
134800*                                                              *  13480029
134900****************************************************************  13490029
135000 3030-VALIDATE-DIRECT-UPC.                                        13500029
135100                                                                  13510029
135200     MOVE 0 TO ASC-DIRECT-UPC-FILLER.                             13520029
135300     MOVE ASC-DIRECT-UPC-01-X  TO DP010I-UNEDITED-FIELD.          13530029
135400     MOVE 2                    TO DP010I-MAXIMUM-DIGITS.          13540029
135500     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        13550029
135600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     13560029
135700                                                                  13570029
135810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             13581030
135820                         USING DP010I-NUMERIC-EDIT-AREA           13582030
135900                                                                  13590029
136000     IF DP010I-ERROR-DETECTED                                     13600029
136100        MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                 13610029
136200        MOVE DP015-UNP-ALP-BRT-MDT                                13620029
136300                              TO ADUPC01A                         13630029
136400                                 ADUPC02A                         13640029
136500                                 ADUPC03A                         13650029
136600                                 ADUPC04A                         13660029
136700        MOVE DP015-RED        TO ADUPC01C                         13670029
136800        MOVE DP015-REVERSE    TO ADUPC01H                         13680029
136900        MOVE -1               TO ADUPC01L                         13690029
137000        SET PS-ERROR                                              13700029
137100            DP020-MSG-FATAL   TO TRUE                             13710029
137200        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       13720029
137300     ELSE                                                         13730029
137400        MOVE DP010I-NUMERIC-FIELD                                 13740029
137500                              TO ASC-DIRECT-UPC-01                13750029
137600        MOVE ASC-DIRECT-UPC-01  TO ADUPC01O                       13760029
137700                                                                  13770029
137800     END-IF.                                                      13780029
137900                                                                  13790029
138000     IF PS-NO-ERROR                                               13800029
138100        MOVE ASC-DIRECT-UPC-02-X  TO DP010I-UNEDITED-FIELD        13810029
138200        MOVE 5                    TO DP010I-MAXIMUM-DIGITS        13820029
138300        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      13830029
138400        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   13840029
138510        CALL DP010I-NUMERIC-EDIT-ROUTINE                          13851030
138520                         USING DP010I-NUMERIC-EDIT-AREA           13852030
138600        IF DP010I-ERROR-DETECTED                                  13860029
138700           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              13870029
138800           MOVE DP015-UNP-ALP-BRT-MDT                             13880029
138900                                 TO ADUPC01A                      13890029
139000                                    ADUPC02A                      13900029
139100                                    ADUPC03A                      13910029
139200                                    ADUPC04A                      13920029
139300           MOVE DP015-RED        TO ADUPC02C                      13930029
139400           MOVE DP015-REVERSE    TO ADUPC02H                      13940029
139500           MOVE -1               TO ADUPC02L                      13950029
139600           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    13960029
139700           SET PS-ERROR                                           13970029
139800               DP020-MSG-FATAL   TO TRUE                          13980029
139900        ELSE                                                      13990029
140000           MOVE DP010I-NUMERIC-FIELD                              14000029
140100                                 TO ASC-DIRECT-UPC-02             14010029
140200           MOVE ASC-DIRECT-UPC-02  TO ADUPC02O                    14020029
140300                                                                  14030029
140400        END-IF.                                                   14040029
140500                                                                  14050029
140600     IF PS-NO-ERROR                                               14060029
140700        MOVE ASC-DIRECT-UPC-03-X  TO DP010I-UNEDITED-FIELD        14070029
140800        MOVE 5                    TO DP010I-MAXIMUM-DIGITS        14080029
140900        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      14090029
141000        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   14100029
141110        CALL DP010I-NUMERIC-EDIT-ROUTINE                          14111030
141120                         USING DP010I-NUMERIC-EDIT-AREA           14112030
141200        IF DP010I-ERROR-DETECTED                                  14120029
141300           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              14130029
141400           MOVE DP015-UNP-ALP-BRT-MDT                             14140029
141500                                 TO ADUPC01A                      14150029
141600                                    ADUPC02A                      14160029
141700                                    ADUPC03A                      14170029
141800                                    ADUPC04A                      14180029
141900           MOVE DP015-RED        TO ADUPC03C                      14190029
142000           MOVE DP015-REVERSE    TO ADUPC03H                      14200029
142100           MOVE -1               TO ADUPC03L                      14210029
142200           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    14220029
142300           SET PS-ERROR                                           14230029
142400               DP020-MSG-FATAL   TO TRUE                          14240029
142500        ELSE                                                      14250029
142600           MOVE DP010I-NUMERIC-FIELD                              14260029
142700                                 TO ASC-DIRECT-UPC-03             14270029
142800           MOVE ASC-DIRECT-UPC-03  TO ADUPC03O                    14280029
142900                                                                  14290029
143000        END-IF.                                                   14300029
143100                                                                  14310029
143200     IF PS-NO-ERROR                                               14320029
143300        MOVE ASC-DIRECT-UPC-04-X  TO DP010I-UNEDITED-FIELD        14330029
143400        MOVE 1                    TO DP010I-MAXIMUM-DIGITS        14340029
143500        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      14350029
143600        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   14360029
143710        CALL DP010I-NUMERIC-EDIT-ROUTINE                          14371030
143720                         USING DP010I-NUMERIC-EDIT-AREA           14372030
143800        IF DP010I-ERROR-DETECTED                                  14380029
143900           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              14390029
144000           MOVE DP015-UNP-ALP-BRT-MDT                             14400029
144100                                 TO ADUPC01A                      14410029
144200                                    ADUPC02A                      14420029
144300                                    ADUPC03A                      14430029
144400                                    ADUPC04A                      14440029
144500           MOVE DP015-RED        TO ADUPC04C                      14450029
144600           MOVE DP015-REVERSE    TO ADUPC04H                      14460029
144700           MOVE -1               TO ADUPC04L                      14470029
144800           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    14480029
144900           SET PS-ERROR                                           14490029
145000               DP020-MSG-FATAL   TO TRUE                          14500029
145100        ELSE                                                      14510029
145200           MOVE DP010I-NUMERIC-FIELD                              14520029
145300                                 TO ASC-DIRECT-UPC-04             14530029
145400           MOVE ASC-DIRECT-UPC-04  TO ADUPC04O                    14540029
145500                                                                  14550029
145600        END-IF.                                                   14560029
145700                                                                  14570029
145800      MOVE ASC-DIRECT-UPC-NBR       TO DK-UPC-NBR.                14580029
145900      IF  ASC-DIRECT-UPC-NBR > ZEROS AND                          14590029
146000                             ASC-DIRECT-UPC-NBR IS NUMERIC        14600029
146100             PERFORM 4700-SELECT-UPC                              14610029
146200         IF  ASC-DIRECT-UPC-NBR > ZEROS AND PS-UPC-FOUND          14620029
146300             NEXT SENTENCE                                        14630029
146400          ELSE                                                    14640029
146500           IF ASC-DIRECT-UPC-NBR > ZEROS AND PS-UPC-NOT-FOUND     14650029
146600              MOVE ASC-DIRECT-UPC-01     TO ADUPC01O              14660029
146700              MOVE ASC-DIRECT-UPC-02     TO ADUPC02O              14670029
146800              MOVE ASC-DIRECT-UPC-03     TO ADUPC03O              14680029
146900              MOVE ASC-DIRECT-UPC-04     TO ADUPC04O              14690029
147000              MOVE PC-TSYMSG-00100  TO DP020-MSG-NUMBER           14700029
147100              PERFORM 4900-UPC-ERROR                              14710029
147200           END-IF                                                 14720029
147300         END-IF                                                   14730029
147400     END-IF.                                                      14740029
147401                                                                  14740129
147402     IF ASC-SKU-NBR IS NOT NUMERIC                                14740229
147403        MOVE ASC-SKU-NBR          TO DP010I-UNEDITED-FIELD        14740329
147404        MOVE 8                    TO DP010I-MAXIMUM-DIGITS        14740429
147405        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      14740529
147406        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   14740629
147408        CALL DP010I-NUMERIC-EDIT-ROUTINE                          14740830
147409                         USING DP010I-NUMERIC-EDIT-AREA           14740930
147410        IF DP010I-ERROR-DETECTED                                  14741029
147411           MOVE PC-TSYMSG-00695  TO DP020-MSG-NUMBER              14741129
147412           MOVE DP015-UNP-ALP-BRT-MDT TO ASKUNBRA                 14741229
147413           MOVE DP015-RED        TO ASKUNBRC                      14741329
147414           MOVE DP015-REVERSE    TO ASKUNBRH                      14741429
147415           MOVE -1               TO ASKUNBRL                      14741529
147416           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    14741629
147417           SET PS-ERROR                                           14741729
147418               DP020-MSG-FATAL   TO TRUE                          14741829
147700        END-IF                                                    14770029
147800     END-IF.                                                      14780029
147801                                                                  14780129
147802     IF PS-NO-ERROR AND ASC-SKU-NBR > ZEROS                       14780229
147803        MOVE ASC-SKU-NBR          TO DP010I-UNEDITED-FIELD        14780329
147804        MOVE 8                    TO DP010I-MAXIMUM-DIGITS        14780429
147805        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      14780529
147806        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   14780629
147808        CALL DP010I-NUMERIC-EDIT-ROUTINE                          14780830
147809                         USING DP010I-NUMERIC-EDIT-AREA           14780930
147810        IF DP010I-ERROR-DETECTED                                  14781029
147811           MOVE PC-TSYMSG-00695  TO DP020-MSG-NUMBER              14781129
147812           MOVE DP015-UNP-ALP-BRT-MDT TO ASKUNBRA                 14781229
147813           MOVE DP015-RED        TO ASKUNBRC                      14781329
147814           MOVE DP015-REVERSE    TO ASKUNBRH                      14781429
147815           MOVE -1               TO ASKUNBRL                      14781529
147816           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    14781629
147817           SET PS-ERROR                                           14781729
147818               DP020-MSG-FATAL   TO TRUE                          14781829
147819        ELSE                                                      14781929
147820           MOVE DP010I-NUMERIC-FIELD                              14782029
147821                                 TO ASC-SKU-NBR                   14782129
147822           MOVE ASC-SKU-NBR      TO ASKUNBRO                      14782229
147823                                    DK-SKU-NBR                    14782329
147824                                    XST00010-SKU-NBR              14782429
147825        END-IF                                                    14782529
147826     END-IF.                                                      14782629
147827                                                                  14782729
147828      MOVE ASC-SKU-NBR              TO XST00010-SKU-NBR           14782829
147829     IF ASC-SKU-NBR > ZEROS AND ASC-SKU-NBR IS NUMERIC            14782929
147830             PERFORM 4600-SELECT-SKU                              14783029
147831         IF ASC-SKU-NBR > ZEROS AND PS-SKU-FOUND                  14783129
147832             NEXT SENTENCE                                        14783229
147840          ELSE                                                    14784029
147850           IF ASC-SKU-NBR > ZEROS AND PS-SKU-NOT-FOUND            14785029
147860              MOVE ASC-SKU-NBR           TO ASKUNBRO              14786029
147870              MOVE PC-TSYMSG-00073  TO DP020-MSG-NUMBER           14787029
147880              PERFORM 4800-SKU-ERROR                              14788029
147890           END-IF                                                 14789029
147900         END-IF                                                   14790029
148000     END-IF.                                                      14800029
148001                                                                  14800129
148002     IF PS-NO-ERROR                                               14800229
148003        IF ASC-DIRECT-UPC-NBR = ZEROS AND ASC-SKU-NBR = ZEROS     14800329
148100           MOVE PC-TSYMSG-00036  TO DP020-MSG-NUMBER              14810029
148200           MOVE SPACES TO ADUPC01O                                14820029
148300                          ADUPC02O                                14830029
148400                          ADUPC03O                                14840029
148500                          ADUPC04O                                14850029
148600                          ASKUNBRO                                14860029
148700           SET PS-DISPLAY-UPC-01 TO TRUE                          14870029
148800           PERFORM 3060-DIRECT-UPC-ERROR.                         14880029
148900                                                                  14890029
149000 3060-DIRECT-UPC-ERROR.                                           14900029
149100                                                                  14910029
149200     SET PS-ERROR                                                 14920029
149300         DP020-MSG-FATAL   TO TRUE.                               14930029
149400     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         14940029
149500                                                                  14950029
149600     IF PS-DISPLAY-UPC-01                                         14960029
149700        MOVE DP015-UNP-ALP-BRT-MDT                                14970029
149800                              TO ADUPC01A                         14980029
149900                                 ADUPC02A                         14990029
150000                                 ADUPC03A                         15000029
150100                                 ADUPC04A                         15010029
150200        MOVE DP015-RED        TO ADUPC01C                         15020029
150300                                 ADUPC02C                         15030029
150400                                 ADUPC03C                         15040029
150500                                 ADUPC04C                         15050029
150600                                 ASKUNBRC                         15060029
150700        MOVE DP015-REVERSE    TO ADUPC01H                         15070029
150800                                 ADUPC02H                         15080029
150900                                 ADUPC03H                         15090029
151000                                 ADUPC04H                         15100029
151100                                 ASKUNBRH                         15110029
151200        MOVE -1               TO ADUPC01L                         15120029
151300                                 ASKUNBRL                         15130029
151400     END-IF.                                                      15140029
151500                                                                  15150029
151600                                                                  15160029
151700****************************************************************  15170029
151800*                                                              *  15180029
151900*                                                              *  15190029
152000****************************************************************  15200029
152100 3110-VALIDATE-DEPARTMENT.                                        15210029
152200                                                                  15220029
152300     IF ASC-DEPT-NBR   = ZEROS  OR                                15230029
152400        ASC-DEPT-NBR-X = SPACES                                   15240029
152500        MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                 15250029
152600        PERFORM 3130-DEPARTMENT-ERROR                             15260029
152700     ELSE                                                         15270029
152800        MOVE ASC-DEPT-NBR-X       TO DP010I-UNEDITED-FIELD        15280029
152900        MOVE 4                    TO DP010I-MAXIMUM-DIGITS        15290029
153000        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      15300029
153100        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   15310029
153210        CALL DP010I-NUMERIC-EDIT-ROUTINE                          15321030
153220                         USING DP010I-NUMERIC-EDIT-AREA           15322030
153300        IF DP010I-ERROR-DETECTED                                  15330029
153400           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              15340029
153500           PERFORM 3130-DEPARTMENT-ERROR                          15350029
153600        ELSE                                                      15360029
153700           MOVE DP010I-NUMERIC-FIELD                              15370029
153800                                 TO ASC-DEPT-NBR                  15380029
153900           MOVE ASC-DEPT-NBR     TO ADPTNBRO                      15390029
154000                                    DK-DEPT-NBR                   15400029
154100                                                                  15410029
154200           PERFORM 3120-SELECT-DEPARTMENT                         15420029
154300                                                                  15430029
154400           EVALUATE TRUE                                          15440029
154500               WHEN PS-DEPARTMENT-FOUND                           15450029
154600                    CONTINUE                                      15460029
154700                                                                  15470029
154800               WHEN PS-DEPARTMENT-NOT-FOUND                       15480029
154900                    MOVE PC-TSYMSG-00588  TO DP020-MSG-NUMBER     15490029
155000                    PERFORM 3130-DEPARTMENT-ERROR                 15500029
155100                                                                  15510029
155200           END-EVALUATE                                           15520029
155300        END-IF                                                    15530029
155400     END-IF.                                                      15540029
155500                                                                  15550029
155600                                                                  15560029
155700****************************************************************  15570029
155800*                                                              *  15580029
155900****************************************************************  15590029
156000 3120-SELECT-DEPARTMENT.                                          15600029
156100                                                                  15610029
156200     EXEC SQL                                                     15620029
156300         SELECT  DEPT_NBR                                         15630029
156400                ,DEPT_NM                                          15640029
156500                ,BUS_GP_NBR                                       15650029
156600           INTO  :XST00015-DEPT-NBR                               15660029
156700                ,:XST00015-DEPT-NM                                15670029
156800                ,:XST00015-BUS-GP-NBR                             15680029
156900           FROM  XST_DEPT                                         15690029
157000          WHERE  DEPT_NBR = :DK-DEPT-NBR                          15700029
157100           WITH  UR                                               15710029
157200     END-EXEC.                                                    15720029
157300                                                                  15730029
157400     EVALUATE SQLCODE                                             15740029
157500         WHEN 0                                                   15750029
157600              SET PS-DEPARTMENT-FOUND TO TRUE                     15760029
157700                                                                  15770029
157800         WHEN +100                                                15780029
157900              SET PS-DEPARTMENT-NOT-FOUND TO TRUE                 15790029
158000                                                                  15800029
158100         WHEN OTHER                                               15810029
158200              MOVE '3120-SELECT-DEPARTMENT' TO DP013-PARAGRAPH    15820029
158300              SET   DP013-DB2-ABEND                               15830029
158400                    DP013-XCTL-DISPLAY-RESTART TO TRUE            15840029
158500              MOVE  SQLCA            TO DP013-SQLCA               15850029
158600              MOVE  'XLT_DEPT'       TO DP013-DB2-TABLE-NAME (1)  15860029
158700              STRING 'SELECT ON '                                 15870029
158800                      DP013-DB2-TABLE-NAME (1)                    15880029
158900                     ' TABLE HAD BAD SQLCODE '                    15890029
159000                      DELIMITED BY SIZE                           15900029
159100                      INTO DP013-MESSAGE-TEXT (1)                 15910029
159200              PERFORM DP013-0000-PROCESS-ABEND                    15920029
159300                                                                  15930029
159400     END-EVALUATE.                                                15940029
159500                                                                  15950029
159600 3130-DEPARTMENT-ERROR.                                           15960029
159700                                                                  15970029
159800     SET PS-ERROR                                                 15980029
159900         DP020-MSG-FATAL   TO TRUE.                               15990029
160000                                                                  16000029
160100     MOVE DP015-UNP-ALP-BRT-OFF                                   16010029
160200                           TO ADPTNBRA.                           16020029
160300     MOVE DP015-UNP-ALP-BRT-MDT                                   16030029
160400                           TO AMAJCLSA                            16040029
160500                              ASUBCLSA.                           16050029
160600     MOVE DP015-RED        TO ADPTNBRC.                           16060029
160700     MOVE DP015-REVERSE    TO ADPTNBRH.                           16070029
160800     MOVE -1               TO ADPTNBRL.                           16080029
160900     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         16090029
161000                                                                  16100029
161100****************************************************************  16110029
161200*                                                              *  16120029
161300****************************************************************  16130029
161400 3140-VALIDATE-MAJOR-CLASS.                                       16140029
161500                                                                  16150029
161600     IF ASC-MAJOR-CLS   = ZEROS OR                                16160029
161700        ASC-MAJOR-CLS-X = SPACES                                  16170029
161800        CONTINUE                                                  16180029
161900     ELSE                                                         16190029
162000        MOVE ASC-MAJOR-CLS-X      TO DP010I-UNEDITED-FIELD        16200029
162100        MOVE 4                    TO DP010I-MAXIMUM-DIGITS        16210029
162200        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16220029
162300        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16230029
162410        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16241030
162420                         USING DP010I-NUMERIC-EDIT-AREA           16242030
162500        IF DP010I-ERROR-DETECTED                                  16250029
162600           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              16260029
162700           PERFORM 3160-MAJOR-CLASS-ERROR                         16270029
162800        ELSE                                                      16280029
162900           MOVE DP010I-NUMERIC-FIELD                              16290029
163000                                 TO ASC-MAJOR-CLS                 16300029
163100           MOVE ASC-MAJOR-CLS    TO AMAJCLSO                      16310029
163200                                    DK-MAJ-CL-NBR                 16320029
163300           PERFORM 3150-SELECT-MAJOR-CLASS                        16330029
163400                                                                  16340029
163500           EVALUATE TRUE                                          16350029
163600               WHEN PS-MAJOR-CLASS-FOUND                          16360029
163700                    CONTINUE                                      16370029
163800                                                                  16380029
163900               WHEN PS-MAJOR-CLASS-NOT-FOUND                      16390029
164000                    MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER     16400029
164100                    PERFORM 3160-MAJOR-CLASS-ERROR                16410029
164200                                                                  16420029
164300           END-EVALUATE                                           16430029
164400        END-IF                                                    16440029
164500     END-IF.                                                      16450029
164600                                                                  16460029
164700                                                                  16470029
164800****************************************************************  16480029
164900*                                                              *  16490029
165000****************************************************************  16500029
165100 3150-SELECT-MAJOR-CLASS.                                         16510029
165200                                                                  16520029
165300     EXEC SQL                                                     16530029
165400         SELECT  DISTINCT                                         16540029
165500                 MAJ_CL_NBR                                       16550029
165600           INTO  :XST00014-MAJ-CL-NBR                             16560029
165700           FROM  XST_SUB_CL                                       16570029
165800          WHERE  MAJ_CL_NBR = :DK-MAJ-CL-NBR                      16580029
165900           WITH  UR                                               16590029
166000     END-EXEC.                                                    16600029
166100                                                                  16610029
166200     EVALUATE SQLCODE                                             16620029
166300         WHEN 0                                                   16630029
166400              SET PS-MAJOR-CLASS-FOUND TO TRUE                    16640029
166500                                                                  16650029
166600         WHEN +100                                                16660029
166700              SET PS-MAJOR-CLASS-NOT-FOUND TO TRUE                16670029
166800                                                                  16680029
166900         WHEN OTHER                                               16690029
167000              MOVE '3150-SELECT-MAJOR-CLASS' TO DP013-PARAGRAPH   16700029
167100              SET   DP013-DB2-ABEND                               16710029
167200                    DP013-XCTL-DISPLAY-RESTART TO TRUE            16720029
167300              MOVE  SQLCA            TO DP013-SQLCA               16730029
167400              MOVE  'XLT_SUB_CL    ' TO DP013-DB2-TABLE-NAME (1)  16740029
167500              STRING 'SELECT ON '                                 16750029
167600                      DP013-DB2-TABLE-NAME (1)                    16760029
167700                     ' TABLE HAD BAD SQLCODE '                    16770029
167800                      DELIMITED BY SIZE                           16780029
167900                      INTO DP013-MESSAGE-TEXT (1)                 16790029
168000              PERFORM DP013-0000-PROCESS-ABEND                    16800029
168100                                                                  16810029
168200     END-EVALUATE.                                                16820029
168300                                                                  16830029
168400 3160-MAJOR-CLASS-ERROR.                                          16840029
168500                                                                  16850029
168600     SET PS-ERROR                                                 16860029
168700         DP020-MSG-FATAL   TO TRUE.                               16870029
168800                                                                  16880029
168900     MOVE DP015-UNP-ALP-BRT-OFF                                   16890029
169000                           TO AMAJCLSA.                           16900029
169100     MOVE DP015-UNP-ALP-BRT-MDT                                   16910029
169200                           TO ADPTNBRA                            16920029
169300                              ASUBCLSA.                           16930029
169400     MOVE DP015-RED        TO AMAJCLSC.                           16940029
169500     MOVE DP015-REVERSE    TO AMAJCLSH.                           16950029
169600     MOVE -1               TO AMAJCLSL.                           16960029
169700     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         16970029
169800                                                                  16980029
169900                                                                  16990029
170000****************************************************************  17000029
170100*                                                              *  17010029
170200****************************************************************  17020029
170300 3170-VALIDATE-SUB-CLASS.                                         17030029
170400                                                                  17040029
170500     IF ASC-SUB-CLS-X = SPACES OR                                 17050029
170600                        ZEROS                                     17060029
170700        CONTINUE                                                  17070029
170800     ELSE                                                         17080029
170900        MOVE ASC-SUB-CLS-X        TO DP010I-UNEDITED-FIELD        17090029
171000        MOVE 4                    TO DP010I-MAXIMUM-DIGITS        17100029
171100        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      17110029
171200        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   17120029
171310        CALL DP010I-NUMERIC-EDIT-ROUTINE                          17131030
171320                         USING DP010I-NUMERIC-EDIT-AREA           17132030
171400        IF DP010I-ERROR-DETECTED                                  17140029
171500           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              17150029
171600           PERFORM 3190-SUB-CLASS-ERROR                           17160029
171700        ELSE                                                      17170029
171800           MOVE DP010I-NUMERIC-FIELD                              17180029
171900                                 TO ASC-SUB-CLS                   17190029
172000           MOVE ASC-SUB-CLS      TO DK-SUB-CL-NBR                 17200029
172100           PERFORM 3180-SELECT-SUB-CLASS                          17210029
172200                                                                  17220029
172300           EVALUATE TRUE                                          17230029
172400               WHEN PS-SUB-CLASS-FOUND                            17240029
172500                    CONTINUE                                      17250029
172600                                                                  17260029
172700               WHEN PS-SUB-CLASS-NOT-FOUND                        17270029
172800                    MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER     17280029
172900                    PERFORM 3190-SUB-CLASS-ERROR                  17290029
173000                                                                  17300029
173100           END-EVALUATE                                           17310029
173200        END-IF                                                    17320029
173300     END-IF.                                                      17330029
173400                                                                  17340029
173500                                                                  17350029
173600****************************************************************  17360029
173700*                                                              *  17370029
173800****************************************************************  17380029
173900 3180-SELECT-SUB-CLASS.                                           17390029
174000                                                                  17400029
174100     EXEC SQL                                                     17410029
174200         SELECT  DISTINCT                                         17420029
174300                 SUB_CL_NBR                                       17430029
174400           INTO  :XST00014-SUB-CL-NBR                             17440029
174500           FROM  XST_SUB_CL                                       17450029
174600          WHERE  SUB_CL_NBR = :DK-SUB-CL-NBR                      17460029
174700           WITH  UR                                               17470029
174800     END-EXEC.                                                    17480029
174900                                                                  17490029
175000     EVALUATE SQLCODE                                             17500029
175100         WHEN 0                                                   17510029
175200              SET PS-SUB-CLASS-FOUND TO TRUE                      17520029
175300                                                                  17530029
175400         WHEN +100                                                17540029
175500              SET PS-SUB-CLASS-NOT-FOUND TO TRUE                  17550029
175600                                                                  17560029
175700         WHEN OTHER                                               17570029
175800              MOVE '3180-SELECT-SUB-CLASS' TO DP013-PARAGRAPH     17580029
175900              SET   DP013-DB2-ABEND                               17590029
176000                    DP013-XCTL-DISPLAY-RESTART TO TRUE            17600029
176100              MOVE  SQLCA            TO DP013-SQLCA               17610029
176200              MOVE  'XLT_SUB_CL    ' TO DP013-DB2-TABLE-NAME (1)  17620029
176300              STRING 'SELECT ON '                                 17630029
176400                      DP013-DB2-TABLE-NAME (1)                    17640029
176500                     ' TABLE HAD BAD SQLCODE '                    17650029
176600                      DELIMITED BY SIZE                           17660029
176700                      INTO DP013-MESSAGE-TEXT (1)                 17670029
176800              PERFORM DP013-0000-PROCESS-ABEND                    17680029
176900                                                                  17690029
177000     END-EVALUATE.                                                17700029
177100                                                                  17710029
177200 3190-SUB-CLASS-ERROR.                                            17720029
177300                                                                  17730029
177400     SET PS-ERROR                                                 17740029
177500         DP020-MSG-FATAL   TO TRUE.                               17750029
177600                                                                  17760029
177700     MOVE DP015-UNP-ALP-BRT-OFF                                   17770029
177800                           TO ASUBCLSA.                           17780029
177900     MOVE DP015-UNP-ALP-BRT-MDT                                   17790029
178000                           TO ADPTNBRA                            17800029
178100                              AMAJCLSA.                           17810029
178200     MOVE DP015-RED        TO ASUBCLSC.                           17820029
178300     MOVE DP015-REVERSE    TO ASUBCLSH.                           17830029
178400     MOVE -1               TO ASUBCLSL.                           17840029
178500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         17850029
178600                                                                  17860029
178700                                                                  17870029
178800****************************************************************  17880029
178900*    MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS     *  17890029
179000*    ON THE MAP.                                               *  17900029
179100****************************************************************  17910029
179200 3200-RESET-ATTRIBUTES.                                           17920029
179300                                                                  17930029
179400     MOVE DP015-UNP-ALP-NOR-OFF    TO AVENDORA                    17940029
179500                                      ASTYLEA                     17950029
179700                                      ASKUNBRA.                   17970029
179800                                                                  17980029
179900     MOVE DP015-UNP-ALP-NOR-MDT    TO ASUPC01A                    17990002
180000                                      ASUPC02A                    18000002
180100                                      ASUPC03A                    18010002
180200                                      ASUPC04A.                   18020029
180300                                                                  18030029
180400     MOVE DP015-GREEN              TO AVENDORC                    18040002
180500                                      ASTYLEC                     18050002
180700                                      ASUPC01C                    18070002
180800                                      ASUPC02C                    18080002
180900                                      ASUPC03C                    18090002
181000                                      ASUPC04C                    18100029
181100                                      ADPTNBRC                    18110029
181200                                      AMAJCLSC                    18120029
181300                                      ASUBCLSC                    18130029
181400                                      ADUPC01C                    18140029
181500                                      ADUPC02C                    18150029
181600                                      ADUPC03C                    18160029
181700                                      ADUPC04C                    18170029
181800                                      ASKUNBRC.                   18180029
181900                                                                  18190029
182000     MOVE DP015-UNDERLINE          TO AVENDORH                    18200002
182100                                      ASTYLEH                     18210002
182300                                      ASUPC01H                    18230002
182400                                      ASUPC02H                    18240002
182500                                      ASUPC03H                    18250002
182600                                      ASUPC04H                    18260029
182700                                      ADPTNBRH                    18270029
182800                                      AMAJCLSH                    18280029
182900                                      ASUBCLSH                    18290029
183000                                      ADUPC01H                    18300029
183100                                      ADUPC02H                    18310029
183200                                      ADUPC03H                    18320029
183300                                      ADUPC04H                    18330029
183400                                      ASKUNBRH.                   18340029
183500                                                                  18350002
183600     MOVE DP015-UNP-ALP-NOR-MDT    TO ADPTNBRA                    18360029
183700                                      AMAJCLSA                    18370029
183800                                      ASUBCLSA                    18380029
184300                                      ADUPC01A                    18430029
184400                                      ADUPC02A                    18440029
184500                                      ADUPC03A                    18450029
184600                                      ADUPC04A.                   18460029
184700                                                                  18470002
185800                                                                  18580002
185900*----------------------------------------------------------------*18590002
186000*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *18600002
186100*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *18610002
186200*  IT HERE.                                                      *18620002
186300*----------------------------------------------------------------*18630002
186400 4000-BUILD-INITIAL-PANEL.                                        18640002
186500                                                                  18650002
186600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        18660002
186900                                                                  18690002
187000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18700002
187100                                                                  18710002
222500*----------------------------------------------------------------*22250029
222600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *22260029
222700*----------------------------------------------------------------*22270029
222800                                                                  22280029
222900 4400-MOVE-COMMAREA-TO-SCREEN.                                    22290029
223000                                                                  22300029
223100     MOVE ASC-VENDOR-ABBREV        TO AVENDORO.                   22310029
223200     MOVE ASC-VS-NBR               TO ASTYLEO.                    22320029
223400                                                                  22340029
224800     IF ASC-SIM-UPC                                               22480041
224900         IF ASC-UPC-NUMBER = 0                                    22490041
225000            MOVE SPACES TO ASUPC01O                               22500041
225100                           ASUPC02O                               22510041
225200                           ASUPC03O                               22520041
225300                           ASUPC04O                               22530041
225400         ELSE                                                     22540041
225500            MOVE ASC-UPC-NUMBER ( 3: 2) TO ASUPC01O               22550041
225600            MOVE ASC-UPC-NUMBER ( 5: 5) TO ASUPC02O               22560041
225700            MOVE ASC-UPC-NUMBER (10: 5) TO ASUPC03O               22570041
225800            MOVE ASC-UPC-NUMBER (15: 1) TO ASUPC04O               22580041
225900         END-IF                                                   22590041
226000     ELSE                                                         22600041
226500        MOVE SPACES TO ASUPC01O                                   22650041
226600                       ASUPC02O                                   22660041
226700                       ASUPC03O                                   22670041
226800                       ASUPC04O                                   22680041
226900     END-IF.                                                      22690041
227100                                                                  22710029
227200     IF ASC-DEPT-NBR = 0                                          22720029
227300        MOVE SPACES TO ADPTNBRO                                   22730029
227400     ELSE                                                         22740029
227500        MOVE ASC-DEPT-NBR TO ADPTNBRO                             22750029
227600     END-IF.                                                      22760029
227700                                                                  22770029
227800     IF ASC-MAJOR-CLS = 0                                         22780029
227900        MOVE SPACES TO AMAJCLSO                                   22790029
228000     ELSE                                                         22800029
228100        MOVE ASC-MAJOR-CLS TO AMAJCLSO                            22810029
228200     END-IF.                                                      22820029
228300                                                                  22830029
228400     IF ASC-SUB-CLS = 0                                           22840029
228500        MOVE SPACES TO ASUBCLSO                                   22850029
228600     ELSE                                                         22860029
228700        MOVE ASC-SUB-CLS TO ASUBCLSO                              22870029
228800     END-IF.                                                      22880029
228900                                                                  22890029
229000     MOVE ASC-STATUS TO ASTATUSO.                                 22900029
229100                                                                  22910029
229200     IF ASC-DIRECT-UPC-NBR = 0                                    22920029
229300        MOVE SPACES TO ADUPC01O                                   22930029
229400                       ADUPC02O                                   22940029
229500                       ADUPC03O                                   22950029
229600                       ADUPC04O                                   22960029
229700     ELSE                                                         22970029
229800        MOVE ASC-DIRECT-UPC-01  TO ADUPC01O                       22980029
229900        MOVE ASC-DIRECT-UPC-02  TO ADUPC02O                       22990029
230000        MOVE ASC-DIRECT-UPC-03  TO ADUPC03O                       23000029
230100        MOVE ASC-DIRECT-UPC-04  TO ADUPC04O                       23010029
230200     END-IF.                                                      23020029
230300                                                                  23030029
230400     IF ASC-SKU-NBR = 0                                           23040029
230500        MOVE SPACES      TO ASKUNBRO                              23050029
230600     ELSE                                                         23060029
230700        MOVE ASC-SKU-NBR TO ASKUNBRO                              23070029
230800     END-IF.                                                      23080029
236801*--------------------------------------------------------------*  23680129
236802* VERIFICATION FOR SKU NUMBER VALID OR NOT                    *   23680229
236803*--------------------------------------------------------------*  23680329
236804                                                                  23680429
236805 4600-SELECT-SKU.                                                 23680529
236806                                                                  23680629
236807     EXEC SQL                                                     23680729
236808         SELECT  UPC.UPC_NBR                                      23680829
236809                ,VNDSTYL.DEPT_NBR                                 23680929
236810                ,VNDSTYL.MAJ_CL_NBR                               23681029
236811                ,VNDSTYL.SUB_CL_NBR                               23681129
236812                ,VNDSTYL.STYL_ID                                  23681229
236813                ,VNDSTYL.VS_NBR                                   23681329
236814                ,VNDSTYL.LBL_NM                                   23681429
236815                ,VNDSTYL.STKR_NBR                                 23681529
236816                ,VNDSTYL.ENT_ID                                   23681629
236817                ,SKU.SIZE_DESC                                    23681729
236818                ,SKU.SKU_NBR                                      23681829
236819                ,SKU.SKU_DESC                                     23681929
236820                ,SKU.NRF_CLOR_DESC                                23682029
236821                ,SKU.INTR_UPC_ID                                  23682129
236822                ,SKU.REGN_PRIC_IND                                23682229
236823            INTO                                                  23682329
236824                 :XST00012-UPC-NBR                                23682429
236825                ,:XST00013-DEPT-NBR                               23682529
236826                ,:XST00013-MAJ-CL-NBR                             23682629
236827                ,:XST00013-SUB-CL-NBR                             23682729
236828                ,:XST00013-STYL-ID                                23682829
236829                ,:XST00013-VS-NBR                                 23682929
236830                ,:XST00013-LBL-NM                                 23683029
236831                ,:XST00013-STKR-NBR                               23683129
236832                ,:XST00013-ENT-ID                                 23683229
236833                ,:XST00010-SIZE-DESC                              23683329
236834                ,:XST00010-SKU-NBR                                23683429
236835                ,:XST00010-SKU-DESC                               23683529
236836                ,:XST00010-NRF-CLOR-DESC                          23683629
236837                ,:XST00010-INTR-UPC-ID                            23683729
236838                ,:XST00010-REGN-PRIC-IND                          23683829
236839           FROM  XST_VND_STYL  VNDSTYL                            23683929
236840                ,XST_SKU       SKU                                23684029
236841                ,XST_UPC       UPC                                23684129
236842          WHERE  VNDSTYL.STYL_ID   =  SKU.STYL_ID                 23684229
236843            AND  SKU.INTR_UPC_ID   =  UPC.INTR_UPC_ID             23684329
236844            AND  SKU.SKU_NBR       = :XST00010-SKU-NBR            23684429
236845            AND  UPC.UPC_TYP_CDE   = 'I'                          23684529
236846           WITH  UR                                               23684629
236847     END-EXEC.                                                    23684729
236848                                                                  23684829
236849     EVALUATE TRUE                                                23684929
236850       WHEN SQLCODE = ZERO                                        23685029
236851            SET PS-SKU-FOUND          TO TRUE                     23685129
236852       WHEN SQLCODE = +100                                        23685229
236853            SET PS-SKU-NOT-FOUND      TO TRUE                     23685329
236854                                                                  23685429
236855       WHEN OTHER                                                 23685529
236856            MOVE '4600-SELECT-SKU       ' TO DP013-PARAGRAPH      23685629
236857            MOVE SQLCA          TO DP013-SQLCA                    23685729
236858            MOVE 'XST_VND_STYL  ' TO DP013-DB2-TABLE-NAME (1)     23685829
236859            MOVE 'XST_SKU       ' TO DP013-DB2-TABLE-NAME (2)     23685929
236860            MOVE 'XST_UPC       ' TO DP013-DB2-TABLE-NAME (3)     23686029
236861            STRING 'SELECT ON '                                   23686129
236862                    DP013-DB2-TABLE-NAME (1)                      23686229
236863                    DP013-DB2-TABLE-NAME (2)                      23686329
236864                    DP013-DB2-TABLE-NAME (3)                      23686429
236865                   ' HAD BAD SQLCODE'                             23686529
236866                    DELIMITED BY SIZE                             23686629
236867                    INTO DP013-MESSAGE-TEXT (1)                   23686729
236868            STRING 'KEYS ARE - UPC - '                            23686829
236869                    DK-SKU-NBR                                    23686929
236870                    DELIMITED BY SIZE                             23687029
236871                    INTO DP013-MESSAGE-TEXT (2)                   23687129
236872            SET DP013-DB2-ABEND TO TRUE                           23687229
236873            PERFORM DP013-0000-PROCESS-ABEND                      23687329
236874                                                                  23687429
236875     END-EVALUATE.                                                23687529
236876*--------------------------------------------------------------*  23687629
236877* VERIFICATION FOR UPC NUMBER VALID OR NOT                    *   23687729
236878*--------------------------------------------------------------*  23687829
236879                                                                  23687929
236880 4700-SELECT-UPC.                                                 23688029
236881                                                                  23688129
236882     EXEC SQL                                                     23688229
236883         SELECT  UPC.UPC_NBR                                      23688329
236884                ,VNDSTYL.DEPT_NBR                                 23688429
236885                ,VNDSTYL.MAJ_CL_NBR                               23688529
236886                ,VNDSTYL.SUB_CL_NBR                               23688629
236887                ,VNDSTYL.STYL_ID                                  23688729
236888                ,VNDSTYL.VS_NBR                                   23688829
236889                ,VNDSTYL.LBL_NM                                   23688929
236890                ,VNDSTYL.STKR_NBR                                 23689029
236891                ,VNDSTYL.ENT_ID                                   23689129
236892                ,SKU.SIZE_DESC                                    23689229
236893                ,SKU.SKU_NBR                                      23689329
236894                ,SKU.SKU_DESC                                     23689429
236895                ,SKU.NRF_CLOR_DESC                                23689529
236896                ,SKU.INTR_UPC_ID                                  23689629
236897                ,SKU.REGN_PRIC_IND                                23689729
236898            INTO                                                  23689829
236899                 :XST00012-UPC-NBR                                23689929
236900                ,:XST00013-DEPT-NBR                               23690029
236901                ,:XST00013-MAJ-CL-NBR                             23690129
236902                ,:XST00013-SUB-CL-NBR                             23690229
236903                ,:XST00013-STYL-ID                                23690329
236904                ,:XST00013-VS-NBR                                 23690429
236905                ,:XST00013-LBL-NM                                 23690529
236906                ,:XST00013-STKR-NBR                               23690629
236907                ,:XST00013-ENT-ID                                 23690729
236908                ,:XST00010-SIZE-DESC                              23690829
236909                ,:XST00010-SKU-NBR                                23690929
236910                ,:XST00010-SKU-DESC                               23691029
236911                ,:XST00010-NRF-CLOR-DESC                          23691129
236912                ,:XST00010-INTR-UPC-ID                            23691229
236913                ,:XST00010-REGN-PRIC-IND                          23691329
236914           FROM  XST_VND_STYL  VNDSTYL                            23691429
236915                ,XST_SKU       SKU                                23691529
236916                ,XST_UPC       UPC                                23691629
236917          WHERE  UPC.UPC_NBR       = :DK-UPC-NBR                  23691729
236918            AND (UPC.UPC_TYP_CDE   = 'I'                          23691829
236919             OR  UPC.UPC_TYP_CDE   = 'V')                         23691929
236920            AND  UPC.LAST_ACTN_CDE <> 'D'                         23692029
236921            AND  UPC.INTR_UPC_ID   =  SKU.INTR_UPC_ID             23692129
236922            AND  SKU.STYL_ID       =  VNDSTYL.STYL_ID             23692229
236923           WITH  UR                                               23692329
236924                                                                  23692429
236925     END-EXEC.                                                    23692529
236926                                                                  23692629
236927     EVALUATE TRUE                                                23692729
236928       WHEN SQLCODE = ZERO                                        23692829
236929            SET PS-UPC-FOUND          TO TRUE                     23692929
236930       WHEN SQLCODE = +100                                        23693029
236931            SET PS-UPC-NOT-FOUND      TO TRUE                     23693129
236932                                                                  23693229
236933       WHEN OTHER                                                 23693329
236934            MOVE '4700-SELECT-UPC       ' TO DP013-PARAGRAPH      23693429
236935            MOVE SQLCA          TO DP013-SQLCA                    23693529
236936            MOVE 'XST_VND_STYL  ' TO DP013-DB2-TABLE-NAME (1)     23693629
236937            MOVE 'XST_SKU       ' TO DP013-DB2-TABLE-NAME (2)     23693729
236938            MOVE 'XST_UPC       ' TO DP013-DB2-TABLE-NAME (3)     23693829
236939            STRING 'SELECT ON '                                   23693929
236940                    DP013-DB2-TABLE-NAME (1)                      23694029
236941                    DP013-DB2-TABLE-NAME (2)                      23694129
236942                    DP013-DB2-TABLE-NAME (3)                      23694229
236943                   ' HAD BAD SQLCODE'                             23694329
236944                    DELIMITED BY SIZE                             23694429
236945                    INTO DP013-MESSAGE-TEXT (1)                   23694529
236946            MOVE DK-UPC-NBR TO DK-UPC-NBR-PIC9                    23694629
236947            STRING 'KEYS ARE - UPC - '                            23694729
236948                    DK-UPC-NBR-PIC9                               23694829
236949                    DELIMITED BY SIZE                             23694929
236950                    INTO DP013-MESSAGE-TEXT (2)                   23695029
236951            SET DP013-DB2-ABEND TO TRUE                           23695129
236952            PERFORM DP013-0000-PROCESS-ABEND                      23695229
236953                                                                  23695329
236954     END-EVALUATE.                                                23695429
236955                                                                  23695529
236956 4800-SKU-ERROR.                                                  23695629
236957                                                                  23695729
236958     MOVE ASKUNBRO         TO ASC-SKU-NBR.                        23695829
236959     SET PS-ERROR                                                 23695929
236960         DP020-MSG-FATAL   TO TRUE.                               23696029
236961     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         23696129
236962                                                                  23696229
236963     MOVE DP015-RED        TO ASKUNBRC.                           23696329
236964     MOVE DP015-REVERSE    TO ASKUNBRH.                           23696429
236965     MOVE -1               TO ASKUNBRL.                           23696529
236966                                                                  23696629
236967 4900-UPC-ERROR.                                                  23696729
236968                                                                  23696829
236969     MOVE ADUPC01O         TO ASC-DIRECT-UPC-01.                  23696929
236970     MOVE ADUPC02O         TO ASC-DIRECT-UPC-02.                  23697029
236971     MOVE ADUPC03O         TO ASC-DIRECT-UPC-03.                  23697129
236972     MOVE ADUPC04O         TO ASC-DIRECT-UPC-04.                  23697229
236973     SET PS-ERROR                                                 23697329
236974         DP020-MSG-FATAL   TO TRUE.                               23697429
236975     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         23697529
236976                                                                  23697629
236977     MOVE DP015-RED        TO ADUPC01C                            23697729
236978                              ADUPC02C                            23697829
236979                              ADUPC03C                            23697929
236980                              ADUPC04C.                           23698029
236981     MOVE DP015-REVERSE    TO ADUPC01H                            23698129
236982                              ADUPC02H                            23698229
236983                              ADUPC03H                            23698329
236984                              ADUPC04H.                           23698429
236985     MOVE -1               TO ADUPC01L.                           23698529
236986                                                                  23698629
236987*----------------------------------------------------------------*23698729
237000*    ABEND PROCESSOR MODULE                                      *23700029
237100*----------------------------------------------------------------*23710029
237200                                                                  23720029
237300     COPY DPPD013.                                                23730029
