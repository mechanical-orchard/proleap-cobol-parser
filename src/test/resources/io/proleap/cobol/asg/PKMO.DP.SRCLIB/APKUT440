000100 IDENTIFICATION DIVISION.                                         00010034
000200 PROGRAM-ID.     APKUT440.                                        00020035
000300 AUTHOR.         MEENAKSHI MITTAL.                                00030035
000400 DATE-WRITTEN.   JUNE 2015.                                       00040035
000500******************************************************************00050035
000600*    COBOL 2                                                      00060043
000700*                                                                 00070035
000800*     REFORMATTING THE DUTY FILE.                                 00080036
000900*                                                                 00090035
001000* THIS PROGRAM REFORMATS THE DUTY FILE COMING FROM THE EXPEDITORS 00100036
001100* IN A TEXT FORMAT TO A FORMAT THAT CAN MORE EASILY BE USED IN    00110040
001200* EDITING THE VALUES AND DO DATABASE LOOKUPS IN A LATER STEP.     00120040
001400*                                                                 00140035
001500******************************************************************00150035
001600* INPUT:                                                          00160035
001700* 1. DUTY FILE FROM EXPEDITORS           (APRD155)                00170035
001800*                                                                 00180035
001900* OUTPUT:                                                         00190035
002000* 1. EXPEDITORS DUTY FEE FOR GROUPED PO'S (APRD156)               00200035
002100*                                                                 00210035
002200***************************************************************** 00220035
002400* CHANGE LOG:                                                     00240035
002500*                                                                 00250035
002600* 06/08/15  INITIAL VERSION                                       00260035
002700*                                                                 00270035
002710* DATE  08/22/2017                                                00271045
002720*     CHANGE MADE: DUTY RECYCLE PROJECT.                          00272045
002730*     CHANGED LRECL FOR FILE USING APRD156 COPYBOOK.              00273045
002740*     MADE BY: NANCY EILBES            WR/IR #:  CHG0175427       00274045
002750*                                                                 00275045
002710* DATE  01/04/2023                                                00276046
002720*     CHANGE MADE: ADD CUSTOMS BROKER LIVINGSTON                  00277046
002730*     CHANGED LRECL FOR FILE USING APRD156 COPYBOOK.              00278046
002730*     ADD NEW CONTROL CARD TO INDICATE CUSTOMS BROKER COMPANY     00278149
002740*     MADE BY: JEAN KURK               WR/IR #:  CHG0277903       00279046
002750*                                                                 00279146
002800***************************************************************** 00280035
002900                                                                  00290035
003000 ENVIRONMENT DIVISION.                                            00300035
003100                                                                  00310035
003200 INPUT-OUTPUT SECTION.                                            00320035
003300                                                                  00330035
003400 FILE-CONTROL.                                                    00340035
003500                                                                  00350035
003600     SELECT DUTY-FEE-INPUT-FILE    ASSIGN TO INP01.               00360035
003700     SELECT DUTY-FEE-OUTPUT-FILE   ASSIGN TO OUT01.               00370035
003800                                                                  00380035
003900 DATA DIVISION.                                                   00390035
004000                                                                  00400035
004100 FILE SECTION.                                                    00410035
004200                                                                  00420035
004300 FD  DUTY-FEE-INPUT-FILE                                          00430035
004400     RECORDING MODE IS  F                                         00440035
004500     LABEL RECORDS  ARE STANDARD                                  00450035
004600     DATA RECORD    IS  DUTY-FEE-INPUT-RECORD.                    00460035
004700                                                                  00470035
004800 01  DUTY-FEE-INPUT-RECORD         PIC X(181).                    00480042
004900                                                                  00490035
005000 FD  DUTY-FEE-OUTPUT-FILE                                         00500035
005100     RECORDING MODE IS  F                                         00510035
005200     LABEL RECORDS  ARE STANDARD                                  00520035
005300     DATA RECORD    IS  DUTY-FEE-OUTPUT-RECORD.                   00530035
005400                                                                  00540035
005500 01  DUTY-FEE-OUTPUT-RECORD        PIC X(181).                    00551047
005500*01  DUTY-FEE-OUTPUT-RECORD        PIC X(179).                    00552047
005600                                                                  00560035
005700 EJECT                                                            00570035
005800 WORKING-STORAGE SECTION.                                         00580035
005900                                                                  00590035
006000 01  FILLER                          PIC X(25) VALUE              00600035
006100                             'WS FOR APKUT440 BEGINS==>'.         00610035
006200                                                                  00620035
006300 01  WS-PROGRAM-COUNTERS.                                         00630035
006400     05 WS-DUTY-IN-REC-CNT          PIC 9(9) VALUE ZEROS.         00640035
006500     05 WS-DUTY-OUT-REC-CNT         PIC 9(9) VALUE ZEROS.         00650035
006600                                                                  00660035
006700 01  PS-SWITCHES.                                                 00670035
006800     05 END-OF-DUTY-IN-SW           PIC X(1) VALUE ' '.           00680035
006900        88  END-OF-DUTY-IN                   VALUE 'N'.           00690035
006901                                                                  00690135
006970 01  RUN-TIME                        PIC 9(8).                    00697035
006980 01  DATE-IN                         PIC X(6).                    00698035
006990 EJECT                                                            00699035
007000*----------------------------------------------------------------*00700035
007100*  DUTY FEE INPUT FILE FROM EXPEDITORS.                           00710035
007200*----------------------------------------------------------------*00720035
007300     COPY APRD155.                                                00730035
007400 EJECT                                                            00740035
008100*----------------------------------------------------------------*00810035
008200*  DUTY FEE FORMATTED OUTPUT FILE.                                00820036
008300*----------------------------------------------------------------*00830035
008400     COPY APRD156.                                                00840035
008500 EJECT                                                            00850035
037700*--------------------------------------------------------------*  00851048
037800*  CONTROL CARD RECORD LAYOUT                                  *  00852048
037900*--------------------------------------------------------------*  00853048
038000 01  CONTROL-CARD-RECORD.                                         00854048
038100     05  CC-BROKER-CODE          PIC  X(01).                      00855048
038200     05  FILLER                  PIC  X(79).                      00856048
008600*                                                                 00860035
016000*----------------------------------------------------------------*00871048
016100*    ABEND DATA AREAS                                             00872048
016200*----------------------------------------------------------------*00873048
016400 01  ABEND-AREAS.                                                 00875048
016500     05  AA-ABEND-LIT              PIC  X(40)   VALUE             00876048
016600             '*****       ABEND'.                                 00877048
016700     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             00878048
016800             '*****   PROGRAM: APKUT440'.                         00879048
016900     05  AA-PARAGRAPH-LIT.                                        00879148
017000         10  FILLER                PIC  X(17)   VALUE             00879248
017100             '***** PARAGRAPH: '.                                 00879348
017200         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     00879448
017300     05  AA-MESSAGE-LINE-1.                                       00879548
017400         10  FILLER                PIC  X(06)   VALUE '*****'.    00879648
017500         10  AA-MESSAGE-1          PIC  X(80)   VALUE SPACES.     00879748
017600     05  AA-MESSAGE-LINE-2.                                       00879848
017700         10  FILLER                PIC  X(06)   VALUE '*****'.    00879948
017800         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     00880048
017900                                                                  00880148
018000 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      00880248
018100                                   COMP         SYNC.             00880348
018700     88  AC-INVALID-CONTROL-CARD                VALUE  +4003.     00880948
019300                                                                  00881548
008800 01  FILLER                        PIC X(25) VALUE                00882035
008900          '<====WS FOR APKUT440 ENDS'.                            00890035
009000 EJECT                                                            00900035
009100 PROCEDURE DIVISION.                                              00910035
009200                                                                  00920035
009300 A100-MAINLINE.                                                   00930035
009400                                                                  00940035
009500     PERFORM B100-INITIALIZE.                                     00950035
009600                                                                  00960035
009700     PERFORM B200-PROCESS-DUTY-FEE-RECORD                         00970040
009710       UNTIL END-OF-DUTY-IN.                                      00971040
009800                                                                  00980037
009900     PERFORM B300-END-OF-JOB.                                     00990035
010000                                                                  01000035
010100     GOBACK.                                                      01010035
010200                                                                  01020035
010300 EJECT                                                            01030035
010400*---------------------------------------------------------------* 01040035
010500* GET DATE, TIME, OPEN FILES, INITIALIZE RECORD LAYOUTS AND       01050035
010600* PERFORM INITIAL READ OF INPUT FILE.                             01060035
010700*---------------------------------------------------------------* 01070035
010800 B100-INITIALIZE.                                                 01080035
010900                                                                  01090035
011000     ACCEPT RUN-TIME FROM TIME.                                   01100035
011100     ACCEPT DATE-IN  FROM DATE.                                   01110035
011200     DISPLAY '------------ START OF APKUT440 ------------'.       01120035
011300     DISPLAY ' RUN-DATE = ' DATE-IN '   RUN-TIME = ' RUN-TIME.    01130035
011400                                                                  01140035
011500     OPEN  INPUT   DUTY-FEE-INPUT-FILE.                           01150035
011600     OPEN  OUTPUT  DUTY-FEE-OUTPUT-FILE.                          01160035
011700                                                                  01170035
011800     INITIALIZE AP155-DUTY-TEXT-RECORD                            01180038
011900                AP156-DUTY-INVC-RECORD.                           01190038
012000                                                                  01200035
012100     PERFORM R100-READ-DUTY-INPUT.                                01210035
012200     IF END-OF-DUTY-IN                                            01220035
012300        DISPLAY '***************************************'         01230035
012400        DISPLAY '* INPUT FILE IS EMPTY.  NO RECORDS    *'         01240035
012500        DISPLAY '* TO PROCESS.                         *'         01250035
012600        DISPLAY '***************************************'         01260035
013000     END-IF.                                                      01300035
013100                                                                  01310035
041200     ACCEPT CONTROL-CARD-RECORD.                                  01311048
041300     IF CC-BROKER-CODE = 'E'                                      01312048
041400        DISPLAY 'APKUT440 - PROCESSING EXPEDITORS'                01313048
041500     ELSE                                                         01314048
041600        IF CC-BROKER-CODE = 'L'                                   01315048
041700           DISPLAY 'APKUT440 - PROCESSING LIVINGSTON'             01316048
041800     ELSE                                                         01317048
041900        MOVE 'B100-INITIALIZATION' TO AA-PARAGRAPH-NAME           01318048
042000        MOVE 'ERROR IN CONTROL CARD' TO AA-MESSAGE-1              01319048
042100        MOVE 'CONTROL CARD NOT SET UP CORRECTLY' TO               01319148
042200                               AA-MESSAGE-2                       01319248
042300        SET  AC-INVALID-CONTROL-CARD TO TRUE                      01319348
042400        PERFORM Z998-ABEND                                        01319448
042500        END-IF                                                    01319548
042600     END-IF.                                                      01319648
013200 EJECT                                                            01320035
013300*---------------------------------------------------------------* 01330035
013400* REFORMAT THE INPUT FIELDS.                                ITES  01340036
013600*---------------------------------------------------------------* 01360035
013700 B200-PROCESS-DUTY-FEE-RECORD.                                    01370035
013800                                                                  01380035
013900     MOVE AP155-BRANCH           TO AP156-BRANCH.                 01390040
014000     MOVE AP155-PO-NBR           TO AP156-PO-NBR.                 01400040
014100     MOVE AP155-INVOICE-NBR      TO AP156-INVOICE-NBR.            01410040
014200     MOVE AP155-BROKER-REF-NBR   TO AP156-BROKER-REF-NBR.         01420040
014400     MOVE AP155-ENTRY-NBR        TO AP156-ENTRY-NBR.              01440040
014730     MOVE AP155-STATEMENT-NBR    TO AP156-STATEMENT-NBR.          01473040
014740     MOVE AP155-STATEMENT-DTE    TO AP156-STATEMENT-DTE.          01474040
014750     MOVE AP155-CUSTOMS-PAID-DTE TO AP156-CUSTOMS-PAID-DTE.       01475035
014760     MOVE AP155-TOTAL-DUTY-AMT   TO AP156-TOTAL-DUTY-AMT.         01476040
014770     MOVE AP155-DUTY-AMT         TO AP156-DUTY-AMT.               01477040
014780     MOVE AP155-MPF-AMT          TO AP156-MPF-AMT.                01478040
014790     MOVE AP155-HMF-AMT          TO AP156-HMF-AMT.                01479040
014800     MOVE AP155-FEES             TO AP156-FEES.                   01480040
014900     MOVE AP155-TOTAL-TAX-AMT    TO AP156-TOTAL-TAX-AMT.          01490040
014910     MOVE ZERO                   TO AP156-RECYCLE-COUNT.          01491044
014910     MOVE CC-BROKER-CODE         TO AP156-CUSTOMS-BROKER.         01492048
015000                                                                  01500035
015010     PERFORM W100-WRITE-FILE.                                     01501036
015020                                                                  01502036
015700     PERFORM R100-READ-DUTY-INPUT.                                01570035
015800*                                                                 01580035
015900*EJECT                                                            01590035
016000*---------------------------------------------------------------* 01600035
016100* CLOSE FILES AND DISPLAY COUNTER TOTALS.                         01610035
016200*---------------------------------------------------------------* 01620035
016300 B300-END-OF-JOB.                                                 01630035
016400                                                                  01640035
016500     CLOSE DUTY-FEE-INPUT-FILE                                    01650035
016600           DUTY-FEE-OUTPUT-FILE.                                  01660035
016700                                                                  01670035
016800     DISPLAY '************************************************'.  01680035
016900     DISPLAY 'TOTAL RECORDS READ     = ' WS-DUTY-IN-REC-CNT    .  01690035
017000     DISPLAY 'TOTAL RECORDS WRITTEN  = ' WS-DUTY-OUT-REC-CNT   .  01700035
017100     DISPLAY '************************************************'.  01710035
017200                                                                  01720035
017300     DISPLAY '------------ END OF APKUT440 ------------'.         01730035
017800                                                                  01780035
017900     ACCEPT RUN-TIME FROM TIME.                                   01790035
018000     ACCEPT DATE-IN  FROM DATE.                                   01800035
018100                                                                  01810035
018200     DISPLAY ' RUN-DATE = ' DATE-IN '   RUN-TIME = ' RUN-TIME.    01820035
018300     DISPLAY '*----------------------------------------------*'.  01830035
018400                                                                  01840035
018500 EJECT                                                            01850035
018600*---------------------------------------------------------------* 01860035
018700* READ THE DUTY FEE FILE FROM EXPEDITORS FOR GROUPED PO'S.        01870035
018800*---------------------------------------------------------------* 01880035
018900 R100-READ-DUTY-INPUT.                                            01890035
019000                                                                  01900035
019100     READ DUTY-FEE-INPUT-FILE  INTO AP155-DUTY-TEXT-RECORD        01910038
019200     AT END                                                       01920035
019300        SET END-OF-DUTY-IN TO TRUE.                               01930035
019400                                                                  01940035
019500     IF NOT END-OF-DUTY-IN                                        01950035
019600        ADD 1 TO WS-DUTY-IN-REC-CNT                               01960035
019700     END-IF.                                                      01970035
019800                                                                  01980035
019810 EJECT                                                            01981036
019811*---------------------------------------------------------------* 01981136
019812* WRITES OUTPUT FILE.                                             01981236
019813*---------------------------------------------------------------* 01981336
019814 W100-WRITE-FILE.                                                 01981436
019815                                                                  01981536
020100     WRITE DUTY-FEE-OUTPUT-RECORD FROM AP156-DUTY-INVC-RECORD.    02010038
020200                                                                  02020036
020300     INITIALIZE AP155-DUTY-TEXT-RECORD                            02030038
020400                AP156-DUTY-INVC-RECORD.                           02040038
020500     ADD 1 TO WS-DUTY-OUT-REC-CNT.                                02050036
020510                                                                  02051036
020600 EJECT                                                            02060036
079500*----------------------------------------------------------------*02070048
079600* Z998-ABEND                                                     *02080048
079700*  ABEND ROUTINE.                                                *02090048
079800*----------------------------------------------------------------*02100048
079900 Z998-ABEND.                                                      02110048
080000                                                                  02120048
080100     DISPLAY AA-ABEND-LIT.                                        02130048
080200     DISPLAY AA-PROGRAM-LIT.                                      02140048
080300     DISPLAY AA-PARAGRAPH-LIT.                                    02150048
080400     DISPLAY AA-MESSAGE-LINE-1.                                   02160048
080500     DISPLAY AA-MESSAGE-LINE-2.                                   02170048
080600                                                                  02180048
080700     CALL 'ILBOABN0' USING ABEND-CODE.                            02190048
