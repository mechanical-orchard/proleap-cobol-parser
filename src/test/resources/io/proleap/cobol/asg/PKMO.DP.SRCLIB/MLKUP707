       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.    MLKUP707.                                         00030000
       AUTHOR.        SCOTT JACKSON.                                    00040000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
       DATE-WRITTEN.  01-11-2011.                                       00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ******************************************************************00090000
      *  MLKUP707 - DATA INTEGRITY VALIDATION OF AUDIT TABLE ENTRIES    00100000
      *             MLT_PADJ_TRN_DTL (RECEIPTS/ PURCH ADJ / TRANSFERS)  00110029
      *             MLT_SLS_TRN_DTL (SALES)                             00120000
      *             MLT_PCHG_TRN_DTL (PRICE CHANGES)                    00130000
      *             MLT_INV_ADJ_TRN_DTL (PHYS INVENTORY ADJUSTMENTS)    00140000
      ******************************************************************00150000
      *  THIS PROGRAM READ THE AUDIT DATABASE AND VALIDATE THE BRAND    00160000
      *      VENDOR ATTRIBUTES FOR CONSISTENCY. PROCESS WILL VALIDATE   00170000
      *      1) ML_LO_MDSE_LVL_ID: MATCHES DEPT, ENT-ID AND LBL-SEQ-NBR 00180025
      *             COMPARE AUDIT TABLES MLT_*_TRN_DTL TO MLV_BRND_VND  00190025
      *      2) IF MISMATCHED ARE FOUND, UPDATE AUDIT ATTRIBUTES        00200025
      *                                                                 00210000
      *      PROCESS WILL RUN IN EITHER 'AUD' OR 'UPD' MODES            00220025
      ******************************************************************00230000
                                                                        00240000
       ENVIRONMENT DIVISION.                                            00250000
                                                                        00260000
       CONFIGURATION SECTION.                                           00270000
       SOURCE-COMPUTER.        IBM-3090.                                00280000
       OBJECT-COMPUTER.        IBM-3090.                                00290000
       INPUT-OUTPUT SECTION.                                            00300000
       FILE-CONTROL.                                                    00310000
                                                                        00320000
           SELECT PROCESS-DATE-FILE                                     00330007
               ASSIGN TO INP01.                                         00340003
           SELECT REPORT-TABLE-UPDATE                                   00350003
               ASSIGN TO RPT01.                                         00360016
                                                                        00370000
       DATA DIVISION.                                                   00380000
       FILE SECTION.                                                    00390000
                                                                        00400000
       FD  PROCESS-DATE-FILE                                            00410008
           LABEL RECORDS ARE STANDARD                                   00420000
           RECORDING MODE IS F                                          00430000
           BLOCK CONTAINS 0 RECORDS.                                    00440000
       01  PROCESS-DATE-CONTROL          PIC X(80).                     00450000
                                                                        00460000
       FD  REPORT-TABLE-UPDATE                                          00470007
           LABEL RECORDS ARE STANDARD                                   00480000
           RECORDING MODE IS F                                          00490000
           BLOCK CONTAINS 0 RECORDS.                                    00500000
       01  REPORT-TABLE-RECORD          PIC X(150).                     00510007
                                                                        00520000
       WORKING-STORAGE SECTION.                                         00530000
                                                                        00540000
       01  FILLER                        PIC X(28)  VALUE               00550000
                'BEGINNING OF WORKING STORAGE'.                         00560000
                                                                        00570000
       01  ABEND-CODE                    PIC S9(04) VALUE ZERO          00580000
                                                    COMP SYNC.          00590000
                                                                        00600000
       01  PC-PROGRAM-CONSTANTS.                                        00610000
           05  PC-PROGRAM-NAME           PIC  X(08) VALUE 'MLKUP707'.   00620000
           05  PC-MAX-RETRIES            PIC S9(03) VALUE +3 COMP-3.    00630000
                                                                        00640000
       01  PE-PROGRAM-ERROR-MESSAGES.                                   00650000
           05  PE-MSG-01                 PIC X(50)  VALUE               00660004
                'DATE CONTROL FILE IS EMPTY OR DATE IS INVALID   '.     00670004
           05  PE-MSG-02                 PIC X(50)  VALUE               00680004
                'DATE INPUT IS NOT A FSCL-WK-END-DTE             '.     00690010
           05  PE-MSG-03                 PIC X(50)  VALUE               00700004
                'START DATE IS AFTER END DATE                    '.     00710004
           05  PE-MSG-04                 PIC X(50)  VALUE               00720004
                'FAILURE ON OPEN CURSOR                          '.     00730004
           05  PE-MSG-05                 PIC X(50)  VALUE               00740004
                'FAILURE ON FETCH CURSOR                         '.     00750004
           05  PE-MSG-06                 PIC X(50)  VALUE               00760004
                'FAILURE ON CLOSE CURSOR                         '.     00770004
           05  PE-MSG-07                 PIC X(50)  VALUE               00780004
                'ATTEMPT TO UPDATE ROW FAILED                    '.     00790004
           05  PE-MSG-08                 PIC X(50)  VALUE               00800004
                'PROGRAM ABENDED WHILE TRYING TO PERFORM A COMMIT'.     00810000
           05  PE-MSG-09                 PIC X(50)  VALUE               00820004
                'PROGRAM MAXIMUM DEADLOCK COUNT HAS BEEN EXCEEDED'.     00830000
                                                                        00840000
       01  PS-PROGRAM-SWITCHES.                                         00850000
           05  PS-EOF-CC-INPUT-SW        PIC X(01)  VALUE 'N'.          00860004
               88  PS-EOF-DATE-INPUT                VALUE 'Y'.          00870004
           05  PS-FIRST-COMMIT-SW        PIC X(01)  VALUE 'N'.          00880000
               88  PS-FIRST-COMMIT                  VALUE 'Y'.          00890000
           05  PS-END-OF-CURSOR-SW       PIC X(01)  VALUE 'N'.          00900018
               88  PS-NOT-END-OF-CSR                VALUE 'N'.          00910018
               88  PS-END-OF-CSR                    VALUE 'Y'.          00920018
           05  PS-AUDIT-PADJ-UPD-SW      PIC X(01)  VALUE 'N'.          00930004
               88  PS-AUDIT-PADJ-UPD-REQD           VALUE 'Y'.          00940004
           05  PS-AUDIT-SLS-UPD-SW       PIC X(01)  VALUE 'N'.          00950004
               88  PS-AUDIT-SLS-UPD-REQD            VALUE 'Y'.          00960004
           05  PS-AUDIT-PCHG-UPD-SW      PIC X(01)  VALUE 'N'.          00970004
               88  PS-AUDIT-PCHG-UPD-REQD           VALUE 'Y'.          00980030
           05  PS-AUDIT-INADJ-UPD-SW     PIC X(01)  VALUE 'N'.          00990004
               88  PS-AUDIT-INADJ-UPD-REQD          VALUE 'Y'.          01000004
                                                                        01010007
       01  PROGRAM-VARIABLES.                                           01020004
           05  PV-START-DATE             PIC  X(10) VALUE SPACES.       01030010
           05  PV-END-DATE               PIC  X(10) VALUE SPACES.       01040010
           05  PV-RETRY-COUNT            PIC S9(03) VALUE +0 COMP-3.    01050010
           05  PV-PARAGRAPH-NAME         PIC  X(30) VALUE SPACES.       01060000
           05  PV-OPERATION-ATTEMPTED    PIC  X(50) VALUE SPACES.       01070000
                                                                        01080000
       01  DATA-CONVERSIONS-VARIABLES.                                  01090004
           05  DC-NUMERIC-1              PIC S9(04)V VALUE +0 COMP-3.   01100004
           05  DC-NUMERIC-2              PIC S9(04)  VALUE ZERO.        01110004
           05  DC-NUMERIC-3              PIC  9(04)  VALUE ZERO.        01120004
           05  DC-NUMERIC-4              PIC S9(09)V VALUE +0 COMP-3.   01130004
           05  DC-NUMERIC-5              PIC S9(10)  VALUE ZERO.        01140004
           05  DC-NUMERIC-6              PIC  9(10)  VALUE ZERO.        01150004
                                                                        01160004
       01  PA-PROGRAM-ACCUMULATORS.                                     01170000
           05  PA-RECORD-COUNTS.                                        01180000
               10  PA-UPDATE-COUNT       PIC  9(09)    VALUE ZEROES.    01190000
               10  PA-COMMIT-COUNT       PIC  9(09)    VALUE ZEROES.    01200000
               10  PA-RP-RECORD-WRITTEN  PIC  9(09)    VALUE ZEROES.    01210007
               10  PA-PADJ-UPDATE-COUNT  PIC  9(09)    VALUE ZEROES.    01220009
               10  PA-SALE-UPDATE-COUNT  PIC  9(09)    VALUE ZEROES.    01230009
               10  PA-PCHG-UPDATE-COUNT  PIC  9(09)    VALUE ZEROES.    01240009
               10  PA-INAD-UPDATE-COUNT  PIC  9(09)    VALUE ZEROES.    01250009
      *                                                                 01260000
      ***************************************************************** 01270000
      *  DATE CONTROL FILE (INPUT FROM JOB:DEFAULT IS FSCL_WK_END_DTE)  01280003
      *     PROCESSING WILL ACCEPT A START AND END RANGE AS OVERRIDE    01290003
      *     PROCESS CAN RUN IN AUDIT UPDATE (AS OVERRIDE OPTION ONLY)   01300004
      *0----5----1----5----2----5----3----5----4                        01310003
      * 2011-01-01 2011-01-01     <--- DEFAULT CC INPUT (UPDATE MODE)   01320015
      * 2011-01-01 2011-01-29 AUD <--- OPTIONAL OVERRIDE INPUT          01330004
      ***************************************************************** 01340000
       01  CC-DATE-CONTROL.                                             01350000
           05  INPUT-START-DATE.                                        01360010
               10  CC-YEAR                  PIC  X(04) VALUE SPACE.     01370010
               10  FILLER                   PIC  X(01) VALUE SPACE.     01380010
               10  CC-MONTH                 PIC  X(02) VALUE SPACE.     01390010
               10  FILLER                   PIC  X(01) VALUE SPACE.     01400010
               10  CC-DAY                   PIC  X(02) VALUE SPACE.     01410010
           05  FILLER                       PIC  X(01) VALUE SPACE.     01420010
           05  INPUT-END-DATE.                                          01430010
               10  CC-YEAR                  PIC  X(04) VALUE SPACE.     01440010
               10  FILLER                   PIC  X(01) VALUE SPACE.     01450010
               10  CC-MONTH                 PIC  X(02) VALUE SPACE.     01460010
               10  FILLER                   PIC  X(01) VALUE SPACE.     01470010
               10  CC-DAY                   PIC  X(02) VALUE SPACE.     01480010
           05  FILLER                       PIC  X(01) VALUE SPACE.     01490015
           05  CC-UPDATE-MODE               PIC  X(03) VALUE SPACE.     01500015
               88  CC-DEFAULT-UPDATE-MODE           VALUE '   '.        01510004
               88  CC-UPDATE-MODE                   VALUE 'UPD'.        01520004
               88  CC-AUDIT-MODE                    VALUE 'AUD'.        01530004
           05  FILLER                       PIC  X(55).                 01540015
                                                                        01550004
    ****** PURCHASE ADJ / RECEIPT / TRANSFER                            01560025
       01  REPORT-PADJ-HEADER.                                          01570019
           05 RPT-PADJ-FSCL-WK         PIC   X(10)  VALUE 'PADJ  WK  '. 01580035
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01590019
           05 RPT-PADJ-PRCG-DTE        PIC   X(10)  VALUE 'PRCG DATE '. 01600019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01610019
           05 RPT-PADJ-DEPT            PIC   X(04)  VALUE ' DPT'.       01620019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01630019
           05 RPT-PADJ-MCL             PIC   X(04)  VALUE ' MCL'.       01640019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01650019
           05 RPT-PADJ-SCL             PIC   X(04)  VALUE ' SCL'.       01660019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01670019
           05 RPT-PADJ-LOC             PIC   X(04)  VALUE ' LOC'.       01680019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01690019
           05 RPT-PADJ-ML-LO-DKEY      PIC   X(10)  VALUE ' BV DKEY  '. 01700019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01710019
           05 RPT-PADJ-ORIG-ENT-ID     PIC   X(09)  VALUE 'INPUT ENT'.  01720020
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01730019
           05 RPT-PADJ-ORIG-LBL-SEQ    PIC   X(09)  VALUE 'INPUT LBL'.  01740020
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       01750019
           05 RPT-PADJ-DMY-SKU-IND     PIC   X(03)  VALUE 'DMY'.        01760019
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       01770019
           05 RPT-PADJ-FINCL-GP        PIC   X(06)  VALUE ' GROUP'.     01780019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01790019
           05 RPT-PADJ-SRC-SYS-ID      PIC   X(04)  VALUE ' SYS'.       01800019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01810019
           05 RPT-PADJ-TRN-TYP-CDE     PIC   X(03)  VALUE 'TYP'.        01820019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01830019
           05 RPT-PADJ-AP-TRN-CDE      PIC   X(02)  VALUE 'AP'.         01840019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01850019
           05 RPT-PADJ-DRCR-CDE        PIC   X(02)  VALUE 'DC'.         01860019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01870019
           05 RPT-PADJ-AUD-ENT-ID      PIC   X(09)  VALUE 'AUD ENT  '.  01880021
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01890019
           05 RPT-PADJ-AUD-LBL-SEQ     PIC   X(09)  VALUE 'AUD LBL  '.  01900019
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01910019
           05 RPT-PADJ-MLV-ENT-ID      PIC   X(10)  VALUE 'MLV ENT   '. 01920020
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01930019
           05 RPT-PADJ-MLV-LBL-SEQ     PIC   X(09)  VALUE 'MLV LBL  '.  01940020
           05 FILLER                   PIC   X(01)  VALUE SPACES.       01950019
      *    05 RPT-PADJ-PADJ-GRO-COST   PIC   X(11) VALUE 'GROSS COST '. 01960035
      *    05 FILLER                   PIC   X(01)  VALUE SPACES.       01970035
      *    05 RPT-PADJ-PADJ-NET-COST   PIC   X(11) VALUE 'NET COST   '. 01980035
      *    05 FILLER                   PIC   X(01)  VALUE SPACES.       01990035
      *    05 RPT-PADJ-PADJ-RTL-AMT    PIC   X(11) VALUE 'RETAIL AMT '. 02000035
      *    05 FILLER                   PIC   X(01)  VALUE SPACES.       02010035
      *    05 RPT-PADJ-PADJ-DISC-COST  PIC   X(11) VALUE 'DISC COST  '. 02020035
      *    05 FILLER                   PIC   X(01)  VALUE SPACES.       02030035
                                                                        02040000
       01  REPORT-PADJ-LAYOUT.                                          02050019
           05 RP-PADJ-FSCL-WK-END-DTE        PIC   X(10)  VALUE SPACES. 02060019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02070019
           05 RP-PADJ-PRCG-DTE               PIC   X(10)  VALUE SPACES. 02080019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02090019
           05 RP-PADJ-DEPT-NBR               PIC   9(04)  VALUE ZEROES. 02100019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02110019
           05 RP-PADJ-MAJ-CL-NBR             PIC   9(04)  VALUE ZEROES. 02120019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02130019
           05 RP-PADJ-SUB-CL-NBR             PIC   9(04)  VALUE ZEROES. 02140019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02150019
           05 RP-PADJ-LOC-NBR                PIC   9(04)  VALUE ZEROES. 02160019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02170019
           05 RP-PADJ-ML-LO-MDSE-LVL-ID      PIC   9(10)  VALUE ZEROES. 02180019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02190019
           05 RP-PADJ-ORIG-ENT-ID            PIC   9(09)  VALUE ZEROES. 02200019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02210019
           05 RP-PADJ-ORIG-LBL-SEQ-NBR       PIC   9(09)  VALUE ZEROES. 02220019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02230019
           05 RP-PADJ-DMY-SKU-IND            PIC   X(01)  VALUE SPACES. 02240019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02250019
           05 RP-PADJ-FINCL-PRC-GP-CDE       PIC   X(06)  VALUE SPACES. 02260019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02270019
           05 RP-PADJ-SRC-SYS-ID             PIC   9(04)  VALUE ZEROES. 02280019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02290019
           05 RP-PADJ-TRN-TYP-CDE            PIC   X(03)  VALUE SPACES. 02300019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02310019
           05 RP-PADJ-AP-TRN-CDE             PIC   X(02)  VALUE SPACES. 02320019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02330019
           05 RP-PADJ-DRCR-CDE               PIC   X(02)  VALUE SPACES. 02340019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02350019
           05 RP-PADJ-AUD-ENT-ID             PIC   9(09)  VALUE ZEROES. 02360019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02370019
           05 RP-PADJ-AUD-LBL-SEQ-NBR        PIC   9(09)  VALUE ZEROES. 02380019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02390019
           05 RP-PADJ-MLV-ENT-ID             PIC   9(10)  VALUE ZEROES. 02400019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02410019
           05 RP-PADJ-MLV-LBL-SEQ            PIC   9(09)  VALUE ZEROES. 02420019
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02430035
           05 RP-PADJ-PADJ-GRO-COST-AMT      PIC  S9(11)V9(2) COMP-3.   02440035
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02450035
           05 RP-PADJ-PADJ-NET-COST-AMT      PIC  S9(11)V9(2) COMP-3.   02460035
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02470035
           05 RP-PADJ-PADJ-RTL-AMT           PIC  S9(11)V9(2) COMP-3.   02480035
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02490035
           05 RP-PADJ-PADJ-DISC-COST-AMT     PIC  S9(11)V9(2) COMP-3.   02500035
           05 FILLER                         PIC   X(01)  VALUE SPACES. 02510035
                                                                        02520019
       01  PV-PADJ-UPDATE-VARIABLES.                                    02530019
KEY        05  PADJ-FSCL-WK-END-DTE        PIC   X(10).                 02540007
 |         05  PADJ-PRCG-DTE               PIC   X(10).                 02550007
 |         05  PADJ-DEPT-NBR               PIC  S9(4)V COMP-3.          02560007
 |         05  PADJ-MAJ-CL-NBR             PIC  S9(4)V COMP-3.          02570007
 |         05  PADJ-SUB-CL-NBR             PIC  S9(4)V COMP-3.          02580007
 |         05  PADJ-LOC-NBR                PIC  S9(4) COMP.             02590007
 |         05  PADJ-ML-LO-MDSE-LVL-ID      PIC  S9(9) COMP.             02600007
 |         05  PADJ-ORIG-ENT-ID            PIC  S9(9) COMP.             02610007
 |         05  PADJ-ORIG-LBL-SEQ-NBR       PIC  S9(4) COMP.             02620007
 |         05  PADJ-DMY-SKU-IND            PIC   X(1).                  02630007
 |         05  PADJ-FINCL-PRC-GP-CDE       PIC   X(6).                  02640007
 |         05  PADJ-SRC-SYS-ID             PIC  S9(4) COMP.             02650007
 |         05  PADJ-TRN-TYP-CDE            PIC   X(3).                  02660007
 |         05  PADJ-AP-TRN-CDE             PIC   X(2).                  02670007
KEY        05  PADJ-DRCR-CDE               PIC   X(2).                  02680007
MLV        05  PADJ-MLV-ENT-ID             PIC  S9(9) COMP.             02690007
MLV        05  PADJ-MLV-LBL-SEQ            PIC  S9(4) COMP.             02700007
           05  PADJ-PADJ-GRO-COST-AMT      PIC  S9(11)V9(2) COMP-3.     02710007
           05  PADJ-PADJ-NET-COST-AMT      PIC  S9(11)V9(2) COMP-3.     02720007
           05  PADJ-PADJ-RTL-AMT           PIC  S9(11)V9(2) COMP-3.     02730007
           05  PADJ-PADJ-DISC-COST-AMT     PIC  S9(11)V9(2) COMP-3.     02740007
PADJ       05  PADJ-AUD-ENT-ID             PIC  S9(9) COMP.             02750007
PADJ       05  PADJ-AUD-LBL-SEQ-NBR        PIC  S9(4) COMP.             02760007
                                                                        02770025
    ****** SALES ***********                                            02780025
       01  REPORT-SLS-HEADER.                                           02790025
           05 RPT-SLS-FSCL-WK          PIC   X(10)  VALUE 'SALES  WK '. 02800035
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02810025
           05 RPT-SLS-PRCG-DTE         PIC   X(10)  VALUE 'PRCG DATE '. 02820025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02830025
           05 RPT-SLS-DEPT             PIC   X(04)  VALUE ' DPT'.       02840025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02850025
           05 RPT-SLS-MCL              PIC   X(04)  VALUE ' MCL'.       02860025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02870025
           05 RPT-SLS-SCL              PIC   X(04)  VALUE ' SCL'.       02880025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02890025
           05 RPT-SLS-LOC              PIC   X(04)  VALUE ' LOC'.       02900025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02910025
           05 RPT-SLS-ML-LO-DKEY       PIC   X(10)  VALUE ' BV DKEY  '. 02920025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02930025
           05 RPT-SLS-ORIG-ENT-ID      PIC   X(09)  VALUE 'INPUT ENT'.  02940025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       02950025
           05 RPT-SLS-ORIG-LBL-SEQ     PIC   X(09)  VALUE 'INP LBL  '.  02960025
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       02970025
           05 RPT-SLS-DMY-SKU-IND      PIC   X(03)  VALUE 'DMY'.        02980025
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       02990025
           05 RPT-SLS-FINCL-GP         PIC   X(06)  VALUE ' GROUP'.     03000025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03010025
           05 RPT-SLS-SRC-SYS-ID       PIC   X(04)  VALUE 'SYS '.       03020025
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       03030025
           05 RPT-SLS-SLS-TYP-CDE      PIC   X(03)  VALUE 'TYP'.        03040025
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       03050025
           05 RPT-SLS-TRN-TYP-CDE      PIC   X(03)  VALUE 'TRN'.        03060025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03070025
           05 RPT-SLS-AUD-ENT-ID       PIC   X(09)  VALUE 'AUD ENT  '.  03080025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03090025
           05 RPT-SLS-AUD-LBL-SEQ      PIC   X(09)  VALUE 'AUD LBL  '.  03100025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03110025
           05 RPT-SLS-MLV-ENT-ID       PIC   X(10)  VALUE 'MLV ENT   '. 03120025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03130025
           05 RPT-SLS-MLV-LBL-SEQ      PIC   X(09)  VALUE 'MLV LBL  '.  03140025
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03150035
           05 RPT-SLS-SLS-RTL-AMT      PIC   X(10)  VALUE 'SLS RTL   '. 03160035
                                                                        03170025
       01  REPORT-SLS-LAYOUT.                                           03180025
           05 RP-SLS-FSCL-WK-END-DTE         PIC   X(10)  VALUE SPACES. 03190025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03200025
           05 RP-SLS-PRCG-DTE                PIC   X(10)  VALUE SPACES. 03210025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03220025
           05 RP-SLS-DEPT-NBR                PIC   9(04)  VALUE ZEROES. 03230025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03240025
           05 RP-SLS-MAJ-CL-NBR              PIC   9(04)  VALUE ZEROES. 03250025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03260025
           05 RP-SLS-SUB-CL-NBR              PIC   9(04)  VALUE ZEROES. 03270025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03280025
           05 RP-SLS-LOC-NBR                 PIC   9(04)  VALUE ZEROES. 03290025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03300025
           05 RP-SLS-ML-LO-MDSE-LVL-ID       PIC   9(10)  VALUE ZEROES. 03310025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03320025
           05 RP-SLS-ORIG-ENT-ID             PIC   9(09)  VALUE ZEROES. 03330025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03340025
           05 RP-SLS-ORIG-LBL-SEQ-NBR        PIC   9(09)  VALUE ZEROES. 03350025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03360025
           05 RP-SLS-DMY-SKU-IND             PIC   X(01)  VALUE SPACES. 03370025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03380025
           05 RP-SLS-FINCL-PRC-GP-CDE        PIC   X(06)  VALUE SPACES. 03390025
           05 FILLER                         PIC   X(02)  VALUE SPACES. 03400035
           05 RP-SLS-SRC-SYS-ID              PIC   9(04)  VALUE ZEROES. 03410025
           05 FILLER                         PIC   X(02)  VALUE SPACES. 03420035
           05 RP-SLS-SLS-TYP-CDE             PIC   X(01)  VALUE SPACES. 03430025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03440025
           05 RP-SLS-TRN-TYP-CDE             PIC   X(03)  VALUE SPACES. 03450025
           05 FILLER                         PIC   X(04)  VALUE SPACES. 03460035
           05 RP-SLS-AUD-ENT-ID              PIC   9(09)  VALUE ZEROES. 03470025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03480025
           05 RP-SLS-AUD-LBL-SEQ-NBR         PIC   9(09)  VALUE ZEROES. 03490025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03500025
           05 RP-SLS-MLV-ENT-ID              PIC   9(10)  VALUE ZEROES. 03510025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03520025
           05 RP-SLS-MLV-LBL-SEQ             PIC   9(09)  VALUE ZEROES. 03530025
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03540025
           05 RP-SLS-SLS-RTL-AMT             PIC  S9(11)V9(2) COMP-3.   03550035
           05 FILLER                         PIC   X(01)  VALUE SPACES. 03560035
                                                                        03570025
       01  PV-SLS-UPDATE-VARIABLES.                                     03580025
KEY        05  SLS-FSCL-WK-END-DTE         PIC   X(10).                 03590025
 |         05  SLS-PRCG-DTE                PIC   X(10).                 03600025
 |         05  SLS-DEPT-NBR                PIC  S9(4)V COMP-3.          03610025
 |         05  SLS-MAJ-CL-NBR              PIC  S9(4)V COMP-3.          03620025
 |         05  SLS-SUB-CL-NBR              PIC  S9(4)V COMP-3.          03630025
 |         05  SLS-LOC-NBR                 PIC  S9(4) COMP.             03640025
 |         05  SLS-ML-LO-MDSE-LVL-ID       PIC  S9(9) COMP.             03650025
 |         05  SLS-ORIG-ENT-ID             PIC  S9(9) COMP.             03660025
 |         05  SLS-ORIG-LBL-SEQ-NBR        PIC  S9(4) COMP.             03670025
 |         05  SLS-DMY-SKU-IND             PIC   X(1).                  03680025
 |         05  SLS-FINCL-PRC-GP-CDE        PIC   X(6).                  03690025
 |         05  SLS-SRC-SYS-ID              PIC  S9(4) COMP.             03700025
 |         05  SLS-SLS-TYP-CDE             PIC   X(1).                  03710025
KEY        05  SLS-TRN-TYP-CDE             PIC   X(3).                  03720025
MLV        05  SLS-MLV-ENT-ID              PIC  S9(9) COMP.             03730025
MLV        05  SLS-MLV-LBL-SEQ-NBR         PIC  S9(4) COMP.             03740025
           05  SLS-SLS-RTL-AMT             PIC  S9(11)V9(2) COMP-3.     03750025
AUD        05  SLS-AUD-ENT-ID              PIC  S9(9) COMP.             03760025
AUD        05  SLS-AUD-LBL-SEQ-NBR         PIC  S9(4) COMP.             03770025
                                                                        03780025
    ****** PRICE CHANGES ***********                                    03790029
       01  REPORT-PCHG-HEADER.                                          03800029
           05 RPT-PCHG-FSCL-WK         PIC   X(10)  VALUE 'MKDOWN WK '. 03810035
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03820029
           05 RPT-PCHG-PRCG-DTE        PIC   X(10)  VALUE 'PRCG DATE '. 03830029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03840029
           05 RPT-PCHG-DEPT            PIC   X(04)  VALUE ' DPT'.       03850029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03860029
           05 RPT-PCHG-MCL             PIC   X(04)  VALUE ' MCL'.       03870029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03880029
           05 RPT-PCHG-SCL             PIC   X(04)  VALUE ' SCL'.       03890029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03900029
           05 RPT-PCHG-LOC             PIC   X(04)  VALUE ' LOC'.       03910029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03920029
           05 RPT-PCHG-ML-LO-DKEY      PIC   X(10)  VALUE ' BV DKEY  '. 03930029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03940029
           05 RPT-PCHG-ORIG-ENT-ID     PIC   X(09)  VALUE 'INPUT ENT'.  03950029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       03960029
           05 RPT-PCHG-ORIG-LBL-SEQ    PIC   X(09)  VALUE 'INPUT LBL'.  03970029
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       03980029
           05 RPT-PCHG-DMY-SKU-IND     PIC   X(03)  VALUE 'DMY'.        03990029
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       04000029
           05 RPT-PCHG-FINCL-GP        PIC   X(06)  VALUE ' GROUP'.     04010029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04020029
           05 RPT-PCHG-SRC-SYS-ID      PIC   X(04)  VALUE ' SYS'.       04030029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04040029
           05 RPT-PCHG-TRN-TYP-CDE     PIC   X(03)  VALUE 'TYP'.        04050029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04060029
           05 RPT-PCHG-PRCHG-RSN-CDE   PIC   X(04)  VALUE 'RSN '.       04070029
     **    05 FILLER                   PIC   X(01)  VALUE SPACES.       04080029
           05 RPT-PCHG-PRCHG-CTG-CDE   PIC   X(03)  VALUE 'CTG'.        04090029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04100029
           05 RPT-PCHG-AUD-ENT-ID      PIC   X(09)  VALUE 'AUD ENT  '.  04110029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04120029
           05 RPT-PCHG-AUD-LBL-SEQ     PIC   X(09)  VALUE 'AUD LBL  '.  04130029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04140029
           05 RPT-PCHG-MLV-ENT-ID      PIC   X(10)  VALUE 'MLV ENT   '. 04150029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04160029
           05 RPT-PCHG-MLV-LBL-SEQ     PIC   X(09)  VALUE 'MLV LBL  '.  04170029
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04180029
           05 RPT-PCHG-PRCHG-RTL-AMT   PIC   X(11) VALUE 'RETAIL AMT '. 04190035
           05 FILLER                   PIC   X(01)  VALUE SPACES.       04200035
                                                                        04210029
       01  REPORT-PCHG-LAYOUT.                                          04220029
           05 RP-PCHG-FSCL-WK-END-DTE        PIC   X(10)  VALUE SPACES. 04230029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04240029
           05 RP-PCHG-PRCG-DTE               PIC   X(10)  VALUE SPACES. 04250029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04260029
           05 RP-PCHG-DEPT-NBR               PIC   9(04)  VALUE ZEROES. 04270029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04280029
           05 RP-PCHG-MAJ-CL-NBR             PIC   9(04)  VALUE ZEROES. 04290029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04300029
           05 RP-PCHG-SUB-CL-NBR             PIC   9(04)  VALUE ZEROES. 04310029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04320029
           05 RP-PCHG-LOC-NBR                PIC   9(04)  VALUE ZEROES. 04330029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04340029
           05 RP-PCHG-ML-LO-MDSE-LVL-ID      PIC   9(10)  VALUE ZEROES. 04350029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04360029
           05 RP-PCHG-ORIG-ENT-ID            PIC   9(09)  VALUE ZEROES. 04370029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04380029
           05 RP-PCHG-ORIG-LBL-SEQ-NBR       PIC   9(09)  VALUE ZEROES. 04390029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04400029
           05 RP-PCHG-DMY-SKU-IND            PIC   X(01)  VALUE SPACES. 04410030
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04420029
           05 RP-PCHG-FINCL-PRC-GP-CDE       PIC   X(06)  VALUE SPACES. 04430030
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04440029
           05 RP-PCHG-SRC-SYS-ID             PIC   9(04)  VALUE ZEROES. 04450029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04460029
           05 RP-PCHG-TRN-TYP-CDE            PIC   X(03)  VALUE SPACES. 04470030
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04480029
           05 RP-PCHG-PRCHG-RSN-CDE          PIC   X(04)  VALUE SPACES. 04490029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04500029
           05 RP-PCHG-PRCHG-CTG-CDE          PIC   X(02)  VALUE SPACES. 04510029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04520029
           05 RP-PCHG-AUD-ENT-ID             PIC   9(09)  VALUE ZEROES. 04530029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04540029
           05 RP-PCHG-AUD-LBL-SEQ-NBR        PIC   9(09)  VALUE ZEROES. 04550029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04560029
           05 RP-PCHG-MLV-ENT-ID             PIC   9(10)  VALUE ZEROES. 04570029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04580029
           05 RP-PCHG-MLV-LBL-SEQ            PIC   9(09)  VALUE ZEROES. 04590029
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04600029
           05 RP-PCHG-PRCHG-RTL-AMT          PIC  S9(11)V9(2) COMP-3.   04610035
           05 FILLER                         PIC   X(01)  VALUE SPACES. 04620035
                                                                        04630029
       01  PV-PCHG-UPDATE-VARIABLES.                                    04640029
KEY        05  PCHG-FSCL-WK-END-DTE        PIC   X(10).                 04650029
 |         05  PCHG-PRCG-DTE               PIC   X(10).                 04660029
 |         05  PCHG-DEPT-NBR               PIC  S9(4)V COMP-3.          04670029
 |         05  PCHG-MAJ-CL-NBR             PIC  S9(4)V COMP-3.          04680029
 |         05  PCHG-SUB-CL-NBR             PIC  S9(4)V COMP-3.          04690029
 |         05  PCHG-LOC-NBR                PIC  S9(4) COMP.             04700029
 |         05  PCHG-ML-LO-MDSE-LVL-ID      PIC  S9(9) COMP.             04710029
 |         05  PCHG-ORIG-ENT-ID            PIC  S9(9) COMP.             04720029
 |         05  PCHG-ORIG-LBL-SEQ-NBR       PIC  S9(4) COMP.             04730029
 |         05  PCHG-DMY-SKU-IND            PIC   X(1).                  04740029
 |         05  PCHG-FINCL-PRC-GP-CDE       PIC   X(6).                  04750029
 |         05  PCHG-SRC-SYS-ID             PIC  S9(4) COMP.             04760029
 |         05  PCHG-TRN-TYP-CDE            PIC   X(3).                  04770029
 |         05  PCHG-PRCHG-RSN-CDE          PIC   X(4).                  04780029
KEY        05  PCHG-PRCHG-CTG-CDE          PIC   X(2).                  04790029
MLV        05  PCHG-MLV-ENT-ID             PIC  S9(9) COMP.             04800029
MLV        05  PCHG-MLV-LBL-SEQ-NBR        PIC  S9(4) COMP.             04810032
           05  PCHG-PRCHG-RTL-AMT          PIC  S9(11)V9(2) COMP-3.     04820031
PADJ       05  PCHG-AUD-ENT-ID             PIC  S9(9) COMP.             04830029
PADJ       05  PCHG-AUD-LBL-SEQ-NBR        PIC  S9(4) COMP.             04840029
                                                                        04850029
                                                                        04860007
      ******************************************************************04870000
      *  DB2 ERROR MESSAGES FORMAT AREA.                                04880000
      ******************************************************************04890000
           COPY DPWS004.                                                04900000
                                                                        04910000
      ******************************************************************04920000
      *  USED FOR DB2 ERRORS                                            04930000
      ******************************************************************04940000
           EXEC SQL                                                     04950000
               INCLUDE SQLCA                                            04960000
           END-EXEC.                                                    04970000
                                                                        04980000
      ******************************************************************04990000
      *  DATE CONTROL TABLE                                             05000004
      ******************************************************************05010000
           EXEC SQL                                                     05020000
               INCLUDE TDTATTR                                          05030004
           END-EXEC.                                                    05040000
                                                                        05050000
      ******************************************************************05060004
      *  BRAND VENDOR AUDIT TABLE - MLT_PRCHG_TRN_DTL                   05070029
      ******************************************************************05080004
           EXEC SQL                                                     05090004
               INCLUDE MLT00038                                         05100029
           END-EXEC.                                                    05110004
                                                                        05120004
      ******************************************************************05130029
      *  BRAND VENDOR AUDIT TABLE - MLT_PADJ_TRN_DTL                    05140029
      ******************************************************************05150029
           EXEC SQL                                                     05160029
               INCLUDE MLT00039                                         05170029
           END-EXEC.                                                    05180029
                                                                        05190029
      ******************************************************************05200025
      *  BRAND VENDOR AUDIT TABLE - MLT_SLS_TRN_DTL                     05210025
      ******************************************************************05220025
           EXEC SQL                                                     05230025
               INCLUDE MLT00040                                         05240025
           END-EXEC.                                                    05250025
                                                                        05260025
      ******************************************************************05270003
      *  DEPT BRAND VENDOR DKEY RELATIONSHIP VIEW                       05280003
      ******************************************************************05290003
           EXEC SQL                                                     05300003
               INCLUDE MLV00000                                         05310003
           END-EXEC.                                                    05320003
                                                                        05330002
      ******************************************************************05340003
      * DEPT BRAND VENDOR DKEY RELATIONSHIP VIEW - PURCHASE ADJUSTMENTS 05350025
      ******************************************************************05360003
           EXEC SQL                                                     05370002
            DECLARE MLT_PADJ_CSR CURSOR FOR                             05380003
                                                                        05390002
            SELECT                                                      05400004
KEY             A.FSCL_WK_END_DTE                                       05410002
 |             ,A.PRCG_DTE                                              05420003
 |             ,A.DEPT_NBR                                              05430003
 |             ,A.MAJ_CL_NBR                                            05440003
 |             ,A.SUB_CL_NBR                                            05450003
 |             ,A.LOC_NBR                                               05460003
 |             ,A.ML_LO_MDSE_LVL_ID                                     05470003
 |             ,A.ORIG_ENT_ID                                           05480003
 |             ,A.ORIG_LBL_SEQ_NBR                                      05490003
 |             ,A.DMY_SKU_IND                                           05500003
 |             ,A.FINCL_PRC_GP_CDE                                      05510003
 |             ,A.SRC_SYS_ID                                            05520003
 |             ,A.TRN_TYP_CDE                                           05530003
 |             ,A.AP_TRN_CDE                                            05540003
KEY            ,A.DRCR_CDE                                              05550003
MLV            ,B.ENT_ID                                                05560003
MLV            ,B.LBL_SEQ_NBR                                           05570003
               ,A.PADJ_GRO_COST_AMT                                     05580003
               ,A.PADJ_NET_COST_AMT                                     05590003
               ,A.PADJ_RTL_AMT                                          05600003
               ,A.PADJ_DISC_COST_AMT                                    05610003
PADJ           ,A.ENT_ID                                                05620003
PADJ           ,A.LBL_SEQ_NBR                                           05630003
            FROM MLT_PADJ_TRN_DTL A                                     05640003
                ,MLV_BRND_VND    B                                      05650003
            WHERE (A.FSCL_WK_END_DTE BETWEEN :PV-START-DATE             05660011
                                        AND  :PV-END-DATE)              05670011
              AND  A.ML_LO_MDSE_LVL_ID = B.ML_LO_MDSE_LVL_ID            05680003
              AND (A.ENT_ID      <> B.ENT_ID                            05690003
              OR   A.LBL_SEQ_NBR <> B.LBL_SEQ_NBR)                      05700003
            ORDER BY                                                    05710013
                A.FSCL_WK_END_DTE                                       05720013
               ,A.PRCG_DTE                                              05730013
               ,A.DEPT_NBR                                              05740013
               ,A.MAJ_CL_NBR                                            05750013
               ,A.SUB_CL_NBR                                            05760013
               ,A.LOC_NBR                                               05770013
               ,A.ML_LO_MDSE_LVL_ID                                     05780013
               ,A.ORIG_ENT_ID                                           05790013
               ,A.ORIG_LBL_SEQ_NBR                                      05800013
               ,A.DMY_SKU_IND                                           05810013
               ,A.FINCL_PRC_GP_CDE                                      05820013
               ,A.SRC_SYS_ID                                            05830013
               ,A.TRN_TYP_CDE                                           05840013
               ,A.AP_TRN_CDE                                            05850013
               ,A.DRCR_CDE                                              05860013
           END-EXEC.                                                    05870003
                                                                        05880002
      ******************************************************************05890025
      * DEPT BRAND VENDOR DKEY RELATIONSHIP VIEW - SALES                05900025
      ******************************************************************05910025
           EXEC SQL                                                     05920025
            DECLARE MLT_SLS_CSR CURSOR FOR                              05930025
                                                                        05940025
            SELECT                                                      05950025
KEY             A.FSCL_WK_END_DTE                                       05960025
 |             ,A.PRCG_DTE                                              05970025
 |             ,A.DEPT_NBR                                              05980025
 |             ,A.MAJ_CL_NBR                                            05990025
 |             ,A.SUB_CL_NBR                                            06000025
 |             ,A.LOC_NBR                                               06010025
 |             ,A.ML_LO_MDSE_LVL_ID                                     06020025
 |             ,A.ORIG_ENT_ID                                           06030025
 |             ,A.ORIG_LBL_SEQ_NBR                                      06040025
 |             ,A.DMY_SKU_IND                                           06050025
 |             ,A.FINCL_PRC_GP_CDE                                      06060025
 |             ,A.SRC_SYS_ID                                            06070025
 |             ,A.SLS_TYP_CDE                                           06080025
KEY            ,A.TRN_TYP_CDE                                           06090025
MLV            ,B.ENT_ID                                                06100025
MLV            ,B.LBL_SEQ_NBR                                           06110025
               ,A.SLS_RTL_AMT                                           06120025
AUD            ,A.ENT_ID                                                06130025
AUD            ,A.LBL_SEQ_NBR                                           06140025
            FROM MLT_SLS_TRN_DTL A                                      06150025
                ,MLV_BRND_VND    B                                      06160025
            WHERE (A.FSCL_WK_END_DTE BETWEEN :PV-START-DATE             06170025
                                        AND  :PV-END-DATE)              06180025
              AND  A.ML_LO_MDSE_LVL_ID = B.ML_LO_MDSE_LVL_ID            06190025
              AND (A.ENT_ID      <> B.ENT_ID                            06200025
              OR   A.LBL_SEQ_NBR <> B.LBL_SEQ_NBR)                      06210025
            ORDER BY                                                    06220025
                A.FSCL_WK_END_DTE                                       06230025
               ,A.PRCG_DTE                                              06240025
               ,A.DEPT_NBR                                              06250025
               ,A.MAJ_CL_NBR                                            06260025
               ,A.SUB_CL_NBR                                            06270025
               ,A.LOC_NBR                                               06280025
               ,A.ML_LO_MDSE_LVL_ID                                     06290025
               ,A.ORIG_ENT_ID                                           06300025
               ,A.ORIG_LBL_SEQ_NBR                                      06310025
               ,A.DMY_SKU_IND                                           06320025
               ,A.FINCL_PRC_GP_CDE                                      06330025
               ,A.SRC_SYS_ID                                            06340025
               ,A.SLS_TYP_CDE                                           06350025
               ,A.TRN_TYP_CDE                                           06360025
           END-EXEC.                                                    06370025
                                                                        06380025
      ******************************************************************06390029
      * DEPT BRAND VENDOR DKEY RELATIONSHIP VIEW - PRICE CHANGES        06400029
      ******************************************************************06410029
           EXEC SQL                                                     06420029
            DECLARE MLT_PCHG_CSR CURSOR FOR                             06430029
                                                                        06440029
            SELECT                                                      06450029
KEY             A.FSCL_WK_END_DTE                                       06460029
 |             ,A.PRCG_DTE                                              06470029
 |             ,A.DEPT_NBR                                              06480029
 |             ,A.MAJ_CL_NBR                                            06490029
 |             ,A.SUB_CL_NBR                                            06500029
 |             ,A.LOC_NBR                                               06510029
 |             ,A.ML_LO_MDSE_LVL_ID                                     06520029
 |             ,A.ORIG_ENT_ID                                           06530029
 |             ,A.ORIG_LBL_SEQ_NBR                                      06540029
 |             ,A.DMY_SKU_IND                                           06550029
 |             ,A.FINCL_PRC_GP_CDE                                      06560029
 |             ,A.SRC_SYS_ID                                            06570029
 |             ,A.TRN_TYP_CDE                                           06580029
 |             ,A.PRCHG_RSN_CDE                                         06590029
KEY            ,A.PRCHG_CTG_CDE                                         06600029
MLV            ,B.ENT_ID                                                06610029
MLV            ,B.LBL_SEQ_NBR                                           06620029
               ,A.PRCHG_RTL_AMT                                         06630029
AUD            ,A.ENT_ID                                                06640029
AUD            ,A.LBL_SEQ_NBR                                           06650029
            FROM MLT_PRCHG_TRN_DTL A                                    06660029
                ,MLV_BRND_VND    B                                      06670029
            WHERE (A.FSCL_WK_END_DTE BETWEEN :PV-START-DATE             06680029
                                        AND  :PV-END-DATE)              06690029
              AND  A.ML_LO_MDSE_LVL_ID = B.ML_LO_MDSE_LVL_ID            06700029
              AND (A.ENT_ID      <> B.ENT_ID                            06710029
              OR   A.LBL_SEQ_NBR <> B.LBL_SEQ_NBR)                      06720029
            ORDER BY                                                    06730029
                A.FSCL_WK_END_DTE                                       06740029
               ,A.PRCG_DTE                                              06750029
               ,A.DEPT_NBR                                              06760029
               ,A.MAJ_CL_NBR                                            06770029
               ,A.SUB_CL_NBR                                            06780029
               ,A.LOC_NBR                                               06790029
               ,A.ML_LO_MDSE_LVL_ID                                     06800029
               ,A.ORIG_ENT_ID                                           06810029
               ,A.ORIG_LBL_SEQ_NBR                                      06820029
               ,A.DMY_SKU_IND                                           06830029
               ,A.FINCL_PRC_GP_CDE                                      06840029
               ,A.SRC_SYS_ID                                            06850029
               ,A.TRN_TYP_CDE                                           06860033
               ,A.PRCHG_RSN_CDE                                         06870029
               ,A.PRCHG_CTG_CDE                                         06880029
           END-EXEC.                                                    06890029
                                                                        06900029
                                                                        06910029
      *================================================================*06920002
       PROCEDURE DIVISION.                                              06930000
      *================================================================*06940000
      ******************************************************************06950000
      * PROGRAM LOGIC                                                   06960000
      ******************************************************************06970000
       0000-MLKUP707.                                                   06980000
                                                                        06990000
           PERFORM 1000-INITIALIZATION.                                 07000000
                                                                        07010003
           PERFORM 2000-AUD-PADJ-VALIDATION.                            07020004
           PERFORM 3000-AUD-SLS-VALIDATION.                             07030025
           PERFORM 4000-AUD-PCHG-VALIDATION.                            07040030
                                                                        07050000
           PERFORM 8000-EOJ-ROUTINE.                                    07060000
                                                                        07070000
           STOP RUN.                                                    07080000
                                                                        07090000
      ******************************************************************07100000
      * OPEN INPUT FILE , INITIALIZE COUNTERS , READ FIRST INPUT RECORD 07110000
      * PREPARE CHECKPOINT RESTART TABLES FOR PROCESSING / RESTART      07120000
      ******************************************************************07130000
       1000-INITIALIZATION.                                             07140000
                                                                        07150000
           OPEN INPUT  PROCESS-DATE-FILE.                               07160016
           OPEN OUTPUT REPORT-TABLE-UPDATE.                             07170016
                                                                        07180000
           PERFORM 1100-READ-DATE-CONTROL.                              07190003
                                                                        07200003
           INITIALIZE PS-PROGRAM-SWITCHES                               07210007
                      PA-PROGRAM-ACCUMULATORS.                          07220007
      *                                                                 07230007
      *                                                                 07240007
      ******************************************************************07250003
      * DATE CONTROL INPUT PROCESSING                                   07260004
      ******************************************************************07270003
      *                                                                 07280003
       1100-READ-DATE-CONTROL.                                          07290003
                                                                        07300003
           READ PROCESS-DATE-FILE INTO CC-DATE-CONTROL                  07310003
               AT END                                                   07320003
                  SET PS-EOF-DATE-INPUT TO TRUE.                        07330004
                                                                        07340003
           IF PS-EOF-DATE-INPUT                                         07350004
                   MOVE '1100-READ-DATE-CONTROL' TO PV-PARAGRAPH-NAME   07360004
                   MOVE PE-MSG-01 TO PV-OPERATION-ATTEMPTED             07370004
                   PERFORM 9999-SQL-ABEND                               07380004
           ELSE                                                         07390003
               MOVE INPUT-START-DATE   TO PV-START-DATE                 07400010
               MOVE INPUT-END-DATE     TO PV-END-DATE                   07410010
               DISPLAY ' '                                              07420035
               DISPLAY 'MLKUP707 - INPUT CONTROL CARD'                  07430035
               DISPLAY ' ', CC-DATE-CONTROL                             07440023
               PERFORM 6000-VALIDATE-DATES                              07450004
           END-IF.                                                      07460003
                                                                        07470000
      ******************************************************************07480004
      * PROCESS THE SORTED/CONDENSED FILE - UPDATE OR INSERT AS NEEDED  07490000
      ******************************************************************07500000
       2000-AUD-PADJ-VALIDATION.                                        07510004
                                                                        07520000
           PERFORM 2100-OPEN-PADJ-CSR.                                  07530003
           PERFORM 2200-FETCH-PADJ-CSR.                                 07540003
                                                                        07550004
           IF PS-AUDIT-PADJ-UPD-REQD                                    07560004
               DISPLAY ' '                                              07570035
               DISPLAY ' MLT_PADJ_TRN_DTL = MISMATCHES FOUND   '        07580024
               PERFORM 6300-WRITE-PADJ-RPT-HEADER                       07590020
               PERFORM 2300-PROCESS-PADJ-AUDIT                          07600020
                   UNTIL PS-END-OF-CSR                                  07610018
           END-IF.                                                      07620004
                                                                        07630000
           PERFORM 2400-CLOSE-PADJ-CUR.                                 07640018
      ***************************************************************** 07650003
      * OPEN CURSOR FOR UPDATE                                          07660003
      ***************************************************************** 07670003
       2100-OPEN-PADJ-CSR.                                              07680003
      *                                                                 07690003
           EXEC SQL                                                     07700003
               OPEN MLT_PADJ_CSR                                        07710003
           END-EXEC                                                     07720003
                                                                        07730003
           EVALUATE SQLCODE                                             07740003
               WHEN 0                                                   07750003
                  SET PS-NOT-END-OF-CSR TO TRUE                         07760021
               WHEN OTHER                                               07770003
                  MOVE '2100-OPEN-PADJ-CSR' TO PV-PARAGRAPH-NAME        07780003
                  MOVE PE-MSG-04 TO PV-OPERATION-ATTEMPTED              07790004
                  PERFORM 9999-SQL-ABEND                                07800003
           END-EVALUATE.                                                07810003
      ***************************************************************** 07820003
      * PROCESS THE MLT_PADJ_TRN_DTL DISCREPANCIES (WITH MLV ATTR)      07830003
      ***************************************************************** 07840003
       2200-FETCH-PADJ-CSR.                                             07850003
      *                                                                 07860003
           EXEC SQL                                                     07870003
             FETCH MLT_PADJ_CSR INTO                                    07880004
                   :PADJ-FSCL-WK-END-DTE                                07890004
                  ,:PADJ-PRCG-DTE                                       07900004
                  ,:PADJ-DEPT-NBR                                       07910004
                  ,:PADJ-MAJ-CL-NBR                                     07920004
                  ,:PADJ-SUB-CL-NBR                                     07930004
                  ,:PADJ-LOC-NBR                                        07940004
                  ,:PADJ-ML-LO-MDSE-LVL-ID                              07950004
                  ,:PADJ-ORIG-ENT-ID                                    07960004
                  ,:PADJ-ORIG-LBL-SEQ-NBR                               07970004
                  ,:PADJ-DMY-SKU-IND                                    07980004
                  ,:PADJ-FINCL-PRC-GP-CDE                               07990004
                  ,:PADJ-SRC-SYS-ID                                     08000004
                  ,:PADJ-TRN-TYP-CDE                                    08010004
                  ,:PADJ-AP-TRN-CDE                                     08020004
                  ,:PADJ-DRCR-CDE                                       08030004
                  ,:PADJ-MLV-ENT-ID                                     08040004
                  ,:PADJ-MLV-LBL-SEQ                                    08050004
                  ,:PADJ-PADJ-GRO-COST-AMT                              08060004
                  ,:PADJ-PADJ-NET-COST-AMT                              08070004
                  ,:PADJ-PADJ-RTL-AMT                                   08080004
                  ,:PADJ-PADJ-DISC-COST-AMT                             08090004
                  ,:PADJ-AUD-ENT-ID                                     08100004
                  ,:PADJ-AUD-LBL-SEQ-NBR                                08110004
           END-EXEC                                                     08120003
                                                                        08130003
           EVALUATE SQLCODE                                             08140003
               WHEN +0                                                  08150003
                    MOVE 'Y' TO PS-AUDIT-PADJ-UPD-SW                    08160004
               WHEN +100                                                08170003
                 DISPLAY ' END OF MLT_PADJ_TRN_DTL                    ' 08180023
                 DISPLAY '********************************************' 08190023
                    MOVE 'Y' TO PS-END-OF-CURSOR-SW                     08200021
               WHEN OTHER                                               08210003
                   MOVE '2200-FETCH-PADJ-CSR' TO PV-PARAGRAPH-NAME      08220004
                   MOVE PE-MSG-05 TO PV-OPERATION-ATTEMPTED             08230004
                   PERFORM 9999-SQL-ABEND                               08240003
           END-EVALUATE.                                                08250003
      *                                                                 08260003
      ***************************************************************** 08270006
      * PROCESS THE PURCHASE ADJUSTMENTS                                08280006
      ***************************************************************** 08290006
      *                                                                 08300006
       2300-PROCESS-PADJ-AUDIT.                                         08310004
      *                                                                 08320004
           PERFORM 6100-FORMAT-PADJ-RPT.                                08330005
      *                                                                 08340005
           IF CC-AUDIT-MODE                                             08350005
              PERFORM 6200-WRITE-PADJ-RPT                               08360005
           ELSE                                                         08370005
              PERFORM 7000-UPDATE-MLT-PADJ-ROW                          08380005
              PERFORM 6200-WRITE-PADJ-RPT                               08390005
           END-IF.                                                      08400005
      *                                                                 08410005
           PERFORM 2200-FETCH-PADJ-CSR.                                 08420022
      ***************************************************************** 08430006
      * CLOSE CURSOR                                                    08440006
      ***************************************************************** 08450006
       2400-CLOSE-PADJ-CUR.                                             08460006
      *                                                                 08470006
           EXEC SQL                                                     08480006
               CLOSE MLT_PADJ_CSR                                       08490006
           END-EXEC                                                     08500006
                                                                        08510006
           EVALUATE SQLCODE                                             08520006
               WHEN 0                                                   08530006
                    CONTINUE                                            08540006
               WHEN OTHER                                               08550006
                  MOVE '2400-CLOSE-PADJ-CUR  ' TO PV-PARAGRAPH-NAME     08560006
                  MOVE PE-MSG-06 TO PV-OPERATION-ATTEMPTED              08570007
                  PERFORM 9999-SQL-ABEND                                08580006
           END-EVALUATE.                                                08590006
      *                                                                 08600006
      ******************************************************************08610025
      * PROCESS THE SORTED/CONDENSED FILE - UPDATE OR INSERT AS NEEDED  08620025
      ******************************************************************08630025
       3000-AUD-SLS-VALIDATION.                                         08640025
                                                                        08650025
           MOVE 'N' TO PS-END-OF-CURSOR-SW                              08660025
           PERFORM 3100-OPEN-SLS-CSR.                                   08670025
           PERFORM 3200-FETCH-SLS-CSR.                                  08680025
                                                                        08690025
           IF PS-AUDIT-SLS-UPD-REQD                                     08700025
               DISPLAY ' '                                              08710035
               DISPLAY ' MLT_SLS_TRN_DTL = MISMATCHES FOUND   '         08720025
               PERFORM 6310-WRITE-SLS-RPT-HEADER                        08730026
               PERFORM 3300-PROCESS-SLS-AUDIT                           08740025
                   UNTIL PS-END-OF-CSR                                  08750025
           END-IF.                                                      08760025
                                                                        08770025
           PERFORM 3400-CLOSE-SLS-CUR.                                  08780025
      ***************************************************************** 08790025
      * OPEN CURSOR FOR UPDATE                                          08800025
      ***************************************************************** 08810025
       3100-OPEN-SLS-CSR.                                               08820025
      *                                                                 08830025
           EXEC SQL                                                     08840025
               OPEN MLT_SLS_CSR                                         08850025
           END-EXEC                                                     08860025
                                                                        08870025
           EVALUATE SQLCODE                                             08880025
               WHEN 0                                                   08890025
                  SET PS-NOT-END-OF-CSR TO TRUE                         08900025
               WHEN OTHER                                               08910025
                  MOVE '3100-OPEN-SLS-CSR' TO PV-PARAGRAPH-NAME         08920025
                  MOVE PE-MSG-04 TO PV-OPERATION-ATTEMPTED              08930025
                  PERFORM 9999-SQL-ABEND                                08940025
           END-EVALUATE.                                                08950025
      ***************************************************************** 08960025
      * PROCESS THE MLT_SLS_TRN_DTL DISCREPANCIES (WITH MLV ATTR)       08970025
      ***************************************************************** 08980025
       3200-FETCH-SLS-CSR.                                              08990025
      *                                                                 09000025
           EXEC SQL                                                     09010025
             FETCH MLT_SLS_CSR INTO                                     09020025
                   :SLS-FSCL-WK-END-DTE                                 09030025
                  ,:SLS-PRCG-DTE                                        09040025
                  ,:SLS-DEPT-NBR                                        09050025
                  ,:SLS-MAJ-CL-NBR                                      09060025
                  ,:SLS-SUB-CL-NBR                                      09070025
                  ,:SLS-LOC-NBR                                         09080025
                  ,:SLS-ML-LO-MDSE-LVL-ID                               09090025
                  ,:SLS-ORIG-ENT-ID                                     09100025
                  ,:SLS-ORIG-LBL-SEQ-NBR                                09110025
                  ,:SLS-DMY-SKU-IND                                     09120025
                  ,:SLS-FINCL-PRC-GP-CDE                                09130025
                  ,:SLS-SRC-SYS-ID                                      09140025
                  ,:SLS-SLS-TYP-CDE                                     09150025
                  ,:SLS-TRN-TYP-CDE                                     09160025
MLV               ,:SLS-MLV-ENT-ID                                      09170025
MLV               ,:SLS-MLV-LBL-SEQ-NBR                                 09180025
                  ,:SLS-SLS-RTL-AMT                                     09190025
AUD               ,:SLS-AUD-ENT-ID                                      09200025
AUD               ,:SLS-AUD-LBL-SEQ-NBR                                 09210025
           END-EXEC                                                     09220025
                                                                        09230025
           EVALUATE SQLCODE                                             09240025
               WHEN +0                                                  09250025
                    MOVE 'Y' TO PS-AUDIT-SLS-UPD-SW                     09260025
               WHEN +100                                                09270025
                 DISPLAY ' END OF MLT_SLS_TRN_DTL                    '  09280025
                 DISPLAY '********************************************' 09290025
                    MOVE 'Y' TO PS-END-OF-CURSOR-SW                     09300025
               WHEN OTHER                                               09310025
                   MOVE '3200-FETCH-SLS-CSR' TO PV-PARAGRAPH-NAME       09320025
                   MOVE PE-MSG-05 TO PV-OPERATION-ATTEMPTED             09330025
                   PERFORM 9999-SQL-ABEND                               09340025
           END-EVALUATE.                                                09350025
      *                                                                 09360025
      ***************************************************************** 09370025
      * PROCESS THE PURCHASE ADJUSTMENTS                                09380025
      ***************************************************************** 09390025
      *                                                                 09400025
       3300-PROCESS-SLS-AUDIT.                                          09410025
      *                                                                 09420025
           PERFORM 6110-FORMAT-SLS-RPT.                                 09430025
      *                                                                 09440025
           IF CC-AUDIT-MODE                                             09450025
              PERFORM 6210-WRITE-SLS-RPT                                09460025
           ELSE                                                         09470025
              PERFORM 7100-UPDATE-MLT-SLS-ROW                           09480025
              PERFORM 6210-WRITE-SLS-RPT                                09490025
           END-IF.                                                      09500025
      *                                                                 09510025
           PERFORM 3200-FETCH-SLS-CSR.                                  09520025
      ***************************************************************** 09530025
      * CLOSE CURSOR                                                    09540025
      ***************************************************************** 09550025
       3400-CLOSE-SLS-CUR.                                              09560025
      *                                                                 09570025
           EXEC SQL                                                     09580025
               CLOSE MLT_SLS_CSR                                        09590025
           END-EXEC                                                     09600025
                                                                        09610025
           EVALUATE SQLCODE                                             09620025
               WHEN 0                                                   09630025
                    CONTINUE                                            09640025
               WHEN OTHER                                               09650025
                  MOVE '2400-CLOSE-SLS-CUR  ' TO PV-PARAGRAPH-NAME      09660025
                  MOVE PE-MSG-06 TO PV-OPERATION-ATTEMPTED              09670025
                  PERFORM 9999-SQL-ABEND                                09680025
           END-EVALUATE.                                                09690025
      *                                                                 09700025
      ******************************************************************09710029
      * PROCESS THE PRICE CHANGE TABLE                                  09720029
      ******************************************************************09730029
       4000-AUD-PCHG-VALIDATION.                                        09740029
                                                                        09750029
           MOVE 'N' TO PS-END-OF-CURSOR-SW                              09760029
           PERFORM 4100-OPEN-PCHG-CSR.                                  09770029
           PERFORM 4200-FETCH-PCHG-CSR.                                 09780029
                                                                        09790029
           IF PS-AUDIT-PCHG-UPD-REQD                                    09800029
               DISPLAY ' '                                              09810035
               DISPLAY ' MLT_PRCHG_TRN_DTL = MISMATCHES FOUND   '       09820029
               PERFORM 6320-WRITE-PCHG-RPT-HEADER                       09830029
               PERFORM 4300-PROCESS-PCHG-AUDIT                          09840030
                   UNTIL PS-END-OF-CSR                                  09850029
           END-IF.                                                      09860029
                                                                        09870029
           PERFORM 4400-CLOSE-PCHG-CUR.                                 09880029
      ***************************************************************** 09890029
      * OPEN CURSOR FOR UPDATE                                          09900029
      ***************************************************************** 09910029
       4100-OPEN-PCHG-CSR.                                              09920029
      *                                                                 09930029
           EXEC SQL                                                     09940029
               OPEN MLT_PCHG_CSR                                        09950029
           END-EXEC                                                     09960029
                                                                        09970029
           EVALUATE SQLCODE                                             09980029
               WHEN 0                                                   09990029
                  SET PS-NOT-END-OF-CSR TO TRUE                         10000029
               WHEN OTHER                                               10010029
                  MOVE '4100-OPEN-PCHG-CSR' TO PV-PARAGRAPH-NAME        10020029
                  MOVE PE-MSG-04 TO PV-OPERATION-ATTEMPTED              10030029
                  PERFORM 9999-SQL-ABEND                                10040029
           END-EVALUATE.                                                10050029
      ***************************************************************** 10060029
      * PROCESS THE MLT_PRCHG_TRN_DTL DISCREPANCIES (WITH MLV ATTR)     10070029
      ***************************************************************** 10080029
       4200-FETCH-PCHG-CSR.                                             10090029
      *                                                                 10100029
           EXEC SQL                                                     10110029
             FETCH MLT_PCHG_CSR INTO                                    10120029
                   :PCHG-FSCL-WK-END-DTE                                10130029
                  ,:PCHG-PRCG-DTE                                       10140029
                  ,:PCHG-DEPT-NBR                                       10150029
                  ,:PCHG-MAJ-CL-NBR                                     10160029
                  ,:PCHG-SUB-CL-NBR                                     10170029
                  ,:PCHG-LOC-NBR                                        10180029
                  ,:PCHG-ML-LO-MDSE-LVL-ID                              10190029
                  ,:PCHG-ORIG-ENT-ID                                    10200029
                  ,:PCHG-ORIG-LBL-SEQ-NBR                               10210029
                  ,:PCHG-DMY-SKU-IND                                    10220029
                  ,:PCHG-FINCL-PRC-GP-CDE                               10230029
                  ,:PCHG-SRC-SYS-ID                                     10240029
                  ,:PCHG-TRN-TYP-CDE                                    10250029
                  ,:PCHG-PRCHG-RSN-CDE                                  10260029
                  ,:PCHG-PRCHG-CTG-CDE                                  10270029
                  ,:PCHG-MLV-ENT-ID                                     10280029
                  ,:PCHG-MLV-LBL-SEQ-NBR                                10290029
                  ,:PCHG-PRCHG-RTL-AMT                                  10300029
                  ,:PCHG-AUD-ENT-ID                                     10310029
                  ,:PCHG-AUD-LBL-SEQ-NBR                                10320029
           END-EXEC                                                     10330029
                                                                        10340029
           EVALUATE SQLCODE                                             10350029
               WHEN +0                                                  10360029
                    MOVE 'Y' TO PS-AUDIT-PCHG-UPD-SW                    10370029
               WHEN +100                                                10380029
                 DISPLAY ' END OF MLT_PRCHG_TRN_DTL                   ' 10390029
                 DISPLAY '********************************************' 10400029
                    MOVE 'Y' TO PS-END-OF-CURSOR-SW                     10410029
               WHEN OTHER                                               10420029
                   MOVE '4200-FETCH-PCHG-CSR' TO PV-PARAGRAPH-NAME      10430029
                   MOVE PE-MSG-05 TO PV-OPERATION-ATTEMPTED             10440029
                   PERFORM 9999-SQL-ABEND                               10450029
           END-EVALUATE.                                                10460029
      *                                                                 10470029
      ***************************************************************** 10480029
      * PROCESS THE PRICE CHANGES                                       10490029
      ***************************************************************** 10500029
      *                                                                 10510029
       4300-PROCESS-PCHG-AUDIT.                                         10520029
      *                                                                 10530029
           PERFORM 6120-FORMAT-PCHG-RPT.                                10540029
      *                                                                 10550029
           IF CC-AUDIT-MODE                                             10560029
              PERFORM 6220-WRITE-PCHG-RPT                               10570029
           ELSE                                                         10580029
              PERFORM 7200-UPDATE-MLT-PCHG-ROW                          10590030
              PERFORM 6220-WRITE-PCHG-RPT                               10600029
           END-IF.                                                      10610029
      *                                                                 10620029
           PERFORM 4200-FETCH-PCHG-CSR.                                 10630034
      ***************************************************************** 10640029
      * CLOSE CURSOR                                                    10650029
      ***************************************************************** 10660029
       4400-CLOSE-PCHG-CUR.                                             10670029
      *                                                                 10680029
           EXEC SQL                                                     10690029
               CLOSE MLT_PCHG_CSR                                       10700029
           END-EXEC                                                     10710029
                                                                        10720029
           EVALUATE SQLCODE                                             10730029
               WHEN 0                                                   10740029
                    CONTINUE                                            10750029
               WHEN OTHER                                               10760029
                  MOVE '4400-CLOSE-PCHG-CUR  ' TO PV-PARAGRAPH-NAME     10770029
                  MOVE PE-MSG-06 TO PV-OPERATION-ATTEMPTED              10780029
                  PERFORM 9999-SQL-ABEND                                10790029
           END-EVALUATE.                                                10800029
      *                                                                 10810029
      ******************************************************************10820004
      * DATE CONTROL INPUT PROCESSING - MUST BE A WEEK END (SATURDAY)   10830004
      ******************************************************************10840004
      *                                                                 10850004
       6000-VALIDATE-DATES.                                             10860004
      *                                                                 10870004
      *VALIDATE START DATE                                              10880004
            EXEC SQL                                                    10890004
                SELECT FSCL_WK_END_DTE                                  10900004
                      ,DAY_NM                                           10910007
                 INTO  :DTATTR-FSCL-WK-END-DTE                          10920004
                      ,:DTATTR-DAY-NM                                   10930007
                 FROM  TDTATTR                                          10940004
                WHERE KY_DTE = :PV-START-DATE                           10950010
            END-EXEC.                                                   10960004
      *                                                                 10970004
           EVALUATE SQLCODE                                             10980004
               WHEN 0                                                   10990004
                   IF  DTATTR-DAY-NM = 'SATURDAY'                       11000007
                       CONTINUE                                         11010004
                   ELSE                                                 11020004
                       MOVE '6000-VALIDATE-DATES' TO PV-PARAGRAPH-NAME  11030004
                       MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED         11040004
                       PERFORM 9999-SQL-ABEND                           11050004
                   END-IF                                               11060004
               WHEN OTHER                                               11070004
                  MOVE '6000-VALIDATE-DATES' TO PV-PARAGRAPH-NAME       11080004
                  MOVE PE-MSG-01 TO PV-OPERATION-ATTEMPTED              11090004
                  PERFORM 9999-SQL-ABEND                                11100004
           END-EVALUATE.                                                11110004
                                                                        11120004
      *VALIDATE END DATE                                                11130004
            EXEC SQL                                                    11140004
                SELECT FSCL_WK_END_DTE                                  11150004
                      ,DAY_NM                                           11160007
                 INTO  :DTATTR-FSCL-WK-END-DTE                          11170004
                      ,:DTATTR-DAY-NM                                   11180007
                 FROM  TDTATTR                                          11190004
                WHERE KY_DTE = :PV-END-DATE                             11200010
            END-EXEC.                                                   11210004
      *                                                                 11220004
           EVALUATE SQLCODE                                             11230004
               WHEN 0                                                   11240004
                   IF  DTATTR-DAY-NM = 'SATURDAY'                       11250007
                       CONTINUE                                         11260004
                   ELSE                                                 11270004
                       MOVE '6000-VALIDATE-DATES' TO PV-PARAGRAPH-NAME  11280004
                       MOVE PE-MSG-02 TO PV-OPERATION-ATTEMPTED         11290004
                       PERFORM 9999-SQL-ABEND                           11300004
                   END-IF                                               11310004
               WHEN OTHER                                               11320004
                  MOVE '6000-VALIDATE-DATES' TO PV-PARAGRAPH-NAME       11330004
                  MOVE PE-MSG-01 TO PV-OPERATION-ATTEMPTED              11340004
                  PERFORM 9999-SQL-ABEND                                11350004
           END-EVALUATE.                                                11360004
                                                                        11370004
           IF  INPUT-START-DATE > INPUT-END-DATE                        11380004
               MOVE '6000-VALIDATE-DATES' TO PV-PARAGRAPH-NAME          11390004
               MOVE PE-MSG-01 TO PV-OPERATION-ATTEMPTED                 11400004
               PERFORM 9999-SQL-ABEND                                   11410004
           END-IF.                                                      11420007
      *                                                                 11430004
      *                                                                 11440004
      *                                                                 11450004
      ******************************************************************11460008
      * FORMAT EXTRACT DATA FOR REPORTING                               11470008
      ******************************************************************11480008
      *                                                                 11490004
       6100-FORMAT-PADJ-RPT.                                            11500004
              MOVE  PADJ-FSCL-WK-END-DTE                                11510005
                TO  RP-PADJ-FSCL-WK-END-DTE                             11520005
                                                                        11530005
              MOVE  PADJ-PRCG-DTE                                       11540005
                TO  RP-PADJ-PRCG-DTE                                    11550005
                                                                        11560005
              MOVE  PADJ-DEPT-NBR                                       11570005
                TO  DC-NUMERIC-2                                        11580005
              MOVE  DC-NUMERIC-2                                        11590005
                TO  DC-NUMERIC-3                                        11600005
              MOVE  DC-NUMERIC-3                                        11610005
                TO  RP-PADJ-DEPT-NBR                                    11620005
                                                                        11630005
              MOVE  PADJ-MAJ-CL-NBR                                     11640005
                TO  DC-NUMERIC-2                                        11650005
              MOVE  DC-NUMERIC-2                                        11660005
                TO  DC-NUMERIC-3                                        11670005
              MOVE  DC-NUMERIC-3                                        11680005
                TO  RP-PADJ-MAJ-CL-NBR                                  11690005
                                                                        11700005
              MOVE  PADJ-SUB-CL-NBR                                     11710005
                TO  DC-NUMERIC-2                                        11720005
              MOVE  DC-NUMERIC-2                                        11730005
                TO  DC-NUMERIC-3                                        11740005
              MOVE  DC-NUMERIC-3                                        11750005
                TO  RP-PADJ-SUB-CL-NBR                                  11760005
                                                                        11770005
              MOVE  PADJ-LOC-NBR                                        11780005
                TO  DC-NUMERIC-1                                        11790017
              MOVE  DC-NUMERIC-1                                        11800017
                TO  DC-NUMERIC-2                                        11810017
              MOVE  DC-NUMERIC-2                                        11820017
                TO  DC-NUMERIC-3                                        11830005
              MOVE  DC-NUMERIC-3                                        11840005
                TO  RP-PADJ-LOC-NBR                                     11850017
                                                                        11860005
              MOVE  PADJ-ML-LO-MDSE-LVL-ID                              11870005
                TO  DC-NUMERIC-4                                        11880005
              MOVE  DC-NUMERIC-4                                        11890005
                TO  DC-NUMERIC-5                                        11900005
              MOVE  DC-NUMERIC-5                                        11910005
                TO  DC-NUMERIC-6                                        11920005
              MOVE  DC-NUMERIC-6                                        11930005
                TO  RP-PADJ-ML-LO-MDSE-LVL-ID                           11940005
                                                                        11950005
              MOVE  PADJ-ORIG-ENT-ID                                    11960005
                TO  DC-NUMERIC-4                                        11970005
              MOVE  DC-NUMERIC-4                                        11980005
                TO  DC-NUMERIC-5                                        11990005
              MOVE  DC-NUMERIC-5                                        12000005
                TO  DC-NUMERIC-6                                        12010005
              MOVE  DC-NUMERIC-6                                        12020005
                TO  RP-PADJ-ORIG-ENT-ID                                 12030005
                                                                        12040005
              MOVE  PADJ-ORIG-LBL-SEQ-NBR                               12050005
                TO  DC-NUMERIC-1                                        12060005
              MOVE  DC-NUMERIC-1                                        12070005
                TO  DC-NUMERIC-2                                        12080005
              MOVE  DC-NUMERIC-2                                        12090005
                TO  DC-NUMERIC-6                                        12100019
              MOVE  DC-NUMERIC-6                                        12110019
                TO  RP-PADJ-ORIG-LBL-SEQ-NBR                            12120005
                                                                        12130005
              MOVE  PADJ-DMY-SKU-IND                                    12140005
                TO  RP-PADJ-DMY-SKU-IND                                 12150005
                                                                        12160005
              MOVE  PADJ-FINCL-PRC-GP-CDE                               12170005
                TO  RP-PADJ-FINCL-PRC-GP-CDE                            12180005
                                                                        12190005
              MOVE  PADJ-SRC-SYS-ID                                     12200005
                TO  DC-NUMERIC-1                                        12210005
              MOVE  DC-NUMERIC-1                                        12220005
                TO  DC-NUMERIC-2                                        12230005
              MOVE  DC-NUMERIC-2                                        12240005
                TO  DC-NUMERIC-3                                        12250005
              MOVE  DC-NUMERIC-3                                        12260005
                TO  RP-PADJ-SRC-SYS-ID                                  12270005
                                                                        12280005
              MOVE  PADJ-TRN-TYP-CDE                                    12290005
                TO  RP-PADJ-TRN-TYP-CDE                                 12300005
                                                                        12310005
              MOVE  PADJ-AP-TRN-CDE                                     12320005
                TO  RP-PADJ-AP-TRN-CDE                                  12330005
                                                                        12340005
              MOVE  PADJ-DRCR-CDE                                       12350005
                TO  RP-PADJ-DRCR-CDE                                    12360005
                                                                        12370005
              MOVE  PADJ-MLV-ENT-ID                                     12380005
                TO  RP-PADJ-MLV-ENT-ID                                  12390005
                                                                        12400005
              MOVE  PADJ-MLV-LBL-SEQ                                    12410005
                TO  DC-NUMERIC-1                                        12420005
              MOVE  DC-NUMERIC-1                                        12430005
                TO  DC-NUMERIC-2                                        12440005
              MOVE  DC-NUMERIC-2                                        12450005
                TO  DC-NUMERIC-6                                        12460019
              MOVE  DC-NUMERIC-6                                        12470019
                TO  RP-PADJ-MLV-LBL-SEQ                                 12480005
                                                                        12490005
              MOVE  PADJ-PADJ-GRO-COST-AMT                              12500005
                TO    RP-PADJ-PADJ-GRO-COST-AMT                         12510005
              MOVE  PADJ-PADJ-NET-COST-AMT                              12520005
                TO    RP-PADJ-PADJ-NET-COST-AMT                         12530005
              MOVE  PADJ-PADJ-RTL-AMT                                   12540005
                TO    RP-PADJ-PADJ-RTL-AMT                              12550005
              MOVE  PADJ-PADJ-DISC-COST-AMT                             12560005
                TO    RP-PADJ-PADJ-DISC-COST-AMT                        12570005
                                                                        12580005
              MOVE  PADJ-AUD-ENT-ID                                     12590005
                TO  DC-NUMERIC-4                                        12600005
              MOVE  DC-NUMERIC-4                                        12610005
                TO  DC-NUMERIC-5                                        12620005
              MOVE  DC-NUMERIC-5                                        12630005
                TO  DC-NUMERIC-6                                        12640005
              MOVE  DC-NUMERIC-6                                        12650005
                TO  RP-PADJ-AUD-ENT-ID                                  12660005
                                                                        12670005
              MOVE  PADJ-AUD-LBL-SEQ-NBR                                12680005
                TO  DC-NUMERIC-1                                        12690005
              MOVE  DC-NUMERIC-1                                        12700005
                TO  DC-NUMERIC-2                                        12710005
              MOVE  DC-NUMERIC-2                                        12720005
                TO  DC-NUMERIC-6                                        12730019
              MOVE  DC-NUMERIC-6                                        12740019
                TO  RP-PADJ-AUD-LBL-SEQ-NBR.                            12750005
      *                                                                 12760008
      *                                                                 12770025
      ******************************************************************12780025
      * FORMAT EXTRACT DATA FOR REPORTING                               12790025
      ******************************************************************12800025
      *                                                                 12810025
       6110-FORMAT-SLS-RPT.                                             12820025
              MOVE  SLS-FSCL-WK-END-DTE                                 12830025
                TO  RP-SLS-FSCL-WK-END-DTE                              12840025
                                                                        12850025
              MOVE  SLS-PRCG-DTE                                        12860025
                TO  RP-SLS-PRCG-DTE                                     12870025
                                                                        12880025
              MOVE  SLS-DEPT-NBR                                        12890025
                TO  DC-NUMERIC-2                                        12900025
              MOVE  DC-NUMERIC-2                                        12910025
                TO  DC-NUMERIC-3                                        12920025
              MOVE  DC-NUMERIC-3                                        12930025
                TO  RP-SLS-DEPT-NBR                                     12940025
                                                                        12950025
              MOVE  SLS-MAJ-CL-NBR                                      12960025
                TO  DC-NUMERIC-2                                        12970025
              MOVE  DC-NUMERIC-2                                        12980025
                TO  DC-NUMERIC-3                                        12990025
              MOVE  DC-NUMERIC-3                                        13000025
                TO  RP-SLS-MAJ-CL-NBR                                   13010025
                                                                        13020025
              MOVE  SLS-SUB-CL-NBR                                      13030025
                TO  DC-NUMERIC-2                                        13040025
              MOVE  DC-NUMERIC-2                                        13050025
                TO  DC-NUMERIC-3                                        13060025
              MOVE  DC-NUMERIC-3                                        13070025
                TO  RP-SLS-SUB-CL-NBR                                   13080025
                                                                        13090025
              MOVE  SLS-LOC-NBR                                         13100025
                TO  DC-NUMERIC-1                                        13110025
              MOVE  DC-NUMERIC-1                                        13120025
                TO  DC-NUMERIC-2                                        13130025
              MOVE  DC-NUMERIC-2                                        13140025
                TO  DC-NUMERIC-3                                        13150025
              MOVE  DC-NUMERIC-3                                        13160025
                TO  RP-SLS-LOC-NBR                                      13170025
                                                                        13180025
              MOVE  SLS-ML-LO-MDSE-LVL-ID                               13190025
                TO  DC-NUMERIC-4                                        13200025
              MOVE  DC-NUMERIC-4                                        13210025
                TO  DC-NUMERIC-5                                        13220025
              MOVE  DC-NUMERIC-5                                        13230025
                TO  DC-NUMERIC-6                                        13240025
              MOVE  DC-NUMERIC-6                                        13250025
                TO  RP-SLS-ML-LO-MDSE-LVL-ID                            13260025
                                                                        13270025
              MOVE  SLS-ORIG-ENT-ID                                     13280025
                TO  DC-NUMERIC-4                                        13290025
              MOVE  DC-NUMERIC-4                                        13300025
                TO  DC-NUMERIC-5                                        13310025
              MOVE  DC-NUMERIC-5                                        13320025
                TO  DC-NUMERIC-6                                        13330025
              MOVE  DC-NUMERIC-6                                        13340025
                TO  RP-SLS-ORIG-ENT-ID                                  13350025
                                                                        13360025
              MOVE  SLS-ORIG-LBL-SEQ-NBR                                13370025
                TO  DC-NUMERIC-1                                        13380025
              MOVE  DC-NUMERIC-1                                        13390025
                TO  DC-NUMERIC-2                                        13400025
              MOVE  DC-NUMERIC-2                                        13410025
                TO  DC-NUMERIC-6                                        13420025
              MOVE  DC-NUMERIC-6                                        13430025
                TO  RP-SLS-ORIG-LBL-SEQ-NBR                             13440025
                                                                        13450025
              MOVE  SLS-DMY-SKU-IND                                     13460025
                TO  RP-SLS-DMY-SKU-IND                                  13470025
                                                                        13480025
              MOVE  SLS-FINCL-PRC-GP-CDE                                13490025
                TO  RP-SLS-FINCL-PRC-GP-CDE                             13500025
                                                                        13510025
              MOVE  SLS-SRC-SYS-ID                                      13520025
                TO  DC-NUMERIC-1                                        13530025
              MOVE  DC-NUMERIC-1                                        13540025
                TO  DC-NUMERIC-2                                        13550025
              MOVE  DC-NUMERIC-2                                        13560025
                TO  DC-NUMERIC-3                                        13570025
              MOVE  DC-NUMERIC-3                                        13580025
                TO  RP-SLS-SRC-SYS-ID                                   13590025
                                                                        13600025
              MOVE  SLS-TRN-TYP-CDE                                     13610025
                TO  RP-SLS-TRN-TYP-CDE                                  13620025
                                                                        13630025
              MOVE  SLS-SLS-TYP-CDE                                     13640025
                TO  RP-SLS-SLS-TYP-CDE                                  13650025
                                                                        13660025
              MOVE  SLS-MLV-ENT-ID                                      13670025
                TO  RP-SLS-MLV-ENT-ID                                   13680025
                                                                        13690025
              MOVE  SLS-MLV-LBL-SEQ-NBR                                 13700026
                TO  DC-NUMERIC-1                                        13710025
              MOVE  DC-NUMERIC-1                                        13720025
                TO  DC-NUMERIC-2                                        13730025
              MOVE  DC-NUMERIC-2                                        13740025
                TO  DC-NUMERIC-6                                        13750025
              MOVE  DC-NUMERIC-6                                        13760025
                TO  RP-SLS-MLV-LBL-SEQ                                  13770025
                                                                        13780025
              MOVE  SLS-SLS-RTL-AMT                                     13790025
                TO    RP-SLS-SLS-RTL-AMT                                13800025
                                                                        13810025
              MOVE  SLS-AUD-ENT-ID                                      13820025
                TO  DC-NUMERIC-4                                        13830025
              MOVE  DC-NUMERIC-4                                        13840025
                TO  DC-NUMERIC-5                                        13850025
              MOVE  DC-NUMERIC-5                                        13860025
                TO  DC-NUMERIC-6                                        13870025
              MOVE  DC-NUMERIC-6                                        13880025
                TO  RP-SLS-AUD-ENT-ID                                   13890025
                                                                        13900025
              MOVE  SLS-AUD-LBL-SEQ-NBR                                 13910025
                TO  DC-NUMERIC-1                                        13920025
              MOVE  DC-NUMERIC-1                                        13930025
                TO  DC-NUMERIC-2                                        13940025
              MOVE  DC-NUMERIC-2                                        13950025
                TO  DC-NUMERIC-6                                        13960025
              MOVE  DC-NUMERIC-6                                        13970025
                TO  RP-SLS-AUD-LBL-SEQ-NBR.                             13980025
      *                                                                 13990025
      *                                                                 14000029
      ******************************************************************14010029
      * FORMAT EXTRACT DATA FOR REPORTING                               14020029
      ******************************************************************14030029
      *                                                                 14040029
       6120-FORMAT-PCHG-RPT.                                            14050029
              MOVE  PCHG-FSCL-WK-END-DTE                                14060029
                TO  RP-PCHG-FSCL-WK-END-DTE                             14070029
                                                                        14080029
              MOVE  PCHG-PRCG-DTE                                       14090029
                TO  RP-PCHG-PRCG-DTE                                    14100029
                                                                        14110029
              MOVE  PCHG-DEPT-NBR                                       14120029
                TO  DC-NUMERIC-2                                        14130029
              MOVE  DC-NUMERIC-2                                        14140029
                TO  DC-NUMERIC-3                                        14150029
              MOVE  DC-NUMERIC-3                                        14160029
                TO  RP-PCHG-DEPT-NBR                                    14170029
                                                                        14180029
              MOVE  PCHG-MAJ-CL-NBR                                     14190029
                TO  DC-NUMERIC-2                                        14200029
              MOVE  DC-NUMERIC-2                                        14210029
                TO  DC-NUMERIC-3                                        14220029
              MOVE  DC-NUMERIC-3                                        14230029
                TO  RP-PCHG-MAJ-CL-NBR                                  14240029
                                                                        14250029
              MOVE  PCHG-SUB-CL-NBR                                     14260029
                TO  DC-NUMERIC-2                                        14270029
              MOVE  DC-NUMERIC-2                                        14280029
                TO  DC-NUMERIC-3                                        14290029
              MOVE  DC-NUMERIC-3                                        14300029
                TO  RP-PCHG-SUB-CL-NBR                                  14310029
                                                                        14320029
              MOVE  PCHG-LOC-NBR                                        14330029
                TO  DC-NUMERIC-1                                        14340029
              MOVE  DC-NUMERIC-1                                        14350029
                TO  DC-NUMERIC-2                                        14360029
              MOVE  DC-NUMERIC-2                                        14370029
                TO  DC-NUMERIC-3                                        14380029
              MOVE  DC-NUMERIC-3                                        14390029
                TO  RP-PCHG-LOC-NBR                                     14400029
                                                                        14410029
              MOVE  PCHG-ML-LO-MDSE-LVL-ID                              14420029
                TO  DC-NUMERIC-4                                        14430029
              MOVE  DC-NUMERIC-4                                        14440029
                TO  DC-NUMERIC-5                                        14450029
              MOVE  DC-NUMERIC-5                                        14460029
                TO  DC-NUMERIC-6                                        14470029
              MOVE  DC-NUMERIC-6                                        14480029
                TO  RP-PCHG-ML-LO-MDSE-LVL-ID                           14490029
                                                                        14500029
              MOVE  PCHG-ORIG-ENT-ID                                    14510029
                TO  DC-NUMERIC-4                                        14520029
              MOVE  DC-NUMERIC-4                                        14530029
                TO  DC-NUMERIC-5                                        14540029
              MOVE  DC-NUMERIC-5                                        14550029
                TO  DC-NUMERIC-6                                        14560029
              MOVE  DC-NUMERIC-6                                        14570029
                TO  RP-PCHG-ORIG-ENT-ID                                 14580029
                                                                        14590029
              MOVE  PCHG-ORIG-LBL-SEQ-NBR                               14600029
                TO  DC-NUMERIC-1                                        14610029
              MOVE  DC-NUMERIC-1                                        14620029
                TO  DC-NUMERIC-2                                        14630029
              MOVE  DC-NUMERIC-2                                        14640029
                TO  DC-NUMERIC-6                                        14650029
              MOVE  DC-NUMERIC-6                                        14660029
                TO  RP-PCHG-ORIG-LBL-SEQ-NBR                            14670029
                                                                        14680029
              MOVE  PCHG-DMY-SKU-IND                                    14690029
                TO  RP-PCHG-DMY-SKU-IND                                 14700029
                                                                        14710029
              MOVE  PCHG-FINCL-PRC-GP-CDE                               14720029
                TO  RP-PCHG-FINCL-PRC-GP-CDE                            14730029
                                                                        14740029
              MOVE  PCHG-SRC-SYS-ID                                     14750029
                TO  DC-NUMERIC-1                                        14760029
              MOVE  DC-NUMERIC-1                                        14770029
                TO  DC-NUMERIC-2                                        14780029
              MOVE  DC-NUMERIC-2                                        14790029
                TO  DC-NUMERIC-3                                        14800029
              MOVE  DC-NUMERIC-3                                        14810029
                TO  RP-PCHG-SRC-SYS-ID                                  14820029
                                                                        14830029
              MOVE  PCHG-TRN-TYP-CDE                                    14840029
                TO  RP-PCHG-TRN-TYP-CDE                                 14850029
                                                                        14860029
              MOVE  PCHG-PRCHG-RSN-CDE                                  14870029
                TO  RP-PCHG-PRCHG-RSN-CDE                               14880029
                                                                        14890029
              MOVE  PCHG-PRCHG-CTG-CDE                                  14900029
                TO  RP-PCHG-PRCHG-CTG-CDE                               14910029
                                                                        14920029
              MOVE  PCHG-MLV-ENT-ID                                     14930029
                TO  RP-PCHG-MLV-ENT-ID                                  14940029
                                                                        14950029
              MOVE  PCHG-MLV-LBL-SEQ-NBR                                14960032
                TO  DC-NUMERIC-1                                        14970029
              MOVE  DC-NUMERIC-1                                        14980029
                TO  DC-NUMERIC-2                                        14990029
              MOVE  DC-NUMERIC-2                                        15000029
                TO  DC-NUMERIC-6                                        15010029
              MOVE  DC-NUMERIC-6                                        15020029
                TO  RP-PCHG-MLV-LBL-SEQ                                 15030029
                                                                        15040029
              MOVE  PCHG-PRCHG-RTL-AMT                                  15050029
                TO    RP-PCHG-PRCHG-RTL-AMT                             15060029
                                                                        15070029
              MOVE  PCHG-AUD-ENT-ID                                     15080029
                TO  DC-NUMERIC-4                                        15090029
              MOVE  DC-NUMERIC-4                                        15100029
                TO  DC-NUMERIC-5                                        15110029
              MOVE  DC-NUMERIC-5                                        15120029
                TO  DC-NUMERIC-6                                        15130029
              MOVE  DC-NUMERIC-6                                        15140029
                TO  RP-PCHG-AUD-ENT-ID                                  15150029
                                                                        15160029
              MOVE  PCHG-AUD-LBL-SEQ-NBR                                15170029
                TO  DC-NUMERIC-1                                        15180029
              MOVE  DC-NUMERIC-1                                        15190029
                TO  DC-NUMERIC-2                                        15200029
              MOVE  DC-NUMERIC-2                                        15210029
                TO  DC-NUMERIC-6                                        15220029
              MOVE  DC-NUMERIC-6                                        15230029
                TO  RP-PCHG-AUD-LBL-SEQ-NBR.                            15240029
      *                                                                 15250029
      *                                                                 15260029
      ***************************************************************** 15270029
      * WRITE THE PURCH ADJ DIFFERENCE REPORT                           15280029
      ***************************************************************** 15290007
       6200-WRITE-PADJ-RPT.                                             15300007
                                                                        15310007
            WRITE REPORT-TABLE-RECORD                                   15320008
               FROM REPORT-PADJ-LAYOUT.                                 15330008
                                                                        15340007
            ADD 1 TO PA-RP-RECORD-WRITTEN.                              15350007
                                                                        15360007
      *                                                                 15370020
      ***************************************************************** 15380025
      * WRITE THE SALES DIFFERENCE REPORT                               15390029
      ***************************************************************** 15400025
       6210-WRITE-SLS-RPT.                                              15410025
                                                                        15420025
            WRITE REPORT-TABLE-RECORD                                   15430025
               FROM REPORT-SLS-LAYOUT.                                  15440025
                                                                        15450025
            ADD 1 TO PA-RP-RECORD-WRITTEN.                              15460025
                                                                        15470025
      *                                                                 15480029
      ***************************************************************** 15490029
      * WRITE THE PRICE CHANGE DIFFERENCE REPORT                        15500029
      ***************************************************************** 15510029
       6220-WRITE-PCHG-RPT.                                             15520029
                                                                        15530029
            WRITE REPORT-TABLE-RECORD                                   15540029
               FROM REPORT-PCHG-LAYOUT.                                 15550029
                                                                        15560029
            ADD 1 TO PA-RP-RECORD-WRITTEN.                              15570029
                                                                        15580029
      *                                                                 15590025
      ***************************************************************** 15600020
      * WRITE THE PURCH ADJ DIFFERENCE REPORT HEADER                    15610029
      ***************************************************************** 15620020
       6300-WRITE-PADJ-RPT-HEADER.                                      15630020
                                                                        15640020
            WRITE REPORT-TABLE-RECORD                                   15650020
               FROM REPORT-PADJ-HEADER.                                 15660020
                                                                        15670020
      *                                                                 15680025
      ***************************************************************** 15690025
      * WRITE THE SALES DIFFERENCE REPORT HEADER                        15700029
      ***************************************************************** 15710025
       6310-WRITE-SLS-RPT-HEADER.                                       15720025
                                                                        15730025
            WRITE REPORT-TABLE-RECORD                                   15740025
               FROM REPORT-SLS-HEADER.                                  15750025
                                                                        15760025
      *                                                                 15770029
      ***************************************************************** 15780029
      * WRITE THE PRICE CHG DIFFERENCE REPORT HEADER                    15790029
      ***************************************************************** 15800029
       6320-WRITE-PCHG-RPT-HEADER.                                      15810029
                                                                        15820029
            WRITE REPORT-TABLE-RECORD                                   15830029
               FROM REPORT-PCHG-HEADER.                                 15840029
                                                                        15850029
      *                                                                 15860007
      ***************************************************************** 15870007
      * UPDATE MLT_PADJ_TRN_DTL                                         15880008
      *        ENT_ID, LBL_SEQ_NBR                                      15890008
      ***************************************************************** 15900007
      *                                                                 15910007
       7000-UPDATE-MLT-PADJ-ROW.                                        15920005
                                                                        15930000
           PERFORM WITH TEST AFTER                                      15940000
              VARYING PV-RETRY-COUNT                                    15950000
              FROM 1 BY 1                                               15960000
              UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                     15970000
                 OR SQLCODE = +0                                        15980000
                                                                        15990000
              EXEC SQL                                                  16000000
                  UPDATE MLT_PADJ_TRN_DTL                               16010011
                   SET   ENT_ID      = :PADJ-MLV-ENT-ID                 16020010
                        ,LBL_SEQ_NBR = :PADJ-MLV-LBL-SEQ                16030010
                 WHERE                                                  16040013
                      FSCL_WK_END_DTE    = :PADJ-FSCL-WK-END-DTE        16050014
                  AND PRCG_DTE           = :PADJ-PRCG-DTE               16060014
                  AND DEPT_NBR           = :PADJ-DEPT-NBR               16070014
                  AND MAJ_CL_NBR         = :PADJ-MAJ-CL-NBR             16080014
                  AND SUB_CL_NBR         = :PADJ-SUB-CL-NBR             16090014
                  AND LOC_NBR            = :PADJ-LOC-NBR                16100014
                  AND ML_LO_MDSE_LVL_ID  = :PADJ-ML-LO-MDSE-LVL-ID      16110014
                  AND ORIG_ENT_ID        = :PADJ-ORIG-ENT-ID            16120014
                  AND ORIG_LBL_SEQ_NBR   = :PADJ-ORIG-LBL-SEQ-NBR       16130014
                  AND DMY_SKU_IND        = :PADJ-DMY-SKU-IND            16140014
                  AND FINCL_PRC_GP_CDE   = :PADJ-FINCL-PRC-GP-CDE       16150014
                  AND SRC_SYS_ID         = :PADJ-SRC-SYS-ID             16160014
                  AND TRN_TYP_CDE        = :PADJ-TRN-TYP-CDE            16170014
                  AND AP_TRN_CDE         = :PADJ-AP-TRN-CDE             16180014
                  AND DRCR_CDE           = :PADJ-DRCR-CDE               16190014
              END-EXEC                                                  16200000
                                                                        16210000
              EVALUATE SQLCODE                                          16220000
                  WHEN +0                                               16230000
                      ADD 1 TO PA-PADJ-UPDATE-COUNT                     16240007
                   DISPLAY '**********  ROW UPDATED  *************'     16250013
                   DISPLAY ' FSCL_WK_END =  ' RP-PADJ-FSCL-WK-END-DTE   16260035
                   DISPLAY ' PROCESS DATE=  ' RP-PADJ-PRCG-DTE          16270035
                   DISPLAY ' ML_LO_MDSE  =  ' RP-PADJ-ML-LO-MDSE-LVL-ID 16280035
                   DISPLAY ' AUD-ENTID    = ' RP-PADJ-AUD-ENT-ID        16290035
                   DISPLAY ' AUD-LBLSEQ   = ' RP-PADJ-AUD-LBL-SEQ-NBR   16300035
                   DISPLAY '*UPD-ENTID    = ' RP-PADJ-MLV-ENT-ID        16310013
                   DISPLAY '*UPD-LBLSEQ   = ' RP-PADJ-MLV-LBL-SEQ       16320013
                  WHEN -904                                             16330000
                  WHEN -911                                             16340000
                  WHEN -913                                             16350000
                      CONTINUE                                          16360000
                  WHEN OTHER                                            16370000
                   DISPLAY '********** FAILED UPDATE *************'     16380006
                   DISPLAY '*FSCL_WK_END =  ' RP-PADJ-FSCL-WK-END-DTE   16390007
                   DISPLAY '*PROCESS DATE=  ' RP-PADJ-PRCG-DTE          16400007
                   DISPLAY '*DEPT_NBR    =  ' RP-PADJ-DEPT-NBR          16410007
                   DISPLAY '*MAJ_CL_NBR  =  ' RP-PADJ-MAJ-CL-NBR        16420007
                   DISPLAY '*SUB_CL_NBR  =  ' RP-PADJ-SUB-CL-NBR        16430007
                   DISPLAY '*LOC_NBR     =  ' RP-PADJ-LOC-NBR           16440007
                   DISPLAY '*ML_LO_MDSE_ =  ' RP-PADJ-ML-LO-MDSE-LVL-ID 16450007
                   DISPLAY '*PADJ-ORIG-ENT= ' RP-PADJ-ORIG-ENT-ID       16460007
                   DISPLAY '*PADJ-ORIG-LBL= ' RP-PADJ-ORIG-LBL-SEQ-NBR  16470007
                   DISPLAY '*PADJ-DMY-SKU = ' RP-PADJ-DMY-SKU-IND       16480007
                   DISPLAY '*PADJ-FINCL-GP= ' RP-PADJ-FINCL-PRC-GP-CDE  16490007
                   DISPLAY '*PADJ-SRC-SYS=  ' RP-PADJ-SRC-SYS-ID        16500007
                   DISPLAY '*PADJ-TRN-TYP = ' RP-PADJ-TRN-TYP-CDE       16510007
                   DISPLAY '*PADJ-AP-TRN- = ' RP-PADJ-AP-TRN-CDE        16520007
                   DISPLAY '*PADJ-DRCR-CD = ' RP-PADJ-DRCR-CDE          16530007
                   MOVE '7000-UPDATE-MLT-PADJ-ROW' TO PV-PARAGRAPH-NAME 16540005
                   MOVE PE-MSG-07             TO PV-OPERATION-ATTEMPTED 16550005
                   PERFORM 9999-SQL-ABEND                               16560000
              END-EVALUATE                                              16570000
           END-PERFORM.                                                 16580000
                                                                        16590000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           16600000
              DISPLAY '*** DEADLOCK OCCURRED ON UPDATE ***'             16610000
              MOVE '7000-UPDATE-MLT-PADJ-ROW' TO PV-PARAGRAPH-NAME      16620005
              MOVE PE-MSG-09               TO PV-OPERATION-ATTEMPTED    16630005
              PERFORM 9999-SQL-ABEND                                    16640000
           END-IF.                                                      16650000
                                                                        16660000
      *                                                                 16670025
      ***************************************************************** 16680025
      * UPDATE MLT_SLS_TRN_DTL                                          16690025
      *        ENT_ID, LBL_SEQ_NBR                                      16700025
      ***************************************************************** 16710025
      *                                                                 16720025
       7100-UPDATE-MLT-SLS-ROW.                                         16730025
                                                                        16740025
           PERFORM WITH TEST AFTER                                      16750025
              VARYING PV-RETRY-COUNT                                    16760025
              FROM 1 BY 1                                               16770025
              UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                     16780025
                 OR SQLCODE = +0                                        16790025
                                                                        16800025
              EXEC SQL                                                  16810025
                  UPDATE MLT_SLS_TRN_DTL                                16820025
                   SET   ENT_ID      = :SLS-MLV-ENT-ID                  16830025
                        ,LBL_SEQ_NBR = :SLS-MLV-LBL-SEQ-NBR             16840027
                 WHERE                                                  16850025
                      FSCL_WK_END_DTE    = :SLS-FSCL-WK-END-DTE         16860025
                  AND PRCG_DTE           = :SLS-PRCG-DTE                16870025
                  AND DEPT_NBR           = :SLS-DEPT-NBR                16880025
                  AND MAJ_CL_NBR         = :SLS-MAJ-CL-NBR              16890025
                  AND SUB_CL_NBR         = :SLS-SUB-CL-NBR              16900025
                  AND LOC_NBR            = :SLS-LOC-NBR                 16910025
                  AND ML_LO_MDSE_LVL_ID  = :SLS-ML-LO-MDSE-LVL-ID       16920025
                  AND ORIG_ENT_ID        = :SLS-ORIG-ENT-ID             16930025
                  AND ORIG_LBL_SEQ_NBR   = :SLS-ORIG-LBL-SEQ-NBR        16940025
                  AND DMY_SKU_IND        = :SLS-DMY-SKU-IND             16950025
                  AND FINCL_PRC_GP_CDE   = :SLS-FINCL-PRC-GP-CDE        16960025
                  AND SRC_SYS_ID         = :SLS-SRC-SYS-ID              16970025
                  AND SLS_TYP_CDE        = :SLS-SLS-TYP-CDE             16980025
                  AND TRN_TYP_CDE        = :SLS-TRN-TYP-CDE             16990025
              END-EXEC                                                  17000025
                                                                        17010025
              EVALUATE SQLCODE                                          17020025
                  WHEN +0                                               17030025
                      ADD 1 TO PA-SALE-UPDATE-COUNT                     17040025
                   DISPLAY '**********  ROW UPDATED  *************'     17050025
                   DISPLAY ' FSCL_WK_END =  ' RP-SLS-FSCL-WK-END-DTE    17060035
                   DISPLAY ' PROCESS DATE=  ' RP-SLS-PRCG-DTE           17070035
                   DISPLAY ' ML_LO_MDSE  =  ' RP-SLS-ML-LO-MDSE-LVL-ID  17080035
                   DISPLAY ' AUD-ENTID    = ' RP-SLS-AUD-ENT-ID         17090035
                   DISPLAY ' AUD-LBLSEQ   = ' RP-SLS-AUD-LBL-SEQ-NBR    17100035
                   DISPLAY '*UPD-ENTID    = ' RP-SLS-MLV-ENT-ID         17110025
                   DISPLAY '*UPD-LBLSEQ   = ' RP-SLS-MLV-LBL-SEQ        17120025
                  WHEN -904                                             17130025
                  WHEN -911                                             17140025
                  WHEN -913                                             17150025
                      CONTINUE                                          17160025
                  WHEN OTHER                                            17170025
                   DISPLAY '********** FAILED UPDATE *************'     17180025
                   DISPLAY '*FSCL_WK_END =  ' RP-SLS-FSCL-WK-END-DTE    17190025
                   DISPLAY '*PROCESS DATE=  ' RP-SLS-PRCG-DTE           17200025
                   DISPLAY '*DEPT_NBR    =  ' RP-SLS-DEPT-NBR           17210025
                   DISPLAY '*MAJ_CL_NBR  =  ' RP-SLS-MAJ-CL-NBR         17220025
                   DISPLAY '*SUB_CL_NBR  =  ' RP-SLS-SUB-CL-NBR         17230025
                   DISPLAY '*LOC_NBR     =  ' RP-SLS-LOC-NBR            17240025
                   DISPLAY '*ML_LO_MDSE_ =  ' RP-SLS-ML-LO-MDSE-LVL-ID  17250025
                   DISPLAY '* SLS-ORIG-ENT= ' RP-SLS-ORIG-ENT-ID        17260025
                   DISPLAY '* SLS-ORIG-LBL= ' RP-SLS-ORIG-LBL-SEQ-NBR   17270025
                   DISPLAY '* SLS-DMY-SKU = ' RP-SLS-DMY-SKU-IND        17280025
                   DISPLAY '* SLS-FINCL-GP= ' RP-SLS-FINCL-PRC-GP-CDE   17290025
                   DISPLAY '* SLS-SRC-SYS=  ' RP-SLS-SRC-SYS-ID         17300025
                   DISPLAY '* SLS-TYP-CDE=  ' RP-SLS-SLS-TYP-CDE        17310025
                   DISPLAY '* SLS-TRN-TYP = ' RP-SLS-TRN-TYP-CDE        17320025
                   MOVE '7100-UPDATE-MLT-SLS-ROW' TO PV-PARAGRAPH-NAME  17330025
                   MOVE PE-MSG-07             TO PV-OPERATION-ATTEMPTED 17340025
                   PERFORM 9999-SQL-ABEND                               17350025
              END-EVALUATE                                              17360025
           END-PERFORM.                                                 17370025
                                                                        17380025
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           17390025
              DISPLAY '*** DEADLOCK OCCURRED ON UPDATE ***'             17400025
              MOVE '7000-UPDATE-MLT-SLS-ROW' TO PV-PARAGRAPH-NAME       17410025
              MOVE PE-MSG-09               TO PV-OPERATION-ATTEMPTED    17420025
              PERFORM 9999-SQL-ABEND                                    17430025
           END-IF.                                                      17440025
                                                                        17450025
      *                                                                 17460029
      ***************************************************************** 17470029
      * UPDATE MLT_PRCHG_TRN_DTL                                        17480029
      *        ENT_ID, LBL_SEQ_NBR                                      17490029
      ***************************************************************** 17500029
      *                                                                 17510029
       7200-UPDATE-MLT-PCHG-ROW.                                        17520029
                                                                        17530029
           PERFORM WITH TEST AFTER                                      17540029
              VARYING PV-RETRY-COUNT                                    17550029
              FROM 1 BY 1                                               17560029
              UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                     17570029
                 OR SQLCODE = +0                                        17580029
                                                                        17590029
              EXEC SQL                                                  17600029
                  UPDATE MLT_PRCHG_TRN_DTL                              17610029
                   SET   ENT_ID      = :PCHG-MLV-ENT-ID                 17620029
                        ,LBL_SEQ_NBR = :PCHG-MLV-LBL-SEQ-NBR            17630029
                 WHERE                                                  17640029
                      FSCL_WK_END_DTE    = :PCHG-FSCL-WK-END-DTE        17650029
                  AND PRCG_DTE           = :PCHG-PRCG-DTE               17660029
                  AND DEPT_NBR           = :PCHG-DEPT-NBR               17670029
                  AND MAJ_CL_NBR         = :PCHG-MAJ-CL-NBR             17680029
                  AND SUB_CL_NBR         = :PCHG-SUB-CL-NBR             17690029
                  AND LOC_NBR            = :PCHG-LOC-NBR                17700029
                  AND ML_LO_MDSE_LVL_ID  = :PCHG-ML-LO-MDSE-LVL-ID      17710029
                  AND ORIG_ENT_ID        = :PCHG-ORIG-ENT-ID            17720029
                  AND ORIG_LBL_SEQ_NBR   = :PCHG-ORIG-LBL-SEQ-NBR       17730029
                  AND DMY_SKU_IND        = :PCHG-DMY-SKU-IND            17740029
                  AND FINCL_PRC_GP_CDE   = :PCHG-FINCL-PRC-GP-CDE       17750029
                  AND SRC_SYS_ID         = :PCHG-SRC-SYS-ID             17760029
                  AND TRN_TYP_CDE        = :PCHG-TRN-TYP-CDE            17770029
                  AND PRCHG_RSN_CDE      = :PCHG-PRCHG-RSN-CDE          17780029
                  AND PRCHG_CTG_CDE      = :PCHG-PRCHG-CTG-CDE          17790029
              END-EXEC                                                  17800029
                                                                        17810029
              EVALUATE SQLCODE                                          17820029
                  WHEN +0                                               17830029
                      ADD 1 TO PA-PADJ-UPDATE-COUNT                     17840029
                   DISPLAY '**********  ROW UPDATED  *************'     17850029
                   DISPLAY ' FSCL_WK_END =  ' RP-PCHG-FSCL-WK-END-DTE   17860035
                   DISPLAY ' PROCESS DATE=  ' RP-PCHG-PRCG-DTE          17870035
                   DISPLAY ' ML_LO_MDSE  =  ' RP-PCHG-ML-LO-MDSE-LVL-ID 17880035
                   DISPLAY ' AUD-ENTID    = ' RP-PCHG-AUD-ENT-ID        17890035
                   DISPLAY ' AUD-LBLSEQ   = ' RP-PCHG-AUD-LBL-SEQ-NBR   17900035
                   DISPLAY '*UPD-ENTID    = ' RP-PCHG-MLV-ENT-ID        17910035
                   DISPLAY '*UPD-LBLSEQ   = ' RP-PCHG-MLV-LBL-SEQ       17920035
                  WHEN -904                                             17930029
                  WHEN -911                                             17940029
                  WHEN -913                                             17950029
                      CONTINUE                                          17960029
                  WHEN OTHER                                            17970029
                   DISPLAY '********** FAILED UPDATE *************'     17980029
                   DISPLAY '*FSCL_WK_END =  ' RP-PCHG-FSCL-WK-END-DTE   17990029
                   DISPLAY '*PROCESS DATE=  ' RP-PCHG-PRCG-DTE          18000029
                   DISPLAY '*DEPT_NBR    =  ' RP-PCHG-DEPT-NBR          18010029
                   DISPLAY '*MAJ_CL_NBR  =  ' RP-PCHG-MAJ-CL-NBR        18020029
                   DISPLAY '*SUB_CL_NBR  =  ' RP-PCHG-SUB-CL-NBR        18030029
                   DISPLAY '*LOC_NBR     =  ' RP-PCHG-LOC-NBR           18040029
                   DISPLAY '*ML_LO_MDSE_ =  ' RP-PCHG-ML-LO-MDSE-LVL-ID 18050029
                   DISPLAY '*PCHG-ORIG-ENT= ' RP-PCHG-ORIG-ENT-ID       18060029
                   DISPLAY '*PCHG-ORIG-LBL= ' RP-PCHG-ORIG-LBL-SEQ-NBR  18070029
                   DISPLAY '*PCHG-DMY-SKU = ' RP-PCHG-DMY-SKU-IND       18080029
                   DISPLAY '*PCHG-FINCL-GP= ' RP-PCHG-FINCL-PRC-GP-CDE  18090029
                   DISPLAY '*PCHG-SRC-SYS=  ' RP-PCHG-SRC-SYS-ID        18100029
                   DISPLAY '*PCHG-TRN-TYP = ' RP-PCHG-TRN-TYP-CDE       18110029
                   DISPLAY '*PCHG-RSN-CDE = ' RP-PCHG-PRCHG-RSN-CDE     18120029
                   DISPLAY '*PCHG-CTG-CDE = ' RP-PCHG-PRCHG-CTG-CDE     18130029
                   MOVE '7200-UPDATE-MLT-PCHG-ROW' TO PV-PARAGRAPH-NAME 18140029
                   MOVE PE-MSG-07             TO PV-OPERATION-ATTEMPTED 18150029
                   PERFORM 9999-SQL-ABEND                               18160029
              END-EVALUATE                                              18170029
           END-PERFORM.                                                 18180029
                                                                        18190029
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           18200029
              DISPLAY '*** DEADLOCK OCCURRED ON UPDATE ***'             18210029
              MOVE '7000-UPDATE-MLT-PADJ-ROW' TO PV-PARAGRAPH-NAME      18220029
              MOVE PE-MSG-09               TO PV-OPERATION-ATTEMPTED    18230029
              PERFORM 9999-SQL-ABEND                                    18240029
           END-IF.                                                      18250029
                                                                        18260029
      ******************************************************************18270025
      *                                                                 18280006
      *                                                                 18290006
      *                                                                 18300006
      ******************************************************************18310000
       7000-COMMIT.                                                     18320003
                                                                        18330000
           EXEC SQL                                                     18340000
                COMMIT                                                  18350003
           END-EXEC.                                                    18360000
                                                                        18370000
           EVALUATE TRUE                                                18380000
              WHEN SQLCODE = 0                                          18390000
                  ADD +1 TO PA-COMMIT-COUNT                             18400006
              WHEN SQLCODE NOT EQUAL ZERO                               18410000
                  MOVE '7000-COMMIT' TO PV-PARAGRAPH-NAME               18420003
                  PERFORM 9999-SQL-ABEND                                18430000
           END-EVALUATE.                                                18440000
                                                                        18450000
                                                                        18460000
      ******************************************************************18470000
      *  TAKE FINAL COMMIT, DISPLAY FINAL COUNTS , CLOSE INPUT FILE    *18480000
      ******************************************************************18490000
       8000-EOJ-ROUTINE.                                                18500000
                                                                        18510000
           PERFORM 7000-COMMIT.                                         18520006
           PERFORM 9000-DISPLAY-COUNTS.                                 18530000
                                                                        18540000
           CLOSE PROCESS-DATE-FILE                                      18550007
                 REPORT-TABLE-UPDATE.                                   18560007
                                                                        18570007
                                                                        18580007
       9000-DISPLAY-COUNTS.                                             18590000
                                                                        18600000
           DISPLAY SPACES.                                              18610000
           DISPLAY '*** MLKUP707 RECORD COUNT SUMMARY'.                 18620000
           DISPLAY 'REPORT RECORDS WRITTEN : ', PA-RP-RECORD-WRITTEN.   18630009
           DISPLAY 'PADJ ROWS UPDATED      : ', PA-PADJ-UPDATE-COUNT.   18640023
           DISPLAY 'SALES ROWS UPDATED     : ', PA-SALE-UPDATE-COUNT.   18650009
           DISPLAY 'PRC CHG ROWS UPDATED   : ', PA-PCHG-UPDATE-COUNT.   18660009
           DISPLAY 'INV ADJ ROWS UPDATED   : ', PA-INAD-UPDATE-COUNT.   18670009
           DISPLAY 'COMMITS TAKEN          : ', PA-COMMIT-COUNT.        18680009
           DISPLAY SPACES.                                              18690000
                                                                        18700000
      ******************************************************************18710000
      *  STANDARD DB2 ERROR ABEND ROUTINE                               18720000
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             18730000
      ******************************************************************18740000
       9999-SQL-ABEND.                                                  18750000
                                                                        18760000
           MOVE +4013                 TO ABEND-CODE.                    18770000
           DISPLAY '**  ABEND     **'.                                  18780000
           DISPLAY '**  PROGRAM   ** => ' PC-PROGRAM-NAME.              18790000
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            18800000
           DISPLAY '**  OPERATION **  = ' PV-OPERATION-ATTEMPTED.       18810000
           PERFORM 9000-DISPLAY-COUNTS.                                 18820000
                                                                        18830000
      ***  THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         18840000
      ***  DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        18850000
                                                                        18860000
           COPY DPPD004.                                                18870000
           CALL 'ILBOABN0'  USING ABEND-CODE.                           18880000
