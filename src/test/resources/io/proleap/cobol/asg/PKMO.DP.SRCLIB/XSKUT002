000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.      XSKUT002.                                       00020000
000300 AUTHOR.          BARB ERTL.                                      00030000
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040000
000500 DATE-WRITTEN.    10/14/2002.                                     00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800**XS MQ RMS LOCATION MESSAGES UPDATES FOR TABLES:                 00080000
000900**                          XST_TERR                              00090000
001000**                          XST_REGN_TERR                         00100000
001100**                          XST_REGN                              00110000
001200**                          XST_DIST_REGN                         00120000
001300**                          XST_DIST                              00130000
001400**                          XST_LOC_DIST                          00140000
001500**                          XST_LOC                               00150000
001600**                          XST_DC_LOC_ASGMT                      00160000
001700**                          XST_STR_GP_TYP                        00170000
001800**                          XST_STR_GP                            00180000
001900**                          XST_STR_GP_MBSHP                      00190000
002000**                          XST_LOC_ATTR                          00200000
002100******************************************************************00210000
002200**THIS PROGRAM EVALUATES THE MESSAGE SENT BY RMS IN COPYBOOK      00220000
002300**     FORMAT HORD100, THEN CALLS THE APPLICABLE PROGRAM TO       00230000
002400**     DO THE MAINTENANCE REQUIRED FOR THAT MESSAGE.              00240000
002500******************************************************************00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700 CONFIGURATION SECTION.                                           00270000
002800 SOURCE-COMPUTER.        IBM-3090.                                00280000
002900 OBJECT-COMPUTER.        IBM-3090.                                00290000
003000 INPUT-OUTPUT SECTION.                                            00300000
003100 FILE-CONTROL.                                                    00310000
003200                                                                  00320000
003300     SELECT CONTROL-CARD-1                                        00330000
003400            ASSIGN TO INP01.                                      00340000
003500     SELECT CONTROL-CARD-2                                        00350000
003600            ASSIGN TO INP02.                                      00360000
003700     SELECT CONTROL-CARD-3                                        00370000
003800            ASSIGN TO INP03.                                      00380000
003900     SELECT MESSAGE-LOG                                           00390000
004000            ASSIGN TO OUT01.                                      00400000
004100                                                                  00410000
004200 DATA DIVISION.                                                   00420000
004300 FILE SECTION.                                                    00430000
004400                                                                  00440000
004500 FD  CONTROL-CARD-1                                               00450000
004600     RECORDING MODE F                                             00460000
004700     BLOCK CONTAINS 0 RECORDS                                     00470000
004800     LABEL RECORDS ARE OMITTED                                    00480000
004900     DATA RECORD IS CONTROL-CARD-1-RECORD.                        00490000
005000 01  CONTROL-CARD-1-RECORD           PIC X(080).                  00500000
005100                                                                  00510000
005200 FD  CONTROL-CARD-2                                               00520000
005300     RECORDING MODE F                                             00530000
005400     BLOCK CONTAINS 0 RECORDS                                     00540000
005500     LABEL RECORDS ARE OMITTED                                    00550000
005600     DATA RECORD IS CONTROL-CARD-2-RECORD.                        00560000
005700 01  CONTROL-CARD-2-RECORD           PIC X(080).                  00570000
005800                                                                  00580000
005900 FD  CONTROL-CARD-3                                               00590000
006000     RECORDING MODE F                                             00600000
006100     BLOCK CONTAINS 0 RECORDS                                     00610000
006200     LABEL RECORDS ARE OMITTED                                    00620000
006300     DATA RECORD IS CONTROL-CARD-3-RECORD.                        00630000
006400 01  CONTROL-CARD-3-RECORD           PIC X(080).                  00640000
006500                                                                  00650000
006600 FD  MESSAGE-LOG                                                  00660000
006700     RECORDING MODE F                                             00670000
006800     BLOCK CONTAINS 0 RECORDS                                     00680000
006900     LABEL RECORDS ARE OMITTED                                    00690000
007000     DATA RECORD IS MESSAGE-LOG-RECORD.                           00700000
007100 01  MESSAGE-LOG-RECORD              PIC X(500).                  00710000
007200                                                                  00720000
007300 WORKING-STORAGE SECTION.                                         00730000
007400******************************************************************00740000
007500**PROGRAM SWITCHES                                                00750000
007600******************************************************************00760000
007700 01  PS-PROGRAM-SWITCHES.                                         00770000
007800     05  PS-PROCESS-INDICATOR-SW         PIC X(01)   VALUE 'Y'.   00780000
007900         88  PS-PROCESS-COMPLETE                     VALUE 'N'.   00790000
008000         88  PS-PROCESS-CONTINUE                     VALUE 'Y'.   00800000
008100******************************************************************00810000
008200**CONTROL CARD 1 RECORD LAYOUT - QUEUE MANAGER NAME               00820000
008300******************************************************************00830000
008400 01  CC-CONTROL-CARD-1-LAYOUT.                                    00840000
008500     05  CC-QUEUE-MANAGER-NAME      PIC X(48)   VALUE SPACES.     00850000
008600     05  FILLER                     PIC X(32)   VALUE SPACES.     00860000
008700******************************************************************00870000
008800**CONTROL CARD 2 RECORD LAYOUT - LOCATION QUEUE NAME              00880000
008900******************************************************************00890000
009000 01  CC-CONTROL-CARD-2-LAYOUT.                                    00900000
009100     05  CC-LOCATION-QUEUE-NAME     PIC X(48)   VALUE SPACES.     00910000
009200     05  FILLER                     PIC X(32)   VALUE SPACES.     00920000
009300******************************************************************00930000
009400**CONTROL CARD 3 RECORD LAYOUT - LOCATION HIER ERROR QUEUE NAME   00940000
009500******************************************************************00950000
009600 01  CC-CONTROL-CARD-3-LAYOUT.                                    00960000
009700     05  CC-LOC-ERROR-QUEUE-NAME    PIC X(48)   VALUE SPACES.     00970000
009800     05  FILLER                     PIC X(32)   VALUE SPACES.     00980000
009900******************************************************************00990000
010000**PROGRAM CONSTANTS                                               01000000
010100******************************************************************01010000
010200 01  PC-PROGRAM-CONSTANTS.                                        01020000
010300     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)   VALUE 'XSKUT002'. 01030000
010400     05  PC-CALLED-PROGRAM          PIC X(08).                    01040000
010500         88  PC-CALL-AREA-PGM                   VALUE 'XSKUP003'. 01050000
010600         88  PC-CALL-REGION-PGM                 VALUE 'XSKUP004'. 01060000
010700         88  PC-CALL-DIST-PGM                   VALUE 'XSKUP025'. 01070000
010800         88  PC-CALL-STORE-PGM                  VALUE 'XSKUP039'. 01080000
010900         88  PC-CALL-STORE-ATTR-PGM             VALUE 'XSKUP042'. 01090000
011000         88  PC-CALL-OUTLOC-PGM                 VALUE 'XSKUP043'. 01100000
011100         88  PC-CALL-WH-PGM                     VALUE 'XSKUP044'. 01110000
011200         88  PC-CALL-WH-ATTR-PGM                VALUE 'XSKUP045'. 01120000
011300         88  PC-CALL-WH-STR-ASGN-PGM            VALUE 'XSKUP047'. 01130000
011400         88  PC-CALL-PRICE-ZONE-PGM             VALUE 'XSKUP061'. 01140000
011500         88  PC-CALL-METRO-PRICE-PGM            VALUE 'XSKUP062'. 01150000
011600         88  PC-CALL-ZONE-STORE-PGM             VALUE 'XSKUP063'. 01160000
011700         88  PC-CALL-PRICE-ZONE-GROUP-PGM       VALUE 'XSKUP060'. 01170000
011800     05  PC-STORE-TABLE            PIC X(30) VALUE                01180000
011900        'STORE                         '.                         01190000
012000     05  PC-STORE-ATTRIBUTES-TABLE PIC X(30) VALUE                01200000
012100        'STORE_ATTRIBUTES              '.                         01210000
012200     05  PC-AREA-TABLE             PIC X(30) VALUE                01220000
012300        'AREA                          '.                         01230000
012400     05  PC-REGION-TABLE           PIC X(30) VALUE                01240000
012500        'REGION                        '.                         01250000
012600     05  PC-DISTRICT-TABLE         PIC X(30) VALUE                01260000
012700        'DISTRICT                      '.                         01270000
012800     05  PC-OUTLOC-TABLE           PIC X(30) VALUE                01280000
012900        'OUTLOC                        '.                         01290000
013000     05  PC-WH-TABLE               PIC X(30) VALUE                01300000
013100        'WH                            '.                         01310000
013200     05  PC-WH-ATTRIBUTES-TABLE    PIC X(30) VALUE                01320000
013300        'WH_ATTRIBUTES                 '.                         01330000
013400     05  PC-WH-STORE-ASSIGN        PIC X(30) VALUE                01340000
013500        'WH_STORE_ASSIGN               '.                         01350000
013600     05  PC-PRICE-ZONE             PIC X(30) VALUE                01360000
013700        'PRICE_ZONE                    '.                         01370000
013800     05  PC-PRICE-ZONE-GROUP       PIC X(30) VALUE                01380000
013900        'PRICE_ZONE_GROUP              '.                         01390000
014000     05  PC-K-EMT-METRO-PRICE-ZONE PIC X(30) VALUE                01400000
014100        'K_EMT_METRO_PRICE_ZONE        '.                         01410000
014200     05  PC-K-EMT-ZONE-STORE-DATE  PIC X(30) VALUE                01420000
014300        'K_EMT_ZONE_STORE_DATE         '.                         01430000
014400******************************************************************01440000
014500**MQ WORKING STORAGE                                              01450000
014600******************************************************************01460000
014700 01  MQV-WORKING-STORAGE.                                         01470000
014800     05  MQV-MQCONN                 PIC  X(08) VALUE 'CSQBCONN'.  01480000
014900     05  MQV-MQOPEN                 PIC  X(08) VALUE 'CSQBOPEN'.  01490000
015000     05  MQV-MQPUT1                 PIC  X(08) VALUE 'CSQBPUT1'.  01500000
015100     05  MQV-MQGET                  PIC  X(08) VALUE 'CSQBGET'.   01510000
015200     05  MQV-MQCMIT                 PIC  X(08) VALUE 'CSQBCOMM'.  01520000
015300     05  MQV-MQBACK                 PIC  X(08) VALUE 'CSQBBACK'.  01530000
015400     05  MQV-MQCLOSE                PIC  X(08) VALUE 'CSQBCLOS'.  01540000
015500     05  MQV-MQDISC                 PIC  X(08) VALUE 'CSQBDISC'.  01550000
015600     05  MQV-MQCHECK                PIC  X(08) VALUE 'MQR2C'.     01560000
015700     05  MQV-HCONN                  PIC S9(09) BINARY VALUE 0.    01570000
015800     05  MQV-COMPLETION-CODE        PIC S9(09) BINARY.            01580000
015900     05  MQV-REASON                 PIC S9(09) BINARY.            01590000
016000     05  MQV-OPEN-OPTIONS           PIC S9(09) BINARY.            01600000
016100     05  MQV-LOC-HANDLE             PIC S9(09) BINARY VALUE 0.    01610000
016200     05  MQV-ERROR-HANDLE           PIC S9(09) BINARY VALUE 0.    01620000
016300     05  MQV-REASON-TEXT            PIC X(30)  VALUE SPACES.      01630000
016400     05  MQV-MSGBUFFER              PIC X(450) VALUE SPACES.      01640000
016500     05  MQV-MSG                    PIC X(450) VALUE SPACES.      01650000
016600     05  MQV-ERRMSGBUF              PIC X(500) VALUE SPACES.      01660000
016700     05  MQV-MSG-LENGTH             PIC S9(09) BINARY VALUE +500. 01670000
016800     05  MQV-DATA-LENGTH            PIC S9(09) BINARY.            01680000
016900******************************************************************01690000
017000**COPYBOOKS                                                       01700000
017100******************************************************************01710000
017200***INPUT FILE LAYOUT - LOCATION MESSAGE COPYBOOK                  01720000
017300     COPY HORD100.                                                01730000
017400* ------------------------------------------------------------- * 01740000
017500*  COMMUNICATION AREAS FOR DB2                                    01750000
017600* ------------------------------------------------------------- * 01760000
017700     EXEC SQL                                                     01770000
017800         INCLUDE SQLCA                                            01780000
017900     END-EXEC.                                                    01790000
018000                                                                  01800000
018100* ------------------------------------------------------------- * 01810000
018200*  ERROR MESSAGE AREA FOR DB2                                   * 01820000
018300* ------------------------------------------------------------- * 01830000
018400     COPY DPWS004.                                                01840000
018500                                                                  01850000
018600***OBJECT-DESCRIPTOR.                                             01860000
018700 01  MQM-OBJECT-DESCRIPTOR.                                       01870000
018800     COPY CMQODV.                                                 01880000
018900***MESSAGE-DESCRIPTOR.                                            01890000
019000 01  MQM-MESSAGE-DESCRIPTOR.                                      01900000
019100     COPY CMQMDV.                                                 01910000
019200***GET-MESSAGE-OPTIONS.                                           01920000
019300 01  MQM-GET-MESSAGE-OPTIONS.                                     01930000
019400     COPY CMQGMOV.                                                01940000
019500***PUT-MESSAGE-OPTIONS.                                           01950000
019600 01  MQM-PUT-MESSAGE-OPTIONS.                                     01960000
019700     COPY CMQPMOV.                                                01970000
019800***CONSTANTS.                                                     01980000
019900 01  MQM-CONSTANTS.                                               01990000
020000     COPY CMQV.                                                   02000000
020100******************************************************************02010000
020200**PROGRAM ACCUMULATORS                                            02020000
020300******************************************************************02030000
020400 01  PA-PROGRAM-ACCUMULATORS.                                     02040000
020500     05  PA-MESSAGE-FROM-QUEUE        PIC 9(06) VALUE ZEROS.      02050000
020600     05  PA-MESSAGES-WRITTEN-TO-FILE  PIC 9(06) VALUE ZEROS.      02060000
020700     05  PA-MESSAGES-TO-ERROR-QUEUE   PIC 9(06) VALUE ZEROS.      02070000
020800     05  PA-STORE-MESSAGES            PIC 9(07) VALUE 0.          02080000
020900     05  PA-STORE-ATTRIB-MESSAGES     PIC 9(07) VALUE 0.          02090000
021000     05  PA-WH-MESSAGES               PIC 9(07) VALUE 0.          02100000
021100     05  PA-WH-ATTRIB-MESSAGES        PIC 9(07) VALUE 0.          02110000
021200     05  PA-WH-STR-ASSIGN-MESSAGES    PIC 9(07) VALUE 0.          02120000
021300     05  PA-AREA-MESSAGES             PIC 9(07) VALUE 0.          02130000
021400     05  PA-REGION-MESSAGES           PIC 9(07) VALUE 0.          02140000
021500     05  PA-DISTRICT-MESSAGES         PIC 9(07) VALUE 0.          02150000
021600     05  PA-OUTLOC-MESSAGES           PIC 9(07) VALUE 0.          02160000
021700     05  PA-ZONE-STORE-MESSAGES       PIC 9(07) VALUE 0.          02170000
021800     05  PA-PRICE-ZONE-GRP-MESSAGES   PIC 9(07) VALUE 0.          02180000
021900     05  PA-METRO-PRICE-MESSAGES      PIC 9(07) VALUE 0.          02190000
022000     05  PA-PRICE-ZONE-MESSAGES       PIC 9(07) VALUE 0.          02200000
022100     05  PA-NOT-PROCESSED             PIC 9(07) VALUE 0.          02210000
022200                                                                  02220000
022300******************************************************************02230000
022400**ERROR HANDLING                                                  02240000
022500******************************************************************02250000
022600 01  PV-MISC-ABEND-FIELDS.                                        02260000
022700     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      02270000
022800     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      02280000
022900     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      02290000
023000     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      02300000
023100     05  PV-DISPLAY-RETURN-CODE       PIC ZZZZ9- VALUE ZERO.      02310000
023200 01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 02320000
023300     88  ABEND-4013-DB2-ERROR             VALUE +4013.            02330000
023400     88  ABEND-4020-MQ-ERROR              VALUE +4020.            02340000
023500     88  ABEND-4008-INVALID-DATA          VALUE +4008.            02350000
023600******************************************************************02360000
023700**LINKAGE VARIABLES                                               02370000
023800******************************************************************02380000
023900 01  LV-LINKAGE-VARIABLES.                                        02390000
024000     05  LV-HORD100-RECORD            PIC X(500) VALUE SPACES.    02400000
024100     05  LV-RETURN-CODE               PIC S9(04) VALUE ZEROS.     02410000
024200                                                                  02420000
024300 PROCEDURE DIVISION.                                              02430000
024400***************************************************************** 02440000
024500                                                                  02450000
024600     PERFORM 1000-INITIALIZATION.                                 02460000
024700     PERFORM 2000-PROCESS-RECORDS                                 02470000
024800             UNTIL PS-PROCESS-COMPLETE.                           02480000
024900     PERFORM 8200-WRAPUP.                                         02490000
025000     GOBACK.                                                      02500000
025100                                                                  02510000
025200******************************************************************02520000
025300**INITIALIZATION AREA - SETUP QUEUES FOR PROCESSING               02530000
025400******************************************************************02540000
025500 1000-INITIALIZATION.                                             02550000
025600                                                                  02560000
025700     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             02570000
025800                                                                  02580000
025900     OPEN INPUT  CONTROL-CARD-1                                   02590000
026000                 CONTROL-CARD-2                                   02600000
026100                 CONTROL-CARD-3                                   02610000
026200          OUTPUT MESSAGE-LOG.                                     02620000
026300                                                                  02630000
026400     PERFORM 8500-READ-CONTROL-CARD-1.                            02640000
026500     PERFORM 8600-READ-CONTROL-CARD-2.                            02650000
026600     PERFORM 8700-READ-CONTROL-CARD-3.                            02660000
026700                                                                  02670000
026800     IF  CC-QUEUE-MANAGER-NAME    =  SPACES                       02680000
026900      OR CC-LOCATION-QUEUE-NAME =    SPACES                       02690000
027000      OR CC-LOC-ERROR-QUEUE-NAME =     SPACES                     02700000
027100         DISPLAY 'EMPTY CONTROL CARD'                             02710000
027200         DISPLAY 'QUEUE MANAGER NAME    ' CC-QUEUE-MANAGER-NAME   02720000
027300         DISPLAY 'LOCATION QUEUE NAME ' CC-LOCATION-QUEUE-NAME    02730000
027400         DISPLAY 'LOCATION ERROR QUEUE NAME '                     02740000
027500                                   CC-LOC-ERROR-QUEUE-NAME        02750000
027600         PERFORM 9000-MQ-ABEND                                    02760000
027700     END-IF.                                                      02770000
027800                                                                  02780000
027900     PERFORM 1100-CONNECT-TO-QMGR.                                02790000
028000     PERFORM 1200-OPEN-LOCATION-QUEUE.                            02800000
028100                                                                  02810000
028200     PERFORM 8000-RETRIEVE-MESSAGE.                               02820000
028300                                                                  02830000
028400******************************************************************02840000
028500**CONNECT TO THE QUEUE MANAGER                                    02850000
028600******************************************************************02860000
028700 1100-CONNECT-TO-QMGR.                                            02870000
028800                                                                  02880000
028900     MOVE '1100-CONNECT-TO-QMGR'       TO PV-PARAGRAPH-NAME.      02890000
029000                                                                  02900000
029100     CALL MQV-MQCONN USING CC-QUEUE-MANAGER-NAME                  02910000
029200                           MQV-HCONN                              02920000
029300                           MQV-COMPLETION-CODE                    02930000
029400                           MQV-REASON.                            02940000
029500                                                                  02950000
029600     EVALUATE TRUE                                                02960000
029700        WHEN MQV-COMPLETION-CODE = MQCC-OK                        02970000
029800             DISPLAY 'SUCCESSFULLY CONNECTED TO: '                02980000
029900                                            CC-QUEUE-MANAGER-NAME 02990000
030000        WHEN OTHER                                                03000000
030100             CALL MQV-MQCHECK USING MQV-REASON                    03010000
030200                                    MQV-REASON-TEXT               03020000
030300             DISPLAY 'QUEUE CONNECTING TO ' CC-QUEUE-MANAGER-NAME 03030000
030400             MOVE 'UNABLE TO CONNECT'  TO PV-OPERATION-MSG-1      03040000
030500             PERFORM 9000-MQ-ABEND                                03050000
030600     END-EVALUATE.                                                03060000
030700                                                                  03070000
030800******************************************************************03080000
030900**OPEN THE LOCATION HIER QUEUE                                    03090000
031000******************************************************************03100000
031100 1200-OPEN-LOCATION-QUEUE.                                        03110000
031200                                                                  03120000
031300     MOVE '1200-OPEN-LOCATION-QUEUE' TO PV-PARAGRAPH-NAME.        03130000
031400                                                                  03140000
031500     MOVE CC-LOCATION-QUEUE-NAME TO MQOD-OBJECTNAME               03150000
031600     MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        03160000
031700                                                                  03170000
031800     COMPUTE MQV-OPEN-OPTIONS      = MQOO-INPUT-SHARED            03180000
031900                                   + MQOO-FAIL-IF-QUIESCING.      03190000
032000                                                                  03200000
032100     CALL MQV-MQOPEN USING MQV-HCONN                              03210000
032200                           MQM-OBJECT-DESCRIPTOR                  03220000
032300                           MQV-OPEN-OPTIONS                       03230000
032400                           MQV-LOC-HANDLE                         03240000
032500                           MQV-COMPLETION-CODE                    03250000
032600                           MQV-REASON.                            03260000
032700                                                                  03270000
032800     EVALUATE TRUE                                                03280000
032900        WHEN MQV-COMPLETION-CODE = MQCC-OK                        03290000
033000             DISPLAY 'SUCCESSFULLY OPENED QUEUE: '                03300000
033100                                        CC-LOCATION-QUEUE-NAME    03310000
033200        WHEN OTHER                                                03320000
033300             CALL MQV-MQCHECK USING MQV-REASON                    03330000
033400                                   MQV-REASON-TEXT                03340000
033500             DISPLAY 'CANNOT OPEN QUEUE ' CC-LOCATION-QUEUE-NAME  03350000
033600             MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      03360000
033700             PERFORM 8300-DISCONNECT-QMGR                         03370000
033800             PERFORM 9000-MQ-ABEND                                03380000
033900     END-EVALUATE.                                                03390000
034000                                                                  03400000
034100******************************************************************03410000
034200**READ ITEM MESSAGE AND BASED ON BUSINESS EVENT CALL PROGRAM      03420000
034300**     TO EXECUTE BUSINESS LOGIC.                                 03430000
034400******************************************************************03440000
034500 2000-PROCESS-RECORDS.                                            03450000
034600                                                                  03460000
034700     MOVE '2000-PROCESS-RECORDS'         TO PV-PARAGRAPH-NAME.    03470000
034800                                                                  03480000
034900*INITIALIZE VARIABLES FOR EACH MESSAGE RETRIEVED                  03490000
035000     INITIALIZE MESSAGE-LOG-RECORD.                               03500000
035100     INITIALIZE LV-LINKAGE-VARIABLES.                             03510000
035200                                                                  03520000
035300     EVALUATE TRUE                                                03530000
035400        WHEN HO100-RMS-TBL-NAME = PC-AREA-TABLE                   03540000
035500             ADD +1                  TO PA-AREA-MESSAGES          03550000
035600             SET PC-CALL-AREA-PGM    TO TRUE                      03560000
035700             PERFORM 2100-CALL-PROGRAM                            03570000
035800        WHEN HO100-RMS-TBL-NAME = PC-REGION-TABLE                 03580000
035900             ADD +1                  TO PA-REGION-MESSAGES        03590000
036000             SET PC-CALL-REGION-PGM  TO TRUE                      03600000
036100             PERFORM 2100-CALL-PROGRAM                            03610000
036200        WHEN HO100-RMS-TBL-NAME = PC-DISTRICT-TABLE               03620000
036300             ADD +1                  TO PA-DISTRICT-MESSAGES      03630000
036400             SET PC-CALL-DIST-PGM    TO TRUE                      03640000
036500             PERFORM 2100-CALL-PROGRAM                            03650000
036600        WHEN HO100-RMS-TBL-NAME = PC-STORE-TABLE                  03660000
036700             ADD +1                  TO PA-STORE-MESSAGES         03670000
036800             SET PC-CALL-STORE-PGM   TO TRUE                      03680000
036900             PERFORM 2100-CALL-PROGRAM                            03690000
037000        WHEN HO100-RMS-TBL-NAME = PC-STORE-ATTRIBUTES-TABLE       03700000
037100             ADD +1                  TO PA-STORE-ATTRIB-MESSAGES  03710000
037200             SET PC-CALL-STORE-ATTR-PGM TO TRUE                   03720000
037300             PERFORM 2100-CALL-PROGRAM                            03730000
037400        WHEN HO100-RMS-TBL-NAME = PC-WH-TABLE                     03740000
037500             ADD +1                  TO PA-WH-MESSAGES            03750000
037600             SET PC-CALL-WH-PGM      TO TRUE                      03760000
037700             PERFORM 2100-CALL-PROGRAM                            03770000
037800        WHEN HO100-RMS-TBL-NAME = PC-WH-ATTRIBUTES-TABLE          03780000
037900             ADD +1                  TO PA-WH-ATTRIB-MESSAGES     03790000
038000             SET PC-CALL-WH-ATTR-PGM TO TRUE                      03800000
038100             PERFORM 2100-CALL-PROGRAM                            03810000
038200        WHEN HO100-RMS-TBL-NAME = PC-WH-STORE-ASSIGN              03820000
038300             ADD +1                  TO PA-WH-STR-ASSIGN-MESSAGES 03830000
038400             SET PC-CALL-WH-STR-ASGN-PGM TO TRUE                  03840000
038500             PERFORM 2100-CALL-PROGRAM                            03850000
038600        WHEN HO100-RMS-TBL-NAME = PC-OUTLOC-TABLE                 03860000
038700             ADD +1                  TO PA-OUTLOC-MESSAGES        03870000
038800             SET PC-CALL-OUTLOC-PGM  TO TRUE                      03880000
038900             PERFORM 2100-CALL-PROGRAM                            03890000
039000        WHEN HO100-RMS-TBL-NAME = PC-PRICE-ZONE-GROUP             03900000
039100             ADD +1                  TO PA-PRICE-ZONE-GRP-MESSAGES03910000
039200             SET PC-CALL-PRICE-ZONE-GROUP-PGM TO TRUE             03920000
039300             PERFORM 2100-CALL-PROGRAM                            03930000
039400        WHEN HO100-RMS-TBL-NAME = PC-K-EMT-METRO-PRICE-ZONE       03940000
039500             ADD +1                  TO PA-METRO-PRICE-MESSAGES   03950000
039600             SET PC-CALL-METRO-PRICE-PGM TO TRUE                  03960000
039700             PERFORM 2100-CALL-PROGRAM                            03970000
039800        WHEN HO100-RMS-TBL-NAME = PC-PRICE-ZONE                   03980000
039900             ADD +1                  TO PA-PRICE-ZONE-MESSAGES    03990000
040000             SET PC-CALL-PRICE-ZONE-PGM TO TRUE                   04000000
040100             PERFORM 2100-CALL-PROGRAM                            04010000
040200        WHEN HO100-RMS-TBL-NAME = PC-K-EMT-ZONE-STORE-DATE        04020000
040300             ADD +1                  TO PA-ZONE-STORE-MESSAGES    04030000
040400             SET PC-CALL-ZONE-STORE-PGM TO TRUE                   04040000
040500             PERFORM 2100-CALL-PROGRAM                            04050000
040600        WHEN OTHER                                                04060000
040700             ADD +1                  TO PA-NOT-PROCESSED          04070000
040800             DISPLAY ' MESSAGE NOT BEING PROCESSED   '            04080000
040900             DISPLAY ' TABLE NAME '                               04090000
041000                       HO100-RMS-TBL-NAME                         04100000
041100             PERFORM 2400-BACKUP-MESSAGE                          04110000
041200             PERFORM 2300-COMMIT-MESSAGE                          04120000
041300     END-EVALUATE.                                                04130000
041400                                                                  04140000
041500                                                                  04150000
041600     PERFORM 8000-RETRIEVE-MESSAGE.                               04160000
041700                                                                  04170000
041800******************************************************************04180000
041900**CALL PROGRAM TO EXECUTE MESSAGE                                 04190000
042000******************************************************************04200000
042100 2100-CALL-PROGRAM.                                               04210000
042200                                                                  04220000
042300     MOVE '2100-CALL-PROGRAM' TO PV-PARAGRAPH-NAME.               04230000
042400                                                                  04240000
042500     MOVE HORD100-RECORD      TO LV-HORD100-RECORD.               04250000
042600                                                                  04260000
042700     CALL PC-CALLED-PROGRAM USING LV-HORD100-RECORD               04270000
042800                                  LV-RETURN-CODE.                 04280000
042900                                                                  04290000
043000     EVALUATE TRUE                                                04300000
043100        WHEN LV-RETURN-CODE EQUAL ZEROS                           04310000
043200             PERFORM 2200-COMMIT-DB2                              04320000
043300             PERFORM 2300-COMMIT-MESSAGE                          04330000
043400             PERFORM 2400-BACKUP-MESSAGE                          04340000
043500        WHEN LV-RETURN-CODE NOT EQUAL ZEROS                       04350000
043600             PERFORM 2500-PUT-ON-ERROR-QUEUE                      04360000
043700             PERFORM 2300-COMMIT-MESSAGE                          04370000
043800     END-EVALUATE.                                                04380000
043900                                                                  04390000
044000****************************************************************  04400000
044100*COMMIT DATA TO DB2                                               04410000
044200****************************************************************  04420000
044300 2200-COMMIT-DB2.                                                 04430000
044400                                                                  04440000
044500     MOVE '2200-COMMIT-DB2' TO PV-PARAGRAPH-NAME.                 04450000
044600                                                                  04460000
044700     EXEC SQL                                                     04470000
044800          COMMIT                                                  04480000
044900     END-EXEC.                                                    04490000
045000                                                                  04500000
045100     EVALUATE TRUE                                                04510000
045200        WHEN SQLCODE = 0                                          04520000
045300             CONTINUE                                             04530000
045400        WHEN OTHER                                                04540000
045500             DISPLAY 'UNABLE TO COMMIT DATA'                      04550000
045600             PERFORM 8100-BACK-OUT-MQV-CHANGES                    04560000
045700             PERFORM 8300-DISCONNECT-QMGR                         04570000
045800             PERFORM 9100-SQL-ABEND-ROUTINE                       04580000
045900     END-EVALUATE.                                                04590000
046000                                                                  04600000
046100******************************************************************04610000
046200**REMOVES MESSAGE FROM QUEUE                                      04620000
046300******************************************************************04630000
046400 2300-COMMIT-MESSAGE.                                             04640000
046500                                                                  04650000
046600     MOVE '2300-COMMIT-MESSAGE'          TO PV-PARAGRAPH-NAME.    04660000
046700                                                                  04670000
046800     CALL MQV-MQCMIT USING MQV-HCONN                              04680000
046900                           MQV-COMPLETION-CODE                    04690000
047000                           MQV-REASON.                            04700000
047100                                                                  04710000
047200     EVALUATE TRUE                                                04720000
047300        WHEN MQV-COMPLETION-CODE = MQCC-OK                        04730000
047400             CONTINUE                                             04740000
047500        WHEN OTHER                                                04750000
047600             CALL MQV-MQCHECK USING MQV-REASON                    04760000
047700                                    MQV-REASON-TEXT               04770000
047800             MOVE 'ERROR COMMITING DATA' TO PV-OPERATION-MSG-1    04780000
047900             PERFORM 8100-BACK-OUT-MQV-CHANGES                    04790000
048000             PERFORM 8300-DISCONNECT-QMGR                         04800000
048100             PERFORM 9000-MQ-ABEND                                04810000
048200     END-EVALUATE.                                                04820000
048300                                                                  04830000
048400******************************************************************04840000
048500**WRITES MESSAGE TO A LOG IN CASE RECOVERY IS NEEDED              04850000
048600******************************************************************04860000
048700 2400-BACKUP-MESSAGE.                                             04870000
048800                                                                  04880000
048900     MOVE '2400-BACKUP-MESSAGE' TO PV-PARAGRAPH-NAME.             04890000
049000                                                                  04900000
049100     MOVE MQV-MSGBUFFER         TO MESSAGE-LOG-RECORD.            04910000
049200     WRITE MESSAGE-LOG-RECORD.                                    04920000
049300     ADD +1                     TO PA-MESSAGES-WRITTEN-TO-FILE.   04930000
049400                                                                  04940000
049500******************************************************************04950000
049600**PUTS MESSAGE THAT HAD ERROR ON ERROR QUEUE                      04960000
049700******************************************************************04970000
049800 2500-PUT-ON-ERROR-QUEUE.                                         04980000
049900                                                                  04990000
050000     MOVE '2500-PUT-ON-ERROR-QUEUE' TO PV-PARAGRAPH-NAME.         05000000
050100                                                                  05010000
050200     COMPUTE MQV-OPEN-OPTIONS = MQOO-FAIL-IF-QUIESCING +          05020000
050300                                MQOO-OUTPUT.                      05030000
050400     MOVE CC-LOC-ERROR-QUEUE-NAME TO MQOD-OBJECTNAME              05040000
050500     MOVE CC-QUEUE-MANAGER-NAME   TO MQOD-OBJECTQMGRNAME.         05050000
050600                                                                  05060000
050700     MOVE HORD100-RECORD          TO MQV-ERRMSGBUF.               05070000
050800                                                                  05080000
050900     CALL MQV-MQPUT1 USING MQV-HCONN                              05090000
051000                          MQM-OBJECT-DESCRIPTOR                   05100000
051100                          MQM-MESSAGE-DESCRIPTOR                  05110000
051200                          MQM-PUT-MESSAGE-OPTIONS                 05120000
051300                          MQV-MSG-LENGTH                          05130000
051400                          MQV-ERRMSGBUF                           05140000
051500                          MQV-COMPLETION-CODE                     05150000
051600                          MQV-REASON.                             05160000
051700                                                                  05170000
051800     EVALUATE TRUE                                                05180000
051900        WHEN MQV-COMPLETION-CODE = MQCC-OK                        05190000
052000             ADD +1                 TO PA-MESSAGES-TO-ERROR-QUEUE 05200000
052100             MOVE LV-RETURN-CODE    TO PV-DISPLAY-RETURN-CODE     05210000
052200             DISPLAY 'LV-RETURN-CODE = ' PV-DISPLAY-RETURN-CODE   05220000
052300             DISPLAY 'MESSAGE        = ' HORD100-RECORD           05230000
052400        WHEN OTHER                                                05240000
052500             DISPLAY 'UNABLE TO WRITE TO LOC ERROR QUEUE'         05250000
052600             CALL MQV-MQCHECK USING MQV-REASON                    05260000
052700                                    MQV-REASON-TEXT               05270000
052800             MOVE 'MQPUT1 ERROR'      TO PV-OPERATION-MSG-1       05280000
052900             PERFORM 8300-DISCONNECT-QMGR                         05290000
053000             PERFORM 9000-MQ-ABEND                                05300000
053100     END-EVALUATE.                                                05310000
053200                                                                  05320000
053300******************************************************************05330000
053400**RETRIEVES NEXT MESSAGE FROM THE LOCATION QUEUE                  05340000
053500******************************************************************05350000
053600 8000-RETRIEVE-MESSAGE.                                           05360000
053700                                                                  05370000
053800     MOVE '8000-RETRIEVE-MESSAGE' TO PV-PARAGRAPH-NAME.           05380000
053900                                                                  05390000
054000     INITIALIZE MQV-MSGBUFFER                                     05400000
054100                MQV-ERRMSGBUF                                     05410000
054200                MQV-MSG.                                          05420000
054300                                                                  05430000
054400     MOVE MQMI-NONE            TO MQMD-MSGID.                     05440000
054500     MOVE MQCI-NONE            TO MQMD-CORRELID.                  05450000
054600     MOVE MQFMT-STRING         TO MQMD-FORMAT.                    05460000
054700                                                                  05470000
054800     COMPUTE MQGMO-OPTIONS  =  MQGMO-SYNCPOINT +                  05480000
054900                               MQGMO-CONVERT   +                  05490000
055000                               MQGMO-WAIT.                        05500000
055100                                                                  05510000
055200     CALL MQV-MQGET USING MQV-HCONN                               05520000
055300                          MQV-LOC-HANDLE                          05530000
055400                          MQM-MESSAGE-DESCRIPTOR                  05540000
055500                          MQM-GET-MESSAGE-OPTIONS                 05550000
055600                          MQV-MSG-LENGTH                          05560000
055700                          MQV-MSGBUFFER                           05570000
055800                          MQV-DATA-LENGTH                         05580000
055900                          MQV-COMPLETION-CODE                     05590000
056000                          MQV-REASON.                             05600000
056100                                                                  05610000
056200     IF  MQV-COMPLETION-CODE = MQCC-OK                            05620000
056300         ADD +1             TO PA-MESSAGE-FROM-QUEUE              05630000
056400         INITIALIZE HORD100-RECORD                                05640000
056500         MOVE MQV-MSGBUFFER TO HORD100-RECORD                     05650000
056600     ELSE                                                         05660000
056700         EVALUATE TRUE                                            05670000
056800            WHEN MQV-REASON = MQRC-NO-MSG-AVAILABLE               05680000
056900                 SET PS-PROCESS-COMPLETE     TO TRUE              05690000
057000            WHEN OTHER                                            05700000
057100                 CALL MQV-MQCHECK USING MQV-REASON                05710000
057200                                        MQV-REASON-TEXT           05720000
057300                 MOVE 'ERROR RETRIEVING MESSAGE'                  05730000
057400                                       TO PV-OPERATION-MSG-1      05740000
057500                 PERFORM 8100-BACK-OUT-MQV-CHANGES                05750000
057600                 PERFORM 8300-DISCONNECT-QMGR                     05760000
057700                 PERFORM 9000-MQ-ABEND                            05770000
057800         END-EVALUATE                                             05780000
057900     END-IF.                                                      05790000
058000                                                                  05800000
058100***************************************************************** 05810000
058200**ROLLBACK MQ CHANGES                                             05820000
058300***************************************************************** 05830000
058400 8100-BACK-OUT-MQV-CHANGES.                                       05840000
058500                                                                  05850000
058600     CALL MQV-MQBACK USING MQV-HCONN                              05860000
058700                           MQV-COMPLETION-CODE                    05870000
058800                           MQV-REASON.                            05880000
058900                                                                  05890000
059000     EVALUATE TRUE                                                05900000
059100        WHEN MQV-COMPLETION-CODE = MQCC-OK                        05910000
059200             CONTINUE                                             05920000
059300        WHEN OTHER                                                05930000
059400             CALL MQV-MQCHECK USING MQV-REASON                    05940000
059500                                    MQV-REASON-TEXT               05950000
059600             MOVE 'MQBACK ERROR'  TO PV-OPERATION-MSG-1           05960000
059700             PERFORM 8300-DISCONNECT-QMGR                         05970000
059800             PERFORM 9000-MQ-ABEND                                05980000
059900     END-EVALUATE.                                                05990000
060000                                                                  06000000
060100****************************************************************  06010000
060200*END OF PROGRAM ROUTINE                                           06020000
060300****************************************************************  06030000
060400 8200-WRAPUP.                                                     06040000
060500                                                                  06050000
060600     PERFORM 8400-CLOSE-QUEUES.                                   06060000
060700     PERFORM 8300-DISCONNECT-QMGR.                                06070000
060800                                                                  06080000
060900     CLOSE CONTROL-CARD-1                                         06090000
061000           CONTROL-CARD-2                                         06100000
061100           CONTROL-CARD-3                                         06110000
061200           MESSAGE-LOG.                                           06120000
061300                                                                  06130000
061400     PERFORM 8800-DISPLAY-STATISTICS.                             06140000
061500                                                                  06150000
061600     IF PA-MESSAGES-TO-ERROR-QUEUE > 0                            06160000
061700         SET ABEND-4008-INVALID-DATA TO TRUE                      06170000
061800         MOVE ABEND-CODE TO RETURN-CODE                           06180000
061900         CALL 'ILBOABN0' USING ABEND-CODE                         06190000
062000     END-IF.                                                      06200000
062100                                                                  06210000
062200***************************************************************** 06220000
062300**DISCONNECT FROM THE QUEUE MANAGER                               06230000
062400***************************************************************** 06240000
062500 8300-DISCONNECT-QMGR.                                            06250000
062600                                                                  06260000
062700     CALL MQV-MQDISC USING MQV-HCONN                              06270000
062800                           MQV-COMPLETION-CODE                    06280000
062900                           MQV-REASON.                            06290000
063000                                                                  06300000
063100     EVALUATE TRUE                                                06310000
063200        WHEN MQV-COMPLETION-CODE = MQCC-OK                        06320000
063300             CONTINUE                                             06330000
063400        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                06340000
063500             CALL MQV-MQCHECK USING MQV-REASON                    06350000
063600                                    MQV-REASON-TEXT               06360000
063700             MOVE 'MQDISC ERROR'       TO PV-OPERATION-MSG-1      06370000
063800             PERFORM 9000-MQ-ABEND                                06380000
063900     END-EVALUATE.                                                06390000
064000                                                                  06400000
064100***************************************************************** 06410000
064200**CLOSE XS ITEM AND XS ITEM ERROR QUEUE                           06420000
064300***************************************************************** 06430000
064400 8400-CLOSE-QUEUES.                                               06440000
064500                                                                  06450000
064600     CALL MQV-MQCLOSE USING MQV-HCONN                             06460000
064700                            MQV-LOC-HANDLE                        06470000
064800                            MQCO-NONE                             06480000
064900                            MQV-COMPLETION-CODE                   06490000
065000                            MQV-REASON.                           06500000
065100                                                                  06510000
065200     EVALUATE TRUE                                                06520000
065300        WHEN MQV-COMPLETION-CODE = MQCC-OK                        06530000
065400             CONTINUE                                             06540000
065500        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                06550000
065600             CALL MQV-MQCHECK USING MQV-REASON                    06560000
065700                                    MQV-REASON-TEXT               06570000
065800             MOVE 'CANNOT CLOSE LOC QUEUE' TO PV-OPERATION-MSG-1  06580000
065900             PERFORM 9000-MQ-ABEND                                06590000
066000     END-EVALUATE.                                                06600000
066100                                                                  06610000
066200***************************************************************** 06620000
066300**READ CONTROL CARD 1                                             06630000
066400***************************************************************** 06640000
066500 8500-READ-CONTROL-CARD-1.                                        06650000
066600                                                                  06660000
066700     READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1-LAYOUT.           06670000
066800                                                                  06680000
066900***************************************************************** 06690000
067000**READ CONTROL CARD 2                                             06700000
067100***************************************************************** 06710000
067200 8600-READ-CONTROL-CARD-2.                                        06720000
067300                                                                  06730000
067400     READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2-LAYOUT.           06740000
067500                                                                  06750000
067600***************************************************************** 06760000
067700**READ CONTROL CARD 3                                             06770000
067800***************************************************************** 06780000
067900 8700-READ-CONTROL-CARD-3.                                        06790000
068000                                                                  06800000
068100     READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3-LAYOUT.           06810000
068200                                                                  06820000
068300****************************************************************  06830000
068400*DISPLAY PROGRAM STATISTICS FOR THIS RUN                          06840000
068500****************************************************************  06850000
068600 8800-DISPLAY-STATISTICS.                                         06860000
068700                                                                  06870000
068800     DISPLAY '*********************************************'.     06880000
068900     DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            06890000
069000     DISPLAY '*********************************************'.     06900000
069100     DISPLAY 'MESSAGES FROM QUEUE: ' PA-MESSAGE-FROM-QUEUE.       06910000
069200     DISPLAY 'MESSAGES WRITTEN TO FILE: '                         06920000
069300                                  PA-MESSAGES-WRITTEN-TO-FILE.    06930000
069400     DISPLAY 'MESSAGES WRITTEN TO ERROR QUEUE: '                  06940000
069500                                  PA-MESSAGES-TO-ERROR-QUEUE.     06950000
069600     DISPLAY 'STORE-MESSAGES        ' PA-STORE-MESSAGES.          06960000
069700     DISPLAY 'STORE-ATTRIB-MESSAGES ' PA-STORE-ATTRIB-MESSAGES.   06970000
069800     DISPLAY 'WH-MESSAGES           ' PA-WH-MESSAGES.             06980000
069900     DISPLAY 'WH-ATTRIB-MESSAGES    ' PA-WH-ATTRIB-MESSAGES.      06990000
070000     DISPLAY 'WH-STR-ASSIGN-MESSAGES' PA-WH-STR-ASSIGN-MESSAGES.  07000000
070100     DISPLAY 'AREA-MESSAGES         ' PA-AREA-MESSAGES.           07010000
070200     DISPLAY 'REGION-MESSAGES       ' PA-REGION-MESSAGES.         07020000
070300     DISPLAY 'DISTRICT-MESSAGES     ' PA-DISTRICT-MESSAGES.       07030000
070400     DISPLAY 'OUTLOC-MESSAGES       ' PA-OUTLOC-MESSAGES.         07040000
070500     DISPLAY 'METRO-PRICE-MESSAGES  ' PA-METRO-PRICE-MESSAGES.    07050000
070600     DISPLAY 'PRICE-ZONE-MESSAGES   ' PA-PRICE-ZONE-MESSAGES.     07060000
070700     DISPLAY 'PRICE-ZONE-GRP-MESSAGE' PA-PRICE-ZONE-GRP-MESSAGES. 07070000
070800     DISPLAY 'ZONE-STR-DATE-MESSAGES' PA-ZONE-STORE-MESSAGES.     07080000
070900     DISPLAY 'MESSAGES NOT PROCESSED' PA-NOT-PROCESSED.           07090000
071000     DISPLAY '*********************************************'.     07100000
071100                                                                  07110000
071200******************************************************************07120000
071300**MQ ABEND ROUTINE                                                07130000
071400******************************************************************07140000
071500 9000-MQ-ABEND.                                                   07150000
071600                                                                  07160000
071700     MOVE +4020 TO ABEND-CODE.                                    07170000
071800                                                                  07180000
071900     DISPLAY '**** ABEND *************************************'.  07190000
072000     DISPLAY '** MQSERIES ERROR **'.                              07200000
072100     DISPLAY '** PROGRAM:    ' PC-CURRENT-PROGRAM-NAME.           07210000
072200     DISPLAY '** ABEND CODE: ' ABEND-CODE.                        07220000
072300     DISPLAY '** PARAGRAPH:  ' PV-PARAGRAPH-NAME.                 07230000
072400     DISPLAY '** MESSAGE:    ' PV-OPERATION-MSG-1.                07240000
072500     DISPLAY '** COMP CODE:  ' MQV-COMPLETION-CODE.               07250000
072600     DISPLAY '** RSN CODE:   ' MQV-REASON.                        07260000
072700     DISPLAY '** RSN TEXT:   ' MQV-REASON-TEXT.                   07270000
072800     DISPLAY '************************************************'.  07280000
072900     CALL 'ILBOABN0' USING ABEND-CODE.                            07290000
073000                                                                  07300000
073100******************************************************************07310000
073200**SQL ABEND ROUTINE                                               07320000
073300******************************************************************07330000
073400 9100-SQL-ABEND-ROUTINE.                                          07340000
073500                                                                  07350000
073600     DISPLAY '** ABEND     **'.                                   07360000
073700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07370000
073800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              07380000
073900     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               07390000
074000******************************************************************07400000
074100* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     07410000
074200* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      07420000
074300******************************************************************07430000
074400     COPY DPPD004.                                                07440000
074500     SET ABEND-4013-DB2-ERROR TO TRUE.                            07450000
074600     CALL 'ILBOABN0' USING ABEND-CODE.                            07460000
074700                                                                  07470000
