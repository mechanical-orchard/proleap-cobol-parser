000100******************************************************************00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300******************************************************************00030004
000400                                                                  00040004
000500 PROGRAM-ID.             PCKRP008.                                00050004
000600 AUTHOR.                 MICHAEL WALTERS.                         00060004
000700 INSTALLATION.           KOHLS.                                   00070004
000800 DATE-WRITTEN            SEPTEMBER, 1995.                         00080004
000900 DATE-COMPILED.                                                   00090004
001000                                                                  00100004
001100******************************************************************00110004
001200 ENVIRONMENT DIVISION.                                            00120004
001300******************************************************************00130004
001400                                                                  00140004
001500 CONFIGURATION SECTION.                                           00150004
001600                                                                  00160004
001700 SOURCE-COMPUTER.        IBM-3090.                                00170004
001800 OBJECT-COMPUTER.        IBM-3090.                                00180004
001900                                                                  00190004
002000 INPUT-OUTPUT SECTION.                                            00200004
002100                                                                  00210004
002200 FILE-CONTROL.                                                    00220004
002300                                                                  00230004
002400     SELECT RE-RECEIPT-EXTRACT                                    00240004
002500         ASSIGN TO IN01.                                          00250004
002600                                                                  00260004
002700     SELECT RT-RECEIPT-TURN-REPORT                                00270004
002800         ASSIGN TO RPT01.                                         00280004
002900                                                                  00290004
003000******************************************************************00300004
003100 DATA DIVISION.                                                   00310004
003200******************************************************************00320004
003300                                                                  00330004
003400 FILE SECTION.                                                    00340004
003500                                                                  00350004
003600 FD  RE-RECEIPT-EXTRACT                                           00360004
003700     RECORDING MODE IS F                                          00370004
003800     LABEL RECORDS ARE STANDARD                                   00380004
003900     BLOCK CONTAINS 0 RECORDS.                                    00390004
004000                                                                  00400004
004100 01  RE-RECEIPT-EXTRACT-RECORD       PIC  X(150).                 00410004
004200                                                                  00420004
004300 FD  RT-RECEIPT-TURN-REPORT                                       00430004
004400     RECORDING MODE IS F                                          00440004
004500     LABEL RECORDS ARE STANDARD                                   00450004
004600     BLOCK CONTAINS 0 RECORDS.                                    00460004
004700                                                                  00470004
004800 01  RT-RECEIPT-TURN-LINE            PIC  X(132).                 00480004
004900                                                                  00490004
005000******************************************************************00500004
005100 WORKING-STORAGE SECTION.                                         00510004
005200******************************************************************00520004
005300                                                                  00530004
005400*                                                                 00540004
005500*  WORK AREA FOR THE RECEIPT EXTRACT INPUT FILE.                  00550004
005600*                                                                 00560004
005700     COPY PCRD032.                                                00570011
005800                                                                  00580004
005900*                                                                 00590004
006000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                00600004
006100*                                                                 00610004
006200     COPY DPWS132O.                                               00620004
006300                                                                  00630004
006400*                                                                 00640004
006500*  WORK AREA FOR FISCAL CALENDAR ROUTINE.                         00650004
006600*                                                                 00660004
006700     COPY DPWS500.                                                00670004
006800                                                                  00680004
006900 01  ABEND-CODE                          PIC S9(04) VALUE +0      00690004
007000                                                     COMP SYNC.   00700004
007100*                                                                 00710004
007200*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      00720004
007300*                                                                 00730004
007400     COPY DPWS004.                                                00740004
007500                                                                  00750004
007600                                                                  00760004
007700 01  PH2-PAGE-HEADING-2.                                          00770004
007800     05  FILLER                          PIC  X(46)  VALUE SPACE. 00780004
007900     05  FILLER                          PIC  X(39)  VALUE        00790004
008000         'DISTRIBUTION CENTER RECEIPT TURN REPORT'.               00800004
008100     05  FILLER                          PIC  X(47)  VALUE SPACE. 00810004
008200                                                                  00820004
008300 01  PH3-PAGE-HEADING-3.                                          00830004
008400     05  FILLER                          PIC  X(54)  VALUE SPACE. 00840004
008500     05  PH3-DC-NAME                     PIC  X(40)  VALUE SPACE. 00850008
008600     05  FILLER                          PIC  X(38)  VALUE SPACE. 00860008
008700                                                                  00870004
008800 01  PH4-PAGE-HEADING-4.                                          00880004
008900     05  FILLER                          PIC  X(54)  VALUE SPACE. 00890004
009000     05  FILLER                          PIC  X(16)  VALUE        00900004
009100         'FOR WEEK ENDING '.                                      00910004
009200     05  PH4-WEEK-END-DATE               PIC  X(08)  VALUE SPACE. 00920004
009300     05  FILLER                          PIC  X(50)  VALUE SPACE. 00930004
009400                                                                  00940004
009500 01  PH5-PAGE-HEADING-5.                                          00950004
009600     05  FILLER                          PIC  X(14)  VALUE        00960004
009700         'PROCESS AREA: '.                                        00970004
009800     05  PH5-PRCS-AREA-CD                PIC  X(06)  VALUE SPACE. 00980004
009900     05  FILLER                          PIC  X(01)  VALUE '-'.   00990004
010000     05  PH5-PRCS-AREA-DESC              PIC  X(20)  VALUE SPACE. 01000004
010100     05  FILLER                          PIC  X(93)  VALUE SPACE. 01010004
010200                                                                  01020004
010300 01  DH1-DETAIL-HEADING-1.                                        01030004
010400     05  FILLER                          PIC  X(08)  VALUE        01040004
010500         ' ARRIVAL'.                                              01050004
010600     05  FILLER                          PIC  X(03)  VALUE SPACE. 01060004
010700     05  FILLER                          PIC  X(12)  VALUE        01070004
010800         '    PO -    '.                                          01080004
010900     05  FILLER                          PIC  X(03)  VALUE SPACE. 01090004
011000     05  FILLER                          PIC  X(30)  VALUE        01100004
011100         '                              '.                        01110004
011200     05  FILLER                          PIC  X(03)  VALUE SPACE. 01120004
011300     05  FILLER                          PIC  X(04)  VALUE        01130004
011400         'MDSE'.                                                  01140004
011500     05  FILLER                          PIC  X(02)  VALUE SPACE. 01150004
011600     05  FILLER                          PIC  X(07)  VALUE        01160004
011700         ' CARTON'.                                               01170004
011800     05  FILLER                          PIC  X(03)  VALUE SPACE. 01180004
011900     05  FILLER                          PIC  X(10)  VALUE        01190004
012000         '      UNIT'.                                            01200004
012100     05  FILLER                          PIC  X(02)  VALUE SPACE. 01210004
012200     05  FILLER                          PIC  X(08)  VALUE        01220004
012300         'TIMES IN'.                                              01230004
012400     05  FILLER                          PIC  X(02)  VALUE SPACE. 01240004
012500     05  FILLER                          PIC  X(08)  VALUE        01250004
012600         'DAYS IN '.                                              01260004
012700     05  FILLER                          PIC  X(02)  VALUE SPACE. 01270004
012800     05  FILLER                          PIC  X(08)  VALUE        01280004
012900         'VERIFIED'.                                              01290004
013000     05  FILLER                          PIC  X(02)  VALUE SPACE. 01300004
013100     05  FILLER                          PIC  X(07)  VALUE        01310004
013200         'PROCESS'.                                               01320004
013300                                                                  01330004
013400 01  DH2-DETAIL-HEADING-2.                                        01340004
013500     05  FILLER                          PIC  X(08)  VALUE        01350004
013600         '  DATE  '.                                              01360004
013700     05  FILLER                          PIC  X(03)  VALUE SPACE. 01370004
013800     05  FILLER                          PIC  X(12)  VALUE        01380004
013900         ' RECEIVER # '.                                          01390004
014000     05  FILLER                          PIC  X(03)  VALUE SPACE. 01400004
014100     05  FILLER                          PIC  X(30)  VALUE        01410004
014200         '  VENDOR NAME                 '.                        01420004
014300     05  FILLER                          PIC  X(03)  VALUE SPACE. 01430004
014400     05  FILLER                          PIC  X(04)  VALUE        01440004
014500         'DEPT'.                                                  01450004
014600     05  FILLER                          PIC  X(02)  VALUE SPACE. 01460004
014700     05  FILLER                          PIC  X(07)  VALUE        01470004
014800         '  COUNT'.                                               01480004
014900     05  FILLER                          PIC  X(03)  VALUE SPACE. 01490004
015000     05  FILLER                          PIC  X(10)  VALUE        01500004
015100         '     COUNT'.                                            01510004
015200     05  FILLER                          PIC  X(02)  VALUE SPACE. 01520004
015300     05  FILLER                          PIC  X(08)  VALUE        01530004
015400         'TROUBLE'.                                               01540004
015500     05  FILLER                          PIC  X(02)  VALUE SPACE. 01550004
015600     05  FILLER                          PIC  X(08)  VALUE        01560004
015700         'TROUBLE'.                                               01570004
015800     05  FILLER                          PIC  X(02)  VALUE SPACE. 01580004
015900     05  FILLER                          PIC  X(08)  VALUE        01590004
016000         '  DATE  '.                                              01600004
016100     05  FILLER                          PIC  X(03)  VALUE SPACE. 01610004
016200     05  FILLER                          PIC  X(06)  VALUE        01620004
016300         '  DAYS'.                                                01630004
016400                                                                  01640004
016500                                                                  01650004
016600 01  DH3-DETAIL-HEADING-3.                                        01660004
016700     05  FILLER                          PIC  X(08)  VALUE        01670004
016800         '________'.                                              01680004
016900     05  FILLER                          PIC  X(03)  VALUE SPACE. 01690004
017000     05  FILLER                          PIC  X(12)  VALUE        01700004
017100         '____________'.                                          01710004
017200     05  FILLER                          PIC  X(03)  VALUE SPACE. 01720004
017300     05  FILLER                          PIC  X(30)  VALUE        01730004
017400         '______________________________'.                        01740004
017500     05  FILLER                          PIC  X(03)  VALUE SPACE. 01750004
017600     05  FILLER                          PIC  X(04)  VALUE '____'.01760004
017700     05  FILLER                          PIC  X(02)  VALUE SPACE. 01770004
017800     05  FILLER                          PIC  X(07)  VALUE        01780004
017900         '_______'.                                               01790004
018000     05  FILLER                          PIC  X(03)  VALUE SPACE. 01800004
018100     05  FILLER                          PIC  X(10)  VALUE        01810004
018200         '__________'.                                            01820004
018300     05  FILLER                          PIC  X(02)  VALUE SPACE. 01830004
018400     05  FILLER                          PIC  X(08)  VALUE        01840004
018500         '________'.                                              01850004
018600     05  FILLER                          PIC  X(02)  VALUE SPACE. 01860004
018700     05  FILLER                          PIC  X(07)  VALUE        01870004
018800         '_______'.                                               01880004
018900     05  FILLER                          PIC  X(03)  VALUE SPACE. 01890004
019000     05  FILLER                          PIC  X(08)  VALUE        01900004
019100         '________'.                                              01910004
019200     05  FILLER                          PIC  X(03)  VALUE SPACE. 01920004
019300     05  FILLER                          PIC  X(06)  VALUE        01930004
019400         '______'.                                                01940004
019500                                                                  01950004
019600                                                                  01960004
019700 01  DL-DETAIL-LINE.                                              01970004
019800     05  DL-ARRIVAL-DATE                 PIC  X(08)  VALUE SPACE. 01980004
019900     05  FILLER                          PIC  X(03)  VALUE SPACE. 01990004
020000     05  DL-PO-NBR                       PIC Z9(07)  VALUE ZERO.  02000004
020100     05  FILLER                          PIC  X(01)  VALUE '-'.   02010004
020200     05  DL-REC-SEQ-NBR                  PIC  9(03)  VALUE ZERO.  02020004
020300     05  FILLER                          PIC  X(03)  VALUE SPACE. 02030004
020400     05  DL-VEND-NAME                    PIC  X(30)  VALUE SPACE. 02040004
020500     05  FILLER                          PIC  X(03)  VALUE SPACE. 02050004
020600     05  DL-DPT-NBR                      PIC  X(03)  VALUE SPACE. 02060004
020700     05  FILLER                          PIC  X(03)  VALUE SPACE. 02070004
020800     05  DL-CART-CNT                     PIC  ZZZ,ZZ9             02080004
020900                                                     VALUE ZERO.  02090004
021000     05  FILLER                          PIC  X(03)  VALUE SPACE. 02100004
021100     05  DL-UNIT-CNT                     PIC  ZZ,ZZZ,ZZ9          02110004
021200                                                     VALUE ZERO.  02120004
021300     05  FILLER                          PIC  X(05)  VALUE SPACE. 02130004
021400     05  DL-TRBL-CNT                     PIC  ZZZ9   VALUE ZERO.  02140004
021500     05  DL-TRBL-IND                     PIC  X(01)  VALUE SPACE. 02150004
021600     05  FILLER                          PIC  X(03)  VALUE SPACE. 02160004
021700     05  DL-DAYS-IN-TRBL                 PIC  ZZZ9.9 VALUE ZERO.  02170004
021800     05  FILLER                          PIC  X(03)  VALUE SPACE. 02180004
021900     05  DL-VERIFIED-DATE                PIC  X(08)  VALUE SPACE. 02190004
022000     05  FILLER                          PIC  X(03)  VALUE SPACE. 02200004
022100     05  DL-PRCS-DAYS                    PIC  ZZZ9.9 VALUE ZERO.  02210004
022200                                                                  02220004
022300 01  SLD-SUMMARY-LINE-DESCRIPTION.                                02230004
022400     05  FILLER                          PIC  X(24)  VALUE        02240004
022500         'SUMMARY INFORMATION FOR '.                              02250004
022600     05  SLD-SUMMARY-DESC                PIC  X(30)  VALUE SPACES.02260004
022700                                                                  02270004
022800 01  SL1-SUMMARY-LINE-1.                                          02280004
022900     05  FILLER                          PIC  X(24)  VALUE        02290004
023000         'TOTAL NUMBER OF ORDERS: '.                              02300004
023100     05  SL1-ORDER-CNT                   PIC  ZZZ,ZZ9 VALUE ZERO. 02310004
023200     05  FILLER                          PIC  X(04)  VALUE SPACE. 02320004
023300     05  FILLER                          PIC  X(21)  VALUE        02330004
023400         'AVERAGE UNITS/ORDER: '.                                 02340004
023500     05  SL1-AVG-UNT-PER-ORDER           PIC  ZZZ,ZZ9             02350004
023600                                                     VALUE ZERO.  02360004
023700     05  FILLER                          PIC  X(20)  VALUE SPACE. 02370004
023800     05  FILLER                          PIC  X(25)  VALUE        02380004
023900         'AVERAGE PROCESSING DAYS: '.                             02390004
024000     05  SL1-AVG-PRCS-DAYS               PIC  ZZZ9.9 VALUE ZERO.  02400004
024100                                                                  02410004
024200 01  SL2-SUMMARY-LINE-2.                                          02420004
024300     05  FILLER                          PIC  X(20)  VALUE        02430004
024400         'TOTAL RETAIL VALUE: '.                                  02440004
024500     05  SL2-TOT-RETAIL-VALUE            PIC  ZZZ,ZZZ,ZZ9         02450004
024600                                                     VALUE ZERO.  02460004
024700     05  FILLER                          PIC  X(04)  VALUE SPACE. 02470004
024800     05  FILLER                          PIC  X(21)  VALUE        02480004
024900         'AVERAGE RETAIL/UNIT: '.                                 02490004
025000     05  SL2-AVG-RET-PER-UNIT            PIC  Z,ZZ9.99            02500004
025100                                                     VALUE ZERO.  02510004
025200                                                                  02520004
025300 01  BLANK-LINE.                                                  02530004
025400     05  FILLER                          PIC  X(132) VALUE SPACE. 02540004
025500                                                                  02550004
025600 01  END-OF-REPORT-LINE.                                          02560004
025700     05  FILLER                          PIC  X(88)  VALUE SPACE. 02570004
025800     05  FILLER                          PIC  X(25)  VALUE        02580004
025900         '***** END OF REPORT *****'.                             02590004
026000     05  FILLER                          PIC  X(87)  VALUE SPACE. 02600004
026100                                                                  02610004
026200 01  GT-GRAND-TOTAL-HEADER.                                       02620004
026300     05  FILLER                          PIC  X(54)  VALUE        02630004
026400                                                     ALL '* '.    02640004
026500     05  FILLER                          PIC  X(25)  VALUE        02650004
026600         '  G R A N D   T O T A L  '.                             02660004
026700     05  FILLER                          PIC  X(52)  VALUE        02670004
026800                                                     ALL '* '.    02680004
026900                                                                  02690004
027000 01  GT-GRAND-TOTAL-QTY.                                          02700004
027100     05  FILLER                          PIC  X(10)  VALUE SPACE. 02710004
027200     05  FILLER                          PIC  X(30)  VALUE        02720004
027300         'REPORT TOTAL      (QUANTITY): '.                        02730004
027400     05  FILLER                          PIC  X(06)  VALUE SPACE. 02740004
027500     05  GT-QTY                          PIC  ZZZ,ZZ9.            02750004
027600                                                                  02760004
027700 01  GT-GRAND-TOTAL-COST.                                         02770004
027800     05  FILLER                          PIC  X(10)  VALUE SPACE. 02780004
027900     05  FILLER                          PIC  X(30)  VALUE        02790004
028000         '              (TOTAL RETAIL): '.                        02800004
028100     05  GT-RETAIL-TOTAL                 PIC  $$,$$$,$$9.99.      02810004
028200     05  FILLER                          PIC  X(03)  VALUE SPACE. 02820004
028300                                                                  02830004
028400 01  ER-EMPTY-REPORT-LINE.                                        02840004
028500     05  FILLER                          PIC  X(41)  VALUE SPACE. 02850004
028600     05  FILLER                          PIC  X(51)  VALUE        02860004
028700         '******** E M P T Y   R E P O R T   F I L E ********'.   02870004
028800     05  FILLER                          PIC  X(40)  VALUE SPACE. 02880004
028900                                                                  02890004
029000 01  DK-DB2-KEY-VARAIBLES.                                        02900004
029100     05  DK-OPER-UNT-ID                  PIC S9(04)  COMP.        02910004
029400     05  DK-DC1-NBR                      PIC S9(04) COMP.         02920006
029500     05  DK-FCLTY-ID                     PIC S9(04)  COMP.        02930004
029600     05  DK-PO-NBR                       PIC S9(09)  COMP.        02940004
029700     05  DK-REC-SEQ-NBR                  PIC S9(09)  COMP.        02950004
029800                                                                  02960004
029900 01  PA-PROGRAM-ACCUMULATORS.                                     02970004
030000     05  PA-PRCS-AREA-TOTALS.                                     02980004
030100         10  PA-PRCS-AREA-RETAIL-TOT     PIC S9(09)V99            02990004
030200                                                     VALUE +0     03000004
030300                                                     COMP-3.      03010004
030400         10  PA-PRCS-AREA-UNIT-CNT       PIC S9(08)  VALUE +0     03020004
030500                                                     COMP-3.      03030004
030600         10  PA-PRCS-AREA-ORDER-CNT      PIC S9(08)  VALUE +0     03040004
030700                                                     COMP-3.      03050004
030800         10  PA-PRCS-AREA-PRCS-DAYS      PIC S9(05)V9 VALUE +0    03060004
030900                                                     COMP-3.      03070004
031000     05  PA-FCLTY-TOTALS.                                         03080004
031100         10  PA-FCLTY-RETAIL-TOT         PIC S9(09)V99            03090004
031200                                                     VALUE +0     03100004
031300                                                     COMP-3.      03110004
031400         10  PA-FCLTY-UNIT-CNT           PIC S9(09)  VALUE +0     03120005
031500                                                     COMP-3.      03130004
031600         10  PA-FCLTY-ORDER-CNT          PIC S9(09)  VALUE +0     03140005
031700                                                     COMP-3.      03150004
031800         10  PA-FCLTY-PRCS-DAYS          PIC S9(06)V9 VALUE +0    03160005
031900                                                     COMP-3.      03170004
032000     05  PA-GRAND-TOTALS.                                         03180004
032100         10  PA-GRAND-RETAIL-TOT         PIC S9(09)V99            03190004
032200                                                     VALUE +0     03200004
032300                                                     COMP-3.      03210004
032400         10  PA-GRAND-UNIT-CNT           PIC S9(09)  VALUE +0     03220005
032500                                                     COMP-3.      03230004
032600         10  PA-GRAND-ORDER-CNT          PIC S9(09)  VALUE +0     03240005
032700                                                     COMP-3.      03250004
032800         10  PA-GRAND-PRCS-DAYS          PIC S9(07)V9 VALUE +0    03260005
032900                                                     COMP-3.      03270004
033000                                                                  03280004
033100 01  PC-CONSTANTS.                                                03290004
033200     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    03300004
033300                                                     COMP SYNC.   03310004
033400     05  PC-NINE                         PIC  9(01)  VALUE 9.     03320004
033500     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        03330004
033600         'PCKRP008'.                                              03340004
033700     05  PC-SKU-DESC-NOT-FOUND           PIC  X(15)  VALUE        03350004
033800         'SKU NOT FOUND  '.                                       03360004
033900     05  PC-DPKUT500                     PIC  X(10)  VALUE        03370004
034000         'DPKUT500  '.                                            03380004
034100     05  PC-SYSTEM-CD                    PIC  X(02)  VALUE 'RV'.  03390004
034200     05  PC-OPERATING-COMPANY-CD         PIC  X(02)  VALUE '03'.  03400004
034300     05  PC-HELD-PO                      PIC  X(06)               03410004
034400                                              VALUE '999999'.     03420004
034300     05  PC-FLOWBACK                     PIC  X(06)               03421009
034400                                              VALUE '999998'.     03422009
034500                                                                  03430004
034600 01  PS-PROGRAM-SWITCHES.                                         03440004
034700     05  PS-EOF-EXTRACT-FILE-IND         PIC  X(01)  VALUE 'N'.   03450004
034800         88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   03460004
034900         88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   03470004
035000                                                                  03480004
035100     05  PS-PRCS-AREA-IND                PIC  X(01)  VALUE 'N'.   03490004
035200         88  PS-GET-PRCS-AREA                        VALUE 'Y'.   03500004
035300         88  PS-NO-PRCS-AREA                         VALUE 'N'.   03510004
035400                                                                  03520004
035500     05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   03530004
035600         88  PS-NO-DATA                              VALUE 'Y'.   03540004
035700                                                                  03550004
035800     05  PS-TOTAL-TYPE-IND               PIC  X(01)  VALUE 'N'.   03560004
035900         88  PS-PRCS-AREA-TOTAL                      VALUE '1'.   03570004
036000         88  PS-FCLTY-TOTAL                          VALUE '2'.   03580004
036100         88  PS-GRAND-TOTAL                          VALUE '3'.   03590004
036200                                                                  03600004
036300 01  PV-PROGRAM-VARIABLES.                                        03610004
036400     05  PV-PO-PRCS-DAYS                 PIC S9(05)V9 VALUE +0    03620004
036500                                                     COMP-3.      03630004
036600     05  PV-TROUBLE-CNT                  PIC S9(09)V   COMP.      03640004
036700     05  PV-DAYS-IN-TROUBLE              PIC S9(09)V   COMP.      03650004
036800     05  PV-CURRENT-DATE                 PIC  X(10)  VALUE SPACES.03660004
036900     05  PV-CURR-DATE REDEFINES PV-CURRENT-DATE.                  03670004
037000         10 PV-CURR-CENTURY              PIC  X(02).              03680004
037100         10 PV-CURR-YEAR                 PIC  X(02).              03690004
037200         10 FILLER                       PIC  X(01).              03700004
037300         10 PV-CURR-MONTH                PIC  X(02).              03710004
037400         10 FILLER                       PIC  X(01).              03720004
037500         10 PV-CURR-DAY                  PIC  X(02).              03730004
037600     05  PV-CURRENT-TIME                 PIC  X(08)  VALUE SPACES.03740004
037700     05  PV-CURR-TIME REDEFINES PV-CURRENT-TIME.                  03750004
037800         10 PV-CURR-HOUR                 PIC  X(02).              03760004
037900         10 FILLER                       PIC  X(01).              03770004
038000         10 PV-CURR-MINUTE               PIC  X(02).              03780004
038100         10 FILLER                       PIC  X(01).              03790004
038200         10 PV-CURR-SECOND               PIC  X(02).              03800004
038300     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.03810004
038400*                                                                 03820004
038500*        HOLD VARIABLES                                           03830004
038600     05  PV-HOLD-OPER-UNT-ID             PIC  9(04)  VALUE ZERO.  03840004
038700     05  PV-HOLD-PRCS-AREA               PIC  X(06)  VALUE SPACES.03850004
038800     05  PV-HOLD-REC-SEQ-NBR             PIC  9(09)  VALUE ZERO.  03860004
038900*                                                                 03870004
039000     05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     03880004
039100                                                     COMP SYNC.   03890004
039200     05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     03900004
039300                                                     COMP SYNC.   03910004
039400     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 03920004
039500     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 03930004
039600     05  PV-DB2-OPER-UNT-ID              PIC  X(03).              03940004
039700     05  PV-WORK-DATE.                                            03950004
039800         10  PV-WORK-MONTH               PIC  X(02).              03960004
039900         10  FILLER                      PIC  X(01) VALUE '/'.    03970004
040000         10  PV-WORK-DAY                 PIC  X(02).              03980004
040100         10  FILLER                      PIC  X(01) VALUE '/'.    03990004
040200         10  PV-WORK-YEAR                PIC  X(02).              04000004
040300                                                                  04010004
040400 01  SD-SYSTEM-DATE.                                              04020004
040500     05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. 04030004
040600     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 04040004
040700     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 04050004
040800                                                                  04060004
040900 01  ST-SYSTEM-TIME.                                              04070004
041000     05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. 04080004
041100     05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. 04090004
041200                                                                  04100004
041300*                                                                 04110004
041400******************************************************************04120004
041500*  WORK FIELDS FOR THE MBS SUBROUTINE                             04130004
041600******************************************************************04140004
041700     COPY DPWS003.                                                04150004
041800*                                                                 04160004
041900******************************************************************04170004
042000*  DB2 COMMUNICATION AREA.                                        04180004
042100******************************************************************04190004
042200     EXEC SQL                                                     04200004
042300          INCLUDE SQLCA                                           04210004
042400     END-EXEC.                                                    04220004
042500*                                                                 04230004
042600*                                                                 04240004
042700******************************************************************04250004
042800*  LOCATION MASTER                                                04260006
042900******************************************************************04270004
043000     EXEC SQL                                                     04280004
043100          INCLUDE XLT00010                                        04290006
043200     END-EXEC.                                                    04300004
043300*                                                                 04310004
043400*                                                                 04320004
043500******************************************************************04330004
043600*  DB2 TABLE DB2PDBA.TTRBNTF                                      04340004
043700******************************************************************04350004
043800     EXEC SQL                                                     04360004
043900          INCLUDE TTRBNTF                                         04370004
044000     END-EXEC.                                                    04380004
044100*                                                                 04390004
044200*                                                                 04400004
044300******************************************************************04410004
044400*  DB2 TABLE DB2PDBA.TTRBRSN                                      04420004
044500******************************************************************04430004
044600     EXEC SQL                                                     04440004
044700          INCLUDE TTRBRSN                                         04450004
044800     END-EXEC.                                                    04460004
044900*                                                                 04470004
045000*                                                                 04480004
045100******************************************************************04490004
045200*  DB2 TABLE DB2PDBA.TRECEIV                                      04500004
045300******************************************************************04510004
045400     EXEC SQL                                                     04520004
045500          INCLUDE TRECEIV                                         04530004
045600     END-EXEC.                                                    04540004
045700*                                                                 04550004
045800*                                                                 04560004
045900******************************************************************04570004
046000*  DB2 TABLE DB2PDBA.TCKRSTCN                                     04580004
046100******************************************************************04590004
046200     EXEC SQL                                                     04600004
046300          INCLUDE TCKRSTCN                                        04610004
046400     END-EXEC.                                                    04620004
046500*                                                                 04630004
046600*                                                                 04640004
046700******************************************************************04650004
046800*  DB2 TABLE DB2PDBA.TDFCTOR                                      04660004
046900******************************************************************04670004
047000     EXEC SQL                                                     04680004
047100          INCLUDE TDFCTOR                                         04690004
047200     END-EXEC.                                                    04700004
047300*                                                                 04710004
047400*                                                                 04720004
047500******************************************************************04730004
047600*  DB2 TABLE DB2PDBA.TVNDDPT                                      04740004
047700******************************************************************04750004
047800     EXEC SQL                                                     04760004
047900          INCLUDE TVNDDPT                                         04770004
048000     END-EXEC.                                                    04780004
048100*                                                                 04790004
048200*                                                                 04800004
048300******************************************************************04810004
048400*  DB2 TABLE DB2PDBA.TENTNME                                      04820004
048500******************************************************************04830004
048600     EXEC SQL                                                     04840004
048700          INCLUDE TENTNME                                         04850004
048800     END-EXEC.                                                    04860004
048900*                                                                 04870004
049000*                                                                 04880004
049100******************************************************************04890004
049200*  DB2 TABLE DB2PDBA.TEXTENT                                      04900004
049300******************************************************************04910004
049400     EXEC SQL                                                     04920004
049500          INCLUDE TEXTENT                                         04930004
049600     END-EXEC.                                                    04940004
049700*                                                                 04950004
049800*                                                                 04960004
049900******************************************************************04970004
050000*  DB2 TABLE DB2PDBA.TDFMEIT                                      04980004
050100******************************************************************04990004
050200     EXEC SQL                                                     05000004
050300          INCLUDE TDFMEIT                                         05010004
050400     END-EXEC.                                                    05020004
050500*                                                                 05030004
050600******************************************************************05040004
050700*  DB2 TABLE DB2PDBA.TSK                                          05050004
050800******************************************************************05060004
050900     EXEC SQL                                                     05070004
051000          INCLUDE TSK                                             05080004
051100     END-EXEC.                                                    05090004
051200*                                                                 05100004
051300******************************************************************05110004
051400*  DB2 TABLE DB2PDBA.TFLAREA - FACILITY AREA TABLE                05120004
051500******************************************************************05130004
051600     EXEC SQL                                                     05140004
051700          INCLUDE TFLAREA                                         05150004
051800     END-EXEC.                                                    05160004
051900*                                                                 05170004
052000*   DB2 COMMUNICATIONS AREA2                                      05180004
052100*                                                                 05190004
052200     COPY SQLCA2.                                                 05200004
052300 EJECT                                                            05210004
052400                                                                  05220004
052500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05230004
052600 PROCEDURE DIVISION.                                              05240004
052700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05250004
052800                                                                  05260004
052900******************************************************************05270004
053000*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    05280004
053100******************************************************************05290004
053200 0000-PROGRAM-MAINLINE.                                           05300004
053300                                                                  05310004
053400     PERFORM 1000-INITIALIZE.                                     05320004
053500                                                                  05330004
053600     PERFORM 2000-CREATE-REPORT.                                  05340004
053700                                                                  05350004
053800     PERFORM 9000-EOJ-ROUTINE.                                    05360004
053900     STOP RUN.                                                    05370004
054000*0000-EXIT.                                                       05380004
054100                                                                  05390004
054200******************************************************************05400004
054300*  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  05410004
054400*  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST 05420004
054500*  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT 05430004
054600*  FILE.                                                          05440004
054700******************************************************************05450004
054800 1000-INITIALIZE.                                                 05460004
054900                                                                  05470004
055000     PERFORM 1050-GET-DATE-TIME.                                  05480004
055100                                                                  05490004
055200     OPEN OUTPUT RT-RECEIPT-TURN-REPORT                           05500004
055300          INPUT  RE-RECEIPT-EXTRACT.                              05510004
055400                                                                  05520004
055500     SET PS-NOT-END-OF-EXTRACT-FILE   TO TRUE.                    05530004
055600                                                                  05540004
055700     PERFORM 6000-READ-EXTRACT-FILE.                              05550004
055800                                                                  05560004
055900     MOVE SD-SYSTEM-YEAR              TO DP132O-RUN-YEAR.         05570004
056000     MOVE SD-SYSTEM-MONTH             TO DP132O-RUN-MONTH.        05580004
056100     MOVE SD-SYSTEM-DAY               TO DP132O-RUN-DAY.          05590004
056200                                                                  05600004
056300     MOVE ST-SYSTEM-HOUR              TO DP132O-RUN-HOUR.         05610004
056400     MOVE ST-SYSTEM-MINUTE            TO DP132O-RUN-MINUTE.       05620004
056500                                                                  05630004
056600     MOVE  PC-CURRENT-PROGRAM-NAME    TO DP132O-PROGRAM-NAME.     05640004
056700     MOVE 1                           TO DP132O-REPORT-NUMBER.    05650004
056800                                                                  05660004
056900     MOVE PC-MAX-REPORT-LINES         TO PV-LINE-COUNT.           05670004
057000     MOVE +0                          TO PV-PAGE-COUNT.           05680004
057100                                                                  05690004
057200     INITIALIZE DL-DETAIL-LINE                                    05700004
057300                PA-PROGRAM-ACCUMULATORS.                          05710004
057400                                                                  05720004
057500     PERFORM 1100-GET-WEEK-END-DATE.                              05730004
057600                                                                  05740004
057700                                                                  05750004
057800*1000-EXIT.                                                       05760004
057900                                                                  05770004
058000******************************************************************05780004
058100*  1050-GET-DATE-TIME - GET THE CURRENT DATE AND TIME FROM DB2    05790004
058200******************************************************************05800004
058300 1050-GET-DATE-TIME.                                              05810004
058400                                                                  05820004
058500     EXEC SQL                                                     05830004
058600         SET :PV-CURRENT-DATE = CURRENT DATE                      05840004
058700     END-EXEC.                                                    05850004
058800                                                                  05860004
058900     EXEC SQL                                                     05870004
059000         SET :PV-CURRENT-TIME = CURRENT TIME                      05880004
059100     END-EXEC.                                                    05890004
059200                                                                  05900004
059300     EVALUATE TRUE                                                05910004
059400         WHEN SQLCODE = ZERO                                      05920004
059500             MOVE PV-CURR-YEAR       TO SD-SYSTEM-YEAR            05930004
059600             MOVE PV-CURR-MONTH      TO SD-SYSTEM-MONTH           05940004
059700             MOVE PV-CURR-DAY        TO SD-SYSTEM-DAY             05950004
059800             MOVE PV-CURR-HOUR       TO ST-SYSTEM-HOUR            05960004
059900             MOVE PV-CURR-MINUTE     TO ST-SYSTEM-MINUTE          05970004
060000         WHEN OTHER                                               05980004
060100              MOVE '1050-GET-DATE-TIME'                           05990004
060200                               TO  PV-PARAGRAPH-NAME              06000004
060300              MOVE 'SET CURRENT DATE/TIME FROM DB2'               06010004
060400                               TO  PV-DB2-OPERATION-ATTEMPTED     06020004
060500              PERFORM 9100-SQL-ABEND                              06030004
060600     END-EVALUATE.                                                06040004
060700                                                                  06050004
060800*1050-EXIT.                                                       06060004
060900*                                                                 06070004
061000******************************************************************06080004
061100* 1100-GET-WEEK-END-DATE  USES DPKUT500 TO DETERMIN THE WEEK END  06090004
061200*      DATE.                                                      06100004
061300******************************************************************06110004
061400 1100-GET-WEEK-END-DATE.                                          06120004
061500                                                                  06130004
061600     MOVE SD-SYSTEM-DATE            TO DPG51-SYSTEM-DATE.         06140004
061700     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      06150004
061800     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     06160004
061900                                                                  06170004
062000     MOVE PC032-DATE-VERIFIED       TO DPG52-LK-DATE-INPUT.       06180004
062100     SET DPG52-LK-DTE-GREG          TO TRUE.                      06190004
062200                                                                  06200004
062300     MOVE PC032-DATE-RECEIVED       TO DPG53-LK-CMPR-DATE-INPUT.  06210004
062400     SET DPG53-LK-CMPR-DTE-GREG     TO TRUE.                      06220004
062500                                                                  06230004
062600     CALL PC-DPKUT500 USING DPG51 DPG52 DPG53                     06240004
062700                            DPG54 DPG55 DPG56.                    06250004
062800                                                                  06260004
062900     EVALUATE TRUE                                                06270004
063000         WHEN DPG54-NO-ERROR                                      06280004
063100             MOVE  DPG55-LAST-WKDY-GREG-FMT                       06290004
063200                                    TO PH4-WEEK-END-DATE          06300004
063300                                                                  06310004
063400         WHEN DPG54-DATE-INVALID                                  06320004
063500             DISPLAY '** ABEND **'                                06330004
063600             DISPLAY '** PROGRAM = PCKRP008 -- CALLED MODULE '    06340004
063700                     'DPKUT500 **'                                06350004
063800             DISPLAY '** PARAGRAPH = 1100-GET-PROCESS-DATE **'    06360004
063900             DISPLAY '** INVALID ARRIVAL DATE: '                  06370004
064000                     PC032-DATE-RECEIVED                          06380004
064100             DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '    06390004
064200             DISPLAY DPG54-ERROR-MESSAGE                          06400004
064300             MOVE +4003 TO ABEND-CODE                             06410004
064400             CALL 'ILBOABN0' USING ABEND-CODE                     06420004
064500                                                                  06430004
064600         WHEN DPG54-CMPR-DATE-INVALID                             06440004
064700             DISPLAY '** ABEND **'                                06450004
064800             DISPLAY '** PROGRAM = PCKRP008 -- CALLED MODULE '    06460004
064900                     'DPKUT500 **'                                06470004
065000             DISPLAY '** PARAGRAPH = 1100-GET-PROCESS-DATE **'    06480004
065100             DISPLAY '** INVALID VERIFY DATE: '                   06490004
065200                     PC032-DATE-VERIFIED                          06500004
065300             DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '    06510004
065400             DISPLAY DPG54-ERROR-MESSAGE                          06520004
065500             MOVE +4003 TO ABEND-CODE                             06530004
065600             CALL 'ILBOABN0' USING ABEND-CODE                     06540004
065700                                                                  06550004
065800         WHEN OTHER                                               06560004
065900             DISPLAY DPG54-ERROR-MESSAGE                          06570004
066000                                                                  06580004
066100     END-EVALUATE.                                                06590004
066200                                                                  06600004
066300*                                                                 06610004
066400******************************************************************06620004
066500* 2000-CREATE-REPORT                                              06630004
066600* PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNA06640004
066700* SORT FILE.                                                      06650004
066800******************************************************************06660004
066900 2000-CREATE-REPORT.                                              06670004
067000                                                                  06680004
067100     IF PS-END-OF-EXTRACT-FILE                                    06690004
067200         SET PS-NO-DATA             TO TRUE                       06700004
067300         WRITE RT-RECEIPT-TURN-LINE                               06710004
067400             FROM ER-EMPTY-REPORT-LINE                            06720004
067500             AFTER ADVANCING 1 LINES                              06730004
067600     ELSE                                                         06740004
067700         MOVE PC032-OPER-UNT-ID     TO DK-OPER-UNT-ID             06750004
067800                                       DK-DC1-NBR                 06760006
067900                                       PV-HOLD-OPER-UNT-ID        06770004
068000         MOVE PC032-FCLTY-ID        TO DK-FCLTY-ID                06780004
068100         PERFORM 8300-GET-DC-NAME                                 06790004
068200                                                                  06800004
068300         MOVE PC032-PRCS-AREA       TO PV-HOLD-PRCS-AREA          06810004
068400                                       PH5-PRCS-AREA-CD           06820004
068500         PERFORM 8200-GET-PRCS-AREA-DESC                          06830004
068600                                                                  06840004
068700         PERFORM UNTIL PS-END-OF-EXTRACT-FILE                     06850004
068800             IF PC032-OPER-UNT-ID    = PV-HOLD-OPER-UNT-ID        06860004
068900                 IF PC032-PRCS-AREA  = PV-HOLD-PRCS-AREA          06870004
069000                     PERFORM 2100-ACCUMULATE-TOTALS               06880004
069100                 ELSE                                             06890004
069200                     PERFORM 2200-PRCS-AREA-BREAK                 06900004
069300                     PERFORM 2100-ACCUMULATE-TOTALS               06910004
069400                 END-IF                                           06920004
069500             ELSE                                                 06930004
069600                 PERFORM 2300-FCLTY-BREAK                         06940004
069700                 PERFORM 2100-ACCUMULATE-TOTALS                   06950004
069800             END-IF                                               06960004
069900                                                                  06970004
070000             PERFORM 6000-READ-EXTRACT-FILE                       06980004
070100                                                                  06990004
070200         END-PERFORM                                              07000004
070300     END-IF.                                                      07010004
070400                                                                  07020004
070500******************************************************************07030004
070600* 2100-ACCUMULATE-TOTALS                                          07040004
070700* PROCESS:  THIS PARAGRAPH WILL ACCUMULATE TOTALS AT THE          07050004
070800*   PROCESS AREA LEVEL                                            07060004
070900******************************************************************07070004
071000 2100-ACCUMULATE-TOTALS.                                          07080004
071100                                                                  07090004
071200     PERFORM 3000-SET-UP-PO-INFO.                                 07100004
071300                                                                  07110004
071400     PERFORM 7000-PRINT-REPORT-LINE.                              07120004
071500                                                                  07130004
071600     ADD +1                   TO PA-PRCS-AREA-ORDER-CNT.          07140004
071700     ADD PC032-RETAIL-EXTENSION                                   07150004
071800                              TO PA-PRCS-AREA-RETAIL-TOT.         07160004
071900     ADD PC032-UNITS-RECVD    TO PA-PRCS-AREA-UNIT-CNT.           07170004
072000     ADD PC032-PRCS-DAYS      TO PA-PRCS-AREA-PRCS-DAYS.          07180004
072100                                                                  07190004
072200******************************************************************07200004
072300* 2200-PRCS-AREA-BREAK                                            07210004
072400* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN 07220004
072500*  THE PROCESS AREA                                               07230004
072600*     1) PRINT THE PROCESS AREA TOTAL LINE                        07240004
072700*     2) ADD THE "OLD" PROCESS AREA TOTALS TO THE FACILITY TOTALS 07250004
072800*        (ONLY IF THE OLD PROCESS AREA WAS NOT '9999' OR '9998')  07260009
072900*     3) INITIALIZE PROCESS AREA TOTALS FOR NEW PROCESS AREA      07270004
073000*     4) RESET THE "HOLD" PROCESS AREA VALUE                      07280004
073100******************************************************************07290004
073200 2200-PRCS-AREA-BREAK.                                            07300004
073300                                                                  07310004
073400     SET PS-PRCS-AREA-TOTAL   TO TRUE.                            07320004
073500     PERFORM 7100-PRINT-SUMMARY-LINE.                             07330004
073600                                                                  07340004
073700     EVALUATE TRUE                                                07350009
073700         WHEN PV-HOLD-PRCS-AREA = PC-HELD-PO                      07351009
073700         WHEN PV-HOLD-PRCS-AREA = PC-FLOWBACK                     07352009
073800             CONTINUE                                             07360009
073900         WHEN OTHER                                               07370009
074000             ADD PA-PRCS-AREA-ORDER-CNT  TO PA-FCLTY-ORDER-CNT    07380009
074200             ADD PA-PRCS-AREA-RETAIL-TOT TO PA-FCLTY-RETAIL-TOT   07400009
074400             ADD PA-PRCS-AREA-UNIT-CNT   TO PA-FCLTY-UNIT-CNT     07420009
074600             ADD PA-PRCS-AREA-PRCS-DAYS  TO PA-FCLTY-PRCS-DAYS    07440009
074800     END-EVALUATE.                                                07460010
074900                                                                  07470004
075000     INITIALIZE PA-PRCS-AREA-TOTALS.                              07480004
075100     MOVE PC032-PRCS-AREA     TO PV-HOLD-PRCS-AREA                07490004
075200                                 PH5-PRCS-AREA-CD.                07500004
075300                                                                  07510004
075400*  A MOVE OF THESE FIELDS IS NEEDED HERE TO GET THE CORRECT       07520004
075500* PROCESS AREA EVEN IF THE OPER-UNT-ID BREAK LOGIC HAS NOT        07530004
075600* EXECUTED YET.  IF THE 'NEW' PROCESS AREA IS 9999 MOVE CONSTANT  07540004
075700* TO THE PROCESS AREA DESCRIPTION FIELD.   A "NEW" PROCESS AREA   07550009
075600* WAS ADDED 1/2005. IF PROCESS AREA IS 9998 - MOVE NEW CONSTANT   07551009
075700* TO THE PROCESS AREA DESCRIPTION FIELD.                          07552009
075800                                                                  07560004
075900     MOVE PC032-OPER-UNT-ID   TO DK-OPER-UNT-ID                   07570004
076000     MOVE PC032-FCLTY-ID      TO DK-FCLTY-ID                      07580004
076100     IF PV-HOLD-PRCS-AREA = PC-HELD-PO                            07590004
076200         MOVE 'ORDERS HELD IN TRBL'   TO  PH5-PRCS-AREA-DESC      07600009
076400     ELSE                                                         07620004
076100         IF PV-HOLD-PRCS-AREA = PC-FLOWBACK                       07621009
076200             MOVE 'FLOWBACK ORDERS  '   TO  PH5-PRCS-AREA-DESC    07622009
076400         ELSE                                                     07624009
076500             PERFORM 8200-GET-PRCS-AREA-DESC                      07630009
076600         END-IF                                                   07640009
076600     END-IF.                                                      07641009
076700                                                                  07650004
076800*                                                                 07660004
076900******************************************************************07670004
077000* 2300-FCLTY-BREAK                                                07680004
077100* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN 07690004
077200*  THE FACILITY (OPERATING UNIT ID)                               07700004
077300*     1) PERFORM PROCESS AREA BREAK LOGIC                         07710004
077400*     2) PRINT FACILITY TOTAL LINE (SET COUNT FOR A PAGE BREAK)   07720004
077500*     3) RESET THE "HOLD" FACILITY ID                             07730004
077600*     4) ADD "OLD" FACIITY TOTALS TO THE GRAND TOTALS             07740004
077700*     5) INITIALIZE FACILITY TOTALS FOR NEW FACILITY              07750004
077800******************************************************************07760004
077900 2300-FCLTY-BREAK.                                                07770004
078000                                                                  07780004
078100     PERFORM 2200-PRCS-AREA-BREAK.                                07790004
078200                                                                  07800004
078300     SET PS-FCLTY-TOTAL       TO TRUE.                            07810004
078400     PERFORM 7100-PRINT-SUMMARY-LINE.                             07820004
078500                                                                  07830004
078600     MOVE PC032-OPER-UNT-ID        TO DK-OPER-UNT-ID              07840004
078700                                      PV-HOLD-OPER-UNT-ID         07850004
078800                                      DK-DC1-NBR                  07860006
078900     MOVE PC032-FCLTY-ID           TO DK-FCLTY-ID.                07870004
079000     PERFORM 8300-GET-DC-NAME.                                    07880004
079100                                                                  07890004
079200     ADD PA-FCLTY-ORDER-CNT        TO PA-GRAND-ORDER-CNT.         07900004
079300     ADD PA-FCLTY-RETAIL-TOT       TO PA-GRAND-RETAIL-TOT.        07910004
079400     ADD PA-FCLTY-UNIT-CNT         TO PA-GRAND-UNIT-CNT.          07920004
079500     ADD PA-FCLTY-PRCS-DAYS        TO PA-GRAND-PRCS-DAYS.         07930004
079600                                                                  07940004
079700     INITIALIZE PA-FCLTY-TOTALS.                                  07950004
079800*                                                                 07960004
079900*                                                                 07970004
080000******************************************************************07980004
080100* 2400-GRAND-TOTAL                                                07990004
080200* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR THE GRAND   08000004
080300*  TOTAL:                                                         08010004
080400*     1) PRINT THE GRAND TOTAL FIRST (NOT TO INCLUDE THOSE ORDERS 08020004
080500*        WITH PROCESS AREA '9999' OR '9998')                      08030009
080600*     2) PERFORM FACILITY BREAK TO PRINT THE                      08040009
080700*     4) ADD "OLD" FACIITY TOTALS TO THE GRAND TOTALS             08050004
080800*     5) INITIALIZE FACILITY TOTALS FOR NEW FACILITY              08060004
080900******************************************************************08070004
081000 2400-GRAND-TOTAL.                                                08080004
081100                                                                  08090004
081200     PERFORM 2300-FCLTY-BREAK.                                    08100004
081300                                                                  08110004
081400     SET PS-GRAND-TOTAL       TO TRUE.                            08120004
081500     PERFORM 7100-PRINT-SUMMARY-LINE.                             08130004
081600*                                                                 08140004
081700******************************************************************08150004
081800* 3000-SET-UP-PO-INFO                                             08160004
081900* PROCESS:  THIS PARAGRAPH MOVE ALL THE CURRENT PO INFORMATION TO 08170004
082000*  THE PRINT LINE.                                                08180004
082100******************************************************************08190004
082200 3000-SET-UP-PO-INFO.                                             08200004
082300     MOVE PC032-PO-NBR              TO DL-PO-NBR                  08210004
082400                                       DK-PO-NBR.                 08220004
082500     MOVE PC032-REC-SEQ-NBR         TO PV-HOLD-REC-SEQ-NBR        08230004
082600                                       DL-REC-SEQ-NBR             08240004
082700                                       DK-REC-SEQ-NBR.            08250004
082800     MOVE PC032-DR-MM               TO PV-WORK-MONTH.             08260004
082900     MOVE PC032-DR-DD               TO PV-WORK-DAY.               08270004
083000     MOVE PC032-DR-YY               TO PV-WORK-YEAR.              08280004
083100     MOVE PV-WORK-DATE              TO DL-ARRIVAL-DATE.           08290004
083200     MOVE PC032-DV-MM               TO PV-WORK-MONTH.             08300004
083300     MOVE PC032-DV-DD               TO PV-WORK-DAY.               08310004
083400     MOVE PC032-DV-YY               TO PV-WORK-YEAR.              08320004
083500     MOVE PV-WORK-DATE              TO DL-VERIFIED-DATE.          08330004
083600     MOVE PC032-VND-NAME            TO DL-VEND-NAME.              08340004
083700     MOVE PC032-DPT-NBR             TO DL-DPT-NBR.                08350004
083800                                                                  08360004
083900     MOVE PC032-TROUBLE-CNT         TO DL-TRBL-CNT.               08370004
084000     IF PC032-NO-UNRSLVD-TRBL                                     08380004
084100         MOVE ' '                   TO DL-TRBL-IND                08390004
084200     ELSE                                                         08400004
084300         MOVE '*'                   TO DL-TRBL-IND                08410004
084400     END-IF.                                                      08420004
084500     MOVE PC032-DAYS-IN-TRBL        TO DL-DAYS-IN-TRBL.           08430004
084600     MOVE PC032-PRCS-DAYS           TO DL-PRCS-DAYS.              08440004
084700                                                                  08450004
084800     MOVE PC032-CARTON-CNT          TO DL-CART-CNT.               08460004
084900                                                                  08470004
085000*                                                                 08480004
085100******************************************************************08490004
085200* 6000-READ-EXTRACT-FILE.                                        *08500004
085300*  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *08510004
085400*  FLAT FILE.                                                    *08520004
085500******************************************************************08530004
085600 6000-READ-EXTRACT-FILE.                                          08540004
085700*                                                                 08550004
085800     READ RE-RECEIPT-EXTRACT                                      08560004
085900         INTO PC032-TURN-RPT-EXTRACT-RECORD                       08570004
086000         AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               08580004
086100                                                                  08590004
086200******************************************************************08600004
086300* 7000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   08610004
086400* CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNT08620004
086500* INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  08630004
086600******************************************************************08640004
086700 7000-PRINT-REPORT-LINE.                                          08650004
086800                                                                  08660004
086900     ADD +1 TO PV-LINE-COUNT.                                     08670004
087000                                                                  08680004
087100     IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      08690004
087200         PERFORM 7300-WRITE-PAGE-HEADING                          08700004
087300         PERFORM 7400-WRITE-COLUMN-HEADING                        08710004
087400     END-IF.                                                      08720004
087500                                                                  08730004
087600     MOVE PC032-UNITS-RECVD        TO DL-UNIT-CNT.                08740004
087700     MOVE PC032-TROUBLE-CNT        TO DL-TRBL-CNT.                08750004
087800                                                                  08760004
087900     WRITE RT-RECEIPT-TURN-LINE                                   08770004
088000         FROM DL-DETAIL-LINE                                      08780004
088100         AFTER ADVANCING 1 LINES.                                 08790004
088200                                                                  08800004
088300*7000-EXIT.                                                       08810004
088400                                                                  08820004
088500******************************************************************08830004
088600* 7100-PRINT-SUMMARY-LINE - WRITE THE CONTROL BREAK SUMMARY LINES 08840004
088700******************************************************************08850004
088800 7100-PRINT-SUMMARY-LINE.                                         08860004
088900                                                                  08870004
089000                                                                  08880004
089100     EVALUATE TRUE                                                08890004
089200         WHEN PS-PRCS-AREA-TOTAL                                  08900004
089300                                                                  08910004
089400             MOVE PH5-PRCS-AREA-DESC   TO SLD-SUMMARY-DESC        08920004
089500                                                                  08930004
089600             MOVE PA-PRCS-AREA-ORDER-CNT TO SL1-ORDER-CNT         08940004
089700             MOVE PA-PRCS-AREA-RETAIL-TOT                         08950004
089800                                         TO SL2-TOT-RETAIL-VALUE  08960004
089900             IF PA-PRCS-AREA-ORDER-CNT > 0                        08970004
090000                 COMPUTE SL1-AVG-UNT-PER-ORDER =                  08980004
090100                     PA-PRCS-AREA-UNIT-CNT /                      08990004
090200                     PA-PRCS-AREA-ORDER-CNT                       09000004
090300             ELSE                                                 09010004
090400                 MOVE +0 TO SL1-AVG-UNT-PER-ORDER                 09020004
090500             END-IF                                               09030004
090600                                                                  09040004
090700             IF PA-PRCS-AREA-UNIT-CNT > 0                         09050004
090800                 COMPUTE SL2-AVG-RET-PER-UNIT =                   09060004
090900                     PA-PRCS-AREA-RETAIL-TOT /                    09070004
091000                     PA-PRCS-AREA-UNIT-CNT                        09080004
091100             ELSE                                                 09090004
091200                 MOVE +0 TO SL2-AVG-RET-PER-UNIT                  09100004
091300             END-IF                                               09110004
091400                                                                  09120004
091500             IF PA-PRCS-AREA-ORDER-CNT > 0                        09130004
091600                 COMPUTE SL1-AVG-PRCS-DAYS =                      09140004
091700                     PA-PRCS-AREA-PRCS-DAYS /                     09150004
091800                     PA-PRCS-AREA-ORDER-CNT                       09160004
091900             ELSE                                                 09170004
092000                 MOVE +0 TO SL1-AVG-PRCS-DAYS                     09180004
092100             END-IF                                               09190004
092200                                                                  09200004
092300         WHEN PS-FCLTY-TOTAL                                      09210004
092400             MOVE PH3-DC-NAME          TO SLD-SUMMARY-DESC        09220004
092500                                                                  09230004
092600             MOVE PA-FCLTY-ORDER-CNT   TO SL1-ORDER-CNT           09240004
092700             MOVE PA-FCLTY-RETAIL-TOT  TO SL2-TOT-RETAIL-VALUE    09250004
092800             IF PA-FCLTY-ORDER-CNT > 0                            09260004
092900                 COMPUTE SL1-AVG-UNT-PER-ORDER =                  09270004
093000                     PA-FCLTY-UNIT-CNT / PA-FCLTY-ORDER-CNT       09280004
093100                 COMPUTE SL1-AVG-PRCS-DAYS =                      09290004
093200                     PA-FCLTY-PRCS-DAYS / PA-FCLTY-ORDER-CNT      09300004
093300             ELSE                                                 09310004
093400                 MOVE +0               TO SL1-AVG-UNT-PER-ORDER   09320004
093500                                          SL1-AVG-PRCS-DAYS       09330004
093600             END-IF                                               09340004
093700                                                                  09350004
093800             IF PA-FCLTY-UNIT-CNT > 0                             09360004
093900                 COMPUTE SL2-AVG-RET-PER-UNIT =                   09370004
094000                     PA-FCLTY-RETAIL-TOT / PA-FCLTY-UNIT-CNT      09380004
094100             ELSE                                                 09390004
094200                 MOVE +0               TO SL2-AVG-RET-PER-UNIT    09400004
094300             END-IF                                               09410004
094400                                                                  09420004
094500         WHEN PS-GRAND-TOTAL                                      09430004
094600             MOVE 'RPT TOTAL' TO SLD-SUMMARY-DESC                 09440004
094700                                                                  09450004
094800             MOVE PA-GRAND-ORDER-CNT   TO SL1-ORDER-CNT           09460004
094900             MOVE PA-GRAND-RETAIL-TOT  TO SL2-TOT-RETAIL-VALUE    09470004
095000             IF PA-GRAND-ORDER-CNT > 0                            09480004
095100                 COMPUTE SL1-AVG-UNT-PER-ORDER =                  09490004
095200                     PA-GRAND-UNIT-CNT / PA-GRAND-ORDER-CNT       09500004
095300                 COMPUTE SL1-AVG-PRCS-DAYS =                      09510004
095400                     PA-GRAND-PRCS-DAYS / PA-GRAND-ORDER-CNT      09520004
095500             ELSE                                                 09530004
095600                 MOVE +0               TO SL1-AVG-UNT-PER-ORDER   09540004
095700                                          SL1-AVG-PRCS-DAYS       09550004
095800             END-IF                                               09560004
095900                                                                  09570004
096000             IF PA-GRAND-UNIT-CNT > 0                             09580004
096100                 COMPUTE SL2-AVG-RET-PER-UNIT =                   09590004
096200                     PA-GRAND-RETAIL-TOT / PA-GRAND-UNIT-CNT      09600004
096300             ELSE                                                 09610004
096400                 MOVE +0 TO SL2-AVG-RET-PER-UNIT                  09620004
096500             END-IF                                               09630004
096600                                                                  09640004
096700     END-EVALUATE.                                                09650004
096800                                                                  09660004
096900     WRITE RT-RECEIPT-TURN-LINE                                   09670004
097000         FROM SLD-SUMMARY-LINE-DESCRIPTION                        09680004
097100         AFTER ADVANCING 2 LINES                                  09690004
097200                                                                  09700004
097300     WRITE RT-RECEIPT-TURN-LINE                                   09710004
097400         FROM SL1-SUMMARY-LINE-1                                  09720004
097500         AFTER ADVANCING 2 LINES.                                 09730004
097600                                                                  09740004
097700     WRITE RT-RECEIPT-TURN-LINE                                   09750004
097800         FROM SL2-SUMMARY-LINE-2                                  09760004
097900         AFTER ADVANCING 1 LINES.                                 09770004
098000                                                                  09780004
098100     MOVE PC-MAX-REPORT-LINES TO PV-LINE-COUNT.                   09790004
098200                                                                  09800004
098300                                                                  09810004
098400*7100-EXIT.                                                       09820004
098500                                                                  09830004
098600******************************************************************09840004
098700* 7200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      09850004
098800******************************************************************09860004
098900 7200-WRITE-BLANK-LINE.                                           09870004
099000                                                                  09880004
099100     WRITE RT-RECEIPT-TURN-LINE                                   09890004
099200         FROM BLANK-LINE                                          09900004
099300         AFTER ADVANCING 1 LINES.                                 09910004
099400                                                                  09920004
099500     ADD +1                        TO PV-LINE-COUNT.              09930004
099600                                                                  09940004
099700                                                                  09950004
099800*7100-EXIT.                                                       09960004
099900******************************************************************09970004
100000* 7300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FOR09980004
100100* THE DEFECTIVE ITEM REPORT.                                      09990004
100200******************************************************************10000004
100300 7300-WRITE-PAGE-HEADING.                                         10010004
100400                                                                  10020004
100500     ADD 1 TO PV-PAGE-COUNT.                                      10030004
100600     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    10040004
100700                                                                  10050004
100800     WRITE RT-RECEIPT-TURN-LINE                                   10060004
100900         FROM DP132O-STANDRD-HEADER-132-COLS                      10070004
101000         AFTER ADVANCING PAGE.                                    10080004
101100                                                                  10090004
101200     WRITE RT-RECEIPT-TURN-LINE                                   10100004
101300         FROM PH2-PAGE-HEADING-2                                  10110004
101400         AFTER ADVANCING 1 LINES.                                 10120004
101500                                                                  10130004
101600     WRITE RT-RECEIPT-TURN-LINE                                   10140004
101700         FROM PH3-PAGE-HEADING-3                                  10150004
101800         AFTER ADVANCING 1 LINES.                                 10160004
101900                                                                  10170004
102000     WRITE RT-RECEIPT-TURN-LINE                                   10180004
102100         FROM PH4-PAGE-HEADING-4                                  10190004
102200         AFTER ADVANCING 1 LINES.                                 10200004
102300                                                                  10210004
102400     WRITE RT-RECEIPT-TURN-LINE                                   10220004
102500         FROM PH5-PAGE-HEADING-5                                  10230004
102600         AFTER ADVANCING 1 LINES.                                 10240004
102700*7300-EXIT.                                                       10250004
102800                                                                  10260004
102900******************************************************************10270004
103000* 7400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       10280004
103100* THE DEFECTIVE ITEM REPORT.                                      10290004
103200******************************************************************10300004
103300 7400-WRITE-COLUMN-HEADING.                                       10310004
103400                                                                  10320004
103500     WRITE RT-RECEIPT-TURN-LINE                                   10330004
103600         FROM DH1-DETAIL-HEADING-1                                10340004
103700         AFTER ADVANCING 2 LINES.                                 10350004
103800                                                                  10360004
103900     WRITE RT-RECEIPT-TURN-LINE                                   10370004
104000         FROM DH2-DETAIL-HEADING-2                                10380004
104100         AFTER ADVANCING 1 LINES.                                 10390004
104200                                                                  10400004
104300     WRITE RT-RECEIPT-TURN-LINE                                   10410004
104400         FROM DH3-DETAIL-HEADING-3                                10420004
104500         AFTER ADVANCING 0 LINES.                                 10430004
104600                                                                  10440004
104700     MOVE PC-NINE TO PV-LINE-COUNT.                               10450004
104800*7400-EXIT.                                                       10460004
104900                                                                  10470004
105000*                                                                 10480004
105100******************************************************************10490004
105200* 8000-CHECK-TROUBLE.                                            *10500004
105300*                                                                *10510004
105400* 12/17/97 - LOGIC CHANGED TO EXCLUDE ONLY 999 STORAGE OFF-SITE  *10520004
105500*            TROUBLE FROM AGING CALCULATION.                     *10530004
105600*                                                                *10540004
105700******************************************************************10550004
105800 8000-CHECK-TROUBLE.                                              10560004
105900     EXEC SQL                                                     10570004
106000         SELECT COUNT(DISTINCT(A.TRBL_RSN_CDE))                   10580004
106100              , (MAX(DAYS(A.RESOLVED_TMST)) -                     10590004
106200                 MIN(DAYS(A.NOTIF_TMST)))                         10600004
106300         INTO :PV-TROUBLE-CNT                                     10610004
106400            , :PV-DAYS-IN-TROUBLE                                 10620004
106500         FROM TTRBNTF A                                           10630004
106600            , TTRBRSN B                                           10640004
106700         WHERE PO_NBR             = :DK-PO-NBR                    10650004
106800           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               10660004
106900           AND A.TRBL_RSN_CDE     NOT IN (999.)                   10670004
107000           AND A.TRBL_RSN_CDE     = B.TRBL_RSN_CDE                10680004
107100           AND B.NOTIF_IND        = 'T'                           10690004
107200     END-EXEC.                                                    10700004
107300                                                                  10710004
107400     EVALUATE TRUE                                                10720004
107500         WHEN SQLCODE = ZEROS                                     10730004
107600             CONTINUE                                             10740004
107700         WHEN SQLCODE = +100                                      10750004
107800         WHEN SQLCODE = -305                                      10760004
107900             MOVE +0 TO PV-TROUBLE-CNT                            10770004
108000                        PV-DAYS-IN-TROUBLE                        10780004
108100         WHEN OTHER                                               10790004
108200             DISPLAY '** ABEND **'                                10800004
108300             DISPLAY '** PROGRAM = PCKRP008 **'                   10810004
108400             DISPLAY '** PARAGRAPH = 8000-CHECK-TROUBLE **'       10820004
108500             DISPLAY '** KEY -- PO: ' DK-PO-NBR                   10830004
108600                     ' REC SEQ: '     DK-REC-SEQ-NBR              10840004
108700             PERFORM 9100-SQL-ABEND                               10850004
108800     END-EVALUATE.                                                10860004
108900                                                                  10870004
109000*                                                                 10880004
109100******************************************************************10890004
109200* 8100-GET-CARTON-COUNT.                                         *10900004
109300*                                                                *10910004
109400******************************************************************10920004
109500 8100-GET-CARTON-COUNT.                                           10930004
109600     EXEC SQL                                                     10940004
109700         SELECT EXPTED_CART_CNT                                   10950004
109800              , ACTL_CART_CNT                                     10960004
109900         INTO  :RECEIV-EXPTED-CART-CNT                            10970004
110000              ,:RECEIV-ACTL-CART-CNT                              10980004
110100         FROM TRECEIV                                             10990004
110200         WHERE ORD_NBR          = :DK-PO-NBR                      11000004
110300           AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 11010004
110400           AND VER_STATUS_CDE   = 'A'                             11020004
110500     END-EXEC.                                                    11030004
110600                                                                  11040004
110700     EVALUATE TRUE                                                11050004
110800         WHEN SQLCODE = ZEROS                                     11060004
110900             CONTINUE                                             11070004
111000         WHEN OTHER                                               11080004
111100             DISPLAY '** ABEND **'                                11090004
111200             DISPLAY '** PROGRAM = PCKRP008 **'                   11100004
111300             DISPLAY '** PARAGRAPH = 8100-CARTON-COUNT  **'       11110004
111400             DISPLAY '** KEY -- PO: ' DK-PO-NBR                   11120004
111500                     ' REC SEQ: '     DK-REC-SEQ-NBR              11130004
111600             PERFORM 9100-SQL-ABEND                               11140004
111700     END-EVALUATE.                                                11150004
111800                                                                  11160004
111900*                                                                 11170004
112000******************************************************************11180004
112100* 8200-GET-PRCS-AREA-DESC.                                       *11190004
112200*                                                                *11200004
112300******************************************************************11210004
112400 8200-GET-PRCS-AREA-DESC.                                         11220004
112500                                                                  11230004
112600     EXEC SQL                                                     11240004
112700         SELECT                                                   11250004
112800                 FCLTY_AREA_DESC                                  11260004
112900           INTO                                                   11270004
113000                 :FLAREA-FCLTY-AREA-DESC                          11280004
113100           FROM                                                   11290004
113200                 TFLAREA                                          11300004
113300          WHERE  OPER_UNT_ID    = :DK-OPER-UNT-ID                 11310004
113400            AND  FCLTY_ID       = :DK-FCLTY-ID                    11320004
113500            AND  FCLTY_AREA_ID  = :PV-HOLD-PRCS-AREA              11330004
113600                                                                  11340004
113700     END-EXEC                                                     11350004
113800                                                                  11360004
113900     EVALUATE TRUE                                                11370004
114000         WHEN SQLCODE = ZERO                                      11380004
114100             MOVE FLAREA-FCLTY-AREA-DESC                          11390004
114200                                    TO  PH5-PRCS-AREA-DESC        11400004
114300         WHEN SQLCODE = +100                                      11410004
114400             MOVE 'AREA NOT FOUND'  TO  PH5-PRCS-AREA-DESC        11420004
114500                                                                  11430004
114600         WHEN SQLWARN0 NOT EQUAL SPACE                            11440004
114700         WHEN SQLCODE NOT EQUAL ZERO                              11450004
114800             DISPLAY '** ABEND **'                                11460004
114900             DISPLAY '** PROGRAM = PCKRP008 **'                   11470004
115000             DISPLAY                                              11480004
115100               '** PARAGRAPH = 8200-GET-PRCS-AREA-DESC **'        11490004
115200             DISPLAY '** KEY -- OPER UNT ID: ' DK-OPER-UNT-ID     11500004
115300                     ' FACILITY ID: ' DK-FCLTY-ID                 11510004
115400                     ' PROCESS AREA: ' PV-HOLD-PRCS-AREA          11520004
115500             PERFORM 9100-SQL-ABEND                               11530004
115600     END-EVALUATE.                                                11540004
115700                                                                  11550004
115800*                                                                 11560004
115900******************************************************************11570004
116000* 8300-GET-DC-NAME.                                              *11580004
116100*                                                                *11590004
116200******************************************************************11600004
116300 8300-GET-DC-NAME.                                                11610004
116400                                                                  11620004
116500     EXEC SQL                                                     11630004
116600           SELECT                                                 11640004
116700                  LOC_NM                                          11650006
116800           INTO                                                   11660004
116900                  :XLT00010-LOC-NM                                11670006
117000           FROM                                                   11680004
117100                  XLT_LOC                                         11690006
117200           WHERE                                                  11700006
117400                  LOC_NBR      = :DK-DC1-NBR                      11710007
117300             AND  LOC_TYP_CDE  = 'DC'                             11720006
117500     END-EXEC                                                     11730004
117600                                                                  11740004
117700     EVALUATE TRUE                                                11750004
117800         WHEN SQLCODE = ZERO                                      11760004
117900             MOVE XLT00010-LOC-NM    TO PH3-DC-NAME               11770006
118000         WHEN SQLCODE = +100                                      11780004
118100             MOVE ' RECEIVING LOC NOT FOUND '                     11790004
118200                                     TO PH3-DC-NAME               11800004
118300         WHEN SQLWARN0 NOT EQUAL SPACE                            11810004
118400         WHEN SQLCODE NOT EQUAL ZERO                              11820004
118500             DISPLAY '** ABEND **'                                11830004
118600             DISPLAY '** PROGRAM = PCKRP008 **'                   11840004
118700             DISPLAY                                              11850004
118800               '** PARAGRAPH = 8300-GET-DC-NAME  **'              11860004
118900             DISPLAY '** KEY -- COMPANY CODE: '                   11870004
119000                      PC-OPERATING-COMPANY-CD                     11880004
119100                     '-TYPE CODE: DC-DC NUMBER: '                 11890004
119200                      DK-DC1-NBR                                  11900004
119300             PERFORM 9100-SQL-ABEND                               11910004
119400     END-EVALUATE.                                                11920004
119500                                                                  11930004
119600******************************************************************11940004
119700* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  11950004
119800* CURSOR AND THE REPORT FILE.                                     11960004
119900******************************************************************11970004
120000 9000-EOJ-ROUTINE.                                                11980004
120100                                                                  11990004
120200     IF PS-NO-DATA                                                12000004
120300         CONTINUE                                                 12010004
120400     ELSE                                                         12020004
120500         PERFORM 2400-GRAND-TOTAL                                 12030004
120600     END-IF.                                                      12040004
120700                                                                  12050004
120800     WRITE RT-RECEIPT-TURN-LINE                                   12060004
120900         FROM END-OF-REPORT-LINE                                  12070004
121000         AFTER ADVANCING 1 LINES.                                 12080004
121100                                                                  12090004
121200     CLOSE RT-RECEIPT-TURN-REPORT                                 12100004
121300           RE-RECEIPT-EXTRACT.                                    12110004
121400                                                                  12120004
121500*9000-EXIT.                                                       12130004
121600******************************************************************12140004
121700* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      12150004
121800* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 12160004
121900******************************************************************12170004
122000 9100-SQL-ABEND.                                                  12180004
122100     DISPLAY '** ABEND     **'.                                   12190004
122200     DISPLAY '** PROGRAM   ** = PCKRP008'.                        12200004
122300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              12210004
122400     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     12220004
122500                                                                  12230004
122600******************************************************************12240004
122700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    12250004
122800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         12260004
122900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     12270004
123000* FORMAT.                                                         12280004
123100******************************************************************12290004
123200*    COPY DPPD004.                                                12300004
123300     COPY DPPD004.                                                12310004
123400                                                                  12320004
123500     MOVE +4013 TO ABEND-CODE.                                    12330004
123600     CALL 'ILBOABN0' USING ABEND-CODE.                            12340004
123700*9100-EXIT.                                                       12350004
