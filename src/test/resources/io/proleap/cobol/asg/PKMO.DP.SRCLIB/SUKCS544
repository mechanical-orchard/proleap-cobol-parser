000300 TITLE 'MSDE BRAND SUMMARY'.                                      00030006
000400 IDENTIFICATION DIVISION.                                         00040000
000500 PROGRAM-ID.    SUKCS544.                                         00050000
000600 AUTHOR.        PATRICK BURKE.                                    00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  MARCH 2006.                                       00080000
000900 DATE-COMPILED.                                                   00090000
000910*----------------------------------------------------------------*00091004
000911* 07/06/2015  CHERI PARMLEY                                      *00091104
000920*             CHANGE WAS ADDED TO REPEAT THE 4 CURSORS TO        *00092010
000930*             ALSO GET DATA OFF THE NEW XLT_BRND AND             *00093010
000930*             SUT_BRND_MDSE_SUM TABLES. THIS WILL EVENTUALLY     *00093110
000940*             REPLACE THE XLT_MDSE_PGM AND THE SUT_PGM_MDSE_SUM  *00094010
000950*             TABLE.  (WHEN DATA IS OLD AND NOT PULLED ANY LONGER*00095010
000950*             IN ANY SYSTEM)                                     *00095110
000960*----------------------------------------------------------------*00096004
000911* 03/2021     JEAN KURK                                          *00097013
000920*             REMOVE TABLES SUT_PGM_MDSE_SUM AND XLT_MDSE_PGM    *00098013
000960*----------------------------------------------------------------*00099013
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00099215
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00099315
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00099415
263968*---------------------------------------------------------------* 00099515
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00099716
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00099816
263968*---------------------------------------------------------------* 00100216
001000 ENVIRONMENT DIVISION.                                            00101000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400                                                                  00140000
001500 01  DK-DB2-KEYS.                                                 00150000
001600     05  DK-TRIP-OCRNC-ID             PIC S9(9) COMP VALUE ZERO.  00160000
001700     05  DK-OTBND-TRIP-ID             PIC S9(9) COMP VALUE ZERO.  00170000
001800     05  DK-STATUS-CODE-1             PIC X(02) VALUE SPACE.      00180000
001900     05  DK-STATUS-CODE-2             PIC X(02) VALUE SPACE.      00190000
002000     05  DK-STATUS-CODE-3             PIC X(02) VALUE SPACE.      00200000
002100     05  DK-STATUS-CODE-4             PIC X(02) VALUE SPACE.      00210000
002200     05  DK-FROM-DATE                 PIC X(10) VALUE SPACE.      00220000
002300     05  DK-TO-DATE                   PIC X(10) VALUE SPACE.      00230000
002400     05  DK-DEPT-NBR                  PIC S9(4) COMP-3.           00240000
002500     05  DK-BUS-AREA-ID               PIC S9(4) COMP-3.           00250000
002510     05  DK-PRINTER-DEST.                                         00251000
002520         10 DK-PRINTER-DEST-1          PIC X(01) VALUE SPACE.     00252000
002530         10 DK-PRINTER-DEST-7          PIC X(07) VALUE SPACE.     00253000
002600                                                                  00260000
002700 01  PC-PROGRAM-CONSTANTS.                                        00270000
002800     05  PC-INTER-APPL-CODES.                                     00280000
002900         10  PC-INTER-APPL-CRIT-SPEC    PIC  X(01)  VALUE '1'.    00290000
003000         10  PC-INTER-APPL-LIST         PIC  X(01)  VALUE '2'.    00300000
003100         10  PC-INTER-APPL-DEPT-LIST    PIC  X(01)  VALUE '3'.    00310000
003200     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00320000
003300                                                    'SU544A  '.   00330000
003400     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00340000
003500                                                    'SUKM544 '.   00350000
003600     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00360000
003700                                                    'SUKCS544'.   00370000
003710     05  PC-DPKCS060                    PIC  X(08)  VALUE         00371000
003720                                                    'DPKCS060'.   00372000
003800     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00380000
003900     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00390000
004000     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00400000
004100     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +08     00410000
004200                                                    COMP SYNC.    00420000
004300     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00430000
004400                                                    COMP SYNC.    00440000
004500     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00450000
004600                                                    +1000000      00460000
004700                                                    COMP-3.       00470000
004800     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00480000
004900                                                    COMP SYNC.    00490000
005000     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00500000
005100     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00510000
005200     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00520000
005300     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00530000
005400     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00540000
005500*                                                                 00550000
005600     05  PC-TSYMSG-NUMBERS.                                       00560000
005700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00570000
005710         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00571000
005800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00580000
005900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00590000
006000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00600000
006100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00610000
006200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00620000
006300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00630000
006400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00640000
006500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00650000
006600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00660000
006700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00670000
006710         10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  00671000
006800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00680000
006900         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  00690000
007000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00700000
007100         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00710000
007110         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  00711000
007200         10  PC-TSYMSG-02816            PIC  9(05)  VALUE 02816.  00720000
007300         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00730000
      *CLP 07/06/2015 START                                             00730106
           05  PC-BRAND-DESC                  PIC  X(20)  VALUE         00731006
               'MDSE BRAND DESC     '.                                  00732006
      *    05  PC-PGM-DESC                    PIC  X(20)  VALUE         00733013
      *        'MDSE PGM DESCRIPTION'.                                  00734013
      *CLP 07/06/2015 END                                               00735006
007400*                                                                 00740000
007500 01  PS-PROGRAM-SWITCHES.                                         00750000
007600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    00760000
007700         88  PS-NO-ERROR                            VALUE 'N'.    00770000
007800         88  PS-ERROR                               VALUE 'Y'.    00780000
007900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00790000
008000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00800000
008100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00810000
008200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00820000
008300         88  PS-DONE                                VALUE 'Y'.    00830000
008400         88  PS-NOT-DONE                            VALUE 'N'.    00840000
008500     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        00850000
008600         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        00860000
008700         88  PS-NEXT-SCREEN                     VALUE 'Y'.        00870000
008800     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       00880000
008900         88  PS-LIST-END                         VALUE 'Y'.       00890000
009000         88  PS-NO-LIST-END                      VALUE 'N'.       00900000
009100*                                                                 00910000
009200 01  PV-PROGRAM-VARIABLES.                                        00920000
009300     05  PV-SUB                         PIC S9(04)  VALUE +0      00930000
009400                                                    COMP SYNC.    00940000
009500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00950000
009600                                                    COMP SYNC.    00960000
009700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00970000
009800                                                    COMP-3.       00980000
009900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00990000
010000                                                    COMP-3.       01000000
010100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01010000
010200                                                    COMP-3.       01020000
010300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01030000
010400                                                    COMP-3.       01040000
010500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01050000
010600                                                    COMP-3.       01060000
010700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01070000
010800                                                    COMP-3.       01080000
010900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01090000
011000                                                    COMP-3.       01100000
011100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01110000
011200                                                    COMP SYNC.    01120000
011300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01130000
011400                                                    COMP SYNC.    01140000
011500     05  PV-ITEM                        PIC S9(04)  VALUE +0      01150000
011600                                                    COMP SYNC.    01160000
011700*    05  PV-SEL-QUEUE-NAME              PIC X(08).                01170000
011800     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01180000
011900                                                    COMP SYNC.    01190000
012000     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01200000
012100                                                    COMP SYNC.    01210000
012200     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01220000
012300                                                    COMP SYNC.    01230000
012400     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01240000
012500                                                    COMP SYNC.    01250000
012600     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01260000
012700                                                    COMP SYNC.    01270000
012800     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01280000
012900                                                    COMP SYNC.    01290000
013000     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01300000
013100                                                    COMP SYNC.    01310000
013200     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01320000
013300                                                    COMP SYNC.    01330000
013400     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01340000
013500                                                    COMP SYNC.    01350000
013600     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01360000
013700                                                    COMP SYNC.    01370000
013800     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01380000
013900                                                    COMP SYNC.    01390000
014000     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01400000
014100                                                    COMP SYNC.    01410000
014200     05  PV-DB2-DATE.                                             01420000
014300         10  PV-DB2-MM                PIC XX VALUE ZERO.          01430000
014400         10  FILLER                   PIC X VALUE '/'.            01440000
014500         10  PV-DB2-DD                PIC XX VALUE ZERO.          01450000
014600         10  FILLER                   PIC X VALUE '/'.            01460000
014700         10  PV-DB2-YY                PIC XX VALUE ZERO.          01470000
014800     05  PV-DATE                      PIC X(10) VALUE SPACES.     01480000
014900     05  PV-TIME                      PIC X(08) VALUE SPACES.     01490000
015000     05  PV-DB2-COUNT                 PIC S9(8) COMP VALUE ZERO.  01500000
015010     05  PV-COMMAREA-LENGTH           PIC S9(04) VALUE ZERO       01501000
015020                                                 COMP SYNC.       01502000
015100                                                                  01510000
015200******************************************************************01520000
015300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01530000
015400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01540000
015500**  APPLICATION-SPECIFIC COMMAREA.                              **01550000
015600******************************************************************01560000
015700 01  LQW-LIST-QUEUE-WORK-AREA.                                    01570000
015800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01580000
015900     05  LQW-ITEM-ENTRIES               OCCURS 08 TIMES           01590000
016000                                        INDEXED BY LQW-IDX.       01600000
016100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01610000
016200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01620000
016300         10  LQW-SELECTED-SW          PIC  X(01).                 01630000
016400             88  LQW-SELECT                         VALUE 'S'.    01640000
016500             88  LQW-DESELECT                       VALUE ' '.    01650000
016600         10  LQW-ACTION               PIC X(03).                  01660000
016610         10  LQW-BUS-AREA             PIC X(13).                  01661000
016800         10  LQW-MDSE-DESC            PIC X(20).                  01680000
017000         10  LQW-CARTONS              PIC S9(07) COMP-3.          01700000
017100         10  LQW-UNITS                PIC S9(07) COMP-3.          01710000
017110         10  LQW-NEW-IND              PIC X(01).                  01711000
017200         10  LQW-SKU-COUNT            PIC S9(07) COMP-3.          01720000
017300         10  LQW-HANG-FOLD-CDE        PIC X(01).                  01730000
017400                                                                  01740000
018900/                                                                 01890000
019000*---------------------------------------------------------------* 01900000
019100*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 01910000
019200*---------------------------------------------------------------* 01920000
019400     COPY SUWS013.                                                01940000
019600/                                                                 01960000
019610*---------------------------------------------------------------* 01961000
019620*    COMMAREA TO LINK TO DPKCS060 - PRINT DEST VALIDATION         01962000
019630*---------------------------------------------------------------* 01963000
019640     COPY DPWS072.                                                01964000
019650/                                                                 01965000
019700*---------------------------------------------------------------* 01970000
019800*    MAP LAYOUT                                                 * 01980000
019900*---------------------------------------------------------------* 01990000
020000                                                                  02000000
020100     COPY SUKM544.                                                02010000
020200*                                                                 02020000
020300 01  MR-OCCURS-LAYOUT                   REDEFINES  SU544AO.       02030000
020400*OUT 05  FILLER                         PIC X(261).               02040008
020400     05  FILLER                         PIC X(286).               02041008
020500     05  MR-SCROLL-AREA                 OCCURS 08 TIMES.          02050000
020600         10  MR-SELECTL                 PIC S9(04) COMP.          02060000
020700         10  MR-SELECTA                 PIC  X(01).               02070000
020800         10  MR-SELECTC                 PIC  X(01).               02080000
020900         10  MR-SELECTH                 PIC  X(01).               02090000
021000         10  MR-SELECTI                 PIC  X(01).               02100000
021100                                                                  02110000
021200         10  MR-ACTIONL                 PIC S9(04) COMP.          02120000
021300         10  MR-ACTIONA                 PIC  X(01).               02130000
021400         10  MR-ACTIONC                 PIC  X(01).               02140000
021500         10  MR-ACTIONH                 PIC  X(01).               02150000
021600         10  MR-ACTION                  PIC  X(03).               02160000
021700                                                                  02170000
023000         10  MR-BUS-AREA-L              PIC S9(04) COMP.          02300000
023100         10  MR-BUS-AREA-A              PIC  X(01).               02310000
023200         10  MR-BUS-AREA-C              PIC  X(01).               02320000
023300         10  MR-BUS-AREA-H              PIC  X(01).               02330000
023400         10  MR-BUS-AREA                PIC  X(13).               02340000
023500                                                                  02350000
023501*CLP 07/06/2015 START                                             02350104
023510         10  MR-BRND-DESC-L             PIC S9(04) COMP.          02351001
023520         10  MR-BRND-DESC-A             PIC  X(01).               02352001
023530         10  MR-BRND-DESC-C             PIC  X(01).               02353001
023540         10  MR-BRND-DESC-H             PIC  X(01).               02354001
023550         10  MR-BRND-DESC               PIC  X(20).               02355001
023551*CLP 07/06/2015 END                                               02355104
023560                                                                  02356000
023600         10  MR-CARTONS-L               PIC S9(04) COMP.          02360000
023700         10  MR-CARTONS-A               PIC  X(01).               02370000
023800         10  MR-CARTONS-C               PIC  X(01).               02380000
023900         10  MR-CARTONS-H               PIC  X(01).               02390000
024000         10  MR-CARTONS                 PIC  ZZZ,ZZZ.             02400000
024100                                                                  02410000
024200         10  MR-UNITS-L                 PIC S9(04) COMP.          02420000
024300         10  MR-UNITS-A                 PIC  X(01).               02430000
024400         10  MR-UNITS-C                 PIC  X(01).               02440000
024500         10  MR-UNITS-H                 PIC  X(01).               02450000
024600         10  MR-UNITS                   PIC  ZZZ,ZZZ.             02460000
024700                                                                  02470000
024710         10  MR-NEW-L                   PIC S9(04) COMP.          02471000
024720         10  MR-NEW-A                   PIC  X(01).               02472000
024730         10  MR-NEW-C                   PIC  X(01).               02473000
024740         10  MR-NEW-H                   PIC  X(01).               02474000
024750         10  MR-NEW                     PIC  X(01).               02475000
024760                                                                  02476000
024800         10  MR-SKU-COUNT-L             PIC S9(04) COMP.          02480000
024900         10  MR-SKU-COUNT-A             PIC  X(01).               02490000
025000         10  MR-SKU-COUNT-C             PIC  X(01).               02500000
025100         10  MR-SKU-COUNT-H             PIC  X(01).               02510000
025200         10  MR-SKU-COUNT               PIC  ZZZ,ZZZ.             02520000
025300                                                                  02530000
025400         10  MR-HANG-FOLD-L             PIC S9(04) COMP.          02540000
025500         10  MR-HANG-FOLD-A             PIC  X(01).               02550000
025600         10  MR-HANG-FOLD-C             PIC  X(01).               02560000
025700         10  MR-HANG-FOLD-H             PIC  X(01).               02570000
025800         10  MR-HANG-FOLD               PIC  X(01).               02580000
025900                                                                  02590000
025910     05  FILLER                         PIC X(012).               02591000
026000/                                                                 02600000
026100*---------------------------------------------------------------* 02610000
026200*    ATTRIBUTE SETTINGS                                           02620000
026300*---------------------------------------------------------------* 02630000
026400                                                                  02640000
026500     COPY DPWS015.                                                02650000
026600                                                                  02660000
026700*---------------------------------------------------------------* 02670000
026800*    FUNCTION KEYS                                                02680000
026900*---------------------------------------------------------------* 02690000
027000                                                                  02700000
027100     COPY DPWS016.                                                02710000
027200                                                                  02720000
027300*---------------------------------------------------------------* 02730000
027400*    NUMERIC EDIT LAYOUT.                                       * 02740000
027500*---------------------------------------------------------------* 02750000
027600                                                                  02760000
027700     COPY DPWS010I.                                               02770000
027800/                                                                 02780000
027900*---------------------------------------------------------------* 02790000
028000*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 02800016
028100*---------------------------------------------------------------* 02810000
028200                                                                  02820000
028300     COPY DPWS030.                                                02830000
028300     COPY DPWS930.                                                02831016
028400/                                                                 02840000
028500*---------------------------------------------------------------* 02850000
028600*    STANDARD COMMAREA.                                         * 02860000
028700*---------------------------------------------------------------* 02870000
028800                                                                  02880000
028900     COPY DPWS020.                                                02890000
029000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02900000
029100                                                                  02910000
029200*---------------------------------------------------------------* 02920000
029300* INTER-APPLICATION COMMAREA.                                   * 02930000
029400*   DPWS054 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02940000
029500*             SPEC SCREEN.                                      * 02950000
029600*   DPWS056 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02960000
029700*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02970000
029800*---------------------------------------------------------------* 02980000
029900                                                                  02990000
030000         10  INTER-APPL-COMM-AREA       PIC X(200).               03000000
030100                                                                  03010000
030200*  INPUT FROM CRIT SPEC SCREEN, SUKCS566                          03020000
030300     COPY SUWS011.                                                03030000
030400                                                                  03040000
030500*  OUTPUT TO LIST SCREEN, SUKCS572                                03050000
030600     COPY SUWS012.                                                03060000
030700*---------------------------------------------------------------* 03070000
030800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03080000
030900*---------------------------------------------------------------* 03090000
031000         10  ASC-SPECIFIC-COMMAREA.                               03100000
031100             15  ASC-INT-APPL-FORMAT-IND    PIC  X(01).           03110000
031300                 88  ASC-BUSAREA-LIST       VALUE '2'.            03130000
031310                 88  ASC-TRLR-STAT-LIST     VALUE '3'.            03131000
031400             15  ASC-LIST-KEYS.                                   03140000
031500                 20  ASC-KEY-TRIP-ID        PIC S9(09) COMP.      03150000
031600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03160000
031700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03170000
031800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03180000
031900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03190000
032000                                                                  03200000
032100                 20  ASC-ITEM-ARRAY.                              03210000
032200                     25  ASC-ITEM-ENTRIES OCCURS 08 TIMES.        03220000
032300                         30  ASC-LIST-ITEM-NUMBER                 03230000
032400                                                     PIC S9(09)   03240000
032500                                                     COMP-3.      03250000
032600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03260000
032700                             88  ASC-VALID-SELECT    VALUE ' '    03270000
032800                                                           'S'    03280000
032900                                                           'B'    03290000
033000                                                           'E'.   03300000
033100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03310000
033200                             88  ASC-TEMP-SELECT     VALUE 'S'.   03320000
033300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03330000
033400                             88  ASC-TEMP-END        VALUE 'E'.   03340000
033500                         30  ASC-SELECTED-SW         PIC  X(01).  03350000
033600                             88  ASC-NO-SELECT       VALUE ' '.   03360000
033700                             88  ASC-SELECT          VALUE 'S'.   03370000
033800                             88  ASC-BEGIN           VALUE 'B'.   03380000
033900                             88  ASC-END             VALUE 'E'.   03390000
034000                         30  ASC-ACTION    PIC  X(03).            03400000
034100                         30  ASC-BUS-AREA  PIC X(13).             03410000
034110*CLP 07/06/2015 START                                             03411004
034200                         30  ASC-BRND-DESC PIC X(20).             03420001
034300*CLP 07/06/2015 END                                               03430004
034400                         30  ASC-CART-QTY  PIC S9(07) COMP-3.     03440000
034500                         30  ASC-UNT-QTY   PIC S9(07) COMP-3.     03450000
034600                         30  ASC-NEW       PIC X(01).             03460000
034700                         30  ASC-SKU-COUNT PIC S9(07) COMP-3.     03470000
034710                         30  ASC-HANG-FOLD PIC X(01).             03471000
034800                                                                  03480000
034900             15  ASC-TRAILER-STAT  PIC X(10).                     03490000
035000             15  ASC-STAT-DATE     PIC X(08).                     03500000
035100*            15  ASC-SCAC          PIC X(04).                     03510000
035200             15  ASC-SERIAL        PIC 9(09).                     03520000
035300             15  ASC-PCT-FULL      PIC 9(03).                     03530000
035400             15  ASC-JEWELRY       PIC X(01).                     03540000
035500*            15  ASC-CART-QTY      PIC 9(06).                     03550000
035600             15  ASC-OTBND-TRIP-ID PIC S9(9) COMP.                03560000
035700             15  ASC-TRIP-STAT-CDE PIC X(02).                     03570000
035800*            15  ASC-TRIP-OCRNC-ID PIC S9(9) COMP.                03580000
035900             15  ASC-CRE-TMST      PIC X(26).                     03590000
036000                                                                  03600000
036100             15  ASC-BLK-SUB          PIC S9(04) COMP SYNC.       03610000
036200             15  ASC-ITEM-SUB         PIC S9(04) COMP SYNC.       03620000
036300             15  ASC-NUMBER-OF-ITEMS-READ      PIC S9(09) COMP-3. 03630000
036400             15  ASC-NUMBER-OF-SELECTED-ITEMS  PIC S9(09) COMP-3. 03640000
036500             15  ASC-ITEMS-DISPLAYED           PIC S9(03) COMP-3. 03650000
036600             15  ASC-ITEM-AT-TOP-OF-PANEL      PIC S9(09) COMP-3. 03660000
036700             15  ASC-ITEM-AT-BOT-OF-PANEL      PIC S9(09) COMP-3. 03670000
036800             15  ASC-HIGHEST-BLOCK-WRITTEN     PIC S9(04) COMP    03680000
036900                                                          SYNC.   03690000
037000             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03700000
037100                                                          COMP-3. 03710000
037200             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03720000
037300                                                          COMP-3. 03730000
037400             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03740000
037500                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03750000
037600                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03760000
037700             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03770000
037800                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03780000
037900                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03790000
038000             15  ASC-LIST-QUEUE-NAME.                             03800000
038100                 20  ASC-LIST-TERM-ID                PIC  X(04).  03810000
038200                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03820000
038300                                                          COMP-3. 03830000
038400                 20  ASC-LIST-SEQ                    PIC  9(01).  03840000
038500             15  ASC-SEL-QUEUE-NAME-IN.                           03850000
038600                 20  ASC-SEL-TERM-ID-IN              PIC  X(04).  03860000
038700                 20  ASC-SEL-TASK-NUMBER-IN          PIC S9(05)   03870000
038800                                                          COMP-3. 03880000
038900                 20  ASC-SEL-SEQ-IN                  PIC  9(01).  03890000
039000             15  ASC-SEL-QUEUE-NAME-OUT.                          03900000
039100                 20  ASC-SEL-TERM-ID-OUT             PIC  X(04).  03910000
039200                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(05)   03920000
039300                                                          COMP-3. 03930000
039400                 20  ASC-SEL-SEQ-OUT                 PIC  9(01).  03940000
039500                                                                  03950000
039600             15  ASC-USE-SELECTION-QUEUE-IND                      03960000
039700                                                 PIC  X(01).      03970000
039800                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03980000
039900             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    03990000
040000             15  ASC-SEL-SUB               PIC S9(04)  COMP.      04000000
040100             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      04010000
040200             15  ASC-START-ITEM-REQUEST.                          04020000
040300                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  04030000
040400                                                                  04040000
040500                                                                  04050000
040600*            15  ASC-CURR-OPER-UNT-ID PIC S9(04) COMP.            04060000
040700             15  ASC-SERVICE-DC-NAME  PIC X(20).                  04070000
040800             15  ASC-STR-NAME         PIC X(25).                  04080000
040900             15  ASC-STR-NBR          PIC S9(04) COMP.            04090000
041000             15  ASC-TRLR-SRL-NBR     PIC S9(09) COMP.            04100000
041100             15  ASC-TRIP-OCRNC-ID    PIC S9(09) COMP.            04110000
041200             15  ASC-BUS-AREA-ID      PIC S9(4) COMP-3.           04120000
041300             15  ASC-SCAC             PIC X(04).                  04130000
041400             15  ASC-TRLR-ID          PIC X(12).                  04140000
041500             15  ASC-TRIP-STAT-DESC   PIC X(10).                  04150000
041600             15  ASC-TOTAL-CARTONS    PIC S9(07) COMP-3.          04160000
041700             15  ASC-TOTAL-UNITS      PIC S9(07) COMP-3.          04170000
041800             15  ASC-SUMMARY-DATE     PIC X(10).                  04180000
041900             15  ASC-SUMMARY-TIME     PIC X(08).                  04190000
041910             15  ASC-PRINTER-DEST     PIC X(08).                  04191000
042000             15  ASC-SCREEN-SEQUENCE  PIC X(01).                  04200000
042100                 88  ASC-AREA-SEQ                VALUE 'D'.       04210000
042200                 88  ASC-UNIT-SEQ                VALUE 'U'.       04220000
042300             15  ASC-SEQ-DESC         PIC X(20).                  04230000
042310*            15  ASC-USING-CSR        PIC X(01).                  04231013
042320*                88  ASC-USING--BRAND            VALUE 'B'.       04232013
042330*                88  ASC-USING--PGM              VALUE 'P'.       04233013
042400/                                                                 04240000
042410******************************************************************04241000
042500*    XLKUT073 COPYBOOK                                            04250000
042600     COPY XLWS073.                                                04260000
042700/                                                                 04270000
042750******************************************************************04275000
042800*    ABEND PROCESSING                                             04280000
042900                                                                  04290000
043000     COPY DPWS013.                                                04300000
043100/                                                                 04310000
043120******************************************************************04312000
043130*  OUTPUT TO REPORT PGM , SUKCS546                                04313000
043140     COPY SUWS083.                                                04314000
043150/                                                                 04315000
043160******************************************************************04316000
043200     EXEC SQL                                                     04320000
043300          INCLUDE TSUOBTR                                         04330000
043400     END-EXEC.                                                    04340000
043500                                                                  04350000
043600*    DEPT SUMMARY                                                 04360000
043700     EXEC SQL                                                     04370000
043800          INCLUDE SUT00009                                        04380000
043900     END-EXEC.                                                    04390000
044000                                                                  04400000
044010*    SUT PGM MDSE SUM                                             04401000
044020*    EXEC SQL                                                     04402014
044030*         INCLUDE SUT00096                                        04403014
044040*    END-EXEC.                                                    04404014
044091                                                                  04409100
044099*    XLT MDSE PGM                                                 04409902
044100*    EXEC SQL                                                     04410014
044101*         INCLUDE XLT00040                                        04410114
044102*    END-EXEC.                                                    04410214
044103                                                                  04410302
044110*CLP 07/06/2015 - START                                           04411004
044113*----------------------------------------------------------------*04411301
044114* BRAND TABLE (XLT_BRND)                                          04411401
044115*----------------------------------------------------------------*04411501
044116     EXEC SQL                                                     04411601
044117          INCLUDE XLT00043                                        04411701
044118     END-EXEC.                                                    04411801
044119                                                                  04411901
044120*----------------------------------------------------------------*04412004
044121* BRAND SUMMARY TABLE (SUT_BRND_MDSE_SUM)                         04412104
044122*----------------------------------------------------------------*04412204
044123*    SUT BRND MDSE SUM                                            04412304
044124     EXEC SQL                                                     04412404
044125          INCLUDE SUT00066                                        04412504
044126     END-EXEC.                                                    04412604
044127                                                                  04412704
044128*CLP 07/06/2015 - END                                             04412804
044129                                                                  04412904
044130*    MAJOR CLASS AD DATE                                          04413000
044200     EXEC SQL                                                     04420000
044300          INCLUDE SUT00011                                        04430000
044400     END-EXEC.                                                    04440000
044500/                                                                 04450000
044600*    DOMAIN BUSINESS AREA                                         04460000
044700     EXEC SQL                                                     04470000
044800          INCLUDE XLT00000                                        04480000
044900     END-EXEC.                                                    04490000
045000                                                                  04500000
045100*    DOMAIN BUSINESS GROUP                                        04510000
045200     EXEC SQL                                                     04520000
045300          INCLUDE XLT00001                                        04530000
045400     END-EXEC.                                                    04540000
045500                                                                  04550000
045600*    DOMAIN DEPARTMENT                                            04560000
045700     EXEC SQL                                                     04570000
045800          INCLUDE XLT00002                                        04580000
045900     END-EXEC.                                                    04590000
046000                                                                  04600000
046100*    DOMAIN LOCATION                                              04610000
046200     EXEC SQL                                                     04620000
046300          INCLUDE XLT00010                                        04630000
046400     END-EXEC.                                                    04640000
046500                                                                  04650000
046510******************************************************************04651000
046511* TRAILER STATUS CURSOR BRINGS BACK A WHOLE TRIP                  04651100
046512* FROM XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          04651204
046513******************************************************************04651302
046514*                                                                 04651413
046515*    EXEC SQL                                                     04651513
046516*     DECLARE TRLR-AREA-CSR CURSOR FOR                            04651613
046517*     SELECT A.TRIP_OCRNC_ID                                      04651713
046518*          , A.BUS_AREA_ID                                        04651813
046519*          , A.MDSE_PGM_ID                                        04651913
046520*          , A.UNT_QTY                                            04652013
046521*          , A.SKU_QTY                                            04652113
046522*          , A.CART_QTY                                           04652213
046523*          , A.RTL_DOL_AMT                                        04652313
046524*          , A.COST_DOL_AMT                                       04652413
046526*          , B.BUS_AREA_ID                                        04652613
046527*          , B.BUS_AREA_DESC                                      04652713
046528*          , C.MDSE_PGM_ID                                        04652813
046529*          , C.MDSE_PGM_DESC                                      04652913
046530*          , A.HNG_FOLD_CDE                                       04653013
046531*          , A.PRC_MSG_RPLN_NEW_IND                               04653113
046532*     FROM SUT_PGM_MDSE_SUM   A                                   04653213
046533*        , XLT_BUS_AREA   B                                       04653313
046534*        , XLT_MDSE_PGM   C                                       04653413
046535*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04653513
046536*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04653613
046537*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       04653713
046538*     UNION ALL                                                   04653813
046539*     SELECT A.TRIP_OCRNC_ID                                      04653913
046540*          , A.BUS_AREA_ID                                        04654013
046541*          , A.MDSE_PGM_ID                                        04654113
046542*          , A.UNT_QTY                                            04654213
046543*          , A.SKU_QTY                                            04654313
046544*          , A.CART_QTY                                           04654413
046545*          , A.RTL_DOL_AMT                                        04654513
046546*          , A.COST_DOL_AMT                                       04654613
046549*          , B.BUS_AREA_ID                                        04654913
046550*          , B.BUS_AREA_DESC                                      04655013
046551*          , 9999999999                                           04655113
046552*          , 'UNKNOWN'                                            04655213
046553*          , A.HNG_FOLD_CDE                                       04655313
046554*          , A.PRC_MSG_RPLN_NEW_IND                               04655413
046555*     FROM SUT_PGM_MDSE_SUM   A                                   04655513
046556*        , XLT_BUS_AREA   B                                       04655613
046557*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04655713
046558*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    04655813
046559*          AND  NOT EXISTS (SELECT *                              04655913
046560*                             FROM XLT_MDSE_PGM  X                04656013
046561*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 04656113
046562*        ORDER BY 10                                              04656213
046563*               , 12                                              04656313
046564*                                                                 04656413
046565*    END-EXEC.                                                    04656513
                                                                        04656610
      *CLP 07/06/2015 START                                             04656710
046566******************************************************************04656802
046567* TRAILER STATUS CURSOR BRINGS BACK A WHOLE TRIP                  04656902
046568* FROM XLT_BRND AND SUT_BRND_MDSE_SUM                             04657004
046569******************************************************************04657102
046570                                                                  04657202
046571     EXEC SQL                                                     04657302
046572      DECLARE TRLR-AREA-B-CSR CURSOR FOR                          04657402
046573      SELECT A.TRIP_OCRNC_ID                                      04657502
046574           , A.BUS_AREA_ID                                        04657602
046575           , A.BRND_ID                                            04657702
046576           , A.UNT_QTY                                            04657802
046577           , A.SKU_QTY                                            04657902
046578           , A.CART_QTY                                           04658002
046579           , A.RTL_DOL_AMT                                        04658102
046580           , A.COST_DOL_AMT                                       04658202
046581           , B.BUS_AREA_ID                                        04658302
046582           , B.BUS_AREA_DESC                                      04658402
046583           , C.BRND_ID                                            04658502
046584           , C.BRND_DESC                                          04658602
046585           , A.HNG_FOLD_CDE                                       04658702
046586           , A.PRC_MSG_RPLN_NEW_IND                               04658802
046587      FROM SUT_BRND_MDSE_SUM   A                                  04658902
046588         , XLT_BUS_AREA   B                                       04659002
046589         , XLT_BRND   C                                           04659102
046590      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04659202
046591        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04659302
046592        AND C.BRND_ID   = A.BRND_ID                               04659402
046593      UNION ALL                                                   04659502
046594      SELECT A.TRIP_OCRNC_ID                                      04659602
046595           , A.BUS_AREA_ID                                        04659702
046596           , A.BRND_ID                                            04659802
046597           , A.UNT_QTY                                            04659902
046598           , A.SKU_QTY                                            04660002
046599           , A.CART_QTY                                           04660102
046600           , A.RTL_DOL_AMT                                        04660202
046601           , A.COST_DOL_AMT                                       04660302
046602           , B.BUS_AREA_ID                                        04660402
046603           , B.BUS_AREA_DESC                                      04660502
046604           , 32767                                                04660612
046605           , 'UNKNOWN'                                            04660702
046606           , A.HNG_FOLD_CDE                                       04660802
046607           , A.PRC_MSG_RPLN_NEW_IND                               04660902
046608      FROM SUT_BRND_MDSE_SUM   A                                  04661002
046609         , XLT_BUS_AREA   B                                       04661102
046610         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04661202
046611           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    04661302
046612           AND  NOT EXISTS (SELECT *                              04661402
046613                              FROM XLT_BRND      X                04661502
046614                             WHERE A.BRND_ID = X.BRND_ID)         04661602
046615         ORDER BY 10                                              04661702
046616                , 12                                              04661802
046617                                                                  04661902
046618     END-EXEC.                                                    04662002
      *CLP 07/06/2015 END                                               04662110
                                                                        04662210
046619******************************************************************04662300
046620* TRAILER STATUS CURSOR BRINGS BACK A WHOLE TRIP IN ORDER OF UNITS04662400
046621* FROM XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          04662504
046623******************************************************************04662602
046624*                                                                 04662713
046625*    EXEC SQL                                                     04662813
046626*     DECLARE TRLR-UNIT-CSR CURSOR FOR                            04662913
046627*     SELECT A.TRIP_OCRNC_ID                                      04663013
046628*          , A.BUS_AREA_ID                                        04663113
046629*          , A.MDSE_PGM_ID                                        04663213
046630*          , A.UNT_QTY                                            04663313
046631*          , A.SKU_QTY                                            04663413
046632*          , A.CART_QTY                                           04663513
046633*          , A.RTL_DOL_AMT                                        04663613
046634*          , A.COST_DOL_AMT                                       04663713
046635*          , B.BUS_AREA_ID                                        04663813
046636*          , B.BUS_AREA_DESC                                      04663913
046637*          , C.MDSE_PGM_ID                                        04664013
046638*          , C.MDSE_PGM_DESC                                      04664113
046639*          , A.HNG_FOLD_CDE                                       04664213
046640*          , A.PRC_MSG_RPLN_NEW_IND                               04664313
046641*     FROM SUT_PGM_MDSE_SUM   A                                   04664413
046642*        , XLT_BUS_AREA   B                                       04664513
046643*        , XLT_MDSE_PGM   C                                       04664613
046644*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04664713
046645*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04664813
046646*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       04664913
046647*     UNION ALL                                                   04665013
046648*     SELECT A.TRIP_OCRNC_ID                                      04665113
046649*          , A.BUS_AREA_ID                                        04665213
046650*          , A.MDSE_PGM_ID                                        04665313
046651*          , A.UNT_QTY                                            04665413
046652*          , A.SKU_QTY                                            04665513
046653*          , A.CART_QTY                                           04665613
046654*          , A.RTL_DOL_AMT                                        04665713
046655*          , A.COST_DOL_AMT                                       04665813
046656*          , B.BUS_AREA_ID                                        04665913
046657*          , B.BUS_AREA_DESC                                      04666013
046658*          , 9999999999                                           04666113
046659*          , 'UNKNOWN'                                            04666213
046660*          , A.HNG_FOLD_CDE                                       04666313
046661*          , A.PRC_MSG_RPLN_NEW_IND                               04666413
046662*     FROM SUT_PGM_MDSE_SUM   A                                   04666513
046663*        , XLT_BUS_AREA   B                                       04666613
046664*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04666713
046665*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    04666813
046666*          AND  NOT EXISTS (SELECT *                              04666913
046667*                             FROM XLT_MDSE_PGM  X                04667013
046668*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 04667113
046669*        ORDER BY 4 DESC                                          04667213
046670*               , 10                                              04667313
046671*                                                                 04667413
046672*    END-EXEC.                                                    04667513
046673                                                                  04667602
      *CLP 07/06/2015 START                                             04667710
046674******************************************************************04667802
046675* TRAILER STATUS CURSOR BRINGS BACK A WHOLE TRIP IN ORDER OF UNITS04667902
046676* USING XLT_BRND AND SUT_BRND_MDSE_SUM                            04668004
046677******************************************************************04668102
046678                                                                  04668202
046679     EXEC SQL                                                     04668302
046680      DECLARE TRLR-UNIT-BRND-CSR CURSOR FOR                       04668402
046681      SELECT A.TRIP_OCRNC_ID                                      04668502
046682           , A.BUS_AREA_ID                                        04668602
046683           , A.BRND_ID                                            04668702
046684           , A.UNT_QTY                                            04668802
046685           , A.SKU_QTY                                            04668902
046686           , A.CART_QTY                                           04669002
046687           , A.RTL_DOL_AMT                                        04669102
046688           , A.COST_DOL_AMT                                       04669202
046689           , B.BUS_AREA_ID                                        04669302
046690           , B.BUS_AREA_DESC                                      04669402
046691           , C.BRND_ID                                            04669502
046692           , C.BRND_DESC                                          04669602
046693           , A.HNG_FOLD_CDE                                       04669702
046694           , A.PRC_MSG_RPLN_NEW_IND                               04669802
046695      FROM SUT_BRND_MDSE_SUM   A                                  04669902
046696         , XLT_BUS_AREA   B                                       04670002
046697         , XLT_BRND       C                                       04670102
046698      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04670202
046699        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04670302
046700        AND C.BRND_ID       = A.BRND_ID                           04670402
046701      UNION ALL                                                   04670502
046702      SELECT A.TRIP_OCRNC_ID                                      04670602
046703           , A.BUS_AREA_ID                                        04670702
046704           , A.BRND_ID                                            04670802
046705           , A.UNT_QTY                                            04670902
046706           , A.SKU_QTY                                            04671002
046707           , A.CART_QTY                                           04671102
046708           , A.RTL_DOL_AMT                                        04671202
046709           , A.COST_DOL_AMT                                       04671302
046710           , B.BUS_AREA_ID                                        04671402
046711           , B.BUS_AREA_DESC                                      04671502
046712           , 32767                                                04671612
046713           , 'UNKNOWN'                                            04671702
046714           , A.HNG_FOLD_CDE                                       04671802
046715           , A.PRC_MSG_RPLN_NEW_IND                               04671902
046716      FROM SUT_BRND_MDSE_SUM   A                                  04672002
046717         , XLT_BUS_AREA   B                                       04672102
046718         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04672202
046719           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    04672302
046720           AND  NOT EXISTS (SELECT *                              04672402
046721                              FROM XLT_BRND      X                04672502
046722                             WHERE A.BRND_ID = X.BRND_ID)         04672602
046723         ORDER BY 4 DESC                                          04672702
046724                , 10                                              04672802
046725                                                                  04672902
046726     END-EXEC.                                                    04673002
      *CLP 07/06/2015 END                                               04673110
                                                                        04673210
046727******************************************************************04673300
046728* BUSAREA AREA CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA04673400
046729* SELECTED ON BUSAREA SCREEN IN AREA SEQUENCE                     04673500
046730* FROM XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          04673604
046732******************************************************************04673702
046733*                                                                 04673813
046734*    EXEC SQL                                                     04673913
046735*        DECLARE BUSAREA-AREA-CSR CURSOR FOR                      04674013
046736*     SELECT A.TRIP_OCRNC_ID                                      04674113
046737*          , A.BUS_AREA_ID                                        04674213
046738*          , A.MDSE_PGM_ID                                        04674313
046739*          , A.UNT_QTY                                            04674413
046740*          , A.SKU_QTY                                            04674513
046741*          , A.CART_QTY                                           04674613
046742*          , A.RTL_DOL_AMT                                        04674713
046743*          , A.COST_DOL_AMT                                       04674813
046744*          , B.BUS_AREA_ID                                        04674913
046745*          , B.BUS_AREA_DESC                                      04675013
046746*          , C.MDSE_PGM_ID                                        04675113
046747*          , C.MDSE_PGM_DESC                                      04675213
046748*          , A.HNG_FOLD_CDE                                       04675313
046749*          , A.PRC_MSG_RPLN_NEW_IND                               04675413
046750*     FROM SUT_PGM_MDSE_SUM   A                                   04675513
046751*        , XLT_BUS_AREA   B                                       04675613
046752*        , XLT_MDSE_PGM   C                                       04675713
046753*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04675813
046754*       AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     04675913
046755*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04676013
046756*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       04676113
046757*     UNION ALL                                                   04676213
046758*     SELECT A.TRIP_OCRNC_ID                                      04676313
046759*          , A.BUS_AREA_ID                                        04676413
046760*          , A.MDSE_PGM_ID                                        04676513
046761*          , A.UNT_QTY                                            04676613
046762*          , A.SKU_QTY                                            04676713
046763*          , A.CART_QTY                                           04676813
046764*          , A.RTL_DOL_AMT                                        04676913
046765*          , A.COST_DOL_AMT                                       04677013
046766*          , B.BUS_AREA_ID                                        04677113
046767*          , B.BUS_AREA_DESC                                      04677213
046768*          , 9999999999                                           04677313
046769*          , 'UNKNOWN'                                            04677413
046770*          , A.HNG_FOLD_CDE                                       04677513
046771*          , A.PRC_MSG_RPLN_NEW_IND                               04677613
046772*     FROM SUT_PGM_MDSE_SUM   A                                   04677713
046773*        , XLT_BUS_AREA   B                                       04677813
046774*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04677913
046775*          AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  04678013
046776*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    04678113
046777*          AND  NOT EXISTS (SELECT *                              04678213
046778*                             FROM XLT_MDSE_PGM  X                04678313
046779*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 04678413
046780*        ORDER BY 10                                              04678513
046781*               , 12                                              04678613
046782*                                                                 04678713
046783*    END-EXEC.                                                    04678813
                                                                        04678910
      *CLP 07/06/2015 START                                             04679010
046784******************************************************************04679102
046785* BUSAREA AREA CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA04679202
046786* SELECTED ON BUSAREA SCREEN IN AREA SEQUENCE                     04679302
046787* FROM XLT_BRND AND SUT_BRND_MDSE_SUM                             04679404
046788******************************************************************04679502
046789                                                                  04679602
046790     EXEC SQL                                                     04679702
046791         DECLARE BUSAREA-AREA-B-CSR CURSOR FOR                    04679802
046792      SELECT A.TRIP_OCRNC_ID                                      04679902
046793           , A.BUS_AREA_ID                                        04680002
046794           , A.BRND_ID                                            04680102
046795           , A.UNT_QTY                                            04680202
046796           , A.SKU_QTY                                            04680302
046797           , A.CART_QTY                                           04680402
046798           , A.RTL_DOL_AMT                                        04680502
046799           , A.COST_DOL_AMT                                       04680602
046800           , B.BUS_AREA_ID                                        04680702
046801           , B.BUS_AREA_DESC                                      04680802
046802           , C.BRND_ID                                            04680902
046803           , C.BRND_DESC                                          04681002
046804           , A.HNG_FOLD_CDE                                       04681102
046805           , A.PRC_MSG_RPLN_NEW_IND                               04681202
046806      FROM SUT_BRND_MDSE_SUM   A                                  04681302
046807         , XLT_BUS_AREA   B                                       04681402
046808         , XLT_BRND       C                                       04681502
046809      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04681602
046810        AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     04681702
046811        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04681802
046812        AND C.BRND_ID       = A.BRND_ID                           04681902
046813      UNION ALL                                                   04682002
046814      SELECT A.TRIP_OCRNC_ID                                      04682102
046815           , A.BUS_AREA_ID                                        04682202
046816           , A.BRND_ID                                            04682302
046817           , A.UNT_QTY                                            04682402
046818           , A.SKU_QTY                                            04682502
046819           , A.CART_QTY                                           04682602
046820           , A.RTL_DOL_AMT                                        04682702
046821           , A.COST_DOL_AMT                                       04682802
046822           , B.BUS_AREA_ID                                        04682902
046823           , B.BUS_AREA_DESC                                      04683002
046824           , 32767                                                04683112
046825           , 'UNKNOWN'                                            04683202
046826           , A.HNG_FOLD_CDE                                       04683302
046827           , A.PRC_MSG_RPLN_NEW_IND                               04683402
046828      FROM SUT_BRND_MDSE_SUM   A                                  04683502
046829         , XLT_BUS_AREA   B                                       04683602
046830         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04683702
046831           AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  04683802
046832           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    04683902
046833           AND  NOT EXISTS (SELECT *                              04684002
046834                              FROM XLT_BRND  X                    04684102
046835                             WHERE A.BRND_ID = X.BRND_ID)         04684202
046836         ORDER BY 10                                              04684302
046837                , 12                                              04684402
046838                                                                  04684502
046839     END-EXEC.                                                    04684602
      *CLP 07/06/2015 END                                               04684710
                                                                        04684810
046840******************************************************************04684902
046841* BUSAREA UNIT CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA04685002
046842* SELECTED ON BUSAREA SCREEN IN UNIT SEQUENCE                     04685102
046843* FROM XLT_MDSE_PGM AND SUT_PGM_MDSE_SUM                          04685204
046845******************************************************************04685302
046846*                                                                 04685413
046847*    EXEC SQL                                                     04685513
046848*        DECLARE BUSAREA-UNIT-CSR CURSOR FOR                      04685613
046849*     SELECT A.TRIP_OCRNC_ID                                      04685713
046850*          , A.BUS_AREA_ID                                        04685813
046851*          , A.MDSE_PGM_ID                                        04685913
046852*          , A.UNT_QTY                                            04686013
046853*          , A.SKU_QTY                                            04686113
046854*          , A.CART_QTY                                           04686213
046855*          , A.RTL_DOL_AMT                                        04686313
046856*          , A.COST_DOL_AMT                                       04686413
046857*          , B.BUS_AREA_ID                                        04686513
046858*          , B.BUS_AREA_DESC                                      04686613
046859*          , C.MDSE_PGM_ID                                        04686713
046860*          , C.MDSE_PGM_DESC                                      04686813
046861*          , A.HNG_FOLD_CDE                                       04686913
046862*          , A.PRC_MSG_RPLN_NEW_IND                               04687013
046863*     FROM SUT_PGM_MDSE_SUM   A                                   04687113
046864*        , XLT_BUS_AREA   B                                       04687213
046865*        , XLT_MDSE_PGM   C                                       04687313
046866*     WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04687413
046867*       AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     04687513
046868*       AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04687613
046869*       AND C.MDSE_PGM_ID   = A.MDSE_PGM_ID                       04687713
046870*     UNION ALL                                                   04687813
046871*     SELECT A.TRIP_OCRNC_ID                                      04687913
046872*          , A.BUS_AREA_ID                                        04688013
046873*          , A.MDSE_PGM_ID                                        04688113
046874*          , A.UNT_QTY                                            04688213
046875*          , A.SKU_QTY                                            04688313
046876*          , A.CART_QTY                                           04688413
046877*          , A.RTL_DOL_AMT                                        04688513
046878*          , A.COST_DOL_AMT                                       04688613
046879*          , B.BUS_AREA_ID                                        04688713
046880*          , B.BUS_AREA_DESC                                      04688813
046881*          , 9999999999                                           04688913
046882*          , 'UNKNOWN'                                            04689013
046883*          , A.HNG_FOLD_CDE                                       04689113
046884*          , A.PRC_MSG_RPLN_NEW_IND                               04689213
046885*     FROM SUT_PGM_MDSE_SUM   A                                   04689313
046886*        , XLT_BUS_AREA   B                                       04689413
046887*        WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04689513
046888*          AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  04689613
046889*          AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    04689713
046890*          AND  NOT EXISTS (SELECT *                              04689813
046891*                             FROM XLT_MDSE_PGM  X                04689913
046892*                            WHERE A.MDSE_PGM_ID = X.MDSE_PGM_ID) 04690013
046893*        ORDER BY 4 DESC                                          04690113
046894*               , 10                                              04690213
046895*               , 12                                              04690313
046896*                                                                 04690413
046900*    END-EXEC.                                                    04691013
                                                                        04691110
      *CLP 07/06/2015 START                                             04692010
047000******************************************************************04700002
047100* BUSAREA UNIT CURSOR BRINGS BACK ALL MERCHANDISE PGMS FOR AN AREA04710002
047200* SELECTED ON BUSAREA SCREEN IN UNIT SEQUENCE                     04720002
047300* FROM XLT_BRND AND SUT_BRND_MDSE_SUM                             04730004
047400******************************************************************04740002
047500                                                                  04750002
047600     EXEC SQL                                                     04760002
047700         DECLARE BUSAREA-UNIT-B-CSR CURSOR FOR                    04770002
047800      SELECT A.TRIP_OCRNC_ID                                      04780002
047900           , A.BUS_AREA_ID                                        04790002
048000           , A.BRND_ID                                            04800002
048100           , A.UNT_QTY                                            04810002
048200           , A.SKU_QTY                                            04820002
048300           , A.CART_QTY                                           04830002
048400           , A.RTL_DOL_AMT                                        04840002
048500           , A.COST_DOL_AMT                                       04850002
048600           , B.BUS_AREA_ID                                        04860002
048700           , B.BUS_AREA_DESC                                      04870002
048800           , C.BRND_ID                                            04880002
048900           , C.BRND_DESC                                          04890002
049000           , A.HNG_FOLD_CDE                                       04900002
049100           , A.PRC_MSG_RPLN_NEW_IND                               04910002
049200      FROM SUT_BRND_MDSE_SUM   A                                  04920002
049300         , XLT_BUS_AREA   B                                       04930002
049400         , XLT_BRND       C                                       04940002
049500      WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                   04950002
049600        AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                     04960002
049700        AND B.BUS_AREA_ID   = A.BUS_AREA_ID                       04970002
049800        AND C.BRND_ID   = A.BRND_ID                               04980002
049900      UNION ALL                                                   04990002
050000      SELECT A.TRIP_OCRNC_ID                                      05000002
050100           , A.BUS_AREA_ID                                        05010002
050200           , A.BRND_ID                                            05020002
050300           , A.UNT_QTY                                            05030002
050400           , A.SKU_QTY                                            05040002
050500           , A.CART_QTY                                           05050002
050600           , A.RTL_DOL_AMT                                        05060002
050700           , A.COST_DOL_AMT                                       05070002
050800           , B.BUS_AREA_ID                                        05080002
050900           , B.BUS_AREA_DESC                                      05090002
051000           , 32767                                                05100012
051100           , 'UNKNOWN'                                            05110002
051200           , A.HNG_FOLD_CDE                                       05120002
051300           , A.PRC_MSG_RPLN_NEW_IND                               05130002
051400      FROM SUT_BRND_MDSE_SUM   A                                  05140002
051500         , XLT_BUS_AREA   B                                       05150002
051600         WHERE A.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                05160002
051700           AND B.BUS_AREA_ID   = :DK-BUS-AREA-ID                  05170002
051800           AND B.BUS_AREA_ID   = A.BUS_AREA_ID                    05180002
051900           AND  NOT EXISTS (SELECT *                              05190002
052000                              FROM XLT_BRND  X                    05200002
052100                             WHERE A.BRND_ID = X.BRND_ID)         05210002
052200         ORDER BY 4 DESC                                          05220002
052300                , 10                                              05230002
052400                , 12                                              05240002
052500                                                                  05250002
052600     END-EXEC.                                                    05260002
      *CLP 07/06/2015 END                                               05270010
053500/                                                                 05350000
053600*---------------------------------------------------------------* 05360000
053700*    DB2 AREA FOR COMMUNICATIONS                                * 05370000
053800*---------------------------------------------------------------* 05380000
053900     EXEC SQL                                                     05390000
054000          INCLUDE SQLCA                                           05400000
054100     END-EXEC.                                                    05410000
054200                                                                  05420000
054300/                                                                 05430000
054400 LINKAGE SECTION.                                                 05440000
054500                                                                  05450000
054600 01  DFHCOMMAREA.                                                 05460000
054700     05  FILLER                         OCCURS  1 TO 4072 TIMES   05470000
054800                                        DEPENDING ON EIBCALEN.    05480000
054900         10  FILLER                     PIC X.                    05490000
055000                                                                  05500000
055100 EJECT                                                            05510000
055200 PROCEDURE DIVISION.                                              05520000
055300******************************************************************05530000
055400**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **05540000
055500**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **05550000
055600**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **05560000
055700******************************************************************05570000
055800 0000-MAIN-MODULE.                                                05580000
055900     INITIALIZE DP030-CICS-API-FIELDS.                            05590000
056000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05600000
056100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05610000
056200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05620000
056300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05630000
056400     MOVE LENGTH OF SU544AI        TO DP030-MAP-LENGTH (1).       05640000
056500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05650000
056600     PERFORM 0001-CALL-CICS-ARCH-API.                             05660000
056700*                                                                 05670000
056800     PERFORM 1000-CONTROL-PROCESSING                              05680000
056900*                                                                 05690000
057000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05700000
057100     PERFORM 0001-CALL-CICS-ARCH-API.                             05710000
057200                                                                  05720000
057300******************************************************************05730000
057400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **05740000
057500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **05750000
057600******************************************************************05760000
057700 0001-CALL-CICS-ARCH-API.                                         05770000
057800*    CALL 'DPKCS030' USING DFHEIBLK                               05780016
057800     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05781016
057900                           DFHCOMMAREA                            05790000
058000                           DP030-CICS-API-FIELDS                  05800000
058100                           DP020-STANDARD-COMMAREA                05810000
058200                           SU544AI.                               05820000
058300*                                                                 05830000
058400     IF  DP030-RC-CALL-SUCCESSFUL                                 05840000
058500         CONTINUE                                                 05850000
058600     ELSE                                                         05860000
058700         SET DP013-NO-ROLLBACK                                    05870000
058800             DP013-XCTL-DISPLAY-RESTART                           05880000
058900             DP013-CICS-ABEND      TO TRUE                        05890000
059000         MOVE '0001-CALL-CICS-ARCH-API'                           05900000
059100                                   TO DP013-PARAGRAPH             05910000
059200*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05920016
059300*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      05930016
059200         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05931016
059300-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05932016
059400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05940000
059500         PERFORM DP013-0000-PROCESS-ABEND                         05950000
059600     END-IF.                                                      05960000
059700*----------------------------------------------------------------*05970000
059800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05980000
059900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05990000
060000*                                                                *06000000
060100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *06010000
060200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *06020000
060300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *06030000
060400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *06040000
060500*----------------------------------------------------------------*06050000
060600                                                                  06060000
060700 1000-CONTROL-PROCESSING.                                         06070000
060800                                                                  06080000
060900     EVALUATE TRUE                                                06090000
061000         WHEN DP020-NEXT-ACT-INITIAL                              06100000
061100             INITIALIZE ASC-SPECIFIC-COMMAREA                     06110000
061200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06120000
061300                                      ASC-SEL-TERM-ID-OUT         06130000
061400             MOVE DP020-SRC-TASK-NUMBER                           06140000
061500                                   TO ASC-LIST-TASK-NUMBER        06150000
061600                                      ASC-SEL-TASK-NUMBER-OUT     06160000
061700             MOVE PC-LIST-QUEUE-SEQ                               06170000
061800                                   TO ASC-LIST-SEQ                06180000
061900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             06190000
062000             SET PS-COMMAREA-VALID TO TRUE                        06200000
062100                                                                  06210000
062200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06220000
062300                                                                  06230000
062400             IF  PS-ERROR                                         06240000
062500                 CONTINUE                                         06250000
062600             ELSE                                                 06260000
062700                 PERFORM 4000-BUILD-INITIAL-PANEL                 06270000
062800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06280000
062900             END-IF                                               06290000
063000                                                                  06300000
063100***-----$TEMPLATE NOTE$-------------------------------------------06310000
063200*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,06320000
063300*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  06330000
063400*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.06340000
063500***---------------------------------------------------------------06350000
063600             IF  PS-COMMAREA-NOT-VALID                            06360000
063700***              MOVE PC-TSYMSG-99901                             06370000
063800***                                TO DP020-MSG-NUMBER            06380000
063900***              SET DP020-MSG-FATAL                              06390000
064000***                                TO TRUE                        06400000
064100                 SET DP020-NEXT-ACT-APPL-ERROR                    06410000
064200                                   TO TRUE                        06420000
064300             ELSE                                                 06430000
064400                 PERFORM 4000-BUILD-INITIAL-PANEL                 06440000
064500             END-IF                                               06450000
064600                                                                  06460000
064700         WHEN DP020-NEXT-ACT-READ-MAP                             06470000
064800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06480000
064900                                   TO PV-TOP-ITEM                 06490000
065000             PERFORM 2000-PROCESS-PANEL                           06500000
065010*            PERFORM 1100-PROCESS-INTER-APPL-COMM                 06501000
065020*            PERFORM 2100-CHECK-FUNCTION-KEY                      06502000
065100                                                                  06510000
065200         WHEN DP020-NEXT-ACT-RETURN                               06520000
065300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06530000
065400                                   TO PV-TOP-ITEM                 06540000
065500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06550000
065600             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 06560000
065700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06570000
065800                                                                  06580000
065900*            MOVE ASC-STR-NBR          TO SU011-CURR-OPER-UNT-ID  06590000
066000*            PERFORM 2050-DELETE-LIST-QUEUE                       06600000
066100*            PERFORM 4000-BUILD-INITIAL-PANEL                     06610000
066200                                                                  06620000
066300                                                                  06630000
066400         WHEN OTHER                                               06640000
066500             SET DP013-LOGIC-ABEND TO TRUE                        06650000
066600             SET DP013-NO-ROLLBACK TO TRUE                        06660000
066700             MOVE '1000-CONTROL-PROCESSING'                       06670000
066800                                   TO DP013-PARAGRAPH             06680000
066900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06690000
067000                                   TO DP013-MESSAGE-TEXT(1)       06700000
067100             PERFORM DP013-0000-PROCESS-ABEND                     06710000
067200     END-EVALUATE.                                                06720000
067300                                                                  06730000
067400 EJECT                                                            06740000
067500*----------------------------------------------------------------*06750000
067600* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06760000
067700* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06770000
067800*----------------------------------------------------------------*06780000
067900                                                                  06790000
068000 1100-PROCESS-INTER-APPL-COMM.                                    06800000
068100                                                                  06810000
068200     SET PS-COMMAREA-VALID         TO TRUE.                       06820000
068300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     06830000
068400     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND    06840000
068500     EVALUATE DP020-INT-APPL-FORMAT-IND                           06850000
068600                                                                  06860000
068700         WHEN PC-INTER-APPL-LIST                                  06870000
068800         WHEN PC-INTER-APPL-DEPT-LIST                             06880000
068900             SET ASC-USE-SELECTION-QUEUE TO TRUE                  06890000
069000             MOVE SU012-NUMBER-OF-SELECTED-ITEMS                  06900000
069100                                   TO ASC-NUMBER-OF-SELECTED-ITEMS06910000
069200             MOVE SU012-NUMBER-OF-TS-ITEMS                        06920000
069300                                    TO ASC-NUMBER-OF-TS-ITEMS     06930000
069400             MOVE SU012-SEL-QUEUE-NAME                            06940000
069500                                    TO ASC-SEL-QUEUE-NAME-IN      06950000
069600             MOVE SU012-STR-NBR   TO ASC-STR-NBR                  06960000
069700             MOVE SU012-STR-NAME  TO ASC-STR-NAME                 06970000
069800             MOVE SU012-SERVICING-DC TO ASC-SERVICE-DC-NAME       06980000
069810             INITIALIZE SU012-SCREEN-SEQUENCE                     06981000
069900             PERFORM 1101-SCREEN-SEQUENCE                         06990000
070000                                                                  07000000
070100             PERFORM 1120-PREPARE-LIST-ENTRY                      07010000
070200                                                                  07020000
070300         WHEN OTHER                                               07030000
070400             MOVE PC-TSYMSG-00148                                 07040000
070500                                     TO DP020-MSG-NUMBER          07050000
070600             SET DP020-MSG-FATAL                                  07060000
070700                 DP020-NEXT-ACT-APPL-ERROR                        07070000
070800                                     TO TRUE                      07080000
070900     END-EVALUATE.                                                07090000
071000 1101-SCREEN-SEQUENCE.                                            07100000
071100     EVALUATE TRUE                                                07110000
071400                                                                  07140000
071500         WHEN SU012-UNIT-SEQ                                      07150000
071600             MOVE 'UNIT SEQUENCE'       TO ASC-SEQ-DESC           07160000
071700         WHEN OTHER                                               07170000
071800*            SET SU012-DEPT-SEQ         TO TRUE                   07180000
071900             MOVE 'AREA SEQUENCE'       TO ASC-SEQ-DESC           07190000
072000     END-EVALUATE.                                                07200000
072010                                                                  07201000
072100     MOVE SU012-SCREEN-SEQUENCE TO ASC-SCREEN-SEQUENCE.           07210000
072200/                                                                 07220000
072300 1120-PREPARE-LIST-ENTRY.                                         07230000
072400     MOVE SU013-MAX-ITEMS          TO ASC-SEL-SUB.                07240000
072500     MOVE ZERO                     TO ASC-SEL-ITEM.               07250000
072600     PERFORM 2110-GET-NEXT-MESSAGE.                               07260000
072700/                                                                 07270000
072800 2110-GET-NEXT-MESSAGE.                                           07280000
072900     ADD +1                        TO ASC-SEL-SUB.                07290000
073000     IF  ASC-SEL-SUB > SU013-MAX-ITEMS                            07300000
073100         ADD +1                    TO ASC-SEL-ITEM                07310000
073200         MOVE +1                   TO ASC-SEL-SUB                 07320000
073300     END-IF.                                                      07330000
073400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07340000
073500         PERFORM 9100-READ-SEL-QUEUE                              07350000
073600         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      07360000
073700             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               07370000
073800                                   TO ASC-TRIP-OCRNC-ID           07380000
073900             MOVE SU013-BUS-GP-NBR  (ASC-SEL-SUB)                 07390000
074000                                   TO ASC-BUS-AREA-ID             07400000
074100             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                07410000
074200                                   TO ASC-TRLR-SRL-NBR            07420000
074300             MOVE SU013-SCAC (ASC-SEL-SUB)                        07430000
074400                                   TO ASC-SCAC                    07440000
074500             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     07450000
074600                                   TO ASC-TRLR-ID                 07460000
074700                                                                  07470000
074800             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     07480000
074900                                   TO DK-OTBND-TRIP-ID            07490000
075000                                      ASC-OTBND-TRIP-ID           07500000
075100                                                                  07510000
075200             MOVE SU013-TRIP-STAT-DESC (ASC-SEL-SUB)              07520000
075300                                   TO ASC-TRIP-STAT-DESC          07530000
075400             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  07540000
075500                                   TO ASC-TOTAL-CARTONS           07550000
075600             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  07560000
075700                                   TO ASC-TOTAL-UNITS             07570000
075800                                                                  07580000
075900             MOVE SU013-TRLR-SRL-NBR (SU013-IDX)                  07590000
076000                                      TO ASC-SERIAL               07600000
076100             MOVE SU013-TRIP-STAT-DESC (SU013-IDX)                07610000
076200                                      TO  ASC-TRAILER-STAT        07620000
076300             MOVE SU013-STAT-DATE (SU013-IDX) TO  ASC-STAT-DATE   07630000
076400                                                                  07640000
076500             IF ASC-SERVICE-DC-NAME = SPACES                      07650000
076600                 PERFORM 7000-SELECT-SERVICING-DC                 07660000
076700             END-IF                                               07670000
076800             MOVE ASC-SERVICE-DC-NAME TO AOPERO                   07680000
076900                                         SU012-SERVICING-DC       07690000
077000                                                                  07700000
077100             PERFORM 7001-CONVERT-DATES                           07710000
077200             MOVE ASC-SUMMARY-DATE TO ASUMDTEO                    07720000
077300             MOVE ASC-SUMMARY-TIME TO ASUMTMEO                    07730000
077400                                                                  07740000
077500             SET SU013-INQ (ASC-SEL-SUB)                          07750000
077600                                   TO TRUE                        07760000
077700             PERFORM 9200-REWRITE-LIST-QUEUE                      07770000
077800         ELSE                                                     07780000
077900             SUBTRACT +1 FROM ASC-SEL-SUB                         07790000
078000*            --- BOTTOM OF LIST ---                               07800000
078100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07810000
078200             SET DP020-MSG-INFORMATIONAL                          07820000
078300                                   TO TRUE                        07830000
078400         END-IF                                                   07840000
078500     ELSE                                                         07850000
078600         SUBTRACT +1 FROM ASC-SEL-ITEM                            07860000
078700         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 07870000
078800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07880000
078900         SET DP020-MSG-INFORMATIONAL                              07890000
079000                                   TO TRUE                        07900000
079100     END-IF.                                                      07910000
079200                                                                  07920000
079300 2120-GET-PREV-MESSAGE.                                           07930000
079400     SUBTRACT +1                   FROM ASC-SEL-SUB.              07940000
079500     IF  ASC-SEL-SUB < 1                                          07950000
079600         SUBTRACT 1                FROM ASC-SEL-ITEM              07960000
079700         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 07970000
079800     END-IF.                                                      07980000
079900     IF  ASC-SEL-ITEM  > ZERO                                     07990000
080000         PERFORM 9100-READ-SEL-QUEUE                              08000000
080100         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      08010000
080200             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               08020000
080300                                   TO ASC-TRIP-OCRNC-ID           08030000
080400             MOVE SU013-BUS-GP-NBR  (ASC-SEL-SUB)                 08040000
080500                                   TO ASC-BUS-AREA-ID             08050000
080600             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                08060000
080700                                   TO ASC-TRLR-SRL-NBR            08070000
080800             MOVE SU013-SCAC (ASC-SEL-SUB)                        08080000
080900                                   TO ASC-SCAC                    08090000
081000             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     08100000
081100                                   TO ASC-TRLR-ID                 08110000
081200                                                                  08120000
081300             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     08130000
081400                                   TO DK-OTBND-TRIP-ID            08140000
081500                                      ASC-OTBND-TRIP-ID           08150000
081600                                                                  08160000
081700             MOVE SU013-TRIP-STAT-DESC (ASC-SEL-SUB)              08170000
081800                                   TO ASC-TRIP-STAT-DESC          08180000
081900             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  08190000
082000                                   TO ASC-TOTAL-CARTONS           08200000
082100             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  08210000
082200                                   TO ASC-TOTAL-UNITS             08220000
082300                                                                  08230000
082400             MOVE SU013-TRLR-SRL-NBR (SU013-IDX)                  08240000
082500                                      TO ASC-SERIAL               08250000
082600             MOVE SU013-TRIP-STAT-DESC (SU013-IDX)                08260000
082700                                      TO  ASC-TRAILER-STAT        08270000
082800             MOVE SU013-STAT-DATE (SU013-IDX) TO  ASC-STAT-DATE   08280000
082900                                                                  08290000
083000             PERFORM 7000-SELECT-SERVICING-DC                     08300000
083100             MOVE ASC-SERVICE-DC-NAME TO AOPERO                   08310000
083200                                         SU012-SERVICING-DC       08320000
083300                                                                  08330000
083400             PERFORM 7001-CONVERT-DATES                           08340000
083500             MOVE ASC-SUMMARY-DATE TO ASUMDTEO                    08350000
083600             MOVE ASC-SUMMARY-TIME TO ASUMTMEO                    08360000
083700                                                                  08370000
083800             SET SU013-INQ (ASC-SEL-SUB)                          08380000
083900                                   TO TRUE                        08390000
084000             PERFORM 9200-REWRITE-LIST-QUEUE                      08400000
084100         ELSE                                                     08410000
084200             MOVE +1               TO ASC-SEL-ITEM                08420000
084300                                      ASC-SEL-SUB                 08430000
084400*            --- TOP OF LIST ---                                  08440000
084500             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            08450000
084600             SET DP020-MSG-INFORMATIONAL                          08460000
084700                                   TO TRUE                        08470000
084800         END-IF                                                   08480000
084900     END-IF.                                                      08490000
085000*----------------------------------------------------------------*08500000
085100* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08510000
085200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08520000
085300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08530000
085400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08540000
085500* FUNCTION KEYS CAN GET THIS FAR.                                *08550000
085600*----------------------------------------------------------------*08560000
085700                                                                  08570000
085800 2000-PROCESS-PANEL.                                              08580000
085900     SET PS-NEXT-SCREEN TO TRUE.                                  08590000
086000     EVALUATE TRUE                                                08600000
086100         WHEN DP020-SRC-AID = DP016-CLEAR                         08610000
086200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08620000
086300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08630000
086400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08640000
086500                                                                  08650000
086600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08660000
086610             MOVE SPACES TO ASC-PRINTER-DEST                      08661000
086700             PERFORM 2050-DELETE-LIST-QUEUE                       08670000
086800             PERFORM 4000-BUILD-INITIAL-PANEL                     08680000
086900                                                                  08690000
087000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    08700000
087100             PERFORM 2140-DESELECT-ALL-ITEMS                      08710000
087200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08720000
087300                                                                  08730000
087400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  08740000
087500             PERFORM 2150-SELECT-ALL-ITEMS                        08750000
087600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08760000
087700                                                                  08770000
087800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08780000
087900                                                                  08790000
088000             IF ASC-USE-SELECTION-QUEUE                           08800000
088100                 PERFORM 2110-GET-NEXT-MESSAGE                    08810000
088200                 IF PS-LIST-END                                   08820000
088300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08830000
088400                     SET PS-NO-LIST-END TO TRUE                   08840000
088500                 ELSE                                             08850000
088600                     PERFORM 2050-DELETE-LIST-QUEUE               08860000
088700                     PERFORM 3200-RESET-ATTRIBUTES                08870000
088800                     PERFORM 4000-BUILD-INITIAL-PANEL             08880000
088900                 END-IF                                           08890000
089000               ELSE                                               08900000
089100*            --- BOTTOM OF LIST ---                               08910000
089200                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         08920000
089300                 SET DP020-MSG-INFORMATIONAL TO TRUE              08930000
089400                 SET PS-LIST-END      TO TRUE                     08940000
089500             END-IF                                               08950000
089600                                                                  08960000
089700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08970000
089800                                                                  08980000
089900             EVALUATE TRUE                                        08990000
090000                 WHEN PS-LIST-END                                 09000000
090100*                    --- TOP OF LIST ---                          09010000
090200                     MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER09020000
090300                     SET DP020-MSG-INFORMATIONAL                  09030000
090400                         DP030-SET-CURSOR-APPL-1                  09040000
090500                                   TO TRUE                        09050000
090600                     MOVE -1       TO MR-SELECTL (1)              09060000
090700                 WHEN ASC-SEL-ITEM = ZERO                         09070000
090800                     MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER    09080000
090900                     SET DP020-MSG-INFORMATIONAL                  09090000
091000                         DP030-SET-CURSOR-APPL-1                  09100000
091100                                   TO TRUE                        09110000
091200                     MOVE -1       TO MR-SELECTL (1)              09120000
091300                 WHEN ASC-SEL-ITEM >  ZERO                        09130000
091400                     PERFORM 2120-GET-PREV-MESSAGE                09140000
091500                     IF ASC-SEL-ITEM >  ZERO                      09150000
091600                         PERFORM 2050-DELETE-LIST-QUEUE           09160000
091700                         PERFORM 3200-RESET-ATTRIBUTES            09170000
091800                         PERFORM 4000-BUILD-INITIAL-PANEL         09180000
091900                     ELSE                                         09190000
092000                         MOVE PC-TSYMSG-00069                     09200000
092100                                           TO DP020-MSG-NUMBER    09210000
092200                         SET DP020-MSG-INFORMATIONAL              09220000
092300                             DP030-SET-CURSOR-APPL-1              09230000
092400                                           TO TRUE                09240000
092500                         MOVE -1   TO MR-SELECTL (1)              09250000
092600                     END-IF                                       09260000
092700             END-EVALUATE                                         09270000
092800                                                                  09280000
092900         WHEN OTHER                                               09290000
093000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09300000
093100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09310000
093200             IF  PS-NO-ERROR                                      09320000
093300                 SET DP030-CONTINUE-GO                            09330000
093400                                 TO TRUE                          09340000
093500                 PERFORM 2100-CHECK-FUNCTION-KEY                  09350000
093600             ELSE                                                 09360000
093700                 SET DP030-OVERRIDE-GO                            09370000
093800                                 TO TRUE                          09380000
093900             END-IF                                               09390000
094000     END-EVALUATE.                                                09400000
094100 EJECT                                                            09410000
094200*----------------------------------------------------------------*09420000
094300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09430000
094400*----------------------------------------------------------------*09440000
094500 2050-DELETE-LIST-QUEUE.                                          09450000
094600                                                                  09460000
094700     EXEC CICS                                                    09470000
094800         DELETEQ TS                                               09480000
094900             QUEUE (ASC-LIST-QUEUE-NAME)                          09490000
095000             RESP  (PV-CICS-RESP)                                 09500000
095100     END-EXEC.                                                    09510000
095200                                                                  09520000
095300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09530000
095400        (PV-CICS-RESP = DFHRESP(QIDERR))                          09540000
095500         CONTINUE                                                 09550000
095600     ELSE                                                         09560000
095700         SET DP013-CICS-ABEND      TO TRUE                        09570000
095800         SET DP013-NO-ROLLBACK     TO TRUE                        09580000
095900                                                                  09590000
096000         MOVE '2050-DELETE-LIST-QUEUE'                            09600000
096100                                   TO DP013-PARAGRAPH             09610000
096200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09620000
096300                                   TO DP013-MESSAGE-TEXT (1)      09630000
096400         PERFORM DP013-0000-PROCESS-ABEND                         09640000
096500     END-IF.                                                      09650000
096600                                                                  09660000
096700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  09670000
096800/                                                                 09680000
096900*----------------------------------------------------------------*09690000
097000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09700000
097100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09710000
097200* CICS ARCHITECTURE API.                                         *09720000
097300*----------------------------------------------------------------*09730000
097400 2100-CHECK-FUNCTION-KEY.                                         09740000
097500     SET PS-NEXT-SCREEN TO TRUE.                                  09750000
097600     EVALUATE TRUE                                                09760000
097700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09770000
097800             PERFORM 2050-DELETE-LIST-QUEUE                       09780000
097900             SET ASC-UNIT-SEQ                                     09790000
098000                 SU012-UNIT-SEQ TO TRUE                           09800000
098100             PERFORM 1101-SCREEN-SEQUENCE                         09810000
098200             PERFORM 4000-BUILD-INITIAL-PANEL                     09820000
098300                                                                  09830000
098400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09840000
098500             PERFORM 2050-DELETE-LIST-QUEUE                       09850000
098600             SET ASC-AREA-SEQ                                     09860000
098700                 SU012-DEPT-SEQ TO TRUE                           09870000
098800             PERFORM 1101-SCREEN-SEQUENCE                         09880000
098900             PERFORM 4000-BUILD-INITIAL-PANEL                     09890000
099000                                                                  09900000
099010         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09901000
099020             PERFORM 2400-CHECK-PRINTER-ID                        09902000
099030             IF PS-NO-ERROR                                       09903000
099040                PERFORM 2300-PREPARE-INTER-APPL-COMM              09904000
099050                PERFORM 7100-START-TRANID-S547                    09905000
099060                MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER          09906000
099070                SET DP020-MSG-INFORMATIONAL TO TRUE               09907000
099080             END-IF                                               09908000
099090                                                                  09909000
099100         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  09910000
099200*        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09920000
099300             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              09930000
099400                 INITIALIZE SU012-INTER-APPL-COMMAREA             09940000
099500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09950000
099600                                TO SU012-NUMBER-OF-SELECTED-ITEMS 09960000
099700                 MOVE ASC-STR-NBR      TO SU012-STR-NBR           09970000
099800                 MOVE ASC-STR-NAME     TO SU012-STR-NAME          09980000
099900                 MOVE ASC-SUMMARY-DATE TO SU012-SUMMARY-DATE      09990000
100000                 MOVE ASC-SUMMARY-TIME TO SU012-SUMMARY-TIME      10000000
100100                 MOVE ASC-SERVICE-DC-NAME TO                      10010000
100200                                          SU012-SERVICING-DC      10020000
100300                 MOVE ASC-SCREEN-SEQUENCE TO                      10030000
100400                                          SU012-SCREEN-SEQUENCE   10040000
100500                 PERFORM 5000-PREPARE-SEL-QUEUE                   10050000
100600             ELSE                                                 10060000
100700                 SET DP030-OVERRIDE-GO                            10070000
100800                                   TO TRUE                        10080000
100900                 MOVE PC-TSYMSG-00057                             10090000
101000                                   TO DP020-MSG-NUMBER            10100000
101100                 SET DP020-MSG-WARNING                            10110000
101200                                   TO TRUE                        10120000
101300                 MOVE -1           TO MR-SELECTL(1)               10130000
101400                 SET DP030-SET-CURSOR-APPL-1                      10140000
101500                                   TO TRUE                        10150000
101600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10160000
101700             END-IF                                               10170000
101800                                                                  10180000
101900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10190000
102000             MOVE +1               TO PV-TOP-ITEM                 10200000
102100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10210000
102200                                                                  10220000
102300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10230000
102400             PERFORM 2110-BROWSE-BACKWARD                         10240000
102500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10250000
102600                                                                  10260000
102700         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10270000
102800             PERFORM 2120-BROWSE-FORWARD                          10280000
102900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10290000
103000                                                                  10300000
103100         WHEN DP020-SRC-AID = DP016-ENTER                         10310000
103200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10320000
103300             IF  PS-ERROR                                         10330000
103400                 CONTINUE                                         10340000
103500             ELSE                                                 10350000
103600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10360000
103700             END-IF                                               10370000
103800                                                                  10380000
103900         WHEN OTHER                                               10390000
104000             SET DP013-NO-ROLLBACK                                10400000
104100                 DP013-XCTL-DISPLAY-RESTART                       10410000
104200                 DP013-CICS-ABEND  TO TRUE                        10420000
104300             MOVE '2100-CHECK-FUNCTION-KEY'                       10430000
104400                                   TO DP013-PARAGRAPH             10440000
104500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10450000
104600                                   TO DP013-MESSAGE-TEXT (1)      10460000
104700             PERFORM DP013-0000-PROCESS-ABEND                     10470000
104800     END-EVALUATE.                                                10480000
104900*                                                                 10490000
105000*----------------------------------------------------------------*10500000
105100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10510000
105200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10520000
105300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10530000
105400*    MESSAGE.                                                    *10540000
105500*----------------------------------------------------------------*10550000
105600                                                                  10560000
105700 2110-BROWSE-BACKWARD.                                            10570000
105800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10580000
105900         GIVING PV-TOP-ITEM.                                      10590000
106000*                                                                 10600000
106100     IF  ((PV-TOP-ITEM < +1)                                      10610000
106200       OR (PV-TOP-ITEM = +1))                                     10620000
106300         MOVE +1                   TO PV-TOP-ITEM                 10630000
106400*        -- TOP OF LIST --                                        10640000
106500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10650000
106600         SET DP020-MSG-INFORMATIONAL TO TRUE                      10660000
106700     END-IF.                                                      10670000
106800                                                                  10680000
106900 EJECT                                                            10690000
107000*----------------------------------------------------------------*10700000
107100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10710000
107200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *10720000
107300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *10730000
107400*----------------------------------------------------------------*10740000
107500                                                                  10750000
107600 2120-BROWSE-FORWARD.                                             10760000
107700                                                                  10770000
107800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10780000
107900         GIVING PV-TOP-ITEM.                                      10790000
108000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   10800000
108100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10810000
108200                                   TO PV-TOP-ITEM                 10820000
108300*        -- BOTTOM OF LIST --                                     10830000
108400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10840000
108500         SET DP020-MSG-INFORMATIONAL                              10850000
108600                                   TO TRUE                        10860000
108700     ELSE                                                         10870000
108800         COMPUTE PV-BOTTOM-ITEM =                                 10880000
108900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 10890000
109000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            10900000
109100*            -- BOTTOM OF LIST --                                 10910000
109200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10920000
109300             SET DP020-MSG-INFORMATIONAL                          10930000
109400                                   TO TRUE                        10940000
109500         END-IF                                                   10950000
109600     END-IF.                                                      10960000
109700 EJECT                                                            10970000
109800*----------------------------------------------------------------*10980000
109900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *10990000
110000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11000000
110100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11010000
110200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11020000
110300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11030000
110400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11040000
110500*----------------------------------------------------------------*11050000
110600                                                                  11060000
110700 2130-CHECK-FOR-JUMP-BROWSE.                                      11070000
110800     SET PS-NO-ERROR               TO TRUE.                       11080000
110900     IF (ASC-START-ITEM-REQUEST = SPACE)                          11090000
111000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11100000
111100                                   TO PV-TOP-ITEM                 11110000
111200     ELSE                                                         11120000
111300         MOVE ASC-START-ITEM-REQUEST                              11130000
111400                                   TO DP010I-UNEDITED-FIELD       11140000
111500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11150000
111600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11160000
111700         SET DP010I-NEGATIVE-NOT-ALLOWED                          11170000
111800                                   TO TRUE                        11180000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11191015
263968              USING DP010I-NUMERIC-EDIT-AREA                      11192015
112000                                                                  11200000
112100         IF  NOT DP010I-ERROR-DETECTED                            11210000
112200             MOVE DP010I-NUMERIC-FIELD                            11220000
112300                                   TO  ASC-START-ITEM-REQUEST-N   11230000
112400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11240000
112500                 IF  ASC-START-ITEM-REQUEST-N >                   11250000
112600                                          ASC-NUMBER-OF-ITEMS-READ11260000
112700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11270000
112800                     COMPUTE PV-TOP-ITEM =                        11280000
112900                             ASC-NUMBER-OF-ITEMS-READ             11290000
113000                             - PC-ITEMS-PER-PANEL + 1             11300000
113100                     IF  PV-TOP-ITEM < +1                         11310000
113200                         MOVE +1   TO PV-TOP-ITEM                 11320000
113300                         MOVE PC-TSYMSG-00070                     11330000
113400                                   TO DP020-MSG-NUMBER            11340000
113500                         SET DP020-MSG-INFORMATIONAL              11350000
113600                                   TO TRUE                        11360000
113700                     END-IF                                       11370000
113800                 ELSE                                             11380000
113900                     MOVE ASC-START-ITEM-REQUEST-N                11390000
114000                                   TO PV-TOP-ITEM                 11400000
114100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11410000
114200                     COMPUTE PV-BOTTOM-ITEM =                     11420000
114300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11430000
114400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11440000
114500*                        -- BOTTOM OF LIST --                     11450000
114600                         MOVE PC-TSYMSG-00070                     11460000
114700                                   TO DP020-MSG-NUMBER            11470000
114800                         SET DP020-MSG-INFORMATIONAL              11480000
114900                                   TO TRUE                        11490000
115000                     END-IF                                       11500000
115100                 END-IF                                           11510000
115200             ELSE                                                 11520000
115300*                --- VALUE OUT OF RANGE ----                      11530000
115400                 MOVE PC-TSYMSG-00101                             11540000
115500                                   TO DP020-MSG-NUMBER            11550000
115600                 MOVE -1           TO ASTRTITL                    11560000
115700                 SET DP030-SET-CURSOR-APPL-1                      11570000
115800                                   TO TRUE                        11580000
115900                 MOVE DP015-REVERSE                               11590000
116000                                   TO ASTRTITH                    11600000
116100                 MOVE DP015-RED    TO ASTRTITC                    11610000
116200                 MOVE DP015-UNP-NUM-BRT-MDT                       11620000
116300                                   TO ASTRTITA                    11630000
116400                 SET DP020-MSG-FATAL                              11640000
116500                                   TO TRUE                        11650000
116600                 SET PS-ERROR      TO TRUE                        11660000
116700             END-IF                                               11670000
116800                                                                  11680000
116900         ELSE                                                     11690000
117000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11700000
117100             MOVE -1               TO ASTRTITL                    11710000
117200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11720000
117300             MOVE DP015-REVERSE    TO ASTRTITH                    11730000
117400             MOVE DP015-RED        TO ASTRTITC                    11740000
117500             MOVE DP015-UNP-NUM-BRT-MDT                           11750000
117600                                   TO ASTRTITA                    11760000
117700             SET DP020-MSG-FATAL   TO TRUE                        11770000
117800             SET PS-ERROR          TO TRUE                        11780000
117900         END-IF                                                   11790000
118000     END-IF.                                                      11800000
118100 EJECT                                                            11810000
118200*----------------------------------------------------------------*11820000
118300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *11830000
118400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *11840000
118500*----------------------------------------------------------------*11850000
118600 2140-DESELECT-ALL-ITEMS.                                         11860000
118700     MOVE +1                       TO ASC-BLK-SUB.                11870000
118800                                                                  11880000
118900     PERFORM 2141-CLEAR-SELECTED-INDS                             11890000
119000         VARYING ASC-ITEM-SUB                                     11900000
119100         FROM 1 BY 1                                              11910000
119200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11920000
119300                                                                  11930000
119400     ADD +1                        TO ASC-BLK-SUB.                11940000
119500                                                                  11950000
119600     PERFORM 2141-CLEAR-SELECTED-INDS                             11960000
119700         VARYING ASC-ITEM-SUB                                     11970000
119800         FROM 1 BY 1                                              11980000
119900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11990000
120000                                                                  12000000
120100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12010000
120200                                   TO PV-LIST-ITEM-NUMBER.        12020000
120300                                                                  12030000
120400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12040000
120500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12050000
120600                                                                  12060000
120700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12070000
120800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12080000
120900         MOVE +1                   TO ASC-BLK-SUB                 12090000
121000                                                                  12100000
121100         PERFORM 5100-WRITE-TEMP-STORAGE                          12110000
121200                                                                  12120000
121300         MOVE +1                   TO PV-BLOCK-NUMBER             12130000
121400                                                                  12140000
121500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12150000
121600             PV-FIRST-BLOCK-IN-ARRAY - 1                          12160000
121700                                                                  12170000
121800         PERFORM                                                  12180000
121900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12190000
122000                                                                  12200000
122100             PERFORM 4410-READ-TEMP-STORAGE                       12210000
122200                                                                  12220000
122300             PERFORM 2141-CLEAR-SELECTED-INDS                     12230000
122400                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12240000
122500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12250000
122600                                                                  12260000
122700             PERFORM 5100-WRITE-TEMP-STORAGE                      12270000
122800                                                                  12280000
122900             ADD +1                TO PV-BLOCK-NUMBER             12290000
123000                                                                  12300000
123100         END-PERFORM                                              12310000
123200                                                                  12320000
123300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12330000
123400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12340000
123500                                                                  12350000
123600         PERFORM                                                  12360000
123700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12370000
123800                   ASC-HIGHEST-BLOCK-WRITTEN                      12380000
123900                                                                  12390000
124000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12400000
124100                                   TO PV-BLOCK-NUMBER             12410000
124200                                                                  12420000
124300             PERFORM 4410-READ-TEMP-STORAGE                       12430000
124400                                                                  12440000
124500             PERFORM 2141-CLEAR-SELECTED-INDS                     12450000
124600                 VARYING ASC-ITEM-SUB                             12460000
124700                 FROM 1 BY 1                                      12470000
124800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12480000
124900                                                                  12490000
125000             PERFORM 5100-WRITE-TEMP-STORAGE                      12500000
125100                                                                  12510000
125200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12520000
125300                                                                  12530000
125400         END-PERFORM                                              12540000
125500                                                                  12550000
125600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12560000
125700                                   TO PV-BLOCK-NUMBER             12570000
125800                                                                  12580000
125900         PERFORM 4410-READ-TEMP-STORAGE                           12590000
126000     END-IF.                                                      12600000
126100                                                                  12610000
126200                                                                  12620000
126300     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 12630000
126400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.12640000
126500     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  12650000
126600                                                                  12660000
126700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12670000
126800                                                                  12680000
126900 EJECT                                                            12690000
127000*----------------------------------------------------------------*12700000
127100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *12710000
127200*----------------------------------------------------------------*12720000
127300                                                                  12730000
127400 2141-CLEAR-SELECTED-INDS.                                        12740000
127500                                                                  12750000
127600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12760000
127700             NOT EQUAL ZERO                                       12770000
127800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12780000
127900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12790000
128000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    12800000
128100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12810000
128200                                   TO TRUE                        12820000
128300         END-IF                                                   12830000
128400     END-IF.                                                      12840000
128500                                                                  12850000
128600/                                                                 12860000
128700*----------------------------------------------------------------*12870000
128800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *12880000
128900*  FOR ALL ITEMS.                                                *12890000
129000*----------------------------------------------------------------*12900000
129100                                                                  12910000
129200 2150-SELECT-ALL-ITEMS.                                           12920000
129300                                                                  12930000
129400     MOVE +1                       TO ASC-BLK-SUB.                12940000
129500                                                                  12950000
129600     PERFORM 2151-SET-SELECTED-INDS                               12960000
129700         VARYING ASC-ITEM-SUB                                     12970000
129800         FROM 1 BY 1                                              12980000
129900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12990000
130000                                                                  13000000
130100     ADD +1                        TO ASC-BLK-SUB.                13010000
130200                                                                  13020000
130300     PERFORM 2151-SET-SELECTED-INDS                               13030000
130400         VARYING ASC-ITEM-SUB                                     13040000
130500         FROM 1 BY 1                                              13050000
130600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13060000
130700                                                                  13070000
130800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13080000
130900                                   TO PV-LIST-ITEM-NUMBER.        13090000
131000                                                                  13100000
131100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13110000
131200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13120000
131300                                                                  13130000
131400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13140000
131500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13150000
131600         MOVE +1                   TO ASC-BLK-SUB                 13160000
131700                                                                  13170000
131800         PERFORM 5100-WRITE-TEMP-STORAGE                          13180000
131900                                                                  13190000
132000         MOVE +1                   TO PV-BLOCK-NUMBER             13200000
132100                                                                  13210000
132200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13220000
132300             PV-FIRST-BLOCK-IN-ARRAY - 1                          13230000
132400                                                                  13240000
132500         PERFORM                                                  13250000
132600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13260000
132700                                                                  13270000
132800             PERFORM 4410-READ-TEMP-STORAGE                       13280000
132900                                                                  13290000
133000             PERFORM 2151-SET-SELECTED-INDS                       13300000
133100                 VARYING ASC-ITEM-SUB                             13310000
133200                 FROM 1 BY 1                                      13320000
133300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13330000
133400                                                                  13340000
133500             PERFORM 5100-WRITE-TEMP-STORAGE                      13350000
133600                                                                  13360000
133700             ADD +1                TO PV-BLOCK-NUMBER             13370000
133800                                                                  13380000
133900         END-PERFORM                                              13390000
134000                                                                  13400000
134100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13410000
134200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13420000
134300                                                                  13430000
134400         PERFORM                                                  13440000
134500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13450000
134600                   ASC-HIGHEST-BLOCK-WRITTEN                      13460000
134700                                                                  13470000
134800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13480000
134900                                   TO PV-BLOCK-NUMBER             13490000
135000                                                                  13500000
135100             PERFORM 4410-READ-TEMP-STORAGE                       13510000
135200                                                                  13520000
135300             PERFORM 2151-SET-SELECTED-INDS                       13530000
135400                 VARYING ASC-ITEM-SUB                             13540000
135500                 FROM 1 BY 1                                      13550000
135600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13560000
135700                                                                  13570000
135800             PERFORM 5100-WRITE-TEMP-STORAGE                      13580000
135900                                                                  13590000
136000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13600000
136100                                                                  13610000
136200         END-PERFORM                                              13620000
136300                                                                  13630000
136400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13640000
136500                                   TO PV-BLOCK-NUMBER             13650000
136600                                                                  13660000
136700         PERFORM 4410-READ-TEMP-STORAGE                           13670000
136800     END-IF.                                                      13680000
136900                                                                  13690000
137000                                                                  13700000
137100     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             13710000
137200                       ASC-NUMBER-OF-SELECTED-ITEMS.              13720000
137300                                                                  13730000
137400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13740000
137500                                                                  13750000
137600 EJECT                                                            13760000
137700*----------------------------------------------------------------*13770000
137800*    MARK EACH ITEM AS BEING SELECTED.                           *13780000
137900*----------------------------------------------------------------*13790000
138000                                                                  13800000
138100 2151-SET-SELECTED-INDS.                                          13810000
138200                                                                  13820000
138300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13830000
138400             NOT EQUAL ZERO                                       13840000
138500         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13850000
138600             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13860000
138700                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        13870000
138800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13880000
138900                               TO  TRUE                           13890000
139000         END-IF                                                   13900000
139100     END-IF.                                                      13910000
139200******************************************************************13920000
139300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13930000
139400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13940000
139500******************************************************************13950000
139600 2200-MOVE-SCREEN-TO-COMMAREA.                                    13960000
139700                                                                  13970000
139800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             13980000
139900     MOVE +1                       TO PV-SUB.                     13990000
140000*                                                                 14000000
140100     PERFORM 3100-SET-SUBSCRIPTS.                                 14010000
140200     IF  ASTRTITL > ZERO                                          14020000
140300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14030000
140400     ELSE                                                         14040000
140500         IF  ASTRTITF = DP015-ERASE-EOF                           14050000
140600             INITIALIZE ASC-START-ITEM-REQUEST                    14060000
140700         END-IF                                                   14070000
140800     END-IF.                                                      14080000
140810     IF  APRTIDL > ZERO                                           14081000
140820         MOVE APRTIDI          TO ASC-PRINTER-DEST                14082000
140830     ELSE                                                         14083000
140840         IF  APRTIDF = DP015-ERASE-EOF                            14084000
140850             MOVE  SPACES      TO ASC-PRINTER-DEST                14085000
140860         END-IF                                                   14086000
140870     END-IF.                                                      14087000
140880                                                                  14088000
140900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14090000
141000         VARYING PV-SUB                                           14100000
141100         FROM 1 BY 1                                              14110000
141200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14120000
141300******************************************************************14130000
141400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**14140000
141500******************************************************************14150000
141600 2210-MOVE-LINES-TO-COMMAREA.                                     14160000
141700     IF  MR-SELECTL (PV-SUB) > ZERO                               14170000
141800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             14180000
141900         MOVE MR-SELECTI (PV-SUB)                                 14190000
142000                                   TO ASC-TEMP-SELECTED-SW        14200000
142100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14210000
142200     ELSE                                                         14220000
142300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                14230000
142400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     14240000
142500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        14250000
142600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14260000
142700         END-IF                                                   14270000
142800     END-IF.                                                      14280000
142900     ADD +1                        TO ASC-ITEM-SUB.               14290000
143000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        14300000
143100         ADD +1                    TO ASC-BLK-SUB                 14310000
143200         MOVE +1                   TO ASC-ITEM-SUB                14320000
143300     END-IF.                                                      14330000
143301/                                                                 14330100
143302******************************************************************14330200
143303** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **14330300
143304** INTER-APPLICATION COMMAREA.                                  **14330400
143305******************************************************************14330500
143306 2300-PREPARE-INTER-APPL-COMM.                                    14330600
143307     MOVE DK-PRINTER-DEST       TO SU083-PRINTER-ID.              14330700
143308     MOVE ASC-TRIP-OCRNC-ID     TO SU083-TRIP-OCRNC-ID.           14330800
143309     IF ASC-BUSAREA-LIST                                          14330900
143310        MOVE ASC-BUS-AREA-ID    TO SU083-BUS-AREA-ID              14331000
143311     ELSE                                                         14331100
143312        MOVE ZERO               TO SU083-BUS-AREA-ID              14331200
143313     END-IF.                                                      14331300
143314     MOVE ASC-STR-NBR           TO SU083-STR-NBR.                 14331400
143315     MOVE ASC-STR-NAME          TO SU083-STR-NAME.                14331500
143316     MOVE ASC-SEQ-DESC          TO SU083-SCREEN-SEQUENCE.         14331600
143317     MOVE ASC-SCAC              TO SU083-SCAC.                    14331700
143318     MOVE ASC-TRLR-SRL-NBR      TO SU083-TRLR-SRL-NBR.            14331800
143319     MOVE ASC-TRLR-ID           TO SU083-TRLR-ID.                 14331900
143320     MOVE ASC-TRIP-STAT-DESC    TO SU083-TRLR-STATUS.             14332000
143321     MOVE ASC-TOTAL-CARTONS     TO SU083-TOTAL-CTNS.              14332100
143322     MOVE ASC-TOTAL-UNITS       TO SU083-TOTAL-UNITS.             14332200
143323     MOVE ASC-SERVICE-DC-NAME   TO SU083-SERVICING-DC.            14332300
143324     MOVE ASC-SUMMARY-DATE      TO SU083-SUMMARY-DATE.            14332400
143325     MOVE ASC-SUMMARY-TIME      TO SU083-SUMMARY-TIME.            14332500
143326                                                                  14332600
143327******************************************************************14332700
143328 2400-CHECK-PRINTER-ID.                                           14332800
143330                                                                  14333000
143340     IF  APRTIDL > ZERO                                           14334000
143350         MOVE APRTIDI              TO ASC-PRINTER-DEST            14335000
143360                                      DK-PRINTER-DEST             14336000
143370     ELSE                                                         14337000
143380         IF  APRTIDF = DP015-ERASE-EOF                            14338000
143390             MOVE SPACE            TO ASC-PRINTER-DEST            14339000
143391                                      DK-PRINTER-DEST             14339100
143392         END-IF                                                   14339200
143393     END-IF.                                                      14339300
143394                                                                  14339400
143395     EVALUATE TRUE                                                14339500
143396         WHEN DK-PRINTER-DEST    = SPACES                         14339600
143397             SET PS-ERROR                                         14339700
143398                 DP020-MSG-FATAL  TO TRUE                         14339800
143399             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             14339900
143400             MOVE DP015-UNP-ALP-BRT-MDT                           14340000
143401                                  TO APRTIDA                      14340100
143402             MOVE DP015-RED       TO APRTIDC                      14340200
143403             MOVE DP015-REVERSE   TO APRTIDH                      14340300
143404             MOVE -1              TO APRTIDL                      14340400
143405             SET DP030-SET-CURSOR-APPL-1                          14340500
143406                                  TO TRUE                         14340600
143407         WHEN DK-PRINTER-DEST   > SPACES                          14340700
143446             IF (DK-PRINTER-DEST-1 = 'U' AND                      14344600
143447                 DP020-LOCATION-NBR = 090) OR                     14344700
143448                 DK-PRINTER-DEST-1  = 'S'                         14344800
143449                   CONTINUE                                       14344900
143450             ELSE                                                 14345000
143451                IF DK-PRINTER-DEST-1 = 'U'                        14345100
143452                  PERFORM 2500-VALIDATE-PRINTER                   14345200
143453                  IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'      14345300
143454                      CONTINUE                                    14345400
143455                  ELSE                                            14345500
143456                    SET PS-ERROR                                  14345600
143457                        DP020-MSG-FATAL  TO TRUE                  14345700
143458                        MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER  14345800
143459                        MOVE DP015-UNP-ALP-BRT-MDT                14345900
143460                                             TO APRTIDA           14346000
143461                        MOVE DP015-RED       TO APRTIDC           14346100
143462                        MOVE DP015-REVERSE   TO APRTIDH           14346200
143463                        MOVE -1              TO APRTIDL           14346300
143464                        MOVE SPACE           TO ASC-PRINTER-DEST  14346400
143465                        SET DP030-SET-CURSOR-APPL-1               14346500
143466                                           TO TRUE                14346600
143467                  END-IF                                          14346700
143468                ELSE                                              14346800
143469                  SET PS-ERROR                                    14346900
143470                      DP020-MSG-FATAL  TO TRUE                    14347000
143471                  MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER        14347100
143472                  MOVE DP015-UNP-ALP-BRT-MDT                      14347200
143473                                       TO APRTIDA                 14347300
143474                  MOVE DP015-RED       TO APRTIDC                 14347400
143475                  MOVE DP015-REVERSE   TO APRTIDH                 14347500
143476                  MOVE -1              TO APRTIDL                 14347600
143477                  SET DP030-SET-CURSOR-APPL-1                     14347700
143478                                       TO TRUE                    14347800
143479                END-IF                                            14347900
143480             END-IF                                               14348000
143481         WHEN OTHER                                               14348100
143482                  SET PS-ERROR                                    14348200
143483                      DP020-MSG-FATAL  TO TRUE                    14348300
143484                  MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER        14348400
143485                  MOVE DP015-UNP-ALP-BRT-MDT                      14348500
143486                                       TO APRTIDA                 14348600
143487                  MOVE DP015-RED       TO APRTIDC                 14348700
143488                  MOVE DP015-REVERSE   TO APRTIDH                 14348800
143489                  MOVE -1              TO APRTIDL                 14348900
143490                  SET DP030-SET-CURSOR-APPL-1                     14349000
143491                                       TO TRUE                    14349100
143492       END-EVALUATE.                                              14349200
143493                                                                  14349300
143494******************************************************************14349400
143495*  VALIDATE USING DPKCS060                                        14349500
143496******************************************************************14349600
143497 2500-VALIDATE-PRINTER.                                           14349700
143498                                                                  14349800
143499      MOVE DK-PRINTER-DEST                                        14349900
143500                                     TO DP072-PRINTER-ID          14350000
143501      MOVE 'SUKRP016'         TO DP072-RPT-PGM-NME                14350100
143502      MOVE '01'               TO DP072-RPT-PGM-TYP-ID             14350200
143503      MOVE DP020-LOCATION-NBR TO DP072-ORIGIN-OPER-UNT-ID         14350300
143504      MOVE DP020-LOCATION-NBR                                     14350400
143505                              TO DP072-OPER-UNT-ID                14350500
143506      MOVE '01'               TO DP072-ORIGIN-FCLTY-ID            14350600
143507      MOVE '01'               TO DP072-FCLTY-ID                   14350700
143508                                                                  14350800
143509      SET DP072-VALIDATE     TO TRUE                              14350900
143510                                                                  14351000
143511               EXEC CICS                                          14351100
143512                  LINK PROGRAM  (PC-DPKCS060)                     14351200
143513                       COMMAREA (DP072-COMM-AREA)                 14351300
143514                       RESP     (PV-CICS-RESP)                    14351400
143515               END-EXEC                                           14351500
143516                                                                  14351600
143517       EVALUATE TRUE                                              14351700
143518           WHEN PV-CICS-RESP = DFHRESP (NORMAL)                   14351800
143519                CONTINUE                                          14351900
143520           WHEN OTHER                                             14352000
143521                MOVE '2500-VALIDATE-PRINTER     '                 14352100
143522                                            TO DP013-PARAGRAPH    14352200
143523                MOVE PV-CICS-RESP                                 14352300
143524                            TO DP013-MESSAGE-TEXT(1)              14352400
143525                MOVE SQLCA           TO DP013-SQLCA               14352500
143526                       SET DP013-LINK-RETURN                      14352600
143527                           DP013-CICS-ABEND                       14352700
143528                           DP013-NO-ROLLBACK TO TRUE              14352800
143529                PERFORM DP013-0000-PROCESS-ABEND                  14352900
143530                                                                  14353000
143531     END-EVALUATE.                                                14353100
143532******************************************************************14353200
143540** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **14354000
143600** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **14360000
143700******************************************************************14370000
143800 3000-EDIT-DATA-IN-COMMAREA.                                      14380000
143900     SET PS-NO-ERROR               TO TRUE.                       14390000
144000     PERFORM 3200-RESET-ATTRIBUTES.                               14400000
144100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     14410000
144200**                                                                14420000
144300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              14430000
144400* EDITTING IS DONE FROM THE BOTTOM UP.                            14440000
144500**                                                                14450000
144600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       14460000
144700         ASC-ITEMS-DISPLAYED - 1.                                 14470000
144800     PERFORM 3100-SET-SUBSCRIPTS.                                 14480000
144900     PERFORM 3300-EDIT-SELECTIONS                                 14490000
145000         VARYING PV-SUB                                           14500000
145100         FROM PV-SUB BY -1                                        14510000
145200         UNTIL PV-SUB < +1                                        14520000
145300*                                                                 14530000
145400     IF  PS-NO-ERROR                                              14540000
145500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        14550000
145600     END-IF.                                                      14560000
145700*                                                                 14570000
145800     IF  ((PS-NO-ERROR)                                           14580000
145900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   14590000
146000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    14600000
146100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  14610000
146200     END-IF.                                                      14620000
146300 EJECT                                                            14630000
146400*----------------------------------------------------------------*14640000
146500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *14650000
146600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*14660000
146700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *14670000
146800*                                                                *14680000
146900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *14690000
147000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *14700000
147100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *14710000
147200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *14720000
147300*----------------------------------------------------------------*14730000
147400                                                                  14740000
147500 3100-SET-SUBSCRIPTS.                                             14750000
147600                                                                  14760000
147700     COMPUTE ASC-ITEM-SUB =                                       14770000
147800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        14780000
147900                                                                  14790000
148000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         14800000
148100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            14810000
148200                                                                  14820000
148300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               14830000
148400     ELSE                                                         14840000
148500         MOVE +1                     TO ASC-BLK-SUB               14850000
148600     END-IF.                                                      14860000
148700******************************************************************14870000
148800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **14880000
148900******************************************************************14890000
149000                                                                  14900000
149100 3200-RESET-ATTRIBUTES.                                           14910000
149200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   14920000
149300     MOVE DP015-GREEN              TO ASTRTITC.                   14930000
149400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   14940000
149500*                                                                 14950000
149600     PERFORM                                                      14960000
149700         VARYING PV-SUB                                           14970000
149800         FROM 1 BY 1                                              14980000
149900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        14990000
150000         MOVE DP015-UNP-ALP-NOR-OFF                               15000000
150100                                   TO MR-SELECTA (PV-SUB)         15010000
150210         MOVE DP015-ASK-NOR-OFF    TO MR-BUS-AREA-A (PV-SUB)      15021000
150300                                      MR-BRND-DESC-A (PV-SUB)     15030001
150500                                      MR-CARTONS-A (PV-SUB)       15050000
150600                                      MR-UNITS-A (PV-SUB)         15060000
150700                                      MR-SKU-COUNT-A (PV-SUB)     15070000
150800                                      MR-NEW-A (PV-SUB)           15080000
150810                                      MR-HANG-FOLD-A (PV-SUB)     15081000
150900         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         15090000
151000         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         15100000
151100     END-PERFORM.                                                 15110000
151200******************************************************************15120000
151300** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **15130000
151400** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **15140000
151500** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **15150000
151600** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **15160000
151700******************************************************************15170000
151800 3300-EDIT-SELECTIONS.                                            15180000
151900     EVALUATE TRUE                                                15190000
152000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     15200000
152100             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         15210000
152200                 CONTINUE                                         15220000
152300         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         15230000
152400             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        15240000
152500                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   15250000
152600                 MOVE ASC-TEMP-SELECTED-SW                        15260000
152700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15270000
152800                                TO ASC-SELECTED-SW                15280000
152900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15290000
153000             END-IF                                               15300000
153100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     15310000
153200                 = SPACE                                          15320000
153300             EVALUATE TRUE                                        15330000
153400                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       15340000
153500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS15350000
153600                     MOVE SPACE TO ASC-SELECTED-SW                15360000
153700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15370000
153800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        15380000
153900                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    15390000
154000                     MOVE SPACE TO ASC-SELECTED-SW                15400000
154100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15410000
154200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          15420000
154300                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      15430000
154400                     MOVE SPACE TO ASC-SELECTED-SW                15440000
154500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15450000
154600             END-EVALUATE                                         15460000
154700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           15470000
154800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15480000
154900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    15490000
155000             END-IF                                               15500000
155100             PERFORM 3310-EDIT-RANGE                              15510000
155200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             15520000
155300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15530000
155400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    15540000
155500             END-IF                                               15550000
155600             PERFORM 3310-EDIT-RANGE                              15560000
155700         WHEN OTHER                                               15570000
155800             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           15580000
155900             SET DP020-MSG-FATAL    TO TRUE                       15590000
156000             MOVE -1                TO MR-SELECTL (PV-SUB)        15600000
156100             SET DP030-SET-CURSOR-APPL-1                          15610000
156200                                    TO TRUE                       15620000
156300             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        15630000
156400             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        15640000
156500             SET PS-ERROR TO TRUE                                 15650000
156600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15660000
156700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     15670000
156800                 MOVE SPACE         TO ASC-SELECTED-SW            15680000
156900                                        (ASC-BLK-SUB ASC-ITEM-SUB)15690000
157000             END-IF                                               15700000
157100     END-EVALUATE.                                                15710000
157200                                                                  15720000
157300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 15730000
157400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               15740000
157500     IF  ASC-ITEM-SUB < 1                                         15750000
157600         SUBTRACT +1 FROM ASC-BLK-SUB                             15760000
157700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                15770000
157800     END-IF.                                                      15780000
157900                                                                  15790000
158000******************************************************************15800000
158100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **15810000
158200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **15820000
158300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**15830000
158400** THE ENDING.                                                  **15840000
158500******************************************************************15850000
158600 3310-EDIT-RANGE.                                                 15860000
158700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                15870000
158800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   15880000
158900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)15890000
159000                                   TO ASC-SELECTED-SW             15900000
159100                                        (ASC-BLK-SUB ASC-ITEM-SUB)15910000
159200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 15920000
159300         ELSE                                                     15930000
159400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     15940000
159500                 CONTINUE                                         15950000
159600             ELSE                                                 15960000
159700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        15970000
159800                 MOVE PC-TSYMSG-00054                             15980000
159900                                   TO DP020-MSG-NUMBER            15990000
160000                 SET DP020-MSG-FATAL                              16000000
160100                                   TO TRUE                        16010000
160200                 MOVE -1           TO MR-SELECTL (PV-SUB)         16020000
160300                 SET DP030-SET-CURSOR-APPL-1                      16030000
160400                                   TO TRUE                        16040000
160500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         16050000
160600                 MOVE DP015-UNDERLINE                             16060000
160700                                   TO MR-SELECTH (PV-SUB)         16070000
160800                 SET PS-ERROR      TO TRUE                        16080000
160900             END-IF                                               16090000
161000         END-IF                                                   16100000
161100     ELSE                                                         16110000
161200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16120000
161300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16130000
161400                                   TO ASC-SELECTED-SW             16140000
161500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16150000
161600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   16160000
161700         ELSE                                                     16170000
161800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16180000
161900                 CONTINUE                                         16190000
162000             ELSE                                                 16200000
162100*                -- ONLY ONE END-OF-RANGE ALLOWED --              16210000
162200                 MOVE PC-TSYMSG-00055                             16220000
162300                                   TO DP020-MSG-NUMBER            16230000
162400                 SET DP020-MSG-FATAL                              16240000
162500                                   TO TRUE                        16250000
162600                 MOVE -1           TO MR-SELECTL (PV-SUB)         16260000
162700                 SET DP030-SET-CURSOR-APPL-1                      16270000
162800                                   TO TRUE                        16280000
162900                 SET PS-ERROR      TO TRUE                        16290000
163000             END-IF                                               16300000
163100         END-IF                                                   16310000
163200     END-IF.                                                      16320000
163300*                                                                 16330000
163400******************************************************************16340000
163500** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **16350000
163600** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **16360000
163700******************************************************************16370000
163800 3400-CHECK-RANGE-SEQUENCE.                                       16380000
163900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       16390000
164000       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      16400000
164100       AND  ASC-START-OF-SELECTED-RANGE >                         16410000
164200                                         ASC-END-OF-SELECTED-RANGE16420000
164300*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                16430000
164400         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 16440000
164500         SET DP020-MSG-FATAL TO TRUE                              16450000
164600         SET PS-ERROR TO TRUE                                     16460000
164700         PERFORM 3410-POSITION-AT-ERROR                           16470000
164800     END-IF.                                                      16480000
164900******************************************************************16490000
165000** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **16500000
165100** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **16510000
165200** SHOULD BE POSITIONED ON A RANGE ERROR.                       **16520000
165300******************************************************************16530000
165400 3410-POSITION-AT-ERROR.                                          16540000
165500     SET DP030-SET-CURSOR-APPL-1                                  16550000
165600                                   TO TRUE.                       16560000
165700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 16570000
165800                    - PV-TOP-ITEM + 1.                            16580000
165900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16590000
166000         CONTINUE                                                 16600000
166100     ELSE                                                         16610000
166200         MOVE -1                   TO MR-SELECTL (PV-SUB)         16620000
166300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         16630000
166400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         16640000
166500     END-IF.                                                      16650000
166600*                                                                 16660000
166700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   16670000
166800                    - PV-TOP-ITEM + 1.                            16680000
166900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16690000
167000         CONTINUE                                                 16700000
167100     ELSE                                                         16710000
167200         MOVE -1                   TO MR-SELECTL (PV-SUB)         16720000
167300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         16730000
167400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         16740000
167500     END-IF.                                                      16750000
167600 EJECT                                                            16760000
167700*----------------------------------------------------------------*16770000
167800*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *16780000
167900*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *16790000
168000*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *16800000
168100*----------------------------------------------------------------*16810000
168200                                                                  16820000
168300 3500-MARK-RANGE-AS-SELECTED.                                     16830000
168400     MOVE +1                       TO  ASC-BLK-SUB.               16840000
168500     PERFORM 3510-MARK-SELECTED-INDS                              16850000
168600         VARYING ASC-ITEM-SUB                                     16860000
168700         FROM 1 BY 1                                              16870000
168800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16880000
168900                                                                  16890000
169000     ADD +1                        TO ASC-BLK-SUB.                16900000
169100     PERFORM 3510-MARK-SELECTED-INDS                              16910000
169200         VARYING ASC-ITEM-SUB                                     16920000
169300         FROM 1 BY 1                                              16930000
169400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16940000
169500                                                                  16950000
169600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16960000
169700                                   TO  PV-LIST-ITEM-NUMBER.       16970000
169800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16980000
169900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         16990000
170000               PC-ITEMS-PER-PANEL).                               17000000
170100                                                                  17010000
170200     MOVE ASC-START-OF-SELECTED-RANGE                             17020000
170300                                   TO PV-START-OF-SELECTED-RANGE. 17030000
170400     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17040000
170500         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17050000
170600               PC-ITEMS-PER-PANEL).                               17060000
170700                                                                  17070000
170800     MOVE ASC-END-OF-SELECTED-RANGE                               17080000
170900                                   TO  PV-END-OF-SELECTED-RANGE.  17090000
171000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17100000
171100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17110000
171200               PC-ITEMS-PER-PANEL).                               17120000
171300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17130000
171400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17140000
171500                                                                  17150000
171600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17160000
171700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17170000
171800         MOVE +1                   TO ASC-BLK-SUB                 17180000
171900         PERFORM 5100-WRITE-TEMP-STORAGE                          17190000
172000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17200000
172100             PV-FIRST-BLOCK-IN-ARRAY - 1                          17210000
172200                                                                  17220000
172300         PERFORM                                                  17230000
172400             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17240000
172500                   PV-PREV-BLOCK-IN-ARRAY                         17250000
172600             MOVE PV-FIRST-BLOCK-IN-RANGE                         17260000
172700                                   TO PV-BLOCK-NUMBER             17270000
172800             PERFORM 4410-READ-TEMP-STORAGE                       17280000
172900             PERFORM 3510-MARK-SELECTED-INDS                      17290000
173000                 VARYING ASC-ITEM-SUB                             17300000
173100                 FROM 1 BY 1                                      17310000
173200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17320000
173300             PERFORM 5100-WRITE-TEMP-STORAGE                      17330000
173400             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     17340000
173500         END-PERFORM                                              17350000
173600                                                                  17360000
173700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17370000
173800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17380000
173900         PERFORM                                                  17390000
174000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17400000
174100                   PV-LAST-BLOCK-IN-RANGE                         17410000
174200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17420000
174300                                   TO PV-BLOCK-NUMBER             17430000
174400             PERFORM 4410-READ-TEMP-STORAGE                       17440000
174500             PERFORM 3510-MARK-SELECTED-INDS                      17450000
174600                 VARYING ASC-ITEM-SUB                             17460000
174700                 FROM 1 BY 1                                      17470000
174800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17480000
174900             PERFORM 5100-WRITE-TEMP-STORAGE                      17490000
175000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17500000
175100         END-PERFORM                                              17510000
175200                                                                  17520000
175300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17530000
175400                                   TO PV-BLOCK-NUMBER             17540000
175500         PERFORM 4410-READ-TEMP-STORAGE                           17550000
175600     END-IF.                                                      17560000
175700                                                                  17570000
175800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 17580000
175900                                      ASC-END-OF-SELECTED-RANGE.  17590000
176000                                                                  17600000
176100/                                                                 17610000
176200*----------------------------------------------------------------*17620000
176300* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *17630000
176400*----------------------------------------------------------------*17640000
176500                                                                  17650000
176600 3510-MARK-SELECTED-INDS.                                         17660000
176700                                                                  17670000
176800     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17680000
176900                                ASC-ITEM-SUB) >                   17690000
177000         ASC-START-OF-SELECTED-RANGE)                             17700000
177100     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17710000
177200                                ASC-ITEM-SUB) =                   17720000
177300         ASC-START-OF-SELECTED-RANGE)                             17730000
177400                                                                  17740000
177500         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17750000
177600                                    ASC-ITEM-SUB) <               17760000
177700             ASC-END-OF-SELECTED-RANGE)                           17770000
177800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17780000
177900                                    ASC-ITEM-SUB) =               17790000
178000             ASC-END-OF-SELECTED-RANGE)                           17800000
178100                                                                  17810000
178200             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17820000
178300                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   17830000
178400                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   17840000
178500                               TO TRUE                            17850000
178600                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              17860000
178700                               TO TRUE                            17870000
178800                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    17880000
178900             END-IF                                               17890000
179000         END-IF                                                   17900000
179100     END-IF.                                                      17910000
179200                                                                  17920000
179300 EJECT                                                            17930000
179400*----------------------------------------------------------------*17940000
179500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *17950000
179600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *17960000
179700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *17970000
179800*    DISPLAY THE PANEL TO USER.                                  *17980000
179900*----------------------------------------------------------------*17990000
180000                                                                  18000000
180100 4000-BUILD-INITIAL-PANEL.                                        18010000
180200                                                                  18020000
180300     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18030000
180400                                 ASC-BLOCK-ENTRIES (2).           18040000
180500     MOVE +1                 TO ASC-BLK-SUB.                      18050000
180600     SET ASC-ITEMS-LEFT-ON-DB                                     18060000
180700                             TO TRUE.                             18070000
180800                                                                  18080000
180900     MOVE ZERO               TO ASC-ITEM-SUB                      18090000
181000                                ASC-NUMBER-OF-ITEMS-READ          18100000
181100                                ASC-NUMBER-OF-SELECTED-ITEMS      18110000
181200                                ASC-HIGHEST-BLOCK-WRITTEN         18120000
181300                                ASC-START-OF-SELECTED-RANGE       18130000
181400                                ASC-END-OF-SELECTED-RANGE         18140000
181500                                ASC-ITEM-AT-TOP-OF-PANEL.         18150000
181600                                                                  18160000
181700     MOVE SU012-STR-NBR          TO ASC-STR-NBR                   18170000
181800                                                                  18180000
181900     PERFORM 4100-PREPARE-CURSOR                                  18190000
182000                                                                  18200000
182001*CLP 07/06/2015 - START                                           18200102
182003*    THIS WILL FIRST TRY THE CURSOR FOR BRAND                     18200305
182004*    IF NO ROWS ARE RETURNED FROM THE BRAND CURSOR THEN           18200405
182005*    THE PROGRAM WILL LOOK AT THE MERCHANDISE PROGRAM CURSOR      18200505
182006*                                                                 18200605
182007*    THIS SET OF OPEN, FETCH AND CLOSE ARE FOR XLT_BRND           18200705
182008                                                                  18200805
182009*    SET ASC-USING--BRAND     TO TRUE.                            18200913
182010     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            18201005
182011     PERFORM 4011-OPEN-CURSOR.                                    18201105
182012     PERFORM 4301-READ-ITEMS-FROM-DB.                             18201205
182014     PERFORM 4021-CLOSE-CURSOR.                                   18201405
182015                                                                  18201505
182020*    THIS SET OF OPEN, FETCH AND CLOSE ARE FOR XLT_MDSE_PGM       18202005
182030*                                                                 18203005
182031*    THIS CURSOR WILL ONLY BE USED IF NO ROWS WERE RETURNED       18203105
182040*    FOR THE TRIP FROM THE BRAND CURSOR                           18204005
182050                                                                  18205005
182001*CLP 07/06/2015 - END                                             18205110
                                                                        18205210
182060*    IF  ASC-NUMBER-OF-ITEMS-READ   >  0                          18206013
182070*        CONTINUE                                                 18207013
182080*    ELSE                                                         18208013
182090*        SET ASC-USING--PGM   TO TRUE                             18209013
      *        SET ASC-ITEMS-LEFT-ON-DB TO TRUE                         18209113
182100*        PERFORM 4010-OPEN-CURSOR                                 18210013
182300*        PERFORM 4300-READ-ITEMS-FROM-DB                          18230013
182500*        PERFORM 4020-CLOSE-CURSOR                                18250013
182501*    END-IF.                                                      18250113
182502                                                                  18250202
182700     MOVE +1                   TO  PV-TOP-ITEM.                   18270000
182800                                                                  18280000
182900*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        18290000
183000*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   18300000
183100*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      18310000
183200*    THE ORIGINAL SCREEN.                                         18320000
183300     EVALUATE TRUE                                                18330000
183400         WHEN SU013-SELECTED-ITEMS > 1                            18340000
183500             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  18350000
183600                 SET DP020-MSG-WARNING TO  TRUE                   18360000
183700                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       18370000
183800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18380000
183900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18390000
184000             ELSE                                                 18400000
184100                 MOVE -1               TO MR-SELECTL (1)          18410000
184200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18420000
184300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18430000
184400             END-IF                                               18440000
184500         WHEN OTHER                                               18450000
184600             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  18460000
184700                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            18470000
184800                 SET DP020-MSG-FATAL   TO  TRUE                   18480000
184900                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       18490000
185000             ELSE                                                 18500000
185100                 MOVE -1               TO MR-SELECTL (1)          18510000
185200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18520000
185300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18530000
185400             END-IF                                               18540000
185500     END-EVALUATE.                                                18550000
185600/                                                                 18560000
185700*4010-OPEN-CURSOR.                                                18570013
185800*                                                                 18580013
185900*    EVALUATE TRUE                                                18590013
186000*        WHEN ASC-TRLR-STAT-LIST                                  18600013
186100*            EVALUATE TRUE                                        18610013
186200*            WHEN ASC-AREA-SEQ                                    18620013
186300*                MOVE 'CURSOR:  TRLR AREA CSR'                    18630013
186400*                                  TO DP013-MESSAGE-TEXT (2)      18640013
186500*                EXEC SQL                                         18650013
186600*                    OPEN TRLR-AREA-CSR                           18660013
186700*                END-EXEC                                         18670013
186710*                                                                 18671013
186800*            WHEN ASC-UNIT-SEQ                                    18680013
186900*                MOVE 'CURSOR:  TRLR UNIT CSR'                    18690013
187000*                                  TO DP013-MESSAGE-TEXT (2)      18700013
187100*                EXEC SQL                                         18710013
187200*                    OPEN TRLR-UNIT-CSR                           18720013
187300*                END-EXEC                                         18730013
187500*                                                                 18750013
187600*            END-EVALUATE                                         18760013
187610*                                                                 18761013
187700*        WHEN ASC-BUSAREA-LIST                                    18770013
187800*            EVALUATE TRUE                                        18780013
187900*            WHEN ASC-AREA-SEQ                                    18790013
188000*                MOVE 'CURSOR: BUSAREA-AREA CSR'                  18800013
188100*                                  TO DP013-MESSAGE-TEXT (2)      18810013
188200*                EXEC SQL                                         18820013
188300*                    OPEN BUSAREA-AREA-CSR                        18830013
188400*                END-EXEC                                         18840013
188500*                                                                 18850013
188600*            WHEN ASC-UNIT-SEQ                                    18860013
188700*                MOVE 'CURSOR: BUSAREA-UNIT CSR'                  18870013
188800*                                  TO DP013-MESSAGE-TEXT (2)      18880013
188900*                EXEC SQL                                         18890013
189000*                    OPEN BUSAREA-UNIT-CSR                        18900013
189100*                END-EXEC                                         18910013
189200*                                                                 18920013
189300*            END-EVALUATE                                         18930013
189400*    END-EVALUATE                                                 18940013
189500*                                                                 18950013
189600*    EVALUATE TRUE                                                18960013
189700*        WHEN SQLCODE = ZERO                                      18970013
189800*            CONTINUE                                             18980013
189900*        WHEN SQLCODE = -904                                      18990013
190000*        WHEN SQLCODE = -911                                      19000013
190100*        WHEN SQLCODE = -913                                      19010013
190200*            PERFORM 9900-SOFT-ABORT                              19020013
190300*        WHEN SQLWARN0 NOT = SPACES                               19030013
190400*        WHEN SQLCODE < ZERO                                      19040013
190500*        WHEN SQLCODE > ZERO                                      19050013
190600*            MOVE '4010-OPEN-CURSOR'                              19060013
190700*                                  TO DP013-PARAGRAPH             19070013
190800*            MOVE 'OPEN TRAILER STATUS CURSOR - '                 19080013
190900*                                  TO DP013-MESSAGE-TEXT (1)      19090013
191000*            MOVE SQLCA        TO DP013-SQLCA                     19100013
191100*            MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        19110013
191200*            MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        19120013
191300*            SET DP013-DB2-ABEND                                  19130013
191400*                DP013-XCTL-DISPLAY-RESTART TO TRUE               19140013
191500*            PERFORM DP013-0000-PROCESS-ABEND                     19150013
191600*    END-EVALUATE.                                                19160013
191700/                                                                 19170000
191701*CLP 07/06/2015 START                                             19170104
191710 4011-OPEN-CURSOR.                                                19171002
191720                                                                  19172002
191730     EVALUATE TRUE                                                19173002
191740         WHEN ASC-TRLR-STAT-LIST                                  19174002
191750             EVALUATE TRUE                                        19175002
191760             WHEN ASC-AREA-SEQ                                    19176002
191770                 MOVE 'CURSOR: TRLR AREAB CSR'                    19177002
191780                                   TO DP013-MESSAGE-TEXT (2)      19178002
191790                 EXEC SQL                                         19179002
191791                     OPEN TRLR-AREA-B-CSR                         19179102
191792                 END-EXEC                                         19179202
191793                                                                  19179302
191794             WHEN ASC-UNIT-SEQ                                    19179402
191795                 MOVE 'CURSOR: TRLR UNIT BRND CSR'                19179502
191796                                   TO DP013-MESSAGE-TEXT (2)      19179602
191797                 EXEC SQL                                         19179702
191798                     OPEN TRLR-UNIT-BRND-CSR                      19179802
191799                 END-EXEC                                         19179902
191800                                                                  19180002
191801             END-EVALUATE                                         19180102
191802                                                                  19180202
191803         WHEN ASC-BUSAREA-LIST                                    19180302
191804             EVALUATE TRUE                                        19180402
191805             WHEN ASC-AREA-SEQ                                    19180502
191806                 MOVE 'CURSOR: BUSAREA-AREAB CSR'                 19180602
191807                                   TO DP013-MESSAGE-TEXT (2)      19180702
191808                 EXEC SQL                                         19180802
191809                     OPEN BUSAREA-AREA-B-CSR                      19180902
191810                 END-EXEC                                         19181002
191811                                                                  19181102
191812             WHEN ASC-UNIT-SEQ                                    19181202
191813                 MOVE 'CURSOR: BUSAREA-UNITB CSR'                 19181302
191814                                   TO DP013-MESSAGE-TEXT (2)      19181402
191815                 EXEC SQL                                         19181502
191816                     OPEN BUSAREA-UNIT-B-CSR                      19181602
191817                 END-EXEC                                         19181702
191818                                                                  19181802
191819             END-EVALUATE                                         19181902
191820     END-EVALUATE                                                 19182002
191821                                                                  19182102
191822     EVALUATE TRUE                                                19182202
191823         WHEN SQLCODE = ZERO                                      19182302
191824             CONTINUE                                             19182402
191825         WHEN SQLCODE = -904                                      19182502
191826         WHEN SQLCODE = -911                                      19182602
191827         WHEN SQLCODE = -913                                      19182702
191828             PERFORM 9900-SOFT-ABORT                              19182802
191829         WHEN SQLWARN0 NOT = SPACES                               19182902
191830         WHEN SQLCODE < ZERO                                      19183002
191831         WHEN SQLCODE > ZERO                                      19183102
191832             MOVE '4011-OPEN-CURSOR'                              19183202
191833                                   TO DP013-PARAGRAPH             19183302
191834             MOVE 'OPEN TRAILER STATUS CURSOR - '                 19183402
191835                                   TO DP013-MESSAGE-TEXT (1)      19183502
191836             MOVE SQLCA        TO DP013-SQLCA                     19183602
191837             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        19183702
191838             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        19183802
191839             SET DP013-DB2-ABEND                                  19183902
191840                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19184002
191841             PERFORM DP013-0000-PROCESS-ABEND                     19184102
191842     END-EVALUATE.                                                19184202
191843*CLP 07/06/2015 END                                               19184304
191844                                                                  19184402
191850*4020-CLOSE-CURSOR.                                               19185013
191900*                                                                 19190013
192000*    EVALUATE TRUE                                                19200013
192100*        WHEN ASC-TRLR-STAT-LIST                                  19210013
192200*            EVALUATE TRUE                                        19220013
192300*            WHEN ASC-AREA-SEQ                                    19230013
192400*                MOVE 'CURSOR:  TRLR AREA CSR'                    19240013
192500*                                  TO DP013-MESSAGE-TEXT (2)      19250013
192600*                EXEC SQL                                         19260013
192700*                    CLOSE TRLR-AREA-CSR                          19270013
192800*                END-EXEC                                         19280013
192900*                                                                 19290013
193000*            WHEN ASC-UNIT-SEQ                                    19300013
193100*                MOVE 'CURSOR:  TRLR UNIT CSR'                    19310013
193200*                                  TO DP013-MESSAGE-TEXT (2)      19320013
193300*                EXEC SQL                                         19330013
193400*                    CLOSE TRLR-UNIT-CSR                          19340013
193500*                END-EXEC                                         19350013
193600*                                                                 19360013
193700*            END-EVALUATE                                         19370013
193710*                                                                 19371013
193800*        WHEN ASC-BUSAREA-LIST                                    19380013
193900*            EVALUATE TRUE                                        19390013
194000*            WHEN ASC-AREA-SEQ                                    19400013
194100*                MOVE 'CURSOR: BUSAREA-AREA CSR'                  19410013
194200*                                  TO DP013-MESSAGE-TEXT (2)      19420013
194300*                EXEC SQL                                         19430013
194400*                    CLOSE BUSAREA-AREA-CSR                       19440013
194500*                END-EXEC                                         19450013
194600*                                                                 19460013
194700*            WHEN ASC-UNIT-SEQ                                    19470013
194800*                MOVE 'CURSOR: BUSAREA-UNIT CSR'                  19480013
194900*                                  TO DP013-MESSAGE-TEXT (2)      19490013
195000*                EXEC SQL                                         19500013
195100*                    CLOSE BUSAREA-UNIT-CSR                       19510013
195200*                END-EXEC                                         19520013
195300*                                                                 19530013
195400*            END-EVALUATE                                         19540013
195500*    END-EVALUATE                                                 19550013
195600*                                                                 19560000
195700*    EVALUATE TRUE                                                19570013
195800*        WHEN SQLCODE = ZERO                                      19580013
195900*            CONTINUE                                             19590013
196000*        WHEN SQLCODE = -904                                      19600013
196100*        WHEN SQLCODE = -911                                      19610013
196200*        WHEN SQLCODE = -913                                      19620013
196300*            PERFORM 9900-SOFT-ABORT                              19630013
196400*        WHEN SQLWARN0 NOT = SPACES                               19640013
196500*        WHEN SQLCODE < ZERO                                      19650013
196600*        WHEN SQLCODE > ZERO                                      19660013
196700*            MOVE '4020-CLOSE-CURSOR'                             19670013
196800*                              TO DP013-PARAGRAPH                 19680013
196900*            MOVE 'CLOSE CURSOR '                                 19690013
197000*                              TO DP013-MESSAGE-TEXT (1)          19700013
197100*            MOVE SQLCA        TO DP013-SQLCA                     19710013
197200*            MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        19720013
197300*            SET DP013-DB2-ABEND                                  19730013
197400*                DP013-XCTL-DISPLAY-RESTART TO TRUE               19740013
197500*            PERFORM DP013-0000-PROCESS-ABEND                     19750013
197600*    END-EVALUATE.                                                19760013
197700                                                                  19770000
197701*CLP 07/06/2015 START                                             19770104
197710 4021-CLOSE-CURSOR.                                               19771002
197720                                                                  19772002
197730     EVALUATE TRUE                                                19773002
197740         WHEN ASC-TRLR-STAT-LIST                                  19774002
197750             EVALUATE TRUE                                        19775002
197760             WHEN ASC-AREA-SEQ                                    19776002
197770                 MOVE 'CURSOR: TRLR AREAB CSR'                    19777002
197780                                   TO DP013-MESSAGE-TEXT (2)      19778002
197790                 EXEC SQL                                         19779002
197791                     CLOSE TRLR-AREA-B-CSR                        19779102
197792                 END-EXEC                                         19779202
197793                                                                  19779302
197794             WHEN ASC-UNIT-SEQ                                    19779402
197795                 MOVE 'CURSOR: TRLR UNIT BRND CSR'                19779502
197796                                   TO DP013-MESSAGE-TEXT (2)      19779602
197797                 EXEC SQL                                         19779702
197798                     CLOSE TRLR-UNIT-BRND-CSR                     19779802
197799                 END-EXEC                                         19779902
197800                                                                  19780002
197801             END-EVALUATE                                         19780102
197802                                                                  19780202
197803         WHEN ASC-BUSAREA-LIST                                    19780302
197804             EVALUATE TRUE                                        19780402
197805             WHEN ASC-AREA-SEQ                                    19780502
197806                 MOVE 'CURSOR: BUSAREA-AREAB CSR'                 19780602
197807                                   TO DP013-MESSAGE-TEXT (2)      19780702
197808                 EXEC SQL                                         19780802
197809                     CLOSE BUSAREA-AREA-B-CSR                     19780902
197810                 END-EXEC                                         19781002
197811                                                                  19781102
197812             WHEN ASC-UNIT-SEQ                                    19781202
197813                 MOVE 'CURSOR: BUSAREA-UNITB CSR'                 19781302
197814                                   TO DP013-MESSAGE-TEXT (2)      19781402
197815                 EXEC SQL                                         19781502
197816                     CLOSE BUSAREA-UNIT-B-CSR                     19781602
197817                 END-EXEC                                         19781702
197818                                                                  19781802
197819             END-EVALUATE                                         19781902
197820     END-EVALUATE                                                 19782002
197821*                                                                 19782102
197822     EVALUATE TRUE                                                19782202
197823         WHEN SQLCODE = ZERO                                      19782302
197824             CONTINUE                                             19782402
197825         WHEN SQLCODE = -904                                      19782502
197826         WHEN SQLCODE = -911                                      19782602
197827         WHEN SQLCODE = -913                                      19782702
197828             PERFORM 9900-SOFT-ABORT                              19782802
197829         WHEN SQLWARN0 NOT = SPACES                               19782902
197830         WHEN SQLCODE < ZERO                                      19783002
197831         WHEN SQLCODE > ZERO                                      19783102
197832             MOVE '4021-CLOSE-CURSOR'                             19783202
197833                               TO DP013-PARAGRAPH                 19783302
197834             MOVE 'CLOSE CURSOR '                                 19783402
197835                               TO DP013-MESSAGE-TEXT (1)          19783502
197836             MOVE SQLCA        TO DP013-SQLCA                     19783602
197837             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        19783702
197838             SET DP013-DB2-ABEND                                  19783802
197839                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19783902
197840             PERFORM DP013-0000-PROCESS-ABEND                     19784002
197841     END-EVALUATE.                                                19784102
197842*CLP 07/06/2015 END                                               19784204
197850 EJECT                                                            19785000
197900*----------------------------------------------------------------*19790000
198000*    SET UP THE HOST VARIABLES.                                  *19800000
198100*----------------------------------------------------------------*19810000
198300 4100-PREPARE-CURSOR.                                             19830000
198400                                                                  19840000
198500     MOVE ASC-TRIP-OCRNC-ID  TO DK-TRIP-OCRNC-ID                  19850000
198600     MOVE ASC-BUS-AREA-ID    TO DK-BUS-AREA-ID                    19860000
198700                                                                  19870000
198800     EVALUATE TRUE                                                19880000
199100         WHEN SU012-UNIT-SEQ                                      19910000
199200             SET ASC-UNIT-SEQ         TO TRUE                     19920000
199210         WHEN OTHER                                               19921000
199220             SET ASC-AREA-SEQ         TO TRUE                     19922000
199300     END-EVALUATE.                                                19930000
199400                                                                  19940000
199500/                                                                 19950000
199600*----------------------------------------------------------------*19960000
199700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *19970000
199800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *19980000
199900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *19990000
200000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20000000
200100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20010000
200200*                                                                *20020000
200300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20030000
200400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20040000
200500*    UPON INITIALIZATION.                                        *20050000
200600*----------------------------------------------------------------*20060000
200700*                                                                 20070013
200800*4300-READ-ITEMS-FROM-DB.                                         20080013
200900*                                                                 20090013
201000*    PERFORM                                                      20100013
201100*        VARYING PV-READ-COUNT                                    20110013
201200*        FROM 1 BY 1                                              20120013
201300*        UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20130013
201400*           OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20140013
201500*                                                                 20150013
201600*        PERFORM 4310-FETCH                                       20160013
201700*                                                                 20170013
201800*        IF  ASC-ITEMS-LEFT-ON-DB                                 20180013
201900*            IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20190013
202000*                ADD +1            TO ASC-ITEM-SUB                20200013
202100*            ELSE                                                 20210013
202200*                ADD +1            TO ASC-BLK-SUB                 20220013
202300*                MOVE +1           TO ASC-ITEM-SUB                20230013
202400*                                                                 20240013
202500*                IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20250013
202600*                    MOVE +1       TO ASC-BLK-SUB                 20260013
202700*                    SET ASC-BLOCK-MODIFIED (1)                   20270013
202800*                                  TO TRUE                        20280013
202900*                    PERFORM 5100-WRITE-TEMP-STORAGE              20290013
203000*                    MOVE ASC-BLOCK-ENTRIES                       20300013
203100*                              (PC-MAX-BLOCKS-IN-ARRAY)           20310013
203200*                               TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20320013
203300*                    ADD +1        TO ASC-BLK-SUB                 20330013
203400*                    INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20340013
203500*                    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20350013
203600*                                  TO TRUE                        20360013
203700*                END-IF                                           20370013
203800*            END-IF                                               20380013
203900*            ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20390013
204000*            PERFORM 4300A-MOVE-TO-COMMAREA                       20400013
204100*        END-IF                                                   20410013
204200*    END-PERFORM.                                                 20420013
204300*                                                                 20430013
204400*    IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          20440013
204500*        MOVE +1               TO ASC-BLK-SUB                     20450013
204600*        PERFORM 5100-WRITE-TEMP-STORAGE                          20460013
204700*        ADD +1                TO ASC-BLK-SUB                     20470013
204800*        PERFORM 5100-WRITE-TEMP-STORAGE                          20480013
204900*                                                                 20490013
205000*        MOVE 1                TO ASC-BLK-SUB                     20500013
205100*                                 PV-BLOCK-NUMBER                 20510013
205200*        PERFORM 4410-READ-TEMP-STORAGE                           20520013
205300*        IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             20530013
205400*            MOVE 2            TO ASC-BLK-SUB                     20540013
205500*                                 PV-BLOCK-NUMBER                 20550013
205600*            PERFORM 4410-READ-TEMP-STORAGE                       20560013
205700*        END-IF                                                   20570013
205800*    END-IF.                                                      20580013
205900/                                                                 20590000
205901*CLP 07/06/2015 START                                             20590104
205910 4301-READ-ITEMS-FROM-DB.                                         20591002
205920                                                                  20592002
205930     PERFORM                                                      20593002
205940         VARYING PV-READ-COUNT                                    20594002
205950         FROM 1 BY 1                                              20595002
205960         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20596002
205970            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20597002
205980                                                                  20598002
205990         PERFORM 4311-FETCH                                       20599002
205991                                                                  20599102
205992         IF  ASC-ITEMS-LEFT-ON-DB                                 20599202
205993             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20599302
205994                 ADD +1            TO ASC-ITEM-SUB                20599402
205995             ELSE                                                 20599502
205996                 ADD +1            TO ASC-BLK-SUB                 20599602
205997                 MOVE +1           TO ASC-ITEM-SUB                20599702
205998                                                                  20599802
205999                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20599902
206000                     MOVE +1       TO ASC-BLK-SUB                 20600002
206001                     SET ASC-BLOCK-MODIFIED (1)                   20600102
206002                                   TO TRUE                        20600202
206003                     PERFORM 5100-WRITE-TEMP-STORAGE              20600302
206004                     MOVE ASC-BLOCK-ENTRIES                       20600402
206005                               (PC-MAX-BLOCKS-IN-ARRAY)           20600502
206006                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20600602
206007                     ADD +1        TO ASC-BLK-SUB                 20600702
206008                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20600802
206009                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20600902
206010                                   TO TRUE                        20601002
206011                 END-IF                                           20601102
206012             END-IF                                               20601202
206013             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20601302
206014             PERFORM 4300B-MOVE-TO-COMMAREA                       20601402
206015         END-IF                                                   20601502
206016     END-PERFORM.                                                 20601602
206017                                                                  20601702
206018     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          20601802
206019         MOVE +1               TO ASC-BLK-SUB                     20601902
206020         PERFORM 5100-WRITE-TEMP-STORAGE                          20602002
206021         ADD +1                TO ASC-BLK-SUB                     20602102
206022         PERFORM 5100-WRITE-TEMP-STORAGE                          20602202
206023                                                                  20602302
206024         MOVE 1                TO ASC-BLK-SUB                     20602402
206025                                  PV-BLOCK-NUMBER                 20602502
206026         PERFORM 4410-READ-TEMP-STORAGE                           20602602
206027         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             20602702
206028             MOVE 2            TO ASC-BLK-SUB                     20602802
206029                                  PV-BLOCK-NUMBER                 20602902
206030             PERFORM 4410-READ-TEMP-STORAGE                       20603002
206031         END-IF                                                   20603102
206032     END-IF.                                                      20603202
206033*CLP 07/06/2015 END                                               20603304
206034                                                                  20603402
206040*4300A-MOVE-TO-COMMAREA.                                          20604013
206100*                                                                 20610013
206200*    MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        20620013
206300*                                       (ASC-BLK-SUB ASC-ITEM-SUB)20630013
206400*                                                                 20640013
207900*    MOVE XLT00000-BUS-AREA-DESC   TO ASC-BUS-AREA                20790013
207901*                                     (ASC-BLK-SUB ASC-ITEM-SUB). 20790113
207920*    MOVE XLT00040-MDSE-PGM-DESC   TO ASC-BRND-DESC               20792013
207930*                                      (ASC-BLK-SUB ASC-ITEM-SUB).20793013
208300*    MOVE SUT00096-UNT-QTY       TO ASC-UNT-QTY                   20830013
208400*                                      (ASC-BLK-SUB ASC-ITEM-SUB).20840013
208500*    MOVE SUT00096-SKU-QTY       TO ASC-SKU-COUNT                 20850013
208600*                                      (ASC-BLK-SUB ASC-ITEM-SUB).20860013
208700*    MOVE SUT00096-CART-QTY      TO ASC-CART-QTY                  20870013
208800*                                      (ASC-BLK-SUB ASC-ITEM-SUB).20880013
208810*    MOVE SUT00096-HNG-FOLD-CDE(1:1)  TO ASC-HANG-FOLD            20881013
208820*                                      (ASC-BLK-SUB ASC-ITEM-SUB).20882013
208830*    MOVE SUT00096-PRC-MSG-RPLN-NEW-IND                           20883013
208840*                    TO ASC-NEW   (ASC-BLK-SUB ASC-ITEM-SUB).     20884013
208900*                                                                 20890013
212117                                                                  21211700
212118*CLP 07/06/2015 START                                             21211804
212119 4300B-MOVE-TO-COMMAREA.                                          21211902
212120                                                                  21212002
212121     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        21212102
212130                                        (ASC-BLK-SUB ASC-ITEM-SUB)21213002
212140                                                                  21214002
212150     MOVE XLT00000-BUS-AREA-DESC   TO ASC-BUS-AREA                21215002
212160                                      (ASC-BLK-SUB ASC-ITEM-SUB). 21216002
212170     MOVE XLT00043-BRND-DESC       TO ASC-BRND-DESC               21217002
212180                                       (ASC-BLK-SUB ASC-ITEM-SUB).21218002
212190     MOVE SUT00066-UNT-QTY       TO ASC-UNT-QTY                   21219010
212200                                       (ASC-BLK-SUB ASC-ITEM-SUB).21220002
212300     MOVE SUT00066-SKU-QTY       TO ASC-SKU-COUNT                 21230010
212400                                       (ASC-BLK-SUB ASC-ITEM-SUB).21240002
212500     MOVE SUT00066-CART-QTY      TO ASC-CART-QTY                  21250010
212600                                       (ASC-BLK-SUB ASC-ITEM-SUB).21260002
212700     MOVE SUT00066-HNG-FOLD-CDE(1:1)  TO ASC-HANG-FOLD            21270010
212800                                       (ASC-BLK-SUB ASC-ITEM-SUB).21280002
           IF SUT00066-PRC-MSG-RPLN-NEW-IND = 'Y'                       21281010
212900         MOVE SUT00066-PRC-MSG-RPLN-NEW-IND                       21290010
213000                           TO ASC-NEW  (ASC-BLK-SUB ASC-ITEM-SUB) 21300010
           ELSE                                                         21301010
213000         MOVE SPACE        TO ASC-NEW  (ASC-BLK-SUB ASC-ITEM-SUB) 21303010
           END-IF.                                                      21304010
213100                                                                  21310002
213110*CLP 07/06/2015 END                                               21311004
213200                                                                  21320002
219400*----------------------------------------------------------------*21940000
219500*    FETCH THE TRAILER CURSOR.                                   *21950000
219600*----------------------------------------------------------------*21960000
219800*4310-FETCH.                                                      21980013
219900*                                                                 21990013
220000*    EVALUATE TRUE                                                22000013
220100*        WHEN ASC-TRLR-STAT-LIST                                  22010013
220200*            EVALUATE TRUE                                        22020013
220300*            WHEN ASC-AREA-SEQ                                    22030013
220400*                EXEC SQL                                         22040013
220500*                    FETCH TRLR-AREA-CSR                          22050013
220600*                      INTO                                       22060013
220700*                    :SUT00096-TRIP-OCRNC-ID                      22070013
220800*                  , :SUT00096-BUS-AREA-ID                        22080013
220810*                  , :SUT00096-MDSE-PGM-ID                        22081013
220900*                  , :SUT00096-UNT-QTY                            22090013
221000*                  , :SUT00096-SKU-QTY                            22100013
221100*                  , :SUT00096-CART-QTY                           22110013
221200*                  , :SUT00096-RTL-DOL-AMT                        22120013
221201*                  , :SUT00096-COST-DOL-AMT                       22120113
221204*                  , :XLT00000-BUS-AREA-ID                        22120413
221205*                  , :XLT00000-BUS-AREA-DESC                      22120513
221206*                  , :XLT00040-MDSE-PGM-ID                        22120613
221207*                  , :XLT00040-MDSE-PGM-DESC                      22120713
221208*                  , :SUT00096-HNG-FOLD-CDE                       22120813
221209*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               22120913
221300*                END-EXEC                                         22130013
221400*                                                                 22140013
221500*            WHEN ASC-UNIT-SEQ                                    22150013
221600*                EXEC SQL                                         22160013
221700*                    FETCH TRLR-UNIT-CSR                          22170013
221800*                      INTO                                       22180013
221900*                    :SUT00096-TRIP-OCRNC-ID                      22190013
222000*                  , :SUT00096-BUS-AREA-ID                        22200013
222100*                  , :SUT00096-MDSE-PGM-ID                        22210013
222200*                  , :SUT00096-UNT-QTY                            22220013
222300*                  , :SUT00096-SKU-QTY                            22230013
222400*                  , :SUT00096-CART-QTY                           22240013
222500*                  , :SUT00096-RTL-DOL-AMT                        22250013
222510*                  , :SUT00096-COST-DOL-AMT                       22251013
222520*                  , :XLT00000-BUS-AREA-ID                        22252013
222530*                  , :XLT00000-BUS-AREA-DESC                      22253013
222540*                  , :XLT00040-MDSE-PGM-ID                        22254013
222550*                  , :XLT00040-MDSE-PGM-DESC                      22255013
222551*                  , :SUT00096-HNG-FOLD-CDE                       22255113
222552*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               22255213
222560*                END-EXEC                                         22256013
222570*                                                                 22257013
222600*            END-EVALUATE                                         22260013
222700*                                                                 22270013
222800*        WHEN ASC-BUSAREA-LIST                                    22280013
222900*            EVALUATE TRUE                                        22290013
223000*            WHEN ASC-AREA-SEQ                                    22300013
223100*                EXEC SQL                                         22310013
223101*                FETCH BUSAREA-AREA-CSR                           22310113
223110*                INTO                                             22311013
223120*                    :SUT00096-TRIP-OCRNC-ID                      22312013
223130*                  , :SUT00096-BUS-AREA-ID                        22313013
223140*                  , :SUT00096-MDSE-PGM-ID                        22314013
223150*                  , :SUT00096-UNT-QTY                            22315013
223160*                  , :SUT00096-SKU-QTY                            22316013
223170*                  , :SUT00096-CART-QTY                           22317013
223180*                  , :SUT00096-RTL-DOL-AMT                        22318013
223181*                  , :SUT00096-COST-DOL-AMT                       22318113
223190*                  , :XLT00000-BUS-AREA-ID                        22319013
223191*                  , :XLT00000-BUS-AREA-DESC                      22319113
223193*                  , :XLT00040-MDSE-PGM-ID                        22319313
223194*                  , :XLT00040-MDSE-PGM-DESC                      22319413
223195*                  , :SUT00096-HNG-FOLD-CDE                       22319513
223196*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               22319613
223197*                END-EXEC                                         22319713
223950*                                                                 22395013
224200*            WHEN ASC-UNIT-SEQ                                    22420013
224300*             EXEC SQL                                            22430013
224400*                FETCH BUSAREA-UNIT-CSR                           22440013
224500*                INTO                                             22450013
224600*                    :SUT00096-TRIP-OCRNC-ID                      22460013
224700*                  , :SUT00096-BUS-AREA-ID                        22470013
224800*                  , :SUT00096-MDSE-PGM-ID                        22480013
224900*                  , :SUT00096-UNT-QTY                            22490013
225000*                  , :SUT00096-SKU-QTY                            22500013
225100*                  , :SUT00096-CART-QTY                           22510013
225110*                  , :SUT00096-RTL-DOL-AMT                        22511013
225111*                  , :SUT00096-COST-DOL-AMT                       22511113
225120*                  , :XLT00000-BUS-AREA-ID                        22512013
225130*                  , :XLT00000-BUS-AREA-DESC                      22513013
225150*                  , :XLT00040-MDSE-PGM-ID                        22515013
225160*                  , :XLT00040-MDSE-PGM-DESC                      22516013
225170*                  , :SUT00096-HNG-FOLD-CDE                       22517013
225180*                  , :SUT00096-PRC-MSG-RPLN-NEW-IND               22518013
225200*             END-EXEC                                            22520013
225300*                                                                 22530013
225400*            END-EVALUATE                                         22540013
225500*    END-EVALUATE                                                 22550013
225600*                                                                 22560000
225700*    EVALUATE TRUE                                                22570013
225800*        WHEN SQLCODE = ZERO                                      22580013
225900*        WHEN SQLCODE = +100                                      22590013
226000*             CONTINUE                                            22600013
226100*        WHEN SQLCODE = -904                                      22610013
226200*        WHEN SQLCODE = -911                                      22620013
226300*        WHEN SQLCODE = -913                                      22630013
226400*            PERFORM 9900-SOFT-ABORT                              22640013
226500*        WHEN SQLWARN0 NOT = SPACE                                22650013
226600*        WHEN SQLCODE NOT = ZERO                                  22660013
226700*             MOVE '4310-FETCH-CURSOR'                            22670013
226800*                              TO DP013-PARAGRAPH                 22680013
226900*             MOVE 'FETCH MESSAGE CURSOR'                         22690013
227000*                              TO DP013-MESSAGE-TEXT (1)          22700013
227100*             MOVE SQLCA       TO DP013-SQLCA                     22710013
227200*             SET DP013-DB2-ABEND                                 22720013
227300*                              TO TRUE                            22730013
227400*             PERFORM DP013-0000-PROCESS-ABEND                    22740013
227500*    END-EVALUATE.                                                22750013
227600*                                                                 22760013
227700*    IF  SQLCODE EQUAL +100                                       22770013
227800*        SET ASC-NO-ITEMS-LEFT-ON-DB                              22780013
227900*                                  TO TRUE                        22790013
228000*    END-IF.                                                      22800013
228100                                                                  22810000
228101*CLP 07/06/2015 START                                             22810104
228110*----------------------------------------------------------------*22811002
228120*    FETCH THE TRAILER CURSOR.                                   *22812002
228130*----------------------------------------------------------------*22813002
228140 4311-FETCH.                                                      22814002
228150                                                                  22815002
228160     EVALUATE TRUE                                                22816002
228170         WHEN ASC-TRLR-STAT-LIST                                  22817002
228180             EVALUATE TRUE                                        22818002
228190             WHEN ASC-AREA-SEQ                                    22819002
228191                 EXEC SQL                                         22819102
228192                     FETCH TRLR-AREA-B-CSR                        22819202
228193                       INTO                                       22819302
228194                     :SUT00066-TRIP-OCRNC-ID                      22819410
228195                   , :SUT00066-BUS-AREA-ID                        22819510
228196                   , :SUT00066-BRND-ID                            22819611
228197                   , :SUT00066-UNT-QTY                            22819710
228198                   , :SUT00066-SKU-QTY                            22819810
228199                   , :SUT00066-CART-QTY                           22819910
228200                   , :SUT00066-RTL-DOL-AMT                        22820010
228201                   , :SUT00066-COST-DOL-AMT                       22820110
228202                   , :XLT00000-BUS-AREA-ID                        22820202
228203                   , :XLT00000-BUS-AREA-DESC                      22820302
228204                   , :XLT00043-BRND-ID                            22820402
228205                   , :XLT00043-BRND-DESC                          22820502
228206                   , :SUT00066-HNG-FOLD-CDE                       22820610
228207                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               22820710
228208                 END-EXEC                                         22820802
228209                                                                  22820902
228210             WHEN ASC-UNIT-SEQ                                    22821002
228211                 EXEC SQL                                         22821102
228212                     FETCH TRLR-UNIT-BRND-CSR                     22821202
228213                       INTO                                       22821302
228214                     :SUT00066-TRIP-OCRNC-ID                      22821410
228215                   , :SUT00066-BUS-AREA-ID                        22821510
228216                   , :SUT00066-BRND-ID                            22821611
228217                   , :SUT00066-UNT-QTY                            22821710
228218                   , :SUT00066-SKU-QTY                            22821810
228219                   , :SUT00066-CART-QTY                           22821910
228220                   , :SUT00066-RTL-DOL-AMT                        22822010
228221                   , :SUT00066-COST-DOL-AMT                       22822110
228222                   , :XLT00000-BUS-AREA-ID                        22822202
228223                   , :XLT00000-BUS-AREA-DESC                      22822302
228224                   , :XLT00043-BRND-ID                            22822402
228225                   , :XLT00043-BRND-DESC                          22822502
228226                   , :SUT00066-HNG-FOLD-CDE                       22822610
228227                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               22822710
228228                 END-EXEC                                         22822802
228229                                                                  22822902
228230             END-EVALUATE                                         22823002
228231                                                                  22823102
228232         WHEN ASC-BUSAREA-LIST                                    22823202
228233             EVALUATE TRUE                                        22823302
228234             WHEN ASC-AREA-SEQ                                    22823402
228235                 EXEC SQL                                         22823502
228236                 FETCH BUSAREA-AREA-B-CSR                         22823602
228237                 INTO                                             22823702
228238                     :SUT00066-TRIP-OCRNC-ID                      22823810
228239                   , :SUT00066-BUS-AREA-ID                        22823910
228240                   , :SUT00066-BRND-ID                            22824011
228241                   , :SUT00066-UNT-QTY                            22824110
228242                   , :SUT00066-SKU-QTY                            22824210
228243                   , :SUT00066-CART-QTY                           22824310
228244                   , :SUT00066-RTL-DOL-AMT                        22824410
228245                   , :SUT00066-COST-DOL-AMT                       22824510
228246                   , :XLT00000-BUS-AREA-ID                        22824602
228247                   , :XLT00000-BUS-AREA-DESC                      22824702
228248                   , :XLT00043-BRND-ID                            22824802
228249                   , :XLT00043-BRND-DESC                          22824902
228250                   , :SUT00066-HNG-FOLD-CDE                       22825010
228251                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               22825110
228252                 END-EXEC                                         22825202
228253                                                                  22825302
228254             WHEN ASC-UNIT-SEQ                                    22825402
228255              EXEC SQL                                            22825502
228256                 FETCH BUSAREA-UNIT-B-CSR                         22825602
228257                 INTO                                             22825702
228258                     :SUT00066-TRIP-OCRNC-ID                      22825810
228259                   , :SUT00066-BUS-AREA-ID                        22825910
228260                   , :SUT00066-BRND-ID                            22826011
228261                   , :SUT00066-UNT-QTY                            22826110
228262                   , :SUT00066-SKU-QTY                            22826210
228263                   , :SUT00066-CART-QTY                           22826310
228264                   , :SUT00066-RTL-DOL-AMT                        22826410
228265                   , :SUT00066-COST-DOL-AMT                       22826510
228266                   , :XLT00000-BUS-AREA-ID                        22826602
228267                   , :XLT00000-BUS-AREA-DESC                      22826702
228268                   , :XLT00043-BRND-ID                            22826802
228269                   , :XLT00043-BRND-DESC                          22826902
228270                   , :SUT00066-HNG-FOLD-CDE                       22827010
228271                   , :SUT00066-PRC-MSG-RPLN-NEW-IND               22827110
228272              END-EXEC                                            22827202
228273                                                                  22827302
228274             END-EVALUATE                                         22827402
228275     END-EVALUATE                                                 22827502
228276*                                                                 22827602
228277     EVALUATE TRUE                                                22827702
228278         WHEN SQLCODE = ZERO                                      22827802
228279         WHEN SQLCODE = +100                                      22827902
228280              CONTINUE                                            22828002
228281         WHEN SQLCODE = -904                                      22828102
228282         WHEN SQLCODE = -911                                      22828202
228283         WHEN SQLCODE = -913                                      22828302
228284             PERFORM 9900-SOFT-ABORT                              22828402
228285         WHEN SQLWARN0 NOT = SPACE                                22828502
228286         WHEN SQLCODE NOT = ZERO                                  22828602
228287              MOVE '4311-FETCH-CURSOR'                            22828702
228288                               TO DP013-PARAGRAPH                 22828802
228289              MOVE 'FETCH MESSAGE CURSOR'                         22828902
228290                               TO DP013-MESSAGE-TEXT (1)          22829002
228291              MOVE SQLCA       TO DP013-SQLCA                     22829102
228292              SET DP013-DB2-ABEND                                 22829202
228293                               TO TRUE                            22829302
228294              PERFORM DP013-0000-PROCESS-ABEND                    22829402
228295     END-EVALUATE.                                                22829502
228296                                                                  22829602
228297     IF  SQLCODE EQUAL +100                                       22829702
228298         SET ASC-NO-ITEMS-LEFT-ON-DB                              22829802
228299                                   TO TRUE                        22829902
228300     END-IF.                                                      22830002
228301*CLP 07/06/2015 END                                               22830104
228302                                                                  22830202
228303 EJECT                                                            22830300
228310*----------------------------------------------------------------*22831000
228400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *22840000
228500*----------------------------------------------------------------*22850000
228600                                                                  22860000
228700 4400-MOVE-COMMAREA-TO-SCREEN.                                    22870000
228800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             22880000
228900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          22890000
229000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          22900000
229100             MOVE +1    TO ASC-BLK-SUB                            22910000
229200             PERFORM 5100-WRITE-TEMP-STORAGE                      22920000
229300             ADD +1     TO ASC-BLK-SUB                            22930000
229400             PERFORM 5100-WRITE-TEMP-STORAGE                      22940000
229500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             22950000
229600                 GIVING PV-BLOCK-NUMBER                           22960000
229700                 REMAINDER PV-REMAINDER                           22970000
229800             IF  PV-REMAINDER > ZERO                              22980000
229900                 ADD +1 TO PV-BLOCK-NUMBER                        22990000
230000             END-IF                                               23000000
230100             MOVE +1    TO ASC-BLK-SUB                            23010000
230200             PERFORM 4410-READ-TEMP-STORAGE                       23020000
230300             ADD +1     TO ASC-BLK-SUB                            23030000
230400                           PV-BLOCK-NUMBER                        23040000
230500             PERFORM 4410-READ-TEMP-STORAGE                       23050000
230600     END-IF.                                                      23060000
230700     MOVE +1            TO ASC-BLK-SUB.                           23070000
230800     COMPUTE ASC-ITEM-SUB =                                       23080000
230900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23090000
231000         + PC-ITEMS-PER-PANEL).                                   23100000
231100*                                                                 23110000
231200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23120000
231300         ADD +1         TO ASC-BLK-SUB                            23130000
231400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23140000
231500     END-IF.                                                      23150000
231600*                                                                 23160000
231700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23170000
231800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23180000
231900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23190000
232000     PERFORM 4420-FORMAT-LIST-LINES                               23200000
232100         VARYING PV-SUB                                           23210000
232200         FROM PC-ITEMS-PER-PANEL BY -1                            23220000
232300         UNTIL PV-SUB < +1.                                       23230000
232400*                                                                 23240000
232500     COMPUTE ASC-ITEMS-DISPLAYED =                                23250000
232600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23260000
232700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23270000
232800                                      ASTRTITO.                   23280000
232900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23290000
233000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23300000
233100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            23310000
233200                                   TO ASELITO.                    23320000
233300*                                                                 23330000
233400     IF  DP020-MSG-NUMBER-X = SPACE                               23340000
233500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23350000
233600*            --- MORE ITEMS TO DISPLAY ----                       23360000
233700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23370000
233800             SET DP020-MSG-INFORMATIONAL TO TRUE                  23380000
233900         END-IF                                                   23390000
234000     END-IF.                                                      23400000
234100                                                                  23410000
      *CLP 07/06/2015 START                                             23410106
      *    IF ASC-USING--BRAND                                          23411013
      *        MOVE PC-BRAND-DESC           TO AHDESCO                  23412013
      *    ELSE                                                         23413013
      *        MOVE PC-PGM-DESC             TO AHDESCO                  23414013
      *    END-IF.                                                      23415013
      *CLP 07/06/2015 END                                               23415106
                                                                        23415213
           MOVE PC-BRAND-DESC               TO AHDESCO.                 23415313
                                                                        23416006
234200     MOVE ASC-STR-NBR                 TO ASTOREO.                 23420013
234300     MOVE ASC-STR-NAME                TO ASTNMEO.                 23430000
234400     MOVE ASC-SEQ-DESC                TO ASEQO.                   23440000
234500     MOVE ASC-SCAC                    TO ASCACO.                  23450000
234600     MOVE ASC-TRLR-SRL-NBR            TO ASERIALO                 23460000
234700     MOVE ASC-TRLR-ID                 TO ATRLRO.                  23470000
234800     MOVE ASC-TRIP-STAT-DESC          TO ASTATUSO.                23480000
234900     MOVE ASC-TOTAL-CARTONS           TO ACTNSO.                  23490000
235000     MOVE ASC-TOTAL-UNITS             TO AUNITSO.                 23500000
235010     MOVE ASC-PRINTER-DEST            TO APRTIDO.                 23501000
235100     MOVE ASC-SERVICE-DC-NAME         TO AOPERO                   23510000
235200     MOVE ASC-SUMMARY-DATE            TO ASUMDTEO.                23520000
235300     MOVE ASC-SUMMARY-TIME            TO ASUMTMEO.                23530000
235400                                                                  23540000
235500*----------------------------------------------------------------*23550000
235600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23560000
235700*----------------------------------------------------------------*23570000
235800                                                                  23580000
235900 4410-READ-TEMP-STORAGE.                                          23590000
236000                                                                  23600000
236100     EXEC CICS                                                    23610000
236200         READQ TS                                                 23620000
236300             QUEUE (ASC-LIST-QUEUE-NAME)                          23630000
236400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23640000
236500             ITEM  (PV-BLOCK-NUMBER)                              23650000
236600             RESP  (PV-CICS-RESP)                                 23660000
236700     END-EXEC.                                                    23670000
236800                                                                  23680000
236900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23690000
237000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23700000
237100         CONTINUE                                                 23710000
237200     ELSE                                                         23720000
237300         SET DP013-CICS-ABEND     TO TRUE                         23730000
237400         SET DP013-NO-ROLLBACK    TO TRUE                         23740000
237500         MOVE '4410-READ-TEMP-STORAGE'                            23750000
237600                                  TO DP013-PARAGRAPH              23760000
237700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      23770000
237800                                  TO DP013-MESSAGE-TEXT(1)        23780000
237900         PERFORM DP013-0000-PROCESS-ABEND                         23790000
238000     END-IF.                                                      23800000
238100                                                                  23810000
238200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             23820000
238300*                                                                 23830000
238400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         23840000
238500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               23850000
238600     END-IF.                                                      23860000
238700 EJECT                                                            23870000
238800*----------------------------------------------------------------*23880000
238900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *23890000
239000*----------------------------------------------------------------*23900000
239100                                                                  23910000
239200 4420-FORMAT-LIST-LINES.                                          23920000
239300     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      23930000
239400         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                23940000
239500         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           23950000
239800                                    MR-BUS-AREA-A (PV-SUB)        23980000
239810                                    MR-BRND-DESC-A (PV-SUB)       23981001
239900                                    MR-CARTONS-A (PV-SUB)         23990000
240000                                    MR-UNITS-A (PV-SUB)           24000000
240100                                    MR-SKU-COUNT-A (PV-SUB)       24010000
240200                                    MR-NEW-A (PV-SUB)             24020000
240210                                    MR-HANG-FOLD-A (PV-SUB)       24021000
240300         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           24030000
240400         MOVE SPACE              TO MR-SELECTI (PV-SUB)           24040000
240500                                    MR-ACTION (PV-SUB)            24050000
240600     ELSE                                                         24060000
240700         PERFORM 4420A-FILL-SCREEN                                24070000
240800*                                                                 24080000
240900         IF  DP030-SET-CURSOR-TRAILER                             24090000
241000             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24100000
241100                 > SPACE)                                         24110000
241200               OR (PV-SUB = 1))                                   24120000
241300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24130000
241400                MOVE -1          TO MR-SELECTL (PV-SUB)           24140000
241500             END-IF                                               24150000
241600         END-IF                                                   24160000
241700*                                                                 24170000
241800         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           24180000
241900             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           24190000
242000                                 TO MR-ACTION (PV-SUB)            24200000
242100         END-IF                                                   24210000
242200     END-IF.                                                      24220000
242300     SUBTRACT +1 FROM ASC-ITEM-SUB                                24230000
242400     IF  ASC-ITEM-SUB < + 1                                       24240000
242500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24250000
242600         MOVE +1                 TO ASC-BLK-SUB                   24260000
242700     END-IF.                                                      24270000
242800                                                                  24280000
242900 4420A-FILL-SCREEN.                                               24290000
243000     IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          24300000
243100                                                   > SPACE        24310000
243200         MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24320000
243300                                 TO MR-SELECTI (PV-SUB)           24330000
243400     ELSE                                                         24340000
243500         MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          24350000
243600                                 TO MR-SELECTI (PV-SUB)           24360000
243700     END-IF                                                       24370000
243800                                                                  24380000
243900                                                                  24390000
244110     MOVE ASC-BUS-AREA(ASC-BLK-SUB ASC-ITEM-SUB)                  24411000
244120                                      TO MR-BUS-AREA(PV-SUB).     24412000
244200     MOVE ASC-BRND-DESC(ASC-BLK-SUB ASC-ITEM-SUB)                 24420001
244300                                      TO MR-BRND-DESC(PV-SUB).    24430001
244600                                                                  24460000
244700     MOVE ASC-CART-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                  24470000
244800                                      TO MR-CARTONS(PV-SUB).      24480000
244900     MOVE ASC-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                   24490000
245000                                      TO MR-UNITS(PV-SUB).        24500000
245100     MOVE ASC-NEW(ASC-BLK-SUB ASC-ITEM-SUB)                       24510000
245200                                      TO MR-NEW(PV-SUB).          24520000
245300     MOVE ASC-SKU-COUNT(ASC-BLK-SUB ASC-ITEM-SUB)                 24530000
245400                                      TO MR-SKU-COUNT(PV-SUB).    24540000
245410     MOVE ASC-HANG-FOLD(ASC-BLK-SUB ASC-ITEM-SUB)                 24541000
245420                                      TO MR-HANG-FOLD(PV-SUB).    24542000
245500                                                                  24550000
245800******************************************************************24580000
245900** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24590000
246000** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24600000
246100** ISSUE A WARNING.                                             **24610000
246200******************************************************************24620000
246300 4430-CHECK-FOR-BEGIN-AND-END.                                    24630000
246400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24640000
246500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24650000
246600*            -- NO END-OF-RANGE SPECFIED ---                      24660000
246700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24670000
246800             SET DP020-MSG-WARNING TO TRUE                        24680000
246900             PERFORM 4431-POSITION-AT-WARNING                     24690000
247000         END-IF                                                   24700000
247100     ELSE                                                         24710000
247200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24720000
247300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                24730000
247400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            24740000
247500             SET DP020-MSG-WARNING TO TRUE                        24750000
247600             PERFORM 4431-POSITION-AT-WARNING                     24760000
247700         END-IF                                                   24770000
247800     END-IF.                                                      24780000
247900******************************************************************24790000
248000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **24800000
248100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **24810000
248200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **24820000
248300** POSITION THE CURSOR THERE.                                   **24830000
248400******************************************************************24840000
248500 4431-POSITION-AT-WARNING.                                        24850000
248600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24860000
248700                    - PV-TOP-ITEM + 1.                            24870000
248800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24880000
248900         CONTINUE                                                 24890000
249000     ELSE                                                         24900000
249100         SET DP030-SET-CURSOR-APPL-1                              24910000
249200                                   TO TRUE                        24920000
249300         MOVE -1                   TO MR-SELECTL (PV-SUB)         24930000
249400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24940000
249500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         24950000
249600     END-IF.                                                      24960000
249700*                                                                 24970000
249800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24980000
249900                    - PV-TOP-ITEM + 1.                            24990000
250000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25000000
250100         CONTINUE                                                 25010000
250200     ELSE                                                         25020000
250300         SET DP030-SET-CURSOR-APPL-1                              25030000
250400                                   TO TRUE                        25040000
250500         MOVE -1                   TO MR-SELECTL (PV-SUB)         25050000
250600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25060000
250700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         25070000
250800     END-IF.                                                      25080000
250900 EJECT                                                            25090000
251000*----------------------------------------------------------------*25100000
251100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *25110000
251200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *25120000
251300* FOR THE SELECTED ITEMS QUEUE.                                  *25130000
251400*                                                                *25140000
251500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *25150000
251600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *25160000
251700* THE ARRAY IS FULL.                                             *25170000
251800*----------------------------------------------------------------*25180000
251900                                                                  25190000
252000 5000-PREPARE-SEL-QUEUE.                                          25200000
252100                                                                  25210000
252200     MOVE +1                   TO  ASC-BLK-SUB.                   25220000
252300     PERFORM 5100-WRITE-TEMP-STORAGE.                             25230000
252400     ADD +1                    TO  ASC-BLK-SUB.                   25240000
252500     PERFORM 5100-WRITE-TEMP-STORAGE.                             25250000
252600                                                                  25260000
252700     MOVE ASC-SEL-QUEUE-NAME-OUT TO  SU012-SEL-QUEUE-NAME.        25270000
252800     PERFORM 6010-DELETE-SEL-QUEUE.                               25280000
252900                                                                  25290000
253000     SET ASC-UPDATE-TSQ        TO  TRUE.                          25300000
253100                                                                  25310000
253200     SET SU013-IDX             TO  1.                             25320000
253300     MOVE ZERO                 TO SU012-NUMBER-OF-TS-ITEMS.       25330000
253400     INITIALIZE SU013-SELECTED-ITEM-ARRAY.                        25340000
253500                                                                  25350000
253600     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25360000
253700             VARYING PV-ITEM                                      25370000
253800             FROM 1 BY 1                                          25380000
253900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25390000
254000                                                                  25400000
254100     IF  SU013-IDX > 1                                            25410000
254200         PERFORM 5205-WRITE-SEL-QUEUE                             25420000
254300         ADD +1                TO SU012-NUMBER-OF-TS-ITEMS        25430000
254400     END-IF.                                                      25440000
254500/                                                                 25450000
254600*----------------------------------------------------------------*25460000
254700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25470000
254800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25480000
254900*----------------------------------------------------------------*25490000
255000                                                                  25500000
255100 5100-WRITE-TEMP-STORAGE.                                         25510000
255200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25520000
255300                                   TO PV-LIST-ITEM-NUMBER.        25530000
255400     COMPUTE PV-BLOCK-NUMBER =                                    25540000
255500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25550000
255600                                                                  25560000
255700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25570000
255800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25580000
255900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25590000
256000             PERFORM 5105-REWRITE-ASC-LISTQ                       25600000
256100         END-IF                                                   25610000
256200     ELSE                                                         25620000
256300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25630000
256400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25640000
256500         PERFORM 5110-WRITE-ASC-LISTQ                             25650000
256600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25660000
256700     END-IF.                                                      25670000
256800                                                                  25680000
256900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25690000
257000******************************************************************25700000
257100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25710000
257200** SPECIFIC COMMAREA.                                           **25720000
257300******************************************************************25730000
257400 5105-REWRITE-ASC-LISTQ.                                          25740000
257500     EXEC CICS                                                    25750000
257600         WRITEQ TS                                                25760000
257700             QUEUE (ASC-LIST-QUEUE-NAME)                          25770000
257800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25780000
257900             ITEM  (PV-BLOCK-NUMBER)                              25790000
258000             REWRITE                                              25800000
258100             RESP  (PV-CICS-RESP)                                 25810000
258200     END-EXEC.                                                    25820000
258300                                                                  25830000
258400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           25840000
258500         CONTINUE                                                 25850000
258600     ELSE                                                         25860000
258700         SET DP013-CICS-ABEND            TO TRUE                  25870000
258800         SET DP013-NO-ROLLBACK           TO TRUE                  25880000
258900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       25890000
259000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     25900000
259100                                         TO DP013-MESSAGE-TEXT(1) 25910000
259200         PERFORM DP013-0000-PROCESS-ABEND                         25920000
259300     END-IF.                                                      25930000
259400                                                                  25940000
259500******************************************************************25950000
259600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **25960000
259700** SPECIFIC COMMAREA.                                           **25970000
259800******************************************************************25980000
259900 5110-WRITE-ASC-LISTQ.                                            25990000
260000     EXEC CICS                                                    26000000
260100         WRITEQ TS                                                26010000
260200             QUEUE (ASC-LIST-QUEUE-NAME)                          26020000
260300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26030000
260400             ITEM  (PV-BLOCK-NUMBER)                              26040000
260500             RESP  (PV-CICS-RESP)                                 26050000
260600     END-EXEC.                                                    26060000
260700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26070000
260800         SET DP013-CICS-ABEND      TO TRUE                        26080000
260900         SET DP013-NO-ROLLBACK     TO TRUE                        26090000
261000         MOVE '5110-WRITE-ASC-LISTQ'                              26100000
261100                                   TO DP013-PARAGRAPH             26110000
261200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           26120000
261300                                   TO DP013-MESSAGE-TEXT(1)       26130000
261400         PERFORM DP013-0000-PROCESS-ABEND                         26140000
261500     END-IF.                                                      26150000
261600 EJECT                                                            26160000
261700*----------------------------------------------------------------*26170000
261800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *26180000
261900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26190000
262000*----------------------------------------------------------------*26200000
262100                                                                  26210000
262200 5200-FILL-SEL-QUEUE-RECORD.                                      26220000
262300                                                                  26230000
262400                                                                  26240000
262500     PERFORM 6112-READ-LIST-QUEUE.                                26250000
262600                                                                  26260000
262700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26270000
262800         PERFORM                                                  26280000
262900         VARYING LQW-IDX                                          26290000
263000         FROM 1 BY 1                                              26300000
263100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26310000
263200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26320000
263300                                                                  26330000
263400             IF  LQW-SELECT (LQW-IDX)                             26340000
263500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              26350000
263600                                   TO SU013-ITEM (SU013-IDX)      26360000
263700                 MOVE SPACE        TO SU013-ACTION-SW (SU013-IDX) 26370000
263800                 MOVE ASC-TRIP-OCRNC-ID   TO SU013-TRIP-OCRNC-ID  26380000
263900                                         (SU013-IDX)              26390000
264000                 MOVE ASC-BUS-AREA-ID     TO SU013-BUS-GP-NBR     26400000
264100                                         (SU013-IDX)              26410000
264200                 MOVE ASC-OTBND-TRIP-ID TO SU013-TRIP-ID          26420000
264300                                         (SU013-IDX)              26430000
264400                 MOVE ASC-SCAC        TO SU013-SCAC (SU013-IDX)   26440000
264500                 MOVE ASC-TRLR-ID     TO SU013-TRLR-ID(SU013-IDX) 26450000
264600                 MOVE ASC-SERIAL      TO SU013-TRLR-SRL-NBR       26460000
264700                                         (SU013-IDX)              26470000
264800                 MOVE ASC-TRAILER-STAT TO SU013-TRIP-STAT-DESC    26480000
264900                                         (SU013-IDX)              26490000
265000                 MOVE ASC-STAT-DATE   TO SU013-STAT-DATE          26500000
265100                                         (SU013-IDX)              26510000
265200                                                                  26520000
265300*              LOAD SELECTIONS TO SEL-QUEUE                       26530000
265400*                MOVE LQW-DEPT (LQW-IDX)                          26540000
265500*                                     TO SU013-DEPT-NBR           26550000
265600*                                        (SU013-IDX)              26560000
265700                 MOVE LQW-MDSE-DESC (LQW-IDX)                     26570000
265800                                      TO SU013-DEPT-NAME          26580000
265900                                         (SU013-IDX)              26590000
266000*                MOVE LQW-AD(LQW-IDX)                             26600000
266100*                                     TO SU013-AD-MDSE-IND        26610000
266200*                                        (SU013-IDX)              26620000
266300                                                                  26630000
266400*                MOVE LQW-PCT-FULL(LQW-IDX)                       26640000
266500*                                     TO SU013-CAPCTY-PCT         26650000
266600*                                        (SU013-IDX)              26660000
266700*                MOVE LQW-JEWELRY(LQW-IDX)                        26670000
266800*                                     TO SU013-JWLRY-IND          26680000
266900*                                        (SU013-IDX)              26690000
267000*                MOVE LQW-OTBND-TRIP-ID(LQW-IDX)                  26700000
267100*                                     TO SU013-TRIP-ID            26710000
267200*                                        (SU013-IDX)              26720000
267300*                MOVE LQW-TRIP-STAT-CDE(LQW-IDX)                  26730000
267400*                                     TO SU013-TRIP-STAT-CDE      26740000
267500*                                        (SU013-IDX)              26750000
267600*                MOVE LQW-CRE-TMST(LQW-IDX)                       26760000
267700*                                     TO SU013-SUMMARY-TMST       26770000
267800*                                        (SU013-IDX)              26780000
267900                 MOVE LQW-UNITS (LQW-IDX)                         26790000
268000                                      TO SU013-UNIT-COUNT         26800000
268100                                         (SU013-IDX)              26810000
268200                 MOVE LQW-CARTONS (LQW-IDX)                       26820000
268300                                      TO SU013-CARTON-CNT         26830000
268400                                         (SU013-IDX)              26840000
268500                                                                  26850000
268600                 SET SU013-IDX UP BY 1                            26860000
268700                 IF  SU013-IDX > SU013-MAX-ITEMS                  26870000
268800                     PERFORM 5205-WRITE-SEL-QUEUE                 26880000
268900                     ADD +1        TO SU012-NUMBER-OF-TS-ITEMS    26890000
269000                     INITIALIZE SU013-SELECTED-ITEM-ARRAY         26900000
269100                     SET SU013-IDX TO  1                          26910000
269200                 END-IF                                           26920000
269300             END-IF                                               26930000
269400         END-PERFORM                                              26940000
269500     END-IF.                                                      26950000
269600                                                                  26960000
269700*----------------------------------------------------------------*26970000
269800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *26980000
269900*----------------------------------------------------------------*26990000
270000                                                                  27000000
270100 5205-WRITE-SEL-QUEUE.                                            27010000
270200                                                                  27020000
270300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27030000
270400                                   TO SU013-SELECTED-ITEMS.       27040000
270500                                                                  27050000
270600     EXEC CICS                                                    27060000
270700          WRITEQ TS                                               27070000
270800              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      27080000
270900              FROM  (SU013-SELECT-RECORD)                         27090000
271000              ITEM  (PV-SEL-QUEUE-ITEM)                           27100000
271100              RESP  (PV-CICS-RESP)                                27110000
271200     END-EXEC.                                                    27120000
271300                                                                  27130000
271400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27140000
271500         CONTINUE                                                 27150000
271600     ELSE                                                         27160000
271700         SET DP013-CICS-ABEND      TO TRUE                        27170000
271800         SET DP013-NO-ROLLBACK     TO TRUE                        27180000
271900         MOVE '5205-WRITE-SEL-QUEUE'                              27190000
272000                                   TO DP013-PARAGRAPH             27200000
272100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27210000
272200                                   TO DP013-MESSAGE-TEXT(1)       27220000
272300         PERFORM DP013-0000-PROCESS-ABEND                         27230000
272400     END-IF.                                                      27240000
272500 EJECT                                                            27250000
272600******************************************************************27260000
272700** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27270000
272800** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27280000
272900** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27290000
273000** THE USER.                                                    **27300000
273100******************************************************************27310000
273200 6000-REFRESH-PANEL-FROM-TEMP.                                    27320000
273300     IF  ASC-UPDATE-TSQ                                           27330000
273400         SET ASC-NO-TSQ-UPDATE TO TRUE                            27340000
273500         MOVE ZERO                 TO PV-SAVE-ITEM                27350000
273600                                      PV-SEL-QUEUE-ITEM           27360000
273700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27370000
273800                                   TO PV-HOLD-SELECTED-ITEMS      27380000
273900         MOVE +1                   TO PV-ITEMS-PROCESSED          27390000
274000         PERFORM 6100-UPDATE-TSQ                                  27400000
274100             UNTIL PV-ITEMS-PROCESSED >                           27410000
274200                                     PV-HOLD-SELECTED-ITEMS       27420000
274300         PERFORM 6010-DELETE-SEL-QUEUE                            27430000
274400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27440000
274500                    ASC-BLOCK-ENTRIES (2)                         27450000
274600     END-IF.                                                      27460000
274700                                                                  27470000
274800*----------------------------------------------------------------*27480000
274900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27490000
275000*----------------------------------------------------------------*27500000
275100 6010-DELETE-SEL-QUEUE.                                           27510000
275200                                                                  27520000
275300     EXEC CICS                                                    27530000
275400         DELETEQ TS                                               27540000
275500             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       27550000
275600             RESP  (PV-CICS-RESP)                                 27560000
275700     END-EXEC.                                                    27570000
275800*                                                                 27580000
275900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      27590000
276000        (PV-CICS-RESP = DFHRESP(QIDERR)))                         27600000
276100         CONTINUE                                                 27610000
276200     ELSE                                                         27620000
276300         SET DP013-CICS-ABEND TO TRUE                             27630000
276400         SET DP013-NO-ROLLBACK TO TRUE                            27640000
276500         MOVE '6010-DELETE-SEL-QUEUE'                             27650000
276600                        TO DP013-PARAGRAPH                        27660000
276700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         27670000
276800                        TO DP013-MESSAGE-TEXT (1)                 27680000
276900         PERFORM DP013-0000-PROCESS-ABEND                         27690000
277000     END-IF.                                                      27700000
277100                                                                  27710000
277200*----------------------------------------------------------------*27720000
277300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *27730000
277400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *27740000
277500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *27750000
277600*    THE TEMP QUEUE.                                             *27760000
277700*----------------------------------------------------------------*27770000
277800                                                                  27780000
277900 6100-UPDATE-TSQ.                                                 27790000
278000                                                                  27800000
278100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             27810000
278200     PERFORM 6105-READ-SEL-QUEUE.                                 27820000
278300     PERFORM                                                      27830000
278400         VARYING SU013-IDX                                        27840000
278500         FROM 1 BY 1                                              27850000
278600         UNTIL ((PV-ITEMS-PROCESSED >                             27860000
278700                              PV-HOLD-SELECTED-ITEMS)             27870000
278800         OR (SU013-IDX GREATER THAN SU013-MAX-ITEMS))             27880000
278900         IF  SU013-ACTION-SW (SU013-IDX) > SPACE                  27890000
279000             PERFORM 6110-PROCESS-ITEMS                           27900000
279100         END-IF                                                   27910000
279200         ADD +1                TO PV-ITEMS-PROCESSED              27920000
279300     END-PERFORM.                                                 27930000
279400     PERFORM 6111-WRITE-LIST-QUEUE.                               27940000
279500*----------------------------------------------------------------*27950000
279600*    READ THE LIST QUEUE RECORD.                                 *27960000
279700*----------------------------------------------------------------*27970000
279800                                                                  27980000
279900 6105-READ-SEL-QUEUE.                                             27990000
280000                                                                  28000000
280100     EXEC CICS                                                    28010000
280200          READQ TS                                                28020000
280300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      28030000
280400              INTO  (SU013-SELECT-RECORD)                         28040000
280500              ITEM  (PV-SEL-QUEUE-ITEM)                           28050000
280600              RESP  (PV-CICS-RESP)                                28060000
280700     END-EXEC.                                                    28070000
280800*                                                                 28080000
280900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28090000
281000         CONTINUE                                                 28100000
281100     ELSE                                                         28110000
281200         SET DP013-CICS-ABEND      TO  TRUE                       28120000
281300         SET DP013-NO-ROLLBACK     TO  TRUE                       28130000
281400         MOVE '6105-READ-SEL-QUEUE'                               28140000
281500                                   TO  DP013-PARAGRAPH            28150000
281600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28160000
281700                                   TO  DP013-MESSAGE-TEXT(1)      28170000
281800         PERFORM DP013-0000-PROCESS-ABEND                         28180000
281900     END-IF.                                                      28190000
282000 EJECT                                                            28200000
282100*----------------------------------------------------------------*28210000
282200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28220000
282300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28230000
282400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28240000
282500*----------------------------------------------------------------*28250000
282600                                                                  28260000
282700 6110-PROCESS-ITEMS.                                              28270000
282800                                                                  28280000
282900     COMPUTE PV-ITEM = 1 + ((SU013-ITEM (SU013-IDX) - 1)          28290000
283000                     / PC-ITEMS-PER-PANEL).                       28300000
283100                                                                  28310000
283200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28320000
283300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28330000
283400             PERFORM 6111-WRITE-LIST-QUEUE                        28340000
283500         END-IF                                                   28350000
283600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28360000
283700                                                                  28370000
283800         PERFORM 6112-READ-LIST-QUEUE                             28380000
283900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28390000
284000             CONTINUE                                             28400000
284100         END-IF                                                   28410000
284200     END-IF.                                                      28420000
284300                                                                  28430000
284400     COMPUTE PV-SUB = (SU013-ITEM (SU013-IDX)                     28440000
284500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28450000
284600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28460000
284700     MOVE LQW-SELECTED-SW (PV-SUB)                                28470000
284800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28480000
284900     EVALUATE TRUE                                                28490000
285000         WHEN SU013-INQ (SU013-IDX)                               28500000
285100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28510000
285200                                                                  28520000
285300         WHEN SU013-UPD (SU013-IDX)                               28530000
285400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28540000
285500                                                                  28550000
285600         WHEN SU013-DEL (SU013-IDX)                               28560000
285700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28570000
285800                                                                  28580000
285900         WHEN SU013-ERR (SU013-IDX)                               28590000
286000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28600000
286100     END-EVALUATE.                                                28610000
286200                                                                  28620000
286300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28630000
286400                                                                  28640000
286500*----------------------------------------------------------------*28650000
286600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28660000
286700*----------------------------------------------------------------*28670000
286800                                                                  28680000
286900 6111-WRITE-LIST-QUEUE.                                           28690000
287000                                                                  28700000
287100     EXEC CICS                                                    28710000
287200         WRITEQ TS                                                28720000
287300             QUEUE (ASC-LIST-QUEUE-NAME)                          28730000
287400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     28740000
287500             ITEM  (PV-SAVE-ITEM)                                 28750000
287600             REWRITE                                              28760000
287700             RESP  (PV-CICS-RESP)                                 28770000
287800     END-EXEC.                                                    28780000
287900*                                                                 28790000
288000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28800000
288100         CONTINUE                                                 28810000
288200     ELSE                                                         28820000
288300         SET DP013-CICS-ABEND  TO  TRUE                           28830000
288400         SET DP013-NO-ROLLBACK TO  TRUE                           28840000
288500         MOVE '6111-WRITE-LIST-QUEUE'                             28850000
288600                               TO  DP013-PARAGRAPH                28860000
288700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  28870000
288800                               TO  DP013-MESSAGE-TEXT(1)          28880000
288900         PERFORM DP013-0000-PROCESS-ABEND                         28890000
289000     END-IF.                                                      28900000
289100                                                                  28910000
289200 EJECT                                                            28920000
289300*----------------------------------------------------------------*28930000
289400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*28940000
289500*----------------------------------------------------------------*28950000
289600                                                                  28960000
289700 6112-READ-LIST-QUEUE.                                            28970000
289800                                                                  28980000
289900     EXEC CICS                                                    28990000
290000         READQ TS                                                 29000000
290100             QUEUE (ASC-LIST-QUEUE-NAME)                          29010000
290200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29020000
290300             ITEM  (PV-ITEM)                                      29030000
290400             RESP  (PV-CICS-RESP)                                 29040000
290500     END-EXEC.                                                    29050000
290600*                                                                 29060000
290700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29070000
290800         CONTINUE                                                 29080000
290900     ELSE                                                         29090000
291000         SET DP013-CICS-ABEND        TO TRUE                      29100000
291100         SET DP013-NO-ROLLBACK       TO TRUE                      29110000
291200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29120000
291300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29130000
291400                                     TO DP013-MESSAGE-TEXT(1)     29140000
291500         PERFORM DP013-0000-PROCESS-ABEND                         29150000
291600     END-IF.                                                      29160000
291700/                                                                 29170000
291800 7000-SELECT-SERVICING-DC.                                        29180000
291900                                                                  29190000
292000     EXEC SQL                                                     29200000
292100         SELECT  STR.LOC_NM                                       29210000
292200             ,   STR.LOC_NBR                                      29220000
292300         INTO                                                     29230000
292400                :XLT00010-LOC-NM                                  29240000
292500             ,  :XLT00010-LOC-NBR                                 29250000
292600         FROM  TSUOBTR OBTR                                       29260000
292700             , XLT_LOC STR                                        29270000
292800         WHERE OBTR.ORGN_OPER_UNT_ID  =   STR.LOC_NBR             29280000
292900         AND   OBTR.OTBND_TRIP_ID     =  :DK-OTBND-TRIP-ID        29290000
293000     END-EXEC.                                                    29300000
293100                                                                  29310000
293200     EVALUATE TRUE                                                29320000
293300         WHEN SQLCODE = ZERO                                      29330000
293400              MOVE XLT00010-LOC-NM    TO  ASC-SERVICE-DC-NAME     29340000
293500         WHEN SQLCODE = +100                                      29350000
293600              MOVE SPACES              TO XLT00010-LOC-NM         29360000
293700                                          ASC-SERVICE-DC-NAME     29370000
293800         WHEN SQLCODE = -904                                      29380000
293900         WHEN SQLCODE = -911                                      29390000
294000         WHEN SQLCODE = -913                                      29400000
294100             PERFORM 9900-SOFT-ABORT                              29410000
294200         WHEN SQLWARN0 NOT = SPACE                                29420000
294300         WHEN SQLCODE NOT = ZERO                                  29430000
294400              MOVE '7000-SELECT-SERVICING-DC'                     29440000
294500                               TO DP013-PARAGRAPH                 29450000
294600              MOVE 'SELECT'    TO DP013-MESSAGE-TEXT (1)          29460000
294700              MOVE SQLCA       TO DP013-SQLCA                     29470000
294800              SET DP013-DB2-ABEND                                 29480000
294900                               TO TRUE                            29490000
295000              PERFORM DP013-0000-PROCESS-ABEND                    29500000
295100     END-EVALUATE.                                                29510000
295200                                                                  29520000
295300 7001-CONVERT-DATES.                                              29530000
295400                                                                  29540000
295500     MOVE SU013-SUMMARY-TIME (ASC-SEL-SUB)                        29550000
295600                                   TO PV-TIME                     29560000
295700     MOVE SU013-SUMMARY-DATE (ASC-SEL-SUB)                        29570000
295800                                   TO PV-DATE                     29580000
295900                                                                  29590000
296000     EXEC SQL                                                     29600000
296100      SELECT                                                      29610000
296200         CHAR ( DATE (:PV-DATE),USA)                              29620000
296300     ,   CHAR ( TIME (:PV-TIME),JIS)                              29630000
296400      INTO                                                        29640000
296500         :ASC-SUMMARY-DATE                                        29650000
296600     ,   :ASC-SUMMARY-TIME                                        29660000
296700     FROM SYSIBM.SYSDUMMY1                                        29670000
296800     END-EXEC.                                                    29680000
296900                                                                  29690000
297000     EVALUATE TRUE                                                29700000
297100         WHEN SQLCODE = ZERO                                      29710000
297200             CONTINUE                                             29720000
297300         WHEN SQLCODE = -180                                      29730000
297400              MOVE SPACES      TO ASC-SUMMARY-DATE                29740000
297500                                  ASC-SUMMARY-TIME                29750000
297600         WHEN SQLCODE = -904                                      29760000
297700         WHEN SQLCODE = -911                                      29770000
297800         WHEN SQLCODE = -913                                      29780000
297900             PERFORM 9900-SOFT-ABORT                              29790000
298000         WHEN SQLWARN0 NOT = SPACE                                29800000
298100         WHEN SQLCODE NOT = ZERO                                  29810000
298200              MOVE '7001-CONVERT-DATES'                           29820000
298300                               TO DP013-PARAGRAPH                 29830000
298400              MOVE 'SELECT'    TO DP013-MESSAGE-TEXT (1)          29840000
298500              MOVE SQLCA       TO DP013-SQLCA                     29850000
298600              SET DP013-DB2-ABEND                                 29860000
298700                               TO TRUE                            29870000
298800              PERFORM DP013-0000-PROCESS-ABEND                    29880000
298900     END-EVALUATE.                                                29890000
299000/                                                                 29900000
299010*----------------------------------------------------------------*29901000
299020*    START TRANID FOR SUKCS547 REPORT                             29902000
299030*----------------------------------------------------------------*29903000
299040 7100-START-TRANID-S547.                                          29904000
299050                                                                  29905000
299060     MOVE LENGTH OF SU083-COMM-AREA   TO PV-COMMAREA-LENGTH       29906000
299070                                                                  29907000
299080     EXEC CICS                                                    29908000
299090         START TRANSID ('S547')                                   29909000
299091         FROM     (SU083-COMM-AREA)                               29909100
299092         LENGTH   (PV-COMMAREA-LENGTH)                            29909200
299093     END-EXEC.                                                    29909300
299094/                                                                 29909400
299095*----------------------------------------------------------------*29909500
299100 9100-READ-SEL-QUEUE.                                             29910000
299200     EXEC CICS                                                    29920000
299300         READQ TS                                                 29930000
299400             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        29940000
299500             INTO  (SU013-SELECT-RECORD)                          29950000
299600             ITEM  (ASC-SEL-ITEM)                                 29960000
299700             RESP  (PV-CICS-RESP)                                 29970000
299800     END-EXEC.                                                    29980000
299900                                                                  29990000
300000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       30000000
300100         CONTINUE                                                 30010000
300200     ELSE                                                         30020000
300300         SET DP013-LOGIC-ABEND                                    30030000
300400             DP013-NO-ROLLBACK     TO TRUE                        30040000
300500         MOVE '9100-READ-SEL-QUEUE'                               30050000
300600                                   TO DP013-PARAGRAPH             30060000
300700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   30070000
300800                                   TO DP013-MESSAGE-TEXT (1)      30080000
300900         PERFORM DP013-0000-PROCESS-ABEND                         30090000
301000     END-IF.                                                      30100000
301100/                                                                 30110000
301200*-----------------------------------------------------------      30120000
301300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.        30130000
301400*-----------------------------------------------------------      30140000
301500 9200-REWRITE-LIST-QUEUE.                                         30150000
301600           EXEC CICS                                              30160000
301700                WRITEQ TS                                         30170000
301800                    QUEUE  (ASC-SEL-QUEUE-NAME-IN)                30180000
301900                    FROM   (SU013-SELECT-RECORD)                  30190000
302000                    ITEM   (ASC-SEL-ITEM)                         30200000
302100                    RESP   (PV-CICS-RESP)                         30210000
302200                    REWRITE                                       30220000
302300           END-EXEC.                                              30230000
302400                                                                  30240000
302500     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   30250000
302600         SET DP013-CICS-ABEND                                     30260000
302700             DP013-NO-ROLLBACK     TO TRUE                        30270000
302800         MOVE '9200-REWRITE-LIST-QUEUE'                           30280000
302900                                         TO DP013-PARAGRAPH       30290000
303000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30300000
303100                                         TO DP013-MESSAGE-TEXT (1)30310000
303200         PERFORM DP013-0000-PROCESS-ABEND                         30320000
303300     END-IF.                                                      30330000
303400                                                                  30340000
303500 9900-SOFT-ABORT.                                                 30350000
303600     SET PS-ERROR         TO TRUE.                                30360000
303700     SET DP020-MSG-FATAL  TO TRUE.                                30370000
303800     MOVE 'THROUGH SOFT-ABORT PARA'                               30380000
303900                            TO DP013-MESSAGE-TEXT (1)             30390000
304000     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    30400000
304100     IF PS-NO-NEXT-SCREEN                                         30410000
304200         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    30420000
304300     END-IF.                                                      30430000
304400                                                                  30440000
304500     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          30450000
304600     PERFORM 0001-CALL-CICS-ARCH-API.                             30460000
304700                                                                  30470000
304800 EJECT                                                            30480000
304900*----------------------------------------------------------------*30490000
305000*    ABEND PROCESSOR MODULE                                      *30500000
305100*----------------------------------------------------------------*30510000
305200                                                                  30520000
305300     COPY DPPD013.                                                30530000
