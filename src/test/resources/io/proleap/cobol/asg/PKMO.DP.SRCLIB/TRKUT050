00001 *                                                                 00010009
00002 *                                                                 00020009
00003 *                                                                 00030009
00004  IDENTIFICATION DIVISION.                                         00040009
00005                                                                   00050009
00006  PROGRAM-ID.              TRKUT050.                               00060014
00007  AUTHOR.                  STEVE FLUNKER.                          00070009
00008  INSTALLATION.            KOHLS DEPARTMENT STORES.                00080009
00009  DATE-WRITTEN.            06/14/96.                               00090009
00010  DATE-COMPILED.                                                   00100009
00011                                                                   00110009
00012 ******************************************************************00120009
00013 *   THIS INCREMENTS THE CONTROL NUMBERS AND UPDATE DATE/TIME INFO 00130009
00014 *   FOR THE 1 PROPRIETARY 850 DOCUMENT INTERCHANGE HEADERS.       00140009
00015 *  (850 IS A PO SPLIT INFO TO OUR IMPORT DECONSOLIDATOR)          00150009
00016 ******************************************************************00160009
0201JF* 02-16-2001 JON FIEDLER 0201JF                                   00170009
0201JF* CHANGED THE RECORD LENGTH OF THE INPUT FILES AND OUTPUT FILES TO00180009
0201JF* 254.                                                            00190009
      *                                                                 00200009
112501* 11-25-2001 COLLEEN WYSOCKI                                      00210009
112501* CHANGED LOGIC TO USE A CONTROL CARD AS INPUT.  THE CONTROL CARD 00220009
112501* CONTAINS THE CONTROL NUMBER, TRIANGLE EAST TRADING PARTNER ID   00230009
112501* AND TRIANGLE GALE TRADING PARTNER ID.  THE PROGRAM WILL CREATE  00240009
112501* EDI ENVELOPING SEGMENTS (ISA/IEA) FOR BOTH TRADING PARTNERS.    00250009
      ******************************************************************00260009
00020  ENVIRONMENT DIVISION.                                            00270009
00021 *                                                                 00280009
00022 *                                                                 00290009
00023  CONFIGURATION SECTION.                                           00300009
00024                                                                   00310009
00025  SOURCE-COMPUTER. IBM-3090.                                       00320009
00026  OBJECT-COMPUTER. IBM-3090.                                       00330009
00027 *                                                                 00340009
00028 *                                                                 00350009
00029  INPUT-OUTPUT SECTION.                                            00360009
00030                                                                   00370009
00031  FILE-CONTROL.                                                    00380009
00032                                                                   00390009
112501                                                                  00400009
112501     SELECT PARM-FILE-IN                                          00401009
112501         ASSIGN TO INP01.                                         00402009
112501                                                                  00403009
112501     SELECT PARM-FILE-OUT                                         00404009
112501         ASSIGN TO OUT01.                                         00405009
112501                                                                  00406009
112501     SELECT DCONSLR-LOC1-ISA-FILE                                 00407012
112501         ASSIGN TO OUT02.                                         00408009
112501                                                                  00409009
112501     SELECT DCONSLR-LOC2-ISA-FILE                                 00410012
112501         ASSIGN TO OUT03.                                         00420009
112501                                                                  00430009
112501     SELECT DCONSLR-IEA-FILE                                      00440012
112501         ASSIGN TO OUT04.                                         00450009
00093 *                                                                 00460009
00094 *                                                                 00470009
00095  DATA DIVISION.                                                   00480009
00096 *                                                                 00490009
00097 *                                                                 00500009
00098  FILE SECTION.                                                    00510009
00099                                                                   00520009
00100  FD  PARM-FILE-IN                                                 00530009
00101      RECORDING MODE IS F                                          00540009
00102      BLOCK CONTAINS 0 RECORDS                                     00550009
00103      LABEL RECORDS ARE STANDARD.                                  00560009
00104                                                                   00570009
       01  PARM-RECORD-IN                   PIC X(80).                  00580009
00106 *                                                                 00590009
00100  FD  PARM-FILE-OUT                                                00600009
00101      RECORDING MODE IS F                                          00610009
00102      BLOCK CONTAINS 0 RECORDS                                     00620009
00103      LABEL RECORDS ARE STANDARD.                                  00630009
00104                                                                   00640009
       01  PARM-RECORD-OUT                  PIC X(80).                  00650009
00106 *                                                                 00660009
00107  FD  DCONSLR-LOC1-ISA-FILE                                        00670012
00108      RECORDING MODE IS F                                          00680009
00109      BLOCK CONTAINS 0 RECORDS                                     00690009
00110      LABEL RECORDS ARE STANDARD.                                  00700009
00111                                                                   00710009
       01  DCONSLR-LOC1-ISA-RECORD          PIC X(254).                 00720012
00169 *                                                                 00730009
00107  FD  DCONSLR-LOC2-ISA-FILE                                        00740012
00108      RECORDING MODE IS F                                          00750009
00109      BLOCK CONTAINS 0 RECORDS                                     00760009
00110      LABEL RECORDS ARE STANDARD.                                  00770009
00111                                                                   00780009
       01  DCONSLR-LOC2-ISA-RECORD          PIC X(254).                 00790012
00169 *                                                                 00800009
00171  FD  DCONSLR-IEA-FILE                                             00810012
00172      RECORDING MODE IS F                                          00820009
00173      BLOCK CONTAINS 0 RECORDS                                     00830009
00174      LABEL RECORDS ARE STANDARD.                                  00840009
00175                                                                   00850009
       01  DCONSLR-IEA-RECORD               PIC X(254).                 00860012
00177 *                                                                 00870009
00241 *                                                                 00880009
00242  WORKING-STORAGE SECTION.                                         00890009
00243                                                                   00900009
00244 ****************************************************************  00910009
00245 *    THIS IS THE LAYOUT FOR THE PARM FILE.                        00920009
00246 ****************************************************************  00930009
00247   01  WS-PARM-RECORD-LAYOUT.                                      00940009
00248       05  WS-CONTROL-NUMBER                PIC 9(09).             00950009
00249       05  WS-LOC1-TP-QUAL                  PIC X(02).             00960012
00249       05  WS-LOC1-TP-ID                    PIC X(15).             00970012
00249       05  WS-LOC2-TP-QUAL                  PIC X(02).             00980012
00249       05  WS-LOC2-TP-ID                    PIC X(15).             00990012
00249       05  WS-TEST-INDICATOR                PIC X(01).             01000009
00252       05  FILLER                           PIC X(36).             01010009
00244 ****************************************************************  01020009
00245 *    THIS IS THE LAYOUT FOR THE ISA RECORD.                       01030009
00246 ****************************************************************  01040009
00247   01  WS-ISA-RECORD-LAYOUT.                                       01050009
            05  FILLER                 PIC X(3)  VALUE 'ISA'.           01060009
            05  FILLER                 PIC X(1)  VALUE '*'.             01070009
            05  ISA01                  PIC X(2)  VALUE '00'.            01080009
            05  FILLER                 PIC X(1)  VALUE '*'.             01090009
            05  ISA02                  PIC X(10) VALUE SPACES.          01100009
            05  FILLER                 PIC X(1)  VALUE '*'.             01110009
            05  ISA03                  PIC X(2)  VALUE '00'.            01120009
            05  FILLER                 PIC X(1)  VALUE '*'.             01130009
            05  ISA04                  PIC X(10) VALUE SPACES.          01140009
            05  FILLER                 PIC X(1)  VALUE '*'.             01150009
            05  ISA05                  PIC X(2)  VALUE 'ZZ'.            01160009
            05  FILLER                 PIC X(1)  VALUE '*'.             01170009
            05  ISA06                  PIC X(15) VALUE 'KOHLS'.         01180010
            05  FILLER                 PIC X(1)  VALUE '*'.             01190009
            05  ISA07-TP-QUAL          PIC X(2)  VALUE SPACES.          01200009
            05  FILLER                 PIC X(1)  VALUE '*'.             01210009
            05  ISA08-TP-ID            PIC X(15) VALUE SPACES.          01220009
00248       05  FILLER                 PIC X(1)  VALUE '*'.             01230009
00249       05  ISA-09-DATE.                                            01240009
00250           10  ISA-09-YY          PIC 9(02) VALUE ZERO.            01250009
00251           10  ISA-09-MM          PIC 9(02) VALUE ZERO.            01260009
00252           10  ISA-09-DD          PIC 9(02) VALUE ZERO.            01270009
00253       05  FILLER                 PIC X(01) VALUE '*'.             01280009
00254       05  ISA-10-TIME.                                            01290009
00255           10  ISA-10-HH          PIC 9(02) VALUE ZERO.            01300009
00256           10  ISA-10-MM          PIC 9(02) VALUE ZERO.            01310009
00248       05  FILLER                 PIC X(1)  VALUE '*'.             01320009
00248       05  ISA11                  PIC X(1)  VALUE 'W'.             01330009
00248       05  FILLER                 PIC X(1)  VALUE '*'.             01340009
00248       05  ISA12                  PIC X(5)  VALUE '00101'.         01350009
00248       05  FILLER                 PIC X(1)  VALUE '*'.             01360009
00258       05  ISA-13-CONTROL-NUMBER  PIC 9(09).                       01370009
00248       05  FILLER                 PIC X(1)  VALUE '*'.             01380009
00248       05  ISA14                  PIC X(1)  VALUE '0'.             01390009
 0248       05  FILLER                 PIC X(1)  VALUE '*'.             01400009
  248       05  ISA15-TEST-IND         PIC X(1)  VALUE SPACE.           01410009
 0248       05  FILLER                 PIC X(1)  VALUE '*'.             01420009
 0248       05  FILLER                 PIC X(1)  VALUE '>'.             01430009
 0248       05  FILLER                 PIC X(1)  VALUE X'15'.           01440011
00259       05  FILLER                 PIC X(48) VALUE SPACES.          01450009
00260 ****************************************************************  01460009
00261 *    THIS IS THE LAYOUT FOR THE IEA RECORD.                       01470009
00262 ****************************************************************  01480009
00263   01  WS-IEA-RECORD-LAYOUT.                                       01490009
            05  FILLER                 PIC X(3)   VALUE 'IEA'.          01500009
            05  FILLER                 PIC X(1)   VALUE '*'.            01510009
            05  IEA01                  PIC X(1)   VALUE '0'.            01520009
            05  FILLER                 PIC X(1)   VALUE '*'.            01530009
00265       05  IEA-02-CONTROL-NUMBER  PIC 9(09).                       01540009
 0248       05  FILLER                 PIC X(1)   VALUE X'15'.          01550011
00266       05  FILLER                 PIC X(144) VALUE SPACES.         01560009
00299 ****************************************************************  01570009
00300  01  CT-CPU-TIME.                                                 01580009
00301      05  CT-CPU-TIME-HH               PIC 9(02)  VALUE ZERO.      01590009
00302      05  CT-CPU-TIME-MM               PIC 9(02)  VALUE ZERO.      01600009
00303      05  CT-CPU-TIME-SS               PIC 9(02)  VALUE ZERO.      01610009
00304      05  CT-CPU-TIME-HS               PIC 9(02)  VALUE ZERO.      01620009
00305                                                                   01630009
00306  01  CD-CPU-DATE.                                                 01640009
00307      05  CD-CPU-DATE-YY               PIC 9(02)  VALUE ZERO.      01650009
00308      05  CD-CPU-DATE-MM               PIC 9(02)  VALUE ZERO.      01660009
00309      05  CD-CPU-DATE-DD               PIC 9(02)  VALUE ZERO.      01670009
00310                                                                   01680009
00311 ****************************************************************  01690009
00312  PROCEDURE DIVISION.                                              01700009
00313 ****************************************************************  01710009
00314                                                                   01720009
00315  0000-MAINLINE.                                                   01730009
00316                                                                   01740009
00317 *                                                                 01750009
00318 * INITIALIZE DATE AND TIME VALUES.                                01770009
00319 *                                                                 01780009
00320      ACCEPT CT-CPU-TIME FROM TIME.                                01790009
00321      ACCEPT CD-CPU-DATE FROM DATE.                                01800009
00322 *                                                                 01820009
00323 * OPEN INPUT AND OUTPUT FILES                                     01830009
00324 *                                                                 01840009
00325      OPEN INPUT PARM-FILE-IN.                                     01850009
00335      OPEN OUTPUT PARM-FILE-OUT                                    01860009
00335                  DCONSLR-LOC1-ISA-FILE                            01870012
00335                  DCONSLR-LOC2-ISA-FILE                            01880012
00336                  DCONSLR-IEA-FILE.                                01890012
00349 *                                                                 01900009
00349 * PROCESS                                                         01920009
00349 *                                                                 01930009
           READ PARM-FILE-IN                                            01940009
             INTO WS-PARM-RECORD-LAYOUT.                                01950009
                                                                        01960009
00353      ADD 1 TO WS-CONTROL-NUMBER.                                  01970009
00258      MOVE WS-CONTROL-NUMBER TO ISA-13-CONTROL-NUMBER.             01980009
00265      MOVE WS-CONTROL-NUMBER TO IEA-02-CONTROL-NUMBER.             01990009
00249      MOVE WS-TEST-INDICATOR TO ISA15-TEST-IND.                    02000009
00352      PERFORM 2000-MOVE-DATE-AND-TIME.                             02010009
00355      PERFORM 5000-WRITE-ISA-OUT-LOC1                              02020012
00355      PERFORM 5010-WRITE-ISA-OUT-LOC2.                             02030012
00356      PERFORM 5020-WRITE-IEA-OUT.                                  02040009
00356      PERFORM 5030-WRITE-PARM.                                     02050009
00412 *                                                                 02060013
00413 * CLOSE ALL FILES                                                 02070009
00414 *                                                                 02080009
00415      CLOSE  PARM-FILE-IN                                          02090009
00415             PARM-FILE-OUT                                         02100009
00416             DCONSLR-LOC1-ISA-FILE                                 02110012
00416             DCONSLR-LOC2-ISA-FILE                                 02120012
00425             DCONSLR-IEA-FILE.                                     02130012
00435 *                                                                 02140009
00436      STOP RUN.                                                    02150009
00437 *0000-EXIT.  EXIT.                                                02160009
00439                                                                   02170009
00439  2000-MOVE-DATE-AND-TIME.                                         02180009
00440       MOVE CT-CPU-TIME-HH      TO ISA-10-HH.                      02190009
00441       MOVE CT-CPU-TIME-MM      TO ISA-10-MM.                      02200009
00442       MOVE CD-CPU-DATE-YY      TO ISA-09-YY.                      02210009
00443       MOVE CD-CPU-DATE-MM      TO ISA-09-MM.                      02220009
00444       MOVE CD-CPU-DATE-DD      TO ISA-09-DD.                      02230009
00445                                                                   02240009
00502  5000-WRITE-ISA-OUT-LOC1.                                         02250012
00355                                                                   02260009
00355       MOVE WS-LOC1-TP-QUAL TO ISA07-TP-QUAL.                      02270012
00355       MOVE WS-LOC1-TP-ID   TO ISA08-TP-ID.                        02280012
00355                                                                   02290009
00503       WRITE DCONSLR-LOC1-ISA-RECORD                               02300012
00504         FROM WS-ISA-RECORD-LAYOUT.                                02310009
00355                                                                   02320009
00502  5010-WRITE-ISA-OUT-LOC2.                                         02330012
00355                                                                   02340009
00355       MOVE WS-LOC2-TP-QUAL TO ISA07-TP-QUAL.                      02350012
00355       MOVE WS-LOC2-TP-ID   TO ISA08-TP-ID.                        02360012
00355                                                                   02370009
00503       WRITE DCONSLR-LOC2-ISA-RECORD                               02380012
00504         FROM WS-ISA-RECORD-LAYOUT.                                02390009
00355                                                                   02400009
00506  5020-WRITE-IEA-OUT.                                              02410009
00507       WRITE DCONSLR-IEA-RECORD                                    02420012
00508         FROM WS-IEA-RECORD-LAYOUT.                                02430009
00509                                                                   02440009
00356  5030-WRITE-PARM.                                                 02450009
00507       WRITE PARM-RECORD-OUT                                       02460010
              FROM WS-PARM-RECORD-LAYOUT.                               02470009
00505                                                                   02480009
