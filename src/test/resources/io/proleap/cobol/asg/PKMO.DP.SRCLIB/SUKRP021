000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400 PROGRAM-ID.             SUKRP021.                                00040001
000500 AUTHOR.                 JOE LAROSA.                              00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN            FEBRUARY, 2000                           00070001
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*  PROGRAM CREATES THE 'INTRA-COMPANY MISDIRECTS FROM UCC128    * 00100001
001100*  SCAN RESULTS BY VENDOR' REPORT.                              * 00110001
001200*                                                               * 00120001
001300*  THIS REPORT CAN BE PRINTED WEEKLY OR MONTHLY (PARM CARD).    * 00130001
001400***************************************************************** 00140001
000098*  CHANGED 10/14/14 BY CHERI PARMLEY                            * 00141031
000099*   CHG#0098147 EXPAND PO# FROM 7 TO 8 DIGITS                   * 00142032
001700*                                                               * 00143031
001500*                                                                 00150001
001600***************************************************************** 00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800***************************************************************** 00180001
001900 CONFIGURATION SECTION.                                           00190001
002000                                                                  00200001
002100 SOURCE-COMPUTER.        IBM-3090.                                00210001
002200 OBJECT-COMPUTER.        IBM-3090.                                00220001
002300                                                                  00230001
002400***************************************************************** 00240001
002500 INPUT-OUTPUT SECTION.                                            00250001
002600                                                                  00260001
002700 FILE-CONTROL.                                                    00270001
002800                                                                  00280001
002900     SELECT INPUT-EXTRACT-FILE                                    00290001
003000         ASSIGN TO INP01.                                         00300001
003100                                                                  00310001
003200     SELECT OUTPUT-REPORT                                         00320001
003300         ASSIGN TO RPT01.                                         00330001
003400                                                                  00340001
003500***************************************************************** 00350001
003600 DATA DIVISION.                                                   00360001
003700***************************************************************** 00370001
003800 FILE SECTION.                                                    00380001
003900                                                                  00390001
004000 FD  INPUT-EXTRACT-FILE                                           00400001
004100     LABEL RECORDS ARE STANDARD                                   00410001
004200     RECORDING MODE IS F                                          00420001
004300     BLOCK CONTAINS 0 RECORDS                                     00430001
004400     RECORD CONTAINS 200 CHARACTERS.                              00440001
004500 01  EXTRACT-REC                     PIC X(200).                  00450001
004600                                                                  00460001
004700 FD  OUTPUT-REPORT                                                00470001
004800     RECORDING MODE IS F                                          00480001
004900     BLOCK CONTAINS 0  RECORDS.                                   00490001
005000 01  OUTPUT-REC                      PIC X(132).                  00500001
005100                                                                  00510001
005200***************************************************************** 00520001
005300 WORKING-STORAGE SECTION.                                         00530001
005400                                                                  00540001
005500 01  PROGRAM-SWITCHES.                                            00550001
005600     05  PS-NORMAL-RUN-SW            PIC X(01) VALUE 'N'.         00560001
005700         88  PS-NORMAL-RUN                     VALUE 'Y'.         00570001
005800         88  PS-SPECIAL-RUN                    VALUE 'N'.         00580001
005900     05  PS-FIRST-TIME-SW            PIC X(01) VALUE 'N'.         00590001
006000         88  PS-FIRST-TIME-YES                 VALUE 'Y'.         00600001
006100         88  PS-FIRST-TIME-NO                  VALUE 'N'.         00610001
006200     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00620001
006300         88  PS-END-OF-INPUT                   VALUE 'Y'.         00630001
006400         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00640001
006500     05  PS-PAGE-SW                  PIC X(01) VALUE 'N'.         00650001
006600         88  PS-NEW-PAGE                       VALUE 'Y'.         00660001
006700         88  PS-SAME-PAGE                      VALUE 'N'.         00670001
006800     05  PS-TYPE-DATA-SW             PIC X(01) VALUE 'N'.         00680001
006900         88  PS-TYPE-DATA-YES                  VALUE 'Y'.         00690001
007000         88  PS-TYPE-DATA-NO                   VALUE 'N'.         00700001
007100     05  PS-ALL-TYPES-PRINTED-SW     PIC X(01) VALUE 'N'.         00710001
007200         88  PS-ALL-TYPES-PRINTED              VALUE 'Y'.         00720001
007300         88  PS-TYPES-PRINTED-NO               VALUE 'N'.         00730001
007400     05  PS-END-OF-CURSOR-SW         PIC X(01) VALUE 'N'.         00740001
007500         88  PS-END-OF-CURSOR                  VALUE 'Y'.         00750001
007600         88  PS-NOT-END-OF-CURSOR              VALUE 'N'.         00760001
007700     05  PS-END-OF-TABLE-SW          PIC X(01) VALUE 'N'.         00770001
007800         88  PS-END-OF-TABLE                   VALUE 'Y'.         00780001
007900         88  PS-NOT-END-OF-TABLE               VALUE 'N'.         00790001
008000                                                                  00800001
008100 01  PC-PROGRAM-CONSTANTS.                                        00810001
008200     05  PC-SUKRP021                 PIC X(08) VALUE              00820001
008300                                               'SUKRP021'.        00830001
008400     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00840001
008500     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00850001
008600                                               COMP-3.            00860001
008700     05  PC-MISDIRECT-DESC-1.                                     00870001
008800         10  FILLER                  PIC X(50) VALUE              00880001
008900         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    00890001
009000         10  FILLER                  PIC X(42) VALUE              00900001
009100         'AT CORRECT DC BASED ON LOCATION MASTER    '.            00910001
009200     05  PC-MISDIRECT-DESC-2.                                     00920001
009300         10  FILLER                  PIC X(50) VALUE              00930001
009400         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    00940001
009500         10  FILLER                  PIC X(42) VALUE              00950001
009600         'AT WRONG DC BASED ON LOCATION MASTER      '.            00960001
009700     05  PC-MISDIRECT-DESC-3.                                     00970001
009800         10  FILLER                  PIC X(50) VALUE              00980001
009900         'ASN DOWNLOADED TO CORRECT DC -- CARTON WAS RECEIVE'.    00990001
010000         10  FILLER                  PIC X(42) VALUE              01000001
010100         'D AT WRONG DC BASED ON LOCATION MASTER    '.            01010001
010200     05  PC-MISDIRECT-DESC-4.                                     01020007
010300         10  FILLER                  PIC X(50) VALUE              01030001
010400         'DC ON ASN DOWNLOAD DOES NOT MATCH RECEIVING DC    '.    01040001
010500         10  FILLER                  PIC X(42) VALUE              01050001
010600         '                                          '.            01060001
010700     05  PC-MISDIRECT-DESC-5.                                     01070007
010800         10  FILLER                  PIC X(50) VALUE              01080007
010900         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    01090007
011000         10  FILLER                  PIC X(42) VALUE              01100007
011100         'AT WRONG DC BASED ON LOCATION MASTER      '.            01110007
011200     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.01120001
011300     05  PC-SYSTEM-DATE              PIC 9(06) VALUE ZEROES.      01130009
011400     05  PC-ONE                      PIC 9(02) VALUE 1.           01140001
011500     05  PC-SEVEN                    PIC 9(02) VALUE 7.           01150001
011600     05  PC-TWENTY-EIGHT             PIC 9(02) VALUE 28.          01160001
011700     05  PC-SPRING                   PIC X(06) VALUE 'SPRING'.    01170001
011800     05  PC-FALL                     PIC X(06) VALUE '  FALL'.    01180001
011900                                                                  01190001
012000 01  PV-PROGRAM-VARIABLES.                                        01200001
012100     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.      01210009
012200     05  PV-SQLCODE                  PIC 9(09) VALUE ZEROES.      01220009
012300     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01230001
012400                                               COMP-3.            01240001
012500     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01250001
012600                                               COMP-3.            01260001
012700     05  PV-REC-IN-QTY               PIC 9(07).                   01270001
012800     05  PV-REC-OUT-QTY              PIC 9(07).                   01280001
012900     05  PV-FIELDS.                                               01290001
013000         10  PV-CURR-VEND            PIC X(30) VALUE SPACES.      01300001
013100         10  PV-CURR-TYPE            PIC X(01) VALUE SPACES.      01310001
013200         10  PV-PREV-TYPE            PIC X(01) VALUE SPACES.      01320001
013300         10  PV-CURR-SCAC            PIC X(04) VALUE SPACES.      01330001
013400         10  PV-CURR-VEH-NBR         PIC X(11) VALUE SPACES.      01340001
013500         10  PV-CURR-LOCN            PIC 9(04) VALUE ZEROES.      01350001
013600         10  PV-CURR-PO-NBR          PIC S9(9) VALUE ZEROES.      01360001
013700         10  PV-CURR-REC-SEQ-NBR     PIC S9(9) VALUE ZEROES.      01370001
013800                                                                  01380001
013900     05  PV-ACCUMULATORS.                                         01390001
014000         10  PV-ACCUM-TYPE           PIC 9(09) VALUE ZEROES.      01400001
014100         10  PV-ACCUM-V1             PIC 9(09) VALUE ZEROES.      01410014
014200         10  PV-ACCUM-V2             PIC 9(09) VALUE ZEROES.      01420014
014300         10  PV-ACCUM-V3             PIC 9(09) VALUE ZEROES.      01430014
014400         10  PV-ACCUM-V4             PIC 9(09) VALUE ZEROES.      01440014
014500         10  PV-ACCUM-V5             PIC 9(09) VALUE ZEROES.      01450014
014600         10  PV-ACCUM-VEND           PIC 9(09) VALUE ZEROES.      01460001
014700         10  PV-ACCUM-T1             PIC 9(09) VALUE ZEROES.      01470001
014800         10  PV-ACCUM-T2             PIC 9(09) VALUE ZEROES.      01480001
014900         10  PV-ACCUM-T3             PIC 9(09) VALUE ZEROES.      01490001
015000         10  PV-ACCUM-T4             PIC 9(09) VALUE ZEROES.      01500001
015100         10  PV-ACCUM-T5             PIC 9(09) VALUE ZEROES.      01510001
015200         10  PV-ACCUM-TOTL           PIC 9(09) VALUE ZEROES.      01520001
015300                                                                  01530001
015400     05  PV-FORMAT-QTY               PIC ZZZ,ZZZ,ZZ9.             01540001
015500     05  PV-FORMAT-ACCUM             PIC ZZZ,ZZ9.                 01550001
015600     05  PV-FORMAT-FACILITY          PIC ZZZZ9.                   01560001
015700                                                                  01570001
015800     05  PV-INPUT-DATE.                                           01580001
015900         10  PV-INPUT-DATE-CC        PIC 9(02) VALUE ZEROES.      01590001
016000         10  PV-INPUT-DATE-YY        PIC 9(02) VALUE ZEROES.      01600001
016100         10  FILLER                  PIC X(01) VALUE '-'.         01610001
016200         10  PV-INPUT-DATE-MM        PIC 9(02) VALUE ZEROES.      01620001
016300         10  FILLER                  PIC X(01) VALUE '-'.         01630001
016400         10  PV-INPUT-DATE-DD        PIC 9(02) VALUE ZEROES.      01640001
016500     05  PV-INPUT-TIME.                                           01650001
016600         10  PV-INPUT-TIME-HH        PIC 9(02) VALUE ZEROES.      01660001
016700         10  FILLER                  PIC X(01) VALUE '.'.         01670001
016800         10  PV-INPUT-TIME-MM        PIC 9(02) VALUE ZEROES.      01680001
016900         10  FILLER                  PIC X(01) VALUE '.'.         01690001
017000         10  PV-INPUT-TIME-SS        PIC 9(02) VALUE ZEROES.      01700001
017100                                                                  01710001
017200     05  PV-YEAR-FORMAT.                                          01720001
017300         10  PV-YEAR-FORMAT-CC       PIC 9(02) VALUE 0.           01730001
017400         10  PV-YEAR-FORMAT-YY       PIC 9(02) VALUE 0.           01740001
017500     05  PV-FORMAT-PO.                                            01750001
      *CLP 10/14/14                                                     01751029
017600         10  PV-FORMAT-PO-NBR        PIC 9(08) VALUE ZEROES.      01760029
017700         10  FILLER                  PIC X(01) VALUE '-'.         01770001
017800         10  PV-FORMAT-REC-SEQ       PIC 9(03) VALUE ZEROES.      01780001
017900     05  PV-FORMAT-DATE.                                          01790001
018000         10  PV-FORMAT-DATE-MM       PIC X(02) VALUE SPACES.      01800001
018100         10  FILLER                  PIC X(01) VALUE '/'.         01810001
018200         10  PV-FORMAT-DATE-DD       PIC X(02) VALUE SPACES.      01820001
018300         10  FILLER                  PIC X(01) VALUE '/'.         01830001
018400         10  PV-FORMAT-DATE-YY       PIC X(02) VALUE SPACES.      01840001
018500     05  PV-FORMAT-TIME.                                          01850001
018600         10  PV-FORMAT-TIME-HH       PIC X(02) VALUE SPACES.      01860001
018700         10  FILLER                  PIC X(01) VALUE ':'.         01870001
018800         10  PV-FORMAT-TIME-MM       PIC X(02) VALUE SPACES.      01880001
018900                                                                  01890001
019000     05  PV-SEASON-DESC              PIC X(06) VALUE SPACES.      01900001
019100     05  PV-CURRENT-DB2-DATE-ONE     PIC X(10).                   01910001
019200     05  PV-CURRENT-DB2-DATE         PIC X(10).                   01920001
019300     05  PV-CURRENT-DB2-DATE-ONEYR   PIC X(10) VALUE SPACES.      01930001
019400     05  FILLER REDEFINES PV-CURRENT-DB2-DATE-ONEYR.              01940001
019500         10  PV-CDD-ONEYR-CCYY       PIC 9(04).                   01950001
019600         10  FILLER                  PIC X(06).                   01960001
019700                                                                  01970001
019800     05  PV-CURR-DATE.                                            01980001
019900         10  PV-CURRENT-DB2-CCYY.                                 01990001
020000             15  PV-CURRENT-DB2-CC   PIC 9(02) VALUE 0.           02000001
020100             15  PV-CURRENT-DB2-YY   PIC 9(02) VALUE 0.           02010001
020200         10  FILLER                  PIC X(01) VALUE '-'.         02020001
020300         10  PV-CURRENT-DB2-MM       PIC 9(02) VALUE 0.           02030001
020400         10  FILLER                  PIC X(01) VALUE '-'.         02040001
020500         10  PV-CURRENT-DB2-DD       PIC 9(02) VALUE 0.           02050001
020600                                                                  02060001
020700     05  PV-CURRENT-DATE.                                         02070001
020800         10  PV-CURRENT-CCYY.                                     02080001
020900             15  PV-CURRENT-CC       PIC 9(02) VALUE 0.           02090001
021000             15  PV-CURRENT-YY       PIC 9(02) VALUE 0.           02100001
021100         10  PV-CURRENT-MM           PIC 9(02) VALUE 0.           02110001
021200         10  PV-CURRENT-DD           PIC 9(02) VALUE 0.           02120001
021300                                                                  02130001
021400     05  PV-CURRENT-YYMMDD-DATE.                                  02140001
021500         10  PV-CURRENT-YYMMDD-YY    PIC 9(02) VALUE 0.           02150001
021600         10  PV-CURRENT-YYMMDD-MM    PIC 9(02) VALUE 0.           02160001
021700         10  PV-CURRENT-YYMMDD-DD    PIC 9(02) VALUE 0.           02170001
021800                                                                  02180001
021900     05  PV-TODAYS-DATE.                                          02190001
022000         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZEROES.      02200009
022100         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZEROES.      02210009
022200         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZEROES.      02220009
022300     05  PV-TODAYS-DATE-YYYY.                                     02230001
022400         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          02240001
022500         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZEROES.      02250009
022600                                                                  02260001
022700     05  PV-TODAYS-TIME.                                          02270001
022800         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZEROES.      02280009
022900         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZEROES.      02290009
023000         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZEROES.      02300009
023100         10  FILLER                  PIC 9(02) VALUE ZEROES.      02310009
023200                                                                  02320001
023300     05  PV-DATE-AREA.                                            02330001
023400         10  PV-DATE-AREA-MM         PIC 9(02) VALUE ZEROES.      02340009
023500         10  FILLER                  PIC X(01) VALUE '/'.         02350001
023600         10  PV-DATE-AREA-DD         PIC 9(02) VALUE ZEROES.      02360009
023700         10  FILLER                  PIC X(01) VALUE '/'.         02370001
023800         10  PV-DATE-AREA-YY         PIC 9(02) VALUE ZEROES.      02380009
023900                                                                  02390001
024000     05  PV-BEG-DATE-CYMD.                                        02400001
024100         10  PV-BEG-YMD-CC           PIC 9(02) VALUE ZEROES.      02410009
024200         10  PV-BEG-YMD-YY           PIC 9(02) VALUE ZEROES.      02420009
024300         10  PV-BEG-YMD-MM           PIC 9(02) VALUE ZEROES.      02430009
024400         10  PV-BEG-YMD-DD           PIC 9(02) VALUE ZEROES.      02440009
024500                                                                  02450001
024600     05  PV-END-DATE-CYMD.                                        02460001
024700         10  PV-END-YMD-CC           PIC 9(02) VALUE ZEROES.      02470009
024800         10  PV-END-YMD-YY           PIC 9(02) VALUE ZEROES.      02480009
024900         10  PV-END-YMD-MM           PIC 9(02) VALUE ZEROES.      02490009
025000         10  PV-END-YMD-DD           PIC 9(02) VALUE ZEROES.      02500009
025100                                                                  02510001
025200     05  PV-BEG-DATE.                                             02520001
025300         10  PV-BEG-MM               PIC 9(02) VALUE ZEROES.      02530009
025400         10  FILLER                  PIC X(01) VALUE '/'.         02540001
025500         10  PV-BEG-DD               PIC 9(02) VALUE ZEROES.      02550009
025600         10  FILLER                  PIC X(01) VALUE '/'.         02560001
025700         10  PV-BEG-YY               PIC 9(02) VALUE ZEROES.      02570009
025800                                                                  02580001
025900     05  PV-END-DATE.                                             02590001
026000         10  PV-END-MM               PIC 9(02) VALUE ZEROES.      02600009
026100         10  FILLER                  PIC X(01) VALUE '/'.         02610001
026200         10  PV-END-DD               PIC 9(02) VALUE ZEROES.      02620009
026300         10  FILLER                  PIC X(01) VALUE '/'.         02630001
026400         10  PV-END-YY               PIC 9(02) VALUE ZEROES.      02640009
026500                                                                  02650001
026600     05  PV-START-EXTRACT            PIC X(26) VALUE SPACES.      02660009
026700     05  FILLER  REDEFINES PV-START-EXTRACT.                      02670001
026800         10  PV-START-EXTRACT-YYYY   PIC 9999.                    02680001
026900         10  PV-START-EXTRACT-1ST    PIC X.                       02690001
027000         10  PV-START-EXTRACT-MM     PIC 99.                      02700001
027100         10  PV-START-EXTRACT-2ND    PIC X.                       02710001
027200         10  PV-START-EXTRACT-DD     PIC 99.                      02720001
027300         10  PV-START-EXTRACT-3RD    PIC X.                       02730001
027400         10  PV-START-TIMESTAMP      PIC X(15).                   02740001
027500                                                                  02750001
027600     05  PV-END-EXTRACT              PIC X(26) VALUE SPACES.      02760009
027700     05  FILLER  REDEFINES PV-END-EXTRACT.                        02770001
027800         10  PV-END-EXTRACT-YYYY     PIC 9999.                    02780001
027900         10  PV-END-EXTRACT-YYYY-RE REDEFINES PV-END-EXTRACT-YYYY.02790001
028000             15  PV-END-EXTRACT-CC   PIC 99.                      02800001
028100             15  PV-END-EXTRACT-YY   PIC 99.                      02810001
028200         10  PV-END-EXTRACT-1ST      PIC X.                       02820001
028300         10  PV-END-EXTRACT-MM       PIC 99.                      02830001
028400         10  PV-END-EXTRACT-2ND      PIC X.                       02840001
028500         10  PV-END-EXTRACT-DD       PIC 99.                      02850001
028600         10  PV-END-EXTRACT-3RD      PIC X.                       02860001
028700         10  PV-END-TIMESTAMP        PIC X(15).                   02870001
028800                                                                  02880001
028900     05  WS-START-EXTRACT.                                        02890001
029000         10  WS-START-EXTRACT-YYYY   PIC 9999.                    02900001
029100         10  WS-START-EXTRACT-MM     PIC 99.                      02910001
029200         10  WS-START-EXTRACT-DD     PIC 99.                      02920001
029300                                                                  02930001
029400     05  WS-END-EXTRACT.                                          02940001
029500         10  WS-END-EXTRACT-YYYY     PIC 9999.                    02950001
029600         10  WS-END-EXTRACT-MM       PIC 99.                      02960001
029700         10  WS-END-EXTRACT-DD       PIC 99.                      02970001
029800                                                                  02980001
029900     05  WS-FISCAL-PERIOD-NBR        PIC 9(02) VALUE ZEROES.      02990001
030000     05  WS-FISCAL-PERIOD-WEEK       PIC 9(02) VALUE ZEROES.      03000001
030100     05  WS-FISCAL-QTR-NBR           PIC 9(01) VALUE ZEROES.      03010009
030200     05  WS-FISCAL-WEEK-NBR          PIC 9(02) VALUE ZEROES.      03020001
030300                                                                  03030001
030400     05  WS-ARRIVE-DATE-WORK.                                     03040001
030500         10  WS-WORK-ARRIVE-MM       PIC 9(02) VALUE ZEROES.      03050001
030600         10  FILLER                  PIC X     VALUE '/'.         03060001
030700         10  WS-WORK-ARRIVE-DD       PIC 9(02) VALUE ZEROES.      03070001
030800         10  FILLER                  PIC X     VALUE '/'.         03080001
030900         10  WS-WORK-ARRIVE-CC       PIC 9(02) VALUE ZEROES.      03090001
031000         10  WS-WORK-ARRIVE-YY       PIC 9(02) VALUE ZEROES.      03100001
031100                                                                  03110001
031200     05  WS-ARRIVE-DATE.                                          03120001
031300         10  WS-ARRIVE-CC            PIC 9(02) VALUE ZEROES.      03130001
031400         10  WS-ARRIVE-YY            PIC 9(02) VALUE ZEROES.      03140001
031500         10  FILLER                  PIC X     VALUE '-'.         03150001
031600         10  WS-ARRIVE-MM            PIC 9(02) VALUE ZEROES.      03160001
031700         10  FILLER                  PIC X     VALUE '-'.         03170001
031800         10  WS-ARRIVE-DD            PIC 9(02) VALUE ZEROES.      03180001
031900                                                                  03190001
032000 01  CC-CONTROL-CARD-PARAMETERS.                                  03200001
032100     05  CC-BEG-DATE.                                             03210001
032200         10  CC-BEG-CC               PIC 9(02) VALUE ZEROES.      03220009
032300         10  CC-BEG-YY               PIC 9(02) VALUE ZEROES.      03230009
032400         10  FILLER                  PIC X(01) VALUE SPACES.      03240009
032500         10  CC-BEG-MM               PIC 9(02) VALUE ZEROES.      03250009
032600         10  FILLER                  PIC X(01) VALUE SPACES.      03260009
032700         10  CC-BEG-DD               PIC 9(02) VALUE ZEROES.      03270009
032800     05  FILLER                      PIC X(01) VALUE SPACES.      03280009
032900     05  CC-END-DATE.                                             03290001
033000         10  CC-END-CC               PIC 9(02) VALUE ZEROES.      03300009
033100         10  CC-END-YY               PIC 9(02) VALUE ZEROES.      03310009
033200         10  FILLER                  PIC X(01) VALUE SPACES.      03320009
033300         10  CC-END-MM               PIC 9(02) VALUE ZEROES.      03330009
033400         10  FILLER                  PIC X(01) VALUE SPACES.      03340009
033500         10  CC-END-DD               PIC 9(02) VALUE ZEROES.      03350009
033600     05  FILLER                      PIC X(01) VALUE SPACES.      03360009
033700     05  CC-MODE-IND                 PIC X(01) VALUE SPACES.      03370009
033800         88  CC-VALID-MODE-IND                 VALUE 'W', 'M',    03380001
033900                                                'F', 'C', 'S'.    03390001
034000         88  CC-WEEKLY-EXTRACT                 VALUE 'W'.         03400001
034100         88  CC-MONTHLY-EXTRACT                VALUE 'M'.         03410001
034200         88  CC-FISCAL-EXTRACT                 VALUE 'F'.         03420001
034300         88  CC-CALENDAR-EXTRACT               VALUE 'C'.         03430001
034400         88  CC-SEASONAL-EXTRACT               VALUE 'S'.         03440001
034500     05  FILLER                      PIC X(57) VALUE SPACES.      03450009
034600                                                                  03460001
034700 01  PV-DATETIME-WORK.                                            03470001
034800     05  PV-DATETIME-CC              PIC 9(02).                   03480001
034900     05  PV-DATETIME-YY              PIC 9(02).                   03490001
035000     05  FILLER                      PIC X(01) VALUE '-'.         03500001
035100     05  PV-DATETIME-MM              PIC 9(02).                   03510001
035200     05  FILLER                      PIC X(01) VALUE '-'.         03520001
035300     05  PV-DATETIME-DD              PIC 9(02).                   03530001
035400     05  FILLER                      PIC X(01) VALUE '-'.         03540001
035500     05  PV-DATETIME-HO              PIC 9(02).                   03550001
035600     05  FILLER                      PIC X(01) VALUE '.'.         03560001
035700     05  PV-DATETIME-MI              PIC 9(02).                   03570001
035800     05  FILLER                      PIC X(01) VALUE '.'.         03580001
035900     05  PV-DATETIME-SS              PIC 9(02).                   03590001
036000     05  FILLER                      PIC X(01) VALUE '.'.         03600001
036100     05  PV-DATETIME-MSEC            PIC 9(06).                   03610001
036200                                                                  03620001
036300 01  PV-DATE-RECORD.                                              03630001
036400     05  PV-DATE-START-MM            PIC X(02) VALUE SPACES.      03640009
036500     05  FILLER                      PIC X(01) VALUE '/'.         03650001
036600     05  PV-DATE-START-DD            PIC X(02) VALUE SPACES.      03660009
036700     05  FILLER                      PIC X(01) VALUE '/'.         03670001
036800     05  PV-DATE-START-CCYY          PIC X(04) VALUE SPACES.      03680009
036900     05  FILLER                      PIC X(01) VALUE SPACES.      03690009
037000     05  PV-DATE-END-MM              PIC X(02) VALUE SPACES.      03700009
037100     05  FILLER                      PIC X(01) VALUE '/'.         03710001
037200     05  PV-DATE-END-DD              PIC X(02) VALUE SPACES.      03720009
037300     05  FILLER                      PIC X(01) VALUE '/'.         03730001
037400     05  PV-DATE-END-CCYY            PIC X(04) VALUE SPACES.      03740009
037500     05  FILLER                      PIC X(01) VALUE SPACES.      03750009
037600     05  PV-DATE-FISCAL-PERIOD       PIC 9(02) VALUE ZEROES.      03760001
037700     05  FILLER                      PIC X(01) VALUE SPACES.      03770009
037800     05  PV-DATE-FISCAL-QUARTER      PIC 9(01) VALUE ZEROES.      03780009
037900     05  FILLER                      PIC X(01) VALUE SPACES.      03790009
038000     05  PV-DATE-SEASON              PIC X(06) VALUE SPACES.      03800001
038100     05  FILLER                      PIC X(47) VALUE SPACES.      03810001
038200                                                                  03820001
038300 01  PV-ABEND-FIELDS.                                             03830001
038400     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           03840001
038500                                               COMP SYNC.         03850001
038600     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP021'.  03860001
038700     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      03870001
038800     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      03880001
038900     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      03890001
039000     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      03900001
039100     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      03910001
039200     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      03920001
039300     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      03930001
039400     05  PV-DB2-TABLE-NAME           PIC X(08) VALUE SPACES.      03940001
039500                                                                  03950001
039600 01  VENDOR-SUMMARY-TABLE.                                        03960012
039700     05  SUMMARY-TABLE  OCCURS 2000 TIMES INDEXED BY CS-IDX.      03970028
039800         10  SUMMARY-VENDOR          PIC  X(30).                  03980012
039900         10  SUMMARY-TYPE-1          PIC  9(09).                  03990012
040000         10  SUMMARY-TYPE-2          PIC  9(09).                  04000012
040100         10  SUMMARY-TYPE-3          PIC  9(09).                  04010012
040200         10  SUMMARY-TYPE-4          PIC  9(09).                  04020012
040300         10  SUMMARY-TYPE-5          PIC  9(09).                  04030012
040400         10  SUMMARY-TOTAL           PIC  9(09).                  04040012
040500                                                                  04050012
040600******************************************************************04060001
040700*  COPYBOOK USED BY CALENDAR ROUTINE                              04070001
040800******************************************************************04080001
040900     COPY DPWS500.                                                04090001
041000                                                                  04100001
041100******************************************************************04110001
041200*  RECORD LAYOUT FOR INPUT FILE                                   04120001
041300******************************************************************04130001
041400     COPY SURD008.                                                04140001
041500                                                                  04150001
041600******************************************************************04160001
041700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               04170001
041800******************************************************************04180001
041900     COPY DPWS132.                                                04190001
042000                                                                  04200001
042100 01  WS-BATCH-PROC-DATE.                                          04210001
042200     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      04220001
042300     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      04230001
042400     05  FILLER                      PIC X(01) VALUE SPACES.      04240001
042500     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      04250001
042600     05  FILLER                      PIC X(01) VALUE SPACES.      04260001
042700     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      04270001
042800*                                                                 04280001
042900 01  HEADING-LINES.                                               04290001
043000     05  HEADING-LINE-1.                                          04300001
043100         10  FILLER                  PIC X(36) VALUE SPACES.      04310001
043200         10  FILLER                  PIC X(49) VALUE              04320001
043300             'INTRA-COMPANY MISDIRECTS FROM UCC128 SCAN RESULTS'. 04330001
043400         10  FILLER                  PIC X(10) VALUE              04340001
043500                                               ' BY VENDOR'.      04350001
043600         10  FILLER                  PIC X(37) VALUE SPACES.      04360001
043700                                                                  04370001
043800     05  HEADING-LINE-2.                                          04380001
043900         10  FILLER                  PIC X(43) VALUE SPACES.      04390001
044000         10  FILLER                  PIC X(15) VALUE              04400001
044100                                               'TIME PERIOD OF '. 04410001
044200         10  HL2-FROM-DATE-MM        PIC X(02) VALUE SPACES.      04420001
044300         10  FILLER                  PIC X(01) VALUE '-'.         04430001
044400         10  HL2-FROM-DATE-DD        PIC X(02) VALUE SPACES.      04440001
044500         10  FILLER                  PIC X(01) VALUE '-'.         04450001
044600         10  HL2-FROM-DATE-YYYY      PIC X(04) VALUE SPACES.      04460001
044700         10  FILLER                  PIC X(06) VALUE ' THRU '.    04470001
044800         10  HL2-TO-DATE-MM          PIC X(02) VALUE SPACES.      04480001
044900         10  FILLER                  PIC X(01) VALUE '-'.         04490001
045000         10  HL2-TO-DATE-DD          PIC X(02) VALUE SPACES.      04500001
045100         10  FILLER                  PIC X(01) VALUE '-'.         04510001
045200         10  HL2-TO-DATE-YYYY        PIC X(04) VALUE SPACES.      04520001
045300         10  FILLER                  PIC X(48) VALUE SPACES.      04530001
045400                                                                  04540001
045500     05  HEADING-LINE-3.                                          04550001
045600         10  FILLER                  PIC X(01) VALUE SPACES.      04560001
045700         10  FILLER                  PIC X(13) VALUE              04570001
045800                                               'VENDOR NAME: '.   04580001
045900         10  HL3-VEND-NAME           PIC X(30) VALUE SPACES.      04590001
046000         10  FILLER                  PIC X(88) VALUE SPACES.      04600001
046100                                                                  04610001
046200     05  HEADING-LINE-3-CS.                                       04620012
046300         10  FILLER                  PIC X(01) VALUE SPACES.      04630012
046400         10  FILLER                  PIC X(13) VALUE              04640012
046500                                               'VENDOR NAME: '.   04650012
046600         10  FILLER                  PIC X(20) VALUE              04660012
046700                                     'VENDOR SUMMARY      '.      04670012
046800         10  FILLER                  PIC X(98) VALUE SPACES.      04680012
046900                                                                  04690012
047000     05  HEADING-LINE-4.                                          04700001
047100         10  FILLER                  PIC X(01) VALUE SPACES.      04710001
047200         10  FILLER                  PIC X(16) VALUE              04720001
047300                                     'MISDIRECT TYPE #'.          04730001
047400         10  HL4-MISDIRECT-TYPE      PIC X(01) VALUE SPACES.      04740001
047500         10  FILLER                  PIC X(02) VALUE ': '.        04750001
047600         10  HL4-MISDIRECT-DESC      PIC X(92) VALUE SPACES.      04760001
047700         10  FILLER                  PIC X(20) VALUE SPACES.      04770001
047800                                                                  04780001
047900     05  HEADING-LINE-4-CS.                                       04790012
048000         10  FILLER                  PIC X(07) VALUE SPACES.      04800012
048100         10  FILLER                  PIC X(11) VALUE              04810012
048200                                               '           '.     04820012
048300         10  FILLER                  PIC X(25) VALUE SPACES.      04830012
048400         10  FILLER                  PIC X(11) VALUE              04840012
048500                                               ' MISDIRECT '.     04850012
048600         10  FILLER                  PIC X(02) VALUE SPACES.      04860012
048700         10  FILLER                  PIC X(11) VALUE              04870012
048800                                               ' MISDIRECT '.     04880012
048900         10  FILLER                  PIC X(02) VALUE SPACES.      04890012
049000         10  FILLER                  PIC X(11) VALUE              04900012
049100                                               ' MISDIRECT '.     04910012
049200         10  FILLER                  PIC X(02) VALUE SPACES.      04920012
049300         10  FILLER                  PIC X(11) VALUE              04930012
049400                                               ' MISDIRECT '.     04940012
049500         10  FILLER                  PIC X(02) VALUE SPACES.      04950012
049600         10  FILLER                  PIC X(11) VALUE              04960012
049700                                               ' MISDIRECT '.     04970012
049800         10  FILLER                  PIC X(02) VALUE SPACES.      04980012
049900         10  FILLER                  PIC X(11) VALUE              04990012
050000                                               '           '.     05000012
050100         10  FILLER                  PIC X(08) VALUE SPACES.      05010012
050200                                                                  05020012
050300     05  HEADING-LINE-5.                                          05030001
050400         10  FILLER                  PIC X(01) VALUE SPACES.      05040023
050500         10  FILLER                  PIC X(04) VALUE SPACES.      05050023
050600         10  FILLER                  PIC X(01) VALUE SPACES.      05060023
050700         10  FILLER                  PIC X(11) VALUE SPACES.      05070023
050800         10  FILLER                  PIC X(01) VALUE SPACES.      05080023
050900         10  FILLER                  PIC X(04) VALUE SPACES.      05090023
051000         10  FILLER                  PIC X(01) VALUE SPACES.      05100023
051100         10  FILLER                  PIC X(11) VALUE SPACES.      05110023
051200         10  FILLER                  PIC X(01) VALUE SPACES.      05120023
051300         10  FILLER                  PIC X(04) VALUE SPACES.      05130023
051400         10  FILLER                  PIC X(01) VALUE SPACES.      05140023
051500         10  FILLER                  PIC X(04) VALUE 'STR '.      05150023
051600         10  FILLER                  PIC X(70) VALUE SPACES.      05160023
051700         10  FILLER                  PIC X(17) VALUE              05170003
051800                                     '-ASN INFORMATION-'.         05180003
051900         10  FILLER                  PIC X(01) VALUE SPACES.      05190023
052000                                                                  05200001
052100     05  HEADING-LINE-5-CS.                                       05210012
052200         10  FILLER                  PIC X(07) VALUE SPACES.      05220012
052300         10  FILLER                  PIC X(11) VALUE              05230012
052400                                               'VENDOR NAME'.     05240012
052500         10  FILLER                  PIC X(25) VALUE SPACES.      05250012
052600         10  FILLER                  PIC X(11) VALUE              05260012
052700                                               '  TYPE #1  '.     05270012
052800         10  FILLER                  PIC X(02) VALUE SPACES.      05280012
052900         10  FILLER                  PIC X(11) VALUE              05290012
053000                                               '  TYPE #2  '.     05300012
053100         10  FILLER                  PIC X(02) VALUE SPACES.      05310012
053200         10  FILLER                  PIC X(11) VALUE              05320012
053300                                               '  TYPE #3  '.     05330012
053400         10  FILLER                  PIC X(02) VALUE SPACES.      05340012
053500         10  FILLER                  PIC X(11) VALUE              05350012
053600                                               '  TYPE #4  '.     05360012
053700         10  FILLER                  PIC X(02) VALUE SPACES.      05370012
053800         10  FILLER                  PIC X(11) VALUE              05380012
053900                                               '   TOTAL   '.     05390012
054000         10  FILLER                  PIC X(02) VALUE SPACES.      05400012
054100         10  FILLER                  PIC X(11) VALUE              05410012
054200                                               '           '.     05420012
054300         10  FILLER                  PIC X(08) VALUE SPACES.      05430012
054400                                                                  05440012
054500     05  HEADING-LINE-6.                                          05450001
054600         10  FILLER                  PIC X(01) VALUE SPACES.      05460003
054700         10  FILLER                  PIC X(04) VALUE SPACES.      05470003
054800         10  FILLER                  PIC X(01) VALUE SPACES.      05480003
      *CLP 10/14/14                                                     05481030
054900         10  FILLER                  PIC X(12) VALUE SPACES.      05490030
055000         10  FILLER                  PIC X(01) VALUE SPACES.      05500003
055100         10  FILLER                  PIC X(04) VALUE 'RCVG'.      05510003
055200         10  FILLER                  PIC X(01) VALUE SPACES.      05520003
055300         10  FILLER                  PIC X(11) VALUE SPACES.      05530003
055400         10  FILLER                  PIC X(01) VALUE SPACES.      05540003
055500         10  FILLER                  PIC X(04) VALUE 'DEST'.      05550003
055600         10  FILLER                  PIC X(01) VALUE SPACES.      05560003
055700         10  FILLER                  PIC X(04) VALUE 'PRCS'.      05570023
055800         10  FILLER                  PIC X(01) VALUE SPACES.      05580023
055900         10  FILLER                  PIC X(20) VALUE SPACES.      05590023
056000         10  FILLER                  PIC X(01) VALUE SPACES.      05600003
056100         10  FILLER                  PIC X(05) VALUE 'SCAN '.     05610003
056200         10  FILLER                  PIC X(01) VALUE SPACES.      05620003
056300         10  FILLER                  PIC X(05) VALUE 'SCAN '.     05630003
056400         10  FILLER                  PIC X(01) VALUE SPACES.      05640003
      *CLP 10/14/14                                                     05641030
056500         10  FILLER                  PIC X(07) VALUE ' SCAN  '.   05650030
056600         10  FILLER                  PIC X(01) VALUE SPACES.      05660003
056700         10  FILLER                  PIC X(27) VALUE SPACES.      05670023
056800         10  FILLER                  PIC X(01) VALUE SPACES.      05680003
056900         10  FILLER                  PIC X(11) VALUE              05690003
057000                                     '-DOWNLOAD- '.               05700003
057100         10  FILLER                  PIC X(01) VALUE SPACES.      05710003
057200         10  FILLER                  PIC X(04) VALUE 'RCVG'.      05720003
057300         10  FILLER                  PIC X(01) VALUE SPACES.      05730023
057400                                                                  05740003
057500     05  HEADING-LINE-7.                                          05750001
057600         10  FILLER                  PIC X(01) VALUE SPACES.      05760001
057700         10  FILLER                  PIC X(04) VALUE 'SCAC'.      05770001
057800         10  FILLER                  PIC X(01) VALUE SPACES.      05780001
057900         10  FILLER                  PIC X(11) VALUE              05790001
058000                                     'TRAILER    '.               05800003
058100         10  FILLER                  PIC X(01) VALUE SPACES.      05810001
058200         10  FILLER                  PIC X(04) VALUE 'LOC '.      05820003
058300         10  FILLER                  PIC X(01) VALUE SPACES.      05830003
      *CLP 10/14/14                                                     05831029
058400         10  FILLER                  PIC X(12) VALUE              05840029
058500                                     'PO/RECEIVER '.              05850029
058600         10  FILLER                  PIC X(01) VALUE SPACES.      05860001
058700         10  FILLER                  PIC X(04) VALUE 'STR '.      05870001
058800         10  FILLER                  PIC X(01) VALUE SPACES.      05880001
058900         10  FILLER                  PIC X(04) VALUE 'DC  '.      05890023
059000         10  FILLER                  PIC X(01) VALUE SPACES.      05900023
059100         10  FILLER                  PIC X(20) VALUE              05910001
059200                                     'SERIAL SHIP CODE    '.      05920001
059300         10  FILLER                  PIC X(01) VALUE SPACES.      05930001
059400         10  FILLER                  PIC X(05) VALUE 'DATE '.     05940003
059500         10  FILLER                  PIC X(01) VALUE SPACES.      05950001
059600         10  FILLER                  PIC X(05) VALUE 'TIME '.     05960001
059700         10  FILLER                  PIC X(01) VALUE SPACES.      05970001
      *CLP 10/14/14                                                     05971029
059800         10  FILLER                  PIC X(07) VALUE 'USER ID'.   05980029
059900         10  FILLER                  PIC X(01) VALUE SPACES.      05990001
060000         10  FILLER                  PIC X(27) VALUE              06000023
060100             'ASN NUMBER                 '.                       06010023
060200         10  FILLER                  PIC X(01) VALUE SPACES.      06020001
060300         10  FILLER                  PIC X(05) VALUE 'DATE '.     06030003
060400         10  FILLER                  PIC X(01) VALUE SPACES.      06040001
060500         10  FILLER                  PIC X(05) VALUE 'TIME '.     06050001
060600         10  FILLER                  PIC X(01) VALUE SPACES.      06060001
060700         10  FILLER                  PIC X(04) VALUE 'OPER'.      06070001
060800         10  FILLER                  PIC X(01) VALUE SPACES.      06080023
060900                                                                  06090001
061000 01  DETAIL-LINES.                                                06100001
061100     05  DETAIL-LINE-1.                                           06110001
061200         10  FILLER                  PIC X(01) VALUE SPACES.      06120001
061300         10  DL1-SCAC                PIC X(04) VALUE SPACES.      06130001
061400         10  FILLER                  PIC X(01) VALUE SPACES.      06140001
061500         10  DL1-TRAILER             PIC X(11) VALUE SPACES.      06150001
061600         10  FILLER                  PIC X(01) VALUE SPACES.      06160003
061700         10  DL1-RCVG-LOC            PIC X(04) VALUE ZEROES.      06170005
061800         10  FILLER                  PIC X(01) VALUE SPACES.      06180001
      *CLP 10/14/14                                                     06181029
061900         10  DL1-PO-RCVR             PIC X(12) VALUE SPACES.      06190029
062000         10  FILLER                  PIC X(01) VALUE SPACES.      06200001
062100         10  DL1-DEST-STR            PIC 9(04) VALUE ZEROES.      06210001
062200         10  FILLER                  PIC X(01) VALUE SPACES.      06220001
062300         10  DL1-PROCESS-DC          PIC 9(04) VALUE ZEROES.      06230023
062400         10  FILLER                  PIC X(01) VALUE SPACES.      06240023
062500         10  DL1-SERIAL-SHIP-CODE    PIC 9(18) VALUE ZEROES.      06250001
062600         10  FILLER                  PIC X(03) VALUE SPACES.      06260001
062700         10  DL1-SCAN-DATE           PIC X(05) VALUE SPACES.      06270003
062800         10  FILLER                  PIC X(01) VALUE SPACES.      06280001
062900         10  DL1-SCAN-TIME           PIC X(05) VALUE SPACES.      06290001
063000         10  FILLER                  PIC X(01) VALUE SPACES.      06300001
      *CLP 10/14/14                                                     06301029
063100         10  DL1-SCAN-USERID         PIC X(07) VALUE SPACES.      06310029
063200         10  FILLER                  PIC X(01) VALUE SPACES.      06320001
063300         10  DL1-ASN-NUMBER          PIC X(27) VALUE SPACES.      06330023
063400         10  FILLER                  PIC X(01) VALUE SPACES.      06340001
063500         10  DL1-ASN-DATE            PIC X(05) VALUE SPACES.      06350003
063600         10  FILLER                  PIC X(01) VALUE SPACES.      06360001
063700         10  DL1-ASN-TIME            PIC X(05) VALUE SPACES.      06370001
063800         10  FILLER                  PIC X(01) VALUE SPACES.      06380001
063900         10  DL1-RCVG-OPER           PIC 9(04) VALUE ZEROES.      06390001
064000         10  FILLER                  PIC X(01) VALUE SPACES.      06400023
064100                                                                  06410001
064200     05  DETAIL-LINE-1-CS.                                        06420012
064300         10  FILLER                  PIC X(07) VALUE SPACES.      06430012
064400         10  CS-VENDOR-NAME          PIC X(30) VALUE SPACES.      06440012
064500         10  FILLER                  PIC X(04) VALUE SPACES.      06450015
064600         10  CS-LOCN-TYPE-1          PIC X(11) VALUE SPACES.      06460012
064700         10  FILLER                  PIC X(02) VALUE SPACES.      06470012
064800         10  CS-LOCN-TYPE-2          PIC X(11) VALUE SPACES.      06480012
064900         10  FILLER                  PIC X(02) VALUE SPACES.      06490012
065000         10  CS-LOCN-TYPE-3          PIC X(11) VALUE SPACES.      06500012
065100         10  FILLER                  PIC X(02) VALUE SPACES.      06510012
065200         10  CS-LOCN-TYPE-4          PIC X(11) VALUE SPACES.      06520012
065300         10  FILLER                  PIC X(02) VALUE SPACES.      06530012
065400***      10  CS-LOCN-TYPE-5          PIC X(11) VALUE SPACES.      06540012
065500***      10  FILLER                  PIC X(02) VALUE SPACES.      06550012
065600         10  CS-LOCN-TOTAL           PIC X(11) VALUE SPACES.      06560012
065700         10  FILLER                  PIC X(28) VALUE SPACES.      06570015
065800                                                                  06580012
065900 01  TOTAL-LINES.                                                 06590001
066000     05  TOTAL-LINE-1.                                            06600001
066100         10  FILLER                  PIC X(01) VALUE SPACES.      06610001
066200         10  FILLER                  PIC X(26) VALUE              06620001
066300             'TOTAL FOR MISDIRECT TYPE #'.                        06630001
066400         10  TL1-MISDIRECT-TYPE      PIC X(01) VALUE SPACES.      06640001
066500         10  FILLER                  PIC X(02) VALUE ': '.        06650001
066600         10  TL1-TOTAL-TYPE          PIC X(07).                   06660001
066700         10  FILLER                  PIC X(95) VALUE SPACES.      06670001
066800                                                                  06680001
066900     05  TOTAL-LINE-1-CS.                                         06690012
067000         10  FILLER                  PIC X(22) VALUE SPACES.      06700012
067100         10  FILLER                  PIC X(17) VALUE              06710012
067200                                     'VENDOR TOTALS:   '.         06720012
067300         10  FILLER                  PIC X(02) VALUE SPACES.      06730015
067400         10  CS-TOTL-TYPE-1          PIC ZZZ,ZZZ,ZZ9.             06740012
067500         10  FILLER                  PIC X(02) VALUE SPACES.      06750012
067600         10  CS-TOTL-TYPE-2          PIC ZZZ,ZZZ,ZZ9.             06760012
067700         10  FILLER                  PIC X(02) VALUE SPACES.      06770012
067800         10  CS-TOTL-TYPE-3          PIC ZZZ,ZZZ,ZZ9.             06780012
067900         10  FILLER                  PIC X(02) VALUE SPACES.      06790012
068000         10  CS-TOTL-TYPE-4          PIC ZZZ,ZZZ,ZZ9.             06800012
068100         10  FILLER                  PIC X(02) VALUE SPACES.      06810012
068200***      10  CS-TOTL-TYPE-5          PIC ZZZ,ZZZ,ZZ9.             06820012
068300***      10  FILLER                  PIC X(02) VALUE SPACES.      06830012
068400         10  CS-TOTL-TOTAL           PIC ZZZ,ZZZ,ZZ9.             06840012
068500         10  FILLER                  PIC X(28) VALUE SPACES.      06850015
068600                                                                  06860012
068700     05  TOTAL-LINE-2.                                            06870001
068800         10  FILLER                  PIC X(01) VALUE SPACES.      06880001
068900         10  FILLER                  PIC X(29) VALUE              06890001
069000             'TOTAL MISDIRECTS FOR VENDOR: '.                     06900001
069100         10  TL2-TOTAL-VEND          PIC X(07).                   06910001
069200         10  FILLER                  PIC X(95) VALUE SPACES.      06920001
069300                                                                  06930001
069400 01  MISCELLANEOUS-LINES.                                         06940001
069500     05  BLANK-LINE.                                              06950001
069600         10  FILLER                  PIC X(132) VALUE SPACES.     06960001
069700                                                                  06970001
069800     05  END-OF-REPORT-LINE.                                      06980001
069900         10  FILLER                  PIC X(44) VALUE SPACES.      06990001
070000         10  FILLER                  PIC X(45) VALUE              07000001
070100             '*******   E N D   O F   R E P O R T   *******'.     07010001
070200         10  FILLER                  PIC X(43) VALUE SPACES.      07020001
070300                                                                  07030001
070400     05  NO-MISDIRECT-DATA-LINE.                                  07040001
070500         10  FILLER                  PIC X(01) VALUE SPACES.      07050001
070600         10  FILLER                  PIC X(23) VALUE              07060001
070700                                     '** NO DATA TO REPORT **'.   07070001
070800         10  FILLER                  PIC X(108) VALUE SPACES.     07080001
070900                                                                  07090001
071000     05  NO-DATA-TO-REPORT-LINE.                                  07100001
071100         10  FILLER                  PIC X(40) VALUE SPACES.      07110001
071200         10  FILLER                  PIC X(52) VALUE              07120009
071300         '*******  N O   D A T A   T O   R E P O R T   *******'.  07130001
071400         10  FILLER                  PIC X(40) VALUE SPACES.      07140009
071500                                                                  07150001
071600******************************************************************07160001
071700*  USED FOR DB2 ERROR MESSAGE BUILDING                            07170001
071800******************************************************************07180001
071900     COPY DPWS004.                                                07190027
072000                                                                  07200001
072100******************************************************************07210001
072200*   DB2 SQL COMMUNICATION AREA                                    07220001
072300******************************************************************07230001
072400     EXEC SQL                                                     07240001
072500          INCLUDE SQLCA                                           07250001
072600     END-EXEC.                                                    07260001
072700                                                                  07270001
072800******************************************************************07280001
072900*  DCLGEN FOR THE COMPANY CONTROL TABLE                           07290001
073000******************************************************************07300001
073100     EXEC SQL                                                     07310001
073200         INCLUDE TCOCNTL                                          07320001
073300     END-EXEC.                                                    07330001
073400                                                                  07340001
073500******************************************************************07350001
073600******************************************************************07360001
073700 PROCEDURE DIVISION.                                              07370001
073800     DISPLAY '**** START OF SUKRP021 ****'.                       07380001
073900                                                                  07390001
074000*OPEN FILES.                                                      07400001
074100     OPEN INPUT  INPUT-EXTRACT-FILE                               07410001
074200          OUTPUT OUTPUT-REPORT.                                   07420001
074300                                                                  07430001
074400*READ FIRST INPUT RECORD.                                         07440001
074500     SET PS-NOT-END-OF-INPUT TO TRUE.                             07450001
074600     SET PS-TYPE-DATA-NO     TO TRUE.                             07460001
074700     MOVE 0 TO PV-REC-IN-QTY.                                     07470001
074800     PERFORM 0100-READ-EXTRACT.                                   07480001
074900                                                                  07490001
075000*SET/PRINT REPORT HEADINGS.                                       07500001
075100     IF NOT PS-END-OF-INPUT                                       07510001
075200         MOVE SU008-VEND-NAME       TO PV-CURR-VEND               07520001
075300         MOVE SU008-MISDIRECT-TYPE  TO PV-CURR-TYPE               07530017
075400         MOVE 1                     TO PV-REC-IN-QTY              07540001
075500     END-IF.                                                      07550001
075600     DISPLAY '  ** 1000-INITIALIZATION **'.                       07560001
075700     PERFORM 1000-INITIALIZATION.                                 07570001
075800     DISPLAY '  ** 1000-INITIALIZATION DONE **'.                  07580001
075900                                                                  07590001
076000*PROCESS INPUT FILE.                                              07600001
076100     IF PS-END-OF-INPUT                                           07610001
076200         PERFORM 1300-NO-DETAIL-LINE                              07620001
076300     ELSE                                                         07630001
076400         PERFORM 2000-PROCESS-EXTRACT                             07640001
076500           UNTIL PS-END-OF-INPUT                                  07650001
076600         PERFORM 0200-PRINT-LAST-TOTALS                           07660001
076700     END-IF.                                                      07670001
076800                                                                  07680001
076900     DISPLAY '**** RECORDS READ    ==> ' PV-REC-IN-QTY.           07690001
077000     DISPLAY '**** RECORDS WRITTEN ==> ' PV-REC-OUT-QTY.          07700001
077100                                                                  07710001
077200*WRITE VENDOR SUMMARY.                                            07720012
077300     PERFORM 3000-PRINT-SUMMARY.                                  07730012
077400                                                                  07740012
077500*WRITE END-OF-REPORT LINE.                                        07750012
077600     PERFORM 1400-END-OF-RPT-LINE.                                07760012
077700                                                                  07770012
077800*CLOSE FILES.                                                     07780001
077900     CLOSE INPUT-EXTRACT-FILE                                     07790001
078000           OUTPUT-REPORT.                                         07800001
078100                                                                  07810001
078200     GOBACK.                                                      07820001
078300                                                                  07830001
078400******************************************************************07840001
078500*  READ NEXT INPUT FILE RECORD.                                  *07850001
078600******************************************************************07860001
078700 0100-READ-EXTRACT.                                               07870001
078800                                                                  07880001
078900     READ INPUT-EXTRACT-FILE INTO SU008-EXTRACT-RECORD            07890001
079000       AT END                                                     07900001
079100           SET PS-END-OF-INPUT TO TRUE.                           07910001
079200                                                                  07920001
079300******************************************************************07930001
079400*  PRINT REMAINING TOTAL LINES AFTER LAST RECORD READ.           *07940001
079500******************************************************************07950001
079600 0200-PRINT-LAST-TOTALS.                                          07960001
079700                                                                  07970001
079800*WRITE LAST TOTALS.                                               07980001
079900     PERFORM 2010-TYPE-BREAK.                                     07990001
080000     PERFORM 2020-VEND-BREAK.                                     08000001
080100                                                                  08010001
080200******************************************************************08020001
080300*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *08030001
080400******************************************************************08040001
080500 1000-INITIALIZATION.                                             08050001
080600                                                                  08060001
080700     PERFORM 1010-INITIALIZE-SUMMARY-TABLE.                       08070012
080800                                                                  08080012
080900     ACCEPT PV-TODAYS-DATE FROM DATE.                             08090001
081000     ACCEPT PV-TODAYS-TIME FROM TIME.                             08100001
081100                                                                  08110001
081200     MOVE PV-TODAYS-DATE-MM    TO DP132-RUN-MONTH.                08120001
081300     MOVE PV-TODAYS-DATE-DD    TO DP132-RUN-DAY.                  08130001
081400     MOVE PV-TODAYS-DATE-YY    TO PV-TODAYS-DATE-Y2.              08140001
081500     MOVE PV-TODAYS-DATE-YYYY  TO DP132-RUN-YEAR.                 08150001
081600                                                                  08160001
081700     MOVE PV-TODAYS-TIME-HH    TO DP132-RUN-HOUR.                 08170001
081800     MOVE PV-TODAYS-TIME-MM    TO DP132-RUN-MINUTE.               08180001
081900                                                                  08190001
082000     MOVE PC-SUKRP021          TO DP132-PROGRAM-NAME.             08200002
082100     MOVE PC-REPORT-NBR        TO DP132-REPORT-NUMBER.            08210001
082200                                                                  08220001
082300     SET PS-FIRST-TIME-YES     TO TRUE.                           08230001
082400                                                                  08240001
082500     MOVE +0                   TO PV-REC-OUT-QTY.                 08250001
082600                                                                  08260001
082700     MOVE +0                   TO PV-PAGE-COUNT                   08270001
082800                                  PV-ACCUM-TYPE                   08280001
082900                                  PV-ACCUM-VEND.                  08290001
083000                                                                  08300001
083100     MOVE ZEROES               TO PV-ACCUM-V1                     08310014
083200                                  PV-ACCUM-V2                     08320014
083300                                  PV-ACCUM-V3                     08330014
083400                                  PV-ACCUM-V4                     08340014
083500                                  PV-ACCUM-V5                     08350014
083600                                  PV-ACCUM-T1                     08360014
083700                                  PV-ACCUM-T2                     08370014
083800                                  PV-ACCUM-T3                     08380014
083900                                  PV-ACCUM-T4                     08390014
084000                                  PV-ACCUM-T5                     08400014
084100                                  PV-ACCUM-TOTL.                  08410001
084200                                                                  08420001
084300     PERFORM 1100-PROCESS-DATECARD.                               08430001
084400                                                                  08440001
084500     PERFORM 1200-PRINT-HEADINGS.                                 08450001
084600                                                                  08460001
084700******************************************************************08470012
084800*   INITIALIZE SUMMARY TABLE.                                    *08480012
084900******************************************************************08490012
085000 1010-INITIALIZE-SUMMARY-TABLE.                                   08500012
085100                                                                  08510012
085200     PERFORM                                                      08520012
085300       VARYING CS-IDX FROM 1 BY 1 UNTIL CS-IDX > 2000             08530028
085400         MOVE ZEROES TO SUMMARY-TYPE-1 (CS-IDX)                   08540012
085500                        SUMMARY-TYPE-2 (CS-IDX)                   08550012
085600                        SUMMARY-TYPE-3 (CS-IDX)                   08560012
085700                        SUMMARY-TYPE-4 (CS-IDX)                   08570012
085800                        SUMMARY-TYPE-5 (CS-IDX)                   08580012
085900                        SUMMARY-TOTAL (CS-IDX)                    08590012
086000         MOVE SPACES TO SUMMARY-VENDOR (CS-IDX)                   08600012
086100     END-PERFORM.                                                 08610012
086200                                                                  08620012
086300******************************************************************08630001
086400*  READ SYSIN TO DETERMINE DATE RANGE DISPLAYED IN HEADING.      *08640001
086500******************************************************************08650001
086600 1100-PROCESS-DATECARD.                                           08660001
086700                                                                  08670001
086800     EXEC SQL                                                     08680001
086900         SELECT (CURRENT DATE - 1 DAY)                            08690001
087000              , CURRENT DATE                                      08700001
087100              , (CURRENT DATE - 1 YEAR)                           08710001
087200           INTO :PV-CURRENT-DB2-DATE-ONE                          08720001
087300              , :PV-CURRENT-DB2-DATE                              08730001
087400              , :PV-CURRENT-DB2-DATE-ONEYR                        08740001
087500           FROM TCOCNTL                                           08750001
087600          WHERE OPER_UNT_ID = 90                                  08760001
087700     END-EXEC.                                                    08770001
087800                                                                  08780001
087900     EVALUATE TRUE                                                08790001
088000       WHEN SQLCODE = ZERO                                        08800001
088100           MOVE PV-CURRENT-DB2-DATE     TO PV-CURR-DATE           08810001
088200           MOVE PV-CURRENT-DB2-CC       TO PV-CURRENT-CC          08820001
088300           MOVE PV-CURRENT-DB2-YY       TO PV-CURRENT-YY          08830001
088400                                           PV-CURRENT-YYMMDD-YY   08840001
088500           MOVE PV-CURRENT-DB2-MM       TO PV-CURRENT-MM          08850001
088600                                           PV-CURRENT-YYMMDD-MM   08860001
088700           MOVE PV-CURRENT-DB2-DD       TO PV-CURRENT-DD          08870001
088800                                           PV-CURRENT-YYMMDD-DD   08880001
088900       WHEN OTHER                                                 08890001
089000           MOVE '1100-PROCESS-DATECARD' TO PV-ABEND-PARAGRAPH     08900001
089100           MOVE 'SET DATE   ' TO PV-DB2-OPERATION-MESSAGE-1       08910001
089200           MOVE 'TCOCNTL'     TO PV-DB2-TABLE-NAME                08920001
089300           PERFORM 9900-DB2-ABEND                                 08930001
089400      END-EVALUATE.                                               08940001
089500                                                                  08950001
089600     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                08960001
089700                                                                  08970001
089800     DISPLAY '  CONTROL CARD SET-UP FOR THIS RUN IS: '            08980001
089900             CC-CONTROL-CARD-PARAMETERS.                          08990001
090000                                                                  09000001
090100     PERFORM 1110-CHECK-CC-PARAMETERS.                            09010001
090200     PERFORM 1120-SET-DATE-RANGE.                                 09020001
090300                                                                  09030001
090400******************************************************************09040001
090500 1110-CHECK-CC-PARAMETERS.                                        09050001
090600     MOVE '1110-CHECK-CC-PARAMETERS'   TO PV-ABEND-PARAGRAPH.     09060001
090700                                                                  09070001
090800     IF NOT CC-VALID-MODE-IND                                     09080001
090900         DISPLAY '***************************'                    09090001
091000         DISPLAY '**       ABEND           **'                    09100001
091100         DISPLAY '**  IN PROGRAM SUKRP021  **'                    09110002
091200         DISPLAY '***************************'                    09120001
091300         DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH    09130001
091400         DISPLAY '**   ERROR         ** = '                       09140001
091500                 'MODE INDICATOR "' CC-MODE-IND '"'               09150001
091600                 ' IS INVALID'                                    09160001
091700         DISPLAY '***************************'                    09170001
091800         DISPLAY '** CONTROL PARAMETERS = '                       09180001
091900                  CC-CONTROL-CARD-PARAMETERS                      09190001
092000         DISPLAY 'RUN ABORTED'                                    09200001
092100         DISPLAY '***************************'                    09210001
092200         MOVE 4003  TO PV-ABEND-CODE                              09220001
092300         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 09230001
092400         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    09240001
092500     END-IF.                                                      09250001
092600                                                                  09260001
092700     IF CC-BEG-DATE = PC-DEFAULT-CC-DATE                          09270001
092800       AND CC-END-DATE = PC-DEFAULT-CC-DATE                       09280001
092900         SET PS-NORMAL-RUN     TO TRUE                            09290001
093000     ELSE                                                         09300001
093100         SET PS-SPECIAL-RUN    TO TRUE                            09310001
093200         MOVE CC-BEG-CC        TO PV-BEG-YMD-CC                   09320001
093300         MOVE CC-BEG-YY        TO PV-BEG-YY                       09330001
093400         MOVE CC-BEG-YY        TO PV-BEG-YMD-YY                   09340001
093500         MOVE CC-BEG-MM        TO PV-BEG-MM                       09350001
093600         MOVE CC-BEG-MM        TO PV-BEG-YMD-MM                   09360001
093700         MOVE CC-BEG-DD        TO PV-BEG-DD                       09370001
093800         MOVE CC-BEG-DD        TO PV-BEG-YMD-DD                   09380001
093900         MOVE CC-END-CC        TO PV-END-YMD-CC                   09390001
094000         MOVE CC-END-YY        TO PV-END-YY                       09400001
094100         MOVE CC-END-YY        TO PV-END-YMD-YY                   09410001
094200         MOVE CC-END-MM        TO PV-END-MM                       09420001
094300         MOVE CC-END-MM        TO PV-END-YMD-MM                   09430001
094400         MOVE CC-END-DD        TO PV-END-DD                       09440001
094500         MOVE CC-END-DD        TO PV-END-YMD-DD                   09450001
094600                                                                  09460001
094700         IF PV-BEG-DATE-CYMD IS NOT < PV-END-DATE-CYMD            09470001
094800           AND PV-BEG-DATE-CYMD IS NOT = PV-END-DATE-CYMD         09480001
094900             DISPLAY '***************************'                09490001
095000             DISPLAY 'CONTROL PARAMETERS: '                       09500001
095100                     CC-CONTROL-CARD-PARAMETERS                   09510001
095200             DISPLAY 'THE BEGINNING DATE MUST BE LESS THAN '      09520001
095300                     'OR EQUAL TO THE ENDING DATE'                09530001
095400             DISPLAY 'PV-BEG-DATE - ' PV-BEG-DATE                 09540001
095500             DISPLAY 'PV-END-DATE - ' PV-BEG-DATE                 09550001
095600             DISPLAY 'PV-BEG-DATE-CYMD - ' PV-BEG-DATE-CYMD       09560001
095700             DISPLAY 'PV-END-DATE-CYMD - ' PV-BEG-DATE-CYMD       09570001
095800             DISPLAY 'RUN ABORTED'                                09580001
095900             DISPLAY '***************************'                09590001
096000             MOVE 4003  TO PV-ABEND-CODE                          09600001
096100             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             09610001
096200             CALL 'ILBOABN0'   USING PV-ABEND-CODE                09620001
096300         END-IF                                                   09630001
096400                                                                  09640001
096500         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           09650001
096600         SET DPG51-FISCAL-454-CALENDAR   TO TRUE                  09660001
096700         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  09670001
096800         SET DPG52-LK-DTE-GREG-FMT       TO TRUE                  09680001
096900         MOVE PV-BEG-DATE                TO DPG52-LK-DATE-INPUT   09690001
097000         PERFORM 9100-CALL-DATE-MODULE                            09700001
097100         IF DPG54-DATE-INVALID                                    09710001
097200             DISPLAY '***************************'                09720001
097300             DISPLAY 'CONTROL PARAMETERS: '                       09730001
097400                     CC-CONTROL-CARD-PARAMETERS                   09740001
097500             DISPLAY 'BEGINNING DATE  ' CC-BEG-DATE               09750001
097600                     ' IS INVALID.'                               09760001
097700             DISPLAY 'RUN ABORTED'                                09770001
097800             DISPLAY '***************************'                09780001
097900             MOVE 4003  TO PV-ABEND-CODE                          09790001
098000             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             09800001
098100             CALL 'ILBOABN0'   USING PV-ABEND-CODE                09810001
098200         END-IF                                                   09820001
098300                                                                  09830001
098400         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           09840001
098500         SET DPG51-FISCAL-454-CALENDAR   TO TRUE                  09850001
098600         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  09860001
098700         SET DPG52-LK-DTE-GREG-FMT       TO TRUE                  09870001
098800         MOVE PV-END-DATE                TO DPG52-LK-DATE-INPUT   09880001
098900         PERFORM 9100-CALL-DATE-MODULE                            09890001
099000         IF DPG54-DATE-INVALID                                    09900001
099100             DISPLAY '***************************'                09910001
099200             DISPLAY 'CONTROL PARAMETERS: '                       09920001
099300                     CC-CONTROL-CARD-PARAMETERS                   09930001
099400             DISPLAY 'ENDING DATE ' CC-END-DATE                   09940001
099500                     ' IS INVALID.'                               09950001
099600             DISPLAY 'RUN ABORTED'                                09960001
099700             DISPLAY '***************************'                09970001
099800             MOVE 4003  TO PV-ABEND-CODE                          09980001
099900             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             09990001
100000             CALL 'ILBOABN0'   USING PV-ABEND-CODE                10000001
100100         END-IF                                                   10010001
100200     END-IF.                                                      10020001
100300                                                                  10030001
100400     IF PS-SPECIAL-RUN                                            10040001
100500       AND CC-SEASONAL-EXTRACT                                    10050001
100600       AND DPG56-FISCAL-PERIOD-NBR < 7                            10060001
100700         MOVE PC-SPRING TO PV-SEASON-DESC                         10070001
100800     ELSE                                                         10080001
100900     IF PS-SPECIAL-RUN                                            10090001
101000       AND CC-SEASONAL-EXTRACT                                    10100001
101100         MOVE PC-FALL   TO PV-SEASON-DESC                         10110001
101200     END-IF.                                                      10120001
101300                                                                  10130001
101400******************************************************************10140001
101500 1120-SET-DATE-RANGE.                                             10150001
101600     MOVE '1120-SET-DATE-RANGE      ' TO PV-ABEND-PARAGRAPH.      10160001
101700                                                                  10170001
101800     IF PS-NORMAL-RUN                                             10180001
101900         PERFORM 1130-DETERMINE-DATE-RANGE                        10190001
102000     ELSE                                                         10200001
102100         MOVE CC-BEG-DATE TO PV-START-EXTRACT                     10210001
102200         MOVE CC-END-DATE TO PV-END-EXTRACT                       10220001
102300     END-IF.                                                      10230001
102400                                                                  10240001
102500     MOVE PV-START-EXTRACT-YYYY    TO WS-START-EXTRACT-YYYY.      10250001
102600     MOVE PV-START-EXTRACT-MM      TO WS-START-EXTRACT-MM.        10260001
102700     MOVE PV-START-EXTRACT-DD      TO WS-START-EXTRACT-DD.        10270001
102800     MOVE PV-END-EXTRACT-YYYY      TO WS-END-EXTRACT-YYYY.        10280001
102900     MOVE PV-END-EXTRACT-MM        TO WS-END-EXTRACT-MM.          10290001
103000     MOVE PV-END-EXTRACT-DD        TO WS-END-EXTRACT-DD.          10300001
103100                                                                  10310001
103200     MOVE DPG56-FISCAL-PERIOD-NBR  TO WS-FISCAL-PERIOD-NBR.       10320001
103300     MOVE DPG56-FISCAL-PERIOD-WEEK TO WS-FISCAL-PERIOD-WEEK.      10330001
103400     MOVE DPG56-FISCAL-QTR-NBR     TO WS-FISCAL-QTR-NBR.          10340001
103500     MOVE DPG56-FISCAL-WEEK-NBR    TO WS-FISCAL-WEEK-NBR.         10350001
103600                                                                  10360001
103700     MOVE PV-START-EXTRACT-MM      TO PV-DATE-START-MM.           10370001
103800     MOVE PV-START-EXTRACT-DD      TO PV-DATE-START-DD.           10380001
103900     MOVE PV-START-EXTRACT-YYYY    TO PV-DATE-START-CCYY.         10390001
104000     MOVE PV-END-EXTRACT-MM        TO PV-DATE-END-MM.             10400001
104100     MOVE PV-END-EXTRACT-DD        TO PV-DATE-END-DD.             10410001
104200     MOVE PV-END-EXTRACT-YYYY      TO PV-DATE-END-CCYY.           10420001
104300     MOVE WS-FISCAL-PERIOD-NBR     TO PV-DATE-FISCAL-PERIOD.      10430001
104400     MOVE WS-FISCAL-QTR-NBR        TO PV-DATE-FISCAL-QUARTER.     10440001
104500     MOVE PV-SEASON-DESC           TO PV-DATE-SEASON.             10450001
104600                                                                  10460001
104700     DISPLAY '  DATE RANGE SET-UP FOR THIS RUN IS: '              10470001
104800             PV-DATE-RECORD.                                      10480001
104900                                                                  10490001
105000******************************************************************10500001
105100 1130-DETERMINE-DATE-RANGE.                                       10510001
105200     MOVE '1130-DETERMINE-DATE-RANGE' TO PV-ABEND-PARAGRAPH.      10520001
105300                                                                  10530001
105400     EVALUATE TRUE                                                10540001
105500       WHEN CC-WEEKLY-EXTRACT                                     10550001
105600            PERFORM 1131-WEEKLY-RPT-DTE-RANGE                     10560001
105700                                                                  10570001
105800       WHEN CC-MONTHLY-EXTRACT                                    10580001
105900                PERFORM 1132-MONTHLY-RPT-DTE-RANGE                10590001
106000                                                                  10600001
106100       WHEN CC-FISCAL-EXTRACT                                     10610001
106200                PERFORM 1133-FISCAL-RPT-DTE-RANGE                 10620001
106300                                                                  10630001
106400       WHEN CC-CALENDAR-EXTRACT                                   10640001
106500                PERFORM 1134-CALENDAR-RPT-DTE-RANGE               10650001
106600                                                                  10660001
106700       WHEN CC-SEASONAL-EXTRACT                                   10670001
106800                PERFORM 1135-SEASONAL-RPT-DTE-RANGE               10680001
106900                                                                  10690001
107000     END-EVALUATE.                                                10700001
107100                                                                  10710001
107200*--------------------------------------------------------------   10720001
107300**** GET START/END DATES OF THE PREVIOUS WEEK.                    10730001
107400*--------------------------------------------------------------   10740001
107500 1131-WEEKLY-RPT-DTE-RANGE.                                       10750001
107600     MOVE '1131-WEEKLY-RPT-DTE-RANGE'  TO PV-ABEND-PARAGRAPH.     10760001
107700                                                                  10770001
107800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              10780001
107900     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               10790001
108000     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               10800001
108100     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               10810001
108200     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           10820001
108300     MOVE   PC-SEVEN           TO DPG51-INCR-DECR-DAYS-9.         10830001
108400                                                                  10840001
108500     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      10850001
108600     SET DPG51-DECREMENT-DATE       TO TRUE.                      10860001
108700     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      10870001
108800                                                                  10880001
108900     PERFORM 9100-CALL-DATE-MODULE                                10890001
109000                                                                  10900001
109100     IF DPG54-DATE-VALID                                          10910001
109200         MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO PV-START-EXTRACT      10920001
109300         MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PV-END-EXTRACT        10930001
109400     ELSE                                                         10940001
109500         DISPLAY 'DPG55-1ST-WKDY-DB2ISO-FMT - '                   10950001
109600                  DPG55-1ST-WKDY-DB2ISO-FMT                       10960001
109700         DISPLAY 'DPG55-LAST-WKDY-DB2ISO-FMT - '                  10970001
109800                  DPG55-LAST-WKDY-DB2ISO-FMT                      10980001
109900     END-IF.                                                      10990001
110000                                                                  11000001
110100*--------------------------------------------------------------   11010001
110200*** GET START/END DATES OF THE PREVIOUS MONTH.                    11020001
110300*--------------------------------------------------------------   11030001
110400 1132-MONTHLY-RPT-DTE-RANGE.                                      11040001
110500     MOVE '1132-MONTHLY-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.     11050001
110600                                                                  11060001
110700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11070001
110800     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY                11080001
110900     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM                11090001
111000     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD                11100001
111100     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            11110001
111200                                                                  11120001
111300     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9          11130001
111400                                                                  11140001
111500     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11150001
111600     SET DPG51-DECREMENT-DATE       TO TRUE.                      11160001
111700     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      11170001
111800                                                                  11180001
111900     PERFORM 9100-CALL-DATE-MODULE                                11190001
112000                                                                  11200001
112100     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                           11210001
112200                                  PV-START-EXTRACT                11220001
112300     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO                           11230001
112400                                  PV-END-EXTRACT.                 11240001
112500                                                                  11250001
112600*-------------------------------------------------------------    11260001
112700*** GET START/END DATES OF THE FISCAL PERIOD.                     11270001
112800*-------------------------------------------------------------    11280001
112900 1133-FISCAL-RPT-DTE-RANGE.                                       11290001
113000     MOVE '1133-FISCAL-RPT-DTE-RANGE ' TO PV-ABEND-PARAGRAPH.     11300001
113100                                                                  11310001
113200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11320001
113300     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               11330001
113400     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               11340001
113500     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               11350001
113600     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            11360001
113700                                                                  11370001
113800     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         11380001
113900                                                                  11390001
114000     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11400001
114100     SET DPG51-DECREMENT-DATE       TO TRUE.                      11410001
114200     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      11420001
114300                                                                  11430001
114400     PERFORM 9100-CALL-DATE-MODULE                                11440001
114500                                                                  11450001
114600     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         11460001
114700         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       11470001
114800                                  PV-START-EXTRACT                11480001
114900         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       11490001
115000                                  PV-END-EXTRACT                  11500001
115100     ELSE                                                         11510001
115200         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       11520001
115300                                  PV-START-EXTRACT                11530001
115400         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           11540001
115500         MOVE PC-ONE                   TO DPG51-INCR-DECR-DAYS-9  11550001
115600         MOVE PV-DATE-AREA             TO DPG52-LK-DATE-INPUT     11560001
115700         SET DPG51-FISCAL-454-CALENDAR TO TRUE                    11570001
115800         SET DPG51-DECREMENT-DATE      TO TRUE                    11580001
115900         SET DPG52-LK-DTE-GREG-FMT     TO TRUE                    11590001
116000         PERFORM 9100-CALL-DATE-MODULE                            11600001
116100         MOVE DPG55-DB2-ISO-DATE-FMT    TO  PV-END-EXTRACT        11610001
116200     END-IF.                                                      11620001
116300                                                                  11630001
116400*---------------------------------------------------------------- 11640001
116500*** GET START/END DATES OF THE CALENDAR PERIOD.                   11650001
116600*---------------------------------------------------------------- 11660001
116700 1134-CALENDAR-RPT-DTE-RANGE.                                     11670001
116800     MOVE '1134-CALENDAR-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    11680001
116900                                                                  11690001
117000     IF PV-CURRENT-MM = 1 THEN                                    11700001
117100****   IF JANUARY WANT TO CREATE REPORT FOR PREV. CALENDAR YEAR   11710001
117200         MOVE PV-CDD-ONEYR-CCYY         TO PV-START-EXTRACT-YYYY  11720001
117300                                           PV-END-EXTRACT-YYYY    11730001
117400         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   11740001
117500         MOVE  01      TO  PV-START-EXTRACT-MM                    11750001
117600         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   11760001
117700         MOVE  01      TO  PV-START-EXTRACT-DD                    11770001
117800         MOVE  '-'     TO  PV-END-EXTRACT-1ST                     11780001
117900         MOVE   12     TO  PV-END-EXTRACT-MM                      11790001
118000         MOVE  '-'     TO  PV-END-EXTRACT-2ND                     11800001
118100         MOVE   31     TO  PV-END-EXTRACT-DD                      11810001
118200     ELSE                                                         11820001
118300*        CURRENT MONTH > 01                                       11830001
118400*                          BEGINNING DATE = CURRENT YEAR, 01, 01  11840001
118500*                          ENDING DATE    = CURRENT DATE - 1      11850001
118600         MOVE PV-CURRENT-CCYY TO PV-START-EXTRACT-YYYY            11860001
118700         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   11870001
118800         MOVE  01      TO  PV-START-EXTRACT-MM                    11880001
118900         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   11890001
119000         MOVE  01      TO  PV-START-EXTRACT-DD                    11900001
119100                                                                  11910001
119200         MOVE PV-CURRENT-DB2-DATE-ONE TO PV-END-EXTRACT           11920001
119300     END-IF.                                                      11930001
119400                                                                  11940001
119500*-----------------------------------------------------------------11950001
119600* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             11960001
119700*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           11970001
119800* FROM PV-END-EXTRACT DATE.                                       11980001
119900*-----------------------------------------------------------------11990001
120000                                                                  12000001
120100     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     12010001
120200     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     12020001
120300     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     12030001
120400     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     12040001
120500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12050001
120600     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   12060001
120700     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  12070001
120800     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  12080001
120900     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  12090001
121000                                                                  12100001
121100     PERFORM 9100-CALL-DATE-MODULE.                               12110001
121200                                                                  12120001
121300*-------------------------------------------------------------    12130001
121400*** GET START/END DATES SEASONAL                                  12140001
121500*-------------------------------------------------------------    12150001
121600 1135-SEASONAL-RPT-DTE-RANGE.                                     12160001
121700     MOVE '1135-SEASONAL-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    12170001
121800                                                                  12180001
121900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12190001
122000     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               12200001
122100     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               12210001
122200     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               12220001
122300     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           12230001
122400                                                                  12240001
122500     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         12250001
122600                                                                  12260001
122700     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      12270001
122800     SET DPG51-DECREMENT-DATE       TO TRUE.                      12280001
122900     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      12290001
123000                                                                  12300001
123100     PERFORM 9100-CALL-DATE-MODULE                                12310001
123200                                                                  12320001
123300     IF DPG56-FISCAL-PERIOD-NBR < 7                               12330001
123400        MOVE PC-SPRING TO PV-SEASON-DESC                          12340001
123500     ELSE                                                         12350001
123600        MOVE PC-FALL   TO PV-SEASON-DESC                          12360001
123700     END-IF.                                                      12370001
123800     IF DPG56-FISCAL-PERIOD-NBR < 6 THEN                          12380001
123900         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12390001
124000                                  PV-START-EXTRACT                12400001
124100         MOVE PV-CURRENT-DB2-DATE-ONE TO                          12410001
124200                           PV-END-EXTRACT                         12420001
124300     END-IF.                                                      12430001
124400     IF DPG56-FISCAL-PERIOD-NBR = 6 THEN                          12440001
124500         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12450001
124600                                  PV-START-EXTRACT                12460001
124700         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       12470001
124800                                  PV-END-EXTRACT                  12480001
124900     END-IF.                                                      12490001
125000     IF DPG56-FISCAL-PERIOD-NBR = 7 THEN                          12500001
125100         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12510001
125200                                  PV-START-EXTRACT                12520001
125300         MOVE PV-CURRENT-DB2-DATE-ONE TO                          12530001
125400                                  PV-END-EXTRACT                  12540001
125500     END-IF.                                                      12550001
125600     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          12560001
125700         MOVE PV-CURRENT-DB2-DATE-ONE TO                          12570001
125800                                  PV-END-EXTRACT                  12580001
125900     END-IF.                                                      12590001
126000     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         12600001
126100         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       12610001
126200                                  PV-END-EXTRACT                  12620001
126300     END-IF.                                                      12630001
126400     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          12640001
126500         MOVE DPG56-FIRST-FD-DB2-ISO-FMT-YR                       12650001
126600                               TO  PV-YEAR-FORMAT                 12660001
126700         MOVE PV-YEAR-FORMAT-YY TO PV-DATE-AREA-YY                12670001
126800         MOVE 01               TO  PV-DATE-AREA-MM                12680001
126900         MOVE 01               TO  PV-DATE-AREA-DD                12690001
127000         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           12700001
127100         MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT            12710001
127200         MOVE 220              TO DPG51-INCR-DECR-DAYS-9          12720001
127300         SET DPG51-FISCAL-454-CALENDAR  TO TRUE                   12730001
127400         SET DPG51-INCREMENT-DATE       TO TRUE                   12740001
127500         SET DPG52-LK-DTE-GREG-FMT      TO TRUE                   12750001
127600         PERFORM 9100-CALL-DATE-MODULE                            12760001
127700         MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                       12770001
127800                                  PV-START-EXTRACT                12780001
127900     END-IF.                                                      12790001
128000                                                                  12800001
128100*-----------------------------------------------------------------12810001
128200* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             12820001
128300*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           12830001
128400* FROM PV-END-EXTRACT DATE.                                       12840001
128500*-----------------------------------------------------------------12850001
128600                                                                  12860001
128700     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     12870001
128800     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     12880001
128900     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     12890001
129000     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     12900001
129100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12910001
129200     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   12920001
129300     MOVE  ZEROES                      TO  DPG51-INCR-DECR-DAYS-9.12930001
129400     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  12940001
129500     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  12950001
129600     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  12960001
129700                                                                  12970001
129800     PERFORM 9100-CALL-DATE-MODULE.                               12980001
129900                                                                  12990001
130000******************************************************************13000001
130100*  PRINT THE REPORT HEADINGS.                                    *13010001
130200******************************************************************13020001
130300 1200-PRINT-HEADINGS.                                             13030001
130400                                                                  13040001
130500     ADD 1  TO PV-PAGE-COUNT.                                     13050001
130600     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     13060001
130700                                                                  13070001
130800     WRITE OUTPUT-REC                                             13080001
130900       FROM DP132-STANDRD-HEADER-132-COLS                         13090001
131000         AFTER ADVANCING PAGE.                                    13100001
131100                                                                  13110001
131200     MOVE +1 TO PV-LINE-COUNT.                                    13120001
131300                                                                  13130001
131400     WRITE OUTPUT-REC                                             13140001
131500       FROM HEADING-LINE-1                                        13150001
131600         AFTER ADVANCING 2 LINES.                                 13160001
131700                                                                  13170001
131800     MOVE PV-DATE-START-MM   TO HL2-FROM-DATE-MM.                 13180001
131900     MOVE PV-DATE-START-DD   TO HL2-FROM-DATE-DD.                 13190001
132000     MOVE PV-DATE-START-CCYY TO HL2-FROM-DATE-YYYY.               13200001
132100     MOVE PV-DATE-END-MM     TO HL2-TO-DATE-MM.                   13210001
132200     MOVE PV-DATE-END-DD     TO HL2-TO-DATE-DD.                   13220001
132300     MOVE PV-DATE-END-CCYY   TO HL2-TO-DATE-YYYY.                 13230001
132400     WRITE OUTPUT-REC                                             13240001
132500       FROM HEADING-LINE-2                                        13250001
132600         AFTER ADVANCING 1 LINES.                                 13260001
132700                                                                  13270001
132800     MOVE PV-CURR-VEND TO HL3-VEND-NAME.                          13280001
132900     WRITE OUTPUT-REC                                             13290001
133000       FROM HEADING-LINE-3                                        13300001
133100         AFTER ADVANCING 2 LINES.                                 13310001
133200                                                                  13320001
133300     WRITE OUTPUT-REC                                             13330001
133400       FROM HEADING-LINE-5                                        13340001
133500         AFTER ADVANCING 1 LINES.                                 13350001
133600                                                                  13360001
133700     WRITE OUTPUT-REC                                             13370001
133800       FROM HEADING-LINE-6                                        13380001
133900         AFTER ADVANCING 1 LINES.                                 13390001
134000                                                                  13400001
134100     WRITE OUTPUT-REC                                             13410001
134200       FROM HEADING-LINE-7                                        13420001
134300         AFTER ADVANCING 1 LINES.                                 13430001
134400                                                                  13440001
134500     PERFORM 1210-TYPE-HEADING.                                   13450010
134600                                                                  13460010
134700     WRITE OUTPUT-REC                                             13470001
134800       FROM BLANK-LINE                                            13480001
134900         AFTER ADVANCING 1 LINES.                                 13490001
135000                                                                  13500001
135100     MOVE +15 TO PV-LINE-COUNT.                                   13510001
135200                                                                  13520001
135300******************************************************************13530001
135400 1210-TYPE-HEADING.                                               13540001
135500                                                                  13550001
135600     MOVE PV-CURR-TYPE TO HL4-MISDIRECT-TYPE.                     13560001
135700                                                                  13570001
135800     IF PV-CURR-TYPE = '1'                                        13580001
135900         MOVE PC-MISDIRECT-DESC-1 TO HL4-MISDIRECT-DESC           13590001
136000     END-IF.                                                      13600001
136100     IF PV-CURR-TYPE = '2'                                        13610001
136200         MOVE PC-MISDIRECT-DESC-2 TO HL4-MISDIRECT-DESC           13620001
136300     END-IF.                                                      13630001
136400     IF PV-CURR-TYPE = '3'                                        13640001
136500         MOVE PC-MISDIRECT-DESC-3 TO HL4-MISDIRECT-DESC           13650001
136600     END-IF.                                                      13660001
136700     IF PV-CURR-TYPE = '4'                                        13670001
136800         MOVE PC-MISDIRECT-DESC-4 TO HL4-MISDIRECT-DESC           13680001
136900     END-IF.                                                      13690001
137000***  IF PV-CURR-TYPE = '5'                                        13700007
137100***      MOVE PC-MISDIRECT-DESC-5 TO HL4-MISDIRECT-DESC           13710007
137200***  END-IF.                                                      13720007
137300                                                                  13730001
137400     WRITE OUTPUT-REC                                             13740001
137500       FROM HEADING-LINE-4                                        13750001
137600         AFTER ADVANCING 2 LINES.                                 13760001
137700                                                                  13770001
137800******************************************************************13780001
137900*  PRINT A 'NO INPUT' REPORT LINE.                               *13790001
138000******************************************************************13800001
138100 1300-NO-DETAIL-LINE.                                             13810001
138200                                                                  13820001
138300     WRITE OUTPUT-REC                                             13830001
138400       FROM NO-DATA-TO-REPORT-LINE                                13840001
138500         AFTER ADVANCING 3 LINES.                                 13850001
138600                                                                  13860001
138700******************************************************************13870001
138800*  PRINT A 'END OF REPORT' REPORT LINE.                          *13880001
138900******************************************************************13890001
139000 1400-END-OF-RPT-LINE.                                            13900001
139100                                                                  13910001
139200*CHECK FOR OVERFLOW.                                              13920001
139300*    ADD 3 TO PV-LINE-COUNT.                                      13930022
139400*    IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         13940022
139500*        SET PS-NEW-PAGE TO TRUE                                  13950022
139600*        PERFORM 1200-PRINT-HEADINGS                              13960022
139700*    END-IF.                                                      13970022
139800                                                                  13980001
139900*PRINT LINE.                                                      13990001
140000     WRITE OUTPUT-REC                                             14000001
140100       FROM END-OF-REPORT-LINE                                    14010001
140200         AFTER ADVANCING 3 LINES.                                 14020001
140300                                                                  14030001
140400******************************************************************14040001
140500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR READING THE INPUT  *14050001
140600*  EXTRACT FILE (FORMAT SURD008) AND CREATING THE 'INTRA-COMPANY *14060001
140700*  MISDIRECTS FROM UCC128 SCAN RESULTS BY DC, VENDOR' REPORT.    *14070001
140800******************************************************************14080001
140900 2000-PROCESS-EXTRACT.                                            14090001
141000                                                                  14100001
141100*CHECK FOR BREAKS.                                                14110001
141200     IF SU008-VEND-NAME NOT = PV-CURR-VEND                        14120001
141300         PERFORM 2010-TYPE-BREAK                                  14130001
141400         PERFORM 2020-VEND-BREAK                                  14140001
141500         MOVE SU008-MISDIRECT-TYPE TO PV-CURR-TYPE                14150017
141600         MOVE SU008-VEND-NAME      TO PV-CURR-VEND                14160017
141700         MOVE 0                    TO PV-PAGE-COUNT               14170017
141800         PERFORM 1200-PRINT-HEADINGS                              14180001
141900         MOVE SPACES TO PV-CURR-SCAC                              14190001
142000                        PV-CURR-VEH-NBR                           14200001
142100         MOVE ZEROES TO PV-CURR-LOCN                              14210001
142200                        PV-CURR-PO-NBR                            14220001
142300                        PV-CURR-REC-SEQ-NBR                       14230001
142400     ELSE                                                         14240001
142500         IF SU008-MISDIRECT-TYPE NOT = PV-CURR-TYPE               14250001
142600             PERFORM 2010-TYPE-BREAK                              14260001
142700             MOVE SU008-MISDIRECT-TYPE TO PV-CURR-TYPE            14270018
142800             PERFORM 1210-TYPE-HEADING                            14280017
142900             MOVE SPACES TO PV-CURR-SCAC                          14290001
143000                            PV-CURR-VEH-NBR                       14300001
143100             MOVE ZEROES TO PV-CURR-LOCN                          14310001
143200                            PV-CURR-PO-NBR                        14320001
143300                            PV-CURR-REC-SEQ-NBR                   14330001
143400         END-IF                                                   14340001
143500     END-IF.                                                      14350001
143600                                                                  14360001
143700*PRINT DETAIL LINE.                                               14370001
143800     PERFORM 2100-PRINT-DETAIL.                                   14380001
143900     SET PS-FIRST-TIME-NO TO TRUE.                                14390001
144000     ADD +1 TO PV-REC-OUT-QTY.                                    14400001
144100                                                                  14410001
144200*READ NEXT INPUT RECORD.                                          14420001
144300     PERFORM 0100-READ-EXTRACT.                                   14430001
144400     IF NOT PS-END-OF-INPUT                                       14440001
144500         ADD +1 TO PV-REC-IN-QTY                                  14450001
144600     END-IF.                                                      14460001
144700                                                                  14470001
144800******************************************************************14480001
144900*  PRINT A REPORT SUB-TOTAL LINE (BY MISDIRECT TYPE).            *14490001
145000******************************************************************14500001
145100 2010-TYPE-BREAK.                                                 14510001
145200                                                                  14520001
145300*FILL NUMBER OF MISDIRECTS.                                       14530001
145400     MOVE PV-CURR-TYPE    TO TL1-MISDIRECT-TYPE.                  14540001
145500     MOVE PV-ACCUM-TYPE   TO PV-FORMAT-ACCUM.                     14550001
145600     MOVE PV-FORMAT-ACCUM TO TL1-TOTAL-TYPE.                      14560001
145700                                                                  14570014
145800*SAVE ACCUMULATED TYPE COUNT.                                     14580014
145900     PERFORM 2015-SAVE-TYPE-COUNT.                                14590014
146000                                                                  14600001
146100*CHECK FOR OVERFLOW.                                              14610001
146200     ADD 2 TO PV-LINE-COUNT.                                      14620001
146300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         14630001
146400         SET PS-NEW-PAGE TO TRUE                                  14640001
146500         PERFORM 1200-PRINT-HEADINGS                              14650001
146600     END-IF.                                                      14660001
146700                                                                  14670001
146800*WRITE TOTAL LINE.                                                14680001
146900     WRITE OUTPUT-REC                                             14690001
147000       FROM TOTAL-LINE-1                                          14700001
147100         AFTER ADVANCING 2 LINES.                                 14710001
147200                                                                  14720001
147300*RE-INITIALIZE ACCUMULATORS.                                      14730001
147400     MOVE ZEROES TO PV-ACCUM-TYPE.                                14740001
147500                                                                  14750001
147600******************************************************************14760014
147700 2015-SAVE-TYPE-COUNT.                                            14770014
147800                                                                  14780014
147900     IF PV-CURR-TYPE = '1'                                        14790014
148000         MOVE PV-ACCUM-TYPE TO PV-ACCUM-V1                        14800014
148100         ADD PV-ACCUM-TYPE  TO PV-ACCUM-T1                        14810015
148200                               PV-ACCUM-TOTL                      14820016
148300     END-IF.                                                      14830014
148400     IF PV-CURR-TYPE = '2'                                        14840014
148500         MOVE PV-ACCUM-TYPE TO PV-ACCUM-V2                        14850014
148600         ADD PV-ACCUM-TYPE  TO PV-ACCUM-T2                        14860015
148700                               PV-ACCUM-TOTL                      14870016
148800     END-IF.                                                      14880014
148900     IF PV-CURR-TYPE = '3'                                        14890014
149000         MOVE PV-ACCUM-TYPE TO PV-ACCUM-V3                        14900014
149100         ADD PV-ACCUM-TYPE  TO PV-ACCUM-T3                        14910015
149200                               PV-ACCUM-TOTL                      14920016
149300     END-IF.                                                      14930014
149400     IF PV-CURR-TYPE = '4'                                        14940014
149500         MOVE PV-ACCUM-TYPE TO PV-ACCUM-V4                        14950014
149600         ADD PV-ACCUM-TYPE  TO PV-ACCUM-T4                        14960015
149700                               PV-ACCUM-TOTL                      14970016
149800     END-IF.                                                      14980014
149900     IF PV-CURR-TYPE = '5'                                        14990014
150000         MOVE PV-ACCUM-TYPE TO PV-ACCUM-V5                        15000014
150100         ADD PV-ACCUM-TYPE  TO PV-ACCUM-T5                        15010015
150200                               PV-ACCUM-TOTL                      15020016
150300     END-IF.                                                      15030014
150400                                                                  15040014
150500******************************************************************15050001
150600*  PRINT A REPORT SUB-TOTAL LINE (BY VENDOR NAME).               *15060001
150700******************************************************************15070001
150800 2020-VEND-BREAK.                                                 15080001
150900                                                                  15090001
151000*FILL NUMBER OF MISDIRECTS.                                       15100001
151100     MOVE PV-ACCUM-VEND   TO PV-FORMAT-ACCUM.                     15110001
151200     MOVE PV-FORMAT-ACCUM TO TL2-TOTAL-VEND.                      15120001
151300                                                                  15130001
151400*CHECK FOR OVERFLOW.                                              15140001
151500     ADD 2 TO PV-LINE-COUNT.                                      15150001
151600     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         15160001
151700         SET PS-NEW-PAGE TO TRUE                                  15170001
151800         PERFORM 1200-PRINT-HEADINGS                              15180001
151900     END-IF.                                                      15190001
152000                                                                  15200001
152100*WRITE TOTAL LINE.                                                15210001
152200     WRITE OUTPUT-REC                                             15220001
152300       FROM TOTAL-LINE-2                                          15230001
152400         AFTER ADVANCING 2 LINES.                                 15240001
152500                                                                  15250001
152600*SAVE VENDOR DATA TO TABLE.                                       15260012
152700     SET PS-NOT-END-OF-TABLE TO TRUE.                             15270012
152800     PERFORM 2025-SAVE-VENDOR-DATA.                               15280012
152900     IF PS-END-OF-TABLE                                           15290012
153000         MOVE '2025-SAVE-VENDOR-DATA' TO PV-ABEND-PARAGRAPH       15300012
153100         MOVE 'SUMMARY '              TO PV-ABEND-STRUCTURE-1     15310012
153200         MOVE 'TABLE TOO SMALL - OVER 2000 VENDORS PROCESSED'     15320028
153300                                      TO PV-ABEND-OPERATION       15330012
153400         PERFORM 9900-DB2-ABEND                                   15340012
153500     END-IF.                                                      15350012
153600                                                                  15360012
153700*RE-INITIALIZE ACCUMULATORS.                                      15370001
153800     MOVE ZEROES TO PV-ACCUM-VEND.                                15380001
153900     MOVE ZEROES TO PV-ACCUM-V1                                   15390014
154000                    PV-ACCUM-V2                                   15400014
154100                    PV-ACCUM-V3                                   15410014
154200                    PV-ACCUM-V4                                   15420014
154300                    PV-ACCUM-V5.                                  15430014
154400                                                                  15440001
154500******************************************************************15450014
154600 2025-SAVE-VENDOR-DATA.                                           15460012
154700                                                                  15470012
154800     SET CS-IDX TO 1.                                             15480012
154900                                                                  15490012
155000     SEARCH SUMMARY-TABLE                                         15500012
155100       VARYING CS-IDX                                             15510012
155200         AT END SET PS-END-OF-TABLE TO TRUE                       15520012
155300                                                                  15530012
155400         WHEN SUMMARY-VENDOR (CS-IDX) = SPACES                    15540012
155500             MOVE PV-CURR-VEND   TO SUMMARY-VENDOR (CS-IDX)       15550012
155600             MOVE PV-ACCUM-V1    TO SUMMARY-TYPE-1 (CS-IDX)       15560014
155700             MOVE PV-ACCUM-V2    TO SUMMARY-TYPE-2 (CS-IDX)       15570014
155800             MOVE PV-ACCUM-V3    TO SUMMARY-TYPE-3 (CS-IDX)       15580014
155900             MOVE PV-ACCUM-V4    TO SUMMARY-TYPE-4 (CS-IDX)       15590014
156000             MOVE PV-ACCUM-V5    TO SUMMARY-TYPE-5 (CS-IDX)       15600014
156100             MOVE PV-ACCUM-VEND  TO SUMMARY-TOTAL (CS-IDX)        15610014
156200                                                                  15620012
156300     END-SEARCH.                                                  15630012
156400                                                                  15640012
156500******************************************************************15650001
156600*  FILL AND DETAIL REPORT LINE.                                  *15660001
156700******************************************************************15670001
156800 2100-PRINT-DETAIL.                                               15680001
156900                                                                  15690001
157000*FILL SCAC.                                                       15700001
157100     IF (SU008-SCAC-CDE = PV-CURR-SCAC)                           15710001
157200       AND (SU008-VEH-NBR  = PV-CURR-VEH-NBR)                     15720001
157300         MOVE SPACES             TO DL1-SCAC                      15730001
157400     ELSE                                                         15740001
157500         MOVE SU008-SCAC-CDE     TO DL1-SCAC                      15750001
157600                                    PV-CURR-SCAC                  15760001
157700         MOVE ZEROES             TO PV-CURR-LOCN                  15770004
157800                                    PV-CURR-PO-NBR                15780004
157900                                    PV-CURR-REC-SEQ-NBR           15790001
158000     END-IF.                                                      15800001
158100*FILL TRAILER.                                                    15810001
158200     IF (SU008-VEH-NBR  = PV-CURR-VEH-NBR)                        15820001
158300         MOVE SPACES             TO DL1-TRAILER                   15830003
158400     ELSE                                                         15840001
158500         MOVE SU008-VEH-NBR      TO DL1-TRAILER                   15850003
158600                                    PV-CURR-VEH-NBR               15860003
158700     END-IF.                                                      15870001
158800*FILL RCVG LOCATION.                                              15880003
158900     IF (SU008-SCN-OPER-UNT-ID = PV-CURR-LOCN)                    15890003
159000         MOVE SPACES             TO DL1-RCVG-LOC                  15900005
159100     ELSE                                                         15910003
159200         MOVE SU008-SCN-OPER-UNT-ID TO PV-CURR-LOCN               15920005
159300         MOVE PV-CURR-LOCN          TO DL1-RCVG-LOC               15930005
159400     END-IF.                                                      15940003
159500*FILL PO/RECEIVER.                                                15950001
159600     IF (SU008-PO-NBR = PV-CURR-PO-NBR)                           15960001
159700       AND (SU008-REC-SEQ-NBR = PV-CURR-REC-SEQ-NBR)              15970001
159800         MOVE SPACES             TO DL1-PO-RCVR                   15980001
159900     ELSE                                                         15990001
160000         MOVE SU008-PO-NBR       TO PV-FORMAT-PO-NBR              16000001
160100                                    PV-CURR-PO-NBR                16010001
160200         MOVE SU008-REC-SEQ-NBR  TO PV-FORMAT-REC-SEQ             16020001
160300                                    PV-CURR-REC-SEQ-NBR           16030001
160400         MOVE PV-FORMAT-PO       TO DL1-PO-RCVR                   16040001
160500     END-IF.                                                      16050001
160600*FILL DEST STORE.                                                 16060001
160700     MOVE SU008-DEST-OPER-UNT-ID TO DL1-DEST-STR.                 16070001
160800*FILL PROCESS DC NUMBER.                                          16080023
160900     MOVE SU008-PROCESS-DC-NBR   TO DL1-PROCESS-DC.               16090023
161000*FILL SERIAL SHIP CODE.                                           16100001
161100     MOVE SU008-SHIPT-UNT-ID     TO DL1-SERIAL-SHIP-CODE.         16110001
161200*FILL SCAN DATE.                                                  16120001
161300     MOVE SU008-SCN-DATE         TO PV-INPUT-DATE.                16130001
161400     MOVE PV-INPUT-DATE-YY       TO PV-FORMAT-DATE-YY             16140001
161500     MOVE PV-INPUT-DATE-MM       TO PV-FORMAT-DATE-MM             16150001
161600     MOVE PV-INPUT-DATE-DD       TO PV-FORMAT-DATE-DD             16160001
161700     MOVE PV-FORMAT-DATE         TO DL1-SCAN-DATE.                16170001
161800*FILL SCAN TIME.                                                  16180001
161900     MOVE SU008-SCN-TIME         TO PV-INPUT-TIME.                16190001
162000     MOVE PV-INPUT-TIME-HH       TO PV-FORMAT-TIME-HH.            16200001
162100     MOVE PV-INPUT-TIME-MM       TO PV-FORMAT-TIME-MM.            16210001
162200     MOVE PV-FORMAT-TIME         TO DL1-SCAN-TIME.                16220001
162300*FILL SCAN USER ID.                                               16230001
162400     MOVE SU008-SCN-USR-ID       TO DL1-SCAN-USERID.              16240001
162500*FILL ASN NUMBER.                                                 16250001
162600     MOVE SU008-ASN-NBR          TO DL1-ASN-NUMBER.               16260001
162700*FILL ASN DATE.                                                   16270001
162800     MOVE SU008-ASN-CRE-DATE     TO PV-INPUT-DATE.                16280001
162900     MOVE PV-INPUT-DATE-YY       TO PV-FORMAT-DATE-YY             16290001
163000     MOVE PV-INPUT-DATE-MM       TO PV-FORMAT-DATE-MM             16300001
163100     MOVE PV-INPUT-DATE-DD       TO PV-FORMAT-DATE-DD             16310001
163200     MOVE PV-FORMAT-DATE         TO DL1-ASN-DATE.                 16320001
163300*FILL ASN TIME.                                                   16330001
163400     MOVE SU008-ASN-CRE-TIME     TO PV-INPUT-TIME.                16340001
163500     MOVE PV-INPUT-TIME-HH       TO PV-FORMAT-TIME-HH.            16350001
163600     MOVE PV-INPUT-TIME-MM       TO PV-FORMAT-TIME-MM.            16360001
163700     MOVE PV-FORMAT-TIME         TO DL1-ASN-TIME.                 16370001
163800*FILL ASN RECEIVING OPERATOR.                                     16380001
163900     MOVE SU008-ORGN-OPER-UNT-ID TO DL1-RCVG-OPER.                16390001
164000                                                                  16400001
164100*ACCUMULATE QUANTITY FIELDS.                                      16410001
164200     ADD +1                     TO PV-ACCUM-TYPE                  16420001
164300                                   PV-ACCUM-VEND.                 16430001
164400                                                                  16440001
164500*CHECK FOR OVERFLOW.                                              16450001
164600     ADD 1 TO PV-LINE-COUNT.                                      16460001
164700     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         16470001
164800         SET PS-NEW-PAGE TO TRUE                                  16480001
164900         PERFORM 1200-PRINT-HEADINGS                              16490001
165000     END-IF.                                                      16500001
165100                                                                  16510001
165200*IF NEW PAGE, DISPLAY SCAC, TRLR, RCVG LOC. & PO# ON FIRST LINE.  16520011
165300     IF PS-NEW-PAGE                                               16530010
165400         MOVE SU008-SCAC-CDE        TO DL1-SCAC                   16540010
165500         MOVE SU008-VEH-NBR         TO DL1-TRAILER                16550010
165600         MOVE SU008-SCN-OPER-UNT-ID TO PV-CURR-LOCN               16560010
165700         MOVE PV-CURR-LOCN          TO DL1-RCVG-LOC               16570010
165800         MOVE SU008-PO-NBR          TO PV-FORMAT-PO-NBR           16580010
165900         MOVE SU008-REC-SEQ-NBR     TO PV-FORMAT-REC-SEQ          16590010
166000         MOVE PV-FORMAT-PO          TO DL1-PO-RCVR                16600010
166100         SET PS-SAME-PAGE           TO TRUE                       16610010
166200     END-IF.                                                      16620010
166300                                                                  16630010
166400*WRITE DETAIL LINE.                                               16640001
166500     WRITE OUTPUT-REC                                             16650001
166600       FROM DETAIL-LINE-1                                         16660001
166700         AFTER ADVANCING 1 LINES.                                 16670001
166800                                                                  16680001
166900*SET SWITCH FOR IDENTIFYING DATA PRESENT FOR MISDIRECT TYPE.      16690001
167000     SET PS-TYPE-DATA-YES TO TRUE.                                16700001
167100                                                                  16710001
167200******************************************************************16720012
167300*  PRINT VENDOR SUMMARY PAGE                                     *16730012
167400******************************************************************16740012
167500 3000-PRINT-SUMMARY.                                              16750012
167600                                                                  16760012
167700     MOVE 0 TO PV-PAGE-COUNT.                                     16770020
167800     PERFORM 3100-PRINT-SUMMARY-HDGS.                             16780020
167900                                                                  16790020
168000*PRINT VENDOR SUMMARY DETAIL.                                     16800012
168100     PERFORM VARYING CS-IDX FROM 1 BY 1                           16810012
168200       UNTIL SUMMARY-VENDOR (CS-IDX) = SPACES                     16820013
168300                                                                  16830012
168400         MOVE SUMMARY-VENDOR (CS-IDX)     TO CS-VENDOR-NAME       16840012
168500         MOVE SUMMARY-TYPE-1 (CS-IDX)     TO PV-FORMAT-QTY        16850012
168600         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-1       16860012
168700         MOVE SUMMARY-TYPE-2 (CS-IDX)     TO PV-FORMAT-QTY        16870012
168800         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-2       16880012
168900         MOVE SUMMARY-TYPE-3 (CS-IDX)     TO PV-FORMAT-QTY        16890012
169000         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-3       16900012
169100         MOVE SUMMARY-TYPE-4 (CS-IDX)     TO PV-FORMAT-QTY        16910012
169200         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-4       16920012
169300***      MOVE SUMMARY-TYPE-5 (CS-IDX)     TO PV-FORMAT-QTY        16930012
169400***      MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-5       16940012
169500         MOVE SUMMARY-TOTAL (CS-IDX)      TO PV-FORMAT-QTY        16950012
169600         MOVE PV-FORMAT-QTY               TO CS-LOCN-TOTAL        16960012
169700                                                                  16970012
169800         ADD 1 TO PV-LINE-COUNT                                   16980020
169900         IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                     16990020
170000             PERFORM 3100-PRINT-SUMMARY-HDGS                      17000020
170100         END-IF                                                   17010020
170200                                                                  17020020
170300         WRITE OUTPUT-REC                                         17030012
170400           FROM DETAIL-LINE-1-CS                                  17040012
170500             AFTER ADVANCING 1 LINES                              17050012
170600                                                                  17060020
170700     END-PERFORM.                                                 17070012
170800                                                                  17080012
170900*CHECK FOR OVERFLOW.                                              17090020
171000     ADD 6 TO PV-LINE-COUNT.                                      17100020
171100     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         17110020
171200         PERFORM 3100-PRINT-SUMMARY-HDGS                          17120020
171300     END-IF.                                                      17130020
171400                                                                  17140020
171500*BLANK LINES.                                                     17150012
171600     WRITE OUTPUT-REC                                             17160012
171700       FROM BLANK-LINE                                            17170012
171800         AFTER ADVANCING 5 LINES.                                 17180012
171900                                                                  17190012
172000*PRINT VENDOR SUMMARY TOTALS.                                     17200015
172100     MOVE PV-ACCUM-T1   TO CS-TOTL-TYPE-1.                        17210012
172200     MOVE PV-ACCUM-T2   TO CS-TOTL-TYPE-2.                        17220012
172300     MOVE PV-ACCUM-T3   TO CS-TOTL-TYPE-3.                        17230012
172400     MOVE PV-ACCUM-T4   TO CS-TOTL-TYPE-4.                        17240012
172500***  MOVE PV-ACCUM-T5   TO CS-TOTL-TYPE-5.                        17250012
172600     MOVE PV-ACCUM-TOTL TO CS-TOTL-TOTAL.                         17260012
172700     WRITE OUTPUT-REC                                             17270012
172800       FROM TOTAL-LINE-1-CS                                       17280012
172900         AFTER ADVANCING 1 LINES.                                 17290012
173000                                                                  17300012
173100******************************************************************17310020
173200*  PRINT VENDOR SUMMARY PAGE HEADINGS.                           *17320020
173300******************************************************************17330020
173400 3100-PRINT-SUMMARY-HDGS.                                         17340020
173500                                                                  17350020
173600     ADD 1 TO PV-PAGE-COUNT.                                      17360021
173700     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     17370020
173800                                                                  17380020
173900     WRITE OUTPUT-REC                                             17390020
174000       FROM DP132-STANDRD-HEADER-132-COLS                         17400020
174100         AFTER ADVANCING PAGE.                                    17410020
174200                                                                  17420020
174300     WRITE OUTPUT-REC                                             17430020
174400       FROM HEADING-LINE-1                                        17440020
174500         AFTER ADVANCING 2 LINES.                                 17450020
174600                                                                  17460020
174700     MOVE PV-DATE-START-MM   TO HL2-FROM-DATE-MM.                 17470020
174800     MOVE PV-DATE-START-DD   TO HL2-FROM-DATE-DD.                 17480020
174900     MOVE PV-DATE-START-CCYY TO HL2-FROM-DATE-YYYY.               17490020
175000     MOVE PV-DATE-END-MM     TO HL2-TO-DATE-MM.                   17500020
175100     MOVE PV-DATE-END-DD     TO HL2-TO-DATE-DD.                   17510020
175200     MOVE PV-DATE-END-CCYY   TO HL2-TO-DATE-YYYY.                 17520020
175300     WRITE OUTPUT-REC                                             17530020
175400       FROM HEADING-LINE-2                                        17540020
175500         AFTER ADVANCING 1 LINES.                                 17550020
175600                                                                  17560020
175700     WRITE OUTPUT-REC                                             17570020
175800       FROM HEADING-LINE-3-CS                                     17580020
175900         AFTER ADVANCING 2 LINES.                                 17590020
176000                                                                  17600020
176100*PRINT MISDIRECT TYPE DESCRIPTIONS.                               17610020
176200     MOVE '1' TO HL4-MISDIRECT-TYPE.                              17620020
176300     MOVE PC-MISDIRECT-DESC-1 TO HL4-MISDIRECT-DESC.              17630020
176400     WRITE OUTPUT-REC                                             17640020
176500       FROM HEADING-LINE-4                                        17650020
176600         AFTER ADVANCING 3 LINES.                                 17660020
176700                                                                  17670020
176800     MOVE '2' TO HL4-MISDIRECT-TYPE.                              17680020
176900     MOVE PC-MISDIRECT-DESC-2 TO HL4-MISDIRECT-DESC.              17690020
177000     WRITE OUTPUT-REC                                             17700020
177100       FROM HEADING-LINE-4                                        17710020
177200         AFTER ADVANCING 2 LINES.                                 17720020
177300                                                                  17730020
177400     MOVE '3' TO HL4-MISDIRECT-TYPE.                              17740020
177500     MOVE PC-MISDIRECT-DESC-3 TO HL4-MISDIRECT-DESC.              17750020
177600     WRITE OUTPUT-REC                                             17760020
177700       FROM HEADING-LINE-4                                        17770020
177800         AFTER ADVANCING 2 LINES.                                 17780020
177900                                                                  17790020
178000     MOVE '4' TO HL4-MISDIRECT-TYPE.                              17800020
178100     MOVE PC-MISDIRECT-DESC-4 TO HL4-MISDIRECT-DESC.              17810020
178200     WRITE OUTPUT-REC                                             17820020
178300       FROM HEADING-LINE-4                                        17830020
178400         AFTER ADVANCING 2 LINES.                                 17840020
178500                                                                  17850020
178600***  MOVE '5' TO HL4-MISDIRECT-TYPE.                              17860020
178700***  MOVE PC-MISDIRECT-DESC-5 TO HL4-MISDIRECT-DESC.              17870020
178800***  WRITE OUTPUT-REC                                             17880020
178900***    FROM HEADING-LINE-4                                        17890020
179000***      AFTER ADVANCING 2 LINES.                                 17900020
179100                                                                  17910020
179200*PRINT VENDOR NAME/TYPE HEADINGS.                                 17920020
179300     WRITE OUTPUT-REC                                             17930020
179400       FROM HEADING-LINE-4-CS                                     17940020
179500         AFTER ADVANCING 3 LINES.                                 17950020
179600                                                                  17960020
179700     WRITE OUTPUT-REC                                             17970020
179800       FROM HEADING-LINE-5-CS                                     17980020
179900         AFTER ADVANCING 1 LINES.                                 17990020
180000                                                                  18000020
180100     WRITE OUTPUT-REC                                             18010020
180200       FROM BLANK-LINE                                            18020020
180300         AFTER ADVANCING 1 LINES.                                 18030020
180400                                                                  18040020
180500*SET PRINT LINE NUMBER.                                           18050020
180600     MOVE 19 TO PV-LINE-COUNT.                                    18060020
180700                                                                  18070020
180800******************************************************************18080001
180900******************************************************************18090001
181000 9100-CALL-DATE-MODULE.                                           18100001
181100     MOVE '9100-CALL-DATE-MODULE   ' TO PV-ABEND-PARAGRAPH.       18110001
181200                                                                  18120001
181300     CALL DP500-KOHLS-CALENDAR-ROUTINE                            18130001
181400                           USING DPG51 DPG52 DPG53                18140001
181500                                 DPG54 DPG55 DPG56.               18150001
181600     EVALUATE TRUE                                                18160001
181700       WHEN DPG54-SEVERE-ERROR                                    18170001
181800           DISPLAY '** ABEND **'                                  18180001
181900           DISPLAY '** PGM = SUKRP021'                            18190006
182000           DISPLAY PV-ABEND-PARAGRAPH                             18200001
182100           DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '    18210001
182200           DISPLAY '** ERROR MESSAGE = '                          18220001
182300                   DPG54-ERROR-MESSAGE                            18230001
182400           DISPLAY '** DPG51 = ' DPG51                            18240001
182500           DISPLAY '** DPG52 = ' DPG52                            18250001
182600           DISPLAY '** DPG53 = ' DPG53                            18260001
182700           DISPLAY '** DPG54 = ' DPG54                            18270001
182800           MOVE +4003 TO PV-ABEND-CODE                            18280001
182900           CALL 'ILBOABN0' USING PV-ABEND-CODE                    18290001
183000       WHEN OTHER                                                 18300001
183100           CONTINUE                                               18310001
183200     END-EVALUATE.                                                18320001
183300                                                                  18330001
183400******************************************************************18340001
183500*  ABEND ROUTINE                                                 *18350001
183600******************************************************************18360001
183700 9900-DB2-ABEND.                                                  18370001
183800                                                                  18380001
183900     MOVE SQLCODE TO PV-SQLCODE.                                  18390001
184000     DISPLAY '*** DB2 ERROR '.                                    18400001
184100     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       18410001
184200     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 18420001
184300     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               18430001
184400     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               18440001
184500     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       18450001
184600     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       18460001
184700     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             18470001
184800                                                                  18480001
184900     COPY DPPD004.                                                18490001
185000                                                                  18500001
185100     MOVE +4013 TO PV-ABEND-CODE.                                 18510001
185200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18520001
185300                                                                  18530001
185400******************************************************************18540001
185500******************************************************************18550001
