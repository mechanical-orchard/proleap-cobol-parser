000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.      VNKUT026.                                       00020000
000300 AUTHOR.          NANCY EILBES.                                   00030000
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040000
000500 DATE-WRITTEN.    FEBRUARY 2009.                                  00050000
000600*----------------------------------------------------------------*00060000
000700*  BATCH MESSAGES FOR RMS SUPPLIER/PARTNER                        00070000
000800*    COBOL II WITH MQ SERIES                                      00080000
000900*----------------------------------------------------------------*00090000
001000* THIS PROGRAM READS AN EXTRACT FILE IN THE FORMAT OF VNWS007,    00100000
001100* THE SAME COPYBOOK USED FOR LINKAGE IN THE CICS MQSERIES ROUTINE.00110000
001110* FOR EACH RECORD READ, THE APPROPRIATE MESSAGE WILL BE FORMATTED 00111000
001120* AND PUT TO THE MESSAGE QUEUE.                                   00112000
001130*                                                                 00113000
001140* BASED ON VNKCS024 PROGRAM.  ANY UPDATES TO THAT PROGRAM THAT    00114000
001150* AFFECT THE FORMAT OF THE MESSAGES NEED TO BE MADE IN THIS       00115000
001151* PROGRAM AS WELL.                                                00115100
001152*----------------------------------------------------------------*00115200
001153* CHANGES MADE:                                                   00115300
001154*                                                                 00115400
001155* DATE  03/25/2009                                                00115500
001156*     CHANGE MADE: INITIAL VERSION.                               00115600
001157*     MADE BY: NANCY EILBES            WR/IR #: WR32219           00115700
001158*                                                                 00115800
001159* DATE  07/09/2014                                                00115900
001160*     CHANGE MADE: CHANGE QMGR FOR RMS13.                         00116000
001170*     MADE BY: JOHN SELWITSCHKA        WR/IR #: CHG0081355        00117000
001171* DATE  08/09/2018                                                00117100
001172*     CHANGE MADE: CHANGE PROGRAM TO READ IN 3 NEW CONTROL CARD   00117200
001173*     TO CONNECT TO QUEUE MANAGER,RATHER THAN HARCODING VALUES    00117300
001174*     IN THE PROGRAM.                                             00117400
001175*     MADE BY: GERMAN BANDA            WR/IR #: CHG0209972        00117500
001176* DATE  05/05/2020                                                00117601
001177*     CHANGE MADE: REINSTATED PROGRAM TO PROUDCTION AFTER IT WAS  00117701
001178*     RETIRED.                                                    00117801
001180*     MADE BY: NANCY EILBES            WR/IR #: CHG0243604        00118001
001181******************************************************************00118101
001182                                                                  00118201
001183 ENVIRONMENT DIVISION.                                            00118301
001184                                                                  00118401
001185 CONFIGURATION SECTION.                                           00118501
001190                                                                  00119000
001200 SOURCE-COMPUTER.        IBM-3090.                                00120000
001300 OBJECT-COMPUTER.        IMB-3090.                                00130000
001400                                                                  00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600 FILE-CONTROL.                                                    00160000
001700     SELECT RMS-VENDOR-FILE ASSIGN TO INP01.                      00170000
001800     SELECT CONTROL-CARD-1  ASSIGN TO INP02.                      00180000
001900     SELECT CONTROL-CARD-2  ASSIGN TO INP03.                      00190000
002000     SELECT CONTROL-CARD-3  ASSIGN TO INP04.                      00200000
002100                                                                  00210000
002200 DATA DIVISION.                                                   00220000
002300                                                                  00230000
002400 FILE SECTION.                                                    00240000
002500                                                                  00250000
002510 FD  CONTROL-CARD-1                                               00251000
002520     LABEL RECORDS ARE STANDARD                                   00252000
002530     RECORDING MODE IS F                                          00253000
002540     BLOCK CONTAINS 0 RECORDS.                                    00254000
002550 01  CONTROL-CARD1-RECORD            PIC X(80).                   00255000
002560                                                                  00256000
002570 FD  CONTROL-CARD-2                                               00257000
002580     LABEL RECORDS ARE STANDARD                                   00258000
002590     RECORDING MODE IS F                                          00259000
002591     BLOCK CONTAINS 0 RECORDS.                                    00259100
002592 01  CONTROL-CARD2-RECORD            PIC X(80).                   00259200
002593                                                                  00259300
002594 FD  CONTROL-CARD-3                                               00259400
002595     LABEL RECORDS ARE STANDARD                                   00259500
002596     RECORDING MODE IS F                                          00259600
002597     BLOCK CONTAINS 0 RECORDS.                                    00259700
002598 01  CONTROL-CARD3-RECORD            PIC X(80).                   00259800
002599                                                                  00259900
002600 FD  RMS-VENDOR-FILE                                              00260000
002700     RECORDING MODE F                                             00270000
002800     LABEL RECORDS ARE STANDARD                                   00280000
002900     DATA RECORD IS RMS-VENDOR-RECORD.                            00290000
003000 01  RMS-VENDOR-RECORD          PIC X(2262).                      00300000
003100                                                                  00310000
003200                                                                  00320000
003300 WORKING-STORAGE SECTION.                                         00330000
003400                                                                  00340000
003500*                                                                 00350000
003600*  OUTPUT SEGMENT COPYBOOK                                        00360000
003700*                                                                 00370000
003800     COPY VNRD003.                                                00380000
003900                                                                  00390000
004000                                                                  00400000
004100*    API CONTROL BLOCKS                                           00410000
004200                                                                  00420000
004300 01  MQM-OBJECT-DESCRIPTOR.                                       00430000
004400     COPY CMQODV.                                                 00440000
004500 01  MQM-MESSAGE-DESCRIPTOR.                                      00450000
004600     COPY CMQMDV.                                                 00460000
004700 01  MQM-GET-MESSAGE-OPTIONS.                                     00470000
004800     COPY CMQGMOV.                                                00480000
004900 01  MQM-PUT-MESSAGE-OPTIONS.                                     00490000
005000     COPY CMQPMOV.                                                00500000
005100                                                                  00510000
005200*    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   00520000
005300*    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          00530000
005400                                                                  00540000
005500 01  MQM-CONSTANTS.                                               00550000
005600     COPY CMQV.                                                   00560000
005700*                                                                 00570000
005800 01  MQ-WORKING-STORAGE.                                          00580000
005900     05  WS-MQCONN               PIC X(8)  VALUE 'CSQBCONN'.      00590000
006000     05  WS-MQOPEN               PIC X(8)  VALUE 'CSQBOPEN'.      00600000
006100     05  WS-MQGET                PIC X(8)  VALUE 'CSQBGET'.       00610000
006200     05  WS-MQPUT                PIC X(8)  VALUE 'CSQBPUT'.       00620000
006300     05  WS-MQCMIT               PIC X(8)  VALUE 'CSQBCOMM'.      00630000
006400     05  WS-MQBACK               PIC X(8)  VALUE 'CSQBBACK'.      00640000
006500     05  WS-MQCLOSE              PIC X(8)  VALUE 'CSQBCLOS'.      00650000
006600     05  WS-MQDISC               PIC X(8)  VALUE 'CSQBDISC'.      00660000
006700     05  WS-MQCHECK              PIC X(8)  VALUE 'MQR2C'.         00670000
006800                                                                  00680000
006900 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         00690000
007000                                              COMP SYNC.          00700000
007100     88  AC-MQ-ERROR                          VALUE +4020.        00710000
007200     88  AC-CONTROL-CARD-ERROR                VALUE +4003.        00720000
007300                                                                  00730000
007301 01  ABEND-AREAS.                                                 00730100
007302     05  AA-ABEND-LIT            PIC  X(40)  VALUE                00730200
007303             '*****       ABEND'.                                 00730300
007304     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                00730400
007305             '*****   PROGRAM: VNKUT026'.                         00730500
007306     05  AA-PARAGRAPH-LIT.                                        00730600
007307         10  FILLER              PIC  X(17)  VALUE                00730700
007308             '***** PARAGRAPH: '.                                 00730800
007309         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        00730900
007310     05  AA-MESSAGE-LINE.                                         00731000
007311         10  FILLER              PIC  X(06)  VALUE '*****'.       00731100
007312         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        00731200
007313         10  FILLER REDEFINES AA-MESSAGE.                         00731300
007314             15 AA-MESSAGE-1     PIC  X(45).                      00731400
007315             15 AA-MESSAGE-2     PIC  X(45).                      00731500
007316             15 AA-MESSAGE-3     PIC  X(37).                      00731600
007317     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                00731700
007318             '*****    DB2 ERROR'.                                00731800
007319     05  AA-DB2-OPERATION-LIT.                                    00731900
007320         10  FILLER              PIC  X(17)  VALUE                00732000
007321             '***** OPERATION: '.                                 00732100
007322         10  AA-DB2-OPERATION.                                    00732200
007323             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        00732300
007324             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        00732400
007325     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        00732500
007326     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        00732600
007327     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        00732700
007328                                                                  00732800
007329 01  CC-CONTROL-CARD-1.                                           00732900
007330     05  CC-QNAME                  PIC X(48).                     00733000
007331     05  FILLER                    PIC X(32).                     00733100
007332 01  CC-CONTROL-CARD-2.                                           00733200
007333     05  CC-QMGR-NAME              PIC X(48).                     00733300
007334     05  FILLER                    PIC X(32).                     00733400
007335                                                                  00733500
007336 01  CC-CONTROL-CARD-3.                                           00733600
007337     05  CC-QMGR-NAME-LCL          PIC X(48).                     00733700
007338     05  FILLER                    PIC X(32).                     00733800
007339                                                                  00733900
007340 01  PS-PROGRAM-SWITCHES.                                         00734000
007350     05  END-OF-EXTRACT-SW         PIC X(01)  VALUE 'N'.          00735000
007360         88  END-OF-EXTRACT                   VALUE 'Y'.          00736000
007370     05  PS-NO-ADDRESSES-LEFT-SW   PIC X(01)  VALUE 'N'.          00737000
007380         88  PS-NO-ADDRESSES-LEFT             VALUE 'Y'.          00738000
007390     05  PS-NO-DEPARTMENTS-LEFT-SW PIC X(01)  VALUE 'N'.          00739000
007400         88  PS-NO-DEPARTMENTS-LEFT           VALUE 'Y'.          00740000
007500     05  PS-MQPUT-SUCCESSFUL-SW    PIC X(01)  VALUE SPACES.       00750000
007600         88  PS-MQPUT-SUCCESSFUL              VALUE 'Y'.          00760000
007700     05  PS-NEW-VENDOR-SW          PIC X(01)  VALUE 'N'.          00770000
007800         88  PS-NOT-NEW-VENDOR                VALUE 'N'.          00780000
007900         88  PS-NEW-VENDOR                    VALUE 'Y'.          00790000
008000     05  PS-EOF-CONTROL-CARD1-SW     PIC X  VALUE 'N'.            00800000
008100         88  PS-EOF-CONTROL-CARD1           VALUE 'Y'.            00810000
008200         88  PS-NOT-EOF-CONTROL-CARD1       VALUE 'N'.            00820000
008300     05  PS-EOF-CONTROL-CARD2-SW     PIC X  VALUE 'N'.            00830000
008400         88  PS-EOF-CONTROL-CARD2           VALUE 'Y'.            00840000
008500         88  PS-NOT-EOF-CONTROL-CARD2       VALUE 'N'.            00850000
008510     05  PS-EOF-CONTROL-CARD3-SW     PIC X  VALUE 'N'.            00851000
008520         88  PS-EOF-CONTROL-CARD3           VALUE 'Y'.            00852000
008530         88  PS-NOT-EOF-CONTROL-CARD3       VALUE 'N'.            00853000
008540                                                                  00854000
008550 01  PC-PROGRAM-CONSTANTS.                                        00855000
008560     05  PC-PGM-NAME             PIC X(8)     VALUE 'VNKUT026'.   00856000
008570     05  PC-MAX-RETRIES          PIC S9(04)   VALUE 10 COMP.      00857000
008580     05  PC-NEW-VENDOR           PIC X(10) VALUE 'NEW VENDOR'.    00858000
008590     05  PC-VENDOR               PIC X(10) VALUE 'VENDOR'.        00859000
008600     05  PC-ADDRESS              PIC X(10) VALUE 'ADDRESS'.       00860000
008700     05  PC-DEPT                 PIC X(10) VALUE 'DEPT'.          00870000
008800     05  PC-EDI                  PIC X(10) VALUE 'EDI'.           00880000
008900     05  PC-NEW-VENDOR-LENGTH    PIC S9(9) BINARY VALUE +458.     00890000
009000     05  PC-VENDOR-LENGTH        PIC S9(9) BINARY VALUE +106.     00900000
009100     05  PC-ADDRESS-LENGTH       PIC S9(9) BINARY VALUE +291.     00910000
009200     05  PC-DEPT-LENGTH          PIC S9(9) BINARY VALUE +103.     00920000
009300     05  PC-EDI-LENGTH           PIC S9(9) BINARY VALUE +36.      00930000
009400     05  PC-CPBLTY-LENGTH        PIC S9(9) BINARY VALUE +32.      00940000
009500     05  PC-RLTNSHP-LENGTH       PIC S9(9) BINARY VALUE +40.      00950000
009600***  05  PC-QNAME                PIC X(48) VALUE                  00960000
009700***                            'RS.SUPPLIER.PARTNER.LOAD.Q'.      00970000
009800***  05  PC-CONNECT-NAME         PIC X(48)   VALUE SPACES.        00980000
009900***      88  PC-PROD-CONNECT-NAME             VALUE 'QKSP    '.   00990000
010000***      88  PC-TEST-CONNECT-NAME             VALUE 'QKST    '.   01000000
010100***      88  PC-QA-CONNECT-NAME               VALUE 'QKSQ    '.   01010000
010200***  05  PC-QMGR-NAME            PIC X(48)   VALUE SPACES.        01020000
010300**********************************                     QKSP       01030000
010400*        88  PC-PROD-QMGR-NAME                VALUE 'ISWMQ04P'.   01040000
010500***      88  PC-PROD-QMGR-NAME                VALUE 'ISWMQ189P'.  01050000
010600**********************************                     QKST       01060000
010700*        88  PC-TEST-QMGR-NAME                VALUE 'ISWMQ04T'.   01070000
010800***      88  PC-TEST-QMGR-NAME                VALUE 'ISWMQ78T'.   01080000
010900**       88  PC-TEST-QMGR-NAME                VALUE 'QKST    '.   01090000
011000**********************************                     QKSQ       01100000
011010*        88  PC-QA-QMGR-NAME                  VALUE 'ISWMQ04Q'.   01101000
011020***      88  PC-QA-QMGR-NAME                  VALUE 'ISWMQ77Q'.   01102000
011030                                                                  01103000
011040                                                                  01104000
011050 01  PV-PROGRAM-VARIABLES.                                        01105000
011060     05  PV-MQGET-COUNTER            PIC S9(9) BINARY VALUE 0.    01106000
011070     05  PV-MQPUT-COUNTER            PIC S9(9) BINARY VALUE 0.    01107000
011080     05  PV-MQPUT-RETRY-COUNTER      PIC S9(4)  VALUE ZERO COMP.  01108000
011090     05  PV-MQGET-RETRY-COUNTER      PIC S9(4)  VALUE ZERO COMP.  01109000
011100     05  PV-PARAGRAPH                PIC X(48) VALUE SPACES.      01110000
011200     05  PV-ERROR.                                                01120000
011300         10  PV-ERROR-LITERAL        PIC X(14) VALUE SPACES.      01130000
011400         10  PV-ERROR-VARIABLE       PIC X(34) VALUE SPACES.      01140000
011500     05  PV-ERROR-MESSAGE            PIC X(48) VALUE SPACES.      01150000
011600     05  PV-ERROR-MESSAGE2           PIC X(48) VALUE SPACES.      01160000
011700*    05  PV-MSGBUFFER                PIC X(422) VALUE SPACES.     01170000
011800     05  PV-OUT-MSGLENGTH            PIC S9(9) BINARY VALUE ZERO. 01180000
011900     05  PV-DATA-LENGTH              PIC S9(9) BINARY.            01190000
012000     05  PV-MSG-LENGTH               PIC S9(9) BINARY.            01200000
012100     05  PV-NBR-OF-MSGS-CREATED      PIC  9(9)     VALUE 0.       01210000
012200     05  INPUT-COUNT                 PIC  9(9)     VALUE 0.       01220000
012300     05  PV-HCONN                    PIC S9(9) BINARY VALUE 0.    01230000
012400     05  PV-GQ-HANDLE                PIC S9(9) BINARY VALUE 0.    01240000
012500     05  PV-PQ-HANDLE                PIC S9(9) BINARY VALUE 0.    01250000
012600     05  PV-OPEN-OPTIONS             PIC S9(9) BINARY.            01260000
012700     05  PV-COMPLETION-CODE          PIC S9(9) BINARY.            01270000
012800     05  PV-REASON                   PIC S9(9) BINARY.            01280000
012900     05  PV-REASON-NONBIN            PIC S9(9).                   01290000
013000     05  PV-MQ-REASON-TEXT           PIC X(30) VALUE SPACES.      01300000
013100     05  PV-SAVE-COMPLETION-CODE     PIC S9(9) BINARY.            01310000
013200     05  PV-SAVE-REASON              PIC S9(9) BINARY.            01320000
013300     05  PV-SAVE-PARAGRAPH           PIC X(48) VALUE SPACES.      01330000
013400     05  PV-CON-REASON               PIC S9(9) BINARY.            01340000
013500     05  PV-SAVE-CORRELID            PIC X(24) VALUE SPACES.      01350000
013600     05  PV-SEGMENT-TYPE         PIC X(10) VALUE SPACES.          01360000
013700         88  PV-NEW-VENDOR-SEGMENT         VALUE 'NEW VENDOR'.    01370000
013800         88  PV-VENDOR-SEGMENT             VALUE 'VENDOR'.        01380000
013900         88  PV-ADDRESS-SEGMENT            VALUE 'ADDRESS'.       01390000
014000         88  PV-DEPARTMENT-SEGMENT         VALUE 'DEPARTMENT'.    01400000
014100         88  PV-EDI-SEGMENT                VALUE 'EDI'.           01410000
014200         88  PV-CPBLTY-SEGMENT             VALUE 'CPBLTY'.        01420000
014300         88  PV-RLTNSHP-SEGMENT            VALUE 'RLTNSHP'.       01430000
014400         88  PV-COMMIT-SEGMENT             VALUE 'COMMIT'.        01440000
014500         88  PV-VALID-SEGMENT              VALUE 'NEW VENDOR',    01450000
014600                                                 'VENDOR',        01460000
014700                                                 'ADDRESS',       01470000
014800                                                 'DEPARTMENT',    01480000
014900                                                 'EDI',           01490000
015000                                                 'CPBLTY',        01500000
015100                                                 'RLTNSHP'.       01510000
015200     05  PV-DISC-FIELD.                                           01520000
015300         10  FILLER                   PIC X(1)  VALUE '.'.        01530000
015400         10  PV-DISC-DECIMALS         PIC V9(4) VALUE ZEROES.     01540000
015500     05  PV-DEPT-FIELD.                                           01550000
015600         10  FILLER                   PIC X(1)  VALUE '0'.        01560000
015700         10  PV-DEPT-CHAR3            PIC X(3)  VALUE SPACES.     01570000
015800                                                                  01580000
015900*----------------------------------------------------------------*01590000
016000*  COPYBOOK FOR RMS VENDORS EXTRACT FILE.                        *01600000
016100*----------------------------------------------------------------*01610000
016200 01  VN007-COPYBOOK.                                              01620000
016300     COPY VNWS007.                                                01630000
016400                                                                  01640000
016500 PROCEDURE DIVISION.                                              01650000
016600                                                                  01660000
016700 A000-MAINLINE.                                                   01670000
016800                                                                  01680000
016900     PERFORM B100-INITIALIZE.                                     01690000
017000                                                                  01700000
017100     PERFORM B200-PROCESS-EXTRACT                                 01710000
017200       UNTIL END-OF-EXTRACT.                                      01720000
017300                                                                  01730000
017400     PERFORM B300-END-OF-JOB.                                     01740000
017500                                                                  01750000
017600     GOBACK.                                                      01760000
017700                                                                  01770000
017800 EJECT                                                            01780000
017900 B100-INITIALIZE.                                                 01790000
018000* ------------------------------------------------------------- * 01800000
018100*    CONNECT TO THE QUEUE MANAGER                                 01810000
018200*    OPEN THE UNIX SUPPLIER/PARTNER LOAD QUEUE FOR OUTPUT         01820000
018300* ------------------------------------------------------------- * 01830000
018400                                                                  01840000
018500     OPEN INPUT                                                   01850000
018600          CONTROL-CARD-1                                          01860000
018700          CONTROL-CARD-2                                          01870000
018800          CONTROL-CARD-3                                          01880000
018900          INPUT RMS-VENDOR-FILE.                                  01890000
019000                                                                  01900000
019100                                                                  01910000
019200     PERFORM R100-READ-CONTROL-CARD-1.                            01920000
019300     IF CC-QNAME = SPACES                                         01930000
019400        MOVE 'B100-INITIALIZE  '      TO AA-PARAGRAPH-LIT         01940000
019500        MOVE 'NO DATA ON INP01 CONTROL CARD'  TO AA-MESSAGE       01950000
019600        PERFORM Z999-ABEND                                        01960000
019700     ELSE                                                         01970000
019800        PERFORM R200-READ-CONTROL-CARD-2                          01980000
019810        IF CC-QMGR-NAME = SPACES                                  01981000
019820           MOVE 'B100-INITIALIZE  '   TO AA-PARAGRAPH-LIT         01982000
019830           MOVE 'NO DATA ON INP02 CONTROL CARD' TO AA-MESSAGE     01983000
019831           PERFORM Z999-ABEND                                     01983100
019832        ELSE                                                      01983200
019833        PERFORM R300-READ-CONTROL-CARD-3                          01983300
019834        IF CC-QMGR-NAME-LCL = SPACES                              01983400
019835           MOVE 'B100-INITIALIZE  '   TO AA-PARAGRAPH-LIT         01983500
019836           MOVE 'NO DATA ON INP03 CONTROL CARD' TO AA-MESSAGE     01983600
019837           PERFORM Z999-ABEND                                     01983700
019838        END-IF                                                    01983800
019839     END-IF.                                                      01983900
019840                                                                  01984000
019841     DISPLAY 'VNKUT026       '                                    01984100
019842     DISPLAY 'CC-QNAME         '  CC-QNAME                        01984200
019843     DISPLAY 'CC-QMGR-NAME     '  CC-QMGR-NAME                    01984300
019844     DISPLAY 'CC-QMGR-NAME-LCL '  CC-QMGR-NAME-LCL                01984400
019845                                                                  01984500
019846     PERFORM Y100-CONNECT-TO-QMGR.                                01984600
019847     PERFORM Y200-OPEN-MQ-QUEUE.                                  01984700
019848                                                                  01984800
019849     PERFORM R500-READ-EXTRACT-FILE.                              01984900
019850                                                                  01985000
019860 EJECT                                                            01986000
019870******************************************************************01987000
019880*  PROCESS THE MESSAGE THAT WAS READ FROM THE QUEUE.             *01988000
019890******************************************************************01989000
019900 B200-PROCESS-EXTRACT.                                            01990000
020000                                                                  02000000
020100     IF  (VN007-PRIM-TYP-CDE = 'M')                               02010000
020200     AND (VN007-FUNCTION-ID (1) NOT = ZERO)                       02020000
020300     AND (VN007-DEPT-NBR (1) NOT = SPACES)                        02030000
020400         SET PS-NEW-VENDOR  TO TRUE                               02040000
020500         PERFORM C100-PROCESS-NEW-VENDOR                          02050000
020600         SET VN007-ADDR-IND TO 2                                  02060000
020700         PERFORM C300-PROCESS-ADDRESS                             02070000
020800           UNTIL VN007-ADDR-IND > 4                               02080000
020900         SET VN007-DEPT-IND TO 2                                  02090000
021000         PERFORM C400-PROCESS-DEPARTMENT                          02100000
021100           UNTIL VN007-DEPT-IND > 10                              02110000
021200     ELSE                                                         02120000
021300         SET PS-NOT-NEW-VENDOR TO TRUE                            02130000
021400     END-IF.                                                      02140000
021500                                                                  02150000
021600     IF (PS-NOT-NEW-VENDOR)                                       02160000
021700     AND (VN007-LONGNAME-DELETE-IND = SPACE)                      02170000
021800     AND (  (VN007-PRIM-TYP-CDE     NOT = SPACE)                  02180000
021900         OR (VN007-PRTNR-TYP-CDE    NOT = SPACE)                  02190000
022000         OR (VN007-STATUS-CDE       NOT = SPACE)                  02200000
022100         OR (VN007-ENT-NAME-DESC    NOT = SPACE)                  02210000
022200         OR (VN007-SCAC-CDE         NOT = SPACE)                  02220000
022300         OR (VN007-PO-PREPK-CDE     NOT = SPACE)                  02230000
022400         OR (VN007-LINE-OF-CR-AMT   NOT = ZERO)                   02240000
022500         OR (VN007-PRTNR-DELETE-IND NOT = SPACE))                 02250000
022600        PERFORM C200-PROCESS-VENDOR-PARTNER                       02260000
022700     END-IF.                                                      02270000
022800                                                                  02280000
022900     IF PS-NOT-NEW-VENDOR                                         02290000
023000        SET VN007-ADDR-IND TO 1                                   02300000
023100        PERFORM C300-PROCESS-ADDRESS                              02310000
023200                     UNTIL VN007-ADDR-IND > 4                     02320000
023300        SET VN007-DEPT-IND TO 1                                   02330000
023400        PERFORM C400-PROCESS-DEPARTMENT                           02340000
023500                     UNTIL VN007-DEPT-IND > 10                    02350000
023600        SET VN007-CPBL-IND TO 1                                   02360000
023700        PERFORM C600-PROCESS-CAPABILITY                           02370000
023800                     UNTIL VN007-CPBL-IND > 20                    02380000
023900        SET VN007-RLTN-IND TO 1                                   02390000
024000        PERFORM C700-PROCESS-RELATIONSHIP                         02400000
024100                     UNTIL VN007-RLTN-IND > 20                    02410000
024200     END-IF.                                                      02420000
024300                                                                  02430000
024400     IF  (PS-NOT-NEW-VENDOR)                                      02440000
024500     AND (VN007-LONGNAME NOT = SPACES)                            02450000
024600     AND (VN007-LONGNAME-DELETE-IND NOT = SPACES)                 02460000
024700         PERFORM C800-PROCESS-LONGNAME                            02470000
024800     END-IF.                                                      02480000
024900                                                                  02490000
025000     IF (VN007-EDI-PO-IND NOT = SPACES) OR                        02500000
025100        (VN007-EDI-POCHG-IND NOT = SPACES) OR                     02510000
025200        (VN007-EDI-ASN-IND NOT = SPACES)                          02520000
025300        PERFORM C500-PROCESS-EDI                                  02530000
025400     END-IF.                                                      02540000
025500                                                                  02550000
025600     PERFORM R500-READ-EXTRACT-FILE.                              02560000
025700 EJECT                                                            02570000
025800*----------------------------------------------------------------*02580000
025900*  PERFORM END OF PROGRAM PROCESSING.                            *02590000
026000*----------------------------------------------------------------*02600000
026100 B300-END-OF-JOB.                                                 02610000
026200                                                                  02620000
026300     PERFORM Y300-CLOSE-MQ-QUEUE.                                 02630000
026400     PERFORM Y400-DISCONNECT-QMGR.                                02640000
026500                                                                  02650000
026600     CLOSE CONTROL-CARD-1                                         02660000
026700           CONTROL-CARD-2                                         02670000
026800           CONTROL-CARD-3                                         02680000
026810           RMS-VENDOR-FILE.                                       02681000
026820                                                                  02682000
026830                                                                  02683000
026840     DISPLAY '***** VNKUT026 PROCESSING TOTALS *****'.            02684000
026850     DISPLAY 'EXTRACT RECORDS READ = ' INPUT-COUNT.               02685000
026860     DISPLAY 'MESSAGES PUT TO QUEUE = ' PV-NBR-OF-MSGS-CREATED.   02686000
026870     DISPLAY '**************************************'.            02687000
026880 EJECT                                                            02688000
026890******************************************************************02689000
026900*  MOVE NEW VENDOR DATA FROM INPUT TO OUTPUT FIELDS.             *02690000
027000******************************************************************02700000
027100 C100-PROCESS-NEW-VENDOR.                                         02710000
027200     MOVE 'C100-PROCESS-NEW-VENDOR - PUT ERROR' TO PV-PARAGRAPH.  02720000
027300     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       02730000
027400                VN003-NEW-VENDOR-MESSAGE                          02740000
027500                VN003-MSGBUFFER.                                  02750000
027600                                                                  02760000
027700     SET VN003-NEW-VND-SEGMENT        TO TRUE.                    02770000
027800     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        02780000
027900     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            02790000
028000     MOVE VN007-PRIM-TYP-CDE          TO VN003-VENDOR-TYPE.       02800000
028100     MOVE VN007-PRTNR-TYP-CDE         TO VN003-PARTNER-TYPE.      02810000
028200     MOVE VN007-STATUS-CDE            TO VN003-VENDOR-STATUS.     02820000
028300     MOVE VN007-ENT-NAME-DESC         TO VN003-VENDOR-NAME.       02830000
028400     MOVE VN007-SCAC-CDE              TO VN003-SCAC-CDE.          02840000
028500     MOVE VN007-LINE-OF-CR-AMT        TO VN003-LINE-OF-CREDIT.    02850000
028600     MOVE VN007-PO-PREPK-CDE          TO VN003-PO-PREPK-CDE.      02860000
028700                                                                  02870000
028800     MOVE VN007-FUNCTION-ID(1)        TO VN003-ADDR-TYP-CDE.      02880000
028900     MOVE VN007-ADDR-SEQ-NBR(1)       TO VN003-ADDR-SEQ-NBR.      02890000
029000     MOVE VN007-PRIM-ADDR-IND(1)      TO VN003-PRIMARY-ADDR-IND.  02900000
029100     MOVE VN007-CNTRY-CD(1)           TO VN003-COUNTRY.           02910000
029200     MOVE VN007-ADDR-LINE1(1)         TO VN003-ADDR-LINE1.        02920000
029300     MOVE VN007-ADDR-LINE2(1)         TO VN003-ADDR-LINE2.        02930000
029400     MOVE VN007-ADDR-LINE3(1)         TO VN003-ADDR-LINE3.        02940000
029500     MOVE VN007-CITY(1)               TO VN003-CITY.              02950000
029600     MOVE VN007-ST-PROV-CDE(1)        TO VN003-STATE-PROV.        02960000
029700     MOVE VN007-ZIP-CDE(1)            TO VN003-ZIP.               02970000
029800     MOVE VN007-EMAIL-ADD(1)          TO VN003-EMAIL.             02980000
029900     MOVE VN007-CONTACT-NAME(1)       TO VN003-CONTACT-NAME.      02990000
030000     MOVE VN007-TEL1-NBR(1)           TO VN003-TELEPHONE.         03000000
030100     MOVE VN007-FAX-NBR(1)            TO VN003-FAX.               03010000
030200                                                                  03020000
030300     MOVE VN007-DEPT-NBR(1)           TO PV-DEPT-CHAR3.           03030000
030400     MOVE PV-DEPT-FIELD               TO VN003-DEPT-NBR.          03040000
030500     MOVE VN007-VND-DEPT-STAT-CD(1)   TO VN003-DEPT-STATUS.       03050000
030600     MOVE VN007-BULK-STK-TKT-IND(1)   TO VN003-BULK-TICKETS.      03060000
030700     MOVE VN007-TKT-MKR-IND(1)        TO VN003-TICKET-MAKER.      03070000
030800     MOVE VN007-HANGER-IND(1)         TO VN003-HANGERS.           03080000
030900     MOVE VN007-PACK-BY-STR-IND(1)    TO VN003-PACK-BY-STORE.     03090000
031000     MOVE VN007-SPLIT-REQD-IND(1)     TO VN003-DC-SPLIT-REQD.     03100000
031100     MOVE VN007-SPLIT-LEADTIME-QTY(1) TO VN003-DC-SPLIT-LEADTIME. 03110000
031200     MOVE VN007-PRETKT-LEADTIME-QTY(1) TO                         03120000
031300                                      VN003-PRETICKET-LEADTIME.   03130000
031400     MOVE VN007-NSD-DISC-PCT(1)       TO PV-DISC-DECIMALS.        03140000
031500     MOVE PV-DISC-FIELD               TO VN003-NEW-STORE-DISC.    03150000
031600     MOVE VN007-NSD-EXT-DAYS-QTY(1)   TO VN003-NEW-STORE-DAYS.    03160000
031700     MOVE VN007-MOS-DISC-PCT(1)       TO PV-DISC-DECIMALS.        03170000
031800     MOVE PV-DISC-FIELD               TO VN003-MOS-DISC.          03180000
031900     MOVE VN007-TRD-DISC-PCT(1)       TO PV-DISC-DECIMALS.        03190000
032000     MOVE PV-DISC-FIELD               TO VN003-TRADE-DISC.        03200000
032100     MOVE VN007-ADV-DISC-PCT(1)       TO PV-DISC-DECIMALS.        03210000
032200     MOVE PV-DISC-FIELD               TO VN003-ADV-DISC.          03220000
032300     MOVE VN007-COOP-DISC-PCT(1)      TO PV-DISC-DECIMALS.        03230000
032400     MOVE PV-DISC-FIELD               TO VN003-COOP-DISC.         03240000
032500     MOVE VN007-PRFTASST-ADCOOP-PCT(1) TO PV-DISC-DECIMALS.       03250000
032600     MOVE PV-DISC-FIELD              TO VN003-PRFTASST-ADCOOP-ALW.03260000
032700     MOVE VN007-TBL-TWR-DAYS-QTY(1)   TO VN003-TBL-TWR-DAYS.      03270000
032800     MOVE VN007-BRDL-DISC-PCT(1)      TO PV-DISC-DECIMALS.        03280000
032900     MOVE PV-DISC-FIELD               TO VN003-BRDL-DISC.         03290000
033000     MOVE VN007-PAYT-TERM-ID(1)       TO VN003-PAYMENT-TERM-ID.   03300000
033100     MOVE VN007-FRGT-TERM-ID(1)       TO VN003-FREIGHT-TERM-ID.   03310000
033200                                                                  03320000
033300     MOVE VN007-CPBLTY-CDE(1)         TO VN003-CPBLTY-CDE.        03330000
033400     MOVE VN007-CPBLTY-INDICATOR(1)   TO VN003-CPBLTY-INDICATOR.  03340000
033500                                                                  03350000
033600     IF VN007-RLTNSHP-CDE(1) NOT = SPACES                         03360000
033700         MOVE VN007-RLTNSHP-ENT-ID(1) TO VN003-RLTNSHP-ENT-ID     03370000
033800         MOVE VN007-RLTNSHP-CDE(1)    TO VN003-RLTNSHP-CDE        03380000
033900         MOVE VN007-RLTNSHP-INDICATOR(1)                          03390000
034000                                      TO VN003-RLTNSHP-INDICATOR  03400000
034100     END-IF.                                                      03410000
034200                                                                  03420000
034300     MOVE VN003-MESSAGE-HEADER        TO VN003-NEW-VENDOR-HEADER. 03430000
034400     MOVE VN003-NEW-VENDOR-SEGMENT-DATA                           03440000
034500                                      TO VN003-NEW-VENDOR-DATA.   03450000
034600     MOVE VN003-NEW-VENDOR-MESSAGE    TO VN003-MSGBUFFER.         03460000
034700     MOVE VN003-NEW-VENDOR-MSG-LENGTH TO PV-OUT-MSGLENGTH.        03470000
034800                                                                  03480000
034900     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            03490000
035000                PV-MQPUT-RETRY-COUNTER.                           03500000
035100     PERFORM S100-PUT-MQ-MESSAGE                                  03510000
035200       UNTIL PS-MQPUT-SUCCESSFUL.                                 03520000
035300/                                                                 03530000
035400******************************************************************03540000
035500*  DETERMINE WHERE TO MOVE VENDOR DATA - VENDOR OR PARTNER FIELDS*03550000
035600*  THEN MOVE VENDOR DATA FROM INPUT TO OUTPUT FIELDS.            *03560000
035700******************************************************************03570000
035800 C200-PROCESS-VENDOR-PARTNER.                                     03580000
035900     MOVE 'C200-PROCESS-VENDOR-PARTNER - PUT ERROR'               03590000
036000                                           TO PV-PARAGRAPH.       03600000
036100     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       03610000
036200                VN003-VENDOR-MESSAGE                              03620000
036300                VN003-PARTNER-MESSAGE                             03630000
036400                VN003-MSGBUFFER.                                  03640000
036500                                                                  03650000
036600     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        03660000
036700     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            03670000
036800                                                                  03680000
036900     IF VN007-PRIM-TYP-CDE = 'E'                                  03690000
037000        SET VN003-PARTNER-SEGMENT    TO TRUE                      03700000
037100        MOVE VN007-STATUS-CDE        TO VN003-P-VENDOR-STATUS     03710000
037200        MOVE VN007-PRIM-TYP-CDE      TO VN003-P-VENDOR-TYPE       03720000
037300        MOVE VN007-PRTNR-TYP-CDE     TO VN003-P-PARTNER-TYPE      03730000
037400        MOVE VN007-SCAC-CDE          TO VN003-P-SCAC-CDE          03740000
037500        MOVE VN007-ENT-NAME-DESC     TO VN003-P-VENDOR-NAME       03750000
037600        MOVE VN007-LINE-OF-CR-AMT    TO VN003-P-LINE-OF-CREDIT    03760000
037700        MOVE VN007-PO-PREPK-CDE      TO VN003-P-PO-PREPK-CDE      03770000
037800        MOVE VN007-PRTNR-DELETE-IND  TO VN003-P-PARTNER-DELETE-IND03780000
037900        MOVE VN007-LONGNAME          TO VN003-P-LONGNAME          03790000
038000        MOVE SPACE                   TO VN003-P-FILLER            03800000
038100        MOVE VN003-MESSAGE-HEADER    TO VN003-PARTNER-HEADER      03810000
038200        MOVE VN003-PARTNER-SEGMENT-DATA                           03820000
038300                                     TO VN003-PARTNER-DATA        03830000
038400        MOVE VN003-PARTNER-MESSAGE   TO VN003-MSGBUFFER           03840000
038500        MOVE VN003-PARTNER-MSG-LENGTH                             03850000
038600                                     TO PV-OUT-MSGLENGTH          03860000
038700      ELSE                                                        03870000
038800        SET VN003-UPD-VND-SEGMENT    TO TRUE                      03880000
038900        MOVE VN007-STATUS-CDE        TO VN003-VENDOR-STATUS       03890000
039000        MOVE VN007-PRIM-TYP-CDE      TO VN003-VENDOR-TYPE         03900000
039100        MOVE VN007-PRTNR-TYP-CDE     TO VN003-PARTNER-TYPE        03910000
039200        MOVE VN007-SCAC-CDE          TO VN003-SCAC-CDE            03920000
039300        MOVE VN007-ENT-NAME-DESC     TO VN003-VENDOR-NAME         03930000
039400        MOVE VN007-LINE-OF-CR-AMT    TO VN003-LINE-OF-CREDIT      03940000
039500        MOVE VN007-PO-PREPK-CDE      TO VN003-PO-PREPK-CDE        03950000
039600        MOVE VN007-PRTNR-DELETE-IND  TO VN003-PARTNER-DELETE-IND  03960000
039700        MOVE VN003-MESSAGE-HEADER    TO VN003-VENDOR-HEADER       03970000
039800        MOVE VN003-VENDOR-SEGMENT-DATA                            03980000
039900                                     TO VN003-VENDOR-DATA         03990000
040000        MOVE VN003-VENDOR-MESSAGE    TO VN003-MSGBUFFER           04000000
040100        MOVE VN003-VENDOR-MSG-LENGTH TO PV-OUT-MSGLENGTH          04010000
040200     END-IF.                                                      04020000
040300                                                                  04030000
040400     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            04040000
040500                PV-MQPUT-RETRY-COUNTER.                           04050000
040600     PERFORM S100-PUT-MQ-MESSAGE                                  04060000
040700       UNTIL PS-MQPUT-SUCCESSFUL.                                 04070000
040800/                                                                 04080000
040900******************************************************************04090000
041000*  MOVE ADDRESS DATA FROM INPUT TO OUTPUT FIELDS.                *04100000
041100******************************************************************04110000
041200 C300-PROCESS-ADDRESS.                                            04120000
041300     IF VN007-FUNCTION-ID(VN007-ADDR-IND) NOT = ZERO              04130000
041400        PERFORM C350-MOVE-ADDRESS-FIELDS                          04140000
041500     END-IF.                                                      04150000
041600                                                                  04160000
041700     SET VN007-ADDR-IND UP BY 1.                                  04170000
041800                                                                  04180000
041900 C350-MOVE-ADDRESS-FIELDS.                                        04190000
042000     MOVE 'C350-MOVE-ADDRESS-FIELDS - PUT ERROR' TO PV-PARAGRAPH. 04200000
042100     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       04210000
042200                VN003-ADDRESS-MESSAGE                             04220000
042300                VN003-MSGBUFFER.                                  04230000
042400                                                                  04240000
042500     SET VN003-ADDRESS-SEGMENT        TO TRUE.                    04250000
042600     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        04260000
042700     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            04270000
042800                                                                  04280000
042900     MOVE VN007-FUNCTION-ID(VN007-ADDR-IND)                       04290000
043000                                      TO VN003-ADDR-TYP-CDE.      04300000
043100     MOVE VN007-ADDR-SEQ-NBR(VN007-ADDR-IND)                      04310000
043200                                      TO VN003-ADDR-SEQ-NBR.      04320000
043300     MOVE VN007-PRIM-ADDR-IND(VN007-ADDR-IND)                     04330000
043400                                      TO VN003-PRIMARY-ADDR-IND.  04340000
043500     MOVE VN007-CNTRY-CD(VN007-ADDR-IND)                          04350000
043600                                      TO VN003-COUNTRY.           04360000
043700     MOVE VN007-ADDR-LINE1(VN007-ADDR-IND)                        04370000
043800                                      TO VN003-ADDR-LINE1.        04380000
043900     MOVE VN007-ADDR-LINE2(VN007-ADDR-IND)                        04390000
044000                                      TO VN003-ADDR-LINE2.        04400000
044100     MOVE VN007-ADDR-LINE3(VN007-ADDR-IND)                        04410000
044200                                      TO VN003-ADDR-LINE3.        04420000
044300     MOVE VN007-CITY(VN007-ADDR-IND)                              04430000
044400                                      TO VN003-CITY.              04440000
044500     MOVE VN007-ST-PROV-CDE(VN007-ADDR-IND)                       04450000
044600                                      TO VN003-STATE-PROV.        04460000
044700     MOVE VN007-ZIP-CDE(VN007-ADDR-IND)                           04470000
044800                                      TO VN003-ZIP.               04480000
044900     MOVE VN007-EMAIL-ADD(VN007-ADDR-IND)                         04490000
045000                                      TO VN003-EMAIL.             04500000
045100     MOVE VN007-CONTACT-NAME(VN007-ADDR-IND)                      04510000
045200                                      TO VN003-CONTACT-NAME.      04520000
045300     MOVE VN007-TEL1-NBR(VN007-ADDR-IND)                          04530000
045400                                      TO VN003-TELEPHONE.         04540000
045500     MOVE VN007-FAX-NBR(VN007-ADDR-IND)                           04550000
045600                                      TO VN003-FAX.               04560000
045700                                                                  04570000
045800     IF VN007-ADDR-DELETE-IND(VN007-ADDR-IND) = ' '               04580000
045900        MOVE 'N'                      TO VN003-ADDRESS-DELETE-IND 04590000
046000     ELSE                                                         04600000
046100        MOVE VN007-ADDR-DELETE-IND(VN007-ADDR-IND)                04610000
046200                                      TO VN003-ADDRESS-DELETE-IND 04620000
046300     END-IF.                                                      04630000
046400                                                                  04640000
046500     MOVE VN003-MESSAGE-HEADER        TO VN003-ADDRESS-HEADER.    04650000
046600     MOVE VN003-ADDRESS-SEGMENT-DATA  TO VN003-ADDRESS-DATA.      04660000
046700     MOVE VN003-ADDRESS-MESSAGE       TO VN003-MSGBUFFER.         04670000
046800     MOVE VN003-ADDRESS-MSG-LENGTH    TO PV-OUT-MSGLENGTH.        04680000
046900                                                                  04690000
047000     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            04700000
047100                PV-MQPUT-RETRY-COUNTER.                           04710000
047200     PERFORM S100-PUT-MQ-MESSAGE                                  04720000
047300       UNTIL PS-MQPUT-SUCCESSFUL.                                 04730000
047400/                                                                 04740000
047500******************************************************************04750000
047600*  MOVE DEPARTMENT DATA FROM INPUT TO OUTPUT FIELDS.             *04760000
047700******************************************************************04770000
047800 C400-PROCESS-DEPARTMENT.                                         04780000
047900     IF VN007-DEPT-NBR(VN007-DEPT-IND) NOT = SPACES               04790000
048000        PERFORM C450-MOVE-DEPARTMENT-FIELDS                       04800000
048100     END-IF.                                                      04810000
048200                                                                  04820000
048300     SET VN007-DEPT-IND UP BY 1.                                  04830000
048400                                                                  04840000
048500 C450-MOVE-DEPARTMENT-FIELDS.                                     04850000
048600     MOVE 'C450-MOVE-DEPARTMENT-FIELDS - PUT ERROR'               04860000
048700                                      TO PV-PARAGRAPH.            04870000
048800     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       04880000
048900                VN003-DEPARTMENT-MESSAGE                          04890000
049000                VN003-MSGBUFFER.                                  04900000
049100                                                                  04910000
049200     SET VN003-DEPT-SEGMENT           TO TRUE.                    04920000
049300     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        04930000
049400     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            04940000
049500                                                                  04950000
049600     MOVE VN007-DEPT-NBR(VN007-DEPT-IND)                          04960000
049700                                      TO PV-DEPT-CHAR3.           04970000
049800     MOVE PV-DEPT-FIELD               TO VN003-DEPT-NBR.          04980000
049900     MOVE VN007-VND-DEPT-STAT-CD(VN007-DEPT-IND)                  04990000
050000                                      TO VN003-DEPT-STATUS.       05000000
050100     MOVE VN007-BULK-STK-TKT-IND(VN007-DEPT-IND)                  05010000
050200                                      TO VN003-BULK-TICKETS.      05020000
050300     MOVE VN007-TKT-MKR-IND(VN007-DEPT-IND)                       05030000
050400                                      TO VN003-TICKET-MAKER.      05040000
050500     MOVE VN007-HANGER-IND(VN007-DEPT-IND)                        05050000
050600                                      TO VN003-HANGERS.           05060000
050700     MOVE VN007-PACK-BY-STR-IND(VN007-DEPT-IND)                   05070000
050800                                      TO VN003-PACK-BY-STORE.     05080000
050900     MOVE VN007-SPLIT-REQD-IND(VN007-DEPT-IND)                    05090000
051000                                      TO VN003-DC-SPLIT-REQD.     05100000
051100     MOVE VN007-SPLIT-LEADTIME-QTY(VN007-DEPT-IND)                05110000
051200                                      TO VN003-DC-SPLIT-LEADTIME. 05120000
051300     MOVE VN007-PRETKT-LEADTIME-QTY(VN007-DEPT-IND)               05130000
051400                                   TO VN003-PRETICKET-LEADTIME.   05140000
051500     MOVE VN007-NSD-DISC-PCT(VN007-DEPT-IND)                      05150000
051600                                      TO PV-DISC-DECIMALS.        05160000
051700     MOVE PV-DISC-FIELD               TO VN003-NEW-STORE-DISC.    05170000
051800     MOVE VN007-NSD-EXT-DAYS-QTY(VN007-DEPT-IND)                  05180000
051900                                      TO VN003-NEW-STORE-DAYS.    05190000
052000     MOVE VN007-MOS-DISC-PCT(VN007-DEPT-IND)                      05200000
052100                                      TO PV-DISC-DECIMALS.        05210000
052200     MOVE PV-DISC-FIELD               TO VN003-MOS-DISC.          05220000
052300     MOVE VN007-TRD-DISC-PCT(VN007-DEPT-IND)                      05230000
052400                                      TO PV-DISC-DECIMALS.        05240000
052500     MOVE PV-DISC-FIELD               TO VN003-TRADE-DISC.        05250000
052600     MOVE VN007-ADV-DISC-PCT(VN007-DEPT-IND)                      05260000
052700                                      TO PV-DISC-DECIMALS.        05270000
052800     MOVE PV-DISC-FIELD               TO VN003-ADV-DISC.          05280000
052900     MOVE VN007-COOP-DISC-PCT(VN007-DEPT-IND)                     05290000
053000                                      TO PV-DISC-DECIMALS.        05300000
053100     MOVE PV-DISC-FIELD               TO VN003-COOP-DISC.         05310000
053200     MOVE VN007-PRFTASST-ADCOOP-PCT(VN007-DEPT-IND)               05320000
053300                                      TO PV-DISC-DECIMALS.        05330000
053400     MOVE PV-DISC-FIELD              TO VN003-PRFTASST-ADCOOP-ALW.05340000
053500     MOVE VN007-TBL-TWR-DAYS-QTY(VN007-DEPT-IND)                  05350000
053600                                      TO VN003-TBL-TWR-DAYS.      05360000
053700     MOVE VN007-BRDL-DISC-PCT(VN007-DEPT-IND)                     05370000
053800                                      TO PV-DISC-DECIMALS.        05380000
053900     MOVE PV-DISC-FIELD               TO VN003-BRDL-DISC.         05390000
054000     MOVE VN007-PAYT-TERM-ID(VN007-DEPT-IND)                      05400000
054100                                      TO VN003-PAYMENT-TERM-ID.   05410000
054200     MOVE VN007-FRGT-TERM-ID(VN007-DEPT-IND)                      05420000
054300                                      TO VN003-FREIGHT-TERM-ID.   05430000
054400                                                                  05440000
054500     MOVE VN003-MESSAGE-HEADER        TO VN003-DEPARTMENT-HEADER. 05450000
054600     MOVE VN003-DEPARTMENT-SEGMENT-DATA                           05460000
054700                                      TO VN003-DEPARTMENT-DATA.   05470000
054800     MOVE VN003-DEPARTMENT-MESSAGE    TO VN003-MSGBUFFER.         05480000
054900     MOVE VN003-DEPARTMENT-MSG-LENGTH TO PV-OUT-MSGLENGTH.        05490000
055000                                                                  05500000
055100     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            05510000
055200                PV-MQPUT-RETRY-COUNTER.                           05520000
055300     PERFORM S100-PUT-MQ-MESSAGE                                  05530000
055400       UNTIL PS-MQPUT-SUCCESSFUL.                                 05540000
055500/                                                                 05550000
055600******************************************************************05560000
055610*  MOVE EDI DATA FROM INPUT TO OUTPUT FIELDS.                    *05561000
055620******************************************************************05562000
055630 C500-PROCESS-EDI.                                                05563000
055640     MOVE 'C500-PROCESS-EDI - PUT ERROR' TO PV-PARAGRAPH.         05564000
055650     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       05565000
055660                VN003-EDI-MESSAGE                                 05566000
055670                VN003-MSGBUFFER.                                  05567000
055680                                                                  05568000
055690     SET VN003-EDI-SEGMENT            TO TRUE.                    05569000
055691     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        05569100
055692     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            05569200
055693                                                                  05569300
055694     MOVE VN007-EDI-PO-IND            TO VN003-EDI-PO-IND.        05569400
055695     MOVE VN007-EDI-ASN-IND           TO VN003-EDI-ASN-IND.       05569500
055696     MOVE VN007-EDI-POCHG-IND         TO VN003-EDI-POCHG-IND.     05569600
055697     MOVE VN007-EDI-PO-PROD-IND       TO VN003-EDI-PO-PROD-IND.   05569700
055698     MOVE VN007-EDI-PO-TEST-IND       TO VN003-EDI-PO-TEST-IND.   05569800
055699     MOVE VN007-EDI-POCHG-PROD-IND    TO VN003-EDI-POCHG-PROD-IND.05569900
055700     MOVE VN007-EDI-POCHG-TEST-IND    TO VN003-EDI-POCHG-TEST-IND.05570000
055701     MOVE VN007-EDI-VNDR-TYPE-IND     TO VN003-EDI-VNDR-TYPE-IND. 05570100
055702                                                                  05570200
055703     MOVE VN003-MESSAGE-HEADER        TO VN003-EDI-HEADER.        05570300
055704     MOVE VN003-EDI-MESSAGE           TO VN003-MSGBUFFER.         05570400
055705     MOVE VN003-EDI-MSG-LENGTH        TO PV-OUT-MSGLENGTH.        05570500
055706                                                                  05570600
055707     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            05570700
055708                PV-MQPUT-RETRY-COUNTER.                           05570800
055709     PERFORM S100-PUT-MQ-MESSAGE                                  05570900
055710       UNTIL PS-MQPUT-SUCCESSFUL.                                 05571000
055711/                                                                 05571100
055712******************************************************************05571200
055713*  MOVE CAPABILITY DATA FROM INPUT TO OUTPUT FIELDS.             *05571300
055714******************************************************************05571400
055715 C600-PROCESS-CAPABILITY.                                         05571500
055716     IF VN007-CPBLTY-CDE(VN007-CPBL-IND) NOT = SPACES             05571600
055717        PERFORM C650-MOVE-CPBLTY-FIELDS                           05571700
055718     END-IF.                                                      05571800
055719                                                                  05571900
055720     SET VN007-CPBL-IND UP BY 1.                                  05572000
055721                                                                  05572100
055722 C650-MOVE-CPBLTY-FIELDS.                                         05572200
055723     MOVE 'C650-MOVE-CPBLTY-FIELDS - PUT ERROR' TO PV-PARAGRAPH.  05572300
055724     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       05572400
055725                VN003-CPBLTY-MESSAGE                              05572500
055726                VN003-MSGBUFFER.                                  05572600
055727                                                                  05572700
055728     SET VN003-CPBLTY-SEGMENT         TO TRUE.                    05572800
055729     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        05572900
055730     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            05573000
055731                                                                  05573100
055732     MOVE VN007-CPBLTY-CDE(VN007-CPBL-IND)                        05573200
055733                                      TO VN003-CPBLTY-CDE.        05573300
055734     MOVE VN007-CPBLTY-INDICATOR(VN007-CPBL-IND)                  05573400
055735                                      TO VN003-CPBLTY-INDICATOR.  05573500
055736                                                                  05573600
055737     MOVE VN003-MESSAGE-HEADER        TO VN003-CPBLTY-HEADER.     05573700
055738     MOVE VN003-CAPABILITY-SEGMENT-DATA                           05573800
055739                                      TO VN003-CPBLTY-DATA.       05573900
055740     MOVE VN003-CPBLTY-MESSAGE        TO VN003-MSGBUFFER.         05574000
055741     MOVE VN003-CPBLTY-MSG-LENGTH     TO PV-OUT-MSGLENGTH.        05574100
055742                                                                  05574200
055743     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            05574300
055744                PV-MQPUT-RETRY-COUNTER.                           05574400
055745     PERFORM S100-PUT-MQ-MESSAGE                                  05574500
055746       UNTIL PS-MQPUT-SUCCESSFUL.                                 05574600
055747/                                                                 05574700
055748******************************************************************05574800
055749*  MOVE RELATIONSHIP DATA FROM INPUT TO OUTPUT FIELDS.           *05574900
055750******************************************************************05575000
055751 C700-PROCESS-RELATIONSHIP.                                       05575100
055752     IF VN007-RLTNSHP-CDE(VN007-RLTN-IND) NOT = SPACES            05575200
055753        PERFORM C750-MOVE-RLTNSHP-FIELDS                          05575300
055754     END-IF.                                                      05575400
055755                                                                  05575500
055756     SET VN007-RLTN-IND UP BY 1.                                  05575600
055757                                                                  05575700
055758 C750-MOVE-RLTNSHP-FIELDS.                                        05575800
055759     MOVE 'C750-MOVE-RLTNSHP-FIELDS - PUT ERROR' TO PV-PARAGRAPH. 05575900
055760     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       05576000
055761                VN003-RLTNSHP-MESSAGE                             05576100
055762                VN003-MSGBUFFER.                                  05576200
055763                                                                  05576300
055764     SET VN003-RLTNSHP-SEGMENT        TO TRUE.                    05576400
055765     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        05576500
055766     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            05576600
055767                                                                  05576700
055768     MOVE VN007-RLTNSHP-ENT-ID(VN007-RLTN-IND)                    05576800
055769                                      TO VN003-RLTNSHP-ENT-ID.    05576900
055770     MOVE VN007-RLTNSHP-CDE(VN007-RLTN-IND)                       05577000
055771                                      TO VN003-RLTNSHP-CDE.       05577100
055772     MOVE VN007-RLTNSHP-INDICATOR(VN007-RLTN-IND)                 05577200
055773                                      TO VN003-RLTNSHP-INDICATOR. 05577300
055774                                                                  05577400
055775     MOVE VN003-MESSAGE-HEADER        TO VN003-RLTNSHP-HEADER.    05577500
055776     MOVE VN003-RELATION-SEGMENT-DATA TO VN003-RLTNSHP-DATA.      05577600
055777     MOVE VN003-RLTNSHP-MESSAGE       TO VN003-MSGBUFFER.         05577700
055778     MOVE VN003-RLTNSHP-MSG-LENGTH    TO PV-OUT-MSGLENGTH.        05577800
055779                                                                  05577900
055780     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            05578000
055781                PV-MQPUT-RETRY-COUNTER.                           05578100
055782     PERFORM S100-PUT-MQ-MESSAGE                                  05578200
055783       UNTIL PS-MQPUT-SUCCESSFUL.                                 05578300
055784/                                                                 05578400
055785******************************************************************05578500
055786*  MOVE LONGNAME DATA FROM INPUT TO OUTPUT FIELDS.               *05578600
055787******************************************************************05578700
055788 C800-PROCESS-LONGNAME.                                           05578800
055789     MOVE 'C800-PROCESS-LONGNAME - PUT ERROR' TO PV-PARAGRAPH.    05578900
055790     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       05579000
055791                VN003-LONGNAME-MESSAGE                            05579100
055792                VN003-MSGBUFFER.                                  05579200
055793                                                                  05579300
055794     SET VN003-LONGNAME-SEGMENT     TO TRUE.                      05579400
055795     MOVE VN007-VND-NBR             TO VN003-VENDOR-NBR.          05579500
055796     MOVE VN007-ENT-ID              TO VN003-ENT-ID.              05579600
055797                                                                  05579700
055798     IF VN007-LONGNAME-DELETE-IND = 'Y'                           05579800
055799        MOVE SPACES                 TO VN003-P-LONGNAME           05579900
055800     ELSE                                                         05580000
055801        MOVE VN007-LONGNAME         TO VN003-P-LONGNAME           05580100
055802     END-IF.                                                      05580200
055803     MOVE SPACE                     TO VN003-LONGNAME-DELETE-IND. 05580300
055804                                                                  05580400
055805     MOVE VN003-MESSAGE-HEADER        TO VN003-LONGNAME-HEADER.   05580500
055806     MOVE VN003-LONGNAME-SEGMENT-DATA TO VN003-LONGNAME-DATA.     05580600
055807     MOVE VN003-LONGNAME-MESSAGE      TO VN003-MSGBUFFER.         05580700
055808     MOVE VN003-LONGNAME-MSG-LENGTH   TO PV-OUT-MSGLENGTH.        05580800
055809                                                                  05580900
055810     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            05581000
055811                PV-MQPUT-RETRY-COUNTER.                           05581100
055812     PERFORM S100-PUT-MQ-MESSAGE                                  05581200
055813       UNTIL PS-MQPUT-SUCCESSFUL.                                 05581300
055814 EJECT                                                            05581400
055815*--------------------------------------------------------------*  05581500
055816* READ THE INPUT CONTROL CARD TO OBTAIN THE MESSAGE QUEUE NAME *  05581600
055817*--------------------------------------------------------------*  05581700
055818 R100-READ-CONTROL-CARD-1.                                        05581800
055819                                                                  05581900
055820     READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1                   05582000
055821       AT END                                                     05582100
055822          SET PS-EOF-CONTROL-CARD1      TO TRUE                   05582200
055823       NOT AT END                                                 05582300
055824          SET PS-NOT-EOF-CONTROL-CARD1  TO TRUE                   05582400
055825     END-READ.                                                    05582500
055826                                                                  05582600
055827*--------------------------------------------------------------*  05582700
055828* READ THE INPUT CONTROL CARD TO OBTAIN THE MESSAGE MANAGER    *  05582800
055829* NAME                                                         *  05582900
055830*--------------------------------------------------------------*  05583000
055831 R200-READ-CONTROL-CARD-2.                                        05583100
055832                                                                  05583200
055833     READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2                   05583300
055834       AT END                                                     05583400
055835          SET PS-EOF-CONTROL-CARD2       TO TRUE                  05583500
055836       NOT AT END                                                 05583600
055837          SET PS-NOT-EOF-CONTROL-CARD2   TO TRUE                  05583700
055838     END-READ.                                                    05583800
055839                                                                  05583900
055840*----------------------------------------------------------------*05584000
055841* READ THE INPUT CONTROL CARD TO OBTAIN THE MESSAGE MANAGER    *  05584100
055842* NAME                                                         *  05584200
055843*--------------------------------------------------------------*  05584300
055844 R300-READ-CONTROL-CARD-3.                                        05584400
055845                                                                  05584500
055846     READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3                   05584600
055847       AT END                                                     05584700
055848          SET PS-EOF-CONTROL-CARD3       TO TRUE                  05584800
055849       NOT AT END                                                 05584900
055850          SET PS-NOT-EOF-CONTROL-CARD3   TO TRUE                  05585000
055851     END-READ.                                                    05585100
055852                                                                  05585200
055853*----------------------------------------------------------------*05585300
055854*  R500-READ-EXTRACT-FILE                                        *05585400
055855*  READS THE INPUT INVOICE FILE INTO THE VNWS007 COPY BOOK.      *05585500
055856*----------------------------------------------------------------*05585600
055857                                                                  05585700
055858 R500-READ-EXTRACT-FILE.                                          05585800
055859                                                                  05585900
055860     READ RMS-VENDOR-FILE INTO VN007-SENDING-FIELDS               05586000
055861         AT END                                                   05586100
055862            SET END-OF-EXTRACT TO TRUE.                           05586200
055863                                                                  05586300
055864     IF NOT END-OF-EXTRACT                                        05586400
055865        ADD 1 TO INPUT-COUNT                                      05586500
055866     END-IF.                                                      05586600
055867                                                                  05586700
055868 EJECT                                                            05586800
055869******************************************************************05586900
055870*  PUT MESSAGE ON THE VENDOR INFO TO RMS QUEUE.                   05587000
055880******************************************************************05588000
055890 S100-PUT-MQ-MESSAGE.                                             05589000
055900                                                                  05590000
056000*    DISPLAY 'STARTING S100'.                                     05600000
056100     MOVE CC-QMGR-NAME           TO MQOD-OBJECTQMGRNAME.          05610000
056200     MOVE CC-QNAME               TO MQOD-OBJECTNAME.              05620000
056300     MOVE MQMI-NONE              TO MQMD-MSGID.                   05630000
056400     MOVE MQCI-NONE              TO MQMD-CORRELID.                05640000
056500     MOVE MQFMT-STRING           TO MQMD-FORMAT.                  05650000
056600     MOVE MQPER-PERSISTENT       TO MQMD-PERSISTENCE.             05660000
056700     COMPUTE MQPMO-OPTIONS  = MQPMO-SYNCPOINT.                    05670000
056800*                                                                 05680000
056900     CALL WS-MQPUT USING PV-HCONN                                 05690000
057000                         PV-PQ-HANDLE                             05700000
057100                         MQM-MESSAGE-DESCRIPTOR                   05710000
057200                         MQM-PUT-MESSAGE-OPTIONS                  05720000
057300                         PV-OUT-MSGLENGTH                         05730000
057400                         VN003-MSGBUFFER                          05740000
057500                         PV-COMPLETION-CODE                       05750000
057600                         PV-REASON.                               05760000
057700                                                                  05770000
057800*        IF PUT FAILED THEN DISPLAY ERROR MESSAGE                 05780000
057900*        AND BREAK OUT OF LOOP                                    05790000
058000                                                                  05800000
058100     IF  (PV-COMPLETION-CODE NOT = MQCC-OK)                       05810000
058200         MOVE PV-PARAGRAPH            TO PV-SAVE-PARAGRAPH        05820000
058300         MOVE PV-COMPLETION-CODE      TO PV-SAVE-COMPLETION-CODE  05830000
058400         MOVE PV-REASON               TO PV-SAVE-REASON           05840000
058500         PERFORM Y300-CLOSE-MQ-QUEUE                              05850000
058600         PERFORM Y400-DISCONNECT-QMGR                             05860000
058700         MOVE PV-SAVE-PARAGRAPH       TO PV-PARAGRAPH             05870000
058800         MOVE PV-SAVE-COMPLETION-CODE TO PV-COMPLETION-CODE       05880000
058900         MOVE PV-SAVE-REASON          TO PV-REASON                05890000
059000         PERFORM Z998-MQ-ABEND                                    05900000
059100     ELSE                                                         05910000
059200         SET PS-MQPUT-SUCCESSFUL TO TRUE                          05920000
059300         ADD 1 TO PV-NBR-OF-MSGS-CREATED                          05930000
059400         DISPLAY ' PUT SUCCESSFUL - MSG NUMBER = '                05940000
059500                  PV-NBR-OF-MSGS-CREATED                          05950000
059600     END-IF.                                                      05960000
059700 EJECT                                                            05970000
059800******************************************************************05980000
059900* CONNECT TO THE QUEUE MANAGER                                    05990000
060000******************************************************************06000000
060100 Y100-CONNECT-TO-QMGR.                                            06010000
060200                                                                  06020000
060300     MOVE 'Y100-CONNECT-TO-QMGR'       TO PV-PARAGRAPH.           06030000
060400                                                                  06040000
060500     CALL WS-MQCONN USING CC-QMGR-NAME-LCL                        06050000
060600                          PV-HCONN                                06060000
060700                          PV-COMPLETION-CODE                      06070000
060800                          PV-REASON.                              06080000
060900                                                                  06090000
061000     EVALUATE TRUE                                                06100000
061100        WHEN PV-COMPLETION-CODE = MQCC-OK                         06110000
061200             DISPLAY 'SUCCESSFULLY CONNECTED TO: '                06120000
061300                                            CC-QMGR-NAME          06130000
061400        WHEN OTHER                                                06140000
061500             CALL WS-MQCHECK USING PV-REASON                      06150000
061600                                    PV-MQ-REASON-TEXT             06160000
061700             DISPLAY 'UNABLE TO CONNECT TO ' CC-QMGR-NAME         06170000
061800             MOVE 'Y100-CONNECT-TO-QMGR - CONNECT ERROR '         06180000
061900               TO PV-PARAGRAPH                                    06190000
062000             PERFORM Z998-MQ-ABEND                                06200000
062100     END-EVALUATE.                                                06210000
062200                                                                  06220000
062300******************************************************************06230000
062400*  OPEN THE OUTPUT MESSAGE QUEUES.                                06240000
062500******************************************************************06250000
062600 Y200-OPEN-MQ-QUEUE.                                              06260000
062700                                                                  06270000
062800     COMPUTE PV-OPEN-OPTIONS = MQOO-OUTPUT +                      06280000
062900                               MQOO-FAIL-IF-QUIESCING.            06290000
063000     MOVE CC-QNAME                       TO MQOD-OBJECTNAME.      06300000
063100     MOVE CC-QMGR-NAME                   TO MQOD-OBJECTQMGRNAME.  06310000
063200                                                                  06320000
063300     CALL WS-MQOPEN USING PV-HCONN                                06330000
063400                          MQM-OBJECT-DESCRIPTOR                   06340000
063500                          PV-OPEN-OPTIONS                         06350000
063600                          PV-PQ-HANDLE                            06360000
063700                          PV-COMPLETION-CODE                      06370000
063800                          PV-REASON.                              06380000
063900*                                                                 06390000
064000*    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    06400000
064100*    AND EXIT.                                                    06410000
064200*                                                                 06420000
064300     EVALUATE TRUE                                                06430000
064400        WHEN PV-COMPLETION-CODE = MQCC-OK                         06440000
064500             DISPLAY 'SUCCESSFULLY OPENED: ' CC-QMGR-NAME         06450000
064600        WHEN OTHER                                                06460000
064700            MOVE 'Y200-OPEN-MQ-QUEUE - OPEN ERROR '               06470000
064800               TO PV-PARAGRAPH                                    06480000
064900            MOVE PV-PARAGRAPH           TO PV-SAVE-PARAGRAPH      06490000
065000            MOVE PV-COMPLETION-CODE     TO PV-SAVE-COMPLETION-CODE06500000
065100            MOVE PV-REASON              TO PV-SAVE-REASON         06510000
065200            MOVE PV-SAVE-PARAGRAPH      TO PV-PARAGRAPH           06520000
065300            MOVE PV-SAVE-COMPLETION-CODE TO PV-COMPLETION-CODE    06530000
065400            MOVE PV-SAVE-REASON         TO PV-REASON              06540000
065500            PERFORM Z998-MQ-ABEND                                 06550000
065600     END-EVALUATE.                                                06560000
065700******************************************************************06570000
065800*  CLOSE THE INPUT AND OUTPUT MESSAGE QUEUES.                     06580000
065900******************************************************************06590000
066000 Y300-CLOSE-MQ-QUEUE.                                             06600000
066100                                                                  06610000
066200     CALL WS-MQCLOSE USING PV-HCONN                               06620000
066300                           PV-PQ-HANDLE                           06630000
066400                           MQCO-NONE                              06640000
066500                           PV-COMPLETION-CODE                     06650000
066600                           PV-REASON.                             06660000
066700                                                                  06670000
066800     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        06680000
066900        MOVE 'Y300-CLOSE-MQ-QUEUE - CLOSE ERROR' TO PV-PARAGRAPH  06690000
067000        PERFORM Z998-MQ-ABEND                                     06700000
067100     END-IF.                                                      06710000
067200 EJECT                                                            06720000
067300***************************************************************** 06730000
067400* DISCONNECT FROM THE QUEUE MANAGER                               06740000
067500***************************************************************** 06750000
067600 Y400-DISCONNECT-QMGR.                                            06760000
067700                                                                  06770000
067800     CALL WS-MQDISC USING PV-HCONN                                06780000
067900                          PV-COMPLETION-CODE                      06790000
068000                          PV-REASON.                              06800000
068100                                                                  06810000
068200     EVALUATE TRUE                                                06820000
068300        WHEN PV-COMPLETION-CODE = MQCC-OK                         06830000
068400             CONTINUE                                             06840000
068500        WHEN PV-COMPLETION-CODE NOT EQUAL MQCC-OK                 06850000
068510             CALL WS-MQCHECK USING PV-REASON                      06851000
068520                                    PV-MQ-REASON-TEXT             06852000
068530             MOVE 'Y400-DISCONNECT-QMGR - MQDISC ERROR'           06853000
068540               TO PV-PARAGRAPH                                    06854000
068550             PERFORM Z998-MQ-ABEND                                06855000
068560     END-EVALUATE.                                                06856000
068570                                                                  06857000
068580* ------------------------------------------------------------- * 06858000
068590* DISPLAY THE VALUES OF A FAILED MQ API COMMAND, AND ABEND PGM    06859000
068591* ------------------------------------------------------------- * 06859100
068592 Z998-MQ-ABEND.                                                   06859200
068593                                                                  06859300
068594     IF PV-COMPLETION-CODE NOT = MQCC-OK                          06859400
068595        CALL WS-MQCHECK USING PV-REASON PV-MQ-REASON-TEXT         06859500
068596     END-IF.                                                      06859600
068597                                                                  06859700
068598     DISPLAY '**** ABEND *************************************'.  06859800
068599     DISPLAY '** MQSERIES ERROR **'.                              06859900
068600     DISPLAY '** PROGRAM:    ' PC-PGM-NAME.                       06860000
068700     DISPLAY '** ABEND CODE: ' ABEND-CODE.                        06870000
068800     DISPLAY '** PARAGRAPH:  ' PV-PARAGRAPH.                      06880000
068810     DISPLAY '** COMP CODE:  ' PV-COMPLETION-CODE.                06881000
068820     DISPLAY '** RSN CODE:   ' PV-REASON.                         06882000
068830     DISPLAY '** RSN TEXT:   ' PV-MQ-REASON-TEXT.                 06883000
068840     DISPLAY '************************************************'.  06884000
068850     MOVE +4013 TO ABEND-CODE.                                    06885000
068860     CALL 'ILBOABN0' USING ABEND-CODE.                            06886000
068870                                                                  06887000
068880*--------------------------------------------------------------*  06888000
068890* ABEND ROUTINE                                                *  06889000
068891*--------------------------------------------------------------*  06889100
068892 Z999-ABEND.                                                      06889200
068893                                                                  06889300
068894     DISPLAY AA-ABEND-LIT.                                        06889400
068895     DISPLAY AA-PROGRAM-LIT.                                      06889500
068896     DISPLAY AA-PARAGRAPH-LIT.                                    06889600
068897     DISPLAY AA-MESSAGE-LINE.                                     06889700
068898                                                                  06889800
068899     CALL 'ILBOABN0' USING ABEND-CODE.                            06889900
068900                                                                  06890000
