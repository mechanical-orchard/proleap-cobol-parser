000100*------------------------------------------------------------             
000200 IDENTIFICATION DIVISION.                                                 
000300*------------------------------------------------------------             
000400 PROGRAM-ID.    ICKUT001.                                                 
000500 AUTHOR.        RICH KELLEN.                                              
000600 DATE-WRITTEN.  JUL 20, 2009.                                             
000700                                                                          
000800*------------------------------------------------------------             
000900*    INVENTORY COUNTS FORMATTER                                           
001000*------------------------------------------------------------             
001100*    THIS PROGRAM WILL FORMAT THE INVENTORY COUNTS            *           
001200*    DATA FILE FOR THE SQL SERVER STORE DATABASE TABLE,       *           
001300*    AND ADD DISTRIBUTION HEADER RECORDS, AS APPROPRIATE.     *           
001400*    WINTER 2010 INFRASTRUCTURE PROJECT WR                    *           
001500*    THE FORMATTING WILL CONSIST OF REMOVING LEADING ZEROS,   *           
001600*    SPACES AND DELIMITING THE FIELDS USING THE VERTILCAL BAR *           
001700*    '|' CHARACTER. FOR SOME RECORD TYPES HARDCODED VALUES    *           
001800*    MAY BE INSERTED AS THE DATA FOR THESE COLUMNS DOES NOT   *           
001900*    EXIST ON THE MAINFRAME, BUT, NEEDS TO BE PROVIDED TO THE *           
002000*    ROUTINES PERFORMING TABLE MAINT TO THE STORE TABLES.     *           
002100*                                                             *           
002200*------------------------------------------------------------             
002300*  INPUT:                                                     *           
002400*        CNT-STAT-TYP-FILE                ICRD201             *           
002500*        CNT-STUP-FILE                    ICRD202             *           
002600*        CNT-SKU-LOC-CNT-FILE             ICRD203             *           
002700*        CNT-LOC-CNT-STAT-FILE            ICRD204             *           
002800*        CNT-LOC-CNT-SUM-FILE             ICRD205             *           
002900*        FILE-TYPE                        EPRD667                         
003000*                                                             *           
003100*  OUTPUT:                                                    *           
003200*        FORMATTED-IC-FL                  EPRD217             *           
003300*                                (FOR HEADER FORMAT)          *           
003400*-------------------------------------------------------------*           
003500* HISTORY LOG:                                                *           
003600*                                                             *           
003700*-------------------------------------------------------------*           
003800* DATE: JAN 2010                                              *           
003900* WR/IR#: WR #35484                                           *           
004000* PROGRAMMER: RICH KELLEN                                     *           
004100* DESCRIPTION: INITIAL PROGRAM CREATION                       *           
004200*-------------------------------------------------------------*           
004300* DATE: 05/12/2015                                            *           
004400* WR/IR#: CHG0111857                                          *           
004500* PROGRAMMER:  COGNIZANT                                      *           
004600* DESCRIPTION: MODIFIED PROGRAM IN 1400-DETERMINE-PROCESS AS              
004700*              DAILY COUNTS WERE REMOVED FROM INVENTORY COUNTS            
004800*              AND ONLY FJ COUNTS ARE AVAILABLE. CHANGES ARE              
004900*              TAGGED AS CR1857.                                          
004200*-------------------------------------------------------------*           
004300* DATE: 02/28/2017                                            *           
004400* WR/IR#: CHG0162935                                          *           
004500* PROGRAMMER:  COGNIZANT                                      *           
004600* DESCRIPTION: MODIFIED PARA 2000- TO HANDLE CHG STATUS FILES.            
004700*              CHANGES ARE TAGGED WITH PRB0064456.                        
004900*                                                                         
005000*-------------------------------------------------------------*           
005100 ENVIRONMENT DIVISION.                                                    
005200*-------------------------------------------------------------*           
005300 CONFIGURATION SECTION.                                                   
005400 SOURCE-COMPUTER. IBM-3090.                                               
005500 OBJECT-COMPUTER. IBM-3090.                                               
005600                                                                          
005700 INPUT-OUTPUT SECTION.                                                    
005800                                                                          
005900 FILE-CONTROL.                                                            
006000*  INPUT:                                                     *           
006100           SELECT CNT-STAT-TYP-FILE                                       
006200             ASSIGN TO INP01.                                             
006300                                                                          
006400           SELECT CNT-STUP-FILE                                           
006500             ASSIGN TO INP02.                                             
006600                                                                          
006700           SELECT CNT-SKU-LOC-CNT-FILE                                    
006800             ASSIGN TO INP03.                                             
006900                                                                          
007000           SELECT CNT-LOC-CNT-STAT-FILE                                   
007100             ASSIGN TO INP04.                                             
007200                                                                          
007300           SELECT CNT-LOC-CNT-SUM-FILE                                    
007400             ASSIGN TO INP05.                                             
007500                                                                          
007600           SELECT CC-FILE-TYPE                                            
007700             ASSIGN TO INP06.                                             
007800                                                                          
007900*  OUTPUT:                                                    *           
008000           SELECT FORMATTED-IC-FL                                         
008100             ASSIGN TO OUT01.                                             
008200                                                                          
008300                                                                          
008400*-------------------------------------------------------------*           
008500 DATA DIVISION.                                                           
008600*----------------------------------------------------------               
008700 FILE SECTION.                                                            
008800                                                                          
008900 FD  CNT-STAT-TYP-FILE                                                    
009000     RECORDING MODE IS F                                                  
009100     LABEL RECORDS ARE STANDARD                                           
009200     BLOCK CONTAINS 0 RECORDS                                             
009300     DATA RECORD IS CNT-STAT-TYP-REC.                                     
009400                                                                          
009500 01  CNT-STAT-TYP-REC        PIC X(072).                                  
009600                                                                          
009700 FD  CNT-STUP-FILE                                                        
009800     RECORDING MODE IS F                                                  
009900     LABEL RECORDS ARE STANDARD                                           
010000     BLOCK CONTAINS 0 RECORDS                                             
010100     DATA RECORD IS CNT-STUP-REC.                                         
010200                                                                          
010300 01  CNT-STUP-REC            PIC X(112).                                  
010400                                                                          
010500 FD  CNT-SKU-LOC-CNT-FILE                                                 
010600     RECORDING MODE IS F                                                  
010700     LABEL RECORDS ARE STANDARD                                           
010800     BLOCK CONTAINS 0 RECORDS                                             
010900     DATA RECORD IS CNT-SKU-LOC-CNT-FILE-REC.                             
011000                                                                          
011100 01  CNT-SKU-LOC-CNT-REC      PIC X(85).                                  
011200                                                                          
011300 FD  CNT-LOC-CNT-STAT-FILE                                                
011400     RECORDING MODE IS F                                                  
011500     LABEL RECORDS ARE STANDARD                                           
011600     BLOCK CONTAINS 0 RECORDS                                             
011700     DATA RECORD IS CNT-LOC-CNT-STAT-REC.                                 
011800                                                                          
011900 01  CNT-LOC-CNT-STAT-REC PIC X(63).                                      
012000                                                                          
012100 FD  CNT-LOC-CNT-SUM-FILE                                                 
012200     RECORDING MODE IS F                                                  
012300     LABEL RECORDS ARE STANDARD                                           
012400     BLOCK CONTAINS 0 RECORDS                                             
012500     DATA RECORD IS CNT-LOC-CNT-SUM-REC.                                  
012600                                                                          
012700 01  CNT-LOC-CNT-SUM-REC     PIC X(079).                                  
012800                                                                          
012900 FD  CC-FILE-TYPE                                                         
013000     RECORDING MODE IS F                                                  
013100     BLOCK CONTAINS 0 RECORDS                                             
013200     LABEL RECORDS ARE STANDARD.                                          
013300                                                                          
013400 01  CC-FILE-TYPE-RECORD          PIC X(80).                              
013500                                                                          
013600 FD  FORMATTED-IC-FL                                                      
013700     RECORDING MODE IS V                                                  
013800     RECORD IS VARYING IN SIZE                                            
013900     FROM 1 TO 200 CHARACTERS                                             
014000     DEPENDING ON PV-BYTE-COUNT                                           
014100     LABEL RECORDS ARE STANDARD                                           
014200     DATA RECORD IS FORMATTED-IC-REC.                                     
014300                                                                          
014400 01  FORMATTED-IC-REC.                                                    
014500     05  FORM-IC-HR-FLD                  PIC X(01)                        
014600         OCCURS 200 TIMES                                                 
014700              INDEXED BY                                                  
014800              FORM-IC-HR-LEN.                                             
014900                                                                          
015000*----------------------------------------------------------               
015100 WORKING-STORAGE SECTION.                                                 
015200                                                                          
015300 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO              
015400                                                  COMP SYNC.              
015500     88  AC-INPUT-CONTROL-CARD-ERROR              VALUE +4003.            
015600     88  AC-DB2-ERROR                             VALUE +4013.            
015700     88  AC-INPUT-FILE-EMPTY                      VALUE +4008.            
015800                                                                          
015900*----------------------------------------------------------               
016000* PC- PROGRAM CONSTANTS                                                   
016100*----------------------------------------------------------               
016200 01  PC-PROGRAM-CONSTANTS.                                                
016300     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'ICKUT001'.         
016400     05  PC-CSV-DELIMITER             PIC X(01) VALUE '|'.                
016500     05  PC-UNDER-SCORE               PIC X(01) VALUE '_'.                
016600     05  PC-DASH                      PIC X(01) VALUE '-'.                
016700     05  PC-COLON                     PIC X(01) VALUE ':'.                
016800     05  PC-ONE-SPACE                 PIC X(01) VALUE ' '.                
016900     05  PC-ONE-ZERO                  PIC X(01) VALUE '0'.                
017000     05  PC-STR-GRP-ID-99997          PIC X(05) VALUE '99997'.            
017100     05  PC-STR-GRP-ID-5000           PIC X(05) VALUE '05000'.            
017200     05  PC-STR-GRP-ID-1000           PIC X(05) VALUE '05000'.            
017300     05  PC-CHG-FILE-STR-ID           PIC X(05) VALUE '00001'.            
017400     05  PC-FULL-FILE-STR-ID          PIC X(05) VALUE '00001'.            
017500     05  PC-FIVE-ZERO                 PIC X(05) VALUE '00000'.            
017600     05  PC-HDR-IND                   PIC X(03) VALUE 'HDR'.              
017700     05  PC-FILE-APPLY-TYPE-FUL       PIC X(01) VALUE 'N'.                
017800     05  PC-FILE-APPLY-TYPE-CHG       PIC X(01) VALUE 'C'.                
017900*----------------------------------------------------------               
018000* PV- PROGRAM VARIABLES                                                   
018100*----------------------------------------------------------               
018200 01  PV-PROGRAM-STATUS.                                                   
018300     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.             
018400     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACES.             
018500     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACES.             
018600     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.              
018700     05  PV-SQL-SUB                   PIC S9(4) VALUE +0 COMP.            
018800*                                                                         
018900 01  PV-PROGRAM-VARIABLES.                                                
019000     05  PV-TALLY                     PIC S9(03) COMP-3 VALUE +0.         
019100     05  PV-PIPE-COUNT                PIC  9(04) VALUE ZERO.              
019200     05  PV-BYTE-COUNT                PIC  9(04) VALUE ZERO.              
019300     05  PV-SQL-SUB                   PIC  9(01) VALUE ZERO.              
019400     05  PV-SPACE                     PIC  X(01).                         
019500     05  PV-DISPLAY-INDEX             PIC S9(04) COMP.                    
019600                                                                          
019700     05  PV-VARIABLE-OUTPUT-FIELD.                                        
019800         10  PV-BIT-VARIABLE          PIC X(01)                           
019900                                          VALUE SPACES                    
020000                                          OCCURS 10 TIMES                 
020100                                          INDEXED BY                      
020200                                          PV-BIT-IDX                      
020300                                          PV-EOF-IDX.                     
020400                                                                          
020500     05  PV-VARIABLE-CHAR-FIELD.                                          
020600         10  PV-BIT-CHR-VARIABLE      PIC X(01)                           
020700                                          VALUE SPACES                    
020800                                          OCCURS 50 TIMES                 
020900                                          INDEXED BY                      
021000                                          PV-CHR-BIT-IDX                  
021100                                          PV-CHR-EOF-IDX.                 
021200                                                                          
021300     05  PV-SAVE-PREV-LOC-NBR         PIC X(05) VALUE SPACES.             
021400     05  PV-TIMESTAMP                 PIC X(26) VALUE SPACES.             
021500     05  PV-CURRENT-TMST REDEFINES    PV-TIMESTAMP.                       
021600         10  PV-CURR-YYYY             PIC 9(04).                          
021700         10  FILLER                   PIC X(01).                          
021800         10  PV-CURR-MO               PIC 9(02).                          
021900         10  FILLER                   PIC X(01).                          
022000         10  PV-CURR-DD               PIC 9(02).                          
022100         10  FILLER                   PIC X(01).                          
022200         10  PV-CURR-HH               PIC 9(02).                          
022300         10  FILLER                   PIC X(01).                          
022400         10  PV-CURR-MM               PIC 9(02).                          
022500         10  FILLER                   PIC X(01).                          
022600         10  PV-CURR-SS               PIC 9(02).                          
022700         10  FILLER                   PIC X(01).                          
022800         10  PV-CURR-SSSSSS           PIC 9(06).                          
022900                                                                          
023000     05  PV-HEADER-TMST.                                                  
023100         10  PV-HEADER-YYYY           PIC 9(04)  VALUE ZERO.              
023200         10  PV-HEADER-MO             PIC 9(02)  VALUE ZERO.              
023300         10  PV-HEADER-DD             PIC 9(02)  VALUE ZERO.              
023400         10  PV-HEADER-HH             PIC 9(02)  VALUE ZERO.              
023500         10  PV-HEADER-MM             PIC 9(02)  VALUE ZERO.              
023600         10  PV-HEADER-SS             PIC 9(02)  VALUE ZERO.              
023700                                                                          
023800     05  PV-QUOTIENT                  PIC 9(04)  VALUE ZERO.              
023900     05  PV-RMDR-4                    PIC 9(04)  VALUE ZERO.              
024000     05  PV-RMDR-100                  PIC 9(04)  VALUE ZERO.              
024100                                                                          
024200     05  PV-FORMAT-HDR-DIST-DTE.                                          
024300         10  PV-FORMAT-YYYY           PIC X(04).                          
024400         10  PV-FORMAT-MM             PIC X(02).                          
024500         10  PV-FORMAT-DD             PIC X(02).                          
024600                                                                          
024700     05  PV-FILE-APPLY-TYPE           PIC X(01) VALUE SPACES.             
024800     05  PV-FILE-PROCESS-TYPE         PIC X(03) VALUE SPACES.             
024900     05  PV-STR-GRP-TYP-CDE           PIC 9(05) VALUE ZERO.               
025000     05  PV-STR-GRP-ID-GRP.                                               
025100         10  PV-FIRST-BYTES           PIC 9(05) VALUE ZERO.               
025200         10  PV-STR-GRP-ID            PIC 9(05) VALUE ZERO.               
025300     05  PV-RECORD-ACTION             PIC X(01) VALUE SPACES.             
025400                                                                          
025500*----------------------------------------------------------               
025600* PV- PROGRAM COUNT VARIABLES                                             
025700*----------------------------------------------------------               
025800 01  PV-PROGRAM-COUNTERS.                                                 
025900     05  PV-CNT-STAT-READ             PIC 9(09) VALUE 0.                  
026000     05  PV-CNT-STUP-READ             PIC 9(09) VALUE 0.                  
026100     05  PV-SKU-LOC-READ              PIC 9(09) VALUE 0.                  
026200     05  PV-LOC-CNT-STAT-READ         PIC 9(09) VALUE 0.                  
026300     05  PV-LOC-CNT-SUM-READ          PIC 9(09) VALUE 0.                  
026400     05  PV-HDR-REC-WRITEN            PIC 9(09) VALUE 0.                  
026500     05  PV-DATA-REC-WRITEN           PIC 9(09) VALUE 0.                  
026600                                                                          
026700*----------------------------------------------------------------*        
026800* PS- PROGRAM SWITCHES                                           *        
026900*----------------------------------------------------------------*        
027000 01  PS-PROGRAM-SWITCHES.                                                 
027100     05  PS-END-OF-CNT-STAT-FILE-SW   PIC  X(01) VALUE 'N'.               
027200         88  PS-END-OF-CNT-STAT-FILE             VALUE 'Y'.               
027300         88  PS-NOT-END-OF-CNT-STAT-FILE         VALUE 'N'.               
027400     05  PS-END-OF-CNT-STUP-FILE-SW   PIC  X(01) VALUE 'N'.               
027500         88  PS-END-OF-CNT-STUP-FILE             VALUE 'Y'.               
027600         88  PS-NOT-END-OF-CNT-STUP-FILE         VALUE 'N'.               
027700     05  PS-END-OF-SKU-LOC-FILE-SW    PIC  X(01) VALUE 'N'.               
027800         88  PS-END-OF-SKU-LOC-FILE              VALUE 'Y'.               
027900         88  PS-NOT-END-OF-SKU-LOC-FILE          VALUE 'N'.               
028000     05  PS-END-OF-LOC-CNT-ST-FILE-SW PIC  X(01) VALUE 'N'.               
028100         88  PS-END-OF-LOC-CNT-ST-FILE           VALUE 'Y'.               
028200         88  PS-NOT-END-OF-LOC-CNT-ST-FILE       VALUE 'N'.               
028300     05  PS-END-OF-LOC-CNT-SM-FILE-SW PIC  X(01) VALUE 'N'.               
028400         88  PS-END-OF-LOC-CNT-SM-FILE           VALUE 'Y'.               
028500         88  PS-NOT-END-OF-LOC-CNT-SM-FILE       VALUE 'N'.               
028600     05  PS-END-OF-CC-TYP-FILE-SW     PIC  X(01) VALUE 'N'.               
028700         88  PS-END-OF-CC-TYP-FILE               VALUE 'Y'.               
028800         88  PS-NOT-END-OF-CC-TYP-FILE           VALUE 'N'.               
028900     05  PS-END-OF-PROCES-SW          PIC  X(01) VALUE 'N'.               
029000         88  PS-END-OF-PROCESSING                VALUE 'Y'.               
029100         88  PS-NOT-END-OF-PROCESSING            VALUE 'N'.               
029200     05  PS-STAT-TYP-HDR-WRITEN-SW    PIC  X(01) VALUE 'N'.               
029300         88 PS-STAT-TYP-HDR-WRITEN               VALUE 'Y'.               
029400         88 PS-STAT-TYP-HDR-NOT-WRITEN           VALUE 'N'.               
029500     05  PS-CNT-STUP-HDR-WRITEN-SW    PIC  X(01) VALUE 'N'.               
029600         88 PS-CNT-STUP-HDR-WRITEN               VALUE 'Y'.               
029700         88 PS-CNT-STUP-HDR-NOT-WRITEN           VALUE 'N'.               
029800     05  PS-SKU-LOC-CNT-HDR-WRITEN-SW PIC  X(01) VALUE 'N'.               
029900         88 PS-SKU-LOC-CNT-HDR-WRITEN            VALUE 'Y'.               
030000         88 PS-SKU-LOC-CNT-HDR-NOT-WRITEN        VALUE 'N'.               
030100     05  PS-LOC-CNT-STAT-HDR-WRITEN-SW PIC X(01) VALUE 'N'.               
030200         88 PS-LOC-CNT-STAT-HDR-WRITEN           VALUE 'Y'.               
030300         88 PS-LOC-CNT-STAT-HDR-NOT-WRITEN       VALUE 'N'.               
030400     05  PS-LOC-CNT-SUM-HDR-WRITEN-SW  PIC X(01) VALUE 'N'.               
030500         88 PS-LOC-CNT-SUM-HDR-WRITEN            VALUE 'Y'.               
030600         88 PS-LOC-CNT-SUM-HDR-NOT-WRITEN        VALUE 'N'.               
030700*----------------------------------------------------------               
030800* COPYBOOK  EPRD217 LAYOUT (HEADER LAYOUT)                                
030900*----------------------------------------------------------               
031000     COPY EPRD217.                                                        
031100                                                                          
031200*----------------------------------------------------------               
031300* COPYBOOK  ICRD201 LAYOUT (READ COUNT STAT TYPE FILE)                    
031400*----------------------------------------------------------               
031500     COPY ICRD201.                                                        
031600                                                                          
031700*----------------------------------------------------------               
031800* COPYBOOK  ICRD202 LAYOUT (READ COUNT SETUP FILE)                        
031900*----------------------------------------------------------               
032000     COPY ICRD202.                                                        
032100                                                                          
032200*----------------------------------------------------------               
032300* COPYBOOK  ICRD203 LAYOUT (READ SKU LOC COUNT FILE)                      
032400*----------------------------------------------------------               
032500     COPY ICRD203.                                                        
032600                                                                          
032700*----------------------------------------------------------               
032800* COPYBOOK  ICRD204 LAYOUT (READ LOC COUNT STAT FILE)                     
032900*----------------------------------------------------------               
033000     COPY ICRD204.                                                        
033100                                                                          
033200*----------------------------------------------------------               
033300* COPYBOOK  ICRD205 LAYOUT (READ LOC COUNT SUM FILE)                      
033400*----------------------------------------------------------               
033500     COPY ICRD205.                                                        
033600                                                                          
033700*----------------------------------------------------------               
033800* COPYBOOK  EPRD667 LAYOUT (READ FILE TYPE CONTROL CARD)                  
033900*----------------------------------------------------------               
034000     COPY EPRD667.                                                        
034100                                                                          
034200*------------------------------------------------------------             
034300* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004                 
034400*------------------------------------------------------------             
034500     COPY DPWS004.                                                        
034600                                                                          
034700*-----------------------------------------------------------              
034800* DB2 MESSAGE AREA                                                        
034900*-----------------------------------------------------------              
035000     COPY SQLCA2.                                                         
035100                                                                          
035200*-----------------------------------------------------------              
035300* DB2 COMMUNICATIONS AREA                                                 
035400*-----------------------------------------------------------              
035500     EXEC SQL                                                             
035600          INCLUDE SQLCA                                                   
035700     END-EXEC.                                                            
035800                                                                          
035900                                                                          
036000*----------------------------------------------------------               
036100 PROCEDURE DIVISION.                                                      
036200*----------------------------------------------------------               
036300 0000-MAINLINE.                                                           
036400                                                                          
036500     PERFORM 1000-INITIALIZATION.                                         
036600                                                                          
036700     PERFORM 2000-PROCESS-IC-COUNTS                                       
036800             UNTIL PS-END-OF-PROCESSING.                                  
036900                                                                          
037000     PERFORM 9200-WRAPUP.                                                 
037100                                                                          
037200     GOBACK.                                                              
037300                                                                          
037400*0000-EXIT.                                                               
037500                                                                          
037600*----------------------------------------------------------               
037700* 1000-INITIALIZATION.                                                    
037800*     INITIALIZES VARIABLES, OPENS ANY FILES, AND READS                   
037900*     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT              
038000*     FILES.                                                              
038100*----------------------------------------------------------               
038200 1000-INITIALIZATION.                                                     
038300                                                                          
038400     DISPLAY '****************************************'.                  
038500     DISPLAY '**          ICKUT001 STARTED          **'.                  
038600     DISPLAY '****************************************'.                  
038700                                                                          
038800     INITIALIZE PV-PROGRAM-VARIABLES.                                     
038900     INITIALIZE PS-PROGRAM-SWITCHES.                                      
039000                                                                          
039100     SET PS-NOT-END-OF-CNT-STAT-FILE    TO TRUE.                          
039200     SET PS-NOT-END-OF-CNT-STUP-FILE    TO TRUE.                          
039300     SET PS-NOT-END-OF-SKU-LOC-FILE     TO TRUE.                          
039400     SET PS-NOT-END-OF-LOC-CNT-ST-FILE  TO TRUE.                          
039500     SET PS-NOT-END-OF-LOC-CNT-SM-FILE  TO TRUE.                          
039600                                                                          
039700     PERFORM 1100-OPEN-FILES.                                             
039800                                                                          
039900     PERFORM 1200-GET-DB2-TIMESTAMP.                                      
040000                                                                          
040100     PERFORM 1300-READ-FILE-TYPE.                                         
040200                                                                          
040300     PERFORM 6000-READ-CNT-STAT-FILE.                                     
040400                                                                          
040500     IF PS-END-OF-CNT-STAT-FILE                                           
040600        DISPLAY ' ****  COUNT STAT TYPE IS EMPTY *****'                   
040700     END-IF.                                                              
040800                                                                          
040900     PERFORM 6100-READ-CNT-STUP-FILE.                                     
041000                                                                          
041100     IF PS-END-OF-CNT-STUP-FILE                                           
041200        DISPLAY ' ****  COUNT SETUP FILE IS EMPTY *****'                  
041300     END-IF.                                                              
041400                                                                          
041500     PERFORM 6200-READ-SKU-LOC-CNT-FILE.                                  
041600                                                                          
041700     IF PS-END-OF-SKU-LOC-FILE                                            
041800        DISPLAY ' ****  SKU LOC COUNT FILE IS EMPTY *****'                
041900     END-IF.                                                              
042000                                                                          
042100     PERFORM 6300-READ-LOC-CNT-ST-FILE.                                   
042200     IF PS-END-OF-LOC-CNT-ST-FILE                                         
042300        DISPLAY ' ****  LOC COUNT STAT FILE IS EMPTY *****'               
042400     END-IF.                                                              
042500                                                                          
042600     PERFORM 6400-READ-LOC-CNT-SM-FILE.                                   
042700                                                                          
042800     IF PS-END-OF-LOC-CNT-SM-FILE                                         
042900        DISPLAY ' ****  LOC COUNT SUM FILE IS EMPTY *****'                
043000     END-IF.                                                              
043100                                                                          
043200     PERFORM 1400-DETERMINE-PROCESS.                                      
043300                                                                          
043400*1000-EXIT.                                                               
043500                                                                          
043600*----------------------------------------------------------               
043700* 1100-OPEN-FILES.                                                        
043800*     THIS PARAGRAPH OPENS ALL THE FILES IN MODE REQUIRED                 
043900*----------------------------------------------------------               
044000 1100-OPEN-FILES.                                                         
044100                                                                          
044200     OPEN INPUT CNT-STAT-TYP-FILE                                         
044300                CNT-STUP-FILE                                             
044400                CNT-SKU-LOC-CNT-FILE                                      
044500                CNT-LOC-CNT-STAT-FILE                                     
044600                CNT-LOC-CNT-SUM-FILE                                      
044700                CC-FILE-TYPE.                                             
044800                                                                          
044900     OPEN OUTPUT FORMATTED-IC-FL.                                         
045000                                                                          
045100*1100-EXIT.                                                               
045200                                                                          
045300*----------------------------------------------------------               
045400* 1200-GET-DB2-TIMESTAMP.                                                 
045500*     THIS PARAGRAPH GETS THE DB2 TIMESTAMP WHICH WILL BE                 
045600*     USED TO UPDATE THE CRT-TIMESTAMP ON THE HEADER RECORD               
045700*----------------------------------------------------------               
045800 1200-GET-DB2-TIMESTAMP.                                                  
045900                                                                          
046000     EXEC SQL                                                             
046100          SELECT CURRENT TIMESTAMP                                        
046200          INTO  :PV-TIMESTAMP                                             
046300          FROM   SYSIBM.SYSDUMMY1                                         
046400     END-EXEC.                                                            
046500                                                                          
046600     IF SQLCODE NOT EQUAL ZERO                                            
046700        MOVE '1200-GET-DB2-TIMESTAMP' TO PV-PARAGRAPH-NAME                
046800        MOVE 'CANNOT GET CURRENT TIMESTAMP'                               
046900                                    TO PV-DB2-OPERATION                   
047000        PERFORM 9800-SQL-ABEND                                            
047100     END-IF.                                                              
047200                                                                          
047300*** SET UP TIMESTAMP    INFORMATION FOR HEADER                            
047400                                                                          
047500     MOVE PV-CURR-YYYY         TO PV-HEADER-YYYY.                         
047600                                                                          
047700     MOVE PV-CURR-MO           TO PV-HEADER-MO.                           
047800                                                                          
047900     MOVE PV-CURR-DD           TO PV-HEADER-DD.                           
048000                                                                          
048100     MOVE PV-CURR-HH           TO PV-HEADER-HH.                           
048200                                                                          
048300     MOVE PV-CURR-MM           TO PV-HEADER-MM.                           
048400                                                                          
048500     MOVE PV-CURR-SS           TO PV-HEADER-SS.                           
048600                                                                          
048700*** SET UP FILE DISTRIBUTION DATE FOR HEADER RECORD                       
048800                                                                          
048900     MOVE PV-CURR-YYYY         TO PV-FORMAT-YYYY.                         
049000                                                                          
049100     MOVE PV-CURR-MO           TO PV-FORMAT-MM.                           
049200                                                                          
049300     MOVE PV-CURR-DD           TO PV-FORMAT-DD.                           
049400                                                                          
049500*1200-EXIT.                                                               
049600                                                                          
049700*----------------------------------------------------------               
049800* 1300-READ-FILE-TYPE.                                                    
049900*     THIS PARAGRAPH GETS THE DB2 TIMESTAMP WHICH WILL BE                 
050000*     USED TO UPDATE THE CRT-TIMESTAMP ON THE HEADER RECORD               
050100*----------------------------------------------------------               
050200 1300-READ-FILE-TYPE.                                                     
050300                                                                          
050400     READ CC-FILE-TYPE INTO CC-EPCC667-CONTROL-CARD                       
050500         AT END                                                           
050600             SET PS-END-OF-CC-TYP-FILE   TO TRUE.                         
050700                                                                          
050800     DISPLAY '    '                                                       
050900     DISPLAY '   FILE TYPE BEING PROCESSED IS : '                         
051000                               CC-EPCC667-CONTROL-CARD-DISPLY.            
051100     DISPLAY '  '.                                                        
051200                                                                          
051300     IF PS-END-OF-CC-TYP-FILE                                             
051400         MOVE '1300-READ-FILE-TYPE  '  TO PV-PARAGRAPH-NAME               
051500         MOVE 'EMPTY FILE TYPE   CC '   TO PV-OPERATION-MSG-1             
051600         SET AC-INPUT-CONTROL-CARD-ERROR TO TRUE                          
051700         PERFORM 9910-ABEND                                               
051800     END-IF.                                                              
051900                                                                          
052000     MOVE CC-EPCC667-FILE-TYPE  TO PV-FILE-PROCESS-TYPE.                  
052100                                                                          
052200*1300-EXIT.                                                               
052300                                                                          
052400*----------------------------------------------------------               
052500* 1400-DETERMINE-PROCESS                                                  
052600*     THIS PARAGRAPH EVALUATES THE READ FLAGS AND THE FILE                
052700*     TYPE TO DETERMINE FURTHER PROCESSING.                               
052800*----------------------------------------------------------               
052900 1400-DETERMINE-PROCESS.                                                  
053000                                                                          
053100     IF PV-FILE-PROCESS-TYPE = 'FUL'                                      
053200        EVALUATE TRUE                                                     
053300            WHEN PS-END-OF-CNT-STUP-FILE                                  
053400             AND PS-END-OF-SKU-LOC-FILE                                   
053500             AND PS-END-OF-LOC-CNT-ST-FILE                                
053600                SET PS-END-OF-PROCESSING TO TRUE                          
053700             WHEN PS-NOT-END-OF-CNT-STUP-FILE                             
053800             AND PS-NOT-END-OF-SKU-LOC-FILE                               
053900             AND PS-NOT-END-OF-LOC-CNT-ST-FILE                            
054000                SET PS-NOT-END-OF-PROCESSING TO TRUE                      
054100            WHEN OTHER                                                    
054200                DISPLAY '  '                                              
054300                DISPLAY ' ERROR IN INPUT FILES SOME HAVE DATA '           
054400                DISPLAY 'OTHERS ARE EMPTY, PROGRAM CANNOT PROCEED'        
054500                MOVE '1400-DETERMINE-PROCESS' TO                          
054600                                                 PV-PARAGRAPH-NAME        
054700                SET AC-INPUT-FILE-EMPTY       TO TRUE                     
054800                PERFORM 9910-ABEND                                        
054900        END-EVALUATE                                                      
055000     END-IF.                                                              
055100                                                                          
055200     IF PV-FILE-PROCESS-TYPE = 'CHG'                                      
055300        EVALUATE TRUE                                                     
055400            WHEN PS-END-OF-CNT-STAT-FILE                                  
055500             AND PS-END-OF-CNT-STUP-FILE                                  
055600             AND PS-END-OF-SKU-LOC-FILE                                   
055700             AND PS-END-OF-LOC-CNT-ST-FILE                                
055800             AND PS-END-OF-LOC-CNT-SM-FILE                                
055900                SET PS-END-OF-PROCESSING TO TRUE                          
056000            WHEN OTHER                                                    
056100                SET PS-NOT-END-OF-PROCESSING TO TRUE                      
056200        END-EVALUATE                                                      
056300     END-IF.                                                              
056400                                                                          
056500*1400-EXIT.                                                               
056600                                                                          
056700*----------------------------------------------------------               
056800*  2000-PROCESS-IC-COUNTS                                                 
056900*     THIS PARAGRAPH READS THE FILES IN A SEQUENCE AND FIRST              
057000*     WRITES THE HEADER RECORD FOLLOWED BY THE DATA RECORD.               
057100*     THE ORDER OF PROCESSING IS THE SAME FOR EACH FILE TYPE              
057200*     AND IS AS FOLLOWS                                                   
057300*     1) WRITE THE HEADER RECORD FOR STAT TYPE AND THEN                   
057400*        FORMAT THE DATA RECORDS, READ THE FILE AND WRITE THE             
057500*        FORMATTED DATA RECORDS UNTILL ALL THE RECORDS ARE WRITEN         
057600*     2) FOLLOW THE SAME STEPS FOR THE COUNT SETUP, SKU LOC,              
057700*        LOC COUNT STATUS AND LOC COUNT SUM FILES.                        
057800*----------------------------------------------------------               
057900 2000-PROCESS-IC-COUNTS.                                                  
058000                                                                          
058100     SET PS-STAT-TYP-HDR-NOT-WRITEN        TO TRUE.                       
058200     SET PS-CNT-STUP-HDR-NOT-WRITEN        TO TRUE.                       
058300     SET PS-SKU-LOC-CNT-HDR-NOT-WRITEN     TO TRUE.                       
058400     SET PS-LOC-CNT-STAT-HDR-NOT-WRITEN    TO TRUE.                       
058500     SET PS-LOC-CNT-SUM-HDR-NOT-WRITEN     TO TRUE.                       
058600                                                                          
058700     EVALUATE TRUE                                                        
058800         WHEN PV-FILE-PROCESS-TYPE = 'FUL'                                
058900            MOVE PC-FIVE-ZERO         TO PV-FIRST-BYTES                   
059000            MOVE PC-FILE-APPLY-TYPE-FUL TO PV-FILE-APPLY-TYPE             
059100         WHEN PV-FILE-PROCESS-TYPE = 'CHG'                                
059200            MOVE PC-FIVE-ZERO         TO PV-FIRST-BYTES                   
059300            MOVE PC-FILE-APPLY-TYPE-CHG TO PV-FILE-APPLY-TYPE             
059400     END-EVALUATE.                                                        
059500                                                                          
059600*PRB0064456 - IF AND END-IF COMMENTED OUT.                                
059700*    IF PV-FILE-PROCESS-TYPE = 'FUL'                                      
059800       MOVE SPACE TO PV-SAVE-PREV-LOC-NBR                                 
059900       PERFORM 2100-FORMAT-STAT-TYP-FILE                                  
060000         UNTIL PS-END-OF-CNT-STAT-FILE                                    
060100*    END-IF.                                                              
060200                                                                          
060300     MOVE SPACE TO PV-SAVE-PREV-LOC-NBR.                                  
060400     PERFORM 2200-FORMAT-CNT-STUP-FILE                                    
060500       UNTIL PS-END-OF-CNT-STUP-FILE.                                     
060600                                                                          
060700     MOVE SPACE TO PV-SAVE-PREV-LOC-NBR.                                  
060800     PERFORM 2500-FORMAT-SKU-LOC-FILE                                     
060900       UNTIL PS-END-OF-SKU-LOC-FILE.                                      
061000                                                                          
061100     MOVE SPACE TO PV-SAVE-PREV-LOC-NBR.                                  
061200     PERFORM 2700-FORMAT-LOC-CNT-ST-FILE                                  
061300       UNTIL PS-END-OF-LOC-CNT-ST-FILE.                                   
061400                                                                          
061500*** THE LOC-CNT-SM-FILE IS NOT CREATED FOR THE CHG PROCESS                
061600     IF PV-FILE-PROCESS-TYPE = 'FUL'                                      
061700       MOVE SPACE TO PV-SAVE-PREV-LOC-NBR                                 
061800       PERFORM 2800-FORMAT-LOC-CNT-SM-FILE                                
061900         UNTIL PS-END-OF-LOC-CNT-SM-FILE                                  
062000     END-IF.                                                              
062100                                                                          
062200     EVALUATE TRUE                                                        
062300       WHEN PV-FILE-PROCESS-TYPE = 'FUL'                                  
062400         EVALUATE TRUE                                                    
062500           WHEN PS-END-OF-CNT-STAT-FILE                                   
062600            AND PS-END-OF-CNT-STUP-FILE                                   
062700            AND PS-END-OF-SKU-LOC-FILE                                    
062800            AND PS-END-OF-LOC-CNT-ST-FILE                                 
062900            AND PS-END-OF-LOC-CNT-SM-FILE                                 
063000               SET PS-END-OF-PROCESSING TO TRUE                           
063100           WHEN OTHER                                                     
063200             DISPLAY '  '                                                 
063300             DISPLAY ' ERROR IN INPUT FILES SOME HAVE DATA '              
063400             DISPLAY 'OTHERS ARE EMPTY, PROGRAM CANNOT PROCEED'           
063500             MOVE '1400-DETERMINE-PROCESS' TO                             
063600                                              PV-PARAGRAPH-NAME           
063700             SET AC-INPUT-FILE-EMPTY       TO TRUE                        
063800             PERFORM 9910-ABEND                                           
063900         END-EVALUATE                                                     
063900                                                                          
064000       WHEN PV-FILE-PROCESS-TYPE = 'CHG'                                  
064100         EVALUATE TRUE                                                    
064100*PRB0064456 START                                                         
064200           WHEN PS-END-OF-CNT-STAT-FILE                                   
064100*PRB0064456 END                                                           
064300            AND PS-END-OF-CNT-STUP-FILE                                   
064400            AND PS-END-OF-SKU-LOC-FILE                                    
064500            AND PS-END-OF-LOC-CNT-ST-FILE                                 
064600               SET PS-END-OF-PROCESSING TO TRUE                           
064700           WHEN OTHER                                                     
064800             DISPLAY '  '                                                 
064900             DISPLAY ' ERROR IN INPUT FILES SOME HAVE DATA '              
065000             DISPLAY 'OTHERS ARE EMPTY, PROGRAM CANNOT PROCEED'           
065100             MOVE '1400-DETERMINE-PROCESS' TO                             
065200                                              PV-PARAGRAPH-NAME           
065300             SET AC-INPUT-FILE-EMPTY       TO TRUE                        
065400             PERFORM 9910-ABEND                                           
065500         END-EVALUATE                                                     
065600     END-EVALUATE.                                                        
065700                                                                          
065800*2000-EXIT.                                                               
065900                                                                          
066000*-------------------------------------------------------------            
066100* 2100-FORMAT-STAT-TYP-FILE.                                              
066200*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
066300*     RECORD FOR ICT_CNT_STAT_TYP TABLE.                                  
066400*-------------------------------------------------------------            
066500 2100-FORMAT-STAT-TYP-FILE.                                               
066600                                                                          
066700     IF PV-SAVE-PREV-LOC-NBR NOT = IC201-LOC-NBR                          
066800       MOVE IC201-LOC-NBR TO PV-SAVE-PREV-LOC-NBR                         
066900                             EP217-STORE-NBR                              
067000                             PV-STR-GRP-ID                                
067100       SET PS-STAT-TYP-HDR-NOT-WRITEN        TO TRUE.                     
067200     IF PS-STAT-TYP-HDR-NOT-WRITEN                                        
067300        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
067400           AND IC201-LOC-NBR EQUAL ZEROES                                 
067500           MOVE PC-STR-GRP-ID-99997      TO PV-STR-GRP-TYP-CDE            
067600        END-IF                                                            
067700        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
067800           AND IC201-LOC-NBR NOT EQUAL ZEROES                             
067900           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
068000        END-IF                                                            
068100        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
068200           AND IC201-LOC-NBR EQUAL ZEROES                                 
068300           MOVE PC-STR-GRP-ID-1000       TO PV-STR-GRP-TYP-CDE            
068400           MOVE PC-FULL-FILE-STR-ID      TO PV-STR-GRP-ID                 
068500        END-IF                                                            
068600        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
068700           AND IC201-LOC-NBR NOT EQUAL ZEROES                             
068800           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
068900        END-IF                                                            
069000        SET EP217-ICT-STAT-TYPE TO TRUE                                   
069100        PERFORM 3100-FORMAT-WRT-HEADER-REC                                
069200        SET PS-STAT-TYP-HDR-WRITEN TO TRUE                                
069300     END-IF.                                                              
069400                                                                          
069500     EVALUATE TRUE                                                        
069600         WHEN IC201-RECORD-ACTION = 'A'                                   
069700           PERFORM 2150-PROCESS-STAT-TYP-ADD                              
069800     END-EVALUATE.                                                        
069900                                                                          
070000     PERFORM 4100-WRITE-DETAIL-REC.                                       
070100                                                                          
070200     PERFORM 6000-READ-CNT-STAT-FILE.                                     
070300                                                                          
070400*2100-EXIT.                                                               
070500                                                                          
070600*-------------------------------------------------------------            
070700* 2150-PROCESS-STAT-TYP-ADD                                               
070800*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
070900*     RECORD FOR ICT_CNT_STAT_TYP TABLE.                                  
071000*-------------------------------------------------------------            
071100 2150-PROCESS-STAT-TYP-ADD.                                               
071200                                                                          
071300**-- INITIALIZE VARIABLES TO WRITE DETAIL RECORD                          
071400                                                                          
071500     SET FORM-IC-HR-LEN TO +1.                                            
071600     MOVE 0 TO PV-BYTE-COUNT.                                             
071700     INITIALIZE FORMATTED-IC-REC.                                         
071800                                                                          
071900**-- FORMAT RECORD ACTION                                                 
072000                                                                          
072100     MOVE IC201-RECORD-ACTION TO  PV-RECORD-ACTION.                       
072200     PERFORM 3200-MOVE-DELIMITER.                                         
072300     PERFORM 3600-MOVE-RECORD-ACTION.                                     
072400     PERFORM 3200-MOVE-DELIMITER.                                         
072500                                                                          
072600                                                                          
072700**-- FORMAT STATUS CODE                                                   
072800                                                                          
072900     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
073000     MOVE IC201-STAT-CDE  TO PV-VARIABLE-CHAR-FIELD.                      
073100     SET PV-CHR-EOF-IDX TO +3.                                            
073200                                                                          
073300     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
073400        FROM 1 BY 1                                                       
073500        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
073600                                                                          
073700     PERFORM 3200-MOVE-DELIMITER.                                         
073800                                                                          
073900**-- FORMAT STATUS CODE DESC                                              
074000     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
074100                                                                          
074200     EVALUATE TRUE                                                        
074300         WHEN IC201-STAT-CDE-DESC = SPACE                                 
074400             PERFORM 3300-MOVE-SPACE                                      
074500         WHEN OTHER                                                       
074600             MOVE IC201-STAT-CDE-DESC TO PV-VARIABLE-CHAR-FIELD           
074700             PERFORM 3800-FIND-DATA-END VARYING PV-CHR-EOF-IDX            
074800                FROM 30 BY -1                                             
074900                UNTIL PV-BIT-CHR-VARIABLE(PV-CHR-EOF-IDX)                 
075000                                                NOT = SPACE               
075100                                                                          
075200             PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           
075300             FROM 1 BY 1                                                  
075400              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
075500     END-EVALUATE.                                                        
075600                                                                          
075700     PERFORM 3200-MOVE-DELIMITER.                                         
075800                                                                          
075900*2150-EXIT.                                                               
076000                                                                          
076100*-------------------------------------------------------------            
076200* 2200-FORMAT-CNT-STUP-FILE.                                              
076300*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
076400*     RECORD FOR ICT_CNT_STAT_TYP TABLE.                                  
076500*-------------------------------------------------------------            
076600 2200-FORMAT-CNT-STUP-FILE.                                               
076700                                                                          
076800     IF PV-SAVE-PREV-LOC-NBR NOT = IC202-LOC-NBR                          
076900       MOVE IC202-LOC-NBR TO PV-SAVE-PREV-LOC-NBR                         
077000                             EP217-STORE-NBR                              
077100                             PV-STR-GRP-ID                                
077200       SET PS-CNT-STUP-HDR-NOT-WRITEN        TO TRUE.                     
077300                                                                          
077400     IF PS-CNT-STUP-HDR-NOT-WRITEN                                        
077500        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
077600           AND IC202-LOC-NBR EQUAL ZEROES                                 
077700           MOVE PC-STR-GRP-ID-99997      TO PV-STR-GRP-TYP-CDE            
077800        END-IF                                                            
077900        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
078000           AND IC202-LOC-NBR NOT EQUAL ZEROES                             
078100           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
078200        END-IF                                                            
078300        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
078400           AND IC202-LOC-NBR EQUAL ZEROES                                 
078500           MOVE PC-STR-GRP-ID-1000       TO PV-STR-GRP-TYP-CDE            
078600           MOVE PC-FULL-FILE-STR-ID      TO PV-STR-GRP-ID                 
078700        END-IF                                                            
078800        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
078900           AND IC202-LOC-NBR NOT EQUAL ZEROES                             
079000           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
079100        END-IF                                                            
079200        SET EP217-ICT-CNT-STUP TO TRUE                                    
079300        PERFORM 3100-FORMAT-WRT-HEADER-REC                                
079400        SET PS-CNT-STUP-HDR-WRITEN TO TRUE                                
079500     END-IF.                                                              
079600                                                                          
079700     EVALUATE TRUE                                                        
079800         WHEN IC201-RECORD-ACTION = 'A'                                   
079900           PERFORM 2250-PROCESS-CNT-STUP-ADD                              
080000     END-EVALUATE.                                                        
080100                                                                          
080200     PERFORM 4100-WRITE-DETAIL-REC.                                       
080300                                                                          
080400     PERFORM 6100-READ-CNT-STUP-FILE.                                     
080500                                                                          
080600*2200-EXIT.                                                               
080700                                                                          
080800*-------------------------------------------------------------            
080900* 2250-PROCESS-CNT-STUP-ADD                                               
081000*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
081100*     RECORD FOR ICT_CNT_STUP TABLE.                                      
081200*-------------------------------------------------------------            
081300 2250-PROCESS-CNT-STUP-ADD.                                               
081400                                                                          
081500**-- INITIALIZE VARIABLES TO WRITE DETAIL RECORD                          
081600                                                                          
081700     SET FORM-IC-HR-LEN TO +1.                                            
081800     MOVE 0 TO PV-BYTE-COUNT.                                             
081900     INITIALIZE FORMATTED-IC-REC.                                         
082000                                                                          
082100**-- FORMAT RECORD ACTION                                                 
082200                                                                          
082300     MOVE IC202-RECORD-ACTION TO  PV-RECORD-ACTION.                       
082400     PERFORM 3200-MOVE-DELIMITER.                                         
082500     PERFORM 3600-MOVE-RECORD-ACTION.                                     
082600     PERFORM 3200-MOVE-DELIMITER.                                         
082700                                                                          
082800                                                                          
082900**-- FORMAT STUP_ID                                                       
083000     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
083100     INITIALIZE PV-TALLY.                                                 
083200                                                                          
083300     EVALUATE TRUE                                                        
083400         WHEN IC202-STUP-ID = 0                                           
083500            PERFORM 3700-MOVE-ZERO                                        
083600         WHEN OTHER                                                       
083700            INSPECT IC202-STUP-ID TALLYING PV-TALLY                       
083800                FOR LEADING ZERO                                          
083900            SET PV-BIT-IDX TO PV-TALLY                                    
084000            SET PV-BIT-IDX UP BY +1                                       
084100                                                                          
084200            MOVE IC202-STUP-ID TO PV-VARIABLE-OUTPUT-FIELD                
084300                                                                          
084400            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
084500               FROM PV-BIT-IDX BY +1                                      
084600               UNTIL PV-EOF-IDX > 10                                      
084700     END-EVALUATE.                                                        
084800                                                                          
084900     PERFORM 3200-MOVE-DELIMITER.                                         
085000                                                                          
085100**-- FORMAT SUGG-EXEC-DTE                                                 
085200                                                                          
085300     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
085400     MOVE IC202-SUGG-EXEC-DTE TO PV-VARIABLE-CHAR-FIELD.                  
085500     SET PV-CHR-EOF-IDX TO +10.                                           
085600                                                                          
085700     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
085800        FROM 1 BY 1                                                       
085900        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
086000                                                                          
086100     PERFORM 3200-MOVE-DELIMITER.                                         
086200                                                                          
086300**-- FORMAT WND-STRT-DTE                                                  
086400                                                                          
086500     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
086600     MOVE IC202-WND-STRT-DTE TO PV-VARIABLE-CHAR-FIELD.                   
086700     SET PV-CHR-EOF-IDX TO +10.                                           
086800                                                                          
086900     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
087000        FROM 1 BY 1                                                       
087100        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
087200                                                                          
087300     PERFORM 3200-MOVE-DELIMITER.                                         
087400                                                                          
087500**-- FORMAT WND-END-DTE                                                   
087600                                                                          
087700     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
087800     MOVE IC202-WND-END-DTE TO PV-VARIABLE-CHAR-FIELD.                    
087900     SET PV-CHR-EOF-IDX TO +10.                                           
088000                                                                          
088100     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
088200        FROM 1 BY 1                                                       
088300        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
088400                                                                          
088500     PERFORM 3200-MOVE-DELIMITER.                                         
088600                                                                          
088700**-- FORMAT STATUS CODE DESC                                              
088800     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
088900                                                                          
089000     EVALUATE TRUE                                                        
089100         WHEN IC202-STAT-CDE-DESC = SPACE                                 
089200             PERFORM 3300-MOVE-SPACE                                      
089300         WHEN OTHER                                                       
089400             MOVE IC202-STAT-CDE-DESC TO PV-VARIABLE-CHAR-FIELD           
089500             PERFORM 3800-FIND-DATA-END VARYING PV-CHR-EOF-IDX            
089600                FROM 30 BY -1                                             
089700                UNTIL PV-BIT-CHR-VARIABLE(PV-CHR-EOF-IDX)                 
089800                                                NOT = SPACE               
089900                                                                          
090000             PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           
090100             FROM 1 BY 1                                                  
090200              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
090300     END-EVALUATE.                                                        
090400                                                                          
090500     PERFORM 3200-MOVE-DELIMITER.                                         
090600                                                                          
090700**-- FORMAT LVL-CDE                                                       
090800                                                                          
090900     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
091000     MOVE IC202-LVL-CDE TO PV-VARIABLE-CHAR-FIELD.                        
091100     SET PV-CHR-EOF-IDX TO +3.                                            
091200                                                                          
091300     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
091400        FROM 1 BY 1                                                       
091500        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
091600                                                                          
091700     PERFORM 3200-MOVE-DELIMITER.                                         
091800                                                                          
091900                                                                          
092000*2250-EXIT.                                                               
092100                                                                          
092200*-------------------------------------------------------------            
092300* 2500-FORMAT-SKU-LOC-FILE                                                
092400*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
092500*     RECORD FOR ICT_SKU_LOC_CNT TABLE.                                   
092600*-------------------------------------------------------------            
092700 2500-FORMAT-SKU-LOC-FILE.                                                
092800                                                                          
092900     IF PV-SAVE-PREV-LOC-NBR NOT = IC203-LOC-NBR                          
093000       MOVE IC203-LOC-NBR TO PV-SAVE-PREV-LOC-NBR                         
093100                             EP217-STORE-NBR                              
093200                             PV-STR-GRP-ID                                
093300       SET PS-SKU-LOC-CNT-HDR-NOT-WRITEN     TO TRUE.                     
093400                                                                          
093500     IF PS-SKU-LOC-CNT-HDR-NOT-WRITEN                                     
093600        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
093700           AND IC203-LOC-NBR EQUAL ZEROES                                 
093800           MOVE PC-STR-GRP-ID-99997      TO PV-STR-GRP-TYP-CDE            
093900        END-IF                                                            
094000        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
094100           AND IC203-LOC-NBR NOT EQUAL ZEROES                             
094200           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
094300        END-IF                                                            
094400        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
094500           AND IC203-LOC-NBR EQUAL ZEROES                                 
094600           MOVE PC-STR-GRP-ID-1000       TO PV-STR-GRP-TYP-CDE            
094700           MOVE PC-FULL-FILE-STR-ID      TO PV-STR-GRP-ID                 
094800        END-IF                                                            
094900        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
095000           AND IC203-LOC-NBR NOT EQUAL ZEROES                             
095100           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
095200        END-IF                                                            
095300        SET EP217-ICT-SKU-LOC-CNT TO TRUE                                 
095400        PERFORM 3100-FORMAT-WRT-HEADER-REC                                
095500        SET PS-SKU-LOC-CNT-HDR-WRITEN TO TRUE                             
095600     END-IF.                                                              
095700                                                                          
095800     EVALUATE TRUE                                                        
095900         WHEN IC203-RECORD-ACTION = 'A'                                   
096000           PERFORM 2550-PROCESS-SKU-LOC-ADD                               
096100     END-EVALUATE.                                                        
096200                                                                          
096300     PERFORM 4100-WRITE-DETAIL-REC.                                       
096400                                                                          
096500     PERFORM 6200-READ-SKU-LOC-CNT-FILE.                                  
096600                                                                          
096700*2500-EXIT.                                                               
096800                                                                          
096900*-------------------------------------------------------------            
097000* 2550-PROCESS-SKU-LOC-ADD                                                
097100*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
097200*     RECORD FOR ICT_CNT_STUP TABLE.                                      
097300*-------------------------------------------------------------            
097400 2550-PROCESS-SKU-LOC-ADD.                                                
097500                                                                          
097600**-- INITIALIZE VARIABLES TO WRITE DETAIL RECORD                          
097700                                                                          
097800     SET FORM-IC-HR-LEN TO +1.                                            
097900     MOVE 0 TO PV-BYTE-COUNT.                                             
098000     INITIALIZE FORMATTED-IC-REC.                                         
098100                                                                          
098200**-- FORMAT RECORD ACTION                                                 
098300                                                                          
098400     MOVE IC203-RECORD-ACTION TO  PV-RECORD-ACTION.                       
098500     PERFORM 3200-MOVE-DELIMITER.                                         
098600     PERFORM 3600-MOVE-RECORD-ACTION.                                     
098700     PERFORM 3200-MOVE-DELIMITER.                                         
098800                                                                          
098900                                                                          
099000**-- FORMAT STUP_ID                                                       
099100     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
099200     INITIALIZE PV-TALLY.                                                 
099300                                                                          
099400     EVALUATE TRUE                                                        
099500         WHEN IC203-STUP-ID = 0                                           
099600            PERFORM 3700-MOVE-ZERO                                        
099700         WHEN OTHER                                                       
099800            INSPECT IC203-STUP-ID TALLYING PV-TALLY                       
099900                FOR LEADING ZERO                                          
100000            SET PV-BIT-IDX TO PV-TALLY                                    
100100            SET PV-BIT-IDX UP BY +1                                       
100200                                                                          
100300            MOVE IC203-STUP-ID TO PV-VARIABLE-OUTPUT-FIELD                
100400                                                                          
100500            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
100600               FROM PV-BIT-IDX BY +1                                      
100700               UNTIL PV-EOF-IDX > 10                                      
100800     END-EVALUATE.                                                        
100900                                                                          
101000     PERFORM 3200-MOVE-DELIMITER.                                         
101100                                                                          
101200**-- FORMAT LOC_NBR_1                                                     
101300     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
101400     INITIALIZE PV-TALLY.                                                 
101500                                                                          
101600     EVALUATE TRUE                                                        
101700         WHEN IC203-LOC-NBR-1 = 0                                         
101800            PERFORM 3700-MOVE-ZERO                                        
101900         WHEN OTHER                                                       
102000            INSPECT IC203-LOC-NBR-1  TALLYING PV-TALLY                    
102100                FOR LEADING ZERO                                          
102200            SET PV-BIT-IDX TO PV-TALLY                                    
102300            SET PV-BIT-IDX UP BY +1                                       
102400                                                                          
102500            MOVE IC203-LOC-NBR-1 TO PV-VARIABLE-OUTPUT-FIELD              
102600                                                                          
102700            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
102800               FROM PV-BIT-IDX BY +1                                      
102900               UNTIL PV-EOF-IDX > 5                                       
103000     END-EVALUATE.                                                        
103100                                                                          
103200     PERFORM 3200-MOVE-DELIMITER.                                         
103300                                                                          
103400**-- FORMAT SKU-NBR                                                       
103500     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
103600                                                                          
103700     EVALUATE TRUE                                                        
103800         WHEN IC203-SKU-NBR = SPACE                                       
103900             PERFORM 3300-MOVE-SPACE                                      
104000         WHEN OTHER                                                       
104100             MOVE IC203-SKU-NBR TO PV-VARIABLE-CHAR-FIELD                 
104200             PERFORM 3800-FIND-DATA-END VARYING PV-CHR-EOF-IDX            
104300                FROM 08 BY -1                                             
104400                UNTIL PV-BIT-CHR-VARIABLE(PV-CHR-EOF-IDX)                 
104500                                                NOT = SPACE               
104600                                                                          
104700             PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           
104800             FROM 1 BY 1                                                  
104900              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
105000     END-EVALUATE.                                                        
105100                                                                          
105200     PERFORM 3200-MOVE-DELIMITER.                                         
105300                                                                          
105400**-- FORMAT SEQ-NBR                                                       
105500     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
105600     INITIALIZE PV-TALLY.                                                 
105700                                                                          
105800     EVALUATE TRUE                                                        
105900         WHEN IC203-SEQ-NBR = 0                                           
106000            PERFORM 3700-MOVE-ZERO                                        
106100         WHEN OTHER                                                       
106200            INSPECT IC203-SEQ-NBR TALLYING PV-TALLY                       
106300                FOR LEADING ZERO                                          
106400            SET PV-BIT-IDX TO PV-TALLY                                    
106500            SET PV-BIT-IDX UP BY +1                                       
106600                                                                          
106700            MOVE IC203-SEQ-NBR TO PV-VARIABLE-OUTPUT-FIELD                
106800                                                                          
106900            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
107000               FROM PV-BIT-IDX BY +1                                      
107100               UNTIL PV-EOF-IDX > 5                                       
107200     END-EVALUATE.                                                        
107300                                                                          
107400     PERFORM 3200-MOVE-DELIMITER.                                         
107500                                                                          
107600**-- FORMAT LOC_EXPTED_UNT_QTY SIGN                                       
107700                                                                          
107800     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
107900     MOVE IC203-EXPCTD-QTY-SGN TO PV-VARIABLE-CHAR-FIELD.                 
108000     SET PV-CHR-EOF-IDX TO +1.                                            
108100                                                                          
108200     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
108300        FROM 1 BY 1                                                       
108400        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX.                            
108500                                                                          
108600                                                                          
108700**-- FORMAT LOC_EXPTED_UNT_QTY                                            
108800     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
108900     INITIALIZE PV-TALLY.                                                 
109000                                                                          
109100     EVALUATE TRUE                                                        
109200         WHEN IC203-EXPCTD-QTY = 0                                        
109300            PERFORM 3700-MOVE-ZERO                                        
109400         WHEN OTHER                                                       
109500            INSPECT IC203-EXPCTD-QTY TALLYING PV-TALLY                    
109600                FOR LEADING ZERO                                          
109700            SET PV-BIT-IDX TO PV-TALLY                                    
109800            SET PV-BIT-IDX UP BY +1                                       
109900            MOVE IC203-EXPCTD-QTY TO PV-VARIABLE-OUTPUT-FIELD             
110000            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
110100               FROM PV-BIT-IDX BY +1                                      
110200               UNTIL PV-EOF-IDX > 4                                       
110300     END-EVALUATE.                                                        
110400                                                                          
110500     PERFORM 3200-MOVE-DELIMITER.                                         
110600                                                                          
110700**-- FORMAT SCND_UPC_NBR                                                  
110800     EVALUATE TRUE                                                        
110900*** THIS FIELD WILL ALWAYS BE MARKED AS NULL BECAUSE THE STORE            
111000*** TABLE NEEDS TO BE SET TO NULL. IF THIS DATA IS EVER DESIRED           
111100*** TO BE NOT NULL, THEN, THE JOB CREATING THE INPUT FILE WILL            
111200*** NEED TO BE CHANGED.                                                   
111300         WHEN IC203-SCND-UPC-NBR = ALL '~'                                
111400            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
111500            MOVE IC203-SCND-UPC-NBR TO PV-VARIABLE-CHAR-FIELD             
111600            SET PV-CHR-EOF-IDX TO +1                                      
111700*** THIS WILL MOVE THE FIRST POSITION ('~') WHICH IS TELLS THE            
111800*** SQL AT THE STORE THAT THIS DATA IS NULL.                              
111900            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
112000              FROM 1 BY 1                                                 
112100              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
112200*** IF ALL ZEROS, THEN, A SINGLE ZERO WILL SENT                           
112300         WHEN IC203-SCND-UPC-NBR = ALL '0'                                
112400            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
112500            MOVE IC203-SCND-UPC-NBR TO PV-VARIABLE-CHAR-FIELD             
112600            SET PV-CHR-EOF-IDX TO +1                                      
112700            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
112800              FROM 1 BY 1                                                 
112900              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
113000         WHEN OTHER                                                       
113100             MOVE IC203-SCND-UPC-NBR TO PV-VARIABLE-CHAR-FIELD            
113200             PERFORM 3800-FIND-DATA-END VARYING PV-CHR-EOF-IDX            
113300                FROM 12 BY -1                                             
113400                UNTIL PV-BIT-CHR-VARIABLE(PV-CHR-EOF-IDX)                 
113500                                                NOT = SPACE               
113600                                                                          
113700     END-EVALUATE.                                                        
113800                                                                          
113900     PERFORM 3200-MOVE-DELIMITER.                                         
114000                                                                          
114100**-- FORMAT SCND_UNT_QTY                                                  
114200     EVALUATE TRUE                                                        
114300*** THIS FIELD WILL ALWAYS BE MARKED AS NULL BECAUSE THE STORE            
114400*** TABLE NEEDS TO BE SET TO NULL. IF THIS DATA IS EVER DESIRED           
114500*** TO BE NOT NULL, THEN, THE JOB CREATING THE INPUT FILE WILL            
114600*** NEED TO BE CHANGED.                                                   
114700         WHEN IC203-SCND-UNT-QTY = ALL '~'                                
114800            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
114900            MOVE IC203-SCND-UNT-QTY TO PV-VARIABLE-CHAR-FIELD             
115000            SET PV-CHR-EOF-IDX TO +1                                      
115100*** THIS WILL MOVE THE FIRST POSITION ('~') WHICH IS TELLS THE            
115200*** SQL AT THE STORE THAT THIS DATA IS NULL.                              
115300            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
115400              FROM 1 BY 1                                                 
115500              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
115600*** IF ALL ZEROS, THEN, A SINGLE ZERO WILL SENT                           
115700         WHEN IC203-SCND-UNT-QTY = ALL '0'                                
115800            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
115900            MOVE IC203-SCND-UNT-QTY TO PV-VARIABLE-CHAR-FIELD             
116000            SET PV-CHR-EOF-IDX TO +1                                      
116100            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
116200              FROM 1 BY 1                                                 
116300              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
116400         WHEN OTHER                                                       
116500            INSPECT IC203-SCND-UNT-QTY TALLYING PV-TALLY                  
116600                FOR LEADING ZERO                                          
116700            SET PV-BIT-IDX TO PV-TALLY                                    
116800            SET PV-BIT-IDX UP BY +1                                       
116900                                                                          
117000            MOVE IC203-SCND-UNT-QTY TO PV-VARIABLE-OUTPUT-FIELD           
117100                                                                          
117200            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
117300               FROM PV-BIT-IDX BY +1                                      
117400               UNTIL PV-EOF-IDX > 4                                       
117500     END-EVALUATE.                                                        
117600                                                                          
117700     PERFORM 3200-MOVE-DELIMITER.                                         
117800                                                                          
117900     EVALUATE TRUE                                                        
118000*** THIS FIELD WILL ALWAYS BE MARKED AS NULL BECAUSE THE STORE            
118100*** TABLE NEEDS TO BE SET TO NULL. IF THIS DATA IS EVER DESIRED           
118200*** TO BE NOT NULL, THEN, THE JOB CREATING THE INPUT FILE WILL            
118300*** NEED TO BE CHANGED.                                                   
118400         WHEN IC203-EXEC-TMST = ALL '~'                                   
118500            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
118600            MOVE IC203-EXEC-TMST TO PV-VARIABLE-CHAR-FIELD                
118700            SET PV-CHR-EOF-IDX TO +1                                      
118800*** THIS WILL MOVE THE FIRST POSITION ('~') WHICH IS TELLS THE            
118900*** SQL AT THE STORE THAT THIS DATA IS NULL.                              
119000            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
119100              FROM 1 BY 1                                                 
119200              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
119300            WHEN OTHER                                                    
119400             MOVE IC203-EXEC-TMST TO PV-VARIABLE-CHAR-FIELD               
119500             PERFORM 3800-FIND-DATA-END VARYING PV-CHR-EOF-IDX            
119600                FROM 26 BY -1                                             
119700                UNTIL PV-BIT-CHR-VARIABLE(PV-CHR-EOF-IDX)                 
119800                                                NOT = SPACE               
119900                                                                          
120000     END-EVALUATE.                                                        
120100                                                                          
120200     PERFORM 3200-MOVE-DELIMITER.                                         
120300*2550-EXIT.                                                               
120400                                                                          
120500*-------------------------------------------------------------            
120600* 2700-FORMAT-LOC-CNT-ST-FILE                                             
120700*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
120800*     RECORD FOR ICT_SKU_LOC_CNT TABLE.                                   
120900*-------------------------------------------------------------            
121000 2700-FORMAT-LOC-CNT-ST-FILE.                                             
121100                                                                          
121200     IF PV-SAVE-PREV-LOC-NBR NOT = IC204-LOC-NBR                          
121300       MOVE IC204-LOC-NBR TO PV-SAVE-PREV-LOC-NBR                         
121400                             EP217-STORE-NBR                              
121500                             PV-STR-GRP-ID                                
121600       SET PS-LOC-CNT-STAT-HDR-NOT-WRITEN    TO TRUE.                     
121700                                                                          
121800     IF PS-LOC-CNT-STAT-HDR-NOT-WRITEN                                    
121900        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
122000           AND IC204-LOC-NBR EQUAL ZEROES                                 
122100           MOVE PC-STR-GRP-ID-99997      TO PV-STR-GRP-TYP-CDE            
122200        END-IF                                                            
122300        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
122400           AND IC204-LOC-NBR NOT EQUAL ZEROES                             
122500           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
122600        END-IF                                                            
122700        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
122800           AND IC204-LOC-NBR EQUAL ZEROES                                 
122900           MOVE PC-STR-GRP-ID-1000       TO PV-STR-GRP-TYP-CDE            
123000           MOVE PC-FULL-FILE-STR-ID      TO PV-STR-GRP-ID                 
123100        END-IF                                                            
123200        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
123300           AND IC204-LOC-NBR NOT EQUAL ZEROES                             
123400           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
123500        END-IF                                                            
123600        SET EP217-ICT-LOC-CNT-STAT TO TRUE                                
123700        PERFORM 3100-FORMAT-WRT-HEADER-REC                                
123800        SET PS-LOC-CNT-STAT-HDR-WRITEN TO TRUE                            
123900     END-IF.                                                              
124000                                                                          
124100     EVALUATE TRUE                                                        
124200         WHEN IC204-RECORD-ACTION = 'A'                                   
124300           PERFORM 2750-PROCESS-LOC-CNT-ST-ADD                            
124400     END-EVALUATE.                                                        
124500                                                                          
124600     PERFORM 4100-WRITE-DETAIL-REC.                                       
124700                                                                          
124800     PERFORM 6300-READ-LOC-CNT-ST-FILE.                                   
124900                                                                          
125000*2700-EXIT.                                                               
125100                                                                          
125200*-------------------------------------------------------------            
125300* 2750-PROCESS-LOC-CNT-ST-ADD                                             
125400*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
125500*     RECORD FOR ICT_LOC_CNT_STAT TABLE.                                  
125600*-------------------------------------------------------------            
125700 2750-PROCESS-LOC-CNT-ST-ADD.                                             
125800                                                                          
125900**-- INITIALIZE VARIABLES TO WRITE DETAIL RECORD                          
126000                                                                          
126100     SET FORM-IC-HR-LEN TO +1.                                            
126200     MOVE 0 TO PV-BYTE-COUNT.                                             
126300     INITIALIZE FORMATTED-IC-REC.                                         
126400                                                                          
126500**-- FORMAT RECORD ACTION                                                 
126600                                                                          
126700     MOVE IC204-RECORD-ACTION TO  PV-RECORD-ACTION.                       
126800     PERFORM 3200-MOVE-DELIMITER.                                         
126900     PERFORM 3600-MOVE-RECORD-ACTION.                                     
127000     PERFORM 3200-MOVE-DELIMITER.                                         
127100                                                                          
127200                                                                          
127300**-- FORMAT STUP_ID                                                       
127400     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
127500     INITIALIZE PV-TALLY.                                                 
127600                                                                          
127700     EVALUATE TRUE                                                        
127800         WHEN IC204-STUP-ID = 0                                           
127900            PERFORM 3700-MOVE-ZERO                                        
128000         WHEN OTHER                                                       
128100            INSPECT IC204-STUP-ID TALLYING PV-TALLY                       
128200                FOR LEADING ZERO                                          
128300            SET PV-BIT-IDX TO PV-TALLY                                    
128400            SET PV-BIT-IDX UP BY +1                                       
128500                                                                          
128600            MOVE IC204-STUP-ID TO PV-VARIABLE-OUTPUT-FIELD                
128700                                                                          
128800            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
128900               FROM PV-BIT-IDX BY +1                                      
129000               UNTIL PV-EOF-IDX > 10                                      
129100     END-EVALUATE.                                                        
129200                                                                          
129300     PERFORM 3200-MOVE-DELIMITER.                                         
129400                                                                          
129500**-- FORMAT STAT-CODE                                                     
129600                                                                          
129700     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
129800     MOVE IC204-STAT-CDE  TO PV-VARIABLE-CHAR-FIELD.                      
129900     SET PV-CHR-EOF-IDX TO +3.                                            
130000                                                                          
130100     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
130200        FROM 1 BY 1                                                       
130300        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
130400                                                                          
130500     PERFORM 3200-MOVE-DELIMITER.                                         
130600                                                                          
130700**-- FORMAT SEQ-NBR                                                       
130800     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
130900     INITIALIZE PV-TALLY.                                                 
131000                                                                          
131100     EVALUATE TRUE                                                        
131200         WHEN IC204-SEQ-NBR = 0                                           
131300            PERFORM 3700-MOVE-ZERO                                        
131400         WHEN OTHER                                                       
131500            INSPECT IC204-SEQ-NBR TALLYING PV-TALLY                       
131600                FOR LEADING ZERO                                          
131700            SET PV-BIT-IDX TO PV-TALLY                                    
131800            SET PV-BIT-IDX UP BY +1                                       
131900                                                                          
132000            MOVE IC204-SEQ-NBR TO PV-VARIABLE-OUTPUT-FIELD                
132100                                                                          
132200            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
132300               FROM PV-BIT-IDX BY +1                                      
132400               UNTIL PV-EOF-IDX > 5                                       
132500     END-EVALUATE.                                                        
132600                                                                          
132700     PERFORM 3200-MOVE-DELIMITER.                                         
132800                                                                          
132900**-- FORMAT LAST-UPD-TMST                                                 
133000                                                                          
133100     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
133200     MOVE IC204-LAST-UPD-TMST TO PV-VARIABLE-CHAR-FIELD.                  
133300     SET PV-CHR-EOF-IDX TO +26.                                           
133400                                                                          
133500     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
133600        FROM 1 BY 1                                                       
133700        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
133800                                                                          
133900     PERFORM 3200-MOVE-DELIMITER.                                         
134000                                                                          
134100**-- FORMAT USER-ID                                                       
134200     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
134300                                                                          
134400     EVALUATE TRUE                                                        
134500         WHEN IC204-USER-ID = SPACE                                       
134600             PERFORM 3300-MOVE-SPACE                                      
134700         WHEN OTHER                                                       
134800             MOVE IC204-USER-ID TO PV-VARIABLE-CHAR-FIELD                 
134900             PERFORM 3800-FIND-DATA-END VARYING PV-CHR-EOF-IDX            
135000                FROM 8 BY -1                                              
135100                UNTIL PV-BIT-CHR-VARIABLE(PV-CHR-EOF-IDX)                 
135200                                                NOT = SPACE               
135300                                                                          
135400             PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           
135500             FROM 1 BY 1                                                  
135600              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
135700     END-EVALUATE.                                                        
135800                                                                          
135900     PERFORM 3200-MOVE-DELIMITER.                                         
136000                                                                          
136100**-- FORMAT ACT-CDE                                                       
136200                                                                          
136300     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
136400     MOVE IC204-ACT-CDE TO PV-VARIABLE-CHAR-FIELD.                        
136500     SET PV-CHR-EOF-IDX TO +1.                                            
136600                                                                          
136700     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
136800        FROM 1 BY 1                                                       
136900        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
137000                                                                          
137100     PERFORM 3200-MOVE-DELIMITER.                                         
137200                                                                          
137300**-- FORMAT DAT_EXTR_IND                                                  
137400**-- THIS FIELD DOES NOT EXIST ON THE ICT_LOC_CNT_STAT TABLE, SO          
137500**-- THE EXTRACT ALWAYS SETS THIS TO NULL ('~').                          
137600                                                                          
137700     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
137800     MOVE IC204-DAT-EXTR-IND TO PV-VARIABLE-CHAR-FIELD.                   
137900     SET PV-CHR-EOF-IDX TO +1.                                            
138000                                                                          
138100     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
138200        FROM 1 BY 1                                                       
138300        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
138400                                                                          
138500     PERFORM 3200-MOVE-DELIMITER.                                         
138600                                                                          
138700                                                                          
138800*2750-EXIT.                                                               
138900                                                                          
139000*-------------------------------------------------------------            
139100* 2800-FORMAT-LOC-CNT-SM-FILE                                             
139200*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
139300*     RECORD FOR ICT_SKU_LOC_CNT TABLE.                                   
139400*-------------------------------------------------------------            
139500 2800-FORMAT-LOC-CNT-SM-FILE.                                             
139600                                                                          
139700     IF PV-SAVE-PREV-LOC-NBR NOT = IC205-LOC-NBR                          
139800       MOVE IC205-LOC-NBR TO PV-SAVE-PREV-LOC-NBR                         
139900                             EP217-STORE-NBR                              
140000                             PV-STR-GRP-ID                                
140100       SET PS-LOC-CNT-SUM-HDR-NOT-WRITEN     TO TRUE.                     
140200                                                                          
140300     IF PS-LOC-CNT-SUM-HDR-NOT-WRITEN                                     
140400        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
140500           AND IC205-LOC-NBR EQUAL ZEROES                                 
140600           MOVE PC-STR-GRP-ID-99997      TO PV-STR-GRP-TYP-CDE            
140700        END-IF                                                            
140800        IF PV-FILE-PROCESS-TYPE = 'FUL'                                   
140900           AND IC205-LOC-NBR NOT EQUAL ZEROES                             
141000           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
141100        END-IF                                                            
141200        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
141300           AND IC205-LOC-NBR EQUAL ZEROES                                 
141400           MOVE PC-STR-GRP-ID-99997      TO PV-STR-GRP-TYP-CDE            
141500        END-IF                                                            
141600        IF PV-FILE-PROCESS-TYPE = 'CHG'                                   
141700           AND IC205-LOC-NBR NOT EQUAL ZEROES                             
141800           MOVE PC-STR-GRP-ID-5000       TO PV-STR-GRP-TYP-CDE            
141900        END-IF                                                            
142000        SET EP217-ICT-LOC-CNT-SUM TO TRUE                                 
142100        PERFORM 3100-FORMAT-WRT-HEADER-REC                                
142200        SET PS-LOC-CNT-SUM-HDR-WRITEN TO TRUE                             
142300     END-IF.                                                              
142400                                                                          
142500     EVALUATE TRUE                                                        
142600         WHEN IC205-RECORD-ACTION = 'A'                                   
142700           PERFORM 2850-PROCESS-LOC-CNT-SM-ADD                            
142800     END-EVALUATE.                                                        
142900                                                                          
143000     PERFORM 4100-WRITE-DETAIL-REC.                                       
143100                                                                          
143200     PERFORM 6400-READ-LOC-CNT-SM-FILE.                                   
143300                                                                          
143400*2800-EXIT.                                                               
143500                                                                          
143600*-------------------------------------------------------------            
143700* 2850-PROCESS-LOC-CNT-SM-ADD                                             
143800*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
143900*     RECORD FOR ICT_LOC_CNT_SUM TABLE.                                   
144000*-------------------------------------------------------------            
144100 2850-PROCESS-LOC-CNT-SM-ADD.                                             
144200                                                                          
144300**-- INITIALIZE VARIABLES TO WRITE DETAIL RECORD                          
144400                                                                          
144500     SET FORM-IC-HR-LEN TO +1.                                            
144600     MOVE 0 TO PV-BYTE-COUNT.                                             
144700     INITIALIZE FORMATTED-IC-REC.                                         
144800                                                                          
144900**-- FORMAT RECORD ACTION                                                 
145000                                                                          
145100     MOVE IC205-RECORD-ACTION TO  PV-RECORD-ACTION.                       
145200     PERFORM 3200-MOVE-DELIMITER.                                         
145300     PERFORM 3600-MOVE-RECORD-ACTION.                                     
145400     PERFORM 3200-MOVE-DELIMITER.                                         
145500                                                                          
145600                                                                          
145700**-- FORMAT STUP_ID                                                       
145800     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
145900     INITIALIZE PV-TALLY.                                                 
146000                                                                          
146100     EVALUATE TRUE                                                        
146200         WHEN IC205-STUP-ID = 0                                           
146300            PERFORM 3700-MOVE-ZERO                                        
146400         WHEN OTHER                                                       
146500            INSPECT IC205-STUP-ID TALLYING PV-TALLY                       
146600                FOR LEADING ZERO                                          
146700            SET PV-BIT-IDX TO PV-TALLY                                    
146800            SET PV-BIT-IDX UP BY +1                                       
146900                                                                          
147000            MOVE IC205-STUP-ID TO PV-VARIABLE-OUTPUT-FIELD                
147100                                                                          
147200            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
147300               FROM PV-BIT-IDX BY +1                                      
147400               UNTIL PV-EOF-IDX > 10                                      
147500     END-EVALUATE.                                                        
147600                                                                          
147700     PERFORM 3200-MOVE-DELIMITER.                                         
147800                                                                          
147900**-- FORMAT SEQ-NBR                                                       
148000     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
148100     INITIALIZE PV-TALLY.                                                 
148200                                                                          
148300     EVALUATE TRUE                                                        
148400         WHEN IC205-SEQ-NBR = 0                                           
148500            PERFORM 3700-MOVE-ZERO                                        
148600         WHEN OTHER                                                       
148700            INSPECT IC205-SEQ-NBR TALLYING PV-TALLY                       
148800                FOR LEADING ZERO                                          
148900            SET PV-BIT-IDX TO PV-TALLY                                    
149000            SET PV-BIT-IDX UP BY +1                                       
149100                                                                          
149200            MOVE IC205-SEQ-NBR TO PV-VARIABLE-OUTPUT-FIELD                
149300                                                                          
149400            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
149500               FROM PV-BIT-IDX BY +1                                      
149600               UNTIL PV-EOF-IDX > 5                                       
149700     END-EVALUATE.                                                        
149800                                                                          
149900     PERFORM 3200-MOVE-DELIMITER.                                         
150000                                                                          
150100**-- FORMAT LAST-UPD-TMST                                                 
150200                                                                          
150300     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
150400     MOVE IC205-LAST-UPD-TMST TO PV-VARIABLE-CHAR-FIELD.                  
150500     SET PV-CHR-EOF-IDX TO +26.                                           
150600                                                                          
150700     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
150800        FROM 1 BY 1                                                       
150900        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
151000                                                                          
151100     PERFORM 3200-MOVE-DELIMITER.                                         
151200                                                                          
151300**-- FORMAT EXP-UNT-QTY                                                   
151400     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
151500                                                                          
151600     EVALUATE TRUE                                                        
151700         WHEN IC205-EXP-UNT-QTY = SPACE                                   
151800             PERFORM 3300-MOVE-SPACE                                      
151900         WHEN OTHER                                                       
152000             MOVE IC205-EXP-UNT-QTY TO PV-VARIABLE-CHAR-FIELD             
152100             PERFORM 3800-FIND-DATA-END VARYING PV-CHR-EOF-IDX            
152200                FROM 4 BY -1                                              
152300                UNTIL PV-BIT-CHR-VARIABLE(PV-CHR-EOF-IDX)                 
152400                                                NOT = SPACE               
152500                                                                          
152600             PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           
152700             FROM 1 BY 1                                                  
152800              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
152900     END-EVALUATE.                                                        
153000                                                                          
153100     PERFORM 3200-MOVE-DELIMITER.                                         
153200                                                                          
153300**-- FORMAT KYD-UNT-QTY                                                   
153400                                                                          
153500     INITIALIZE PV-VARIABLE-CHAR-FIELD.                                   
153600     MOVE IC205-KYD-UNT-QTY TO PV-VARIABLE-CHAR-FIELD.                    
153700     SET PV-CHR-EOF-IDX TO +2.                                            
153800                                                                          
153900     PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX                   
154000        FROM 1 BY 1                                                       
154100        UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                             
154200                                                                          
154300     PERFORM 3200-MOVE-DELIMITER.                                         
154400                                                                          
154500**-- FORMAT DEPT-NBR                                                      
154600     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
154700     INITIALIZE PV-TALLY.                                                 
154800                                                                          
154900     EVALUATE TRUE                                                        
155000*** THIS INDICATES THAT THIS FIELD WAS NULL ON TABLE                      
155100         WHEN IC205-DEPT-NBR = '~~~~'                                     
155200            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
155300            MOVE IC205-DEPT-NBR TO PV-VARIABLE-CHAR-FIELD                 
155400            SET PV-CHR-EOF-IDX TO +1                                      
155500*** THIS WILL MOVE THE FIRST POSITION ('~') WHICH IS TELLS THE            
155600*** SQL AT THE STORE THAT THIS DATA IS NULL.                              
155700            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
155800              FROM 1 BY 1                                                 
155900              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
156000            WHEN OTHER                                                    
156100            INSPECT IC205-DEPT-NBR TALLYING PV-TALLY                      
156200                FOR LEADING ZERO                                          
156300            SET PV-BIT-IDX TO PV-TALLY                                    
156400            SET PV-BIT-IDX UP BY +1                                       
156500                                                                          
156600            MOVE IC205-DEPT-NBR TO PV-VARIABLE-OUTPUT-FIELD               
156700                                                                          
156800            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
156900               FROM PV-BIT-IDX BY +1                                      
157000               UNTIL PV-EOF-IDX > 4                                       
157100     END-EVALUATE.                                                        
157200                                                                          
157300     PERFORM 3200-MOVE-DELIMITER.                                         
157400                                                                          
157500**-- FORMAT MAJ-CLS-CDE                                                   
157600     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
157700     INITIALIZE PV-TALLY.                                                 
157800                                                                          
157900     EVALUATE TRUE                                                        
158000*** THIS INDICATES THAT THIS FIELD WAS NULL ON TABLE                      
158100         WHEN IC205-MAJ-CLS-CDE = '~~~~'                                  
158200            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
158300            MOVE IC205-MAJ-CLS-CDE TO PV-VARIABLE-CHAR-FIELD              
158400            SET PV-CHR-EOF-IDX TO +1                                      
158500*** THIS WILL MOVE THE FIRST POSITION ('~') WHICH IS TELLS THE            
158600*** SQL AT THE STORE THAT THIS DATA IS NULL.                              
158700            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
158800              FROM 1 BY 1                                                 
158900              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
159000            WHEN OTHER                                                    
159100            INSPECT IC205-MAJ-CLS-CDE TALLYING PV-TALLY                   
159200                FOR LEADING ZERO                                          
159300            SET PV-BIT-IDX TO PV-TALLY                                    
159400            SET PV-BIT-IDX UP BY +1                                       
159500                                                                          
159600            MOVE IC205-MAJ-CLS-CDE TO PV-VARIABLE-OUTPUT-FIELD            
159700                                                                          
159800            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
159900               FROM PV-BIT-IDX BY +1                                      
160000               UNTIL PV-EOF-IDX > 4                                       
160100     END-EVALUATE.                                                        
160200                                                                          
160300     PERFORM 3200-MOVE-DELIMITER.                                         
160400                                                                          
160500**-- FORMAT SUB-CLS-CDE                                                   
160600     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
160700     INITIALIZE PV-TALLY.                                                 
160800                                                                          
160900     EVALUATE TRUE                                                        
161000*** THIS INDICATES THAT THIS FIELD WAS NULL ON TABLE                      
161100         WHEN IC205-SUB-CLS-CDE = '~~~~'                                  
161200            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
161300            MOVE IC205-SUB-CLS-CDE TO PV-VARIABLE-CHAR-FIELD              
161400            SET PV-CHR-EOF-IDX TO +1                                      
161500*** THIS WILL MOVE THE FIRST POSITION ('~') WHICH IS TELLS THE            
161600*** SQL AT THE STORE THAT THIS DATA IS NULL.                              
161700            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
161800              FROM 1 BY 1                                                 
161900              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
162000            WHEN OTHER                                                    
162100            INSPECT IC205-SUB-CLS-CDE TALLYING PV-TALLY                   
162200                FOR LEADING ZERO                                          
162300            SET PV-BIT-IDX TO PV-TALLY                                    
162400            SET PV-BIT-IDX UP BY +1                                       
162500                                                                          
162600            MOVE IC205-SUB-CLS-CDE TO PV-VARIABLE-OUTPUT-FIELD            
162700                                                                          
162800            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
162900               FROM PV-BIT-IDX BY +1                                      
163000               UNTIL PV-EOF-IDX > 4                                       
163100     END-EVALUATE.                                                        
163200                                                                          
163300     PERFORM 3200-MOVE-DELIMITER.                                         
163400                                                                          
163500**-- FORMAT STYLE-ID                                                      
163600     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                                 
163700     INITIALIZE PV-TALLY.                                                 
163800                                                                          
163900     EVALUATE TRUE                                                        
164000*** THIS INDICATES THAT THIS FIELD WAS NULL ON TABLE                      
164100         WHEN IC205-STYLE-ID = '~~~~~~~~'                                 
164200            INITIALIZE PV-VARIABLE-CHAR-FIELD                             
164300            MOVE IC205-STYLE-ID TO PV-VARIABLE-CHAR-FIELD                 
164400            SET PV-CHR-EOF-IDX TO +1                                      
164500*** THIS WILL MOVE THE FIRST POSITION ('~') WHICH IS TELLS THE            
164600*** SQL AT THE STORE THAT THIS DATA IS NULL.                              
164700            PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX            
164800              FROM 1 BY 1                                                 
164900              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                       
165000            WHEN OTHER                                                    
165100            INSPECT IC205-STYLE-ID TALLYING PV-TALLY                      
165200                FOR LEADING ZERO                                          
165300            SET PV-BIT-IDX TO PV-TALLY                                    
165400            SET PV-BIT-IDX UP BY +1                                       
165500                                                                          
165600            MOVE IC205-STYLE-ID TO PV-VARIABLE-OUTPUT-FIELD               
165700                                                                          
165800            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX             
165900               FROM PV-BIT-IDX BY +1                                      
166000               UNTIL PV-EOF-IDX > 8                                       
166100     END-EVALUATE.                                                        
166200                                                                          
166300     PERFORM 3200-MOVE-DELIMITER.                                         
166400                                                                          
166500                                                                          
166600*2850-EXIT.                                                               
166700                                                                          
166800*-------------------------------------------------------------            
166900* 3100-FORMAT-WRT-HEADER-REC.                                             
167000*     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA           
167100*     RECORD FOR XST_VND_STYL_STR TABLE.                                  
167200*-------------------------------------------------------------            
167300 3100-FORMAT-WRT-HEADER-REC.                                              
167400                                                                          
167500     MOVE PC-HDR-IND             TO EP217-HDR-INDICATOR.                  
167600     MOVE PV-STR-GRP-TYP-CDE     TO EP217-STR-GRP-TYP.                    
167700     MOVE PV-STR-GRP-ID-GRP      TO EP217-STR-GRP-ID.                     
167800     MOVE PC-FIVE-ZERO           TO EP217-EXCO-STR-NBR.                   
167900     MOVE PV-FORMAT-HDR-DIST-DTE TO EP217-FILE-DIST-DATE.                 
168000     MOVE PV-FILE-APPLY-TYPE     TO EP217-FILE-TYPE-APPLY.                
168100     SET EP217-FILE-ICT          TO TRUE.                                 
168200     MOVE PV-FILE-PROCESS-TYPE   TO EP217-FILE-NAME-TYPE.                 
168300     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-1.                   
168400     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-2.                   
168500     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-3.                   
168600     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-4.                   
168700     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-5.                   
168800     MOVE PV-HEADER-TMST         TO EP217-CRT-TIMESTAMP.                  
168900                                                                          
169000     PERFORM 4000-WRITE-HEADER-REC.                                       
169100                                                                          
169200*3100-EXIT.                                                               
169300                                                                          
169400*-----------------------------------------------------------------        
169500* 3200-MOVE-DELIMITER                                                     
169600*  THIS PARAGRAPH WILL MOVE '|' TO THE OUTPUT FILE VARIABLE               
169700*----------------------------------------------------------------*        
169800 3200-MOVE-DELIMITER.                                                     
169900                                                                          
170000     MOVE PC-CSV-DELIMITER                                                
170100       TO FORM-IC-HR-FLD(FORM-IC-HR-LEN).                                 
170200     SET FORM-IC-HR-LEN                                                   
170300       UP BY +1.                                                          
170400     ADD 1                                                                
170500       TO PV-BYTE-COUNT.                                                  
170600                                                                          
170700*3200-EXIT.                                                               
170800                                                                          
170900*-----------------------------------------------------------------        
171000* 3300-MOVE-SPACE                                                         
171100*  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE               
171200*----------------------------------------------------------------*        
171300 3300-MOVE-SPACE.                                                         
171400                                                                          
171500     MOVE PC-ONE-SPACE                                                    
171600       TO FORM-IC-HR-FLD(FORM-IC-HR-LEN).                                 
171700     SET FORM-IC-HR-LEN                                                   
171800       UP BY +1.                                                          
171900     ADD 1                                                                
172000       TO PV-BYTE-COUNT.                                                  
172100                                                                          
172200*3300-EXIT.                                                               
172300                                                                          
172400*-----------------------------------------------------------------        
172500* 3400-MOVE-NUMERIC-DATA                                                  
172600*  THIS PARAGRAPH WILL NUMERIC DATA TO THE OUTPUT FILE VARIABLE           
172700*----------------------------------------------------------------*        
172800 3400-MOVE-NUMERIC-DATA.                                                  
172900                                                                          
173000     MOVE PV-BIT-VARIABLE(PV-EOF-IDX)                                     
173100       TO FORM-IC-HR-FLD(FORM-IC-HR-LEN).                                 
173200     SET FORM-IC-HR-LEN                                                   
173300       UP BY +1.                                                          
173400     ADD 1                                                                
173500       TO PV-BYTE-COUNT.                                                  
173600                                                                          
173700*3400-EXIT.                                                               
173800                                                                          
173900*-----------------------------------------------------------------        
174000* 3500-MOVE-CHAR-DATA                                                     
174100*  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE               
174200*----------------------------------------------------------------*        
174300 3500-MOVE-CHAR-DATA.                                                     
174400                                                                          
174500     MOVE PV-BIT-CHR-VARIABLE(PV-CHR-BIT-IDX)                             
174600       TO FORM-IC-HR-FLD(FORM-IC-HR-LEN).                                 
174700     SET FORM-IC-HR-LEN                                                   
174800       UP BY +1.                                                          
174900     ADD 1                                                                
175000       TO PV-BYTE-COUNT.                                                  
175100                                                                          
175200*3500-EXIT.                                                               
175300*-----------------------------------------------------------------        
175400* 3600-MOVE-RECORD-ACTION                                                 
175500*  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE               
175600*----------------------------------------------------------------*        
175700 3600-MOVE-RECORD-ACTION.                                                 
175800                                                                          
175900     MOVE PV-RECORD-ACTION                                                
176000       TO FORM-IC-HR-FLD(FORM-IC-HR-LEN).                                 
176100     SET FORM-IC-HR-LEN                                                   
176200       UP BY +1.                                                          
176300     ADD 1                                                                
176400       TO PV-BYTE-COUNT.                                                  
176500                                                                          
176600*3600-EXIT.                                                               
176700                                                                          
176800*-----------------------------------------------------------------        
176900* 3700-MOVE-ZERO                                                          
177000*  THIS PARAGRAPH WILL MOVE '0' TO THE OUTPUT FILE VARIABLE               
177100*----------------------------------------------------------------*        
177200 3700-MOVE-ZERO.                                                          
177300                                                                          
177400     MOVE PC-ONE-ZERO                                                     
177500       TO FORM-IC-HR-FLD(FORM-IC-HR-LEN).                                 
177600     SET FORM-IC-HR-LEN                                                   
177700       UP BY +1.                                                          
177800     ADD 1                                                                
177900       TO PV-BYTE-COUNT.                                                  
178000                                                                          
178100*3700-EXIT.                                                               
178200                                                                          
178300*-------------------------------------------------------------            
178400* 3800-FIND-DATA-END.                                                     
178500*  THIS PARAGRAPH IS USED IN A LOOP TO DETERMINE THE LENGTH OF            
178600*  THE STRING.                                                            
178700*-------------------------------------------------------------            
178800 3800-FIND-DATA-END.                                                      
178900                                                                          
179000     MOVE ' '                                                             
179100       TO PV-SPACE.                                                       
179200                                                                          
179300*3800-EXIT.                                                               
179400                                                                          
179500*-------------------------------------------------------------            
179600* 4000-WRITE-HEADER-REC.                                                  
179700*     FORMAT AND WRITE THE HEADER RECORD.                                 
179800*-------------------------------------------------------------            
179900 4000-WRITE-HEADER-REC.                                                   
180000                                                                          
180100     PERFORM 5000-INCR-HEADER-TIMESTAMP.                                  
180200                                                                          
180300     MOVE 64                                                              
180400       TO PV-BYTE-COUNT.                                                  
180500     WRITE FORMATTED-IC-REC                                               
180600       FROM EP217-HEADER-RECORD.                                          
180700                                                                          
180800     ADD 1 TO PV-HDR-REC-WRITEN.                                          
180900                                                                          
181000*4000-EXIT.                                                               
181100                                                                          
181200                                                                          
181300*-------------------------------------------------------------            
181400* 4100-WRITE-DETAIL-REC.                                                  
181500*    WRITE THE FORMATTED DETAIL RECORD.                                   
181600*-------------------------------------------------------------            
181700 4100-WRITE-DETAIL-REC.                                                   
181800                                                                          
181900     WRITE FORMATTED-IC-REC.                                              
182000                                                                          
182100     ADD 1 TO PV-DATA-REC-WRITEN.                                         
182200                                                                          
182300*4100-EXIT.                                                               
182400                                                                          
182500*-------------------------------------------------------------            
182600* 5000-INCR-HEADER-TIMESTAMP.                                             
182700*     THIS PARAGRAPH WILL INCREMENT THE TIMESTAMP BY 1 SECOND             
182800*     THIS WOULD ENSURE THE HEADER RECORDS TO BE 1 SECOND APART           
182900*     WHICH IS MID-TIER REQUIREMENT.                                      
183000*-------------------------------------------------------------            
183100 5000-INCR-HEADER-TIMESTAMP.                                              
183200                                                                          
183300     ADD 1                                                                
183400       TO PV-HEADER-SS.                                                   
183500     IF PV-HEADER-SS GREATER 59                                           
183600         MOVE ZERO                                                        
183700           TO PV-HEADER-SS                                                
183800         ADD 1                                                            
183900           TO PV-HEADER-MM                                                
184000     END-IF.                                                              
184100                                                                          
184200     IF PV-HEADER-MM GREATER 59                                           
184300         MOVE ZERO                                                        
184400           TO PV-HEADER-MM                                                
184500         ADD 1                                                            
184600           TO PV-HEADER-HH                                                
184700     END-IF.                                                              
184800                                                                          
184900     IF PV-HEADER-HH GREATER 23                                           
185000         MOVE ZERO                                                        
185100           TO PV-HEADER-HH                                                
185200         ADD 1                                                            
185300           TO PV-HEADER-DD                                                
185400     END-IF.                                                              
185500                                                                          
185600     IF PV-HEADER-MO = 01                                                 
185700       OR PV-HEADER-MO = 03                                               
185800         OR PV-HEADER-MO = 05                                             
185900           OR PV-HEADER-MO = 07                                           
186000             OR PV-HEADER-MO = 08                                         
186100               OR PV-HEADER-MO = 10                                       
186200                 OR PV-HEADER-MO = 12                                     
186300         IF PV-HEADER-DD GREATER 31                                       
186400             MOVE 1                                                       
186500               TO PV-HEADER-DD                                            
186600             ADD 1                                                        
186700               TO PV-HEADER-MO                                            
186800         END-IF                                                           
186900     ELSE                                                                 
187000         IF PV-HEADER-MO = 04                                             
187100           OR PV-HEADER-MO = 06                                           
187200             OR PV-HEADER-MO = 09                                         
187300               OR PV-HEADER-MO = 11                                       
187400             IF PV-HEADER-DD GREATER 30                                   
187500                 MOVE 1                                                   
187600                   TO PV-HEADER-DD                                        
187700                 ADD 1                                                    
187800                   TO PV-HEADER-MO                                        
187900             END-IF                                                       
188000         ELSE                                                             
188100             IF PV-HEADER-MO = 02                                         
188200                 DIVIDE PV-HEADER-YYYY BY 100                             
188300                   GIVING PV-QUOTIENT                                     
188400                     REMAINDER PV-RMDR-100                                
188500                 DIVIDE PV-HEADER-YYYY BY 4                               
188600                   GIVING PV-QUOTIENT                                     
188700                     REMAINDER PV-RMDR-4                                  
188800                 IF PV-RMDR-100 = 0                                       
188900                     IF PV-HEADER-DD GREATER 28                           
189000                         MOVE 1                                           
189100                           TO PV-HEADER-DD                                
189200                         ADD 1                                            
189300                           TO PV-HEADER-MO                                
189400                     END-IF                                               
189500                 ELSE                                                     
189600                     IF PV-RMDR-4 = 0                                     
189700                         IF PV-HEADER-DD GREATER 29                       
189800                             MOVE 1                                       
189900                               TO PV-HEADER-DD                            
190000                             ADD 1                                        
190100                               TO PV-HEADER-MO                            
190200                         END-IF                                           
190300                     ELSE                                                 
190400                         IF PV-HEADER-DD GREATER 28                       
190500                             MOVE 1                                       
190600                               TO PV-HEADER-DD                            
190700                             ADD 1                                        
190800                               TO PV-HEADER-MO                            
190900                         END-IF                                           
191000                     END-IF                                               
191100                 END-IF                                                   
191200             END-IF                                                       
191300         END-IF                                                           
191400     END-IF.                                                              
191500                                                                          
191600     IF PV-HEADER-MO GREATER 12                                           
191700         MOVE 1                                                           
191800           TO PV-HEADER-MO                                                
191900         ADD 1                                                            
192000           TO PV-HEADER-YYYY                                              
192100     END-IF.                                                              
192200                                                                          
192300*5000-EXIT.                                                               
192400                                                                          
192500*----------------------------------------------------------               
192600* 6000-READ-CNT-STAT-FILE                                                 
192700*     THIS PARAGRAPH READS DATA THE CNT-STUP-FILE (INP01)                 
192800*     INTO COPYBOOK ICRD201                                               
192900*----------------------------------------------------------               
193000 6000-READ-CNT-STAT-FILE.                                                 
193100                                                                          
193200     READ CNT-STAT-TYP-FILE                                               
193300         INTO IC201-IC-CNT-STAT-RECORD                                    
193400       AT END                                                             
193500          SET PS-END-OF-CNT-STAT-FILE TO TRUE                             
193600     END-READ.                                                            
193700                                                                          
193800     IF PS-NOT-END-OF-CNT-STAT-FILE                                       
193900        ADD +1 TO PV-CNT-STAT-READ                                        
194000        MOVE 0 TO PV-PIPE-COUNT                                           
194100        PERFORM 6050-CHECK-INP01-FOR-PIPES                                
194200     END-IF.                                                              
194300                                                                          
194400*6000-EXIT.                                                               
194500                                                                          
194600*----------------------------------------------------------               
194700* 6050-CHECK-INP01-FOR-PIPES                                              
194800*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND         
194900*     REPLACES PIPES WITH SPACE.                                          
195000*----------------------------------------------------------               
195100 6050-CHECK-INP01-FOR-PIPES.                                              
195200                                                                          
195300     INSPECT IC201-IC-CNT-STAT-RECORD                                     
195400          TALLYING PV-PIPE-COUNT FOR ALL '|'.                             
195500                                                                          
195600     IF PV-PIPE-COUNT > 0                                                 
195700        INSPECT IC201-IC-CNT-STAT-RECORD                                  
195800            REPLACING ALL '|'  BY  ' '                                    
195900        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'          
196000                ' | WITH A SPACE '                                        
196100        DISPLAY IC201-IC-CNT-STAT-RECORD                                  
196200     END-IF.                                                              
196300                                                                          
196400*6050-EXIT.                                                               
196500                                                                          
196600*----------------------------------------------------------               
196700* 6100-READ-CNT-STUP-FILE                                                 
196800*     THIS PARAGRAPH READS DATA THE CNT-STUP-FILE (INP02)                 
196900*     INTO COPYBOOK ICRD202                                               
197000*----------------------------------------------------------               
197100 6100-READ-CNT-STUP-FILE.                                                 
197200                                                                          
197300     READ CNT-STUP-FILE                                                   
197400         INTO IC202-IC-CNT-STUP-RECORD                                    
197500       AT END                                                             
197600          SET PS-END-OF-CNT-STUP-FILE TO TRUE                             
197700     END-READ.                                                            
197800                                                                          
197900     IF PS-NOT-END-OF-CNT-STUP-FILE                                       
198000        ADD +1 TO PV-CNT-STUP-READ                                        
198100        MOVE 0 TO PV-PIPE-COUNT                                           
198200        PERFORM 6150-CHECK-INP02-FOR-PIPES                                
198300     END-IF.                                                              
198400                                                                          
198500*6100-EXIT.                                                               
198600                                                                          
198700*----------------------------------------------------------               
198800* 6150-CHECK-INP02-FOR-PIPES                                              
198900*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND         
199000*     REPLACES PIPES WITH SPACE.                                          
199100*----------------------------------------------------------               
199200 6150-CHECK-INP02-FOR-PIPES.                                              
199300                                                                          
199400     INSPECT IC202-IC-CNT-STUP-RECORD                                     
199500          TALLYING PV-PIPE-COUNT FOR ALL '|'.                             
199600                                                                          
199700     IF PV-PIPE-COUNT > 0                                                 
199800        INSPECT IC202-IC-CNT-STUP-RECORD                                  
199900            REPLACING ALL '|'  BY  ' '                                    
200000        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'          
200100                ' | WITH A SPACE '                                        
200200        DISPLAY IC202-IC-CNT-STUP-RECORD                                  
200300     END-IF.                                                              
200400                                                                          
200500*6150-EXIT.                                                               
200600                                                                          
200700*----------------------------------------------------------               
200800* 6200-READ-SKU-LOC-CNT-FILE                                              
200900*     THIS PARAGRAPH READS DATA THE SKU-LOC-CNT-FILE (INP03)              
201000*     INTO COPYBOOK ICRD203                                               
201100*----------------------------------------------------------               
201200 6200-READ-SKU-LOC-CNT-FILE.                                              
201300                                                                          
201400     READ CNT-SKU-LOC-CNT-FILE                                            
201500         INTO IC203-IC-SKU-LOC-CNT-RECORD                                 
201600       AT END                                                             
201700          SET PS-END-OF-SKU-LOC-FILE TO TRUE                              
201800     END-READ.                                                            
201900                                                                          
202000     IF PS-NOT-END-OF-SKU-LOC-FILE                                        
202100        ADD +1 TO PV-SKU-LOC-READ                                         
202200        MOVE 0 TO PV-PIPE-COUNT                                           
202300        PERFORM 6250-CHECK-INP03-FOR-PIPES                                
202400     END-IF.                                                              
202500                                                                          
202600*6200-EXIT.                                                               
202700                                                                          
202800*----------------------------------------------------------               
202900* 6250-CHECK-INP03-FOR-PIPES                                              
203000*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND         
203100*     REPLACES PIPES WITH SPACE.                                          
203200*----------------------------------------------------------               
203300 6250-CHECK-INP03-FOR-PIPES.                                              
203400                                                                          
203500     INSPECT IC203-IC-SKU-LOC-CNT-RECORD                                  
203600          TALLYING PV-PIPE-COUNT FOR ALL '|'.                             
203700                                                                          
203800     IF PV-PIPE-COUNT > 0                                                 
203900        INSPECT IC203-IC-SKU-LOC-CNT-RECORD                               
204000            REPLACING ALL '|'  BY  ' '                                    
204100        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'          
204200                ' | WITH A SPACE '                                        
204300        DISPLAY IC203-IC-SKU-LOC-CNT-RECORD                               
204400     END-IF.                                                              
204500                                                                          
204600*6250-EXIT.                                                               
204700                                                                          
204800*----------------------------------------------------------               
204900* 6300-READ-LOC-CNT-ST-FILE                                               
205000*     THIS PARAGRAPH READS DATA THE LOC-CNT-ST-FILE (INP04)               
205100*     INTO COPYBOOK ICRD204                                               
205200*----------------------------------------------------------               
205300 6300-READ-LOC-CNT-ST-FILE.                                               
205400                                                                          
205500     READ CNT-LOC-CNT-STAT-FILE                                           
205600         INTO IC204-IC-LOC-CNT-STAT-RECORD                                
205700       AT END                                                             
205800          SET PS-END-OF-LOC-CNT-ST-FILE TO TRUE                           
205900     END-READ.                                                            
206000                                                                          
206100     IF PS-NOT-END-OF-LOC-CNT-ST-FILE                                     
206200        ADD +1 TO PV-LOC-CNT-STAT-READ                                    
206300        MOVE 0 TO PV-PIPE-COUNT                                           
206400        PERFORM 6350-CHECK-INP04-FOR-PIPES                                
206500     END-IF.                                                              
206600                                                                          
206700*6300-EXIT.                                                               
206800                                                                          
206900*----------------------------------------------------------               
207000* 6350-CHECK-INP04-FOR-PIPES                                              
207100*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND         
207200*     REPLACES PIPES WITH SPACE.                                          
207300*----------------------------------------------------------               
207400 6350-CHECK-INP04-FOR-PIPES.                                              
207500                                                                          
207600     INSPECT IC204-IC-LOC-CNT-STAT-RECORD                                 
207700          TALLYING PV-PIPE-COUNT FOR ALL '|'.                             
207800                                                                          
207900     IF PV-PIPE-COUNT > 0                                                 
208000        INSPECT IC204-IC-LOC-CNT-STAT-RECORD                              
208100            REPLACING ALL '|'  BY  ' '                                    
208200        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'          
208300                ' | WITH A SPACE '                                        
208400        DISPLAY IC204-IC-LOC-CNT-STAT-RECORD                              
208500     END-IF.                                                              
208600                                                                          
208700*6350-EXIT.                                                               
208800                                                                          
208900*----------------------------------------------------------               
209000* 6400-READ-LOC-CNT-SM-FILE                                               
209100*     THIS PARAGRAPH READS DATA THE LOC-CNT-SM-FILE (INP05)               
209200*     INTO COPYBOOK ICRD205                                               
209300*----------------------------------------------------------               
209400 6400-READ-LOC-CNT-SM-FILE.                                               
209500                                                                          
209600     READ CNT-LOC-CNT-SUM-FILE                                            
209700         INTO IC205-IC-LOC-CNT-SUM-RECORD                                 
209800       AT END                                                             
209900          SET PS-END-OF-LOC-CNT-SM-FILE TO TRUE                           
210000     END-READ.                                                            
210100                                                                          
210200     IF PS-NOT-END-OF-LOC-CNT-ST-FILE                                     
210300        ADD +1 TO PV-LOC-CNT-SUM-READ                                     
210400        MOVE 0 TO PV-PIPE-COUNT                                           
210500        PERFORM 6450-CHECK-INP05-FOR-PIPES                                
210600     END-IF.                                                              
210700                                                                          
210800*6400-EXIT.                                                               
210900                                                                          
211000*----------------------------------------------------------               
211100* 6450-CHECK-INP05-FOR-PIPES                                              
211200*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND         
211300*     REPLACES PIPES WITH SPACE.                                          
211400*----------------------------------------------------------               
211500 6450-CHECK-INP05-FOR-PIPES.                                              
211600                                                                          
211700     INSPECT IC205-IC-LOC-CNT-SUM-RECORD                                  
211800          TALLYING PV-PIPE-COUNT FOR ALL '|'.                             
211900                                                                          
212000     IF PV-PIPE-COUNT > 0                                                 
212100        INSPECT IC205-IC-LOC-CNT-SUM-RECORD                               
212200            REPLACING ALL '|'  BY  ' '                                    
212300        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'          
212400                ' | WITH A SPACE '                                        
212500        DISPLAY IC205-IC-LOC-CNT-SUM-RECORD                               
212600     END-IF.                                                              
212700                                                                          
212800*6450-EXIT.                                                               
212900                                                                          
213000******************************************************************        
213100*     CLOSES ALL FILES AND DISPLAYS ANY NEEDED INFORMATION.      *        
213200******************************************************************        
213300 9200-WRAPUP.                                                             
213400     MOVE '9200-WRAPUP                     ' TO PV-PARAGRAPH-NAME.        
213500                                                                          
213600     PERFORM 9920-DISPLAY-TOTALS.                                         
213700                                                                          
213800     DISPLAY '****************************************'.                  
213900     DISPLAY '**          ICKUT001 END              **'.                  
214000     DISPLAY '****************************************'.                  
214100                                                                          
214200     CLOSE CNT-STAT-TYP-FILE                                              
214300           CNT-STUP-FILE                                                  
214400           CNT-SKU-LOC-CNT-FILE                                           
214500           CNT-LOC-CNT-STAT-FILE                                          
214600           CNT-LOC-CNT-SUM-FILE                                           
214700           CC-FILE-TYPE.                                                  
214800                                                                          
214900     CLOSE FORMATTED-IC-FL.                                               
215000                                                                          
215100*9200-EXIT.  EXIT.                                                        
215200*---------------------------------------------------------                
215300* 9800-SQL-ABEND.                                                         
215400*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.        
215500*---------------------------------------------------------                
215600 9800-SQL-ABEND.                                                          
215700                                                                          
215800     SET AC-DB2-ERROR TO TRUE.                                            
215900                                                                          
216000     DISPLAY '** ABEND     **'.                                           
216100     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                        
216200     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
216300     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.                       
216400                                                                          
216500     COPY DPPD004.                                                        
216600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                                 
216700                                                                          
216800*9800-EXIT.                                                               
216900                                                                          
217000******************************************************************        
217100*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.              *           
217200******************************************************************        
217300 9910-ABEND.                                                              
217400                                                                          
217500     PERFORM 9920-DISPLAY-TOTALS.                                         
217600                                                                          
217700     DISPLAY '** ABEND           **'.                                     
217800     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.                  
217900     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.                
218000     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.               
218100     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.               
218200                                                                          
218300     CALL 'ILBOABN0' USING AC-ABEND-CODE.                                 
218400                                                                          
218500*9910-EXIT.  EXIT.                                                        
218600******************************************************************        
218700*     DISPLAY END OF JOB TOTALS                                  *        
218800******************************************************************        
218900 9920-DISPLAY-TOTALS.                                                     
219000                                                                          
219100     DISPLAY '************************************************'.          
219200     DISPLAY '** STATISTICS FOR MERCHANDISE HIERARCHY FILES **'.          
219300     DISPLAY '************************************************'.          
219400                                                                          
219500     DISPLAY '**   COUNT STAT RECORDS READ  ====> '                       
219600             PV-CNT-STAT-READ                                             
219700             ' **'.                                                       
219800     DISPLAY '**  COUNT STUP  RECORDS READ  ====> '                       
219900             PV-CNT-STUP-READ                                             
220000             ' **'.                                                       
220100     DISPLAY '**SKU LOC COUNT RECORDS READ  ====> '                       
220200             PV-SKU-LOC-READ                                              
220300             ' **'.                                                       
220400     DISPLAY '**LOC CNT  STAT RECORDS READ  ====> '                       
220500             PV-LOC-CNT-STAT-READ                                         
220600             ' **'.                                                       
220700     DISPLAY '** LOC CNT SUM  RECORDS READ  ====> '                       
220800             PV-LOC-CNT-SUM-READ                                          
220900             ' **'.                                                       
221000     DISPLAY '                                     '.                     
221100     DISPLAY '** TOTAL HEADER RECORDS WRITEN ====> '                      
221200             PV-HDR-REC-WRITEN                                            
221300             ' **'.                                                       
221400     DISPLAY '** TOTAL DATA RECORDS WRITEN   ====> '                      
221500             PV-DATA-REC-WRITEN                                           
221600             ' **'.                                                       
221700     DISPLAY '****************************************'.                  
221800                                                                          
221900*9920-EXIT.  EXIT.                                                        
222000                                                                          
