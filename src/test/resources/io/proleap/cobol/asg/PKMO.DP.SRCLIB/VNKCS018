000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400                                                                  00040000
000500 PROGRAM-ID.    VNKCS018.                                         00050000
000600 AUTHOR.        SCOTT VANG.                                       00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  12-25-95.                                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*---------------------------------------------------------------* 00110000
001200*    V018 - BUSINESS FUNCTION ADDRESS COPY PROGRAM.             * 00120000
001300*                                                               * 00130000
001400*    THIS PROGRAM GENERATES A LIST OF BUSINESS FUNCTIONS        * 00140000
001500*    THAT THE USER SELECTS TO HAVE THE FUNCTION ADDRESS COPIED  * 00150000
001600*    TO.  ONE OR MANY OF THE FUNCTIONS MAY BE SELECTED TO HAVE  * 00160000
001700*    THE ADDRESS COPIED TO.                                     * 00170000
001800*                                                               * 00180000
001900*    DATE  04/19/2001                                           * 00190000
002000*        CHANGE MADE: CHANGE VNWS014 COPYBOOK AND VNKCS018 FOR  * 00200000
002100*   WHAT IS SENT TO PEOPLESOFT AS A PRIMARY VENDOR TYPE.        * 00210000
002200*        MADE BY: L SCHALLHORN                       WR# 21278  * 00220000
002300*                                                               * 00230000
002400*   02/10/2003                                                  * 00240000
002500*      CHANGED CALL TO PEOPLESOFT TABLE TO USE NEW ALIAS        * 00250000
002600*      NAMING STANDARD.                                         * 00260000
002700*   MADE BY: L SCHALLHORN                 WR#: 23417            * 00270000
002800*                                                               * 00280000
002900*  DATE  05/27/2003                                             * 00290000
003000*      CHANGE MADE: VENDOR MULTI PRE-PACK USAGE PROJECT.  ADDED * 00300000
003100*      EDI-PO-PREPK-CDE TO CURSOR IN PARAGRAPH 7100.  INCLUDE   * 00310000
003200*      ASC-PO-PREPK-CDE IN MOVE TO VNWS013 COPYBOOK IN PARAGRAPH* 00320000
003300*      7482 AND TO VNWS007 COPYBOOK IN PARAGRAPH 7486.          * 00330000
003400*      MADE BY: KEVIN CATLIN            WR/IR #: WR24663        * 00340000
003500*                                                               * 00350000
003600*  DATE  05/27/2003                                             * 00360000
003700*      CHANGE MADE: ADDED CODE TO MOVE THE 4 NEW COLUMNS FROM   * 00370000
003800*      TEXTENT (GVRNG_IND, GVRNG_ENT_ID, CART_LBL_IND,          * 00380000
003900*      CART_LBL_EFF_DTE) TO THE RMS PO MESSAGING CODE.            00390000
004000*      MADE BY: MIKE BESKE              WR/IR #: WR25358        * 00400000
004100*                                                               * 00410000
004200*  DATE  08/27/2004                                             * 00420000
004300*      CHANGE MADE: CORRECTED LOGIC WHEN COPYING A REMIT ADDRESS* 00430000
004400*      DO NOT COPY THE EXTENDED NAME INTO PEOPLESOFT.           * 00440000
004500*      MADE BY: L SCHALLHORN            WR/IR #: P000686510     * 00450000
004600*                                                               * 00460000
004700*  DATE  04/01/2005                                             * 00470000
004800*      CHANGE MADE: ADDED 2 NEW MESSAGES, AND LOGIC IN THE      * 00480000
004900*      RETURN FROM CALLING VNKCS023 TO IDENTIFY THE FACT THAT   * 00490000
005000*      THE MAX NUMBER OF CAPABILITIES OR RELATIONSHIPS WAS      * 00500000
005100*      EXCEEDED WHEN SENDING A 'NEW VENDOR' MESSAGE TO RMS.     * 00510000
005200*      MADE BY: JACK KRAMER             WR/IR #: WR25278        * 00520000
005300*                                                               * 00530000
005400*  DATE  07/21/2005                                             * 00540000
005500*      CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.   * 00550000
005600*      RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO      * 00560000
005700*      COPYBOOK VNWS013.                                        * 00570000
005800*      MADE BY: KRYSTEN LEARY           WR/IR #: WR28651        * 00580000
005900*                                                               * 00590000
006000*  DATE  03/24/2006                                             * 00600000
006100*      CHANGE MADE: VENDOR ALLOWANCE AUTOMATION PROJECT.        * 00610000
006200*      RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO      * 00620000
006300*      COPYBOOK VNWS007 AND VNWS013.                            * 00630000
006400*      MADE BY: MIKE BESKE              WR/IR #: WR30028        * 00640000
006500*                                                               * 00650000
006600*  DATE  02/25/2008                                             * 00660000
006700*      CHANGE MADE: VENDOR MINORITY CERTIFICATIONS PROJECT.     * 00670000
006800*      RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO      * 00680000
006900*      COPYBOOK VNWS014.                                        * 00690000
007000*      MADE BY: MIKE BESKE              WR/IR #: WR33218        * 00700000
007100*                                                               * 00710000
007200* DATE  09/21/2011                                                00720030
007300*     CHANGE MADE: REMOVED DB2 SELECT OF PFI0013.                 00730010
007400*     REPLACED WITH A CALL TO THE VNKUT034 MODULE.  THIS          00740010
007500*     IS NEEDED AS A RESULT OF THE PEOPLESOFT FI UPGRADE AND      00750010
007600*     RE-PLATFORM.                                                00760010
007700*     MADE BY: STEVE KRIEG             WR/IR #: WR37038           00770010
007800*                                                                 00780010
007900*     CHANGE MADE: ADDED A CALL TO VNKUT040 TO COMMIT PS          00790030
008000*     ORACLE CHANGES.                                             00800030
008100*     MADE BY: MADHURA PETHE           WR/IR #: WR37038           00810030
008110*                                                               * 00811042
008120*  DATE  09/25/2014                                             * 00812043
008130*      CHANGE MADE:                                             * 00813043
008140*      CALLED NEW SUB-ROUTINE VNKUT054 TO DERIVE ADDITIONAL     * 00814043
008150*      VENDOR TYPES.                                            * 00815043
008160*      MADE BY: COGNIZANT               WR/IR #: CHG0099490     * 00816045
008170*  DATE  05/17/2016                                             * 00817047
008180*      CHANGE MADE:                                             * 00818048
008190*      RECOMPILE FOR VNWS014 AND VNWS054                        * 00819048
008191*      MADE BY: ACCENTURE               WR/IR #: CHG0135353     * 00819148
008192*  DATE  03/22/2019                                              *00819251
008193*   CHANGE MADE: ADDED CHECK TO NOT CALL PEOPLESOFT CALLED       *00819351
008194*   MODULES AS PART OF THE PS REPLACEMENT TO ORACLE. *            00819451
008195*   BASED ON TKRPRPM PARAMTER LOOKUP 'ERPDTE'. IF CURRENT DATE *  00819551
008196*   IS GREATER THEN PARAMATER DATE, ASC-ERP-OIC-LIVE-YES OR *     00819651
008197*   ASC-ERP-OIC-LIVE-NO WILL BE SET AND CHECKED IN THE PROGRAM *  00819751
008198*        MADE BY: GERMAN BANDA            WR/IR #: CHG0220043 *   00819851
008199*  DATE  05/18/2020                                              *00819953
008200*   CHANGE MADE: REMOVE CALLS TO VNKUT054, VNKUT040, VNKUT034.   *00820052
008205*        MADE BY: JEAN KURK               WR/IR #: CHG0243534 *   00820552
008206*  DATE  09/07/2021                                              *00820654
008207*            - CHANGE CALL OF DPKUT100 TO                       * 00820754
008208*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00820854
008209*              MAKING THE CALL DYNAMIC VS STATIC                * 00820954
008210*      MADE BY: GERMAN BANDA            WR/IR #: CHG0261091      *00821056
008206*  DATE  01/05/2023                                              *00821157
008207*            - CHANGE CALL OF DPKCS030 TO DYNAMIC               * 00821257
008210*      MADE BY: JEAN KURK               WR/IR #: CHG0277999      *00821557
008211*                                                               * 00821654
008212******************************************************************00821751
008220*---------------------------------------------------------------* 00822038
008300                                                                  00830000
008400     EJECT                                                        00840000
008500                                                                  00850000
008600 ENVIRONMENT DIVISION.                                            00860000
008700                                                                  00870000
008800 DATA DIVISION.                                                   00880000
008900                                                                  00890000
009000 WORKING-STORAGE SECTION.                                         00900000
009100                                                                  00910000
009200     EJECT                                                        00920000
009300                                                                  00930000
009400 01  DK-DB2-KEYS.                                                 00940000
009500     15  DK-ENT-ID                      PIC S9(09)  COMP.         00950000
009600     15  DK-FUNCTION-ID                 PIC S9(04)  COMP.         00960000
009700     15  DK-REP-SEQ-NBR                 PIC S9(04)  COMP.         00970000
009800     15  DK-DUNS-NUMBER                 PIC  X(09)  VALUE SPACES. 00980000
009900     15  DK-VENDOR-NAME                 PIC  X(30)  VALUE SPACES. 00990000
010000                                                                  01000000
010100     EJECT                                                        01010000
010200                                                                  01020000
010300 01  PC-PROGRAM-CONSTANTS.                                        01030000
010400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         01040000
010500                                                    'VN018A  '.   01050000
010600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         01060000
010700                                                    'VNKM018 '.   01070000
010800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         01080000
010900                                                    'VNKCS018'.   01090000
011000     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      01100000
011100     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      01110000
011200     05  PC-INTER-APPL-CODES.                                     01120000
011300         10  PC-INTER-APPL-ADD          PIC  X(01)  VALUE '1'.    01130000
011400     05  PC-REMIT-FUNCTION-ID           PIC S9(04)  VALUE +9      01140000
011500                                                    COMP.         01150000
011600     05  PC-1099-FUNCTION-ID            PIC S9(04)  VALUE +16     01160000
011700                                                    COMP.         01170000
011800     05  PC-CORP-FUNCTION-ID            PIC S9(04)  VALUE +4      01180000
011900                                                    COMP.         01190000
012000     05  PC-PO-FUNCTION-ID              PIC S9(04)  VALUE +2      01200000
012100                                                    COMP.         01210000
012200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +14     01220000
012300                                                    COMP SYNC.    01230000
012400     05  PC-NBR-OF-BUSINESS-FUNC        PIC S9(04)  VALUE +16     01240000
012500                                                    COMP SYNC.    01250000
012600     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01260000
012700                                                    COMP SYNC.    01270000
012800     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01280000
012900                                                    +1000000      01290000
013000                                                    COMP-3.       01300000
013100     05  PC-ITM-NUMBER-LENGTH           PIC S9(04)  VALUE +7      01310000
013200                                                    COMP SYNC.    01320000
013300     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       01330000
013400                                                    COMP-3.       01340000
013500     05  PC-ADD                         PIC  X(03)  VALUE 'ADD'.  01350000
013600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  01360000
013700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  01370000
013800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  01380000
013900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  01390000
014000                                                                  01400000
014200     05  PC-VNKCS023              PIC  X(08)  VALUE 'VNKCS023'.   01420000
014300     05  PC-VNKCS024              PIC  X(08)  VALUE 'VNKCS024'.   01430000
014500                                                                  01450000
014600     05  PC-TSYMSG-NUMBERS.                                       01460000
014700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01470000
014800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01480000
014900         10  PC-TSYMSG-00034            PIC  9(05)  VALUE 00034.  01490000
015000         10  PC-TSYMSG-00046            PIC  9(05)  VALUE 00046.  01500000
015100         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01510000
015200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01520000
015300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01530000
015400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01540000
015500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01550000
015600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01560000
015700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01570000
015800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01580000
015900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01590000
016000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01600000
016100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01610000
016200         10  PC-TSYMSG-00117            PIC  9(05)  VALUE 00117.  01620000
016300         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01630000
016400         10  PC-TSYMSG-00159            PIC  9(05)  VALUE 00159.  01640000
016500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01650000
016600         10  PC-TSYMSG-00398            PIC  9(05)  VALUE 00398.  01660000
016700         10  PC-TSYMSG-00487            PIC  9(05)  VALUE 00487.  01670000
016800         10  PC-TSYMSG-00499            PIC  9(05)  VALUE 00499.  01680000
016900         10  PC-TSYMSG-00500            PIC  9(05)  VALUE 00500.  01690000
017000         10  PC-TSYMSG-01884            PIC  9(05)  VALUE 01884.  01700000
017100         10  PC-TSYMSG-01887            PIC  9(05)  VALUE 01887.  01710000
017300         10  PC-TSYMSG-01889            PIC  9(05)  VALUE 01889.  01730000
017500         10  PC-TSYMSG-01891            PIC  9(05)  VALUE 01891.  01750000
017700         10  PC-TSYMSG-01893            PIC  9(05)  VALUE 01893.  01770000
017800         10  PC-TSYMSG-01894            PIC  9(05)  VALUE 01894.  01780000
017900         10  PC-TSYMSG-01895            PIC  9(05)  VALUE 01895.  01790000
018100         10  PC-TSYMSG-01957            PIC  9(05)  VALUE 01957.  01810000
018200         10  PC-TSYMSG-01958            PIC  9(05)  VALUE 01958.  01820000
018300         10  PC-TSYMSG-01966            PIC  9(05)  VALUE 01966.  01830000
018400         10  PC-TSYMSG-02623            PIC  9(05)  VALUE 02623.  01840000
018500         10  PC-TSYMSG-02645            PIC  9(05)  VALUE 02645.  01850000
018600         10  PC-TSYMSG-02646            PIC  9(05)  VALUE 02646.  01860000
018700         10  PC-TSYMSG-03380            PIC  9(05)  VALUE 03380.  01870000
018800         10  PC-TSYMSG-03381            PIC  9(05)  VALUE 03381.  01880000
018900         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01890000
019000                                                                  01900000
019100     EJECT                                                        01910000
019200                                                                  01920000
019300 01  WS-MISC-FIELDS.                                              01930000
019500     05  WS-VENDOR-SHORTNAME            PIC  X(30)  VALUE SPACES. 01950000
019700                                                                  01970000
019800 01  PS-PROGRAM-SWITCHES.                                         01980000
019900     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01990000
020000         88  PS-NO-ERROR                            VALUE 'Y'.    02000000
020100         88  PS-ERROR                               VALUE 'N'.    02010000
020200     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02020000
020300         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02030000
020400         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02040000
020500     05  PS-15-BYTE-FIRST-NAME-SW       PIC  X(01)  VALUE 'N'.    02050000
020600         88  PS-15-BYTE-FIRST-NAME                  VALUE 'Y'.    02060000
020700     05  PS-NO-FIRST-NAME-SW            PIC  X(01)  VALUE 'N'.    02070000
020800         88  PS-NO-FIRST-NAME                       VALUE 'Y'.    02080000
021500                                                                  02150000
021600     EJECT                                                        02160000
021700                                                                  02170000
021800 01  PV-PROGRAM-VARIABLES.                                        02180000
021900     05  PV-SUB                         PIC S9(04)  VALUE +0      02190000
022000                                                    COMP SYNC.    02200000
022100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02210000
022200                                                    COMP SYNC.    02220000
022300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02230000
022400                                                    COMP-3.       02240000
022500     05  PV-READ-COUNT2                 PIC S9(09)  VALUE +0      02250000
022600                                                    COMP-3.       02260000
022700     05  PV-FUNCTION-ID-HOLD            PIC S9(04)  VALUE +0      02270000
022800                                                    COMP.         02280000
022900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02290000
023000                                                    COMP-3.       02300000
023100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02310000
023200                                                    COMP-3.       02320000
023300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02330000
023400                                                    COMP-3.       02340000
023500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02350000
023600                                                    COMP-3.       02360000
023700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02370000
023800                                                    COMP-3.       02380000
023900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02390000
024000                                                    COMP-3.       02400000
024100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02410000
024200                                                    COMP SYNC.    02420000
024300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02430000
024400                                                    COMP SYNC.    02440000
024500     05  PV-ITEM                        PIC S9(04)  VALUE +0      02450000
024600                                                    COMP SYNC.    02460000
024700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02470000
024800                                                    COMP SYNC.    02480000
024900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02490000
025000                                                    COMP SYNC.    02500000
025100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02510000
025200                                                    COMP SYNC.    02520000
025300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02530000
025400                                                    COMP SYNC.    02540000
025500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02550000
025600                                                    COMP SYNC.    02560000
025700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02570000
025800                                                    COMP SYNC.    02580000
025900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02590000
026000                                                    COMP SYNC.    02600000
026100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02610000
026200                                                    COMP SYNC.    02620000
026300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02630000
026400                                                    COMP SYNC.    02640000
026500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02650000
026600                                                    COMP SYNC.    02660000
026700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02670000
026800                                                    COMP SYNC.    02680000
026900     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02690000
027000                                                    COMP SYNC.    02700000
027100     05  PV-SELECTED-ITEMS-CNT          PIC S9(04)  VALUE +0      02710000
027200                                                    COMP SYNC.    02720000
027300     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02730000
027400                                                    COMP-3.       02740000
027500     05  PV-1099-ADDRESS-CNT            PIC S9(09)  VALUE +0      02750000
027600                                                    COMP-3.       02760000
027700     05  PV-SEL-FUNC-CNT                PIC S9(02)  VALUE +0      02770000
027800                                                    COMP-3.       02780000
027900     05  PV-FUNCTION-SECURITY.                                    02790000
028000         10  PV-RESOURCE-TYPE           PIC X(01).                02800000
028100         10  FILLER                     PIC X.                    02810000
028200         10  PV-RESOURCE-NAME           PIC X(08).                02820000
028300                                                                  02830000
028400     05  PV-MAX-TBUSLOC-SEQ-NBR         PIC S9(04)  VALUE +0      02840000
028500                                                    COMP.         02850000
028600*    05  PV-MAX-PS-VND-ADDR-SEQ-NBR     PIC S9(04)  VALUE +0      02860010
028700*                                                   COMP.         02870010
029000     05  PV-NEXT-TBUSLOC-SEQ-NBR        PIC S9(04)  VALUE +0      02900000
029100                                                    COMP.         02910000
029200     05  PV-MAX-TENTREP-SEQ-NBR         PIC S9(04)  VALUE +0      02920000
029300                                                    COMP.         02930000
029400     05  PV-NEXT-TENTREP-SEQ-NBR        PIC S9(04)  VALUE +0      02940000
029500                                                    COMP.         02950000
029600     05  PV-COUNTRY-NAME                PIC  X(30)   VALUE SPACES.02960000
029700     05  PV-STATE-NAME                  PIC  X(30)   VALUE SPACES.02970000
029800     05  PV-STATE                       PIC  X(02)   VALUE SPACES.02980000
029900     05  PV-BLK-SUB                     PIC S9(04)   COMP         02990000
030000                                                     SYNC.        03000000
030300     05  PV-PRIM-ADDR-IND               PIC  X(01)   VALUE SPACES.03030000
030400     05  PV-HOLD-FUNCTION-ID            PIC  9(04)   VALUE ZEROS. 03040000
030500     05  PV-SQLDISP                     PIC  -99999.              03050017
030600     05  PV-ERROR-MESSAGE-AREA.                                   03060000
030700         10  PV-ERROR-MSG-1.                                      03070000
030800             15  FILLER                 PIC X(21)    VALUE        03080000
030900                 'UNSUCCESSFUL CALL TO '.                         03090000
031000             15  PV-ERROR-PGM-NAME      PIC X(08).                03100000
031100             15  FILLER                 PIC X(11)    VALUE        03110000
031200                 ' IN PARA:  '.                                   03120000
031300             15  PV-ERROR-PARA-NAME     PIC X(30).                03130000
031400         10  PV-ERROR-MSG-2.                                      03140000
031500             15  PV-ERROR-MESSAGE       PIC X(57).                03150000
031600         10  PV-ERROR-MSG-3.                                      03160000
031700             15  PV-ERROR-TYPE          PIC X(15).                03170000
031800             15  PV-OPTIONAL-TEXT       PIC X(10).                03180000
031900             15  PV-ERROR-REASON        PIC X(30).                03190000
032000     05  PV-INDEX-HOLD                  PIC S9(04) COMP.          03200000
032100     05  PV-NAME-AREA.                                            03210000
032200         10  PV-NAME-TABLE                                        03220000
032300             OCCURS 15 TIMES INDEXED BY PV-INDEX.                 03230000
032400             15  PV-NAME-POSITION       PIC X(01).                03240000
032500                                                                  03250000
032600     05  PV-FIRST-LAST-NAME-AREA.                                 03260000
032700         10  PV-FIRST-LAST-NAME-TABLE                             03270000
032800             OCCURS 20 TIMES INDEXED BY PV-INDEX2.                03280000
032900             15  PV-FULL-NAME-POSITION  PIC X(01).                03290000
033000                                                                  03300000
033100     EJECT                                                        03310000
033200                                                                  03320000
033300******************************************************************03330000
033400**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03340000
033500**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03350000
033600**  APPLICATION-SPECIFIC COMMAREA.                              **03360000
033700******************************************************************03370000
033800                                                                  03380000
033900 01  LQW-LIST-QUEUE-WORK-AREA.                                    03390000
034000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03400000
034100     05  LQW-ITEM-ENTRIES               OCCURS 14 TIMES           03410000
034200                                        INDEXED BY LQW-IDX.       03420000
034300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03430000
034400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03440000
034500         10  LQW-SELECTED-SW            PIC  X(01).               03450000
034600             88  LQW-SELECT                         VALUE 'S'.    03460000
034700             88  LQW-DESELECT                       VALUE ' '.    03470000
034800         10  LQW-ACTION                 PIC  X(03).               03480000
034900         10  LQW-FUNCTION-NAME          PIC  X(25).               03490000
035000         10  LQW-FUNCTION-ID            PIC S9(04)  COMP.         03500000
035100         10  LQW-ADDRESS-COUNT          PIC  9(03).               03510000
035200         10  LQW-UPDATE-FLAG            PIC  X(01).               03520000
035300                                                                  03530000
035400     EJECT                                                        03540000
035500                                                                  03550000
035600*---------------------------------------------------------------* 03560000
035700*  RECORD LAYOUT FOR THE VENDOR  SELECTION TEMP STORAGE QUEUE.  * 03570000
035800*---------------------------------------------------------------* 03580000
035900                                                                  03590000
036000                                                                  03600000
036100     COPY VNWS003.                                                03610000
036200                                                                  03620000
036300     EJECT                                                        03630000
036400                                                                  03640000
036500*---------------------------------------------------------------* 03650000
036600*    MAP LAYOUT                                                 * 03660000
036700*---------------------------------------------------------------* 03670000
036800                                                                  03680000
036900     COPY VNKM018.                                                03690000
037000                                                                  03700000
037100 01  MR-OCCURS-LAYOUT                   REDEFINES  VN018AO.       03710000
037200     05  FILLER                         PIC X(83).                03720000
037300     05  MR-SCROLL-AREA                 OCCURS 14 TIMES.          03730000
037400         10  MR-SELECTL                 PIC S9(04) COMP.          03740000
037500         10  MR-SELECTA                 PIC  X(01).               03750000
037600         10  MR-SELECTC                 PIC  X(01).               03760000
037700         10  MR-SELECTH                 PIC  X(01).               03770000
037800         10  MR-SELECTI                 PIC  X(01).               03780000
037900                                                                  03790000
038000         10  MR-ACTIONL                 PIC S9(04) COMP.          03800000
038100         10  MR-ACTIONA                 PIC  X(01).               03810000
038200         10  MR-ACTIONC                 PIC  X(01).               03820000
038300         10  MR-ACTIONH                 PIC  X(01).               03830000
038400         10  MR-ACTION                  PIC  X(03).               03840000
038500                                                                  03850000
038600         10  MR-FUNCTION-NAMEL          PIC S9(04) COMP.          03860000
038700         10  MR-FUNCTION-NAMEA          PIC  X(01).               03870000
038800         10  MR-FUNCTION-NAMEC          PIC  X(01).               03880000
038900         10  MR-FUNCTION-NAMEH          PIC  X(01).               03890000
039000         10  MR-FUNCTION-NAME           PIC  X(25).               03900000
039100                                                                  03910000
039200         10  MR-ADDRESS-COUNTL          PIC S9(04) COMP.          03920000
039300         10  MR-ADDRESS-COUNTA          PIC  X(01).               03930000
039400         10  MR-ADDRESS-COUNTC          PIC  X(01).               03940000
039500         10  MR-ADDRESS-COUNTH          PIC  X(01).               03950000
039600         10  MR-ADDRESS-COUNT-X.                                  03960000
039700             15  MR-ADDRESS-COUNT       PIC ZZ9.                  03970000
039800                                                                  03980000
039900         10  MR-UPDATE-FLAGL            PIC S9(04) COMP.          03990000
040000         10  MR-UPDATE-FLAGA            PIC  X(01).               04000000
040100         10  MR-UPDATE-FLAGC            PIC  X(01).               04010000
040200         10  MR-UPDATE-FLAGH            PIC  X(01).               04020000
040300         10  MR-UPDATE-FLAG             PIC  X(01).               04030000
040400                                                                  04040000
040500     EJECT                                                        04050000
040600                                                                  04060000
041200*---------------------------------------------------------------* 04120000
041300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04130000
041400*---------------------------------------------------------------* 04140000
041500                                                                  04150000
041600     COPY DPWS015.                                                04160000
041700                                                                  04170000
041800     EJECT                                                        04180000
041900                                                                  04190000
042000*---------------------------------------------------------------* 04200000
042100*    FUNCTION KEYS COPYBOOK.                                    * 04210000
042200*---------------------------------------------------------------* 04220000
042300                                                                  04230000
042400     COPY DPWS016.                                                04240000
042500                                                                  04250000
042800*---------------------------------------------------------------* 04280000
042900*    COPYBOOK FOR THE CALL TO RACF SECURITY SUBROUTINE          * 04290000
043000*---------------------------------------------------------------* 04300000
043100                                                                  04310000
043200     COPY DPWS008.                                                04320000
043300                                                                  04330000
043400*---------------------------------------------------------------* 04340000
043500*    COPYBOOK TO CALL THE RMS DATA BUILDER ROUTINE (VNKCS023)   * 04350000
043600*---------------------------------------------------------------* 04360000
043700                                                                  04370000
043800 01  VN013-COMMAREA.                                              04380000
043900     COPY VNWS013.                                                04390000
044000                                                                  04400000
044100     EJECT                                                        04410000
044200                                                                  04420000
044300*---------------------------------------------------------------* 04430000
044400*    COPYBOOK TO CALL THE MQ SERIES FORMATTER FOR RMS (VNKCS024)* 04440000
044500*---------------------------------------------------------------* 04450000
044600                                                                  04460000
044700 01  VN007-COMMAREA.                                              04470000
044800     COPY VNWS007.                                                04480000
044900                                                                  04490000
045000     EJECT                                                        04500000
045100                                                                  04510000
045200*---------------------------------------------------------------* 04520000
045300*    NUMERIC EDIT LAYOUT.                                       * 04530000
045400*---------------------------------------------------------------* 04540000
045500                                                                  04550000
045600     COPY DPWS010I.                                               04560000
045700                                                                  04570000
045800     EJECT                                                        04580000
045900                                                                  04590000
046000*---------------------------------------------------------------* 04600000
046100*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04610057
046200*---------------------------------------------------------------* 04620000
046300                                                                  04630000
046400     COPY DPWS030.                                                04640000
046400     COPY DPWS930.                                                04641057
046500                                                                  04650000
046600     EJECT                                                        04660000
046700                                                                  04670000
047600*---------------------------------------------------------------* 04760000
047700*    STANDARD COMMAREA.                                         * 04770000
047800*---------------------------------------------------------------* 04780000
047900                                                                  04790000
048000     COPY DPWS020.                                                04800000
048100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04810000
048200                                                                  04820000
048300*---------------------------------------------------------------* 04830000
048400* INTER-APPLICATION COMMAREA.                                   * 04840000
048500*   VNWS005 - IS THE ADDRESS DATA WHEN COMING FROM THE CRIT.    * 04850000
048600*             SPEC SCREEN.                                      * 04860000
048700*---------------------------------------------------------------* 04870000
048800                                                                  04880000
048900         10  INTER-APPL-COMM-AREA       PIC X(200).               04890000
049000                                                                  04900000
049100     COPY VNWS005.                                                04910000
049200                                                                  04920000
049300     COPY VNWS002.                                                04930000
049400                                                                  04940000
049500*---------------------------------------------------------------* 04950000
049600*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04960000
049700*---------------------------------------------------------------* 04970000
049800         10  ASC-SPECIFIC-COMMAREA.                               04980000
049900             15  ASC-LIST-KEYS.                                   04990000
050000                 20  ASC-KEY-ENT-ID                  PIC S9(09)   05000000
050100                                                     COMP.        05010000
050200                 20  ASC-KEY-FUNCTION-ID             PIC S9(04)   05020000
050300                                                     COMP.        05030000
050400                 20  ASC-KEY-REP-SEQ-NBR             PIC S9(04)   05040000
050500                                                     COMP.        05050000
050540*                                                                 05054048
050600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05060000
050700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05070000
050800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05080000
050900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05090000
051000                                                                  05100000
051100                 20  ASC-ITEM-ARRAY.                              05110000
051200                     25  ASC-ITEM-ENTRIES OCCURS 14 TIMES.        05120000
051300                         30  ASC-LIST-ITEM-NUMBER                 05130000
051400                                                     PIC S9(09)   05140000
051500                                                     COMP-3.      05150000
051600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05160000
051700                             88  ASC-VALID-SELECT    VALUE ' '    05170000
051800                                                           'S'    05180000
051900                                                           'B'    05190000
052000                                                           'E'.   05200000
052100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05210000
052200                             88  ASC-TEMP-SELECT     VALUE 'S'.   05220000
052300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05230000
052400                             88  ASC-TEMP-END        VALUE 'E'.   05240000
052500                         30  ASC-SELECTED-SW         PIC  X(01).  05250000
052600                             88  ASC-NO-SELECT       VALUE ' '.   05260000
052700                             88  ASC-SELECT          VALUE 'S'.   05270000
052800                             88  ASC-BEGIN           VALUE 'B'.   05280000
052900                             88  ASC-END             VALUE 'E'.   05290000
053000                         30  ASC-ACTION              PIC  X(03).  05300000
053100                         30  ASC-FUNCTION-NAME       PIC  X(25).  05310000
053200                         30  ASC-FUNCTION-ID         PIC S9(04)   05320000
053300                                                          COMP.   05330000
053400                         30  ASC-ADDRESS-COUNT       PIC  9(03).  05340000
053500                         30  ASC-UPDATE-FLAG         PIC  X(01).  05350000
053600                             88  ASC-UPDATE          VALUE 'Y'.   05360000
053700                             88  ASC-NO-UPDATE       VALUE 'N'.   05370000
053800             15  ASC-BLK-SUB                         PIC S9(04)   05380000
053900                                                          COMP    05390000
054000                                                          SYNC.   05400000
054100             15  ASC-ITEM-SUB                        PIC S9(04)   05410000
054200                                                          COMP    05420000
054300                                                          SYNC.   05430000
054400             15  ASC-SEL-SUB                         PIC S9(04)   05440000
054500                                                          COMP.   05450000
054600             15  ASC-SEL-ITEM                        PIC S9(04)   05460000
054700                                                          COMP.   05470000
054800             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05480000
054900                                                          COMP-3. 05490000
055000             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05500000
055100                                                          COMP-3. 05510000
055200             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   05520000
055300                                                          COMP-3. 05530000
055400             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05540000
055500                                                          COMP-3. 05550000
055600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05560000
055700                                                          COMP-3. 05570000
055800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05580000
055900                                                          COMP-3. 05590000
056000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05600000
056100                                                          COMP    05610000
056200                                                          SYNC.   05620000
056300             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05630000
056400                                                          COMP-3. 05640000
056500             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05650000
056600                                                          COMP-3. 05660000
056700             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05670000
056800                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05680000
056900                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05690000
057000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05700000
057100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05710000
057200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05720000
057300             15  ASC-ADD-SUCCESSFUL-SW               PIC X(01).   05730000
057400                 88  ASC-ADD-NOT-SUCCESSFUL          VALUE ' '.   05740000
057500                 88  ASC-ADD-SUCCESSFUL              VALUE 'Y'.   05750000
057600             15  ASC-LIST-QUEUE-NAME.                             05760000
057700                 20  ASC-LIST-TERM-ID                PIC  X(04).  05770000
057800                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05780000
057900                                                          COMP-3. 05790000
058000                 20  ASC-LIST-SEQ                    PIC  9(01).  05800000
058100             15  ASC-SEL-QUEUE-NAME-IN               PIC  X(08).  05810000
058200             15  ASC-SEL-QUEUE-NAME-OUT.                          05820000
058300                 20  ASC-SEL-TERM-ID-OUT             PIC  X(04).  05830000
058400                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(05)   05840000
058500                                                          COMP-3. 05850000
058600                 20  ASC-SEL-SEQ-OUT                 PIC  9(01).  05860000
058700                                                                  05870000
058800             15  ASC-START-ITEM-REQUEST.                          05880000
058900                 20  ASC-START-ITEM-REQUEST-N        PIC  9(07).  05890000
059000             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  05900000
059100                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   05910000
059200             15  ASC-GET-ADDR-CNTR                   PIC S9(02)   05920000
059300                                                         COMP-3.  05930000
059400             15  ASC-SEL-FUNC                        PIC S9(04)   05940000
059500                                                          COMP    05950000
059600                                                          SYNC.   05960000
059700             15  ASC-SEL-FUNC-POS-TABLE.                          05970000
059800                 20  ASC-SEL-FUNC-POS     PIC S9(02) COMP-3       05980000
059900                                          OCCURS 16 TIMES.        05990000
060000             15  ASC-LIST-ENTRY.                                  06000000
060100                 20  ASC-FIRST-NAME       PIC X(15).              06010000
060200                 20  ASC-LAST-NAME        PIC X(15).              06020000
060300                 20  ASC-TITLE            PIC X(35).              06030000
060400                 20  ASC-TEL1-NBR         PIC X(18).              06040000
060500                 20  ASC-TEL1-EXT-NBR     PIC X(04).              06050000
060600                 20  ASC-TEL1-CNTY-PH-CD  PIC X(03).              06060000
060700                 20  ASC-TEL2-NBR         PIC X(18).              06070000
060800                 20  ASC-TEL2-EXT-NBR     PIC X(04).              06080000
060900                 20  ASC-TEL2-CNTY-PH-CD  PIC X(03).              06090000
061000                 20  ASC-FAX-NBR          PIC X(24).              06100000
061100                 20  ASC-LAST-UPDATE-DATE PIC X(10).              06110000
061200                 20  ASC-LAST-UPDATE-ID   PIC X(08).              06120000
061300                 20  ASC-ADDR1-DESC       PIC X(40).              06130000
061400                 20  ASC-ADDR2-DESC       PIC X(40).              06140000
061500                 20  ASC-ADDR3-DESC       PIC X(40).              06150000
061600                 20  ASC-ADDR4-DESC       PIC X(40).              06160000
061700                 20  ASC-CITY             PIC X(15).              06170000
061800                 20  ASC-ZIP              PIC X(12).              06180000
061900                 20  ASC-STATE-CDE        PIC X(02).              06190000
062000                 20  ASC-ST-PROV-CDE      PIC X(06).              06200000
062100                 20  ASC-STATE-NAME       PIC X(19).              06210000
062200                 20  ASC-COUNTRY-CDE      PIC X(03).              06220000
062300                 20  ASC-EXTD-VND-NM      PIC X(40).              06230000
062400                 20  ASC-1099-VND-NM      PIC X(40).              06240000
062500                 20  ASC-COUNTRY-NAME     PIC X(24).              06250000
062600                 20  ASC-ROOM-NBR         PIC X(10).              06260000
062700                 20  ASC-ATTENTION-TO-TXT PIC X(40).              06270000
062800                 20  ASC-COMMENT1-TXT     PIC X(60).              06280000
062900                 20  ASC-COMMENT2-TXT     PIC X(60).              06290000
063000                 20  ASC-COMMENT3-TXT     PIC X(60).              06300000
063100                 20  ASC-VENDOR-NAME      PIC X(30).              06310000
063200                 20  ASC-DUN-NBR          PIC X(09).              06320000
063300                 20  ASC-EMAIL-ADDR       PIC X(64).              06330000
063400                                                                  06340000
063500     EJECT                                                        06350000
063600                                                                  06360000
063700*---------------------------------------------------------------* 06370000
063800*    ABEND PROCESSING COPYBOOK.                                 * 06380000
063900*---------------------------------------------------------------* 06390000
064000                                                                  06400000
064100     COPY DPWS013.                                                06410000
064200                                                                  06420000
064300     EJECT                                                        06430000
064400                                                                  06440000
064500******************************************************************06450000
064600***          PS DCLGEN FOR FI_VENDOR_ADDR TABLE                ***06460000
064700******************************************************************06470000
064800*                                                                 06480010
064900*    EXEC SQL                                                     06490001
065000*         INCLUDE PFI00013                                        06500001
065100*    END-EXEC.                                                    06510001
065200*                                                                 06520001
065300*    EJECT                                                        06530001
065400*                                                                 06540001
065500*----------------------------------------------------------------*06550000
065600*    DB2 AREA FOR VENDOR DETAIL HISTORY TABLE                    *06560000
065700*----------------------------------------------------------------*06570000
065800                                                                  06580000
065900     EXEC SQL                                                     06590000
066000          INCLUDE TVNADAU                                         06600000
066100     END-EXEC.                                                    06610000
066200                                                                  06620000
066300     EJECT                                                        06630000
066400                                                                  06640000
066500*---------------------------------------------------------------* 06650000
066600*    DB2 AREA FOR TENTNME                                       * 06660000
066700*---------------------------------------------------------------* 06670000
066800                                                                  06680000
066900     EXEC SQL                                                     06690000
067000          INCLUDE TENTNME                                         06700000
067100     END-EXEC.                                                    06710000
067200                                                                  06720000
067300     EJECT                                                        06730000
067400                                                                  06740000
067500*---------------------------------------------------------------* 06750000
067600*    DB2 AREA FOR TEXTENT                                       * 06760000
067700*---------------------------------------------------------------* 06770000
067800                                                                  06780000
067900     EXEC SQL                                                     06790000
068000          INCLUDE TEXTENT                                         06800000
068100     END-EXEC.                                                    06810000
068200                                                                  06820000
068300     EJECT                                                        06830000
068400                                                                  06840000
068500*---------------------------------------------------------------* 06850000
068600*    DB2 AREA FOR TBUSFNC                                       * 06860000
068700*---------------------------------------------------------------* 06870000
068800                                                                  06880000
068900     EXEC SQL                                                     06890000
069000          INCLUDE TBUSFNC                                         06900000
069100     END-EXEC.                                                    06910000
069200                                                                  06920000
069300     EJECT                                                        06930000
069400                                                                  06940000
069500*---------------------------------------------------------------* 06950000
069600*    DB2 AREA FOR TENTREP                                       * 06960000
069700*---------------------------------------------------------------* 06970000
069800                                                                  06980000
069900     EXEC SQL                                                     06990000
070000          INCLUDE TENTREP                                         07000000
070100     END-EXEC.                                                    07010000
070200                                                                  07020000
070300     EJECT                                                        07030000
070400                                                                  07040000
070500*---------------------------------------------------------------* 07050000
070600*    DB2 AREA FOR TBUSLOC                                       * 07060000
070700*---------------------------------------------------------------* 07070000
070800                                                                  07080000
070900     EXEC SQL                                                     07090000
071000          INCLUDE TBUSLOC                                         07100000
071100     END-EXEC.                                                    07110000
071200                                                                  07120000
071300     EJECT                                                        07130000
071400                                                                  07140000
071500*---------------------------------------------------------------* 07150000
071600*    DB2 AREA FOR COMMUNICATIONS                                * 07160000
071700*---------------------------------------------------------------* 07170000
071800                                                                  07180000
071900     EXEC SQL                                                     07190000
072000          INCLUDE SQLCA                                           07200000
072100     END-EXEC.                                                    07210000
072200                                                                  07220000
072300     EJECT                                                        07230000
072400                                                                  07240000
072500*---------------------------------------------------------------* 07250000
072600*    TVNDDPT CURSOR WHEN ENTERPRISE ID IS REQUESTED             * 07260000
072700*---------------------------------------------------------------* 07270000
072800                                                                  07280000
072900     EXEC SQL                                                     07290000
073000          DECLARE BUS-FUNC-CSR CURSOR                             07300000
073100          FOR SELECT                                              07310000
073200                FUNCTION_ID                                       07320000
073300               ,FUNCTION_NAME                                     07330000
073400               ,AUTHD_RACF_GP_ID                                  07340000
073500          FROM                                                    07350000
073600                TBUSFNC                                           07360000
073700          WHERE                                                   07370000
073800                 FUNCTION_ID    > 0                               07380000
073900          ORDER BY                                                07390000
074000                FUNCTION_NAME                                     07400000
074100     END-EXEC.                                                    07410000
074200                                                                  07420000
074300     EJECT                                                        07430000
074400                                                                  07440000
074500 LINKAGE SECTION.                                                 07450000
074600                                                                  07460000
074700 01  DFHCOMMAREA.                                                 07470000
074800     05  FILLER                         OCCURS  1 TO 4072 TIMES   07480000
074900                                        DEPENDING ON EIBCALEN.    07490000
075000         10  FILLER                     PIC X.                    07500000
075100                                                                  07510000
075200     EJECT                                                        07520000
075300                                                                  07530000
075400 PROCEDURE DIVISION.                                              07540000
075500                                                                  07550000
075600******************************************************************07560000
075700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07570000
075800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07580000
075900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07590000
076000******************************************************************07600000
076100                                                                  07610000
076200 0000-MAIN-MODULE.                                                07620000
076300                                                                  07630000
076400     INITIALIZE DP030-CICS-API-FIELDS.                            07640000
076500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07650000
076600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07660000
076700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07670000
076800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07680000
076900     MOVE LENGTH OF VN018AI        TO DP030-MAP-LENGTH (1).       07690000
077000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07700000
077100     PERFORM 0001-CALL-CICS-ARCH-API.                             07710000
077200*                                                                 07720000
077300     PERFORM 1000-CONTROL-PROCESSING.                             07730026
077400*                                                                 07740000
077800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07780000
077900     PERFORM 0001-CALL-CICS-ARCH-API.                             07790000
078000                                                                  07800000
078100     EJECT                                                        07810000
078200                                                                  07820000
078300******************************************************************07830000
078400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07840000
078500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07850000
078600******************************************************************07860000
078700                                                                  07870000
078800 0001-CALL-CICS-ARCH-API.                                         07880000
078900                                                                  07890000
079000*    CALL 'DPKCS030' USING DFHEIBLK                               07900057
079000     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07901057
079100                           DFHCOMMAREA                            07910000
079200                           DP030-CICS-API-FIELDS                  07920000
079300                           DP020-STANDARD-COMMAREA                07930000
079400                           VN018AI.                               07940000
079500*                                                                 07950000
079600     IF  DP030-RC-CALL-SUCCESSFUL                                 07960000
079700         CONTINUE                                                 07970000
079800     ELSE                                                         07980000
079900         SET DP013-NO-ROLLBACK                                    07990000
080000             DP013-XCTL-DISPLAY-RESTART                           08000000
080100             DP013-CICS-ABEND      TO TRUE                        08010000
080200         MOVE '0001-CALL-CICS-ARCH-API'                           08020000
080300                                   TO DP013-PARAGRAPH             08030000
080400*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX08040057
080500*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      08050057
080400         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08051057
080500-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08052057
080600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08060000
080700         PERFORM DP013-0000-PROCESS-ABEND                         08070000
080800     END-IF.                                                      08080000
080900                                                                  08090000
081000     EJECT                                                        08100000
081100                                                                  08110000
081200*----------------------------------------------------------------*08120000
081300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08130000
081400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08140000
081500*                                                                *08150000
081600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08160000
081700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08170000
081800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08180000
081900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08190000
082000*----------------------------------------------------------------*08200000
082100                                                                  08210000
082200 1000-CONTROL-PROCESSING.                                         08220000
082300                                                                  08230000
082400     EVALUATE TRUE                                                08240000
082500         WHEN DP020-NEXT-ACT-INITIAL                              08250000
082600             INITIALIZE ASC-SPECIFIC-COMMAREA                     08260000
082700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08270000
082800                                      ASC-SEL-TERM-ID-OUT         08280000
082900             MOVE DP020-SRC-TASK-NUMBER                           08290000
083000                                   TO ASC-LIST-TASK-NUMBER        08300000
083100                                      ASC-SEL-TASK-NUMBER-OUT     08310000
083200             MOVE PC-LIST-QUEUE-SEQ                               08320000
083300                                   TO ASC-LIST-SEQ                08330000
083400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             08340000
083500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08350000
083600***-----$TEMPLATE NOTE$-------------------------------------------08360000
083700*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,08370000
083800*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  08380000
083900*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08390000
084000***---------------------------------------------------------------08400000
084100             IF  PS-COMMAREA-NOT-VALID                            08410000
084200                 SET DP020-MSG-FATAL                              08420000
084300                     DP020-NEXT-ACT-APPL-ERROR                    08430000
084400                                   TO TRUE                        08440000
084500             ELSE                                                 08450000
084600                 PERFORM 4000-BUILD-INITIAL-PANEL                 08460000
084700             END-IF                                               08470000
084800                                                                  08480000
084900         WHEN DP020-NEXT-ACT-READ-MAP                             08490000
085000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08500000
085100                                   TO PV-TOP-ITEM                 08510000
085200             PERFORM 2000-PROCESS-PANEL                           08520000
085300                                                                  08530000
085400         WHEN DP020-NEXT-ACT-RETURN                               08540000
085500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08550000
085600                                   TO PV-TOP-ITEM                 08560000
085700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08570000
085800*            PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08580000
085900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08590000
086000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08600000
086100                                                                  08610000
086200         WHEN OTHER                                               08620000
086300             SET DP013-LOGIC-ABEND TO TRUE                        08630000
086400             SET DP013-NO-ROLLBACK TO TRUE                        08640000
086500             MOVE '1000-CONTROL-PROCESSING'                       08650000
086600                                   TO DP013-PARAGRAPH             08660000
086700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08670000
086800                                   TO DP013-MESSAGE-TEXT(1)       08680000
086900             PERFORM DP013-0000-PROCESS-ABEND                     08690000
087000     END-EVALUATE.                                                08700000
087100                                                                  08710000
087200     EJECT                                                        08720000
087300                                                                  08730000
087400*----------------------------------------------------------------*08740000
087500* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA.      *08750000
087600*----------------------------------------------------------------*08760000
087700                                                                  08770000
087800 1100-PROCESS-INTER-APPL-COMM.                                    08780000
087900                                                                  08790000
088000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08800000
088100                                                                  08810000
088200     IF   VN005-ENT-ID      > ZERO                                08820000
088300     AND  VN005-FUNCTION-ID > ZERO                                08830000
088400     AND  VN005-REP-SEQ-NBR > ZERO                                08840000
088500         SET PS-COMMAREA-VALID         TO TRUE                    08850000
088600         PERFORM 1120-PREPARE-ENTRY                               08860000
088700     ELSE                                                         08870000
088800         SET PS-COMMAREA-NOT-VALID     TO TRUE                    08880000
088900         MOVE PC-TSYMSG-00046          TO DP020-MSG-NUMBER        08890000
089000         SET DP020-MSG-INFORMATIONAL   TO TRUE                    08900000
089100     END-IF.                                                      08910000
089200                                                                  08920000
089300*----------------------------------------------------------------*08930000
089400*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *08940000
089500*  QUEUE PASSED FROM THE LIST.                                   *08950000
089600*                                                                *08960000
089700*----------------------------------------------------------------*08970000
089800                                                                  08980000
089900 1120-PREPARE-ENTRY.                                              08990000
090000      MOVE VN005-ENT-ID            TO ASC-KEY-ENT-ID.             09000000
090100      MOVE VN005-FUNCTION-ID       TO ASC-KEY-FUNCTION-ID.        09010000
090200      MOVE VN005-REP-SEQ-NBR       TO ASC-KEY-REP-SEQ-NBR.        09020000
090300      MOVE ZERO                    TO ASC-SEL-ITEM.               09030000
090400                                                                  09040000
090500     EJECT                                                        09050000
090600                                                                  09060000
090700*----------------------------------------------------------------*09070000
090800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09080000
090900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09090000
091000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09100000
091100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09110000
091200* FUNCTION KEYS CAN GET THIS FAR.                                *09120000
091300*----------------------------------------------------------------*09130000
091400                                                                  09140000
091500 2000-PROCESS-PANEL.                                              09150000
091600                                                                  09160000
091700     EVALUATE TRUE                                                09170000
091800         WHEN DP020-SRC-AID = DP016-CLEAR                         09180000
091900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09190000
092000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09200000
092100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09210000
092200                                                                  09220000
092300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09230000
092400             MOVE ASC-KEY-ENT-ID      TO DK-ENT-ID                09240000
092500             MOVE ASC-KEY-FUNCTION-ID TO DK-FUNCTION-ID           09250000
092600             MOVE ASC-KEY-REP-SEQ-NBR TO DK-REP-SEQ-NBR           09260000
092700                                                                  09270000
092800             PERFORM 2050-DELETE-LIST-QUEUE                       09280000
092900             PERFORM 4000-BUILD-INITIAL-PANEL                     09290000
093000                                                                  09300000
093100         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09310000
093200             PERFORM 2140-DESELECT-ALL-ITEMS                      09320000
093300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09330000
093400                                                                  09340000
093500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09350000
093600             PERFORM 2150-SELECT-ALL-ITEMS                        09360000
093700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09370000
093800                                                                  09380000
093900         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09390000
094000             IF ASC-USE-SELECTION-QUEUE                           09400000
094100                 CONTINUE                                         09410000
094200             ELSE                                                 09420000
094300*                --- BOTTOM OF LIST ---                           09430000
094400                 MOVE PC-TSYMSG-00070                             09440000
094500                                   TO DP020-MSG-NUMBER            09450000
094600                 SET DP020-MSG-INFORMATIONAL                      09460000
094700                                   TO TRUE                        09470000
094800             END-IF                                               09480000
094900                                                                  09490000
095000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09500000
095100             IF ASC-USE-SELECTION-QUEUE                           09510000
095200                 CONTINUE                                         09520000
095300             ELSE                                                 09530000
095400*                --- TOP OF LIST ---                              09540000
095500                 MOVE PC-TSYMSG-00069                             09550000
095600                                   TO DP020-MSG-NUMBER            09560000
095700                 SET DP020-MSG-INFORMATIONAL                      09570000
095800                                   TO TRUE                        09580000
095900             END-IF                                               09590000
096000                                                                  09600000
096100         WHEN OTHER                                               09610000
096200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09620000
096300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09630000
096400             IF  PS-NO-ERROR                                      09640000
096500                 SET DP030-CONTINUE-GO                            09650000
096600                                   TO TRUE                        09660000
096700                 PERFORM 2100-CHECK-FUNCTION-KEY                  09670000
096800             ELSE                                                 09680000
096900                 SET DP030-OVERRIDE-GO                            09690000
097000                                 TO TRUE                          09700000
097100             END-IF                                               09710000
097200     END-EVALUATE.                                                09720000
097300                                                                  09730000
097400     EJECT                                                        09740000
097500                                                                  09750000
097600*----------------------------------------------------------------*09760000
097700*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09770000
097800*----------------------------------------------------------------*09780000
097900                                                                  09790000
098000 2050-DELETE-LIST-QUEUE.                                          09800000
098100                                                                  09810000
098200     EXEC CICS                                                    09820000
098300         DELETEQ TS                                               09830000
098400             QUEUE (ASC-LIST-QUEUE-NAME)                          09840000
098500             RESP  (PV-CICS-RESP)                                 09850000
098600     END-EXEC.                                                    09860000
098700                                                                  09870000
098800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09880000
098900        (PV-CICS-RESP = DFHRESP(QIDERR))                          09890000
099000         CONTINUE                                                 09900000
099100     ELSE                                                         09910000
099200         SET DP013-CICS-ABEND      TO TRUE                        09920000
099300         SET DP013-NO-ROLLBACK     TO TRUE                        09930000
099400                                                                  09940000
099500         MOVE '2050-DELETE-LIST-QUEUE'                            09950000
099600                                   TO DP013-PARAGRAPH             09960000
099700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09970000
099800                                   TO DP013-MESSAGE-TEXT (1)      09980000
099900         PERFORM DP013-0000-PROCESS-ABEND                         09990000
100000     END-IF.                                                      10000000
100100                                                                  10010000
100200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10020000
100300                                                                  10030000
100400     EJECT                                                        10040000
100500                                                                  10050000
100600*----------------------------------------------------------------*10060000
100700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10070000
100800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10080000
100900* CICS ARCHITECTURE API.                                         *10090000
101000*----------------------------------------------------------------*10100000
101100                                                                  10110000
101200 2100-CHECK-FUNCTION-KEY.                                         10120000
101300                                                                  10130000
101400     EVALUATE TRUE                                                10140000
101500         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               10150000
101600             SET DP030-CONTINUE-GO TO TRUE                        10160000
101700             MOVE ASC-KEY-ENT-ID       TO DK-ENT-ID               10170000
101800             MOVE ASC-KEY-FUNCTION-ID  TO DK-FUNCTION-ID          10180000
101900                                          PV-FUNCTION-ID-HOLD     10190000
102000             MOVE ASC-KEY-REP-SEQ-NBR  TO DK-REP-SEQ-NBR          10200000
102100                                                                  10210000
102200             IF ASC-NUMBER-OF-SELECTED-ITEMS < 1                  10220000
102300               MOVE PC-TSYMSG-00057        TO DP020-MSG-NUMBER    10230000
102400               SET DP020-MSG-INFORMATIONAL TO TRUE                10240000
102500             ELSE                                                 10250000
102600               IF ASC-GET-ADDR-CNTR NOT > ZERO                    10260000
102700                  PERFORM 7001-GET-ADDRESS                        10270000
102800                  MOVE 1 TO ASC-GET-ADDR-CNTR                     10280000
102900               END-IF                                             10290000
103000                                                                  10300000
103100               PERFORM 4010-OPEN-CURSOR                           10310000
103200               MOVE 1 TO PV-SEL-FUNC-CNT                          10320000
103300               PERFORM 5300-ADD-ADDRESS                           10330000
103400                   UNTIL (PV-SEL-FUNC-CNT >                       10340000
103500                          PC-NBR-OF-BUSINESS-FUNC) OR             10350000
103600                          PS-ERROR                                10360000
103700               PERFORM 4020-CLOSE-CURSOR                          10370000
103800             END-IF                                               10380000
103900                                                                  10390000
104000             PERFORM 3200-RESET-ATTRIBUTES                        10400000
104100                                                                  10410000
104200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10420000
104300             MOVE +1               TO PV-TOP-ITEM                 10430000
104400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10440000
104500             PERFORM 3200-RESET-ATTRIBUTES                        10450000
104600                                                                  10460000
104700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10470000
104800             PERFORM 2110-BROWSE-BACKWARD                         10480000
104900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10490000
105000             PERFORM 3200-RESET-ATTRIBUTES                        10500000
105100                                                                  10510000
105200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10520000
105300             PERFORM 2120-BROWSE-FORWARD                          10530000
105400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10540000
105500             PERFORM 3200-RESET-ATTRIBUTES                        10550000
105600                                                                  10560000
105700         WHEN DP020-SRC-AID = DP016-ENTER                         10570000
105800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10580000
105900             IF  PS-ERROR                                         10590000
106000                 CONTINUE                                         10600000
106100             ELSE                                                 10610000
106200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10620000
106300             END-IF                                               10630000
106400                                                                  10640000
106500         WHEN OTHER                                               10650000
106600             SET DP013-NO-ROLLBACK                                10660000
106700                 DP013-XCTL-DISPLAY-RESTART                       10670000
106800                 DP013-CICS-ABEND  TO TRUE                        10680000
106900             MOVE '2100-CHECK-FUNCTION-KEY'                       10690000
107000                                   TO DP013-PARAGRAPH             10700000
107100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10710000
107200                                   TO DP013-MESSAGE-TEXT (1)      10720000
107300             PERFORM DP013-0000-PROCESS-ABEND                     10730000
107400     END-EVALUATE.                                                10740000
107500                                                                  10750000
107600     EJECT                                                        10760000
107700                                                                  10770000
107800*----------------------------------------------------------------*10780000
107900*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10790000
108000*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10800000
108100*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10810000
108200*    MESSAGE.                                                    *10820000
108300*----------------------------------------------------------------*10830000
108400                                                                  10840000
108500 2110-BROWSE-BACKWARD.                                            10850000
108600                                                                  10860000
108700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10870000
108800         GIVING PV-TOP-ITEM.                                      10880000
108900*                                                                 10890000
109000     IF  ((PV-TOP-ITEM < +1)                                      10900000
109100       OR (PV-TOP-ITEM = +1))                                     10910000
109200         MOVE +1                   TO PV-TOP-ITEM                 10920000
109300*        -- TOP OF LIST --                                        10930000
109400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10940000
109500         SET DP020-MSG-INFORMATIONAL TO TRUE                      10950000
109600     END-IF.                                                      10960000
109700                                                                  10970000
109800*----------------------------------------------------------------*10980000
109900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10990000
110000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11000000
110100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11010000
110200*----------------------------------------------------------------*11020000
110300                                                                  11030000
110400 2120-BROWSE-FORWARD.                                             11040000
110500                                                                  11050000
110600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11060000
110700         GIVING PV-TOP-ITEM.                                      11070000
110800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11080000
110900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11090000
111000                                   TO PV-TOP-ITEM                 11100000
111100*        -- BOTTOM OF LIST --                                     11110000
111200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11120000
111300         SET DP020-MSG-INFORMATIONAL                              11130000
111400                                   TO TRUE                        11140000
111500     ELSE                                                         11150000
111600         COMPUTE PV-BOTTOM-ITEM =                                 11160000
111700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11170000
111800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11180000
111900*            -- BOTTOM OF LIST --                                 11190000
112000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11200000
112100             SET DP020-MSG-INFORMATIONAL                          11210000
112200                                   TO TRUE                        11220000
112300         END-IF                                                   11230000
112400     END-IF.                                                      11240000
112500                                                                  11250000
112600     EJECT                                                        11260000
112700                                                                  11270000
112800*----------------------------------------------------------------*11280000
112900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11290000
113000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11300000
113100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11310000
113200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11320000
113300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11330000
113400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11340000
113500*----------------------------------------------------------------*11350000
113600                                                                  11360000
113700 2130-CHECK-FOR-JUMP-BROWSE.                                      11370000
113800                                                                  11380000
113900     SET PS-NO-ERROR               TO TRUE.                       11390000
114000     IF (ASC-START-ITEM-REQUEST = SPACE)                          11400000
114100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11410000
114200                                   TO PV-TOP-ITEM                 11420000
114300     ELSE                                                         11430000
114400         MOVE ASC-START-ITEM-REQUEST                              11440000
114500                                   TO DP010I-UNEDITED-FIELD       11450000
114600         MOVE PC-ITM-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11460000
114700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11470000
114800         SET DP010I-NEGATIVE-NOT-ALLOWED                          11480000
114900                                   TO TRUE                        11490000
115010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11501054
115020                         USING DP010I-NUMERIC-EDIT-AREA           11502054
115100                                                                  11510000
115200         IF  NOT DP010I-ERROR-DETECTED                            11520000
115300             MOVE DP010I-NUMERIC-FIELD                            11530000
115400                                   TO  ASC-START-ITEM-REQUEST-N   11540000
115500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11550000
115600                 IF  ASC-START-ITEM-REQUEST-N >                   11560000
115700                                          ASC-NUMBER-OF-ITEMS-READ11570000
115800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11580000
115900                     COMPUTE PV-TOP-ITEM =                        11590000
116000                             ASC-NUMBER-OF-ITEMS-READ             11600000
116100                             - PC-ITEMS-PER-PANEL + 1             11610000
116200                     IF  PV-TOP-ITEM < +1                         11620000
116300                         MOVE +1   TO PV-TOP-ITEM                 11630000
116400                         MOVE PC-TSYMSG-00070                     11640000
116500                                   TO DP020-MSG-NUMBER            11650000
116600                         SET DP020-MSG-INFORMATIONAL              11660000
116700                                   TO TRUE                        11670000
116800                     END-IF                                       11680000
116900                 ELSE                                             11690000
117000                     MOVE ASC-START-ITEM-REQUEST-N                11700000
117100                                   TO PV-TOP-ITEM                 11710000
117200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11720000
117300                     COMPUTE PV-BOTTOM-ITEM =                     11730000
117400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11740000
117500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11750000
117600*                        -- BOTTOM OF LIST --                     11760000
117700                         MOVE PC-TSYMSG-00070                     11770000
117800                                   TO DP020-MSG-NUMBER            11780000
117900                         SET DP020-MSG-INFORMATIONAL              11790000
118000                                   TO TRUE                        11800000
118100                     END-IF                                       11810000
118200                 END-IF                                           11820000
118300             ELSE                                                 11830000
118400*                --- VALUE OUT OF RANGE ----                      11840000
118500                 MOVE PC-TSYMSG-00101                             11850000
118600                                   TO DP020-MSG-NUMBER            11860000
118700                 MOVE -1           TO ASTRTITL                    11870000
118800                 SET DP030-SET-CURSOR-APPL-1                      11880000
118900                                   TO TRUE                        11890000
119000                 MOVE DP015-REVERSE                               11900000
119100                                   TO ASTRTITH                    11910000
119200                 MOVE DP015-RED    TO ASTRTITC                    11920000
119300                 MOVE DP015-UNP-NUM-BRT-MDT                       11930000
119400                                   TO ASTRTITA                    11940000
119500                 SET DP020-MSG-FATAL                              11950000
119600                                   TO TRUE                        11960000
119700                 SET PS-ERROR      TO TRUE                        11970000
119800             END-IF                                               11980000
119900                                                                  11990000
120000         ELSE                                                     12000000
120100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12010000
120200             MOVE -1               TO ASTRTITL                    12020000
120300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12030000
120400             MOVE DP015-REVERSE    TO ASTRTITH                    12040000
120500             MOVE DP015-RED        TO ASTRTITC                    12050000
120600             MOVE DP015-UNP-NUM-BRT-MDT                           12060000
120700                                   TO ASTRTITA                    12070000
120800             SET DP020-MSG-FATAL   TO TRUE                        12080000
120900             SET PS-ERROR          TO TRUE                        12090000
121000         END-IF                                                   12100000
121100     END-IF.                                                      12110000
121200                                                                  12120000
121300     EJECT                                                        12130000
121400                                                                  12140000
121500*----------------------------------------------------------------*12150000
121600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12160000
121700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12170000
121800*----------------------------------------------------------------*12180000
121900                                                                  12190000
122000 2140-DESELECT-ALL-ITEMS.                                         12200000
122100                                                                  12210000
122200     MOVE +1                       TO ASC-BLK-SUB.                12220000
122300                                                                  12230000
122400     PERFORM 2141-CLEAR-SELECTED-INDS                             12240000
122500         VARYING ASC-ITEM-SUB                                     12250000
122600         FROM 1 BY 1                                              12260000
122700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12270000
122800                                                                  12280000
122900     ADD +1                        TO ASC-BLK-SUB.                12290000
123000                                                                  12300000
123100     PERFORM 2141-CLEAR-SELECTED-INDS                             12310000
123200         VARYING ASC-ITEM-SUB                                     12320000
123300         FROM 1 BY 1                                              12330000
123400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12340000
123500                                                                  12350000
123600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12360000
123700                                   TO PV-LIST-ITEM-NUMBER.        12370000
123800                                                                  12380000
123900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12390000
124000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12400000
124100                                                                  12410000
124200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12420000
124300        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12430000
124400         MOVE +1                   TO ASC-BLK-SUB                 12440000
124500                                                                  12450000
124600         PERFORM 5100-WRITE-TEMP-STORAGE                          12460000
124700                                                                  12470000
124800         MOVE +1                   TO PV-BLOCK-NUMBER             12480000
124900                                                                  12490000
125000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12500000
125100             PV-FIRST-BLOCK-IN-ARRAY - 1                          12510000
125200                                                                  12520000
125300         PERFORM                                                  12530000
125400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12540000
125500                                                                  12550000
125600             PERFORM 4410-READ-TEMP-STORAGE                       12560000
125700                                                                  12570000
125800             PERFORM 2141-CLEAR-SELECTED-INDS                     12580000
125900                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12590000
126000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12600000
126100                                                                  12610000
126200             PERFORM 5100-WRITE-TEMP-STORAGE                      12620000
126300                                                                  12630000
126400             ADD +1                TO PV-BLOCK-NUMBER             12640000
126500                                                                  12650000
126600         END-PERFORM                                              12660000
126700                                                                  12670000
126800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12680000
126900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12690000
127000                                                                  12700000
127100         PERFORM                                                  12710000
127200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12720000
127300                   ASC-HIGHEST-BLOCK-WRITTEN                      12730000
127400                                                                  12740000
127500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12750000
127600                                   TO PV-BLOCK-NUMBER             12760000
127700                                                                  12770000
127800             PERFORM 4410-READ-TEMP-STORAGE                       12780000
127900                                                                  12790000
128000             PERFORM 2141-CLEAR-SELECTED-INDS                     12800000
128100                 VARYING ASC-ITEM-SUB                             12810000
128200                 FROM 1 BY 1                                      12820000
128300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12830000
128400                                                                  12840000
128500             PERFORM 5100-WRITE-TEMP-STORAGE                      12850000
128600                                                                  12860000
128700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12870000
128800                                                                  12880000
128900         END-PERFORM                                              12890000
129000                                                                  12900000
129100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12910000
129200                                   TO PV-BLOCK-NUMBER             12920000
129300                                                                  12930000
129400         PERFORM 4410-READ-TEMP-STORAGE                           12940000
129500     END-IF.                                                      12950000
129600                                                                  12960000
129700                                                                  12970000
129800     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS12980000
129900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.12990000
130000     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  13000000
130100                                                                  13010000
130200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13020000
130300                                                                  13030000
130400     EJECT                                                        13040000
130500                                                                  13050000
130600*----------------------------------------------------------------*13060000
130700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13070000
130800*----------------------------------------------------------------*13080000
130900                                                                  13090000
131000 2141-CLEAR-SELECTED-INDS.                                        13100000
131100                                                                  13110000
131200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13120000
131300             NOT EQUAL ZERO                                       13130000
131400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13140000
131500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13150000
131600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13160000
131700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13170000
131800                                   TO TRUE                        13180000
131900         END-IF                                                   13190000
132000     END-IF.                                                      13200000
132100                                                                  13210000
132200     EJECT                                                        13220000
132300                                                                  13230000
132400*----------------------------------------------------------------*13240000
132500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13250000
132600*  FOR ALL ITEMS.                                                *13260000
132700*----------------------------------------------------------------*13270000
132800                                                                  13280000
132900 2150-SELECT-ALL-ITEMS.                                           13290000
133000                                                                  13300000
133100     MOVE +1                       TO ASC-BLK-SUB.                13310000
133200                                                                  13320000
133300     PERFORM 2151-SET-SELECTED-INDS                               13330000
133400         VARYING ASC-ITEM-SUB                                     13340000
133500         FROM 1 BY 1                                              13350000
133600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13360000
133700                                                                  13370000
133800     ADD +1                        TO ASC-BLK-SUB.                13380000
133900                                                                  13390000
134000     PERFORM 2151-SET-SELECTED-INDS                               13400000
134100         VARYING ASC-ITEM-SUB                                     13410000
134200         FROM 1 BY 1                                              13420000
134300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13430000
134400                                                                  13440000
134500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13450000
134600                                   TO PV-LIST-ITEM-NUMBER.        13460000
134700                                                                  13470000
134800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13480000
134900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13490000
135000                                                                  13500000
135100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13510000
135200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13520000
135300         MOVE +1                   TO ASC-BLK-SUB                 13530000
135400                                                                  13540000
135500         PERFORM 5100-WRITE-TEMP-STORAGE                          13550000
135600                                                                  13560000
135700         MOVE +1                   TO PV-BLOCK-NUMBER             13570000
135800                                                                  13580000
135900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13590000
136000             PV-FIRST-BLOCK-IN-ARRAY - 1                          13600000
136100                                                                  13610000
136200         PERFORM                                                  13620000
136300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13630000
136400                                                                  13640000
136500             PERFORM 4410-READ-TEMP-STORAGE                       13650000
136600                                                                  13660000
136700             PERFORM 2151-SET-SELECTED-INDS                       13670000
136800                 VARYING ASC-ITEM-SUB                             13680000
136900                 FROM 1 BY 1                                      13690000
137000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13700000
137100                                                                  13710000
137200             PERFORM 5100-WRITE-TEMP-STORAGE                      13720000
137300                                                                  13730000
137400             ADD +1                TO PV-BLOCK-NUMBER             13740000
137500                                                                  13750000
137600         END-PERFORM                                              13760000
137700                                                                  13770000
137800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13780000
137900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13790000
138000                                                                  13800000
138100         PERFORM                                                  13810000
138200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13820000
138300                   ASC-HIGHEST-BLOCK-WRITTEN                      13830000
138400                                                                  13840000
138500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13850000
138600                                   TO PV-BLOCK-NUMBER             13860000
138700                                                                  13870000
138800             PERFORM 4410-READ-TEMP-STORAGE                       13880000
138900                                                                  13890000
139000             PERFORM 2151-SET-SELECTED-INDS                       13900000
139100                 VARYING ASC-ITEM-SUB                             13910000
139200                 FROM 1 BY 1                                      13920000
139300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13930000
139400                                                                  13940000
139500             PERFORM 5100-WRITE-TEMP-STORAGE                      13950000
139600                                                                  13960000
139700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13970000
139800                                                                  13980000
139900         END-PERFORM                                              13990000
140000                                                                  14000000
140100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14010000
140200                                   TO PV-BLOCK-NUMBER             14020000
140300                                                                  14030000
140400         PERFORM 4410-READ-TEMP-STORAGE                           14040000
140500     END-IF.                                                      14050000
140600                                                                  14060000
140700                                                                  14070000
140800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14080000
140900                       ASC-NUMBER-OF-SELECTED-ITEMS.              14090000
141000                                                                  14100000
141100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14110000
141200                                                                  14120000
141300     EJECT                                                        14130000
141400                                                                  14140000
141500*----------------------------------------------------------------*14150000
141600*    MARK EACH ITEM AS BEING SELECTED.                           *14160000
141700*----------------------------------------------------------------*14170000
141800                                                                  14180000
141900 2151-SET-SELECTED-INDS.                                          14190000
142000                                                                  14200000
142100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14210000
142200             NOT EQUAL ZERO                                       14220000
142300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14230000
142400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14240000
142500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14250000
142600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14260000
142700                               TO  TRUE                           14270000
142800         END-IF                                                   14280000
142900     END-IF.                                                      14290000
143000                                                                  14300000
143100******************************************************************14310000
143200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **14320000
143300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **14330000
143400******************************************************************14340000
143500                                                                  14350000
143600 2200-MOVE-SCREEN-TO-COMMAREA.                                    14360000
143700                                                                  14370000
143800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14380000
143900     MOVE +1                       TO PV-SUB.                     14390000
144000*                                                                 14400000
144100     PERFORM 3100-SET-SUBSCRIPTS.                                 14410000
144200     IF  ASTRTITL > ZERO                                          14420000
144300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14430000
144400     ELSE                                                         14440000
144500         IF  ASTRTITF = DP015-ERASE-EOF                           14450000
144600             INITIALIZE ASC-START-ITEM-REQUEST                    14460000
144700         END-IF                                                   14470000
144800     END-IF.                                                      14480000
144900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14490000
145000         VARYING PV-SUB                                           14500000
145100         FROM 1 BY 1                                              14510000
145200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14520000
145300                                                                  14530000
145400     EJECT                                                        14540000
145500                                                                  14550000
145600******************************************************************14560000
145700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**14570000
145800******************************************************************14580000
145900                                                                  14590000
146000 2210-MOVE-LINES-TO-COMMAREA.                                     14600000
146100                                                                  14610000
146200     IF  MR-SELECTL (PV-SUB) > ZERO                               14620000
146300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             14630000
146400         MOVE MR-SELECTI (PV-SUB)                                 14640000
146500                                   TO ASC-TEMP-SELECTED-SW        14650000
146600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14660000
146700                                                                  14670000
146800     ELSE                                                         14680000
146900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                14690000
147000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     14700000
147100                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        14710000
147200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14720000
147300         END-IF                                                   14730000
147400     END-IF.                                                      14740000
147500     ADD +1                        TO ASC-ITEM-SUB.               14750000
147600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        14760000
147700         ADD +1                    TO ASC-BLK-SUB                 14770000
147800         MOVE +1                   TO ASC-ITEM-SUB                14780000
147900     END-IF.                                                      14790000
148000                                                                  14800000
148100                                                                  14810000
148200                                                                  14820000
148300******************************************************************14830000
148400* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *14840000
148500* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *14850000
148600******************************************************************14860000
148700                                                                  14870000
148800 2300-GET-NEXT-MESSAGE.                                           14880000
148900                                                                  14890000
149000     ADD +1                        TO ASC-SEL-SUB.                14900000
149100     IF ASC-SEL-SUB > VN003-MAX-ITEMS                             14910000
149200         ADD +1                    TO ASC-SEL-ITEM                14920000
149300         MOVE +1                   TO ASC-SEL-SUB                 14930000
149400     END-IF.                                                      14940000
149500     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 14950000
149600         PERFORM 9100-READ-SEL-QUEUE                              14960000
149700         IF VN003-ITEM (ASC-SEL-SUB) > ZERO                       14970000
149800             MOVE VN003-ENT-ID (ASC-SEL-SUB)                      14980000
149900                                   TO ASC-KEY-ENT-ID              14990000
150000             SET VN003-INQ (ASC-SEL-SUB)                          15000000
150100                                   TO TRUE                        15010000
150200             PERFORM 9200-REWRITE-LIST-QUEUE                      15020000
150300         ELSE                                                     15030000
150400             SUBTRACT +1 FROM ASC-SEL-SUB                         15040000
150500*            --- BOTTOM OF LIST ---                               15050000
150600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15060000
150700             SET DP020-MSG-INFORMATIONAL                          15070000
150800                                   TO TRUE                        15080000
150900         END-IF                                                   15090000
151000     ELSE                                                         15100000
151100         SUBTRACT +1 FROM ASC-SEL-ITEM                            15110000
151200         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 15120000
151300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15130000
151400         SET DP020-MSG-INFORMATIONAL                              15140000
151500                                   TO TRUE                        15150000
151600     END-IF.                                                      15160000
151700                                                                  15170000
151800                                                                  15180000
151900                                                                  15190000
152000******************************************************************15200000
152100* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *15210000
152200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15220000
152300******************************************************************15230000
152400                                                                  15240000
152500 2310-GET-PREV-MESSAGE.                                           15250000
152600                                                                  15260000
152700     SUBTRACT +1 FROM ASC-SEL-SUB.                                15270000
152800     IF ASC-SEL-SUB < +1                                          15280000
152900         SUBTRACT +1 FROM ASC-SEL-ITEM                            15290000
153000         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 15300000
153100     END-IF.                                                      15310000
153200*                                                                 15320000
153300     IF ASC-SEL-ITEM > ZERO                                       15330000
153400         PERFORM 9100-READ-SEL-QUEUE                              15340000
153500         MOVE VN003-ENT-ID (ASC-SEL-SUB)                          15350000
153600                                   TO ASC-KEY-ENT-ID              15360000
153700     ELSE                                                         15370000
153800         MOVE +1                   TO ASC-SEL-ITEM                15380000
153900                                      ASC-SEL-SUB                 15390000
154000*        --- TOP OF LSIT ---                                      15400000
154100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15410000
154200         SET DP020-MSG-INFORMATIONAL                              15420000
154300                                   TO TRUE                        15430000
154400     END-IF.                                                      15440000
154500                                                                  15450000
154600                                                                  15460000
154700                                                                  15470000
154800******************************************************************15480000
154900** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **15490000
155000** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **15500000
155100******************************************************************15510000
155200                                                                  15520000
155300 3000-EDIT-DATA-IN-COMMAREA.                                      15530000
155400                                                                  15540000
155500     SET PS-NO-ERROR               TO TRUE.                       15550000
155600     PERFORM 3200-RESET-ATTRIBUTES.                               15560000
155700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     15570000
155800**                                                                15580000
155900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              15590000
156000* EDITTING IS DONE FROM THE BOTTOM UP.                            15600000
156100**                                                                15610000
156200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       15620000
156300         ASC-ITEMS-DISPLAYED - 1.                                 15630000
156400     PERFORM 3100-SET-SUBSCRIPTS.                                 15640000
156500     PERFORM 3300-EDIT-SELECTIONS                                 15650000
156600         VARYING PV-SUB                                           15660000
156700         FROM PV-SUB BY -1                                        15670000
156800         UNTIL PV-SUB < +1.                                       15680000
156900*                                                                 15690000
157000     IF  PS-NO-ERROR                                              15700000
157100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        15710000
157200     END-IF.                                                      15720000
157300*                                                                 15730000
157400     IF  ((PS-NO-ERROR)                                           15740000
157500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   15750000
157600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    15760000
157700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  15770000
157800     END-IF.                                                      15780000
157900                                                                  15790000
158000                                                                  15800000
158100                                                                  15810000
158200*----------------------------------------------------------------*15820000
158300*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15830000
158400*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15840000
158500*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15850000
158600*                                                                *15860000
158700*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15870000
158800*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15880000
158900*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15890000
159000*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15900000
159100*----------------------------------------------------------------*15910000
159200                                                                  15920000
159300 3100-SET-SUBSCRIPTS.                                             15930000
159400                                                                  15940000
159500     COMPUTE ASC-ITEM-SUB =                                       15950000
159600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15960000
159700                                                                  15970000
159800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15980000
159900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15990000
160000                                                                  16000000
160100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               16010000
160200     ELSE                                                         16020000
160300         MOVE +1                     TO ASC-BLK-SUB               16030000
160400     END-IF.                                                      16040000
160500                                                                  16050000
160600                                                                  16060000
160700                                                                  16070000
160800******************************************************************16080000
160900** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **16090000
161000******************************************************************16100000
161100                                                                  16110000
161200 3200-RESET-ATTRIBUTES.                                           16120000
161300                                                                  16130000
161400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   16140000
161500     MOVE DP015-GREEN              TO ASTRTITC.                   16150000
161600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   16160000
161700*                                                                 16170000
161800     IF  ASC-ITEM-AT-BOT-OF-PANEL > 14                            16180000
161900         MOVE 2             TO PV-BLK-SUB                         16190000
162000     ELSE                                                         16200000
162100         MOVE 1             TO PV-BLK-SUB                         16210000
162200     END-IF.                                                      16220000
162300                                                                  16230000
162400     IF DP020-NEXT-ACT-RETURN                                     16240000
162500     OR DP020-NEXT-ACT-READ-MAP                                   16250000
162600        PERFORM                                                   16260000
162700            VARYING PV-SUB                                        16270000
162800            FROM 1 BY 1                                           16280000
162900            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    16290000
163000            IF  ASC-NO-UPDATE      (PV-BLK-SUB PV-SUB)            16300000
163100                MOVE DP015-ASK-DRK-OFF                            16310000
163200                                   TO MR-SELECTA (PV-SUB)         16320000
163300                MOVE DP015-BLUE    TO MR-SELECTC (PV-SUB)         16330000
163400                MOVE DP015-HL-OFF  TO MR-SELECTH (PV-SUB)         16340000
163500            ELSE                                                  16350000
163600                MOVE DP015-UNP-ALP-NOR-OFF                        16360000
163700                                   TO MR-SELECTA (PV-SUB)         16370000
163800                MOVE DP015-GREEN   TO MR-SELECTC (PV-SUB)         16380000
163900                MOVE DP015-UNDERLINE                              16390000
164000                                   TO MR-SELECTH (PV-SUB)         16400000
164100            END-IF                                                16410000
164200            MOVE DP015-BLUE        TO MR-UPDATE-FLAGC (PV-SUB)    16420000
164300            MOVE DP015-HL-OFF      TO MR-UPDATE-FLAGH (PV-SUB)    16430000
164400        END-PERFORM                                               16440000
164500     ELSE                                                         16450000
164600        PERFORM                                                   16460000
164700            VARYING PV-SUB                                        16470000
164800            FROM 1 BY 1                                           16480000
164900            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     16490000
165000            IF  ASC-NO-UPDATE      (PV-BLK-SUB PV-SUB)            16500000
165100                MOVE DP015-ASK-DRK-OFF                            16510000
165200                                   TO MR-SELECTA (PV-SUB)         16520000
165300                MOVE DP015-BLUE    TO MR-SELECTC (PV-SUB)         16530000
165400                MOVE DP015-HL-OFF  TO MR-SELECTH (PV-SUB)         16540000
165500            ELSE                                                  16550000
165600                MOVE DP015-UNP-ALP-NOR-OFF                        16560000
165700                                   TO MR-SELECTA (PV-SUB)         16570000
165800                MOVE DP015-GREEN   TO MR-SELECTC (PV-SUB)         16580000
165900                MOVE DP015-UNDERLINE                              16590000
166000                                   TO MR-SELECTH (PV-SUB)         16600000
166100            END-IF                                                16610000
166200            MOVE DP015-BLUE        TO MR-UPDATE-FLAGC (PV-SUB)    16620000
166300            MOVE DP015-HL-OFF      TO MR-UPDATE-FLAGH (PV-SUB)    16630000
166400        END-PERFORM                                               16640000
166500     END-IF.                                                      16650000
166600                                                                  16660000
166700                                                                  16670000
166800                                                                  16680000
166900******************************************************************16690000
167000** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **16700000
167100** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **16710000
167200** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **16720000
167300** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **16730000
167400******************************************************************16740000
167500                                                                  16750000
167600 3300-EDIT-SELECTIONS.                                            16760000
167700                                                                  16770000
167800     EVALUATE TRUE                                                16780000
167900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16790000
168000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16800000
168100                 CONTINUE                                         16810000
168200         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16820000
168300             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16830000
168400                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16840000
168500******************************************************************16850000
168600****** THIS LOGIC DETERMINES WHAT LINES HAVE BEEN SELECTED FOR    16860000
168700****** THE COPY FUNCTION                                          16870000
168800                 IF ASC-BLK-SUB = 2                               16880000
168900                     ADD PC-ITEMS-PER-PANEL                       16890000
169000                      TO ASC-ITEM-SUB GIVING ASC-SEL-FUNC         16900000
169100                 ELSE                                             16910000
169200                     MOVE ASC-ITEM-SUB                            16920000
169300                       TO ASC-SEL-FUNC                            16930000
169400                 END-IF                                           16940000
169500                 MOVE +1           TO                             16950000
169600                  ASC-SEL-FUNC-POS(ASC-SEL-FUNC)                  16960000
169700******************************************************************16970000
169800                 MOVE ASC-TEMP-SELECTED-SW                        16980000
169900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16990000
170000                                TO ASC-SELECTED-SW                17000000
170100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17010000
170200             END-IF                                               17020000
170300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17030000
170400                 = SPACE                                          17040000
170500             EVALUATE TRUE                                        17050000
170600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       17060000
170700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS17070000
170800******************************************************************17080000
170900****** THIS LOGIC DETERMINES WHAT LINES HAVE BEEN SELECTED FOR    17090000
171000****** THE COPY FUNCTION                                          17100000
171100                     IF ASC-BLK-SUB = 2                           17110000
171200                         ADD PC-ITEMS-PER-PANEL                   17120000
171300                          TO ASC-ITEM-SUB GIVING ASC-SEL-FUNC     17130000
171400                     ELSE                                         17140000
171500                         MOVE ASC-ITEM-SUB                        17150000
171600                           TO ASC-SEL-FUNC                        17160000
171700                     END-IF                                       17170000
171800                     MOVE ZEROES       TO                         17180000
171900                          ASC-SEL-FUNC-POS(ASC-SEL-FUNC)          17190000
172000******************************************************************17200000
172100                     MOVE SPACE TO ASC-SELECTED-SW                17210000
172200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17220000
172300                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        17230000
172400                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    17240000
172500                     MOVE SPACE TO ASC-SELECTED-SW                17250000
172600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17260000
172700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          17270000
172800                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      17280000
172900                     MOVE SPACE TO ASC-SELECTED-SW                17290000
173000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17300000
173100             END-EVALUATE                                         17310000
173200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           17320000
173300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17330000
173400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17340000
173500******************************************************************17350000
173600****** THIS LOGIC DETERMINES WHAT LINES HAVE BEEN SELECTED FOR    17360000
173700****** THE COPY FUNCTION                                          17370000
173800                 IF ASC-BLK-SUB = 2                               17380000
173900                    ADD PC-ITEMS-PER-PANEL                        17390000
174000                     TO ASC-ITEM-SUB GIVING ASC-SEL-FUNC          17400000
174100                 ELSE                                             17410000
174200                    MOVE ASC-ITEM-SUB TO ASC-SEL-FUNC             17420000
174300                 END-IF                                           17430000
174400                 MOVE ZEROES TO                                   17440000
174500                          ASC-SEL-FUNC-POS(ASC-SEL-FUNC)          17450000
174600******************************************************************17460000
174700             END-IF                                               17470000
174800             PERFORM 3310-EDIT-RANGE                              17480000
174900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             17490000
175000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17500000
175100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17510000
175200******************************************************************17520000
175300****** THIS LOGIC DETERMINES WHAT LINES HAVE BEEN SELECTED FOR    17530000
175400****** THE COPY FUNCTION                                          17540000
175500                 IF ASC-BLK-SUB = 2                               17550000
175600                    ADD PC-ITEMS-PER-PANEL                        17560000
175700                     TO ASC-ITEM-SUB GIVING ASC-SEL-FUNC          17570000
175800                 ELSE                                             17580000
175900                    MOVE ASC-ITEM-SUB TO ASC-SEL-FUNC             17590000
176000                 END-IF                                           17600000
176100                 MOVE ZEROES TO                                   17610000
176200                          ASC-SEL-FUNC-POS(ASC-SEL-FUNC)          17620000
176300******************************************************************17630000
176400             END-IF                                               17640000
176500             PERFORM 3310-EDIT-RANGE                              17650000
176600         WHEN OTHER                                               17660000
176700             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           17670000
176800             SET DP020-MSG-FATAL    TO TRUE                       17680000
176900             MOVE -1                TO MR-SELECTL (PV-SUB)        17690000
177000             SET DP030-SET-CURSOR-APPL-1                          17700000
177100                                    TO TRUE                       17710000
177200             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        17720000
177300             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        17730000
177400             SET PS-ERROR TO TRUE                                 17740000
177500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17750000
177600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     17760000
177700******************************************************************17770000
177800****** THIS LOGIC DETERMINES WHAT LINES HAVE BEEN SELECTED FOR    17780000
177900****** THE COPY FUNCTION                                          17790000
178000                 IF ASC-BLK-SUB = 2                               17800000
178100                    ADD PC-ITEMS-PER-PANEL                        17810000
178200                     TO ASC-ITEM-SUB GIVING ASC-SEL-FUNC          17820000
178300                 ELSE                                             17830000
178400                    MOVE ASC-ITEM-SUB TO ASC-SEL-FUNC             17840000
178500                 END-IF                                           17850000
178600                 MOVE ZEROES TO                                   17860000
178700                          ASC-SEL-FUNC-POS(ASC-SEL-FUNC)          17870000
178800******************************************************************17880000
178900                 MOVE SPACE         TO ASC-SELECTED-SW            17890000
179000                                        (ASC-BLK-SUB ASC-ITEM-SUB)17900000
179100             END-IF                                               17910000
179200     END-EVALUATE.                                                17920000
179300                                                                  17930000
179400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 17940000
179500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               17950000
179600     IF  ASC-ITEM-SUB < 1                                         17960000
179700         SUBTRACT +1 FROM ASC-BLK-SUB                             17970000
179800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                17980000
179900     END-IF.                                                      17990000
180000                                                                  18000000
180100                                                                  18010000
180200                                                                  18020000
180300******************************************************************18030000
180400** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **18040000
180500** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **18050000
180600** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**18060000
180700** THE ENDING.                                                  **18070000
180800******************************************************************18080000
180900                                                                  18090000
181000 3310-EDIT-RANGE.                                                 18100000
181100                                                                  18110000
181200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                18120000
181300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   18130000
181400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)18140000
181500                                   TO ASC-SELECTED-SW             18150000
181600                                        (ASC-BLK-SUB ASC-ITEM-SUB)18160000
181700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 18170000
181800         ELSE                                                     18180000
181900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     18190000
182000                 CONTINUE                                         18200000
182100             ELSE                                                 18210000
182200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        18220000
182300                 MOVE PC-TSYMSG-00054                             18230000
182400                                   TO DP020-MSG-NUMBER            18240000
182500                 SET DP020-MSG-FATAL                              18250000
182600                                   TO TRUE                        18260000
182700                 MOVE -1           TO MR-SELECTL (PV-SUB)         18270000
182800                 SET DP030-SET-CURSOR-APPL-1                      18280000
182900                                   TO TRUE                        18290000
183000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         18300000
183100                 MOVE DP015-UNDERLINE                             18310000
183200                                   TO MR-SELECTH (PV-SUB)         18320000
183300                 SET PS-ERROR      TO TRUE                        18330000
183400             END-IF                                               18340000
183500         END-IF                                                   18350000
183600     ELSE                                                         18360000
183700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     18370000
183800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18380000
183900                                   TO ASC-SELECTED-SW             18390000
184000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18400000
184100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   18410000
184200         ELSE                                                     18420000
184300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       18430000
184400                 CONTINUE                                         18440000
184500             ELSE                                                 18450000
184600*                -- ONLY ONE END-OF-RANGE ALLOWED --              18460000
184700                 MOVE PC-TSYMSG-00055                             18470000
184800                                   TO DP020-MSG-NUMBER            18480000
184900                 SET DP020-MSG-FATAL                              18490000
185000                                   TO TRUE                        18500000
185100                 MOVE -1           TO MR-SELECTL (PV-SUB)         18510000
185200                 SET DP030-SET-CURSOR-APPL-1                      18520000
185300                                   TO TRUE                        18530000
185400                 SET PS-ERROR      TO TRUE                        18540000
185500             END-IF                                               18550000
185600         END-IF                                                   18560000
185700     END-IF.                                                      18570000
185800                                                                  18580000
185900                                                                  18590000
186000                                                                  18600000
186100******************************************************************18610000
186200** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **18620000
186300** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **18630000
186400******************************************************************18640000
186500                                                                  18650000
186600 3400-CHECK-RANGE-SEQUENCE.                                       18660000
186700                                                                  18670000
186800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       18680000
186900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      18690000
187000       AND  ASC-START-OF-SELECTED-RANGE >                         18700000
187100                                         ASC-END-OF-SELECTED-RANGE18710000
187200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                18720000
187300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 18730000
187400         SET DP020-MSG-FATAL TO TRUE                              18740000
187500         SET PS-ERROR TO TRUE                                     18750000
187600         PERFORM 3410-POSITION-AT-ERROR                           18760000
187700     END-IF.                                                      18770000
187800                                                                  18780000
187900                                                                  18790000
188000                                                                  18800000
188100******************************************************************18810000
188200** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **18820000
188300** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **18830000
188400** SHOULD BE POSITIONED ON A RANGE ERROR.                       **18840000
188500******************************************************************18850000
188600                                                                  18860000
188700 3410-POSITION-AT-ERROR.                                          18870000
188800                                                                  18880000
188900     SET DP030-SET-CURSOR-APPL-1                                  18890000
189000                                   TO TRUE.                       18900000
189100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 18910000
189200                    - PV-TOP-ITEM + 1.                            18920000
189300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18930000
189400         CONTINUE                                                 18940000
189500     ELSE                                                         18950000
189600         MOVE -1                   TO MR-SELECTL (PV-SUB)         18960000
189700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18970000
189800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18980000
189900     END-IF.                                                      18990000
190000*                                                                 19000000
190100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   19010000
190200                    - PV-TOP-ITEM + 1.                            19020000
190300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19030000
190400         CONTINUE                                                 19040000
190500     ELSE                                                         19050000
190600         MOVE -1                   TO MR-SELECTL (PV-SUB)         19060000
190700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19070000
190800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19080000
190900     END-IF.                                                      19090000
191000                                                                  19100000
191100                                                                  19110000
191200                                                                  19120000
191300*----------------------------------------------------------------*19130000
191400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *19140000
191500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *19150000
191600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *19160000
191700*----------------------------------------------------------------*19170000
191800                                                                  19180000
191900 3500-MARK-RANGE-AS-SELECTED.                                     19190000
192000                                                                  19200000
192100     MOVE +1                       TO  ASC-BLK-SUB.               19210000
192200     PERFORM 3510-MARK-SELECTED-INDS                              19220000
192300         VARYING ASC-ITEM-SUB                                     19230000
192400         FROM 1 BY 1                                              19240000
192500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19250000
192600                                                                  19260000
192700     ADD +1                        TO ASC-BLK-SUB.                19270000
192800     PERFORM 3510-MARK-SELECTED-INDS                              19280000
192900         VARYING ASC-ITEM-SUB                                     19290000
193000         FROM 1 BY 1                                              19300000
193100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19310000
193200                                                                  19320000
193300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19330000
193400                                   TO  PV-LIST-ITEM-NUMBER.       19340000
193500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19350000
193600         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         19360000
193700               PC-ITEMS-PER-PANEL).                               19370000
193800                                                                  19380000
193900     MOVE ASC-START-OF-SELECTED-RANGE                             19390000
194000                                   TO PV-START-OF-SELECTED-RANGE. 19400000
194100     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            19410000
194200         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  19420000
194300               PC-ITEMS-PER-PANEL).                               19430000
194400                                                                  19440000
194500     MOVE ASC-END-OF-SELECTED-RANGE                               19450000
194600                                   TO  PV-END-OF-SELECTED-RANGE.  19460000
194700     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             19470000
194800         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    19480000
194900               PC-ITEMS-PER-PANEL).                               19490000
195000     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             19500000
195100         PV-FIRST-BLOCK-IN-ARRAY + 1.                             19510000
195200                                                                  19520000
195300     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19530000
195400        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19540000
195500         MOVE +1                   TO ASC-BLK-SUB                 19550000
195600         PERFORM 5100-WRITE-TEMP-STORAGE                          19560000
195700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19570000
195800             PV-FIRST-BLOCK-IN-ARRAY - 1                          19580000
195900                                                                  19590000
196000         PERFORM                                                  19600000
196100             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      19610000
196200                   PV-PREV-BLOCK-IN-ARRAY                         19620000
196300             MOVE PV-FIRST-BLOCK-IN-RANGE                         19630000
196400                                   TO PV-BLOCK-NUMBER             19640000
196500             PERFORM 4410-READ-TEMP-STORAGE                       19650000
196600             PERFORM 3510-MARK-SELECTED-INDS                      19660000
196700                 VARYING ASC-ITEM-SUB                             19670000
196800                 FROM 1 BY 1                                      19680000
196900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19690000
197000             PERFORM 5100-WRITE-TEMP-STORAGE                      19700000
197100             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     19710000
197200         END-PERFORM                                              19720000
197300                                                                  19730000
197400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19740000
197500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19750000
197600         PERFORM                                                  19760000
197700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19770000
197800                   PV-LAST-BLOCK-IN-RANGE                         19780000
197900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19790000
198000                                   TO PV-BLOCK-NUMBER             19800000
198100             PERFORM 4410-READ-TEMP-STORAGE                       19810000
198200             PERFORM 3510-MARK-SELECTED-INDS                      19820000
198300                 VARYING ASC-ITEM-SUB                             19830000
198400                 FROM 1 BY 1                                      19840000
198500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19850000
198600             PERFORM 5100-WRITE-TEMP-STORAGE                      19860000
198700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19870000
198800         END-PERFORM                                              19880000
198900                                                                  19890000
199000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19900000
199100                                   TO PV-BLOCK-NUMBER             19910000
199200         PERFORM 4410-READ-TEMP-STORAGE                           19920000
199300     END-IF.                                                      19930000
199400                                                                  19940000
199500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 19950000
199600                                      ASC-END-OF-SELECTED-RANGE.  19960000
199700                                                                  19970000
199800                                                                  19980000
199900                                                                  19990000
200000*----------------------------------------------------------------*20000000
200100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *20010000
200200*----------------------------------------------------------------*20020000
200300                                                                  20030000
200400 3510-MARK-SELECTED-INDS.                                         20040000
200500                                                                  20050000
200600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20060000
200700                                ASC-ITEM-SUB) >                   20070000
200800         ASC-START-OF-SELECTED-RANGE)                             20080000
200900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20090000
201000                                ASC-ITEM-SUB) =                   20100000
201100         ASC-START-OF-SELECTED-RANGE)                             20110000
201200                                                                  20120000
201300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20130000
201400                                    ASC-ITEM-SUB) <               20140000
201500             ASC-END-OF-SELECTED-RANGE)                           20150000
201600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20160000
201700                                    ASC-ITEM-SUB) =               20170000
201800             ASC-END-OF-SELECTED-RANGE)                           20180000
201900                                                                  20190000
202000             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20200000
202100                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   20210000
202200                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   20220000
202300                               TO TRUE                            20230000
202400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              20240000
202500                               TO TRUE                            20250000
202600                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    20260000
202700******************************************************************20270000
202800****** THIS LOGIC DETERMINES WHAT LINES HAVE BEEN SELECTED FOR    20280000
202900****** THE COPY FUNCTION                                          20290000
203000                 IF ASC-BLK-SUB = 2                               20300000
203100                    ADD PC-ITEMS-PER-PANEL                        20310000
203200                     TO ASC-ITEM-SUB GIVING ASC-SEL-FUNC          20320000
203300                 ELSE                                             20330000
203400                    MOVE ASC-ITEM-SUB TO ASC-SEL-FUNC             20340000
203500                 END-IF                                           20350000
203600                 MOVE +1 TO                                       20360000
203700                          ASC-SEL-FUNC-POS(ASC-SEL-FUNC)          20370000
203800******************************************************************20380000
203900             END-IF                                               20390000
204000         END-IF                                                   20400000
204100     END-IF.                                                      20410000
204200                                                                  20420000
204300                                                                  20430000
204400                                                                  20440000
204500*----------------------------------------------------------------*20450000
204600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *20460000
204700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *20470000
204800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *20480000
204900*    DISPLAY THE PANEL TO USER.                                  *20490000
205000*----------------------------------------------------------------*20500000
205100                                                                  20510000
205200 4000-BUILD-INITIAL-PANEL.                                        20520000
205300                                                                  20530000
205400     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            20540000
205500                                 ASC-BLOCK-ENTRIES (2).           20550000
205600     MOVE +1                 TO ASC-BLK-SUB.                      20560000
205700     SET ASC-ITEMS-LEFT-ON-DB                                     20570000
205800                             TO TRUE.                             20580000
205900                                                                  20590000
206000     MOVE +0                 TO ASC-ITEM-SUB                      20600000
206100                                ASC-NUMBER-OF-ITEMS-READ          20610000
206200                                ASC-NUMBER-OF-SELECTED-ITEMS      20620000
206300                                ASC-HIGHEST-BLOCK-WRITTEN         20630000
206400                                ASC-START-OF-SELECTED-RANGE       20640000
206500                                ASC-END-OF-SELECTED-RANGE         20650000
206600                                ASC-ITEM-AT-TOP-OF-PANEL.         20660000
206700     PERFORM 4100-PREPARE-CURSOR                                  20670000
206800                                                                  20680000
206900     PERFORM 4010-OPEN-CURSOR.                                    20690000
207000                                                                  20700000
207100     PERFORM 4300-READ-ITEMS-FROM-DB.                             20710000
207200                                                                  20720000
207300     PERFORM 4020-CLOSE-CURSOR.                                   20730000
207400                                                                  20740000
207500     MOVE +1                   TO  PV-TOP-ITEM.                   20750000
207600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          20760000
207700         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    20770000
207800         SET DP020-MSG-FATAL   TO  TRUE                           20780000
207900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               20790000
208000     ELSE                                                         20800000
208100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     20810000
208200     END-IF.                                                      20820000
208300                                                                  20830000
208400     MOVE VN005-VENDOR-NAME    TO AVENDO                          20840000
208500                                  ASC-VENDOR-NAME.                20850000
208600                                                                  20860000
208700                                                                  20870000
208800                                                                  20880000
208900*----------------------------------------------------------------*20890000
209000* OPEN THE TBUSFNC CURSOR.                                       *20900000
209100*----------------------------------------------------------------*20910000
209200                                                                  20920000
209300 4010-OPEN-CURSOR.                                                20930000
209400                                                                  20940000
209500     PERFORM                                                      20950000
209600         WITH TEST AFTER                                          20960000
209700         VARYING PV-RETRY-COUNTER                                 20970000
209800         FROM 1 BY 1                                              20980000
209900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20990000
210000                   OR (SQLCODE = ZERO))                           21000000
210100*                                                                 21010000
210200         EXEC SQL                                                 21020000
210300             OPEN BUS-FUNC-CSR                                    21030000
210400         END-EXEC                                                 21040000
210500*                                                                 21050000
210600         EVALUATE TRUE                                            21060000
210700             WHEN SQLCODE = ZERO                                  21070000
210800             WHEN SQLCODE = -904                                  21080000
210900             WHEN SQLCODE = -913                                  21090000
211000                 CONTINUE                                         21100000
211100             WHEN SQLWARN0 NOT = SPACES                           21110000
211200             WHEN SQLCODE < ZERO                                  21120000
211300             WHEN SQLCODE > ZERO                                  21130000
211400                 MOVE '4010-OPEN-CURSOR'                          21140000
211500                                   TO DP013-PARAGRAPH             21150000
211600                 MOVE 'OPEN BUSINESS FUNCTION CURSOR - '          21160000
211700                                   TO DP013-MESSAGE-TEXT (1)      21170000
211800                 MOVE SQLCA        TO DP013-SQLCA                 21180000
211900                 MOVE 'TBUSFNC '   TO DP013-DB2-TABLE-NAME (1)    21190000
212000                 SET DP013-DB2-ABEND                              21200000
212100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           21210000
212200                 PERFORM DP013-0000-PROCESS-ABEND                 21220000
212300         END-EVALUATE                                             21230000
212400     END-PERFORM.                                                 21240000
212500*                                                                 21250000
212600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21260000
212700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             21270000
212800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   21280000
212900                                   TO DP013-MESSAGE-TEXT (1)      21290000
213000         MOVE SQLCA                TO DP013-SQLCA                 21300000
213100         MOVE 'TBUSFNC '           TO DP013-DB2-TABLE-NAME (1)    21310000
213200         SET DP013-DB2-ABEND                                      21320000
213300             DP013-XCTL-DISPLAY-RESTART                           21330000
213400                                   TO TRUE                        21340000
213500         PERFORM DP013-0000-PROCESS-ABEND                         21350000
213600     END-IF.                                                      21360000
213700                                                                  21370000
213800                                                                  21380000
213900                                                                  21390000
214000*----------------------------------------------------------------*21400000
214100* CLOSE THE TMESSAGE CURSOR.                                     *21410000
214200*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *21420000
214300*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *21430000
214400*   USER.                                                        *21440000
214500*----------------------------------------------------------------*21450000
214600                                                                  21460000
214700 4020-CLOSE-CURSOR.                                               21470000
214800                                                                  21480000
214900     EXEC SQL                                                     21490000
215000         CLOSE BUS-FUNC-CSR                                       21500000
215100     END-EXEC                                                     21510000
215200*                                                                 21520000
215300     EVALUATE TRUE                                                21530000
215400         WHEN SQLCODE = ZERO                                      21540000
215500             CONTINUE                                             21550000
215600         WHEN SQLWARN0 NOT = SPACES                               21560000
215700         WHEN SQLCODE < ZERO                                      21570000
215800         WHEN SQLCODE > ZERO                                      21580000
215900             MOVE '4020-CLOSE-CURSOR'                             21590000
216000                               TO DP013-PARAGRAPH                 21600000
216100             MOVE 'CLOSE BUSINESS FUNCTION CURSOR '               21610000
216200                               TO DP013-MESSAGE-TEXT (1)          21620000
216300             MOVE SQLCA        TO DP013-SQLCA                     21630000
216400             MOVE 'TBUSFNC '   TO DP013-DB2-TABLE-NAME (1)        21640000
216500             SET DP013-DB2-ABEND                                  21650000
216600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21660000
216700             PERFORM DP013-0000-PROCESS-ABEND                     21670000
216800     END-EVALUATE.                                                21680000
216900                                                                  21690000
217000                                                                  21700000
217100                                                                  21710000
217200*----------------------------------------------------------------*21720000
217300*    SET UP THE HOST VARIABLES.                                  *21730000
217400*----------------------------------------------------------------*21740000
217500                                                                  21750000
217600 4100-PREPARE-CURSOR.                                             21760000
217700                                                                  21770000
217800     MOVE ASC-KEY-ENT-ID           TO DK-ENT-ID.                  21780000
217900                                                                  21790000
218000*----------------------------------------------------------------*21800000
218100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21810000
218200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *21820000
218300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21830000
218400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21840000
218500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21850000
218600*                                                                *21860000
218700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21870000
218800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21880000
218900*    UPON INITIALIZATION.                                        *21890000
219000*----------------------------------------------------------------*21900000
219100                                                                  21910000
219200 4300-READ-ITEMS-FROM-DB.                                         21920000
219300                                                                  21930000
219400     PERFORM                                                      21940000
219500         VARYING PV-READ-COUNT                                    21950000
219600         FROM 1 BY 1                                              21960000
219700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21970000
219800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21980000
219900                                                                  21990000
220000         PERFORM 4310-FETCH                                       22000000
220100                                                                  22010000
220200         IF  ASC-ITEMS-LEFT-ON-DB                                 22020000
220300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                22030000
220400                 ADD +1            TO ASC-ITEM-SUB                22040000
220500             ELSE                                                 22050000
220600                 ADD +1            TO ASC-BLK-SUB                 22060000
220700                 MOVE +1           TO ASC-ITEM-SUB                22070000
220800                                                                  22080000
220900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         22090000
221000                     MOVE +1       TO ASC-BLK-SUB                 22100000
221100                     SET ASC-BLOCK-MODIFIED (1)                   22110000
221200                                   TO TRUE                        22120000
221300                     PERFORM 5100-WRITE-TEMP-STORAGE              22130000
221400                     MOVE ASC-BLOCK-ENTRIES                       22140000
221500                               (PC-MAX-BLOCKS-IN-ARRAY)           22150000
221600                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 22160000
221700                     ADD +1        TO ASC-BLK-SUB                 22170000
221800                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   22180000
221900                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      22190000
222000                                   TO TRUE                        22200000
222100                 END-IF                                           22210000
222200             END-IF                                               22220000
222300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    22230000
222400             MOVE ASC-NUMBER-OF-ITEMS-READ                        22240000
222500                                   TO ASC-LIST-ITEM-NUMBER        22250000
222600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22260000
222700             INITIALIZE PV-DB2-COUNT                              22270000
222800             PERFORM 4320-COUNT-ADDRESS                           22280000
222900             MOVE PV-DB2-COUNT     TO ASC-ADDRESS-COUNT           22290000
223000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22300000
223100             MOVE BUSFNC-FUNCTION-NAME                            22310000
223200                                   TO ASC-FUNCTION-NAME           22320000
223300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22330000
223400             MOVE BUSFNC-FUNCTION-ID                              22340000
223500                                   TO ASC-FUNCTION-ID             22350000
223600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22360000
223700             PERFORM 4330-RACF-ACCESS                             22370000
223800         END-IF                                                   22380000
223900     END-PERFORM.                                                 22390000
224000                                                                  22400000
224100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          22410000
224200         MOVE +1                   TO ASC-BLK-SUB                 22420000
224300         PERFORM 5100-WRITE-TEMP-STORAGE                          22430000
224400         ADD +1                TO ASC-BLK-SUB                     22440000
224500         PERFORM 5100-WRITE-TEMP-STORAGE                          22450000
224600                                                                  22460000
224700         MOVE 1                TO ASC-BLK-SUB                     22470000
224800                                  PV-BLOCK-NUMBER                 22480000
224900         PERFORM 4410-READ-TEMP-STORAGE                           22490000
225000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22500000
225100             MOVE 2            TO ASC-BLK-SUB                     22510000
225200                                  PV-BLOCK-NUMBER                 22520000
225300             PERFORM 4410-READ-TEMP-STORAGE                       22530000
225400         END-IF                                                   22540000
225500     END-IF.                                                      22550000
225600                                                                  22560000
225700                                                                  22570000
225800                                                                  22580000
225900*----------------------------------------------------------------*22590000
226000*    FETCH THE MESSAGE CURSOR.                                   *22600000
226100*----------------------------------------------------------------*22610000
226200                                                                  22620000
226300 4310-FETCH.                                                      22630000
226400                                                                  22640000
226500     EXEC SQL                                                     22650000
226600         FETCH BUS-FUNC-CSR                                       22660000
226700         INTO  :BUSFNC-FUNCTION-ID                                22670000
226800              ,:BUSFNC-FUNCTION-NAME                              22680000
226900              ,:BUSFNC-AUTHD-RACF-GP-ID                           22690000
227000     END-EXEC                                                     22700000
227100                                                                  22710000
227200     EVALUATE TRUE                                                22720000
227300         WHEN SQLCODE = ZERO                                      22730000
227400         WHEN SQLCODE = +100                                      22740000
227500              CONTINUE                                            22750000
227600         WHEN SQLWARN0 NOT = SPACE                                22760000
227700         WHEN SQLCODE NOT = ZERO                                  22770000
227800              MOVE '4310-FETCH-CURSOR'                            22780000
227900                               TO DP013-PARAGRAPH                 22790000
228000              MOVE 'FETCH BUSINESS FUNCTION CURSOR'               22800000
228100                               TO DP013-MESSAGE-TEXT (1)          22810000
228200              MOVE SQLCA       TO DP013-SQLCA                     22820000
228300              SET DP013-DB2-ABEND                                 22830000
228400                               TO TRUE                            22840000
228500              PERFORM DP013-0000-PROCESS-ABEND                    22850000
228600     END-EVALUATE.                                                22860000
228700                                                                  22870000
228800     IF  SQLCODE EQUAL +100                                       22880000
228900         SET ASC-NO-ITEMS-LEFT-ON-DB                              22890000
229000                                   TO TRUE                        22900000
229100     END-IF.                                                      22910000
229200                                                                  22920000
229300                                                                  22930000
229500*----------------------------------------------------------------*22950000
229600*    COUNT THE NUMBER OF ADDRESSES                               *22960000
229700*----------------------------------------------------------------*22970000
229800                                                                  22980000
229900 4320-COUNT-ADDRESS.                                              22990000
230000                                                                  23000000
230100     PERFORM                                                      23010000
230200         WITH TEST AFTER                                          23020000
230300         VARYING PV-RETRY-COUNTER                                 23030000
230400         FROM 1 BY 1                                              23040000
230500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23050000
230600                   OR (SQLCODE = ZERO)                            23060000
230700                   OR (SQLCODE = +100))                           23070000
230800                                                                  23080000
230900         EXEC SQL                                                 23090000
231000             SELECT COUNT(*)                                      23100000
231100             INTO :PV-DB2-COUNT                                   23110000
231200             FROM TENTREP A                                       23120000
231300                 ,TBUSLOC B                                       23130000
231400                 ,TBUSFNC C                                       23140000
231500             WHERE A.ENT_ID         = :DK-ENT-ID                  23150000
231600               AND A.FUNCTION_ID    = :BUSFNC-FUNCTION-ID         23160000
231700               AND A.ENT_ID         = B.ENT_ID                    23170000
231800               AND A.ENT_BUS_LOC_ID = B.SEQ_NBR                   23180000
231900               AND B.FUNCTION_ID    = C.FUNCTION_ID               23190000
232000         END-EXEC                                                 23200000
232100                                                                  23210000
232200         EVALUATE TRUE                                            23220000
232300             WHEN SQLCODE = ZERO                                  23230000
232400             WHEN SQLCODE = +100                                  23240000
232500             WHEN SQLCODE = -904                                  23250000
232600             WHEN SQLCODE = -913                                  23260000
232700                 CONTINUE                                         23270000
232800             WHEN SQLWARN0 NOT = SPACES                           23280000
232900             WHEN SQLCODE < ZERO                                  23290000
233000             WHEN SQLCODE > ZERO                                  23300000
233100                 MOVE '4320-COUNT-ADDRESS'                        23310000
233200                                   TO DP013-PARAGRAPH             23320000
233300                 MOVE 'COUNT TO GET NUMBER OF ADDRESSES'          23330000
233400                                   TO DP013-MESSAGE-TEXT (1)      23340000
233500                 MOVE SQLCA        TO DP013-SQLCA                 23350000
233600                 MOVE 'TENTREP'    TO DP013-DB2-TABLE-NAME (1)    23360000
233700                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (2)    23370000
233800                 MOVE 'TBUSFNC'    TO DP013-DB2-TABLE-NAME (3)    23380000
233900                 SET DP013-DB2-ABEND                              23390000
234000                     DP013-XCTL-DISPLAY-RESTART                   23400000
234100                                   TO TRUE                        23410000
234200                 PERFORM DP013-0000-PROCESS-ABEND                 23420000
234300         END-EVALUATE                                             23430000
234400     END-PERFORM.                                                 23440000
234500                                                                  23450000
234600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23460000
234700         MOVE '4320-COUNT-ADDRESSES'                              23470000
234800                                   TO DP013-PARAGRAPH             23480000
234900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO COUNT'      23490000
235000                                   TO DP013-MESSAGE-TEXT (1)      23500000
235100         MOVE 'ADDRESSES '         TO DP013-MESSAGE-TEXT (2)      23510000
235200         MOVE SQLCA                TO DP013-SQLCA                 23520000
235300         MOVE 'TENTREP'            TO DP013-DB2-TABLE-NAME (1)    23530000
235400         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (2)    23540000
235500         MOVE 'TBUSFNC'            TO DP013-DB2-TABLE-NAME (3)    23550000
235600         SET DP013-DB2-ABEND                                      23560000
235700             DP013-XCTL-DISPLAY-RESTART                           23570000
235800                                   TO TRUE                        23580000
235900         PERFORM DP013-0000-PROCESS-ABEND                         23590000
236000     END-IF.                                                      23600000
236100                                                                  23610000
236200                                                                  23620000
236300                                                                  23630000
236400*----------------------------------------------------------------*23640000
236500*    DETERMINE IF USER HAS RACF ACCESS TO UPDATE THE FUNCTION     23650000
236600*----------------------------------------------------------------*23660000
236700                                                                  23670000
236800 4330-RACF-ACCESS.                                                23680000
236900                                                                  23690000
237000      MOVE BUSFNC-AUTHD-RACF-GP-ID       TO PV-FUNCTION-SECURITY  23700000
237100      MOVE PV-RESOURCE-TYPE              TO DP008-RESOURCE-TYPE   23710000
237200      MOVE PV-RESOURCE-NAME              TO DP008-RESOURCE-NAME   23720000
237300      SET DP008-ACCESS-TYPE-READ         TO TRUE                  23730000
237400                                                                  23740000
237500      EXEC CICS                                                   23750000
237600         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 23760000
237700              COMMAREA (DP008-SECURITY-COMMAREA)                  23770000
237800              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             23780000
237900      END-EXEC                                                    23790000
238000                                                                  23800000
238100      IF DP008-CALL-SUCCESSFUL                                    23810000
238200         IF DP008-ACCESS-ALLOWED                                  23820000
238300             SET  ASC-UPDATE (ASC-BLK-SUB ASC-ITEM-SUB)           23830000
238400                               TO TRUE                            23840000
238500         ELSE                                                     23850000
238600             SET  ASC-NO-UPDATE (ASC-BLK-SUB ASC-ITEM-SUB)        23860000
238700                               TO TRUE                            23870000
238800         END-IF                                                   23880000
238900     ELSE                                                         23890000
239000         MOVE '4330-RACF-ACCESS'                                  23900000
239100                               TO DP013-PARAGRAPH                 23910000
239200          MOVE 'UNABLE TO ACCESS CICS'                            23920000
239300                               TO DP013-MESSAGE-TEXT (1)          23930000
239400          MOVE SQLCA                 TO DP013-SQLCA               23940000
239500          SET DP013-DB2-ABEND                                     23950000
239600              DP013-XCTL-DISPLAY-RESTART                          23960000
239700                               TO TRUE                            23970000
239800          PERFORM DP013-0000-PROCESS-ABEND                        23980000
239900      END-IF.                                                     23990000
240000                                                                  24000000
240100                                                                  24010000
240200                                                                  24020000
240300*----------------------------------------------------------------*24030000
240400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *24040000
240500*----------------------------------------------------------------*24050000
240600                                                                  24060000
240700 4400-MOVE-COMMAREA-TO-SCREEN.                                    24070000
240800                                                                  24080000
240900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             24090000
241000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          24100000
241100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          24110000
241200             MOVE +1    TO ASC-BLK-SUB                            24120000
241300             PERFORM 5100-WRITE-TEMP-STORAGE                      24130000
241400             ADD +1     TO ASC-BLK-SUB                            24140000
241500             PERFORM 5100-WRITE-TEMP-STORAGE                      24150000
241600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             24160000
241700                 GIVING PV-BLOCK-NUMBER                           24170000
241800                 REMAINDER PV-REMAINDER                           24180000
241900             IF  PV-REMAINDER > ZERO                              24190000
242000                 ADD +1 TO PV-BLOCK-NUMBER                        24200000
242100             END-IF                                               24210000
242200             MOVE +1    TO ASC-BLK-SUB                            24220000
242300             PERFORM 4410-READ-TEMP-STORAGE                       24230000
242400             ADD +1     TO ASC-BLK-SUB                            24240000
242500                           PV-BLOCK-NUMBER                        24250000
242600             PERFORM 4410-READ-TEMP-STORAGE                       24260000
242700     END-IF.                                                      24270000
242800     MOVE +1            TO ASC-BLK-SUB.                           24280000
242900     COMPUTE ASC-ITEM-SUB =                                       24290000
243000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              24300000
243100         + PC-ITEMS-PER-PANEL).                                   24310000
243200*                                                                 24320000
243300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24330000
243400         ADD +1         TO ASC-BLK-SUB                            24340000
243500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24350000
243600     END-IF.                                                      24360000
243700*                                                                 24370000
243800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           24380000
243900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                24390000
244000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        24400000
244100     PERFORM 4420-FORMAT-LIST-LINES                               24410000
244200         VARYING PV-SUB                                           24420000
244300         FROM PC-ITEMS-PER-PANEL BY -1                            24430000
244400         UNTIL PV-SUB < +1.                                       24440000
244500*                                                                 24450000
244600     COMPUTE ASC-ITEMS-DISPLAYED =                                24460000
244700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          24470000
244800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    24480000
244900                                      ASTRTITO.                   24490000
245000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    24500000
245100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    24510000
245200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            24520000
245300                                   TO ASELITO.                    24530000
245400     MOVE ASC-VENDOR-NAME          TO AVENDO.                     24540000
245500*                                                                 24550000
245600     IF  DP020-MSG-NUMBER-X = SPACE                               24560000
245700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  24570000
245800*            --- MORE ITEMS TO DISPLAY ----                       24580000
245900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            24590000
246000             SET DP020-MSG-INFORMATIONAL TO TRUE                  24600000
246100         END-IF                                                   24610000
246200     END-IF.                                                      24620000
246300                                                                  24630000
246400                                                                  24640000
246500                                                                  24650000
246600*----------------------------------------------------------------*24660000
246700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *24670000
246800*----------------------------------------------------------------*24680000
246900                                                                  24690000
247000 4410-READ-TEMP-STORAGE.                                          24700000
247100                                                                  24710000
247200     EXEC CICS                                                    24720000
247300         READQ TS                                                 24730000
247400             QUEUE (ASC-LIST-QUEUE-NAME)                          24740000
247500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24750000
247600             ITEM  (PV-BLOCK-NUMBER)                              24760000
247700             RESP  (PV-CICS-RESP)                                 24770000
247800     END-EXEC.                                                    24780000
247900                                                                  24790000
248000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       24800000
248100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     24810000
248200         CONTINUE                                                 24820000
248300     ELSE                                                         24830000
248400         SET DP013-CICS-ABEND     TO TRUE                         24840000
248500         SET DP013-NO-ROLLBACK    TO TRUE                         24850000
248600         MOVE '4410-READ-TEMP-STORAGE'                            24860000
248700                                  TO DP013-PARAGRAPH              24870000
248800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24880000
248900                                  TO DP013-MESSAGE-TEXT(1)        24890000
249000         PERFORM DP013-0000-PROCESS-ABEND                         24900000
249100     END-IF.                                                      24910000
249200                                                                  24920000
249300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24930000
249400*                                                                 24940000
249500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24950000
249600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24960000
249700     END-IF.                                                      24970000
249800                                                                  24980000
249900                                                                  24990000
250000                                                                  25000000
250100*----------------------------------------------------------------*25010000
250200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *25020000
250300*----------------------------------------------------------------*25030000
250400                                                                  25040000
250500 4420-FORMAT-LIST-LINES.                                          25050000
250600                                                                  25060000
250700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      25070000
250800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25080000
250900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           25090000
251000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           25100000
251100         MOVE SPACE              TO MR-SELECTI (PV-SUB)           25110000
251200                                    MR-ACTION (PV-SUB)            25120000
251300                                    MR-FUNCTION-NAME (PV-SUB)     25130000
251400                                    MR-ADDRESS-COUNT-X (PV-SUB)   25140000
251500                                    MR-UPDATE-FLAG (PV-SUB)       25150000
251600     ELSE                                                         25160000
251700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      25170000
251800                                                   > SPACE        25180000
251900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25190000
252000                                 TO MR-SELECTI (PV-SUB)           25200000
252100         ELSE                                                     25210000
252200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      25220000
252300                                 TO MR-SELECTI (PV-SUB)           25230000
252400         END-IF                                                   25240000
252500*                                                                 25250000
252600         IF  DP030-SET-CURSOR-TRAILER                             25260000
252700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)25270000
252800                 > SPACE)                                         25280000
252900               OR (PV-SUB = 1))                                   25290000
253000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               25300000
253100                MOVE -1          TO MR-SELECTL (PV-SUB)           25310000
253200             END-IF                                               25320000
253300         END-IF                                                   25330000
253400*                                                                 25340000
253500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           25350000
253600             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           25360000
253700                                 TO MR-ACTION (PV-SUB)            25370000
253800             MOVE ASC-FUNCTION-NAME  (ASC-BLK-SUB ASC-ITEM-SUB)   25380000
253900                                 TO MR-FUNCTION-NAME  (PV-SUB)    25390000
254000             MOVE ASC-ADDRESS-COUNT  (ASC-BLK-SUB ASC-ITEM-SUB)   25400000
254100                                 TO MR-ADDRESS-COUNT  (PV-SUB)    25410000
254200             MOVE ASC-UPDATE-FLAG  (ASC-BLK-SUB ASC-ITEM-SUB)     25420000
254300                                 TO MR-UPDATE-FLAG  (PV-SUB)      25430000
254400         END-IF                                                   25440000
254500     END-IF.                                                      25450000
254600                                                                  25460000
254700     IF ASC-UPDATE (ASC-BLK-SUB ASC-ITEM-SUB)                     25470000
254800        MOVE -1                    TO MR-SELECTL (PV-SUB)         25480000
254900        SET DP030-SET-CURSOR-APPL-1                               25490000
255000                                   TO TRUE                        25500000
255100     ELSE                                                         25510000
255200        MOVE DP015-ASK-DRK-OFF     TO MR-SELECTA (PV-SUB)         25520000
255300        MOVE DP015-BLUE            TO MR-SELECTC (PV-SUB)         25530000
255400        MOVE DP015-HL-OFF          TO MR-SELECTH (PV-SUB)         25540000
255500     END-IF.                                                      25550000
255600                                                                  25560000
255700     SUBTRACT +1 FROM ASC-ITEM-SUB                                25570000
255800     IF  ASC-ITEM-SUB < + 1                                       25580000
255900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25590000
256000         MOVE +1                 TO ASC-BLK-SUB                   25600000
256100     END-IF.                                                      25610000
256200                                                                  25620000
256300                                                                  25630000
256400                                                                  25640000
256500******************************************************************25650000
256600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **25660000
256700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **25670000
256800** ISSUE A WARNING.                                             **25680000
256900******************************************************************25690000
257000                                                                  25700000
257100 4430-CHECK-FOR-BEGIN-AND-END.                                    25710000
257200                                                                  25720000
257300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25730000
257400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25740000
257500*            -- NO END-OF-RANGE SPECFIED ---                      25750000
257600             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            25760000
257700             SET DP020-MSG-WARNING TO TRUE                        25770000
257800             PERFORM 4431-POSITION-AT-WARNING                     25780000
257900         END-IF                                                   25790000
258000     ELSE                                                         25800000
258100         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     25810000
258200*            -- NO BEGINNING-OF-RANGE SPECFIED ---                25820000
258300             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            25830000
258400             SET DP020-MSG-WARNING TO TRUE                        25840000
258500             PERFORM 4431-POSITION-AT-WARNING                     25850000
258600         END-IF                                                   25860000
258700     END-IF.                                                      25870000
258800                                                                  25880000
258900                                                                  25890000
259000                                                                  25900000
259100******************************************************************25910000
259200** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **25920000
259300** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **25930000
259400** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **25940000
259500** POSITION THE CURSOR THERE.                                   **25950000
259600******************************************************************25960000
259700                                                                  25970000
259800 4431-POSITION-AT-WARNING.                                        25980000
259900                                                                  25990000
260000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 26000000
260100                    - PV-TOP-ITEM + 1.                            26010000
260200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26020000
260300         CONTINUE                                                 26030000
260400     ELSE                                                         26040000
260500         SET DP030-SET-CURSOR-APPL-1                              26050000
260600                                   TO TRUE                        26060000
260700         MOVE -1                   TO MR-SELECTL (PV-SUB)         26070000
260800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26080000
260900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         26090000
261000     END-IF.                                                      26100000
261100*                                                                 26110000
261200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   26120000
261300                    - PV-TOP-ITEM + 1.                            26130000
261400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26140000
261500         CONTINUE                                                 26150000
261600     ELSE                                                         26160000
261700         SET DP030-SET-CURSOR-APPL-1                              26170000
261800                                   TO TRUE                        26180000
261900         MOVE -1                   TO MR-SELECTL (PV-SUB)         26190000
262000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26200000
262100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         26210000
262200     END-IF.                                                      26220000
262300                                                                  26230000
262400                                                                  26240000
262500                                                                  26250000
262600*----------------------------------------------------------------*26260000
262700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *26270000
262800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *26280000
262900*----------------------------------------------------------------*26290000
263000                                                                  26300000
263100 5100-WRITE-TEMP-STORAGE.                                         26310000
263200                                                                  26320000
263300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     26330000
263400                                   TO PV-LIST-ITEM-NUMBER.        26340000
263500     COMPUTE PV-BLOCK-NUMBER =                                    26350000
263600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    26360000
263700                                                                  26370000
263800     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             26380000
263900     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             26390000
264000         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      26400000
264100             PERFORM 5105-REWRITE-ASC-LISTQ                       26410000
264200         END-IF                                                   26420000
264300     ELSE                                                         26430000
264400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       26440000
264500         ASC-HIGHEST-BLOCK-WRITTEN + 1                            26450000
264600         PERFORM 5110-WRITE-ASC-LISTQ                             26460000
264700         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   26470000
264800     END-IF.                                                      26480000
264900                                                                  26490000
265000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26500000
265100                                                                  26510000
265200                                                                  26520000
265300                                                                  26530000
265400******************************************************************26540000
265500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **26550000
265600** SPECIFIC COMMAREA.                                           **26560000
265700******************************************************************26570000
265800                                                                  26580000
265900 5105-REWRITE-ASC-LISTQ.                                          26590000
266000                                                                  26600000
266100     EXEC CICS                                                    26610000
266200         WRITEQ TS                                                26620000
266300             QUEUE (ASC-LIST-QUEUE-NAME)                          26630000
266400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26640000
266500             ITEM  (PV-BLOCK-NUMBER)                              26650000
266600             REWRITE                                              26660000
266700             RESP  (PV-CICS-RESP)                                 26670000
266800     END-EXEC.                                                    26680000
266900                                                                  26690000
267000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           26700000
267100         CONTINUE                                                 26710000
267200     ELSE                                                         26720000
267300         SET DP013-CICS-ABEND            TO TRUE                  26730000
267400         SET DP013-NO-ROLLBACK           TO TRUE                  26740000
267500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       26750000
267600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     26760000
267700                                         TO DP013-MESSAGE-TEXT(1) 26770000
267800         PERFORM DP013-0000-PROCESS-ABEND                         26780000
267900     END-IF.                                                      26790000
268000                                                                  26800000
268100                                                                  26810000
268200                                                                  26820000
268300******************************************************************26830000
268400** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26840000
268500** SPECIFIC COMMAREA.                                           **26850000
268600******************************************************************26860000
268700                                                                  26870000
268800 5110-WRITE-ASC-LISTQ.                                            26880000
268900                                                                  26890000
269000     EXEC CICS                                                    26900000
269100         WRITEQ TS                                                26910000
269200             QUEUE (ASC-LIST-QUEUE-NAME)                          26920000
269300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26930000
269400             ITEM  (PV-BLOCK-NUMBER)                              26940000
269500             RESP  (PV-CICS-RESP)                                 26950000
269600     END-EXEC.                                                    26960000
269700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26970000
269800         SET DP013-CICS-ABEND      TO TRUE                        26980000
269900         SET DP013-NO-ROLLBACK     TO TRUE                        26990000
270000         MOVE '5110-WRITE-ASC-LISTQ'                              27000000
270100                                   TO DP013-PARAGRAPH             27010000
270200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           27020000
270300                                   TO DP013-MESSAGE-TEXT(1)       27030000
270400         PERFORM DP013-0000-PROCESS-ABEND                         27040000
270500     END-IF.                                                      27050000
270600                                                                  27060000
270700                                                                  27070000
270800                                                                  27080000
270900******************************************************************27090000
271000* ADD ADDRESS                                                    *27100000
271100******************************************************************27110000
271200                                                                  27120000
271300 5300-ADD-ADDRESS.                                                27130000
271400                                                                  27140000
271500     PERFORM 4310-FETCH.                                          27150000
271600     IF ASC-SEL-FUNC-POS(PV-SEL-FUNC-CNT) > ZEROES                27160000
271700        MOVE BUSFNC-FUNCTION-ID TO ASC-KEY-FUNCTION-ID            27170000
271800        IF ASC-KEY-FUNCTION-ID NOT = PV-FUNCTION-ID-HOLD          27180000
271900           PERFORM 5400-VERIFY-FUNCTION-ID                        27190000
272000           IF PS-ERROR                                            27200000
272100              CONTINUE                                            27210000
272200           ELSE                                                   27220000
272300              PERFORM 5700-VERIFY-CORP-PO-FNCTN-IDS               27230000
272400              IF PS-ERROR                                         27240000
272500                 CONTINUE                                         27250000
272600              ELSE                                                27260000
272700                 PERFORM 7005-ADD-ADDRESS                         27270000
272800                 IF PS-ERROR                                      27280000
272900                    CONTINUE                                      27290029
273000                 ELSE                                             27300000
273100                    IF (ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID27310000
273200                                         OR   PC-1099-FUNCTION-ID)27320000
273300                       PERFORM 7200-SELECT-TENTNME04              27330000
273400                       MOVE ENTNME-ENT-NAME-DESC TO               27340000
273500                            WS-VENDOR-SHORTNAME                   27350000
273600                       PERFORM 7300-SELECT-TENTNME01              27360000
273800                       MOVE 'A'             TO VNADAU-AUD-FUNC-CDE27380000
273900                       MOVE ASC-KEY-ENT-ID  TO VNADAU-ENT-ID      27390000
274000                       PERFORM 7450-MOVES-TO-VENDOR-DETAIL        27400000
274100                       PERFORM 7460-INSERT-ADDR-HISTORY-ROW       27410000
274200                    ELSE                                          27420000
274300                       PERFORM 7100-SELECT-TEXTENT                27430000
274400                       PERFORM 7300-SELECT-TENTNME01              27440000
274500                       IF (ASC-KEY-FUNCTION-ID  =                 27450000
274600                           PC-CORP-FUNCTION-ID  OR                27460000
274700                           PC-PO-FUNCTION-ID)                     27470000
274800                           PERFORM 7470-DETERMINE-RMS-INTERFACE   27480000
274900                       END-IF                                     27490000
275000                    END-IF                                        27500000
275100                 END-IF                                           27510000
275200              END-IF                                              27520000
275300           END-IF                                                 27530000
275400        END-IF                                                    27540000
275500     END-IF.                                                      27550000
275600                                                                  27560000
275700     ADD 1 TO PV-SEL-FUNC-CNT.                                    27570000
275800                                                                  27580000
275999                                                                  27599943
276100******************************************************************27610000
276200* VERIFY REMIT AND 1099 ADDRESS "COPY TO" HAS A MESSAGE           27620000
276300* DISPLAYED MENTIONING THE POTENTIAL FOR ADDRESS TRUNCATION       27630000
276400******************************************************************27640000
276500                                                                  27650000
276600 5400-VERIFY-FUNCTION-ID.                                         27660000
276700                                                                  27670000
276800     IF (ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID OR            27680000
276900                               PC-1099-FUNCTION-ID) AND           27690000
277000        (DK-FUNCTION-ID NOT  = PC-REMIT-FUNCTION-ID OR            27700000
277100                               PC-1099-FUNCTION-ID)               27710000
277200                                                                  27720000
277300         IF ASC-ADDR4-DESC > SPACES                               27730000
277400*            --- ADDRESS MAY BE TRUNCATED ---                     27740000
277500             MOVE PC-TSYMSG-01966      TO DP020-MSG-NUMBER        27750000
277600             SET DP020-MSG-INFORMATIONAL                          27760000
277700                                       TO TRUE                    27770000
277800         END-IF                                                   27780000
277900                                                                  27790000
278000         IF ASC-ADDR1-DESC (36:5) > SPACES OR                     27800000
278100            ASC-ADDR2-DESC (36:5) > SPACES OR                     27810000
278200            ASC-ADDR3-DESC (36:5) > SPACES                        27820000
278300               SET PS-ERROR                                       27830000
278400                   DP020-MSG-FATAL                                27840000
278500                   DP030-SET-CURSOR-TRAILER                       27850000
278600                                    TO TRUE                       27860000
278700               MOVE PC-TSYMSG-01957 TO DP020-MSG-NUMBER           27870000
278800         END-IF                                                   27880000
278900                                                                  27890000
279000     END-IF.                                                      27900000
279100                                                                  27910000
279200     IF PS-ERROR                                                  27920000
279300         CONTINUE                                                 27930000
279400     ELSE                                                         27940000
279500         IF ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID             27950000
279600             PERFORM 5500-SELECT-TBUSLOC                          27960000
279700             PERFORM 5600-INITIALIZE-CONTACT-INFO                 27970000
279800         END-IF                                                   27980000
279900     END-IF.                                                      27990000
280000                                                                  28000000
280100                                                                  28010000
280200                                                                  28020000
280300******************************************************************28030000
280400* CHECK TO SEE IF A 1099 VENDOR ALREADY EXISTS                   *28040000
280500******************************************************************28050000
280600                                                                  28060000
280700 5500-SELECT-TBUSLOC.                                             28070000
280800                                                                  28080000
280900     PERFORM                                                      28090000
281000         WITH TEST AFTER                                          28100000
281100         VARYING PV-RETRY-COUNTER                                 28110000
281200         FROM 1 BY 1                                              28120000
281300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28130000
281400             OR (SQLCODE = +0))                                   28140000
281500                                                                  28150000
281600         EXEC SQL                                                 28160000
281700              SELECT COUNT(*)                                     28170000
281800                INTO :PV-1099-ADDRESS-CNT                         28180000
281900                FROM TBUSLOC                                      28190000
282000               WHERE ENT_ID = :DK-ENT-ID                          28200000
282100                 AND FUNCTION_ID = :PC-1099-FUNCTION-ID           28210000
282200         END-EXEC                                                 28220000
282300                                                                  28230000
282400         EVALUATE TRUE                                            28240000
282500             WHEN SQLCODE = +0                                    28250000
282600                  IF PV-1099-ADDRESS-CNT > 0                      28260000
282700                      SET PS-ERROR                                28270000
282800                          DP020-MSG-FATAL                         28280000
282900                          DP030-SET-CURSOR-TRAILER                28290000
283000                                     TO TRUE                      28300000
283100                      MOVE PC-TSYMSG-01958 TO DP020-MSG-NUMBER    28310000
283200                  END-IF                                          28320000
283300             WHEN SQLCODE = -904                                  28330000
283400             WHEN SQLCODE = -913                                  28340000
283500                  CONTINUE                                        28350000
283600                                                                  28360000
283700             WHEN SQLWARN0 NOT = SPACES                           28370000
283800             WHEN SQLCODE < +0                                    28380000
283900             WHEN SQLCODE > +0                                    28390000
284000                  MOVE '5500-SELECT-TBUSLOC'                      28400000
284100                                  TO DP013-PARAGRAPH              28410000
284200                  MOVE 'UNSUCCESSFUL SELECT '                     28420000
284300                                  TO DP013-MESSAGE-TEXT (1)       28430000
284400                  MOVE SQLCA      TO DP013-SQLCA                  28440000
284500                  MOVE 'TBUSLOC ' TO DP013-DB2-TABLE-NAME (1)     28450000
284600                  SET DP013-DB2-ABEND                             28460000
284700                      DP013-XCTL-DISPLAY-RESTART                  28470000
284800                                  TO TRUE                         28480000
284900                  PERFORM DP013-0000-PROCESS-ABEND                28490000
285000         END-EVALUATE                                             28500000
285100     END-PERFORM.                                                 28510000
285200                                                                  28520000
285300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28530000
285400         MOVE '5500-SELECT-TBUSLOC'                               28540000
285500                                  TO DP013-PARAGRAPH              28550000
285600         MOVE 'MAX RETRIES EXCEEDED ON SELECT '                   28560000
285700                                  TO DP013-MESSAGE-TEXT (1)       28570000
285800         MOVE SQLCA               TO DP013-SQLCA                  28580000
285900         MOVE 'TBUSLOC '          TO DP013-DB2-TABLE-NAME (1)     28590000
286000         SET DP013-DB2-ABEND                                      28600000
286100             DP013-XCTL-DISPLAY-RESTART                           28610000
286200                                  TO TRUE                         28620000
286300         PERFORM DP013-0000-PROCESS-ABEND                         28630000
286400     END-IF.                                                      28640000
286500                                                                  28650000
286600                                                                  28660000
286700                                                                  28670000
286800*----------------------------------------------------------------*28680000
286900*    INITIALIZE ALL CONTACT INFORMATION WHEN COPYING TO A 1099   *28690000
287000*    ADDRESS                                                     *28700000
287100*----------------------------------------------------------------*28710000
287200                                                                  28720000
287300 5600-INITIALIZE-CONTACT-INFO.                                    28730000
287400                                                                  28740000
287500     INITIALIZE ASC-EMAIL-ADDR                                    28750000
287600                ASC-FIRST-NAME                                    28760000
287700                ASC-LAST-NAME                                     28770000
287800                ASC-TITLE                                         28780000
287900                ASC-TEL1-NBR                                      28790000
288000                ASC-TEL1-EXT-NBR                                  28800000
288100                ASC-TEL2-NBR                                      28810000
288200                ASC-TEL2-EXT-NBR                                  28820000
288300                ASC-FAX-NBR                                       28830000
288400                ASC-TEL1-CNTY-PH-CD                               28840000
288500                ASC-TEL2-CNTY-PH-CD.                              28850000
288600                                                                  28860000
288700                                                                  28870000
288800                                                                  28880000
288900******************************************************************28890000
289000* VERIFY THE COPY PROCESS OF THE CORPORATE AND PURCHASE ORDER    *28900000
289100* FUNCTION IDS.  THESE TWO FUNCTION IDS CAN ONLY BE COPIED TO    *28910000
289200* THEMSELVES OR EACH OTHER, NOT TO ANY OTHER FUNCTION ID.        *28920000
289300* AN ERROR MESSAGE WILL BE DISPLAYED WHEN AN ATTEMPT IS MADE TO  *28930000
289400* COPY ANY ADDRESS INFORMATION FROM ANOTHER FUNCTION ID TO EITHER*28940000
289500* OF THESE IDS.                                                  *28950000
289600******************************************************************28960000
289700                                                                  28970000
289800 5700-VERIFY-CORP-PO-FNCTN-IDS.                                   28980000
289900                                                                  28990000
290000     IF (ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID OR             29000000
290100                               PC-PO-FUNCTION-ID)  AND            29010000
290200        (DK-FUNCTION-ID      = PC-CORP-FUNCTION-ID OR             29020000
290300                               PC-PO-FUNCTION-ID)                 29030000
290400        CONTINUE                                                  29040000
290500     ELSE                                                         29050000
290600                                                                  29060000
290700     IF (ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID OR             29070000
290800                               PC-PO-FUNCTION-ID)  AND            29080000
290900        (DK-FUNCTION-ID NOT  = PC-CORP-FUNCTION-ID OR             29090000
291000                               PC-PO-FUNCTION-ID)                 29100000
291100        SET PS-ERROR                                              29110000
291200            DP020-MSG-FATAL                                       29120000
291300            DP030-SET-CURSOR-TRAILER TO TRUE                      29130000
291400                                                                  29140000
291500        MOVE PC-TSYMSG-02623 TO DP020-MSG-NUMBER                  29150000
291600     END-IF                                                       29160000
291700     END-IF.                                                      29170000
291800                                                                  29180000
291900                                                                  29190000
292000                                                                  29200000
292100******************************************************************29210000
292200* GET THE ADDRESS FOR THE COPIED FUNCTION                        *29220000
292300******************************************************************29230000
292400                                                                  29240000
292500 7001-GET-ADDRESS.                                                29250000
292600                                                                  29260000
292700     PERFORM                                                      29270000
292800         WITH TEST AFTER                                          29280000
292900         VARYING PV-RETRY-COUNTER                                 29290000
293000         FROM 1 BY 1                                              29300000
293100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29310000
293200            OR (SQLCODE = +0))                                    29320000
293300                                                                  29330000
293400       EXEC SQL                                                   29340000
293500           SELECT A.ENT_ID                                        29350000
293600                 ,A.SEQ_NBR                                       29360000
293700                 ,A.FIRST_NAME                                    29370000
293800                 ,A.LAST_NAME                                     29380000
293900                 ,A.TITLE_NAME                                    29390000
294000                 ,A.TEL1_NBR                                      29400000
294100                 ,A.TEL1_EXT_NBR                                  29410000
294200                 ,A.TEL2_NBR                                      29420000
294300                 ,A.TEL2_EXT_NBR                                  29430000
294400                 ,A.FAX_NBR                                       29440000
294500                 ,A.FUNCTION_ID                                   29450000
294600                 ,A.LAST_UPDATE_ID                                29460000
294700                 ,A.TEL_1_CNTRY_CDE                               29470000
294800                 ,A.TEL_2_CNTRY_CDE                               29480000
294900                 ,B.SEQ_NBR                                       29490000
295000                 ,B.ADDRESS_LINE1_DESC                            29500000
295100                 ,B.ADDRESS_LINE2_DESC                            29510000
295200                 ,B.ADDRESS_LINE3_DESC                            29520000
295300                 ,B.ADDRESS_LINE4_DESC                            29530000
295400                 ,B.ATTENTION_TO_TXT                              29540000
295500                 ,B.CITY_NAME                                     29550000
295600                 ,B.STATE_CDE                                     29560000
295700                 ,B.ZIP_CDE                                       29570000
295800                 ,B.ROOM_NBR                                      29580000
295900                 ,B.COMMENT1_TXT                                  29590000
296000                 ,B.COMMENT2_TXT                                  29600000
296100                 ,B.COMMENT3_TXT                                  29610000
296200                 ,A.EMAIL_ADDR_ID                                 29620000
296300                 ,B.ST_PROV_CDE                                   29630000
296400                 ,B.CNTRY_CDE                                     29640000
296500                 ,B.EXTD_VND_NM                                   29650000
296600                 ,B.ALT_1099_VND_NM                               29660000
296700            INTO :ENTREP-ENT-ID                                   29670000
296800                 ,:ENTREP-SEQ-NBR                                 29680000
296900                 ,:ASC-FIRST-NAME                                 29690000
297000                 ,:ASC-LAST-NAME                                  29700000
297100                 ,:ASC-TITLE                                      29710000
297200                 ,:ASC-TEL1-NBR                                   29720000
297300                 ,:ASC-TEL1-EXT-NBR                               29730000
297400                 ,:ASC-TEL2-NBR                                   29740000
297500                 ,:ASC-TEL2-EXT-NBR                               29750000
297600                 ,:ASC-FAX-NBR                                    29760000
297700                 ,:ENTREP-FUNCTION-ID                             29770000
297800                 ,:ASC-LAST-UPDATE-ID                             29780000
297900                 ,:ASC-TEL1-CNTY-PH-CD                            29790000
298000                 ,:ASC-TEL2-CNTY-PH-CD                            29800000
298100                 ,:BUSLOC-SEQ-NBR                                 29810000
298200                 ,:ASC-ADDR1-DESC                                 29820000
298300                 ,:ASC-ADDR2-DESC                                 29830000
298400                 ,:ASC-ADDR3-DESC                                 29840000
298500                 ,:ASC-ADDR4-DESC                                 29850000
298600                 ,:ASC-ATTENTION-TO-TXT                           29860000
298700                 ,:ASC-CITY                                       29870000
298800                 ,:ASC-STATE-CDE                                  29880000
298900                 ,:ASC-ZIP                                        29890000
299000                 ,:ASC-ROOM-NBR                                   29900000
299100                 ,:ASC-COMMENT1-TXT                               29910000
299200                 ,:ASC-COMMENT2-TXT                               29920000
299300                 ,:ASC-COMMENT3-TXT                               29930000
299400                 ,:ASC-EMAIL-ADDR                                 29940000
299500                 ,:ASC-ST-PROV-CDE                                29950000
299600                 ,:ASC-COUNTRY-CDE                                29960000
299700                 ,:ASC-EXTD-VND-NM                                29970000
299800                 ,:ASC-1099-VND-NM                                29980000
299900                                                                  29990000
300000           FROM TENTREP A                                         30000000
300100               ,TBUSLOC B                                         30010000
300200                                                                  30020000
300300           WHERE A.ENT_ID         = :DK-ENT-ID                    30030000
300400             AND A.FUNCTION_ID    = :DK-FUNCTION-ID               30040000
300500             AND A.SEQ_NBR        = :DK-REP-SEQ-NBR               30050000
300600             AND B.SEQ_NBR        = A.ENT_BUS_LOC_ID              30060000
300700             AND B.ENT_ID         = A.ENT_ID                      30070000
300800             AND B.FUNCTION_ID    = A.FUNCTION_ID                 30080000
300900       END-EXEC                                                   30090000
301000                                                                  30100000
301100         EVALUATE TRUE                                            30110000
301200             WHEN SQLCODE = +0                                    30120000
301300             WHEN SQLCODE = -904                                  30130000
301400             WHEN SQLCODE = -913                                  30140000
301500                 CONTINUE                                         30150000
301600             WHEN SQLWARN0 NOT = SPACE                            30160000
301700             WHEN SQLCODE < +0                                    30170000
301800             WHEN SQLCODE > +0                                    30180000
301900                 MOVE '7001-GET-ADDRESS'                          30190000
302000                                 TO DP013-PARAGRAPH               30200000
302100                 MOVE 'SELECT ON ENTERPRISE NAME TABLE'           30210000
302200                                 TO DP013-MESSAGE-TEXT (1)        30220000
302300                 MOVE SQLCA      TO DP013-SQLCA                   30230000
302400                 MOVE 'TENTREP'  TO DP013-DB2-TABLE-NAME (1)      30240000
302500                     SET DP013-DB2-ABEND                          30250000
302600                         DP013-XCTL-DISPLAY-RESTART               30260000
302700                                 TO TRUE                          30270000
302800                 PERFORM DP013-0000-PROCESS-ABEND                 30280000
302900         END-EVALUATE                                             30290000
303000     END-PERFORM.                                                 30300000
303100                                                                  30310000
303200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30320000
303300         MOVE '7001-GET-ADDRESS' TO DP013-PARAGRAPH               30330000
303400         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TENTREP'        30340000
303500                                   TO DP013-MESSAGE-TEXT (1)      30350000
303600         MOVE SQLCA                TO DP013-SQLCA                 30360000
303700         SET DP013-DB2-ABEND       TO TRUE                        30370000
303800         PERFORM DP013-0000-PROCESS-ABEND                         30380000
303900     END-IF.                                                      30390000
304000                                                                  30400000
304100                                                                  30410000
304200                                                                  30420000
304300******************************************************************30430000
304400* ADD THE ADDRESS TO THE SELECTED FUNCTION                       *30440000
304500******************************************************************30450000
304600                                                                  30460000
304700 7005-ADD-ADDRESS.                                                30470000
304800                                                                  30480000
304900     MOVE ASC-KEY-ENT-ID           TO DK-ENT-ID.                  30490000
305000     MOVE ASC-KEY-FUNCTION-ID      TO DK-FUNCTION-ID.             30500000
305100                                                                  30510000
305200     PERFORM 7010-MAX-TBUSLOC.                                    30520000
305400                                                                  30540000
305500     INITIALIZE DCLTBUSLOC                                        30550000
305600                DCLTENTREP.                                       30560000
305700                                                                  30570000
305800     MOVE ASC-KEY-FUNCTION-ID TO PV-HOLD-FUNCTION-ID.             30580000
305900                                                                  30590000
306000     IF (PV-HOLD-FUNCTION-ID NOT = +2) AND                        30600000
306100        (PV-HOLD-FUNCTION-ID NOT = +4)                            30610000
306200        MOVE 'N' TO PV-PRIM-ADDR-IND                              30620000
306300**   END-IF.                                                      30630000
306400     ELSE                                                         30640000
306500        IF PV-HOLD-FUNCTION-ID = +2                               30650000
306600           PERFORM 7600-GET-PO-FUNCTION-ID                        30660000
306700        ELSE                                                      30670000
306800           IF PV-HOLD-FUNCTION-ID = +4                            30680000
306900              PERFORM 7605-GET-CORP-FUNCTION-ID                   30690000
307000           END-IF                                                 30700000
307100        END-IF                                                    30710000
307200     END-IF.                                                      30720000
307300                                                                  30730000
307400     PERFORM 7020-INSERT-TBUSLOC.                                 30740000
307500                                                                  30750000
307600     IF  SQLCODE = -803                                           30760000
307700         SET PS-ERROR                                             30770000
307800             DP020-MSG-FATAL                                      30780000
307900             DP030-SET-CURSOR-TRAILER                             30790000
308000                                   TO TRUE                        30800000
308100         MOVE PC-TSYMSG-00117      TO DP020-MSG-NUMBER            30810000
308200     ELSE                                                         30820000
308300         PERFORM 7030-MAX-TENTREP                                 30830000
308400         PERFORM 7040-INSERT-TENTREP                              30840000
308500         IF  SQLCODE = +0                                         30850000
308600             IF DP020-MSG-NUMBER = PC-TSYMSG-01966                30860000
308700                 SET ASC-ADD-SUCCESSFUL TO TRUE                   30870000
308800             ELSE                                                 30880000
308900                 MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER        30890000
309000                 SET DP020-MSG-INFORMATIONAL                      30900000
309100                     ASC-ADD-SUCCESSFUL TO TRUE                   30910000
309200             END-IF                                               30920000
309300         ELSE                                                     30930000
309400            IF  SQLCODE = -803                                    30940000
309500                SET PS-ERROR                                      30950000
309600                    DP020-MSG-FATAL                               30960000
309700                    DP030-SET-CURSOR-TRAILER                      30970000
309800                                     TO TRUE                      30980000
309900                MOVE PC-TSYMSG-00117 TO DP020-MSG-NUMBER          30990000
310000            END-IF                                                31000000
310100         END-IF                                                   31010000
310200     END-IF.                                                      31020000
310300                                                                  31030000
310400                                                                  31040000
310500                                                                  31050000
310600******************************************************************31060000
310700*  GET THE MAXIMUN TBUSLOC SEQ-NBR                                31070000
310800******************************************************************31080000
310900                                                                  31090000
311000 7010-MAX-TBUSLOC.                                                31100000
311100                                                                  31110000
311200     PERFORM                                                      31120000
311300         WITH TEST AFTER                                          31130000
311400         VARYING PV-RETRY-COUNTER                                 31140000
311500         FROM 1 BY 1                                              31150000
311600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31160000
311700             OR (SQLCODE = +0)                                    31170000
311800             OR (SQLCODE = -305))                                 31180000
311900                                                                  31190000
312000         EXEC SQL                                                 31200000
312100              SELECT MAX(SEQ_NBR)                                 31210000
312200                INTO :PV-MAX-TBUSLOC-SEQ-NBR                      31220000
312300                FROM TBUSLOC                                      31230000
312400               WHERE ENT_ID = :DK-ENT-ID                          31240000
312500         END-EXEC                                                 31250000
312600                                                                  31260000
312700         EVALUATE TRUE                                            31270000
312800             WHEN SQLCODE = +0                                    31280000
312900                  COMPUTE PV-NEXT-TBUSLOC-SEQ-NBR =               31290000
313000                          PV-MAX-TBUSLOC-SEQ-NBR + 1              31300000
313100             WHEN SQLCODE = -305                                  31310000
313200                  MOVE +1         TO PV-NEXT-TBUSLOC-SEQ-NBR      31320000
313300             WHEN SQLCODE = -904                                  31330000
313400             WHEN SQLCODE = -913                                  31340000
313500                  CONTINUE                                        31350000
313600                                                                  31360000
313700             WHEN SQLWARN0 NOT = SPACES                           31370000
313800             WHEN SQLCODE < +0                                    31380000
313900             WHEN SQLCODE > +0                                    31390000
314000                  MOVE '7010-MAX-TBUSLOC'                         31400000
314100                                  TO DP013-PARAGRAPH              31410000
314200                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          31420000
314300                                  TO DP013-MESSAGE-TEXT (1)       31430000
314400                  MOVE SQLCA      TO DP013-SQLCA                  31440000
314500                  MOVE 'TBUSLOC ' TO DP013-DB2-TABLE-NAME (1)     31450000
314600                  SET DP013-DB2-ABEND                             31460000
314700                      DP013-XCTL-DISPLAY-RESTART                  31470000
314800                                  TO TRUE                         31480000
314900                  PERFORM DP013-0000-PROCESS-ABEND                31490000
315000         END-EVALUATE                                             31500000
315100     END-PERFORM.                                                 31510000
315200                                                                  31520000
315300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31530000
315400         MOVE '7010-MAX-TBUSLOC'  TO DP013-PARAGRAPH              31540000
315500         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        31550000
315600                                  TO DP013-MESSAGE-TEXT (1)       31560000
315700         MOVE SQLCA               TO DP013-SQLCA                  31570000
315800         MOVE 'TBUSLOC '          TO DP013-DB2-TABLE-NAME (1)     31580000
315900         SET DP013-DB2-ABEND                                      31590000
316000             DP013-XCTL-DISPLAY-RESTART                           31600000
316100                                  TO TRUE                         31610000
316200         PERFORM DP013-0000-PROCESS-ABEND                         31620000
316300     END-IF.                                                      31630000
316400                                                                  31640000
316500                                                                  31650000
316600                                                                  31660000
316700******************************************************************31670000
316800*  INSERT THE DATA TO TBUSLOC                                     31680000
316900******************************************************************31690000
317000                                                                  31700000
317100 7020-INSERT-TBUSLOC.                                             31710000
317200                                                                  31720000
317300     PERFORM                                                      31730000
317400         WITH TEST AFTER                                          31740000
317500         VARYING PV-RETRY-COUNTER                                 31750000
317600         FROM 1 BY 1                                              31760000
317700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31770000
317800             OR (SQLCODE = +0)                                    31780000
317900             OR (SQLCODE = -803))                                 31790000
318000                                                                  31800000
318100         EXEC SQL                                                 31810000
318200             INSERT  INTO TBUSLOC                                 31820000
318300                   ( ENT_ID                                       31830000
318400                    ,SEQ_NBR                                      31840000
318500                    ,ADDRESS_LINE1_DESC                           31850000
318600                    ,ADDRESS_LINE2_DESC                           31860000
318700                    ,ADDRESS_LINE3_DESC                           31870000
318800                    ,ADDRESS_LINE4_DESC                           31880000
318900                    ,ATTENTION_TO_TXT                             31890000
319000                    ,CITY_NAME                                    31900000
319100                    ,STATE_CDE                                    31910000
319200                    ,ZIP_CDE                                      31920000
319300                    ,ROOM_NBR                                     31930000
319400                    ,COMMENT1_TXT                                 31940000
319500                    ,COMMENT2_TXT                                 31950000
319600                    ,COMMENT3_TXT                                 31960000
319700                    ,FUNCTION_ID                                  31970000
319800                    ,LAST_UPDATE_TMST                             31980000
319900                    ,LAST_UPDATE_ID                               31990000
320000                    ,ST_PROV_CDE                                  32000000
320100                    ,CNTRY_CDE                                    32010000
320200                    ,EXTD_VND_NM                                  32020000
320300                    ,ALT_1099_VND_NM                              32030000
320400                    ,PRIM_ADDR_IND)                               32040000
320500            VALUES  (:DK-ENT-ID                                   32050000
320600                    ,:PV-NEXT-TBUSLOC-SEQ-NBR                     32060000
320700                    ,:ASC-ADDR1-DESC                              32070000
320800                    ,:ASC-ADDR2-DESC                              32080000
320900                    ,:ASC-ADDR3-DESC                              32090000
321000                    ,:ASC-ADDR4-DESC                              32100000
321100                    ,:ASC-ATTENTION-TO-TXT                        32110000
321200                    ,:ASC-CITY                                    32120000
321300                    ,:ASC-STATE-CDE                               32130000
321400                    ,:ASC-ZIP                                     32140000
321500                    ,:ASC-ROOM-NBR                                32150000
321600                    ,:ASC-COMMENT1-TXT                            32160000
321700                    ,:ASC-COMMENT2-TXT                            32170000
321800                    ,:ASC-COMMENT3-TXT                            32180000
321900                    ,:DK-FUNCTION-ID                              32190000
322000                    , CURRENT TIMESTAMP                           32200000
322100                    ,:DP020-USERID                                32210000
322200                    ,:ASC-ST-PROV-CDE                             32220000
322300                    ,:ASC-COUNTRY-CDE                             32230000
322400                    ,'                                        '   32240000
322500                    ,'                                        '   32250000
322600                    ,:PV-PRIM-ADDR-IND                         )  32260000
322700         END-EXEC                                                 32270000
322800                                                                  32280000
322900         EVALUATE TRUE                                            32290000
323000             WHEN SQLCODE = +0                                    32300000
323100             WHEN SQLCODE = -803                                  32310000
323200             WHEN SQLCODE = -904                                  32320000
323300             WHEN SQLCODE = -913                                  32330000
323400                 CONTINUE                                         32340000
323500             WHEN SQLWARN0 NOT = SPACES                           32350000
323600             WHEN SQLCODE < +0                                    32360000
323700             WHEN SQLCODE > +0                                    32370000
323800                 MOVE '7020-INSERT-TBUSLOC'                       32380000
323900                                   TO DP013-PARAGRAPH             32390000
324000                 MOVE 'INSERT A ROW ON TBUSLOC'                   32400000
324100                                   TO DP013-MESSAGE-TEXT(1)       32410000
324200                 MOVE SQLCA        TO DP013-SQLCA                 32420000
324300                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    32430000
324400                 SET DP013-DB2-ABEND                              32440000
324500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32450000
324600                 PERFORM DP013-0000-PROCESS-ABEND                 32460000
324700         END-EVALUATE                                             32470000
324800     END-PERFORM.                                                 32480000
324900                                                                  32490000
325000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32500000
325100         MOVE '7020-INSERT-TBUSLOC'                               32510000
325200                                   TO DP013-PARAGRAPH             32520000
325300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              32530000
325400                                   TO DP013-MESSAGE-TEXT (1)      32540000
325500         MOVE 'TO INSERT A TBUSLOC ROW'                           32550000
325600                                   TO DP013-MESSAGE-TEXT (2)      32560000
325700         MOVE SQLCA                TO DP013-SQLCA                 32570000
325800         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (1)    32580000
325900         SET DP013-DB2-ABEND                                      32590000
326000             DP013-XCTL-DISPLAY-RESTART                           32600000
326100                                   TO TRUE                        32610000
326200         PERFORM DP013-0000-PROCESS-ABEND                         32620000
326300     END-IF.                                                      32630000
326400                                                                  32640000
326500                                                                  32650000
326600                                                                  32660000
326700******************************************************************32670000
326800*  GET THE MAXIMUN TENTREP SEQ-NBR                                32680000
326900******************************************************************32690000
327000                                                                  32700000
327100 7030-MAX-TENTREP.                                                32710000
327200                                                                  32720000
327300     PERFORM                                                      32730000
327400         WITH TEST AFTER                                          32740000
327500         VARYING PV-RETRY-COUNTER                                 32750000
327600         FROM 1 BY 1                                              32760000
327700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32770000
327800             OR (SQLCODE = +0)                                    32780000
327900             OR (SQLCODE = -305))                                 32790000
328000                                                                  32800000
328100         EXEC SQL                                                 32810000
328200              SELECT MAX(SEQ_NBR)                                 32820000
328300                INTO :PV-MAX-TENTREP-SEQ-NBR                      32830000
328400                FROM TENTREP                                      32840000
328500               WHERE ENT_ID = :DK-ENT-ID                          32850000
328600         END-EXEC                                                 32860000
328700                                                                  32870000
328800         EVALUATE TRUE                                            32880000
328900             WHEN SQLCODE = +0                                    32890000
329000                  COMPUTE PV-NEXT-TENTREP-SEQ-NBR =               32900000
329100                          PV-MAX-TENTREP-SEQ-NBR + 1              32910000
329200             WHEN SQLCODE = -305                                  32920000
329300                  MOVE +1         TO PV-NEXT-TENTREP-SEQ-NBR      32930000
329400             WHEN SQLCODE = -904                                  32940000
329500             WHEN SQLCODE = -913                                  32950000
329600                  CONTINUE                                        32960000
329700                                                                  32970000
329800             WHEN SQLWARN0 NOT = SPACES                           32980000
329900             WHEN SQLCODE < +0                                    32990000
330000             WHEN SQLCODE > +0                                    33000000
330100                  MOVE '7030-MAX-TENTREP'                         33010000
330200                                  TO DP013-PARAGRAPH              33020000
330300                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          33030000
330400                                  TO DP013-MESSAGE-TEXT (1)       33040000
330500                  MOVE SQLCA      TO DP013-SQLCA                  33050000
330600                  MOVE 'TENTREP ' TO DP013-DB2-TABLE-NAME (1)     33060000
330700                  SET DP013-DB2-ABEND                             33070000
330800                      DP013-XCTL-DISPLAY-RESTART                  33080000
330900                                  TO TRUE                         33090000
331000                  PERFORM DP013-0000-PROCESS-ABEND                33100000
331100         END-EVALUATE                                             33110000
331200     END-PERFORM.                                                 33120000
331300                                                                  33130000
331400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33140000
331500         MOVE '7030-MAX-TENTREP'  TO DP013-PARAGRAPH              33150000
331600         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        33160000
331700                                  TO DP013-MESSAGE-TEXT (1)       33170000
331800         MOVE SQLCA               TO DP013-SQLCA                  33180000
331900         MOVE 'TENTREP '          TO DP013-DB2-TABLE-NAME (1)     33190000
332000         SET DP013-DB2-ABEND                                      33200000
332100             DP013-XCTL-DISPLAY-RESTART                           33210000
332200                                  TO TRUE                         33220000
332300         PERFORM DP013-0000-PROCESS-ABEND                         33230000
332400     END-IF.                                                      33240000
332500                                                                  33250000
332600                                                                  33260000
332700                                                                  33270000
332800******************************************************************33280000
332900*  INSERT THE DATA TO TENTREP                                     33290000
333000******************************************************************33300000
333100                                                                  33310000
333200 7040-INSERT-TENTREP.                                             33320000
333300                                                                  33330000
333400     PERFORM                                                      33340000
333500         WITH TEST AFTER                                          33350000
333600         VARYING PV-RETRY-COUNTER                                 33360000
333700         FROM 1 BY 1                                              33370000
333800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33380000
333900             OR (SQLCODE = +0)                                    33390000
334000             OR (SQLCODE = -803))                                 33400000
334100                                                                  33410000
334200         EXEC SQL                                                 33420000
334300             INSERT  INTO TENTREP                                 33430000
334400                   ( ENT_ID                                       33440000
334500                    ,EMAIL_ADDR_ID                                33450000
334600                    ,SEQ_NBR                                      33460000
334700                    ,FIRST_NAME                                   33470000
334800                    ,LAST_NAME                                    33480000
334900                    ,TITLE_NAME                                   33490000
335000                    ,TEL1_NBR                                     33500000
335100                    ,TEL1_EXT_NBR                                 33510000
335200                    ,TEL2_NBR                                     33520000
335300                    ,TEL2_EXT_NBR                                 33530000
335400                    ,FAX_NBR                                      33540000
335500                    ,ENT_BUS_LOC_ID                               33550000
335600                    ,FUNCTION_ID                                  33560000
335700                    ,LAST_UPDATE_TMST                             33570000
335800                    ,LAST_UPDATE_ID                               33580000
335900                    ,TEL_1_CNTRY_CDE                              33590000
336000                    ,TEL_2_CNTRY_CDE)                             33600000
336100            VALUES  (:DK-ENT-ID                                   33610000
336200                    ,:ASC-EMAIL-ADDR                              33620000
336300                    ,:PV-NEXT-TENTREP-SEQ-NBR                     33630000
336400                    ,:ASC-FIRST-NAME                              33640000
336500                    ,:ASC-LAST-NAME                               33650000
336600                    ,:ASC-TITLE                                   33660000
336700                    ,:ASC-TEL1-NBR                                33670000
336800                    ,:ASC-TEL1-EXT-NBR                            33680000
336900                    ,:ASC-TEL2-NBR                                33690000
337000                    ,:ASC-TEL2-EXT-NBR                            33700000
337100                    ,:ASC-FAX-NBR                                 33710000
337200                    ,:PV-NEXT-TBUSLOC-SEQ-NBR                     33720000
337300                    ,:DK-FUNCTION-ID                              33730000
337400                    , CURRENT TIMESTAMP                           33740000
337500                    ,:DP020-USERID                                33750000
337600                    ,:ASC-TEL1-CNTY-PH-CD                         33760000
337700                    ,:ASC-TEL2-CNTY-PH-CD)                        33770000
337800         END-EXEC                                                 33780000
337900                                                                  33790000
338000         EVALUATE TRUE                                            33800000
338100             WHEN SQLCODE = +0                                    33810000
338200             WHEN SQLCODE = -803                                  33820000
338300             WHEN SQLCODE = -904                                  33830000
338400             WHEN SQLCODE = -913                                  33840000
338500                 CONTINUE                                         33850000
338600             WHEN SQLWARN0 NOT = SPACES                           33860000
338700             WHEN SQLCODE < +0                                    33870000
338800             WHEN SQLCODE > +0                                    33880000
338900                 MOVE '7040-INSERT-TENTREP'                       33890000
339000                                   TO DP013-PARAGRAPH             33900000
339100                 MOVE 'INSERT A ROW ON TENTREP'                   33910000
339200                                   TO DP013-MESSAGE-TEXT(1)       33920000
339300                 MOVE SQLCA        TO DP013-SQLCA                 33930000
339400                 MOVE 'TENTREP'    TO DP013-DB2-TABLE-NAME (1)    33940000
339500                 SET DP013-DB2-ABEND                              33950000
339600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33960000
339700                 PERFORM DP013-0000-PROCESS-ABEND                 33970000
339800         END-EVALUATE                                             33980000
339900     END-PERFORM.                                                 33990000
340000                                                                  34000000
340100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34010000
340200         MOVE '7040-INSERT-TENTREP'                               34020000
340300                                   TO DP013-PARAGRAPH             34030000
340400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              34040000
340500                                   TO DP013-MESSAGE-TEXT (1)      34050000
340600         MOVE 'TO INSERT A TENTREP ROW'                           34060000
340700                                   TO DP013-MESSAGE-TEXT (2)      34070000
340800         MOVE SQLCA                TO DP013-SQLCA                 34080000
340900         MOVE 'TENTREP'            TO DP013-DB2-TABLE-NAME (1)    34090000
341000         SET DP013-DB2-ABEND                                      34100000
341100             DP013-XCTL-DISPLAY-RESTART                           34110000
341200                                   TO TRUE                        34120000
341300         PERFORM DP013-0000-PROCESS-ABEND                         34130000
341400     END-IF.                                                      34140000
341500                                                                  34150000
354000*                                                                 35400010
354100******************************************************************35410010
354200 7100-SELECT-TEXTENT.                                             35420000
354300                                                                  35430000
354400     EXEC SQL                                                     35440000
354500           SELECT                                                 35450000
354600                 DUN_NBR                                          35460000
354700                ,PRNT_CO_ENT_ID                                   35470000
354800                ,PRNT_CO_IND                                      35480000
354900                ,FED_TX_ID_NBR                                    35490000
355000                ,FED_TX_ID_TYP_CDE                                35500000
355100                ,STATUS_CDE                                       35510000
355200                ,VND_CLSN_CDE                                     35520000
355300                ,VND_PRSST_CDE                                    35530000
355400                ,CAP_EXP_CDE                                      35540000
355500                ,CRE_BY_UID                                       35550000
355600                ,NEED_1099_IND                                    35560000
355700                ,HLD_PAYT_IND                                     35570000
355800                ,PAY_FCTR_VND_IND                                 35580000
355900                ,SEPR_INVC_PAYT_IND                               35590000
356000                ,WHLDG_PAYT_TYP_CDE                               35600000
356100                ,PAYT_HNDLG_CDE                                   35610000
356200                ,EDI_PO_PREPK_CDE                                 35620000
356300                ,PRIM_TYP_CDE                                     35630000
356400                ,PRTNR_TYP_CDE                                    35640000
356500                ,VND_IN_RMS_IND                                   35650000
356600           INTO  :EXTENT-DUN-NBR                                  35660000
356700                ,:EXTENT-PRNT-CO-ENT-ID                           35670000
356800                ,:EXTENT-PRNT-CO-IND                              35680000
356900                ,:EXTENT-FED-TX-ID-NBR                            35690000
357000                ,:EXTENT-FED-TX-ID-TYP-CDE                        35700000
357100                ,:EXTENT-STATUS-CDE                               35710000
357200                ,:EXTENT-VND-CLSN-CDE                             35720000
357300                ,:EXTENT-VND-PRSST-CDE                            35730000
357400                ,:EXTENT-CAP-EXP-CDE                              35740000
357500                ,:EXTENT-CRE-BY-UID                               35750000
357600                ,:EXTENT-NEED-1099-IND                            35760000
357700                ,:EXTENT-HLD-PAYT-IND                             35770000
357800                ,:EXTENT-PAY-FCTR-VND-IND                         35780000
357900                ,:EXTENT-SEPR-INVC-PAYT-IND                       35790000
358000                ,:EXTENT-WHLDG-PAYT-TYP-CDE                       35800000
358100                ,:EXTENT-PAYT-HNDLG-CDE                           35810000
358200                ,:EXTENT-EDI-PO-PREPK-CDE                         35820000
358300                ,:EXTENT-PRIM-TYP-CDE                             35830000
358400                ,:EXTENT-PRTNR-TYP-CDE                            35840000
358500                ,:EXTENT-VND-IN-RMS-IND                           35850000
358600           FROM TEXTENT                                           35860000
358700           WHERE ENT_ID = :DK-ENT-ID                              35870000
358800     END-EXEC.                                                    35880000
358900                                                                  35890000
359000     EVALUATE TRUE                                                35900000
359100           WHEN SQLCODE = ZERO                                    35910000
359200           WHEN SQLCODE = +0                                      35920000
359300           WHEN SQLCODE = -803                                    35930000
359400           WHEN SQLCODE = -904                                    35940000
359500           WHEN SQLCODE = -913                                    35950000
359600              CONTINUE                                            35960000
359700           WHEN SQLWARN0 NOT = SPACES                             35970000
359800           WHEN SQLCODE < +0                                      35980000
359900           WHEN SQLCODE > +0                                      35990000
360000             MOVE '7100-SELECT-TEXTENT'                           36000000
360100                                      TO DP013-PARAGRAPH          36010000
360200             MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '          36020000
360300                                      TO DP013-MESSAGE-TEXT (1)   36030000
360400             MOVE 'TO SELECT A TEXTENT ROW'                       36040000
360500                                      TO DP013-MESSAGE-TEXT (2)   36050000
360600             MOVE SQLCA               TO DP013-SQLCA              36060000
360700             MOVE 'TENTREP'           TO DP013-DB2-TABLE-NAME (1) 36070000
360800             SET DP013-DB2-ABEND                                  36080000
360900                 DP013-XCTL-DISPLAY-RESTART                       36090000
361000                                      TO TRUE                     36100000
361100             PERFORM DP013-0000-PROCESS-ABEND                     36110000
361200     END-EVALUATE.                                                36120000
361300                                                                  36130000
361400     EJECT                                                        36140000
361500                                                                  36150000
361600 7200-SELECT-TENTNME04.                                           36160000
361700                                                                  36170000
361800     EXEC SQL                                                     36180000
361900           SELECT                                                 36190000
362000                 ENT_NAME_DESC                                    36200000
362100           INTO  :ENTNME-ENT-NAME-DESC                            36210000
362200           FROM TENTNME                                           36220000
362300           WHERE ENT_ID = :DK-ENT-ID AND TYPE_CDE = '04'          36230000
362400     END-EXEC.                                                    36240000
362500                                                                  36250000
362600     EVALUATE TRUE                                                36260000
362700           WHEN SQLCODE = ZERO                                    36270000
362800           WHEN SQLCODE = +0                                      36280000
362900           WHEN SQLCODE = -803                                    36290000
363000           WHEN SQLCODE = -904                                    36300000
363100           WHEN SQLCODE = -913                                    36310000
363200             CONTINUE                                             36320000
363300           WHEN SQLWARN0 NOT = SPACES                             36330000
363400           WHEN SQLCODE < +0                                      36340000
363500           WHEN SQLCODE > +0                                      36350000
363600             MOVE '7200-SELECT-TENTNME04'                         36360000
363700                                      TO DP013-PARAGRAPH          36370000
363800             MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '          36380000
363900                                      TO DP013-MESSAGE-TEXT (1)   36390000
364000             MOVE 'TO SELECT A TENTNME ROW'                       36400000
364100                                      TO DP013-MESSAGE-TEXT (2)   36410000
364200             MOVE SQLCA               TO DP013-SQLCA              36420000
364300             MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (1) 36430000
364400             SET DP013-DB2-ABEND                                  36440000
364500                 DP013-XCTL-DISPLAY-RESTART                       36450000
364600                                      TO TRUE                     36460000
364700             PERFORM DP013-0000-PROCESS-ABEND                     36470000
364800     END-EVALUATE.                                                36480000
364900                                                                  36490000
365000     EJECT                                                        36500000
365100                                                                  36510000
365200 7300-SELECT-TENTNME01.                                           36520000
365300                                                                  36530000
365400     EXEC SQL                                                     36540000
365500           SELECT                                                 36550000
365600                 ENT_NAME_DESC                                    36560000
365700           INTO  :ENTNME-ENT-NAME-DESC                            36570000
365800           FROM TENTNME                                           36580000
365900           WHERE ENT_ID = :DK-ENT-ID AND TYPE_CDE = '01'          36590000
366000     END-EXEC.                                                    36600000
366100                                                                  36610000
366200     EVALUATE TRUE                                                36620000
366300           WHEN SQLCODE = ZERO                                    36630000
366400           WHEN SQLCODE = +0                                      36640000
366500           WHEN SQLCODE = -803                                    36650000
366600           WHEN SQLCODE = -904                                    36660000
366700           WHEN SQLCODE = -913                                    36670000
366800              CONTINUE                                            36680000
366900           WHEN SQLWARN0 NOT = SPACES                             36690000
367000           WHEN SQLCODE < +0                                      36700000
367100           WHEN SQLCODE > +0                                      36710000
367200             MOVE '7300-SELECT-TENTNME01'                         36720000
367300                                      TO DP013-PARAGRAPH          36730000
367400             MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '          36740000
367500                                      TO DP013-MESSAGE-TEXT (1)   36750000
367600             MOVE 'TO SELECT A TENTNME ROW'                       36760000
367700                                      TO DP013-MESSAGE-TEXT (2)   36770000
367800             MOVE SQLCA               TO DP013-SQLCA              36780000
367900             MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (1) 36790000
368000             SET DP013-DB2-ABEND                                  36800000
368100                 DP013-XCTL-DISPLAY-RESTART                       36810000
368200                                      TO TRUE                     36820000
368300             PERFORM DP013-0000-PROCESS-ABEND                     36830000
368400     END-EVALUATE.                                                36840000
368500                                                                  36850000
368600     EJECT                                                        36860000
368700                                                                  36870000
382000 7450-MOVES-TO-VENDOR-DETAIL.                                     38200000
382100                                                                  38210000
382200     MOVE PV-NEXT-TBUSLOC-SEQ-NBR TO VNADAU-SEQ-NBR.              38220000
382300     MOVE ASC-FIRST-NAME          TO VNADAU-REP-1ST-NM.           38230000
382400     MOVE ASC-LAST-NAME           TO VNADAU-REP-LAST-NM.          38240000
382500     MOVE ASC-EXTD-VND-NM         TO VNADAU-EXTD-VND-NM.          38250000
382600     MOVE ASC-ADDR1-DESC          TO VNADAU-VND-1ST-LNE-ADDR.     38260000
382700     MOVE ASC-ADDR2-DESC          TO VNADAU-VND-2ND-LNE-ADDR.     38270000
382800     MOVE ASC-ADDR3-DESC          TO VNADAU-VND-3RD-LNE-ADDR.     38280000
382900     MOVE ASC-CITY                TO VNADAU-CTY-NM.               38290000
383000     MOVE ASC-STATE-CDE           TO VNADAU-ST-PROV-CDE.          38300000
383100     MOVE ASC-ZIP                 TO VNADAU-ZIP-CDE.              38310000
383200     MOVE ASC-COUNTRY-CDE         TO VNADAU-CNTRY-CDE.            38320000
383300     MOVE ASC-ATTENTION-TO-TXT    TO VNADAU-ATTN-TO-TXT.          38330000
383400                                                                  38340000
383500     EJECT                                                        38350000
383600                                                                  38360000
383700 7460-INSERT-ADDR-HISTORY-ROW.                                    38370000
383800                                                                  38380000
383900     PERFORM                                                      38390000
384000         WITH TEST AFTER                                          38400000
384100         VARYING PV-RETRY-COUNTER                                 38410000
384200         FROM 1 BY 1                                              38420000
384300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38430000
384400                   OR (SQLCODE = ZERO))                           38440000
384500         EXEC SQL                                                 38450000
384600             INSERT INTO TVNADAU                                  38460000
384700                 (  ENT_ID                                        38470000
384800                  ,SEQ_NBR                                        38480000
384900                  ,AUD_TMST                                       38490000
385000                  ,LAST_UPD_BY_USR_ID                             38500000
385100                  ,AUD_FUNC_CDE                                   38510000
385200                  ,REP_1ST_NM                                     38520000
385300                  ,REP_LAST_NM                                    38530000
385400                  ,EXTD_VND_NM                                    38540000
385500                  ,VND_1ST_LNE_ADDR                               38550000
385600                  ,VND_2ND_LNE_ADDR                               38560000
385700                  ,VND_3RD_LNE_ADDR                               38570000
385800                  ,CTY_NM                                         38580000
385900                  ,ST_PROV_CDE                                    38590000
386000                  ,ZIP_CDE                                        38600000
386100                  ,CNTRY_CDE                                      38610000
386200                  ,ATTN_TO_TXT)                                   38620000
386300             VALUES                                               38630000
386400                 (:VNADAU-ENT-ID                                  38640000
386500                 ,:VNADAU-SEQ-NBR                                 38650000
386600                 ,CURRENT TIMESTAMP                               38660000
386700                 ,:DP020-USERID                                   38670000
386800                 ,:VNADAU-AUD-FUNC-CDE                            38680000
386900                 ,:VNADAU-REP-1ST-NM                              38690000
387000                 ,:VNADAU-REP-LAST-NM                             38700000
387100                 ,:VNADAU-EXTD-VND-NM                             38710000
387200                 ,:VNADAU-VND-1ST-LNE-ADDR                        38720000
387300                 ,:VNADAU-VND-2ND-LNE-ADDR                        38730000
387400                 ,:VNADAU-VND-3RD-LNE-ADDR                        38740000
387500                 ,:VNADAU-CTY-NM                                  38750000
387600                 ,:VNADAU-ST-PROV-CDE                             38760000
387700                 ,:VNADAU-ZIP-CDE                                 38770000
387800                 ,:VNADAU-CNTRY-CDE                               38780000
387900                 ,:VNADAU-ATTN-TO-TXT)                            38790000
388000         END-EXEC                                                 38800000
388100                                                                  38810000
388200         EVALUATE TRUE                                            38820000
388300             WHEN SQLCODE = ZERO                                  38830000
388400             WHEN SQLCODE = -904                                  38840000
388500             WHEN SQLCODE = -913                                  38850000
388600                 CONTINUE                                         38860000
388700             WHEN SQLWARN0 NOT = SPACES                           38870000
388800             WHEN SQLCODE < ZERO                                  38880000
388900             WHEN SQLCODE > ZERO                                  38890000
389000                 MOVE '7460-INSERT-ADDR-HISTORY-ROW'              38900000
389100                                   TO DP013-PARAGRAPH             38910000
389200                 MOVE 'ADD A ROW TO THE ADDRESS HISTORY TBL'      38920000
389300                                   TO DP013-MESSAGE-TEXT(1)       38930000
389400                 MOVE SQLCA        TO DP013-SQLCA                 38940000
389500                 MOVE 'TVNADAU'    TO DP013-DB2-TABLE-NAME (1)    38950000
389600                 SET DP013-DB2-ABEND                              38960000
389700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38970000
389800                 PERFORM DP013-0000-PROCESS-ABEND                 38980000
389900         END-EVALUATE                                             38990000
390000     END-PERFORM.                                                 39000000
390100                                                                  39010000
390200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39020000
390300         MOVE '7460-INSERT-ADDR-HISTORY-ROW'                      39030000
390400                                   TO DP013-PARAGRAPH             39040000
390500         MOVE 'MAX RETRIES EXCEEDED TRYING TO INSERT TVNADAU ROW' 39050000
390600                                   TO DP013-MESSAGE-TEXT (1)      39060000
390700         MOVE SQLCA                TO DP013-SQLCA                 39070000
390800         MOVE 'TVNADAU'            TO DP013-DB2-TABLE-NAME (1)    39080000
390900         SET DP013-DB2-ABEND                                      39090000
391000             DP013-XCTL-DISPLAY-RESTART                           39100000
391100                                   TO TRUE                        39110000
391200         PERFORM DP013-0000-PROCESS-ABEND                         39120000
391300     END-IF.                                                      39130000
391400                                                                  39140000
391500     EJECT                                                        39150000
391600                                                                  39160000
391700 7470-DETERMINE-RMS-INTERFACE.                                    39170000
391800     IF EXTENT-PRIM-TYP-CDE = 'M'                                 39180000
391900        PERFORM 7480-INTERFACE-TO-RMS                             39190000
392000     END-IF.                                                      39200000
392100                                                                  39210000
392200******************************************************************39220000
392300* DETERMINE IF AN INTERFACE TO RMS IS NEEDED.  THERE ARE TWO     *39230000
392400* POSSIBLE SCENARIOS:                                            *39240000
392500* 1) - IF THE VENDOR IS NOT IN RMS YET, AND A PO ADDRESS IS BEING*39250000
392600*      ADDED, THEN CALL VNKCS023 TO VALIDATE THE REST OF THE     *39260000
392700*      REQUIRED DATA.  IF VNKCS023 DETERMINES THAT ALL OF THE    *39270000
392800*      REQUIRED DATA IS AVAILABLE, THEN IT WILL CALL VNKCS024 TO *39280000
392900*      HAVE THE NEW VENDOR MESSAGE FORMATTED AND SENT TO RMS.    *39290000
393000* 2) - IF THE VENDOR IS ALREADY IN RMS, AND A PO OR CORPORATE    *39300000
393100*      ADDRESS IS BEING ADDED, THEN CALL VNKCS024 DIRECTLY TO    *39310000
393200*      SEND THE ADDRESS DATA TO MQ SERIES FOR SUBSEQUENT UPDATING*39320000
393300*      TO RMS.                                                   *39330000
393400******************************************************************39340000
393500 7480-INTERFACE-TO-RMS.                                           39350000
393600     IF (EXTENT-VND-IN-RMS-IND = 'N' AND                          39360000
393700         ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID)                 39370000
393800         PERFORM 7482-CALL-VNKCS023                               39380000
393900         IF VN013-RMS-VENDOR-ADDED                                39390000
394000             PERFORM 7484-UPDATE-TEXTENT                          39400000
394100         END-IF                                                   39410000
394200     ELSE                                                         39420000
394300         IF (EXTENT-VND-IN-RMS-IND  = 'Y' AND                     39430000
394400            (ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID OR         39440000
394500                                   PC-PO-FUNCTION-ID))            39450000
394600             PERFORM 7486-CALL-VNKCS024                           39460000
394700         END-IF                                                   39470000
394800     END-IF.                                                      39480000
394900                                                                  39490000
395000 7482-CALL-VNKCS023.                                              39500000
395100******************************************************************39510000
395200*   CALL PROGRAM VNKCS023; THE DATA BUILDER SUB-ROUTINE.         *39520000
395300******************************************************************39530000
395400     INITIALIZE VN013-VENDOR-INTERFACE-PARMS.                     39540000
395500     SET VN013-ACTION-ADD                                         39550000
395600         VN013-FUNCTION-ADDRESS     TO TRUE.                      39560000
395700     MOVE DK-ENT-ID                 TO VN013-ENT-ID.              39570000
395800     MOVE EXTENT-DUN-NBR            TO VN013-VND-NBR.             39580000
395900     MOVE EXTENT-PRIM-TYP-CDE       TO VN013-PRIM-TYP-CDE.        39590000
396000     MOVE EXTENT-VND-IN-RMS-IND     TO VN013-VND-IN-RMS-IND.      39600000
396100     MOVE EXTENT-STATUS-CDE         TO VN013-STATUS-CDE.          39610000
396200     MOVE EXTENT-EDI-PO-PREPK-CDE   TO VN013-PO-PREPK-CDE.        39620000
396300     MOVE ENTNME-ENT-NAME-DESC      TO VN013-ENT-NAME-DESC.       39630000
396400                                                                  39640000
396500*                                                                 39650000
396600* FEED TBUSLOC FIELDS TO VNKCS023:                                39660000
396700*                                                                 39670000
396800                                                                  39680000
396900     MOVE DK-FUNCTION-ID            TO VN013-FUNCTION-ID.         39690000
397000     MOVE PV-NEXT-TBUSLOC-SEQ-NBR   TO VN013-ADDR-SEQ-NBR.        39700000
397100     MOVE PV-PRIM-ADDR-IND          TO VN013-PRIM-ADDR-IND.       39710000
397200     MOVE ASC-COUNTRY-CDE           TO VN013-CNTRY-CD.            39720000
397300     MOVE ASC-ADDR1-DESC            TO VN013-ADDR-LINE1.          39730000
397400     MOVE ASC-ADDR2-DESC            TO VN013-ADDR-LINE2.          39740000
397500     MOVE ASC-ADDR3-DESC            TO VN013-ADDR-LINE3.          39750000
397600     MOVE ASC-CITY                  TO VN013-CITY.                39760000
397700     MOVE ASC-ST-PROV-CDE           TO VN013-ST-PROV-CDE.         39770000
397800     MOVE ASC-ZIP                   TO VN013-ZIP-CDE.             39780000
397900                                                                  39790000
398000*                                                                 39800000
398100* FEED TENTREP FIELDS TO VNKCS023:                                39810000
398200*                                                                 39820000
398300                                                                  39830000
398400     MOVE ASC-EMAIL-ADDR            TO VN013-EMAIL-ADD.           39840000
398500                                                                  39850000
398600*                                                                 39860000
398700* SINCE FIRST NAME AND LAST NAME ARE 15 POSITIONS EACH ON         39870000
398800* TENTREP, AND ON THE VNKCS023 LAYOUT IT IS A COMBINED FIELD      39880000
398900* OF 20 POSITIONS, PERFORM THE FOLLOWING ROUTINE TO COMBINE       39890000
399000* FIELDS TOGETHER.                                                39900000
399100*                                                                 39910000
399200     INITIALIZE PV-NAME-AREA                                      39920000
399300                PV-FIRST-LAST-NAME-AREA                           39930000
399400                PV-INDEX-HOLD                                     39940000
399500                PS-NO-FIRST-NAME-SW                               39950000
399600                PS-15-BYTE-FIRST-NAME-SW.                         39960000
399700                                                                  39970000
399800     MOVE ASC-FIRST-NAME            TO PV-NAME-AREA.              39980000
399900     PERFORM WITH TEST AFTER                                      39990000
400000       VARYING PV-INDEX FROM 15 BY -1 UNTIL                       40000000
400100         PV-NAME-POSITION (PV-INDEX) NOT EQUAL SPACES OR          40010000
400200         PV-INDEX = 1                                             40020000
400300     END-PERFORM.                                                 40030000
400400                                                                  40040000
400500     IF PV-INDEX = 1 AND PV-NAME-POSITION (PV-INDEX) = SPACE      40050000
400600         SET PS-NO-FIRST-NAME TO TRUE                             40060000
400700     ELSE                                                         40070000
400800         IF PV-INDEX = 15                                         40080000
400900             SET PS-15-BYTE-FIRST-NAME TO TRUE                    40090000
401000         ELSE                                                     40100000
401100             SET PV-INDEX      UP BY 1                            40110000
401200         END-IF                                                   40120000
401300     END-IF.                                                      40130000
401400                                                                  40140000
401500     SET PV-INDEX-HOLD TO PV-INDEX.                               40150000
401600     SET PV-INDEX2     TO 1.                                      40160000
401700                                                                  40170000
401800     IF PS-NO-FIRST-NAME                                          40180000
401900         SET PV-INDEX2 DOWN BY 1                                  40190000
402000     ELSE                                                         40200000
402100         PERFORM WITH TEST AFTER                                  40210000
402200           VARYING PV-INDEX FROM 1 BY 1 UNTIL                     40220000
402300             PV-INDEX EQUAL PV-INDEX-HOLD                         40230000
402400                 SET PV-INDEX2 TO PV-INDEX                        40240000
402500                 MOVE PV-NAME-POSITION      (PV-INDEX) TO         40250000
402600                      PV-FULL-NAME-POSITION (PV-INDEX2)           40260000
402700         END-PERFORM                                              40270000
402800     END-IF.                                                      40280000
402900                                                                  40290000
403000     IF PS-15-BYTE-FIRST-NAME                                     40300000
403100         SET PV-INDEX2 UP BY 1                                    40310000
403200         MOVE ' ' TO PV-FULL-NAME-POSITION (PV-INDEX2)            40320000
403300     END-IF.                                                      40330000
403400                                                                  40340000
403500     MOVE ASC-LAST-NAME             TO PV-NAME-AREA.              40350000
403600                                                                  40360000
403700     PERFORM VARYING PV-INDEX FROM 1 BY 1 UNTIL                   40370000
403800         PV-INDEX  > 15 OR                                        40380000
403900         PV-INDEX2 > 20                                           40390000
404000             SET PV-INDEX2 UP BY 1                                40400000
404100             MOVE PV-NAME-POSITION      (PV-INDEX) TO             40410000
404200                  PV-FULL-NAME-POSITION (PV-INDEX2)               40420000
404300     END-PERFORM.                                                 40430000
404400                                                                  40440000
404500     MOVE PV-FIRST-LAST-NAME-AREA   TO VN013-CONTACT-NAME.        40450000
404600                                                                  40460000
404700     MOVE ASC-TEL1-NBR              TO VN013-TEL1-NBR.            40470000
404800     MOVE ASC-FAX-NBR               TO VN013-FAX-NBR.             40480000
404900                                                                  40490000
405000     EXEC CICS LINK PROGRAM (PC-VNKCS023)                         40500000
405100                    COMMAREA(VN013-COMMAREA)                      40510000
405200                    RESP    (PV-CICS-RESP)                        40520000
405300     END-EXEC.                                                    40530000
405400                                                                  40540000
405500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           40550000
405600         CONTINUE                                                 40560000
405700     ELSE                                                         40570000
405800         SET DP013-ROLLBACK                                       40580000
405900             DP013-XCTL-DISPLAY-RESTART                           40590000
406000             DP013-CICS-ABEND      TO TRUE                        40600000
406100         MOVE '7482-CALL-VNKCS023' TO DP013-PARAGRAPH             40610000
406200         MOVE 'FAILED CALL TO RMS DATA BUILDER ROUTINE: VNKCS023' 40620000
406300                                   TO DP013-MESSAGE-TEXT (1)      40630000
406400         PERFORM DP013-0000-PROCESS-ABEND                         40640000
406500     END-IF.                                                      40650000
406600                                                                  40660000
406700     IF VN013-NO-ERRORS                                           40670000
406800         CONTINUE                                                 40680000
406900     ELSE                                                         40690000
407000         SET DP013-CICS-ABEND                                     40700000
407100             DP013-ROLLBACK                                       40710000
407200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   40720000
407300         MOVE '7482-CALL-VNKCS023'      TO DP013-PARAGRAPH        40730000
407400         MOVE VN013-PROGRAM-NAME        TO PV-ERROR-PGM-NAME      40740000
407500         MOVE VN013-PARAGRAPH-NAME      TO PV-ERROR-PARA-NAME     40750000
407600         MOVE VN013-MESSAGE             TO PV-ERROR-MESSAGE       40760000
407700         IF VN013-DB-ERROR                                        40770000
407800             MOVE 'DB2 ERROR      '     TO PV-ERROR-TYPE          40780000
407900             MOVE 'SQL CODE: '          TO PV-OPTIONAL-TEXT       40790000
408000             MOVE VN013-SQLCODE         TO PV-ERROR-REASON        40800000
408100         ELSE                                                     40810000
408200             MOVE SPACES                TO PV-OPTIONAL-TEXT       40820000
408300                                           PV-ERROR-REASON        40830000
408400             IF VN013-MQ-ERROR                                    40840000
408500                 MOVE 'MQ SERIES ERROR' TO PV-ERROR-TYPE          40850000
408600             ELSE                                                 40860000
408700                 MOVE 'UNKNOWN ERROR  ' TO PV-ERROR-TYPE          40870000
408800             END-IF                                               40880000
408900         END-IF                                                   40890000
409000         MOVE PV-ERROR-MSG-1       TO DP013-MESSAGE-TEXT (2)      40900000
409100         MOVE PV-ERROR-MSG-2       TO DP013-MESSAGE-TEXT (3)      40910000
409200         MOVE PV-ERROR-MSG-3       TO DP013-MESSAGE-TEXT (4)      40920000
409300         PERFORM DP013-0000-PROCESS-ABEND                         40930000
409400     END-IF.                                                      40940000
409500                                                                  40950000
409600     IF VN013-MAX-CPBLTY-EXCEEDED                                 40960000
409700         SET DP030-OVERRIDE-GO TO TRUE                            40970000
409800         MOVE PC-TSYMSG-03380  TO DP020-MSG-NUMBER                40980000
409900         SET DP020-MSG-WARNING TO TRUE                            40990000
410000     END-IF.                                                      41000000
410100                                                                  41010000
410200     IF VN013-MAX-RLTNSHP-EXCEEDED                                41020000
410300         SET DP030-OVERRIDE-GO TO TRUE                            41030000
410400         MOVE PC-TSYMSG-03381  TO DP020-MSG-NUMBER                41040000
410500         SET DP020-MSG-WARNING TO TRUE                            41050000
410600     END-IF.                                                      41060000
410700                                                                  41070000
410800     IF VN013-MAX-ADDR-EXCEEDED                                   41080000
410900         SET DP030-OVERRIDE-GO TO TRUE                            41090000
411000         MOVE PC-TSYMSG-02645  TO DP020-MSG-NUMBER                41100000
411100         SET DP020-MSG-WARNING TO TRUE                            41110000
411200     END-IF.                                                      41120000
411300                                                                  41130000
411400     IF VN013-MAX-DEPT-EXCEEDED                                   41140000
411500         SET DP030-OVERRIDE-GO TO TRUE                            41150000
411600         MOVE PC-TSYMSG-02646  TO DP020-MSG-NUMBER                41160000
411700         SET DP020-MSG-WARNING TO TRUE                            41170000
411800     END-IF.                                                      41180000
411900                                                                  41190000
412000 7484-UPDATE-TEXTENT.                                             41200000
412100     PERFORM                                                      41210000
412200         WITH TEST AFTER                                          41220000
412300         VARYING PV-RETRY-COUNTER                                 41230000
412400         FROM 1 BY 1                                              41240000
412500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41250000
412600                   OR (SQLCODE = ZERO))                           41260000
412700         EXEC SQL                                                 41270000
412800           UPDATE TEXTENT                                         41280000
412900              SET VND_IN_RMS_IND     = 'Y'                        41290000
413000             WHERE ENT_ID  = :ASC-KEY-ENT-ID                      41300000
413100         END-EXEC                                                 41310000
413200                                                                  41320000
413300         EVALUATE TRUE                                            41330000
413400             WHEN SQLCODE = ZERO                                  41340000
413500             WHEN SQLCODE = -904                                  41350000
413600             WHEN SQLCODE = -913                                  41360000
413700                 CONTINUE                                         41370000
413800             WHEN SQLWARN0 NOT = SPACES                           41380000
413900             WHEN SQLCODE < ZERO                                  41390000
414000             WHEN SQLCODE > ZERO                                  41400000
414100                 MOVE '5070-UPDATE-TEXTENT'                       41410000
414200                                   TO DP013-PARAGRAPH             41420000
414300                 MOVE 'UPDATE A ROW ON THE EXTERNAL ENT TABLE'    41430000
414400                                   TO DP013-MESSAGE-TEXT(1)       41440000
414500                 MOVE SQLCA        TO DP013-SQLCA                 41450000
414600                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    41460000
414700                 SET DP013-DB2-ABEND                              41470000
414800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41480000
414900                 PERFORM DP013-0000-PROCESS-ABEND                 41490000
415000         END-EVALUATE                                             41500000
415100     END-PERFORM.                                                 41510000
415200                                                                  41520000
415300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41530000
415400         MOVE '5070-UPDATE-TEXTENT'                               41540000
415500                                   TO DP013-PARAGRAPH             41550000
415600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A VEN41560000
415700-             'DOR'                TO DP013-MESSAGE-TEXT (1)      41570000
415800         MOVE SQLCA                TO DP013-SQLCA                 41580000
415900         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    41590000
416000         SET DP013-DB2-ABEND                                      41600000
416100             DP013-XCTL-DISPLAY-RESTART                           41610000
416200                                   TO TRUE                        41620000
416300         PERFORM DP013-0000-PROCESS-ABEND                         41630000
416400     END-IF.                                                      41640000
416500                                                                  41650000
416600 7486-CALL-VNKCS024.                                              41660000
416700******************************************************************41670000
416800*   CALL PROGRAM VNKCS024 TO SEND ADDRESS INFORMATION TO RMS     *41680000
416900******************************************************************41690000
417000     INITIALIZE VN007-INTERFACE-MESSAGE-PARMS.                    41700000
417100                                                                  41710000
417200     MOVE EXTENT-DUN-NBR            TO VN007-VND-NBR.             41720000
417300     MOVE DK-ENT-ID                 TO VN007-ENT-ID.              41730000
417400                                                                  41740000
417500*                                                                 41750000
417600* FEED ADDRESS FIELDS TO VNKCS024:                                41760000
417700*                                                                 41770000
417800                                                                  41780000
417900     SET VN007-ADDR-IND             TO 1.                         41790000
418000                                                                  41800000
418100     MOVE DK-FUNCTION-ID            TO VN007-FUNCTION-ID          41810000
418200                                      (VN007-ADDR-IND)            41820000
418300                                                                  41830000
418400     MOVE PV-NEXT-TBUSLOC-SEQ-NBR   TO VN007-ADDR-SEQ-NBR         41840000
418500                                      (VN007-ADDR-IND)            41850000
418600                                                                  41860000
418700     MOVE PV-PRIM-ADDR-IND          TO VN007-PRIM-ADDR-IND        41870000
418800                                      (VN007-ADDR-IND)            41880000
418900                                                                  41890000
419000     MOVE ASC-COUNTRY-CDE           TO VN007-CNTRY-CD             41900000
419100                                      (VN007-ADDR-IND)            41910000
419200                                                                  41920000
419300     MOVE ASC-ADDR1-DESC            TO VN007-ADDR-LINE1           41930000
419400                                      (VN007-ADDR-IND)            41940000
419500                                                                  41950000
419600     MOVE ASC-ADDR2-DESC            TO VN007-ADDR-LINE2           41960000
419700                                      (VN007-ADDR-IND)            41970000
419800                                                                  41980000
419900     MOVE ASC-ADDR3-DESC            TO VN007-ADDR-LINE3           41990000
420000                                      (VN007-ADDR-IND)            42000000
420100                                                                  42010000
420200     MOVE ASC-CITY                  TO VN007-CITY                 42020000
420300                                      (VN007-ADDR-IND)            42030000
420400                                                                  42040000
420500     MOVE ASC-ST-PROV-CDE           TO VN007-ST-PROV-CDE          42050000
420600                                      (VN007-ADDR-IND)            42060000
420700                                                                  42070000
420800     MOVE ASC-ZIP                   TO VN007-ZIP-CDE              42080000
420900                                      (VN007-ADDR-IND)            42090000
421000                                                                  42100000
421100     MOVE ASC-EMAIL-ADDR            TO VN007-EMAIL-ADD            42110000
421200                                      (VN007-ADDR-IND)            42120000
421300                                                                  42130000
421400*                                                                 42140000
421500* SINCE FIRST NAME AND LAST NAME ARE 15 POSITIONS EACH ON         42150000
421600* TENTREP, AND ON THE VNKCS024 LAYOUT IT IS A COMBINED FIELD      42160000
421700* OF 20 POSITIONS, PERFORM THE FOLLOWING ROUTINE TO COMBINE       42170000
421800* FIELDS TOGETHER.                                                42180000
421900*                                                                 42190000
422000     INITIALIZE PV-NAME-AREA                                      42200000
422100                PV-FIRST-LAST-NAME-AREA                           42210000
422200                PV-INDEX-HOLD                                     42220000
422300                PS-NO-FIRST-NAME-SW                               42230000
422400                PS-15-BYTE-FIRST-NAME-SW.                         42240000
422500                                                                  42250000
422600     MOVE ASC-FIRST-NAME            TO PV-NAME-AREA.              42260000
422700     PERFORM WITH TEST AFTER                                      42270000
422800       VARYING PV-INDEX FROM 15 BY -1 UNTIL                       42280000
422900         PV-NAME-POSITION (PV-INDEX) NOT EQUAL SPACES OR          42290000
423000         PV-INDEX = 1                                             42300000
423100     END-PERFORM.                                                 42310000
423200                                                                  42320000
423300     IF PV-INDEX = 1 AND PV-NAME-POSITION (PV-INDEX) = SPACE      42330000
423400         SET PS-NO-FIRST-NAME TO TRUE                             42340000
423500     ELSE                                                         42350000
423600         IF PV-INDEX = 15                                         42360000
423700             SET PS-15-BYTE-FIRST-NAME TO TRUE                    42370000
423800         ELSE                                                     42380000
423900             SET PV-INDEX      UP BY 1                            42390000
424000         END-IF                                                   42400000
424100     END-IF.                                                      42410000
424200                                                                  42420000
424300     SET PV-INDEX-HOLD TO PV-INDEX.                               42430000
424400     SET PV-INDEX2     TO 1.                                      42440000
424500                                                                  42450000
424600     IF PS-NO-FIRST-NAME                                          42460000
424700         SET PV-INDEX2 DOWN BY 1                                  42470000
424800     ELSE                                                         42480000
424900         PERFORM WITH TEST AFTER                                  42490000
425000           VARYING PV-INDEX FROM 1 BY 1 UNTIL                     42500000
425100             PV-INDEX EQUAL PV-INDEX-HOLD                         42510000
425200                 SET PV-INDEX2 TO PV-INDEX                        42520000
425300                 MOVE PV-NAME-POSITION      (PV-INDEX) TO         42530000
425400                      PV-FULL-NAME-POSITION (PV-INDEX2)           42540000
425500         END-PERFORM                                              42550000
425600     END-IF.                                                      42560000
425700                                                                  42570000
425800     IF PS-15-BYTE-FIRST-NAME                                     42580000
425900         SET PV-INDEX2 UP BY 1                                    42590000
426000         MOVE ' ' TO PV-FULL-NAME-POSITION (PV-INDEX2)            42600000
426100     END-IF.                                                      42610000
426200                                                                  42620000
426300     MOVE ASC-LAST-NAME             TO PV-NAME-AREA.              42630000
426400                                                                  42640000
426500     PERFORM VARYING PV-INDEX FROM 1 BY 1 UNTIL                   42650000
426600         PV-INDEX  > 15 OR                                        42660000
426700         PV-INDEX2 > 20                                           42670000
426800             SET PV-INDEX2 UP BY 1                                42680000
426900             MOVE PV-NAME-POSITION      (PV-INDEX) TO             42690000
427000                  PV-FULL-NAME-POSITION (PV-INDEX2)               42700000
427100     END-PERFORM.                                                 42710000
427200                                                                  42720000
427300     MOVE PV-FIRST-LAST-NAME-AREA   TO VN007-CONTACT-NAME         42730000
427400                                      (VN007-ADDR-IND)            42740000
427500                                                                  42750000
427600     MOVE ASC-TEL1-NBR              TO VN007-TEL1-NBR             42760000
427700                                      (VN007-ADDR-IND)            42770000
427800                                                                  42780000
427900     MOVE ASC-FAX-NBR               TO VN007-FAX-NBR              42790000
428000                                      (VN007-ADDR-IND)            42800000
428100                                                                  42810000
428200     MOVE 'N'                       TO VN007-ADDR-DELETE-IND      42820000
428300                                      (VN007-ADDR-IND)            42830000
428400                                                                  42840000
428500     EXEC CICS LINK PROGRAM (PC-VNKCS024)                         42850000
428600                    COMMAREA(VN007-COMMAREA)                      42860000
428700                    RESP    (PV-CICS-RESP)                        42870000
428800     END-EXEC.                                                    42880000
428900                                                                  42890000
429000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           42900000
429100         CONTINUE                                                 42910000
429200     ELSE                                                         42920000
429300         SET DP013-ROLLBACK                                       42930000
429400             DP013-XCTL-DISPLAY-RESTART                           42940000
429500             DP013-CICS-ABEND      TO TRUE                        42950000
429600         MOVE '7486-CALL-VNKCS024' TO DP013-PARAGRAPH             42960000
429700         MOVE 'FAILED CALL TO MQSERIES MESSAGE ROUTINE: VNKCS024' 42970000
429800                                   TO DP013-MESSAGE-TEXT (1)      42980000
429900         PERFORM DP013-0000-PROCESS-ABEND                         42990000
430000     END-IF.                                                      43000000
430100                                                                  43010000
430200     IF VN007-NO-ERRORS                                           43020000
430300         CONTINUE                                                 43030000
430400     ELSE                                                         43040000
430500         SET DP013-CICS-ABEND                                     43050000
430600             DP013-ROLLBACK                                       43060000
430700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   43070000
430800         MOVE '7486-CALL-VNKCS024'      TO DP013-PARAGRAPH        43080000
430900         MOVE VN007-PROGRAM-NAME        TO PV-ERROR-PGM-NAME      43090000
431000         MOVE VN007-PARAGRAPH-NAME      TO PV-ERROR-PARA-NAME     43100000
431100         MOVE VN007-MESSAGE             TO PV-ERROR-MESSAGE       43110000
431200         IF VN007-MQ-ERROR                                        43120000
431300             MOVE 'MQ SERIES ERROR'     TO PV-ERROR-TYPE          43130000
431400             MOVE 'REASON:   '          TO PV-OPTIONAL-TEXT       43140000
431500             MOVE VN007-REASON-CODE     TO PV-ERROR-REASON        43150000
431600         ELSE                                                     43160000
431700             MOVE 'UNKNOWN ERROR  '     TO PV-ERROR-TYPE          43170000
431800             MOVE SPACES                TO PV-OPTIONAL-TEXT       43180000
431900                                           PV-ERROR-REASON        43190000
432000         END-IF                                                   43200000
432100         MOVE PV-ERROR-MSG-1       TO DP013-MESSAGE-TEXT (2)      43210000
432200         MOVE PV-ERROR-MSG-2       TO DP013-MESSAGE-TEXT (3)      43220000
432300         MOVE PV-ERROR-MSG-3       TO DP013-MESSAGE-TEXT (4)      43230000
432400         PERFORM DP013-0000-PROCESS-ABEND                         43240000
432500     END-IF.                                                      43250000
438500                                                                  43850000
438600                                                                  43860000
438700******************************************************************43870000
438800* GET FUNCTION ID FROM TBUSLOC TO DETERMINE IF A PURCHASE ORDER  *43880000
438900* ADDRESS EXISTS ON THE TABLE.  BASED UPON THE INFORMATION       *43890000
439000* RETRIEVED HERE, THE PRIM_ADDR_IND WILL BE CORRECTLY POPULATED. *43900000
439100******************************************************************43910000
439200                                                                  43920000
439300 7600-GET-PO-FUNCTION-ID.                                         43930000
439400                                                                  43940000
439500         EXEC SQL                                                 43950000
439600              SELECT FUNCTION_ID                                  43960000
439700                INTO :BUSLOC-FUNCTION-ID                          43970000
439800                FROM TBUSLOC                                      43980000
439900               WHERE ENT_ID = :ASC-KEY-ENT-ID                     43990000
440000                 AND  FUNCTION_ID = 2                             44000000
440100                 AND PRIM_ADDR_IND = 'Y'                          44010000
440200         END-EXEC                                                 44020000
440300                                                                  44030000
440400         EVALUATE TRUE                                            44040000
440500             WHEN SQLCODE = +0                                    44050000
440600                  MOVE 'N' TO PV-PRIM-ADDR-IND                    44060000
440700             WHEN SQLCODE = +100                                  44070000
440800                  MOVE 'Y' TO PV-PRIM-ADDR-IND                    44080000
440900             WHEN SQLCODE = -904                                  44090000
441000             WHEN SQLCODE = -913                                  44100000
441100                 CONTINUE                                         44110000
441200             WHEN SQLWARN0 NOT = SPACES                           44120000
441300             WHEN SQLCODE < ZERO                                  44130000
441400             WHEN SQLCODE > ZERO                                  44140000
441500                 MOVE '7600-GET-PO-FUNCTION-ID'                   44150000
441600                                   TO DP013-PARAGRAPH             44160000
441700                 MOVE 'SELECT TEXTENT FOR FUNCTION ID'            44170000
441800                                   TO DP013-MESSAGE-TEXT (1)      44180000
441900                 MOVE BUSLOC-FUNCTION-ID                          44190000
442000                                   TO DP013-MESSAGE-TEXT (2)      44200000
442100                 MOVE SQLCA        TO DP013-SQLCA                 44210000
442200                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    44220000
442300                 SET DP013-DB2-ABEND                              44230000
442400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           44240000
442500                 PERFORM DP013-0000-PROCESS-ABEND                 44250000
442600         END-EVALUATE.                                            44260000
442700                                                                  44270000
442800                                                                  44280000
442900******************************************************************44290000
443000* GET FUNCTION ID FROM TBUSLOC TO DETERMINE IF A CORPORATE       *44300000
443100* ADDRESS EXISTS ON THE TABLE.  BASED UPON THE INFORMATION       *44310000
443200* RETRIEVED HERE, THE PRIM_ADDR_IND WILL BE CORRECTLY POPULATED. *44320000
443300******************************************************************44330000
443400                                                                  44340000
443500 7605-GET-CORP-FUNCTION-ID.                                       44350000
443600                                                                  44360000
443700         EXEC SQL                                                 44370000
443800              SELECT FUNCTION_ID                                  44380000
443900                INTO :BUSLOC-FUNCTION-ID                          44390000
444000                FROM TBUSLOC                                      44400000
444100               WHERE ENT_ID = :ASC-KEY-ENT-ID                     44410000
444200                 AND  FUNCTION_ID = 4                             44420000
444300                 AND PRIM_ADDR_IND = 'Y'                          44430000
444400         END-EXEC                                                 44440000
444500                                                                  44450000
444600         EVALUATE TRUE                                            44460000
444700             WHEN SQLCODE = +0                                    44470000
444800                  MOVE 'N' TO PV-PRIM-ADDR-IND                    44480000
444900             WHEN SQLCODE = +100                                  44490000
445000                  MOVE 'Y' TO PV-PRIM-ADDR-IND                    44500000
445100             WHEN SQLCODE = -904                                  44510000
445200             WHEN SQLCODE = -913                                  44520000
445300                 CONTINUE                                         44530000
445400             WHEN SQLWARN0 NOT = SPACES                           44540000
445500             WHEN SQLCODE < ZERO                                  44550000
445600             WHEN SQLCODE > ZERO                                  44560000
445700                 MOVE '7605-GET-CORP-FUNCTION-ID'                 44570000
445800                                   TO DP013-PARAGRAPH             44580000
445900                 MOVE 'SELECT TEXTENT FOR FUNCTION ID'            44590000
446000                                   TO DP013-MESSAGE-TEXT (1)      44600000
446100                 MOVE BUSLOC-FUNCTION-ID                          44610000
446200                                   TO DP013-MESSAGE-TEXT (2)      44620000
446300                 MOVE SQLCA        TO DP013-SQLCA                 44630000
446400                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    44640000
446500                 SET DP013-DB2-ABEND                              44650000
446600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           44660000
446700                 PERFORM DP013-0000-PROCESS-ABEND                 44670000
446800         END-EVALUATE.                                            44680000
446900                                                                  44690000
447000                                                                  44700000
447100     EJECT                                                        44710000
447200                                                                  44720000
447300******************************************************************44730000
447400* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *44740000
447500******************************************************************44750000
447600                                                                  44760000
447700 9100-READ-SEL-QUEUE.                                             44770000
447800                                                                  44780000
447900     EXEC CICS                                                    44790000
448000         READQ TS                                                 44800000
448100             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        44810000
448200             INTO  (VN003-VENDOR-SEL-REC)                         44820000
448300             ITEM  (ASC-SEL-ITEM)                                 44830000
448400             RESP  (PV-CICS-RESP)                                 44840000
448500     END-EXEC.                                                    44850000
448600                                                                  44860000
448700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        44870000
448800         CONTINUE                                                 44880000
448900     ELSE                                                         44890000
449000         SET DP013-LOGIC-ABEND                                    44900000
449100             DP013-NO-ROLLBACK     TO TRUE                        44910000
449200         MOVE '9100-READ-SEL-QUEUE'                               44920000
449300                                   TO DP013-PARAGRAPH             44930000
449400         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    44940000
449500                                   TO DP013-MESSAGE-TEXT (1)      44950000
449600         PERFORM DP013-0000-PROCESS-ABEND                         44960000
449700     END-IF.                                                      44970000
449800                                                                  44980000
449900     EJECT                                                        44990000
450000                                                                  45000000
450100******************************************************************45010000
450200* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *45020000
450300******************************************************************45030000
450400                                                                  45040000
450500 9200-REWRITE-LIST-QUEUE.                                         45050000
450600                                                                  45060000
450700     EXEC CICS                                                    45070000
450800          WRITEQ TS                                               45080000
450900              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     45090000
451000              FROM    (VN003-VENDOR-SEL-REC)                      45100000
451100              ITEM    (ASC-SEL-ITEM)                              45110000
451200              RESP    (PV-CICS-RESP)                              45120000
451300              REWRITE                                             45130000
451400     END-EXEC.                                                    45140000
451500                                                                  45150000
451600     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    45160000
451700         SET DP013-CICS-ABEND                                     45170000
451800             DP013-NO-ROLLBACK     TO TRUE                        45180000
451900         MOVE '9200-REWRITE-LIST-QUEUE'                           45190000
452000                                   TO DP013-PARAGRAPH             45200000
452100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   45210000
452200                                   TO DP013-MESSAGE-TEXT (1)      45220000
452300         PERFORM DP013-0000-PROCESS-ABEND                         45230000
452400     END-IF.                                                      45240000
452500                                                                  45250000
452600     EJECT                                                        45260000
452700                                                                  45270000
455000*----------------------------------------------------------------*45500000
455100*    ABEND PROCESSOR MODULE                                      *45510000
455200*----------------------------------------------------------------*45520000
455300                                                                  45530000
455400     COPY DPPD013.                                                45540000
455500                                                                  45550000
455600*---------------------------------------------------------------* 45560000
455700*---------------------------------------------------------------* 45570000
