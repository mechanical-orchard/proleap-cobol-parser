000100 IDENTIFICATION DIVISION.                                         00010099
000200                                                                  00020099
000300 PROGRAM-ID.      TFKUP001.                                       00030099
000400 AUTHOR.          THOMAS HANSON.                                  00040099
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050099
000600 DATE-WRITTEN.    11/30/09.                                       00060099
000700 DATE-COMPILED.                                                   00070099
000800                                                                  00080099
000900******************************************************************00090099
001000*  MODULE TYPE:   COBOL2 DB2 BATCH.                               00100099
001100*                                                                 00110099
001200*  DESCRIPTION:   THIS DB2 CHECKPOINT RESTART PROGRAM             00120099
001300*                 HANDLES INSERTS FOR TFT_PHY_INV_ITM.            00130099
001400*                                                                 00140099
001500*========================== CHANGE LOG ===========================00150099
001600*  AUTH       BY            DATE    DESCRIPTION                   00160099
001700*=================================================================00170099
001800* WR37120     T. HANSON   11-30-09  CREATE PROGRAM                00180099
003400*                                                                 00190099
      ******************************************************************00191099
      * 03/28/2012 CHANGED BY:  DEANNA BRANTNER   PR#3403               00191199
      *            DESCRIPTION: COMPILE ONLY CHANGES TO TFRD060 COPYBK  00191299
      ******************************************************************00191399
260107* CHG0260107  JIM HUNTER  08/17/21  ADD COPYBOOK DPWS991 TO       00191499
260107*                                   MAKE CALL TO DPKUT901 DYNAMIC.00191599
      ******************************************************************00191699
002100                                                                  00192099
002200 ENVIRONMENT DIVISION.                                            00193099
002300 CONFIGURATION SECTION.                                           00194099
002400                                                                  00195099
002500 SOURCE-COMPUTER.    IBM-3090.                                    00196099
002600 OBJECT-COMPUTER.    IBM-3090.                                    00197099
002700                                                                  00198099
002800 INPUT-OUTPUT SECTION.                                            00199099
002900 FILE-CONTROL.                                                    00200099
003000                                                                  00210099
003100 DATA DIVISION.                                                   00220099
003200 FILE SECTION.                                                    00230099
003300                                                                  00240099
003400                                                                  00250099
003500***************************************************************** 00260099
003600*                       WORKING STORAGE                           00270099
003700***************************************************************** 00280099
003800 WORKING-STORAGE SECTION.                                         00290099
003900                                                                  00300099
004000 01  W-START                          PIC  X(40)                  00310099
004100     VALUE 'TFKUP001 - WORKING STORAGE BEGINS HERE'.              00320099
004200                                                                  00330099
004300                                                                  00340099
004400***************************************************************** 00350099
004500*                         SWITCHES                                00360099
004600***************************************************************** 00370099
004700 01  PROGRAM-SWITCHES.                                            00380099
004800     05  PS-RESTART-REQUIRED-SW       PIC  X(01) VALUE 'N'.       00390099
004900         88  PS-RESTART-REQUIRED                 VALUE 'Y'.       00400099
005000         88  PS-RESTART-NOT-REQUIRED             VALUE 'N'.       00410099
005100                                                                  00420099
005200******************************************************************00430099
005300*                       ACCUMULATORS                              00440099
005400******************************************************************00450099
005500 01  PROGRAM-ACCUM.                                               00460099
005600     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00470099
005700     05  PA-CKPT                      PIC  9(11) VALUE ZEROS.     00480099
005800                                                                  00490099
005900******************************************************************00500099
006000*                           CONSTANTS                             00510099
006100******************************************************************00520099
006200 01  PROGRAM-CONSTANTS.                                           00530099
006300     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         00540099
006400                                                 COMP SYNC.       00550099
006500     05  PC-MAX-DEADLOCKS             PIC S9(04) VALUE +3         00560099
006600                                                 COMP SYNC.       00570099
006700                                                                  00580099
006800     05  PC-CKPT-JOB-NAME             PIC  X(08) VALUE 'TFK026  '.00590099
006900     05  PC-CKPT-PLAN-NAME            PIC  X(08) VALUE 'TFKUP001'.00600099
007000     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'TFKUP001'.00610099
007100                                                                  00620099
007200     05  PC-TRAN-PRES-FUNC-CODES.                                 00630099
007300         10  PC-TRAN-PRES-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00640099
007400         10  PC-TRAN-PRES-FUNC-TRANS  PIC  X(05) VALUE 'TRANS'.   00650099
007500         10  PC-TRAN-PRES-FUNC-RSTRT  PIC  X(05) VALUE 'RSTRT'.   00660099
007600         10  PC-TRAN-PRES-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00670099
007700                                                                  00680099
007800     05  PC-MINUS-ONE                 PIC S9(01) VALUE -1.        00690099
007900     05  PC-SYSTEM                    PIC  X(08) VALUE 'SYSTEM  '.00700099
008000                                                                  00710099
008100******************************************************************00720099
008200*                          VARIABLES                              00730099
008300******************************************************************00740099
008400 01  PROGRAM-VARIABLES.                                           00750099
008500     05  PV-SQL-SUB                   PIC  9(03) VALUE ZERO.      00760099
008600     05  PV-DEADLOCK-COUNTER          PIC  9(03) VALUE ZERO.      00770099
008700     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     00780099
008800     05  PV-DB2-OPER-ATTEMPTED        PIC  X(30) VALUE SPACE.     00790099
008900     05  PV-OPERATION-MSG             PIC  X(35) VALUE SPACE.     00800099
009000     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     00810099
009100                                                                  00820099
009200******************************************************************00830099
009300*               SYSTEM TIME AND DATE VARIABLES                    00840099
009400******************************************************************00850099
009500 01  SYS-DATE-TIME.                                               00860099
009600     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    00870099
009700     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    00880099
009800                                                                  00890099
009900 01  ST-BEG-TIME.                                                 00900099
010000     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     00910099
010100     05  FILLER                       PIC  X(01) VALUE ':'.       00920099
010200     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     00930099
010300                                                                  00940099
010400 01  ST-END-TIME.                                                 00950099
010500     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     00960099
010600     05  FILLER                       PIC  X(01) VALUE ':'.       00970099
010700     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     00980099
010800                                                                  00990099
010900 01  SD-EDIT-DATE.                                                01000099
011000     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01010099
011100     05  FILLER                       PIC  X(01) VALUE '-'.       01020099
011200     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01030099
011300     05  FILLER                       PIC  X(01) VALUE '-'.       01040099
011400     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01050099
011500     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01060099
011600                                                                  01070099
011700******************************************************************01080099
011800*                        ERROR HANDLING                           01090099
011900******************************************************************01100099
012000 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01110099
012100                                                 COMP SYNC.       01120099
012200     88  ABEND-4002-READ-ERROR                   VALUE +4002.     01130099
012300     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     01140099
012400     88  ABEND-4019-CAL-SUB-ERROR                VALUE +4019.     01150099
012500                                                                  01160099
012600                                                                  01170099
012700******************************************************************01180099
012800*  LAYOUT FOR UNLOAD FILE RECORDS                                 01190099
012900******************************************************************01200099
013000     COPY TFRD060.                                                01210099
013100                                                                  01220099
013200******************************************************************01230099
013300*  DB2 FORMATTED ERROR MESSAGE                                    01240099
013400******************************************************************01250099
013500     COPY DPWS004.                                                01260099
013600                                                                  01270099
013700******************************************************************01280099
013800*  SQL COMMUNICATIONS WORK AREA                                   01290099
013900******************************************************************01300099
014000     COPY SQLCA2.                                                 01310099
014100                                                                  01320099
014200******************************************************************01330099
014300*  COMMUNICATIONS AREA FOR DB2                                    01340099
014400******************************************************************01350099
014500     EXEC SQL                                                     01360099
014600         INCLUDE SQLCA                                            01370099
014700     END-EXEC.                                                    01380099
014800                                                                  01390099
014900******************************************************************01400099
015000*  DB2 TABLE TFT_PHY_INV_ITM - PHYSICAL INVENTORY ITEM TABLE      01410099
015100******************************************************************01420099
015200     EXEC SQL                                                     01430099
015300          INCLUDE TFT00000                                        01440099
015400     END-EXEC.                                                    01450099
015500                                                                  01460099
015600                                                                  01470099
015700******************************************************************01480099
015800*  TRANSACTION PREPARATION MODULE COMMUNICATIONS AREA             01490099
015900******************************************************************01500099
260107     COPY DPWS991.                                                01501099
                                                                        01502099
016000     COPY DPLS001.                                                01510099
016100     05  WORK-STORAGE-PASSED.                                     01520099
016200******************************************************************01530099
016300*PA - PROGRAM ACCUMULATORS                                        01540099
016400******************************************************************01550099
016500         10  PROGRAM-ACCUMULATORS.                                01560099
016600             15  PA-ROWS-INSERTED PIC S9(11)           VALUE ZERO 01570099
016700                                                       COMP-3.    01580099
016800                                                                  01590099
016900 01  FILLER                          PIC X(4096)  VALUE SPACE.    01600099
017000                                                                  01610099
017100                                                                  01620099
017200                                                                  01630099
017300 PROCEDURE DIVISION.                                              01640099
017400******************************************************************01650099
017500* MAINLINE-PROCESSING                                             01660099
017600******************************************************************01670099
017700                                                                  01680099
017800     PERFORM A100-INITIALIZE.                                     01690099
017900                                                                  01700099
018000     PERFORM B100-PROCESS-INSERT-RECORDS                          01710099
018100       UNTIL DP001-PREP-TRANS-EOF.                                01720099
018200                                                                  01730099
018300     PERFORM Z990-EOJ-ROUTINE.                                    01740099
018400                                                                  01750099
018500     GOBACK.                                                      01760099
018600                                                                  01770099
018700                                                                  01780099
018800******************************************************************01790099
018900* PREFORMS TASK INITIATION                                        01800099
019000******************************************************************01810099
019100 A100-INITIALIZE.                                                 01820099
019200                                                                  01830099
019300     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01840099
019400                                                                  01850099
019500     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01860099
019600     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01870099
019700                                                                  01880099
019800     MOVE SYS-DATE (1:2) TO SD-CENT.                              01890099
019900     MOVE SYS-DATE (3:2) TO SD-YEAR.                              01900099
020000     MOVE SYS-DATE (5:2) TO SD-MONTH.                             01910099
020100     MOVE SYS-DATE (7:2) TO SD-DAY.                               01920099
020200                                                                  01930099
020300     MOVE PC-TRAN-PRES-FUNC-OPEN TO DP001-FUNC-CODE.              01940099
020400                                                                  01950099
020500     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      01960099
020600                                                                  01970099
020700                                                                  01980099
020800******************************************************************01990099
020900* PROCESS INSERT RECORDS                                          02000099
021000******************************************************************02010099
021100 B100-PROCESS-INSERT-RECORDS.                                     02020099
021200                                                                  02030099
021300     SET PS-RESTART-NOT-REQUIRED TO TRUE.                         02040099
021400                                                                  02050099
021500     PERFORM C100-INSERT-FIELDS.                                  02060099
021600                                                                  02070099
021700*----------------------------------------------------------------*02080099
021800*  IF A RESTART IS REQUIRED, ISSUE A RESTART CALL RATHER THAN A  *02090099
021900*  TRANS CALL.  THIS WILL ALLOW PROCESSING TO RESUME WITH THE    *02100099
022000*  FIRST TRANSACTION AFTER THE LAST COMMIT.                      *02110099
022100*----------------------------------------------------------------*02120099
022200     IF  PS-RESTART-REQUIRED                                      02130099
022300         MOVE PC-TRAN-PRES-FUNC-RSTRT TO DP001-FUNC-CODE          02140099
022400     ELSE                                                         02150099
022500         MOVE PC-TRAN-PRES-FUNC-TRANS TO DP001-FUNC-CODE          02160099
022600     END-IF.                                                      02170099
022700                                                                  02180099
022800     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      02190099
022900                                                                  02200099
023000     ADD 1 TO PA-READ.                                            02210099
023100                                                                  02220099
023200                                                                  02230099
023300******************************************************************02240099
023400* INSERTS THE PHY-INV-ITM FIELDS                                  02250099
023500******************************************************************02260099
023600 C100-INSERT-FIELDS.                                              02270099
023700                                                                  02280099
024100     PERFORM C200-PHY-INV-ITM-INSERT.                             02290099
024200                                                                  02300099
024300                                                                  02310099
024400******************************************************************02320099
024500* INSERT THE PHY-INV-ITM TABLE                                    02330099
024600******************************************************************02340099
024700 C200-PHY-INV-ITM-INSERT.                                         02350099
024800                                                                  02360099
024900     PERFORM WITH TEST AFTER                                      02370099
025000         VARYING PV-SQL-SUB                                       02380099
025100         FROM 1 BY 1                                              02390099
025200         UNTIL (PV-SQL-SUB > PC-MAX-RETRIES                       02400099
025400                OR SQLCODE = +100                                 02410099
025500                OR SQLCODE = 0)                                   02420099
025600                                                                  02430099
025700         EXEC SQL                                                 02440099
                   INSERT  INTO TFT_PHY_INV_ITM                         02450099
                        (  XFER_DKEY_ID                                 02460099
                        ,  XFER_LNE_NBR                                 02470099
                        ,  BTCH_DKEY_ID                                 02480099
                        ,  FRM_PSTG_STR_NBR                             02490099
                        ,  TO_PSTG_STR_NBR                              02491099
                        ,  UNT_RTL_AMT                                  02492099
                        ,  UNT_QTY )                                    02493099
                   VALUES                                               02494099
                        (  :TFRD060-XFER-DKEY-ID                        02495099
                        ,  :TFRD060-XFER-LNE-NBR                        02496099
                        ,  :TFRD060-BTCH-DKEY-ID                        02497099
                        ,  :TFRD060-FR-LOC-NBR                          02498099
                        ,  :TFRD060-TO-PSTG-LOC-NBR                     02499099
                        ,  :TFRD060-ITM-RTL-PRCE-AMT                    02499199
                        ,  :TFRD060-ITM-QTY  )                          02499299
026400         END-EXEC                                                 02499399
026500                                                                  02499499
026600         EVALUATE TRUE                                            02499599
026700             WHEN SQLCODE = 0                                     02499699
026800                 ADD +1 TO PA-ROWS-INSERTED                       02499799
026900                                                                  02499899
027000             WHEN SQLCODE = -904                                  02499999
027000             WHEN SQLCODE = -911                                  02500099
027100                 ADD +1 TO PV-DEADLOCK-COUNTER                    02510099
027200                                                                  02520099
027300                 DISPLAY '                   '                    02530099
027400                 DISPLAY 'DEADLOCK INCOUNTERED -911'              02540099
027500                 DISPLAY 'DEADLOCK-COUNTER = ' PV-DEADLOCK-COUNTER02550099
027600                                                                  02560099
027700                 IF PV-DEADLOCK-COUNTER > PC-MAX-DEADLOCKS        02570099
027800                     MOVE 'C200-PHY-INV-ITM-INSERT'               02580099
027900                                      TO PV-PARAGRAPH-NAME        02590099
028000                     MOVE 'MAXIMUM DEADLOCKS EXCEEDED    '        02600099
028100                                      TO PV-DB2-OPER-ATTEMPTED    02610099
028200                     PERFORM Z200-SQL-ABEND                       02620099
028300                                                                  02630099
028400                 ELSE                                             02640099
028500                     SET PS-RESTART-REQUIRED TO TRUE              02650099
028600                 END-IF                                           02660099
028700                                                                  02670099
028800             WHEN OTHER                                           02680099
028900                 DISPLAY '                   '                    02690099
029000                 DISPLAY 'SQLCODE = ' SQLCODE                     02700099
029100                 DISPLAY 'DP001-FUNC-CODE = ' DP001-FUNC-CODE     02710099
029200                 DISPLAY 'DP001-RET-CODE  = ' DP001-RET-CODE      02720099
029300                 DISPLAY '                   '                    02730099
029400                 DISPLAY 'INSERT ABENDED ON: '                    02740099
                       DISPLAY 'XFER DKEY ID ' TFRD060-XFER-DKEY-ID     02750099
                       DISPLAY 'UNIT RTL AMT ' TFRD060-ITM-RTL-PRCE-AMT 02760099
029800                 MOVE 'C200-PHY-INV-ITM-INSERT'                   02770099
029900                                        TO PV-PARAGRAPH-NAME      02780099
030000                 MOVE 'PHY-INV-ITM INSERT'                        02790099
030100                                        TO PV-DB2-OPER-ATTEMPTED  02800099
030300                 PERFORM Z200-SQL-ABEND                           02810099
030400         END-EVALUATE                                             02820099
030500     END-PERFORM.                                                 02830099
030600                                                                  02840099
030700     IF PV-SQL-SUB > PC-MAX-RETRIES                               02850099
030800         MOVE 'C200-PHY-INV-ITM-INSERT' TO PV-PARAGRAPH-NAME      02860099
030900         MOVE 'VERIFY RETRIES EXCEEDED' TO PV-DB2-OPER-ATTEMPTED  02870099
031000         PERFORM Z200-SQL-ABEND                                   02880099
031100     END-IF.                                                      02890099
031200                                                                  02900099
031300                                                                  02910099
031400******************************************************************02920099
031500* BUILD THE COMMUNICATION AREA FOR A CALL TO THE TRANSACTION      02930099
031600* PRESENTATION MODULE                                             02940099
031700******************************************************************02950099
031800 X100-BUILD-COMM-AREA-TRAN-PRES.                                  02960099
031900                                                                  02970099
032000     MOVE LENGTH OF                                               02980099
032100          WORK-STORAGE-PASSED TO DP001-WORK-STRG-LENGTH.          02990099
032200     MOVE PC-CKPT-JOB-NAME    TO DP001-JOB-NAME.                  03000099
032300     MOVE PC-CKPT-PLAN-NAME   TO DP001-PLAN-NAME.                 03010099
032400                                                                  03020099
032500     PERFORM X200-CALL-TRANS-PRES-MODULE.                         03030099
032600                                                                  03040099
032700     MOVE DP001-TRANS-RECORD  TO TFRD060-INV-SNAPSHOT-EXTRACT.    03050099
032800                                                                  03060099
032900     IF  DP001-CKPT-TAKEN                                         03070099
033000         ADD 1 TO PA-CKPT                                         03080099
033100                                                                  03090099
033200         INITIALIZE PV-DEADLOCK-COUNTER                           03100099
033300     END-IF.                                                      03110099
033400                                                                  03120099
033500                                                                  03130099
033600******************************************************************03140099
033700* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03150099
033800******************************************************************03160099
033900 X200-CALL-TRANS-PRES-MODULE.                                     03170099
034000                                                                  03180099
034100     PERFORM Z900-CALL-TRANS-PRES-MODULE.                         03190099
034200                                                                  03200099
034300     IF  DP001-GOOD-RET-CODE                                      03210099
034400     OR  DP001-CKPT-TAKEN                                         03220099
034500     OR  DP001-RESTART                                            03230099
034600         CONTINUE                                                 03240099
034700                                                                  03250099
034800     ELSE                                                         03260099
034900         MOVE 'X200-CALL-TRANS-PRES-MODULE' TO PV-PARAGRAPH-NAME  03270099
035000         MOVE '** BAD CALL TO TRANS PREP MODULE **'               03280099
035100                                            TO PV-OPERATION-MSG   03290099
035200         MOVE DP001-RET-CODE                TO PV-RET-CODE        03300099
035300                                                                  03310099
035400         SET ABEND-4019-CAL-SUB-ERROR TO TRUE                     03320099
035500                                                                  03330099
035600         PERFORM Z100-ABEND                                       03340099
035700     END-IF.                                                      03350099
035800                                                                  03360099
035900                                                                  03370099
036000******************************************************************03380099
036100* NON-DB2 ABEND                                                   03390099
036200******************************************************************03400099
036300 Z100-ABEND.                                                      03410099
036400                                                                  03420099
036500     PERFORM Z999-CONTROLS.                                       03430099
036600                                                                  03440099
036700     DISPLAY '                     '.                             03450099
036800     DISPLAY '** ABEND           **'.                             03460099
036900     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03470099
037000     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03480099
037100     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03490099
037200     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              03500099
037300                                                                  03510099
037400     CALL 'ILBOABN0' USING ABEND-CODE.                            03520099
037500                                                                  03530099
037600                                                                  03540099
037700******************************************************************03550099
037800* ABEND THE PROGRAM IN THE EVENT THAT A SQL ERROR OR WARNING      03560099
037900* CODE OCCURS.                                                    03570099
038000******************************************************************03580099
038100 Z200-SQL-ABEND.                                                  03590099
038200                                                                  03600099
038300     PERFORM Z999-CONTROLS.                                       03610099
038400                                                                  03620099
038500     DISPLAY '** ABEND     **'.                                   03630099
038600     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                03640099
038700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              03650099
038800     DISPLAY '** OPERATION ** = ' PV-DB2-OPER-ATTEMPTED.          03660099
038900                                                                  03670099
039000******************************************************************03680099
039100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    03690099
039200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         03700099
039300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     03710099
039400* FORMAT.                                                         03720099
039500******************************************************************03730099
039600     COPY DPPD004.                                                03740099
039700                                                                  03750099
039800     SET ABEND-4013-DB2-ERROR TO TRUE.                            03760099
039900                                                                  03770099
040000     CALL 'ILBOABN0' USING ABEND-CODE.                            03780099
040100                                                                  03790099
040200                                                                  03800099
040300******************************************************************03810099
040400* PREFORMS TASK TERMINATION PROCESSING                            03820099
040500******************************************************************03830099
040600 Z990-EOJ-ROUTINE.                                                03840099
040700                                                                  03850099
040800     MOVE PC-TRAN-PRES-FUNC-CLOSE TO DP001-FUNC-CODE.             03860099
040900                                                                  03870099
041000     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      03880099
041100                                                                  03890099
041200     PERFORM Z999-CONTROLS.                                       03900099
041300                                                                  03910099
041400                                                                  03920099
041500******************************************************************03930099
041600* DISPLAY CONTROLS FROM THE PROGRAM                               03940099
041700******************************************************************03950099
041800 Z999-CONTROLS.                                                   03960099
041900                                                                  03970099
042000     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 03980099
042100                                                                  03990099
042200     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04000099
042300     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04010099
042400                                                                  04020099
042500     DISPLAY '                    '.                              04030099
042600     DISPLAY '**********************'.                            04040099
042700     DISPLAY '   TFKUP001 CONTROLS  '.                            04050099
042800     DISPLAY '**********************'.                            04060099
042900     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04070099
043000     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04080099
043100     DISPLAY 'END TIME  = ' ST-END-TIME.                          04090099
043200     DISPLAY '======================'.                            04100099
043300     DISPLAY 'RECORDS READ   = ' PA-READ.                         04110099
043400     DISPLAY 'CHECKPOINTS    = ' PA-CKPT.                         04120099
043500     DISPLAY '                '.                                  04130099
043600     DISPLAY 'ROWS INSERTED  = ' PA-ROWS-INSERTED.                04140099
043700     DISPLAY '                '.                                  04150099
043800                                                                  04160099
043900******************************************************************04170099
044000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04180099
044100* MENTS THAT ARE REQUIRED TO INVOKE THE TRANSACTION PRESENTATION  04190099
044200* MODULE (DPKUT901) OF THE DB2 CHECKPOINT RESTART SYSTEM.         04200099
044300******************************************************************04210099
044400     COPY DPPD001.                                                04220099
044500                                                                  04230099
044600                                                                  04240099
