000100 IDENTIFICATION DIVISION.                                         06500003
000200 PROGRAM-ID.      XSKRP040.                                       06510003
000300 AUTHOR.          NANCY MARTIN                                    06520003
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        06530003
000500 DATE-WRITTEN.    10/22/2004.                                     06540003
000600 DATE-COMPILED.                                                   06550003
000700******************************************************************06560003
000800**XS DOMAIN TABLE INTEGRITY CHECK - FOR TABLE XST_PRCHG_MDSE      06570003
000900******************************************************************06580003
001000**THIS PROGRAM VALIDATES THE DATA IN THE XS DOMAIN IS THE SAME    06590003
001100**AS THE DATA IN THE SOR                                          06600003
001150**   THIS PROGRAM WAS CLONED FROM XSKRP039                        06610003
001160**   CREATED FOR NEW PERM SYSTEM WORK WR27634                     06620003
001170**      WE ALSO ADDED "NEW PERM - RED" FIELDS FOR LATER USE       06620127
001180**      OF PRICING GRID AND CLEARANCE TYPE.                       06620227
NEMNTE***** THE VARIABLE NAMES WERE LEFT "PRCHG" EVEN THOUGH            06621003
NEMNTE***** THIS PROGRAM DEALS WITH "PRCHG MDSE"                        06622003
001200******************************************************************06630003
      * DATE:        02/04/2005                                         06631032
      * WR/IR#:      WR27634                                            06632032
      * PROGRAMMER:  NANCY MARTIN                                       06633032
      * DESCRIPTION: CHANGE TO NOT HAVE EMPTY SOR FILE TRIGGER MSG.     06634032
      *                                                                 06635032
      *--------------------------------------------------------------*  06639440
      * DATE:        07/26/2010                                         06639540
      * WR/IR#:      WR36734                                            06639642
      * PROGRAMMER:  DAVE METZGER                                       06639740
      * DESCRIPTION: REMOVED TMST VALIDATION CHECK AS PART OF THE       06639840
      *              MDO SPRING 2010 PROJECT DUE TO MESSAGING           06639940
      *              CHANGES FROM PERM TO XS.                           06640041
      *                                                                 06640140
      *--------------------------------------------------------------*  06640240
001300 ENVIRONMENT DIVISION.                                            06641003
001400 CONFIGURATION SECTION.                                           06650003
001500 SOURCE-COMPUTER.        IBM-3090.                                06660003
001600 OBJECT-COMPUTER.        IBM-3090.                                06670003
001700 INPUT-OUTPUT SECTION.                                            06680003
001800 FILE-CONTROL.                                                    06690003
001900                                                                  06700003
002400     SELECT SOR-PRCHG-EXTRACT-FILE                                06710003
002500            ASSIGN TO INP01.                                      06720003
002600     SELECT XS-PRCHG-EXTRACT-FILE                                 06730003
002700            ASSIGN TO INP02.                                      06740003
002800     SELECT XS-PRCHG-INTEG-RPT-FILE                               06750003
002900            ASSIGN TO RPT01.                                      06760003
003000                                                                  06770003
003100 DATA DIVISION.                                                   06780003
003200 FILE SECTION.                                                    06790003
003300                                                                  06800003
004800 FD  SOR-PRCHG-EXTRACT-FILE                                       06810003
004900     RECORDING MODE F                                             06820003
005000     BLOCK CONTAINS 0 RECORDS                                     06830003
005100     LABEL RECORDS ARE OMITTED                                    06840003
005200     DATA RECORD IS SOR-PRCHG-EXTRACT-RECORD.                     06850003
005300 01  SOR-PRCHG-EXTRACT-RECORD        PIC X(200).                  06860003
005400                                                                  06870003
005500 FD  XS-PRCHG-EXTRACT-FILE                                        06880003
005600     RECORDING MODE F                                             06890003
005700     BLOCK CONTAINS 0 RECORDS                                     06900003
005800     LABEL RECORDS ARE OMITTED                                    06910003
005900     DATA RECORD IS XS-PRCHG-EXTRACT-RECORD.                      06920003
006000 01  XS-PRCHG-EXTRACT-RECORD         PIC X(119).                  06930020
006100                                                                  06940003
006200 FD  XS-PRCHG-INTEG-RPT-FILE                                      06950003
006300     RECORDING MODE IS F                                          06960003
006400     BLOCK CONTAINS 0  RECORDS.                                   06970003
006500 01  XS-PRCHG-INTEG-RPT-RECORD       PIC  X(200).                 06980003
006600                                                                  06990003
006700 WORKING-STORAGE SECTION.                                         07000003
006800                                                                  07010003
006900 01  FILLER                              PIC X(41)                07020003
007000     VALUE 'WORKING STORAGE STARTS HERE FOR XSKRP040'.            07030003
007100                                                                  07040003
007200 01  PS-PROGRAM-SWITCHES.                                         07050003
007900     05  PS-END-OF-SOR-PRCHG-SW          PIC X(01) VALUE 'N'.     07080003
008000         88  PS-END-OF-SOR-PRCHG                   VALUE 'Y'.     07090003
008100         88  PS-NOT-END-OF-SOR-PRCHG               VALUE 'N'.     07100003
008200     05  PS-END-OF-XS-PRCHG-SW           PIC X(01) VALUE 'N'.     07110003
008300         88  PS-END-OF-XS-PRCHG                    VALUE 'Y'.     07120003
008400         88  PS-NOT-END-OF-XS-PRCHG                VALUE 'N'.     07130003
009100     05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     07140003
009200         88  PS-ERROR-FOUND                        VALUE 'Y'.     07150003
009300         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     07160003
009400                                                                  07170003
010500 01  PC-PROGRAM-CONSTANTS.                                        07180003
010600     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)  VALUE         07190003
010700                                                    'XSKRP040'.   07200003
010800     05  PC-REPORT-NBR-1                 PIC  9(01) VALUE 1.      07210003
010900     05  PC-ONE                          PIC  9(01) VALUE 1.      07220003
NEMTST     05  PC-NULL                         PIC S9(04) VALUE -1.     07230003
011200     05  PC-MAX-REPORT-LINES             PIC S9(05) VALUE +74     07240003
011300                                                    COMP-3.       07250003
011400                                                                  07260003
011500     05  PC-NO-ERROR-MESSAGE             PIC  X(200) VALUE        07270003
011600         'NO ERRORS'.                                             07280003
011900                                                                  07290003
012600     05  PC-MISSING-FROM-SOR-PRCHG       PIC  X(36) VALUE         07330026
012700**       'MATCHING KEY NOT FOUND ON SOR PRCHG MDSE EXTRACT'.      07340026
012700         'MATCHING KEY NOT ON SOR PRCHG MDSE'.                    07341026
012800                                                                  07350003
012900     05  PC-MISSING-FROM-XS-PRCHG        PIC  X(36) VALUE         07360026
013000**       'MATCHING KEY NOT FOUND ON XS PRCHG MDSE EXTRACT'.       07370026
013000         'MATCHING KEY NOT ON XS PRCHG MDSE '.                    07371026
013100                                                                  07380003
012600     05  PC-EXTRA-FOUND-SOR-PRCHG        PIC  X(36) VALUE         07390026
012700**       'ADDITIONAL DATA FOUND FOR SOR PRCHG MDSE EXTRACT'.      07400026
012700         'EXTRA DATA FOUND FOR SOR PRCHG MDSE '.                  07401026
012800                                                                  07410003
012900     05  PC-EXTRA-FOUND-XS-PRCHG        PIC  X(36) VALUE          07420026
013000**       'ADDITTIONAL DATA FOUND ON XS PRCHG MDSE EXTRACT'.       07430026
013000         'EXTRA DATA FOUND ON XS PRCHG MDSE  '.                   07431026
NEMDEL*******   123456789-123456789-123456789-123456                    07432026
013100                                                                  07440003
           05  PC-EMPTY-SOR-PRCHG              PIC  X(40) VALUE         07441028
               'NO DATA RECEIVED FROM SOR PRCHG EXTRACT '.              07442033
                                                                        07443028
013200 01  PV-MISCELANEOUS.                                             07450003
NEMCHG     05  PV-TEMP-PRCHG-ID                PIC S9(11) COMP          07460003
NEMCHG                                                    VALUE ZEROS.  07470003
013400     05  PV-PRINT-RECORD                 PIC X(200) VALUE SPACE.  07480003
013500     05  PV-LINE-SPACING                 PIC S9(04) VALUE ZEROES  07490003
013600                                                    COMP SYNC.    07500003
013700     05  PV-CURR-TIME.                                            07590003
013800        10  PV-CURR-TIME-HH              PIC  9(02) VALUE ZEROES. 07600003
013900        10  PV-CURR-TIME-MM              PIC  9(02) VALUE ZEROES. 07610003
014000        10  PV-CURR-TIME-SSHH            PIC  9(04) VALUE ZEROES. 07620003
014100                                                                  07630003
014200     05  PV-CURR-DATE-CCYYMMDD.                                   07640003
014300         10  PV-CURR-DATE-CCYY           PIC  9(04) VALUE ZEROES. 07650003
014400         10  PV-CURR-DATE-MM             PIC  9(02) VALUE ZEROES. 07660003
014500         10  PV-CURR-DATE-DD             PIC  9(02) VALUE ZEROES. 07670003
014600                                                                  07680003
014700 01  PV-PROGRAM-COUNTER.                                          07690003
014800     05  PV-PAGE-CNT                     PIC  9(05) VALUE ZEROS.  07700003
014900     05  PV-LINE-CNT                     PIC S9(07) VALUE ZEROS.  07710003
015000     05  PV-SOR-PRCHG-RECS-READ-CNT      PIC  9(09) VALUE ZEROS.  07720003
015200     05  PV-XS-EXTRACT-REC-READ-CNT      PIC  9(09) VALUE ZEROS.  07730003
015000     05  PV-SOR-PRCHG-RECS-UNIQUE        PIC  9(09) VALUE ZEROS.  07740003
015200     05  PV-XS-EXTRACT-REC-UNIQUE        PIC  9(09) VALUE ZEROS.  07750003
015000     05  PV-SOR-XS-COMMON-CNT            PIC  9(09) VALUE ZEROS.  07760003
015000     05  PV-SOR-XS-TOTAL-CNT             PIC  9(09) VALUE ZEROS.  07770003
015300     05  PV-ERROR-RECORD-WRITTEN-CNT     PIC  9(09) VALUE ZEROS.  07780003
015400     05  PV-VALID-MATCH-CNT              PIC  9(09) VALUE ZEROS.  07790003
015500                                                                  07800003
015600 01  PV-MISC-ABEND-FIELDS.                                        07810003
015700     05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  07820003
015800     05  PV-OPERATION-MSG-1              PIC  X(40) VALUE SPACE.  07830003
015900     05  PV-OPERATION-MSG-2              PIC  X(40) VALUE SPACE.  07840003
016100                                                                  07850003
016200 01  PV-ABEND-CODE   COMP  SYNC          PIC S9(04) VALUE +0000.  07860003
016300     88  PV-ABEND-4008-DATA-ERROR                   VALUE +4008.  07870003
016400     88  PV-ABEND-4009-CARD-ERROR                   VALUE +4009.  07880003
016700                                                                  07890003
016800******************************************************************07900003
016900*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  07910003
017000******************************************************************07920003
017100     COPY DPWS200.                                                07930003
017200                                                                  07940003
017300 01  HL2-HEADING-LINE-2.                                          07950003
017400     05  FILLER                  PIC X(83)   VALUE SPACES.        07960003
017500     05  FILLER                  PIC X(35)   VALUE                07970003
017600         'XS PRCHG MDSE DATA INTEGRITY ERRORS'.                   07980003
017700     05  FILLER                  PIC X(82)   VALUE SPACES.        07990003
017800                                                                  08000003
017900 01  HL3-HEADING-LINE-3.                                          08010003
018400     05  FILLER                  PIC X(12)   VALUE                08020016
018500         '  PRCHG ID  '.                                          08030016
018400     05  FILLER                  PIC X(13)   VALUE                08040003
018500         '--STR GRP--  '.                                         08050003
018400     05  FILLER                  PIC X(10)   VALUE                08051016
018500         '-MDSE ID- '.                                            08052016
018700     05  FILLER                  PIC X(06)   VALUE                08060017
018800         'FROM  '.                                                08070017
019000     05  FILLER                  PIC X(19)   VALUE                08090017
019100         'MDSE DEPT  MAJ  SUB'.                                   08100017
           05  FILLER                  PIC X(20)   VALUE SPACES.        08100126
           05  FILLER                  PIC X(15)   VALUE                08101026
               ' CLR  PRICING  '.                                       08101126
           05  FILLER                  PIC X(10)   VALUE SPACES.        08101226
019000     05  FILLER                  PIC X(23)   VALUE                08104026
019100         '--GROUP PRICING DATA --'.                               08105016
019200     05  FILLER                  PIC X(26)   VALUE SPACES.        08120003
019000     05  FILLER                  PIC X(40)   VALUE                08130016
019100         '  ------------------ DIFFERENCE(S) FOUND'.              08140016
*************   123456789-123456789-123456789-123456789-12345           08141016
019200     05  FILLER                  PIC X(25)   VALUE                08150003
M19300         ' ------------------------'.                             08160003
017900 01  HL4-HEADING-LINE-4.                                          08170003
018000     05  FILLER                  PIC X(12)   VALUE SPACES.        08180016
018400     05  FILLER                  PIC X(13)   VALUE                08190003
018500         'TYPE     ID  '.                                         08200003
018700     05  FILLER                  PIC X(16)   VALUE SPACES.        08210016
019000     05  FILLER                  PIC X(19)   VALUE                08220014
019100         'HIER  NBR   CL   CL'.                                   08230014
019000     05  FILLER                  PIC X(35)   VALUE                08240026
019100         ' STYLE ID   SKU NBR  TYP   GRID    '.                   08241026
019000     05  FILLER                  PIC X(11)   VALUE                08241226
019100         'UNIT RTL   '.                                           08241326
019000     05  FILLER                  PIC X(24)   VALUE                08242016
019100         ' GRP ID  QTY    GRP RTL '.                              08243016
*************   123456789-123456789-123456789-12345678                  08243116
019000     05  FILLER                  PIC X(26)   VALUE                08244003
019100         '---SOR UPDATE TIMESTAMP---'.                            08250003
019200     05  FILLER                  PIC X(97)   VALUE SPACES.        08280003
019500                                                                  08290003
019600******************************************************************08300003
019700*  DETAIL LINE LAYOUT FOR THE ERROR REPORT.                       08310003
019800******************************************************************08320003
019900 01  DLS-DETAIL-LINE-1.                                           08450008
020100     05  DLS-SOR-PRCHG-ID        PIC Z(10)-    VALUE ZEROES.      08460003
020100     05  DLS-GP-TYP              PIC Z(05)-    VALUE ZEROES.      08480003
021000     05  FILLER                  PIC X(01)     VALUE SPACES.      08490003
020100     05  DLS-GP-ID               PIC Z(05)-    VALUE ZEROES.      08500003
020100     05  DLS-MDSE-ID             PIC Z(10)-    VALUE ZEROES.      08502003
020600     05  FILLER                  PIC X(01)     VALUE SPACES.      08510016
020300     05  DLS-SOURCE              PIC X(03)     VALUE 'SOR'.       08520003
020600     05  FILLER                  PIC X(02)     VALUE SPACES.      08521014
020300     05  DLS-HIER                PIC X(03)     VALUE SPACES.      08522014
020600     05  FILLER                  PIC X(02)     VALUE SPACES.      08530014
020300     05  DLS-DEPT-NBR            PIC ZZZZ      VALUE ZEROES.      08540005
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08550014
020300     05  DLS-MAJ-CL              PIC ZZZZ      VALUE ZEROES.      08560003
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      08570014
020300     05  DLS-SUB-CL              PIC ZZZZ      VALUE ZEROES.      08570103
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08570214
020300     05  DLS-STYLE               PIC Z(8)      VALUE ZEROES.      08570303
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08570414
020300     05  DLS-SKU                 PIC Z(8)      VALUE ZEROES.      08570503
           05  FILLER                  PIC X(02)     VALUE SPACES.      08570626
           05  DLS-CLR-TYP             PIC X(1)      VALUE SPACES.      08571026
           05  FILLER                  PIC X(01)     VALUE SPACES.      08571126
           05  DLS-PRC-GRID            PIC Z(9)      VALUE ZEROES.      08571226
020300     05  DLS-SOR-UNT-RTL         PIC -Z(7).99  VALUE ZEROES.      08572026
020300     05  DLS-SOR-GP-PRIC-ID      PIC -Z(08)9   VALUE ZEROES.      08575003
020300     05  DLS-SOR-GP-RTL-QTY      PIC -ZZZ9     VALUE ZEROES.      08577003
020300     05  DLS-SOR-GP-RTL-AMT      PIC -Z(7).99  VALUE ZEROES.      08579003
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08579116
020300     05  DLS-SOR-SOR-UPD         PIC X(26)     VALUE ZEROES.      08580003
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08590014
021100     05  DLS-ERROR.                                               08601105
021100         10  DLS-ERR-HIER        PIC X(05)     VALUE SPACES.      08601226
021100         10  DLS-ERR-DEPT        PIC X(05)     VALUE SPACES.      08601326
021100         10  DLS-ERR-MAJ         PIC X(04)     VALUE SPACES.      08601426
021100         10  DLS-ERR-SUB         PIC X(04)     VALUE SPACES.      08601526
021100         10  DLS-ERR-STYLE       PIC X(06)     VALUE SPACES.      08602026
021100         10  DLS-ERR-SKU         PIC X(06)     VALUE SPACES.      08620026
021100         10  DLS-ERR-UNT-RTL     PIC X(06)     VALUE SPACES.      08621027
021300                                                                  08680003
019900 01  DLX-DETAIL-LINE-1.                                           08690008
020500     05  DLX-XS-PRCHG-ID         PIC Z(10)-    VALUE ZEROES.      08700003
020100     05  DLX-GP-TYP              PIC Z(05)-    VALUE ZEROES.      08720003
021000     05  FILLER                  PIC X(01)     VALUE SPACES.      08730014
020100     05  DLX-GP-ID               PIC Z(05)-    VALUE ZEROES.      08740003
020100     05  DLX-MDSE-ID             PIC Z(10)-    VALUE ZEROES.      08742003
021000     05  FILLER                  PIC X(01)     VALUE SPACES.      08750016
020300     05  DLX-SOURCE              PIC X(03)     VALUE 'XS '.       08760003
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      08770014
020300     05  DLX-HIER                PIC X(03)     VALUE SPACES.      08770114
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      08770214
020300     05  DLX-DEPT-NBR            PIC ZZZZ      VALUE ZEROES.      08771005
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08772014
020300     05  DLX-MAJ-CL              PIC ZZZZ      VALUE ZEROES.      08773005
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      08774014
020300     05  DLX-SUB-CL              PIC ZZZZ      VALUE ZEROES.      08775005
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08776014
020300     05  DLX-STYLE               PIC Z(8)      VALUE ZEROES.      08777005
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08778014
020300     05  DLX-SKU                 PIC Z(8)      VALUE ZEROES.      08779005
           05  FILLER                  PIC X(02)     VALUE SPACES.      08780026
           05  DLX-CLR-TYP             PIC X(1)      VALUE SPACES.      08790026
           05  FILLER                  PIC X(01)     VALUE SPACES.      08800026
           05  DLX-PRC-GRID            PIC Z(9)      VALUE ZEROES.      08810026
020300     05  DLX-XS-UNT-RTL          PIC -Z(7).99  VALUE ZEROES.      08811005
020300     05  DLX-XS-GP-PRIC-ID       PIC -Z(08)9   VALUE ZEROES.      08812005
020300     05  DLX-XS-GP-RTL-QTY       PIC -ZZZ9     VALUE ZEROES.      08813005
020300     05  DLX-XS-GP-RTL-AMT       PIC -Z(7).99  VALUE ZEROES.      08814005
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08815014
020300     05  DLX-XS-SOR-UPD          PIC X(26)     VALUE ZEROES.      08820003
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      08830014
021100     05  DLX-ERROR.                                               08830108
021100         10  DLX-ERR-CLR-TYP     PIC X(06)     VALUE SPACES.      08830227
021100         10  DLX-ERR-PRC-GRID    PIC X(06)     VALUE SPACES.      08832026
021100         10  DLX-ERR-GP-PRIC-ID  PIC X(06)     VALUE SPACES.      08835026
021100         10  DLX-ERR-GP-RTL-QTY  PIC X(06)     VALUE SPACES.      08836026
021100         10  DLX-ERR-GP-RTL-AMT  PIC X(06)     VALUE SPACES.      08837026
021100         10  DLX-ERR-SOR-UPD-TMST PIC X(06)     VALUE SPACES.     08838026
021300                                                                  08840003
021400******************************************************************08850003
021500*  TRAILER LAYOUT FOR THE ERROR REPORT.                           08860003
021600******************************************************************08870003
021700 01  TR1-TRAILER-LINE-1.                                          08880003
021800     05  FILLER                  PIC X(25)   VALUE                08890003
021900         ' TOTAL NUMBER OF ERRORS: '.                             08900003
022000     05  TR1-TOTAL-ERROR-CNT     PIC Z(09)   VALUE ZEROS.         08910003
022100     05  FILLER                  PIC X(166)  VALUE SPACES.        08920003
022200                                                                  08930003
022300******************************************************************08940003
022400**COPYBOOKS                                                       08950003
022500******************************************************************08960003
022600                                                                  08970003
022700***SOR EXTRACT FILE LAYOUT                                        08980003
022800     COPY PERD105.                                                08990003
022900                                                                  09000003
023000***XS EXTRACT FILE LAYOUT                                         09010003
023100     COPY XSRD071.                                                09020003
023200                                                                  09030003
023300***************************************************************** 09040003
023400 PROCEDURE DIVISION.                                              09050003
023500***************************************************************** 09060003
023600 0000-MAINLINE.                                                   09070003
023700                                                                  09080003
           DISPLAY '***** STARTING XSKRP040'                            09081012
023800     PERFORM 1000-INITIALIZATION.                                 09090003
023900                                                                  09100003
           IF PS-NOT-END-OF-SOR-PRCHG                                   09101028
024000        PERFORM 2000-PROCESS-RECORDS                              09110028
024100          UNTIL PS-END-OF-SOR-PRCHG                               09120028
024200             OR PS-END-OF-XS-PRCHG                                09130028
           END-IF.                                                      09131028
024300                                                                  09140003
024400     PERFORM 2200-PROCESS-EXTRA-RECORDS                           09150003
024500       UNTIL PS-END-OF-SOR-PRCHG                                  09160003
024600         AND PS-END-OF-XS-PRCHG.                                  09170003
024700                                                                  09180003
024710     IF PV-ERROR-RECORD-WRITTEN-CNT = 0                           09190003
024720         MOVE PC-NO-ERROR-MESSAGE TO PV-PRINT-RECORD              09200005
024740         PERFORM 8900-WRITE-REPORT-LINE                           09220003
024750     ELSE                                                         09230003
024760         MOVE PV-ERROR-RECORD-WRITTEN-CNT TO                      09240003
024770                TR1-TOTAL-ERROR-CNT                               09250003
024780         MOVE TR1-TRAILER-LINE-1  TO PV-PRINT-RECORD              09260003
024790         PERFORM 8900-WRITE-REPORT-LINE                           09270003
024791     END-IF.                                                      09280003
024792                                                                  09290003
024800     PERFORM 9000-END-OF-PGM.                                     09300003
024900                                                                  09310003
025000     GOBACK.                                                      09320003
025100                                                                  09330003
025200******************************************************************09340003
025300*1000-INITIALIZATION.                                             09350003
025400* INITIALIZATION AREA                                             09360003
025500******************************************************************09370003
025600 1000-INITIALIZATION.                                             09380003
025700                                                                  09390003
025800     INITIALIZE PV-PROGRAM-COUNTER.                               09400003
025900                                                                  09410003
026000     OPEN INPUT  SOR-PRCHG-EXTRACT-FILE                           09420003
026300                 XS-PRCHG-EXTRACT-FILE.                           09430003
026400                                                                  09440003
026500     OPEN OUTPUT XS-PRCHG-INTEG-RPT-FILE.                         09450003
026600                                                                  09460003
031100     ACCEPT PV-CURR-TIME FROM TIME.                               09461030
031200     MOVE PV-CURR-TIME-HH          TO DP200-RUN-HOUR.             09462030
031300     MOVE PV-CURR-TIME-MM          TO DP200-RUN-MINUTE.           09463030
031400                                                                  09464030
031500     MOVE FUNCTION CURRENT-DATE (1:8)                             09465030
031600                                   TO PV-CURR-DATE-CCYYMMDD.      09466030
031700                                                                  09467030
031800     MOVE PV-CURR-DATE-MM          TO DP200-RUN-MONTH.            09468030
031900     MOVE PV-CURR-DATE-DD          TO DP200-RUN-DAY.              09469030
032000     MOVE PV-CURR-DATE-CCYY        TO DP200-RUN-YEAR.             09469130
032100                                                                  09469230
032200     MOVE PC-CURRENT-PROGRAM-NAME  TO DP200-PROGRAM-NAME.         09469330
032300                                                                  09469430
032400     PERFORM 8700-REPORT-HEADER-ROUTINE.                          09469530
032500                                                                  09469630
029300     PERFORM 7000-READ-SOR-PRCHG-EXTRACT                          09470003
029600                                                                  09480003
029700     IF PS-END-OF-SOR-PRCHG                                       09490003
              INITIALIZE  DLS-DETAIL-LINE-1                             09491028
              MOVE ZEROES             TO PE105-PRCHG-ID                 09510028
                                         PE105-STR-GP-TYP-CDE           09513028
                                         PE105-STR-GP-ID                09514028
                                         PE105-PRCHG-MDSE-ID            09515028
              MOVE 'SOR'              TO DLS-SOURCE                     09520028
              MOVE PC-EMPTY-SOR-PRCHG TO DLS-ERROR                      09530028
              MOVE DLS-DETAIL-LINE-1  TO PV-PRINT-RECORD                09540028
NEMDEL**** NOTE: THIS SITUATION WILL NOT TRIGGER RC 4 FOR MSG           09540132
NEMDEL******* ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                     09540232
              PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                       09541129
              PERFORM 8900-WRITE-REPORT-LINE                            09542028
030200     END-IF.                                                      09550003
030300                                                                  09560003
030500     PERFORM 7100-READ-XS-PRCHG-EXTRACT.                          09570003
031000                                                                  09580003
032600******************************************************************09740003
032700*2000-PROCESS-RECORDS.                                            09750003
032800* THIS SECTION COMPARES RECORDS ON THE SOR PRCHG MDSE FILE &      09760005
032900* XS DOMAIN EXTRACT FILE. IF KEYS MATCH, PROGRAM LOOKS AT DETAIL  09770003
032900* FIELDS AND CHECKS THAT THEY MATCH, DIFFERENCES ARE REPORTED.    09780003
033000* IF KEY (PRCHG ID+ STR GP ID & TYP ALONG WITH MDSE ID) DOES      09790005
033000* NOT APPEAR ON ONE FILE, BUT IS ON THE OTHER FILE THEN AN        09791005
033010* APPROPRIATE MESSAGE WILL BE WRITTEN TO THE ERROR FILE, ALONG    09800005
033100* WITH THE DATA THAT WAS ON THE CORRESPONDING FILES.              09810005
033300******************************************************************09830003
033400 2000-PROCESS-RECORDS.                                            09840003
033500                                                                  09850003
033600     INITIALIZE DLS-DETAIL-LINE-1                                 09860008
                      DLX-DETAIL-LINE-1                                 09880008
033800                                                                  09890003
NEMTST**   DISPLAY '>>> 2000-PROCESS KEYS ARE PRCHG SOR*'               09900023
NEMTST**           PE105-PRCHG-ID,                                      09910023
NEMTST**              '== AND XS*'                                      09920023
NEMTST**           XS071-PRCHG-ID, '**'                                 09930023
NEMTST**   DISPLAY '>>>               STORE GRP TYP SOR*'               09940023
NEMTST**           PE105-STR-GP-TYP-CDE,                                09950023
NEMTST**              '== AND XS*'                                      09960023
NEMTST**           XS071-STR-GP-TYP-CDE, '**'                           09970023
NEMTST**   DISPLAY '>>>               STORE GRP ID  SOR*'               09980023
NEMTST**           PE105-STR-GP-ID,                                     09990023
NEMTST**              '== AND XS*'                                      10000023
NEMTST**           XS071-STR-GP-ID, '**'                                10010023
NEMTST**   DISPLAY '>>>                    MDSE ID  SOR*'               10011023
NEMTST**           PE105-PRCHG-MDSE-ID,                                 10012023
NEMTST**              '== AND XS*'                                      10013023
NEMTST**           XS071-PRCHG-MDSE-ID, '**'                            10014023
033900     EVALUATE TRUE                                                10020003
034000        WHEN PE105-PRCHG-ID = XS071-PRCHG-ID                      10030003
               AND PE105-STR-GP-TYP-CDE  = XS071-STR-GP-TYP-CDE         10040003
                 AND PE105-STR-GP-ID = XS071-STR-GP-ID                  10050003
                 AND PE105-PRCHG-MDSE-ID = XS071-PRCHG-MDSE-ID          10051005
NEMTST***          DISPLAY '>>>---  MATCHED KEYS  -------<<<<'          10052023
                   ADD +1 TO PV-SOR-XS-COMMON-CNT                       10060003
034100             PERFORM 2100-COMPARE-FIELDS                          10070003
034200             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  10080003
034700             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   10090003
034000        WHEN PE105-PRCHG-ID = XS071-PRCHG-ID                      10100003
               AND PE105-STR-GP-TYP-CDE  = XS071-STR-GP-TYP-CDE         10110005
                 AND PE105-STR-GP-ID = XS071-STR-GP-ID                  10120005
                   AND PE105-PRCHG-MDSE-ID NOT = XS071-PRCHG-MDSE-ID    10121005
NEMTST***          DISPLAY '>>>---  MDSE MISMATCH -------<<<<'          10121123
                IF PE105-PRCHG-MDSE-ID < XS071-PRCHG-MDSE-ID            10122005
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10140003
035500             PERFORM 2400-MOVE-SOR-VALUES                         10150005
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        10160005
035700               TO DLS-ERROR                                       10170007
035800             MOVE DLS-DETAIL-LINE-1 TO PV-PRINT-RECORD            10180005
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10190003
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   10200003
036000             PERFORM 8900-WRITE-REPORT-LINE                       10210003
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  10220003
035200          ELSE                                                    10230003
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10240003
036400             PERFORM 2500-MOVE-XS-VALUES                          10250003
035600             MOVE PC-MISSING-FROM-SOR-PRCHG                       10260007
036600               TO DLX-ERROR                                       10270008
036700             MOVE DLX-DETAIL-LINE-1 TO PV-PRINT-RECORD            10280005
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10290003
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   10300003
036900             PERFORM 8900-WRITE-REPORT-LINE                       10310003
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   10320003
035200          END-IF                                                  10330003
034000        WHEN PE105-PRCHG-ID = XS071-PRCHG-ID                      10331005
               AND (PE105-STR-GP-TYP-CDE  = XS071-STR-GP-TYP-CDE        10332005
                 AND PE105-STR-GP-ID NOT = XS071-STR-GP-ID)             10333005
NEMTST**           DISPLAY '>>>---  STR GP MISMATCH -----<<<<'          10333123
                IF PE105-STR-GP-ID < XS071-STR-GP-ID                    10334005
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10335005
035500             PERFORM 2400-MOVE-SOR-VALUES                         10335108
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        10336107
035700               TO DLS-ERROR                                       10338007
035800             MOVE DLS-DETAIL-LINE-1 TO PV-PRINT-RECORD            10339007
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10339105
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   10339205
036000             PERFORM 8900-WRITE-REPORT-LINE                       10339305
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  10339405
035200          ELSE                                                    10339505
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10339605
036400             PERFORM 2500-MOVE-XS-VALUES                          10339705
035600             MOVE PC-MISSING-FROM-SOR-PRCHG                       10339807
036600               TO DLX-ERROR                                       10340008
036700             MOVE DLX-DETAIL-LINE-1 TO PV-PRINT-RECORD            10340107
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10340205
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   10340305
036900             PERFORM 8900-WRITE-REPORT-LINE                       10340405
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   10340505
035200          END-IF                                                  10340605
034000        WHEN PE105-PRCHG-ID = XS071-PRCHG-ID                      10341003
               AND (PE105-STR-GP-TYP-CDE NOT = XS071-STR-GP-TYP-CDE)    10350003
NEMTST**           DISPLAY '>>>---  GP TYP MISMATCH -----<<<<'          10351023
                IF PE105-STR-GP-TYP-CDE < XS071-STR-GP-TYP-CDE          10360003
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10370003
035500             PERFORM 2400-MOVE-SOR-VALUES                         10380003
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        10381007
035700               TO DLS-ERROR                                       10400008
035800             MOVE DLS-DETAIL-LINE-1 TO PV-PRINT-RECORD            10410007
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10420003
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   10430003
036000             PERFORM 8900-WRITE-REPORT-LINE                       10440003
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  10450003
035200          ELSE                                                    10460003
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10470003
036400             PERFORM 2500-MOVE-XS-VALUES                          10480003
035600             MOVE PC-MISSING-FROM-SOR-PRCHG                       10481007
036600               TO DLX-ERROR                                       10500008
036700             MOVE DLX-DETAIL-LINE-1 TO PV-PRINT-RECORD            10510007
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10520003
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   10530003
036900             PERFORM 8900-WRITE-REPORT-LINE                       10540003
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   10550003
                END-IF                                                  10560003
035300        WHEN PE105-PRCHG-ID < XS071-PRCHG-ID                      10570003
NEMTST***     DISPLAY '=== SOR LOWER *'                                 10580003
NEMTST***          PE105-PRCHG-ID, '-', PE105-PRCHG-ID                  10590003
NEMTST***             '== AND XS*'                                      10600003
NEMTST***          XS071-PRCHG-ID, '-', XS071-PRCHG, '**'               10610003
NEMTST**           DISPLAY '>>>---  PRCHG  SOR LOW  -----<<<<'          10611023
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10620003
035500             PERFORM 2400-MOVE-SOR-VALUES                         10630003
035600             MOVE PC-MISSING-FROM-XS-PRCHG                        10640003
035700               TO DLS-ERROR                                       10650008
035800             MOVE DLS-DETAIL-LINE-1 TO PV-PRINT-RECORD            10660007
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10670003
                   ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                   10680003
036000             PERFORM 8900-WRITE-REPORT-LINE                       10690003
036100             PERFORM 7000-READ-SOR-PRCHG-EXTRACT                  10700003
036200        WHEN PE105-PRCHG-ID > XS071-PRCHG-ID                      10710003
NEMTST**           DISPLAY '>>>---  PRCHG SOR HIGH  -----<<<<'          10711023
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  10720003
036400             PERFORM 2500-MOVE-XS-VALUES                          10730003
036500             MOVE PC-MISSING-FROM-SOR-PRCHG                       10740003
036600               TO DLX-ERROR                                       10750008
036700             MOVE DLX-DETAIL-LINE-1 TO PV-PRINT-RECORD            10760007
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                10770003
                   ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                   10780003
036900             PERFORM 8900-WRITE-REPORT-LINE                       10790003
037000             PERFORM 7100-READ-XS-PRCHG-EXTRACT                   10800003
036200        WHEN OTHER                                                10801007
NEMTST             DISPLAY '>>>--- UNPLANNED CASE -------<<<<'          10802024
NEMTST             DISPLAY '=== XS RECORD-'                             10803024
NEMTST                          XS071-PRCHG-MDSE-UNLOAD, '**'           10804024
NEMTST             DISPLAY '=== SOR RECORD-'                            10805024
NEMTST                          PE105-RECORD, '**'                      10806024
037100     END-EVALUATE.                                                10810003
037200                                                                  10820003
037300******************************************************************10830003
M37400*2100-COMPARE-FIELDS.                                             10840014
037500* COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   10850003
037600******************************************************************10860003
037700 2100-COMPARE-FIELDS.                                             10870003
037800                                                                  10880003
037900     SET PS-NO-ERROR-FOUND               TO TRUE.                 10890003
038200                                                                  10900003
038800     IF  PE105-MDSE-HIER-CDE NOT EQUAL XS071-MDSE-HIER-CDE        10901007
038900         SET PS-ERROR-FOUND  TO TRUE                              10902007
021100         MOVE 'HIER  ' TO  DLS-ERR-HIER                           10903026
039100     END-IF.                                                      10904007
039200                                                                  10905007
           IF PE105-DEPT-NBR-NI EQUAL PC-NULL                           10905236
              IF XS071-DEPT-NBR-IS-NULL                                 10905336
                 CONTINUE                                               10905436
              ELSE                                                      10905536
038900           SET PS-ERROR-FOUND  TO TRUE                            10905636
021100           MOVE 'DEPT ' TO  DLS-ERR-DEPT                          10905736
039100        END-IF                                                    10905836
           ELSE                                                         10905936
              IF XS071-DEPT-NBR-IS-NULL                                 10906036
038900           SET PS-ERROR-FOUND  TO TRUE                            10906136
021100           MOVE 'DEPT ' TO  DLS-ERR-DEPT                          10906236
              ELSE                                                      10906336
                 IF PE105-DEPT-NBR NOT EQUAL XS071-DEPT-NBR             10906436
                    SET PS-ERROR-FOUND  TO TRUE                         10906536
                    MOVE 'DEPT ' TO  DLS-ERR-DEPT                       10906636
                 END-IF                                                 10906736
039100        END-IF                                                    10906836
039100     END-IF.                                                      10906936
039200                                                                  10910807
           IF PE105-MAJ-CL-NBR-NI EQUAL PC-NULL                         10911036
              IF XS071-MAJ-CL-NBR-IS-NULL                               10911136
                 CONTINUE                                               10911236
              ELSE                                                      10911336
038900           SET PS-ERROR-FOUND  TO TRUE                            10911436
021100           MOVE 'MAJ  ' TO  DLS-ERR-MAJ                           10911536
039100        END-IF                                                    10911636
           ELSE                                                         10911736
              IF XS071-MAJ-CL-NBR-IS-NULL                               10911836
038900           SET PS-ERROR-FOUND  TO TRUE                            10911936
021100           MOVE 'MAJ  ' TO  DLS-ERR-MAJ                           10912036
              ELSE                                                      10912136
                 IF PE105-MAJ-CL-NBR NOT EQUAL XS071-MAJ-CL-NBR         10912236
                    SET PS-ERROR-FOUND  TO TRUE                         10912336
                    MOVE 'MAJ  ' TO  DLS-ERR-MAJ                        10912436
                 END-IF                                                 10912536
039100        END-IF                                                    10912636
039100     END-IF.                                                      10912736
039200                                                                  10991007
           IF PE105-SUB-CL-NBR-NI EQUAL PC-NULL                         10991236
              IF XS071-SUB-CL-NBR-IS-NULL                               10991336
                 CONTINUE                                               10991436
              ELSE                                                      10991536
038900           SET PS-ERROR-FOUND  TO TRUE                            10991636
021100           MOVE 'SUB  ' TO  DLS-ERR-SUB                           10991736
039100        END-IF                                                    10991836
           ELSE                                                         10991936
              IF XS071-SUB-CL-NBR-IS-NULL                               10992036
038900           SET PS-ERROR-FOUND  TO TRUE                            10992136
021100           MOVE 'SUB  ' TO  DLS-ERR-SUB                           10992236
              ELSE                                                      10992336
                 IF PE105-SUB-CL-NBR NOT EQUAL XS071-SUB-CL-NBR         10992436
038900              SET PS-ERROR-FOUND  TO TRUE                         10992536
021100              MOVE 'SUB  ' TO  DLS-ERR-SUB                        10992636
                 END-IF                                                 10992736
039100        END-IF                                                    10992836
039100     END-IF.                                                      10992936
039200                                                                  11019107
           IF  PE105-SKU-NBR-NI EQUAL PC-NULL                           11019336
              IF XS071-SKU-NBR-IS-NULL                                  11019436
                 CONTINUE                                               11019536
              ELSE                                                      11019636
038900           SET PS-ERROR-FOUND  TO TRUE                            11019736
021100           MOVE 'SKU  ' TO  DLS-ERR-SKU                           11019836
039100        END-IF                                                    11019936
           ELSE                                                         11020036
              IF XS071-SKU-NBR-IS-NULL                                  11020136
038900           SET PS-ERROR-FOUND  TO TRUE                            11020236
021100           MOVE 'SKU  ' TO  DLS-ERR-SKU                           11020336
              ELSE                                                      11020436
038800           IF PE105-SKU-NBR NOT EQUAL XS071-SKU-NBR               11021036
                    SET PS-ERROR-FOUND  TO TRUE                         11022036
021100              MOVE 'SKU  ' TO  DLS-ERR-SKU                        11023036
                 END-IF                                                 11041036
039100        END-IF                                                    11041136
039100     END-IF.                                                      11041236
039200                                                                  11041336
           IF PE105-MDSE-PRIC-AMT-NI EQUAL PC-NULL                      11041436
              IF XS071-UNT-RTL-IS-NULL                                  11041536
                 CONTINUE                                               11041636
              ELSE                                                      11041736
                 SET PS-ERROR-FOUND  TO TRUE                            11041836
021100           MOVE ' RTL $  ' TO  DLS-ERR-UNT-RTL                    11041936
              END-IF                                                    11042036
           ELSE                                                         11042136
              IF XS071-UNT-RTL-IS-NULL                                  11042236
                 SET PS-ERROR-FOUND  TO TRUE                            11042336
021100           MOVE ' RTL $  ' TO  DLS-ERR-UNT-RTL                    11042436
              ELSE                                                      11042636
                 IF PE105-MDSE-PRIC-AMT NOT EQUAL XS071-UNT-RTL-AMT     11042736
038900              SET PS-ERROR-FOUND  TO TRUE                         11042836
021100              MOVE ' RTL $  ' TO  DLS-ERR-UNT-RTL                 11043036
                 END-IF                                                 11044036
039100        END-IF                                                    11044136
039100     END-IF.                                                      11044236
039200                                                                  11045005
           IF XS071-GP-PRIC-ID-IS-NULL                                  11045236
              IF PE105-GP-PRIC-ID-NI EQUAL PC-NULL                      11045336
                 CONTINUE                                               11045436
              ELSE                                                      11045536
038900           SET PS-ERROR-FOUND  TO TRUE                            11045636
021100           MOVE ' GP ID ' TO  DLX-ERR-GP-PRIC-ID                  11045736
              END-IF                                                    11045836
           ELSE                                                         11045936
              IF PE105-GP-PRIC-ID-NI EQUAL PC-NULL                      11046036
038900           SET PS-ERROR-FOUND  TO TRUE                            11046136
021100           MOVE ' GP ID ' TO  DLX-ERR-GP-PRIC-ID                  11046236
              ELSE                                                      11046336
                 IF  PE105-GP-PRIC-ID   NOT EQUAL XS071-GP-PRIC-ID      11046436
                    SET PS-ERROR-FOUND  TO TRUE                         11046536
                    MOVE ' GP ID ' TO  DLX-ERR-GP-PRIC-ID               11046636
                 END-IF                                                 11046736
              END-IF                                                    11046836
           END-IF.                                                      11046936
039200                                                                  11048107
           IF XS071-GP-RTL-QTY-IS-NULL                                  11048336
              IF PE105-GP-QTY-NI EQUAL PC-NULL                          11048436
                 CONTINUE                                               11048536
              ELSE                                                      11048636
                 SET PS-ERROR-FOUND  TO TRUE                            11048736
                 MOVE ' G QTY ' TO  DLX-ERR-GP-RTL-QTY                  11048836
              END-IF                                                    11048936
           ELSE                                                         11049036
              IF PE105-GP-QTY-NI EQUAL PC-NULL                          11049136
                 SET PS-ERROR-FOUND  TO TRUE                            11049236
                 MOVE ' G QTY ' TO  DLX-ERR-GP-RTL-QTY                  11049336
              ELSE                                                      11049436
                 IF PE105-GP-QTY   NOT EQUAL XS071-GP-RTL-QTY           11049636
038900              SET PS-ERROR-FOUND  TO TRUE                         11050136
021100              MOVE ' G QTY ' TO  DLX-ERR-GP-RTL-QTY               11050236
039100           END-IF                                                 11050336
039100        END-IF                                                    11050436
039100     END-IF.                                                      11050536
039200                                                                  11050736
038800     IF XS071-GP-RTL-AMT-IS-NULL                                  11050936
              IF PE105-GP-PRIC-AMT-NI EQUAL PC-NULL                     11051036
                 CONTINUE                                               11051136
              ELSE                                                      11051236
038900           SET PS-ERROR-FOUND  TO TRUE                            11051336
021100           MOVE ' G AMT ' TO  DLX-ERR-GP-RTL-AMT                  11051436
              END-IF                                                    11051536
           ELSE                                                         11051636
              IF PE105-GP-PRIC-AMT-NI EQUAL PC-NULL                     11051736
038900           SET PS-ERROR-FOUND  TO TRUE                            11051836
021100           MOVE ' G AMT ' TO  DLX-ERR-GP-RTL-AMT                  11051936
              ELSE                                                      11052036
038800           IF PE105-GP-PRIC-AMT   NOT EQUAL XS071-GP-RTL-AMT      11470936
038900              SET PS-ERROR-FOUND  TO TRUE                         11471636
021100              MOVE ' G AMT ' TO  DLX-ERR-GP-RTL-AMT               11471736
039100           END-IF                                                 11471836
039100       END-IF                                                     11471936
039100     END-IF.                                                      11472036
039200* 07/26/2010 - COMMENTED OUT AS PART OF MDO SPRING 2010 PROJECT   11472143
038800*    IF  PE105-SOR-LAST-UPD-TMST                                  11472239
      *                       NOT EQUAL XS071-SOR-LAST-UPD-TMST         11472339
038900*         SET PS-ERROR-FOUND  TO TRUE                             11472439
021100*         MOVE ' TMSTP ' TO  DLX-ERR-SOR-UPD-TMST                 11472539
039100*    END-IF.                                                      11472639
039200                                                                  11472736
           IF  PE105-CLR-TYP-CDE NOT EQUAL XS071-CLR-TYP-CDE            11472936
             IF  XS071-CLR-TYP-CDE-IS-NULL                              11473036
               AND PE105-CLR-TYP-CDE-NI EQUAL PC-NULL                   11473136
                 CONTINUE                                               11473236
             ELSE                                                       11473336
                 SET PS-ERROR-FOUND  TO TRUE                            11473436
                 MOVE 'C TYP ' TO  DLX-ERR-CLR-TYP                      11473536
             END-IF                                                     11473636
           END-IF.                                                      11473736
                                                                        11473836
           IF XS071-PRICG-GRID-ID-IS-NULL                               11474036
              IF PE105-PRICG-GRID-ID-NI EQUAL PC-NULL                   11474136
                 CONTINUE                                               11474236
              ELSE                                                      11474336
                 SET PS-ERROR-FOUND  TO TRUE                            11474436
                 MOVE 'GRID ' TO  DLX-ERR-PRC-GRID                      11474536
              END-IF                                                    11474636
           ELSE                                                         11474736
              IF PE105-PRICG-GRID-ID-NI EQUAL PC-NULL                   11474836
                 SET PS-ERROR-FOUND  TO TRUE                            11474936
                 MOVE 'GRID ' TO  DLX-ERR-PRC-GRID                      11475036
              ELSE                                                      11475136
                 IF PE105-PRICG-GRID-ID NOT EQUAL XS071-PRICG-GRID-ID   11475236
                    SET PS-ERROR-FOUND  TO TRUE                         11475736
                    MOVE 'GRID ' TO  DLX-ERR-PRC-GRID                   11475836
                 END-IF                                                 11475936
              END-IF                                                    11476036
           END-IF.                                                      11476136
                                                                        11476236
039300     IF  PS-ERROR-FOUND                                           11476336
039400         PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                      11476436
039500         PERFORM 2400-MOVE-SOR-VALUES                             11476536
039500         PERFORM 2500-MOVE-XS-VALUES                              11476636
039800         MOVE DLS-DETAIL-LINE-1     TO PV-PRINT-RECORD            11476736
040000         PERFORM 8900-WRITE-REPORT-LINE                           11476836
039800         MOVE DLX-DETAIL-LINE-1     TO PV-PRINT-RECORD            11476936
039900         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    11477036
040000         PERFORM 8900-WRITE-REPORT-LINE                           11477136
040100     ELSE                                                         11477236
NEMTST***  DISPLAY '>>>*** RECORDS MATCHED SOR*'                        11477336
NEMTST***          PE105-RECORD                                         11477436
NEMTST***  DISPLAY '>>>***                  XS*'                        11477536
NEMTST***          XS071-PRCHG-MDSE-UNLOAD                              11477636
040200         ADD +1 TO PV-VALID-MATCH-CNT                             11477736
040300     END-IF.                                                      11477836
040400                                                                  11477936
040700******************************************************************11478036
040800**  PROCESSES THRU END OF FILE FOR REMAINING RECORDS              11478136
040900******************************************************************11478236
041000 2200-PROCESS-EXTRA-RECORDS.                                      11478336
041100                                                                  11478436
041200     INITIALIZE DLS-DETAIL-LINE-1,                                11478536
                      DLX-DETAIL-LINE-1.                                11478636
041400                                                                  11478736
041500     IF  PS-NOT-END-OF-SOR-PRCHG                                  11478836
041700         PERFORM 2400-MOVE-SOR-VALUES                             11478936
041800         MOVE PC-EXTRA-FOUND-SOR-PRCHG TO DLS-ERROR               11479036
042000         MOVE DLS-DETAIL-LINE-1   TO PV-PRINT-RECORD              11479136
042010         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    11479236
               ADD +1 TO PV-SOR-PRCHG-RECS-UNIQUE                       11479337
042100         PERFORM 8900-WRITE-REPORT-LINE                           11479436
042300         PERFORM 7000-READ-SOR-PRCHG-EXTRACT                      11479536
042400     END-IF.                                                      11479636
042500                                                                  11479736
042600     IF  PS-NOT-END-OF-XS-PRCHG                                   11479836
042800         PERFORM 2500-MOVE-XS-VALUES                              11480005
042900         MOVE PC-EXTRA-FOUND-XS-PRCHG TO DLX-ERROR                11490005
043100         MOVE DLX-DETAIL-LINE-1   TO PV-PRINT-RECORD              11510005
043110         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    11520005
               ADD +1 TO PV-XS-EXTRACT-REC-UNIQUE                       11521037
043200         PERFORM 8900-WRITE-REPORT-LINE                           11530005
043400         PERFORM 7100-READ-XS-PRCHG-EXTRACT                       11550003
043500     END-IF.                                                      11560003
043600                                                                  11570003
043700******************************************************************11580003
043800* 2300-CHECK-IF-NEW-PG-NEEDED.                                    11590003
043900*     CHECKS TO SEE IF A NEW PAGE IS NEEDED.                      11600003
044000***************************************************************** 11610003
044100 2300-CHECK-IF-NEW-PG-NEEDED.                                     11620003
044200                                                                  11630003
044300     IF PV-LINE-CNT > PC-MAX-REPORT-LINES                         11640003
044400        PERFORM 8700-REPORT-HEADER-ROUTINE                        11650003
044500     END-IF.                                                      11660003
044600                                                                  11670003
044700******************************************************************11680003
044800* 2400-MOVE-SOR-VALUES.                                           11690003
044900*     MOVES THE SOR ITEM PRCHG VALUES TO THE ERROR RECORD.        11700003
045000***************************************************************** 11710003
045100 2400-MOVE-SOR-VALUES.                                            11720003
045200                                                                  11730003
045300     MOVE PE105-PRCHG-ID     TO PV-TEMP-PRCHG-ID                  11740003
045400     MOVE PV-TEMP-PRCHG-ID   TO DLS-SOR-PRCHG-ID.                 11750005
           MOVE PE105-STR-GP-TYP-CDE  TO DLS-GP-TYP.                    11770005
           MOVE PE105-STR-GP-ID    TO DLS-GP-ID.                        11780005
045500     MOVE PE105-PRCHG-MDSE-ID   TO DLS-MDSE-ID.                   11781008
045400     MOVE 'SOR'              TO DLS-SOURCE.                       11790005
045700                                                                  11791005
           MOVE PE105-MDSE-HIER-CDE TO DLS-HIER.                        11791114
           IF  PE105-DEPT-NBR-NI EQUAL PC-NULL                          11792014
               MOVE ZEROES TO PE105-DEPT-NBR.                           11792314
045500     MOVE PE105-DEPT-NBR     TO DLS-DEPT-NBR.                     11793008
           IF  PE105-MAJ-CL-NBR-NI EQUAL PC-NULL                        11793114
               MOVE ZEROES TO PE105-MAJ-CL-NBR.                         11793414
045500     MOVE PE105-MAJ-CL-NBR   TO DLS-MAJ-CL.                       11794008
           IF  PE105-SUB-CL-NBR-NI EQUAL PC-NULL                        11794114
               MOVE ZEROES TO PE105-SUB-CL-NBR.                         11794414
045500     MOVE PE105-SUB-CL-NBR   TO DLS-SUB-CL.                       11795008
           IF  PE105-STYL-ID-NI EQUAL PC-NULL                           11795114
               MOVE ZEROES TO PE105-STYL-ID.                            11795214
045500     MOVE PE105-STYL-ID      TO DLS-STYLE.                        11795308
           IF  PE105-SKU-NBR-NI EQUAL PC-NULL                           11795414
               MOVE ZEROES TO PE105-SKU-NBR.                            11795514
045500     MOVE PE105-SKU-NBR      TO DLS-SKU.                          11795608
           IF  PE105-CLR-TYP-CDE-NI EQUAL PC-NULL                       11795726
               MOVE SPACES TO PE105-CLR-TYP-CDE.                        11795826
           MOVE PE105-CLR-TYP-CDE  TO DLS-CLR-TYP.                      11795926
           IF  PE105-PRICG-GRID-ID-NI EQUAL PC-NULL                     11796026
               MOVE ZEROES TO PE105-PRICG-GRID-ID.                      11796126
           MOVE PE105-PRICG-GRID-ID TO DLS-PRC-GRID.                    11796226
                                                                        11796326
           IF  PE105-MDSE-PRIC-AMT-NI EQUAL PC-NULL                     11796434
               MOVE ZEROES TO PE105-MDSE-PRIC-AMT.                      11796534
045500     MOVE PE105-MDSE-PRIC-AMT   TO DLS-SOR-UNT-RTL.               11797035
                                                                        11798014
           IF  PE105-GP-PRIC-ID-NI EQUAL PC-NULL                        11798514
               MOVE ZEROES TO PE105-GP-PRIC-ID.                         11798614
           MOVE PE105-GP-PRIC-ID   TO DLS-SOR-GP-PRIC-ID.               11799014
           IF PE105-GP-QTY-NI EQUAL PC-NULL                             11799114
              MOVE ZEROES TO PE105-GP-QTY.                              11799214
           MOVE PE105-GP-QTY       TO DLS-SOR-GP-RTL-QTY.               11799414
           IF PE105-GP-PRIC-AMT-NI EQUAL PC-NULL                        11799514
              MOVE ZEROS TO  PE105-GP-PRIC-AMT.                         11799614
045500     MOVE PE105-GP-PRIC-AMT  TO DLS-SOR-GP-RTL-AMT.               11799705
045700                                                                  11799805
045500     MOVE PE105-SOR-LAST-UPD-TMST TO DLS-SOR-SOR-UPD.             11799905
045700                                                                  11800003
045800******************************************************************11810003
045900* 2500-MOVE-XS-VALUES.                                            11820003
046000*     MOVES THE XS PRCHG VALUES TO THE ERROR RECORD.              11830003
046100***************************************************************** 11840003
046200 2500-MOVE-XS-VALUES.                                             11850003
046300                                                                  11860003
046400     MOVE XS071-PRCHG-ID     TO PV-TEMP-PRCHG-ID.                 11870003
046500     MOVE PV-TEMP-PRCHG-ID   TO DLX-XS-PRCHG-ID.                  11881005
           MOVE XS071-STR-GP-TYP-CDE  TO DLX-GP-TYP.                    11900005
           MOVE XS071-STR-GP-ID       TO DLX-GP-ID.                     11910005
045500     MOVE XS071-PRCHG-MDSE-ID   TO DLX-MDSE-ID.                   11911008
045400     MOVE 'XS '              TO DLX-SOURCE.                       11920005
                                                                        11920114
           MOVE XS071-MDSE-HIER-CDE TO DLX-HIER.                        11920214
045500     MOVE XS071-DEPT-NBR     TO DLX-DEPT-NBR.                     11921008
045500     MOVE XS071-MAJ-CL-NBR   TO DLX-MAJ-CL                        11922008
045500     MOVE XS071-SUB-CL-NBR   TO DLX-SUB-CL.                       11923008
045500     MOVE XS071-STYL-ID      TO DLX-STYLE.                        11923508
045500     MOVE XS071-SKU-NBR      TO DLX-SKU.                          11924114
           MOVE XS071-CLR-TYP-CDE  TO DLX-CLR-TYP.                      11924426
           MOVE XS071-PRICG-GRID-ID TO DLX-PRC-GRID.                    11924726
                                                                        11924826
045500     MOVE XS071-UNT-RTL-AMT  TO DLX-XS-UNT-RTL.                   11925005
045700                                                                  11926005
045500     MOVE XS071-GP-PRIC-ID   TO DLX-XS-GP-PRIC-ID.                11927005
045500     MOVE XS071-GP-RTL-QTY   TO DLX-XS-GP-RTL-QTY.                11928005
045500     MOVE XS071-GP-RTL-AMT   TO DLX-XS-GP-RTL-AMT.                11929005
045700                                                                  11929105
045500     MOVE XS071-SOR-LAST-UPD-TMST TO DLX-XS-SOR-UPD.              11929205
046800                                                                  11930003
048500***************************************************************** 12220003
048600*7000-READ-SOR-PRCHG-EXTRACT.                                     12230003
048700*  READ SOR PRCHG    EXTRACT FILE                                 12240003
049100***************************************************************** 12250003
049200 7000-READ-SOR-PRCHG-EXTRACT.                                     12260003
049300                                                                  12270003
049400     IF  PS-NOT-END-OF-SOR-PRCHG                                  12280003
049500         READ SOR-PRCHG-EXTRACT-FILE                              12290003
049550            INTO PE105-RECORD                                     12300003
049600              AT END                                              12310003
049700                 SET PS-END-OF-SOR-PRCHG TO TRUE                  12320003
049800         END-READ                                                 12330003
049900     END-IF.                                                      12340003
050000                                                                  12350003
050100     IF  PS-NOT-END-OF-SOR-PRCHG                                  12360003
NEMTST**      DISPLAY '=== SYSTEM OF RECORD READ *'                     12370023
NEMTST**           PE105-RECORD, '**'                                   12380023
052200         ADD +1 TO PV-SOR-PRCHG-RECS-READ-CNT                     12390003
052500     END-IF.                                                      12400003
052600                                                                  12410003
052700***************************************************************** 12420003
052800*7100-READ-XS-PRCHG-EXTRACT.                                      12430003
052900* READ XS EXTRACT FILE                                            12440003
053000***************************************************************** 12450003
053100 7100-READ-XS-PRCHG-EXTRACT.                                      12460003
053200                                                                  12470003
053300     IF  PS-NOT-END-OF-XS-PRCHG                                   12480003
053400         READ XS-PRCHG-EXTRACT-FILE                               12490003
053450           INTO XS071-PRCHG-MDSE-UNLOAD                           12500008
053500             AT END                                               12510003
053600                SET PS-END-OF-XS-PRCHG TO TRUE                    12520003
053700         END-READ                                                 12530003
053800     END-IF.                                                      12540003
053900                                                                  12550003
054000     IF  PS-NOT-END-OF-XS-PRCHG                                   12560003
NEMTST**      DISPLAY '=== XS READ *'                                   12570023
NEMTST**           XS071-PRCHG-MDSE-UNLOAD, '**'                        12580023
054100         ADD +1                   TO PV-XS-EXTRACT-REC-READ-CNT   12590003
054200     END-IF.                                                      12600003
           IF XS071-DEPT-NBR-IS-NULL                                    12600123
               MOVE ZEROES TO XS071-DEPT-NBR.                           12600223
           IF XS071-MAJ-CL-NBR-IS-NULL                                  12600323
               MOVE ZEROES TO XS071-MAJ-CL-NBR.                         12600423
           IF  XS071-SUB-CL-NBR-IS-NULL                                 12600523
               MOVE ZEROES TO XS071-SUB-CL-NBR.                         12600623
           IF XS071-STYL-ID-IS-NULL                                     12600723
               MOVE ZEROES TO XS071-STYL-ID.                            12600834
           IF XS071-SKU-NBR-IS-NULL                                     12600923
               MOVE ZEROES TO XS071-SKU-NBR.                            12601034
           IF  XS071-CLR-TYP-CDE-IS-NULL                                12601126
               MOVE SPACES TO XS071-CLR-TYP-CDE.                        12601226
           IF  XS071-PRICG-GRID-ID-IS-NULL                              12601326
               MOVE ZEROES TO XS071-PRICG-GRID-ID.                      12601426
           IF  XS071-UNT-RTL-IS-NULL                                    12601534
               MOVE ZEROES TO XS071-UNT-RTL-AMT.                        12601634
           IF  XS071-GP-PRIC-ID-IS-NULL                                 12601734
               MOVE ZEROES TO XS071-GP-PRIC-ID.                         12601834
           IF  XS071-GP-RTL-QTY-IS-NULL                                 12601934
               MOVE ZEROES TO XS071-GP-RTL-QTY.                         12602034
           IF  XS071-GP-RTL-AMT-IS-NULL                                 12602134
               MOVE ZEROES TO XS071-GP-RTL-AMT.                         12603034
054300                                                                  12610003
054400******************************************************************12620003
054500* 8700-REPORT-HEADER-ROUTINE.                                     12630003
054600*     PRINT THE HEADINGS FOR THE REPORT.                          12640003
054700******************************************************************12650003
054800 8700-REPORT-HEADER-ROUTINE.                                      12660003
054900                                                                  12670003
055000     MOVE ZEROS                  TO PV-LINE-CNT.                  12680003
055100     ADD +1                      TO PV-PAGE-CNT.                  12690003
055200     MOVE PV-PAGE-CNT            TO DP200-PAGE-NUMBER.            12700003
055300                                                                  12710003
055400     MOVE PC-REPORT-NBR-1        TO DP200-REPORT-NUMBER.          12720003
055500     MOVE DP200-STANDRD-HEADER-200-COLS                           12730003
055600                                 TO PV-PRINT-RECORD.              12740003
055700                                                                  12750003
055800     PERFORM 8800-WRITE-RPT-TOP-OF-PAGE.                          12760003
055900                                                                  12770003
056000     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              12780003
056100     MOVE +2                     TO PV-LINE-SPACING.              12790003
056200     PERFORM 8900-WRITE-REPORT-LINE.                              12800003
056300                                                                  12810003
056400     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              12820003
056500     MOVE +3                     TO PV-LINE-SPACING.              12830003
056600     PERFORM 8900-WRITE-REPORT-LINE.                              12840003
056700                                                                  12850003
056400     MOVE HL4-HEADING-LINE-4     TO PV-PRINT-RECORD.              12860003
056500     MOVE +1                     TO PV-LINE-SPACING.              12870003
056600     PERFORM 8900-WRITE-REPORT-LINE.                              12880003
056700                                                                  12890003
056800******************************************************************12900003
056900* 8800-WRITE-RPT-TOP-OF-PAGE                                      12910003
057000*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   12920003
057100******************************************************************12930003
057200 8800-WRITE-RPT-TOP-OF-PAGE.                                      12940003
057300                                                                  12950003
057400     WRITE XS-PRCHG-INTEG-RPT-RECORD                              12960003
057500       FROM PV-PRINT-RECORD                                       12970003
057600         AFTER ADVANCING PAGE.                                    12980003
057700                                                                  12990003
057800     MOVE +1 TO PV-LINE-CNT.                                      13000003
057900                                                                  13010003
058000******************************************************************13020003
058100* 8900-WRITE-REPORT-LINE                                          13030003
058200*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             13040003
058300******************************************************************13050003
058400 8900-WRITE-REPORT-LINE.                                          13060003
058500                                                                  13070003
058600     WRITE XS-PRCHG-INTEG-RPT-RECORD                              13080003
058700       FROM PV-PRINT-RECORD                                       13090003
058800         AFTER ADVANCING PV-LINE-SPACING.                         13100003
058900                                                                  13110003
059000     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          13120003
059100                                                                  13130003
059200****************************************************************  13140003
059300*END OF PROGRAM ROUTINE                                           13150003
059400****************************************************************  13160003
059500 9000-END-OF-PGM.                                                 13170003
059600                                                                  13180003
060800     DISPLAY '******** XSKRP040 COUNTS *********'.                13190003
060850     DISPLAY ' INTEGRITY CHECK - FOR XST_PRCHG_MDSE '.            13200038
060900     DISPLAY '   SOR REC READ CNT= '                              13210003
060950                     PV-SOR-PRCHG-RECS-READ-CNT.                  13220003
061000     DISPLAY 'XS PRCHG READ COUNT= ' PV-XS-EXTRACT-REC-READ-CNT.  13230003
061300     DISPLAY '  =============================== '                 13240003
           DISPLAY 'UNIQUE TO SOR ONLY  - ', PV-SOR-PRCHG-RECS-UNIQUE   13250003
           DISPLAY 'UNIQUE TO XS  ONLY  - ', PV-XS-EXTRACT-REC-UNIQUE   13260003
           DISPLAY 'COMMON TO BOTH FILES- ',  PV-SOR-XS-COMMON-CNT      13270003
           COMPUTE PV-SOR-XS-TOTAL-CNT =  PV-SOR-XS-COMMON-CNT          13280003
            + PV-SOR-PRCHG-RECS-UNIQUE  + PV-XS-EXTRACT-REC-UNIQUE      13290003
           DISPLAY 'TOTAL COMMON + UNIQUE=', PV-SOR-XS-TOTAL-CNT        13300003
061300     DISPLAY '  =============================== '                 13310003
061100     DISPLAY ' ERROR MSGS WRITTEN= ' PV-ERROR-RECORD-WRITTEN-CNT. 13320003
061200     DISPLAY '  VALID MATCH COUNT= ' PV-VALID-MATCH-CNT.          13330003
061300     DISPLAY '                              '.                    13340003
061700     DISPLAY '**********************************'.                13350003
061800                                                                  13360003
061900     IF  PV-ERROR-RECORD-WRITTEN-CNT > 0                          13370003
062000         MOVE 04               TO RETURN-CODE                     13380003
062100     END-IF.                                                      13390003
062200                                                                  13400003
062300     CLOSE SOR-PRCHG-EXTRACT-FILE                                 13410003
062400           XS-PRCHG-EXTRACT-FILE                                  13420003
062500           XS-PRCHG-INTEG-RPT-FILE.                               13430003
062600                                                                  13440003
062700******************************************************************13450003
062800*     9999-ABEND                                                 *13460003
062900* ==> PROCESSES:                                                 *13470003
063000*     -PERFORMS ABEND PROCESSING FOR NON-SQL-ERRORS.             *13480003
063100******************************************************************13490003
063200 9999-ABEND.                                                      13500003
063300                                                                  13510003
063400     DISPLAY '9999-ABEND'.                                        13520003
063500     DISPLAY '**  ABEND     **', PC-CURRENT-PROGRAM-NAME.         13530003
063600     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               13540003
063700     DISPLAY '**  OPERATION ** ' PV-OPERATION-MSG-1.              13550003
063800     DISPLAY '**            ** ' PV-OPERATION-MSG-2.              13560003
063900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         13570003
