      ******************************************************************00010001
       IDENTIFICATION DIVISION.                                         00020001
       PROGRAM-ID.                FSKCS032.                             00030001
       AUTHOR.                    DORIE CALLIES.                        00040001
       INSTALLATION.              KOHLS DEPARTMENT STORES.              00050001
       DATE-WRITTEN.              11-15-90.                             00060001
       DATE-COMPILED.                                                   00070001
                                                                        00080001
      ******************************************************************00090001
      *  CICS PROGRAM - FSKCS032 - F032                                *00100001
      *                                                                *00110001
      *       FASHION SALES - MONTHLY SALES INQUIRY DISPLAY            *00120001
      *                                                                *00130001
      *       THIS PROGRAM ACCEPTS MONTHLY SALES SELECTION PARAMETERS  *00140001
      *  PASSED TO IT FROM EITHER FSKCS034 OR LIST PROGRAM FSKCS055.   *00150001
      *                                                                *00160001
      *       IF ANY SYSTEM ERRORS ARE DETECTED, THAT THE PROGRAM CAN  *00170001
      *  NOT RESOLVE, THE PROGRAM WILL BE TERMINATED, AN ERROR         *00180001
      *  MESSAGE WILL BE DISPLAYED ON THE SCREEN, AND PROGRAM CONTROL  *00190001
      *  WILL BE RETURNED TO NATIVE CICS.                              *00200001
      *                                                                *00210001
      *       DIRECT ENTRY INTO THIS TRANSACTION IS PROHIBITED.        *00220001
      *                                                                *00230001
      ******************************************************************00240001
      *                                                                *00250001
      *  CHANGED 12/92 BY ZAR MATIC. COMBINED HEADER LINES 1 AND 2      00260001
      *  ON LINE 1. INSERTED LINE 9 ON SCREEN.  LINE 9 CONTAINS WEEKLY *00270001
      *  SALES FOR THE PREVIOUS WEEK. COMMAREA LENGTH WAS INCREASED.   *00280001
      *                                                                *00290001
      *  CHANGED 05/93 BY MARC BLAZICH - RE-VAMPED TO HANDLE INPUT FROM*00300001
      *  F034 OR F055.  NOW RUNS W/IN THE API ARCHITECTURE.   NO LONGER*00310001
      *  STARTS F033 TO DO "NEXT" DB2 I/O.  FKCS033'S LOGIC IS NOW     *00320001
      *  FOUND AT THE BOTTOM OF THIS MODULE.                           *00330001
      *                                                                *00340001
      *  ADD DIAGNOSTIC GATHERING LOGIC TO WRITE CRITERIA OF EACH      *00350001
      *  INVOCATION OUT TO THE FSMRCLOG VSAM FILE.                     *00360001
      *                                                                *00370001
      *  REMOVED FSMRCLOG AUDITING - 12/16/94 C. LEADLEY               *00380001
      **                                                               *00390001
      *  CHANGED 02/95 BY M. DEERING - LOGIC WAS ADDED TO TRAP ANY     *00400001
      *  QIDERR (TEMP STORAGE QUEUE DOES NOT EXIST) CONDITIONS IN THE  *00410001
      *  9000-READ-TS-QUEUE PARAGRAPH.                                 *00420001
      *                                                                *00430001
      * 06/19/95 -- M. DEERING :  THE CA-VENDOR-STYLE, CA-SIZE, AND    *00440093
      *                           CA-COLOR FIELDS WERE EXPANDED TO     *00450001
      *                           20 CHARACTER POSITIONS.              *00460001
      *                                                                *00470001
      * 05/23/96 -- A. RAISLER :  ADDED KEY ITEM IND                   *00480001
      *                                                                *00490001
      * 05/24/96 -- A. RAISLER :  ADDED COLOR AND SIZE                 *00500001
      *                                                                *00510001
      * 09/18/97 -- T. MEDREK  :  ADDED GIFT-WITH-PURCHASE LOGIC FOR   *00520001
      *                           MULTIPLE SKUS TO EXCLUDE THEM FROM   *00530001
      *                           ALL TOTALS WHILE CONTINUING TO LIST  *00540001
      *                           THEIR DETAIL.                        *00550001
      *                                                                *00560001
      * 10/10/97 -- T. MEDREK  :  FIXED SKU FIELDS ON FSIUNTSL UNIT    *00570001
      *                           SALES INQUIRY SCREEN.  THEY WERE     *00580001
      *                           DISPLAYING DATA FROM THE FIRST SKU   *00590001
      *                           SELECTED AFTER RETURNING TO FSLSKSL1 *00600001
      *                           AND SELECTING ANOTHER SKU.           *00610001
      *                                                                *00620001
      * 03/04/98 -- P. KEBER   :  UPDATED THE MAP-AREA-FSKM032 FILLER  *00630001
      *                           TO ALLOW FOR AN INCREASE IN THE SIZE *00640001
      *                           OF THE ENROUTE FIELD FROM 7 TO 9     *00650001
      *                           DIGITS.  ALSO FIXED A BUG WHICH WAS  *00660001
      *                           MOVING A DATA FIELD TO MAP ATTRIBUTE *00670001
      *                           BYTES.  (WR# 5847)                   *00680001
      * 06/12/98 -- B. DORST   :  INCREASED LENGTH OF ONHAND AND ONORDR*00690001
      *                           FROM PIC 9(9) TO PIC 9(11).  CHANGED *00700001
      *                           'ONHAND' TO 'BOH' FOR DISPLAY OF     *00710001
      *                           WEEKLY UNITS.  ALSO CHANGED TO DISPLAY00720001
      *                           BOH FOR CURRENT WTD FROM TSKSTWKI.   *00730001
      *                           CHANGED 'ONORD:' TO 'OO:'. UPDATED   *00740001
      *                           PROGRAM TO ACCOMODATE REPLACING      *00750001
      *                           INVEN_INDCT WITH FSCL_BOW_DTE ON THE *00760001
      *                           WEEKLY INVENTORY TABLE. (WR# 6041)   *00770001
      *                                                                *00780001
      * 07/29/98 -- P. KEBER   :  UPDATED PROGRAM TO CONVERT THE SKU   *00790001
      *                           STORE WEEKLY SALES TABLE FROM THE    *00800001
      *                           OLD NAME (TSKSTWKSL) TO THE NEW NAME *00810001
      *                           (TSKSTWKS).  REPLACED SALES_INDCT    *00820001
      *                           FIELD WITH NEW DATE FIELD            *00830001
      *                           FSCL_BOW_DTE.  USED KY_ITM_IND FROM  *00840001
      *                           TUPC INSTEAD OF TSK IN THE           *00850001
      *                           MULT-SKUS-CSR-2 CURSOR.  (WR# 6041)  *00860001
      **                                                               *00870001
      * 04/14/99  ROLLIN KRING - REMOVED REFERENCE TO DPG51-SYSTEM-DATE*00880001
      *       WHICH IS NO LONGER SUPPORTED BY THE CALENDAR ROUTINE.    *00890001
      *       REMOVED WORKING STORAGE FIELD PC-DPKUT500-CALENDAR TO    *00900001
      *       STANDARDIZE FIELD IN CALENDAR ROUTINE COPYBOOK.          *00910001
      *                                           (WR# 10647)          *00920001
      * 09/07/99 -- M. KLAMIK  :  UPDATED MAP AND PROGRAM TO INCREASE  *00930001
      *                           FIELD SIZE OF ORDRPT AND OUTLMT TO   *00940001
      *                           7 CHARACTERS.                        *00950001
      *                                                    (WR# 9999)  *00960001
      * 11/10/99 -- M. KLAMIK  :  ADDED CODE FOR REGIONAL CLEARANCE    *00970001
      *                           PRICING.  ADDED SUMMARY TABLE-TDISTSM*00980001
      *                           AND TUPCPLS.  ADDED PF22-RC PRICE KEY*00990001
      *                           TO TRANSFER CONTROL TO FSLRCPP (LIST *01000001
      *                           OF STORES REGIONAL CLEARANCE PRICES).*01010001
      *                           REMOVED ALL REFERENCES TO METRO AREA.*01020001
      *                           PARAMETER NO LONGER IN USE.          *01030001
      *                                                   (WR# 10760)  *01040001
      * 04/26/2000  M. KLAMIK  :  TMRITST SUM - CHANGED DB2 CALL TO    *01050001
      *                           NOT INCLUDE THE BETWEENS.  SPLIT     *01060001
      *                           CALL INTO THREE SEPARATE CALLS -     *01070001
      *                           EITHER ALL STORES, ONE STORE OR      *01080001
      *                           ONE DISTRICT.                        *01090001
      *                                                 (WR# 21087)    *01100001
      * 05/02/2000  M. KLAMIK  :  CONVERT VSAM ON-ORDER CALL TO DB2    *01110001
      *                           ON-ORDER CALL (TABLE TSKSTOO).       *01120001
      *                                                 (WR# 21062)    *01130001
      * 06/25/2001  M. BANSEMAR:  ADDED LOGIC TO PROCESS INTRANSIT     *01140001
      *                           QUANTITY.                            *01150001
      *                            9585-SELECT-SKU-STORE               *01160001
      *                            9586-SELECT-INTRANSIT-QTY           *01170001
      *                            9587-SUM-INTRANSIT-QTY              *01180001
      *                                                 (WR# 21546)    *01190001
      * 11/01/2001  M. COLEMAN:   ADDED LOGIC TO PROCESS INTRANSIT     *01200001
      *                           QUANTITIES WHICH ARE NULL INSTEAD    *01210001
      *                           OF ZERO.                             *01220001
      *    (MK)     M. KLAMIK     FIXED LOGIC FOR RCP - SPECIFIC SKU - *01230001
      *                           SPECIFIC STORE CURRENT AND PREV WK   *01240001
      *                           DATA.  CHANGE MADE TO PARA 9195-.    *01250001
      * 02/12/2002  L. MOYER      ADD EFFECTIVE DATE CHECK ON THE      *01260002
      *                           SKU STORE SELECT.                    *01270002
      * 08/22/2002  M. KLAMIK:    CHANGES MADE FOR NON-INTELLIGENT     *01280004
      *                           SKU.  ADDED DPT & SC FIELDS AND      *01290004
      *                           INCREASED SIZE OF SKU TO 8 DIGITS.   *01300004
      *                           CHANGED THE STORE NAME FROM 20       *01310004
      *                           CHAR DISPLAY TO 10 CHAR DISPLAY.     *01320004
      *                           NOW USING CHAR10_ABBR_NAME STORE     *01330004
      *                           NAME.                                *01340004
      *                                                 (WR# 21568)    *01350004
      * 09/11/2003  M. KLAMIK:    CHANGES MADE FOR RCP DUE TO BUSINESS *01360053
      *                           RULE CHANGE.  PARA 9185-RCP-SKU...   *01370053
      *                           CHANGED WHEN ROW NOT FOUND ON TUPCPLS*01380053
      *                           - CHECK STATUS, IF CLEARANCE MOVE    *01390053
      *                           TSK RETAIL.                          *01400053
      *                                                 (WR# 25651)    *01410053
      *                                                                *01420058
W27494* 09/17/2004  M JOHNSON     FALL 2004 PERFORMANCE TUNING.        *01430066
W27494*                           CHANGED SQL FOR TMRITST SELECTS TO   *01440066
W27494*                           USE LOCATION ID FROM CHARACTER TO    *01450066
W27494*                           INTEGER.                             *01460066
W27494*                           WR27494                              *01470066
      *                                                                *01480058
      * 09/17/2004  A KINTOPF     STORE NUMBER EXPANSION CHANGES.      *01490099
      *                           CHANGED TO USE THE NEW NUMERIC       *01500099
      *                           STORE NUMBER FIELDS ON TSKSTWKS,     *01510099
      *                           TSKSTWKI AND TSTST.                  *01520099
      *                           CHANGED PROGRAM TO USE XMT_LOC       *01530099
      *                           INSTEAD OF TSTR000.                  *01540099
      *                           WR26354                              *01550099
KP1105*                                                                *01560099
KP1105* 11/09/2005  K PETERSON    MAP-AREA-FSKM032 FILLER LENGTH WAS   *01570099
KP1105*                           1 BYTE TOO SHORT. THIS WAS TRUNCATING*01580099
KP1105*                           THE FIRST DIGIT FOR TWO-DIGIT MONTHS *01590099
KP1105*                           CAUSING THE DATES TO FLASH.  ALSO    *01600099
KP1105*                           NEEDED TO CHANGE THE OVERRIDE OF THE *01610099
KP1105*                           'STORE:' LABEL TO MOVE 'STR:' INSTEAD*01620099
KP1105*                           WHICH MATCHES THE NEW MAP.           *01630099
KP1105*                                                 (WR# 29571)    *01640099
W30677* 08/27/2006  JILL LIN      CHANGE THE SKU FIELD TO BE UPDATE-   *01650099
W30677*                           ABLE FIELD, AND EXTEND THE LENGTH OF *01660099
W30677*                           THE FIELD TO ACCOMODATE UPC INQUERY. *01670099
W30677*                           WHEN USER ENTER MORE THAN EIGHT      *01680099
W30677*                           DIGITS, IT WILL BE PROCESSED AS UPC  *01690099
W30677*                           CODE, AND REFRESH SCREEN WITH        *01700099
W30677*                           APPROPRIATE INFOMATION.              *01710099
W30677*                                                 (WR# 30677)    *01720099
W30677* 09/25/2006  JILL LIN      FIX THE CURSOR NOT IN CORRECT PLACE  *01730099
W30677*                           WHEN SKU IS NOT SPECIFIED            *01740099
W30677*                                                 (P000929885)   *01750099
SR3403* 05/01/2012  J SELWITSCHKA LARGE RETAIL EXPANSION.              *01760099
SR3403*                           CRQ000000023799                      *01770099
W43143*                                                                 01780099
W43143* 12/21/2015  NEHA BAGRODIA ADD THE F24 KEY TO GO FROM THE FASHION01790099
W43143*                           SALES UNIT SALES INQ SCREEN TO THE    01800099
W43143*                           PROGRAM PCKCS747-  IN-TRANSIT - SKU   01810099
W43143*                           STORE DETAIL LIST SCREEN              01820099
0518  * 05/18/2018  J ARENDT      FOR MAINFRAME REFACTOR,  BROKE THE   *01830099
0518  *                           VENDOR STYLE CODE INTO TWO FIELDS    *01840099
0518  *                           ONE SHORT X(15) AND ONE LONG X(20).  *01850099
0518  *                           CHG0201762                           *01860099
272945* 08/05/2022  JIM HUNTER    CHANGE CALL OF DPKUT100 TO           *01861099
272945*                           CALL DP010I-NUMERIC-EDIT-ROUTINE     *01862099
272945*                           MAKING THE CALL DYNAMIC VS STATIC.   *01863099
272945*                           CHG0272945                           *01864099
1022RM* 10/24/2022  BOB MCASEY    ADD COPYBOOK DPWS930 AND CHANGED     *01865099
1022RM*                           CICS ARCHITECTURE CALL TO A DYNAMIC  *01866099
1022RM*                           CALL.                                *01867099
1022RM*                           CHG0                                 *01868099
      ******************************************************************01870099
       ENVIRONMENT DIVISION.                                            01880001
      ******************************************************************01890001
       DATA DIVISION.                                                   01900001
      ******************************************************************01910001
       WORKING-STORAGE SECTION.                                         01920001
       01  PC-MISC-CONSTANTS.                                           01930001
           05  PC-KOHLS-OPERATING-COMPANY PIC X(02) VALUE '03'.         01940001
           05  PC-ABSTIME              PIC S9(18)   VALUE ZERO          01950001
                                       COMP SYNC.                       01960001
           05  PC-SYSTEM-DATE          PIC  X(06).                      01970001
           05  PC-ALL-SIZES            PIC  X(10) VALUE  'ALL SIZES '.  01980001
           05  PC-ALL-COLS             PIC  X(10) VALUE  'ALL COLORS'.  01990001
       01  PC-TSYMSG-AREA.                                              02000001
           05  PC-TSYMSG-00045        PIC 9(5) VALUE 00045.             02010099
W30677     05  PC-TSYMSG-00100        PIC 9(5) VALUE 00100.             02020099
           05  PC-TSYMSG-00113        PIC 9(5) VALUE 00113.             02030001
W30677     05  PC-TSYMSG-00342        PIC 9(5) VALUE 00342.             02040099
           05  PC-TSYMSG-00386        PIC 9(5) VALUE 00386.             02050099
           05  PC-TSYMSG-00404        PIC 9(5) VALUE 00404.             02060001
           05  PC-TSYMSG-00405        PIC 9(5) VALUE 00405.             02070001
           05  PC-TSYMSG-00406        PIC 9(5) VALUE 00406.             02080001
           05  PC-TSYMSG-00407        PIC 9(5) VALUE 00407.             02090001
           05  PC-TSYMSG-00408        PIC 9(5) VALUE 00408.             02100001
W30677     05  PC-TSYMSG-00413        PIC 9(5) VALUE 00413.             02110099
W43143     05  PC-TSYMSG-00507        PIC 9(5) VALUE 00507.             02120099
           05  PC-TSYMSG-01056        PIC 9(5) VALUE 01056.             02130001
           05  PC-TSYMSG-01300        PIC 9(5) VALUE 01300.             02140001
           05  PC-TSYMSG-02060        PIC 9(5) VALUE 02060.             02150001
                                                                        02160001
      ******************************************************************02170099
      *  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02180001
      ******************************************************************02190001
           COPY DPWS013.                                                02200001
                                                                        02210019
      ******************************************************************02220019
      *    FUNCTION KEYS COPYBOOK                                      *02230001
      ******************************************************************02240019
           COPY DPWS016.                                                02250001
                                                                        02260001
           COPY DPWS030.                                                02270001
1022RM     COPY DPWS930.                                                02271099
                                                                        02280001
           COPY FSWS002.                                                02290052
                                                                        02300001
      * NOTE: IF ANY CHANGES ARE MADE TO THIS COMMAREA, ALSO CHECK THE  02310001
      * COMMAREA LAYOUT IN PROGRAMS FSKCS034 AND FSKCS055               02320001
                                                                        02330001
           COPY DPWS020.                                                02340001
           COPY FSWS000.                                                02350052
           COPY FSWS006.                                                02360001
                                                                        02370001
           10  CA-THIS-SKUS-MISC-DATA.                                  02380001
               15  CA-STATUS           PIC 9(2).                        02390001
               15  CA-STATUS-X REDEFINES CA-STATUS                      02400001
                                       PIC X(2).                        02410001
           10  CA-FSKCS032-DATA.                                        02420001
                                                                        02430001
               15  CA-ON-ORDER-UNITS   PIC S9(11)   COMP-3.             02440001
               15  CA-ON-ORDER-DLRS    PIC S9(11)V99 COMP-3.            02450001
               15  CA-STORE-OH-UNITS   PIC S9(9)    COMP-3.             02460088
               15  CA-STORE-OH-DLRS    PIC S9(9)V99 COMP-3.             02470088
               15  CA-IN-TRNST-UNITS   PIC S9(9)    COMP-3.             02480001
               15  CA-IN-TRNST-DLRS    PIC S9(9)V99 COMP-3.             02490001
               15  CA-SUN-UNITS        PIC S9(7)    COMP-3.             02500001
               15  CA-MON-UNITS        PIC S9(7)    COMP-3.             02510001
               15  CA-TUE-UNITS        PIC S9(7)    COMP-3.             02520001
               15  CA-WED-UNITS        PIC S9(7)    COMP-3.             02530001
               15  CA-THU-UNITS        PIC S9(7)    COMP-3.             02540001
               15  CA-FRI-UNITS        PIC S9(7)    COMP-3.             02550001
               15  CA-SAT-UNITS        PIC S9(7)    COMP-3.             02560001
               15  CA-SUN-DLRS         PIC S9(9)V99 COMP-3.             02570001
               15  CA-MON-DLRS         PIC S9(9)V99 COMP-3.             02580001
               15  CA-TUE-DLRS         PIC S9(9)V99 COMP-3.             02590001
               15  CA-WED-DLRS         PIC S9(9)V99 COMP-3.             02600001
               15  CA-THU-DLRS         PIC S9(9)V99 COMP-3.             02610001
               15  CA-FRI-DLRS         PIC S9(9)V99 COMP-3.             02620001
               15  CA-SAT-DLRS         PIC S9(9)V99 COMP-3.             02630001
               15  CA-MODEL-STOCK      PIC S9(7)    COMP-3.             02640001
               15  CA-CURR-ONHAND-UNITS                                 02650001
                                       PIC S9(11)   COMP-3.             02660001
               15  CA-CURR-ONHAND-DLRS                                  02670001
                                       PIC S9(11)V99 COMP-3.            02680001
               15  CA-SUN-UNITS-PREV   PIC S9(7)    COMP-3.             02690001
               15  CA-MON-UNITS-PREV   PIC S9(7)    COMP-3.             02700001
               15  CA-TUE-UNITS-PREV   PIC S9(7)    COMP-3.             02710001
               15  CA-WED-UNITS-PREV   PIC S9(7)    COMP-3.             02720001
               15  CA-THU-UNITS-PREV   PIC S9(7)    COMP-3.             02730001
               15  CA-FRI-UNITS-PREV   PIC S9(7)    COMP-3.             02740001
               15  CA-SAT-UNITS-PREV   PIC S9(7)    COMP-3.             02750001
               15  CA-SUN-DLRS-PREV    PIC S9(9)V99 COMP-3.             02760001
               15  CA-MON-DLRS-PREV    PIC S9(9)V99 COMP-3.             02770001
               15  CA-TUE-DLRS-PREV    PIC S9(9)V99 COMP-3.             02780001
               15  CA-WED-DLRS-PREV    PIC S9(9)V99 COMP-3.             02790001
               15  CA-THU-DLRS-PREV    PIC S9(9)V99 COMP-3.             02800001
               15  CA-FRI-DLRS-PREV    PIC S9(9)V99 COMP-3.             02810001
               15  CA-SAT-DLRS-PREV    PIC S9(9)V99 COMP-3.             02820001
               15  CA-WEEKLY-ACCUMULATION  OCCURS 4 TIMES               02830001
                                           INDEXED BY CA-WKLY-INDEX.    02840001
                   20  CA-WKLY-CAL-DATE                                 02850001
                                       PIC X(8).                        02860001
                   20  CA-WKLY-REG-UNITS                                02870001
                                       PIC S9(9)     COMP-3.            02880001
                   20  CA-WKLY-REG-DLRS                                 02890001
                                       PIC S9(9)V99  COMP-3.            02900001
                   20  CA-WKLY-PRO-UNITS                                02910001
                                       PIC S9(9)     COMP-3.            02920001
                   20  CA-WKLY-PRO-DLRS                                 02930001
                                       PIC S9(9)V99  COMP-3.            02940001
                   20  CA-WKLY-CLR-UNITS                                02950001
                                       PIC S9(9)     COMP-3.            02960001
                   20  CA-WKLY-CLR-DLRS                                 02970001
                                       PIC S9(9)V99  COMP-3.            02980001
                   20  CA-WKLY-ONHAND-UNITS                             02990001
                                       PIC S9(9)     COMP-3.            03000001
                   20  CA-WKLY-ONHAND-DLRS                              03010001
                                       PIC S9(9)V99  COMP-3.            03020001
                                                                        03030001
               15  CA-SCREEN-CONTROL-DATA.                              03040001
                   20  CA-DISPLAY-TYPE     PIC X.                       03050001
                       88  CA-DISPLAY-DOLLARS       VALUES 'D'.         03060001
                       88  CA-DISPLAY-UNITS         VALUES 'U'.         03070001
                                                                        03080001
           10  CA-FSKCS033-DATA.                                        03090001
               15  CA-NEXT-FUNCTION    PIC X(1).                        03100001
                   88  CA-NEXT-STORE                 VALUE 'S'.         03110001
                   88  CA-NEXT-SKU                   VALUE 'K'.         03120001
                   88  CA-NEXT-DEPT                  VALUE 'D'.         03130001
                   88  CA-NEXT-CLASS                 VALUE 'C'.         03140001
      *                                                                 03150001
           10  CA-FS002-AREA           PIC X(800).                      03160001
           10  CA-INTER-APPL-COPY      PIC X(200).                      03170001
W43143                                                                  03180099
W43143     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03190099
W43143         10  INTER-APPL-COMM-AREA   PIC X(200).                   03200099
W43143                                                                  03210099
W43143         10  FS009-FS-INTER-APPL-COMMAREA REDEFINES               03220099
W43143                  INTER-APPL-COMM-AREA.                           03230099
W43143     COPY FSWS009.                                                03240099
W43143                                                                  03250099
      ******************************************************************03260001
      *  DSECT CREATED BY MAP FSKM032                                   03270001
      ******************************************************************03280001
           COPY FSKM032.                                                03290001
                                                                        03300001
       01  MAP-AREA-FSKM032  REDEFINES  FS032AI.                        03310001
W30677     05  FILLER                  PIC X(886).                      03320099
           05  MA-WEEKLY-DATA  OCCURS  4 TIMES                          03330001
                               INDEXED BY MA-WKLY-INDEX.                03340001
               10  FILLER              PIC X(3).                        03350001
               10  MA-WKLY-DATE-C      PIC X.                           03360001
               10  MA-WKLY-DATE-H      PIC X.                           03370001
               10  MA-WKLY-DATE        PIC X(8).                        03380001
               10  FILLER              PIC X(3).                        03390001
               10  MA-WKLY-TOTAL-C     PIC X.                           03400001
               10  MA-WKLY-TOTAL-H     PIC X.                           03410001
               10  MA-WKLY-TOTAL       PIC ZZZ,ZZZ,ZZ9-.                03420001
               10  MA-WKLY-TOTAL-X REDEFINES MA-WKLY-TOTAL              03430001
                                       PIC X(12).                       03440001
               10  FILLER              PIC X(3).                        03450001
               10  MA-WKLY-REGULAR-C   PIC X.                           03460001
               10  MA-WKLY-REGULAR-H   PIC X.                           03470001
               10  MA-WKLY-REGULAR     PIC ZZZ,ZZZ,ZZ9-.                03480001
               10  MA-WKLY-REGULAR-X REDEFINES MA-WKLY-REGULAR          03490001
                                       PIC X(12).                       03500001
               10  FILLER              PIC X(3).                        03510001
               10  MA-WKLY-PROMO-C     PIC X.                           03520001
               10  MA-WKLY-PROMO-H     PIC X.                           03530001
               10  MA-WKLY-PROMO       PIC ZZZ,ZZZ,ZZ9-.                03540001
               10  MA-WKLY-PROMO-X REDEFINES MA-WKLY-PROMO              03550001
                                       PIC X(12).                       03560001
               10  FILLER              PIC X(3).                        03570001
               10  MA-WKLY-CLEAR-C     PIC X.                           03580001
               10  MA-WKLY-CLEAR-H     PIC X.                           03590001
               10  MA-WKLY-CLEAR       PIC ZZZ,ZZZ,ZZ9-.                03600001
               10  MA-WKLY-CLEAR-X REDEFINES MA-WKLY-CLEAR              03610001
                                       PIC X(12).                       03620001
               10  FILLER              PIC X(3).                        03630001
               10  MA-WKLY-ONHAND-C    PIC X.                           03640001
               10  MA-WKLY-ONHAND-H    PIC X.                           03650001
               10  MA-WKLY-ONHAND      PIC ZZZ,ZZZ,ZZ9-.                03660001
               10  MA-WKLY-ONHAND-X REDEFINES MA-WKLY-ONHAND            03670001
                                       PIC X(12).                       03680001
                                                                        03690001
       01  PC-PROGRAM-CONSTANTS.                                        03700001
           05  PC-INQ                  PIC X(3)     VALUE 'INQ'.        03710001
           05  PC-LOW-MINOR-CLASS.                                      03720001
               10  PC-LOW-MINOR-POS1   PIC X(1)     VALUE '1'.          03730001
               10  PC-LOW-MINOR-POS2   PIC X(1)     VALUE LOW-VALUES.   03740001
           05  PC-MAX-CLASS            PIC 9(2)     VALUE 99.           03750001
MK         05  PC-MIN-CLASS            PIC 9(2)     VALUE 00.           03760008
           05  PC-MAX-DEPT             PIC 9(3)     VALUE 999.          03770001
MK         05  PC-MAX-SKU              PIC 9(8)     VALUE 99999999.     03780012
           05  PC-ONE                  PIC S9(4)    VALUE +1 COMP.      03790001
MK         05  PC-STATUS-98            PIC X(02)    VALUE '98'.         03800012
MK         05  PC-STATUS-00            PIC X(02)    VALUE '00'.         03810012
           05  PC-CORPORATE-LITERAL    PIC X(10)    VALUE 'ALL STORES'. 03820001
           05  PC-MAXIMUM-RETRY-COUNT  PIC S9(4)    VALUE +2            03830001
                                       COMP SYNC.                       03840001
           05  PC-BEGIN-SECOND-PAGE    PIC 9        VALUE 4.            03850001
           05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'FSKCS032'.   03860001
           05  PC-CURRENT-MAPSET-NAME  PIC X(08)    VALUE 'FSKM032'.    03870001
           05  PC-CURRENT-MAP-NAME     PIC X(08)    VALUE 'FS032A'.     03880001
           05  PC-DPKCS030             PIC X(08)    VALUE 'DPKCS030'.   03890001
           05  PC-DOLLAR-SALES-HEADER  PIC X(20)    VALUE               03900001
               'DOLLAR SALES INQUIRY'.                                  03910001
           05  PC-DOLLAR-MTHLY-HEADER  PIC X(8)     VALUE               03920001
               'DOLLARS:'.                                              03930001
           05  PC-DOLLAR-WKLY-HEADER   PIC X(13)    VALUE               03940001
               'WKLY DOLLARS:'.                                         03950001
           05  PC-CURRENT-WEEK         PIC 9(1)     VALUE 1.            03960001
           05  PC-PREVIOUS-WEEK        PIC 9(1)     VALUE 2.            03970001
           05  PC-HIGH-VALUES          PIC X(15)    VALUE HIGH-VALUES.  03980001
           05  PC-LITERAL-0            PIC X(1)     VALUE '0'.          03990001
           05  PC-LITERAL-9            PIC X(1)     VALUE '9'.          04000001
           05  PC-LOW-VALUES           PIC X(15)    VALUE LOW-VALUES.   04010001
           05  PC-MAP-BREAKLINE-DLRS.                                   04020001
               10  FILLER              PIC X(30)    VALUE               04030001
               '------------------------------'.                        04040001
               10  FILLER              PIC X(31)    VALUE               04050001
               '---------------AVG. RETAIL-----'.                       04060001
           05  PC-MAP-BREAKLINE-UNITS.                                  04070001
               10  FILLER              PIC X(30)    VALUE               04080001
               '------------------------------'.                        04090001
               10  FILLER              PIC X(31)    VALUE               04100001
               '-------------------------------'.                       04110001
           05  PC-MAX-NUM-WEEKS        PIC 9        VALUE 4.            04120001
           05  PC-MAX-STORES-IN-ON-ORDER-REC                            04130001
                                       PIC 9(5)     VALUE 99999.        04140073
           05  PC-MAX-RETRIES          PIC S9(03)   VALUE 3             04150001
                                                    COMP-3.             04160001
           05  PC-EN-ROUTE-FILE        PIC X(8)     VALUE 'FSENRTE'.    04170001
           05  PC-OPERATING-COMPANY    PIC X(2)     VALUE '03'.         04180001
           05  PC-SLASH                PIC X        VALUE '/'.          04190001
MK         05  PC-STATUS-10            PIC X(2)     VALUE '10'.         04200012
MK         05  PC-STATUS-20            PIC X(2)     VALUE '20'.         04210012
MK         05  PC-STATUS-30            PIC X(2)     VALUE '30'.         04220012
MK         05  PC-STATUS-40            PIC X(2)     VALUE '40'.         04230012
MK         05  PC-STATUS-90            PIC X(2)     VALUE '90'.         04240012
MK         05  PC-STATUS-25            PIC X(2)     VALUE '25'.         04250012
           05  PC-STORE-ZERO           PIC 9(5)     VALUE ZERO.         04260073
           05  PC-STORE-ZERO-X         PIC X(5)     VALUE '00000'.      04270073
           05  PC-TOTAL-LITERAL        PIC X(5)     VALUE 'TOTAL'.      04280001
           05  PC-UNIT-SALES-HEADER    PIC X(20)    VALUE               04290001
               ' UNIT SALES INQUIRY '.                                  04300001
           05  PC-UNIT-MTHLY-HEADER    PIC X(8)     VALUE               04310001
               'UNITS:  '.                                              04320001
           05  PC-UNIT-WKLY-HEADER     PIC X(13)    VALUE               04330001
               'WEEKLY UNITS:'.                                         04340001
           05  PC-VENDOR-HIGH          PIC 9(3)     VALUE 999.          04350001
           05  PC-VENDOR-LOW           PIC 9(3)     VALUE ZERO.         04360001
           05  PC-WTD-LITERAL          PIC X(5)     VALUE '  WTD'.      04370001
           05  PC-YEAR-99              PIC 9(2)     VALUE 99.           04380001
MC1101     05  PC-NULL                 PIC S9(3)    VALUE -1.           04390001
                                                                        04400001
      ******************************************************************04410001
      * INDICATOR VARIABLES - FOR THE SELECTION OF NULL VALUES          04420001
      ******************************************************************04430001
       01  IND-VARIABLES.                                               04440001
           05  IND-INTRAN                  PIC S9(04) COMP.             04450001
                                                                        04460001
       01  PE-PGM-ERROR-MESSAGES.                                       04470001
           05  PE-ERR-MSG-1            PIC X(35)    VALUE               04480001
             'OPEN ON STORE CURSOR (XMT_LOC)     '.                     04490073
           05  PE-ERR-MSG-2            PIC X(35)    VALUE               04500001
             'CLOSE ON STORE CURSOR (XMT_LOC)    '.                     04510073
           05  PE-ERR-MSG-3            PIC X(35)    VALUE               04520001
             'FETCH ON STORE CURSOR (XMT_LOC)    '.                     04530073
           05  PE-ERR-MSG-4            PIC X(35)    VALUE               04540001
             'OPEN ON SKU CURSOR (TSK)           '.                     04550001
           05  PE-ERR-MSG-5            PIC X(35)    VALUE               04560001
             'FETCH ON SKU CURSOR (TSK)          '.                     04570001
           05  PE-ERR-MSG-6            PIC X(35)    VALUE               04580001
             'CLOSE ON SKU CURSOR (TSK)          '.                     04590001
           05  PE-ERR-MSG-7            PIC X(35)    VALUE               04600001
             'OPEN ON DEPT CURSOR (TSKXREF)      '.                     04610019
           05  PE-ERR-MSG-8            PIC X(35)    VALUE               04620001
             'FETCH ON DEPT CURSOR (TSKXREF)     '.                     04630019
           05  PE-ERR-MSG-9            PIC X(35)    VALUE               04640001
             'CLOSE ON DEPT CURSOR (TSKXREF)     '.                     04650019
           05  PE-ERR-MSG-10           PIC X(35)    VALUE               04660001
             'OPEN ON CLASS CURSOR (TSKXREF)     '.                     04670019
           05  PE-ERR-MSG-11           PIC X(35)    VALUE               04680001
             'FETCH ON CLASS CURSOR (TSKXREF)    '.                     04690019
           05  PE-ERR-MSG-12           PIC X(35)    VALUE               04700001
             'CLOSE ON CLASS CURSOR (TSKXREF)    '.                     04710019
           05  PE-ERR-MSG-13           PIC X(35)    VALUE               04720001
             'OPEN ON COMPLEX SKU CURSOR (TSK)   '.                     04730001
           05  PE-ERR-MSG-14           PIC X(35)    VALUE               04740001
             'FETCH ON COMPLEX SKU CURSOR (TSK)  '.                     04750001
           05  PE-ERR-MSG-15           PIC X(35)    VALUE               04760001
             'CLOSE ON COMPLEX SKU CURSOR (TSK)  '.                     04770001
                                                                        04780001
       01  PS-PROGRAM-SWITCHES.                                         04790001
           05  PS-CLASS-FOUND-IND      PIC X(1)     VALUE 'N'.          04800001
               88  PS-CLASS-FOUND                   VALUE 'Y'.          04810001
               88  PS-NO-CLASS-FOUND                VALUE 'N'.          04820001
           05  PS-DEPT-FOUND-IND       PIC X(1)     VALUE 'N'.          04830001
               88  PS-DEPT-FOUND                    VALUE 'Y'.          04840001
               88  PS-NO-DEPT-FOUND                 VALUE 'N'.          04850001
           05  PS-DB-ERROR-SW          PIC X(1)     VALUE 'N'.          04860001
               88  DB-ERROR                         VALUE 'Y'.          04870001
               88  DB-ERROR-NO                      VALUE 'N'.          04880001
           05  PS-SIZE-DESC-FOUND-SW   PIC X(01)    VALUE 'N'.          04890001
               88  PS-SIZE-DESC-FOUND               VALUE 'Y'.          04900001
               88  PS-SIZE-DESC-NOT-FOUND           VALUE 'N'.          04910001
           05  PS-GIFT-W-PURCHASE-SW   PIC X(01)    VALUE 'N'.          04920001
               88  PS-GIFT-W-PURCHASE               VALUE 'Y'.          04930001
               88  PS-NOT-GIFT-W-PURCHASE           VALUE 'N'.          04940001
MK         05  PS-TUPCPLS-SW           PIC X(01)    VALUE 'N'.          04950054
MK             88  PS-TUPCPLS-ROW-FOUND             VALUE 'Y'.          04960054
MK             88  PS-TUPCPLS-ROW-NOT-FOUND         VALUE 'N'.          04970054
                                                                        04980001
       01  PV-PROGRAM-VARIABLES.                                        04990001
           05  PV-KEY-FEEDBACK-AREA    PIC X(11)    VALUE SPACES.       05000001
           05  PV-CLASS                PIC X(02)    VALUE SPACES.       05010001
           05  PV-DECREMENT-FROM-NO    PIC 9(02)    VALUE ZERO.         05020001
           05  PV-DEC-DAYS             PIC 9(02)    VALUE ZERO.         05030001
           05  PV-SQL-SUB              PIC S9(04)   VALUE +0 COMP SYNC. 05040001
           05  PV-SUB                  PIC 9(02)    VALUE ZERO.         05050001
W30677     05  PV-RETRY-COUNTER        PIC S9(04)   VALUE +0            05060099
W30677                                              COMP SYNC.          05070099
W30677     05  PV-UPC-NBR              PIC S9(15)V  COMP-3 VALUE +0.    05080099
W30677     05  PV-SKU-UPC-INPUT.                                        05090099
W30677         10 PV-SKUI-8            PIC X(08)    VALUE SPACES.       05100099
W30677         10 PV-UPCI              PIC X(06)    VALUE SPACES.       05110099
W30677     05  PV-SKU-UPC-INPUT-EOF REDEFINES PV-SKU-UPC-INPUT.         05120099
W30677         10 FILLER               PIC X(06).                       05130099
W30677         10 PV-SKUI-EOF          PIC X(08).                       05140099
W30677     05  PV-SKUI                 PIC X(08)    VALUE SPACES.       05150099
                                                                        05160099
       01  PV-DISTRICT-NBR             PIC X(02)    VALUE SPACES.       05170001
       01  PV-DISTRICT-NBR-9           PIC 9(04)    VALUE ZERO.         05180074
       01  PV-DISTRICT-NBR-COMP        PIC S9(4)V COMP-3 VALUE ZERO.    05190081
       01  PV-STORE-NBR                PIC X(05)    VALUE SPACES.       05200073
       01  IND-NOTES                   PIC S9(04)   COMP.               05210001
       01  PV-MRITST-CSTOCK-QTY        PIC S9(9)V   COMP-3 VALUE ZERO.  05220001
       01  PV-MRITST-OUTL-QTY          PIC S9(7)V   COMP-3 VALUE ZERO.  05230001
       01  PV-MRITST-OP-QTY            PIC S9(9)    COMP   VALUE ZERO.  05240001
       01  PV-STORE-NUMBER-X           PIC XXXXX.                       05250073
       01  PV-STORE-NUMBER-COMP        PIC S9(04)   COMP.               05260001
       01  PV-STORE-NBR-COMP           PIC S9(4)    VALUE ZERO          05270001
                                                    COMP.               05280001
       01  PV-UPC-INTR-UPC-ID          PIC S9(9)    VALUE +0            05290001
                                                    COMP.               05300001
       01  PV-CURRENT-CLASS            PIC X(2)     VALUE SPACES.       05310001
       01  PV-CURRENT-CLASS-9 REDEFINES PV-CURRENT-CLASS                05320001
                                       PIC 9(2).                        05330001
       01  FILLER REDEFINES PV-CURRENT-CLASS.                           05340001
           05  PV-CURRENT-MAJOR-CLASS  PIC 9(1).                        05350001
           05  PV-CURRENT-MINOR-CLASS  PIC 9(1).                        05360001
                                                                        05370001
MK     01  PV-CURRENT-SKU              PIC X(8)     VALUE SPACES.       05380019
MK     01  PV-CURRENT-SKU-9 REDEFINES PV-CURRENT-SKU                    05390019
MK                                     PIC 9(8).                        05400019
                                                                        05410001
       01  PV-MAJOR-CLASS.                                              05420001
           05  PV-MAJOR-CLASS-1        PIC X(01).                       05430001
           05  PV-MAJOR-CLASS-2        PIC X(01).                       05440001
       01  PV-MAJOR-CLASS-X REDEFINES PV-MAJOR-CLASS PIC X(02).         05450001
                                                                        05460001
       01  PV-MINOR-CLASS.                                              05470001
           05  PV-MINOR-CLASS-1        PIC X(01).                       05480001
           05  PV-MINOR-CLASS-2        PIC X(01).                       05490001
           05  PV-MINOR-CLASS-3        PIC X(01).                       05500001
       01  PV-MINOR-CLASS-X REDEFINES PV-MINOR-CLASS PIC X(03).         05510001
                                                                        05520001
       01  PROGRAM-FATAL-ERROR-MESSAGES.                                05530001
           05  PF-ERR-MSG-1            PIC X(35)    VALUE               05540001
             'SELECT OF DEPT/CLASS/SKU ON TSK    '.                     05550001
           05  PF-ERR-MSG-2            PIC X(35)    VALUE               05560001
             'FETCH WITH CURSOR ON TSK          '.                      05570001
           05  PF-ERR-MSG-3            PIC X(35)    VALUE               05580001
             'OPEN CURSOR FOR TSK                '.                     05590001
           05  PF-ERR-MSG-4            PIC X(35)    VALUE               05600001
             'CLOSE CURSOR FOR TSK               '.                     05610001
           05  PF-ERR-MSG-5            PIC X(35)    VALUE               05620001
             'SELECT OF STORE ON XMT_LOC         '.                     05630073
           05  PF-ERR-MSG-6            PIC X(35)    VALUE               05640001
             'FETCH WITH CURSOR ON XMT_LOC       '.                     05650073
           05  PF-ERR-MSG-7            PIC X(35)    VALUE               05660001
             'OPEN CURSOR FOR XMT_LOC            '.                     05670073
           05  PF-ERR-MSG-8            PIC X(35)    VALUE               05680001
             'CLOSE CURSOR FOR XMT_LOC           '.                     05690073
           05  PF-ERR-MSG-9            PIC X(35)    VALUE               05700001
             'FETCH OF TSKSTWKS                 '.                      05710001
           05  PF-ERR-MSG-10           PIC X(35)    VALUE               05720001
             'SELECT OF TSKSTWKI                 '.                     05730001
           05  PF-ERR-MSG-11           PIC X(35)    VALUE               05740001
             'FETCH OF TSKSTMTH                  '.                     05750001
           05  PF-ERR-MSG-12           PIC X(35)    VALUE               05760001
             'SELECT OF TSKST                    '.                     05770001
           05  PF-ERR-MSG-13           PIC X(35)    VALUE               05780001
             'OPEN CURSOR FOR TSKSTMTH           '.                     05790001
           05  PF-ERR-MSG-14           PIC X(35)    VALUE               05800001
             'CLOSE CURSOR FOR TSKSTMTH          '.                     05810001
           05  PF-ERR-MSG-15           PIC X(35)    VALUE               05820001
             'OPEN CURSOR FOR TSKSTWKS           '.                     05830001
           05  PF-ERR-MSG-16           PIC X(35)    VALUE               05840001
             'CLOSE CURSOR FOR TSKSTWKS          '.                     05850001
           05  PF-ERR-MSG-17           PIC X(35)    VALUE               05860001
             'SELECT ORDER INFO FROM TMRITST     '.                     05870001
           05  PF-ERR-MSG-18           PIC X(35)    VALUE               05880001
             'SUM REGIONAL CLEARANCE PRICE DATA  '.                     05890001
           05  PF-ERR-MSG-19           PIC X(35)    VALUE               05900001
             'SELECT REGIONAL CLEAR. PRICE DATA  '.                     05910001
                                                                        05920001
       01  PS-PROGRAM-SWITCHES.                                         05930001
           05  PS-DATES-INIT-IND       PIC X(1)     VALUE 'N'.          05940001
               88  PS-DATES-INIT                    VALUE 'Y'.          05950001
               88  PS-DATES-NOT-INIT                VALUE 'N'.          05960001
           05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          05970001
               88  PS-NO-EDIT-ERROR                 VALUE 'N'.          05980001
               88  PS-EDIT-ERROR                    VALUE 'Y'.          05990001
           05  PS-MORE-MONTHS-IND      PIC X(1)     VALUE 'N'.          06000001
               88  PS-MORE-MONTHS                   VALUE 'Y'.          06010001
               88  PS-NO-MORE-MONTHS                VALUE 'N'.          06020001
           05  PS-MORE-STORES-IND      PIC X(1)     VALUE 'N'.          06030001
               88  PS-MORE-STORES                   VALUE 'Y'.          06040001
               88  PS-NO-MORE-STORES                VALUE 'N'.          06050001
           05  PS-MORE-SKUS-IND        PIC X(1)     VALUE 'N'.          06060001
               88  PS-MORE-SKUS                     VALUE 'Y'.          06070001
               88  PS-NO-MORE-SKUS                  VALUE 'N'.          06080001
           05  PS-MORE-WEEKS-IND       PIC X(1)     VALUE 'N'.          06090001
               88  PS-MORE-WEEKS                    VALUE 'Y'.          06100001
               88  PS-NO-MORE-WEEKS                 VALUE 'N'.          06110001
           05  PS-STORES-FOUND-IND     PIC X(1)     VALUE 'N'.          06120001
               88  PS-STORES-FOUND                  VALUE 'Y'.          06130001
               88  PS-NO-STORES-FOUND               VALUE 'N'.          06140001
           05  PS-SKUS-FOUND-IND       PIC X(1)     VALUE 'N'.          06150001
               88  PS-SKUS-FOUND                    VALUE 'Y'.          06160001
               88  PS-NO-SKUS-FOUND                 VALUE 'N'.          06170001
           05  PS-REPLENISH-FILLED-IND PIC X(1)     VALUE 'N'.          06180001
               88  PS-REPLENISH-FILLED              VALUE 'Y'.          06190001
               88  PS-REPLENISH-NOT-FILLED          VALUE 'N'.          06200001
           05  PS-INT-FOUND-IND        PIC X(1)     VALUE 'N'.          06210001
               88  PS-INT-FOUND                     VALUE 'Y'.          06220001
               88  PS-INT-NOT-FOUND                 VALUE 'N'.          06230001
                                                                        06240001
       01  PV-PROGRAM-VARIABLES.                                        06250001
           05  PV-CICS-RESPONSE        PIC S9(9)    VALUE ZERO          06260001
                                                    COMP SYNC.          06270001
           05  PV-RETRY-COUNT          PIC S9(4)    VALUE ZERO          06280001
                                                    COMP SYNC.          06290001
           05  PV-AMOUNT-FIELDS.                                        06300001
SR3403*        10  PV-ORG-RTL-9        PIC Z,ZZZ.99.                    06310099
SR3403         10  PV-ORG-RTL-9        PIC ZZZZZ.99.                    06320099
               10  PV-ORG-RTL-X REDEFINES PV-ORG-RTL-9                  06330001
                                       PIC X(8).                        06340001
SR3403*        10  PV-CUR-RTL-9        PIC Z,ZZZ.99.                    06350099
SR3403         10  PV-CUR-RTL-9        PIC ZZZZZ.99.                    06360099
               10  PV-CUR-RTL-X REDEFINES PV-CUR-RTL-9                  06370001
                                       PIC X(8).                        06380001
               10  PV-UNITS            PIC Z,ZZZ,ZZ9-.                  06390001
               10  PV-UNITS-X   REDEFINES PV-UNITS                      06400001
                                       PIC X(10).                       06410001
               10  PV-ON-ORDER         PIC ZZZ,ZZZ,ZZ9.                 06420001
               10  PV-ON-ORDER-X REDEFINES PV-ON-ORDER                  06430001
                                       PIC X(11).                       06440001
               10  PV-COST-9           PIC ZZZZZ.999.                   06450001
               10  PV-COST-X    REDEFINES PV-COST-9                     06460001
                                       PIC X(09).                       06470001
               10  PV-STOCK            PIC ZZZZZ,ZZ9.                   06480001
               10  PV-STOCK-X   REDEFINES PV-STOCK                      06490001
                                       PIC X(09).                       06500001
               10  PV-ONHAND           PIC -ZZZ,ZZZ,ZZ9.                06510001
               10  PV-ONHAND-X  REDEFINES PV-ONHAND                     06520001
                                       PIC X(12).                       06530001
W30677         10  PV-INTRANSIT        PIC ZZZZZZZ9-.                   06540099
               10  PV-INTRANSIT-X REDEFINES PV-INTRANSIT                06550001
W30677                                 PIC X(09).                       06560099
W30677         10  PV-STORE-OH         PIC ZZZZZZZZ9-.                  06570099
W30677         10  PV-STORE-OH-X REDEFINES PV-STORE-OH                  06580099
W30677                                 PIC X(10).                       06590099
           05  PV-CURRENT-STORE        PIC 9(5)     VALUE ZERO.         06600073
           05  PV-LEAVE-SYSTEM-MESSAGE PIC X(160)   VALUE SPACES.       06610001
           05  PV-ONHAND-DLRS          PIC S9(9)V99 VALUE ZEROES        06620001
                                                    COMP-3.             06630001
           05  PV-IN-TRNST-DLRS        PIC S9(9)V99 VALUE ZEROES        06640001
                                                    COMP-3.             06650001
           05  PV-STORE-OH-DLRS        PIC S9(9)V99 VALUE ZEROES        06660088
                                                    COMP-3.             06670001
           05  PV-ON-ORDER-DLRS        PIC S9(9)V99 VALUE ZEROES        06680001
                                                    COMP-3.             06690001
           05  PV-SALES-TYPE-CODE      PIC X(2)     VALUE SPACES.       06700001
               88  PV-REGULAR                       VALUE '01'.         06710001
               88  PV-PROMOTIONAL                   VALUE '02'.         06720001
               88  PV-CLEARANCE                     VALUE '03'.         06730001
           05  PV-STATUS-LITERALS-TABLE.                                06740068
               10  PV-STATUS-LITERALS  OCCURS 5 TIMES                   06750001
                                       INDEXED BY PV-STATUS-INDEX.      06760001
                   15 PV-STATUS-LITERAL                                 06770001
                                       PIC 9(2).                        06780001
                   15 PV-STATUS-LITERAL-X REDEFINES PV-STATUS-LITERAL   06790001
                                       PIC X(2).                        06800001
                                                                        06810001
           05  PV-TODAYS-DATE          PIC 9(7)     VALUE ZERO.         06820001
           05  FILLER REDEFINES PV-TODAYS-DATE.                         06830001
               10  FILLER              PIC X(2).                        06840001
               10  PV-TODAYS-YYDDD     PIC 9(5).                        06850001
           05  PV-WEEK-IND             PIC X(10)    VALUE SPACES.       06860001
           05  PV-WEEKS-THIS-YEAR      PIC 9(2)     VALUE ZERO.         06870001
               88  PV-52-WEEKS-THIS-YEAR            VALUE 52.           06880001
               88  PV-53-WEEKS-THIS-YEAR            VALUE 53.           06890001
           05  PV-WKLY-DATE-KEYS.                                       06900001
               10  PV-WKLY-DATE-ENTRY OCCURS  4 TIMES                   06910001
                                     INDEXED BY PV-WEEKLY-INDEX.        06920001
                   15  PV-WKLY-BOW-DATE PIC X(10).                      06930001
                   15  FILLER REDEFINES PV-WKLY-BOW-DATE.               06940001
                       20  PV-WKLY-BOW-CCYY PIC X(4).                   06950001
                       20  FILLER           PIC X(1).                   06960001
                       20  PV-WKLY-BOW-MM   PIC X(2).                   06970001
                       20  FILLER           PIC X(1).                   06980001
                       20  PV-WKLY-BOW-DD   PIC X(2).                   06990001
           05  PV-WKLY-TOTAL-DOLLARS   PIC S9(9)    VALUE ZEROES        07000001
                                                    COMP-3.             07010001
           05  PV-WKLY-TOTAL-UNITS     PIC S9(9)    VALUE ZEROES        07020001
                                                    COMP-3.             07030001
           05  PV-WORK-MMDDYY          PIC X(8)     VALUE SPACES.       07040001
           05  FILLER REDEFINES PV-WORK-MMDDYY.                         07050001
               10  PV-WORK-MM          PIC XX.                          07060001
               10  PV-WORK-SLASH-1     PIC X.                           07070001
               10  PV-WORK-DD          PIC XX.                          07080001
               10  PV-WORK-SLASH-2     PIC X.                           07090001
               10  PV-WORK-YY          PIC XX.                          07100001
           05  PV-WORK-MONTH-YYMM      PIC X(4)     VALUE SPACES.       07110001
           05  FILLER REDEFINES PV-WORK-MONTH-YYMM.                     07120001
               10  PV-WORK-MONTH-YY    PIC XX.                          07130001
               10  PV-WORK-MONTH-MM    PIC XX.                          07140001
           05  PV-WORK-YEAR            PIC 9(2)     VALUE ZERO.         07150001
           05  PV-WORK-DOLLARS         PIC S9(11)   VALUE ZEROES        07160001
                                                    COMP-3.             07170001
           05  PV-CUR-UNIT-RTL-AMT     PIC S9(5)V99 VALUE ZERO.         07180001
           05  PV-STATUS-98            PIC 9(3)     VALUE 98.           07190001
                                                                        07200001
      * NOTE: THE FOLLOWING PV- FIELDS ARE AT AN 01 LEVEL BECAUSE       07210001
      * THEY ARE USED IN CURSOR DECLARATIONS FOR DB2                    07220001
                                                                        07230001
       01  PV-CLASS-LOW                PIC X(2)     VALUE SPACES.       07240001
       01  FILLER  REDEFINES  PV-CLASS-LOW.                             07250001
           05  FILLER                  PIC X.                           07260001
           05  PV-CLASS-LOW-POS-2      PIC X.                           07270001
MK     01  PV-CLASS-LOW-C3             PIC S9(4)V   VALUE ZEROES        07280008
                                                    COMP-3.             07290008
                                                                        07300001
       01  PV-CLASS-HIGH               PIC X(2)     VALUE SPACES.       07310001
       01  FILLER  REDEFINES  PV-CLASS-HIGH.                            07320001
           05  FILLER                  PIC X.                           07330001
           05  PV-CLASS-HIGH-POS-2     PIC X.                           07340001
MK     01  PV-CLASS-HIGH-C3            PIC S9(4)V   VALUE ZEROES        07350008
                                                    COMP-3.             07360008
                                                                        07370001
       01  PV-DB2-FROM-BOW-DATE        PIC X(10)    VALUE SPACES.       07380001
       01  PV-DB2-TO-BOW-DATE          PIC X(10)    VALUE SPACES.       07390001
                                                                        07400001
       01  PV-DB2-FROM-CCYYMM          PIC X(6)     VALUE SPACES.       07410089
       01  FILLER  REDEFINES  PV-DB2-FROM-CCYYMM.                       07420089
           05  PV-DB2-FROM-CC          PIC X(2).                        07430089
           05  PV-DB2-FROM-YY          PIC X(2).                        07440089
           05  PV-DB2-FROM-MM          PIC X(2).                        07450089
                                                                        07460001
       01  PV-DB2-TO-CCYYMM            PIC X(6)     VALUE SPACES.       07470089
       01  FILLER  REDEFINES  PV-DB2-TO-CCYYMM.                         07480089
           05  PV-DB2-TO-CC            PIC X(2).                        07490089
           05  PV-DB2-TO-YY            PIC X(2).                        07500089
           05  PV-DB2-TO-MM            PIC X(2).                        07510089
                                                                        07520001
       01  PV-GROUP-HIGH               PIC X(3)     VALUE SPACES.       07530001
                                                                        07540001
       01  PV-GROUP-LOW                PIC X(3)     VALUE SPACES.       07550001
                                                                        07560001
       01  PV-STATUS-CODES.                                             07570001
MK         05  PV-STATUS-1             PIC X(02)    VALUE SPACES.       07580007
MK         05  PV-STATUS-2             PIC X(02)    VALUE SPACES.       07590007
MK         05  PV-STATUS-3             PIC X(02)    VALUE SPACES.       07600007
MK         05  PV-STATUS-4             PIC X(02)    VALUE SPACES.       07610007
MK         05  PV-STATUS-5             PIC X(02)    VALUE SPACES.       07620007
MK         05  PV-STATUS-6             PIC X(02)    VALUE SPACES.       07630007
                                                                        07640001
       01  PV-STORE-NUMBER             PIC 9(5)     VALUE ZERO.         07650085
                                                                        07660001
0518   01  PV-VND-STYL-LO              PIC X(15)    VALUE SPACES.       07670099
0518   01  PV-VND-STYL-HI              PIC X(15)    VALUE SPACES.       07680099
0518   01  PV-LNG-STYL-LO              PIC X(20)    VALUE SPACES.       07690099
0518   01  PV-LNG-STYL-HI              PIC X(20)    VALUE SPACES.       07700099
0518  *01  PV-STYLE-HIGH               PIC X(20)    VALUE SPACES.       07710099
0518  *                                                                 07720099
0518  *01  PV-STYLE-LOW                PIC X(20)    VALUE SPACES.       07730099
       01  PV-KYITM-LOW                PIC X        VALUE SPACES.       07740001
       01  PV-KYITM-HIGH               PIC X        VALUE SPACES.       07750001
       01  PV-LONG-COLOR-LOW           PIC X(10)    VALUE SPACES.       07760001
       01  PV-LONG-COLOR-HIGH          PIC X(10)    VALUE SPACES.       07770001
       01  PV-COLOR-LOW                PIC XXX      VALUE SPACES.       07780001
       01  PV-COLOR-HIGH               PIC XXX      VALUE SPACES.       07790001
       01  PV-SIZE-LOW                 PIC X(5)     VALUE SPACES.       07800001
       01  PV-SIZE-HIGH                PIC X(5)     VALUE SPACES.       07810001
       01  PV-REPLEN-LOW               PIC X        VALUE SPACES.       07820001
       01  PV-REPLEN-HIGH              PIC X        VALUE SPACES.       07830001
                                                                        07840001
       01  PV-VENDOR-HIGH              PIC S999V    VALUE ZERO          07850001
                                                    COMP-3.             07860001
                                                                        07870001
       01  PV-VENDOR-LOW               PIC S999V    VALUE ZERO          07880001
                                                    COMP-3.             07890001
       01  ST-SYSTEM-DATE-AREA.                                         07900001
           05  ST-DATE-MM              PIC 9(2)     VALUE ZERO.         07910001
           05  FILLER                  PIC X(4)     VALUE SPACES.       07920001
           05  ST-DATE-YY              PIC 9(2)     VALUE ZERO.         07930001
                                                                        07940001
       01  ST-SYSTEM-TIME-AREA.                                         07950001
           05  ST-ABSTIME              PIC S9(18)   VALUE ZERO          07960001
                                       COMP SYNC.                       07970001
           05  ST-TIME-EDIT.                                            07980001
               10  ST-TIME-HHMM        PIC X(5)     VALUE SPACES.       07990001
               10  FILLER              PIC X(3)     VALUE SPACES.       08000001
       01  PV-SUM-LVL-CDE              PIC X        VALUE SPACES.       08010001
       01  PV-ALL-SUM-LVL-CDE          PIC X        VALUE 'A'.          08020001
       01  PV-DIST-SUM-LVL-CDE         PIC X        VALUE 'D'.          08030001
       01  PV-TDISTSM-STATUS-CDE       PIC X(02)    VALUE SPACES.       08040099
       01  PV-BLANK-DISTRICT           PIC X(02)    VALUE SPACES.       08050001
       01  PV-TDISTSM-DISTRICT         PIC X(02)    VALUE SPACES.       08060099
       01  PV-TSKSTOO-QTY              PIC 9(07)    VALUE ZERO.         08070001
      *                                                                 08080001
      *  STANDARD ATTENTION IDENTIFIER LIST                             08090001
      *                                                                 08100001
           COPY DFHAID.                                                 08110001
      *                                                                 08120001
W30677******************************************************************08130099
W30677*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE            08140099
W30677******************************************************************08150099
W30677     COPY DPWS010I.                                               08160099
W30677                                                                  08170099
      ******************************************************************08180001
      * DB2 CALENDAR ROUTINE WORK AREA.                                 08190001
      ******************************************************************08200001
           COPY DPWS500.                                                08210001
      *                                                                 08220001
      *  STANDARD KOHL'S ATTRIBUTE LIST                                 08230001
      *                                                                 08240001
           COPY DPWS015.                                                08250001
      ******************************************************************08260093
      *    INTRANSIT COPYBOOK.                                         *08270093
      ******************************************************************08280093
           COPY XLWS074.                                                08290093
                                                                        08300006
MK    ******************************************************************08310006
MK    * NON-INTELLIGENT SKU RE-FORMATTING COPYBOOK                      08320006
MK    ******************************************************************08330006
MK    *                                                                 08340006
MK         COPY ISWS006.                                                08350006
MK                                                                      08360006
      ******************************************************************08370001
      *    SQLCA IS THE DB2 COMMUNICATIONS AREA                        *08380001
      ******************************************************************08390001
           EXEC SQL                                                     08400001
               INCLUDE SQLCA                                            08410001
           END-EXEC.                                                    08420001
      ******************************************************************08430001
      *    TMRITST IS THE DCLGEN MEMBER FOR THE ORDER-UP-TO INFO        08440001
      ******************************************************************08450001
           EXEC SQL                                                     08460001
               INCLUDE TMRITST                                          08470001
           END-EXEC.                                                    08480001
      ******************************************************************08490001
      *    XMT00001 IS THE DCLGEN MEMBER FOR THE STORE TABLE            08500073
      ******************************************************************08510001
           EXEC SQL                                                     08520001
               INCLUDE XMT00001                                         08530073
           END-EXEC.                                                    08540001
      ******************************************************************08550001
      *    TSK IS THE DCLGEN MEMBER FOR THE SKU TABLE                  *08560001
      ******************************************************************08570001
           EXEC SQL                                                     08580001
               INCLUDE TSK                                              08590001
           END-EXEC.                                                    08600001
      ******************************************************************08610019
      *    TSKXREF IS THE DCLGEN MEMBER FOR THE SKU CROSS REFERENCE    *08620019
      *      TABLE.                                                    *08630019
      ******************************************************************08640019
           EXEC SQL                                                     08650019
               INCLUDE TSKXREF                                          08660019
           END-EXEC.                                                    08670019
      ******************************************************************08680001
      *    TSKST IS THE DCLGEN MEMBER FOR THE SKU STORE TABLE           08690001
      ******************************************************************08700001
           EXEC SQL                                                     08710001
               INCLUDE TSKST                                            08720001
           END-EXEC.                                                    08730001
      ******************************************************************08740019
      *  SQL AND COBOL DECLARATIONS FOR THE UPC SKU TABLE TO INCLUDE  * 08750001
      *  REPLENISHMENT SKUS                                           * 08760001
      ******************************************************************08770019
           EXEC SQL                                                     08780001
               INCLUDE TUPCSKU                                          08790001
           END-EXEC.                                                    08800001
      ******************************************************************08810019
      *  SQL AND COBOL DECLARATIONS FOR THE UPC TABLE TO INCLUDE      * 08820001
      *  REPLENISHMENT SKUS                                           * 08830001
      ******************************************************************08840019
           EXEC SQL                                                     08850001
               INCLUDE TUPC                                             08860001
           END-EXEC.                                                    08870001
      ******************************************************************08880001
      *    TSKSTWKS IS THE DCLGEN MEMBER FOR THE SKU WEEKLY SALES TABLE 08890001
      ******************************************************************08900001
           EXEC SQL                                                     08910001
               INCLUDE TSKSTWKS                                         08920001
           END-EXEC.                                                    08930001
      ******************************************************************08940001
      *    TWKINVP IS THE DCLGEN MEMBER FOR THE SKU WEEKLY INVENTORY    08950001
      *    TABLE.                                                       08960001
      ******************************************************************08970001
           EXEC SQL                                                     08980001
               INCLUDE TSKSTWKI                                         08990001
           END-EXEC.                                                    09000001
      ******************************************************************09010001
      *    TMDSEAR IF THE DCLGEN MEMBER FOR THE DEPARTMENT/CLASS       *09020001
      *    TABLE.                                                      *09030001
      ******************************************************************09040001
           EXEC SQL                                                     09050001
               INCLUDE TMDSEAR                                          09060001
           END-EXEC.                                                    09070001
      ******************************************************************09080001
      *  SQL AND COBOL DECLARATIONS FOR THE NRF SIZE TABLE (TSIZE)     *09090001
      ******************************************************************09100001
           EXEC SQL                                                     09110001
               INCLUDE TSIZE                                            09120001
           END-EXEC.                                                    09130001
      ******************************************************************09140001
      *  SQL AND COBOL DECLARATIONS FOR THE TUPCPLS TABLE              *09150001
      ******************************************************************09160001
           EXEC SQL                                                     09170001
               INCLUDE TUPCPLS                                          09180001
           END-EXEC.                                                    09190001
                                                                        09200099
      ******************************************************************09210001
      *  SQL AND COBOL DECLARATIONS FOR THE SUMMARY TABLE (TDISTSM)    *09220099
      ******************************************************************09230099
                                                                        09240099
           EXEC SQL                                                     09250099
               INCLUDE TDISTSM                                          09260099
           END-EXEC.                                                    09270099
                                                                        09280099
      ******************************************************************09290099
      *  SQL AND COBOL DECLARATIONS FOR THE ON-ORDER TABLE (TSKSTOO)   *09300001
      ******************************************************************09310001
                                                                        09320099
           EXEC SQL                                                     09330001
               INCLUDE TSKSTOO                                          09340001
           END-EXEC.                                                    09350001
      ******************************************************************09360001
      *    DECLARE THE CURSOR FOR SELECTIONS OF STORES WITHIN A DIS-   *09370001
      *    TRICT FROM THE STORE TABLE                                  *09380001
      ******************************************************************09390001
           EXEC SQL                                                     09400001
               DECLARE DIST_STORE_CURS CURSOR FOR                       09410001
                   SELECT LOC_NBR                                       09420073
                   FROM XMT_LOC                                         09430073
                   WHERE                                                09440075
                         DIST_NBR       = :PV-DISTRICT-NBR-COMP         09450082
                                                                        09460001
                    OPTIMIZE FOR 1 ROW                                  09470048
                    FOR FETCH ONLY                                      09480001
           END-EXEC.                                                    09490001
      ******************************************************************09500001
      *    DECLARE THE CURSOR FOR SELECTIONS OF SKUS WHICH MEET THE    *09510001
      *    CRITERIA PASSED IN THE COMMAREA FROM FSKCS034 OR FSKCS033   *09520001
      ******************************************************************09530012
MK    *   CHANGE MADE TO CURSOR FOR NEW SKU - ADDED TSKSXREF AND       *09540012
MK    *   TOOK OUT REFERENCES TO TUPCSKU.                              *09550012
      ******************************************************************09560001
      ******************************************************************09570057
MK    *   CHANGE MADE FOR RCP PROCESSING - ADDED STATUS CODE           *09580057
      ******************************************************************09590057
                                                                        09600001
           EXEC SQL                                                     09610001
               DECLARE MULT-SKUS-CSR-2 CURSOR FOR                       09620001
                   SELECT B.DEPT,                                       09630019
                          B.SUBCLASS,                                   09640019
                          B.SKU,                                        09650019
                          A.CUR_UNIT_RTL_AMT,                           09660019
                          A.ITEM_NMBR,                                  09670019
                          A.GP_RTL_AMT,                                 09680019
                          A.GP_QTY,                                     09690019
                          A.REGN_PRIC_IND,                              09700057
                          A.STATUS_CODE                                 09710057
                   FROM  TSK     A                                      09720001
                        ,TSKXREF B                                      09730006
                        ,TUPC    C                                      09740001
                   WHERE (A.ITEM_NMBR = B.ITM_NBR)                      09750019
                     AND (B.INTR_UPC_ID = C.INTR_UPC_ID)                09760019
                     AND (B.DEPT = :NI-DEPT-9-4)                        09770019
                     AND (B.SUBCLASS BETWEEN :PV-CLASS-LOW-C3           09780019
                                         AND :PV-CLASS-HIGH-C3)         09790019
                     AND (B.SKU_STAT_CDE IN (:PV-STATUS-1,              09800019
                                             :PV-STATUS-2,              09810019
                                             :PV-STATUS-3,              09820019
                                             :PV-STATUS-4,              09830019
                                             :PV-STATUS-5,              09840019
                                             :PV-STATUS-6))             09850019
                     AND (A.GROUP_CODE BETWEEN :PV-GROUP-LOW AND        09860019
                                               :PV-GROUP-HIGH)          09870019
                     AND (A.VNDR_IN_HSE_NMBR BETWEEN :PV-VENDOR-LOW     09880019
                                                 AND :PV-VENDOR-HIGH)   09890019
0518                 AND ((A.LONG_VENDOR_STYLE                          09900099
0518                                         BETWEEN :PV-LNG-STYL-LO    09910099
0518                                             AND :PV-LNG-STYL-HI)   09920099
                       OR (A.VENDOR_STYLE_CODE                          09930099
0518                                         BETWEEN :PV-VND-STYL-LO    09940099
0518                                             AND :PV-VND-STYL-HI))  09950099
0518  *              AND ((A.LONG_VENDOR_STYLE BETWEEN :PV-STYLE-LOW    09960099
0518  *                                            AND :PV-STYLE-HIGH)  09970099
0518  *                  OR (A.VENDOR_STYLE_CODE BETWEEN :PV-STYLE-LOW  09980099
0518  *                                            AND :PV-STYLE-HIGH)) 09990099
                     AND (A.SIZE_CDE BETWEEN :PV-SIZE-LOW               10000019
                                         AND :PV-SIZE-HIGH)             10010019
                     AND (A.LONG_COLOR_DESC BETWEEN :PV-LONG-COLOR-LOW  10020019
                                               AND :PV-LONG-COLOR-HIGH) 10030019
                     AND (A.COLOR_CDE BETWEEN :PV-COLOR-LOW             10040019
                                          AND :PV-COLOR-HIGH)           10050019
                     AND (C.KY_ITM_IND BETWEEN :PV-KYITM-LOW            10060019
                                           AND :PV-KYITM-HIGH)          10070019
                     AND (C.UPC_TYP_CDE = 'I')                          10080019
                     AND (C.RPLNMT_IND BETWEEN :PV-REPLEN-LOW           10090019
                                           AND :PV-REPLEN-HIGH)         10100019
                     AND ((CURRENT DATE BETWEEN C.EFF_BEG_DTE           10110019
                                           AND  C.EFF_END_DTE)          10120019
                         OR (CURRENT DATE > C.EFF_BEG_DTE AND           10130019
                                        C.EFF_END_DTE IS NULL))         10140020
                    OPTIMIZE FOR 1 ROW                                  10150047
                    FOR FETCH ONLY                                      10160001
           END-EXEC.                                                    10170001
                                                                        10180001
      ******************************************************************10190001
      *    DECLARE THE CURSOR FOR SELECTIONS OF WEEKLY SALES FOR EACH  *10200001
      *    SKU PROCESSED                                               *10210001
      ******************************************************************10220001
           EXEC SQL                                                     10230001
               DECLARE WKLY_SALES_CURS CURSOR FOR                       10240001
                   SELECT                                               10250001
                       FSCL_BOW_DTE,                                    10260001
                       SALES_TYPE_CODE,                                 10270001
                       SUN_SLS_UNIT_QTY,                                10280001
                       MON_SLS_UNIT_QTY,                                10290001
                       TUE_SLS_UNIT_QTY,                                10300001
                       WED_SLS_UNIT_QTY,                                10310001
                       THU_SLS_UNIT_QTY,                                10320001
                       FRI_SLS_UNIT_QTY,                                10330001
                       SAT_SLS_UNIT_QTY,                                10340001
                       SALES_UNIT_QTY,                                  10350001
                       SALES_AMT                                        10360001
                   FROM                                                 10370001
                       TSKSTWKS                                         10380001
                   WHERE                                                10390001
                    ((:TSK-ITEM-NMBR = ITEM_NMBR)                       10400001
                                  AND                                   10410001
                     (:TSKST-LOC-NBR = STR_NBR)                         10420075
                                  AND                                   10430001
                     (FSCL_BOW_DTE BETWEEN                              10440001
                        :PV-DB2-FROM-BOW-DATE AND :PV-DB2-TO-BOW-DATE)) 10450001
                    OPTIMIZE FOR 5 ROWS                                 10460048
                    FOR FETCH ONLY                                      10470001
           END-EXEC.                                                    10480001
                                                                        10490001
      ******************************************************************10500001
      *    THE FOLLOWING CURSORS USED TO RESIDE IN FSKCS033            *10510001
      ******************************************************************10520001
      *    DECLARE THE CURSOR FOR THE NEXT STORE NUMBER                 10530001
      ******************************************************************10540001
                                                                        10550001
           EXEC SQL                                                     10560001
               DECLARE STORE_CURSOR CURSOR FOR                          10570001
                   SELECT                                               10580001
                       LOC_NBR,                                         10590074
                       LOC_10_ABBR_NM                                   10600079
                   FROM                                                 10610001
                       XMT_LOC                                          10620074
                   WHERE                                                10630001
                       LOC_NBR > :PV-STORE-NUMBER-COMP                  10640075
                   ORDER BY LOC_NBR                                     10650074
                   OPTIMIZE FOR 1  ROWS                                 10660048
                   FOR FETCH ONLY                                       10670001
           END-EXEC.                                                    10680001
                                                                        10690001
      ******************************************************************10700001
      *    DECLARE THE CURSOR FOR THE NEXT SKU NUMBER                   10710001
      ******************************************************************10720001
MK    *    CHANGED CURSOR FOR NEW SKU.  ADDED TSKXREF.                  10730012
      ******************************************************************10740012
                                                                        10750001
           EXEC SQL                                                     10760001
               DECLARE NEXT_SKU_CURS CURSOR FOR                         10770001
                   SELECT X.DEPT,                                       10780011
                        X.SUBCLASS,                                     10790011
                        X.SKU,                                          10800011
                        STATUS_CODE,                                    10810011
                        UNIT_COST_AMT,                                  10820011
                        CUR_UNIT_RTL_AMT,                               10830011
                        ORIG_UNIT_RTL_AMT,                              10840011
                        SKU_DESC,                                       10850011
                        SIZE_DESC,                                      10860011
                        COLOR_DESC,                                     10870011
                        GP_RTL_AMT,                                     10880011
                        GP_QTY,                                         10890011
                        LONG_SIZE_DESC,                                 10900011
                        LONG_COLOR_DESC,                                10910011
                        SIZE_CDE,                                       10920011
                        REGN_PRIC_IND                                   10930011
                   FROM TSK,                                            10940011
                        TSKXREF X                                       10950011
                   WHERE ITEM_NMBR = X.ITM_NBR                          10960011
                     AND X.DEPT = :NI-DEPT-9-4                          10970011
                     AND X.SUBCLASS = :NI-SUB-CLASS-9-4                 10980011
                     AND X.SKU  > :NI-SKU-9-8                           10990011
W30677               AND X.SKU_STAT_CDE <> :PC-STATUS-98                11000099
                   ORDER BY X.DEPT,                                     11010011
                            X.SUBCLASS,                                 11020011
                            X.SKU                                       11030011
                   OPTIMIZE FOR 1  ROWS                                 11040048
                   FOR FETCH ONLY                                       11050001
           END-EXEC.                                                    11060001
                                                                        11070001
      ******************************************************************11080001
      *    DECLARE THE COMPLEX CURSOR FOR THE NEXT SKU NUMBER           11090001
MK    *    CHANGED CURSOR FOR NEW SKU.  ADDED TSKXREF.                  11100013
      *              AND ((X.SUBCLASS >= :NI-CLASS-9-4)                 11110049
      *                 AND (X.SUBCLASS <= :PV-CLASS-HIGH-C3))          11120049
      ******************************************************************11130001
                                                                        11140001
           EXEC SQL                                                     11150001
               DECLARE SKU_CMPLX_CURS CURSOR FOR                        11160001
                   SELECT X.DEPT,                                       11170013
                        X.SUBCLASS,                                     11180013
                        X.SKU,                                          11190013
                        UNIT_COST_AMT,                                  11200013
                        CUR_UNIT_RTL_AMT,                               11210013
                        ORIG_UNIT_RTL_AMT,                              11220013
                        SKU_DESC,                                       11230013
                        SIZE_DESC,                                      11240013
                        COLOR_DESC,                                     11250013
                        GP_RTL_AMT,                                     11260013
                        GP_QTY,                                         11270013
                        LONG_SIZE_DESC,                                 11280013
                        LONG_COLOR_DESC,                                11290013
                        SIZE_CDE,                                       11300013
                        REGN_PRIC_IND,                                  11310057
                        STATUS_CODE                                     11320057
                   FROM TSK,                                            11330013
                        TSKXREF X                                       11340013
                   WHERE ITEM_NMBR = X.ITM_NBR                          11350051
                     AND X.DEPT = :NI-DEPT-9-4                          11360051
                     AND ((X.SUBCLASS >= :NI-CLASS-9-4)                 11370050
                        AND (X.SUBCLASS <= :PV-CLASS-HIGH-C3))          11380050
                     AND X.SKU > :NI-SKU-9-8                            11390014
W30677               AND X.SKU_STAT_CDE <> :PC-STATUS-98                11400099
                   ORDER BY X.DEPT,                                     11410013
                            X.SUBCLASS,                                 11420013
                            X.SKU                                       11430013
                   OPTIMIZE FOR 1  ROWS                                 11440048
                   FOR FETCH ONLY                                       11450001
           END-EXEC.                                                    11460001
                                                                        11470001
      ******************************************************************11480001
      *    DECLARE THE CURSOR FOR THE NEXT CLASS                        11490001
MK    *    CHANGED CURSOR FOR NEW SKU - CHANGED TSK TO TSKXREF          11500014
      ******************************************************************11510001
                                                                        11520001
           EXEC SQL                                                     11530001
               DECLARE NEXT_CLASS_CURS CURSOR FOR                       11540001
                   SELECT SUBCLASS                                      11550014
                   FROM TSKXREF                                         11560014
                   WHERE DEPT = :NI-DEPT-9-4                            11570014
                     AND SUBCLASS > :NI-CLASS-9-4                       11580016
                   ORDER BY SUBCLASS                                    11590014
                   OPTIMIZE FOR 1  ROWS                                 11600048
                   FOR FETCH ONLY                                       11610001
           END-EXEC.                                                    11620001
                                                                        11630001
      ******************************************************************11640001
      *    DECLARE THE CURSOR FOR THE NEXT DEPARTMENT                   11650001
MK    *    CHANGED CURSOR FOR NEW SKU - CHANGED TSK TO TSKXREF          11660014
      ******************************************************************11670001
                                                                        11680001
           EXEC SQL                                                     11690001
               DECLARE NEXT_DEPT_CURS CURSOR FOR                        11700001
                   SELECT DEPT                                          11710014
                   FROM TSKXREF                                         11720014
                   WHERE DEPT > :NI-DEPT-9-4                            11730014
                     AND (SUBCLASS BETWEEN :PV-CLASS-LOW-C3             11740014
                        AND :PV-CLASS-HIGH-C3)                          11750021
                   ORDER BY DEPT                                        11760014
                   OPTIMIZE FOR 1  ROWS                                 11770048
                   FOR FETCH ONLY                                       11780001
           END-EXEC.                                                    11790001
                                                                        11800001
       LINKAGE SECTION.                                                 11810001
                                                                        11820001
       01  DFHCOMMAREA.                                                 11830001
           05  FILLER                         OCCURS  1 TO 4072 TIMES   11840001
                                              DEPENDING ON EIBCALEN.    11850001
               10  FILLER                     PIC X.                    11860001
                                                                        11870001
                                                                        11880001
           EJECT                                                        11890001
      ******************************************************************11900001
       PROCEDURE DIVISION.                                              11910001
      ******************************************************************11920001
                                                                        11930001
       0000-MAINLINE.                                                   11940001
           MOVE '*0000-MAINLINE.                  *' TO DP013-PARAGRAPH 11950001
                                                                        11960001
           INITIALIZE DP030-CICS-API-FIELDS.                            11970001
           MOVE +1                      TO DP030-NUMBER-OF-MAPS.        11980001
           MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           11990001
           MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          12000001
           SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        12010001
           MOVE LENGTH OF FS032AI       TO DP030-MAP-LENGTH (1).        12020001
           MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      12030001
           PERFORM 0001-CALL-CICS-ARCH-API.                             12040001
                                                                        12050001
           PERFORM 1000-CONTROL-PROCESSING.                             12060001
                                                                        12070001
           MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      12080001
           PERFORM 0001-CALL-CICS-ARCH-API.                             12090001
                                                                        12100001
           GOBACK.                                                      12110001
                                                                        12120001
           EJECT                                                        12130001
      ******************************************************************12140019
      *   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *12150001
      *   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *12160001
      ******************************************************************12170019
                                                                        12180001
       0001-CALL-CICS-ARCH-API.                                         12190001
           MOVE '*0001-CALL-CICS-ARCH-API.        *' TO DP013-PARAGRAPH 12200001
                                                                        12210001
           IF PS-EDIT-ERROR                                             12220099
               SET DP020-MSG-FATAL           TO TRUE                    12230099
W30677         SET DP030-SET-CURSOR-APPL-1   TO TRUE.                   12240099
                                                                        12250001
           CALL DP930-CICS-ARCH-API USING DFHEIBLK                      12260099
                                          DFHCOMMAREA                   12270099
                                          DP030-CICS-API-FIELDS         12280099
                                          DP020-STANDARD-COMMAREA       12290099
                                          FS032AI.                      12300099
                                                                        12310001
           IF  DP030-RC-CALL-SUCCESSFUL                                 12320001
               CONTINUE                                                 12330001
           ELSE                                                         12340001
               SET DP013-NO-ROLLBACK TO TRUE                            12350001
               SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   12360001
               SET DP013-CICS-ABEND TO TRUE                             12370001
               MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        12380001
1022RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O12401099
1022RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      12402099
               MOVE DP030-RETURN-CODE                                   12410001
                                     TO DP013-MESSAGE-TEXT (3)          12420001
               PERFORM DP013-0000-PROCESS-ABEND                         12430001
           END-IF.                                                      12440001
                                                                        12450001
      ******************************************************************12460019
       1000-CONTROL-PROCESSING.                                         12470001
           MOVE '*1000-CONTROL-PROCESSING.        *' TO DP013-PARAGRAPH.12480001
                                                                        12490001
                                                                        12500001
           EXEC CICS                                                    12510001
               ASKTIME                                                  12520001
                   ABSTIME(PC-ABSTIME)                                  12530001
           END-EXEC.                                                    12540001
                                                                        12550001
           EXEC CICS                                                    12560001
               FORMATTIME                                               12570001
                   ABSTIME(PC-ABSTIME)                                  12580001
                   MMDDYY(PC-SYSTEM-DATE)                               12590001
           END-EXEC.                                                    12600001
                                                                        12610001
           EVALUATE TRUE                                                12620001
               WHEN DP020-NEXT-ACT-INITIAL                              12630001
                 MOVE CA-FS-INTER-APPL-COMMAREA TO CA-INTER-APPL-COPY   12640099
               WHEN OTHER                                               12650099
                 MOVE CA-INTER-APPL-COPY TO CA-FS-INTER-APPL-COMMAREA   12660001
           END-EVALUATE.                                                12670001
                                                                        12680001
           IF DP020-NEXT-ACT-INITIAL                                    12690001
               MOVE DP020-INT-APPL-FORMAT-IND TO CA-DP020-FORMAT-IND    12700001
           END-IF                                                       12710001
                                                                        12720001
           SET PS-NO-EDIT-ERROR            TO TRUE.                     12730001
                                                                        12740001
           IF CA-DP020-FORMAT-IND       = '1' OR                        12750001
              DP020-INT-APPL-FORMAT-IND = '1'                           12760001
      *-->     DEALING W/ A SELECTED ITEM FROM A LIST SCREEN.           12770001
                                                                        12780001
               EVALUATE TRUE                                            12790001
                                                                        12800001
      *-->     THE 9000- ROUTINE LOADS UP CA-SKU-STORE W/ THE KEY VALUE 12810001
      *-->     FOUND ON THE TEMP STORAGE RECORD.  THE REMAINDER OF THE  12820001
      *-->     PROGRAM CAN STAY THE SAME.                               12830001
                                                                        12840001
                   WHEN DP020-NEXT-ACT-INITIAL                          12850001
                   WHEN DP020-NEXT-ACT-RETURN                           12860001
                       SET CA-NEXT-SKU   TO TRUE                        12870001
                       PERFORM 9000-READ-TS-QUEUE                       12880001
                                                                        12890001
                   WHEN (DP020-NEXT-ACT-READ-MAP AND                    12900001
                         DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID))         12910001
                       SET CA-NEXT-SKU TO TRUE                          12920001
                       ADD +1 TO CA-FS002-IDX                           12930001
                       IF CA-FS002-IDX > FS002-MAX-ITEMS                12940001
                           ADD  +1 TO CA-TS-ITEM-NUMBER                 12950001
                           MOVE +1 TO CA-FS002-IDX                      12960001
                           PERFORM 9000-READ-TS-QUEUE                   12970001
                       END-IF                                           12980001
               END-EVALUATE                                             12990001
               IF CA-NEXT-STORE                                         13000001
                   NEXT SENTENCE                                        13010001
               ELSE                                                     13020001
                   MOVE CA-FS002-AREA  TO FS002-TS-SEL-REC              13030001
                   IF FS002-KEY-DATA(CA-FS002-IDX) =                    13040001
                       (SPACES OR LOW-VALUES)                           13050001
                       IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)         13060001
      *-->                 NO MORE SKU'S W/IN SELECTION LIST            13070001
                           MOVE PC-TSYMSG-00113  TO  DP020-MSG-NUMBER   13080001
                           SET PS-EDIT-ERROR     TO  TRUE               13090001
                       END-IF                                           13100001
                   ELSE                                                 13110001
                       MOVE CA-FS002-AREA TO FS002-TS-SEL-REC           13120001
                       MOVE FS002-KEY-DATA(CA-FS002-IDX) TO             13130001
                            CA-SKU-STORE                                13140001
      *-->             SIGNIFY THAT THIS SELECTED ITEM HAS BEEN VIEWED .13150001
                       MOVE PC-INQ TO FS002-ACTION-SW (CA-FS002-IDX)    13160001
                       PERFORM 9100-REWRITE-TS-QUEUE                    13170001
      *-->             ... AND UPDATE COMMAREA WITH THE CHANGE          13180001
                       MOVE FS002-TS-SEL-REC TO CA-FS002-AREA           13190001
                   END-IF                                               13200001
               END-IF                                                   13210001
                                                                        13220001
           END-IF.                                                      13230001
                                                                        13240001
           IF PS-NO-EDIT-ERROR                                          13250001
               EVALUATE TRUE                                            13260001
                   WHEN DP020-NEXT-ACT-INITIAL                          13270001
                   WHEN DP020-NEXT-ACT-RETURN                           13280099
                       PERFORM 2000-INITIALIZE                          13290099
                                                                        13300099
                   WHEN DP020-NEXT-ACT-READ-MAP                         13310001
W30677                 IF CA-SKU-LEVEL-IND EQUAL SPACES                 13320099
W30677                     PERFORM 2000-FKEY-PROCESSING                 13330099
W30677                 ELSE                                             13340099
W30677                     PERFORM 2000-EDIT-SKU                        13350099
W43143                     PERFORM 2000-FKEY-PROCESSING                 13360099
W30677                 END-IF                                           13370099
                                                                        13380099
                   WHEN OTHER                                           13390001
                       SET DP013-LOGIC-ABEND                            13400001
                           DP013-NO-ROLLBACK TO TRUE                    13410001
                       MOVE '1000-CONTROL-PROCESSING'                   13420001
                                             TO  DP013-PARAGRAPH        13430001
                       MOVE 'INVALID NEXT ACTY RETURNED TO APPL PGM:'   13440001
                                             TO  DP013-MESSAGE-TEXT(1)  13450001
                       MOVE DP020-NEXT-APPL-ACTIVITY                    13460001
                                             TO DP013-MESSAGE-TEXT(2)   13470001
                       PERFORM DP013-0000-PROCESS-ABEND                 13480001
               END-EVALUATE.                                            13490001
           MOVE CA-FS-INTER-APPL-COMMAREA TO CA-INTER-APPL-COPY.        13500001
                                                                        13510001
           EJECT                                                        13520001
                                                                        13530019
W30677******************************************************************13540099
W30677 2000-EDIT-SKU.                                                   13550099
W30677     MOVE '*2000-EDIT-SKU.                  *' TO DP013-PARAGRAPH.13560099
W30677                                                                  13570099
W30677     IF  SKUF = DP015-ERASE-EOF                                   13580099
W30677         MOVE DP015-REVERSE         TO SKUH                       13590099
W30677         MOVE DP015-RED             TO SKUC                       13600099
W30677         MOVE DP015-UNP-ALP-BRT-OFF TO SKUA                       13610099
W30677         SET PS-EDIT-ERROR          TO TRUE                       13620099
W30677         MOVE PC-TSYMSG-00413      TO DP020-MSG-NUMBER            13630099
W30677         MOVE -1                   TO SKUL                        13640099
W30677         MOVE SPACES               TO CA-SKU-NUMBER-X             13650099
W30677                                      CA-UPC-NUMBER-X             13660099
W30677     ELSE                                                         13670099
W30677         IF SKUL > ZERO                                           13680099
W30677             MOVE SKUI TO PV-SKU-UPC-INPUT                        13690099
W30677             IF SKUL > +8                                         13700099
W30677                 IF PV-UPCI EQUAL SPACE                           13710099
W30677                     MOVE PV-SKUI-8 TO PV-SKUI                    13720099
W30677                     PERFORM 2700-EDIT-SKU-FIELDS                 13730099
W30677                     IF NOT PS-EDIT-ERROR                         13740099
W30677                         PERFORM 2000-GET-NEW-SKU-UPC             13750099
W30677                     END-IF                                       13760099
W30677                 ELSE                                             13770099
W30677                     PERFORM 2600-EDIT-UPC-FIELDS                 13780099
W30677                     IF NOT PS-EDIT-ERROR                         13790099
W30677                         PERFORM 2500-VALIDATE-UPC-NBR            13800099
W30677                     END-IF                                       13810099
W30677                 END-IF                                           13820099
W30677             ELSE                                                 13830099
W30677                 MOVE PV-SKUI-EOF TO PV-SKUI                      13840099
W30677                 PERFORM 2700-EDIT-SKU-FIELDS                     13850099
W30677                 IF NOT PS-EDIT-ERROR                             13860099
W30677                     PERFORM 2000-GET-NEW-SKU-UPC                 13870099
W30677                 END-IF                                           13880099
W30677             END-IF                                               13890099
W30677         ELSE                                                     13900099
W30677             IF SKUL = ZERO                                       13910099
W30677                 IF CA-UPC-NUMBER-X > SPACES                      13920099
W30677                     PERFORM 2600-EDIT-UPC-FIELDS                 13930099
W30677                     IF NOT PS-EDIT-ERROR                         13940099
W30677                         PERFORM 2500-VALIDATE-UPC-NBR            13950099
W30677                     END-IF                                       13960099
W30677                 ELSE                                             13970099
W30677                     PERFORM 2700-EDIT-SKU-FIELDS                 13980099
W30677                     IF NOT PS-EDIT-ERROR                         13990099
W30677                         PERFORM 2000-GET-NEW-SKU-UPC             14000099
W30677                     END-IF                                       14010099
W30677                 END-IF                                           14020099
W43143*                IF NOT PS-EDIT-ERROR                             14030099
W43143*                    PERFORM 2000-FKEY-PROCESSING                 14040099
W43143*                END-IF                                           14050099
W30677             END-IF                                               14060099
W30677         END-IF                                                   14070099
W30677     END-IF.                                                      14080099
      ******************************************************************14090019
       2000-FKEY-PROCESSING.                                            14100001
           MOVE '*2000-FKEY-PROCESSING.           *' TO DP013-PARAGRAPH 14110001
                                                                        14120001
           SET PS-NO-EDIT-ERROR TO TRUE                                 14130099
                                                                        14140099
           EVALUATE TRUE                                                14150001
               WHEN DP020-SRC-AID = DP016-ENTER                         14160001
W30677             IF CA-SKU-LEVEL-IND EQUAL SPACES                     14170099
W30677                 MOVE LOW-VALUES TO FS032AI                       14180099
W30677                 PERFORM 2300-FORMAT-OUTPUT-MAP                   14190099
W30677             ELSE                                                 14200099
W30677                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14210099
W30677                 MOVE -1                     TO SKUL              14220099
W30677             END-IF                                               14230099
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14240001
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14250001
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14260001
                   PERFORM 5000-PAGING                                  14270001
               WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               14280001
               WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               14290001
               WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               14300001
               WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               14310001
                   PERFORM 6000-GET-NEXT-DATA-GROUPING                  14320001
               WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               14330001
                   PERFORM 7000-DISPLAY-ALTERNATE-FIELDS                14340001
               WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               14350001
                   IF (CA-DEPT-NUMBER-X  > SPACES  AND                  14360001
                       CA-CLASS-NUMBER-X > SPACES  AND                  14370001
MK                     CA-SKU-NUMBER-X   > SPACES) AND                  14380016
                      (CA-STORE-NUMBER-X = '00000')                     14390074
                      INITIALIZE DCLTSK                                 14400001
MK                    MOVE CA-SKU-NUMBER-9 TO NI-SKU-9-8                14410012
                      PERFORM 9505-SELECT-SINGLE-SKU                    14420001
                      IF TSK-REGN-PRIC-IND = 'Y'                        14430001
                         MOVE TSK-ITEM-NMBR TO CA-ITEM-NUMBER           14440001
                         MOVE TSK-SKU-DESC  TO CA-SKU-DESCRIPTION       14450001
                      ELSE                                              14460001
                         SET PS-EDIT-ERROR TO TRUE                      14470001
                         MOVE PC-TSYMSG-02060 TO DP020-MSG-NUMBER       14480001
                         SET DP020-MSG-INFORMATIONAL TO TRUE            14490001
                      END-IF                                            14500001
                   ELSE                                                 14510001
                      SET PS-EDIT-ERROR TO TRUE                         14520001
                      MOVE PC-TSYMSG-02060 TO DP020-MSG-NUMBER          14530001
                      SET DP020-MSG-INFORMATIONAL TO TRUE               14540001
                   END-IF                                               14550001
W43143         WHEN DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)               14560099
W43143            IF (STOREO > SPACES AND                               14570099
W43143               STOREO NOT = '00000')                              14580099
W43143              MOVE STOREO   TO FS009-STORE-NUMBER-X               14590099
W43143              MOVE SKUO     TO FS009-SKU-NUMBER-X                 14600099
W43143              MOVE STRDSCO  TO FS009-STORE-NAME                   14610099
W43143              SET FS009-DISPLAY-STR-EXPT TO TRUE                  14620099
W43143            ELSE                                                  14630099
W43143               SET PS-EDIT-ERROR TO TRUE                          14640099
W43143*-->           STORE NUMBER IS REQUIRED FOR THE FUNCTION REQUIRED 14650099
W43143               MOVE PC-TSYMSG-00507 TO DP020-MSG-NUMBER           14660099
W43143               SET DP020-MSG-INFORMATIONAL TO TRUE                14670099
W43143             END-IF                                               14680099
           END-EVALUATE.                                                14690001
                                                                        14700001
           IF  PS-NO-EDIT-ERROR                                         14710001
               SET DP030-CONTINUE-GO TO TRUE                            14720001
           ELSE                                                         14730001
               SET DP030-OVERRIDE-GO TO TRUE.                           14740001
                                                                        14750001
           EJECT                                                        14760001
      ******************************************************************14770001
      *  INITIALIZE SCREEN FIELDS AND THE COMM AREA FOR PROCESSING.    *14780001
      *  SEND THE MAP AND THE INITIAL DATA.  THIS PARAGRAPH WILL ONLY  *14790001
      *  BE PERFORMED WHEN GOOD SELECTION CRITERIA HAVE BEEN RECEIVED  *14800001
      *  FROM EITHER FSKCS034 (THE FIRST TIME IN) OR FROM FSKCS033.    *14810001
      ******************************************************************14820001
       2000-INITIALIZE.                                                 14830001
           MOVE '*2000-INITIALIZE.                *' TO DP013-PARAGRAPH 14840001
                                                                        14850001
           IF DP020-NEXT-ACT-INITIAL OR                                 14860001
              DP020-NEXT-ACT-RETURN                                     14870001
               INITIALIZE CA-FSKCS034-CRITERIA-DATA                     14880001
               PERFORM 9200-READ-CRITERIA-QUEUE                         14890001
               INITIALIZE CA-FSKCS033-DATA                              14900001
               INITIALIZE CA-THIS-SKUS-MISC-DATA                        14910001
           END-IF.                                                      14920001
                                                                        14930001
           INITIALIZE CA-FSKCS032-DATA                                  14940001
                                                                        14950001
      * THE INFORMATION WILL BE DISPLAYED IN UNITS AS OPPOSED TO DOLLARS14960001
      * FOR EACH INITIAL PASS FOR NEW SELECTION CRITERIA.               14970001
                                                                        14980001
           SET CA-DISPLAY-UNITS TO TRUE                                 14990001
                                                                        15000001
           MOVE LOW-VALUES TO FS032AI.                                  15010001
                                                                        15020001
W30677     IF DP020-NEXT-ACT-INITIAL OR                                 15030099
W30677         DP020-NEXT-ACT-RETURN                                    15040099
W30677         IF CA-SKU-NUMBER-X > SPACES                              15050099
W30677             MOVE DP015-UNP-ALP-NOR-OFF  TO SKUA                  15060099
W30677             MOVE DP015-GREEN            TO SKUC                  15070099
W30677             MOVE DP015-UNDERLINE        TO SKUH                  15080099
W30677             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15090099
W30677             MOVE -1                     TO SKUL                  15100099
W30677             MOVE 'X' TO CA-SKU-LEVEL-IND                         15110099
W30677         ELSE                                                     15120099
W30677             MOVE SPACES TO CA-SKU-LEVEL-IND                      15130099
W30677         END-IF                                                   15140099
W30677     END-IF.                                                      15150099
                                                                        15160099
      * THIS WILL PERFORM THE DB2 CALLS WHICH GATHER ALL THE INFORMA-   15170099
      * TION NEEDED TO PROCESS THIS SALES INQUIRY.                      15180099
           PERFORM 2200-RETRIEVE-SALES-DATA                             15190001
           PERFORM 2100-MOVE-SELECTION-TO-MAP                           15200099
                                                                        15210001
      * MOVES THE SALES INFORMATION FROM THE COMMAREA (WHERE IT IS      15220001
      * STORED) TO THE MAP AREA.                                        15230001
           PERFORM 2300-FORMAT-OUTPUT-MAP.                              15240001
                                                                        15250001
W30677******************************************************************15260099
W30677*  INITIALIZE SCREEN FIELDS AND THE COMM AREA FOR PROCESSING.    *15270099
W30677*  SEND THE MAP AND THE INITIAL DATA.  THIS PARAGRAPH WILL ONLY  *15280099
W30677*  BE PERFORMED WHEN GOOD SELECTION CRITERIA HAVE BEEN RECEIVED  *15290099
W30677*  FROM EITHER FSKCS034 (THE FIRST TIME IN) OR FROM FSKCS033.    *15300099
W30677******************************************************************15310099
W30677 2000-GET-NEW-SKU-UPC.                                            15320099
W30677     MOVE '*2000-GET-NEW-SKU-UPC.         *' TO DP013-PARAGRAPH   15330099
W30677* THE INFORMATION WILL BE DISPLAYED IN UNITS AS OPPOSED TO DOLLARS15340099
W30677* FOR EACH INITIAL PASS FOR NEW SELECTION CRITERIA.               15350099
W30677                                                                  15360099
W30677     INITIALIZE CA-FSKCS032-DATA.                                 15370099
W30677     SET CA-DISPLAY-UNITS TO TRUE.                                15380099
W30677     MOVE LOW-VALUES TO FS032AI.                                  15390099
W30677                                                                  15400099
W30677     PERFORM 2400-RESET-ATTRIBUTES.                               15410099
W30677     PERFORM 9505-SELECT-SINGLE-SKU.                              15420099
W30677     PERFORM 2200-RETRIEVE-SALES-DATA                             15430099
W30677     PERFORM 2100-MOVE-SELECTION-TO-MAP                           15440099
W30677                                                                  15450099
W30677* MOVES THE SALES INFORMATION FROM THE COMMAREA (WHERE IT IS      15460099
W30677* STORED) TO THE MAP AREA.                                        15470099
W30677     PERFORM 2300-FORMAT-OUTPUT-MAP.                              15480099
W30677                                                                  15490099
           EJECT                                                        15500001
                                                                        15510001
      ******************************************************************15520001
      *  THIS WILL MOVE THE MONTHLY SALES SELECTION DATA WHICH IS CON- *15530001
      *  TAINED IN THE COMMAREA TO THE OUTPUT MAP AREA. THE DATA MOVED *15540001
      *  TO THE MAP AREA WILL VARY DEPENDING UPON WHETHER UNITS ARE TO *15550001
      *  BE DISPLAYED OR DOLLARS.                                      *15560001
      ******************************************************************15570001
                                                                        15580001
       2100-MOVE-SELECTION-TO-MAP.                                      15590001
           MOVE '*2100-MOVE-SELECTION-TO-MAP.     *' TO DP013-PARAGRAPH 15600001
                                                                        15610001
      * DISPLAY THE PROPER SCREEN HEADER LITERAL VALUES                 15620001
           IF CA-DISPLAY-UNITS                                          15630001
               MOVE PC-UNIT-WKLY-HEADER TO WKLYTO                       15640001
      *        MOVE PC-MAP-BREAKLINE-UNITS TO BRKLINO                   15650092
           ELSE                                                         15660001
               MOVE PC-DOLLAR-WKLY-HEADER TO WKLYTO                     15670001
      *        MOVE PC-MAP-BREAKLINE-DLRS TO BRKLINO                    15680092
           END-IF.                                                      15690001
                                                                        15700001
           MOVE DP015-ASK-NOR-OFF TO STATTA.                            15710001
                                                                        15720001
      * DEPARTMENT NUMBER                                               15730001
           MOVE CA-DEPT-NUMBER-X TO DEPTO.                              15740001
           MOVE CA-DEPT-NAME TO SKUDSCO.                                15750001
                                                                        15760001
      * DEPENDING UPON THE SELECTION CRITERIA ENTERED, SOME PF KEYS ARE 15770001
      * NOT VALID OPTIONS AND SHOULD NOT EVEN BE DISPLAYED ON THE SCREEN15780001
      * ALSO, THE FIELDS AND FIELD LABELS ON THE UPPER HALF OF THE      15790001
      * SCREEN WILL VARY DEPENDING UPON WHICH SELECTION DATA FIELDS     15800001
      * WERE ENTERED.                                                   15810001
                                                                        15820001
      * CLASS NUMBER                                                    15830001
           IF CA-CLASS-NUMBER-X > SPACES                                15840001
               MOVE CA-CLASS-NUMBER-X TO CLASSO                         15850001
               MOVE CA-CLASS-DESCRIPTION TO SKUDSCO                     15860001
           END-IF.                                                      15870001
                                                                        15880001
      * DEPARTMENT, CLASS AND SKU NUMBERS                               15890016
           IF CA-SKU-NUMBER-X > SPACES                                  15900016
MK             MOVE CA-CLASS-NUMBER-X  TO CLASSO                        15910016
MK             MOVE CA-SKU-NUMBER-X    TO SKUO                          15920016
               MOVE CA-SKU-DESCRIPTION TO SKUDSCO                       15930001
               MOVE CA-TSK-SIZE        TO SIZEO                         15940001
               MOVE CA-TSK-COLOR       TO COLORO                        15950001
               MOVE CA-TSK-ORG-RTL     TO PV-ORG-RTL-9                  15960001
               MOVE PV-ORG-RTL-X       TO ORGRTLO                       15970001
                                                                        15980001
                                                                        15990001
               IF CA-TSK-CUR-RTL IS NUMERIC                             16000001
                  MOVE CA-TSK-CUR-RTL     TO PV-CUR-RTL-9               16010001
                  MOVE PV-CUR-RTL-X       TO CURRTLO                    16020001
               ELSE                                                     16030001
                  MOVE CA-TSK-CUR-RTL-X   TO CURRTLO                    16040001
               END-IF                                                   16050001
                                                                        16060001
               MOVE CA-TSK-COST        TO PV-COST-9                     16070001
               MOVE PV-COST-X          TO COSTO                         16080001
               MOVE CA-TSK-GP-QTY-RTL  TO GPRTLO                        16090001
               MOVE DP015-ASK-NOR-OFF  TO COLORTA                       16100001
                                          ORRTLTA                       16110001
                                          CRRTLTA                       16120001
                                          COSTTA                        16130001
                                          STATTA                        16140001
                                          STROHTA                       16150088
                                          INTRATA                       16160001
           ELSE                                                         16170001
               MOVE DP015-ASK-DRK-OFF TO SKUTA                          16180044
                                         ORRTLTA                        16190001
                                         CRRTLTA                        16200001
                                         COSTTA                         16210001
                                         STROHTA                        16220088
                                         INTRATA                        16230001
W30677         MOVE DP015-PRO-DRK-OFF TO SKUA                           16240099
               IF CA-COLOR-1-X      = SPACES AND                        16250001
                  CA-COLOR-2-X      = SPACES AND                        16260001
                  CA-TSK-LONG-COLOR = SPACES                            16270001
W30677            MOVE PC-ALL-COLS  TO COLORO                           16280099
               ELSE                                                     16290001
                  IF CA-TSK-LONG-COLOR = SPACES                         16300001
W30677               MOVE CA-COLOR-DESC     TO COLORO                   16310099
                  ELSE                                                  16320099
W30677               MOVE CA-TSK-LONG-COLOR TO COLORO                   16330099
                  END-IF                                                16340001
               END-IF                                                   16350001
               IF CA-SIZE-DESC = SPACES                                 16360001
                 MOVE PC-ALL-SIZES    TO SIZEO                          16370001
               ELSE                                                     16380001
                 MOVE CA-SIZE-DESC    TO SIZEO                          16390001
               END-IF                                                   16400001
               IF CA-VSM-REPLENISH = SPACES                             16410001
                  MOVE DP015-ASK-DRK-OFF TO RPLTA                       16420001
               ELSE                                                     16430001
                  MOVE CA-VSM-REPLENISH  TO RPLO                        16440001
               END-IF                                                   16450001
           END-IF.                                                      16460001
                                                                        16470001
W30677     IF CA-UPC-NUMBER-X > SPACES                                  16480099
W30677         IF DP020-NEXT-ACT-INITIAL                                16490099
W30677            OR DP020-NEXT-ACT-RETURN                              16500099
W30677            MOVE CA-UPC-NUMBER-X TO SKUO                          16510099
W30677         END-IF                                                   16520099
W30677     END-IF.                                                      16530099
W30677                                                                  16540099
      * STORE / DISTRICT                                                16550001
                                                                        16560001
      *    STORE NUMBER                                                 16570001
           IF CA-STORE-NUMBER-X > SPACES                                16580001
KP1105         MOVE 'STR:'            TO STORETO                        16590099
               MOVE CA-STORE-NUMBER-X TO STOREO                         16600001
               MOVE DP015-ASK-NOR-OFF TO STORETA                        16610001
               IF CA-STORE-NUMBER-X = '00000'                           16620074
                   MOVE PC-CORPORATE-LITERAL TO STRDSCO                 16630001
               ELSE                                                     16640001
MK                 MOVE CA-STORE-SHORT-NAME  TO STRDSCO                 16650012
               END-IF                                                   16660001
           ELSE                                                         16670001
               MOVE '00000'                  TO CA-STORE-NUMBER-X       16680074
               MOVE PC-CORPORATE-LITERAL     TO STRDSCO                 16690001
KP1105         MOVE 'STR:'                   TO STORETO                 16700099
           END-IF.                                                      16710001
                                                                        16720001
      *    DISTRICT NUMBER                                              16730001
           IF CA-DISTRICT-NUMBER > SPACES                               16740001
              MOVE 'DISTR:'                 TO STORETO                  16750001
MK            MOVE SPACES                TO CA-STORE-NUMBER-X           16760012
              MOVE CA-DISTRICT-NUMBER    TO STOREO                      16770001
              MOVE DP015-ASK-NOR-OFF     TO STORETA                     16780001
MK            MOVE SPACES                TO STRDSCO                     16790005
           END-IF.                                                      16800001
                                                                        16810001
      * ROLLUP COLOR FAMILY                                             16820001
                                                                        16830001
      * STATUS                                                          16840001
           IF (CA-DEPT-NUMBER-X  > SPACES  AND                          16850001
               CA-CLASS-NUMBER-X > SPACES  AND                          16860001
MK             CA-SKU-NUMBER-X   > SPACES)                              16870016
      *-->       FULLY QUALIFIED SKU, SO DISPLAY IT'S ACTUAL STATUS     16880001
                 MOVE CA-STATUS-X  TO  STAT1O                           16890001
                 MOVE SPACES       TO  STAT2O                           16900001
                                       STAT3O                           16910001
                                       STAT4O                           16920001
                                       STAT5O                           16930001
           ELSE                                                         16940001
               PERFORM 2110-LOAD-CRITERIA-STATUS                        16950001
           END-IF.                                                      16960001
                                                                        16970001
      * VENDOR NUMBER                                                   16980001
           IF CA-INHOUSE-NUMBER > SPACES                                16990001
               MOVE CA-INHOUSE-NUMBER TO VNDRNOO                        17000001
               MOVE DP015-ASK-NOR-OFF TO VENDRTA                        17010001
               MOVE CA-VENDOR-NAME    TO VNDDSCO                        17020001
           ELSE                                                         17030001
               MOVE DP015-ASK-DRK-OFF TO VENDRTA                        17040001
           END-IF.                                                      17050001
                                                                        17060001
      * STYLE                                                           17070001
           IF CA-STYLE > SPACES                                         17080001
               MOVE CA-STYLE TO STYLEO                                  17090001
               MOVE DP015-ASK-NOR-OFF TO STYLETA                        17100001
           ELSE                                                         17110001
               MOVE DP015-ASK-DRK-OFF TO STYLETA                        17120001
           END-IF.                                                      17130001
                                                                        17140001
                                                                        17150001
      * GROUP CODE                                                      17160001
           IF CA-GROUP-CODE > SPACES                                    17170001
               MOVE CA-GROUP-CODE TO GROUPO                             17180001
               MOVE DP015-ASK-NOR-OFF TO GROUPTA                        17190001
           ELSE                                                         17200001
               MOVE DP015-ASK-DRK-OFF TO GROUPTA                        17210001
           END-IF.                                                      17220001
           EJECT                                                        17230001
                                                                        17240001
      ******************************************************************17250019
       2110-LOAD-CRITERIA-STATUS.                                       17260001
                                                                        17270001
      * NOTE:  WHEN STATUS '25' IS ENTERED, NO OTHER STATUSES MUST BE   17280001
      *        ENTERED.                                                 17290001
                                                                        17300001
           MOVE SPACES TO PV-STATUS-LITERALS-TABLE.                     17310001
           SET PV-STATUS-INDEX TO 1.                                    17320001
                                                                        17330001
           IF CA-STAT-10-ENTERED                                        17340001
MK             MOVE PC-STATUS-10 TO PV-STATUS-LITERAL-X                 17350012
                                            (PV-STATUS-INDEX)           17360001
               SET PV-STATUS-INDEX UP BY 1                              17370001
           ELSE                                                         17380001
              IF CA-STAT-25-ENTERED                                     17390001
MK               MOVE PC-STATUS-25 TO PV-STATUS-LITERAL-X               17400012
                                            (PV-STATUS-INDEX)           17410001
                 SET PV-STATUS-INDEX UP BY 1                            17420001
              END-IF                                                    17430001
           END-IF.                                                      17440001
                                                                        17450001
           IF CA-STAT-20-ENTERED                                        17460001
               MOVE PC-STATUS-20 TO                                     17470006
MK                             PV-STATUS-LITERAL-X (PV-STATUS-INDEX)    17480012
               SET PV-STATUS-INDEX UP BY 1                              17490001
           END-IF.                                                      17500001
                                                                        17510001
           IF CA-STAT-30-ENTERED                                        17520001
               MOVE PC-STATUS-30 TO                                     17530006
MK                             PV-STATUS-LITERAL-X (PV-STATUS-INDEX)    17540012
               SET PV-STATUS-INDEX UP BY 1                              17550001
           END-IF.                                                      17560001
                                                                        17570001
           IF CA-STAT-40-ENTERED                                        17580001
               MOVE PC-STATUS-40 TO                                     17590006
MK                             PV-STATUS-LITERAL-X (PV-STATUS-INDEX)    17600012
               SET PV-STATUS-INDEX UP BY 1                              17610001
           END-IF.                                                      17620001
                                                                        17630001
           IF CA-STAT-90-ENTERED                                        17640001
               MOVE PC-STATUS-90 TO                                     17650006
MK                             PV-STATUS-LITERAL-X (PV-STATUS-INDEX)    17660012
               SET PV-STATUS-INDEX UP BY 1                              17670001
           END-IF.                                                      17680001
                                                                        17690001
           SET PV-STATUS-INDEX TO 1.                                    17700001
                                                                        17710001
      * STATUS SELECTIONS ARE NOT VALID WITH THE ENTRY OF A FULL        17720018
      * SKU NUMBER AND WILL NOT BE DISPLAYED ON THE SCREEN.             17730018
                                                                        17740001
           MOVE PV-STATUS-LITERAL-X (PV-STATUS-INDEX) TO STAT1O         17750001
           SET PV-STATUS-INDEX UP BY 1                                  17760001
           MOVE PV-STATUS-LITERAL-X (PV-STATUS-INDEX) TO STAT2O         17770001
           SET PV-STATUS-INDEX UP BY 1                                  17780001
           MOVE PV-STATUS-LITERAL-X (PV-STATUS-INDEX) TO STAT3O         17790001
           SET PV-STATUS-INDEX UP BY 1                                  17800001
           MOVE PV-STATUS-LITERAL-X (PV-STATUS-INDEX) TO STAT4O         17810001
           SET PV-STATUS-INDEX UP BY 1                                  17820001
           MOVE PV-STATUS-LITERAL-X (PV-STATUS-INDEX) TO STAT5O.        17830001
                                                                        17840001
           EJECT                                                        17850001
                                                                        17860001
      ******************************************************************17870001
      * THIS PARAGRAPH WILL TAKE THE SELECTION CRITERIA STORED IN THE  *17880001
      * COMMAREA AND ATTEMPT TO GET ALL THE INFORMATION REQUIRED TO    *17890001
      * DISPLAY THE MONTHLY SALES INFORMATION ON THE SCREEN - THE MAP  *17900001
      * FIELDS WILL THEN BE FILLED FROM THE COMMAREA ACCUMULATOR FIELDS*17910001
      ******************************************************************17920001
                                                                        17930001
       2200-RETRIEVE-SALES-DATA.                                        17940001
           MOVE '*2200-RETRIEVE-SALES-DATA.       *' TO DP013-PARAGRAPH 17950001
                                                                        17960001
           SET PS-NO-EDIT-ERROR       TO TRUE                           17970001
                                                                        17980001
      * GIVEN TODAY'S DATE AND THE FROM/TO DATES ENTERED ON THE SCREEN, 17990001
      * CALCULATE THE DATES NEEDED FOR THE DB2 CURSORS AND THE SCREEN   18000001
      * DISPLAYS.                                                       18010001
           PERFORM 2210-FIGURE-WEEK-MONTH-DATES.                        18020001
      ************ TEST *********************************               18030001
               MOVE ZEROES               TO CSTOCKO                     18040001
               MOVE ZEROES               TO OUTLMTO                     18050001
               MOVE ZEROES               TO ORDRPTO                     18060001
                                                                        18070001
      * IF A FULL SKU NUMBER WAS ENTERED, THEN ONLY ONE SKU             18080018
      * WILL BE PROCESSED - OTHERWISE SET UP THE SKU CURSOR AND PROCESS 18090001
      * EACH SKU FOUND WITHIN THAT CURSOR                               18100001
           IF (CA-DEPT-NUMBER-X > SPACES                                18110001
                      AND                                               18120001
              CA-CLASS-NUMBER-X > SPACES                                18130001
                      AND                                               18140001
MK            CA-SKU-NUMBER-X > SPACES)                                 18150016
               PERFORM 2230-ONE-SKU-REQUEST                             18160001
           ELSE                                                         18170001
               SET PS-MORE-SKUS TO TRUE                                 18180001
               SET PS-NO-SKUS-FOUND TO TRUE                             18190001
               PERFORM 2260-FILL-CURSOR-CRITERIA                        18200001
                                                                        18210001
      *    --- USE CURSOR 1 IF THE DEPARTMENT HASN'T BEEN CONVERTED --- 18220001
      *    --- TO VSM OR THE REPLENISHMENT FIELD WAS NOT FILLED IN  --- 18230001
      *    --- ON THE CRITERIA SCREEN.                              --- 18240001
                                                                        18250001
      *    --- REMOVED CSR-1 PROCESSING       MHB (7/2001)          --- 18260001
      *    --- ALL DEPARTMENTS ARE NOW VSM                          --- 18270001
               PERFORM 9512-OPEN-SKU-CSR-2                              18280001
                                                                        18290001
               PERFORM 2280-MULTIPLE-SKU-REQUEST                        18300001
                   UNTIL PS-NO-MORE-SKUS                                18310001
                                                                        18320001
               PERFORM 9522-CLOSE-SKU-CSR-2                             18330001
           END-IF.                                                      18340001
                                                                        18350001
           EJECT                                                        18360001
                                                                        18370001
      ******************************************************************18380001
      * GIVEN TODAY'S DATE, CALCULATE THE FIRST WEEKDAY DATES FOR THIS  18390001
      * WEEK AND THE PREVIOUS 4 WEEKS - TO BE USED AS PART OF THE KEY IN18400001
      * RETRIEVING INFORMATION FROM THE TSKSTWKS AND TSKSTWKI TABLES.   18410001
      * ALSO CALCULATE THE DISPLAY AND TSKSTMTH TABLE DATES WHICH FALL  18420001
      * WITHIN THE RANGE OF FROM/TO MONTH DATES ENTERED AS SELECTION    18430001
      * CRITERIA.                                                       18440001
      ******************************************************************18450001
                                                                        18460001
       2210-FIGURE-WEEK-MONTH-DATES.                                    18470001
           MOVE '*2210-FIGURE-WEEK-MONTH-DATES.   *' TO DP013-PARAGRAPH 18480001
                                                                        18490001
      * PV-WKLY-DATE-KEYS CONTAINS THE ACTUAL WEEKLY DATA FORMATS       18500001
      * REQUIRED FOR THE DB2 WEEKLY INFORMATION CURSORS                 18510001
           MOVE SPACES TO PV-WKLY-DATE-KEYS.                            18520001
                                                                        18530001
      * THIS WILL USE THE STANDARD SYSTEM ROUTINE TO FIND THE CURRENT   18540001
      * FIRST WEEKDAY DATE, GIVEN TODAYS DATE.  THIS WEEK'S FIRST       18550001
      * WEEKDAY DATE WILL BE PLACED IN THE FIRST ENTRY OF THE 4         18560001
      * ENTRY WEEKLY DATE TABLE (THIS TABLE CONTAINS THIS WEEK AND THE  18570001
      * PREVIOUS 3 WEEKS)                                               18580001
           MOVE EIBDATE TO PV-TODAYS-DATE.                              18590001
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              18600001
           SET DPG51-FISCAL-JAN-DEC-F2                                  18610001
               DPG51-DO-NOT-INCR-DECR-DATE                              18620001
               DPG52-LK-DTE-GREG        TO TRUE.                        18630001
           MOVE PC-SYSTEM-DATE TO DPG52-GREG-DATE-N.                    18640001
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          18650001
                                                   DPG53 DPG54          18660001
                                                   DPG55 DPG56.         18670001
           MOVE DPG55-1ST-WKDY-DB2ISO-FMT TO PV-WKLY-BOW-DATE(1).       18680001
           MOVE DPG55-1ST-WKDY-GREG-FMT TO                              18690001
                                     CA-WKLY-CAL-DATE (1).              18700001
                                                                        18710001
      * BY WORKING FROM THE WEEKLY DATE IN THE FIRST ENTRY, FIGURE THE  18720001
      * PREVIOUS 3 WEEKS DATE VALUES AND PLACE THEM IN THE 3 REMAINING  18730001
      * TABLE ENTRIES.                                                  18740001
      * CALCULATE THE DISPLAY DATE FORMAT (MMDDYY) FOR THE MAP. THIS    18750001
      * (MMDDYY) DATE WILL ALWAYS BE THE FIRST DAY OF THE WEEK.         18760001
                                                                        18770001
           MOVE 2 TO PV-SUB.                                            18780001
           PERFORM VARYING PV-WEEKLY-INDEX                              18790001
             FROM 2 BY 1                                                18800001
               UNTIL PV-WEEKLY-INDEX > PC-MAX-NUM-WEEKS                 18810001
                 SET DPG51-FISCAL-JAN-DEC-F2                            18820001
                     DPG51-DECREMENT-DATE                               18830001
                     DPG52-LK-DTE-GREG        TO TRUE                   18840001
                 MOVE 7 TO DPG51-INCR-DECR-DAYS-9                       18850001
                 MOVE DPG55-1ST-WKDY-GREG-N TO DPG52-GREG-DATE-N        18860001
                 CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52    18870001
                                                         DPG53 DPG54    18880001
                                                         DPG55 DPG56    18890001
                 MOVE DPG55-1ST-WKDY-DB2ISO-FMT TO                      18900001
                                     PV-WKLY-BOW-DATE(PV-WEEKLY-INDEX)  18910001
                 MOVE DPG55-1ST-WKDY-GREG-FMT TO                        18920001
                                     CA-WKLY-CAL-DATE (PV-SUB)          18930001
                 ADD 1 TO PV-SUB                                        18940001
           END-PERFORM.                                                 18950001
                                                                        18960001
      * FILL THE FIELDS USED IN THE DB2 WEEKLY CURSORS WITH THE FIRST   18970001
      * AND LAST BOW DATES TO BE INCLUDED IN THE SELECTIONS.            18980001
                                                                        18990001
           MOVE PV-WKLY-BOW-DATE (1) TO PV-DB2-TO-BOW-DATE.             19000001
           MOVE PV-WKLY-BOW-DATE (4) TO PV-DB2-FROM-BOW-DATE.           19010001
                                                                        19020001
      * FOR THE FIRST WEEK DISPLAYED ON THE OUTPUT MAP, THE LITERAL     19030001
      * 'WTD' WILL BE DISPLAYED INSTEAD OF THE ACTUAL DATE.             19040001
           MOVE PC-WTD-LITERAL TO CA-WKLY-CAL-DATE (1).                 19050001
                                                                        19060001
           EJECT                                                        19070001
      ******************************************************************19080001
      *  THIS PARAGRAPH WILL PROCESS THE SINGLE SKU IDENTIFIED IN THE   19090001
      *  COMMAREA.                                                      19100001
      ******************************************************************19110001
                                                                        19120001
       2230-ONE-SKU-REQUEST.                                            19130001
           MOVE '*2230-ONE-SKU-REQUEST.           *' TO DP013-PARAGRAPH 19140001
                                                                        19150001
           IF CA-DP020-FORMAT-IND = '1' AND                             19160001
              DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)                     19170001
      *-->     WE'VE ALREADY GOTTEN THE NEXT SKU FROM THE LIST QUEUE    19180001
               IF TSK-REGN-PRIC-IND = 'Y'                               19190001
                  PERFORM 9010-PROCESS-RCP-SKU-AT-A-TIME                19200001
               ELSE                                                     19210001
                  PERFORM 9000-PROCESS-SKU-AT-A-TIME                    19220001
               END-IF                                                   19230001
           ELSE                                                         19240001
MK             MOVE CA-SKU-NUMBER-9 TO NI-SKU-9-8                       19250012
               PERFORM 9505-SELECT-SINGLE-SKU                           19260001
               IF SQLCODE NOT EQUAL ZERO                                19270001
                   CONTINUE                                             19280001
               ELSE                                                     19290001
                   PERFORM 6100-MOVE-TSK-TO-COMMAREA                    19300001
                   IF TSK-REGN-PRIC-IND = 'Y'                           19310001
                      PERFORM 9010-PROCESS-RCP-SKU-AT-A-TIME            19320001
                   ELSE                                                 19330001
                      PERFORM 9000-PROCESS-SKU-AT-A-TIME                19340001
                   END-IF                                               19350001
               END-IF                                                   19360001
                                                                        19370001
           END-IF.                                                      19380001
                                                                        19390001
           EJECT                                                        19400001
                                                                        19410001
      ******************************************************************19420001
      *  THIS PARAGRAPH WILL FILL IN THE VALUES OF THE FIELDS CONTAINED 19430001
      *  IN THE MULTIPLE SKUS CURSOR DEFINITION. IF NO SELECTION DATA   19440001
      *  WAS ENTERED FOR A PARTICULAR CURSOR DECLARATION FIELD, THEN    19450001
      *  THOSE FIELDS WILL BE FILLED WITH THE LOWEST AND HIGHEST POSS-  19460001
      *  IBLE VALUES SO THAT THE 'BETWEEN' IN THE CURSOR DECLARATION    19470001
      *  WILL RETRIEVE ALL POSSIBLE VALUES.                             19480001
      ******************************************************************19490001
                                                                        19500001
       2260-FILL-CURSOR-CRITERIA.                                       19510001
           MOVE '*2260-FILL-CURSOR-CRITERIA.      *' TO DP013-PARAGRAPH 19520001
                                                                        19530001
MK         MOVE CA-DEPT-NUMBER-9 TO NI-DEPT-9-4.                        19540012
                                                                        19550009
           IF (CA-MAJOR-CLASS > SPACES                                  19560001
                  AND                                                   19570001
              CA-MINOR-CLASS > SPACES)                                  19580001
MK             MOVE CA-CLASS-NUMBER-9  TO PV-CLASS-LOW-C3               19590008
MK                                        PV-CLASS-HIGH-C3              19600008
           ELSE                                                         19610001
               IF CA-MAJOR-CLASS > SPACES                               19620001
                   MOVE CA-MAJOR-CLASS TO PV-CLASS-LOW                  19630001
                                          PV-CLASS-HIGH                 19640001
                   MOVE PC-LITERAL-0   TO PV-CLASS-LOW-POS-2            19650001
                   MOVE PC-LITERAL-9   TO PV-CLASS-HIGH-POS-2           19660001
MK                 MOVE PV-CLASS-LOW   TO PV-CLASS-LOW-C3               19670008
MK                 MOVE PV-CLASS-HIGH  TO PV-CLASS-HIGH-C3              19680008
               ELSE                                                     19690001
MK                 MOVE PC-MIN-CLASS   TO PV-CLASS-LOW-C3               19700008
MK                 MOVE PC-MAX-CLASS   TO PV-CLASS-HIGH-C3              19710008
               END-IF                                                   19720001
           END-IF.                                                      19730001
                                                                        19740001
           INITIALIZE PV-STATUS-CODES.                                  19750001
           IF CA-STAT-10-ENTERED                                        19760001
               MOVE PC-STATUS-10 TO PV-STATUS-1                         19770001
           END-IF.                                                      19780001
           IF CA-STAT-20-ENTERED                                        19790001
               MOVE PC-STATUS-20 TO PV-STATUS-2                         19800001
           END-IF.                                                      19810001
           IF CA-STAT-30-ENTERED                                        19820001
               MOVE PC-STATUS-30 TO PV-STATUS-3                         19830001
           END-IF.                                                      19840001
           IF CA-STAT-40-ENTERED                                        19850001
               MOVE PC-STATUS-40 TO PV-STATUS-4                         19860001
           END-IF.                                                      19870001
           IF CA-STAT-90-ENTERED                                        19880001
               MOVE PC-STATUS-90 TO PV-STATUS-5                         19890001
           END-IF.                                                      19900001
           IF CA-STAT-20-ENTERED OR                                     19910001
              CA-STAT-25-ENTERED OR                                     19920001
              CA-STAT-30-ENTERED                                        19930001
               MOVE PC-STATUS-25 TO PV-STATUS-6                         19940001
           END-IF.                                                      19950001
                                                                        19960001
           IF CA-GROUP-CODE > SPACES                                    19970001
               MOVE CA-GROUP-CODE TO PV-GROUP-LOW                       19980001
                                     PV-GROUP-HIGH                      19990001
           ELSE                                                         20000001
               MOVE PC-LOW-VALUES TO PV-GROUP-LOW                       20010001
               MOVE PC-HIGH-VALUES TO PV-GROUP-HIGH                     20020001
           END-IF.                                                      20030001
                                                                        20040001
           IF CA-STYLE > SPACES                                         20050099
0518           MOVE CA-STYLE       TO PV-VND-STYL-LO                    20060099
0518                                  PV-VND-STYL-HI                    20070099
0518                                  PV-LNG-STYL-LO                    20080099
0518                                  PV-LNG-STYL-HI                    20090099
0518  *        MOVE CA-STYLE TO PV-STYLE-LOW                            20100099
0518  *                         PV-STYLE-HIGH                           20110099
           ELSE                                                         20120001
0518           MOVE PC-LOW-VALUES  TO PV-VND-STYL-LO                    20130099
0518                                  PV-LNG-STYL-LO                    20140099
0518           MOVE PC-HIGH-VALUES TO PV-VND-STYL-HI                    20150099
0518                                  PV-LNG-STYL-HI                    20160099
0518  *        MOVE PC-LOW-VALUES TO PV-STYLE-LOW                       20170099
0518  *        MOVE PC-HIGH-VALUES TO PV-STYLE-HIGH                     20180099
           END-IF.                                                      20190001
                                                                        20200001
           IF CA-VSM-REPLENISH = 'Y' OR                                 20210001
              CA-VSM-REPLENISH = 'N'                                    20220001
               MOVE CA-VSM-REPLENISH       TO PV-REPLEN-LOW             20230001
                                              PV-REPLEN-HIGH            20240001
               SET PS-REPLENISH-FILLED     TO TRUE                      20250001
           ELSE                                                         20260001
               MOVE LOW-VALUES             TO PV-REPLEN-LOW             20270001
               MOVE HIGH-VALUES            TO PV-REPLEN-HIGH            20280001
               SET PS-REPLENISH-NOT-FILLED TO TRUE                      20290001
           END-IF.                                                      20300001
                                                                        20310001
           IF CA-KEY-ITEM  = 'Y'                                        20320001
               MOVE CA-KEY-ITEM TO PV-KYITM-LOW                         20330001
                                   PV-KYITM-HIGH                        20340001
           ELSE                                                         20350001
              IF CA-KEY-ITEM  = 'N'                                     20360001
                  MOVE SPACE       TO PV-KYITM-LOW                      20370001
                  MOVE CA-KEY-ITEM TO PV-KYITM-HIGH                     20380001
              ELSE                                                      20390001
                  MOVE PC-LOW-VALUES TO PV-KYITM-LOW                    20400001
                  MOVE PC-HIGH-VALUES TO PV-KYITM-HIGH                  20410001
              END-IF.                                                   20420001
                                                                        20430001
           IF CA-TSK-LONG-COLOR = SPACES                                20440001
              MOVE PC-LOW-VALUES     TO PV-LONG-COLOR-LOW               20450001
              MOVE PC-HIGH-VALUES    TO PV-LONG-COLOR-HIGH              20460001
           ELSE                                                         20470001
              MOVE CA-TSK-LONG-COLOR TO PV-LONG-COLOR-LOW               20480001
                                        PV-LONG-COLOR-HIGH              20490001
           END-IF.                                                      20500001
                                                                        20510001
           IF CA-COLOR-1-X = SPACES                                     20520001
              MOVE PC-LOW-VALUES TO PV-COLOR-LOW                        20530001
              MOVE PC-HIGH-VALUES TO PV-COLOR-HIGH                      20540001
           ELSE                                                         20550001
              MOVE CA-COLOR-1-X TO PV-COLOR-LOW                         20560001
              IF CA-COLOR-2-X = SPACES                                  20570001
                 MOVE CA-COLOR-1-X TO PV-COLOR-HIGH                     20580001
              ELSE                                                      20590001
                 MOVE CA-COLOR-2-X TO PV-COLOR-HIGH.                    20600001
                                                                        20610001
           IF CA-SIZE-CDE > SPACES                                      20620001
              MOVE CA-SIZE-CDE TO PV-SIZE-LOW                           20630001
                                  PV-SIZE-HIGH                          20640001
           ELSE                                                         20650001
              MOVE PC-LOW-VALUES TO PV-SIZE-LOW                         20660001
              MOVE PC-HIGH-VALUES TO PV-SIZE-HIGH.                      20670001
                                                                        20680001
           IF CA-INHOUSE-NUMBER > SPACES                                20690001
               MOVE CA-INHOUSE-NUMBER-9 TO PV-VENDOR-LOW                20700001
                                           PV-VENDOR-HIGH               20710001
           ELSE                                                         20720001
               MOVE PC-VENDOR-LOW TO PV-VENDOR-LOW                      20730001
               MOVE PC-VENDOR-HIGH TO PV-VENDOR-HIGH                    20740001
           END-IF.                                                      20750001
                                                                        20760001
           EJECT                                                        20770001
                                                                        20780001
      ******************************************************************20790001
      *  THIS PARAGRAPH WILL PROCESS THE SKUS FETCHED FROM THE SKU      20800001
      *  CURSOR. THIS PARAGRAPH WILL ONLY BE PERFORMED WHEN A FULL      20810018
      *  SKU NUMBER HAS NOT BEEN ENTERED. AN ERROR MESSAGE WILL         20820018
      *  BE RETURNED TO THE USER IF NO SKUS AT ALL ARE FOUND WITHIN     20830001
      *  THE SELECTION CRITERIA ENTERED.                                20840001
      *  NOTE:  ADDED CODE FOR REGIONAL CLEARANCE PRICED SKUS.          20850001
      ******************************************************************20860001
                                                                        20870001
       2280-MULTIPLE-SKU-REQUEST.                                       20880001
           MOVE '*2280-MULTIPLE-SKU-REQUEST.      *' TO DP013-PARAGRAPH 20890001
                                                                        20900001
           SET PS-NOT-GIFT-W-PURCHASE TO TRUE                           20910001
                                                                        20920001
           PERFORM 9517-FETCH-SKU-FROM-CSR-2                            20930001
                                                                        20940001
           IF  SQLCODE = +0 AND                                         20950001
               TSK-CUR-UNIT-RTL-AMT = +0.00                             20960001
               SET PS-GIFT-W-PURCHASE TO TRUE                           20970001
           END-IF                                                       20980001
                                                                        20990001
           IF SQLCODE EQUAL ZERO                                        21000001
               IF TSK-REGN-PRIC-IND = 'Y'                               21010001
                  PERFORM 9010-PROCESS-RCP-SKU-AT-A-TIME                21020001
               ELSE                                                     21030001
                  PERFORM 9000-PROCESS-SKU-AT-A-TIME                    21040001
               END-IF                                                   21050001
           ELSE                                                         21060001
               IF SQLCODE EQUAL +100                                    21070001
                   IF PS-NO-SKUS-FOUND                                  21080001
                       IF NOT PS-EDIT-ERROR                             21090001
                           SET PS-EDIT-ERROR TO TRUE                    21100001
                           MOVE PC-TSYMSG-01300 TO DP020-MSG-NUMBER     21110001
                       END-IF                                           21120001
                       IF DP020-NEXT-ACT-INITIAL                        21130001
                           SET PS-EDIT-ERROR TO TRUE                    21140001
                           MOVE PC-TSYMSG-01300 TO DP020-MSG-NUMBER     21150001
                           SET DP020-NEXT-ACT-APPL-ERROR TO TRUE        21160001
                       END-IF                                           21170001
                   END-IF                                               21180001
               END-IF                                                   21190001
           END-IF.                                                      21200001
                                                                        21210001
           EJECT                                                        21220001
                                                                        21230001
      ******************************************************************21240001
      *  TAKE THE INFORMATION FOUND IN THE COMMAREA WHICH WAS RETRIEVED 21250001
      *  IN THIS PROGRAM AND MOVE IT TO THE OUTPUT MAP AREA.            21260001
      ******************************************************************21270001
                                                                        21280001
       2300-FORMAT-OUTPUT-MAP.                                          21290001
           MOVE '*2300-FORMAT-OUTPUT-MAP.         *' TO DP013-PARAGRAPH 21300001
                                                                        21310001
           PERFORM 2305-FORMAT-CURR-PREV.                               21320001
                                                                        21330001
           PERFORM 2310-FORMAT-WEEKLY-OUTPUT.                           21340001
                                                                        21350001
           PERFORM 2370-FORMAT-MONTHLY-OUTPUT.                          21360001
                                                                        21370001
           EJECT                                                        21380001
      ******************************************************************21390001
      *  MOVE THE APPROPRIATE CURRENT AND WEEKLY FIELDS TO THE OUTPUT   21400001
      *  MAP DEPENDING UPON THE UNITS/DOLLARS SWITCH IN THE COMMAREA.   21410001
      ******************************************************************21420001
       2305-FORMAT-CURR-PREV.                                           21430001
           MOVE '*2305-FORMAT-CURR-PREV.          *' TO DP013-PARAGRAPH 21440001
                                                                        21450001
           IF CA-DISPLAY-UNITS                                          21460001
              MOVE CA-SUN-UNITS TO PV-UNITS                             21470001
              MOVE PV-UNITS-X TO SUNUNTO                                21480001
              MOVE CA-MON-UNITS TO PV-UNITS                             21490001
              MOVE PV-UNITS-X TO MONUNTO                                21500001
              MOVE CA-TUE-UNITS TO PV-UNITS                             21510001
              MOVE PV-UNITS-X TO TUEUNTO                                21520001
              MOVE CA-WED-UNITS TO PV-UNITS                             21530001
              MOVE PV-UNITS-X TO WEDUNTO                                21540001
              MOVE CA-THU-UNITS TO PV-UNITS                             21550001
              MOVE PV-UNITS-X TO THUUNTO                                21560001
              MOVE CA-FRI-UNITS TO PV-UNITS                             21570001
              MOVE PV-UNITS-X TO FRIUNTO                                21580001
              MOVE CA-SAT-UNITS TO PV-UNITS                             21590001
              MOVE PV-UNITS-X TO SATUNTO                                21600001
           ELSE                                                         21610001
              IF CA-TSK-CUR-RTL-X = 'MIXED'                             21620001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21630001
                            (CA-SUN-DLRS * 1)                           21640001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21650001
                 MOVE PV-UNITS-X TO SUNUNTO                             21660001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21670001
                            (CA-MON-DLRS * 1)                           21680001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21690001
                 MOVE PV-UNITS-X TO MONUNTO                             21700001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21710001
                            (CA-TUE-DLRS * 1)                           21720001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21730001
                 MOVE PV-UNITS-X TO TUEUNTO                             21740001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21750001
                            (CA-WED-DLRS * 1)                           21760001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21770001
                 MOVE PV-UNITS-X TO WEDUNTO                             21780001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21790001
                            (CA-THU-DLRS * 1)                           21800001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21810001
                 MOVE PV-UNITS-X TO THUUNTO                             21820001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21830001
                            (CA-FRI-DLRS * 1)                           21840001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21850001
                 MOVE PV-UNITS-X TO FRIUNTO                             21860001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21870001
                            (CA-SAT-DLRS * 1)                           21880001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21890001
                 MOVE PV-UNITS-X TO SATUNTO                             21900001
              ELSE                                                      21910001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21920001
                            (CA-SUN-UNITS * CA-TSK-CUR-RTL)             21930001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21940001
                 MOVE PV-UNITS-X TO SUNUNTO                             21950001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      21960001
                            (CA-MON-UNITS * CA-TSK-CUR-RTL)             21970001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       21980001
                 MOVE PV-UNITS-X TO MONUNTO                             21990001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22000001
                            (CA-TUE-UNITS * CA-TSK-CUR-RTL)             22010001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22020001
                 MOVE PV-UNITS-X TO TUEUNTO                             22030001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22040001
                            (CA-WED-UNITS * CA-TSK-CUR-RTL)             22050001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22060001
                 MOVE PV-UNITS-X TO WEDUNTO                             22070001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22080001
                            (CA-THU-UNITS * CA-TSK-CUR-RTL)             22090001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22100001
                 MOVE PV-UNITS-X TO THUUNTO                             22110001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22120001
                            (CA-FRI-UNITS * CA-TSK-CUR-RTL)             22130001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22140001
                 MOVE PV-UNITS-X TO FRIUNTO                             22150001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22160001
                            (CA-SAT-UNITS * CA-TSK-CUR-RTL)             22170001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22180001
                 MOVE PV-UNITS-X TO SATUNTO                             22190001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22200001
                            (CA-MODEL-STOCK * CA-TSK-CUR-RTL)           22210001
              END-IF                                                    22220001
           END-IF.                                                      22230001
                                                                        22240001
           IF CA-DISPLAY-UNITS                                          22250001
              MOVE CA-SUN-UNITS-PREV TO PV-UNITS                        22260001
              MOVE PV-UNITS-X TO SUNUNTPO                               22270001
              MOVE CA-MON-UNITS-PREV TO PV-UNITS                        22280001
              MOVE PV-UNITS-X TO MONUNTPO                               22290001
              MOVE CA-TUE-UNITS-PREV TO PV-UNITS                        22300001
              MOVE PV-UNITS-X TO TUEUNTPO                               22310001
              MOVE CA-WED-UNITS-PREV TO PV-UNITS                        22320001
              MOVE PV-UNITS-X TO WEDUNTPO                               22330001
              MOVE CA-THU-UNITS-PREV TO PV-UNITS                        22340001
              MOVE PV-UNITS-X TO THUUNTPO                               22350001
              MOVE CA-FRI-UNITS-PREV TO PV-UNITS                        22360001
              MOVE PV-UNITS-X TO FRIUNTPO                               22370001
              MOVE CA-SAT-UNITS-PREV TO PV-UNITS                        22380001
              MOVE PV-UNITS-X TO SATUNTPO                               22390001
           ELSE                                                         22400001
              IF CA-TSK-CUR-RTL-X = 'MIXED'                             22410001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22420001
                            (CA-SUN-DLRS-PREV * 1)                      22430001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22440001
                 MOVE PV-UNITS-X TO SUNUNTPO                            22450001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22460001
                            (CA-MON-DLRS-PREV * 1)                      22470001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22480001
                 MOVE PV-UNITS-X TO MONUNTPO                            22490001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22500001
                            (CA-TUE-DLRS-PREV * 1)                      22510001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22520001
                 MOVE PV-UNITS-X TO TUEUNTPO                            22530001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22540001
                            (CA-WED-DLRS-PREV * 1)                      22550001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22560001
                 MOVE PV-UNITS-X TO WEDUNTPO                            22570001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22580001
                            (CA-THU-DLRS-PREV * 1)                      22590001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22600001
                 MOVE PV-UNITS-X TO THUUNTPO                            22610001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22620001
                            (CA-FRI-DLRS-PREV * 1)                      22630001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22640001
                 MOVE PV-UNITS-X TO FRIUNTPO                            22650001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22660001
                            (CA-SAT-DLRS-PREV * 1)                      22670001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22680001
                 MOVE PV-UNITS-X TO SATUNTPO                            22690001
              ELSE                                                      22700001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22710001
                            (CA-SUN-UNITS-PREV * CA-TSK-CUR-RTL)        22720001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22730001
                 MOVE PV-UNITS-X TO SUNUNTPO                            22740001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22750001
                            (CA-MON-UNITS-PREV * CA-TSK-CUR-RTL)        22760001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22770001
                 MOVE PV-UNITS-X TO MONUNTPO                            22780001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22790001
                            (CA-TUE-UNITS-PREV * CA-TSK-CUR-RTL)        22800001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22810001
                 MOVE PV-UNITS-X TO TUEUNTPO                            22820001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22830001
                            (CA-WED-UNITS-PREV * CA-TSK-CUR-RTL)        22840001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22850001
                 MOVE PV-UNITS-X TO WEDUNTPO                            22860001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22870001
                            (CA-THU-UNITS-PREV * CA-TSK-CUR-RTL)        22880001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22890001
                 MOVE PV-UNITS-X TO THUUNTPO                            22900001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22910001
                            (CA-FRI-UNITS-PREV * CA-TSK-CUR-RTL)        22920001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22930001
                 MOVE PV-UNITS-X TO FRIUNTPO                            22940001
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      22950001
                            (CA-SAT-UNITS-PREV * CA-TSK-CUR-RTL)        22960001
                 MOVE PV-WORK-DOLLARS TO PV-UNITS                       22970001
                 MOVE PV-UNITS-X TO SATUNTPO                            22980001
              END-IF                                                    22990001
           END-IF.                                                      23000001
                                                                        23010001
           EJECT                                                        23020001
      ******************************************************************23030001
      *  MOVE THE APPROPRIATE WEEKLY INFORMATION TO THE OUTPUT MAP      23040001
      *  DEPENDING UPON THE UNITS/DOLLARS SWITCH IN THE COMMAREA.       23050001
      ******************************************************************23060001
                                                                        23070001
       2310-FORMAT-WEEKLY-OUTPUT.                                       23080001
           MOVE '*2310-FORMAT-WEEKLY-OUTPUT.      *' TO DP013-PARAGRAPH 23090001
                                                                        23100001
           IF CA-DISPLAY-UNITS                                          23110001
               MOVE CA-ON-ORDER-UNITS TO PV-ON-ORDER                    23120001
               MOVE PV-ON-ORDER-X TO ONORDRO                            23130001
               MOVE CA-CURR-ONHAND-UNITS TO PV-ONHAND                   23140001
               MOVE PV-ONHAND-X TO ONHANDO                              23150001
MK             IF CA-SKU-NUMBER-X > SPACES                              23160016
W30677           MOVE CA-STORE-OH-UNITS TO PV-STORE-OH                  23170099
W30677           MOVE PV-STORE-OH-X TO STOREOHO                         23180099
W30677           MOVE CA-IN-TRNST-UNITS TO PV-INTRANSIT                 23190099
W30677           MOVE PV-INTRANSIT-X TO INTRAO                          23200099
               END-IF                                                   23210001
           ELSE                                                         23220001
               COMPUTE PV-WORK-DOLLARS ROUNDED =                        23230001
                          (CA-ON-ORDER-DLRS * 1)                        23240001
               MOVE PV-WORK-DOLLARS TO PV-ON-ORDER                      23250001
               MOVE PV-ON-ORDER-X TO ONORDRO                            23260001
               COMPUTE PV-WORK-DOLLARS ROUNDED =                        23270001
                          (CA-CURR-ONHAND-DLRS * 1)                     23280001
               MOVE PV-WORK-DOLLARS TO PV-ONHAND                        23290001
               MOVE PV-ONHAND-X TO ONHANDO                              23300001
MK             IF CA-SKU-NUMBER-X > SPACES                              23310017
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      23320001
                            (CA-STORE-OH-DLRS * 1)                      23330088
W30677           MOVE PV-WORK-DOLLARS TO PV-STORE-OH                    23340099
W30677           MOVE PV-STORE-OH-X TO STOREOHO                         23350099
                 COMPUTE PV-WORK-DOLLARS ROUNDED =                      23360001
                            (CA-IN-TRNST-DLRS * 1)                      23370001
W30677           MOVE PV-WORK-DOLLARS TO PV-INTRANSIT                   23380099
W30677           MOVE PV-INTRANSIT-X TO INTRAO                          23390099
               END-IF                                                   23400001
           END-IF.                                                      23410001
                                                                        23420001
           PERFORM VARYING CA-WKLY-INDEX                                23430001
                   FROM 1 BY 1                                          23440001
                   UNTIL CA-WKLY-INDEX > PC-MAX-NUM-WEEKS               23450001
               SET MA-WKLY-INDEX TO CA-WKLY-INDEX                       23460001
               IF CA-WKLY-CAL-DATE (CA-WKLY-INDEX) NOT EQUAL SPACES     23470001
                   MOVE CA-WKLY-CAL-DATE (CA-WKLY-INDEX)                23480001
                                TO MA-WKLY-DATE (MA-WKLY-INDEX)         23490001
                   IF CA-DISPLAY-UNITS                                  23500001
                       MOVE CA-WKLY-ONHAND-UNITS (CA-WKLY-INDEX)        23510001
                                TO MA-WKLY-ONHAND (MA-WKLY-INDEX)       23520001
                       INITIALIZE PV-WKLY-TOTAL-UNITS                   23530001
                       ADD CA-WKLY-REG-UNITS (CA-WKLY-INDEX)            23540099
                                TO PV-WKLY-TOTAL-UNITS                  23550001
                       MOVE CA-WKLY-REG-UNITS (CA-WKLY-INDEX)           23560099
                                TO MA-WKLY-REGULAR (MA-WKLY-INDEX)      23570001
                       ADD CA-WKLY-PRO-UNITS (CA-WKLY-INDEX)            23580099
                                TO PV-WKLY-TOTAL-UNITS                  23590001
                       MOVE CA-WKLY-PRO-UNITS (CA-WKLY-INDEX)           23600099
                                TO MA-WKLY-PROMO (MA-WKLY-INDEX)        23610001
                       ADD CA-WKLY-CLR-UNITS (CA-WKLY-INDEX)            23620099
                                TO PV-WKLY-TOTAL-UNITS                  23630001
                       MOVE CA-WKLY-CLR-UNITS (CA-WKLY-INDEX)           23640099
                                TO MA-WKLY-CLEAR (MA-WKLY-INDEX)        23650001
                       MOVE PV-WKLY-TOTAL-UNITS                         23660099
                                TO MA-WKLY-TOTAL (MA-WKLY-INDEX)        23670001
                   ELSE                                                 23680001
                       COMPUTE PV-WORK-DOLLARS ROUNDED =                23690001
                          (CA-WKLY-ONHAND-DLRS (CA-WKLY-INDEX) * 1)     23700001
                       MOVE PV-WORK-DOLLARS                             23710001
                                TO MA-WKLY-ONHAND (MA-WKLY-INDEX)       23720001
                       INITIALIZE PV-WKLY-TOTAL-DOLLARS                 23730001
                       COMPUTE PV-WORK-DOLLARS ROUNDED =                23740001
                          (CA-WKLY-REG-DLRS (CA-WKLY-INDEX) * 1)        23750001
                       ADD PV-WORK-DOLLARS TO                           23760001
                                   PV-WKLY-TOTAL-DOLLARS                23770001
                       MOVE PV-WORK-DOLLARS TO                          23780001
                                   MA-WKLY-REGULAR (MA-WKLY-INDEX)      23790001
                       COMPUTE PV-WORK-DOLLARS ROUNDED =                23800001
                          (CA-WKLY-PRO-DLRS (CA-WKLY-INDEX) * 1)        23810001
                       ADD PV-WORK-DOLLARS TO                           23820001
                                   PV-WKLY-TOTAL-DOLLARS                23830001
                       MOVE PV-WORK-DOLLARS TO                          23840001
                                   MA-WKLY-PROMO (MA-WKLY-INDEX)        23850001
                       COMPUTE PV-WORK-DOLLARS ROUNDED =                23860001
                          (CA-WKLY-CLR-DLRS (CA-WKLY-INDEX) * 1)        23870001
                       ADD PV-WORK-DOLLARS TO                           23880001
                                   PV-WKLY-TOTAL-DOLLARS                23890001
                       MOVE PV-WORK-DOLLARS TO                          23900001
                                   MA-WKLY-CLEAR (MA-WKLY-INDEX)        23910001
                       MOVE PV-WKLY-TOTAL-DOLLARS TO                    23920001
                                   MA-WKLY-TOTAL (MA-WKLY-INDEX)        23930001
                   END-IF                                               23940001
               ELSE                                                     23950001
                   MOVE SPACES TO MA-WKLY-DATE (MA-WKLY-INDEX)          23960001
                                  MA-WKLY-REGULAR-X (MA-WKLY-INDEX)     23970001
                                  MA-WKLY-PROMO-X (MA-WKLY-INDEX)       23980001
                                  MA-WKLY-CLEAR-X (MA-WKLY-INDEX)       23990001
                                  MA-WKLY-TOTAL-X (MA-WKLY-INDEX)       24000001
                                  MA-WKLY-ONHAND-X (MA-WKLY-INDEX)      24010001
               END-IF                                                   24020001
           END-PERFORM.                                                 24030001
                                                                        24040001
           EJECT                                                        24050001
                                                                        24060001
      ******************************************************************24070001
      *  MOVE THE APPROPRIATE MONTHLY INFORMATION TO THE OUTPUT MAP     24080001
      *  DEPENDING UPON THE PAGING POINT OF THE PROGRAM.                24090001
      ******************************************************************24100001
                                                                        24110001
       2370-FORMAT-MONTHLY-OUTPUT.                                      24120001
           MOVE '*2370-FORMAT-MONTHLY-OUTPUT.     *' TO DP013-PARAGRAPH.24130072
                                                                        24140001
           EJECT.                                                       24150072
                                                                        24160001
W30677******************************************************************24170099
W30677** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **24180099
W30677** MAP.                                                         **24190099
W30677******************************************************************24200099
W30677 2400-RESET-ATTRIBUTES.                                           24210099
W30677                                                                  24220099
W30677** ENTERABLE FIELDS (SKU NUMBER).                                 24230099
W30677     MOVE DP015-UNP-ALP-NOR-OFF  TO SKUA.                         24240099
W30677     MOVE DP015-GREEN            TO SKUC.                         24250099
W30677     MOVE DP015-UNDERLINE        TO SKUH.                         24260099
W30677     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         24270099
W30677     MOVE -1                     TO SKUL.                         24280099
W30677                                                                  24290099
W30677** NON-ENTERABLE FIELDS.                                          24300099
W30677     MOVE DP015-HL-OFF               TO DEPTH                     24310099
W30677                                        CLASSH                    24320099
W30677                                        STOREH                    24330099
W30677                                        STRDSCH                   24340099
W30677                                        SKUDSCH                   24350099
W30677                                        SIZEH                     24360099
W30677                                        COLORH                    24370099
W30677                                        CSTOCKH                   24380099
W30677                                        ORGRTLH                   24390099
W30677                                        CURRTLH                   24400099
W30677                                        GPRTLH                    24410099
W30677                                        ORDRPTH                   24420099
W30677                                        COSTH                     24430099
W30677                                        STAT1H                    24440099
W30677                                        STAT2H                    24450099
W30677                                        STAT3H                    24460099
W30677                                        STAT4H                    24470099
W30677                                        STAT5H                    24480099
W30677                                        OUTLMTH                   24490099
W30677                                        ONORDRH                   24500099
W30677                                        VNDRNOH                   24510099
W30677                                        VNDDSCH                   24520099
W30677                                        STYLEH                    24530099
W30677                                        GROUPH                    24540099
W30677                                        INTRAH                    24550099
W30677                                        RPLH                      24560099
W30677                                        STOREOHH                  24570099
W30677                                        ONHANDH                   24580099
W30677                                        SUNUNTH                   24590099
W30677                                        MONUNTH                   24600099
W30677                                        TUEUNTH                   24610099
W30677                                        WEDUNTH                   24620099
W30677                                        THUUNTH                   24630099
W30677                                        FRIUNTH                   24640099
W30677                                        SATUNTH                   24650099
W30677                                        SUNUNTPH                  24660099
W30677                                        MONUNTPH                  24670099
W30677                                        TUEUNTPH                  24680099
W30677                                        WEDUNTPH                  24690099
W30677                                        THUUNTPH                  24700099
W30677                                        FRIUNTPH                  24710099
W30677                                        SATUNTPH                  24720099
W30677                                        WKTOT1H                   24730099
W30677                                        WKREG1H                   24740099
W30677                                        WKPRO1H                   24750099
W30677                                        WKCLE1H                   24760099
W30677                                        WKONH1H                   24770099
W30677                                        WKDAT2H                   24780099
W30677                                        WKTOT2H                   24790099
W30677                                        WKREG2H                   24800099
W30677                                        WKPRO2H                   24810099
W30677                                        WKCLE2H                   24820099
W30677                                        WKONH2H                   24830099
W30677                                        WKDAT3H                   24840099
W30677                                        WKTOT3H                   24850099
W30677                                        WKREG3H                   24860099
W30677                                        WKPRO3H                   24870099
W30677                                        WKCLE3H                   24880099
W30677                                        WKONH3H                   24890099
W30677                                        WKDAT4H                   24900099
W30677                                        WKTOT4H                   24910099
W30677                                        WKREG4H                   24920099
W30677                                        WKPRO4H                   24930099
W30677                                        WKCLE4H                   24940099
W30677                                        WKONH4H.                  24950099
W30677     MOVE DP015-BLUE                 TO DEPTC                     24960099
W30677                                        CLASSC                    24970099
W30677                                        STOREC                    24980099
W30677                                        STRDSCC                   24990099
W30677                                        SKUDSCC                   25000099
W30677                                        SIZEC                     25010099
W30677                                        COLORC                    25020099
W30677                                        CSTOCKC                   25030099
W30677                                        ORGRTLC                   25040099
W30677                                        CURRTLC                   25050099
W30677                                        GPRTLC                    25060099
W30677                                        ORDRPTC                   25070099
W30677                                        COSTC                     25080099
W30677                                        STAT1C                    25090099
W30677                                        STAT2C                    25100099
W30677                                        STAT3C                    25110099
W30677                                        STAT4C                    25120099
W30677                                        STAT5C                    25130099
W30677                                        OUTLMTC                   25140099
W30677                                        ONORDRC                   25150099
W30677                                        VNDRNOC                   25160099
W30677                                        VNDDSCC                   25170099
W30677                                        STYLEC                    25180099
W30677                                        GROUPC                    25190099
W30677                                        INTRAC                    25200099
W30677                                        RPLC                      25210099
W30677                                        STOREOHC                  25220099
W30677                                        ONHANDC                   25230099
W30677                                        SUNUNTC                   25240099
W30677                                        MONUNTC                   25250099
W30677                                        TUEUNTC                   25260099
W30677                                        WEDUNTC                   25270099
W30677                                        THUUNTC                   25280099
W30677                                        FRIUNTC                   25290099
W30677                                        SATUNTC                   25300099
W30677                                        SUNUNTPC                  25310099
W30677                                        MONUNTPC                  25320099
W30677                                        TUEUNTPC                  25330099
W30677                                        WEDUNTPC                  25340099
W30677                                        THUUNTPC                  25350099
W30677                                        FRIUNTPC                  25360099
W30677                                        SATUNTPC                  25370099
W30677                                        WKTOT1C                   25380099
W30677                                        WKREG1C                   25390099
W30677                                        WKPRO1C                   25400099
W30677                                        WKCLE1C                   25410099
W30677                                        WKONH1C                   25420099
W30677                                        WKDAT2C                   25430099
W30677                                        WKTOT2C                   25440099
W30677                                        WKREG2C                   25450099
W30677                                        WKPRO2C                   25460099
W30677                                        WKCLE2C                   25470099
W30677                                        WKONH2C                   25480099
W30677                                        WKDAT3C                   25490099
W30677                                        WKTOT3C                   25500099
W30677                                        WKREG3C                   25510099
W30677                                        WKPRO3C                   25520099
W30677                                        WKCLE3C                   25530099
W30677                                        WKONH3C                   25540099
W30677                                        WKDAT4C                   25550099
W30677                                        WKTOT4C                   25560099
W30677                                        WKREG4C                   25570099
W30677                                        WKPRO4C                   25580099
W30677                                        WKCLE4C                   25590099
W30677                                        WKONH4C.                  25600099
W30677     MOVE DP015-ASK-NOR-OFF          TO DEPTA                     25610099
W30677                                        CLASSA                    25620099
W30677                                        STOREA                    25630099
W30677                                        STRDSCA                   25640099
W30677                                        SKUDSCA                   25650099
W30677                                        SIZEA                     25660099
W30677                                        COLORA                    25670099
W30677                                        CSTOCKA                   25680099
W30677                                        ORGRTLA                   25690099
W30677                                        CURRTLA                   25700099
W30677                                        GPRTLA                    25710099
W30677                                        ORDRPTA                   25720099
W30677                                        COSTA                     25730099
W30677                                        STAT1A                    25740099
W30677                                        STAT2A                    25750099
W30677                                        STAT3A                    25760099
W30677                                        STAT4A                    25770099
W30677                                        STAT5A                    25780099
W30677                                        OUTLMTA                   25790099
W30677                                        ONORDRA                   25800099
W30677                                        VNDRNOA                   25810099
W30677                                        VNDDSCA                   25820099
W30677                                        STYLEA                    25830099
W30677                                        GROUPA                    25840099
W30677                                        INTRAA                    25850099
W30677                                        RPLA                      25860099
W30677                                        STOREOHA                  25870099
W30677                                        ONHANDA                   25880099
W30677                                        SUNUNTA                   25890099
W30677                                        MONUNTA                   25900099
W30677                                        TUEUNTA                   25910099
W30677                                        WEDUNTA                   25920099
W30677                                        THUUNTA                   25930099
W30677                                        FRIUNTA                   25940099
W30677                                        SATUNTA                   25950099
W30677                                        SUNUNTPA                  25960099
W30677                                        MONUNTPA                  25970099
W30677                                        TUEUNTPA                  25980099
W30677                                        WEDUNTPA                  25990099
W30677                                        THUUNTPA                  26000099
W30677                                        FRIUNTPA                  26010099
W30677                                        SATUNTPA                  26020099
W30677                                        WKTOT1A                   26030099
W30677                                        WKREG1A                   26040099
W30677                                        WKPRO1A                   26050099
W30677                                        WKCLE1A                   26060099
W30677                                        WKONH1A                   26070099
W30677                                        WKDAT2A                   26080099
W30677                                        WKTOT2A                   26090099
W30677                                        WKREG2A                   26100099
W30677                                        WKPRO2A                   26110099
W30677                                        WKCLE2A                   26120099
W30677                                        WKONH2A                   26130099
W30677                                        WKDAT3A                   26140099
W30677                                        WKTOT3A                   26150099
W30677                                        WKREG3A                   26160099
W30677                                        WKPRO3A                   26170099
W30677                                        WKCLE3A                   26180099
W30677                                        WKONH3A                   26190099
W30677                                        WKDAT4A                   26200099
W30677                                        WKTOT4A                   26210099
W30677                                        WKREG4A                   26220099
W30677                                        WKPRO4A                   26230099
W30677                                        WKCLE4A                   26240099
W30677                                        WKONH4A.                  26250099
W30677                                                                  26260099
W30677******************************************************************26270099
W30677** VALIDATE UPC NUMBER.                                         **26280099
W30677******************************************************************26290099
W30677 2500-VALIDATE-UPC-NBR.                                           26300099
W30677     PERFORM                                                      26310099
W30677         WITH TEST AFTER                                          26320099
W30677         VARYING PV-RETRY-COUNT                                   26330099
W30677         FROM 1 BY 1                                              26340099
W30677         UNTIL ((PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)         26350099
W30677                   OR (SQLCODE = ZERO)                            26360099
W30677                   OR (SQLCODE = +100))                           26370099
W30677         EXEC SQL                                                 26380099
W30677           SELECT X.DEPT                                          26390099
W30677                 ,X.CLASS                                         26400099
W30677                 ,X.SUBCLASS                                      26410099
W30677                 ,X.SKU                                           26420099
W30677                 ,X.ITM_NBR                                       26430099
W43143                 ,X.INTR_UPC_ID                                   26440099
W30677             INTO :SKXREF-DEPT                                    26450099
W30677                 ,:SKXREF-CLASS                                   26460099
W30677                 ,:SKXREF-SUBCLASS                                26470099
W30677                 ,:SKXREF-SKU                                     26480099
W30677                 ,:SKXREF-ITM-NBR                                 26490099
W43143                 ,:SKXREF-INTR-UPC-ID                             26500099
W30677             FROM TUPCSKU U                                       26510099
W30677                 ,TSKXREF X                                       26520099
W30677            WHERE U.ITEM_NBR = X.ITM_NBR                          26530099
W30677              AND X.SKU_STAT_CDE ^= '00'                          26540099
W30677              AND U.UPC_NBR = :PV-UPC-NBR                         26550099
W30677         END-EXEC                                                 26560099
W30677                                                                  26570099
W30677         EVALUATE TRUE                                            26580099
W30677             WHEN SQLCODE = ZERO                                  26590099
W30677                  PERFORM 2550-MOVE-UPC-VALUES                    26600099
W30677                  PERFORM 2000-GET-NEW-SKU-UPC                    26610099
W30677                  MOVE CA-UPC-NUMBER-X TO SKUO                    26620099
W30677                  MOVE SPACES TO CA-UPC-NUMBER-X                  26630099
W30677             WHEN SQLCODE = +100                                  26640099
W30677                  MOVE DP015-REVERSE         TO SKUH              26650099
W30677                  MOVE DP015-RED             TO SKUC              26660099
W30677                  MOVE DP015-UNP-ALP-BRT-OFF TO SKUA              26670099
W30677                  IF NOT PS-EDIT-ERROR                            26680099
W30677                      SET PS-EDIT-ERROR      TO TRUE              26690099
W30677                      MOVE PC-TSYMSG-00100   TO DP020-MSG-NUMBER  26700099
W30677                      MOVE -1                TO SKUL              26710099
W30677                  END-IF                                          26720099
W30677             WHEN SQLWARN0 NOT = SPACES                           26730099
W30677             WHEN SQLCODE < ZERO                                  26740099
W30677             WHEN SQLCODE > ZERO                                  26750099
W30677                 MOVE '2500-VALIDATE-UPC-NBR'                     26760099
W30677                                   TO DP013-PARAGRAPH             26770099
W30677                 MOVE 'VALIDATE UPC NUMBER'                       26780099
W30677                                   TO DP013-MESSAGE-TEXT (1)      26790099
W30677                 MOVE SQLCA        TO DP013-SQLCA                 26800099
W30677                 MOVE 'TUPCSKU'    TO DP013-DB2-TABLE-NAME (1)    26810099
W30677                 SET DP013-DB2-ABEND                              26820099
W30677                     DP013-XCTL-DISPLAY-RESTART                   26830099
W30677                                   TO TRUE                        26840099
W30677                 PERFORM DP013-0000-PROCESS-ABEND                 26850099
W30677         END-EVALUATE                                             26860099
W30677     END-PERFORM.                                                 26870099
W30677                                                                  26880099
W30677     IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                  26890099
W30677         MOVE '2500-VALIDATE-UPC-NBR'                             26900099
W30677                                   TO DP013-PARAGRAPH             26910099
W30677         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26920099
W30677                                   TO DP013-MESSAGE-TEXT (1)      26930099
W30677         MOVE 'VALIDATE UPC NUMBER'                               26940099
W30677                                   TO DP013-MESSAGE-TEXT (2)      26950099
W30677         MOVE SQLCA                TO DP013-SQLCA                 26960099
W30677         MOVE 'TUPCSKU'            TO DP013-DB2-TABLE-NAME (1)    26970099
W30677         SET DP013-DB2-ABEND                                      26980099
W30677             DP013-XCTL-DISPLAY-RESTART                           26990099
W30677                                   TO TRUE                        27000099
W30677         PERFORM DP013-0000-PROCESS-ABEND                         27010099
W30677     END-IF.                                                      27020099
W30677                                                                  27030099
W30677******************************************************************27040099
W30677** VALID UPC - MOVE DETAIL TO COMMAREA & SCREEN.                **27050099
W30677******************************************************************27060099
W30677 2550-MOVE-UPC-VALUES.                                            27070099
W30677                                                                  27080099
W30677     MOVE SKXREF-SKU       TO CA-SKU-NUMBER-9                     27090099
W30677                              NI-SKU-9-8.                         27100099
W43143     MOVE SKXREF-INTR-UPC-ID TO FS009-UPC-ID.                     27110099
W30677                                                                  27120099
W30677******************************************************************27130099
W30677* 2600-EDIT-UPC-FIELDS.                                           27140099
W30677******************************************************************27150099
W30677 2600-EDIT-UPC-FIELDS.                                            27160099
W30677                                                                  27170099
W30677     IF  PV-SKU-UPC-INPUT = SPACES                                27180099
W30677         IF CA-UPC-NUMBER-X > SPACES                              27190099
W30677             MOVE CA-UPC-NUMBER-X TO DP010I-UNEDITED-FIELD        27200099
W30677             MOVE LENGTH OF CA-UPC-NUMBER-X                       27210099
W30677                 TO DP010I-MAXIMUM-DIGITS                         27220099
W30677             MOVE ZERO            TO DP010I-MAXIMUM-DECIMALS      27230099
W30677             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              27240099
272945             CALL DP010I-NUMERIC-EDIT-ROUTINE                     27251099
272945                             USING DP010I-NUMERIC-EDIT-AREA       27252099
W30677             IF  (DP010I-ERROR-DETECTED                           27260099
W30677                 OR DP010I-NUMERIC-FIELD = ZERO)                  27270099
W30677                 MOVE DP015-REVERSE         TO SKUH               27280099
W30677                 MOVE DP015-RED             TO SKUC               27290099
W30677                 MOVE DP015-UNP-ALP-BRT-OFF TO SKUA               27300099
W30677                 IF  NOT PS-EDIT-ERROR                            27310099
W30677                     SET PS-EDIT-ERROR      TO TRUE               27320099
W30677                     MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER   27330099
W30677                     MOVE -1                TO SKUL               27340099
W30677                 END-IF                                           27350099
W30677             ELSE                                                 27360099
W30677                 MOVE DP010I-NUM-FIELD-15-DIG-2-DEC               27370099
W30677                     TO CA-UPC-NUMBER-9                           27380099
W30677                        PV-UPC-NBR                                27390099
W30677                 MOVE CA-UPC-NUMBER-X       TO SKUO               27400099
W30677             END-IF                                               27410099
W30677         END-IF                                                   27420099
W30677     ELSE                                                         27430099
W30677         MOVE PV-SKU-UPC-INPUT        TO DP010I-UNEDITED-FIELD    27440099
W30677         MOVE LENGTH OF PV-SKU-UPC-INPUT TO DP010I-MAXIMUM-DIGITS 27450099
W30677         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  27460099
W30677         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  27470099
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         27481099
272945                         USING DP010I-NUMERIC-EDIT-AREA           27482099
W30677         IF  (DP010I-ERROR-DETECTED                               27490099
W30677                 OR DP010I-NUMERIC-FIELD = ZERO)                  27500099
W30677             MOVE DP015-REVERSE         TO SKUH                   27510099
W30677             MOVE DP015-RED             TO SKUC                   27520099
W30677             MOVE DP015-UNP-ALP-BRT-OFF TO SKUA                   27530099
W30677             IF  NOT PS-EDIT-ERROR                                27540099
W30677                 SET PS-EDIT-ERROR      TO TRUE                   27550099
W30677                 MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER       27560099
W30677                 MOVE -1                TO SKUL                   27570099
W30677                 MOVE PV-SKU-UPC-INPUT  TO CA-UPC-NUMBER-X        27580099
W30677             END-IF                                               27590099
W30677         ELSE                                                     27600099
W30677             MOVE DP010I-NUM-FIELD-15-DIG-2-DEC TO CA-UPC-NUMBER-927610099
W30677                                                   PV-UPC-NBR     27620099
W30677             MOVE CA-UPC-NUMBER-X               TO SKUO           27630099
W30677         END-IF                                                   27640099
W30677     END-IF.                                                      27650099
W30677                                                                  27660099
W30677******************************************************************27670099
W30677* 2700-EDIT-SKU-FIELDS.                                           27680099
W30677******************************************************************27690099
W30677 2700-EDIT-SKU-FIELDS.                                            27700099
W30677                                                                  27710099
W30677     IF  PV-SKU-UPC-INPUT = SPACES                                27720099
W30677         IF CA-SKU-NUMBER-X = SPACES                              27730099
W30677             MOVE DP015-REVERSE         TO SKUH                   27740099
W30677             MOVE DP015-RED             TO SKUC                   27750099
W30677             MOVE DP015-UNP-ALP-BRT-OFF TO SKUA                   27760099
W30677             SET PS-EDIT-ERROR          TO TRUE                   27770099
W30677             MOVE PC-TSYMSG-00413       TO DP020-MSG-NUMBER       27780099
W30677             MOVE -1                    TO SKUL                   27790099
W30677         ELSE                                                     27800099
W30677             MOVE CA-SKU-NUMBER-X TO DP010I-UNEDITED-FIELD        27810099
W30677             MOVE LENGTH OF CA-SKU-NUMBER-X                       27820099
W30677                 TO DP010I-MAXIMUM-DIGITS                         27830099
W30677             MOVE ZERO            TO DP010I-MAXIMUM-DECIMALS      27840099
W30677             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              27850099
272945             CALL DP010I-NUMERIC-EDIT-ROUTINE                     27861099
272945                             USING DP010I-NUMERIC-EDIT-AREA       27862099
W30677             IF  (DP010I-ERROR-DETECTED                           27870099
W30677                 OR DP010I-NUMERIC-FIELD = ZERO)                  27880099
W30677                 MOVE DP015-REVERSE         TO SKUH               27890099
W30677                 MOVE DP015-RED             TO SKUC               27900099
W30677                 MOVE DP015-UNP-ALP-BRT-OFF TO SKUA               27910099
W30677                 IF NOT PS-EDIT-ERROR                             27920099
W30677                     SET PS-EDIT-ERROR      TO TRUE               27930099
W30677                     MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER   27940099
W30677                     MOVE -1                TO SKUL               27950099
W30677                 END-IF                                           27960099
W30677             ELSE                                                 27970099
W30677                 MOVE DP010I-NUMERIC-FIELD TO CA-SKU-NUMBER-9     27980099
W30677                 MOVE CA-SKU-NUMBER-X      TO SKUO                27990099
W30677                                              NI-SKU-9-8          28000099
W30677             END-IF                                               28010099
W30677         END-IF                                                   28020099
W30677     ELSE                                                         28030099
W30677         MOVE PV-SKUI           TO DP010I-UNEDITED-FIELD          28040099
W30677         MOVE LENGTH OF PV-SKUI TO DP010I-MAXIMUM-DIGITS          28050099
W30677         MOVE ZERO              TO DP010I-MAXIMUM-DECIMALS        28060099
W30677         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  28070099
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         28081099
272945                         USING DP010I-NUMERIC-EDIT-AREA           28082099
W30677         IF  (DP010I-ERROR-DETECTED                               28090099
W30677                 OR DP010I-NUMERIC-FIELD = ZERO)                  28100099
W30677             MOVE DP015-REVERSE         TO SKUH                   28110099
W30677             MOVE DP015-RED             TO SKUC                   28120099
W30677             MOVE DP015-UNP-ALP-BRT-OFF TO SKUA                   28130099
W30677             IF NOT PS-EDIT-ERROR                                 28140099
W30677                 SET PS-EDIT-ERROR      TO TRUE                   28150099
W30677                 MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER       28160099
W30677                 MOVE -1                TO SKUL                   28170099
W30677                 MOVE PV-SKUI           TO CA-SKU-NUMBER-X        28180099
W30677             END-IF                                               28190099
W30677         ELSE                                                     28200099
W30677             MOVE DP010I-NUMERIC-FIELD TO CA-SKU-NUMBER-9         28210099
W30677             MOVE CA-SKU-NUMBER-X      TO SKUO                    28220099
W30677                                          NI-SKU-9-8              28230099
W30677         END-IF                                                   28240099
W30677     END-IF.                                                      28250099
W30677                                                                  28260099
      ******************************************************************28270099
      *  THIS PARAGRAPH WILL ONLY BE PERFORMED IF NO 'NEXT'             28280099
      *  SELECTION WAS FOUND WITHIN THE F033 SECTION.                   28290099
      *  PREVIOUS DATA IS REDISPLAYED ON THE SCREEN ALONG WITH A MESS-  28300099
      *  AGE TELLING THE USER THAT NO 'NEXT' SELECTION WAS FOUND. IF    28310099
      *  A VALID 'NEXT' SELECTION HAD BEEN FOUND, THE PROGRAM PATH      28320099
      *  WOULD HAVE ROUTED TO PARAGRAPH 2000-INITIALIZE.                28330099
      ******************************************************************28340099
                                                                        28350099
       3000-NO-NEXT-FOUND.                                              28360099
           MOVE '*3000-NO-NEXT-FOUND.             *' TO DP013-PARAGRAPH 28370099
                                                                        28380099
           SET CA-DISPLAY-UNITS TO TRUE.                                28390099
      *    MOVE 1 TO CA-STARTING-MONTH-POSITION.                        28400070
                                                                        28410001
           MOVE LOW-VALUES TO FS032AI.                                  28420001
                                                                        28430001
           PERFORM 2100-MOVE-SELECTION-TO-MAP.                          28440001
                                                                        28450001
           MOVE PC-UNIT-WKLY-HEADER TO WKLYTO.                          28460001
      *    MOVE PC-MAP-BREAKLINE-UNITS TO BRKLINO.                      28470092
                                                                        28480001
           PERFORM 2300-FORMAT-OUTPUT-MAP.                              28490001
                                                                        28500001
           SET DP030-SET-CURSOR-TRAILER TO TRUE                         28510001
                                                                        28520001
           EVALUATE TRUE                                                28530001
               WHEN CA-NEXT-STORE                                       28540001
                   MOVE PC-TSYMSG-00404 TO DP020-MSG-NUMBER             28550001
               WHEN CA-NEXT-SKU                                         28560001
                   MOVE PC-TSYMSG-00405 TO DP020-MSG-NUMBER             28570001
               WHEN CA-NEXT-DEPT                                        28580001
                   MOVE PC-TSYMSG-00406 TO DP020-MSG-NUMBER             28590001
               WHEN CA-NEXT-CLASS                                       28600001
                   MOVE PC-TSYMSG-00407 TO DP020-MSG-NUMBER             28610001
           END-EVALUATE.                                                28620001
                                                                        28630001
      ******************************************************************28640001
      *  PAGE THE MONTHLY SALES INFORMATION BACK OR FORWARD DEPENDING   28650001
      *  UPON THE PFKEY.                                                28660001
      ******************************************************************28670001
                                                                        28680001
       5000-PAGING.                                                     28690001
           MOVE '*5000-PAGING.                    *' TO DP013-PARAGRAPH 28700001
                                                                        28710001
           MOVE LOW-VALUES TO FS032AI.                                  28720001
                                                                        28730001
           EJECT                                                        28740001
                                                                        28750001
      ******************************************************************28760001
      *  THIS PARAGRAPH WILL BE PERFORMED WHEN THE USER STRIKES A PFKEY*28770001
      *  WHICH INDICATES THAT THEY WANT TO SEE THE 'NEXT' SELECTION    *28780001
      *  WITHIN A VALID SELECTION GROUPING. CONTROL WILL BE PASSED TO  *28790001
      *  PROGRAM FSKCS033 WHICH WILL ACTUALLY DETERMINE THE SELECTION  *28800001
      *  DATA.                                                         *28810001
      ******************************************************************28820001
                                                                        28830001
       6000-GET-NEXT-DATA-GROUPING.                                     28840001
           MOVE '*6000-GET-NEXT-DATA-GROUPING.    *' TO DP013-PARAGRAPH 28850001
                                                                        28860001
           EVALUATE TRUE                                                28870001
               WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               28880001
                   IF (CA-DEPT-NUMBER-X > SPACES                        28890001
                              AND                                       28900001
                      CA-CLASS-NUMBER-X > SPACES                        28910001
                              AND                                       28920001
MK                    CA-SKU-NUMBER-X > SPACES)                         28930017
                       SET CA-NEXT-SKU TO TRUE                          28940001
                       IF CA-DP020-FORMAT-IND = '1'                     28950001
      *-->                 THE NEXT SKU HAS BEEN RETRIEVED FROM THE     28960001
      *-->                 TS LIST CREATED IN F055                      28970001
MK                         MOVE CA-SKU-NUMBER-9 TO NI-SKU-9-8           28980012
                           PERFORM 9505-SELECT-SINGLE-SKU               28990001
                           PERFORM 9050-GET-REPLENISH-IND               29000001
                           PERFORM 6100-MOVE-TSK-TO-COMMAREA            29010001
                           PERFORM 2000-INITIALIZE                      29020001
                       ELSE                                             29030001
                           PERFORM F033-0000-FSKCS033-SECTION           29040001
                   ELSE                                                 29050001
                       SET PS-EDIT-ERROR TO TRUE                        29060001
                       MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         29070001
                   END-IF                                               29080001
               WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               29090001
                   IF CA-STORE-NUMBER-X > SPACES                        29100001
                       SET CA-NEXT-STORE TO TRUE                        29110001
                       PERFORM F033-0000-FSKCS033-SECTION               29120001
                   ELSE                                                 29130001
                       SET PS-EDIT-ERROR TO TRUE                        29140001
                       MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         29150001
                   END-IF                                               29160001
               WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               29170001
                   IF (CA-DEPT-NUMBER-X > SPACES                        29180001
                              AND                                       29190001
MK                    CA-SKU-NUMBER-X = SPACES)                         29200017
                       SET CA-NEXT-DEPT TO TRUE                         29210001
                       PERFORM F033-0000-FSKCS033-SECTION               29220001
                   ELSE                                                 29230001
                       SET PS-EDIT-ERROR TO TRUE                        29240001
                       MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         29250001
                   END-IF                                               29260001
               WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               29270001
                   IF (CA-DEPT-NUMBER-X > SPACES                        29280001
                              AND                                       29290001
MK                    CA-SKU-NUMBER-X = SPACES)                         29300017
                       SET CA-NEXT-CLASS TO TRUE                        29310001
                       PERFORM F033-0000-FSKCS033-SECTION               29320001
                   ELSE                                                 29330001
                       SET PS-EDIT-ERROR TO TRUE                        29340001
                       MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         29350001
                   END-IF                                               29360001
W43143         WHEN DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)               29370099
W43143            IF (STOREO > SPACES AND                               29380099
W43143               STOREO NOT = '00000')                              29390099
W43143              MOVE STOREO TO FS009-STORE-NUMBER-X                 29400099
W43143              IF SKUO > SPACES                                    29410099
W43143                 MOVE SKUO TO FS009-SKU-NUMBER-X                  29420099
W43143               END-IF                                             29430099
W43143              SET FS009-DISPLAY-STR-EXPT TO TRUE                  29440099
W43143             END-IF                                               29450099
           END-EVALUATE.                                                29460001
                                                                        29470001
       6100-MOVE-TSK-TO-COMMAREA.                                       29480001
           MOVE '*6100-MOVE-TSK-TO-COMMAREA.      *' TO DP013-PARAGRAPH 29490001
                                                                        29500001
MK         MOVE SKXREF-DEPT           TO CA-DEPT-NUMBER-9               29510017
MK         MOVE SKXREF-SUBCLASS       TO CA-CLASS-NUMBER-9              29520017
MK         MOVE SKXREF-SKU            TO CA-SKU-NUMBER-9                29530017
           MOVE TSK-SKU-DESC          TO CA-SKU-DESCRIPTION             29540001
      *MED                                                              29550001
           IF PS-SIZE-DESC-FOUND                                        29560001
              MOVE SIZE-KOHLS-DESC       TO CA-TSK-SIZE                 29570001
           ELSE                                                         29580001
              IF TSK-LONG-SIZE-DESC = SPACES                            29590001
                 MOVE TSK-SIZE-DESC      TO CA-TSK-SIZE                 29600001
              ELSE                                                      29610001
                 MOVE TSK-LONG-SIZE-DESC TO CA-TSK-SIZE                 29620001
              END-IF                                                    29630001
           END-IF                                                       29640001
      *MED                                                              29650001
           IF TSK-LONG-COLOR-DESC = SPACES                              29660001
              MOVE TSK-COLOR-DESC       TO CA-TSK-COLOR                 29670001
           ELSE                                                         29680001
              MOVE TSK-LONG-COLOR-DESC  TO CA-TSK-COLOR                 29690001
           END-IF                                                       29700001
      *MED                                                              29710001
           MOVE TSK-ORIG-UNIT-RTL-AMT TO CA-TSK-ORG-RTL                 29720001
                                                                        29730001
           MOVE TSK-CUR-UNIT-RTL-AMT  TO CA-TSK-CUR-RTL                 29740001
                                                                        29750001
           MOVE TSK-UNIT-COST-AMT     TO CA-TSK-COST                    29760001
           IF TSK-GP-QTY > 1                                            29770001
               MOVE TSK-GP-RTL-AMT    TO CA-TSK-GP-RTL                  29780001
               MOVE PC-SLASH          TO CA-TSK-GP-SLASH                29790001
               MOVE TSK-GP-QTY        TO CA-TSK-GP-QTY                  29800001
           ELSE                                                         29810001
               MOVE SPACES            TO CA-TSK-GP-QTY-RTL              29820001
           END-IF.                                                      29830001
                                                                        29840001
           MOVE UPC-RPLNMT-IND        TO CA-VSM-REPLENISH.              29850001
                                                                        29860001
           EJECT                                                        29870001
                                                                        29880001
      ******************************************************************29890099
      *  THIS PARAGRAPH WILL MOVE THE VALUES RETRIEVED FROM TDISTSM.   *29900099
      *  THESE FIELDS INCLUDE THE ON-HAND, ON-ORDER, ENROUTE, WEEKLY   *29910099
      *  SALES, AND INTRANSIT QUANTITIES AND AMOUNTS.                  *29920099
      ******************************************************************29930099
       6500-MOVE-TDISTSM-DATA.                                          29940099
           MOVE '*6500-MOVE-TDISTSM-DATA.         *' TO DP013-PARAGRAPH 29950099
                                                                        29960099
           MOVE DISTSM-OH-QTY          TO CA-CURR-ONHAND-UNITS.         29970099
           MOVE DISTSM-OH-AMT          TO CA-CURR-ONHAND-DLRS.          29980099
           MOVE DISTSM-ONORD-QTY       TO CA-ON-ORDER-UNITS.            29990099
           MOVE DISTSM-ONORD-AMT       TO CA-ON-ORDER-DLRS.             30000099
           MOVE DISTSM-ENTRE-QTY       TO CA-STORE-OH-UNITS.            30010099
           MOVE DISTSM-ENTRE-AMT       TO CA-STORE-OH-DLRS.             30020099
           MOVE DISTSM-SUN-SIS-QTY     TO CA-SUN-UNITS.                 30030099
           MOVE DISTSM-SUN-SIS-AMT     TO CA-SUN-DLRS.                  30040099
           MOVE DISTSM-MON-SIS-QTY     TO CA-MON-UNITS.                 30050099
           MOVE DISTSM-MON-SIS-AMT     TO CA-MON-DLRS.                  30060099
           MOVE DISTSM-TUE-SIS-QTY     TO CA-TUE-UNITS.                 30070099
           MOVE DISTSM-TUE-SIS-AMT     TO CA-TUE-DLRS.                  30080099
           MOVE DISTSM-WED-SIS-QTY     TO CA-WED-UNITS.                 30090099
           MOVE DISTSM-WED-SIS-AMT     TO CA-WED-DLRS.                  30100099
           MOVE DISTSM-THU-SIS-QTY     TO CA-THU-UNITS.                 30110099
           MOVE DISTSM-THU-SIS-AMT     TO CA-THU-DLRS.                  30120099
           MOVE DISTSM-FRI-SIS-QTY     TO CA-FRI-UNITS.                 30130099
           MOVE DISTSM-FRI-SIS-AMT     TO CA-FRI-DLRS.                  30140099
           MOVE DISTSM-SAT-SIS-QTY     TO CA-SAT-UNITS.                 30150099
           MOVE DISTSM-SAT-SIS-AMT     TO CA-SAT-DLRS.                  30160099
           MOVE DISTSM-PWK-SUN-SIS-QTY TO CA-SUN-UNITS-PREV.            30170099
           MOVE DISTSM-PWK-SUN-SIS-AMT TO CA-SUN-DLRS-PREV.             30180099
           MOVE DISTSM-PWK-MON-SIS-QTY TO CA-MON-UNITS-PREV.            30190099
           MOVE DISTSM-PWK-MON-SIS-AMT TO CA-MON-DLRS-PREV.             30200099
           MOVE DISTSM-PWK-TUE-SIS-QTY TO CA-TUE-UNITS-PREV.            30210099
           MOVE DISTSM-PWK-TUE-SIS-AMT TO CA-TUE-DLRS-PREV.             30220099
           MOVE DISTSM-PWK-WED-SIS-QTY TO CA-WED-UNITS-PREV.            30230099
           MOVE DISTSM-PWK-WED-SIS-AMT TO CA-WED-DLRS-PREV.             30240099
           MOVE DISTSM-PWK-THU-SIS-QTY TO CA-THU-UNITS-PREV.            30250099
           MOVE DISTSM-PWK-THU-SIS-AMT TO CA-THU-DLRS-PREV.             30260099
           MOVE DISTSM-PWK-FRI-SIS-QTY TO CA-FRI-UNITS-PREV.            30270099
           MOVE DISTSM-PWK-FRI-SIS-AMT TO CA-FRI-DLRS-PREV.             30280099
           MOVE DISTSM-PWK-SAT-SIS-QTY TO CA-SAT-UNITS-PREV.            30290099
           MOVE DISTSM-PWK-SAT-SIS-AMT TO CA-SAT-DLRS-PREV.             30300099
           MOVE DISTSM-IN-TRNST-QTY    TO CA-IN-TRNST-UNITS.            30310099
           MOVE DISTSM-IN-TRNST-AMT    TO CA-IN-TRNST-DLRS.             30320099
                                                                        30330099
      ******************************************************************30340099
      *  THIS PARAGRAPH WILL ADD THE VALUES RETRIEVED FROM TDISTSM.    *30350099
      *  THESE FIELDS INCLUDE THE ON-HAND, ON-ORDER, ENROUTE, WEEKLY   *30360099
      *  SALES, AND INTRANSIT QUANTITIES AND AMOUNTS.                  *30370099
      ******************************************************************30380099
       6600-ADD-TDISTSM-DATA.                                           30390099
           MOVE '*6600-ADD-TDISTSM-DATA.          *' TO DP013-PARAGRAPH 30400099
                                                                        30410099
           ADD  DISTSM-OH-QTY          TO CA-CURR-ONHAND-UNITS.         30420099
           ADD  DISTSM-OH-AMT          TO CA-CURR-ONHAND-DLRS.          30430099
           ADD  DISTSM-ONORD-QTY       TO CA-ON-ORDER-UNITS.            30440099
           ADD  DISTSM-ONORD-AMT       TO CA-ON-ORDER-DLRS.             30450099
           ADD  DISTSM-ENTRE-QTY       TO CA-STORE-OH-UNITS.            30460099
           ADD  DISTSM-ENTRE-AMT       TO CA-STORE-OH-DLRS.             30470099
           ADD  DISTSM-IN-TRNST-QTY    TO CA-IN-TRNST-UNITS.            30480099
           ADD  DISTSM-IN-TRNST-AMT    TO CA-IN-TRNST-DLRS.             30490099
           ADD  DISTSM-SUN-SIS-QTY     TO CA-SUN-UNITS.                 30500099
           ADD  DISTSM-SUN-SIS-AMT     TO CA-SUN-DLRS.                  30510099
           ADD  DISTSM-MON-SIS-QTY     TO CA-MON-UNITS.                 30520099
           ADD  DISTSM-MON-SIS-AMT     TO CA-MON-DLRS.                  30530099
           ADD  DISTSM-TUE-SIS-QTY     TO CA-TUE-UNITS.                 30540099
           ADD  DISTSM-TUE-SIS-AMT     TO CA-TUE-DLRS.                  30550099
           ADD  DISTSM-WED-SIS-QTY     TO CA-WED-UNITS.                 30560099
           ADD  DISTSM-WED-SIS-AMT     TO CA-WED-DLRS.                  30570099
           ADD  DISTSM-THU-SIS-QTY     TO CA-THU-UNITS.                 30580099
           ADD  DISTSM-THU-SIS-AMT     TO CA-THU-DLRS.                  30590099
           ADD  DISTSM-FRI-SIS-QTY     TO CA-FRI-UNITS.                 30600099
           ADD  DISTSM-FRI-SIS-AMT     TO CA-FRI-DLRS.                  30610099
           ADD  DISTSM-SAT-SIS-QTY     TO CA-SAT-UNITS.                 30620099
           ADD  DISTSM-SAT-SIS-AMT     TO CA-SAT-DLRS.                  30630099
           ADD  DISTSM-PWK-SUN-SIS-QTY TO CA-SUN-UNITS-PREV.            30640099
           ADD  DISTSM-PWK-SUN-SIS-AMT TO CA-SUN-DLRS-PREV.             30650099
           ADD  DISTSM-PWK-MON-SIS-QTY TO CA-MON-UNITS-PREV.            30660099
           ADD  DISTSM-PWK-MON-SIS-AMT TO CA-MON-DLRS-PREV.             30670099
           ADD  DISTSM-PWK-TUE-SIS-QTY TO CA-TUE-UNITS-PREV.            30680099
           ADD  DISTSM-PWK-TUE-SIS-AMT TO CA-TUE-DLRS-PREV.             30690099
           ADD  DISTSM-PWK-WED-SIS-QTY TO CA-WED-UNITS-PREV.            30700099
           ADD  DISTSM-PWK-WED-SIS-AMT TO CA-WED-DLRS-PREV.             30710099
           ADD  DISTSM-PWK-THU-SIS-QTY TO CA-THU-UNITS-PREV.            30720099
           ADD  DISTSM-PWK-THU-SIS-AMT TO CA-THU-DLRS-PREV.             30730099
           ADD  DISTSM-PWK-FRI-SIS-QTY TO CA-FRI-UNITS-PREV.            30740099
           ADD  DISTSM-PWK-FRI-SIS-AMT TO CA-FRI-DLRS-PREV.             30750099
           ADD  DISTSM-PWK-SAT-SIS-QTY TO CA-SAT-UNITS-PREV.            30760099
           ADD  DISTSM-PWK-SAT-SIS-AMT TO CA-SAT-DLRS-PREV.             30770099
                                                                        30780099
      ******************************************************************30790099
      *  THIS PARAGRAPH WILL ADD ZEROS VALUES TO THE SUMMARY FIELDS.   *30800099
      *  THESE FIELDS INCLUDE THE ON-HAND, ON-ORDER, ENROUTE, WEEKLY   *30810099
      *  SALES, AND INTRANSIT QUANTITIES AND AMOUNTS.                  *30820099
      *  THIS PARAGRAPH WILL ONLY BE PERFORMED IF A PROBLEM EXISTS     *30830099
      *  IN THE SETUP OF A REGIONALLY CLEARANCE PRICED SKU.            *30840099
      ******************************************************************30850099
       6650-ADD-TDISTSM-ZERO-DATA.                                      30860099
           MOVE '*6650-ADD-TDISTSM-ZERO-DATA.     *' TO DP013-PARAGRAPH 30870099
                                                                        30880099
           ADD  ZERO                   TO CA-CURR-ONHAND-UNITS.         30890099
           ADD  ZERO                   TO CA-CURR-ONHAND-DLRS.          30900099
           ADD  ZERO                   TO CA-ON-ORDER-UNITS.            30910099
           ADD  ZERO                   TO CA-ON-ORDER-DLRS.             30920099
           ADD  ZERO                   TO CA-STORE-OH-UNITS.            30930099
           ADD  ZERO                   TO CA-STORE-OH-DLRS.             30940099
           ADD  ZERO                   TO CA-IN-TRNST-UNITS.            30950099
           ADD  ZERO                   TO CA-IN-TRNST-DLRS.             30960099
           ADD  ZERO                   TO CA-SUN-UNITS.                 30970099
           ADD  ZERO                   TO CA-SUN-DLRS.                  30980099
           ADD  ZERO                   TO CA-MON-UNITS.                 30990099
           ADD  ZERO                   TO CA-MON-DLRS.                  31000099
           ADD  ZERO                   TO CA-TUE-UNITS.                 31010099
           ADD  ZERO                   TO CA-TUE-DLRS.                  31020099
           ADD  ZERO                   TO CA-WED-UNITS.                 31030099
           ADD  ZERO                   TO CA-WED-DLRS.                  31040099
           ADD  ZERO                   TO CA-THU-UNITS.                 31050099
           ADD  ZERO                   TO CA-THU-DLRS.                  31060099
           ADD  ZERO                   TO CA-FRI-UNITS.                 31070099
           ADD  ZERO                   TO CA-FRI-DLRS.                  31080099
           ADD  ZERO                   TO CA-SAT-UNITS.                 31090099
           ADD  ZERO                   TO CA-SAT-DLRS.                  31100099
           ADD  ZERO                   TO CA-SUN-UNITS-PREV.            31110099
           ADD  ZERO                   TO CA-SUN-DLRS-PREV.             31120099
           ADD  ZERO                   TO CA-MON-UNITS-PREV.            31130099
           ADD  ZERO                   TO CA-MON-DLRS-PREV.             31140099
           ADD  ZERO                   TO CA-TUE-UNITS-PREV.            31150099
           ADD  ZERO                   TO CA-TUE-DLRS-PREV.             31160099
           ADD  ZERO                   TO CA-WED-UNITS-PREV.            31170099
           ADD  ZERO                   TO CA-WED-DLRS-PREV.             31180099
           ADD  ZERO                   TO CA-THU-UNITS-PREV.            31190099
           ADD  ZERO                   TO CA-THU-DLRS-PREV.             31200099
           ADD  ZERO                   TO CA-FRI-UNITS-PREV.            31210099
           ADD  ZERO                   TO CA-FRI-DLRS-PREV.             31220099
           ADD  ZERO                   TO CA-SAT-UNITS-PREV.            31230099
           ADD  ZERO                   TO CA-SAT-DLRS-PREV.             31240099
                                                                        31250099
      ******************************************************************31260099
      *  FLIP THE DATA THAT IS DISPLAYED FROM UNITS TO DOLLARS OR VICE *31270099
      *  VERSA, DEPENDING UPON WHAT WAS PREVIOUSLY DISPLAYED UPON THE  *31280099
      *  SCREEN.                                                       *31290099
      ******************************************************************31300099
                                                                        31310001
       7000-DISPLAY-ALTERNATE-FIELDS.                                   31320001
           MOVE '*7000-DISPLAY-ALTERNATE-FIELDS.  *' TO DP013-PARAGRAPH 31330001
                                                                        31340001
           IF CA-DISPLAY-UNITS                                          31350001
               SET CA-DISPLAY-DOLLARS TO TRUE                           31360001
           ELSE                                                         31370001
               SET CA-DISPLAY-UNITS TO TRUE                             31380001
           END-IF.                                                      31390001
                                                                        31400001
           IF CA-DISPLAY-UNITS                                          31410001
               MOVE PC-UNIT-WKLY-HEADER TO WKLYTO                       31420001
      *        MOVE PC-MAP-BREAKLINE-UNITS TO BRKLINO                   31430092
               PERFORM 2305-FORMAT-CURR-PREV                            31440001
           ELSE                                                         31450001
               MOVE PC-DOLLAR-WKLY-HEADER TO WKLYTO                     31460001
      *        MOVE PC-MAP-BREAKLINE-DLRS TO BRKLINO                    31470092
               PERFORM 2305-FORMAT-CURR-PREV                            31480001
           END-IF.                                                      31490001
                                                                        31500001
           PERFORM 2310-FORMAT-WEEKLY-OUTPUT.                           31510001
                                                                        31520001
           PERFORM 2370-FORMAT-MONTHLY-OUTPUT.                          31530001
                                                                        31540001
           EJECT                                                        31550001
      ******************************************************************31560001
      *  THIS HANDLES THE PROCESSING OF ONE SKU AT A TIME, REGARDLESS   31570001
      *  OF WHETHER THAT SKU WAS OBTAINED FROM SPECIFIC SELECTION, OR   31580001
      *  FROM A CURSOR FETCH.                                           31590001
      ******************************************************************31600001
                                                                        31610001
       9000-PROCESS-SKU-AT-A-TIME.                                      31620001
           MOVE '*9000-PROCESS-SKU-AT-A-TIME.     *' TO DP013-PARAGRAPH 31630001
      *--> GET REPLENISHMENT INDICATOR IF SPECIFIC SKU REQUEST          31640001
MK         IF CA-SKU-NUMBER-X NUMERIC                                   31650017
              PERFORM 9050-GET-REPLENISH-IND                            31660001
           END-IF.                                                      31670001
                                                                        31680001
           IF  NOT (PS-GIFT-W-PURCHASE)                                 31690001
               PERFORM 9100-ACCUMULATE-WEEKLY-DATA                      31700001
               PERFORM 9200-ACCUMULATE-MONTHLY-DATA                     31710001
               PERFORM 9300-GET-ON-ORDER-DATA                           31720001
           END-IF                                                       31730001
                                                                        31740001
           IF  NOT (PS-GIFT-W-PURCHASE)                                 31750001
              IF CA-DISTRICT-NUMBER > SPACES                            31760001
                 SET PS-MORE-STORES TO TRUE                             31770001
                 PERFORM 9530-OPEN-STORE-CURSOR                         31780001
                 PERFORM 9340-MULTIPLE-STORE-STORE-OH                   31790088
                     UNTIL PS-NO-MORE-STORES                            31800001
                 PERFORM 9540-CLOSE-STORE-CURSOR                        31810001
              ELSE                                                      31820001
                 PERFORM 9350-GET-STORE-OH-UNITS                        31830088
              END-IF                                                    31840001
           END-IF.                                                      31850001
                                                                        31860001
MK         IF  CA-SKU-NUMBER-X NUMERIC       AND                        31870017
               CA-STORE-NUMBER-X NOT = '00000' AND                      31880074
               CA-DISTRICT-NUMBER = SPACES                              31890001
               PERFORM 9400-SELECT-TMRITST                              31900001
           ELSE                                                         31910001
               PERFORM 9450-SUMMARIZE-TMRITST                           31920001
           END-IF.                                                      31930001
           EJECT                                                        31940001
                                                                        31950001
      ******************************************************************31960001
      *  THIS HANDLES THE PROCESSING OF REGIONAL CLEARANCE PRICED SKUS. 31970001
      *  THE PROCESS WILL HANDLE ONE SKU AT A TIME, REGARDLESS OF       31980001
      *  WHETHER THAT SKU WAS OBTAINED FROM SPECIFIC SELECTION, OR      31990001
      *  FROM A CURSOR FETCH.                                           32000001
      ******************************************************************32010001
                                                                        32020001
       9010-PROCESS-RCP-SKU-AT-A-TIME.                                  32030001
           MOVE '*9010-PROCESS-RCP-SKU-AT-A-TIME. *' TO DP013-PARAGRAPH 32040001
                                                                        32050001
MK         IF CA-SKU-NUMBER-X NUMERIC                                   32060017
              PERFORM 9050-GET-REPLENISH-IND                            32070001
           END-IF.                                                      32080001
                                                                        32090001
           IF  NOT (PS-GIFT-W-PURCHASE)                                 32100001
               PERFORM 9105-ACCUM-WEEKLY-RCP-DATA                       32110001
               PERFORM 9200-ACCUMULATE-MONTHLY-DATA                     32120001
           END-IF.                                                      32130001
                                                                        32140001
MK         IF  CA-SKU-NUMBER-X NUMERIC       AND                        32150017
               CA-STORE-NUMBER-X NOT = '00000' AND                      32160074
               CA-DISTRICT-NUMBER = SPACES                              32170001
               PERFORM 9400-SELECT-TMRITST                              32180001
           ELSE                                                         32190001
               PERFORM 9450-SUMMARIZE-TMRITST                           32200001
           END-IF.                                                      32210001
           EJECT                                                        32220001
                                                                        32230001
      ******************************************************************32240001
      *  GET REPLENISHMENT INDICATOR FOR EACH SKU                       32250001
      ******************************************************************32260001
                                                                        32270001
       9050-GET-REPLENISH-IND.                                          32280001
                                                                        32290001
           MOVE '*9050-GET-REPLENISH-IND       *' TO DP013-PARAGRAPH    32300001
                                                                        32310001
           MOVE LOW-VALUES        TO PV-REPLEN-LOW.                     32320001
           MOVE HIGH-VALUES       TO PV-REPLEN-HIGH.                    32330001
           MOVE TSK-ITEM-NMBR     TO TUPCSKU-ITEM-NBR.                  32340001
                                                                        32350001
           INITIALIZE PV-RETRY-COUNT.                                   32360001
           PERFORM WITH TEST AFTER                                      32370001
                   UNTIL ((SQLCODE = ZERO)                              32380001
                               OR                                       32390001
                         (SQLCODE = +100)                               32400001
                               OR                                       32410001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     32420001
               EXEC SQL                                                 32430001
                   SELECT B.RPLNMT_IND                                  32440001
                   INTO   :UPC-RPLNMT-IND                               32450001
                   FROM  TUPCSKU A                                      32460001
                        ,TUPC    B                                      32470001
                   WHERE                                                32480001
                       A.ITEM_NBR         = :TUPCSKU-ITEM-NBR AND       32490001
                       A.UPC_NBR          = B.UPC_NBR         AND       32500001
                       B.UPC_TYP_CDE      = 'I'               AND       32510001
                       B.RPLNMT_IND     BETWEEN                         32520001
                         :PV-REPLEN-LOW  AND :PV-REPLEN-HIGH  AND       32530001
                        ((CURRENT DATE  BETWEEN                         32540001
                          B.EFF_BEG_DTE  AND  B.EFF_END_DTE)  OR        32550001
                         (CURRENT DATE   > B.EFF_BEG_DTE      AND       32560001
                          B.EFF_END_DTE  IS NULL))                      32570001
                                                                        32580001
               END-EXEC                                                 32590001
                                                                        32600001
               EVALUATE TRUE                                            32610001
                   WHEN SQLCODE = -911                                  32620001
                   WHEN SQLCODE = -913                                  32630001
                       ADD +1 TO PV-RETRY-COUNT                         32640001
                   WHEN SQLCODE = ZERO                                  32650001
                       MOVE UPC-RPLNMT-IND     TO RPLO                  32660001
                   WHEN SQLCODE = +100                                  32670001
                       CONTINUE                                         32680001
                   WHEN SQLCODE  NOT = +0                               32690001
                   WHEN SQLWARN0 NOT = SPACES                           32700001
                       MOVE PF-ERR-MSG-17 TO DP013-MESSAGE-TEXT(1)      32710001
                       PERFORM 9900-DB2-ERROR                           32720001
               END-EVALUATE                                             32730001
           END-PERFORM.                                                 32740001
                                                                        32750001
      ******************************************************************32760001
      *  GIVEN A SPECIFIC SKU, THE PARAGRAPH WILL CONTROL THE ACCESSING 32770001
      *  OF THE WEEKLY SKU TABLES FOR DATA. IF A SPECIFIC STORE NUMBER  32780001
      *  WAS ENTERED, OR THE PROGRAM DEFAULTED TO STORE '000' (ALL),    32790001
      *  THEN PROCESSING IS DONE FOR THE SPECIFIC STORE NUMBER CONTAINED32800001
      *  WITHIN THE COMMAREA, OTHERWISE, THE STORE CURSOR WHICH WILL    32810001
      *  CONTAIN ALL THE STORES WITHIN THE SELECTED DISTRICT WILL BE    32820001
      *  USED AND PROCESSING WILL BE DONE FOR EACH STORE FOUND WITHIN   32830001
      *  THAT CURSOR.                                                   32840001
      ******************************************************************32850001
                                                                        32860001
       9100-ACCUMULATE-WEEKLY-DATA.                                     32870001
           MOVE '*9100-ACCUMULATE-WEEKLY-DATA.    *' TO DP013-PARAGRAPH 32880001
                                                                        32890001
           IF CA-STORE-NUMBER-X > SPACES                                32900001
               PERFORM 9110-ONE-STORE-WEEKLY                            32910001
           ELSE                                                         32920001
               SET PS-MORE-STORES TO TRUE                               32930001
               SET PS-NO-STORES-FOUND TO TRUE                           32940001
               PERFORM 9530-OPEN-STORE-CURSOR                           32950001
               PERFORM 9130-MULTIPLE-STORE-WEEKLY                       32960001
                   UNTIL PS-NO-MORE-STORES                              32970001
               PERFORM 9540-CLOSE-STORE-CURSOR                          32980001
           END-IF.                                                      32990001
                                                                        33000001
           EJECT                                                        33010001
                                                                        33020001
      ******************************************************************33030001
      *  GIVEN A SPECIFIC REGIONALLY CLEARANCE PRICED SKU, THIS         33040001
      *  PARAGRAPH WILL CONTROL THE ACCESSING OF THE SALES DATA.        33050001
      *  IF A SPECIFIC STORE NUMBER WAS ENTERED, THEN PROCESSING IS     33060001
      *  DONE VIA THE STORE ENTERED IN THE COMMAREA.  IF STORE '000' OR 33070001
      *  OR A SPECIFIC DISTRICT WAS ENTERED, THEN PROCESSING IS         33080001
      *  DONE VIA THE STORES CURSOR.                                    33090001
      ******************************************************************33100001
                                                                        33110001
       9105-ACCUM-WEEKLY-RCP-DATA.                                      33120001
           MOVE '*9105-ACCUM-WEEKLY-RCP-DATA.    *' TO DP013-PARAGRAPH  33130001
                                                                        33140001
           IF CA-STORE-NUMBER-X > SPACES                                33150001
              IF CA-STORE-NUMBER-X = PC-STORE-ZERO-X                    33160001
                 MOVE PC-STORE-ZERO   TO PV-STORE-NUMBER                33170074
                 MOVE PV-STORE-NUMBER TO PV-STORE-NUMBER-COMP           33180084
                 PERFORM 9585-SELECT-SKU-STORE                          33190001
                 IF SQLCODE = 0                                         33200001
                    PERFORM 9185-RCP-SKU-STORE-DATA                     33210001
                    PERFORM 9195-RCP-STORE-AT-A-TIME                    33220001
                 END-IF                                                 33230001
              ELSE                                                      33240001
                 PERFORM 9525-SELECT-SINGLE-STORE                       33250001
                 IF SQLCODE = 0                                         33260001
                    MOVE XMT00001-LOC-NBR   TO PV-STORE-NUMBER-COMP     33270084
                    MOVE XMT00001-LOC-NBR   TO PV-STORE-NUMBER          33280084
                    PERFORM 9585-SELECT-SKU-STORE                       33290001
                    IF SQLCODE = 0                                      33300001
                       PERFORM 9185-RCP-SKU-STORE-DATA                  33310001
                       PERFORM 9195-RCP-STORE-AT-A-TIME                 33320001
                    END-IF                                              33330001
                 ELSE                                                   33340001
                    IF NOT PS-EDIT-ERROR                                33350001
                       SET PS-EDIT-ERROR TO TRUE                        33360001
                       MOVE PC-TSYMSG-00408 TO DP020-MSG-NUMBER         33370001
                    END-IF                                              33380001
                 END-IF                                                 33390001
              END-IF                                                    33400001
           ELSE                                                         33410001
               SET PS-MORE-STORES TO TRUE                               33420001
               SET PS-NO-STORES-FOUND TO TRUE                           33430001
               PERFORM 9189-DISTRICT-SUMS                               33440099
               PERFORM 9530-OPEN-STORE-CURSOR                           33450001
               PERFORM 9130-MULTIPLE-STORE-WEEKLY                       33460001
                   UNTIL PS-NO-MORE-STORES                              33470001
               PERFORM 9540-CLOSE-STORE-CURSOR                          33480001
           END-IF.                                                      33490001
                                                                        33500001
           EJECT                                                        33510001
                                                                        33520001
      ******************************************************************33530001
      * THIS PARAGRAPH WILL HANDLE PROCESSING FOR THE SINGLE STORE      33540001
      * NUMBER ENTERED IN THE COMMAREA. IF THE STORE NUMBER IS '000'    33550001
      * (ALL STORES), THERE WILL BE NO ROW IN THE XMT_LOC STORE TABLE,  33560075
      * OTHERWISE THE ROW ON THE STORE TABLE IS RETRIEVED TO GET STORE  33570001
      * NAME FOR THE SPECIFIC STORE.                                    33580001
      ******************************************************************33590001
                                                                        33600001
       9110-ONE-STORE-WEEKLY.                                           33610001
           MOVE '*9110-ONE-STORE-WEEKLY.          *' TO DP013-PARAGRAPH 33620001
                                                                        33630001
           IF CA-STORE-NUMBER-X EQUAL PC-STORE-ZERO-X                   33640001
               CONTINUE                                                 33650001
           ELSE                                                         33660001
               PERFORM 9525-SELECT-SINGLE-STORE                         33670001
               IF SQLCODE NOT EQUAL ZERO                                33680001
                   IF NOT PS-EDIT-ERROR                                 33690001
                       SET PS-EDIT-ERROR TO TRUE                        33700001
                       MOVE PC-TSYMSG-00408 TO DP020-MSG-NUMBER         33710001
                   END-IF                                               33720001
               END-IF                                                   33730001
           END-IF.                                                      33740001
                                                                        33750001
      * THE ROW FOR THIS STORE IS RETRIEVED FROM THE TSKST TABLE AND    33760001
      * ALL THE WEEKLY ROWS (FROM TSKSTWKS AND TSKSTWKI) ARE PROC-      33770001
      * ESSED. NO ERROR MESSAGES ARE SENT TO USERS IF THESE ROWS ARE    33780001
      * NOT FOUND, THE DATA FIELDS ON THE SCREEN WILL SIMPLY BE ZEROS.  33790001
           IF ((CA-STORE-NUMBER-X EQUAL PC-STORE-ZERO-X)                33800001
                              OR                                        33810001
              (CA-STORE-NUMBER-X NOT EQUAL PC-STORE-ZERO-X              33820001
                                 AND                                    33830001
                        SQLCODE EQUAL ZERO))                            33840001
               PERFORM 9180-RETRIEVE-SKU-STORE-DATA                     33850001
               IF SQLCODE EQUAL ZERO                                    33860001
                      PERFORM 9190-WEEKLY-STORE-AT-A-TIME               33870001
               END-IF                                                   33880001
           END-IF.                                                      33890001
                                                                        33900001
           EJECT                                                        33910001
                                                                        33920001
      ******************************************************************33930001
      * THIS PARAGRAPH WILL HANDLE PROCESSING FOR THE THE MULTIPLE      33940001
      * STORES WHICH FALL WITHIN THE ENTERED DISTRICT. THE STORE CURSOR 33950001
      * IS OPENED, AND FOR EACH STORE FOUND, THE ROW FROM THE TSKST     33960001
      * TABLE IS RETRIEVED AND PROCESSING IS DONE FOR ALL THE WEEKLY    33970001
      * ROWS FROM TSKSTWKS AND TSKSTWKI.                                33980001
      * NOTE: ADDED CODE FOR REGIONALLY CLEARANCE PRICED SKUS.          33990001
      ******************************************************************34000001
                                                                        34010001
       9130-MULTIPLE-STORE-WEEKLY.                                      34020001
                                                                        34030001
           PERFORM 9535-FETCH-STORE-FROM-CURSOR.                        34040001
                                                                        34050001
           IF SQLCODE EQUAL ZERO                                        34060001
               IF TSK-REGN-PRIC-IND = 'Y'                               34070001
                  PERFORM 9186-SET-STORE-NUMBER                         34080001
                  PERFORM 9185-RCP-SKU-STORE-DATA                       34090001
                  PERFORM 9195-RCP-STORE-AT-A-TIME                      34100001
               ELSE                                                     34110001
                  PERFORM 9180-RETRIEVE-SKU-STORE-DATA                  34120001
                  IF SQLCODE EQUAL ZERO                                 34130001
MC1101               IF (SQLCODE = ZERO)                                34140099
                        PERFORM 9190-WEEKLY-STORE-AT-A-TIME             34150001
MC1101               END-IF                                             34160001
                  END-IF                                                34170001
               END-IF                                                   34180001
           ELSE                                                         34190001
               IF SQLCODE EQUAL +100                                    34200001
                   IF PS-NO-STORES-FOUND                                34210001
                       IF NOT PS-EDIT-ERROR                             34220001
                           SET PS-EDIT-ERROR TO TRUE                    34230001
                       END-IF                                           34240001
                   END-IF                                               34250001
               END-IF                                                   34260001
           END-IF.                                                      34270001
                                                                        34280001
           EJECT                                                        34290001
                                                                        34300001
      ******************************************************************34310001
      * GET THE SKU STORE ROW CORRESPONDING TO THE CURRENT SKU AND STORE34320001
      * NUMBER AND ADD THE DATA NEEDED TO THE COMMAREA ACCUMULATORS.    34330001
      * THIS SAME PARAGRAPH IS PERFORMED REGARDLESS OF WHETHER THE SKU  34340001
      * AND STORE WERE ENTERED SPECIFICALLY BY THE USER, OR WERE GOTTEN 34350001
      * AS FETCHES FROM SKU AND STORE CURSORS.                          34360001
      ******************************************************************34370001
                                                                        34380001
       9180-RETRIEVE-SKU-STORE-DATA.                                    34390001
           MOVE '*9180-RETRIEVE-SKU-STORE-DATA.   *' TO DP013-PARAGRAPH 34400001
                                                                        34410001
      * PV-STORE-NUMBER IS USED WITHIN THE SELECT FOR TSKST.            34420001
           IF CA-STORE-NUMBER-X EQUAL PC-STORE-ZERO-X                   34430001
               MOVE PC-STORE-ZERO   TO PV-STORE-NUMBER                  34440074
               MOVE PV-STORE-NUMBER TO PV-STORE-NUMBER-COMP             34450084
           ELSE                                                         34460001
               MOVE XMT00001-LOC-NBR   TO PV-STORE-NUMBER-COMP          34470084
               MOVE XMT00001-LOC-NBR   TO PV-STORE-NUMBER               34480084
           END-IF.                                                      34490001
                                                                        34500001
           PERFORM 9585-SELECT-SKU-STORE.                               34510001
                                                                        34520001
                                                                        34530001
      * THE MODEL STOCK UNITS ARE FOUND ON THE TSKST TABLE. THE MODEL   34540001
      * STOCK DOLLARS ARE COMPUTED FROM CURRENT RETAIL AND UNITS.       34550001
                                                                        34560001
           IF SQLCODE NOT EQUAL ZERO                                    34570001
               CONTINUE                                                 34580001
           ELSE                                                         34590001
               IF TSK-GP-QTY > 1                                        34600001
                   COMPUTE PV-CUR-UNIT-RTL-AMT =                        34610001
                       TSK-GP-RTL-AMT / TSK-GP-QTY                      34620001
               ELSE                                                     34630001
                   MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT     34640001
               END-IF                                                   34650001
MK             IF (CA-SKU-NUMBER-9 > 0) AND                             34660017
                  CA-DISTRICT-NUMBER = SPACES                           34670001
      *-->         FULLY QUALIFIED SKU                                  34680001
                   MOVE TSKST-ONHAND-QTY TO CA-CURR-ONHAND-UNITS        34690001
                   COMPUTE PV-ONHAND-DLRS =                             34700001
                           TSKST-ONHAND-QTY * PV-CUR-UNIT-RTL-AMT       34710001
                   MOVE PV-ONHAND-DLRS TO CA-CURR-ONHAND-DLRS           34720001
               ELSE                                                     34730001
                   ADD TSKST-ONHAND-QTY TO CA-CURR-ONHAND-UNITS         34740001
                   COMPUTE PV-ONHAND-DLRS =                             34750001
                           TSKST-ONHAND-QTY * PV-CUR-UNIT-RTL-AMT       34760001
                   ADD PV-ONHAND-DLRS TO CA-CURR-ONHAND-DLRS            34770001
               END-IF                                                   34780001
           END-IF.                                                      34790001
                                                                        34800001
      ******************************************************************34810001
      * GET THE SKU STORE ROW CORRESPONDING TO THE CURRENT SKU AND STORE34820001
      * NUMBER AND ADD THE DATA NEEDED TO THE COMMAREA ACCUMULATORS.    34830001
      * THIS SAME PARAGRAPH IS PERFORMED REGARDLESS OF WHETHER THE SKU  34840001
      * AND STORE WERE ENTERED SPECIFICALLY BY THE USER, OR WERE GOTTEN 34850001
      * AS FETCHES FROM SKU AND STORE CURSORS.                          34860001
      * NOTE: THIS IS THE REGIONAL CLEARANCE PRICE METHOD FOR GETTING   34870001
      * THE DATA.                                                       34880001
      ******************************************************************34890001
       9185-RCP-SKU-STORE-DATA.                                         34900001
           MOVE '*9185-RCP-SKU-STORE-DATA.   *' TO DP013-PARAGRAPH.     34910001
                                                                        34920001
MK         SET PS-TUPCPLS-ROW-NOT-FOUND TO TRUE.                        34930054
                                                                        34940054
           IF (CA-STORE-NUMBER-X = PC-STORE-ZERO-X) OR                  34950001
              (CA-DISTRICT-NUMBER > SPACES)                             34960001
MK            IF (CA-SKU-NUMBER-9 > 0)                                  34970017
                 IF TSK-STATUS-CODE = 25                                34980001
                    MOVE 'MIXED' TO CA-TSK-CUR-RTL-X                    34990099
                    PERFORM 9187-SET-TDISTSM-VALUES                     35000099
                    PERFORM 9600-SUM-TDISTSM-DATA                       35010099
                    IF SQLCODE = 0                                      35020099
                       PERFORM 6500-MOVE-TDISTSM-DATA                   35030099
                    ELSE                                                35040099
                       PERFORM 6650-ADD-TDISTSM-ZERO-DATA               35050099
                    END-IF                                              35060099
                 END-IF                                                 35070099
                 IF TSK-STATUS-CODE = 30                                35080099
                    MOVE 'MIXED' TO CA-TSK-CUR-RTL-X                    35090099
                    PERFORM 9187-SET-TDISTSM-VALUES                     35100099
                    PERFORM 9700-SELECT-TDISTSM-DATA                    35110099
                    PERFORM 6500-MOVE-TDISTSM-DATA                      35120099
                 END-IF                                                 35130099
              ELSE                                                      35140099
                 IF CA-DISTRICT-NUMBER > SPACES                         35150099
                    CONTINUE                                            35160099
                 ELSE                                                   35170099
                    PERFORM 9189-DISTRICT-SUMS                          35180099
                 END-IF                                                 35190001
              END-IF                                                    35200001
           ELSE                                                         35210001
MK            IF (CA-SKU-NUMBER-9 > 0)                                  35220017
                 MOVE CA-STORE-NUMBER-9 TO PV-STORE-NUMBER-COMP         35230001
                 PERFORM 9800-SELECT-TUPCPLS-DATA                       35240001
                 IF SQLCODE = 0                                         35250001
                    MOVE UPCPLS-UNT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT      35260001
                                               CA-TSK-CUR-RTL           35270001
                 ELSE                                                   35280001
                    MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT    35290001
                 END-IF                                                 35300001
                 MOVE TSKST-ONHAND-QTY TO CA-CURR-ONHAND-UNITS          35310001
                 COMPUTE PV-ONHAND-DLRS = TSKST-ONHAND-QTY *            35320001
                                          PV-CUR-UNIT-RTL-AMT           35330001
                 MOVE PV-ONHAND-DLRS TO CA-CURR-ONHAND-DLRS             35340001
                 PERFORM 9300-GET-ON-ORDER-DATA                         35350001
              ELSE                                                      35360001
                 MOVE CA-STORE-NUMBER-9 TO PV-STORE-NUMBER-COMP         35370001
                 PERFORM 9800-SELECT-TUPCPLS-DATA                       35380001
                 IF SQLCODE = 0                                         35390001
                    IF (CA-STATUS = 25)                                 35400001
                       IF (CA-STAT-20-ENTERED AND CA-STAT-30-ENTERED)   35410001
                       OR (CA-STAT-25-ENTERED)                          35420001
                       OR (CA-STAT-30-ENTERED)                          35430001
                          MOVE UPCPLS-UNT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT35440001
                          ADD TSKST-ONHAND-QTY TO CA-CURR-ONHAND-UNITS  35450001
                       ELSE                                             35460001
                          MOVE ZERO TO PV-CUR-UNIT-RTL-AMT              35470001
                       END-IF                                           35480001
                    ELSE                                                35490001
                       IF (CA-STAT-30-ENTERED)                          35500001
                          MOVE UPCPLS-UNT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT35510001
                          ADD TSKST-ONHAND-QTY TO CA-CURR-ONHAND-UNITS  35520001
                       ELSE                                             35530001
                          MOVE ZERO TO PV-CUR-UNIT-RTL-AMT              35540001
                       END-IF                                           35550001
                    END-IF                                              35560001
                 ELSE                                                   35570001
                    IF (CA-STAT-20-ENTERED) OR (CA-STAT-25-ENTERED)     35580001
                       MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT 35590001
                       ADD TSKST-ONHAND-QTY TO CA-CURR-ONHAND-UNITS     35600001
                    ELSE                                                35610001
MK                     IF TSK-STATUS-CODE = 30                          35620056
MK                        MOVE TSK-CUR-UNIT-RTL-AMT TO                  35630053
MK                                   PV-CUR-UNIT-RTL-AMT                35640053
MK                        ADD TSKST-ONHAND-QTY TO CA-CURR-ONHAND-UNITS  35650053
MK                     ELSE                                             35660053
MK                        MOVE ZERO TO PV-CUR-UNIT-RTL-AMT              35670053
MK                     END-IF                                           35680053
                    END-IF                                              35690053
                 END-IF                                                 35700001
                 COMPUTE PV-ONHAND-DLRS = TSKST-ONHAND-QTY *            35710001
                                          PV-CUR-UNIT-RTL-AMT           35720001
                 ADD PV-ONHAND-DLRS TO CA-CURR-ONHAND-DLRS              35730001
                 PERFORM 9300-GET-ON-ORDER-DATA                         35740001
              END-IF                                                    35750001
           END-IF.                                                      35760001
                                                                        35770001
           EJECT                                                        35780001
      ******************************************************************35790001
      * THIS PARAGRAPH WILL MOVE THE VALUES NEEDED FOR THE SELECTS OF   35800001
      * TSKSTWKS, TSKSTWKI AND TSKSTMTH FOR RCP SKUS.                   35810001
      ******************************************************************35820001
       9186-SET-STORE-NUMBER.                                           35830001
           MOVE '*9186-SET-STORE-NUMBER.     *' TO DP013-PARAGRAPH      35840001
                                                                        35850001
      * STORE NUMBER IS USED WITHIN THE SELECTS FOR TSKSTWKS, TSKSTWKI, 35860001
      * AND TSKSTMTH.                                                   35870001
           IF CA-STORE-NUMBER-X EQUAL PC-STORE-ZERO-X                   35880001
               MOVE PC-STORE-ZERO   TO PV-STORE-NUMBER                  35890074
                                       TSKST-LOC-NBR                    35900075
               MOVE PC-STORE-ZERO   TO PV-STORE-NUMBER-COMP             35910084
           ELSE                                                         35920001
               MOVE XMT00001-LOC-NBR   TO PV-STORE-NUMBER               35930074
                                          TSKST-LOC-NBR                 35940075
                                          PV-STORE-NUMBER-COMP          35950084
           END-IF.                                                      35960001
                                                                        35970001
           EJECT                                                        35980001
      ******************************************************************35990099
      * THIS PARAGRAPH WILL MOVE THE VALUES NEEDED FOR THE DATABASE CALL36000099
      * TO TDISTSM.  REGIONAL CLEARANCE PRICED SKU SUMMARY.             36010099
      ******************************************************************36020099
                                                                        36030099
       9187-SET-TDISTSM-VALUES.                                         36040099
           MOVE '*9187-SET-TDISTSM-VALUES.   *' TO DP013-PARAGRAPH      36050099
                                                                        36060099
           IF CA-STORE-NUMBER-X = '00000'                               36070099
              MOVE PV-ALL-SUM-LVL-CDE TO PV-SUM-LVL-CDE                 36080099
              MOVE PV-BLANK-DISTRICT TO PV-TDISTSM-DISTRICT             36090099
           ELSE                                                         36100099
              MOVE PV-DIST-SUM-LVL-CDE TO PV-SUM-LVL-CDE                36110099
              MOVE CA-DISTRICT-NUMBER TO PV-TDISTSM-DISTRICT            36120099
           END-IF.                                                      36130099
                                                                        36140099
           IF TSK-STATUS-CODE = 30                                      36150099
              MOVE '30' TO PV-TDISTSM-STATUS-CDE                        36160099
           END-IF.                                                      36170099
                                                                        36180099
      ******************************************************************36190099
      * THIS PARAGRAPH WILL MOVE THE VALUES NEEDED FOR THE DATABASE CALL36200099
      * TO TDISTSM.  REGIONAL CLEARANCE PRICED SKU SUMMARY.             36210099
      ******************************************************************36220099
                                                                        36230099
       9188-SET-TDISTSM-VALUES.                                         36240099
           MOVE '*9188-SET-TDISTSM-VALUES.   *' TO DP013-PARAGRAPH      36250099
                                                                        36260099
           IF CA-STORE-NUMBER-X = '00000'                               36270099
              MOVE PV-ALL-SUM-LVL-CDE TO PV-SUM-LVL-CDE                 36280099
              MOVE PV-BLANK-DISTRICT TO PV-TDISTSM-DISTRICT             36290099
           ELSE                                                         36300099
              MOVE PV-DIST-SUM-LVL-CDE TO PV-SUM-LVL-CDE                36310099
              MOVE CA-DISTRICT-NUMBER TO PV-TDISTSM-DISTRICT            36320099
           END-IF.                                                      36330099
                                                                        36340099
           IF (CA-STAT-20-ENTERED)                                      36350099
              MOVE '20' TO PV-TDISTSM-STATUS-CDE                        36360099
           ELSE                                                         36370099
              IF (CA-STAT-30-ENTERED)                                   36380099
                 MOVE '30' TO PV-TDISTSM-STATUS-CDE                     36390099
              ELSE                                                      36400099
                 MOVE '  ' TO PV-TDISTSM-STATUS-CDE                     36410099
              END-IF                                                    36420099
           END-IF.                                                      36430099
                                                                        36440099
      ******************************************************************36450099
      * THIS PARAGRAPH WILL BE PERFORMED FOR EITHER DISTRICT CRITERIA   36460099
      * OR FULLY QUALIFED SKU CRITERIA TO OBTAIN SUMS FROM THE RCP      36470099
      * SUMMARY TABLE - TDISTSM.                                        36480099
      ******************************************************************36490099
       9189-DISTRICT-SUMS.                                              36500099
           MOVE '*9189-DISTRICT-SUMS.        *' TO DP013-PARAGRAPH.     36510099
                                                                        36520099
           IF (CA-STAT-20-ENTERED AND CA-STAT-30-ENTERED)               36530099
            OR (CA-STAT-25-ENTERED)                                     36540099
              PERFORM 9188-SET-TDISTSM-VALUES                           36550099
              PERFORM 9600-SUM-TDISTSM-DATA                             36560099
              IF SQLCODE = 0                                            36570099
                 PERFORM 6600-ADD-TDISTSM-DATA                          36580099
              ELSE                                                      36590099
                 PERFORM 6650-ADD-TDISTSM-ZERO-DATA                     36600099
              END-IF                                                    36610099
           ELSE                                                         36620099
              IF (CA-STAT-20-ENTERED)                                   36630099
                 PERFORM 9188-SET-TDISTSM-VALUES                        36640099
                 PERFORM 9700-SELECT-TDISTSM-DATA                       36650099
                 PERFORM 6600-ADD-TDISTSM-DATA                          36660099
              ELSE                                                      36670099
                 IF (CA-STAT-30-ENTERED)                                36680099
                    PERFORM 9188-SET-TDISTSM-VALUES                     36690099
                    PERFORM 9700-SELECT-TDISTSM-DATA                    36700099
                    PERFORM 6600-ADD-TDISTSM-DATA                       36710099
                 ELSE                                                   36720099
                    PERFORM 6650-ADD-TDISTSM-ZERO-DATA                  36730099
                 END-IF                                                 36740099
              END-IF                                                    36750099
           END-IF.                                                      36760099
                                                                        36770001
      ******************************************************************36780001
      * ACCESS THE SKU WEEKLY SALES AND INVENTORY FOR A PARTICULAR SKU  36790001
      * AND STORE TO OBTAIN ACCUMULATOR DATA. THIS SAME PARAGRAPH IS    36800001
      * PERFORMED REGARDLESS OF WHETHER THE SKU AND STORE WERE ENTERED  36810001
      * SPECIFICALLY BY THE USER OR WHETHER THE SKU AND STORE NUMBER    36820001
      * CAME FROM A CURSOR FETCH. ONLY THE LAST 5 WEEKS OF DATA WILL    36830001
      * BE RETRIEVED FROM THE TSKSTWKS AND TSKSTWKI TABLES.             36840001
      ******************************************************************36850001
                                                                        36860001
       9190-WEEKLY-STORE-AT-A-TIME.                                     36870001
           MOVE '*9190-WEEKLY-STORE-AT-A-TIME.    *' TO DP013-PARAGRAPH 36880001
                                                                        36890001
           PERFORM 9555-OPEN-TSKSTWKS-CURSOR.                           36900001
           SET PS-MORE-WEEKS TO TRUE.                                   36910001
                                                                        36920001
      * FOR EACH ROW RETRIEVED FROM THE WEEKLY SALES TABLE, THE PROPER  36930001
      * ENTRY IN THE COMMAREA WEEKLY DATA ACCUMULATION TABLE IS DETER-  36940001
      * MINED BY COMPARING THE BOW DATE FROM THE TABLE ROW TO THE       36950001
      * BOW DATE HELD IN THE PROGRAM WEEKLY TABLE. THE COMMAREA         36960001
      * WEEKLY ACCUMULATION INDEX IS THEN SET TO THE SAME INDEX VALUE AS36970001
      * THE PROGRAM WEEKLY TABLE ENTRY AND THE DATA VALUES FROM THE     36980001
      * TSKSTWKS ROW ARE ADDED TO THE APPROPRIATE FIELDS WITHIN THE     36990001
      * COMMAREA WEEKLY DATA ACCUMULATION TABLE DEPENDING UPON THE TYPE 37000001
      * OF SALE. THE DAY BY DAY SALES INFORMATION IS KEPT ONLY FOR THE  37010001
      * CURRENT WEEK (COMMAREA TABLE ENTRY 1).                          37020001
           PERFORM UNTIL PS-NO-MORE-WEEKS                               37030001
               PERFORM 9550-FETCH-WEEKLY-SALES                          37040001
               IF SQLCODE = ZERO                                        37050001
                   PERFORM VARYING PV-WEEKLY-INDEX                      37060001
                           FROM 1 BY 1                                  37070001
                           UNTIL (SKSTWKS-FSCL-BOW-DTE =                37080001
                                 PV-WKLY-BOW-DATE (PV-WEEKLY-INDEX)     37090001
                                          OR                            37100001
                                 PV-WEEKLY-INDEX > PC-MAX-NUM-WEEKS)    37110001
                   END-PERFORM                                          37120001
                   IF PV-WEEKLY-INDEX = PC-CURRENT-WEEK                 37130001
                       ADD SKSTWKS-SUN-SLS-UNIT-QTY TO                  37140001
                                             CA-SUN-UNITS               37150001
                       ADD SKSTWKS-MON-SLS-UNIT-QTY TO                  37160001
                                             CA-MON-UNITS               37170001
                       ADD SKSTWKS-TUE-SLS-UNIT-QTY TO                  37180001
                                             CA-TUE-UNITS               37190001
                       ADD SKSTWKS-WED-SLS-UNIT-QTY TO                  37200001
                                             CA-WED-UNITS               37210001
                       ADD SKSTWKS-THU-SLS-UNIT-QTY TO                  37220001
                                             CA-THU-UNITS               37230001
                       ADD SKSTWKS-FRI-SLS-UNIT-QTY TO                  37240001
                                             CA-FRI-UNITS               37250001
                       ADD SKSTWKS-SAT-SLS-UNIT-QTY TO                  37260001
                                             CA-SAT-UNITS               37270001
                   END-IF                                               37280001
                   IF PV-WEEKLY-INDEX = PC-PREVIOUS-WEEK                37290001
                       ADD SKSTWKS-SUN-SLS-UNIT-QTY TO                  37300001
                                             CA-SUN-UNITS-PREV          37310001
                       ADD SKSTWKS-MON-SLS-UNIT-QTY TO                  37320001
                                             CA-MON-UNITS-PREV          37330001
                       ADD SKSTWKS-TUE-SLS-UNIT-QTY TO                  37340001
                                             CA-TUE-UNITS-PREV          37350001
                       ADD SKSTWKS-WED-SLS-UNIT-QTY TO                  37360001
                                             CA-WED-UNITS-PREV          37370001
                       ADD SKSTWKS-THU-SLS-UNIT-QTY TO                  37380001
                                             CA-THU-UNITS-PREV          37390001
                       ADD SKSTWKS-FRI-SLS-UNIT-QTY TO                  37400001
                                             CA-FRI-UNITS-PREV          37410001
                       ADD SKSTWKS-SAT-SLS-UNIT-QTY TO                  37420001
                                             CA-SAT-UNITS-PREV          37430001
                   END-IF                                               37440001
                   IF PV-WEEKLY-INDEX NOT GREATER THAN                  37450001
                                                   PC-MAX-NUM-WEEKS     37460001
                       SET CA-WKLY-INDEX TO PV-WEEKLY-INDEX             37470001
                       MOVE SKSTWKS-SALES-TYPE-CODE TO                  37480001
                                                 PV-SALES-TYPE-CODE     37490001
                       EVALUATE TRUE                                    37500001
                           WHEN PV-REGULAR                              37510001
                               ADD SKSTWKS-SALES-UNIT-QTY TO            37520001
                                    CA-WKLY-REG-UNITS (CA-WKLY-INDEX)   37530001
                               ADD SKSTWKS-SALES-AMT TO                 37540001
                                    CA-WKLY-REG-DLRS (CA-WKLY-INDEX)    37550001
                           WHEN PV-PROMOTIONAL                          37560001
                               ADD SKSTWKS-SALES-UNIT-QTY TO            37570001
                                    CA-WKLY-PRO-UNITS (CA-WKLY-INDEX)   37580001
                               ADD SKSTWKS-SALES-AMT TO                 37590001
                                    CA-WKLY-PRO-DLRS (CA-WKLY-INDEX)    37600001
                           WHEN PV-CLEARANCE                            37610001
                               ADD SKSTWKS-SALES-UNIT-QTY TO            37620001
                                    CA-WKLY-CLR-UNITS (CA-WKLY-INDEX)   37630001
                               ADD SKSTWKS-SALES-AMT TO                 37640001
                                    CA-WKLY-CLR-DLRS (CA-WKLY-INDEX)    37650001
                       END-EVALUATE                                     37660001
                   END-IF                                               37670001
               END-IF                                                   37680001
           END-PERFORM.                                                 37690001
                                                                        37700001
           PERFORM 9560-CLOSE-TSKSTWKS-CURSOR.                          37710001
                                                                        37720001
      * FOR EACH WEEK WITHIN THE PROGRAM WEEKLY DATE TABLE, THE         37730001
      * TSKSTWKI TABLE IS READ TO FIND THE WEEKLY INVENTORY INFOR-      37740001
      * MATION. THE ONHAND INFORMATION IS FOUND ON THE WEEKLY INVEN-    37750001
      * TORY TABLE.                                                     37760001
           PERFORM VARYING PV-WEEKLY-INDEX                              37770001
                   FROM 1 BY 1                                          37780001
                   UNTIL PV-WEEKLY-INDEX GREATER THAN                   37790001
                                                   PC-MAX-NUM-WEEKS     37800001
               MOVE PV-WKLY-BOW-DATE (PV-WEEKLY-INDEX) TO               37810001
                                                    PV-WEEK-IND         37820001
               SET CA-WKLY-INDEX TO PV-WEEKLY-INDEX                     37830001
               PERFORM 9565-SELECT-WEEKLY-INVENTORY                     37840001
               IF SQLCODE = ZERO                                        37850001
                   IF TSK-GP-QTY > 1                                    37860001
                       COMPUTE PV-CUR-UNIT-RTL-AMT =                    37870001
                           TSK-GP-RTL-AMT / TSK-GP-QTY                  37880001
                   ELSE                                                 37890001
                       MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT 37900001
                   END-IF                                               37910001
                   ADD SKSTWKI-INVEN-ONHAND-QTY TO                      37920001
                                  CA-WKLY-ONHAND-UNITS (CA-WKLY-INDEX)  37930001
                   COMPUTE PV-ONHAND-DLRS =                             37940001
                           SKSTWKI-INVEN-RTL-AMT * 1                    37950001
                   ADD PV-ONHAND-DLRS TO                                37960001
                                  CA-WKLY-ONHAND-DLRS (CA-WKLY-INDEX)   37970001
               END-IF                                                   37980001
           END-PERFORM.                                                 37990001
                                                                        38000001
           EJECT                                                        38010001
                                                                        38020001
      ******************************************************************38030001
      * ACCESS THE SKU WEEKLY SALES AND INVENTORY FOR A PARTICULAR SKU  38040001
      * AND STORE TO OBTAIN ACCUMULATOR DATA. THIS SAME PARAGRAPH IS    38050001
      * PERFORMED REGARDLESS OF WHETHER THE SKU AND STORE WERE ENTERED  38060001
      * SPECIFICALLY BY THE USER OR WHETHER THE SKU AND STORE NUMBER    38070001
      * CAME FROM A CURSOR FETCH. ONLY THE LAST 5 WEEKS OF DATA WILL    38080001
      * BE RETRIEVED FROM THE TSKSTWKS AND TSKSTWKI TABLES.             38090001
      ******************************************************************38100001
                                                                        38110001
       9195-RCP-STORE-AT-A-TIME.                                        38120001
           MOVE '*9195-RCP-STORE-AT-A-TIME.    *' TO DP013-PARAGRAPH    38130001
                                                                        38140001
           PERFORM 9555-OPEN-TSKSTWKS-CURSOR.                           38150001
           SET PS-MORE-WEEKS TO TRUE.                                   38160001
                                                                        38170001
      * FOR EACH ROW RETRIEVED FROM THE WEEKLY SALES TABLE, THE PROPER  38180001
      * ENTRY IN THE COMMAREA WEEKLY DATA ACCUMULATION TABLE IS DETER-  38190001
      * MINED BY COMPARING THE BOW DATE FROM THE TABLE ROW TO THE       38200001
      * BOW DATE HELD IN THE PROGRAM WEEKLY TABLE. THE COMMAREA         38210001
      * WEEKLY ACCUMULATION INDEX IS THEN SET TO THE SAME INDEX VALUE AS38220001
      * THE PROGRAM WEEKLY TABLE ENTRY AND THE DATA VALUES FROM THE     38230001
      * TSKSTWKS ROW ARE ADDED TO THE APPROPRIATE FIELDS WITHIN THE     38240001
      * COMMAREA WEEKLY DATA ACCUMULATION TABLE DEPENDING UPON THE TYPE 38250001
      * OF SALE.                                                        38260001
           PERFORM UNTIL PS-NO-MORE-WEEKS                               38270001
               PERFORM 9550-FETCH-WEEKLY-SALES                          38280001
               IF SQLCODE = ZERO                                        38290001
                   PERFORM VARYING PV-WEEKLY-INDEX                      38300001
                           FROM 1 BY 1                                  38310001
                           UNTIL (SKSTWKS-FSCL-BOW-DTE =                38320001
                                 PV-WKLY-BOW-DATE (PV-WEEKLY-INDEX)     38330001
                                          OR                            38340001
                                 PV-WEEKLY-INDEX > PC-MAX-NUM-WEEKS)    38350001
                   END-PERFORM                                          38360001
                   IF CA-STORE-NUMBER-X > '00000'                       38370074
                       IF PV-WEEKLY-INDEX = PC-CURRENT-WEEK             38380001
                           ADD SKSTWKS-SUN-SLS-UNIT-QTY TO              38390001
                                                 CA-SUN-UNITS           38400001
                           ADD SKSTWKS-MON-SLS-UNIT-QTY TO              38410001
                                                 CA-MON-UNITS           38420001
                           ADD SKSTWKS-TUE-SLS-UNIT-QTY TO              38430001
                                                 CA-TUE-UNITS           38440001
                           ADD SKSTWKS-WED-SLS-UNIT-QTY TO              38450001
                                                 CA-WED-UNITS           38460001
                           ADD SKSTWKS-THU-SLS-UNIT-QTY TO              38470001
                                                 CA-THU-UNITS           38480001
                           ADD SKSTWKS-FRI-SLS-UNIT-QTY TO              38490001
                                                 CA-FRI-UNITS           38500001
                           ADD SKSTWKS-SAT-SLS-UNIT-QTY TO              38510001
                                                 CA-SAT-UNITS           38520001
                       END-IF                                           38530001
                       IF PV-WEEKLY-INDEX = PC-PREVIOUS-WEEK            38540001
                           ADD SKSTWKS-SUN-SLS-UNIT-QTY TO              38550001
                                                 CA-SUN-UNITS-PREV      38560001
                           ADD SKSTWKS-MON-SLS-UNIT-QTY TO              38570001
                                                 CA-MON-UNITS-PREV      38580001
                           ADD SKSTWKS-TUE-SLS-UNIT-QTY TO              38590001
                                                 CA-TUE-UNITS-PREV      38600001
                           ADD SKSTWKS-WED-SLS-UNIT-QTY TO              38610001
                                                 CA-WED-UNITS-PREV      38620001
                           ADD SKSTWKS-THU-SLS-UNIT-QTY TO              38630001
                                                 CA-THU-UNITS-PREV      38640001
                           ADD SKSTWKS-FRI-SLS-UNIT-QTY TO              38650001
                                                 CA-FRI-UNITS-PREV      38660001
                           ADD SKSTWKS-SAT-SLS-UNIT-QTY TO              38670001
                                                 CA-SAT-UNITS-PREV      38680001
                       END-IF                                           38690001
                   END-IF                                               38700001
                   IF PV-WEEKLY-INDEX NOT GREATER THAN                  38710001
                                                   PC-MAX-NUM-WEEKS     38720001
                       SET CA-WKLY-INDEX TO PV-WEEKLY-INDEX             38730001
                       MOVE SKSTWKS-SALES-TYPE-CODE TO                  38740001
                                                 PV-SALES-TYPE-CODE     38750001
                       EVALUATE TRUE                                    38760001
                           WHEN PV-REGULAR                              38770001
                               ADD SKSTWKS-SALES-UNIT-QTY TO            38780001
                                    CA-WKLY-REG-UNITS (CA-WKLY-INDEX)   38790001
                               ADD SKSTWKS-SALES-AMT TO                 38800001
                                    CA-WKLY-REG-DLRS (CA-WKLY-INDEX)    38810001
                           WHEN PV-PROMOTIONAL                          38820001
                               ADD SKSTWKS-SALES-UNIT-QTY TO            38830001
                                    CA-WKLY-PRO-UNITS (CA-WKLY-INDEX)   38840001
                               ADD SKSTWKS-SALES-AMT TO                 38850001
                                    CA-WKLY-PRO-DLRS (CA-WKLY-INDEX)    38860001
                           WHEN PV-CLEARANCE                            38870001
                               ADD SKSTWKS-SALES-UNIT-QTY TO            38880001
                                    CA-WKLY-CLR-UNITS (CA-WKLY-INDEX)   38890001
                               ADD SKSTWKS-SALES-AMT TO                 38900001
                                    CA-WKLY-CLR-DLRS (CA-WKLY-INDEX)    38910001
                       END-EVALUATE                                     38920001
                   END-IF                                               38930001
               END-IF                                                   38940001
           END-PERFORM.                                                 38950001
                                                                        38960001
           PERFORM 9560-CLOSE-TSKSTWKS-CURSOR.                          38970001
                                                                        38980001
      * FOR EACH WEEK WITHIN THE PROGRAM WEEKLY DATE TABLE, THE         38990001
      * TSKSTWKI TABLE IS READ TO FIND THE WEEKLY INVENTORY INFOR-      39000001
      * MATION. THE ONHAND INFORMATION IS FOUND ON THE WEEKLY INVEN-    39010001
      * TORY TABLE.                                                     39020001
           PERFORM VARYING PV-WEEKLY-INDEX                              39030001
                   FROM 1 BY 1                                          39040001
                   UNTIL PV-WEEKLY-INDEX GREATER THAN                   39050001
                                                   PC-MAX-NUM-WEEKS     39060001
               MOVE PV-WKLY-BOW-DATE (PV-WEEKLY-INDEX) TO               39070001
                                                    PV-WEEK-IND         39080001
               SET CA-WKLY-INDEX TO PV-WEEKLY-INDEX                     39090001
               PERFORM 9565-SELECT-WEEKLY-INVENTORY                     39100001
               IF SQLCODE = ZERO                                        39110001
                   IF TSK-GP-QTY > 1                                    39120001
                       COMPUTE PV-CUR-UNIT-RTL-AMT =                    39130001
                           TSK-GP-RTL-AMT / TSK-GP-QTY                  39140001
                   ELSE                                                 39150001
                       MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT 39160001
                   END-IF                                               39170001
                   ADD SKSTWKI-INVEN-ONHAND-QTY TO                      39180001
                                  CA-WKLY-ONHAND-UNITS (CA-WKLY-INDEX)  39190001
                   COMPUTE PV-ONHAND-DLRS =                             39200001
                           SKSTWKI-INVEN-RTL-AMT * 1                    39210001
                   ADD PV-ONHAND-DLRS TO                                39220001
                                  CA-WKLY-ONHAND-DLRS (CA-WKLY-INDEX)   39230001
               END-IF                                                   39240001
           END-PERFORM.                                                 39250001
                                                                        39260001
           EJECT                                                        39270001
      ******************************************************************39280001
      *  GIVEN A SPECIFIC SKU, THE PARAGRAPH WILL CONTROL THE ACCESSING 39290001
      *  OF THE MONTHLY SKU TABLES FOR DATA. THIS SAME PARAGRAPH WILL   39300001
      *  BE PERFORMED REGARDLESS OF WHETHER THE SKU NUMBER              39310018
      *  WAS SPECIFICALLY ENTERED BY THE USER OR IT CAME FROM A CURSOR. 39320001
      *  DEPENDING UPON WHETHER OR NOT A SPECIFIC STORE WAS ENTERED OR  39330001
      *  A DISTRICT WAS ENTERED, SEPARATE PATHS WILL BE TAKEN.          39340001
      ******************************************************************39350001
                                                                        39360001
       9200-ACCUMULATE-MONTHLY-DATA.                                    39370001
           MOVE '*9200-ACCUMULATE-MONTHLY-DATA.   *' TO DP013-PARAGRAPH.39380069
                                                                        39390001
           EJECT                                                        39400001
      ******************************************************************39410001
      * THIS PARAGRAPH WILL HANDLE PROCESSING FOR A SPECIFIC STORE.     39420001
      * THE STORE TABLE IS FIRST ACCESSED TO GET STORE NAME (EXCEPT FOR 39430001
      * STORE '000' WHICH HAS NO ROW ON THE XMT_LOC TABLE.              39440075
      ******************************************************************39450001
                                                                        39460001
       9210-ONE-STORE-MONTHLY.                                          39470001
           MOVE '*9210-ONE-STORE-MONTHLY.         *' TO DP013-PARAGRAPH.39480069
                                                                        39490001
           EJECT                                                        39500001
                                                                        39510001
      ******************************************************************39520001
      * THIS WILL HANDLE PROCESSING OF EACH STORE FOUND WITHIN THE      39530001
      * DISTRICT NUMBER WHICH WAS ENTERED.                              39540001
      ******************************************************************39550001
                                                                        39560001
       9250-MULTIPLE-STORE-MONTHLY.                                     39570001
W43143     MOVE '*9250-MULTIPLE-STORE-MONTHLY.    *' TO DP013-PARAGRAPH.39580099
                                                                        39590001
           EJECT                                                        39600001
      ******************************************************************39610001
      * ACCESS THE SKU MONTHLY SALES FOR A PARTICULAR SKU AND STORE TO  39620001
      * OBTAIN ACCUMULATOR DATA.  THIS SAME PARAGRAPH WILL BE PERFORMED 39630001
      * REGARDLESS OF WHETHER THE SKU AND STORE NUMBERS WERE SPECIF-    39640001
      * ICALLY ENTERED OR WERE OBTAINED FROM SKU AND STORE CURSORS.     39650001
      ******************************************************************39660001
                                                                        39670001
       9290-MONTHLY-STORE-AT-A-TIME.                                    39680001
           MOVE '*9290-MONTHLY-STORE-AT-A-TIME.   *' TO DP013-PARAGRAPH.39690069
                                                                        39700001
           EJECT                                                        39710001
                                                                        39720001
      ******************************************************************39730001
      * CALL TSKSTOO FOR THE ON-ORDER INFORMATION FOR A PARTICULAR SKU  39740001
      ******************************************************************39750001
                                                                        39760001
       9300-GET-ON-ORDER-DATA.                                          39770001
           MOVE '*9300-GET-ON-ORDER-DATA.         *' TO DP013-PARAGRAPH 39780001
                                                                        39790001
           IF TSK-REGN-PRIC-IND = 'Y'                                   39800001
MK            IF PS-TUPCPLS-ROW-FOUND                                   39810054
MK               MOVE UPCPLS-UNT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT         39820054
MK            ELSE                                                      39830054
MK               MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT       39840054
MK            END-IF                                                    39850054
           ELSE                                                         39860001
              IF TSK-GP-QTY > 1                                         39870001
                  COMPUTE PV-CUR-UNIT-RTL-AMT =                         39880001
                      TSK-GP-RTL-AMT / TSK-GP-QTY                       39890001
              ELSE                                                      39900001
                  MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT      39910001
              END-IF                                                    39920001
           END-IF.                                                      39930001
                                                                        39940001
           IF CA-STORE-NUMBER-X > SPACES                                39950001
               IF CA-STORE-NUMBER-X = PC-STORE-ZERO-X                   39960001
                  INITIALIZE PV-RETRY-COUNT                             39970001
                             DCLTSKSTOO                                 39980001
                  PERFORM 9330-SUM-ON-ORDER                             39990001
                      WITH TEST AFTER                                   40000001
                      UNTIL SQLCODE = ZERO                              40010001
                         OR SQLCODE = +100                              40020001
                         OR SQLCODE = -305                              40030001
                         OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT     40040001
                      EVALUATE TRUE                                     40050001
                          WHEN SQLCODE = ZERO                           40060001
                             MOVE SKSTOO-ONORD-UNT-QTY TO PV-TSKSTOO-QTY40070001
                             ADD PV-TSKSTOO-QTY TO CA-ON-ORDER-UNITS    40080001
                             COMPUTE PV-ON-ORDER-DLRS =                 40090001
                               (PV-TSKSTOO-QTY * PV-CUR-UNIT-RTL-AMT)   40100001
                             ADD PV-ON-ORDER-DLRS TO CA-ON-ORDER-DLRS   40110001
                          WHEN SQLCODE = -911                           40120001
                          WHEN SQLCODE = -913                           40130001
                              MOVE 'CORP SUM ONORDER QTY FROM TSKSTOO'  40140001
                                               TO DP013-MESSAGE-TEXT(1) 40150001
                               PERFORM 9900-DB2-ERROR                   40160001
                          WHEN SQLCODE = +100                           40170001
                             MOVE ZERO TO PV-TSKSTOO-QTY                40180001
                          WHEN SQLCODE = -305                           40190001
                             MOVE ZERO TO PV-TSKSTOO-QTY                40200001
                      END-EVALUATE                                      40210001
               ELSE                                                     40220001
                  MOVE CA-STORE-NUMBER-9 TO PV-STORE-NUMBER-COMP        40230001
                  INITIALIZE PV-RETRY-COUNT                             40240001
                             DCLTSKSTOO                                 40250001
                  PERFORM 9333-SUM-STORE-ON-ORDER                       40260001
                      WITH TEST AFTER                                   40270001
                      UNTIL SQLCODE = ZERO                              40280001
                         OR SQLCODE = +100                              40290001
                         OR SQLCODE = -305                              40300001
                         OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT     40310001
                      EVALUATE TRUE                                     40320001
                          WHEN SQLCODE = ZERO                           40330001
                             MOVE SKSTOO-ONORD-UNT-QTY TO PV-TSKSTOO-QTY40340001
                             ADD PV-TSKSTOO-QTY TO CA-ON-ORDER-UNITS    40350001
                             COMPUTE PV-ON-ORDER-DLRS =                 40360001
                               (PV-TSKSTOO-QTY * PV-CUR-UNIT-RTL-AMT)   40370001
                             ADD PV-ON-ORDER-DLRS TO CA-ON-ORDER-DLRS   40380001
                          WHEN SQLCODE = -911                           40390001
                          WHEN SQLCODE = -913                           40400001
                              MOVE 'SUM-STORE ONORDER QTY FROM TSKSTOO' 40410001
                                              TO DP013-MESSAGE-TEXT(1)  40420001
                               PERFORM 9900-DB2-ERROR                   40430001
                          WHEN SQLCODE = +100                           40440001
                             MOVE ZERO TO PV-TSKSTOO-QTY                40450001
                          WHEN SQLCODE = -305                           40460001
                             MOVE ZERO TO PV-TSKSTOO-QTY                40470001
                      END-EVALUATE                                      40480001
               END-IF                                                   40490001
           ELSE                                                         40500001
              INITIALIZE PV-RETRY-COUNT                                 40510001
                         DCLTSKSTOO                                     40520001
              PERFORM 9335-SUM-DISTRICT-ON-ORDER                        40530001
                  WITH TEST AFTER                                       40540001
                  UNTIL SQLCODE = ZERO                                  40550001
                     OR SQLCODE = +100                                  40560001
                     OR SQLCODE = -305                                  40570001
                     OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT         40580001
                  EVALUATE TRUE                                         40590001
                      WHEN SQLCODE = ZERO                               40600001
                         MOVE SKSTOO-ONORD-UNT-QTY TO PV-TSKSTOO-QTY    40610001
                         ADD PV-TSKSTOO-QTY TO CA-ON-ORDER-UNITS        40620001
                         COMPUTE PV-ON-ORDER-DLRS =                     40630001
                           (PV-TSKSTOO-QTY * PV-CUR-UNIT-RTL-AMT)       40640001
                         ADD PV-ON-ORDER-DLRS TO CA-ON-ORDER-DLRS       40650001
                      WHEN SQLCODE = -911                               40660001
                      WHEN SQLCODE = -913                               40670001
                          MOVE 'DISTRICT SUM ONORDER QTY FROM TSKSTOO'  40680001
                                              TO DP013-MESSAGE-TEXT(1)  40690001
                           PERFORM 9900-DB2-ERROR                       40700001
                      WHEN SQLCODE = +100                               40710001
                         MOVE ZERO TO PV-TSKSTOO-QTY                    40720001
                      WHEN SQLCODE = -305                               40730001
                         MOVE ZERO TO PV-TSKSTOO-QTY                    40740001
                  END-EVALUATE                                          40750001
           END-IF.                                                      40760001
                                                                        40770001
           EJECT                                                        40780001
                                                                        40790001
      ******************************************************************40800001
      * SUM ON-ORDER INFORMATION FOR ALL STORES                         40810001
      ******************************************************************40820001
       9330-SUM-ON-ORDER.                                               40830001
           MOVE '*9330-SUM-ON-ORDER.              *' TO DP013-PARAGRAPH 40840001
                                                                        40850001
           EXEC SQL                                                     40860001
                SELECT SUM(ONORD_UNT_QTY)                               40870001
                  INTO :SKSTOO-ONORD-UNT-QTY                            40880001
                  FROM TSKSTOO                                          40890001
                 WHERE ITM_NBR = :TSK-ITEM-NMBR                         40900001
           END-EXEC.                                                    40910001
                                                                        40920001
           EVALUATE TRUE                                                40930001
               WHEN SQLCODE = -911                                      40940001
               WHEN SQLCODE = -913                                      40950001
                    ADD 1                  TO PV-RETRY-COUNT            40960001
               WHEN ((SQLCODE < ZERO) AND (SQLCODE NOT = -305))         40970001
               WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))         40980001
               WHEN SQLWARN0 NOT = SPACES                               40990001
                    MOVE 'CORP SUM ONORDER QTY FROM TSKSTOO'            41000001
                                           TO DP013-MESSAGE-TEXT(1)     41010001
                    PERFORM 9900-DB2-ERROR                              41020001
               WHEN OTHER                                               41030001
                    CONTINUE                                            41040001
           END-EVALUATE.                                                41050001
           EJECT                                                        41060001
                                                                        41070001
      ******************************************************************41080001
      * SELECT ON-ORDER INFORMATION FOR A SPECIFIC STORE                41090001
      ******************************************************************41100001
       9333-SUM-STORE-ON-ORDER.                                         41110001
           MOVE '*9333-SUM-STORE-ON-ORDER.        *' TO DP013-PARAGRAPH 41120001
                                                                        41130001
           EXEC SQL                                                     41140001
                SELECT SUM(ONORD_UNT_QTY)                               41150001
                  INTO :SKSTOO-ONORD-UNT-QTY                            41160001
                  FROM TSKSTOO                                          41170001
                 WHERE ITM_NBR = :TSK-ITEM-NMBR                         41180001
                   AND STR_NBR = :PV-STORE-NUMBER-COMP                  41190001
           END-EXEC.                                                    41200001
                                                                        41210001
           EVALUATE TRUE                                                41220001
               WHEN SQLCODE = -911                                      41230001
               WHEN SQLCODE = -913                                      41240001
                    ADD 1                  TO PV-RETRY-COUNT            41250001
               WHEN ((SQLCODE < ZERO) AND (SQLCODE NOT = -305))         41260001
               WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))         41270001
               WHEN SQLWARN0 NOT = SPACES                               41280001
                    MOVE 'SUM ONORDER QTY FROM TSKSTOO-SPECIFIC STORE'  41290001
                                           TO DP013-MESSAGE-TEXT(1)     41300001
                    PERFORM 9900-DB2-ERROR                              41310001
               WHEN OTHER                                               41320001
                    CONTINUE                                            41330001
           END-EVALUATE.                                                41340001
           EJECT                                                        41350001
                                                                        41360001
      ******************************************************************41370001
      * SUM ON-ORDER INFORMATION FOR A SPECIFIC DISTRICT                41380001
      ******************************************************************41390001
       9335-SUM-DISTRICT-ON-ORDER.                                      41400001
           MOVE '*9335-SUM-DISTRICT-ON-ORDER.     *' TO DP013-PARAGRAPH 41410001
                                                                        41420083
           MOVE CA-DISTRICT-NUMBER     TO PV-DISTRICT-NBR-9             41430083
           MOVE PV-DISTRICT-NBR-9      TO PV-DISTRICT-NBR-COMP          41440083
                                                                        41450001
           EXEC SQL                                                     41460001
                SELECT SUM(ONORD_UNT_QTY)                               41470001
                  INTO :SKSTOO-ONORD-UNT-QTY                            41480001
                  FROM TSKSTOO A,                                       41490001
                       XMT_LOC B                                        41500074
                 WHERE A.ITM_NBR = :TSK-ITEM-NMBR                       41510001
                   AND A.STR_NBR = B.LOC_NBR                            41520074
                   AND B.DIST_NBR      = :PV-DISTRICT-NBR-COMP          41530084
           END-EXEC.                                                    41540001
                                                                        41550001
           EVALUATE TRUE                                                41560001
               WHEN SQLCODE = -911                                      41570001
               WHEN SQLCODE = -913                                      41580001
                    ADD 1                  TO PV-RETRY-COUNT            41590001
               WHEN ((SQLCODE < ZERO) AND (SQLCODE NOT = -305))         41600001
               WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))         41610001
               WHEN SQLWARN0 NOT = SPACES                               41620001
                    MOVE 'SUM ONORDER QTY FROM TSKSTOO-SPECIFIC STORE'  41630001
                                           TO DP013-MESSAGE-TEXT(1)     41640001
                    PERFORM 9900-DB2-ERROR                              41650001
               WHEN OTHER                                               41660001
                    CONTINUE                                            41670001
           END-EVALUATE.                                                41680001
                                                                        41690001
           EJECT                                                        41700001
                                                                        41710001
      ******************************************************************41720001
      * WILL GET ALL STORE ENROUTE INFORMATION WHEN A DISTRICT NUMBER   41730001
      * IS REQUESTED.                                                   41740001
      ******************************************************************41750001
                                                                        41760001
       9340-MULTIPLE-STORE-STORE-OH.                                    41770088
           MOVE '*9340-MULTIPLE-STORE-STORE-OH.   *' TO DP013-PARAGRAPH 41780088
                                                                        41790001
           PERFORM 9535-FETCH-STORE-FROM-CURSOR.                        41800001
                                                                        41810001
           IF SQLCODE EQUAL ZERO                                        41820001
               IF TSK-GP-QTY > 1                                        41830001
                   COMPUTE PV-CUR-UNIT-RTL-AMT =                        41840001
                       TSK-GP-RTL-AMT / TSK-GP-QTY                      41850001
               ELSE                                                     41860001
                   MOVE TSK-CUR-UNIT-RTL-AMT TO PV-CUR-UNIT-RTL-AMT     41870001
               END-IF                                                   41880001
               MOVE XMT00001-LOC-NBR   TO PV-CURRENT-STORE              41890074
               PERFORM 9350-GET-STORE-OH-UNITS                          41900088
           END-IF.                                                      41910001
                                                                        41920001
           EJECT                                                        41930001
                                                                        41940001
      ******************************************************************41950001
      *  READ THE RECEIPT ENROUTE FILE TO RETRIEVE UNITS IN TRANSIT    *41960001
      *  TO THE STORES.                                                *41970001
      ******************************************************************41980001
       9350-GET-STORE-OH-UNITS.                                         41990098
           MOVE '*9350-GET-STORE-OH-UNITS.         *'                   42000095
                                                  TO DP013-PARAGRAPH.   42010095
                                                                        42020096
           INITIALIZE XL074-ITEM-COMMAREA.                              42030096
                                                                        42040096
           SET XL074-BY-SKU               TO TRUE.                      42050096
           MOVE CA-SKU-NUMBER-9           TO XL074-KEY-SKU.             42060096
                                                                        42070096
           IF CA-ALL-STORES                                             42080096
              SET XL074-BY-ALL-LOCATIONS  TO TRUE                       42090096
              MOVE ZERO                   TO XL074-KEY-LOC-NBR          42100096
           ELSE                                                         42110096
              SET XL074-BY-STORE          TO TRUE                       42120096
              MOVE XMT00001-LOC-NBR       TO XL074-KEY-LOC-NBR          42130096
           END-IF.                                                      42140096
                                                                        42150096
           CALL XL074-ONLINE-PGM                                        42160096
               USING DFHEIBLK                                           42170096
                     XL074-COMMAREA                                     42180096
                     XL074-ITEM-COMMAREA.                               42190096
                                                                        42200096
           EVALUATE XL074-RETURN-CODE                                   42210096
              WHEN '00'                                                 42220096
      *----------> SUCCESSFUL                                           42230096
                                                                        42240096
                 COMPUTE  CA-STORE-OH-UNITS  =                          42250096
                        CA-CURR-ONHAND-UNITS - XL074-SE-QTY             42260096
                                                                        42270096
                 COMPUTE CA-STORE-OH-DLRS   =                           42280096
                     (CA-STORE-OH-UNITS * PV-CUR-UNIT-RTL-AMT)          42290096
                                                                        42300096
                 MOVE XL074-IT-QTY          TO CA-IN-TRNST-UNITS        42310099
                 COMPUTE PV-IN-TRNST-DLRS =                             42320099
                      XL074-IT-QTY           * PV-CUR-UNIT-RTL-AMT      42330099
                 MOVE PV-IN-TRNST-DLRS TO CA-IN-TRNST-DLRS              42340099
                                                                        42350096
              WHEN OTHER                                                42360096
      *----------> SOME TYPE OF ERROR                                   42370096
      *----------> ONLY ACCEPT +100 ERROR (NOT FOUND)                   42380096
                 IF XL074-SQLCODE = +100                                42390096
                     MOVE CA-CURR-ONHAND-UNITS TO CA-STORE-OH-UNITS     42400097
                     COMPUTE CA-STORE-OH-DLRS   =                       42410097
                           (CA-STORE-OH-UNITS * PV-CUR-UNIT-RTL-AMT)    42420097
                 ELSE                                                   42430097
                     MOVE ZERO TO CA-STORE-OH-UNITS                     42440097
                     MOVE ZERO TO CA-STORE-OH-DLRS                      42450097
                 END-IF                                                 42460097
           END-EVALUATE.                                                42470097
           EJECT.                                                       42480095
                                                                        42490001
       9400-SELECT-TMRITST.                                             42500001
           MOVE '*9400-SELECT-TMRITST          *' TO DP013-PARAGRAPH    42510001
W27494     MOVE CA-STORE-NUMBER-9    TO PV-STORE-NBR-COMP               42520060
                                                                        42530001
           INITIALIZE PV-RETRY-COUNT.                                   42540001
           PERFORM WITH TEST AFTER                                      42550001
                   UNTIL ((SQLCODE = ZERO)                              42560001
                               OR                                       42570001
                         (SQLCODE = +100)                               42580001
                               OR                                       42590001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     42600001
               EXEC SQL                                                 42610001
                   SELECT CSTOCK_QTY,                                   42620001
                          OUTL_QTY,                                     42630001
                          OP_QTY                                        42640001
                   INTO   :MRITST-CSTOCK-QTY,                           42650001
                          :MRITST-OUTL-QTY,                             42660001
                          :MRITST-OP-QTY                                42670001
                   FROM   TMRITST                                       42680001
MK                 WHERE  ITEM_NBR = :TSK-ITEM-NMBR                     42690012
W27494               AND  STR_NBR  = :PV-STORE-NBR-COMP                 42700060
               END-EXEC                                                 42710001
                                                                        42720001
               EVALUATE TRUE                                            42730001
                   WHEN SQLCODE = -911                                  42740001
                   WHEN SQLCODE = -913                                  42750001
                       ADD +1 TO PV-RETRY-COUNT                         42760001
                   WHEN SQLCODE = ZERO                                  42770001
                       MOVE MRITST-CSTOCK-QTY  TO CSTOCKO               42780001
                       MOVE MRITST-OUTL-QTY    TO OUTLMTO               42790001
                       MOVE MRITST-OP-QTY      TO ORDRPTO               42800001
      *-->             ASSURES THAT THE CAPTIONS ARE DISPLAYED. IF THE  42810001
      *-->             ORIGINAL CRITERIA INCLUDED "ALL STORES", THESE   42820001
      *-->             CAPTIONS W/BE BLANKED OUT.  "NEXT STORE" WOULD   42830001
      *-->             DISPLAY A NON-000 STORE, SO CAPTIONS S/BE SHOWN. 42840001
                       MOVE 'OTL:'             TO OUTLMTCO              42850001
                       MOVE 'OP:'              TO ORDRPTCO              42860001
                       MOVE 'CSTK:'            TO CSTOCKCO              42870001
                   WHEN SQLCODE = +100                                  42880001
                       CONTINUE                                         42890001
                   WHEN SQLCODE < ZERO                                  42900001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     42910001
                   WHEN SQLWARN0 NOT = SPACES                           42920001
                       MOVE PF-ERR-MSG-17 TO DP013-MESSAGE-TEXT(1)      42930001
                       PERFORM 9900-DB2-ERROR                           42940001
               END-EVALUATE                                             42950001
           END-PERFORM.                                                 42960001
                                                                        42970001
           IF ((SQLCODE = -911)                                         42980001
                     OR                                                 42990001
               (SQLCODE = -913))                                        43000001
               PERFORM 9900-DB2-ERROR                                   43010001
           END-IF.                                                      43020001
                                                                        43030001
       9450-SUMMARIZE-TMRITST.                                          43040001
           MOVE '*9450-SUMMARIZE-TMRITST       *' TO DP013-PARAGRAPH    43050001
                                                                        43060001
           IF CA-STORE-NUMBER-X > SPACES                                43070001
              IF CA-STORE-NUMBER-X = '00000'                            43080074
                 PERFORM 9453-TMRITST-CORP-SUM                          43090001
              ELSE                                                      43100001
                 MOVE CA-STORE-NUMBER-9 TO PV-STORE-NBR                 43110085
                 PERFORM 9455-TMRITST-STORE-SUM                         43120001
              END-IF                                                    43130001
           ELSE                                                         43140001
              MOVE CA-DISTRICT-NUMBER     TO PV-DISTRICT-NBR            43150001
              MOVE CA-DISTRICT-NUMBER     TO PV-DISTRICT-NBR-9          43160080
              MOVE PV-DISTRICT-NBR-9      TO PV-DISTRICT-NBR-COMP       43170081
              PERFORM 9457-TMRITST-DIST-SUM                             43180001
           END-IF.                                                      43190001
                                                                        43200001
      ******************************************************************43210001
      * SQL FOR SUM OF ALL STORES - CORPORATE LEVEL SUM                 43220001
      * DO NOT USE HOST VARIABLES IN PREDICATE WHEN VALUE IS CONSTANT.  43230001
      ******************************************************************43240001
       9453-TMRITST-CORP-SUM.                                           43250001
                                                                        43260001
           INITIALIZE PV-RETRY-COUNT.                                   43270001
           PERFORM WITH TEST AFTER                                      43280001
                   UNTIL ((SQLCODE = ZERO)                              43290001
                               OR                                       43300001
                         (SQLCODE = +100)                               43310001
                               OR                                       43320001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     43330001
               EXEC SQL                                                 43340001
                   SELECT SUM(CSTOCK_QTY),                              43350001
                          SUM(OUTL_QTY),                                43360001
                          SUM(OP_QTY)                                   43370001
                   INTO   :MRITST-CSTOCK-QTY:IND-NOTES,                 43380001
                          :MRITST-OUTL-QTY:IND-NOTES,                   43390001
                          :MRITST-OP-QTY:IND-NOTES                      43400001
                   FROM   TMRITST A,                                    43410001
                          TSK     B                                     43420075
MK                 WHERE  A.ITEM_NBR = B.ITEM_NMBR                      43430012
                     AND  B.ITEM_NMBR = :TSK-ITEM-NMBR                  43440009
W27494               AND  A.STR_NBR          > 0                        43450060
               END-EXEC                                                 43460001
                                                                        43470001
               EVALUATE TRUE                                            43480001
                   WHEN SQLCODE = -911                                  43490001
                   WHEN SQLCODE = -913                                  43500001
                       ADD +1 TO PV-RETRY-COUNT                         43510001
                   WHEN SQLCODE = ZERO AND IND-NOTES NOT = -1           43520001
                       ADD MRITST-CSTOCK-QTY     TO PV-MRITST-CSTOCK-QTY43530001
                       MOVE PV-MRITST-CSTOCK-QTY TO CSTOCKO             43540001
                                                                        43550001
                       ADD MRITST-OUTL-QTY       TO PV-MRITST-OUTL-QTY  43560001
                       MOVE PV-MRITST-OUTL-QTY   TO OUTLMTO             43570001
                                                                        43580001
                       ADD MRITST-OP-QTY         TO PV-MRITST-OP-QTY    43590001
                       MOVE PV-MRITST-OP-QTY     TO ORDRPTO             43600001
                                                                        43610001
      *-->             ASSURES THAT THE CAPTIONS ARE DISPLAYED. IF THE  43620001
      *-->             ORIGINAL CRITERIA INCLUDED "ALL STORES", THESE   43630001
      *-->             CAPTIONS W/BE BLANKED OUT.  "NEXT STORE" WOULD   43640001
      *-->             DISPLAY A NON-000 STORE, SO CAPTIONS S/BE SHOWN. 43650001
                       MOVE 'OTL:'             TO OUTLMTCO              43660001
                       MOVE 'OP:'              TO ORDRPTCO              43670001
                       MOVE 'CSTK:'            TO CSTOCKCO              43680001
                   WHEN SQLCODE = +100                                  43690001
                       CONTINUE                                         43700001
                   WHEN SQLCODE < ZERO                                  43710001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     43720001
                   WHEN SQLWARN0 NOT = SPACES                           43730001
                       MOVE PF-ERR-MSG-17 TO DP013-MESSAGE-TEXT(1)      43740001
                       PERFORM 9900-DB2-ERROR                           43750001
               END-EVALUATE                                             43760001
           END-PERFORM.                                                 43770001
                                                                        43780001
           IF ((SQLCODE = -911)                                         43790001
                     OR                                                 43800001
               (SQLCODE = -913))                                        43810001
               PERFORM 9900-DB2-ERROR                                   43820001
           END-IF.                                                      43830001
                                                                        43840001
           EJECT                                                        43850001
                                                                        43860001
      ******************************************************************43870001
      * SQL FOR SUM OF SPECIFIC STORE                                   43880001
      * DO NOT USE HOST VARIABLES IN PREDICATE WHEN VALUE IS CONSTANT.  43890001
      ******************************************************************43900001
       9455-TMRITST-STORE-SUM.                                          43910001
                                                                        43920001
W27494     MOVE CA-STORE-NUMBER-9    TO PV-STORE-NBR-COMP               43930060
           INITIALIZE PV-RETRY-COUNT.                                   43940001
           PERFORM WITH TEST AFTER                                      43950001
                   UNTIL ((SQLCODE = ZERO)                              43960001
                               OR                                       43970001
                         (SQLCODE = +100)                               43980001
                               OR                                       43990001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     44000001
               EXEC SQL                                                 44010001
                   SELECT SUM(CSTOCK_QTY),                              44020001
                          SUM(OUTL_QTY),                                44030001
                          SUM(OP_QTY)                                   44040001
                   INTO   :MRITST-CSTOCK-QTY:IND-NOTES,                 44050001
                          :MRITST-OUTL-QTY:IND-NOTES,                   44060001
                          :MRITST-OP-QTY:IND-NOTES                      44070001
                   FROM   TMRITST A,                                    44080001
                          TSK     B                                     44090075
                   WHERE  A.ITEM_NBR = B.ITEM_NMBR                      44100001
                     AND  B.ITEM_NMBR = :TSK-ITEM-NMBR                  44110009
W27494               AND  A.STR_NBR          = :PV-STORE-NBR-COMP       44120060
               END-EXEC                                                 44130001
                                                                        44140001
               EVALUATE TRUE                                            44150001
                   WHEN SQLCODE = -911                                  44160001
                   WHEN SQLCODE = -913                                  44170001
                       ADD +1 TO PV-RETRY-COUNT                         44180001
                   WHEN SQLCODE = ZERO AND IND-NOTES NOT = -1           44190001
                       ADD MRITST-CSTOCK-QTY     TO PV-MRITST-CSTOCK-QTY44200001
                       MOVE PV-MRITST-CSTOCK-QTY TO CSTOCKO             44210001
                                                                        44220001
                       ADD MRITST-OUTL-QTY       TO PV-MRITST-OUTL-QTY  44230001
                       MOVE PV-MRITST-OUTL-QTY   TO OUTLMTO             44240001
                                                                        44250001
                       ADD MRITST-OP-QTY         TO PV-MRITST-OP-QTY    44260001
                       MOVE PV-MRITST-OP-QTY     TO ORDRPTO             44270001
                                                                        44280001
      *-->             ASSURES THAT THE CAPTIONS ARE DISPLAYED. IF THE  44290001
      *-->             ORIGINAL CRITERIA INCLUDED "ALL STORES", THESE   44300001
      *-->             CAPTIONS W/BE BLANKED OUT.  "NEXT STORE" WOULD   44310001
      *-->             DISPLAY A NON-000 STORE, SO CAPTIONS S/BE SHOWN. 44320001
                       MOVE 'OTL:'             TO OUTLMTCO              44330001
                       MOVE 'OP:'              TO ORDRPTCO              44340001
                       MOVE 'CSTK:'            TO CSTOCKCO              44350001
                   WHEN SQLCODE = +100                                  44360001
                       CONTINUE                                         44370001
                   WHEN SQLCODE < ZERO                                  44380001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     44390001
                   WHEN SQLWARN0 NOT = SPACES                           44400001
                       MOVE PF-ERR-MSG-17 TO DP013-MESSAGE-TEXT(1)      44410001
                       PERFORM 9900-DB2-ERROR                           44420001
               END-EVALUATE                                             44430001
           END-PERFORM.                                                 44440001
                                                                        44450001
           IF ((SQLCODE = -911)                                         44460001
                     OR                                                 44470001
               (SQLCODE = -913))                                        44480001
               PERFORM 9900-DB2-ERROR                                   44490001
           END-IF.                                                      44500001
                                                                        44510001
           EJECT                                                        44520001
                                                                        44530001
      ******************************************************************44540001
      * SQL FOR SUM OF ALL STORES IN A SPECIFIC DISTRICT                44550001
      * DO NOT USE HOST VARIABLES IN PREDICATE WHEN VALUE IS CONSTANT.  44560001
      ******************************************************************44570001
       9457-TMRITST-DIST-SUM.                                           44580001
                                                                        44590001
           INITIALIZE PV-RETRY-COUNT.                                   44600001
           PERFORM WITH TEST AFTER                                      44610001
                   UNTIL ((SQLCODE = ZERO)                              44620001
                               OR                                       44630001
                         (SQLCODE = +100)                               44640001
                               OR                                       44650001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     44660001
               EXEC SQL                                                 44670001
                   SELECT SUM(CSTOCK_QTY),                              44680001
                          SUM(OUTL_QTY),                                44690001
                          SUM(OP_QTY)                                   44700001
                   INTO   :MRITST-CSTOCK-QTY:IND-NOTES,                 44710001
                          :MRITST-OUTL-QTY:IND-NOTES,                   44720001
                          :MRITST-OP-QTY:IND-NOTES                      44730001
                   FROM   TMRITST A,                                    44740001
                          TSK     B,                                    44750084
                          XMT_LOC C                                     44760084
MK                 WHERE  A.ITEM_NBR = B.ITEM_NMBR                      44770012
                     AND  B.ITEM_NMBR = :TSK-ITEM-NMBR                  44780009
W27494               AND  A.STR_NBR          > 0                        44790060
W27494               AND  A.STR_NBR          = C.LOC_NBR                44800084
                     AND  C.DIST_NBR         = :PV-DISTRICT-NBR-COMP    44810084
               END-EXEC                                                 44820001
                                                                        44830001
               EVALUATE TRUE                                            44840001
                   WHEN SQLCODE = -911                                  44850001
                   WHEN SQLCODE = -913                                  44860001
                       ADD +1 TO PV-RETRY-COUNT                         44870001
                   WHEN SQLCODE = ZERO AND IND-NOTES NOT = -1           44880001
                       ADD MRITST-CSTOCK-QTY     TO PV-MRITST-CSTOCK-QTY44890001
                       MOVE PV-MRITST-CSTOCK-QTY TO CSTOCKO             44900001
                                                                        44910001
                       ADD MRITST-OUTL-QTY       TO PV-MRITST-OUTL-QTY  44920001
                       MOVE PV-MRITST-OUTL-QTY   TO OUTLMTO             44930001
                                                                        44940001
                       ADD MRITST-OP-QTY         TO PV-MRITST-OP-QTY    44950001
                       MOVE PV-MRITST-OP-QTY     TO ORDRPTO             44960001
                                                                        44970001
      *-->             ASSURES THAT THE CAPTIONS ARE DISPLAYED. IF THE  44980001
      *-->             ORIGINAL CRITERIA INCLUDED "ALL STORES", THESE   44990001
      *-->             CAPTIONS W/BE BLANKED OUT.  "NEXT STORE" WOULD   45000001
      *-->             DISPLAY A NON-000 STORE, SO CAPTIONS S/BE SHOWN. 45010001
                       MOVE 'OTL:'             TO OUTLMTCO              45020001
                       MOVE 'OP:'              TO ORDRPTCO              45030001
                       MOVE 'CSTK:'            TO CSTOCKCO              45040001
                   WHEN SQLCODE = +100                                  45050001
                       CONTINUE                                         45060001
                   WHEN SQLCODE < ZERO                                  45070001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     45080001
                   WHEN SQLWARN0 NOT = SPACES                           45090001
                       MOVE PF-ERR-MSG-17 TO DP013-MESSAGE-TEXT(1)      45100001
                       PERFORM 9900-DB2-ERROR                           45110001
               END-EVALUATE                                             45120001
           END-PERFORM.                                                 45130001
                                                                        45140001
           IF ((SQLCODE = -911)                                         45150001
                     OR                                                 45160001
               (SQLCODE = -913))                                        45170001
               PERFORM 9900-DB2-ERROR                                   45180001
           END-IF.                                                      45190001
                                                                        45200001
           EJECT                                                        45210001
                                                                        45220001
      ******************************************************************45230001
      * SQL FOR RETRIEVING ONE FULLY QUALIFIED SKU                      45240001
      * CHANGED FOR NEW SKU - ADDED TSKXREF                             45250012
      ******************************************************************45260001
                                                                        45270001
       9505-SELECT-SINGLE-SKU.                                          45280001
           MOVE '*9505-SELECT-SINGLE-SKU.         *' TO DP013-PARAGRAPH 45290001
                                                                        45300001
           INITIALIZE PV-RETRY-COUNT.                                   45310001
           PERFORM WITH TEST AFTER                                      45320001
                   UNTIL ((SQLCODE = ZERO)                              45330001
                               OR                                       45340001
                         (SQLCODE = +100)                               45350001
                               OR                                       45360001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     45370001
               EXEC SQL                                                 45380001
                   SELECT                                               45390001
                       X.DEPT,                                          45400011
                       X.SUBCLASS,                                      45410011
                       X.SKU,                                           45420011
                       CUR_UNIT_RTL_AMT,                                45430001
                       ITEM_NMBR,                                       45440001
                       STATUS_CODE,                                     45450001
                       UNIT_COST_AMT,                                   45460001
                       ORIG_UNIT_RTL_AMT,                               45470001
                       SKU_DESC,                                        45480001
                       SIZE_DESC,                                       45490001
                       COLOR_DESC,                                      45500001
                       GP_RTL_AMT,                                      45510001
                       GP_QTY,                                          45520001
                       LONG_SIZE_DESC,                                  45530001
                       LONG_COLOR_DESC,                                 45540001
                       SIZE_CDE,                                        45550001
                       REGN_PRIC_IND                                    45560001
                   INTO                                                 45570001
                      :SKXREF-DEPT,                                     45580010
                      :SKXREF-SUBCLASS,                                 45590010
                      :SKXREF-SKU,                                      45600010
                      :TSK-CUR-UNIT-RTL-AMT,                            45610001
                      :TSK-ITEM-NMBR,                                   45620001
                      :TSK-STATUS-CODE,                                 45630001
                      :TSK-UNIT-COST-AMT,                               45640001
                      :TSK-ORIG-UNIT-RTL-AMT,                           45650001
                      :TSK-SKU-DESC,                                    45660001
                      :TSK-SIZE-DESC,                                   45670001
                      :TSK-COLOR-DESC,                                  45680001
                      :TSK-GP-RTL-AMT,                                  45690001
                      :TSK-GP-QTY,                                      45700001
                      :TSK-LONG-SIZE-DESC,                              45710001
                      :TSK-LONG-COLOR-DESC,                             45720001
                      :TSK-SIZE-CDE,                                    45730001
                      :TSK-REGN-PRIC-IND                                45740001
                   FROM                                                 45750001
                       TSK,                                             45760009
                       TSKXREF X                                        45770009
                   WHERE ITEM_NMBR = X.ITM_NBR                          45780009
                     AND X.SKU = :NI-SKU-9-8                            45790009
               END-EXEC                                                 45800001
               EVALUATE TRUE                                            45810001
                   WHEN SQLCODE = -911                                  45820001
                   WHEN SQLCODE = -913                                  45830001
                       ADD +1 TO PV-RETRY-COUNT                         45840001
                   WHEN SQLCODE = ZERO                                  45850001
                       MOVE TSK-STATUS-CODE TO CA-STATUS                45860001
                       MOVE CA-STATUS-X     TO STAT1O                   45870001
                   WHEN SQLCODE = +100                                  45880001
W30677                 MOVE DP015-REVERSE         TO SKUH               45890099
W30677                 MOVE DP015-RED             TO SKUC               45900099
W30677                 MOVE DP015-UNP-ALP-BRT-OFF TO SKUA               45910099
                       IF NOT PS-EDIT-ERROR                             45920001
                           SET PS-EDIT-ERROR TO TRUE                    45930099
W30677                     MOVE -1           TO SKUL                    45940099
                           MOVE PC-TSYMSG-00386 TO DP020-MSG-NUMBER     45950001
                       END-IF                                           45960001
                   WHEN SQLCODE < ZERO                                  45970001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     45980001
                   WHEN SQLWARN0 NOT = SPACES                           45990001
                       MOVE PF-ERR-MSG-1 TO DP013-MESSAGE-TEXT(1)       46000001
                       PERFORM 9900-DB2-ERROR                           46010001
               END-EVALUATE                                             46020001
           END-PERFORM.                                                 46030001
                                                                        46040001
           IF ((SQLCODE = -911)                                         46050001
                     OR                                                 46060001
               (SQLCODE = -913))                                        46070001
               PERFORM 9900-DB2-ERROR                                   46080001
           END-IF.                                                      46090001
                                                                        46100001
           EJECT                                                        46110001
      ******************************************************************46120001
      * OPEN SKU CURSOR FOR DEPTS THAT HAVE BEEN CONVERTED TO VSM       46130001
      ******************************************************************46140001
                                                                        46150001
       9512-OPEN-SKU-CSR-2.                                             46160001
           MOVE '*9512-OPEN-SKU-CSR-2.           *' TO DP013-PARAGRAPH  46170001
                                                                        46180001
           EXEC SQL                                                     46190001
               OPEN MULT-SKUS-CSR-2                                     46200001
           END-EXEC.                                                    46210001
                                                                        46220001
           EVALUATE TRUE                                                46230001
               WHEN SQLCODE = ZERO                                      46240001
                   CONTINUE                                             46250001
               WHEN OTHER                                               46260001
                   MOVE PF-ERR-MSG-3 TO DP013-MESSAGE-TEXT(1)           46270001
                   PERFORM 9900-DB2-ERROR                               46280001
           END-EVALUATE.                                                46290001
                                                                        46300001
           EJECT                                                        46310001
      ******************************************************************46320001
      * SQL FOR RETRIEVING SKUS FROM ESTABLISHED SKU CURSOR             46330001
      * FOR DEPTS THAT HAVE BEEN CONVERTED TO VSM                       46340001
      ******************************************************************46350001
                                                                        46360001
       9517-FETCH-SKU-FROM-CSR-2.                                       46370001
           MOVE '*9517-FETCH-SKU-FROM-CSR-2.     *' TO DP013-PARAGRAPH  46380001
                                                                        46390001
           INITIALIZE PV-RETRY-COUNT.                                   46400001
           PERFORM WITH TEST AFTER                                      46410001
                   UNTIL ((SQLCODE = ZERO)                              46420001
                               OR                                       46430001
                         (SQLCODE = +100)                               46440001
                               OR                                       46450001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     46460001
               EXEC SQL                                                 46470001
                   FETCH MULT-SKUS-CSR-2                                46480001
                   INTO                                                 46490001
                       :SKXREF-DEPT,                                    46500009
                       :SKXREF-SUBCLASS,                                46510009
                       :SKXREF-SKU,                                     46520009
                       :TSK-CUR-UNIT-RTL-AMT,                           46530001
                       :TSK-ITEM-NMBR,                                  46540001
                       :TSK-GP-RTL-AMT,                                 46550001
                       :TSK-GP-QTY,                                     46560001
                       :TSK-REGN-PRIC-IND,                              46570057
                       :TSK-STATUS-CODE                                 46580057
               END-EXEC                                                 46590001
               EVALUATE TRUE                                            46600001
                   WHEN SQLCODE = -911                                  46610001
                   WHEN SQLCODE = -913                                  46620001
                       ADD +1 TO PV-RETRY-COUNT                         46630001
                   WHEN SQLCODE = ZERO                                  46640001
                       SET PS-SKUS-FOUND TO TRUE                        46650001
                   WHEN SQLCODE = +100                                  46660001
                       SET PS-NO-MORE-SKUS TO TRUE                      46670001
                   WHEN SQLCODE < ZERO                                  46680001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     46690001
                   WHEN SQLWARN0 NOT = SPACES                           46700001
                       MOVE PF-ERR-MSG-2 TO DP013-MESSAGE-TEXT(1)       46710001
                       PERFORM 9900-DB2-ERROR                           46720001
               END-EVALUATE                                             46730001
           END-PERFORM.                                                 46740001
                                                                        46750001
           IF ((SQLCODE = -911)                                         46760001
                     OR                                                 46770001
               (SQLCODE = -913))                                        46780001
               PERFORM 9900-DB2-ERROR                                   46790001
           END-IF.                                                      46800001
                                                                        46810001
           EJECT                                                        46820001
      ******************************************************************46830001
      * CLOSE SKU CURSOR FOR DEPT                                       46840018
      ******************************************************************46850001
                                                                        46860001
       9522-CLOSE-SKU-CSR-2.                                            46870001
           MOVE '*9522-CLOSE-SKU-CSR-2.          *' TO DP013-PARAGRAPH  46880001
                                                                        46890001
           EXEC SQL                                                     46900001
               CLOSE MULT-SKUS-CSR-2                                    46910001
           END-EXEC.                                                    46920001
                                                                        46930001
           EVALUATE TRUE                                                46940001
               WHEN SQLCODE = ZERO                                      46950001
                   CONTINUE                                             46960001
               WHEN OTHER                                               46970001
                   MOVE PF-ERR-MSG-4 TO DP013-MESSAGE-TEXT(1)           46980001
                   PERFORM 9900-DB2-ERROR                               46990001
           END-EVALUATE.                                                47000001
                                                                        47010001
           EJECT                                                        47020001
                                                                        47030001
      ******************************************************************47040001
      * GET THE SINGLE STORE CONTAINED IN THE COMMAREA                  47050001
      ******************************************************************47060001
                                                                        47070001
       9525-SELECT-SINGLE-STORE.                                        47080001
           MOVE '*9525-SELECT-SINGLE-STORE.       *' TO DP013-PARAGRAPH 47090001
                                                                        47100001
           MOVE CA-STORE-NUMBER-9 TO PV-STORE-NUMBER-COMP               47110075
                                                                        47120075
           INITIALIZE PV-RETRY-COUNT.                                   47130001
           PERFORM WITH TEST AFTER                                      47140001
                   UNTIL ((SQLCODE = ZERO)                              47150001
                               OR                                       47160001
                         (SQLCODE = +100)                               47170001
                               OR                                       47180001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     47190001
               EXEC SQL                                                 47200001
                   SELECT LOC_NBR                                       47210074
                   INTO :XMT00001-LOC-NBR                               47220074
                   FROM XMT_LOC                                         47230074
                   WHERE                                                47240074
                            LOC_NBR = :PV-STORE-NUMBER-COMP             47250075
               END-EXEC                                                 47260001
               EVALUATE TRUE                                            47270001
                   WHEN SQLCODE = -911                                  47280001
                   WHEN SQLCODE = -913                                  47290001
                       ADD +1 TO PV-RETRY-COUNT                         47300001
                   WHEN SQLCODE = ZERO                                  47310001
                       CONTINUE                                         47320001
                   WHEN SQLCODE = +100                                  47330001
                       CONTINUE                                         47340001
                   WHEN SQLCODE < ZERO                                  47350001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     47360001
                   WHEN SQLWARN0 NOT = SPACES                           47370001
                       MOVE PF-ERR-MSG-5 TO DP013-MESSAGE-TEXT(1)       47380001
                       PERFORM 9900-DB2-ERROR                           47390001
               END-EVALUATE                                             47400001
           END-PERFORM.                                                 47410001
                                                                        47420001
           IF ((SQLCODE = -911)                                         47430001
                     OR                                                 47440001
               (SQLCODE = -913))                                        47450001
               PERFORM 9900-DB2-ERROR                                   47460001
           END-IF.                                                      47470001
                                                                        47480001
           EJECT                                                        47490001
                                                                        47500001
      ******************************************************************47510001
      * OPEN STORE CURSOR                                               47520001
      ******************************************************************47530001
                                                                        47540001
       9530-OPEN-STORE-CURSOR.                                          47550001
           MOVE '*9530-OPEN-STORE-CURSOR.         *' TO DP013-PARAGRAPH 47560001
                                                                        47570001
           MOVE CA-DISTRICT-NUMBER     TO PV-DISTRICT-NBR.              47580080
           MOVE CA-DISTRICT-NUMBER     TO PV-DISTRICT-NBR-9.            47590080
           MOVE PV-DISTRICT-NBR-9      TO PV-DISTRICT-NBR-COMP.         47600081
                                                                        47610001
           EXEC SQL                                                     47620001
               OPEN DIST_STORE_CURS                                     47630001
           END-EXEC.                                                    47640001
                                                                        47650001
           EVALUATE TRUE                                                47660001
               WHEN SQLCODE = ZERO                                      47670001
                   CONTINUE                                             47680001
               WHEN OTHER                                               47690001
                   MOVE PF-ERR-MSG-7 TO DP013-MESSAGE-TEXT(1)           47700001
                   PERFORM 9900-DB2-ERROR                               47710001
           END-EVALUATE.                                                47720001
                                                                        47730001
           EJECT                                                        47740001
                                                                        47750001
      ******************************************************************47760001
      * FETCH STORES FROM STORE CURSOR                                  47770001
      ******************************************************************47780001
                                                                        47790001
       9535-FETCH-STORE-FROM-CURSOR.                                    47800001
           MOVE '*9535-FETCH-STORE-FROM-CURSOR.   *' TO DP013-PARAGRAPH 47810001
                                                                        47820001
           INITIALIZE PV-RETRY-COUNT.                                   47830001
           PERFORM WITH TEST AFTER                                      47840001
                   UNTIL ((SQLCODE = ZERO)                              47850001
                               OR                                       47860001
                         (SQLCODE = +100)                               47870001
                               OR                                       47880001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     47890001
               EXEC SQL                                                 47900001
                   FETCH DIST_STORE_CURS                                47910001
                   INTO :XMT00001-DIST-NBR                              47920074
               END-EXEC                                                 47930001
               EVALUATE TRUE                                            47940001
                   WHEN SQLCODE = -911                                  47950001
                   WHEN SQLCODE = -913                                  47960001
                       ADD +1 TO PV-RETRY-COUNT                         47970001
                   WHEN SQLCODE = ZERO                                  47980001
                       SET PS-STORES-FOUND TO TRUE                      47990001
                   WHEN SQLCODE = +100                                  48000001
                       SET PS-NO-MORE-STORES TO TRUE                    48010001
                   WHEN SQLCODE < ZERO                                  48020001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     48030001
                   WHEN SQLWARN0 NOT = SPACES                           48040001
                       MOVE PF-ERR-MSG-6 TO DP013-MESSAGE-TEXT(1)       48050001
                       PERFORM 9900-DB2-ERROR                           48060001
               END-EVALUATE                                             48070001
           END-PERFORM.                                                 48080001
                                                                        48090001
           IF ((SQLCODE = -911)                                         48100001
                     OR                                                 48110001
               (SQLCODE = -913))                                        48120001
               PERFORM 9900-DB2-ERROR                                   48130001
           END-IF.                                                      48140001
                                                                        48150001
           EJECT                                                        48160001
                                                                        48170001
      ******************************************************************48180001
      * CLOSE STORE CURSOR                                              48190001
      ******************************************************************48200001
                                                                        48210001
       9540-CLOSE-STORE-CURSOR.                                         48220001
           MOVE '*9540-CLOSE-STORE-CURSOR.        *' TO DP013-PARAGRAPH 48230001
                                                                        48240001
           EXEC SQL                                                     48250001
               CLOSE DIST_STORE_CURS                                    48260001
           END-EXEC.                                                    48270001
                                                                        48280001
           EVALUATE TRUE                                                48290001
               WHEN SQLCODE = ZERO                                      48300001
                   CONTINUE                                             48310001
               WHEN OTHER                                               48320001
                   MOVE PF-ERR-MSG-8 TO DP013-MESSAGE-TEXT(1)           48330001
                   PERFORM 9900-DB2-ERROR                               48340001
           END-EVALUATE.                                                48350001
                                                                        48360001
           EJECT                                                        48370001
                                                                        48380001
      ******************************************************************48390001
      *  FETCH THE MATCHING WEEKLY SALES ROW                            48400001
      ******************************************************************48410001
                                                                        48420001
       9550-FETCH-WEEKLY-SALES.                                         48430001
           MOVE '*9550-FETCH-WEEKLY-SALES.        *' TO DP013-PARAGRAPH 48440001
                                                                        48450001
           INITIALIZE PV-RETRY-COUNT.                                   48460001
           PERFORM WITH TEST AFTER                                      48470001
                   UNTIL ((SQLCODE = ZERO)                              48480001
                               OR                                       48490001
                         (SQLCODE = +100)                               48500001
                               OR                                       48510001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     48520001
               EXEC SQL                                                 48530001
                   FETCH WKLY_SALES_CURS                                48540001
                   INTO                                                 48550001
                      :SKSTWKS-FSCL-BOW-DTE,                            48560001
                      :SKSTWKS-SALES-TYPE-CODE,                         48570001
                      :SKSTWKS-SUN-SLS-UNIT-QTY,                        48580001
                      :SKSTWKS-MON-SLS-UNIT-QTY,                        48590001
                      :SKSTWKS-TUE-SLS-UNIT-QTY,                        48600001
                      :SKSTWKS-WED-SLS-UNIT-QTY,                        48610001
                      :SKSTWKS-THU-SLS-UNIT-QTY,                        48620001
                      :SKSTWKS-FRI-SLS-UNIT-QTY,                        48630001
                      :SKSTWKS-SAT-SLS-UNIT-QTY,                        48640001
                      :SKSTWKS-SALES-UNIT-QTY,                          48650001
                      :SKSTWKS-SALES-AMT                                48660001
               END-EXEC                                                 48670001
               EVALUATE TRUE                                            48680001
                   WHEN SQLCODE = -911                                  48690001
                   WHEN SQLCODE = -913                                  48700001
                       ADD +1 TO PV-RETRY-COUNT                         48710001
                   WHEN SQLCODE = ZERO                                  48720001
                       CONTINUE                                         48730001
                   WHEN SQLCODE = +100                                  48740001
                       SET PS-NO-MORE-WEEKS TO TRUE                     48750001
                   WHEN SQLCODE < ZERO                                  48760001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     48770001
                   WHEN SQLWARN0 NOT = SPACES                           48780001
                       MOVE PF-ERR-MSG-9 TO DP013-MESSAGE-TEXT(1)       48790001
                       PERFORM 9900-DB2-ERROR                           48800001
               END-EVALUATE                                             48810001
           END-PERFORM.                                                 48820001
                                                                        48830001
           IF ((SQLCODE = -911)                                         48840001
                     OR                                                 48850001
               (SQLCODE = -913))                                        48860001
               PERFORM 9900-DB2-ERROR                                   48870001
           END-IF.                                                      48880001
                                                                        48890001
           EJECT                                                        48900001
                                                                        48910001
      ******************************************************************48920001
      * OPEN TSKSTWKS CURSOR                                            48930001
      ******************************************************************48940001
                                                                        48950001
       9555-OPEN-TSKSTWKS-CURSOR.                                       48960001
           MOVE '*9555-OPEN-TSKSTWKS-CURSOR.     *' TO DP013-PARAGRAPH  48970001
                                                                        48980001
           EXEC SQL                                                     48990001
               OPEN WKLY_SALES_CURS                                     49000001
           END-EXEC.                                                    49010001
                                                                        49020001
           EVALUATE TRUE                                                49030001
               WHEN SQLCODE = ZERO                                      49040001
                   CONTINUE                                             49050001
               WHEN OTHER                                               49060001
                   MOVE PF-ERR-MSG-15 TO DP013-MESSAGE-TEXT(1)          49070001
                   PERFORM 9900-DB2-ERROR                               49080001
           END-EVALUATE.                                                49090001
                                                                        49100001
           EJECT                                                        49110001
                                                                        49120001
      ******************************************************************49130001
      * CLOSE TSKSTWKS CURSOR                                           49140001
      ******************************************************************49150001
                                                                        49160001
       9560-CLOSE-TSKSTWKS-CURSOR.                                      49170001
           MOVE '*9560-CLOSE-TSKSTWKS-CURSOR.    *' TO DP013-PARAGRAPH  49180001
                                                                        49190001
           EXEC SQL                                                     49200001
               CLOSE WKLY_SALES_CURS                                    49210001
           END-EXEC.                                                    49220001
                                                                        49230001
           EVALUATE TRUE                                                49240001
               WHEN SQLCODE = ZERO                                      49250001
                   CONTINUE                                             49260001
               WHEN OTHER                                               49270001
                   MOVE PF-ERR-MSG-16 TO DP013-MESSAGE-TEXT(1)          49280001
                   PERFORM 9900-DB2-ERROR                               49290001
           END-EVALUATE.                                                49300001
                                                                        49310001
           EJECT                                                        49320001
                                                                        49330001
      ******************************************************************49340001
      *  GET THE MATCHING WEEKLY INVENTORY ROW                          49350001
      ******************************************************************49360001
                                                                        49370001
       9565-SELECT-WEEKLY-INVENTORY.                                    49380001
           MOVE '*9565-SELECT-WEEKLY-INVENTORY.   *' TO DP013-PARAGRAPH 49390001
                                                                        49400001
           INITIALIZE PV-RETRY-COUNT.                                   49410001
           PERFORM WITH TEST AFTER                                      49420001
                   UNTIL ((SQLCODE = ZERO)                              49430001
                               OR                                       49440001
                         (SQLCODE = +100)                               49450001
                               OR                                       49460001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     49470001
               EXEC SQL                                                 49480001
                   SELECT                                               49490001
                       INVEN_ONHAND_QTY                                 49500001
                      ,INVEN_RTL_AMT                                    49510001
                   INTO                                                 49520001
                      :SKSTWKI-INVEN-ONHAND-QTY                         49530001
                     ,:SKSTWKI-INVEN-RTL-AMT                            49540001
                   FROM                                                 49550001
                       TSKSTWKI                                         49560001
                   WHERE                                                49570001
                    ((:TSK-ITEM-NMBR = ITEM_NMBR)                       49580001
                                  AND                                   49590001
                     (:TSKST-LOC-NBR = LOC_NBR)                         49600074
                                  AND                                   49610001
                     (:PV-WEEK-IND = FSCL_BOW_DTE))                     49620001
               END-EXEC                                                 49630001
               EVALUATE TRUE                                            49640001
                   WHEN SQLCODE = -911                                  49650001
                   WHEN SQLCODE = -913                                  49660001
                       ADD +1 TO PV-RETRY-COUNT                         49670001
                   WHEN ((SQLCODE = ZERO) OR (SQLCODE = +100))          49680001
                       CONTINUE                                         49690001
                   WHEN SQLCODE < ZERO                                  49700001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     49710001
                   WHEN SQLWARN0 NOT = SPACES                           49720001
                       MOVE PF-ERR-MSG-10 TO DP013-MESSAGE-TEXT(1)      49730001
                       PERFORM 9900-DB2-ERROR                           49740001
               END-EVALUATE                                             49750001
           END-PERFORM.                                                 49760001
                                                                        49770001
           IF ((SQLCODE = -911)                                         49780001
                     OR                                                 49790001
               (SQLCODE = -913))                                        49800001
               PERFORM 9900-DB2-ERROR                                   49810001
           END-IF.                                                      49820001
                                                                        49830001
           EJECT                                                        49840001
                                                                        49850001
      ******************************************************************49860001
      * OPEN TSKSTMTH CURSOR                                            49870001
      ******************************************************************49880001
                                                                        49890001
       9570-OPEN-TSKSTMTH-CURSOR.                                       49900001
           MOVE '*9570-OPEN-TSKSTMTH-CURSOR.    *' TO DP013-PARAGRAPH.  49910069
                                                                        49920001
           EJECT                                                        49930001
                                                                        49940001
      ******************************************************************49950001
      * CLOSE TSKSTMTH CURSOR                                           49960001
      ******************************************************************49970001
                                                                        49980001
       9575-CLOSE-TSKSTMTH-CURSOR.                                      49990001
           MOVE '*9575-CLOSE-TSKSTMTH-CURSOR.   *' TO DP013-PARAGRAPH.  50000069
                                                                        50010001
           EJECT                                                        50020001
                                                                        50030001
      ******************************************************************50040001
      *  FETCH THE MATCHING MONTHLY SALES ROW                           50050001
      ******************************************************************50060001
                                                                        50070001
       9580-FETCH-MONTHLY-SALES.                                        50080001
           MOVE '*9580-FETCH-MONTHLY-SALES.       *' TO DP013-PARAGRAPH.50090069
                                                                        50100001
           EJECT                                                        50110001
                                                                        50120001
      ******************************************************************50130001
      *  GET THE MATCHING SKU STORE ROW                                 50140001
      ******************************************************************50150001
                                                                        50160001
       9585-SELECT-SKU-STORE.                                           50170001
           MOVE '*9585-SELECT-SKU-STORE.          *' TO DP013-PARAGRAPH 50180001
                                                                        50190001
           INITIALIZE PV-RETRY-COUNT.                                   50200001
           INITIALIZE PV-UPC-INTR-UPC-ID.                               50210001
           PERFORM WITH TEST AFTER                                      50220001
                   UNTIL ((SQLCODE = ZERO)                              50230001
                               OR                                       50240001
                         (SQLCODE = +100)                               50250001
                               OR                                       50260001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     50270001
               EXEC SQL                                                 50280001
                   SELECT                                               50290001
                       A.LOC_NBR,                                       50300075
                       A.ONHAND_QTY,                                    50310001
                       C.INTR_UPC_ID                                    50320001
                   INTO                                                 50330001
                      :TSKST-LOC-NBR,                                   50340076
                      :TSKST-ONHAND-QTY,                                50350001
                      :UPC-INTR-UPC-ID                                  50360001
                   FROM                                                 50370001
                       TSKST               A                            50380001
                      ,TUPCSKU             B                            50390001
                      ,TUPC                C                            50400001
                   WHERE                                                50410001
                    ((:TSK-ITEM-NMBR = A.ITEM_NMBR)                     50420001
                             AND                                        50430001
                     (B.ITEM_NBR     = A.ITEM_NMBR)                     50440001
                             AND                                        50450001
                     (:PV-STORE-NUMBER-COMP = A.LOC_NBR)                50460084
                             AND                                        50470001
                     (B.UPC_NBR        = C.UPC_NBR)                     50480001
                             AND                                        50490001
                     (C.UPC_TYP_CDE    = 'I')                           50500003
                     AND ((CURRENT DATE  BETWEEN                        50510003
                          EFF_BEG_DTE  AND  EFF_END_DTE)  OR            50520003
                         (CURRENT DATE   > EFF_BEG_DTE      AND         50530003
                          EFF_END_DTE  IS NULL)))                       50540003
               END-EXEC                                                 50550001
               EVALUATE TRUE                                            50560001
                   WHEN SQLCODE = ZERO                                  50570001
                       MOVE UPC-INTR-UPC-ID TO PV-UPC-INTR-UPC-ID       50580001
                   WHEN SQLCODE = -911                                  50590001
                   WHEN SQLCODE = -913                                  50600001
                       ADD +1 TO PV-RETRY-COUNT                         50610001
                   WHEN SQLCODE = +100                                  50620099
                       CONTINUE                                         50630099
                   WHEN SQLCODE < ZERO                                  50640099
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     50650099
                   WHEN SQLWARN0 NOT = SPACES                           50660099
                       MOVE PF-ERR-MSG-12 TO DP013-MESSAGE-TEXT(1)      50670099
                       PERFORM 9900-DB2-ERROR                           50680099
               END-EVALUATE                                             50690099
           END-PERFORM.                                                 50700099
                                                                        50710099
           IF ((SQLCODE = -911)                                         50720099
                     OR                                                 50730099
               (SQLCODE = -913))                                        50740099
               PERFORM 9900-DB2-ERROR                                   50750099
           END-IF.                                                      50760099
          EJECT                                                         50770099
                                                                        50780099
       9600-SUM-TDISTSM-DATA.                                           50790099
           MOVE '*9600-SUM-TDISTSM-DATA.       *' TO DP013-PARAGRAPH    50800099
                                                                        50810099
           INITIALIZE PV-RETRY-COUNT                                    50820099
                      DCLTDISTSM.                                       50830099
                                                                        50840099
           PERFORM WITH TEST AFTER                                      50850099
                   UNTIL ((SQLCODE = ZERO)                              50860099
                               OR                                       50870099
                         (SQLCODE = +100)                               50880099
                               OR                                       50890099
                         (SQLCODE = -305)                               50900099
                               OR                                       50910099
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     50920099
               EXEC SQL                                                 50930099
                   SELECT SUM(OH_QTY)                                   50940099
                         ,SUM(OH_AMT)                                   50950099
                         ,SUM(ONORD_QTY)                                50960099
                         ,SUM(ONORD_AMT)                                50970099
                         ,SUM(ENTRE_QTY)                                50980099
                         ,SUM(ENTRE_AMT)                                50990099
                         ,SUM(SUN_SIS_QTY)                              51000099
                         ,SUM(SUN_SIS_AMT)                              51010099
                         ,SUM(MON_SIS_QTY)                              51020099
                         ,SUM(MON_SIS_AMT)                              51030099
                         ,SUM(TUE_SIS_QTY)                              51040099
                         ,SUM(TUE_SIS_AMT)                              51050099
                         ,SUM(WED_SIS_QTY)                              51060099
                         ,SUM(WED_SIS_AMT)                              51070099
                         ,SUM(THU_SIS_QTY)                              51080099
                         ,SUM(THU_SIS_AMT)                              51090099
                         ,SUM(FRI_SIS_QTY)                              51100099
                         ,SUM(FRI_SIS_AMT)                              51110099
                         ,SUM(SAT_SIS_QTY)                              51120099
                         ,SUM(SAT_SIS_AMT)                              51130099
                         ,SUM(PWK_SUN_SIS_QTY)                          51140099
                         ,SUM(PWK_SUN_SIS_AMT)                          51150099
                         ,SUM(PWK_MON_SIS_QTY)                          51160099
                         ,SUM(PWK_MON_SIS_AMT)                          51170099
                         ,SUM(PWK_TUE_SIS_QTY)                          51180099
                         ,SUM(PWK_TUE_SIS_AMT)                          51190099
                         ,SUM(PWK_WED_SIS_QTY)                          51200099
                         ,SUM(PWK_WED_SIS_AMT)                          51210099
                         ,SUM(PWK_THU_SIS_QTY)                          51220099
                         ,SUM(PWK_THU_SIS_AMT)                          51230099
                         ,SUM(PWK_FRI_SIS_QTY)                          51240099
                         ,SUM(PWK_FRI_SIS_AMT)                          51250099
                         ,SUM(PWK_SAT_SIS_QTY)                          51260099
                         ,SUM(PWK_SAT_SIS_AMT)                          51270099
                         ,SUM(IN_TRNST_QTY)                             51280099
                         ,SUM(IN_TRNST_AMT)                             51290099
                   INTO   :DISTSM-OH-QTY                                51300099
                         ,:DISTSM-OH-AMT                                51310099
                         ,:DISTSM-ONORD-QTY                             51320099
                         ,:DISTSM-ONORD-AMT                             51330099
                         ,:DISTSM-ENTRE-QTY                             51340099
                         ,:DISTSM-ENTRE-AMT                             51350099
                         ,:DISTSM-SUN-SIS-QTY                           51360099
                         ,:DISTSM-SUN-SIS-AMT                           51370099
                         ,:DISTSM-MON-SIS-QTY                           51380099
                         ,:DISTSM-MON-SIS-AMT                           51390099
                         ,:DISTSM-TUE-SIS-QTY                           51400099
                         ,:DISTSM-TUE-SIS-AMT                           51410099
                         ,:DISTSM-WED-SIS-QTY                           51420099
                         ,:DISTSM-WED-SIS-AMT                           51430099
                         ,:DISTSM-THU-SIS-QTY                           51440099
                         ,:DISTSM-THU-SIS-AMT                           51450099
                         ,:DISTSM-FRI-SIS-QTY                           51460099
                         ,:DISTSM-FRI-SIS-AMT                           51470099
                         ,:DISTSM-SAT-SIS-QTY                           51480099
                         ,:DISTSM-SAT-SIS-AMT                           51490099
                         ,:DISTSM-PWK-SUN-SIS-QTY                       51500099
                         ,:DISTSM-PWK-SUN-SIS-AMT                       51510099
                         ,:DISTSM-PWK-MON-SIS-QTY                       51520099
                         ,:DISTSM-PWK-MON-SIS-AMT                       51530099
                         ,:DISTSM-PWK-TUE-SIS-QTY                       51540099
                         ,:DISTSM-PWK-TUE-SIS-AMT                       51550099
                         ,:DISTSM-PWK-WED-SIS-QTY                       51560099
                         ,:DISTSM-PWK-WED-SIS-AMT                       51570099
                         ,:DISTSM-PWK-THU-SIS-QTY                       51580099
                         ,:DISTSM-PWK-THU-SIS-AMT                       51590099
                         ,:DISTSM-PWK-FRI-SIS-QTY                       51600099
                         ,:DISTSM-PWK-FRI-SIS-AMT                       51610099
                         ,:DISTSM-PWK-SAT-SIS-QTY                       51620099
                         ,:DISTSM-PWK-SAT-SIS-AMT                       51630099
                         ,:DISTSM-IN-TRNST-QTY                          51640099
                         ,:DISTSM-IN-TRNST-AMT                          51650099
                   FROM   TDISTSM                                       51660099
MK                 WHERE  ITM_NBR  = :TSK-ITEM-NMBR                     51670099
                     AND  STAT_CDE IN ('20','30')                       51680099
                     AND  SUM_LVL_CDE = :PV-SUM-LVL-CDE                 51690099
                     AND  DIST_NBR = :PV-TDISTSM-DISTRICT               51700099
               END-EXEC                                                 51710099
                                                                        51720099
               EVALUATE TRUE                                            51730099
                   WHEN SQLCODE = -911                                  51740099
                   WHEN SQLCODE = -913                                  51750099
                       ADD +1 TO PV-RETRY-COUNT                         51760099
                   WHEN SQLCODE = ZERO                                  51770099
                       CONTINUE                                         51780099
                   WHEN SQLCODE = +100                                  51790099
                       CONTINUE                                         51800099
                   WHEN SQLCODE = -305                                  51810099
                       CONTINUE                                         51820099
                   WHEN SQLCODE < ZERO                                  51830099
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     51840099
                   WHEN SQLWARN0 NOT = SPACES                           51850099
                       MOVE PF-ERR-MSG-18 TO DP013-MESSAGE-TEXT(1)      51860099
                       PERFORM 9900-DB2-ERROR                           51870099
               END-EVALUATE                                             51880099
           END-PERFORM.                                                 51890099
                                                                        51900099
           IF ((SQLCODE = -911)                                         51910099
                     OR                                                 51920099
               (SQLCODE = -913))                                        51930099
               PERFORM 9900-DB2-ERROR                                   51940099
           END-IF.                                                      51950099
                                                                        51960099
           EJECT                                                        51970099
                                                                        51980099
       9700-SELECT-TDISTSM-DATA.                                        51990099
           MOVE '*9700-SELECT-TDISTSM-DATA.    *' TO DP013-PARAGRAPH    52000099
                                                                        52010099
           INITIALIZE PV-RETRY-COUNT                                    52020099
                      DCLTDISTSM.                                       52030099
                                                                        52040099
           PERFORM WITH TEST AFTER                                      52050099
                   UNTIL ((SQLCODE = ZERO)                              52060099
                               OR                                       52070099
                         (SQLCODE = +100)                               52080099
                               OR                                       52090099
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     52100099
               EXEC SQL                                                 52110099
                   SELECT OH_QTY                                        52120099
                         ,OH_AMT                                        52130099
                         ,ONORD_QTY                                     52140099
                         ,ONORD_AMT                                     52150099
                         ,ENTRE_QTY                                     52160099
                         ,ENTRE_AMT                                     52170099
                         ,SUN_SIS_QTY                                   52180099
                         ,SUN_SIS_AMT                                   52190099
                         ,MON_SIS_QTY                                   52200099
                         ,MON_SIS_AMT                                   52210099
                         ,TUE_SIS_QTY                                   52220099
                         ,TUE_SIS_AMT                                   52230099
                         ,WED_SIS_QTY                                   52240099
                         ,WED_SIS_AMT                                   52250099
                         ,THU_SIS_QTY                                   52260099
                         ,THU_SIS_AMT                                   52270099
                         ,FRI_SIS_QTY                                   52280099
                         ,FRI_SIS_AMT                                   52290099
                         ,SAT_SIS_QTY                                   52300099
                         ,SAT_SIS_AMT                                   52310099
                         ,PWK_SUN_SIS_QTY                               52320099
                         ,PWK_SUN_SIS_AMT                               52330099
                         ,PWK_MON_SIS_QTY                               52340099
                         ,PWK_MON_SIS_AMT                               52350099
                         ,PWK_TUE_SIS_QTY                               52360099
                         ,PWK_TUE_SIS_AMT                               52370099
                         ,PWK_WED_SIS_QTY                               52380099
                         ,PWK_WED_SIS_AMT                               52390099
                         ,PWK_THU_SIS_QTY                               52400099
                         ,PWK_THU_SIS_AMT                               52410099
                         ,PWK_FRI_SIS_QTY                               52420099
                         ,PWK_FRI_SIS_AMT                               52430099
                         ,PWK_SAT_SIS_QTY                               52440099
                         ,PWK_SAT_SIS_AMT                               52450099
                         ,IN_TRNST_QTY                                  52460099
                         ,IN_TRNST_AMT                                  52470099
                   INTO   :DISTSM-OH-QTY                                52480099
                         ,:DISTSM-OH-AMT                                52490099
                         ,:DISTSM-ONORD-QTY                             52500099
                         ,:DISTSM-ONORD-AMT                             52510099
                         ,:DISTSM-ENTRE-QTY                             52520099
                         ,:DISTSM-ENTRE-AMT                             52530099
                         ,:DISTSM-SUN-SIS-QTY                           52540099
                         ,:DISTSM-SUN-SIS-AMT                           52550099
                         ,:DISTSM-MON-SIS-QTY                           52560099
                         ,:DISTSM-MON-SIS-AMT                           52570099
                         ,:DISTSM-TUE-SIS-QTY                           52580099
                         ,:DISTSM-TUE-SIS-AMT                           52590099
                         ,:DISTSM-WED-SIS-QTY                           52600099
                         ,:DISTSM-WED-SIS-AMT                           52610099
                         ,:DISTSM-THU-SIS-QTY                           52620099
                         ,:DISTSM-THU-SIS-AMT                           52630099
                         ,:DISTSM-FRI-SIS-QTY                           52640099
                         ,:DISTSM-FRI-SIS-AMT                           52650099
                         ,:DISTSM-SAT-SIS-QTY                           52660099
                         ,:DISTSM-SAT-SIS-AMT                           52670099
                         ,:DISTSM-PWK-SUN-SIS-QTY                       52680099
                         ,:DISTSM-PWK-SUN-SIS-AMT                       52690099
                         ,:DISTSM-PWK-MON-SIS-QTY                       52700099
                         ,:DISTSM-PWK-MON-SIS-AMT                       52710099
                         ,:DISTSM-PWK-TUE-SIS-QTY                       52720099
                         ,:DISTSM-PWK-TUE-SIS-AMT                       52730099
                         ,:DISTSM-PWK-WED-SIS-QTY                       52740099
                         ,:DISTSM-PWK-WED-SIS-AMT                       52750099
                         ,:DISTSM-PWK-THU-SIS-QTY                       52760099
                         ,:DISTSM-PWK-THU-SIS-AMT                       52770099
                         ,:DISTSM-PWK-FRI-SIS-QTY                       52780099
                         ,:DISTSM-PWK-FRI-SIS-AMT                       52790099
                         ,:DISTSM-PWK-SAT-SIS-QTY                       52800099
                         ,:DISTSM-PWK-SAT-SIS-AMT                       52810099
                         ,:DISTSM-IN-TRNST-QTY                          52820099
                         ,:DISTSM-IN-TRNST-AMT                          52830099
                   FROM   TDISTSM                                       52840099
MK                 WHERE  ITM_NBR = :TSK-ITEM-NMBR                      52850099
                     AND  STAT_CDE = :PV-TDISTSM-STATUS-CDE             52860099
                     AND  SUM_LVL_CDE = :PV-SUM-LVL-CDE                 52870099
                     AND  DIST_NBR = :PV-TDISTSM-DISTRICT               52880099
               END-EXEC                                                 52890099
                                                                        52900099
               EVALUATE TRUE                                            52910099
                   WHEN SQLCODE = -911                                  52920099
                   WHEN SQLCODE = -913                                  52930099
                       ADD +1 TO PV-RETRY-COUNT                         52940099
                   WHEN SQLCODE = ZERO                                  52950099
                       CONTINUE                                         52960099
                   WHEN SQLCODE = +100                                  52970001
                       CONTINUE                                         52980001
                   WHEN SQLCODE < ZERO                                  52990001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     53000001
                   WHEN SQLWARN0 NOT = SPACES                           53010001
                       MOVE PF-ERR-MSG-19 TO DP013-MESSAGE-TEXT(1)      53020099
                       PERFORM 9900-DB2-ERROR                           53030001
               END-EVALUATE                                             53040001
           END-PERFORM.                                                 53050001
                                                                        53060001
           IF ((SQLCODE = -911)                                         53070001
                     OR                                                 53080001
               (SQLCODE = -913))                                        53090001
               PERFORM 9900-DB2-ERROR                                   53100001
           END-IF.                                                      53110001
                                                                        53120099
           EJECT                                                        53130099
                                                                        53140001
       9800-SELECT-TUPCPLS-DATA.                                        53150001
           MOVE '*9800-SELECT-TUPCPLS-DATA.    *' TO DP013-PARAGRAPH    53160001
                                                                        53170001
           INITIALIZE PV-RETRY-COUNT                                    53180001
                      DCLTUPCPLS.                                       53190001
                                                                        53200001
           PERFORM WITH TEST AFTER                                      53210001
                   UNTIL ((SQLCODE = ZERO)                              53220001
                               OR                                       53230001
                         (SQLCODE = +100)                               53240001
                               OR                                       53250001
                         (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))     53260001
               EXEC SQL                                                 53270001
                   SELECT UNT_RTL_AMT                                   53280001
                   INTO   :UPCPLS-UNT-RTL-AMT                           53290001
                   FROM   TUPCPLS                                       53300001
                   WHERE  OPERCO_NBR = :PC-OPERATING-COMPANY            53310001
                     AND  ITM_NBR = :TSK-ITEM-NMBR                      53320001
                     AND  STR_NBR = :PV-STORE-NUMBER-COMP               53330001
                     AND  ((EFF_BEG_TMST <= CURRENT TIMESTAMP           53340001
                        AND EFF_END_TMST >= CURRENT TIMESTAMP)          53350001
                        OR (EFF_BEG_TMST <= CURRENT TIMESTAMP           53360001
                        AND EFF_END_TMST IS NULL))                      53370001
               END-EXEC                                                 53380001
                                                                        53390001
               EVALUATE TRUE                                            53400001
                   WHEN SQLCODE = -911                                  53410001
                   WHEN SQLCODE = -913                                  53420001
                       ADD +1 TO PV-RETRY-COUNT                         53430001
                   WHEN SQLCODE = ZERO                                  53440001
                       SET PS-TUPCPLS-ROW-FOUND TO TRUE                 53450054
                   WHEN SQLCODE = +100                                  53460001
                       SET PS-TUPCPLS-ROW-NOT-FOUND TO TRUE             53470054
                   WHEN SQLCODE < ZERO                                  53480001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     53490001
                   WHEN SQLWARN0 NOT = SPACES                           53500001
                       MOVE PF-ERR-MSG-19 TO DP013-MESSAGE-TEXT(1)      53510001
                       PERFORM 9900-DB2-ERROR                           53520001
               END-EVALUATE                                             53530001
           END-PERFORM.                                                 53540001
                                                                        53550001
           IF ((SQLCODE = -911)                                         53560001
                     OR                                                 53570001
               (SQLCODE = -913))                                        53580001
               PERFORM 9900-DB2-ERROR                                   53590001
           END-IF.                                                      53600001
                                                                        53610001
           EJECT                                                        53620001
                                                                        53630001
       9000-READ-TS-QUEUE.                                              53640001
           MOVE '*9000-READ-TS-QUEUE.             *' TO DP013-PARAGRAPH 53650001
                                                                        53660001
           SET CA-TS-SELECTED-ITEMS TO TRUE                             53670001
                                                                        53680001
           IF DP020-NEXT-ACT-INITIAL                                    53690001
               MOVE +1 TO CA-TS-ITEM-NUMBER                             53700001
                          CA-FS002-IDX.                                 53710001
                                                                        53720001
           EXEC CICS                                                    53730001
                READQ TS                                                53740001
                    QUEUE (CA-SEL-QUEUE-NAME)                           53750001
                    INTO  (FS002-TS-SEL-REC)                            53760001
                    ITEM  (CA-TS-ITEM-NUMBER)                           53770001
                    RESP  (PV-CICS-RESPONSE)                            53780001
           END-EXEC.                                                    53790001
      *                                                                 53800001
           IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      53810099
               MOVE FS002-TS-SEL-REC     TO  CA-FS002-AREA              53820099
           ELSE                                                         53830099
               IF PV-CICS-RESPONSE = DFHRESP (ITEMERR)                  53840001
                   MOVE PC-TSYMSG-00113  TO  DP020-MSG-NUMBER           53850001
                   SET PS-EDIT-ERROR     TO  TRUE                       53860001
                   SET DP020-MSG-WARNING TO  TRUE                       53870001
                   SET DP030-SET-CURSOR-TRAILER TO TRUE                 53880001
               ELSE                                                     53890001
      *MD 2/20    --> TRAP QIDERRORS <--                                53900001
                  IF PV-CICS-RESPONSE = DFHRESP (QIDERR)                53910001
                     SET DP013-CICS-ABEND      TO  TRUE                 53920001
                     SET DP013-NO-ROLLBACK     TO  TRUE                 53930001
                     MOVE '9000-READ-TS-QIDERR'                         53940001
                                               TO  DP013-PARAGRAPH      53950001
                     MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'     53960001
                                               TO  DP013-MESSAGE-TEXT(1)53970001
                     MOVE '- QIDERR CONDITION (QUEUE DOESNT EXIST) '    53980001
                                               TO  DP013-MESSAGE-TEXT(2)53990001
                     PERFORM DP013-0000-PROCESS-ABEND                   54000001
      *MD 2/20                                                          54010001
                  ELSE                                                  54020001
                     SET DP013-CICS-ABEND      TO  TRUE                 54030001
                     SET DP013-NO-ROLLBACK     TO  TRUE                 54040001
                     MOVE '9000-READ-TS-QUEUE' TO  DP013-PARAGRAPH      54050001
                     MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'     54060001
                                               TO  DP013-MESSAGE-TEXT(1)54070001
                     PERFORM DP013-0000-PROCESS-ABEND                   54080001
                  END-IF                                                54090001
               END-IF                                                   54100001
           END-IF.                                                      54110001
                                                                        54120001
       9100-REWRITE-TS-QUEUE.                                           54130001
           MOVE '*9100-REWRITE-TS-QUEUE.          *' TO DP013-PARAGRAPH 54140001
                                                                        54150001
           SET CA-TS-SELECTED-ITEMS TO TRUE                             54160001
                                                                        54170001
           EXEC CICS                                                    54180001
                WRITEQ TS                                               54190001
                    QUEUE (CA-SEL-QUEUE-NAME)                           54200001
                    FROM  (FS002-TS-SEL-REC)                            54210001
                    ITEM  (CA-TS-ITEM-NUMBER)                           54220001
                    RESP  (PV-CICS-RESPONSE)                            54230001
                    REWRITE                                             54240001
           END-EXEC.                                                    54250001
      *                                                                 54260001
           IF  PV-CICS-RESPONSE NOT = DFHRESP (NORMAL)                  54270001
               SET DP013-CICS-ABEND      TO  TRUE                       54280001
               SET DP013-NO-ROLLBACK     TO  TRUE                       54290001
               MOVE '9100-REWRITE-TS-QUEUE' TO  DP013-PARAGRAPH         54300001
               MOVE 'ATTEMPTING TO REWRITE SELECTED ITEMS QUEUE'        54310001
                                         TO  DP013-MESSAGE-TEXT(1)      54320001
               MOVE 'TO SIGNIFY THAT THE SKU HAS BEEN VIEWED   '        54330001
                                         TO  DP013-MESSAGE-TEXT(2)      54340001
               PERFORM DP013-0000-PROCESS-ABEND                         54350001
           END-IF.                                                      54360001
                                                                        54370001
           EJECT                                                        54380001
       9200-READ-CRITERIA-QUEUE.                                        54390001
           MOVE '*9200-READ-CRITERIA-QUEUE.       *' TO DP013-PARAGRAPH 54400001
                                                                        54410001
           SET CA-TS-SHARED-DATA TO TRUE                                54420001
                                                                        54430001
           EXEC CICS                                                    54440001
                READQ TS                                                54450001
                    QUEUE (CA-SEL-QUEUE-NAME)                           54460001
                    INTO  (CA-FSKCS034-CRITERIA-DATA)                   54470001
                    ITEM  (PC-ONE)                                      54480001
                    RESP  (PV-CICS-RESPONSE)                            54490001
           END-EXEC.                                                    54500001
      *                                                                 54510001
           IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      54520001
               CONTINUE                                                 54530001
           ELSE                                                         54540001
               IF PV-CICS-RESPONSE = DFHRESP (ITEMERR)                  54550001
                   MOVE PC-TSYMSG-00113  TO  DP020-MSG-NUMBER           54560001
                   SET PS-EDIT-ERROR     TO  TRUE                       54570001
                   SET DP020-MSG-WARNING TO  TRUE                       54580001
                   SET DP030-SET-CURSOR-TRAILER TO TRUE                 54590001
               ELSE                                                     54600001
                   SET DP013-CICS-ABEND      TO  TRUE                   54610001
                   SET DP013-NO-ROLLBACK     TO  TRUE                   54620001
                   MOVE '9200-READ-TS-QUEUE' TO  DP013-PARAGRAPH        54630001
                   MOVE 'ATTEMPTING TO READ SELECTION CRITERIA QUEUE'   54640001
                                             TO  DP013-MESSAGE-TEXT(1)  54650001
                   PERFORM DP013-0000-PROCESS-ABEND                     54660001
               END-IF                                                   54670001
           END-IF.                                                      54680001
           EJECT                                                        54690001
                                                                        54700001
      ******************************************************************54710001
      *    AT ONE POINT IN TIME, F034 STARTED F033 TO PERFORM DB2 I/O.  54720001
      *    THE CONTENTS OF FSKCS033 ARE NOW IN FSKCS034 AS FOUND BELOW. 54730001
      ******************************************************************54740001
                                                                        54750001
       F033-0000-FSKCS033-SECTION.                                      54760001
                                                                        54770001
           SET PS-NO-EDIT-ERROR TO TRUE.                                54780001
                                                                        54790001
           EVALUATE TRUE                                                54800001
               WHEN CA-NEXT-STORE                                       54810001
                   PERFORM F033-1000-NEXT-STORE                         54820001
               WHEN CA-NEXT-SKU                                         54830001
                   PERFORM F033-2000-NEXT-SKU                           54840001
               WHEN CA-NEXT-DEPT                                        54850001
                   PERFORM F033-3000-NEXT-DEPARTMENT                    54860001
               WHEN CA-NEXT-CLASS                                       54870001
                   PERFORM F033-4000-NEXT-CLASS                         54880001
           END-EVALUATE.                                                54890001
                                                                        54900001
           IF PS-EDIT-ERROR                                             54910001
               PERFORM 3000-NO-NEXT-FOUND                               54920001
           ELSE                                                         54930001
               PERFORM 2000-INITIALIZE.                                 54940001
                                                                        54950001
           EJECT                                                        54960001
      ******************************************************************54970001
      *  GIVEN THE STORE THAT IS PASSED IN THE COMMAREA FROM FSKCS032,  54980001
      *  FILL THE CURSOR FOR THE STORE AND TRY TO FIND A 'NEXT' STORE.  54990001
      ******************************************************************55000001
                                                                        55010001
       F033-1000-NEXT-STORE.                                            55020001
                                                                        55030001
           SET PS-NO-STORES-FOUND TO TRUE.                              55040001
                                                                        55050001
           PERFORM F033-1200-OPEN-STORE-CURSOR.                         55060001
           PERFORM F033-1300-FETCH-NEXT-STORE.                          55070001
           PERFORM F033-1400-CLOSE-STORE-CURSOR.                        55080001
                                                                        55090001
           IF PS-STORES-FOUND                                           55100001
               MOVE XMT00001-DIST-NBR         TO CA-STORE-NUMBER-9      55110074
               MOVE XMT00001-LOC-10-ABBR-NM   TO CA-STORE-NAME          55120079
                                                 CA-STORE-SHORT-NAME    55130074
W43143                                           FS009-STORE-NAME       55140099
           ELSE                                                         55150001
               SET PS-EDIT-ERROR TO TRUE                                55160001
           END-IF.                                                      55170001
                                                                        55180001
           EJECT                                                        55190001
                                                                        55200001
      ******************************************************************55210001
      * OPEN STORE CURSOR                                               55220001
      ******************************************************************55230001
                                                                        55240001
       F033-1200-OPEN-STORE-CURSOR.                                     55250001
           MOVE '*F033-1200-OPEN-STORE-CURSOR.    *' TO DP013-PARAGRAPH 55260001
                                                                        55270075
           MOVE CA-STORE-NUMBER-9 TO PV-STORE-NUMBER-COMP               55280075
                                                                        55290001
           EXEC SQL                                                     55300001
               OPEN STORE_CURSOR                                        55310001
           END-EXEC.                                                    55320001
                                                                        55330001
           EVALUATE TRUE                                                55340001
               WHEN SQLCODE = ZERO                                      55350001
                   CONTINUE                                             55360001
               WHEN OTHER                                               55370001
                   MOVE PE-ERR-MSG-1 TO DP013-MESSAGE-TEXT(1)           55380001
                   PERFORM 9900-DB2-ERROR                               55390001
           END-EVALUATE.                                                55400001
                                                                        55410001
           EJECT                                                        55420001
                                                                        55430001
      ******************************************************************55440001
      * SQL FOR RETRIEVING STORE FROM ESTABLISHED STORE CURSOR          55450001
      ******************************************************************55460001
                                                                        55470001
       F033-1300-FETCH-NEXT-STORE.                                      55480001
           MOVE '*F033-1300-FETCH-NEXT-STORE.     *' TO DP013-PARAGRAPH 55490001
                                                                        55500001
           INITIALIZE PV-RETRY-COUNT.                                   55510001
           PERFORM WITH TEST AFTER                                      55520001
                   UNTIL ((SQLCODE = ZERO)                              55530001
                                 OR                                     55540001
                          (SQLCODE = +100)                              55550001
                                 OR                                     55560001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    55570001
               EXEC SQL                                                 55580001
                   FETCH STORE_CURSOR                                   55590001
                   INTO                                                 55600001
                       :XMT00001-DIST-NBR,                              55610074
                       :XMT00001-LOC-10-ABBR-NM                         55620079
               END-EXEC                                                 55630001
               EVALUATE TRUE                                            55640001
                   WHEN SQLCODE = -911                                  55650001
                   WHEN SQLCODE = -913                                  55660001
                       ADD +1 TO PV-RETRY-COUNT                         55670001
                   WHEN SQLCODE = ZERO                                  55680001
                       SET PS-STORES-FOUND TO TRUE                      55690001
                   WHEN SQLCODE = +100                                  55700001
                       SET PS-EDIT-ERROR   TO TRUE                      55710001
                   WHEN SQLCODE < ZERO                                  55720001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     55730001
                   WHEN SQLWARN0 NOT = SPACES                           55740001
                       MOVE PE-ERR-MSG-3 TO DP013-MESSAGE-TEXT(1)       55750001
                       PERFORM 9900-DB2-ERROR                           55760001
               END-EVALUATE                                             55770001
           END-PERFORM.                                                 55780001
                                                                        55790001
           IF ((SQLCODE = -911)                                         55800001
                   OR                                                   55810001
               (SQLCODE = -913))                                        55820001
               PERFORM 9900-DB2-ERROR                                   55830001
           END-IF.                                                      55840001
                                                                        55850001
           EJECT                                                        55860001
                                                                        55870001
      ******************************************************************55880001
      * CLOSE STORE CURSOR                                              55890001
      ******************************************************************55900001
                                                                        55910001
       F033-1400-CLOSE-STORE-CURSOR.                                    55920001
           MOVE '*F033-1400-CLOSE-STORE-CURSOR.   *' TO DP013-PARAGRAPH 55930001
                                                                        55940001
           EXEC SQL                                                     55950001
               CLOSE STORE_CURSOR                                       55960001
           END-EXEC.                                                    55970001
                                                                        55980001
           EVALUATE TRUE                                                55990001
               WHEN SQLCODE = ZERO                                      56000001
                   CONTINUE                                             56010001
               WHEN OTHER                                               56020001
                   MOVE PE-ERR-MSG-2 TO DP013-MESSAGE-TEXT(1)           56030001
                   PERFORM 9900-DB2-ERROR                               56040001
           END-EVALUATE.                                                56050001
                                                                        56060001
           EJECT                                                        56070001
                                                                        56080001
      ******************************************************************56090001
      *  GIVEN THE DEPT, CLASS, SKU IN THE COMMAREA FROM FSKCS032,      56100001
      *  FILL THE CURSOR FOR THE SKU AND TRY TO FIND A 'NEXT' SKU.      56110001
      *  TWO CURSORS ARE USED HERE. THE FIRST SKU CURSOR WILL ATTEMPT TO56120001
      *  FIND A SKU WITH THE SAME DEPARTMENT AND CLASS AND GREATER THAN 56130001
      *  THE CURRENT SKU NUMBER. IF THIS FAILS, THE PROGRAM WILL THEN   56140001
      *  TRY TO FIND A SKU WITH THE SAME DEPARTMENT, A GREATER CLASS,   56150001
      *  AND A SKU NUMBER LARGER THAN ZERO.                             56160001
      ******************************************************************56170001
                                                                        56180001
       F033-2000-NEXT-SKU.                                              56190001
                                                                        56200001
           SET PS-NO-SKUS-FOUND TO TRUE                                 56210001
                                                                        56220011
MK         MOVE CA-DEPT-NUMBER-9 TO NI-DEPT-9-4.                        56230011
MK         MOVE CA-CLASS-NUMBER-9 TO NI-SUB-CLASS-9-4.                  56240011
MK         MOVE CA-SKU-NUMBER-9 TO NI-SKU-9-8.                          56250011
                                                                        56260001
           PERFORM F033-2200-OPEN-SKU-CURSOR.                           56270011
           PERFORM F033-2300-FETCH-NEXT-SKU.                            56280011
           PERFORM F033-2400-CLOSE-SKU-CURSOR.                          56290001
                                                                        56300001
           IF PS-SKUS-FOUND                                             56310001
MK             MOVE SKXREF-DEPT TO CA-DEPT-NUMBER-9                     56320012
MK             MOVE SKXREF-SUBCLASS TO CA-CLASS-NUMBER-9                56330012
MK             MOVE SKXREF-SKU TO CA-SKU-NUMBER-9                       56340012
               MOVE TSK-STATUS-CODE TO CA-STATUS                        56350001
               MOVE TSK-SKU-DESC TO CA-SKU-DESCRIPTION                  56360001
      *MED                                                              56370001
               IF PS-SIZE-DESC-FOUND                                    56380001
                  MOVE SIZE-KOHLS-DESC       TO CA-TSK-SIZE             56390001
               ELSE                                                     56400001
                  IF TSK-LONG-SIZE-DESC = SPACES                        56410001
                     MOVE TSK-SIZE-DESC      TO CA-TSK-SIZE             56420001
                  ELSE                                                  56430001
                     MOVE TSK-LONG-SIZE-DESC TO CA-TSK-SIZE             56440001
                  END-IF                                                56450001
               END-IF                                                   56460001
      *MED                                                              56470001
               IF TSK-LONG-COLOR-DESC = SPACES                          56480001
                  MOVE TSK-COLOR-DESC       TO CA-TSK-COLOR             56490001
               ELSE                                                     56500001
                  MOVE TSK-LONG-COLOR-DESC  TO CA-TSK-COLOR             56510001
               END-IF                                                   56520001
      *MED                                                              56530001
               MOVE TSK-ORIG-UNIT-RTL-AMT TO CA-TSK-ORG-RTL             56540001
                                                                        56550001
               MOVE TSK-CUR-UNIT-RTL-AMT TO CA-TSK-CUR-RTL              56560001
                                                                        56570001
               MOVE TSK-UNIT-COST-AMT TO CA-TSK-COST                    56580001
               IF TSK-GP-QTY > 1                                        56590001
                   MOVE TSK-GP-RTL-AMT TO CA-TSK-GP-RTL                 56600001
                   MOVE PC-SLASH TO CA-TSK-GP-SLASH                     56610001
                   MOVE TSK-GP-QTY TO CA-TSK-GP-QTY                     56620001
               ELSE                                                     56630001
                   MOVE SPACES TO CA-TSK-GP-QTY-RTL                     56640001
               END-IF                                                   56650001
           ELSE                                                         56660001
               MOVE CA-CLASS-NUMBER-X TO PV-CURRENT-CLASS               56670001
               IF (CA-DEPT-NUMBER-X EQUAL PC-MAX-DEPT                   56680001
                                AND                                     56690001
                   PV-CURRENT-CLASS-9 EQUAL PC-MAX-CLASS)               56700001
                   CONTINUE                                             56710001
               ELSE                                                     56720001
                   PERFORM F033-2500-FILL-COMPLEX-CURSOR                56730001
                   PERFORM F033-2600-OPEN-SKU-CURSOR                    56740001
                   PERFORM F033-2700-FETCH-NEXT-SKU                     56750001
                   PERFORM F033-2800-CLOSE-SKU-CURSOR                   56760001
                   IF PS-SKUS-FOUND                                     56770001
MK                     MOVE SKXREF-DEPT TO CA-DEPT-NUMBER-9             56780014
MK                     MOVE SKXREF-SUBCLASS TO CA-CLASS-NUMBER-9        56790014
MK                     MOVE SKXREF-SKU TO CA-SKU-NUMBER-9               56800014
                       MOVE TSK-SKU-DESC TO CA-SKU-DESCRIPTION          56810001
                       MOVE TSK-STATUS-CODE TO CA-STATUS                56820001
      *MED                                                              56830001
                       IF PS-SIZE-DESC-FOUND                            56840001
                          MOVE SIZE-KOHLS-DESC       TO CA-TSK-SIZE     56850001
                       ELSE                                             56860001
                          IF TSK-LONG-SIZE-DESC = SPACES                56870001
                             MOVE TSK-SIZE-DESC      TO CA-TSK-SIZE     56880001
                          ELSE                                          56890001
                             MOVE TSK-LONG-SIZE-DESC TO CA-TSK-SIZE     56900001
                          END-IF                                        56910001
                       END-IF                                           56920001
      *MED                                                              56930001
                       IF TSK-LONG-COLOR-DESC = SPACES                  56940001
                          MOVE TSK-COLOR-DESC       TO CA-TSK-COLOR     56950001
                       ELSE                                             56960001
                          MOVE TSK-LONG-COLOR-DESC  TO CA-TSK-COLOR     56970001
                       END-IF                                           56980001
      *MED                                                              56990001
                       MOVE TSK-ORIG-UNIT-RTL-AMT TO CA-TSK-ORG-RTL     57000001
                       MOVE TSK-CUR-UNIT-RTL-AMT TO CA-TSK-CUR-RTL      57010001
                       MOVE TSK-UNIT-COST-AMT TO CA-TSK-COST            57020001
                       IF TSK-GP-QTY > 1                                57030001
                           MOVE TSK-GP-RTL-AMT TO CA-TSK-GP-RTL         57040001
                           MOVE PC-SLASH TO CA-TSK-GP-SLASH             57050001
                           MOVE TSK-GP-QTY TO CA-TSK-GP-QTY             57060001
                       ELSE                                             57070001
                           MOVE SPACES TO CA-TSK-GP-QTY-RTL             57080001
                       END-IF                                           57090001
                       PERFORM F033-5000-GET-DEPT-CLASS-NAME            57100001
                   END-IF                                               57110001
               END-IF                                                   57120001
           END-IF.                                                      57130001
                                                                        57140001
           IF PS-NO-SKUS-FOUND                                          57150001
               SET PS-EDIT-ERROR TO TRUE                                57160001
           END-IF.                                                      57170001
                                                                        57180001
      ******************************************************************57190001
      * OPEN SKU CURSOR                                                 57200001
      ******************************************************************57210001
                                                                        57220001
       F033-2200-OPEN-SKU-CURSOR.                                       57230001
           MOVE '*F033-2200-OPEN-SKU-CURSOR.      *' TO DP013-PARAGRAPH 57240001
                                                                        57250001
           EXEC SQL                                                     57260001
               OPEN NEXT_SKU_CURS                                       57270001
           END-EXEC.                                                    57280001
                                                                        57290001
           EVALUATE TRUE                                                57300001
               WHEN SQLCODE = ZERO                                      57310001
                   CONTINUE                                             57320001
               WHEN OTHER                                               57330001
                   MOVE PE-ERR-MSG-4 TO DP013-MESSAGE-TEXT(1)           57340001
                   PERFORM 9900-DB2-ERROR                               57350001
           END-EVALUATE.                                                57360001
                                                                        57370001
           EJECT                                                        57380001
                                                                        57390001
      ******************************************************************57400001
      * SQL FOR RETRIEVING SKU FROM ESTABLISHED SKU CURSOR              57410001
      ******************************************************************57420001
                                                                        57430001
       F033-2300-FETCH-NEXT-SKU.                                        57440001
           MOVE '*F033-2300-FETCH-NEXT-SKU.       *' TO DP013-PARAGRAPH 57450001
                                                                        57460001
           INITIALIZE PV-RETRY-COUNT.                                   57470001
           PERFORM WITH TEST AFTER                                      57480001
                   UNTIL ((SQLCODE = ZERO)                              57490001
                                 OR                                     57500001
                          (SQLCODE = +100)                              57510001
                                 OR                                     57520001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    57530001
               EXEC SQL                                                 57540001
                   FETCH NEXT_SKU_CURS                                  57550001
                   INTO                                                 57560001
                       :SKXREF-DEPT,                                    57570011
                       :SKXREF-SUBCLASS,                                57580011
                       :SKXREF-SKU,                                     57590011
                       :TSK-STATUS-CODE,                                57600011
                       :TSK-UNIT-COST-AMT,                              57610011
                       :TSK-CUR-UNIT-RTL-AMT,                           57620001
                       :TSK-ORIG-UNIT-RTL-AMT,                          57630001
                       :TSK-SKU-DESC,                                   57640001
                       :TSK-SIZE-DESC,                                  57650001
                       :TSK-COLOR-DESC,                                 57660001
                       :TSK-GP-RTL-AMT,                                 57670001
                       :TSK-GP-QTY,                                     57680001
                       :TSK-LONG-SIZE-DESC,                             57690001
                       :TSK-LONG-COLOR-DESC,                            57700001
                       :TSK-SIZE-CDE,                                   57710001
                       :TSK-REGN-PRIC-IND                               57720001
               END-EXEC                                                 57730001
               EVALUATE TRUE                                            57740001
                   WHEN SQLCODE = -911                                  57750001
                   WHEN SQLCODE = -913                                  57760001
                       ADD +1 TO PV-RETRY-COUNT                         57770001
                   WHEN SQLCODE = ZERO                                  57780001
                       CONTINUE                                         57790001
                   WHEN SQLCODE = +100                                  57800001
                       SET PS-NO-SKUS-FOUND TO TRUE                     57810001
                   WHEN SQLCODE < ZERO                                  57820001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     57830001
                   WHEN SQLWARN0 NOT = SPACES                           57840001
                       MOVE PE-ERR-MSG-5 TO DP013-MESSAGE-TEXT(1)       57850001
                       PERFORM 9900-DB2-ERROR                           57860001
               END-EVALUATE                                             57870001
           END-PERFORM.                                                 57880001
                                                                        57890001
           IF ((SQLCODE = -911)                                         57900001
                   OR                                                   57910001
               (SQLCODE = -913))                                        57920001
               PERFORM 9900-DB2-ERROR                                   57930001
           ELSE                                                         57940001
              IF SQLCODE = ZERO                                         57950001
                 SET PS-SKUS-FOUND TO TRUE                              57960001
                 MOVE TSK-SIZE-CDE  TO SIZE-NRF-SIZE-CDE                57970001
                 PERFORM F033-6000-GET-SIZE-DESC                        57980001
               END-IF                                                   57990001
           END-IF.                                                      58000001
                                                                        58010001
           EJECT                                                        58020001
                                                                        58030001
      ******************************************************************58040001
      * CLOSE SKU CURSOR                                                58050001
      ******************************************************************58060001
                                                                        58070001
       F033-2400-CLOSE-SKU-CURSOR.                                      58080001
           MOVE '*F033-2400-CLOSE-SKU-CURSOR.     *' TO DP013-PARAGRAPH 58090001
                                                                        58100001
           EXEC SQL                                                     58110001
               CLOSE NEXT_SKU_CURS                                      58120001
           END-EXEC.                                                    58130001
                                                                        58140001
           EVALUATE TRUE                                                58150001
               WHEN SQLCODE = ZERO                                      58160001
                   CONTINUE                                             58170001
               WHEN OTHER                                               58180001
                   MOVE PE-ERR-MSG-6 TO DP013-MESSAGE-TEXT(1)           58190001
                   PERFORM 9900-DB2-ERROR                               58200001
           END-EVALUATE.                                                58210001
                                                                        58220001
           EJECT                                                        58230001
                                                                        58240001
      ******************************************************************58250001
      * FILL THE FIELDS USED IN THE COMPLEX SKU CURSOR                  58260001
      ******************************************************************58270001
                                                                        58280001
       F033-2500-FILL-COMPLEX-CURSOR.                                   58290001
           MOVE '*F033-2500-FILL-COMPLEX-CURSOR.  *' TO DP013-PARAGRAPH 58300001
                                                                        58310001
MK         MOVE CA-DEPT-NUMBER-9 TO NI-DEPT-9-4.                        58320014
                                                                        58330014
MK         MOVE PC-MAX-CLASS TO PV-CLASS-HIGH-C3.                       58340014
           IF PV-CURRENT-CLASS-9 LESS THAN PC-MAX-CLASS                 58350001
               ADD 1 TO PV-CURRENT-CLASS-9                              58360001
           END-IF.                                                      58370001
MK         MOVE PV-CURRENT-CLASS-9 TO NI-CLASS-9-4.                     58380014
                                                                        58390014
MK         MOVE ZEROES TO PV-CURRENT-SKU-9.                             58400014
MK         MOVE PV-CURRENT-SKU-9 TO NI-SKU-9-8.                         58410014
                                                                        58420014
           EJECT                                                        58430001
                                                                        58440001
      ******************************************************************58450001
      * OPEN SKU CURSOR                                                 58460001
      ******************************************************************58470001
                                                                        58480001
       F033-2600-OPEN-SKU-CURSOR.                                       58490001
           MOVE '*F033-2600-OPEN-SKU-CURSOR.      *' TO DP013-PARAGRAPH 58500001
                                                                        58510001
           EXEC SQL                                                     58520001
               OPEN SKU_CMPLX_CURS                                      58530001
           END-EXEC.                                                    58540001
                                                                        58550001
           EVALUATE TRUE                                                58560001
               WHEN SQLCODE = ZERO                                      58570001
                   CONTINUE                                             58580001
               WHEN OTHER                                               58590001
                   MOVE PE-ERR-MSG-13 TO DP013-MESSAGE-TEXT(1)          58600001
                   PERFORM 9900-DB2-ERROR                               58610001
           END-EVALUATE.                                                58620001
                                                                        58630001
           EJECT                                                        58640001
                                                                        58650001
      ******************************************************************58660001
      * SQL FOR RETRIEVING SKU FROM ESTABLISHED SKU CURSOR              58670001
      ******************************************************************58680001
                                                                        58690001
       F033-2700-FETCH-NEXT-SKU.                                        58700001
           MOVE '*F033-2700-FETCH-NEXT-SKU.       *' TO DP013-PARAGRAPH 58710001
                                                                        58720001
           INITIALIZE PV-RETRY-COUNT.                                   58730001
           PERFORM WITH TEST AFTER                                      58740001
                   UNTIL ((SQLCODE = ZERO)                              58750001
                                 OR                                     58760001
                          (SQLCODE = +100)                              58770001
                                 OR                                     58780001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    58790001
               EXEC SQL                                                 58800001
                   FETCH SKU_CMPLX_CURS                                 58810001
                   INTO                                                 58820001
                       :SKXREF-DEPT,                                    58830014
                       :SKXREF-SUBCLASS,                                58840014
                       :SKXREF-SKU,                                     58850014
                       :TSK-UNIT-COST-AMT,                              58860001
                       :TSK-CUR-UNIT-RTL-AMT,                           58870001
                       :TSK-ORIG-UNIT-RTL-AMT,                          58880001
                       :TSK-SKU-DESC,                                   58890001
                       :TSK-SIZE-DESC,                                  58900001
                       :TSK-COLOR-DESC,                                 58910001
                       :TSK-GP-RTL-AMT,                                 58920001
                       :TSK-GP-QTY,                                     58930001
                       :TSK-LONG-SIZE-DESC,                             58940001
                       :TSK-LONG-COLOR-DESC,                            58950001
                       :TSK-SIZE-CDE,                                   58960001
                       :TSK-REGN-PRIC-IND,                              58970057
                       :TSK-STATUS-CODE                                 58980057
               END-EXEC                                                 58990001
               EVALUATE TRUE                                            59000001
                   WHEN SQLCODE = -911                                  59010001
                   WHEN SQLCODE = -913                                  59020001
                       ADD +1 TO PV-RETRY-COUNT                         59030001
                   WHEN SQLCODE = ZERO                                  59040001
                       SET PS-SKUS-FOUND    TO TRUE                     59050001
                   WHEN SQLCODE = +100                                  59060001
                       SET PS-NO-SKUS-FOUND TO TRUE                     59070001
                   WHEN SQLCODE < ZERO                                  59080001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     59090001
                   WHEN SQLWARN0 NOT = SPACES                           59100001
                       MOVE PE-ERR-MSG-14 TO DP013-MESSAGE-TEXT(1)      59110001
                       PERFORM 9900-DB2-ERROR                           59120001
               END-EVALUATE                                             59130001
           END-PERFORM.                                                 59140001
                                                                        59150001
           IF ((SQLCODE = -911)                                         59160001
                   OR                                                   59170001
               (SQLCODE = -913))                                        59180001
               PERFORM 9900-DB2-ERROR                                   59190001
           END-IF.                                                      59200001
                                                                        59210001
           EJECT                                                        59220001
                                                                        59230001
      ******************************************************************59240001
      * CLOSE SKU CURSOR                                                59250001
      ******************************************************************59260001
                                                                        59270001
       F033-2800-CLOSE-SKU-CURSOR.                                      59280001
           MOVE '*F033-2800-CLOSE-SKU-CURSOR.     *' TO DP013-PARAGRAPH 59290001
                                                                        59300001
           EXEC SQL                                                     59310001
               CLOSE SKU_CMPLX_CURS                                     59320001
           END-EXEC.                                                    59330001
                                                                        59340001
           EVALUATE TRUE                                                59350001
               WHEN SQLCODE = ZERO                                      59360001
                   CONTINUE                                             59370001
               WHEN OTHER                                               59380001
                   MOVE PE-ERR-MSG-15 TO DP013-MESSAGE-TEXT(1)          59390001
                   PERFORM 9900-DB2-ERROR                               59400001
           END-EVALUATE.                                                59410001
                                                                        59420001
           EJECT                                                        59430001
                                                                        59440001
      ******************************************************************59450001
      *  GIVEN THE DEPT (AND POSSIBLY CLASS) IN COMMAREA FROM FSKCS032, 59460001
      *  FILL THE CURSOR FOR THE DEPARTMENT/CLASS TO FIND 'NEXT' DEPT.  59470001
      *  CLASS (IF PRESENT) WILL NOT CHANGE.                            59480001
MK    *  CHANGES MADE FOR NEW SKU - USING TSKXREF NOT TSK.              59490015
      ******************************************************************59500001
                                                                        59510001
       F033-3000-NEXT-DEPARTMENT.                                       59520001
                                                                        59530001
           SET PS-NO-DEPT-FOUND TO TRUE.                                59540001
                                                                        59550001
MK         MOVE CA-DEPT-NUMBER-9 TO NI-DEPT-9-4.                        59560016
                                                                        59570016
           IF CA-CLASS-NUMBER-X EQUAL SPACES                            59580015
MK             MOVE PC-MIN-CLASS TO PV-CLASS-LOW-C3                     59590016
MK             MOVE PC-MAX-CLASS TO PV-CLASS-HIGH-C3                    59600016
           ELSE                                                         59610001
               MOVE CA-CLASS-NUMBER-X TO PV-CLASS-LOW                   59620022
                                PV-CLASS-HIGH                           59630022
               IF CA-MINOR-CLASS EQUAL SPACES                           59640016
                   MOVE PC-LITERAL-0 TO PV-CLASS-LOW-POS-2              59650016
                   MOVE PC-LITERAL-9 TO PV-CLASS-HIGH-POS-2             59660016
               END-IF                                                   59670016
MK             MOVE PV-CLASS-LOW  TO PV-CLASS-LOW-C3                    59680022
MK             MOVE PV-CLASS-HIGH TO PV-CLASS-HIGH-C3                   59690022
           END-IF.                                                      59700001
                                                                        59710001
           PERFORM F033-3200-OPEN-DEPT-CURSOR.                          59720001
           PERFORM F033-3300-FETCH-NEXT-DEPT.                           59730001
           PERFORM F033-3400-CLOSE-DEPT-CURSOR.                         59740001
                                                                        59750001
           IF PS-DEPT-FOUND                                             59760001
               MOVE SKXREF-DEPT TO CA-DEPT-NUMBER-9                     59770016
               PERFORM F033-5000-GET-DEPT-CLASS-NAME                    59780001
           ELSE                                                         59790001
               SET PS-EDIT-ERROR TO TRUE                                59800001
           END-IF.                                                      59810001
                                                                        59820001
      ******************************************************************59830001
      * OPEN DEPARTMENT CURSOR                                          59840001
      ******************************************************************59850001
                                                                        59860001
       F033-3200-OPEN-DEPT-CURSOR.                                      59870001
           MOVE '*F033-3200-OPEN-DEPT-CURSOR.     *' TO DP013-PARAGRAPH 59880001
                                                                        59890001
           EXEC SQL                                                     59900001
               OPEN NEXT_DEPT_CURS                                      59910001
           END-EXEC.                                                    59920001
                                                                        59930001
           EVALUATE TRUE                                                59940001
               WHEN SQLCODE = ZERO                                      59950001
                   CONTINUE                                             59960001
               WHEN OTHER                                               59970001
                   MOVE PE-ERR-MSG-7 TO DP013-MESSAGE-TEXT(1)           59980001
                   PERFORM 9900-DB2-ERROR                               59990001
           END-EVALUATE.                                                60000001
                                                                        60010001
           EJECT                                                        60020001
                                                                        60030001
      ******************************************************************60040001
      * SQL FOR RETRIEVING DEPARTMENT FROM ESTABLISHED CURSOR           60050001
      ******************************************************************60060001
                                                                        60070001
       F033-3300-FETCH-NEXT-DEPT.                                       60080001
           MOVE '*F033-3300-FETCH-NEXT-DEPT.      *' TO DP013-PARAGRAPH 60090001
                                                                        60100001
           INITIALIZE PV-RETRY-COUNT.                                   60110001
           PERFORM WITH TEST AFTER                                      60120001
                   UNTIL ((SQLCODE = ZERO)                              60130001
                                 OR                                     60140001
                          (SQLCODE = +100)                              60150001
                                 OR                                     60160001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    60170001
               EXEC SQL                                                 60180001
                   FETCH NEXT_DEPT_CURS                                 60190001
                   INTO :SKXREF-DEPT                                    60200016
               END-EXEC                                                 60210001
               EVALUATE TRUE                                            60220001
                   WHEN SQLCODE = -911                                  60230001
                   WHEN SQLCODE = -913                                  60240001
                       ADD +1 TO PV-RETRY-COUNT                         60250001
                   WHEN SQLCODE = ZERO                                  60260001
                       SET PS-DEPT-FOUND TO TRUE                        60270001
                   WHEN SQLCODE = +100                                  60280001
                       SET PS-NO-DEPT-FOUND TO TRUE                     60290001
                   WHEN SQLCODE < ZERO                                  60300001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     60310001
                   WHEN SQLWARN0 NOT = SPACES                           60320001
                       MOVE PE-ERR-MSG-8 TO DP013-MESSAGE-TEXT(1)       60330001
                       PERFORM 9900-DB2-ERROR                           60340001
               END-EVALUATE                                             60350001
           END-PERFORM.                                                 60360001
                                                                        60370001
           IF ((SQLCODE = -911)                                         60380001
                   OR                                                   60390001
               (SQLCODE = -913))                                        60400001
               PERFORM 9900-DB2-ERROR                                   60410001
           END-IF.                                                      60420001
                                                                        60430001
           EJECT                                                        60440001
                                                                        60450001
      ******************************************************************60460001
      * CLOSE DEPARTMENT CURSOR                                         60470001
      ******************************************************************60480001
                                                                        60490001
       F033-3400-CLOSE-DEPT-CURSOR.                                     60500001
           MOVE '*F033-3400-CLOSE-DEPT-CURSOR.    *' TO DP013-PARAGRAPH 60510001
                                                                        60520001
           EXEC SQL                                                     60530001
               CLOSE NEXT_DEPT_CURS                                     60540001
           END-EXEC.                                                    60550001
                                                                        60560001
           EVALUATE TRUE                                                60570001
               WHEN SQLCODE = ZERO                                      60580001
                   CONTINUE                                             60590001
               WHEN OTHER                                               60600001
                   MOVE PE-ERR-MSG-9 TO DP013-MESSAGE-TEXT(1)           60610001
                   PERFORM 9900-DB2-ERROR                               60620001
           END-EVALUATE.                                                60630001
                                                                        60640001
           EJECT                                                        60650001
                                                                        60660001
      ******************************************************************60670001
      *  GIVEN THE CLASS PASSED IN THE COMMAREA FROM FSKCS032,          60680001
      *  FILL THE CURSOR FOR THE CLASS TO FIND 'NEXT' CLASS.            60690001
MK    *  CHANGES MADE FOR NEW SKU - USING TSKXREF NOT TSK.              60700016
      ******************************************************************60710001
                                                                        60720001
       F033-4000-NEXT-CLASS.                                            60730001
                                                                        60740001
           SET PS-NO-CLASS-FOUND TO TRUE.                               60750001
                                                                        60760001
           IF CA-CLASS-NUMBER-X EQUAL SPACES                            60770001
               MOVE PC-LOW-MINOR-CLASS TO PV-CLASS                      60780001
           ELSE                                                         60790001
               MOVE CA-CLASS-NUMBER-X TO PV-CLASS                       60800001
                                PV-CLASS-HIGH                           60810001
               IF CA-MINOR-CLASS EQUAL SPACES                           60820001
                   MOVE PC-LITERAL-9 TO PV-CLASS-HIGH-POS-2             60830001
                   MOVE PV-CLASS-HIGH TO PV-CLASS                       60840001
               END-IF                                                   60850001
           END-IF.                                                      60860001
                                                                        60870001
MK         MOVE CA-DEPT-NUMBER-9 TO NI-DEPT-9-4.                        60880022
MK         MOVE PV-CLASS TO NI-CLASS-9-4.                               60890022
                                                                        60900016
           PERFORM F033-4200-OPEN-CLASS-CURSOR.                         60910001
           PERFORM F033-4300-FETCH-NEXT-CLASS.                          60920001
           PERFORM F033-4400-CLOSE-CLASS-CURSOR.                        60930001
                                                                        60940001
           IF PS-CLASS-FOUND                                            60950001
               IF CA-MINOR-CLASS EQUAL SPACES                           60960001
MK                 MOVE SKXREF-SUBCLASS TO CA-CLASS-NUMBER-9            60970016
                   MOVE SPACE TO CA-MINOR-CLASS                         60980001
               ELSE                                                     60990001
MK                 MOVE SKXREF-SUBCLASS TO CA-CLASS-NUMBER-9            61000016
               END-IF                                                   61010016
               PERFORM F033-5000-GET-DEPT-CLASS-NAME                    61020001
           ELSE                                                         61030001
               SET PS-EDIT-ERROR TO TRUE                                61040001
           END-IF.                                                      61050001
                                                                        61060001
      ******************************************************************61070001
      * OPEN CLASS CURSOR                                               61080001
      ******************************************************************61090001
                                                                        61100001
       F033-4200-OPEN-CLASS-CURSOR.                                     61110001
           MOVE '*F033-4200-OPEN-CLASS-CURSOR.    *' TO DP013-PARAGRAPH 61120001
                                                                        61130001
           EXEC SQL                                                     61140001
               OPEN NEXT_CLASS_CURS                                     61150001
           END-EXEC.                                                    61160001
                                                                        61170001
           EVALUATE TRUE                                                61180001
               WHEN SQLCODE = ZERO                                      61190001
                   CONTINUE                                             61200001
               WHEN OTHER                                               61210001
                   MOVE PE-ERR-MSG-10 TO DP013-MESSAGE-TEXT(1)          61220001
                   PERFORM 9900-DB2-ERROR                               61230001
           END-EVALUATE.                                                61240001
                                                                        61250001
           EJECT                                                        61260001
                                                                        61270001
      ******************************************************************61280001
      * SQL FOR RETRIEVING CLASS FROM ESTABLISHED CURSOR                61290001
      ******************************************************************61300001
                                                                        61310001
       F033-4300-FETCH-NEXT-CLASS.                                      61320001
           MOVE '*F033-4300-FETCH-NEXT-CLASS.     *' TO DP013-PARAGRAPH 61330001
                                                                        61340001
           INITIALIZE PV-RETRY-COUNT.                                   61350001
           PERFORM WITH TEST AFTER                                      61360001
                   UNTIL ((SQLCODE = ZERO)                              61370001
                                 OR                                     61380001
                          (SQLCODE = +100)                              61390001
                                 OR                                     61400001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    61410001
               EXEC SQL                                                 61420001
                   FETCH NEXT_CLASS_CURS                                61430001
                   INTO :SKXREF-SUBCLASS                                61440016
               END-EXEC                                                 61450001
               EVALUATE TRUE                                            61460001
                   WHEN SQLCODE = -911                                  61470001
                   WHEN SQLCODE = -913                                  61480001
                       ADD +1 TO PV-RETRY-COUNT                         61490001
                   WHEN SQLCODE = ZERO                                  61500001
                       SET PS-CLASS-FOUND TO TRUE                       61510001
                   WHEN SQLCODE = +100                                  61520001
                       SET PS-NO-CLASS-FOUND TO TRUE                    61530001
                   WHEN SQLCODE < ZERO                                  61540001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     61550001
                   WHEN SQLWARN0 NOT = SPACES                           61560001
                       MOVE PE-ERR-MSG-11 TO DP013-MESSAGE-TEXT(1)      61570001
                       PERFORM 9900-DB2-ERROR                           61580001
               END-EVALUATE                                             61590001
           END-PERFORM.                                                 61600001
                                                                        61610001
           IF ((SQLCODE = -911)                                         61620001
                   OR                                                   61630001
               (SQLCODE = -913))                                        61640001
               PERFORM 9900-DB2-ERROR                                   61650001
           END-IF.                                                      61660001
                                                                        61670001
           EJECT                                                        61680001
                                                                        61690001
      ******************************************************************61700001
      * CLOSE CLASS CURSOR                                              61710001
      ******************************************************************61720001
                                                                        61730001
       F033-4400-CLOSE-CLASS-CURSOR.                                    61740001
           MOVE '*F033-4400-CLOSE-CLASS-CURSOR.   *' TO DP013-PARAGRAPH 61750001
                                                                        61760001
           EXEC SQL                                                     61770001
               CLOSE NEXT_CLASS_CURS                                    61780001
           END-EXEC.                                                    61790001
                                                                        61800001
           EVALUATE TRUE                                                61810001
               WHEN SQLCODE = ZERO                                      61820001
                   CONTINUE                                             61830001
               WHEN OTHER                                               61840001
                   MOVE PE-ERR-MSG-12 TO DP013-MESSAGE-TEXT(1)          61850001
                   PERFORM 9900-DB2-ERROR                               61860001
           END-EVALUATE.                                                61870001
                                                                        61880001
           EJECT                                                        61890001
                                                                        61900001
      ******************************************************************61910001
      *    READ THE DEPARTMENT/CLASS TABLE TO GET THE DEPARTMENT AND   *61920001
      *    CLASS NAMES.                                                *61930001
      ******************************************************************61940001
                                                                        61950001
       F033-5000-GET-DEPT-CLASS-NAME.                                   61960001
           PERFORM F033-5100-READ-DEPT.                                 61970001
           IF DB-ERROR-NO                                               61980001
               MOVE MDSEAR-DESC TO CA-DEPT-NAME                         61990001
           END-IF.                                                      62000001
           MOVE CA-MAJOR-CLASS TO PV-MAJOR-CLASS-1.                     62010001
           MOVE ZEROES TO PV-MAJOR-CLASS-2.                             62020001
           MOVE ZEROES TO PV-MINOR-CLASS-1.                             62030001
           MOVE CA-MAJOR-CLASS TO PV-MINOR-CLASS-2.                     62040001
           MOVE CA-MINOR-CLASS TO PV-MINOR-CLASS-3.                     62050001
           PERFORM F033-5120-READ-MINOR-CLASS.                          62060001
           IF DB-ERROR-NO                                               62070001
               MOVE MDSEAR-DESC TO CA-CLASS-DESCRIPTION                 62080001
           END-IF.                                                      62090001
           IF CA-MAJOR-CLASS NOT EQUAL SPACES                           62100001
                              AND                                       62110001
               (CA-MINOR-CLASS = PC-LITERAL-0 OR SPACE)                 62120001
                   PERFORM F033-5110-READ-MAJOR-CLASS                   62130001
                   IF DB-ERROR-NO                                       62140001
                       MOVE MDSEAR-DESC TO CA-CLASS-DESCRIPTION         62150001
                   END-IF                                               62160001
           END-IF.                                                      62170001
                                                                        62180001
      ******************************************************************62190001
      *  READ THE MERCHANDISE AREA TABLE (TMDSEAR) TO OBTAIN THE        62200001
      *  DEPARTMENT NAME.                                               62210001
      ******************************************************************62220001
                                                                        62230001
       F033-5100-READ-DEPT.                                             62240001
           MOVE '*F033-5100-READ-DEPT.            *' TO DP013-PARAGRAPH 62250001
           INITIALIZE PV-RETRY-COUNT.                                   62260001
           PERFORM WITH TEST AFTER                                      62270001
                   UNTIL ((SQLCODE = ZERO)                              62280001
                                 OR                                     62290001
                          (SQLCODE = +100)                              62300001
                                 OR                                     62310001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    62320001
               EXEC SQL                                                 62330001
                   SELECT MDSEAR_DESC                                   62340001
                       INTO :MDSEAR-DESC                                62350001
                       FROM TMDSEAR                                     62360001
                       WHERE OPERCO_NBR = :PC-KOHLS-OPERATING-COMPANY   62370001
                         AND DEPT_NBR = :CA-DEPT-NUMBER-X               62380001
                         AND MDSELV_CDE = 'DPT'                         62390001
                         AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  62400001
               END-EXEC                                                 62410001
               EVALUATE TRUE                                            62420001
                   WHEN SQLCODE = -911                                  62430001
                   WHEN SQLCODE = -913                                  62440001
                       ADD +1              TO PV-RETRY-COUNT            62450001
                   WHEN SQLCODE = ZERO                                  62460001
                   WHEN SQLCODE = +100                                  62470001
                       CONTINUE                                         62480001
                   WHEN SQLCODE < ZERO                                  62490001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     62500001
                   WHEN SQLWARN0 NOT = SPACES                           62510001
                       MOVE 'SELECT A DEPT FROM THE TMDSEAR TABLE'      62520001
                                           TO DP013-MESSAGE-TEXT(1)     62530001
                       PERFORM 9900-DB2-ERROR                           62540001
               END-EVALUATE                                             62550001
           END-PERFORM.                                                 62560001
                                                                        62570001
           IF  ((SQLCODE = -911)                                        62580001
                     OR                                                 62590001
               (SQLCODE = -913))                                        62600001
                   MOVE 'SELECT A DEPT FROM THE TMDSEAR TABLE'          62610001
                                          TO DP013-MESSAGE-TEXT(1)      62620001
                   PERFORM 9900-DB2-ERROR                               62630001
               PERFORM 9900-DB2-ERROR                                   62640001
           END-IF.                                                      62650001
                                                                        62660001
           IF  SQLCODE = 0                                              62670001
               SET DB-ERROR-NO TO TRUE                                  62680001
           ELSE                                                         62690001
               IF  SQLCODE = +100                                       62700001
                   SET DB-ERROR TO TRUE                                 62710001
               END-IF                                                   62720001
           END-IF.                                                      62730001
                                                                        62740001
      ******************************************************************62750001
      *  READ THE MERCHANDISE AREA TABLE (TMDSEAR) TO OBTAIN THE        62760001
      *  MAJOR CLASS NAME.                                              62770001
      ******************************************************************62780001
                                                                        62790001
       F033-5110-READ-MAJOR-CLASS.                                      62800001
           MOVE '*F033-5110-READ-MAJOR-CLASS      *' TO DP013-PARAGRAPH 62810001
           INITIALIZE PV-RETRY-COUNT.                                   62820001
           PERFORM WITH TEST AFTER                                      62830001
                   UNTIL ((SQLCODE = ZERO)                              62840001
                                 OR                                     62850001
                          (SQLCODE = +100)                              62860001
                                 OR                                     62870001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    62880001
               EXEC SQL                                                 62890001
                   SELECT MDSEAR_DESC                                   62900001
                       INTO :MDSEAR-DESC                                62910001
                       FROM TMDSEAR                                     62920001
                       WHERE OPERCO_NBR = :PC-KOHLS-OPERATING-COMPANY   62930001
                         AND DEPT_NBR = :CA-DEPT-NUMBER-X               62940001
                         AND MAJ_CL_NBR = :PV-MAJOR-CLASS-X             62950001
                         AND MDSELV_CDE = 'MCL'                         62960001
                         AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  62970001
               END-EXEC                                                 62980001
               EVALUATE TRUE                                            62990001
                   WHEN SQLCODE = -911                                  63000001
                   WHEN SQLCODE = -913                                  63010001
                       ADD +1              TO PV-RETRY-COUNT            63020001
                   WHEN SQLCODE = ZERO                                  63030001
                   WHEN SQLCODE = +100                                  63040001
                       CONTINUE                                         63050001
                   WHEN SQLCODE < ZERO                                  63060001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     63070001
                   WHEN SQLWARN0 NOT = SPACES                           63080001
                       MOVE 'SELECT A DEPT FROM THE TMDSEAR TABLE'      63090001
                                           TO DP013-MESSAGE-TEXT(1)     63100001
                       PERFORM 9900-DB2-ERROR                           63110001
               END-EVALUATE                                             63120001
           END-PERFORM.                                                 63130001
                                                                        63140001
           IF  ((SQLCODE = -911)                                        63150001
                     OR                                                 63160001
               (SQLCODE = -913))                                        63170001
                   MOVE 'SELECT A MAJ CLASS FORM THE TMDSEAR TABLE'     63180001
                                          TO DP013-MESSAGE-TEXT(1)      63190001
                   PERFORM 9900-DB2-ERROR                               63200001
               PERFORM 9900-DB2-ERROR                                   63210001
           END-IF.                                                      63220001
                                                                        63230001
           IF  SQLCODE = 0                                              63240001
               SET DB-ERROR-NO TO TRUE                                  63250001
           ELSE                                                         63260001
               IF  SQLCODE = +100                                       63270001
                   SET DB-ERROR TO TRUE                                 63280001
               END-IF                                                   63290001
           END-IF.                                                      63300001
                                                                        63310001
      ******************************************************************63320001
      *  READ THE MERCHANDISE AREA TABLE (TMDSEAR) TO OBTAIN THE        63330001
      *  MINOR CLASS NAME.                                              63340001
      ******************************************************************63350001
                                                                        63360001
       F033-5120-READ-MINOR-CLASS.                                      63370001
           MOVE '*F033-5120-READ-MINOR-CLASS      *' TO DP013-PARAGRAPH 63380001
           INITIALIZE PV-RETRY-COUNT.                                   63390001
           PERFORM WITH TEST AFTER                                      63400001
                   UNTIL ((SQLCODE = ZERO)                              63410001
                                 OR                                     63420001
                          (SQLCODE = +100)                              63430001
                                 OR                                     63440001
                          (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    63450001
               EXEC SQL                                                 63460001
                   SELECT MDSEAR_DESC                                   63470001
                       INTO :MDSEAR-DESC                                63480001
                       FROM TMDSEAR                                     63490001
                       WHERE OPERCO_NBR = :PC-KOHLS-OPERATING-COMPANY   63500001
                         AND DEPT_NBR = :CA-DEPT-NUMBER-X               63510001
                         AND SUB_CL_NBR = :PV-MINOR-CLASS-X             63520001
                         AND MDSELV_CDE = 'SCL'                         63530001
                         AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  63540001
               END-EXEC                                                 63550001
               EVALUATE TRUE                                            63560001
                   WHEN SQLCODE = -911                                  63570001
                   WHEN SQLCODE = -913                                  63580001
                       ADD +1              TO PV-RETRY-COUNT            63590001
                   WHEN SQLCODE = ZERO                                  63600001
                   WHEN SQLCODE = +100                                  63610001
                       CONTINUE                                         63620001
                   WHEN SQLCODE < ZERO                                  63630001
                   WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     63640001
                   WHEN SQLWARN0 NOT = SPACES                           63650001
                       MOVE 'SELECT A DEPT FROM THE TMDSEAR TABLE'      63660001
                                           TO DP013-MESSAGE-TEXT(1)     63670001
                       PERFORM 9900-DB2-ERROR                           63680001
               END-EVALUATE                                             63690001
           END-PERFORM.                                                 63700001
                                                                        63710001
           IF  ((SQLCODE = -911)                                        63720001
                     OR                                                 63730001
               (SQLCODE = -913))                                        63740001
                   MOVE 'SELECT A MAJ CLASS FORM THE TMDSEAR TABLE'     63750001
                                          TO DP013-MESSAGE-TEXT(1)      63760001
                   PERFORM 9900-DB2-ERROR                               63770001
               PERFORM 9900-DB2-ERROR                                   63780001
           END-IF.                                                      63790001
                                                                        63800001
           IF  SQLCODE = 0                                              63810001
               SET DB-ERROR-NO TO TRUE                                  63820001
           ELSE                                                         63830001
               IF  SQLCODE = +100                                       63840001
                   SET DB-ERROR TO TRUE                                 63850001
               END-IF                                                   63860001
           END-IF.                                                      63870001
                                                                        63880001
           EJECT                                                        63890001
      ******************************************************************63900001
      *  GET THE KOHL'S SIZE DESCRIPTION FOR A SPECIFIC SKU SIZE CODE. *63910001
      *  SELECT THE REQUIRED SIZE DESC INFORMATION FROM THE DB2 TSIZE  *63920001
      *  TABLE USING THE SKU TABLE (TSK) SIZE_CDE.                     *63930001
      *  IF A RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE     *63940001
      *  SELECT WILL BE RETRIED UP TO A SET NUMBER OF TIMES.  IF NO    *63950001
      *  DESCRIPTION IS FOUND FOR THE SKU SIZE CODE WHERE THE          *63960001
      *  EFF-END-DTE FIELD IS GREATER THAN THE CURRENT DATE, THE MOST  *63970001
      *  CURRENT EXPIRED DESCRIPTION WILL BE SELECTED (PARA 5114-)     *63980001
      ******************************************************************63990001
                                                                        64000001
       F033-6000-GET-SIZE-DESC.                                         64010001
           MOVE '*F033-6000-GET-SIZE-DESC.       *' TO DP013-PARAGRAPH. 64020001
                                                                        64030001
           INITIALIZE PV-RETRY-COUNT.                                   64040001
           PERFORM F033-6010-SELECT-SIZE-DESC                           64050001
               WITH TEST AFTER                                          64060001
               UNTIL ((SQLCODE = ZERO)                                  64070001
                   OR (SQLCODE = +100)                                  64080001
                   OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)).       64090001
                                                                        64100001
           EVALUATE TRUE                                                64110001
               WHEN SQLCODE = 0                                         64120001
                   SET PS-SIZE-DESC-FOUND TO TRUE                       64130001
               WHEN SQLCODE = +100                                      64140001
                   PERFORM F033-6020-GET-MOST-CURR-SIZE                 64150001
               WHEN SQLCODE = -911                                      64160001
               WHEN SQLCODE = -913                                      64170001
                   MOVE 'SELECT A DESC FROM THE SIZE TABLE (TSIZE)' TO  64180001
                             DP013-MESSAGE-TEXT(1)                      64190001
                   PERFORM 9900-DB2-ERROR                               64200001
               WHEN OTHER                                               64210001
                   SET PS-SIZE-DESC-NOT-FOUND TO TRUE                   64220001
           END-EVALUATE.                                                64230001
                                                                        64240001
      ******************************************************************64250001
      *  SELECT INFORMATION FROM THE SIZETABLE FOR THE CURRENT SKU.    *64260001
      *  IF THE RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE   *64270001
      *  SELECT WILL BE RETRIED.  IF ANY OTHER ERRORS ARE DETECTED,    *64280001
      *  AN ERROR MESSAGE WILL BE FORMATTED AND SENT TO THE SCREEN,    *64290001
      *  AND CONTROL WILL BE RETURNED TO NATIVE CICS.                  *64300001
      ******************************************************************64310001
                                                                        64320001
       F033-6010-SELECT-SIZE-DESC.                                      64330001
           MOVE '*F033-6010-SELECT-SIZE-DESC    *' TO DP013-PARAGRAPH   64340001
           EXEC SQL                                                     64350001
               SELECT KOHLS_DESC                                        64360001
                   INTO :SIZE-KOHLS-DESC                                64370001
                   FROM TSIZE                                           64380001
                   WHERE NRF_SIZE_CDE = :SIZE-NRF-SIZE-CDE AND          64390001
                         (EFF_END_DTE IS NULL               OR          64400001
                          EFF_END_DTE > CURRENT DATE)                   64410001
           END-EXEC.                                                    64420001
                                                                        64430001
           EVALUATE TRUE                                                64440001
               WHEN SQLCODE = 0                                         64450001
               WHEN SQLCODE = +100                                      64460001
                   CONTINUE                                             64470001
               WHEN SQLCODE = -911                                      64480001
               WHEN SQLCODE = -913                                      64490001
                   ADD 1 TO PV-RETRY-COUNT                              64500001
               WHEN SQLWARN0 NOT = SPACES                               64510001
               WHEN SQLCODE  NOT = ZERO                                 64520001
                   MOVE 'SELECT A SIZE DESC FORM SIZE TABLE (TSIZE)' TO 64530001
                            DP013-MESSAGE-TEXT(1)                       64540001
                   PERFORM 9900-DB2-ERROR                               64550001
           END-EVALUATE.                                                64560001
                                                                        64570001
      ******************************************************************64580001
      *  GET THE KOHL'S SIZE DESCRIPTION FOR A SPECIFIC SKU SIZE CODE. *64590001
      *  SELECT THE REQUIRED SIZE DESC INFORMATION FROM THE DB2 TSIZE  *64600001
      *  TABLE USING THE SKU TABLE (TSK) SIZE_CDE.  THE MOST CURRENT   *64610001
      *  EXPIRED DESCRIPTION WILL BE SELECTED AND DISPLAYED SINCE NO   *64620001
      *  VALID DESCRIPTION WAS FOUND IN PARAGRAPH 6000-.               *64630001
      *  IF A RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE     *64640001
      *  SELECT WILL BE RETRIED UP TO A SET NUMBER OF TIMES.  IF NO    *64650001
      *  DESCRIPTION IS FOUND FOR THE SKU SIZE CODE, THE SKU TABLE     *64660001
      *  SIZE DESCRIPTION WILL BE DISPLAYED.                           *64670001
      ******************************************************************64680001
                                                                        64690001
       F033-6020-GET-MOST-CURR-SIZE.                                    64700001
           MOVE '*F033-6020-GET-MOST-CURR-SIZE  *' TO DP013-PARAGRAPH.  64710001
                                                                        64720001
           INITIALIZE PV-RETRY-COUNT.                                   64730001
           PERFORM F033-6030-SELECT-OUTDATED-SIZE                       64740001
               WITH TEST AFTER                                          64750001
               UNTIL ((SQLCODE = ZERO)                                  64760001
                   OR (SQLCODE = +100)                                  64770001
                   OR (SQLCODE = -811)                                  64780001
                   OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)).       64790001
                                                                        64800001
           EVALUATE TRUE                                                64810001
               WHEN SQLCODE = +100                                      64820001
                   SET PS-SIZE-DESC-NOT-FOUND TO TRUE                   64830001
               WHEN SQLCODE = -911                                      64840001
               WHEN SQLCODE = -913                                      64850001
                   MOVE 'SELECT MOST CURR DESC FROM SIZE TBL (TSIZE)' TO64860001
                             DP013-MESSAGE-TEXT(1)                      64870001
                   PERFORM 9900-DB2-ERROR                               64880001
               WHEN OTHER                                               64890001
                   SET PS-SIZE-DESC-FOUND TO TRUE                       64900001
           END-EVALUATE.                                                64910001
                                                                        64920001
      ******************************************************************64930001
      *  SELECT INFORMATION FROM THE SIZETABLE FOR THE CURRENT SKU.    *64940001
      *  IF THE RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE   *64950001
      *  SELECT WILL BE RETRIED.  IF ANY OTHER ERRORS ARE DETECTED,    *64960001
      *  AN ERROR MESSAGE WILL BE FORMATTED AND SENT TO THE SCREEN,    *64970001
      *  AND CONTROL WILL BE RETURNED TO NATIVE CICS.                  *64980001
      ******************************************************************64990001
                                                                        65000001
       F033-6030-SELECT-OUTDATED-SIZE.                                  65010001
           MOVE '*F033-6030-SELECT-OUTDATED-SIZE. *' TO DP013-PARAGRAPH 65020001
           EXEC SQL                                                     65030001
               SELECT KOHLS_DESC                                        65040001
                   INTO :SIZE-KOHLS-DESC                                65050001
                   FROM TSIZE                                           65060001
                   WHERE NRF_SIZE_CDE = : SIZE-NRF-SIZE-CDE AND         65070001
                         EFF_END_DTE  =                                 65080001
                         ( SELECT MAX (EFF_END_DTE)                     65090001
                           FROM   TSIZE                                 65100001
                           WHERE  NRF_SIZE_CDE = :SIZE-NRF-SIZE-CDE)    65110001
           END-EXEC.                                                    65120001
                                                                        65130001
           EVALUATE TRUE                                                65140001
               WHEN SQLCODE = 0                                         65150001
               WHEN SQLCODE = +100                                      65160001
               WHEN SQLCODE = -811                                      65170001
                   CONTINUE                                             65180001
               WHEN SQLCODE = -911                                      65190001
               WHEN SQLCODE = -913                                      65200001
                   ADD 1 TO PV-RETRY-COUNT                              65210001
               WHEN SQLWARN0 NOT = SPACES                               65220001
               WHEN SQLCODE  NOT = ZERO                                 65230001
                   MOVE 'SELECT OUTDATED DESC FROM SIZE TABLE(TSIZE)' TO65240001
                            DP013-MESSAGE-TEXT(1)                       65250001
                   PERFORM 9900-DB2-ERROR                               65260001
           END-EVALUATE.                                                65270001
                                                                        65280001
      ******************************************************************65290001
      *  ROLL BACK ALL RESOURCES, FOLLOWING A DB2 ERROR.  FORMAT       *65300001
      *  INFORMATION RELATIVE TO THE ERROR.                            *65310001
      ******************************************************************65320001
       9900-DB2-ERROR.                                                  65330001
                                                                        65340001
           MOVE SQLCA                TO DP013-SQLCA                     65350001
                                                                        65360001
           SET DP013-NO-ROLLBACK                                        65370001
               DP013-XCTL-DISPLAY-RESTART                               65380001
               DP013-DB2-ABEND       TO TRUE                            65390001
                                                                        65400001
           PERFORM DP013-0000-PROCESS-ABEND.                            65410001
                                                                        65420001
      ******************************************************************65430001
      *  ROLL BACK ALL RESOURCES, FOLLOWING A DB2 ERROR.  FORMAT       *65440001
      *  INFORMATION RELATIVE TO THE ERROR.                            *65450001
      ******************************************************************65460001
       9920-CICS-ERROR.                                                 65470001
                                                                        65480001
           SET DP013-NO-ROLLBACK                                        65490001
               DP013-XCTL-DISPLAY-RESTART                               65500001
               DP013-CICS-ABEND      TO TRUE                            65510001
                                                                        65520001
           PERFORM DP013-0000-PROCESS-ABEND.                            65530001
                                                                        65540001
      *----------------------------------------------------------------*65550001
      *    ABEND PROCESSOR MODULE                                      *65560001
      *----------------------------------------------------------------*65570001
                                                                        65580001
           COPY DPPD013.                                                65590001
