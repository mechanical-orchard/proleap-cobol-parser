000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.                FSKCS034.                             00050000
000600 AUTHOR.                    DORIE CALLIES.                        00060000
000700 INSTALLATION.              KOHLS DEPARTMENT STORES.              00070000
000800 DATE-WRITTEN.              10-02-90.                             00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  CICS PROGRAM - FSKCS034 - F034                                *00120000
001300*                                                                *00130000
001400*       FASHION SALES - MONTHLY SALES INQUIRY SELECTION          *00140000
001500*                                                                *00150000
001600*       THIS PROGRAM ALLOWS THE USERS TO ENTER PARAMETERS TO     *00160000
001700*  REQUEST AN ONLINE INQUIRY OF MONTHLY SALES INFORMATION BY     *00170000
001800*  UNITS AND DOLLARS.                                            *00180000
001900*                                                                *00190000
002000*           DEPARTMENT       - A VALID 3 DIGIT DEPARTMENT NUMBER *00200000
002100*                              REQUIRED FIELD                    *00210000
002200*           CLASS            - THE MAJOR CLASS NUMBER OR THE     *00220000
002300*                              FULL CLASS NUMBER                 *00230000
002400*                              OPTIONAL FIELD                    *00240000
002500*           SKU              - SEQUENCE NUMBER WITHIN DEPT/CLASS *00250000
002600*                              OPTIONAL FIELD                    *00260000
002700*           GROUP            - GROUP CODE                        *00270000
002800*                              OPTIONAL FIELD                    *00280000
002900*           IN-HOUSE VENDOR  - IN HOUSE VENDOR NUMBER            *00290000
003000*                              OPTIONAL FIELD                    *00300000
003100*           STYLE            - VENDOR STYLE                      *00310000
003200*                              OPTIONAL FIELD                    *00320000
003300*           KEY ITEM         - KEY ITEM INDICATOR                *00330000
003400*                              OPTIONAL FIELD                    *00340000
003500*           DISTRICT         - DISTRICT NUMBER                   *00350000
003600*                              OPTIONAL FIELD                    *00360000
003700*           STORE            - STORE NUMBER                      *00370000
003800*                              OPTIONAL FIELD                    *00380000
003900*           SIZE             - SIZE DESCRIPTION                  *00390000
004000*                              OPTIONAL FIELD                    *00400000
004100*           COLOR            - COLOR NUMBER                      *00410000
004200*                              OPTIONAL FIELD                    *00420000
004300*           FROM MONTH       - BEGINNING MONTH                   *00430000
004400*                              DEFAULTS TO THIS MONTH            *00440000
004500*                              OPTIONAL FIELD                    *00450000
004600*           TO MONTH         - ENDING MONTH                      *00460000
004700*                              DEFAULTS TO THIS MONTH            *00470000
004800*                              OPTIONAL FIELD                    *00480000
004900*           STATUS CODES     - STATUS CODE OF SKUS               *00490000
005000*                              DEFAULTS TO '20'                  *00500000
005100*                              OPTIONAL FIELD                    *00510000
005200*                                                                *00520000
005300*       THE REQUEST SELECTIONS WHICH HAVE BEEN ENTERED ARE       *00530000
005400*  EDITED WITHIN THIS PROGRAM FOR CORRECT FIELD FORMAT (IE.      *00540000
005500*  NUMERIC IS NUMERIC), VALID FIELD CONTENT (IE. 'CLASS' EXISTS),*00550000
005600*  AND LOGICAL FIELD RELATIONSHIPS (IE. IT MAKES NO SENSE TO     *00560000
005700*  ENTER A SPECIFIC SKU NUMBER AND TO ALSO ENTER A GROUP CODE).  *00570000
005800*                                                                *00580000
005900*  ONCE THE SELECTION FIELDS HAVE BEEN VALIDATED, THIS PROGRAM   *00590000
006000*  WILL PASS THE SELECTION CRITERIA TO PROGRAM FSKCS032 WHICH    *00600000
006100*  WILL ACTUALLY DISPLAY THE RESULTING INQUIRY SCREEN.           *00610000
006200*                                                                *00620000
006300*       IF ANY SYSTEM ERRORS ARE DETECTED, THAT THE PROGRAM CAN  *00630000
006400*  NOT RESOLVE, THE PROGRAM WILL BE TERMINATED, AN ERROR         *00640000
006500*  MESSAGE WILL BE DISPLAYED ON THE SCREEN, AND PROGRAM CONTROL  *00650000
006600*  WILL BE RETURNED TO NATIVE CICS.                              *00660000
006700*                                                                *00670000
006800*       DIRECT ENTRY INTO THIS TRANSACTION IS PROHIBITED.        *00680000
006900*  ATTEMPTING TO DO THIS RESULTS IN AN XCTL BACK TO FSKCS010.    *00690000
007000*                                                                *00700000
007100* 04/19/95 -- M. DEERING :  THE CA-VENDOR-STYLE, CA-SIZE, AND    *00710000
007200*                           CA-COLOR FIELDS WERE EXPANDED TO     *00720000
007300*                           20 CHARACTER POSITIONS.              *00730000
007400*                                                                *00740000
007500* 05/20/96 -- C. ROMENESK0: ADDED 'CS' CENTRAL STOCK AS A VALID  *00750000
007600*                           STORE TYPE                           *00760000
007700*                                                                *00770000
007800* 05/23/96 -- A. RAISLER:   ADDED KEY ITEM INDICATOR TO SELECTION*00780000
007900*                           CRITERIA                             *00790000
008000*                                                                *00800000
008100* 05/24/96 -- A. RAISLER:   ADDED SIZE AND COLOR TO SELECTION    *00810000
008200*                           CRITERIA                             *00820000
008300*                                                                *00830000
008400* 06/06/96 -- A. RAISLER:   ADDED VENDOR NAME TO SELECTION       *00840000
008500*                           CRITERIA                             *00850000
008600*                                                                *00860000
008700* 07/11/96 -- A. RAISLER:   CHANGED COLOR EDIT TO SUB-CLASS      *00870000
008800*                                                                *00880000
008700* 03/13/98 -- P. KEBER  :   Y2K WINDOWING LOGIC CHANGES          *00881099
008900*                                                                *00890000
008700* 04/23/98 -- T. MEDREK :   WR6242.  VSM CONVERSION CLEANUP      *00891099
008800*                                                                *00891199
008700* 08/21/98 -- P. KEBER  :   DISPLAY STORE NUMBER AND NAME ON THE *00891299
008900*                           INITIAL SCREEN FOR DS TYPE STORES.   *00892099
008900*                                                                *00893099
008700* 09/02/98 -- S. SWESSEL:   REPLACE DP060 DATE ROUTINE WITH      *00894099
008900*                           DPKUT500 DATE ROUTINE.               *00895099
008900*                                                                *00896099
      * 04/14/99  ROLLIN KRING - REMOVED REFERENCE TO DPG51-SYSTEM-DATE*00896199
      *       WHICH IS NO LONGER SUPPORTED BY THE CALENDAR ROUTINE.    *00896299
      *                                           (WR# 10647)          *00897099
008700* 10/27/99 -- M. KLAMIK :   ADDED LOGIC FOR REGIONAL CLEARANCE   *00898099
008900*                           PRICING - STATUS 25 (MIXED) CHANGES. *00899099
008900*                           DELETED ALL REFERENCES TO METRO AREA *00899199
008900*                           - THE PF23 KEY WAS DELETED.          *00899299
008900*                           WHEN SELECTING STATUS 25 - ONLY PF17 *00899399
008900*                           IS VALID.                            *00899499
      *                                                                *00899599
008700* 05/08/02 -- M. COLEMAN:   MADE CHANGES FOR NON-INTELLEGENT SKU *00899699
008700*             M. KLAMIK:    REVISIONS MADE TO CHANGES-ADDITIONAL *00899799
008700*                           EDITS NEEDED.                        *00899899
      *                                                                *00899999
W27494* 09/03/04 -- M JOHNSON     FALL PERFORMANCE TUNNING. REMOVED    *00900099
W27494*                           DISPLAY OF DISTRICT ON THE MAP TO    *00900199
W27494*                           SUPPORT CHANGE IN TDIDTSM NOT HAVING *00900299
W27494*                           DISTRICT DATA.                       *00900399
W27494*                           WR27494                              *00900499
W27494*                                                                *00900599
      * 09/17/2004  A KINTOPF     STORE NUMBER EXPANSION CHANGES.      *00900699
      *                           CHANGED PROGRAM TO USE XMT_LOC       *00901799
      *                           INSTEAD OF TSTR000.                  *00901899
      *                           ALLOW USER TO ENTER UPC_ID AND THE   *00901999
      *                           PROGRAM WILL GET THE SKU ASSOCIATED  *00902099
      *                           TO IT. TOOK AWAY THE MONTHS FIELDS.  *00902199
      *                           WR26354                              *00902399
SR3403* 05/01/2012  J SELWITSCHKA LARGE RETAIL EXPANSION.              *00902499
SR3403*                           CRQ000000023799                      *00902599
272945*                                                                 00902699
272945* 08/05/2022  JIM HUNTER    CHANGE CALL OF DPKUT100 TO           *00902799
272945*                           CALL DP010I-NUMERIC-EDIT-ROUTINE     *00902899
272945*                           MAKING THE CALL DYNAMIC VS STATIC.   *00902999
272945*                           CHG0272945                           *00903099
1022RM*                                                                 00903199
1022RM* 10/24/2022  BOB MCASEY    ADD COPYBOOK DPWS930 AND CHANGED     *00903299
1022RM*                           CICS ARCHITECTURE CALL TO A DYNAMIC  *00903399
1022RM*                           CALL.                                *00903499
1022RM*                           CHG0                                 *00903599
009000******************************************************************00904099
009100                                                                  00910000
009200******************************************************************00920000
009300 ENVIRONMENT DIVISION.                                            00930000
009400******************************************************************00940000
009500                                                                  00950000
009600******************************************************************00960000
009700 DATA DIVISION.                                                   00970000
009800******************************************************************00980000
009900                                                                  00990000
010000 WORKING-STORAGE SECTION.                                         01000000
010100                                                                  01010000
010200 01  PC-TSYMSG-AREA.                                              01020000
010300     05  PC-TSYMSG-00005      PIC 9(5) VALUE 00005.               01030000
010400     05  PC-TSYMSG-00007      PIC 9(5) VALUE 00007.               01040000
010500     05  PC-TSYMSG-00008      PIC 9(5) VALUE 00008.               01050000
010600     05  PC-TSYMSG-00009      PIC 9(5) VALUE 00009.               01060000
010700     05  PC-TSYMSG-00032      PIC 9(5) VALUE 00032.               01070000
010700     05  PC-TSYMSG-00073      PIC 9(5) VALUE 00073.               01071099
010800     05  PC-TSYMSG-00100      PIC 9(5) VALUE 00100.               01080099
010800     05  PC-TSYMSG-00110      PIC 9(5) VALUE 00110.               01081099
010900     05  PC-TSYMSG-00342      PIC 9(5) VALUE 00342.               01090000
011000     05  PC-TSYMSG-00349      PIC 9(5) VALUE 00349.               01100000
011100     05  PC-TSYMSG-00332      PIC 9(5) VALUE 00332.               01110000
011400     05  PC-TSYMSG-00389      PIC 9(5) VALUE 00389.               01140000
011500     05  PC-TSYMSG-00395      PIC 9(5) VALUE 00395.               01150000
011600     05  PC-TSYMSG-00396      PIC 9(5) VALUE 00396.               01160000
011700     05  PC-TSYMSG-00397      PIC 9(5) VALUE 00397.               01170000
011800     05  PC-TSYMSG-00399      PIC 9(5) VALUE 00399.               01180046
011900     05  PC-TSYMSG-00400      PIC 9(5) VALUE 00400.               01190000
012000     05  PC-TSYMSG-00401      PIC 9(5) VALUE 00401.               01200000
012100     05  PC-TSYMSG-00402      PIC 9(5) VALUE 00402.               01210000
012200     05  PC-TSYMSG-00615      PIC 9(5) VALUE 00615.               01220000
012300     05  PC-TSYMSG-00616      PIC 9(5) VALUE 00616.               01230000
012400     05  PC-TSYMSG-00617      PIC 9(5) VALUE 00617.               01240000
012500     05  PC-TSYMSG-00653      PIC 9(5) VALUE 00653.               01250000
012600     05  PC-TSYMSG-01295      PIC 9(5) VALUE 01295.               01260099
012700     05  PC-TSYMSG-01296      PIC 9(5) VALUE 01296.               01270000
012800     05  PC-TSYMSG-01301      PIC 9(5) VALUE 01301.               01280000
012900     05  PC-TSYMSG-01437      PIC 9(5) VALUE 01437.               01290047
013000     05  PC-TSYMSG-01441      PIC 9(5) VALUE 01441.               01300047
013100     05  PC-TSYMSG-01526      PIC 9(5) VALUE 01526.               01310046
013200     05  PC-TSYMSG-01535      PIC 9(5) VALUE 01535.               01320074
013300     05  PC-TSYMSG-01536      PIC 9(5) VALUE 01536.               01330074
013400     05  PC-TSYMSG-01537      PIC 9(5) VALUE 01537.               01340074
013500     05  PC-TSYMSG-01538      PIC 9(5) VALUE 01538.               01350076
013600     05  PC-TSYMSG-01540      PIC 9(5) VALUE 01540.               01360089
013600     05  PC-TSYMSG-01705      PIC 9(5) VALUE 01705.               01361099
013600     05  PC-TSYMSG-02119      PIC 9(5) VALUE 02119.               01370099
013600     05  PC-TSYMSG-02149      PIC 9(5) VALUE 02149.               01371099
013800                                                                  01380000
013900******************************************************************01390000
014000*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01400000
014100******************************************************************01410000
014200     COPY DPWS013.                                                01420004
014300                                                                  01430000
014600     COPY DPWS500.                                                01460004
014700                                                                  01470000
014800*----------------------------------------------------------------*01480000
014900*    FUNCTION KEYS COPYBOOK                                      *01490000
015000*----------------------------------------------------------------*01500000
015100     COPY DPWS016.                                                01510004
015200                                                                  01520000
015300* NOTE:  IF ANY CHANGE IS MADE TO COMMAREA IN THIS PROGRAM,       01530000
015400*        ALSO CHECK COMMAREA IN FSKCS032                          01540000
015500                                                                  01550000
015600     COPY DPWS030.                                                01560004
1022RM     COPY DPWS930.                                                01561099
015700                                                                  01570000
015800     COPY DPWS020.                                                01580004
015900         10  INTER-APPL-COMM-AREA       PIC X(200).               01590099
                                                                        01590199
      * FASHION SALES INTER-APPL COPYBOOK                               01591099
016000     COPY FSWS000.                                                01600099
                                                                        01600299
      * SELECTION LISTS COPYBOOK                                        01600399
016100     COPY FSWS007.                                                01601099
                                                                        01602099
      * CRITERIA COPYBOOK                                               01603099
016100     COPY FSWS006.                                                01610099
016200                                                                  01620000
016300     10  CA-NEXT-PROGRAM         PIC X(2).                        01630000
016400         88  CA-NO-REQUEST                    VALUE '  '.         01640000
016500         88  CA-FSKCS032-REQUEST              VALUE '32'.         01650000
016600         88  CA-F901-REQUEST                  VALUE '91'.         01660000
016700         88  CA-FSKCS055-REQUEST              VALUE '55'.         01670000
016800                                                                  01670199
016900     10  CA-VENDOR-NAME-ENT-IND  PIC X(1).                        01690000
017000         88  CA-VENDOR-NAME-NOT-ENTERED       VALUE 'N'.          01700000
017100         88  CA-VENDOR-NAME-ENTERED           VALUE 'Y'.          01710000
017200     10  CA-VENDOR-NUMBER-ENT-IND PIC X(1).                       01720000
017300         88  CA-VENDOR-NUMBER-NOT-ENTERED     VALUE 'N'.          01730000
017400         88  CA-VENDOR-NUMBER-ENTERED         VALUE 'Y'.          01740000
017200     10  CA-VENDOR-TYPE           PIC X(2).                       01741099
017500                                                                  01750000
017600     10  CA-INTER-APPL-COPY      PIC X(200).                      01760000
017700                                                                  01770000
017800******************************************************************01780000
017900*  DSECT CREATED BY MAP FSKM034                                   01790000
018000******************************************************************01800000
018100     COPY FSKM034.                                                01810000
018200                                                                  01820000
018300                                                                  01830000
018400 01  PC-PROGRAM-CONSTANTS.                                        01840000
018500     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'FSKCS034'.   01850000
018600     05  PC-CURRENT-MAPSET-NAME  PIC X(08)    VALUE 'FSKM034'.    01860000
018700     05  PC-CURRENT-MAP-NAME     PIC X(08)    VALUE 'FS034A'.     01870000
018800     05  PC-DPKCS030             PIC X(08)    VALUE 'DPKCS030'.   01880000
018900     05  PC-DATA-DISPLAY-PROGRAM PIC X(8)     VALUE 'FSKCS032'.   01890000
019000     05  PC-ONE                  PIC S9(4)    VALUE +1 COMP.      01900000
019100     05  PC-LEAVE-SYSTEM-LENGTH  PIC S9(4)    VALUE +160          01910000
019200                                 COMP SYNC.                       01920000
019300     05  PC-TRANSFER-UP-LENGTH   PIC S9(4)    VALUE +317          01930000
019400                                 COMP SYNC.                       01940000
019500     05  PC-MAXIMUM-RETRY-COUNT  PIC S9(4)    VALUE +2            01950000
019600                                 COMP SYNC.                       01960000
019700     05  PC-CORPORATE-LITERAL    PIC X(10)    VALUE 'ALL STORES'. 01970000
019800     05  PC-DISPLAY-TRANS-CLASS  PIC X(4)     VALUE 'F032'.       01980000
019900     05  PC-DISPLAY-TRANS-DEPT   PIC X(4)     VALUE 'F901'.       01990000
020000     05  PC-DEPT-AUTH-TRAN       PIC X(4)     VALUE 'F900'.       02000000
020100     05  PC-ERR-MSG-1            PIC X(35)    VALUE               02010000
020200       'SELECT ON DISTRICT TABLE (TDST000) '.                     02020000
020300     05  PC-ERR-MSG-2            PIC X(38)    VALUE               02030000
020400       'SELECT ON STORE TABLE (XMT_LOC)       '.                  02040099
020500     05  PC-ERR-MSG-3            PIC X(36)    VALUE               02050000
020600       'SELECT ON SKU TABLE (TSK)           '.                    02060000
020700     05  PC-LITERAL-0            PIC X(1)     VALUE '0'.          02070000
020800     05  PC-LITERAL-9            PIC X(1)     VALUE '9'.          02080000
020900     05  PC-OPERATING-COMPANY    PIC X(2)     VALUE '03'.         02090000
021000     05  PC-SEGMENT-LEVEL-02     PIC X(2)     VALUE '02'.         02100000
021100     05  PC-SEGMENT-LEVEL-03     PIC X(2)     VALUE '03'.         02110000
021200     05  PC-STORE-LOCATION       PIC X(2)     VALUE 'DS'.         02120099
021200     05  PC-STORE-ZERO-LITERAL   PIC X(5)     VALUE '00000'.      02121099
021300     05  PC-SLASH                PIC X(1)     VALUE '/'.          02130000
021400     05  PC-STATUS-98            PIC S9(3)    VALUE +98           02140000
021500                                 COMP-3.                          02150000
028200 01  PM-CICSAUTH-MESSAGE.                                         02820000
028300     05  FILLER                  PIC  X(36)     VALUE             02830000
028400         'INVALID RETURN CODE FROM CICSAUTH - '.                  02840000
028500     05  PM-CM-RETURN-CODE       PIC  9(04).                      02850000
028600                                                                  02860000
028700                                                                  02870000
028800 01  PS-PROGRAM-SWITCHES.                                         02880000
028900     05  PS-DEPT-FOUND-IND       PIC X(1)     VALUE 'N'.          02890000
029000         88  PS-DEPT-NOT-FOUND                VALUE 'N'.          02900000
029100         88  PS-DEPT-FOUND                    VALUE 'Y'.          02910000
029200     05  PS-SIZE-FOUND-IND       PIC X(1)     VALUE 'N'.          02920000
029300         88  PS-SIZE-NOT-FOUND                VALUE 'N'.          02930000
029400         88  PS-SIZE-FOUND                    VALUE 'Y'.          02940000
029500     05  PS-DEPT-NUM-IND         PIC X(1)     VALUE 'N'.          02950000
029600         88  PS-DEPT-NOT-NUMERIC              VALUE 'N'.          02960000
029700         88  PS-DEPT-NUMERIC                  VALUE 'Y'.          02970000
030100     05  PS-DISTRICT-FOUND-IND   PIC X(1)     VALUE 'N'.          03010000
030200         88  PS-DISTRICT-NOT-FOUND            VALUE 'N'.          03020000
030300         88  PS-DISTRICT-FOUND                VALUE 'Y'.          03030000
030400     05  PS-DISTRICT-NUM-IND     PIC X(1)     VALUE 'N'.          03040000
030500         88  PS-DISTRICT-NOT-NUMERIC          VALUE 'N'.          03050000
030600         88  PS-DISTRICT-NUMERIC              VALUE 'Y'.          03060000
031000     05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          03100000
031100         88  PS-NO-EDIT-ERROR                 VALUE 'N'.          03110000
031200         88  PS-EDIT-ERROR                    VALUE 'Y'.          03120000
031300     05  PS-COLOR-FOUND-IND      PIC X(1)     VALUE 'N'.          03130060
031400         88  PS-COLOR-FOUND                   VALUE 'Y'.          03140060
031500         88  PS-COLOR-NOT-FOUND               VALUE 'N'.          03150060
031600     05  PS-COLOR-ERROR-IND      PIC X(1)     VALUE 'N'.          03160060
031700         88  PS-NO-COLOR-ERROR                VALUE 'N'.          03170060
031800         88  PS-COLOR-ERROR                   VALUE 'Y'.          03180060
031900     05  PS-COLOR-FAMILY-IND     PIC X(1)     VALUE 'N'.          03190000
032000         88  PS-NOT-COLOR-FAMILY              VALUE 'N'.          03200000
032100         88  PS-COLOR-FAMILY                  VALUE 'Y'.          03210000
032200     05  PS-MAJOR-CLASS-IND      PIC X(1)     VALUE 'N'.          03220000
032300         88  PS-NO-VALID-MAJOR-CLASS          VALUE 'N'.          03230000
032400         88  PS-VALID-MAJOR-CLASS             VALUE 'Y'.          03240000
032500     05  PS-MAJOR-BLANK-IND      PIC X(1)     VALUE 'N'.          03250000
032600         88  PS-MAJOR-CLASS-NOT-BLANK         VALUE 'N'.          03260000
032700         88  PS-MAJOR-CLASS-BLANK             VALUE 'Y'.          03270000
032800     05  PS-MINOR-BLANK-IND      PIC X(1)     VALUE 'N'.          03280000
032900         88  PS-MINOR-CLASS-NOT-BLANK         VALUE 'N'.          03290000
033000         88  PS-MINOR-CLASS-BLANK             VALUE 'Y'.          03300000
033100     05  PS-MINOR-CLASS-IND      PIC X(1)     VALUE 'N'.          03310000
033200         88  PS-NO-VALID-MINOR-CLASS          VALUE 'N'.          03320000
033300         88  PS-VALID-MINOR-CLASS             VALUE 'Y'.          03330000
033400     05  PS-INQUIRY-AUTH-IND     PIC X(1)     VALUE 'M'.          03340000
033500         88  PS-MINOR-CLASS-AUTH              VALUE 'M'.          03350000
033600         88  PS-DEPARTMENT-AUTH               VALUE 'D'.          03360000
033700     05  PS-STORE-FOUND-IND      PIC X(1)     VALUE 'N'.          03370000
033800         88  PS-STORE-NOT-FOUND               VALUE 'N'.          03380000
033900         88  PS-STORE-FOUND                   VALUE 'Y'.          03390000
034000     05  PS-STORE-NUM-IND        PIC X(1)     VALUE 'N'.          03400000
034100         88  PS-STORE-NOT-NUMERIC             VALUE 'N'.          03410000
034200         88  PS-STORE-NUMERIC                 VALUE 'Y'.          03420000
034300     05  PS-VENDOR-NAME-IND      PIC X(1)     VALUE 'N'.          03430000
034400         88  PS-VENDOR-NAME-NOT-FOUND         VALUE 'N'.          03440000
034500         88  PS-VENDOR-NAME-FOUND             VALUE 'Y'.          03450000
034600     05  PS-VENDOR-NUM-IND       PIC X(1)     VALUE 'N'.          03460000
034700         88  PS-VENDOR-NOT-NUMERIC            VALUE 'N'.          03470000
034800         88  PS-VENDOR-NUMERIC                VALUE 'Y'.          03480000
034900     05  PS-SIZE-DESC-FOUND-SW   PIC X(01)    VALUE 'N'.          03490000
035000         88  PS-SIZE-DESC-FOUND               VALUE 'Y'.          03500000
035100         88  PS-SIZE-DESC-NOT-FOUND           VALUE 'N'.          03510000
035200                                                                  03520000
035300     05  PS-DB-ERROR-SW          PIC X(1)     VALUE 'N'.          03530000
035400         88  DB-ERROR                         VALUE 'Y'.          03540000
035500         88  DB-ERROR-NO                      VALUE 'N'.          03550000
035600                                                                  03560000
035700 01  PV-PROGRAM-VARIABLES.                                        03570000
035800     05  PV-RETRY-COUNT          PIC S9(4)    VALUE ZERO          03580000
035900                                 COMP SYNC.                       03590000
035800     05  PV-TYPE-COUNT           PIC S9(4)    VALUE ZERO          03591099
035900                                 COMP SYNC.                       03592099
036000     05  PV-SQL-SUB              PIC S9(4)    VALUE ZERO          03600000
036100                                 COMP SYNC.                       03610000
036200     05  PV-CICS-RESPONSE        PIC S9(9)    VALUE ZERO          03620000
036300                                              COMP SYNC.          03630000
036400     05  PV-COLOR-COUNT          PIC S9(04)   VALUE ZERO          03640058
036500                                              COMP SYNC.          03650058
           05  PV-UPC-NBR               PIC S9(15)V COMP-3 VALUE +0.    03651099
036600     05  PV-COLOR-1              PIC X(10)    VALUE SPACES.       03660058
036700     05  PV-COLOR-2              PIC X(10)    VALUE SPACES.       03670000
036800     05  PV-COLOR-1-CDE          PIC X(3)     VALUE SPACES.       03680000
036900     05  PV-COLOR-2-CDE          PIC X(3)     VALUE SPACES.       03690000
037000     05  PV-CENTURY              PIC 9(2)     VALUE ZEROES.       03700000
037100         88  PV-20TH-CENTURY                  VALUE 81 THRU 99.   03710099
037200         88  PV-21ST-CENTURY                  VALUE 00 THRU 80.   03720099
038500                                                                  03850000
038600     05  PV-KEY-FEEDBACK-AREA    PIC X(11)    VALUE SPACES.       03860000
038800     05  PV-PREVIOUS-PROGRAM     PIC X(8)     VALUE SPACES.       03880000
038900         88  PV-SUBORDINATE-PROGRAM           VALUE 'FSKCS032'.   03890000
           05  PV-STORE-NUMBER-COMP    PIC S9(04)   COMP.               03901099
040300     05  PV-USER-ID.                                              04030000
040400         10  PV-USER-ID-PREFIX   PIC X(4)     VALUE SPACES.       04040000
040500             88  PV-APPLICATIONS-PREFIX       VALUE 'TKMA'.       04050000
040600         10  PV-USER-ID-SUFFIX   PIC X(4)     VALUE SPACES.       04060000
040700         10  FILLER              REDEFINES PV-USER-ID-SUFFIX.     04070000
040800             25  PV-APPLICATIONS-SEQ-NUMBER                       04080000
040900                                 PIC 9(3).                        04090000
041000             25  FILLER          PIC X(1).                        04100000
041300                                                                  04130000
041400 01  PV-CLASS-LOW                PIC X(2)     VALUE SPACES.       04140000
041500 01  FILLER  REDEFINES  PV-CLASS-LOW.                             04150000
041600     05  FILLER                  PIC X.                           04160000
041700     05  PV-CLASS-LOW-POS-2      PIC X.                           04170000
041800                                                                  04180000
MC0502 01  PV-CLASS-LOW-C3             PIC S9(4)V COMP-3.               04181099
MC0502 01  PV-CLASS-HIGH-C3            PIC S9(4)V COMP-3.               04182099
                                                                        04183099
041900 01  PV-CLASS-HIGH               PIC X(2)     VALUE SPACES.       04190000
042000 01  FILLER  REDEFINES  PV-CLASS-HIGH.                            04200000
042100     05  FILLER                  PIC X.                           04210000
042200     05  PV-CLASS-HIGH-POS-2     PIC X.                           04220000
042300                                                                  04230000
042400 01  PV-DEPT-NUMBER              PIC X(03).                       04240000
042500 01  PV-INHOUSE-NUMBER           PIC S9(03) COMP-3.               04250000
042500 01  PV-VENDOR-TYPE              PIC X(02).                       04251099
042600                                                                  04260000
042700 01  PV-MAJOR-CLASS.                                              04270000
042800     05  PV-MAJOR-CLASS-1        PIC X(01).                       04280000
042900     05  PV-MAJOR-CLASS-2        PIC X(01).                       04290000
043000 01  PV-MAJOR-CLASS-X REDEFINES PV-MAJOR-CLASS PIC X(02).         04300000
MC0502 01  PV-MAJOR-CLASS-9 REDEFINES PV-MAJOR-CLASS PIC 9(02).         04301099
043100                                                                  04310000
043200 01  PV-MINOR-CLASS.                                              04320000
043300     05  PV-MINOR-CLASS-1        PIC X(01).                       04330000
043400     05  PV-MINOR-CLASS-2        PIC X(01).                       04340000
043500     05  PV-MINOR-CLASS-3        PIC X(01).                       04350000
043600 01  PV-MINOR-CLASS-X REDEFINES PV-MINOR-CLASS PIC X(03).         04360000
043700                                                                  04370000
043800 01  ST-DATE-EDIT.                                                04380000
043900     05  ST-DATE-MM              PIC 9(2)     VALUE ZERO.         04390000
044000     05  ST-DATE-DD              PIC 9(2)     VALUE ZERO.         04400000
044100     05  ST-DATE-YY              PIC 9(2)     VALUE ZERO.         04410000
044200                                                                  04420000
044300 01  ST-SYSTEM-TIME-AREA.                                         04430000
044400     05  ST-ABSTIME              PIC S9(18)   VALUE ZERO          04440000
044500                                 COMP SYNC.                       04450000
044600     05  ST-TIME-EDIT.                                            04460000
044700         10  ST-TIME-HHMM        PIC X(5)     VALUE SPACES.       04470000
044800         10  FILLER              PIC X(3)     VALUE SPACES.       04480000
044900                                                                  04490000
MC0502******************************************************************04500099
MC0502*    COPY BOOK FOR NON-INTELLEGENT SKU CONVERSIONS                04510099
MC0502******************************************************************04520099
MC0502     COPY ISWS006.                                                04530099
045000******************************************************************04541099
045100*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        04542099
045200******************************************************************04543099
045300     COPY DPWS008.                                                04544099
045400                                                                  04545099
045500******************************************************************04550000
045600*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE            04560000
045700******************************************************************04570000
045800     COPY DPWS010I.                                               04580004
045900                                                                  04590000
046000******************************************************************04600000
046100*  STANDARD ATTENTION IDENTIFIER LIST                             04610000
046200******************************************************************04620000
046300     COPY DFHAID.                                                 04630000
046400                                                                  04640000
046500******************************************************************04650000
046600*  STANDARD KOHL'S ATTRIBUTE LIST                                 04660000
046700******************************************************************04670000
046800     COPY DPWS015.                                                04680004
046900                                                                  04690000
047700******************************************************************04770000
047800*    XMT00001 IS THE DCLGEN MEMBER FOR THE STORE TABLE           *04780099
047900******************************************************************04790000
048000     EXEC SQL                                                     04800000
048100         INCLUDE XMT00001                                         04810099
048200     END-EXEC.                                                    04820000
048300                                                                  04830000
048400******************************************************************04840000
048500*    TCOLOR IS THE DCLGEN MEMBER FOR THE COLOR TABLE            * 04850000
048600******************************************************************04860000
048700     EXEC SQL                                                     04870000
048800         INCLUDE TCOLOR                                           04880000
048900     END-EXEC.                                                    04890000
049000                                                                  04900000
049100******************************************************************04910000
049200*    TDST000 IS THE DCLGEN MEMBER FOR THE DISTRICT TABLE         *04920000
049300******************************************************************04930000
049400     EXEC SQL                                                     04940000
049500         INCLUDE TDST000                                          04950000
049600     END-EXEC.                                                    04960000
049700                                                                  04970000
050500******************************************************************05050000
050600*    TDST000 IS THE DCLGEN MEMBER FOR THE SIZE TABLE             *05060000
050700******************************************************************05070000
050800     EXEC SQL                                                     05080000
050900         INCLUDE TSIZE                                            05090000
051000     END-EXEC.                                                    05100000
051100                                                                  05110000
051200******************************************************************05120000
051300*    TDST000 IS THE DCLGEN MEMBER FOR THE TDSZMEM TABLE          *05130000
051400******************************************************************05140000
051500     EXEC SQL                                                     05150000
051600         INCLUDE TDSZMEM                                          05160000
051700     END-EXEC.                                                    05170000
051800                                                                  05180000
051900******************************************************************05190000
052000*    TSK IS THE DCLGEN MEMBER FOR THE SKU TABLE                  *05200000
052100******************************************************************05210000
052200     EXEC SQL                                                     05220099
052300         INCLUDE TSK                                              05230099
052400     END-EXEC.                                                    05240099
052500                                                                  05255000
051900******************************************************************05256099
052000*    TSKXREF IS THE DCLGEN MEMBER FOR THE SKU XREF TABLE         *05257099
052100******************************************************************05258099
052200     EXEC SQL                                                     05259099
052300         INCLUDE TSKXREF                                          05259199
052400     END-EXEC.                                                    05259299
052500                                                                  05259399
052600******************************************************************05260000
052700*    DEPARTMENT/CLASS VALIDATION                                  05270000
052800******************************************************************05280000
052900     EXEC SQL                                                     05290000
053000         INCLUDE TMDSEAR                                          05300000
053100     END-EXEC.                                                    05310000
053200                                                                  05320000
054000******************************************************************05400000
054100*    VENDOR TABLE                                                 05410000
054200******************************************************************05420000
054300     EXEC SQL                                                     05430000
054400         INCLUDE TVNDDPT                                          05440000
054500     END-EXEC.                                                    05450000
054600                                                                  05460000
054700******************************************************************05470000
054800*    ENTITY TABLE                                                 05480000
054900******************************************************************05490000
055000     EXEC SQL                                                     05500000
055100         INCLUDE TENTNME                                          05510000
055200     END-EXEC.                                                    05520000
055300                                                                  05530000
      ******************************************************************05530199
      *    THIS IS THE DCLGEN MEMBER FOR THE TUPCSKU TABLE             *05530299
      ******************************************************************05530399
           EXEC SQL                                                     05530499
               INCLUDE TUPCSKU                                          05530599
           END-EXEC.                                                    05530699
                                                                        05530799
047000******************************************************************05531099
047100*    SQLCA IS THE DB2 COMMUNICATIONS AREA                        *05532099
047200******************************************************************05533099
047300     EXEC SQL                                                     05534099
047400         INCLUDE SQLCA                                            05535099
047500     END-EXEC.                                                    05536099
047600                                                                  05537099
055400******************************************************************05540000
055500 LINKAGE SECTION.                                                 05550000
055600******************************************************************05560000
055700                                                                  05570000
055800 01  DFHCOMMAREA.                                                 05580000
055900     05  FILLER                         OCCURS  1 TO 4072 TIMES   05590000
056000                                        DEPENDING ON EIBCALEN.    05600000
056100         10  FILLER                     PIC X.                    05610000
056200                                                                  05620000
056300******************************************************************05630000
056400 PROCEDURE DIVISION.                                              05640000
056500******************************************************************05650000
056600                                                                  05660000
056700 0000-MAINLINE.                                                   05670000
                                                                        05671099
056800     MOVE '*0000-MAINLINE.                  *' TO DP013-PARAGRAPH 05680000
056900                                                                  05690000
057000     INITIALIZE DP030-CICS-API-FIELDS.                            05700000
057100     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        05710000
057200     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           05720000
057300     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          05730000
057400     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        05740000
057500     MOVE LENGTH OF FS034AI       TO DP030-MAP-LENGTH (1).        05750000
057600     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      05760000
057700     PERFORM 0001-CALL-CICS-ARCH-API.                             05770000
057800                                                                  05780000
057900     PERFORM 1000-CONTROL-PROCESSING.                             05790000
058000                                                                  05800000
058100     IF PS-EDIT-ERROR          OR                                 05810000
058200        DP020-NEXT-ACT-INITIAL OR                                 05820000
058300        DP020-NEXT-ACT-RETURN                                     05830000
058400         CONTINUE                                                 05840000
058500     ELSE                                                         05850000
058600         EVALUATE TRUE                                            05860000
058700*-->        ON F14 / F15 / F17                                    05870030
058800            WHEN  DP020-FK-LOCAL-GOTO(DP020-SRC-AID)              05880000
058900*-->        ON F19                                                05890030
059000            WHEN  DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)           05900029
058900*-->        ON F22                                                05901099
059000            WHEN  DP020-SRC-AID = DP016-PF22                      05901199
058900*-->        ON F23                                                05901399
059000            WHEN  DP020-SRC-AID = DP016-PF23                      05901499
059100                PERFORM 9400-WRITE-CRITERIA-QUEUE                 05910000
059200                PERFORM 9500-WRITE-KEY-QUEUE                      05920000
059300         END-EVALUATE                                             05930000
059400     END-IF.                                                      05940000
059500                                                                  05950000
059600     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      05960000
059700     PERFORM 0001-CALL-CICS-ARCH-API.                             05970000
059800                                                                  05980000
059900     GOBACK.                                                      05990000
060000                                                                  06000000
060100     EJECT                                                        06010000
060200******************************************************************06020099
060300*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *06030000
060400*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *06040000
060200******************************************************************06041099
060700 0001-CALL-CICS-ARCH-API.                                         06070000
                                                                        06071099
060800     MOVE '*0001-CALL-CICS-ARCH-API.        *' TO DP013-PARAGRAPH 06080000
060900                                                                  06090000
061000     IF PS-EDIT-ERROR                                             06100000
061100         IF DP030-SET-CURSOR-APPL-1                               06110000
061200             IF DP020-MSG-WARNING OR                              06120000
061300                DP020-MSG-INFORMATIONAL                           06130000
061400                 NEXT SENTENCE                                    06140000
061500             ELSE                                                 06150000
061600                 SET DP020-MSG-FATAL           TO TRUE            06160000
061700             END-IF                                               06170099
061800         ELSE                                                     06180000
061900             IF DP030-SET-CURSOR-ABSOLUTE                         06190000
062000                 NEXT SENTENCE                                    06200000
062100             ELSE                                                 06210000
062200                 SET DP030-SET-CURSOR-TRAILER  TO TRUE            06220099
062300             END-IF                                               06230099
062400         END-IF                                                   06240099
062500     END-IF.                                                      06250099
062600                                                                  06260000
062700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06270099
062800                                    DFHCOMMAREA                   06280099
062900                                    DP030-CICS-API-FIELDS         06290099
063000                                    DP020-STANDARD-COMMAREA       06300099
063100                                    FS034AI.                      06310099
063200                                                                  06320000
063300     IF  DP030-RC-CALL-SUCCESSFUL                                 06330000
063400         CONTINUE                                                 06340000
063500     ELSE                                                         06350000
063600         SET DP013-NO-ROLLBACK TO TRUE                            06360000
063700         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   06370000
063800         SET DP013-CICS-ABEND TO TRUE                             06380000
063900         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        06390000
1022RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06411099
1022RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06412099
064200         MOVE DP030-RETURN-CODE                                   06420000
064300                               TO DP013-MESSAGE-TEXT (3)          06430000
064400         PERFORM DP013-0000-PROCESS-ABEND                         06440000
064500     END-IF.                                                      06450000
064600                                                                  06460000
060200******************************************************************06461099
060300*   THIS IS THE CONTROL PROCESSING PARAGRAPH                     *06462099
060200******************************************************************06462199
064700 1000-CONTROL-PROCESSING.                                         06470000
                                                                        06471099
064800     MOVE '*1000-CONTROL-PROCESSING.        *' TO DP013-PARAGRAPH 06480000
                                                                        06480199
           IF CA-VENDOR-TYPE = SPACES                                   06480299
              MOVE '01'                      TO CA-VENDOR-TYPE          06481099
           END-IF.                                                      06482099
064900                                                                  06490000
065000     IF DP020-NEXT-ACT-INITIAL                                    06500000
065100*-->     1ST TIME IN, LOAD INITIAL VALUES INTO COMMAREA & SCREEN  06510000
065200         PERFORM 1100-INITIALIZATIONS                             06520000
065300         MOVE CA-FS-INTER-APPL-COMMAREA TO CA-INTER-APPL-COPY     06530000
065400     END-IF.                                                      06540000
065500                                                                  06550000
065600                                                                  06560000
065700     IF DP020-NEXT-ACT-RETURN                                     06570000
065800           MOVE SPACES TO DP020-MSG-SEVERITY-IND                  06580099
065900*-->    COMING BACK IN, SO GET THE ORIGINAL CRITERIA              06590026
066000           PERFORM 9200-READ-CRITERIA-QUEUE                       06600099
                                                                        06600199
      *-->       CHECK FOR RETURN FORMAT-IND 5 FOR VENDOR SELECTION     06600299
                 IF DP020-INT-APPL-FORMAT-IND = '5'                     06600399
                    MOVE FS007-VENDOR-NAME     TO CA-VENDOR-NAME        06601099
                                                  VENNMI                06601199
                    MOVE FS007-VENDOR-TYPE     TO CA-VENDOR-TYPE        06601299
                 END-IF                                                 06602099
                                                                        06603099
066100           IF PV-CICS-RESPONSE = DFHRESP (QIDERR)                 06610099
066200              PERFORM 1100-INITIALIZATIONS                        06620099
066300           ELSE                                                   06630099
066400              PERFORM 9300-READ-KEY-QUEUE                         06640099
066500           END-IF                                                 06650099
                                                                        06650199
      *-->       MOVE INTER-APPL-COPY COMMAREA TO FS COMMAREA           06650299
D68300           MOVE CA-INTER-APPL-COPY  TO CA-FS-INTER-APPL-COMMAREA  06650699
066600     ELSE                                                         06660000
066700         MOVE CA-INTER-APPL-COPY TO CA-FS-INTER-APPL-COMMAREA     06670000
066800     END-IF.                                                      06680000
066900                                                                  06690000
067000     EVALUATE TRUE                                                06700000
067100                                                                  06710000
067200         WHEN DP020-NEXT-ACT-INITIAL                              06720000
067300         WHEN DP020-NEXT-ACT-RETURN                               06730000
067400                                                                  06740000
067500             SET DP030-SET-CURSOR-APPL-1   TO TRUE                06750000
067600             MOVE -1                       TO DEPTL               06760000
067700             IF CA-DEPT-NUMBER-X      NUMERIC                     06770000
067800                 PERFORM 2100-MOVE-COMMAREA-TO-MAP                06780000
067900                 PERFORM 3000-EDIT-INPUT-FIELDS                   06790000
068000             END-IF                                               06800000
068100                                                                  06810000
068200         WHEN DP020-NEXT-ACT-READ-MAP                             06820000
068300             MOVE CA-INTER-APPL-COPY  TO CA-FS-INTER-APPL-COMMAREA06830000
068400             PERFORM 2000-FKEY-PROCESSING                         06840000
068500                                                                  06850000
068600         WHEN OTHER                                               06860000
068700             SET DP013-LOGIC-ABEND                                06870000
068800                 DP013-NO-ROLLBACK TO TRUE                        06880000
068900             MOVE '1000-CONTROL-PROCESSING'                       06890000
069000                                   TO  DP013-PARAGRAPH            06900000
069100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   06910000
069200                                   TO  DP013-MESSAGE-TEXT(1)      06920000
069300             MOVE DP020-NEXT-APPL-ACTIVITY                        06930000
069400                                   TO DP013-MESSAGE-TEXT(2)       06940000
069500             PERFORM DP013-0000-PROCESS-ABEND                     06950000
069600     END-EVALUATE.                                                06960000
                                                                        06970099
069800     MOVE CA-FS-INTER-APPL-COMMAREA TO CA-INTER-APPL-COPY.        06980099
                                                                        06980199
069700*--> FORMAT KEY FOR FOR THE VENDOR SELECTION LIST - PF22          06981099
093007     IF DP020-SRC-AID = DP016-PF22                                06982099
MC0502*       MOVE CA-DEPT-NUMBER-X  TO FS007-DEPT-NUMBER               06982199
              MOVE CA-VENDOR-NAME    TO FS007-VENDOR-NAME               06982299
           END-IF.                                                      06984099
069900                                                                  06990000
070100******************************************************************07010000
070200*    CLEAN UP PROGRAM-SPECIFIC COMMAREA AND, IF NEED BE,         *07020000
070300*    FASHION SALES COMMAREA AS WELL.                             *07030000
070400******************************************************************07040000
070600 1100-INITIALIZATIONS.                                            07060000
070500                                                                  07061099
070700     MOVE '*1100-INITIALIZATIONS.           *' TO DP013-PARAGRAPH 07070000
070800                                                                  07080000
070900     INITIALIZE CA-FSKCS034-CRITERIA-DATA                         07090000
071000                CA-NEXT-PROGRAM.                                  07100099
071100                                                                  07110000
071200     IF DP020-NAV-KEY-DATA > SPACES                               07120000
071300         MOVE DP020-NAV-KEY-DATA TO CA-SKU-STORE.                 07130000
071400                                                                  07140000
071500     IF CA-DEPT-NUMBER-X NOT NUMERIC                              07150000
071600         MOVE SPACES     TO  CA-DEPT-NUMBER-X                     07160000
071700                             CA-DEPT-NAME.                        07170000
071800                                                                  07180000
071900     IF CA-CLASS-NUMBER-X NOT NUMERIC                             07190000
072000         MOVE SPACES     TO  CA-CLASS-NUMBER-X                    07200000
072100                             CA-CLASS-DESCRIPTION.                07210000
072200                                                                  07220000
MC0502     IF CA-SKU-NUMBER-X NOT NUMERIC                               07230099
072400         MOVE SPACES     TO  CA-SKU-NUMBER-X                      07240099
072500                             CA-SKU-DESCRIPTION.                  07250000
072600                                                                  07250199
MC0502     IF CA-UPC-NUMBER-X NOT NUMERIC                               07251099
072400         MOVE SPACES     TO  CA-UPC-NUMBER-X.                     07252099
072600                                                                  07260000
072700     IF CA-STORE-NUMBER-X NOT NUMERIC                             07270000
073000         MOVE SPACES     TO  CA-STORE-SHORT-NAME                  07300099
073100                                                                  07310000
073200     IF CA-SKU-NUMBER-X   NOT NUMERIC                             07320000
073300         MOVE +0         TO  CA-ITEM-NUMBER.                      07330000
073400                                                                  07340000
073500     EXEC CICS                                                    07350000
073600         ASKTIME                                                  07360000
073700             ABSTIME(ST-ABSTIME)                                  07370000
073800     END-EXEC.                                                    07380000
073900                                                                  07390000
074000     EXEC CICS                                                    07400000
074100         FORMATTIME                                               07410000
074200             ABSTIME(ST-ABSTIME)                                  07420000
074300             MMDDYY(ST-DATE-EDIT)                                 07430000
074400             TIME(ST-TIME-EDIT)                                   07440000
074500             TIMESEP                                              07450000
074600     END-EXEC.                                                    07460000
074700                                                                  07470000
074800     MOVE ST-DATE-MM                 TO CA-TODAYS-MM.             07480000
074900     MOVE ST-DATE-YY                 TO CA-TODAYS-YY.             07490000
075000                                                                  07500000
075100     MOVE ST-DATE-DD                 TO CA-TODAYS-DD.             07510000
075200                                                                  07520000
075300     MOVE CA-TODAYS-YY               TO PV-CENTURY.               07530000
075400     IF  PV-20TH-CENTURY                                          07540000
075500         SET CA-TODAY-IS-1900S       TO TRUE                      07550000
075600     ELSE                                                         07560000
075700         SET CA-TODAY-IS-2000S       TO TRUE                      07570000
075800     END-IF.                                                      07580000
075900                                                                  07590000
076000**   CALL THE DPKUT500 DATE ROUTINE TO DETERMINE THE FISCAL       07600000
076100**   MONTH.  FOR INSTANCE, 7/2/93 IS ACTUALLY STILL IN FISCAL     07610000
076200**   JUNE, SO DEFAULT CA-FROM/TO DATES S/B "06".                  07620000
076300**   USE F4                                                       07630000
076400                                                                  07640000
076500     INITIALIZE DPG51                                             07650000
076600                DPG52                                             07660000
076700                DPG53                                             07670000
076800                DPG54                                             07680000
076900                DPG55                                             07690000
077000                DPG56.                                            07700000
077100                                                                  07710000
077300     MOVE CA-TODAYS-CCYYMMDD-DATE    TO DPG52-LK-DATE-INPUT       07730000
077400     SET DPG52-LK-DTE-ISO            TO TRUE                      07740000
077600     SET DPG51-FISCAL-JAN-DEC-F2     TO TRUE                      07760000
077700                                                                  07770000
077800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                07780099
077900                                             DPG52                07790099
078000                                             DPG53                07800099
078100                                             DPG54                07810099
078200                                             DPG55                07820099
078300                                             DPG56.               07830099
078400                                                                  07840000
079300     SET CA-STAT-10-ENTERED      TO TRUE                          07930000
079400     MOVE CA-STAT-10             TO STATAO                        07940000
079500     SET CA-STAT-20-ENTERED      TO TRUE                          07950000
079600     MOVE CA-STAT-20             TO STATCO                        07960000
079700     SET CA-STAT-40-ENTERED      TO TRUE                          07970000
079800     MOVE CA-STAT-40             TO STATBO                        07980000
079900     SET CA-STAT-90-ENTERED      TO TRUE                          07990000
080000     MOVE CA-STAT-90             TO STATDO                        08000000
080100                                                                  08010099
083300     IF  DP020-LOCATION-TYPE = PC-STORE-LOCATION                  08011099
080200         MOVE DP020-LOCATION        TO CA-STORE-NUMBER-X          08020099
080300                                       STOREO                     08030099
237200         PERFORM 33500-GET-STORE                                  08030399
237300         IF PS-STORE-NOT-FOUND                                    08030499
237400             MOVE DP015-REVERSE        TO STOREH                  08030599
237500             MOVE DP015-RED            TO STOREC                  08030699
237600             MOVE DP015-UNP-ALP-BRT-OFF                           08030799
237700                                   TO STOREA                      08030899
237800             IF NOT PS-EDIT-ERROR                                 08030999
237900                 SET PS-EDIT-ERROR TO TRUE                        08031099
238000                 MOVE PC-TSYMSG-00332 TO DP020-MSG-NUMBER         08031199
238100                 MOVE -1               TO STOREL                  08031299
238200             END-IF                                               08032099
238300         END-IF                                                   08040099
080600     ELSE                                                         08060099
080200         MOVE PC-STORE-ZERO-LITERAL TO CA-STORE-NUMBER-X          08060199
080300                                       STOREO                     08060299
080400         MOVE PC-CORPORATE-LITERAL  TO CA-STORE-NAME              08060399
080500                                       STRDSCO                    08060499
080600     END-IF.                                                      08060599
080600                                                                  08061099
080700     MOVE SPACE                  TO CA-KEY-ITEM                   08070000
080800                                    REPLENO                       08080071
080900                                    KYITMO                        08090071
081000                                    COLOR1O                       08100000
081100                                    COLOR2O                       08110000
081200                                    SIZEO.                        08120000
081300                                                                  08130000
089100******************************************************************08140099
089200*  PFKEY PROCESSING PARAGRAPH                                     08141099
089800******************************************************************08142099
081500 2000-FKEY-PROCESSING.                                            08150000
                                                                        08151099
081600     MOVE '*2000-FKEY-PROCESSING.           *' TO DP013-PARAGRAPH 08160000
081700                                                                  08170000
081800     SET PS-NO-EDIT-ERROR TO TRUE                                 08180000
081900                                                                  08190000
082000     EVALUATE TRUE                                                08200000
082100                                                                  08210000
082200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08220000
082300                                                                  08230000
082400             INITIALIZE CA-NEXT-PROGRAM                           08240000
082500             PERFORM 2100-MOVE-COMMAREA-TO-MAP                    08250000
082600                                                                  08260000
082700         WHEN OTHER                                               08272099
082800                                                                  08280000
082900             PERFORM 3000-EDIT-INPUT-FIELDS                       08290000
082900                                                                  08290199
083100     END-EVALUATE.                                                08310000
083200                                                                  08320000
083300     IF  PS-NO-EDIT-ERROR                                         08330000
083500         MOVE -1               TO DEPTL                           08350000
083600         SET DP030-CONTINUE-GO TO TRUE                            08360000
083700     ELSE                                                         08370000
083800         SET DP030-OVERRIDE-GO TO TRUE                            08380000
083900         IF DP020-MSG-INFORMATIONAL OR                            08390000
084000            DP020-MSG-WARNING                                     08400000
084100             NEXT SENTENCE                                        08410000
084200         ELSE                                                     08420000
084300             SET DP030-SET-CURSOR-APPL-1 TO TRUE.                 08430000
084400                                                                  08440000
089100******************************************************************08450099
089200*  MOVE COMMAREA FIELDS TO THE MAP                                08451099
089800******************************************************************08457099
084600 2100-MOVE-COMMAREA-TO-MAP.                                       08460000
084700                                                                  08470000
084800     MOVE LOW-VALUES           TO FS034AI                         08480000
084900                                                                  08490000
085000     MOVE CA-DEPT-NUMBER-X     TO DEPTO                           08500000
085100     MOVE CA-DEPT-NAME         TO DPTDSCO                         08510000
MC0502     MOVE CA-SKU-NUMBER-X      TO SKUO                            08540099
085500     MOVE CA-SKU-DESCRIPTION   TO SKUDSCO                         08550099
MC0502     MOVE CA-UPC-NUMBER-X      TO UPCO                            08551099
MK         MOVE CA-CLASS-NUMBER-X    TO CLASSO                          08560099
085600     MOVE CA-CLASS-DESCRIPTION TO CLSDSCO                         08561099
085700     MOVE CA-GROUP-CODE        TO GROUPO                          08570000
085800     MOVE CA-INHOUSE-NUMBER    TO VENNOO                          08580000
085900     MOVE CA-VENDOR-NAME       TO VENNMO                          08590000
086100     MOVE CA-STYLE             TO STYLEO                          08610000
086200     MOVE CA-DISTRICT-NUMBER   TO DISTO                           08620041
086500     IF CA-DISTRICT-NUMBER = SPACES                               08651099
086700        MOVE CA-STORE-NUMBER-X    TO STOREO                       08670082
086800     ELSE                                                         08680082
086900        MOVE SPACES               TO STOREO                       08690082
087000     END-IF.                                                      08700082
087100                                                                  08710082
087200     MOVE CA-STORE-NAME        TO STRDSCO                         08720000
087300     MOVE CA-COLOR-1-X         TO COLOR1O                         08730000
087400     MOVE CA-COLOR-2-X         TO COLOR2O                         08740000
087500     MOVE CA-COLOR-DESC        TO COLORDO                         08750000
087600     MOVE CA-SIZE-DESC         TO SIZEO                           08760000
087800     MOVE CA-KEY-ITEM          TO KYITMO                          08780071
088100     MOVE CA-STAT-10           TO STATAO                          08810000
088200     MOVE CA-STAT-40           TO STATBO                          08820000
088300     MOVE CA-STAT-20           TO STATCO                          08830000
088400     MOVE CA-STAT-90           TO STATDO                          08840000
088500     MOVE CA-STAT-30           TO STATEO.                         08850000
088300     MOVE CA-STAT-25           TO STATFO                          08851099
088600     MOVE CA-VSM-REPLENISH     TO REPLENO.                        08860070
088700                                                                  08870099
089100******************************************************************08871099
089200*  PROCESS INFORMATION ENTERED ON THE SCREEN. RECEIVE THE MAP     08872099
089300*  AND FILL THE COMMAREA FIELDS FROM THE MAP FIELDS. UPDATE THE   08873099
089400*  SCREEN HEADER IN PREPARATION FOR EVENTUAL SENDING BACK OUT TO  08874099
089500*  TERMINAL. RESET THE ATTRIBUTES FOR THE PROGRAM KEY FIELDS BACK 08875099
089600*  TO THE DEFAULTS. EDIT THE SCREEN FIELDS. PAGE BACKWARD FOR PF7,08876099
089700*  FORWARD FOR PF8.                                               08877099
089800******************************************************************08878099
088800 3000-EDIT-INPUT-FIELDS.                                          08880000
                                                                        08881099
088900     MOVE '*3000-EDIT-INPUT-FIELDS.         *' TO DP013-PARAGRAPH 08890000
089000                                                                  08900000
089900                                                                  08990000
090000     PERFORM 3100-DETERMINE-USER-LEVEL.                           09000000
090100                                                                  09010000
090200     PERFORM 3200-FILL-COMMAREA.                                  09020000
090300                                                                  09030000
090400     PERFORM 3300-EDIT-SCREEN-FIELDS.                             09040000
090500                                                                  09050000
090600* IF THERE WERE NO EDIT ERRORS, THEN TRANSFER CONTROL TO NEXT     09060000
090700* PROGRAM WHICH WILL ACTUALLY DISPLAY THE SALES FIGURES.          09070000
090800* IF THE REQUEST IS AT A MAJOR CLASS OR DEPARTMENT LEVEL, THE USER09080000
090900* MUST HIT PF15 TO CONFIRM THE REQUEST (IF RACF AUTH. EXISTS      09090000
091000* FOR THIS USER TO EXECUTE THE F901 TRANSACTION)                  09100000
091100                                                                  09110000
091200     IF PS-NO-EDIT-ERROR                                          09120032
091300         IF  PS-VALID-MINOR-CLASS                                 09130047
091400             IF DP020-SRC-AID = DP016-PF15                        09140047
091500                SET PS-EDIT-ERROR     TO TRUE                     09150047
091600                MOVE PC-TSYMSG-00616  TO DP020-MSG-NUMBER         09160047
091700                SET DP020-MSG-WARNING TO TRUE                     09170047
091800                MOVE -1               TO DEPTL                    09180038
091900             END-IF                                               09190038
092000          ELSE                                                    09200038
092100             IF DP020-SRC-AID =  DP016-PF15                       09210032
092200                IF NOT CA-F901-REQUEST                            09220038
092300                   SET CA-F901-REQUEST   TO TRUE                  09230036
092400                   SET PS-EDIT-ERROR     TO TRUE                  09240032
092500                   MOVE PC-TSYMSG-00615  TO DP020-MSG-NUMBER      09250032
092600                   SET DP020-MSG-WARNING TO TRUE                  09260032
092700                   MOVE -1               TO DEPTL                 09270032
092800                ELSE                                              09280038
092900                   PERFORM 3050-SEND-IN-PROCESS-MAP               09290032
093000                END-IF                                            09300038
093100             ELSE                                                 09310032
093200                 SET CA-NO-REQUEST TO TRUE                        09320032
093300                 IF DP020-SRC-AID =  DP016-PF14                   09330032
093400                     SET PS-EDIT-ERROR   TO TRUE                  09340032
093500                     MOVE PC-TSYMSG-00617 TO DP020-MSG-NUMBER     09350032
093600                     SET DP020-MSG-WARNING                        09360032
093700                                         TO TRUE                  09370032
093800                     MOVE -1             TO DEPTL                 09380032
093900                 END-IF                                           09390032
094000             END-IF                                               09400032
094100         END-IF                                                   09410032
094200     ELSE                                                         09420037
094300        IF DP020-SRC-AID =  DP016-PF15                            09430037
094400           CONTINUE                                               09440037
094500        ELSE                                                      09450037
094600*-->       WHEN NOT PF15 & NO EDIT ERROR - RESET WARNING REQ MSG  09460039
094700           SET CA-NO-REQUEST TO TRUE                              09470037
094800        END-IF                                                    09480037
094900     END-IF.                                                      09490037
095000                                                                  09500037
095100 3050-SEND-IN-PROCESS-MAP.                                        09510037
095200     MOVE '*3050-SEND-IN-PROCESS-MAP *' TO DP013-PARAGRAPH.       09520037
095300                                                                  09530037
095400     MOVE LOW-VALUES   TO FSX34AI.                                09540037
095500                                                                  09550037
095600     MOVE DP015-BLINK  TO WAITMSGH.                               09560037
095700     MOVE DP015-YELLOW TO WAITMSGC.                               09570037
095800                                                                  09580037
095900     EXEC CICS                                                    09590037
096000         SEND                                                     09600037
096100             MAP    ('FSX34A')                                    09610037
096200             MAPSET ('FSKM034')                                   09620037
096500             RESP   (PV-CICS-RESPONSE)                            09650037
096600     END-EXEC.                                                    09660037
096700                                                                  09670037
096800     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    09680037
096900         PERFORM 9920-CICS-ERROR                                  09690037
097000     END-IF.                                                      09700037
097100                                                                  09710037
097200     EXEC CICS                                                    09720037
097300         SEND PAGE                                                09730037
097400             RETAIN                                               09740037
097500             AUTOPAGE                                             09750037
097600             RESP(PV-CICS-RESPONSE)                               09760037
097700     END-EXEC.                                                    09770037
097800                                                                  09780037
097900     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    09790037
098000         PERFORM 9920-CICS-ERROR                                  09800037
098100     END-IF.                                                      09810037
098200                                                                  09820037
098300     EXEC CICS                                                    09830037
098400         SYNCPOINT                                                09840037
098500     END-EXEC.                                                    09850037
098600                                                                  09860037
099000******************************************************************09871099
099100*  IF THE USER IS AUTHORIZED FOR TRANSACTION F900, THIS MEANS    *09872099
099200*  THAT HE CAN DO DEPARTMENT LEVEL INQUIRIES, OTHERWISE THEY     *09873099
099300*  ARE LIMITED TO ONLY FULLY QUALIFIED DEPARTMENT/MINOR CLASS    *09874099
099400*  QUERIES                                                       *09875099
099500******************************************************************09876099
098800 3100-DETERMINE-USER-LEVEL.                                       09880037
                                                                        09881099
098900     MOVE '*3100-DETERMINE-USER-LEVEL.      *' TO DP013-PARAGRAPH 09890037
099600     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     09960037
099700     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     09970037
099800     MOVE PC-DEPT-AUTH-TRAN          TO DP008-RESOURCE-NAME.      09980037
099900                                                                  09990037
100000     EXEC CICS                                                    10000037
100100          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               10010000
100200               COMMAREA (DP008-SECURITY-COMMAREA)                 10020000
100300               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          10030000
100400               RESP     (PV-CICS-RESPONSE)                        10040000
100500     END-EXEC.                                                    10050000
100600                                                                  10060000
100700     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       10070000
100800         IF  DP008-CALL-SUCCESSFUL                                10080000
100900             IF  DP008-ACCESS-ALLOWED                             10090000
101000                 SET PS-DEPARTMENT-AUTH                           10100000
101100                                     TO TRUE                      10110000
101200             ELSE                                                 10120000
101300                 SET PS-MINOR-CLASS-AUTH                          10130000
101400                                     TO TRUE                      10140000
101500             END-IF                                               10150000
101600         ELSE                                                     10160000
101700             MOVE DP008-ERROR-CODE   TO PM-CM-RETURN-CODE         10170000
101800             MOVE PM-CICSAUTH-MESSAGE                             10180000
101900                                     TO DP013-MESSAGE-TEXT(1)     10190000
102000             PERFORM 9920-CICS-ERROR                              10200000
102100         END-IF                                                   10210000
102200     ELSE                                                         10220000
102300         MOVE 'CALL RACF SECURITY PROGRAM'                        10230000
102400                                     TO DP013-MESSAGE-TEXT(1)     10240000
102500         PERFORM 9920-CICS-ERROR                                  10250000
102600     END-IF.                                                      10260000
102700                                                                  10270099
103000******************************************************************10271099
103100*  MOVE MAP FIELDS TO THE COMMUNICATIONS AREA.                   *10272099
103200******************************************************************10273099
102800 3200-FILL-COMMAREA.                                              10280000
                                                                        10281099
102900     MOVE '*3200-FILL-COMMAREA.             *' TO DP013-PARAGRAPH 10290000
103300* DEPARTMENT NUMBER                                               10330000
103400     IF  DEPTL > ZERO                                             10340000
103500         MOVE DEPTI                  TO CA-DEPT-NUMBER-X          10350000
MC0502         MOVE CA-DEPT-NUMBER-9       TO NI-DEPT-9-4               10351099
103600         INITIALIZE CA-DEPT-NAME                                  10360000
103700                    DPTDSCO                                       10370000
103800     ELSE                                                         10380000
103900         IF  DEPTA = DP015-ERASE-EOF                              10390000
104000             INITIALIZE CA-DEPT-NUMBER-X                          10400000
104100                        CA-DEPT-NAME                              10410000
104200                        DPTDSCO                                   10420000
104300         END-IF                                                   10430000
104400     END-IF.                                                      10440000
104500                                                                  10450000
104600* CLASS NUMBER                                                    10460000
104700     IF  CLASSL > ZERO                                            10470000
104800         MOVE CLASSI                 TO CA-CLASS-NUMBER-X         10480000
MC0502         MOVE CA-CLASS-NUMBER-9      TO NI-CLASS-9-4              10481099
104900         INITIALIZE CA-CLASS-DESCRIPTION                          10490000
104900                    CLSDSCO                                       10491099
105000     ELSE                                                         10500000
105100         IF  (CLASSA = DP015-ERASE-EOF OR CLASSI = SPACES)        10510000
105200             INITIALIZE CA-CLASS-NUMBER-X                         10520000
105300                        CA-CLASS-DESCRIPTION                      10530000
104900                        CLSDSCO                                   10531099
105400         END-IF                                                   10540000
105500     END-IF.                                                      10550000
105600                                                                  10560078
105700* MOVE CLASS VALUES FOR CHECKING VALID LONG COLOR.                10570078
105800                                                                  10580079
105900     IF (CA-MAJOR-CLASS > SPACES                                  10590078
106000            AND                                                   10600078
106100        CA-MINOR-CLASS > SPACES)                                  10610078
106200         MOVE CA-CLASS-NUMBER-X  TO PV-CLASS-LOW                  10620079
106300                                    PV-CLASS-HIGH                 10630079
MC0502         MOVE CA-CLASS-NUMBER-9  TO PV-CLASS-LOW-C3               10631099
MC0502                                    PV-CLASS-HIGH-C3              10632099
106400     ELSE                                                         10640078
106500         IF CA-MAJOR-CLASS > SPACES                               10650078
106600             MOVE CA-MAJOR-CLASS TO PV-CLASS-LOW                  10660078
106700                                    PV-CLASS-HIGH                 10670078
MC0502             MOVE PV-MAJOR-CLASS-9 TO PV-CLASS-LOW-C3             10671099
MC0502                                      PV-CLASS-HIGH-C3            10672099
106800             MOVE PC-LITERAL-0   TO PV-CLASS-LOW-POS-2            10680079
106900             MOVE PC-LITERAL-9   TO PV-CLASS-HIGH-POS-2           10690079
107000         ELSE                                                     10700078
107100             MOVE LOW-VALUES     TO PV-CLASS-LOW                  10710079
MC0502             MOVE HIGH-VALUES    TO PV-CLASS-HIGH                 10711099
107200             MOVE ZEROES         TO PV-CLASS-LOW-C3               10720099
MC0502             MOVE 999            TO PV-CLASS-HIGH-C3              10721099
107300         END-IF                                                   10730078
107400     END-IF.                                                      10740078
107500                                                                  10750078
107600                                                                  10760078
107700* SKU NUMBER                                                      10770000
107800     IF  SKUL > ZERO                                              10780000
MC0502         MOVE SKUI                   TO CA-SKU-NUMBER-X           10790099
MC0502         MOVE CA-SKU-NUMBER-9        TO NI-SKU-9-8                10791099
108000         MOVE SPACES                 TO CA-TSK-GP-QTY-RTL         10800099
108100         INITIALIZE CA-SKU-DESCRIPTION                            10810000
108200                    CA-TSK-SIZE                                   10820099
108300                    CA-TSK-COLOR                                  10830000
108400                    CA-TSK-ORG-RTL                                10840000
108500                    CA-TSK-CUR-RTL                                10850000
108600                    CA-TSK-COST                                   10860000
108700                    SKUDSCO                                       10870000
108800     ELSE                                                         10880000
108900         IF  (SKUA = DP015-ERASE-EOF OR SKUI = SPACES)            10890000
109000             MOVE SPACES             TO CA-TSK-GP-QTY-RTL         10900000
MC0502             INITIALIZE CA-SKU-NUMBER-X                           10910099
109200                        CA-SKU-DESCRIPTION                        10920000
109300                        CA-TSK-SIZE                               10930000
109400                        CA-TSK-COLOR                              10940000
109500                        CA-TSK-ORG-RTL                            10950000
109600                        CA-TSK-CUR-RTL                            10960000
109700                        CA-TSK-COST                               10970000
109800                        SKUDSCO                                   10980000
109900         END-IF                                                   10990000
110000     END-IF.                                                      11000000
110000                                                                  11000199
107700* UPC                                                             11001099
107800     IF  UPCL > ZERO                                              11002099
MC0502         MOVE UPCI                   TO CA-UPC-NUMBER-X           11003099
108800     ELSE                                                         11009499
108900         IF  UPCF = DP015-ERASE-EOF                               11009599
108900             MOVE SPACE            TO CA-UPC-NUMBER-X             11009699
109900         END-IF                                                   11010599
110000     END-IF.                                                      11010699
110100                                                                  11011000
110200* GROUP CODE                                                      11020000
110300     IF  GROUPL > ZERO                                            11030000
110400         MOVE GROUPI                 TO CA-GROUP-CODE             11040000
110500     ELSE                                                         11050000
110600         IF  (GROUPA = DP015-ERASE-EOF OR GROUPI = SPACES)        11060000
110700             INITIALIZE CA-GROUP-CODE                             11070000
110800         END-IF                                                   11080000
110900     END-IF.                                                      11090000
111000                                                                  11100000
111100* CHECK VENDOR NUMBER AND VENDOR NAME. BOTH CANNOT BE ENTERED.    11110000
111200* IF THEY ARE THEY WILL BE ERRORED OUT SO DO NOT INIT FIELDS.     11120000
111300                                                                  11130000
111400                                                                  11140000
111500* VENDOR NUMBER                                                   11150000
111600     IF  VENNOL > ZERO                                            11160000
111700         MOVE VENNOI                 TO CA-INHOUSE-NUMBER         11170000
111800         SET CA-VENDOR-NUMBER-ENTERED TO TRUE                     11180000
111900         IF VENNML = ZERO                                         11190000
112000           INITIALIZE CA-VENDOR-NAME                              11200000
112100                      VENNMO                                      11210000
112200         END-IF                                                   11220000
112300     ELSE                                                         11230000
112400         IF  (VENNOA = DP015-ERASE-EOF OR VENNOI = SPACES)        11240000
112500             INITIALIZE CA-INHOUSE-NUMBER                         11250000
112600         END-IF                                                   11260000
112700     END-IF.                                                      11270000
112800                                                                  11280000
112900* VENDOR NAME                                                     11290000
113000*    IF  VENNML > ZERO                                            11300099
           IF VENNMI > SPACES                                           11301099
113100         SET CA-VENDOR-NAME-ENTERED TO TRUE                       11310000
113200         MOVE VENNMI                TO CA-VENDOR-NAME             11320091
113300         IF VENNOL = ZERO                                         11330000
113400           INITIALIZE CA-INHOUSE-NUMBER                           11340000
113500                      VENNOO                                      11350000
113600           END-IF                                                 11360000
113700     ELSE                                                         11370000
113800         IF  (VENNMA = DP015-ERASE-EOF OR VENNMI = SPACES)        11380000
113900             INITIALIZE CA-VENDOR-NAME                            11390000
114000         END-IF                                                   11400000
114100     END-IF.                                                      11410000
114200                                                                  11420000
114300* STYLE                                                           11430000
114400     IF  STYLEL > ZERO                                            11440000
114500         MOVE STYLEI                 TO CA-STYLE                  11450000
114600     ELSE                                                         11460000
114700         IF  (STYLEA = DP015-ERASE-EOF OR STYLEI = SPACES)        11470000
114800             INITIALIZE CA-STYLE                                  11480000
114900         END-IF                                                   11490000
115000     END-IF.                                                      11500000
116200                                                                  11620000
116300* DISTRICT                                                        11630047
116400     IF  DISTL > ZERO                                             11640047
116500         MOVE DISTI                  TO CA-DISTRICT-NUMBER        11650047
116600         INITIALIZE CA-DISTRICT-NAME                              11660047
116700     ELSE                                                         11670047
116800         IF  (DISTA = DP015-ERASE-EOF OR DISTI = SPACES)          11680047
116900             INITIALIZE CA-DISTRICT-NUMBER                        11690047
117000                        CA-DISTRICT-NAME                          11700047
117100         END-IF                                                   11710047
117200     END-IF.                                                      11720047
117300                                                                  11730047
117400* STORE NUMBER                                                    11740000
117500     IF  STOREL > ZERO                                            11750000
117600         MOVE STOREI                 TO CA-STORE-NUMBER-X         11760000
117700         INITIALIZE CA-STORE-NAME                                 11770000
117800                    STRDSCO                                       11780000
117900     ELSE                                                         11790000
118000         IF  CA-STORE-NUMBER-X  = SPACES AND                      11800099
118100             CA-DISTRICT-NUMBER = SPACES                          11810099
118300             MOVE PC-STORE-ZERO-LITERAL  TO CA-STORE-NUMBER-X     11830099
118400             MOVE PC-CORPORATE-LITERAL   TO CA-STORE-NAME         11840099
118500                                            STRDSCO               11850099
118600        ELSE                                                      11860099
118700            IF  (STOREA = DP015-ERASE-EOF OR STOREI = SPACES)     11870099
118800                INITIALIZE CA-STORE-NUMBER-X                      11880099
118900                           CA-STORE-NAME                          11890099
119000                           STRDSCO                                11900099
119100            END-IF                                                11910099
119200         END-IF                                                   11920099
119300     END-IF.                                                      11930000
119400                                                                  11940000
119500* REPLENISHMENT INDICATOR                                         11950071
119600     IF  REPLENL > ZERO                                           11960071
119700         MOVE REPLENI                TO CA-VSM-REPLENISH          11970071
119800     ELSE                                                         11980000
119900         IF  (REPLENA = DP015-ERASE-EOF OR REPLENI = SPACES)      11990071
120000             INITIALIZE CA-VSM-REPLENISH                          12000071
120100                        REPLENO                                   12010071
120200         END-IF                                                   12020000
120300     END-IF.                                                      12030000
120400                                                                  12040000
120500* KEY ITEM INDICATOR                                              12050071
120600     IF  KYITML > ZERO                                            12060071
120700         MOVE KYITMI                 TO CA-KEY-ITEM               12070071
120800     ELSE                                                         12080071
120900         IF  (KYITMA = DP015-ERASE-EOF OR KYITMI = SPACES)        12090071
121000             INITIALIZE CA-KEY-ITEM                               12100071
121100                        KYITMO                                    12110071
121200         END-IF                                                   12120071
121300     END-IF.                                                      12130071
121400                                                                  12140071
121500* SIZE                                                            12150000
121600     IF  (SIZEA = DP015-ERASE-EOF OR SIZEI = SPACES)              12160000
121700             INITIALIZE CA-SIZE-DESC                              12170000
121800                        CA-SIZE-CDE                               12180000
121900                        SIZEO                                     12190000
122000     ELSE                                                         12200000
122100         IF  SIZEL > ZERO                                         12210000
122200             MOVE SIZEI        TO CA-SIZE-DESC                    12220000
122300         END-IF                                                   12230000
122400     END-IF.                                                      12240000
122500                                                                  12250000
122600* LONG COLOR                                                      12260094
122700     IF  COLDSCL > ZERO                                           12270056
122800         MOVE COLDSCI               TO CA-TSK-LONG-COLOR          12280063
122900     ELSE                                                         12290056
123000         IF  (COLDSCA = DP015-ERASE-EOF OR COLDSCI = SPACES)      12300056
123100             MOVE SPACES TO CA-TSK-LONG-COLOR                     12310063
123200                            COLDSCO                               12320056
123300         END-IF                                                   12330056
123400     END-IF.                                                      12340056
123500                                                                  12350056
123600* COLOR1                                                          12360056
123700     IF  COLOR1L > ZERO                                           12370000
123800         MOVE COLOR1I               TO CA-COLOR-1-X               12380000
123900     ELSE                                                         12390000
124000         IF  (COLOR1A = DP015-ERASE-EOF OR COLOR1I = SPACES)      12400000
124100             MOVE SPACES TO CA-COLOR-1-X                          12410000
124200                            COLOR1O                               12420000
124300         END-IF                                                   12430000
124400     END-IF.                                                      12440000
124500                                                                  12450000
124600* COLOR2                                                          12460000
124700     IF  COLOR2L > ZERO                                           12470000
124800         MOVE COLOR2I               TO CA-COLOR-2-X               12480000
124900     ELSE                                                         12490000
125000         IF  (COLOR2A = DP015-ERASE-EOF OR COLOR2I = SPACES)      12500000
125100             MOVE SPACES TO  CA-COLOR-2-X                         12510000
125200                             COLOR2O                              12520000
125300         END-IF                                                   12530000
125400     END-IF.                                                      12540000
125500                                                                  12550000
127300                                                                  12730000
127400* STATUS CODE A - 10                                              12740000
127500     IF  STATAL > ZERO                                            12750000
127600         MOVE STATAI                 TO CA-STAT-10                12760000
127700     ELSE                                                         12770000
127800         IF  (STATAA = DP015-ERASE-EOF                            12780000
127900                       OR                                         12790000
128000             STATAI = SPACES)                                     12800000
128100             INITIALIZE CA-STAT-10                                12810000
128200         END-IF                                                   12820000
128300     END-IF.                                                      12830000
128400                                                                  12840000
128500* STATUS CODE B - 30                                              12850000
128600     IF  STATBL > ZERO                                            12860000
128700         MOVE STATBI                 TO CA-STAT-40                12870000
128800     ELSE                                                         12880000
128900         IF  (STATBA = DP015-ERASE-EOF                            12890000
129000                       OR                                         12900000
129100             STATBI = SPACES)                                     12910000
129200             INITIALIZE CA-STAT-40                                12920000
129300         END-IF                                                   12930000
129400     END-IF.                                                      12940000
129500                                                                  12950000
129600* STATUS CODE C - 20                                              12960099
129700     IF  STATCL > ZERO                                            12970000
129800         MOVE STATCI                 TO CA-STAT-20                12980000
129900     ELSE                                                         12990000
130000         IF  (STATCA = DP015-ERASE-EOF                            13000000
130100                       OR                                         13010000
130200             STATCI = SPACES)                                     13020000
130300             INITIALIZE CA-STAT-20                                13030000
130400         END-IF                                                   13040000
130500     END-IF.                                                      13050000
130600                                                                  13060000
130700* STATUS CODE D - 90                                              13070000
130800     IF  STATDL > ZERO                                            13080000
130900         MOVE STATDI                 TO CA-STAT-90                13090000
131000     ELSE                                                         13100000
131100         IF  (STATDA = DP015-ERASE-EOF                            13110000
131200                       OR                                         13120000
131300             STATDI = SPACES)                                     13130000
131400             INITIALIZE CA-STAT-90                                13140000
131500         END-IF                                                   13150000
131600     END-IF.                                                      13160000
131700                                                                  13170000
131800* STATUS CODE E - 30                                              13180000
131900     IF  STATEL > ZERO                                            13190000
132000         MOVE STATEI                 TO CA-STAT-30                13200000
132100     ELSE                                                         13210000
132200         IF  (STATEA = DP015-ERASE-EOF                            13220000
132300                       OR                                         13230000
132400             STATEI = SPACES)                                     13240000
132500             INITIALIZE CA-STAT-30                                13250000
132600         END-IF                                                   13260000
132700     END-IF.                                                      13270000
132800                                                                  13280000
131800* STATUS CODE F - 25                                              13281099
131900     IF  STATFL > ZERO                                            13282099
132000         MOVE STATFI                 TO CA-STAT-25                13283099
132100     ELSE                                                         13284099
132200         IF  (STATFA = DP015-ERASE-EOF                            13285099
132300                       OR                                         13286099
132400             STATFI = SPACES)                                     13287099
132500             INITIALIZE CA-STAT-25                                13288099
132600         END-IF                                                   13289099
132700     END-IF.                                                      13289199
132800                                                                  13289299
132900                                                                  13290000
133000* IF NO STATUS CODES WERE ENTERED, THE PROGRAM WILL DEFAULT TO    13300000
133100* STATUS CODE '20'.                                               13310000
133200     IF  CA-STAT-10 = SPACES                                      13320000
133300     AND CA-STAT-20 = SPACES                                      13330000
133400     AND CA-STAT-25 = SPACES                                      13340099
133400     AND CA-STAT-30 = SPACES                                      13341099
133500     AND CA-STAT-40 = SPACES                                      13350000
133600     AND CA-STAT-90 = SPACES                                      13360000
133700         SET CA-STAT-20-ENTERED      TO TRUE                      13370000
133800         MOVE CA-STAT-20             TO STATCI                    13380000
133900     END-IF.                                                      13390000
134100                                                                  13410099
134500******************************************************************13411099
134600*  SET THE ATTRIBUTES FOR ALL ENTERABLE KEY SCREEN FIELDS BACK TO*13412099
134700*  THEIR MAP DEFAULTS.                                           *13413099
134800******************************************************************13414099
134200 3300-EDIT-SCREEN-FIELDS.                                         13420000
                                                                        13421099
134300     MOVE '*3300-EDIT-SCREEN-FIELDS.        *' TO DP013-PARAGRAPH 13430000
134400                                                                  13440000
134900* DEPARTMENT                                                      13490000
135000     MOVE DP015-UNDERLINE            TO DEPTH.                    13500000
135100     MOVE DP015-GREEN                TO DEPTC.                    13510000
135200     MOVE DP015-UNP-NUM-NOR-OFF      TO DEPTA.                    13520000
135300                                                                  13530000
135400* DEPARTMENT DESCRIPTION                                          13540000
135500     MOVE DP015-HL-OFF               TO DPTDSCH.                  13550000
135600     MOVE DP015-BLUE                 TO DPTDSCC.                  13560000
135700     MOVE DP015-ASK-NOR-OFF          TO DPTDSCA.                  13570000
135800                                                                  13580000
135900* CLASS                                                           13590000
136000     MOVE DP015-UNDERLINE            TO CLASSH.                   13600000
136100     MOVE DP015-GREEN                TO CLASSC.                   13610000
136200     MOVE DP015-UNP-ALP-NOR-OFF      TO CLASSA.                   13620000
136300                                                                  13630000
135400* CLASS DESCRIPTION                                               13631099
135500     MOVE DP015-HL-OFF               TO CLSDSCH.                  13632099
135600     MOVE DP015-BLUE                 TO CLSDSCC.                  13633099
135700     MOVE DP015-ASK-NOR-OFF          TO CLSDSCA.                  13634099
136300                                                                  13635099
136400* SKU                                                             13640000
136500     MOVE DP015-UNDERLINE            TO SKUH.                     13650000
136600     MOVE DP015-GREEN                TO SKUC.                     13660000
136700     MOVE DP015-UNP-ALP-NOR-OFF      TO SKUA.                     13670000
136800                                                                  13680000
136900* SKU DESCRIPTION                                                 13690000
137000     MOVE DP015-HL-OFF               TO SKUDSCH                   13700000
137100     MOVE DP015-BLUE                 TO SKUDSCC.                  13710000
137200     MOVE DP015-ASK-NOR-OFF          TO SKUDSCA.                  13720000
136300                                                                  13721099
136400* UPC                                                             13722099
136500     MOVE DP015-UNDERLINE            TO UPCH.                     13723099
136600     MOVE DP015-GREEN                TO UPCC.                     13724099
136700     MOVE DP015-UNP-ALP-NOR-OFF      TO UPCA.                     13725099
137300                                                                  13730000
137400* GROUP                                                           13740000
137500     MOVE DP015-UNDERLINE            TO GROUPH.                   13750000
137600     MOVE DP015-GREEN                TO GROUPC.                   13760000
137700     MOVE DP015-UNP-ALP-NOR-OFF      TO GROUPA.                   13770000
137800                                                                  13780000
137900* VENDOR NUMBER                                                   13790000
138000     MOVE DP015-UNDERLINE            TO VENNOH.                   13800000
138100     MOVE DP015-GREEN                TO VENNOC.                   13810000
138200     MOVE DP015-UNP-ALP-NOR-OFF      TO VENNOA.                   13820000
138300                                                                  13830000
138400* VENDOR NAME                                                     13840000
138500     MOVE DP015-UNDERLINE            TO VENNMH.                   13850000
138600     MOVE DP015-GREEN                TO VENNMC.                   13860000
138700     MOVE DP015-UNP-ALP-NOR-OFF      TO VENNMA.                   13870000
138800                                                                  13880000
138900* STYLE                                                           13890000
139000     MOVE DP015-UNDERLINE            TO STYLEH.                   13900000
139100     MOVE DP015-GREEN                TO STYLEC.                   13910000
139200     MOVE DP015-UNP-ALP-NOR-OFF      TO STYLEA.                   13920000
139800                                                                  13980047
139900* DISTRICT                                                        13990047
W27494*    MOVE DP015-UNDERLINE            TO DISTH.                    14000099
W27494*    MOVE DP015-GREEN                TO DISTC.                    14010099
W27494*    MOVE DP015-UNP-ALP-NOR-OFF      TO DISTA.                    14020099
140300                                                                  14030000
140400* STORE NUMBER                                                    14040000
140500     MOVE DP015-UNDERLINE            TO STOREH.                   14050000
140600     MOVE DP015-GREEN                TO STOREC.                   14060000
140700     MOVE DP015-UNP-ALP-NOR-OFF      TO STOREA.                   14070000
140800                                                                  14080000
140900* REPLENISHMENT INDICATOR                                         14090071
141000     MOVE DP015-UNDERLINE            TO REPLENH.                  14100071
141100     MOVE DP015-GREEN                TO REPLENC.                  14110071
141200     MOVE DP015-UNP-ALP-NOR-OFF      TO REPLENA.                  14120071
141300                                                                  14130000
141400* KEY ITEM INDICATOR                                              14140071
141500     MOVE DP015-UNDERLINE            TO KYITMH.                   14150071
141600     MOVE DP015-GREEN                TO KYITMC.                   14160071
141700     MOVE DP015-UNP-ALP-NOR-OFF      TO KYITMA.                   14170071
141800                                                                  14180071
141900* LONG COLOR                                                      14190094
142000     MOVE DP015-UNDERLINE            TO COLDSCH.                  14200056
142100     MOVE DP015-GREEN                TO COLDSCC.                  14210056
142200     MOVE DP015-UNP-ALP-NOR-OFF      TO COLDSCA.                  14220056
142300                                                                  14230056
142400* COLOR-1                                                         14240000
142500     MOVE DP015-UNDERLINE            TO COLOR1H.                  14250000
142600     MOVE DP015-GREEN                TO COLOR1C.                  14260000
142700     MOVE DP015-UNP-ALP-NOR-OFF      TO COLOR1A.                  14270000
142800                                                                  14280000
142900* COLOR-2                                                         14290000
143000     MOVE DP015-UNDERLINE            TO COLOR2H.                  14300000
143100     MOVE DP015-GREEN                TO COLOR2C.                  14310000
143200     MOVE DP015-UNP-ALP-NOR-OFF      TO COLOR2A.                  14320000
143300                                                                  14330000
143400* SIZE                                                            14340000
143500     MOVE DP015-UNDERLINE            TO SIZEH.                    14350000
143600     MOVE DP015-GREEN                TO SIZEC.                    14360000
143700     MOVE DP015-UNP-ALP-NOR-OFF      TO SIZEA.                    14370000
143800                                                                  14380000
143900* STORE NAME                                                      14390000
144000     MOVE DP015-HL-OFF               TO STRDSCH.                  14400000
144100     MOVE DP015-BLUE                 TO STRDSCC.                  14410000
144200     MOVE DP015-ASK-NOR-OFF          TO STRDSCA.                  14420000
145300                                                                  14530000
145400* STATUS CODE A                                                   14540000
145500     MOVE DP015-UNDERLINE            TO STATAH.                   14550000
145600     MOVE DP015-GREEN                TO STATAC.                   14560000
145700     MOVE DP015-UNP-ALP-NOR-OFF      TO STATAA.                   14570000
145800                                                                  14580000
145900* STATUS CODE B                                                   14590000
146000     MOVE DP015-UNDERLINE            TO STATBH.                   14600000
146100     MOVE DP015-GREEN                TO STATBC.                   14610000
146200     MOVE DP015-UNP-ALP-NOR-OFF      TO STATBA.                   14620000
146300                                                                  14630000
146400* STATUS CODE C                                                   14640000
146500     MOVE DP015-UNDERLINE            TO STATCH.                   14650000
146600     MOVE DP015-GREEN                TO STATCC.                   14660000
146700     MOVE DP015-UNP-ALP-NOR-OFF      TO STATCA.                   14670000
146800                                                                  14680000
146900* STATUS CODE D                                                   14690000
147000     MOVE DP015-UNDERLINE            TO STATDH.                   14700000
147100     MOVE DP015-GREEN                TO STATDC.                   14710000
147200     MOVE DP015-UNP-ALP-NOR-OFF      TO STATDA.                   14720000
147300                                                                  14730000
147400* STATUS CODE E                                                   14740000
147500     MOVE DP015-UNDERLINE            TO STATEH.                   14750000
147600     MOVE DP015-GREEN                TO STATEC.                   14760000
147700     MOVE DP015-UNP-ALP-NOR-OFF      TO STATEA.                   14770000
147800                                                                  14780000
147400* STATUS CODE F                                                   14781099
147500     MOVE DP015-UNDERLINE            TO STATFH.                   14782099
147600     MOVE DP015-GREEN                TO STATFC.                   14783099
147700     MOVE DP015-UNP-ALP-NOR-OFF      TO STATFA.                   14784099
147800                                                                  14785099
147900******************************************************************14790000
148000*  EDIT SCREEN FIELDS.  IF ERRORS ARE DETECTED, USE REVERSE      *14800000
148100*  VIDEO, RED, AND HIGH INTENSITY TO INDICATE THE ERRORS, AND    *14810000
148200*  POSITION THE CURSOR AT THE FIRST ERROR ENCOUNTERED,           *14820000
148300*  DISPLAYING AN ASSOCIATED ERROR MESSAGE AT THE BOTTOM OF THE   *14830000
148400*  SCREEN.                                                        14840000
148500******************************************************************14850000
148600                                                                  14860000
148700     SET PS-NO-EDIT-ERROR            TO TRUE.                     14870000
148800     SET PS-DEPT-NOT-NUMERIC         TO TRUE.                     14880000
148900     SET PS-VENDOR-NOT-NUMERIC       TO TRUE.                     14890000
149000     SET PS-DISTRICT-NOT-NUMERIC     TO TRUE.                     14900041
149100     SET PS-STORE-NOT-NUMERIC        TO TRUE.                     14910000
149200                                                                  14920000
MC0502***************************************************************** 14921099
MC0502*    THIS SECTION ADDED FOR NON-INTELLEGENT SKU                   14921199
MC0502*    DEPT AND CLASS ARE NOW OPTIONAL ENTRY FIELDS                 14921299
MC0502* IF ONLY SKU HAS BEEN ENTERED, VALIDATE THE SKU, RETRIEVE        14922099
MC0502* THE DEPT AND CLASS, AND CONTINUE PROCESSING THIS PARAGRAPH      14923099
MC0502***************************************************************** 14924099
MC0502*    NOW CAN ALSO ENTER JUST UPC.  IF UPC IS ENTERED,             14924199
MC0502*    VALIDATE THE THE UPC, RETRIEVE THE DEPT AND CLASS AND SKU,   14924299
MC0502*    AND CONTINUE PROCESSING THIS PARAGRAPH                       14924399
MC0502***************************************************************** 14924499
MC0502                                                                  14925099
MC0502     IF CA-UPC-NUMBER-X > SPACES                                  14925199
MC0502         PERFORM 33180-VALIDATE-UPC-NBR                           14925399
MC0502     END-IF.                                                      14925499
MC0502                                                                  14925599
MC0502     IF CA-SKU-NUMBER-X > SPACES                                  14926099
MC0502         MOVE CA-SKU-NUMBER-9 TO NI-SKU-9-8                       14927099
MC0502         PERFORM 33155-VALIDATE-SKU                               14929099
MC0502     END-IF.                                                      14929199
MC0502* DEPARTMENT NUMBER MUST BE NUMERIC IF ENTERED                    14930099
MC0502     IF CA-DEPT-NUMBER-X > SPACES                                 14931099
149400        MOVE CA-DEPT-NUMBER-X        TO DP010I-UNEDITED-FIELD     14940099
149500        MOVE 3                       TO DP010I-MAXIMUM-DIGITS     14950099
149600        MOVE 0                       TO DP010I-MAXIMUM-DECIMALS   14960099
149700        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   14970099
272945        CALL DP010I-NUMERIC-EDIT-ROUTINE                          14981099
272945                        USING DP010I-NUMERIC-EDIT-AREA            14982099
149900                                                                  14990000
150000        IF  (DP010I-ERROR-DETECTED                                15000099
150100             OR DP010I-NUMERIC-FIELD = ZERO)                      15010000
150200           MOVE DP015-REVERSE          TO DEPTH                   15020099
150300           MOVE DP015-RED              TO DEPTC                   15030099
150400           MOVE DP015-UNP-NUM-BRT-OFF  TO DEPTA                   15040099
150500           IF  NOT PS-EDIT-ERROR                                  15050099
150600               SET PS-EDIT-ERROR       TO TRUE                    15060099
150700               MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER        15070099
150800               MOVE -1                 TO DEPTL                   15080099
150900           END-IF                                                 15090099
151000        ELSE                                                      15100099
151100           SET PS-DEPT-NUMERIC         TO TRUE                    15110099
151200           MOVE DP010I-NUMERIC-FIELD   TO CA-DEPT-NUMBER-9        15120099
151300           MOVE CA-DEPT-NUMBER-X       TO DEPTI                   15130099
151400        END-IF                                                    15140099
MC0502     END-IF.                                                      15141099
151500                                                                  15150000
151600* CLASS                                                           15160000
151700* 1 DIGIT NUMBER MUST BE ENTERED WHICH MUST BE GREATER THAN ZERO. 15170000
151800* IF ONLY 1 DIGIT IS ENTERED, THE PROGRAM WILL ASSUME THAT IT IS  15180000
151900* TO BE THE MAJOR CLASS REGARDLESS OF WHICH BYTE IT WAS ENTERED IN15190000
152000* AND WILL REPOSITION IT ON OUTPUT.                               15200000
152100         SET PS-NO-VALID-MAJOR-CLASS     TO TRUE.                 15210099
152200         SET PS-MAJOR-CLASS-NOT-BLANK    TO TRUE.                 15220099
152300         SET PS-NO-VALID-MINOR-CLASS     TO TRUE.                 15230099
152400         SET PS-MINOR-CLASS-NOT-BLANK    TO TRUE.                 15240099
152500                                                                  15250000
152600                                                                  15260000
152700         IF  (CA-MAJOR-CLASS = SPACES)                            15270099
152800            SET PS-MAJOR-CLASS-BLANK    TO TRUE                   15280099
152900         ELSE                                                     15290099
                  IF (CA-DEPT-NUMBER-X > SPACES)                        15291099
                     MOVE CA-MAJOR-CLASS   TO DP010I-UNEDITED-FIELD     15300099
                     MOVE 1                TO DP010I-MAXIMUM-DIGITS     15310099
                     MOVE 0                TO DP010I-MAXIMUM-DECIMALS   15320099
                     SET DP010I-NEGATIVE-NOT-ALLOWED                    15330099
                                           TO TRUE                      15340099
272945               CALL DP010I-NUMERIC-EDIT-ROUTINE                   15351099
272945                               USING DP010I-NUMERIC-EDIT-AREA     15352099
                     IF (DP010I-ERROR-DETECTED OR                       15360099
                          DP010I-NUMERIC-FIELD = ZERO)                  15361099
                         CONTINUE                                       15370099
                     ELSE                                               15380099
                         SET PS-VALID-MAJOR-CLASS                       15390099
                                              TO TRUE                   15400099
                     END-IF                                             15410099
                  ELSE                                                  15410199
                     MOVE DP015-REVERSE          TO DEPTH               15410299
                     MOVE DP015-RED              TO DEPTC               15410399
                     MOVE DP015-UNP-NUM-BRT-OFF  TO DEPTA               15410499
                     IF  NOT PS-EDIT-ERROR                              15410599
                         SET PS-EDIT-ERROR       TO TRUE                15410699
                         MOVE PC-TSYMSG-01705    TO DP020-MSG-NUMBER    15410799
                         MOVE -1                 TO DEPTL               15410899
                  END-IF                                                15411099
154200         END-IF.                                                  15420099
154300                                                                  15430000
154400      IF  CA-MINOR-CLASS = SPACES                                 15440099
154500         SET PS-MINOR-CLASS-BLANK    TO TRUE                      15450000
154600      ELSE                                                        15460099
               IF (CA-DEPT-NUMBER-X > SPACES)                           15461099
                  MOVE CA-MINOR-CLASS   TO DP010I-UNEDITED-FIELD        15470099
                  MOVE 1                TO DP010I-MAXIMUM-DIGITS        15480099
                  MOVE 0                TO DP010I-MAXIMUM-DECIMALS      15490099
                  SET DP010I-NEGATIVE-NOT-ALLOWED                       15500099
                                              TO TRUE                   15510099
272945            CALL DP010I-NUMERIC-EDIT-ROUTINE                      15521099
272945                            USING DP010I-NUMERIC-EDIT-AREA        15522099
                  IF  (DP010I-ERROR-DETECTED OR                         15530099
                     (DP010I-NUMERIC-FIELD = ZERO AND                   15540099
                                         PS-MAJOR-CLASS-BLANK))         15550099
                      CONTINUE                                          15560099
                  ELSE                                                  15570099
                      SET PS-VALID-MINOR-CLASS                          15580099
                                              TO TRUE                   15590099
                  END-IF                                                15600099
               ELSE                                                     15601099
                  MOVE DP015-REVERSE          TO DEPTH                  15601199
                  MOVE DP015-RED              TO DEPTC                  15601299
                  MOVE DP015-UNP-NUM-BRT-OFF  TO DEPTA                  15601399
                  IF  NOT PS-EDIT-ERROR                                 15601499
                      SET PS-EDIT-ERROR       TO TRUE                   15601599
                      MOVE PC-TSYMSG-01705    TO DP020-MSG-NUMBER       15601699
                      MOVE -1                 TO DEPTL                  15601799
               END-IF                                                   15602099
156100      END-IF.                                                     15610099
156200                                                                  15620000
156300     IF  (PS-MAJOR-CLASS-BLANK AND PS-VALID-MINOR-CLASS)          15630031
156400         MOVE CA-MINOR-CLASS         TO CA-MAJOR-CLASS            15640031
156500         MOVE SPACE                  TO CA-MINOR-CLASS            15650031
156600         MOVE CA-DEPT-NUMBER-X       TO DEPTI                     15660031
156700     ELSE                                                         15670031
156800         IF  (PS-VALID-MAJOR-CLASS AND PS-MINOR-CLASS-BLANK)      15680031
156900             MOVE SPACE              TO CA-MINOR-CLASS            15690031
157000             MOVE CA-CLASS-NUMBER-X  TO CLASSI                    15700031
157100         ELSE                                                     15710031
157200             IF  ((PS-VALID-MAJOR-CLASS AND PS-VALID-MINOR-CLASS) 15720031
157300                                     OR                           15730031
157400                (PS-MAJOR-CLASS-BLANK AND PS-MINOR-CLASS-BLANK))  15740031
MC0402                 MOVE CA-CLASS-NUMBER-X  TO CLASSI                15741099
157500                 CONTINUE                                         15750031
157600             ELSE                                                 15760031
157700                 MOVE DP015-REVERSE  TO CLASSH                    15770031
157800                 MOVE DP015-RED      TO CLASSC                    15780031
157900                 MOVE DP015-UNP-ALP-BRT-OFF                       15790031
158000                                     TO CLASSA                    15800031
158100                 IF  NOT PS-EDIT-ERROR                            15810031
158200                     SET PS-EDIT-ERROR                            15820031
158300                                     TO TRUE                      15830031
158400                     MOVE PC-TSYMSG-00342 TO DP020-MSG-NUMBER     15840031
158500                     MOVE -1         TO CLASSL                    15850031
158600                 END-IF                                           15860031
158700             END-IF                                               15870031
158800         END-IF.                                                  15880099
159000                                                                  15900000
159100*--> CLASS REQUIRED FOR F19 - STORE LIST                          15911099
159200     IF DP020-SRC-AID = DP016-PF19 AND                            15920035
159300        (PS-MAJOR-CLASS-BLANK OR PS-MINOR-CLASS-BLANK)            15930035
159400        MOVE DP015-REVERSE         TO CLASSH                      15940035
159500        MOVE DP015-RED             TO CLASSC                      15950035
159600        MOVE DP015-UNP-ALP-BRT-OFF TO CLASSA                      15960035
159700        IF  NOT PS-EDIT-ERROR                                     15970035
159800            SET PS-EDIT-ERROR       TO TRUE                       15980035
159900            SET DP020-MSG-FATAL     TO TRUE                       15990035
160000            MOVE PC-TSYMSG-01526    TO DP020-MSG-NUMBER           16000035
160100            MOVE -1                 TO CLASSL                     16010035
160200        END-IF                                                    16020035
160300     END-IF.                                                      16030035
160400                                                                  16040034
160500****************************************************************  16050000
160600*  THE FOLLOWING PARAGRAPH IS HERE TO PREVENT UNAUTHORIZED USERS  16060000
160700*  DOING A DEPARTMENT ONLY INQUIRY - DEPARTMENT ONLY INQUIRIES    16070000
160800*  TAKE A LONG TIME.                                              16080000
160900****************************************************************  16090000
161000     IF  PS-MINOR-CLASS-AUTH                                      16100000
161100         IF  PS-NO-VALID-MINOR-CLASS                              16110000
161200             MOVE DP015-REVERSE      TO CLASSH                    16120000
161300             MOVE DP015-RED          TO CLASSC                    16130000
161400             MOVE DP015-UNP-ALP-BRT-OFF                           16140000
161500                                     TO CLASSA                    16150000
161600             IF  NOT PS-EDIT-ERROR                                16160000
161700                 SET PS-EDIT-ERROR   TO TRUE                      16170000
161800                 MOVE PC-TSYMSG-00401 TO DP020-MSG-NUMBER         16180000
161900                 MOVE -1             TO CLASSL                    16190000
162000             END-IF                                               16200000
162100         END-IF                                                   16210000
162200     END-IF.                                                      16220000
162300                                                                  16230000
162400* SKU NUMBER MAY BE BLANK, BUT MUST BE NUMERIC IF ENTERED         16240000
MC0502     IF  CA-SKU-NUMBER-X = SPACES                                 16250099
162600         CONTINUE                                                 16260000
162700     ELSE                                                         16270000
MC0502         MOVE CA-SKU-NUMBER-X        TO DP010I-UNEDITED-FIELD     16280099
162900         MOVE 8                      TO DP010I-MAXIMUM-DIGITS     16290099
163000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   16300000
163100         SET DP010I-NEGATIVE-NOT-ALLOWED                          16310000
163200                                     TO TRUE                      16320000
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16331099
272945                         USING DP010I-NUMERIC-EDIT-AREA           16332099
163400         IF  (DP010I-ERROR-DETECTED                               16340000
163500                 OR DP010I-NUMERIC-FIELD = ZERO)                  16350000
163600             MOVE DP015-REVERSE      TO SKUH                      16360000
163700             MOVE DP015-RED          TO SKUC                      16370000
163800             MOVE DP015-UNP-ALP-BRT-OFF                           16380000
163900                                     TO SKUA                      16390000
164000             IF  NOT PS-EDIT-ERROR                                16400000
164100                 SET PS-EDIT-ERROR   TO TRUE                      16410000
164200                 MOVE PC-TSYMSG-00342 TO DP020-MSG-NUMBER         16420000
164300                 MOVE -1             TO SKUL                      16430000
164400             END-IF                                               16440000
164500         ELSE                                                     16450000
164600             MOVE DP010I-NUMERIC-FIELD                            16460000
MC0502                                     TO CA-SKU-NUMBER-9           16470099
MC0502             MOVE CA-SKU-NUMBER-X    TO SKUI                      16480099
164900         END-IF                                                   16490000
165000     END-IF.                                                      16500000
165000                                                                  16500199
162400* UPC NUMBER MAY BE BLANK, BUT MUST BE NUMERIC IF ENTERED         16501099
160502     IF  CA-UPC-NUMBER-X = SPACES                                 16502099
162600         CONTINUE                                                 16503099
162700     ELSE                                                         16504099
               MOVE CA-UPC-NUMBER-X         TO DP010I-UNEDITED-FIELD    16504199
               MOVE LENGTH OF CA-UPC-NUMBER-X TO DP010I-MAXIMUM-DIGITS  16504299
               MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  16504399
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16504499
160502*        MOVE CA-UPC-NUMBER-X        TO DP010I-UNEDITED-FIELD     16505099
162900*        MOVE 14                     TO DP010I-MAXIMUM-DIGITS     16506099
163000*        MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   16507099
163100*        SET DP010I-NEGATIVE-NOT-ALLOWED                          16508099
163200*                                    TO TRUE                      16509099
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16509299
272945                         USING DP010I-NUMERIC-EDIT-AREA           16509399
163400         IF  (DP010I-ERROR-DETECTED                               16509499
163500                 OR DP010I-NUMERIC-FIELD = ZERO)                  16509599
163600             MOVE DP015-REVERSE      TO UPCH                      16509699
163700             MOVE DP015-RED          TO UPCC                      16509799
163800             MOVE DP015-UNP-ALP-BRT-OFF                           16509899
163900                                     TO UPCA                      16509999
164000             IF  NOT PS-EDIT-ERROR                                16510099
164100                 SET PS-EDIT-ERROR   TO TRUE                      16510199
164200                 MOVE PC-TSYMSG-00342 TO DP020-MSG-NUMBER         16510299
164300                 MOVE -1             TO UPCL                      16510399
164400             END-IF                                               16510499
164500         ELSE                                                     16510599
164600*            MOVE DP010I-NUMERIC-FIELD                            16510699
164600             MOVE DP010I-NUM-FIELD-15-DIG-2-DEC                   16510799
160502                                     TO CA-UPC-NUMBER-9           16510899
160502*            MOVE CA-UPC-NUMBER-X    TO UPCI                      16510999
160502             MOVE CA-UPC-NUMBER-X    TO UPCO                      16511099
164900         END-IF                                                   16511199
165000     END-IF.                                                      16511299
165100                                                                  16512099
165200* GROUP CODE - REQUIRES NO FORMAT EDITING AT THIS POINT           16520000
165300                                                                  16530000
165400* VENDOR NUMBER DOES NOT HAVE TO BE ENTERED, BUT MUST BE NUMERIC  16540000
165500* IF IT IS                                                        16550000
165600     IF  CA-INHOUSE-NUMBER = SPACES                               16560087
165700         CONTINUE                                                 16570087
165800     ELSE                                                         16580087
165900       IF CA-VENDOR-NUMBER-ENTERED                                16590087
166000         MOVE CA-INHOUSE-NUMBER      TO DP010I-UNEDITED-FIELD     16600000
166100         MOVE 3                      TO DP010I-MAXIMUM-DIGITS     16610000
166200         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   16620000
166300         SET DP010I-NEGATIVE-NOT-ALLOWED                          16630000
166400                                     TO TRUE                      16640000
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16651099
272945                         USING DP010I-NUMERIC-EDIT-AREA           16652099
166600         IF  (DP010I-ERROR-DETECTED                               16660000
166700                 OR DP010I-NUMERIC-FIELD = ZERO)                  16670000
166800             MOVE DP015-REVERSE      TO VENNOH                    16680000
166900             MOVE DP015-RED          TO VENNOC                    16690000
167000             MOVE DP015-UNP-ALP-BRT-OFF                           16700000
167100                                     TO VENNOA                    16710000
167200             IF  NOT PS-EDIT-ERROR                                16720000
167300                 SET PS-EDIT-ERROR   TO TRUE                      16730000
167400                 MOVE PC-TSYMSG-00342 TO DP020-MSG-NUMBER         16740000
167500                 MOVE -1             TO VENNOL                    16750000
167600             END-IF                                               16760000
167700         ELSE                                                     16770000
167800             SET PS-VENDOR-NUMERIC   TO TRUE                      16780000
167900             MOVE DP010I-NUMERIC-FIELD                            16790000
168000                                     TO CA-INHOUSE-NUMBER-9       16800000
168100             MOVE CA-INHOUSE-NUMBER TO VENNOI                     16810000
168200         END-IF                                                   16820000
168300       END-IF                                                     16830099
168400     END-IF.                                                      16840087
168500                                                                  16850000
168600* STYLE - REQUIRES NO FORMAT EDITING AT THIS POINT                16860000
168700                                                                  16870000
168800* DISTRICT NUMBER DOES NOT HAVE TO BE ENTERED, BUT MUST BE NUMERIC16880000
168900* IF IT IS                                                        16890000
169000     IF  CA-DISTRICT-NUMBER = SPACES                              16900041
169100         CONTINUE                                                 16910041
169200     ELSE                                                         16920041
169300         MOVE CA-DISTRICT-NUMBER     TO DP010I-UNEDITED-FIELD     16930041
169400         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     16940041
169500         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   16950041
169600         SET DP010I-NEGATIVE-NOT-ALLOWED                          16960041
169700                                     TO TRUE                      16970041
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16981099
272945                         USING DP010I-NUMERIC-EDIT-AREA           16982099
169900         IF  (DP010I-ERROR-DETECTED                               16990041
170000                 OR DP010I-NUMERIC-FIELD = ZERO)                  17000041
170100             MOVE DP015-REVERSE      TO DISTH                     17010041
170200             MOVE DP015-RED          TO DISTC                     17020041
170300             MOVE DP015-UNP-ALP-BRT-OFF                           17030041
170400                                     TO DISTA                     17040041
170500             IF  NOT PS-EDIT-ERROR                                17050041
170600                 SET PS-EDIT-ERROR   TO TRUE                      17060041
170700                 MOVE PC-TSYMSG-00342 TO DP020-MSG-NUMBER         17070041
170800                 MOVE -1             TO DISTL                     17080041
170900             END-IF                                               17090041
171000         ELSE                                                     17100041
171100             SET PS-DISTRICT-NUMERIC TO TRUE                      17110041
171200             MOVE DP010I-NUMERIC-FIELD                            17120041
171300                                     TO CA-DISTRICT-NUMBER-9      17130041
171400             MOVE CA-DISTRICT-NUMBER TO DISTI                     17140041
171500         END-IF                                                   17150041
171600     END-IF.                                                      17160041
171700                                                                  17170000
171800* STORE NUMBER DOES NOT HAVE TO BE ENTERED, BUT MUST BE NUMERIC   17180000
171900* IF IT IS                                                        17190000
172000     IF  CA-STORE-NUMBER-X = SPACES                               17200000
172100         CONTINUE                                                 17210000
172200     ELSE                                                         17220000
172300         MOVE CA-STORE-NUMBER-X      TO DP010I-UNEDITED-FIELD     17230000
172400         MOVE 5                      TO DP010I-MAXIMUM-DIGITS     17240099
172500         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   17250000
172600         SET DP010I-NEGATIVE-NOT-ALLOWED                          17260000
172700                                     TO TRUE                      17270000
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17281099
272945                         USING DP010I-NUMERIC-EDIT-AREA           17282099
172900         IF  DP010I-ERROR-DETECTED                                17290000
173000             MOVE DP015-REVERSE      TO STOREH                    17300000
173100             MOVE DP015-RED          TO STOREC                    17310000
173200             MOVE DP015-UNP-ALP-BRT-OFF                           17320000
173300                                     TO STOREA                    17330000
173400             IF  NOT PS-EDIT-ERROR                                17340000
173500                 SET PS-EDIT-ERROR   TO TRUE                      17350000
173600                 MOVE PC-TSYMSG-00342 TO DP020-MSG-NUMBER         17360000
173700                 MOVE -1             TO STOREL                    17370000
173800             END-IF                                               17380000
173900         ELSE                                                     17390000
174000             SET PS-STORE-NUMERIC    TO TRUE                      17400000
174100             MOVE DP010I-NUMERIC-FIELD                            17410000
174200                                     TO CA-STORE-NUMBER-9         17420000
174300             MOVE CA-STORE-NUMBER-X  TO STOREI                    17430000
174400         END-IF                                                   17440000
174500     END-IF.                                                      17450000
174600                                                                  17460000
174700* LONG COLOR DOES NOT HAVE TO BE ENTRED, BUT MUST BE VALID        17470056
174800* AND IS MUTUALLY EXCLUSIVE WITH COLOR1 - COLOR2 RANGE            17480056
174900     IF  CA-TSK-LONG-COLOR = SPACES                               17490063
175000         CONTINUE                                                 17500056
175100     ELSE                                                         17510056
175200        IF  CA-COLOR-1-X = SPACES AND                             17520056
175300            CA-COLOR-2-X = SPACES                                 17530056
MC0502             MOVE CA-DEPT-NUMBER-9   TO NI-DEPT-9-4               17540099
MC0502             MOVE CA-CLASS-NUMBER-9  TO NI-CLASS-9-4              17550099
MC0502             MOVE CA-SKU-NUMBER-9    TO NI-SKU-9-8                17551099
175600             MOVE CA-TSK-LONG-COLOR  TO TSK-LONG-COLOR-DESC       17560063
175700                                        COLDSCI                   17570060
175800            PERFORM 33265-GET-LONG-COLOR                          17580063
175900            IF PS-COLOR-FOUND                                     17590056
176000               CONTINUE                                           17600056
176100            ELSE                                                  17610056
176200               IF  NOT PS-EDIT-ERROR                              17620056
176300                   SET PS-EDIT-ERROR    TO TRUE                   17630056
176400                   SET PS-COLOR-ERROR   TO TRUE                   17640056
176500                   MOVE PC-TSYMSG-01535 TO DP020-MSG-NUMBER       17650074
176600                   MOVE -1              TO COLDSCL                17660056
176700                   MOVE DP015-REVERSE   TO COLDSCH                17670066
176800                   MOVE DP015-RED       TO COLDSCC                17680066
176900                   MOVE DP015-UNP-ALP-BRT-OFF                     17690066
177000                                        TO COLDSCA                17700066
177100               END-IF                                             17710056
177200        ELSE                                                      17720060
177300           IF  NOT PS-EDIT-ERROR                                  17730060
177400               SET PS-EDIT-ERROR    TO TRUE                       17740060
177500               SET PS-COLOR-ERROR   TO TRUE                       17750060
177600               MOVE PC-TSYMSG-01536 TO DP020-MSG-NUMBER           17760074
177700               MOVE -1              TO COLDSCL                    17770060
177800               MOVE DP015-REVERSE   TO COLDSCH                    17780066
177900               MOVE DP015-RED       TO COLDSCC                    17790066
178000               MOVE DP015-UNP-ALP-BRT-OFF                         17800066
178100                                    TO COLDSCA                    17810066
178200           END-IF                                                 17820060
178300         END-IF                                                   17830056
178400     END-IF.                                                      17840056
178500                                                                  17850056
178600                                                                  17860056
178700* COLOR 1 & 2 DO NOT HAVE TO BE ENTERED, BUT MUST BE NUMERIC      17870056
178800* IF THEY ARE.                                                    17880056
178900     IF  CA-COLOR-1-X = SPACES                                    17890056
179000         CONTINUE                                                 17900000
179100     ELSE                                                         17910000
179200     IF  CA-TSK-LONG-COLOR NOT = SPACES                           17920069
179300         SET PS-COLOR-ERROR  TO TRUE                              17930069
179400         MOVE DP015-REVERSE          TO COLOR1H                   17940069
179500         MOVE DP015-RED              TO COLOR1C                   17950069
179600         MOVE DP015-UNP-ALP-BRT-OFF  TO COLOR1A                   17960069
179700     ELSE                                                         17970069
179800         MOVE CA-COLOR-1-NUM         TO DP010I-UNEDITED-FIELD     17980000
179900         MOVE 3                      TO DP010I-MAXIMUM-DIGITS     17990000
180000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   18000000
180100         SET DP010I-NEGATIVE-NOT-ALLOWED                          18010000
180200                                     TO TRUE                      18020000
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18031099
272945                         USING DP010I-NUMERIC-EDIT-AREA           18032099
180400         IF  DP010I-ERROR-DETECTED                                18040000
180500             MOVE DP015-REVERSE      TO COLOR1H                   18050000
180600             MOVE DP015-RED          TO COLOR1C                   18060000
180700             MOVE DP015-UNP-ALP-BRT-OFF                           18070000
180800                                     TO COLOR1A                   18080000
180900             IF  NOT PS-EDIT-ERROR                                18090000
181000                 SET PS-EDIT-ERROR   TO TRUE                      18100000
181100                 SET PS-COLOR-ERROR  TO TRUE                      18110000
181200                 MOVE PC-TSYMSG-01295 TO DP020-MSG-NUMBER         18120000
181300                 MOVE -1             TO COLOR1L                   18130000
181400             END-IF                                               18140000
181500         ELSE                                                     18150000
181600             MOVE DP010I-NUMERIC-FIELD                            18160000
181700                                     TO CA-COLOR-1-NUM            18170000
181800             MOVE CA-COLOR-1-NUM     TO COLOR1I                   18180000
181900         END-IF                                                   18190000
182000     END-IF.                                                      18200000
182100                                                                  18210000
182200* COLOR 1 & 2 DO NOT HAVE TO BE ENTERED, BUT MUST BE NUMERIC      18220000
182300* IF THEY ARE. COLOR 2 CANNOT BE LESS THAN COLOR 1.               18230000
182400                                                                  18240000
182500     IF  CA-COLOR-2-X = SPACES                                    18250000
182600         CONTINUE                                                 18260000
182700     ELSE                                                         18270069
182800     IF  CA-TSK-LONG-COLOR NOT = SPACES                           18280069
182900         SET PS-COLOR-ERROR  TO TRUE                              18290069
183000         MOVE DP015-REVERSE          TO COLOR2H                   18300069
183100         MOVE DP015-RED              TO COLOR2C                   18310069
183200         MOVE DP015-UNP-ALP-BRT-OFF  TO COLOR2A                   18320069
183300     ELSE                                                         18330000
183400         MOVE CA-COLOR-2-NUM         TO DP010I-UNEDITED-FIELD     18340000
183500         MOVE 3                      TO DP010I-MAXIMUM-DIGITS     18350000
183600         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   18360000
183700         SET DP010I-NEGATIVE-NOT-ALLOWED                          18370000
183800                                     TO TRUE                      18380000
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18391099
272945                         USING DP010I-NUMERIC-EDIT-AREA           18392099
184000         IF  DP010I-ERROR-DETECTED                                18400000
184100             MOVE DP015-REVERSE      TO COLOR2H                   18410000
184200             MOVE DP015-RED          TO COLOR2C                   18420000
184300             MOVE DP015-UNP-ALP-BRT-OFF                           18430000
184400                                     TO COLOR2A                   18440000
184500             IF  NOT PS-EDIT-ERROR                                18450000
184600                 SET PS-EDIT-ERROR   TO TRUE                      18460000
184700                 SET PS-COLOR-ERROR  TO TRUE                      18470000
184800                 MOVE PC-TSYMSG-01295 TO DP020-MSG-NUMBER         18480000
184900                 MOVE -1             TO COLOR2L                   18490000
185000             END-IF                                               18500000
185100         ELSE                                                     18510000
185200             MOVE DP010I-NUMERIC-FIELD                            18520000
185300                                     TO CA-COLOR-2-NUM            18530000
185400             MOVE CA-COLOR-2-NUM     TO COLOR2I                   18540000
185500         END-IF                                                   18550000
185600     END-IF.                                                      18560000
185700                                                                  18570000
185800     IF  CA-COLOR-2-X NOT = SPACES                                18580000
185900        IF CA-COLOR-2-NUM < CA-COLOR-1-NUM                        18590000
186000           MOVE DP015-REVERSE      TO COLOR2H                     18600000
186100           MOVE DP015-RED          TO COLOR2C                     18610000
186200           MOVE DP015-UNP-ALP-BRT-OFF                             18620000
186300                                     TO COLOR2A                   18630000
186400           IF  NOT PS-EDIT-ERROR                                  18640000
186500               SET PS-EDIT-ERROR   TO TRUE                        18650000
186600               SET PS-COLOR-ERROR  TO TRUE                        18660000
186700               MOVE PC-TSYMSG-01295 TO DP020-MSG-NUMBER           18670000
186800               MOVE -1             TO COLOR2L.                    18680000
186900                                                                  18690000
187000************************************************************      18700000
187100* CHECK FOR VALID COLOR FAMILY RANGES                      *      18710000
187200************************************************************      18720000
187300     IF CA-COLOR-1-X = SPACES AND                                 18730000
187400        CA-COLOR-2-X NOT = SPACES                                 18740000
187500          MOVE CA-COLOR-2-X TO CA-COLOR-1-X                       18750000
187600                               COLOR1O                            18760000
187700          MOVE SPACES       TO CA-COLOR-2-X                       18770000
187800                               COLOR2O.                           18780000
187900      IF NOT PS-COLOR-ERROR                                       18790000
188000         MOVE CA-COLOR-1-X TO PV-COLOR-1-CDE                      18800000
188100         IF CA-COLOR-2-X = SPACES                                 18810000
188200            MOVE CA-COLOR-1-X TO PV-COLOR-2-CDE                   18820000
188300         ELSE                                                     18830000
188400            MOVE CA-COLOR-2-X TO PV-COLOR-2-CDE                   18840000
188500         END-IF                                                   18850000
188600         IF   CA-COLOR-1-X = SPACES                               18860000
188700         AND  CA-COLOR-2-X = SPACES                               18870000
188800            MOVE SPACES TO COLORDO                                18880000
188900            CA-COLOR-DESC                                         18890000
189000         ELSE                                                     18900000
189100            PERFORM 33253-CHECK-COLOR-FAMILY                      18910000
189200            PERFORM 33252-GET-COLOR                               18920000
189300            IF PV-COLOR-1 = PV-COLOR-2                            18930000
189400               MOVE PV-COLOR-1 TO COLORDO                         18940000
189500                   CA-COLOR-DESC                                  18950000
189600            ELSE                                                  18960000
189700              IF PS-COLOR-FAMILY                                  18970000
189800                MOVE PV-COLOR-1 TO COLORDO                        18980000
189900                     CA-COLOR-DESC                                18990000
190000              ELSE                                                19000000
190100                MOVE SPACES TO COLORDO                            19010000
190200                    CA-COLOR-DESC                                 19020000
190300                MOVE DP015-REVERSE      TO COLOR1H                19030000
190400                MOVE DP015-RED          TO COLOR1C                19040000
190500                MOVE DP015-UNP-ALP-BRT-OFF                        19050000
190600                                        TO COLOR1A                19060000
190700                IF  NOT PS-EDIT-ERROR                             19070000
190800                    SET PS-EDIT-ERROR   TO TRUE                   19080000
190900                    MOVE PC-TSYMSG-01295 TO DP020-MSG-NUMBER      19090000
191000                    MOVE -1             TO COLOR1L.               19100000
206800* STATUS A                                                        20680000
206900     IF  (CA-STAT-10-ENTERED OR CA-STAT-10 = SPACES)              20690000
207000         CONTINUE                                                 20700000
207100     ELSE                                                         20710000
207200         MOVE DP015-REVERSE          TO STATAH                    20720000
207300         MOVE DP015-RED              TO STATAC                    20730000
207400         MOVE DP015-UNP-ALP-BRT-OFF  TO STATAA                    20740000
207500         IF  NOT PS-EDIT-ERROR                                    20750000
207600             SET PS-EDIT-ERROR       TO TRUE                      20760000
207700             MOVE PC-TSYMSG-00397    TO DP020-MSG-NUMBER          20770000
207800             MOVE -1                 TO STATAL                    20780000
207900         END-IF                                                   20790000
208000     END-IF.                                                      20800000
208100                                                                  20810000
208200* STATUS B                                                        20820000
208300     IF  (CA-STAT-40-ENTERED OR CA-STAT-40 = SPACES)              20830000
208400         CONTINUE                                                 20840000
208500     ELSE                                                         20850000
208600         MOVE DP015-REVERSE          TO STATBH                    20860000
208700         MOVE DP015-RED              TO STATBC                    20870000
208800         MOVE DP015-UNP-ALP-BRT-OFF  TO STATBA                    20880000
208900         IF  NOT PS-EDIT-ERROR                                    20890000
209000             SET PS-EDIT-ERROR       TO TRUE                      20900000
209100             MOVE PC-TSYMSG-00397    TO DP020-MSG-NUMBER          20910000
209200             MOVE -1                 TO STATBL                    20920000
209300         END-IF                                                   20930000
209400     END-IF.                                                      20940000
209500                                                                  20950000
209600* STATUS C                                                        20960000
209700     IF  (CA-STAT-20-ENTERED OR CA-STAT-20 = SPACES)              20970000
209800         CONTINUE                                                 20980000
209900     ELSE                                                         20990000
210000         MOVE DP015-REVERSE          TO STATCH                    21000000
210100         MOVE DP015-RED              TO STATCC                    21010000
210200         MOVE DP015-UNP-ALP-BRT-OFF  TO STATCA                    21020000
210300         IF  NOT PS-EDIT-ERROR                                    21030000
210400             SET PS-EDIT-ERROR       TO TRUE                      21040000
210500             MOVE PC-TSYMSG-00397    TO DP020-MSG-NUMBER          21050000
210600             MOVE -1                 TO STATCL                    21060000
210700         END-IF                                                   21070000
210800     END-IF.                                                      21080000
210900                                                                  21090000
211000* STATUS D                                                        21100000
211100     IF  (CA-STAT-90-ENTERED OR CA-STAT-90 = SPACES)              21110000
211200         CONTINUE                                                 21120000
211300     ELSE                                                         21130000
211400         MOVE DP015-REVERSE          TO STATDH                    21140000
211500         MOVE DP015-RED              TO STATDC                    21150000
211600         MOVE DP015-UNP-ALP-BRT-OFF  TO STATDA                    21160000
211700         IF  NOT PS-EDIT-ERROR                                    21170000
211800             SET PS-EDIT-ERROR       TO TRUE                      21180000
211900             MOVE PC-TSYMSG-00397    TO DP020-MSG-NUMBER          21190000
212000             MOVE -1                 TO STATDL                    21200000
212100         END-IF                                                   21210000
212200     END-IF.                                                      21220000
212300                                                                  21230000
212400* STATUS E                                                        21240000
212500     IF  (CA-STAT-30-ENTERED OR CA-STAT-30 = SPACES)              21250000
212600         CONTINUE                                                 21260000
212700     ELSE                                                         21270000
212800         MOVE DP015-REVERSE          TO STATEH                    21280000
212900         MOVE DP015-RED              TO STATEC                    21290000
213000         MOVE DP015-UNP-ALP-BRT-OFF  TO STATEA                    21300000
213100         IF  NOT PS-EDIT-ERROR                                    21310000
213200             SET PS-EDIT-ERROR       TO TRUE                      21320000
213300             MOVE PC-TSYMSG-00397    TO DP020-MSG-NUMBER          21330000
213400             MOVE -1                 TO STATEL                    21340000
213500         END-IF                                                   21350000
213600     END-IF.                                                      21360000
213700                                                                  21370000
212400* STATUS F                                                        21371099
212500     IF  (CA-STAT-25-ENTERED OR CA-STAT-25 = SPACES)              21372099
212600         CONTINUE                                                 21373099
212700     ELSE                                                         21374099
212800         MOVE DP015-REVERSE          TO STATFH                    21375099
212900         MOVE DP015-RED              TO STATFC                    21376099
213000         MOVE DP015-UNP-ALP-BRT-OFF  TO STATFA                    21377099
213100         IF  NOT PS-EDIT-ERROR                                    21378099
213200             SET PS-EDIT-ERROR       TO TRUE                      21379099
213300             MOVE PC-TSYMSG-00397    TO DP020-MSG-NUMBER          21379199
213400             MOVE -1                 TO STATFL                    21379299
213500         END-IF                                                   21379399
213600     END-IF.                                                      21379499
213700                                                                  21379599
213700* STATUS F - NO OTHER STATUS CAN BE SELECTED WHEN STATUS F IS     21379699
213700*            SELETED.                                             21379799
213700                                                                  21379899
213700     IF (CA-STAT-25-ENTERED)                                      21379999
213700         IF (CA-STAT-10-ENTERED OR CA-STAT-20-ENTERED OR          21380099
213700             CA-STAT-30-ENTERED OR CA-STAT-40-ENTERED OR          21380199
213700             CA-STAT-90-ENTERED)                                  21380299
213700            MOVE DP015-REVERSE          TO STATFH                 21380499
213700            MOVE DP015-RED              TO STATFC                 21380599
213700            MOVE DP015-UNP-ALP-BRT-OFF  TO STATFC                 21380699
213700            IF NOT PS-EDIT-ERROR                                  21380799
213700               SET PS-EDIT-ERROR        TO TRUE                   21380899
213700               MOVE PC-TSYMSG-02119     TO DP020-MSG-NUMBER       21380999
213700               MOVE -1                  TO STATFL                 21381099
213700            END-IF                                                21381199
213700         END-IF                                                   21381299
213700     END-IF.                                                      21381399
213700                                                                  21381699
213800* REPLENISH INDICATOR                                             21382099
213900     IF  REPLENA = DP015-ERASE-EOF                                21390071
214000         MOVE SPACE TO REPLENI                                    21400071
214100     ELSE                                                         21410000
214200         MOVE CA-VSM-REPLENISH TO REPLENI                         21420099
214300     END-IF.                                                      21430099
216000                                                                  21600099
219100* KEY ITEM INDICATOR                                              21910070
219200     IF  KYITMA = DP015-ERASE-EOF                                 21920070
219300         MOVE SPACE TO KYITMI                                     21930070
219400     ELSE                                                         21940070
219500         MOVE CA-KEY-ITEM TO KYITMI.                              21950070
219600     IF  KYITMI = 'N' OR 'Y' OR ' '                               21960070
219700         CONTINUE                                                 21970070
219800     ELSE                                                         21980070
219900         MOVE DP015-REVERSE          TO KYITMH                    21990070
220000         MOVE DP015-RED              TO KYITMC                    22000070
220100         MOVE DP015-UNP-ALP-BRT-OFF  TO KYITMA                    22010070
220200         IF  NOT PS-EDIT-ERROR                                    22020070
220300             SET PS-EDIT-ERROR       TO TRUE                      22030070
220400             MOVE PC-TSYMSG-00349    TO DP020-MSG-NUMBER          22040070
220500             MOVE -1                 TO KYITML                    22050070
220600         END-IF                                                   22060070
220700     END-IF.                                                      22070070
220800                                                                  22080070
220900     IF  PS-NO-EDIT-ERROR                                         22090000
221000         PERFORM 33100-EDIT-LOGIC-RELATIONSHIPS                   22100000
221100     END-IF.                                                      22110000
221200                                                                  22120000
221300* VENDOR NAME IS OPTIONAL BUT CANNOT BE ENTERED IF VENDOR NUMBER  22130000
221400* IS ENTERED                                                      22140000
221500                                                                  22150000
221600     IF  VENNML > 0 AND                                           22160000
221700         VENNOL > 0                                               22170000
221800             MOVE DP015-REVERSE      TO VENNMH                    22180000
221900             MOVE DP015-RED          TO VENNMC                    22190000
222000             MOVE DP015-UNP-ALP-BRT-OFF                           22200000
222100                                     TO VENNMA                    22210000
222200             MOVE DP015-REVERSE      TO VENNOH                    22220000
222300             MOVE DP015-RED          TO VENNOC                    22230000
222400             MOVE DP015-UNP-ALP-BRT-OFF                           22240000
222500                                     TO VENNOA                    22250000
222600             IF  NOT PS-EDIT-ERROR                                22260000
222700                 SET PS-EDIT-ERROR   TO TRUE                      22270000
222800                    MOVE PC-TSYMSG-01301 TO DP020-MSG-NUMBER      22280000
222900                 MOVE -1             TO VENNML                    22290000
223000             END-IF.                                              22300000
223100                                                                  22310000
223200* VENDOR NAME IS OPTIONAL BUT IF UTILIZED IT MUST MATCH A NAME    22320000
223300* ON THE TENTNME TABLE. THE ENT ID IS THEN USED WITH THE DEPT     22330000
223400* TO GET THE INHOUSE VENDOR NUMBER                                22340000
223500                                                                  22350000
223600     IF  CA-VENDOR-NAME = SPACES  OR                              22360099
223700         DP020-SRC-AID = DP016-PF22 OR                            22370099
223700         DP020-SRC-AID = DP016-PF23                               22371099
223800       CONTINUE                                                   22380000
223900     ELSE                                                         22390000
224000       IF CA-VENDOR-NAME-ENTERED                                  22400000
224100         PERFORM 33255-GET-VENDOR-NAME                            22410000
224200         IF  PS-VENDOR-NAME-NOT-FOUND                             22420000
224300             MOVE DP015-REVERSE       TO VENNMH                   22430091
224400             MOVE DP015-RED           TO VENNMC                   22440091
224500             MOVE DP015-UNP-ALP-BRT-OFF                           22450000
224600                                      TO VENNMA                   22460091
224700             IF  NOT PS-EDIT-ERROR                                22470000
224800                 SET PS-EDIT-ERROR    TO TRUE                     22480091
224900                 MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER         22490091
225000                 MOVE -1              TO VENNML                   22500091
225100             END-IF                                               22510000
225200         ELSE                                                     22520000
225300             MOVE CA-VENDOR-NAME      TO VENNMI                   22530099
225400             MOVE VNDDPT-INHOUSE-NBR   TO CA-INHOUSE-NUMBER       22540099
225500                                          VENNOO                  22550099
225600         END-IF                                                   22560000
225700       END-IF                                                     22570000
225800     END-IF.                                                      22580000
225900                                                                  22590000
226000* ATTEMPT TO GET A DEPARTMENT NAME AND VENDOR NAME TO DISPLAY ON  22600000
226100* THE SCREEN REGARDLESS OF ANY OTHER ERRORS WHICH HAVE HAPPENED   22610000
226200     IF  PS-DEPT-NUMERIC                                          22620099
226300         PERFORM 33200-GET-DEPT-VENDOR                            22630000
226400         IF  PS-DEPT-NOT-FOUND                                    22640000
226500             MOVE DP015-REVERSE      TO DEPTH                     22650000
226600             MOVE DP015-RED          TO DEPTC                     22660000
226700             MOVE DP015-UNP-NUM-BRT-OFF                           22670000
226800                                     TO DEPTA                     22680000
226900             SET PS-EDIT-ERROR       TO TRUE                      22690000
227000             MOVE PC-TSYMSG-00032    TO DP020-MSG-NUMBER          22700000
227100             MOVE -1                 TO DEPTL                     22710000
227200         END-IF                                                   22720000
227300         IF  PS-VENDOR-NUMERIC                                    22730000
227400             IF  PS-VENDOR-NAME-NOT-FOUND                         22740000
227500                 MOVE DP015-REVERSE  TO VENNOH                    22750000
227600                 MOVE DP015-RED      TO VENNOC                    22760000
227700                 MOVE DP015-UNP-ALP-BRT-OFF                       22770000
227800                                     TO VENNOA                    22780000
227900                 IF  NOT PS-EDIT-ERROR                            22790000
228000                     SET PS-EDIT-ERROR                            22800000
228100                                     TO TRUE                      22810000
228200                     MOVE PC-TSYMSG-00653 TO DP020-MSG-NUMBER     22820000
228300                     MOVE -1         TO VENNOL                    22830000
228400                 END-IF                                           22840000
228500             END-IF                                               22850000
228600         END-IF                                                   22860000
228700         IF  CA-CLASS-NUMBER-X NOT = SPACES                       22870000
228800             PERFORM 33300-EDIT-VALID-DEPT-CLASS                  22880000
228900         ELSE                                                     22890099
229000            MOVE SPACES         TO CA-CLASS-DESCRIPTION           22900099
229100                                   CLSDSCO                        22910099
229200         END-IF                                                   22920000
229300     END-IF.                                                      22930000
229400                                                                  22940000
229500* SIZE IS OPTIONAL BUT IF UTILIZED IT MUST MATCH A SIZE DESC      22950000
229600* ON THE TSIZE TABLE.                                             22960000
229700                                                                  22970000
229800     IF  CA-SIZE-DESC = SPACES                                    22980000
229900       CONTINUE                                                   22990000
230000     ELSE                                                         23000000
230100         PERFORM 33380-GET-SIZE                                   23010000
230200         IF  PS-SIZE-NOT-FOUND                                    23020000
230300             MOVE DP015-REVERSE      TO SIZEH                     23030000
230400             MOVE DP015-RED          TO SIZEC                     23040000
230500             MOVE DP015-UNP-ALP-BRT-OFF                           23050000
230600                                     TO SIZEA                     23060000
230700             IF  NOT PS-EDIT-ERROR                                23070000
230800                 SET PS-EDIT-ERROR   TO TRUE                      23080000
230900                 IF SQLCODE = -811                                23090000
231000                    MOVE PC-TSYMSG-01296 TO DP020-MSG-NUMBER      23100000
231100                 ELSE                                             23110000
231200                    MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER      23120000
231300                 END-IF                                           23130000
231400                 MOVE -1             TO SIZEL                     23140000
231500             END-IF                                               23150000
231600         ELSE                                                     23160000
231700             MOVE CA-SIZE-DESC TO SIZEI                           23170000
231800         END-IF                                                   23180000
231900     END-IF.                                                      23190000
232000                                                                  23200000
232100* ATTEMPT TO GET A STORE NAME REGARDLESS OF ANY OTHER ERRORS      23210000
232200* ON THE SCREEN                                                   23220000
232300*                                                                 23230000
234800* ATTEMPT TO GET A DISTRICT NAME REGARDLESS OF ANY OTHER ERRORS   23480047
234900* ON THE SCREEN                                                   23490047
235000*                                                                 23500047
235100     IF  CA-DISTRICT-NUMBER NUMERIC                               23510047
235200         PERFORM 33400-GET-DISTRICT                               23520047
235300         IF  PS-DISTRICT-NOT-FOUND                                23530047
235400             MOVE DP015-REVERSE      TO DISTH                     23540047
235500             MOVE DP015-RED          TO DISTC                     23550047
235600             MOVE DP015-UNP-ALP-BRT-OFF                           23560047
235700                                     TO DISTA                     23570047
235800             IF  NOT PS-EDIT-ERROR                                23580047
235900                 SET PS-EDIT-ERROR    TO TRUE                     23590047
236000                 MOVE PC-TSYMSG-00399 TO DP020-MSG-NUMBER         23600047
236100                 MOVE -1              TO DISTL                    23610047
236200             END-IF                                               23620047
236300         END-IF                                                   23630047
236400     END-IF.                                                      23640047
236500                                                                  23650047
236600* ATTEMPT TO GET A STORE NAME REGARDLESS OF ANY OTHER ERRORS      23660047
236700* ON THE SCREEN                                                   23670000
236800*                                                                 23680000
236900                                                                  23690000
237000     IF  CA-STORE-NUMBER-X NUMERIC                                23700000
237100         IF  CA-STORE-NUMBER-9 NOT = ZERO                         23710000
237200             PERFORM 33500-GET-STORE                              23720000
237300             IF  PS-STORE-NOT-FOUND                               23730000
237400                 MOVE DP015-REVERSE    TO STOREH                  23740099
237500                 MOVE DP015-RED        TO STOREC                  23750099
237600                 MOVE DP015-UNP-ALP-BRT-OFF                       23760000
237700                                       TO STOREA                  23770099
237800                 IF  NOT PS-EDIT-ERROR                            23780000
237900                     SET PS-EDIT-ERROR TO TRUE                    23790099
238000                     MOVE PC-TSYMSG-00332 TO DP020-MSG-NUMBER     23800000
238100                     MOVE -1           TO STOREL                  23810099
238200                 END-IF                                           23820000
238300             END-IF                                               23830000
238400         ELSE                                                     23840000
238500             MOVE PC-CORPORATE-LITERAL TO STRDSCO                 23850099
238600                                          CA-STORE-NAME           23860099
238700             MOVE DP015-HL-OFF         TO STRDSCH                 23870099
238800             MOVE DP015-BLUE           TO STRDSCC                 23880099
238900             MOVE DP015-ASK-NOR-OFF    TO STRDSCA                 23890099
239000         END-IF                                                   23900000
239100     END-IF.                                                      23910000
239200                                                                  23920000
213700****** WHEN 25 - MIXED STATUS CHOSEN - THE ONLY ACTIVE PF KEY     23921099
213700****** IS PF17.  THIS WILL SHOW A LIST OF REGIONALLY CLEARANCE    23922099
213700****** PRICED SKUS (FSKCS055).                                    23922199
213700     IF (CA-STAT-25-ENTERED)                                      23922299
213700        IF DP020-SRC-AID = DP016-PF17                             23922399
213700         OR DP020-SRC-AID = DP016-ENTER                           23922499
213700         OR DP020-NEXT-ACT-RETURN                                 23922599
213700           CONTINUE                                               23922699
213700        ELSE                                                      23922799
213700           IF NOT PS-EDIT-ERROR                                   23922899
213700              SET PS-EDIT-ERROR    TO TRUE                        23922999
213700              MOVE PC-TSYMSG-02149 TO DP020-MSG-NUMBER            23923099
213700              MOVE -1              TO STATFL                      23923199
213700           END-IF                                                 23923299
213700        END-IF                                                    23923399
213700     END-IF.                                                      23923499
239200                                                                  23925099
MK    *--> DEPT OR DEPT/MCL OR DEPT/SCL OR SKU MUST BE ENTERED          23925199
MK         IF (CA-DEPT-NUMBER-X > SPACES)                               23925299
MK          OR (CA-SKU-NUMBER-X > SPACES)                               23925499
            OR (CA-UPC-NUMBER-X  > SPACES)                              23925599
MK            CONTINUE                                                  23925699
MK         ELSE                                                         23926999
MK            MOVE DP015-REVERSE          TO DEPTH                      23927099
MK                                           SKUH                       23927199
MK                                           UPCH                       23927299
MK            MOVE DP015-RED              TO DEPTC                      23927399
MK                                           SKUC                       23927499
MK                                           UPCC                       23927599
MK            MOVE DP015-UNP-NUM-BRT-OFF  TO DEPTA                      23927699
MK                                           SKUA                       23927799
MK                                           UPCA                       23927899
MK            IF  NOT PS-EDIT-ERROR                                     23927999
MK                SET PS-EDIT-ERROR       TO TRUE                       23928099
MK                MOVE PC-TSYMSG-01705    TO DP020-MSG-NUMBER           23928199
MK                MOVE -1                 TO DEPTL                      23928299
MK            END-IF                                                    23928399
MK         END-IF.                                                      23929099
239300* THIS POSITIONS THE CURSOR AT DEPARTMENT NUMBER, IF THERE WERE   23930000
239400* NO ERRORS TO POSITION THE CURSOR AT ALREADY                     23940000
239500     IF  PS-NO-EDIT-ERROR                                         23950000
239600         MOVE -1                     TO DEPTL                     23960000
240500     END-IF.                                                      24050000
240600                                                                  24060000
241100******************************************************************24081099
241200*  EXAMINE THE RELATIONSHIPS BETWEEN THE SELECTION CRITERIA       24082099
241300*  ENTERED ON THE SCREEN AND DISPLAY ERROR MESSAGES WHEN INVALID  24083099
241400*  COMBINATIONS HAVE BEEN REQUESTED.                              24084099
241500******************************************************************24085099
240900 33100-EDIT-LOGIC-RELATIONSHIPS.                                  24090000
                                                                        24091099
241000     MOVE '*33100-EDIT-LOGIC-RELATIONSHIPS. *' TO DP013-PARAGRAPH 24100000
      ***************************************************************** 24110099
241600* IF A SKU NUMBER HAS BEEN ENTERED, THEN IT MAKES NO LOGICAL      24160000
241700* SENSE FOR GROUP, VENDOR NUMBER, STYLE OR STATUS CODES TO HAVE   24170000
241800* BEEN ENTERED. HOWEVER, IF A SKU NUMBER HAS BEEN ENTERED, THEN   24180000
241900* THERE HAS TO HAVE BEEN A FULL 2 DIGIT MAJOR/MINOR CLASS ENTERED.24190000
      ***************************************************************** 24191099
242000                                                                  24200000
MC0502     IF  CA-SKU-NUMBER-X GREATER THAN SPACES                      24210099
243500         IF  CA-GROUP-CODE NOT = SPACES                           24350000
243600             MOVE DP015-REVERSE      TO GROUPH                    24360000
243700             MOVE DP015-RED          TO GROUPC                    24370000
243800             MOVE DP015-UNP-ALP-BRT-OFF                           24380000
243900                                     TO GROUPA                    24390000
244000             IF  NOT PS-EDIT-ERROR                                24400000
244100                 SET PS-EDIT-ERROR   TO TRUE                      24410000
244200                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         24420000
244300                 MOVE -1             TO GROUPL                    24430000
244400             END-IF                                               24440000
244500         END-IF                                                   24450000
244600         IF  CA-INHOUSE-NUMBER NOT = SPACES                       24460000
244700             MOVE DP015-REVERSE      TO VENNOH                    24470000
244800             MOVE DP015-RED          TO VENNOC                    24480000
244900             MOVE DP015-UNP-ALP-BRT-OFF                           24490000
245000                                     TO VENNOA                    24500000
245100             IF  NOT PS-EDIT-ERROR                                24510000
245200                 SET PS-EDIT-ERROR   TO TRUE                      24520000
245300                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         24530000
245400                 MOVE -1             TO VENNOL                    24540000
245500             END-IF                                               24550000
245600         END-IF                                                   24560000
245700         IF  CA-STYLE NOT = SPACES                                24570000
245800             MOVE DP015-REVERSE      TO STYLEH                    24580000
245900             MOVE DP015-RED          TO STYLEC                    24590000
246000             MOVE DP015-UNP-ALP-BRT-OFF                           24600000
246100                                     TO STYLEA                    24610000
246200             IF  NOT PS-EDIT-ERROR                                24620000
246300                 SET PS-EDIT-ERROR   TO TRUE                      24630000
246400                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         24640000
246500                 MOVE -1             TO STYLEL                    24650000
246600             END-IF                                               24660000
246700         END-IF                                                   24670000
246800         IF  CA-VSM-REPLENISH NOT = SPACES                        24680071
246900             MOVE DP015-REVERSE      TO REPLENH                   24690071
247000             MOVE DP015-RED          TO REPLENC                   24700071
247100             MOVE DP015-UNP-ALP-BRT-OFF                           24710000
247200                                     TO REPLENA                   24720071
247300             IF  NOT PS-EDIT-ERROR                                24730000
247400                 SET PS-EDIT-ERROR   TO TRUE                      24740000
247500                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         24750000
247600                 MOVE -1             TO REPLENL                   24760071
247700             END-IF                                               24770000
247800         END-IF                                                   24780000
247900         IF  CA-KEY-ITEM NOT = SPACES                             24790071
248000             MOVE DP015-REVERSE      TO KYITMH                    24800071
248100             MOVE DP015-RED          TO KYITMC                    24810071
248200             MOVE DP015-UNP-ALP-BRT-OFF                           24820071
248300                                     TO KYITMA                    24830071
248400             IF  NOT PS-EDIT-ERROR                                24840071
248500                 SET PS-EDIT-ERROR   TO TRUE                      24850071
248600                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         24860071
248700                 MOVE -1             TO KYITML                    24870071
248800             END-IF                                               24880071
248900         END-IF                                                   24890071
249000         IF  CA-TSK-LONG-COLOR NOT = SPACES                       24900077
249100             MOVE DP015-REVERSE      TO COLDSCH                   24910077
249200             MOVE DP015-RED          TO COLDSCC                   24920077
249300             MOVE DP015-UNP-ALP-BRT-OFF                           24930000
249400                                     TO COLDSCA                   24940077
249500             IF  NOT PS-EDIT-ERROR                                24950000
249600                 SET PS-EDIT-ERROR   TO TRUE                      24960000
249700                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         24970000
249800                 MOVE -1             TO COLDSCL                   24980077
249900             END-IF                                               24990000
250000         END-IF                                                   25000000
250100         IF  CA-COLOR-1-X   NOT = SPACES                          25010077
250200             MOVE DP015-REVERSE      TO COLOR1H                   25020077
250300             MOVE DP015-RED          TO COLOR1C                   25030077
250400             MOVE DP015-UNP-ALP-BRT-OFF                           25040077
250500                                     TO COLOR1A                   25050077
250600             IF  NOT PS-EDIT-ERROR                                25060077
250700                 SET PS-EDIT-ERROR   TO TRUE                      25070077
250800                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25080077
250900                 MOVE -1             TO COLOR1L                   25090077
251000             END-IF                                               25100077
251100         END-IF                                                   25110077
251200         IF  CA-COLOR-2-X   NOT = SPACES                          25120000
251300             MOVE DP015-REVERSE      TO COLOR2H                   25130000
251400             MOVE DP015-RED          TO COLOR2C                   25140000
251500             MOVE DP015-UNP-ALP-BRT-OFF                           25150000
251600                                     TO COLOR2A                   25160000
251700             IF  NOT PS-EDIT-ERROR                                25170000
251800                 SET PS-EDIT-ERROR   TO TRUE                      25180000
251900                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25190000
252000                 MOVE -1             TO COLOR2L                   25200000
252100             END-IF                                               25210000
252200         END-IF                                                   25220000
252300         IF  CA-SIZE-DESC NOT = SPACES                            25230000
252400             MOVE DP015-REVERSE      TO SIZEH                     25240000
252500             MOVE DP015-RED          TO SIZEC                     25250000
252600             MOVE DP015-UNP-ALP-BRT-OFF                           25260000
252700                                     TO SIZEA                     25270000
252800             IF  NOT PS-EDIT-ERROR                                25280000
252900                 SET PS-EDIT-ERROR   TO TRUE                      25290000
253000                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25300000
253100                 MOVE -1             TO SIZEL                     25310000
253200             END-IF                                               25320000
253300         END-IF                                                   25330000
257800     END-IF.                                                      25780000
257800                                                                  25780199
      ***************************************************************** 25780299
241600* IF A UPC NUMBER HAS BEEN ENTERED, THEN IT MAKES NO LOGICAL      25780399
241700* SENSE FOR GROUP, VENDOR NUMBER, STYLE OR STATUS CODES TO HAVE   25780499
241800* BEEN ENTERED. HOWEVER, IF A SKU NUMBER HAS BEEN ENTERED, THEN   25780599
241900* THERE HAS TO HAVE BEEN A FULL 2 DIGIT MAJOR/MINOR CLASS ENTERED.25780699
      ***************************************************************** 25780799
240502     IF  CA-UPC-NUMBER-X GREATER THAN SPACES                      25781099
243500         IF  CA-GROUP-CODE NOT = SPACES                           25782099
243600             MOVE DP015-REVERSE      TO GROUPH                    25783099
243700             MOVE DP015-RED          TO GROUPC                    25784099
243800             MOVE DP015-UNP-ALP-BRT-OFF                           25785099
243900                                     TO GROUPA                    25786099
244000             IF  NOT PS-EDIT-ERROR                                25787099
244100                 SET PS-EDIT-ERROR   TO TRUE                      25788099
244200                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25789099
244300                 MOVE -1             TO GROUPL                    25789199
244400             END-IF                                               25789299
244500         END-IF                                                   25789399
244600         IF  CA-INHOUSE-NUMBER NOT = SPACES                       25789499
244700             MOVE DP015-REVERSE      TO VENNOH                    25789599
244800             MOVE DP015-RED          TO VENNOC                    25789699
244900             MOVE DP015-UNP-ALP-BRT-OFF                           25789799
245000                                     TO VENNOA                    25789899
245100             IF  NOT PS-EDIT-ERROR                                25789999
245200                 SET PS-EDIT-ERROR   TO TRUE                      25790099
245300                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25790199
245400                 MOVE -1             TO VENNOL                    25790299
245500             END-IF                                               25790399
245600         END-IF                                                   25790499
245700         IF  CA-STYLE NOT = SPACES                                25790599
245800             MOVE DP015-REVERSE      TO STYLEH                    25790699
245900             MOVE DP015-RED          TO STYLEC                    25790799
246000             MOVE DP015-UNP-ALP-BRT-OFF                           25790899
246100                                     TO STYLEA                    25790999
246200             IF  NOT PS-EDIT-ERROR                                25791099
246300                 SET PS-EDIT-ERROR   TO TRUE                      25791199
246400                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25791299
246500                 MOVE -1             TO STYLEL                    25791399
246600             END-IF                                               25791499
246700         END-IF                                                   25791599
246800         IF  CA-VSM-REPLENISH NOT = SPACES                        25791699
246900             MOVE DP015-REVERSE      TO REPLENH                   25791799
247000             MOVE DP015-RED          TO REPLENC                   25791899
247100             MOVE DP015-UNP-ALP-BRT-OFF                           25791999
247200                                     TO REPLENA                   25792099
247300             IF  NOT PS-EDIT-ERROR                                25792199
247400                 SET PS-EDIT-ERROR   TO TRUE                      25792299
247500                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25792399
247600                 MOVE -1             TO REPLENL                   25792499
247700             END-IF                                               25792599
247800         END-IF                                                   25792699
247900         IF  CA-KEY-ITEM NOT = SPACES                             25792799
248000             MOVE DP015-REVERSE      TO KYITMH                    25792899
248100             MOVE DP015-RED          TO KYITMC                    25792999
248200             MOVE DP015-UNP-ALP-BRT-OFF                           25793099
248300                                     TO KYITMA                    25793199
248400             IF  NOT PS-EDIT-ERROR                                25793299
248500                 SET PS-EDIT-ERROR   TO TRUE                      25793399
248600                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25793499
248700                 MOVE -1             TO KYITML                    25793599
248800             END-IF                                               25793699
248900         END-IF                                                   25793799
249000         IF  CA-TSK-LONG-COLOR NOT = SPACES                       25793899
249100             MOVE DP015-REVERSE      TO COLDSCH                   25793999
249200             MOVE DP015-RED          TO COLDSCC                   25794099
249300             MOVE DP015-UNP-ALP-BRT-OFF                           25794199
249400                                     TO COLDSCA                   25794299
249500             IF  NOT PS-EDIT-ERROR                                25794399
249600                 SET PS-EDIT-ERROR   TO TRUE                      25794499
249700                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25794599
249800                 MOVE -1             TO COLDSCL                   25794699
249900             END-IF                                               25794799
250000         END-IF                                                   25794899
250100         IF  CA-COLOR-1-X   NOT = SPACES                          25794999
250200             MOVE DP015-REVERSE      TO COLOR1H                   25795099
250300             MOVE DP015-RED          TO COLOR1C                   25795199
250400             MOVE DP015-UNP-ALP-BRT-OFF                           25795299
250500                                     TO COLOR1A                   25795399
250600             IF  NOT PS-EDIT-ERROR                                25795499
250700                 SET PS-EDIT-ERROR   TO TRUE                      25795599
250800                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25795699
250900                 MOVE -1             TO COLOR1L                   25795799
251000             END-IF                                               25795899
251100         END-IF                                                   25795999
251200         IF  CA-COLOR-2-X   NOT = SPACES                          25796099
251300             MOVE DP015-REVERSE      TO COLOR2H                   25796199
251400             MOVE DP015-RED          TO COLOR2C                   25796299
251500             MOVE DP015-UNP-ALP-BRT-OFF                           25796399
251600                                     TO COLOR2A                   25796499
251700             IF  NOT PS-EDIT-ERROR                                25796599
251800                 SET PS-EDIT-ERROR   TO TRUE                      25796699
251900                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25796799
252000                 MOVE -1             TO COLOR2L                   25796899
252100             END-IF                                               25796999
252200         END-IF                                                   25797099
252300         IF  CA-SIZE-DESC NOT = SPACES                            25797199
252400             MOVE DP015-REVERSE      TO SIZEH                     25797299
252500             MOVE DP015-RED          TO SIZEC                     25797399
252600             MOVE DP015-UNP-ALP-BRT-OFF                           25797499
252700                                     TO SIZEA                     25797599
252800             IF  NOT PS-EDIT-ERROR                                25797699
252900                 SET PS-EDIT-ERROR   TO TRUE                      25797799
253000                 MOVE PC-TSYMSG-00402 TO DP020-MSG-NUMBER         25797899
253100                 MOVE -1             TO SIZEL                     25797999
253200             END-IF                                               25798099
253300         END-IF                                                   25798199
257800     END-IF.                                                      25798299
257900                                                                  25799000
258000*  ENTRY OF STORE / DISTRICT ------------ ARE MUTUALLY EXCLUSIVE  25800099
258100                                                                  25810000
258200      IF DP020-SRC-AID =  DP016-PF17 AND                          25820088
258300         (CA-DISTRICT-NUMBER  NOT = SPACES )                      25830099
258500          IF CA-DISTRICT-NUMBER  NOT = SPACES                     25850088
258600             MOVE DP015-REVERSE          TO DISTH                 25860088
258700             MOVE DP015-RED              TO DISTC                 25870088
258800             MOVE DP015-UNP-ALP-BRT-OFF  TO DISTA                 25880088
258900             IF NOT PS-EDIT-ERROR                                 25890088
259000                SET PS-EDIT-ERROR        TO TRUE                  25900088
259100                MOVE -1                  TO DISTL                 25910088
259200             END-IF                                               25920088
259300          END-IF                                                  25930088
260300          MOVE PC-TSYMSG-01540    TO DP020-MSG-NUMBER             26030089
260400      END-IF.                                                     26040088
260500                                                                  26050041
260600      IF (CA-STORE-NUMBER-X   NOT = SPACES AND                    26160199
260800          CA-DISTRICT-NUMBER  NOT = SPACES)                       26160399
262500         IF CA-DISTRICT-NUMBER  NOT = SPACES                      26250081
262600            MOVE DP015-REVERSE          TO DISTH                  26260081
262700            MOVE DP015-RED              TO DISTC                  26270081
262800            MOVE DP015-UNP-ALP-BRT-OFF  TO DISTA                  26280081
262900            IF NOT PS-EDIT-ERROR                                  26290081
263000               MOVE -1                  TO DISTL                  26300081
263100            END-IF                                                26310081
263200         END-IF                                                   26320081
263300         IF CA-STORE-NUMBER-X   NOT = SPACES                      26330081
263400            MOVE DP015-REVERSE          TO STOREH                 26340081
263500            MOVE DP015-RED              TO STOREC                 26350074
263600            MOVE DP015-UNP-ALP-BRT-OFF  TO STOREA                 26360074
263700            IF NOT PS-EDIT-ERROR                                  26370081
263800               MOVE -1                  TO STOREL                 26380081
263900            END-IF                                                26390081
264000         END-IF                                                   26400074
264100         IF  NOT PS-EDIT-ERROR                                    26410041
264200             SET PS-EDIT-ERROR       TO TRUE                      26420041
264300             MOVE PC-TSYMSG-01537    TO DP020-MSG-NUMBER          26430074
264400         END-IF                                                   26440041
264500     END-IF.                                                      26450041
264600                                                                  26460000
MC0502     IF  CA-SKU-NUMBER-X NUMERIC                                  26470099
265000         PERFORM 33150-EDIT-VALID-SKU                             26500000
265100     END-IF.                                                      26510000
265200                                                                  26520041
269100******************************************************************26910099
269200* CHECK IF DEPARTMENT / CLASS / SKU EXISTS                        26920099
269300******************************************************************26930099
269500 33150-EDIT-VALID-SKU.                                            26950000
269400                                                                  26951099
269600     MOVE '*33150-EDIT-VALID-SKU.           *' TO DP013-PARAGRAPH 26960000
269700     INITIALIZE PV-RETRY-COUNT.                                   26970000
269800     PERFORM WITH TEST AFTER                                      26980000
269900             UNTIL ((SQLCODE = ZERO)                              26990000
270000                           OR                                     27000000
270100                    (SQLCODE = +100)                              27010000
270200                           OR                                     27020000
270300                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    27030000
270400         EXEC SQL                                                 27040000
MC0502             SELECT DEPT,                                         27050099
MC0502                    SUBCLASS,                                     27050199
MC0502                    SKU,                                          27050299
270500                    SKU_DESC,                                     27051099
270600                    SIZE_DESC,                                    27060000
270700                    COLOR_DESC,                                   27070000
270800                    UNIT_COST_AMT,                                27080000
270900                    ORIG_UNIT_RTL_AMT,                            27090000
271000                    CUR_UNIT_RTL_AMT,                             27100000
271100                    LONG_SIZE_DESC,                               27110000
271200                    LONG_COLOR_DESC,                              27120000
271300                    GP_RTL_AMT,                                   27130000
271400                    GP_QTY,                                       27140000
271500                    SIZE_CDE                                      27150000
MC0502                 INTO :SKXREF-DEPT,                               27160099
MC0502                      :SKXREF-SUBCLASS,                           27160199
MC0502                      :SKXREF-SKU,                                27160299
MC0502                      :TSK-SKU-DESC,                              27161099
271700                      :TSK-SIZE-DESC,                             27170000
271800                      :TSK-COLOR-DESC,                            27180000
271900                      :TSK-UNIT-COST-AMT,                         27190000
272000                      :TSK-ORIG-UNIT-RTL-AMT,                     27200000
272100                      :TSK-CUR-UNIT-RTL-AMT,                      27210000
272200                      :TSK-LONG-SIZE-DESC,                        27220000
272300                      :TSK-LONG-COLOR-DESC,                       27230000
272400                      :TSK-GP-RTL-AMT,                            27240000
272500                      :TSK-GP-QTY,                                27250000
272600                      :TSK-SIZE-CDE                               27260000
272700                 FROM TSK S                                       27270099
MC0502                 JOIN TSKXREF X                                   27271099
MC0502                   ON S.ITEM_NMBR = X.ITM_NBR                     27272099
MC0502                 WHERE SKU      = :NI-SKU-9-8                     27280099
MC0502                   AND SKU_STAT_CDE NOT IN ('00','98')            27330099
273500         END-EXEC                                                 27350000
273600         EVALUATE TRUE                                            27360000
273700             WHEN SQLCODE = -911                                  27370099
273800             WHEN SQLCODE = -913                                  27380000
273900                 ADD +1              TO PV-RETRY-COUNT            27390000
274000             WHEN SQLCODE = ZERO                                  27400000
274100                 MOVE TSK-SKU-DESC   TO CA-SKU-DESCRIPTION        27410000
274200                                        SKUDSCO                   27420000
MC0502                 MOVE SKXREF-DEPT       TO CA-DEPT-NUMBER-9       27421099
MC0502                 MOVE CA-DEPT-NUMBER-X  TO DEPTO                  27422099
MC0502                 MOVE SKXREF-SUBCLASS   TO CA-CLASS-NUMBER-9      27423099
MC0502                 MOVE CA-CLASS-NUMBER-X TO CLASSO                 27424099
274300                 MOVE TSK-UNIT-COST-AMT                           27430000
274400                                     TO CA-TSK-COST               27440000
274500                 MOVE TSK-ORIG-UNIT-RTL-AMT                       27450000
274600                                     TO CA-TSK-ORG-RTL            27460000
274700                 IF CA-STAT-25-ENTERED                            27470099
274700                    MOVE 'MIXED'     TO CA-TSK-CUR-RTL-X          27471099
274700                 ELSE                                             27471199
274700                    MOVE TSK-CUR-UNIT-RTL-AMT                     27471299
274800                                     TO CA-TSK-CUR-RTL            27471399
274700                 END-IF                                           27471499
274900*MED                                                              27490000
275000                 IF TSK-LONG-COLOR-DESC = SPACES                  27500000
275100                    MOVE TSK-COLOR-DESC  TO CA-TSK-COLOR          27510000
275200                 ELSE                                             27520000
275300                    MOVE TSK-LONG-COLOR-DESC                      27530000
275400                                         TO CA-TSK-COLOR          27540000
275500                 END-IF                                           27550000
275600*MED                                                              27560000
275700                 IF  TSK-GP-QTY > 1                               27570000
275800                     MOVE TSK-GP-RTL-AMT                          27580000
275900                                     TO CA-TSK-GP-RTL             27590000
276000                     MOVE PC-SLASH   TO CA-TSK-GP-SLASH           27600000
276100                     MOVE TSK-GP-QTY TO CA-TSK-GP-QTY             27610000
276200                 ELSE                                             27620000
276300                     MOVE SPACES     TO CA-TSK-GP-QTY-RTL         27630000
276400                 END-IF                                           27640000
276500             WHEN SQLCODE = +100                                  27650000
276600                 CONTINUE                                         27660000
276700             WHEN SQLCODE < ZERO                                  27670000
276800             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     27680000
276900             WHEN SQLWARN0 NOT = SPACES                           27690000
277000                 MOVE PC-ERR-MSG-3   TO DP013-MESSAGE-TEXT(1)     27700000
277100                 PERFORM 9900-DB2-ERROR                           27710000
277200         END-EVALUATE                                             27720000
277300     END-PERFORM.                                                 27730000
277400                                                                  27740000
277500     IF  ((SQLCODE = -911)                                        27750099
277600               OR                                                 27760000
277700         (SQLCODE = -913))                                        27770000
277800         PERFORM 9900-DB2-ERROR                                   27780000
277900     END-IF.                                                      27790000
278000                                                                  27800000
278100     IF  SQLCODE = +100                                           27810000
278200         MOVE DP015-REVERSE          TO SKUH                      27820000
278300         MOVE DP015-RED              TO SKUC                      27830000
278400         MOVE DP015-UNP-ALP-BRT-OFF  TO SKUA                      27840000
278500         IF  NOT PS-EDIT-ERROR                                    27850000
278600             SET PS-EDIT-ERROR       TO TRUE                      27860000
278700             MOVE PC-TSYMSG-00073    TO DP020-MSG-NUMBER          27870099
278800             MOVE -1                 TO SKUL                      27880000
278900         END-IF                                                   27890000
279000     END-IF.                                                      27900000
279100                                                                  27910005
279200     IF  SQLCODE = ZERO                                           27920005
279300         MOVE TSK-SIZE-CDE  TO SIZE-NRF-SIZE-CDE                  27930005
279400         PERFORM 33160-GET-SIZE-DESC                              27940005
279500                                                                  27950005
279600         IF PS-SIZE-DESC-FOUND                                    27960005
279700            MOVE SIZE-KOHLS-DESC       TO CA-TSK-SIZE             27970005
279800         ELSE                                                     27980005
279900            IF TSK-LONG-SIZE-DESC = SPACES                        27990005
280000               MOVE TSK-SIZE-DESC      TO CA-TSK-SIZE             28000005
280100            ELSE                                                  28010005
280200               MOVE TSK-LONG-SIZE-DESC TO CA-TSK-SIZE             28020005
280300            END-IF                                                28030005
280400         END-IF                                                   28040005
280500     END-IF.                                                      28050005
280600*                                                                 28060000
269100******************************************************************28061099
269200* CHECK IF SKU EXISTS (DEPT & CLASS HAVE NOT BEEN ENTERED)        28062099
269200* (PLEASE NOTE THIS SQL IS THE SAME AS 33150-....                 28062199
269200*  THIS CHECK WAS ADDED WITH THE NEW SKU CHANGE)                  28062299
269300******************************************************************28063099
269500 33155-VALIDATE-SKU.                                              28064099
269400                                                                  28065099
269600     MOVE '*33155-VALIDATE-SKU.           *' TO DP013-PARAGRAPH   28066099
269700     INITIALIZE PV-RETRY-COUNT.                                   28067099
269800     PERFORM WITH TEST AFTER                                      28068099
269900             UNTIL ((SQLCODE = ZERO)                              28069099
270000                           OR                                     28069199
270100                    (SQLCODE = +100)                              28069299
270200                           OR                                     28069399
270300                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    28069499
270400         EXEC SQL                                                 28069599
MC0502             SELECT DEPT,                                         28069699
MC0502                    SUBCLASS,                                     28069799
MC0502                    SKU,                                          28069899
270500                    SKU_DESC,                                     28069999
270600                    SIZE_DESC,                                    28070099
270700                    COLOR_DESC,                                   28070199
270800                    UNIT_COST_AMT,                                28070299
270900                    ORIG_UNIT_RTL_AMT,                            28070399
271000                    CUR_UNIT_RTL_AMT,                             28070499
271100                    LONG_SIZE_DESC,                               28070599
271200                    LONG_COLOR_DESC,                              28070699
271300                    GP_RTL_AMT,                                   28070799
271400                    GP_QTY,                                       28070899
271500                    SIZE_CDE                                      28070999
MC0502                 INTO :SKXREF-DEPT,                               28071099
MC0502                      :SKXREF-SUBCLASS,                           28071199
MC0502                      :SKXREF-SKU,                                28071299
MC0502                      :TSK-SKU-DESC,                              28071399
271700                      :TSK-SIZE-DESC,                             28071499
271800                      :TSK-COLOR-DESC,                            28071599
271900                      :TSK-UNIT-COST-AMT,                         28071699
272000                      :TSK-ORIG-UNIT-RTL-AMT,                     28071799
272100                      :TSK-CUR-UNIT-RTL-AMT,                      28071899
272200                      :TSK-LONG-SIZE-DESC,                        28071999
272300                      :TSK-LONG-COLOR-DESC,                       28072099
272400                      :TSK-GP-RTL-AMT,                            28072199
272500                      :TSK-GP-QTY,                                28072299
272600                      :TSK-SIZE-CDE                               28072399
272700                 FROM TSK S                                       28072499
MC0502                 JOIN TSKXREF X                                   28072599
MC0502                   ON S.ITEM_NMBR   = X.ITM_NBR                   28072699
MC0502                 WHERE  (X.SKU      = :NI-SKU-9-8) AND            28072799
273400                        (X.SKU_STAT_CDE NOT IN ('00','98'))       28073399
273500         END-EXEC                                                 28073499
273600         EVALUATE TRUE                                            28073599
273700             WHEN SQLCODE = -911                                  28073699
273800             WHEN SQLCODE = -913                                  28073799
273900                 ADD +1              TO PV-RETRY-COUNT            28073899
274000             WHEN SQLCODE = ZERO                                  28073999
MC0502                 MOVE SKXREF-DEPT      TO CA-DEPT-NUMBER-9        28074099
MC0502                                          NI-DEPT-9-4             28074199
MC0502                 MOVE SKXREF-SUBCLASS  TO CA-CLASS-NUMBER-9       28074299
MC0502                                          NI-CLASS-9-4            28074399
276500             WHEN SQLCODE = +100                                  28077099
278200                  MOVE DP015-REVERSE          TO SKUH             28077399
278300                  MOVE DP015-RED              TO SKUC             28077499
278400                  MOVE DP015-UNP-ALP-BRT-OFF  TO SKUA             28077599
278500                  IF  NOT PS-EDIT-ERROR                           28077699
278600                      SET PS-EDIT-ERROR       TO TRUE             28077799
278700                      MOVE PC-TSYMSG-00073    TO DP020-MSG-NUMBER 28077899
278800                      MOVE -1                 TO SKUL             28077999
278900                  END-IF                                          28078099
276700             WHEN SQLCODE < ZERO                                  28078299
276800             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     28078399
276900             WHEN SQLWARN0 NOT = SPACES                           28078499
277000                 MOVE PC-ERR-MSG-3   TO DP013-MESSAGE-TEXT(1)     28078599
277100                 PERFORM 9900-DB2-ERROR                           28078699
277200         END-EVALUATE                                             28078799
277300     END-PERFORM.                                                 28078899
277400                                                                  28078999
280700******************************************************************28079000
280800*  GET THE KOHL'S SIZE DESCRIPTION FOR A SPECIFIC SKU SIZE CODE. *28080000
280900*  SELECT THE REQUIRED SIZE DESC INFORMATION FROM THE DB2 TSIZE  *28090000
281000*  TABLE USING THE SKU TABLE (TSK) SIZE_CDE.                     *28100000
281100*  IF A RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE     *28110000
281200*  SELECT WILL BE RETRIED UP TO A SET NUMBER OF TIMES.  IF NO    *28120000
281300*  DESCRIPTION IS FOUND FOR THE SKU SIZE CODE WHERE THE          *28130000
281400*  EFF-END-DTE FIELD IS GREATER THAN THE CURRENT DATE, THE MOST  *28140000
281500*  CURRENT EXPIRED DESCRIPTION WILL BE SELECTED (PARA 33170-)    *28150000
281600******************************************************************28160000
281800 33160-GET-SIZE-DESC.                                             28180000
281700                                                                  28181099
281900     MOVE '*33160-GET-SIZE-DESC.     *' TO DP013-PARAGRAPH.       28190000
282000                                                                  28200000
282100     INITIALIZE PV-RETRY-COUNT.                                   28210000
282200     PERFORM 33165-SELECT-VALID-SIZE-DESC                         28220000
282300         WITH TEST AFTER                                          28230000
282400         UNTIL ((SQLCODE = ZERO)                                  28240000
282500             OR (SQLCODE = +100)                                  28250000
282600             OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)).       28260000
282700                                                                  28270000
282800     EVALUATE TRUE                                                28280000
282900         WHEN SQLCODE = 0                                         28290000
283000             SET PS-SIZE-DESC-FOUND TO TRUE                       28300000
283100         WHEN SQLCODE = +100                                      28310000
283200             PERFORM 33170-GET-MOST-CURR-SIZE                     28320002
283300         WHEN SQLCODE = -911                                      28330099
283400         WHEN SQLCODE = -913                                      28340000
283500             MOVE 'SELECT A DESC FROM THE SIZE TABLE (TSIZE)' TO  28350000
283600                       DP013-MESSAGE-TEXT(1)                      28360000
283700             PERFORM 9900-DB2-ERROR                               28370000
283800         WHEN OTHER                                               28380000
283900             SET PS-SIZE-DESC-NOT-FOUND TO TRUE                   28390000
284000     END-EVALUATE.                                                28400000
284100                                                                  28410000
284200*33160-EXIT.                                                      28420000
284300                                                                  28430000
284400******************************************************************28440000
284500*  SELECT INFORMATION FROM THE SIZETABLE FOR THE CURRENT SKU.    *28450000
284600*  IF THE RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE   *28460000
284700*  SELECT WILL BE RETRIED.  IF ANY OTHER ERRORS ARE DETECTED,    *28470000
284800*  AN ERROR MESSAGE WILL BE FORMATTED AND SENT TO THE SCREEN,    *28480000
284900*  AND CONTROL WILL BE RETURNED TO NATIVE CICS.                  *28490000
285000******************************************************************28500000
285200 33165-SELECT-VALID-SIZE-DESC.                                    28520000
285100                                                                  28521099
285300     MOVE '*33165-SELECT-VALID-SIZE-DESC    *' TO DP013-PARAGRAPH 28530000
285400     EXEC SQL                                                     28540000
285500         SELECT KOHLS_DESC                                        28550000
285600             INTO :SIZE-KOHLS-DESC                                28560000
285700             FROM TSIZE                                           28570000
285800             WHERE NRF_SIZE_CDE = :SIZE-NRF-SIZE-CDE AND          28580000
285900                   (EFF_END_DTE IS NULL               OR          28590000
286000                    EFF_END_DTE > CURRENT DATE)                   28600000
286100     END-EXEC.                                                    28610000
286200                                                                  28620000
286300     EVALUATE TRUE                                                28630000
286400         WHEN SQLCODE = 0                                         28640000
286500         WHEN SQLCODE = +100                                      28650000
286600             CONTINUE                                             28660000
286700         WHEN SQLCODE = -911                                      28670099
286800         WHEN SQLCODE = -913                                      28680000
286900             ADD 1 TO PV-RETRY-COUNT                              28690000
287000         WHEN SQLWARN0 NOT = SPACES                               28700000
287100         WHEN SQLCODE  NOT = ZERO                                 28710000
287200             MOVE 'SELECT A SIZE DESC FORM SIZE TABLE (TSIZE)' TO 28720000
287300                      DP013-MESSAGE-TEXT(1)                       28730000
287400             PERFORM 9900-DB2-ERROR                               28740000
287500     END-EVALUATE.                                                28750000
287600*33165-EXIT.                                                      28760000
287700                                                                  28770000
287800******************************************************************28780000
287900*  GET THE KOHL'S SIZE DESCRIPTION FOR A SPECIFIC SKU SIZE CODE. *28790000
288000*  SELECT THE REQUIRED SIZE DESC INFORMATION FROM THE DB2 TSIZE  *28800000
288100*  TABLE USING THE SKU TABLE (TSK) SIZE_CDE.  THE MOST CURRENT   *28810000
288200*  EXPIRED DESCRIPTION WILL BE SELECTED AND DISPLAYED SINCE NO   *28820000
288300*  VALID DESCRIPTION WAS FOUND IN PARAGRAPH 33160-.              *28830000
288400*  IF A RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE     *28840000
288500*  SELECT WILL BE RETRIED UP TO A SET NUMBER OF TIMES.  IF NO    *28850000
288600*  DESCRIPTION IS FOUND FOR THE SKU SIZE CODE, THE SKU TABLE     *28860000
288700*  SIZE DESCRIPTION WILL BE DISPLAYED.                           *28870000
288800******************************************************************28880000
289000 33170-GET-MOST-CURR-SIZE.                                        28900002
288900                                                                  28901099
289100     MOVE '*33170-GET-MOST-CURR-SIZE.  *' TO DP013-PARAGRAPH.     28910002
289200                                                                  28920000
289300     INITIALIZE PV-RETRY-COUNT.                                   28930000
289400     PERFORM 33175-SELECT-OUTDATED-SIZE                           28940003
289500         WITH TEST AFTER                                          28950000
289600         UNTIL ((SQLCODE = ZERO)                                  28960000
289700             OR (SQLCODE = +100)                                  28970000
289800             OR (SQLCODE = -811)                                  28980000
289900             OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)).       28990000
290000                                                                  29000000
290100     EVALUATE TRUE                                                29010000
290200         WHEN SQLCODE = +100                                      29020000
290300             SET PS-SIZE-DESC-NOT-FOUND TO TRUE                   29030000
290400         WHEN SQLCODE = -911                                      29040099
290500         WHEN SQLCODE = -913                                      29050000
290600             MOVE 'SELECT MOST CURR DESC FROM SIZE TBL (TSIZE)' TO29060000
290700                       DP013-MESSAGE-TEXT(1)                      29070000
290800             PERFORM 9900-DB2-ERROR                               29080000
290900         WHEN OTHER                                               29090000
291000             SET PS-SIZE-DESC-FOUND TO TRUE                       29100000
291100     END-EVALUATE.                                                29110000
291200                                                                  29120000
291300*33170-EXIT.                                                      29130000
291400                                                                  29140000
291500******************************************************************29150000
291600*  SELECT INFORMATION FROM THE SIZETABLE FOR THE CURRENT SKU.    *29160000
291700*  IF THE RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE   *29170000
291800*  SELECT WILL BE RETRIED.  IF ANY OTHER ERRORS ARE DETECTED,    *29180000
291900*  AN ERROR MESSAGE WILL BE FORMATTED AND SENT TO THE SCREEN,    *29190000
292000*  AND CONTROL WILL BE RETURNED TO NATIVE CICS.                  *29200000
292100******************************************************************29210000
292300 33175-SELECT-OUTDATED-SIZE.                                      29230004
                                                                        29231099
292400     MOVE '*33175-SELECT-OUTDATED-SIZE. *' TO DP013-PARAGRAPH     29240003
292500     EXEC SQL                                                     29250000
292600         SELECT KOHLS_DESC                                        29260000
292700             INTO :SIZE-KOHLS-DESC                                29270000
292800             FROM TSIZE                                           29280000
292900             WHERE NRF_SIZE_CDE = : SIZE-NRF-SIZE-CDE AND         29290000
293000                   EFF_END_DTE  =                                 29300000
293100                   ( SELECT MAX (EFF_END_DTE)                     29310000
293200                     FROM   TSIZE                                 29320000
293300                     WHERE  NRF_SIZE_CDE = :SIZE-NRF-SIZE-CDE)    29330000
293400     END-EXEC.                                                    29340000
293500                                                                  29350000
293600     EVALUATE TRUE                                                29360000
293700         WHEN SQLCODE = 0                                         29370000
293800         WHEN SQLCODE = +100                                      29380000
293900         WHEN SQLCODE = -811                                      29390000
294000             CONTINUE                                             29400000
294100         WHEN SQLCODE = -911                                      29410099
294200         WHEN SQLCODE = -913                                      29420000
294300             ADD 1 TO PV-RETRY-COUNT                              29430000
294400         WHEN SQLWARN0 NOT = SPACES                               29440000
294500         WHEN SQLCODE  NOT = ZERO                                 29450000
294600             MOVE 'SELECT OUTDATED DESC FROM SIZE TABLE(TSIZE)' TO29460000
294700                      DP013-MESSAGE-TEXT(1)                       29470000
294800             PERFORM 9900-DB2-ERROR                               29480000
294900     END-EVALUATE.                                                29490000
295000                                                                  29500000
295100*33175-EXIT.                                                      29510000
                                                                        29511099
      ******************************************************************29512099
      ** VALIDATE UPC NUMBER.                                         **29513099
      ******************************************************************29514099
       33180-VALIDATE-UPC-NBR.                                          29515099
                                                                        29516099
           MOVE CA-UPC-NUMBER-9 TO PV-UPC-NBR.                          29517099
                                                                        29518099
           PERFORM                                                      29519099
               WITH TEST AFTER                                          29519199
               VARYING PV-RETRY-COUNT                                   29519399
               FROM 1 BY 1                                              29519499
               UNTIL ((PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)         29519599
                         OR (SQLCODE = ZERO)                            29519699
                         OR (SQLCODE = +100))                           29519799
               EXEC SQL                                                 29519899
                 SELECT X.DEPT                                          29519999
                       ,X.CLASS                                         29520099
                       ,X.SUBCLASS                                      29520199
                       ,X.SKU                                           29521099
                       ,X.ITM_NBR                                       29522099
                   INTO :SKXREF-DEPT                                    29523099
                       ,:SKXREF-CLASS                                   29524099
                       ,:SKXREF-SUBCLASS                                29525099
                       ,:SKXREF-SKU                                     29526099
                       ,:SKXREF-ITM-NBR                                 29527099
                   FROM TUPCSKU U                                       29528099
                       ,TSKXREF X                                       29529099
                  WHERE U.ITEM_NBR = X.ITM_NBR                          29529199
                    AND X.SKU_STAT_CDE ^= '00'                          29529299
                    AND U.UPC_NBR = :PV-UPC-NBR                         29529399
               END-EXEC                                                 29529499
                                                                        29529599
               EVALUATE TRUE                                            29529699
                   WHEN SQLCODE = ZERO                                  29529799
                        PERFORM 33185-MOVE-UPC-VALUES                   29529899
                   WHEN SQLCODE = +100                                  29529999
278200                  MOVE DP015-REVERSE          TO UPCH             29530199
278300                  MOVE DP015-RED              TO UPCC             29530299
278400                  MOVE DP015-UNP-ALP-BRT-OFF  TO UPCA             29530399
278500                  IF  NOT PS-EDIT-ERROR                           29530499
278600                      SET PS-EDIT-ERROR       TO TRUE             29530599
278700                      MOVE PC-TSYMSG-00100    TO DP020-MSG-NUMBER 29530699
278800                      MOVE -1                 TO UPCL             29530799
278900                  END-IF                                          29530899
                   WHEN SQLWARN0 NOT = SPACES                           29530999
                   WHEN SQLCODE < ZERO                                  29531099
                   WHEN SQLCODE > ZERO                                  29531199
                       MOVE '33180-VALIDATE-UPC-NBR'                    29531299
                                         TO DP013-PARAGRAPH             29531399
                       MOVE 'VALIDATE UPC NUMBER'                       29531499
                                         TO DP013-MESSAGE-TEXT (1)      29531599
                       MOVE SQLCA        TO DP013-SQLCA                 29531699
                       MOVE 'TUPCSKU'    TO DP013-DB2-TABLE-NAME (1)    29531799
                       SET DP013-DB2-ABEND                              29531899
                           DP013-XCTL-DISPLAY-RESTART                   29531999
                                         TO TRUE                        29532099
                       PERFORM DP013-0000-PROCESS-ABEND                 29532199
               END-EVALUATE                                             29532299
           END-PERFORM.                                                 29532399
                                                                        29532499
           IF  PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                  29532599
               MOVE '33180-VALIDATE-UPC-NBR'                            29532699
                                         TO DP013-PARAGRAPH             29532799
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29532899
                                         TO DP013-MESSAGE-TEXT (1)      29532999
               MOVE 'VALIDATE UPC NUMBER'                               29533099
                                         TO DP013-MESSAGE-TEXT (2)      29533199
               MOVE SQLCA                TO DP013-SQLCA                 29533299
               MOVE 'TUPCSKU'            TO DP013-DB2-TABLE-NAME (1)    29533399
               SET DP013-DB2-ABEND                                      29533499
                   DP013-XCTL-DISPLAY-RESTART                           29533599
                                         TO TRUE                        29533699
               PERFORM DP013-0000-PROCESS-ABEND                         29533799
           END-IF.                                                      29533899
                                                                        29533999
295100*33180-EXIT.                                                      29534099
295200                                                                  29534100
      ******************************************************************29534299
      ** VALID UPC - MOVE DETAIL TO COMMAREA & SCREEN.                **29534399
      ******************************************************************29534499
       33185-MOVE-UPC-VALUES.                                           29534599
                                                                        29535099
           MOVE SKXREF-SKU       TO CA-SKU-NUMBER-9                     29535499
MC0502                              NI-SKU-9-8.                         29535599
                                                                        29539699
295600******************************************************************29539799
295700*  FIND THE VENDOR NAME FOR THE NUMERIC VENDOR NUMBER ENTERED    *29539899
295800*  ON THE SCREEN.                                                *29539999
295900******************************************************************29540099
295400 33200-GET-DEPT-VENDOR.                                           29540100
                                                                        29541099
295500     MOVE '*33200-GET-DEPT-VENDOR.          *' TO DP013-PARAGRAPH 29550000
296000     SET PS-DEPT-NOT-FOUND           TO TRUE.                     29600000
296100     SET PS-VENDOR-NAME-NOT-FOUND    TO TRUE.                     29610000
296200                                                                  29620000
296300                                                                  29630000
296400     MOVE DP015-HL-OFF               TO DPTDSCH.                  29640000
296500     MOVE DP015-BLUE                 TO DPTDSCC.                  29650000
296600     MOVE DP015-ASK-NOR-OFF          TO DPTDSCA.                  29660000
296700                                                                  29670000
296800     IF CA-INHOUSE-NUMBER NUMERIC                                 29680099
296900        PERFORM 33250-GET-VENDOR-NAME                             29690099
297000        IF PS-VENDOR-NAME-FOUND                                   29700099
297100           MOVE ENTNME-ENT-NAME-DESC TO VENNMI                    29710099
297200                                        CA-VENDOR-NAME            29720099
297300       END-IF                                                     29730099
297400     END-IF.                                                      29740099
297500                                                                  29750086
297600     PERFORM 33260-GET-DEPT-NAME.                                 29760000
297700     IF  PS-DEPT-FOUND                                            29770000
297800         MOVE MDSEAR-DESC            TO DPTDSCI                   29780000
297900                                        CA-DEPT-NAME              29790000
298000     ELSE                                                         29800000
298100         MOVE SPACES                 TO DPTDSCI                   29810000
298200                                        CA-DEPT-NAME              29820000
298300     END-IF.                                                      29830000
298400                                                                  29840099
298500*                                                                 29850000
298800******************************************************************29851099
298900*  READ THE VENDOR NAME FROM THE ENTITY TABLE USING THE          *29852099
299000*  DEPARTMENT NUMBER AND THE IN-HOUSE VENDOR NUMBER THAT IS      *29853099
299100*  PASSED IN THE COMMAREA.                                       *29854099
299200******************************************************************29855099
298600 33250-GET-VENDOR-NAME.                                           29860000
                                                                        29861099
298700     MOVE '*33250-GET-VENDOR-NAME.          *' TO DP013-PARAGRAPH 29870000
299300     INITIALIZE PV-RETRY-COUNT.                                   29930099
                                                                        29931099
299400     MOVE CA-DEPT-NUMBER-X    TO PV-DEPT-NUMBER.                  29940084
299500     MOVE CA-INHOUSE-NUMBER-9 TO PV-INHOUSE-NUMBER.               29950000
321100     MOVE '01'                TO PV-VENDOR-TYPE                   29950199
                                                                        29950299
299600     PERFORM                                                      29960000
299700         WITH TEST AFTER                                          29970000
299800         UNTIL SQLCODE = ZERO                                     29980000
299900            OR SQLCODE = +100                                     29990000
300000            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT            30000000
300100         EXEC SQL                                                 30010000
300200              SELECT TENTNME.ENT_NAME_DESC                        30020000
300300                INTO :ENTNME-ENT-NAME-DESC                        30030000
300400                FROM TVNDDPT,                                     30040000
300500                     TENTNME                                      30050000
300600               WHERE TVNDDPT.DEPT_NBR    = :PV-DEPT-NUMBER        30060084
300700                 AND TVNDDPT.INHOUSE_NBR = :PV-INHOUSE-NUMBER     30070000
300800                 AND TENTNME.ENT_ID      = TVNDDPT.ENT_ID         30080084
322500                 AND TENTNME.TYPE_CDE    = :PV-VENDOR-TYPE        30091099
301000         END-EXEC                                                 30100000
301100         EVALUATE TRUE                                            30110000
301200             WHEN SQLCODE = ZERO OR -811                          30120099
301300                  CONTINUE                                        30130000
301400             WHEN SQLCODE = -911                                  30140099
301500             WHEN SQLCODE = -913                                  30150000
301600                  ADD +1 TO PV-RETRY-COUNT                        30160000
301700             WHEN SQLCODE < ZERO                                  30170000
301800             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     30180000
301900             WHEN SQLWARN0 NOT = SPACES                           30190000
302000                 MOVE 'SELECT A VEND NAME FROM THE TENTNME TABLE' 30200000
302100                                    TO DP013-MESSAGE-TEXT(1)      30210000
302200                 PERFORM 9900-DB2-ERROR                           30220000
302300         END-EVALUATE                                             30230000
302400     END-PERFORM.                                                 30240000
302500                                                                  30250000
302600     EVALUATE TRUE                                                30260000
302700         WHEN SQLCODE = ZERO                                      30270000
302800             SET PS-VENDOR-NAME-FOUND    TO TRUE                  30280000
302900         WHEN SQLCODE = -911                                      30290099
303000         WHEN SQLCODE = -913                                      30300000
303100             MOVE 'SELECT A VEND NAME FROM THE TENTNME TABLE'     30310000
303200                                    TO DP013-MESSAGE-TEXT(1)      30320000
303300             PERFORM 9900-DB2-ERROR                               30330000
303400         WHEN SQLCODE = +100                                      30340000
303500             SET DB-ERROR TO TRUE                                 30350000
303600     END-EVALUATE.                                                30360000
303700*33250-EXIT.                                                      30370000
                                                                        30371099
298800******************************************************************30372099
298900*  GET NRF COLOR DESCRIPTION                                     *30373099
299200******************************************************************30376099
303800 33252-GET-COLOR.                                                 30380065
303900                                                                  30390000
304000     MOVE SPACES TO PV-COLOR-1                                    30400000
304100                    PV-COLOR-2.                                   30410000
304200     PERFORM                                                      30420000
304300         WITH TEST AFTER                                          30430000
304400         VARYING PV-SQL-SUB                                       30440000
304500         FROM 1 BY 1                                              30450000
304600         UNTIL PV-SQL-SUB > PC-MAXIMUM-RETRY-COUNT                30460000
304700            OR SQLCODE = +0                                       30470000
304800            OR SQLCODE NOT = +0                                   30480000
304900                                                                  30490000
305000             EXEC SQL                                             30500000
305100                 SELECT NRF_CLOR_DESC                             30510000
305200                 INTO  :COLOR-NRF-CLOR-DESC                       30520000
305300                 FROM   TCOLOR                                    30530000
305400                 WHERE  NRF_CLOR_CDE = :PV-COLOR-1-CDE            30540000
305500             END-EXEC                                             30550000
305600                                                                  30560000
305700             EVALUATE TRUE                                        30570000
305800                 WHEN SQLCODE = ZERO                              30580000
305900                    MOVE COLOR-NRF-CLOR-DESC TO PV-COLOR-1        30590000
306000                 WHEN SQLCODE  NOT = 0                            30600000
306100                 WHEN SQLWARN0 NOT = SPACES                       30610000
306200                      MOVE '33252-GET-COLOR'                      30620000
306300                                       TO DP013-PARAGRAPH         30630000
306400                      MOVE 'SELECT TCOLOR'                        30640000
306500                                       TO DP013-MESSAGE-TEXT (1)  30650000
306600                      MOVE SQLCA       TO DP013-SQLCA             30660000
306700                      SET DP013-DB2-ABEND                         30670000
306800                                       TO TRUE                    30680000
306900                      PERFORM DP013-0000-PROCESS-ABEND            30690000
307000             END-EVALUATE                                         30700000
307100     END-PERFORM.                                                 30710000
307200                                                                  30720000
307300     IF  PV-SQL-SUB > PC-MAXIMUM-RETRY-COUNT                      30730000
307400         MOVE '33252-GET-COLOR'                                   30740000
307500                                   TO DP013-PARAGRAPH             30750000
307600         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   30760000
307700                                   TO DP013-MESSAGE-TEXT (1)      30770000
307800         MOVE SQLCA                TO DP013-SQLCA                 30780000
307900         SET DP013-DB2-ABEND       TO TRUE                        30790000
308000         PERFORM DP013-0000-PROCESS-ABEND                         30800000
308100     END-IF.                                                      30810000
308200                                                                  30820000
308300                                                                  30830000
308400     PERFORM                                                      30840000
308500         WITH TEST AFTER                                          30850000
308600         VARYING PV-SQL-SUB                                       30860000
308700         FROM 1 BY 1                                              30870000
308800         UNTIL PV-SQL-SUB > PC-MAXIMUM-RETRY-COUNT                30880000
308900            OR SQLCODE = +0                                       30890000
309000            OR SQLCODE NOT = +0                                   30900000
309100                                                                  30910000
309200             EXEC SQL                                             30920000
309300                 SELECT NRF_CLOR_DESC                             30930000
309400                 INTO  :COLOR-NRF-CLOR-DESC                       30940000
309500                 FROM   TCOLOR                                    30950000
309600                 WHERE  NRF_CLOR_CDE = :PV-COLOR-2-CDE            30960000
309700             END-EXEC                                             30970000
309800                                                                  30980000
309900             EVALUATE TRUE                                        30990000
310000                 WHEN SQLCODE = ZERO                              31000000
310100                    MOVE COLOR-NRF-CLOR-DESC TO PV-COLOR-2        31010000
310200                 WHEN SQLCODE  NOT = 0                            31020000
310300                 WHEN SQLWARN0 NOT = SPACES                       31030000
310400                      MOVE '33252-GET-COLOR'                      31040000
310500                                       TO DP013-PARAGRAPH         31050000
310600                      MOVE 'SELECT TCOLOR'                        31060000
310700                                       TO DP013-MESSAGE-TEXT (1)  31070000
310800                      MOVE SQLCA       TO DP013-SQLCA             31080000
310900                      SET DP013-DB2-ABEND                         31090000
311000                                       TO TRUE                    31100000
311100                      PERFORM DP013-0000-PROCESS-ABEND            31110000
311200             END-EVALUATE                                         31120000
311300     END-PERFORM.                                                 31130000
311400                                                                  31140000
311500     IF  PV-SQL-SUB > PC-MAXIMUM-RETRY-COUNT                      31150000
311600         MOVE '33252-GET-COLOR'                                   31160000
311700                                   TO DP013-PARAGRAPH             31170000
311800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   31180000
311900                                   TO DP013-MESSAGE-TEXT (1)      31190000
312000         MOVE SQLCA                TO DP013-SQLCA                 31200000
312100         SET DP013-DB2-ABEND       TO TRUE                        31210000
312200         PERFORM DP013-0000-PROCESS-ABEND                         31220000
312300     END-IF.                                                      31230000
312400                                                                  31240000
312600************************************************************      31241099
312700* CHECK FOR VALID COLOR FAMILY RANGES                      *      31242099
312800************************************************************      31243099
312500 33253-CHECK-COLOR-FAMILY.                                        31250000
                                                                        31260099
312900** BLACK                                                          31290000
313000      IF CA-COLOR-1-X   NOT = SPACES                              31300000
313100     AND CA-COLOR-2-X   NOT = SPACES                              31310000
313200         IF CA-COLOR-1-NUM = 001 AND                              31320000
313300            CA-COLOR-2-NUM = 019                                  31330000
313400            SET PS-COLOR-FAMILY TO TRUE                           31340000
313500         END-IF                                                   31350000
313600** GREY                                                           31360000
313700         IF CA-COLOR-1-NUM = 020                                  31370000
313800        AND CA-COLOR-2-NUM = 099                                  31380000
313900            SET PS-COLOR-FAMILY TO TRUE                           31390000
314000         END-IF                                                   31400000
314100** WHITE                                                          31410000
314200         IF CA-COLOR-1-NUM = 100                                  31420000
314300        AND CA-COLOR-2-NUM = 199                                  31430000
314400            SET PS-COLOR-FAMILY TO TRUE                           31440000
314500        END-IF                                                    31450000
314600** BROWN                                                          31460000
314700         IF CA-COLOR-1-NUM = 200                                  31470000
314800        AND CA-COLOR-2-NUM = 249                                  31480000
314900            SET PS-COLOR-FAMILY TO TRUE                           31490000
315000        END-IF                                                    31500000
315100** BEIGE                                                          31510000
315200         IF CA-COLOR-1-NUM = 250                                  31520000
315300        AND CA-COLOR-2-NUM = 299                                  31530000
315400            SET PS-COLOR-FAMILY TO TRUE                           31540000
315500        END-IF                                                    31550000
315600** GREEN                                                          31560000
315700         IF CA-COLOR-1-NUM = 300                                  31570000
315800        AND CA-COLOR-2-NUM = 399                                  31580000
315900            SET PS-COLOR-FAMILY TO TRUE                           31590000
316000        END-IF                                                    31600000
316100** BLUE                                                           31610000
316200         IF CA-COLOR-1-NUM = 400                                  31620000
316300        AND CA-COLOR-2-NUM = 499                                  31630000
316400            SET PS-COLOR-FAMILY TO TRUE                           31640000
316500        END-IF                                                    31650000
316600** PURPLE                                                         31660000
316700         IF CA-COLOR-1-NUM = 500                                  31670000
316800        AND CA-COLOR-2-NUM = 599                                  31680000
316900            SET PS-COLOR-FAMILY TO TRUE                           31690000
317000        END-IF                                                    31700000
317100** RED                                                            31710000
317200         IF CA-COLOR-1-NUM = 600                                  31720000
317300        AND CA-COLOR-2-NUM = 649                                  31730000
317400            SET PS-COLOR-FAMILY TO TRUE                           31740000
317500        END-IF                                                    31750000
317600** PINK                                                           31760000
317700         IF CA-COLOR-1-NUM = 650                                  31770000
317800        AND CA-COLOR-2-NUM = 699                                  31780000
317900            SET PS-COLOR-FAMILY TO TRUE                           31790000
318000        END-IF                                                    31800000
318100** YELLOW                                                         31810000
318200         IF CA-COLOR-1-NUM = 700                                  31820000
318300        AND CA-COLOR-2-NUM = 799                                  31830000
318400            SET PS-COLOR-FAMILY TO TRUE                           31840000
318500        END-IF                                                    31850000
318600** ORANGE                                                         31860000
318700         IF CA-COLOR-1-NUM = 800                                  31870000
318800        AND CA-COLOR-2-NUM = 899                                  31880000
318900            SET PS-COLOR-FAMILY TO TRUE                           31890000
319000        END-IF                                                    31900000
319100** OVERFLOW                                                       31910000
319200         IF CA-COLOR-1-NUM = 900                                  31920000
319300        AND CA-COLOR-2-NUM = 999                                  31930000
319400            SET PS-COLOR-FAMILY TO TRUE                           31940000
319500        END-IF                                                    31950000
319600** MULTI OR NONE                                                  31960000
319700         IF CA-COLOR-1-NUM = 000                                  31970000
319800        AND CA-COLOR-2-NUM = 000                                  31980000
319900            SET PS-COLOR-FAMILY TO TRUE                           31990000
320000        END-IF                                                    32000000
320100     END-IF.                                                      32010000
                                                                        32010199
320500******************************************************************32011099
320600*  READ THE VENDOR NAME FROM INPUT AND SEARCH THE TENTNME TABLE  *32012099
320700*  FOR A MATCH. TAKE THE ENTITY ID AND USE THAT WITH DEPT NUMBER *32013099
320800*  TO GET THE IN HOUSE VENDOR NUMBER.                            *32014099
320900******************************************************************32015099
320200 33255-GET-VENDOR-NAME.                                           32020000
                                                                        32021099
320300     SET PS-VENDOR-NAME-NOT-FOUND    TO TRUE.                     32030000
320400     MOVE '*33255-GET-VENDOR-NAME.          *' TO DP013-PARAGRAPH 32040000
                                                                        32092099
321000     INITIALIZE PV-RETRY-COUNT                                    32100000
321100     MOVE CA-DEPT-NUMBER-X TO PV-DEPT-NUMBER.                     32110000
                                                                        32119199
321200     PERFORM                                                      32120000
321300         WITH TEST AFTER                                          32130000
321400         UNTIL SQLCODE = ZERO                                     32140000
321500            OR SQLCODE = +100                                     32150000
321600            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT            32160000
321700         EXEC SQL                                                 32170000
321800              SELECT TVNDDPT.INHOUSE_NBR                          32180000
321900                INTO :VNDDPT-INHOUSE-NBR                          32190099
322000                FROM TVNDDPT,                                     32200000
322100                     TENTNME                                      32210000
322200               WHERE TVNDDPT.DEPT_NBR      = :PV-DEPT-NUMBER      32220099
322300                 AND TENTNME.ENT_ID        = TVNDDPT.ENT_ID       32230099
322400                 AND TENTNME.ENT_NAME_DESC = :CA-VENDOR-NAME      32240000
322500                 AND TVNDDPT.VND_DEPT_STAT_CD = 'A'               32250000
322600         END-EXEC                                                 32260000
                                                                        32261099
322700         EVALUATE TRUE                                            32270000
322800             WHEN SQLCODE = ZERO                                  32280000
322900                  CONTINUE                                        32290000
323000             WHEN SQLCODE = -911                                  32300099
323100             WHEN SQLCODE = -913                                  32310000
323200                  ADD +1 TO PV-RETRY-COUNT                        32320000
323300             WHEN SQLCODE < ZERO                                  32330000
323400             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     32340000
323500             WHEN SQLWARN0 NOT = SPACES                           32350000
323600                 MOVE 'SELECT A VEND NUMBER FROM TENTNEM'         32360000
323700                                    TO DP013-MESSAGE-TEXT(1)      32370000
323800                 PERFORM 9900-DB2-ERROR                           32380000
323900         END-EVALUATE                                             32390000
324000     END-PERFORM.                                                 32400000
324100                                                                  32410000
324200     EVALUATE TRUE                                                32420000
324300         WHEN SQLCODE = ZERO OR -811                              32430099
324400             SET PS-VENDOR-NAME-FOUND    TO TRUE                  32440000
324500         WHEN SQLCODE = -911                                      32450099
324600         WHEN SQLCODE = -913                                      32460000
324700             MOVE 'SELECT A VEND NAME FROM THE TENTNME TABLE'     32470000
324800                                    TO DP013-MESSAGE-TEXT(1)      32480000
324900             PERFORM 9900-DB2-ERROR                               32490000
325000         WHEN SQLCODE = +100                                      32500000
325100             SET DB-ERROR TO TRUE                                 32510000
325200     END-EVALUATE.                                                32520000
325300                                                                  32530000
325600******************************************************************32531099
325700*  READ THE DEPARTMENT/CLASS TABLE TO GET THE DEPT NAME.         *32532099
325800******************************************************************32533099
325400 33260-GET-DEPT-NAME.                                             32540000
325300                                                                  32541099
325500     MOVE '*33260-GET-DEPT-NAME.            *' TO DP013-PARAGRAPH.32550099
325900     SET PS-DEPT-NOT-FOUND TO TRUE.                               32590000
326000     INITIALIZE PV-RETRY-COUNT.                                   32600099
                                                                        32601099
326100     PERFORM                                                      32610000
326200         WITH TEST AFTER                                          32620000
326300         UNTIL SQLCODE = ZERO                                     32630000
326400            OR SQLCODE = +100                                     32640000
326500            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT            32650000
326600         EXEC SQL                                                 32660000
326700              SELECT MDSEAR_DESC                                  32670000
326800                INTO :MDSEAR-DESC                                 32680000
326900                FROM TMDSEAR                                      32690000
327000               WHERE OPERCO_NBR = '03'                            32700000
327100                 AND DEPT_NBR = :CA-DEPT-NUMBER-X                 32710000
327200                 AND MDSELV_CDE = 'DPT'                           32720000
327300                 AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE    32730000
327400         END-EXEC                                                 32740000
327500         EVALUATE TRUE                                            32750000
327600             WHEN SQLCODE = ZERO                                  32760000
327700                  CONTINUE                                        32770000
327800             WHEN SQLCODE = -911                                  32780099
327900             WHEN SQLCODE = -913                                  32790000
328000                  ADD +1 TO PV-RETRY-COUNT                        32800000
328100             WHEN SQLCODE < ZERO                                  32810000
328200             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     32820000
328300             WHEN SQLWARN0 NOT = SPACES                           32830000
328400                 MOVE 'SELECT A DEPT NAME FROM THE DEPT TABLE'    32840000
328500                                    TO DP013-MESSAGE-TEXT(1)      32850000
328600                 PERFORM 9900-DB2-ERROR                           32860000
328700         END-EVALUATE                                             32870000
328800     END-PERFORM.                                                 32880000
328900                                                                  32890000
329000     EVALUATE TRUE                                                32900000
329100         WHEN SQLCODE = ZERO                                      32910000
329200             SET PS-DEPT-FOUND           TO TRUE                  32920000
329300         WHEN SQLCODE = -911                                      32930099
329400         WHEN SQLCODE = -913                                      32940000
329500             MOVE 'SELECT A DEPT NAME FROM THE TDMSEAR TABLE'     32950000
329600                                    TO DP013-MESSAGE-TEXT(1)      32960000
329700             PERFORM 9900-DB2-ERROR                               32970000
329800         WHEN SQLCODE = +100                                      32980000
329900             SET DB-ERROR TO TRUE                                 32990000
330000     END-EVALUATE.                                                33000000
330100*33260-EXIT.                                                      33010000
330200                                                                  33020000
330600******************************************************************33031099
330700*  READ THE DEPARTMENT/CLASS TABLE TO GET THE DEPT NAME.         *33032099
330800******************************************************************33033099
330400 33265-GET-LONG-COLOR.                                            33040063
330300                                                                  33041099
330500     MOVE '*33265-GET-LONG-COLOR            *' TO DP013-PARAGRAPH 33050063
330900     MOVE ZEROS TO PV-COLOR-COUNT.                                33090058
331000     INITIALIZE PV-RETRY-COUNT.                                   33100099
                                                                        33101099
331100     PERFORM                                                      33110056
331200         WITH TEST AFTER                                          33120056
331300         UNTIL SQLCODE = ZERO                                     33130056
331400            OR SQLCODE = +100                                     33140056
331500            OR PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT            33150056
331600         EXEC SQL                                                 33160056
331700              SELECT  COUNT(*)                                    33170058
331800                INTO :PV-COLOR-COUNT                              33180058
331900                FROM TSK S                                        33190099
MC0502                JOIN TSKXREF X                                    33191099
MC0502                  ON S.ITEM_NMBR = X.ITM_NBR                      33192099
MC0502               WHERE DEPT  = :NI-DEPT-9-4                         33200099
MC0502                 AND (SUBCLASS BETWEEN                            33210099
MC0502                            :PV-CLASS-LOW-C3 AND                  33220099
MC0502                            :PV-CLASS-HIGH-C3)                    33221099
332300                 AND LONG_COLOR_DESC  = :TSK-LONG-COLOR-DESC      33230063
MC0502                 AND SKU_STAT_CDE ^= '00'                         33231099
332400         END-EXEC                                                 33240056
332500                                                                  33250078
332800         EVALUATE TRUE                                            33280078
332900             WHEN SQLCODE = ZERO                                  33290078
333000             WHEN SQLCODE = -305                                  33300078
333100                  CONTINUE                                        33310078
333200             WHEN SQLCODE = -911                                  33320099
333300             WHEN SQLCODE = -913                                  33330078
333400                  ADD +1 TO PV-RETRY-COUNT                        33340078
333500             WHEN SQLCODE < ZERO                                  33350078
333600             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     33360078
333700             WHEN SQLWARN0 NOT = SPACES                           33370078
333800                 MOVE 'SELECT A COLOR FROM THE TSK TABLE'         33380078
333900                                    TO DP013-MESSAGE-TEXT(1)      33390078
334000                 PERFORM 9900-DB2-ERROR                           33400078
334100         END-EVALUATE                                             33410078
334200     END-PERFORM.                                                 33420078
334300                                                                  33430078
334400     EVALUATE TRUE                                                33440078
334500         WHEN SQLCODE = ZERO OR -305                              33450078
334600             IF PV-COLOR-COUNT > 0                                33460078
334700                SET PS-COLOR-FOUND          TO TRUE               33470078
334800             ELSE                                                 33480078
334900                SET PS-COLOR-NOT-FOUND      TO TRUE               33490078
335000             END-IF                                               33500078
335100         WHEN SQLCODE = -911                                      33510099
335200         WHEN SQLCODE = -913                                      33520078
335300             MOVE 'SELECT A COLOR DESC FROM THE TSK TABLE'        33530078
335400                                    TO DP013-MESSAGE-TEXT(1)      33540078
335500             PERFORM 9900-DB2-ERROR                               33550078
335600     END-EVALUATE.                                                33560078
335700*33265-EXIT.                                                      33570078
335800                                                                  33580078
336100******************************************************************33581099
336200* CHECK IF THE DEPARTMENT/CLASS ENTERED ARE VALID                 33582099
336300******************************************************************33583099
335900 33300-EDIT-VALID-DEPT-CLASS.                                     33590056
                                                                        33591099
336000     MOVE '*33300-EDIT-VALID-DEPT-CLASS*' TO DP013-PARAGRAPH.     33600000
336400     PERFORM 33350-GET-DEPT-NAME.                                 33640000
336500     MOVE CA-MAJOR-CLASS TO PV-MAJOR-CLASS-1.                     33650000
336600     MOVE ZEROES TO PV-MAJOR-CLASS-2.                             33660000
336700     MOVE ZEROES TO PV-MINOR-CLASS-1.                             33670000
336800     MOVE CA-MAJOR-CLASS TO PV-MINOR-CLASS-2.                     33680000
336900     MOVE CA-MINOR-CLASS TO PV-MINOR-CLASS-3.                     33690000
337000     IF  (PS-VALID-MAJOR-CLASS AND PS-VALID-MINOR-CLASS)          33700000
337100         PERFORM 33360-GET-MINOR-CLASS-NAME                       33710000
337200         IF DB-ERROR-NO                                           33720000
337300             MOVE MDSEAR-DESC TO CA-CLASS-DESCRIPTION             33730000
337400                                 CLSDSCO                          33740097
337500         ELSE                                                     33750000
337600             IF  CA-MINOR-CLASS = PC-LITERAL-0                    33760000
337700                 CONTINUE                                         33770000
337800             ELSE                                                 33780000
337900                 MOVE DP015-REVERSE  TO DEPTH                     33790000
338000                 MOVE DP015-RED      TO DEPTC                     33800000
338100                 MOVE DP015-UNP-NUM-BRT-OFF                       33810000
338200                                     TO DEPTA                     33820000
338300                 MOVE DP015-REVERSE  TO CLASSH                    33830000
338400                 MOVE DP015-RED      TO CLASSC                    33840000
338500                 MOVE DP015-UNP-ALP-BRT-OFF                       33850000
338600                                     TO CLASSA                    33860000
338700                 IF  NOT PS-EDIT-ERROR                            33870000
338800                     SET PS-EDIT-ERROR                            33880000
338900                                     TO TRUE                      33890000
339000                     MOVE PC-TSYMSG-00110 TO DP020-MSG-NUMBER     33900000
339100                     MOVE -1         TO CLASSL                    33910000
339200                 END-IF                                           33920000
339300             END-IF                                               33930000
339400         END-IF                                                   33940000
339500     END-IF.                                                      33950000
339600     IF  (PS-VALID-MAJOR-CLASS AND CA-MINOR-CLASS = SPACE)        33960000
339700         PERFORM 33370-GET-MAJOR-CLASS-NAME                       33970000
339800         IF DB-ERROR-NO                                           33980000
339900             MOVE MDSEAR-DESC        TO CA-CLASS-DESCRIPTION      33990000
340000                                        CLSDSCO                   34000097
340100         ELSE                                                     34010000
340200             MOVE DP015-REVERSE      TO DEPTH                     34020000
340300             MOVE DP015-RED          TO DEPTC                     34030000
340400             MOVE DP015-UNP-NUM-BRT-OFF                           34040000
340500                                     TO DEPTA                     34050000
340600             MOVE DP015-REVERSE      TO CLASSH                    34060000
340700             MOVE DP015-RED          TO CLASSC                    34070000
340800             MOVE DP015-UNP-ALP-BRT-OFF                           34080000
340900                                     TO CLASSA                    34090000
341000             IF  NOT PS-EDIT-ERROR                                34100000
341100                 SET PS-EDIT-ERROR   TO TRUE                      34110000
341200                 MOVE PC-TSYMSG-00110 TO DP020-MSG-NUMBER         34120000
341300                 MOVE -1             TO CLASSL                    34130000
341400             END-IF                                               34140000
341500         END-IF                                                   34150000
341600     END-IF.                                                      34160000
341700                                                                  34170000
341800     IF  (PS-VALID-MAJOR-CLASS                                    34180000
341900                  AND                                             34190000
342000         CA-MINOR-CLASS = PC-LITERAL-0)                           34200000
342100         IF  DB-ERROR-NO                                          34210000
342200             CONTINUE                                             34220000
342300         ELSE                                                     34230000
342400             PERFORM 33370-GET-MAJOR-CLASS-NAME                   34240000
342500             IF DB-ERROR-NO                                       34250000
342600                 MOVE MDSEAR-DESC    TO CA-CLASS-DESCRIPTION      34260000
342700                                        CLSDSCO                   34270097
342800             ELSE                                                 34280000
342900                 MOVE DP015-REVERSE  TO DEPTH                     34290000
343000                 MOVE DP015-RED      TO DEPTC                     34300000
343100                 MOVE DP015-UNP-NUM-BRT-OFF                       34310000
343200                                     TO DEPTA                     34320000
343300                 MOVE DP015-REVERSE  TO CLASSH                    34330000
343400                 MOVE DP015-RED      TO CLASSC                    34340000
343500                 MOVE DP015-UNP-ALP-BRT-OFF                       34350000
343600                                     TO CLASSA                    34360000
343700                 IF  NOT PS-EDIT-ERROR                            34370000
343800                     SET PS-EDIT-ERROR                            34380000
343900                                     TO TRUE                      34390000
344000                     MOVE PC-TSYMSG-00110 TO DP020-MSG-NUMBER     34400000
344100                     MOVE -1         TO CLASSL                    34410000
344200                 END-IF                                           34420000
344300             END-IF                                               34430000
344400         END-IF                                                   34440000
344500     END-IF.                                                      34450000
344600*33300-EXIT.                                                      34460000
344700                                                                  34470000
345000******************************************************************34471099
345100*  READ THE ONLINE DEPARTMENT DATABASE TO OBTAIN THE DEPARTMENT  *34472099
345200*  AND CLASS DESCRIPTIONS OF THE ENTERED DEPARTMENT AND CLASS.   *34473099
345300******************************************************************34474099
344800 33350-GET-DEPT-NAME.                                             34480000
                                                                        34481099
344900     MOVE '*33350-GET-DEPT-NAME.            *' TO DP013-PARAGRAPH 34490000
345400     MOVE CA-DEPT-NUMBER-X TO PV-DEPT-NUMBER.                     34540000
345500     INITIALIZE PV-RETRY-COUNT.                                   34550000
345600     PERFORM WITH TEST AFTER                                      34560000
345700             UNTIL ((SQLCODE = ZERO)                              34570000
345800                           OR                                     34580000
345900                    (SQLCODE = +100)                              34590000
346000                           OR                                     34600000
346100                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    34610000
346200         EXEC SQL                                                 34620000
346300             SELECT MDSEAR_DESC                                   34630000
346400                 INTO :MDSEAR-DESC                                34640000
346500                 FROM TMDSEAR                                     34650000
346600                 WHERE OPERCO_NBR = '03'                          34660000
346700                   AND DEPT_NBR = :PV-DEPT-NUMBER                 34670000
346800                   AND MDSELV_CDE = 'DPT'                         34680000
346900                   AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  34690000
347000         END-EXEC                                                 34700000
347100         EVALUATE TRUE                                            34710000
347200             WHEN SQLCODE = -911                                  34720099
347300             WHEN SQLCODE = -913                                  34730000
347400                 ADD +1              TO PV-RETRY-COUNT            34740000
347500             WHEN SQLCODE = ZERO                                  34750000
347600             WHEN SQLCODE = +100                                  34760000
347700                 CONTINUE                                         34770000
347800             WHEN SQLCODE < ZERO                                  34780000
347900             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     34790000
348000             WHEN SQLWARN0 NOT = SPACES                           34800000
348100                 MOVE 'SELECT A DEPT FROM THE TMDSEAR TABLE'      34810000
348200                                     TO DP013-MESSAGE-TEXT(1)     34820000
348300                 PERFORM 9900-DB2-ERROR                           34830000
348400         END-EVALUATE                                             34840000
348500     END-PERFORM.                                                 34850000
348600                                                                  34860000
348700     IF  ((SQLCODE = -911)                                        34870099
348800               OR                                                 34880000
348900         (SQLCODE = -913))                                        34890000
349000             MOVE 'SELECT A DEPT FROM THE TMDSEAR TABLE'          34900000
349100                                    TO DP013-MESSAGE-TEXT(1)      34910000
349200             PERFORM 9900-DB2-ERROR                               34920000
349300         PERFORM 9900-DB2-ERROR                                   34930000
349400     END-IF.                                                      34940000
349500                                                                  34950000
349600     IF  SQLCODE = 0                                              34960000
349700         SET DB-ERROR-NO TO TRUE                                  34970000
349800     ELSE                                                         34980000
349900         IF  SQLCODE = +100                                       34990000
350000             SET DB-ERROR TO TRUE                                 35000000
350100         END-IF                                                   35010000
350200     END-IF.                                                      35020000
350300*33350-EXIT.                                                      35030000
350400                                                                  35040000
350500******************************************************************35050000
350600* GET THE MINOR CLASS NAME FROM THE DEPARTMENT CLASS TABLE        35060000
350700******************************************************************35070000
350800 33360-GET-MINOR-CLASS-NAME.                                      35080000
                                                                        35081099
350900     MOVE '*33360-GET-MINOR-CLASS-NAME      *' TO DP013-PARAGRAPH 35090000
351000     MOVE CA-DEPT-NUMBER-X TO PV-DEPT-NUMBER.                     35100000
351100     INITIALIZE PV-RETRY-COUNT.                                   35110000
351200     PERFORM WITH TEST AFTER                                      35120000
351300             UNTIL ((SQLCODE = ZERO)                              35130000
351400                           OR                                     35140000
351500                    (SQLCODE = +100)                              35150000
351600                           OR                                     35160000
351700                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    35170000
351800         EXEC SQL                                                 35180000
351900             SELECT MDSEAR_DESC                                   35190000
352000                 INTO :MDSEAR-DESC                                35200000
352100                 FROM TMDSEAR                                     35210000
352200                 WHERE OPERCO_NBR = '03'                          35220000
352300                   AND DEPT_NBR = :PV-DEPT-NUMBER                 35230000
352400                   AND SUB_CL_NBR = :PV-MINOR-CLASS-X             35240000
352500                   AND MDSELV_CDE = 'SCL'                         35250000
352600                   AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  35260000
352700         END-EXEC                                                 35270000
352800         EVALUATE TRUE                                            35280000
352900             WHEN SQLCODE = -911                                  35290099
353000             WHEN SQLCODE = -913                                  35300000
353100                 ADD +1              TO PV-RETRY-COUNT            35310000
353200             WHEN SQLCODE = ZERO                                  35320000
353300             WHEN SQLCODE = +100                                  35330000
353400                 CONTINUE                                         35340000
353500             WHEN SQLCODE < ZERO                                  35350000
353600             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     35360000
353700             WHEN SQLWARN0 NOT = SPACES                           35370000
353800                 MOVE 'SELECT MINOR CLASS NAME'                   35380000
353900                                     TO DP013-MESSAGE-TEXT(1)     35390000
354000                 PERFORM 9900-DB2-ERROR                           35400000
354100         END-EVALUATE                                             35410000
354200     END-PERFORM.                                                 35420000
354300                                                                  35430000
354400     IF  ((SQLCODE = -911)                                        35440099
354500               OR                                                 35450000
354600         (SQLCODE = -913))                                        35460000
354700             MOVE 'SELECT MINOR CLASS NAME'                       35470000
354800                                    TO DP013-MESSAGE-TEXT(1)      35480000
354900             PERFORM 9900-DB2-ERROR                               35490000
355000     END-IF.                                                      35500000
355100                                                                  35510000
355200     IF  SQLCODE = 0                                              35520000
355300         SET DB-ERROR-NO TO TRUE                                  35530000
355400     ELSE                                                         35540000
355500         IF  SQLCODE = +100                                       35550000
355600             SET DB-ERROR TO TRUE                                 35560000
355700         END-IF                                                   35570000
355800     END-IF.                                                      35580000
355900*33360-EXIT.                                                      35590000
356100*                                                                 35610000
356200******************************************************************35620000
356300* GET THE MAJOR CLASS NAME FROM THE DEPARTMENT CLASS TABLE *      35630000
356400******************************************************************35640000
356600 33370-GET-MAJOR-CLASS-NAME.                                      35660000
356500                                                                  35661099
356700     MOVE '*33370-GET-MAJOR-CLASS-NAME      *' TO DP013-PARAGRAPH 35670000
356800     MOVE CA-DEPT-NUMBER-X TO PV-DEPT-NUMBER.                     35680000
356900     INITIALIZE PV-RETRY-COUNT.                                   35690000
357000     PERFORM WITH TEST AFTER                                      35700000
357100             UNTIL ((SQLCODE = ZERO)                              35710000
357200                           OR                                     35720000
357300                    (SQLCODE = +100)                              35730000
357400                           OR                                     35740000
357500                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    35750000
357600         EXEC SQL                                                 35760000
357700             SELECT MDSEAR_DESC                                   35770000
357800                 INTO :MDSEAR-DESC                                35780000
357900                 FROM TMDSEAR                                     35790000
358000                 WHERE OPERCO_NBR = '03'                          35800000
358100                   AND DEPT_NBR = :PV-DEPT-NUMBER                 35810000
358200                   AND MAJ_CL_NBR = :PV-MAJOR-CLASS-X             35820000
358300                   AND MDSELV_CDE = 'MCL'                         35830000
358400                   AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  35840000
358500         END-EXEC                                                 35850000
358600         EVALUATE TRUE                                            35860000
358700             WHEN SQLCODE = -911                                  35870099
358800             WHEN SQLCODE = -913                                  35880000
358900                 ADD +1              TO PV-RETRY-COUNT            35890000
359000             WHEN SQLCODE = ZERO                                  35900000
359100             WHEN SQLCODE = +100                                  35910000
359200                 CONTINUE                                         35920000
359300             WHEN SQLCODE < ZERO                                  35930000
359400             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     35940000
359500             WHEN SQLWARN0 NOT = SPACES                           35950000
359600                 MOVE 'SELECT MAJOR CLASS NAME'                   35960000
359700                                     TO DP013-MESSAGE-TEXT(1)     35970000
359800                 PERFORM 9900-DB2-ERROR                           35980000
359900         END-EVALUATE                                             35990000
360000     END-PERFORM.                                                 36000000
360100                                                                  36010000
360200     IF  ((SQLCODE = -911)                                        36020099
360300               OR                                                 36030000
360400         (SQLCODE = -913))                                        36040000
360500             MOVE 'SELECT MAJOR CLASS NAME'                       36050000
360600                                    TO DP013-MESSAGE-TEXT(1)      36060000
360700             PERFORM 9900-DB2-ERROR                               36070000
360800     END-IF.                                                      36080000
360900                                                                  36090000
361000     IF  SQLCODE = 0                                              36100000
361100         SET DB-ERROR-NO TO TRUE                                  36110000
361200     ELSE                                                         36120000
361300         IF  SQLCODE = +100                                       36130000
361400             SET DB-ERROR TO TRUE                                 36140000
361500         END-IF                                                   36150000
361600     END-IF.                                                      36160000
361700*33370-EXIT.                                                      36170000
361800                                                                  36180000
356200******************************************************************36181099
356300* GET NRF SIZE CODE                                               36182099
356400******************************************************************36183099
361900 33380-GET-SIZE.                                                  36190000
                                                                        36191099
362000     MOVE '*33380-GET-SIZE      *' TO DP013-PARAGRAPH.            36200000
362100     INITIALIZE PV-RETRY-COUNT.                                   36210000
362200     PERFORM WITH TEST AFTER                                      36220000
362300             UNTIL ((SQLCODE = ZERO)                              36230000
362400                           OR                                     36240000
362500                    (SQLCODE = +100)                              36250000
362600                           OR                                     36260000
362700                    (SQLCODE = -811)                              36270000
362800                           OR                                     36280000
362900                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    36290000
363000         EXEC SQL                                                 36300000
363100             SELECT   A.NRF_SIZE_CDE                              36310000
363200                 INTO :SIZE-NRF-SIZE-CDE                          36320000
363300                 FROM TSIZE A,                                    36330000
363400                      TMDSEAR B,                                  36340000
363500                      TDSZMEM C                                   36350000
363600                 WHERE A.KOHLS_DESC = :CA-SIZE-DESC               36360000
363700                   AND B.OPERCO_NBR = '03'                        36370000
363800                   AND B.DEPT_NBR = :PV-DEPT-NUMBER               36380000
363900                   AND B.MDSELV_CDE = 'DPT'                       36390000
364000                   AND B.MDSEAR_DKEY = C.MDSEAR_ID                36400000
364100                   AND A.KOHLS_SIZE_CDE = C.KOHLS_SIZE_CDE        36410000
364200                   AND (A.EFF_END_DTE IS NULL OR                  36420000
364300                       A.EFF_END_DTE > CURRENT DATE)              36430000
364400                   AND CURRENT DATE BETWEEN B.STRT_DTE            36440000
364500                   AND B.END_DTE                                  36450000
364600         END-EXEC                                                 36460000
364700         EVALUATE TRUE                                            36470000
364800             WHEN SQLCODE = -911                                  36480099
364900             WHEN SQLCODE = -913                                  36490000
365000                 ADD +1              TO PV-RETRY-COUNT            36500000
365100             WHEN SQLCODE = ZERO                                  36510000
365200             WHEN SQLCODE = +100                                  36520000
365300                 CONTINUE                                         36530000
365400             WHEN SQLCODE = -811                                  36540000
365500                 CONTINUE                                         36550000
365600             WHEN SQLCODE < ZERO                                  36560000
365700             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     36570000
365800             WHEN SQLWARN0 NOT = SPACES                           36580000
365900                 MOVE 'SELECT KOHLS SIZE CODE'                    36590000
366000                                     TO DP013-MESSAGE-TEXT(1)     36600000
366100                 PERFORM 9900-DB2-ERROR                           36610000
366200         END-EVALUATE                                             36620000
366300     END-PERFORM.                                                 36630000
366400                                                                  36640000
366500     IF  ((SQLCODE = -911)                                        36650099
366600               OR                                                 36660000
366700         (SQLCODE = -913))                                        36670000
366800             MOVE 'SELECT KOHLS SIZE CODE'                        36680000
366900                                    TO DP013-MESSAGE-TEXT(1)      36690000
367000             PERFORM 9900-DB2-ERROR                               36700000
367100     END-IF.                                                      36710000
367200                                                                  36720000
367300     IF  SQLCODE = 0                                              36730000
367400         SET DB-ERROR-NO TO TRUE                                  36740000
367500         SET PS-SIZE-FOUND TO TRUE                                36750000
367600         MOVE SIZE-NRF-SIZE-CDE TO CA-SIZE-CDE                    36760000
367700     ELSE                                                         36770000
367800         IF  SQLCODE = +100 OR -811                               36780000
367900             SET DB-ERROR TO TRUE                                 36790000
368000         END-IF                                                   36800000
368100     END-IF.                                                      36810000
368200*33380-EXIT.                                                      36820050
368300                                                                  36830000
368500******************************************************************36831099
368600* ACCESS THE DISTRICT DB2 TABLE TO GET THE NAME OF THE ENTERED    36832099
368700* DISTRICT NUMBER                                                 36833099
368800******************************************************************36834099
368400 33400-GET-DISTRICT.                                              36840044
                                                                        36850099
368900     SET PS-DISTRICT-NOT-FOUND       TO TRUE.                     36890041
369000                                                                  36900041
369500     MOVE SPACES                     TO CA-DISTRICT-NAME.         36950042
369600                                                                  36960041
369700     INITIALIZE PV-RETRY-COUNT.                                   36970041
369800     PERFORM WITH TEST AFTER                                      36980041
369900             UNTIL ((SQLCODE = ZERO)                              36990041
370000                           OR                                     37000041
370100                    (SQLCODE = +100)                              37010041
370200                           OR                                     37020041
370300                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    37030041
370400         EXEC SQL                                                 37040041
370500             SELECT DISTRICT_NAME                                 37050041
370600             INTO :TDST000-DISTRICT-NAME                          37060041
370700             FROM TDST000                                         37070041
370800             WHERE ((OP_CO_NMBR = :PC-OPERATING-COMPANY)          37080041
370900                              AND                                 37090041
371000                    (DISTRICT_NMBR = :CA-DISTRICT-NUMBER))        37100041
371100         END-EXEC                                                 37110041
371200         EVALUATE TRUE                                            37120041
371300             WHEN SQLCODE = -911                                  37130099
371400             WHEN SQLCODE = -913                                  37140041
371500                 ADD +1              TO PV-RETRY-COUNT            37150041
371600             WHEN SQLCODE = ZERO                                  37160041
371700                 SET PS-DISTRICT-FOUND                            37170041
371800                                     TO TRUE                      37180041
371900                 MOVE TDST000-DISTRICT-NAME                       37190053
372000                                     TO CA-DISTRICT-NAME          37200053
372400             WHEN SQLCODE = +100                                  37240041
372500                 CONTINUE                                         37250041
372600             WHEN SQLCODE < ZERO                                  37260041
372700             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     37270041
372800             WHEN SQLWARN0 NOT = SPACES                           37280041
372900                 MOVE PC-ERR-MSG-1   TO DP013-MESSAGE-TEXT(1)     37290041
373000                 PERFORM 9900-DB2-ERROR                           37300041
373100         END-EVALUATE                                             37310041
373200     END-PERFORM.                                                 37320041
373300                                                                  37330041
373400     IF  ((SQLCODE = -911)                                        37340099
373500               OR                                                 37350041
373600         (SQLCODE = -913))                                        37360041
373700         PERFORM 9900-DB2-ERROR                                   37370041
373800     END-IF.                                                      37380041
373900                                                                  37390041
378800******************************************************************37851099
378900* ACCESS THE STORE DB2 TABLE TO GET THE NAME OF THE ENTERED STORE 37852099
379000* NUMBER                                                          37853099
379100******************************************************************37854099
378600 33500-GET-STORE.                                                 37860047
                                                                        37861099
378700     MOVE '*33500-GET-STORE.                *' TO DP013-PARAGRAPH 37870000
379200     SET PS-STORE-NOT-FOUND          TO TRUE.                     37920000
379300                                                                  37930000
379400     MOVE DP015-HL-OFF               TO STRDSCH.                  37940000
379500     MOVE DP015-BLUE                 TO STRDSCC.                  37950000
379600     MOVE DP015-ASK-NOR-OFF          TO STRDSCA.                  37960000
379700     MOVE SPACES                     TO STRDSCI                   37970000
379800                                        CA-STORE-NAME.            37980000
379800     MOVE CA-STORE-NUMBER-9          TO PV-STORE-NUMBER-COMP.     37981099
379900                                                                  37990000
380000     INITIALIZE PV-RETRY-COUNT.                                   38000000
380100     PERFORM WITH TEST AFTER                                      38010000
380200             UNTIL ((SQLCODE = ZERO)                              38020000
380300                           OR                                     38030000
380400                    (SQLCODE = +100)                              38040000
380500                           OR                                     38050000
380600                    (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT))    38060000
380700         EXEC SQL                                                 38070000
380800             SELECT LOC_10_ABBR_NM                                38080099
380900                   ,LOC_NM                                        38090099
381000             INTO :XMT00001-LOC-10-ABBR-NM                        38100099
381100                 ,:XMT00001-LOC-NM                                38110099
381200             FROM XMT_LOC                                         38120099
381300             WHERE ((LOC_NBR = :PV-STORE-NUMBER-COMP)             38140099
381600                              AND                                 38160000
381700                    (LOC_TYP_CDE IN('DS','DC','CS','HQ')))        38170099
381800         END-EXEC                                                 38180000
381900         EVALUATE TRUE                                            38190000
382000             WHEN SQLCODE = -911                                  38200099
382100             WHEN SQLCODE = -913                                  38210000
382200                 ADD +1                        TO PV-RETRY-COUNT  38220099
382300             WHEN SQLCODE = ZERO                                  38230000
382400                 SET PS-STORE-FOUND            TO TRUE            38240099
382500                 MOVE XMT00001-LOC-10-ABBR-NM  TO STRDSCI         38250099
MK                                                CA-STORE-SHORT-NAME   38251099
382600                 MOVE XMT00001-LOC-NM          TO CA-STORE-NAME   38260099
382700             WHEN SQLCODE = +100                                  38270000
382800                 CONTINUE                                         38280000
382900             WHEN SQLCODE < ZERO                                  38290000
383000             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     38300000
383100             WHEN SQLWARN0 NOT = SPACES                           38310000
383200                 MOVE PC-ERR-MSG-2   TO DP013-MESSAGE-TEXT(1)     38320000
383300                 PERFORM 9900-DB2-ERROR                           38330000
383400         END-EVALUATE                                             38340000
383500     END-PERFORM.                                                 38350000
383600                                                                  38360000
383700     IF  ((SQLCODE = -911)                                        38370099
383800               OR                                                 38380000
383900         (SQLCODE = -913))                                        38390000
384000         PERFORM 9900-DB2-ERROR                                   38400000
384100     END-IF.                                                      38410000
384300                                                                  38430099
378800******************************************************************38431099
378900* READ CRITERIA QUEUE                                             38432099
379100******************************************************************38434099
384400 9200-READ-CRITERIA-QUEUE.                                        38440000
                                                                        38441099
384500     MOVE '*9200-READ-CRITERIA-QUEUE.       *' TO DP013-PARAGRAPH 38450000
384600                                                                  38460000
384700     MOVE EIBTRMID              TO CA-TS-TERM-ID                  38470000
384800     MOVE DP020-SRC-TASK-NUMBER TO CA-TS-TASK-NMBR                38480000
384900     SET CA-TS-SHARED-DATA TO TRUE                                38490000
385000                                                                  38500000
385100     INITIALIZE CA-FSKCS034-CRITERIA-DATA                         38510000
385200                                                                  38520000
385300     EXEC CICS                                                    38530000
385400          READQ TS                                                38540000
385500              QUEUE (CA-SEL-QUEUE-NAME)                           38550000
385600              INTO  (CA-FSKCS034-CRITERIA-DATA)                   38560000
385700              ITEM  (PC-ONE)                                      38570000
385800              RESP  (PV-CICS-RESPONSE)                            38580000
385900     END-EXEC.                                                    38590000
386000*                                                                 38600000
386100     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL) OR                   38610000
386200                            DFHRESP (QIDERR)                      38620000
386300         CONTINUE                                                 38630000
386400     ELSE                                                         38640000
386500         SET DP013-CICS-ABEND      TO  TRUE                       38650000
386600         SET DP013-NO-ROLLBACK     TO  TRUE                       38660000
386700         MOVE '9200-READ-TS-QUEUE' TO  DP013-PARAGRAPH            38670000
386800         MOVE 'ATTEMPTING TO READ SELECTION CRITERIA QUEUE'       38680000
386900                                   TO  DP013-MESSAGE-TEXT(1)      38690000
387000         PERFORM DP013-0000-PROCESS-ABEND                         38700000
387100     END-IF.                                                      38710000
387200                                                                  38720099
378800******************************************************************38721099
378900* READ KEY QUEUE                                                  38722099
379100******************************************************************38723099
387300 9300-READ-KEY-QUEUE.                                             38730000
387400                                                                  38740000
387500     MOVE EIBTRMID              TO CA-TS-TERM-ID                  38750000
387600     MOVE DP020-SRC-TASK-NUMBER TO CA-TS-TASK-NMBR                38760000
387700     SET CA-TS-FSWS0000-KEY     TO TRUE                           38770000
387800                                                                  38780000
387900     EXEC CICS                                                    38790000
388000         READQ TS                                                 38800000
388100             QUEUE (CA-SEL-QUEUE-NAME)                            38810000
388200             INTO  (CA-SKU-STORE)                                 38820000
388300             ITEM  (PC-ONE)                                       38830000
388400             RESP  (PV-CICS-RESPONSE)                             38840000
388500     END-EXEC.                                                    38850000
388600                                                                  38860000
388700     IF ((PV-CICS-RESPONSE = DFHRESP (NORMAL))   OR               38870000
388800         (PV-CICS-RESPONSE = DFHRESP (ITEMERR)))                  38880000
388900         CONTINUE                                                 38890000
389000     ELSE                                                         38900000
389100         SET DP013-CICS-ABEND     TO TRUE                         38910000
389200         SET DP013-NO-ROLLBACK    TO TRUE                         38920000
389300         MOVE '4050-READ-KEY-QUEUE'                               38930000
389400                                  TO DP013-PARAGRAPH              38940000
389500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      38950000
389600                                  TO DP013-MESSAGE-TEXT(1)        38960000
389700         PERFORM DP013-0000-PROCESS-ABEND                         38970000
389800     END-IF.                                                      38980000
389900                                                                  38990000
378800******************************************************************39001099
378900* WRITE CRITERIA QUEUE                                            39002099
379100******************************************************************39003099
390100 9400-WRITE-CRITERIA-QUEUE.                                       39010000
                                                                        39011099
390200     MOVE '*9400-WRITE-CRITERIA-QUEUE.      *' TO DP013-PARAGRAPH 39020000
390300                                                                  39030000
390400     MOVE EIBTRMID              TO CA-TS-TERM-ID                  39040000
390500     MOVE DP020-SRC-TASK-NUMBER TO CA-TS-TASK-NMBR                39050000
390600     SET CA-TS-SHARED-DATA      TO TRUE                           39060000
390700                                                                  39070000
390800     EXEC CICS                                                    39080000
390900          DELETEQ TS                                              39090000
391000              QUEUE (CA-SEL-QUEUE-NAME)                           39100000
391100              RESP  (PV-CICS-RESPONSE)                            39110000
391200     END-EXEC.                                                    39120000
391300*                                                                 39130000
391400     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL) OR                   39140000
391500                            DFHRESP (QIDERR)                      39150000
391600         CONTINUE                                                 39160000
391700     ELSE                                                         39170000
391800         SET DP013-CICS-ABEND      TO  TRUE                       39180000
391900         SET DP013-NO-ROLLBACK     TO  TRUE                       39190000
392000         MOVE 'ATTEMPTING TO DELETE CRITERIA QUEUE'               39200000
392100                                   TO  DP013-MESSAGE-TEXT(1)      39210000
392200         PERFORM DP013-0000-PROCESS-ABEND                         39220000
392300     END-IF.                                                      39230000
392400                                                                  39240000
392500     EXEC CICS                                                    39250000
392600          WRITEQ TS                                               39260000
392700              QUEUE (CA-SEL-QUEUE-NAME)                           39270000
392800              FROM  (CA-FSKCS034-CRITERIA-DATA)                   39280000
392900              LENGTH(LENGTH OF CA-FSKCS034-CRITERIA-DATA)         39290000
393000              ITEM  (PC-ONE)                                      39300000
393100              RESP  (PV-CICS-RESPONSE)                            39310000
393200     END-EXEC.                                                    39320000
393300*                                                                 39330000
393400     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      39340000
393500         CONTINUE                                                 39350000
393600     ELSE                                                         39360000
393700         SET DP013-CICS-ABEND      TO  TRUE                       39370000
393800         SET DP013-NO-ROLLBACK     TO  TRUE                       39380000
393900         MOVE 'ATTEMPTING TO WRITE SELECTION CRITERIA QUEUE'      39390000
394000                                   TO  DP013-MESSAGE-TEXT(1)      39400000
394100         PERFORM DP013-0000-PROCESS-ABEND                         39410000
394200     END-IF.                                                      39420000
394300                                                                  39430099
378800******************************************************************39431099
378900* WRITE KEY QUEUE                                                 39432099
379100******************************************************************39433099
394400 9500-WRITE-KEY-QUEUE.                                            39440000
                                                                        39441099
394500     MOVE '*9500-WRITE-KEY-QUEUE.      *' TO DP013-PARAGRAPH      39450000
394600                                                                  39460000
394700     MOVE EIBTRMID              TO CA-TS-TERM-ID                  39470000
394800     MOVE DP020-SRC-TASK-NUMBER TO CA-TS-TASK-NMBR                39480000
394900     SET CA-TS-FSWS0000-KEY     TO TRUE                           39490000
395000                                                                  39500000
395100     EXEC CICS                                                    39510000
395200          DELETEQ TS                                              39520000
395300              QUEUE (CA-SEL-QUEUE-NAME)                           39530000
395400              RESP  (PV-CICS-RESPONSE)                            39540000
395500     END-EXEC.                                                    39550000
395600*                                                                 39560000
395700     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL) OR                   39570000
395800                            DFHRESP (QIDERR)                      39580000
395900         CONTINUE                                                 39590000
396000     ELSE                                                         39600000
396100         SET DP013-CICS-ABEND      TO  TRUE                       39610000
396200         SET DP013-NO-ROLLBACK     TO  TRUE                       39620000
396300         MOVE 'ATTEMPTING TO DELETE KEY QUEUE'                    39630000
396400                                   TO  DP013-MESSAGE-TEXT(1)      39640000
396500         PERFORM DP013-0000-PROCESS-ABEND                         39650000
396600     END-IF.                                                      39660000
396700                                                                  39670000
396800     EXEC CICS                                                    39680000
396900          WRITEQ TS                                               39690000
397000              QUEUE (CA-SEL-QUEUE-NAME)                           39700000
397100              FROM  (CA-SKU-STORE)                                39710000
397200              LENGTH(LENGTH OF CA-SKU-STORE)                      39720000
397300              ITEM  (PC-ONE)                                      39730000
397400              RESP  (PV-CICS-RESPONSE)                            39740000
397500     END-EXEC.                                                    39750000
397600*                                                                 39760000
397700     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      39770000
397800         CONTINUE                                                 39780000
397900     ELSE                                                         39790000
398000         SET DP013-CICS-ABEND      TO  TRUE                       39800000
398100         SET DP013-NO-ROLLBACK     TO  TRUE                       39810000
398200         MOVE 'ATTEMPTING TO WRITE KEY QUEUE'                     39820000
398300                                   TO  DP013-MESSAGE-TEXT(1)      39830000
398400         PERFORM DP013-0000-PROCESS-ABEND                         39840000
398500     END-IF.                                                      39850000
398600                                                                  39860000
378800******************************************************************39862099
378900* DB2 ERROR ABEND                                                 39863099
379100******************************************************************39864099
398700 9900-DB2-ERROR.                                                  39870000
398800                                                                  39880000
398900     MOVE SQLCA                TO DP013-SQLCA                     39890000
399000                                                                  39900000
399100     SET DP013-NO-ROLLBACK                                        39910000
399200         DP013-XCTL-DISPLAY-RESTART                               39920000
399300         DP013-DB2-ABEND       TO TRUE                            39930000
399400                                                                  39940000
399500     PERFORM DP013-0000-PROCESS-ABEND.                            39950000
399600                                                                  39960000
378800******************************************************************39970099
378900* CICS ERROR ABEND                                                39980099
379100******************************************************************39990099
400500 9920-CICS-ERROR.                                                 40050000
400600                                                                  40060000
400700     SET DP013-NO-ROLLBACK                                        40070000
400800         DP013-XCTL-DISPLAY-RESTART                               40080000
400900         DP013-CICS-ABEND      TO TRUE                            40090000
401000                                                                  40100000
401100     PERFORM DP013-0000-PROCESS-ABEND.                            40110000
401200                                                                  40120000
401300                                                                  40130000
401900*----------------------------------------------------------------*40190000
402000*    ABEND PROCESSOR MODULE                                      *40200000
402100*----------------------------------------------------------------*40210000
402200                                                                  40220000
402300     COPY DPPD013.                                                40230004
