000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.      EPKUT082.                                       00030000
000400 AUTHOR.          STEVEN NOWAK.                                   00040000
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050000
000600 DATE-WRITTEN.    04/20/10.                                       00060001
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000*  MODULE TYPE:   COBOL2 BATCH.                                   00100000
001100*                                                                 00110000
001200* THIS PROGRAM PREPARES THE UPDATE FILE TO BE PROCESSED           00120003
001300* BY EPKUP060 UNDER THE DB2 CHECKPOINT RESTART SYSTEM.            00130003
001400*                                                                 00140000
001500* THE PROGRAM READS THE UPDATE FILE, REFORMATS THE                00150003
001600* RECORDS AND SETS A CHECKPOINT INDICATOR ON THE RECORD BASED     00160000
001700* ON HOW CHECKPOINTS WILL BE TAKEN BY THE MAINTENANCE PROGRAM.    00170000
001800* AFTER A RECORD HAS BEEN REFORMATTED IT IS PASSED TO THE         00180000
001900* TRANSACTION PREPARATION MODULE (DPKUT900) WHICH DOES SOME MORE  00190000
002000* PROCESSING ON THE RECORDS AND WRITES THE REFORMATTED RECORDS    00200000
002100* OUT TO A SEQUENTIAL FILE.                                       00210000
002200*                                                                 00220000
002300* THE PROGRAM COMMUNICATES WITH THE TRANSACTION PREPARATION       00230000
002400* MODULE USING FUNCTION CODES (OPEN, WRITE, & CLOSE) AND CHECKS   00240000
002500* THE RETURN CODE AFTER EACH REQUEST.  IF AN INVALID RETURN CODE  00250000
002600* IS RECEIVED, ANY INFORMATION THAT MAY BE HELPFUL IN RESOLVING   00260000
002700* THE BAD RETURN CODE IS DISPLAYED ON SYSOUT AND THE PROGRAM      00270000
002800* ABENDS.                                                         00280000
002900*                                                                 00290000
003000*========================== CHANGE LOG ===========================00300000
003100*  AUTH          BY         DATE       DESCRIPTION                00310004
003200*=================================================================00320000
003300* WR37120     S. NOWAK    04-20-10     CREATE PROGRAM             00330004
003400*                                                                 00340000
260107* CHG0260107  JIM HUNTER  08-13-2021   ADD COPYBOOK DPWS990 TO    00341004
260107*             CHANGE CALL TO DPKUT900 FROM STATIC TO DYNAMIC.     00342004
003500******************************************************************00350000
003600                                                                  00360000
003700 ENVIRONMENT DIVISION.                                            00370000
003800 CONFIGURATION SECTION.                                           00380000
003900                                                                  00390000
004000 SOURCE-COMPUTER.    IBM-3090.                                    00400000
004100 OBJECT-COMPUTER.    IBM-3090.                                    00410000
004200                                                                  00420000
004300 INPUT-OUTPUT SECTION.                                            00430000
004400 FILE-CONTROL.                                                    00440000
004500                                                                  00450000
004600     SELECT UPDATE-FILE   ASSIGN TO INP01.                        00460000
004700                                                                  00470000
004800 DATA DIVISION.                                                   00480000
004900 FILE SECTION.                                                    00490000
005000                                                                  00500000
005100 FD  UPDATE-FILE                                                  00510000
005200     RECORDING MODE IS F                                          00520000
005300     LABEL RECORDS ARE STANDARD                                   00530000
005400     RECORD CONTAINS 63 CHARACTERS                                00540003
005500     BLOCK CONTAINS 0 RECORDS                                     00550000
005600     DATA RECORD IS UPDATE-REC.                                   00560000
005700                                                                  00570000
005800 01  UPDATE-REC                       PIC  X(63).                 00580003
005900                                                                  00590000
006000***************************************************************** 00600000
006100*                       WORKING STORAGE                           00610000
006200***************************************************************** 00620000
006300 WORKING-STORAGE SECTION.                                         00630000
006400                                                                  00640000
006500 01  W-START                          PIC  X(40)                  00650000
006600     VALUE 'EPKUT082 - WORKING STORAGE BEGINS HERE'.              00660000
006700                                                                  00670000
006800                                                                  00680000
006900***************************************************************** 00690000
007000*                         SWITCHES                                00700000
007100***************************************************************** 00710000
007200 01  PROGRAM-SWITCHES.                                            00720000
007300     05  PS-INPUT-UPDATE-EOF-SW       PIC  X(01) VALUE 'N'.       00730000
007400         88  PS-INPUT-UPDATE-EOF                 VALUE 'Y'.       00740000
007500     05  PS-FIRST-TRANS-READ-SW       PIC  X(01) VALUE 'Y'.       00750000
007600         88  FIRST-TRANS-READ                    VALUE 'Y'.       00760000
007700                                                                  00770000
007800******************************************************************00780000
007900*                       ACCUMULATORS                              00790000
008000******************************************************************00800000
008100 01  PROGRAM-ACCUMULATORS.                                        00810000
008200     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00820000
008300     05  PA-WRITTEN                   PIC  9(11) VALUE ZEROS.     00830000
008400                                                                  00840000
008500******************************************************************00850000
008600*                           CONSTANTS                             00860000
008700******************************************************************00870000
008800 01  PROGRAM-CONSTANTS.                                           00880000
008900     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'EPKUT082'.00890000
009000                                                                  00900000
009100     05  PC-TRAN-PREP-FUNC-CODES.                                 00910000
009200         10  PC-TRAN-PREP-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00920000
009300         10  PC-TRAN-PREP-FUNC-WRITE  PIC  X(05) VALUE 'WRITE'.   00930000
009400         10  PC-TRAN-PREP-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00940000
009500                                                                  00950000
009600     05  PC-JOB-NAME                  PIC  X(08) VALUE 'EPK380  '.00960003
009700     05  PC-PLAN-NAME                 PIC  X(08) VALUE 'EPKUP060'.00970003
009800     05  PC-TRANS-RECORD-LENGTH       PIC S9(04) VALUE +63 COMP.  00980003
009900                                                                  00990000
010000******************************************************************01000000
010100*                          VARIABLES                              01010000
010200******************************************************************01020000
010300 01  PROGRAM-VARIABLES.                                           01030000
010400     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACES.    01040000
010500     05  PV-OPERATION-MSG             PIC  X(60) VALUE SPACES.    01050000
010600     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     01060000
010700                                                                  01070000
010800     05  PV-CHECKPOINT-TYPE           PIC  X(01) VALUE SPACE.     01080000
010900         88  CONTROL-BREAK                       VALUE 'C'.       01090000
011000         88  LOGICAL-TRANSACTION                 VALUE 'L'.       01100000
011100         88  TIME-INTERVAL                       VALUE 'T'.       01110000
011200         88  REQUESTED-BY-PROGRAM                VALUE 'R'.       01120000
011300                                                                  01130000
011400     05  PV-SCN-DTE                   PIC  X(10).                 01140003
011500     05  PV-LOC-NBR                   PIC S9(04) COMP.            01150003
011600     05  PV-SCN-TM                    PIC  X(08).                 01160003
011700                                                                  01170000
011800******************************************************************01180000
011900*               SYSTEM TIME AND DATE VARIABLES                    01190000
012000******************************************************************01200000
012100 01  SYS-DATE-TIME.                                               01210000
012200     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    01220000
012300     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    01230000
012400                                                                  01240000
012500 01  ST-BEG-TIME.                                                 01250000
012600     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     01260000
012700     05  FILLER                       PIC  X(01) VALUE ':'.       01270000
012800     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     01280000
012900                                                                  01290000
013000 01  ST-END-TIME.                                                 01300000
013100     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     01310000
013200     05  FILLER                       PIC  X(01) VALUE ':'.       01320000
013300     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     01330000
013400                                                                  01340000
013500 01  SD-EDIT-DATE.                                                01350000
013600     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01360000
013700     05  FILLER                       PIC  X(01) VALUE '-'.       01370000
013800     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01380000
013900     05  FILLER                       PIC  X(01) VALUE '-'.       01390000
014000     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01400000
014100     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01410000
014200                                                                  01420000
014300******************************************************************01430000
014400*                        ERROR HANDLING                           01440000
014500******************************************************************01450000
014600 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01460000
014700                                                 COMP SYNC.       01470000
014800     88  ABEND-4002-READ-ERROR             VALUE +4002.           01480000
014900     88  ABEND-4444-FORCED-ABEND           VALUE +4444.           01490000
015000                                                                  01500000
015100                                                                  01510000
015200******************************************************************01520000
015300* RECORD LAYOUT FOR UPDATE KEY                                    01530000
015400******************************************************************01540000
015500     COPY EPRD018.                                                01550003
015600                                                                  01560000
015700******************************************************************01570000
015800*  TRANSACTION PREPARATION MODULE LINKAGE SECTION                 01580000
015900******************************************************************01590000
260107     COPY DPWS990.                                                01600004
016100                                                                  01610000
016000     COPY DPLS000.                                                01611004
016100                                                                  01612004
016200******************************************************************01620000
016300*  SQL COMMUNICATIONS WORK AREA                                   01630000
016400******************************************************************01640000
016500     COPY SQLCA2.                                                 01650000
016600                                                                  01660000
016700                                                                  01670000
016800                                                                  01680000
016900                                                                  01690000
017000 PROCEDURE DIVISION.                                              01700000
017100******************************************************************01710000
017200* MAINLINE-PROCESSING                                             01720000
017300******************************************************************01730000
017400                                                                  01740000
017500     PERFORM A100-INITIALIZE.                                     01750000
017600                                                                  01760000
017700     PERFORM B100-PROCESS-UPDATE-INPUT-FILE                       01770000
017800       UNTIL PS-INPUT-UPDATE-EOF.                                 01780000
017900                                                                  01790000
018000     PERFORM Z990-END-OF-JOB-ROUTINE.                             01800000
018100                                                                  01810000
018200     GOBACK.                                                      01820000
018300                                                                  01830000
018400                                                                  01840000
018500******************************************************************01850000
018600* PREFORMS TASK INITIATION                                        01860000
018700******************************************************************01870000
018800 A100-INITIALIZE.                                                 01880000
018900                                                                  01890000
019000     OPEN INPUT UPDATE-FILE.                                      01900000
019100                                                                  01910000
019200     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01920000
019300                                                                  01930000
019400     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01940000
019500     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01950000
019600                                                                  01960000
019700     MOVE SYS-DATE (1:2) TO SD-CENT.                              01970000
019800     MOVE SYS-DATE (3:2) TO SD-YEAR.                              01980000
019900     MOVE SYS-DATE (5:2) TO SD-MONTH.                             01990000
020000     MOVE SYS-DATE (7:2) TO SD-DAY.                               02000000
020100                                                                  02010000
020200     PERFORM C100-ISSUE-OPEN-REQUEST.                             02020000
020300                                                                  02030000
020400     PERFORM C200-READ-UPDATE-INPUT-FILE.                         02040000
020500                                                                  02050000
020600     IF PS-INPUT-UPDATE-EOF                                       02060000
020700         MOVE 'C200-READ-UPDATE-INPUT-FILE' TO PV-PARAGRAPH-NAME  02070000
020800         MOVE '** EMPTY UPDATE FILE - NO DATA **'                 02080000
020900                                            TO PV-OPERATION-MSG   02090000
021000     END-IF.                                                      02100000
021100                                                                  02110000
021200                                                                  02120000
021300******************************************************************02130000
021400* PROCESS THE UPDATE FILE. IF A RECORD IS READ, GATHER WHATEVER   02140000
021500* OTHER DATA IS NECESSARY TO TAKE CHECKPOINTS BASED ON THE TYPE OF02150000
021600* CHECKPOINTS BEING TAKEN BY EPKUP060 AND ISSUE A WRITE REQUEST   02160003
021700* TO THE TRANSACTION PREPARATION PROGRAM.                         02170000
021800******************************************************************02180000
021900 B100-PROCESS-UPDATE-INPUT-FILE.                                  02190000
022000                                                                  02200000
022100     IF FIRST-TRANS-READ                                          02210000
022200         MOVE EP018-SCN-DTE   TO PV-SCN-DTE                       02220003
022300         MOVE EP018-LOC-NBR   TO PV-LOC-NBR                       02230003
022400         MOVE EP018-SCN-TM    TO PV-SCN-TM                        02240003
022500                                                                  02250000
022600         MOVE 'N'             TO PS-FIRST-TRANS-READ-SW           02260000
022700     END-IF.                                                      02270000
022800                                                                  02280000
022900     IF CONTROL-BREAK                                             02290000
023000         PERFORM C300-CKPT-BY-CNTL-BREAK                          02300000
023100     ELSE                                                         02310000
023200         IF LOGICAL-TRANSACTION                                   02320000
023300             PERFORM C400-CKPT-BY-LOGICAL-TRANS                   02330000
023400         ELSE                                                     02340000
023500             PERFORM C500-CKPT-BY-TIME-OR-REQUEST                 02350000
023600         END-IF                                                   02360000
023700     END-IF.                                                      02370000
023800                                                                  02380000
023900     PERFORM C200-READ-UPDATE-INPUT-FILE.                         02390000
024000                                                                  02400000
024100                                                                  02410000
024200******************************************************************02420000
024300* ISSUE AN 'OPEN' REQUEST TO THE TRANSACTION PREPARATION MODULE   02430000
024400******************************************************************02440000
024500 C100-ISSUE-OPEN-REQUEST.                                         02450000
024600                                                                  02460000
024700     MOVE PC-TRAN-PREP-FUNC-OPEN TO DP000-FUNC-CODE.              02470000
024800     MOVE PC-JOB-NAME            TO DP000-JOB-NAME.               02480000
024900     MOVE PC-PLAN-NAME           TO DP000-PLAN-NAME.              02490000
025000                                                                  02500000
025100     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02510000
025200                                                                  02520000
025300     MOVE DP000-CKPT-TYPE-CODE   TO PV-CHECKPOINT-TYPE.           02530000
025400                                                                  02540000
025500                                                                  02550000
025600******************************************************************02560000
025700* READ THE UPDATE INPUT FILE                                      02570000
025800******************************************************************02580000
025900 C200-READ-UPDATE-INPUT-FILE.                                     02590000
026000                                                                  02600000
026100     READ UPDATE-FILE INTO EP018-UPDT-REC                         02610003
026200       AT END SET PS-INPUT-UPDATE-EOF TO TRUE.                    02620000
026300                                                                  02630000
026400     IF PS-INPUT-UPDATE-EOF                                       02640000
026500         CONTINUE                                                 02650000
026600     ELSE                                                         02660000
026700         ADD +1 TO PA-READ                                        02670000
026800     END-IF.                                                      02680000
026900                                                                  02690000
027000                                                                  02700000
027100******************************************************************02710000
027200* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACATION  02720000
027300* RECORD "ON" IF THERE IS A CHANGE IN THE KEY. AFTER              02730000
027400* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   02740000
027500* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   02750000
027600******************************************************************02760000
027700 C300-CKPT-BY-CNTL-BREAK.                                         02770000
027800                                                                  02780000
027900     IF  EP018-SCN-DTE   = PV-SCN-DTE                             02790003
028000     AND EP018-LOC-NBR   = PV-LOC-NBR                             02800003
028100     AND EP018-SCN-TM    = PV-SCN-TM                              02810003
028200         MOVE 'N' TO DP000-CHECKPOINT-IND                         02820000
028300     ELSE                                                         02830000
028400         MOVE 'Y' TO DP000-CHECKPOINT-IND                         02840000
028500         MOVE EP018-SCN-DTE   TO PV-SCN-DTE                       02850003
028600         MOVE EP018-LOC-NBR   TO PV-LOC-NBR                       02860003
028700         MOVE EP018-SCN-TM    TO PV-SCN-TM                        02870003
028800     END-IF.                                                      02880000
028900                                                                  02890000
029000     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      02900000
029100     MOVE EP018-UPDT-REC          TO DP000-TRANS-REC.             02910003
029200     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             02920000
029300     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              02930000
029400     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             02940000
029500                                                                  02950000
029600     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02960000
029700                                                                  02970000
029800     ADD +1 TO PA-WRITTEN.                                        02980000
029900                                                                  02990000
030000                                                                  03000000
030100******************************************************************03010000
030200* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACTION   03020000
030300* RECORD "ON".  THE UPDATE PROGRAM WILL CHECK THE CHECKPOINT      03030000
030400* FREQUENCY TO KNOW WHETHER A CHECKPOINT SHOULD BE TAKEN. AFTER   03040000
030500* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   03050000
030600* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   03060000
030700* THE 'Y' INCREMENTS THE COUNTER THAT COMPARES THE NUMBER THAT    03070000
030800* WAS SET ON THE CICS SCREEN FOR THE COMMIT                       03080000
030900******************************************************************03090000
031000 C400-CKPT-BY-LOGICAL-TRANS.                                      03100000
031100                                                                  03110000
031200     MOVE 'Y'                     TO DP000-CHECKPOINT-IND.        03120000
031300     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03130000
031400     MOVE EP018-UPDT-REC          TO DP000-TRANS-REC.             03140003
031500     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03150000
031600     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03160000
031700     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03170000
031800                                                                  03180000
031900     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03190000
032000                                                                  03200000
032100     ADD +1 TO PA-WRITTEN.                                        03210000
032200                                                                  03220000
032300                                                                  03230000
032400******************************************************************03240000
032500* THIS ROUTINE BUILDS THE TRANSACTION RECORD AND ISSUES A WRITE   03250000
032600* REQUEST TO THE TRANSACTION PREPARATION MODULE IF CHECKPOINTS ARE03260000
032700* TAKEN BY TIME INTERVAL (SECONDS) OR REQUESTED BY THE MAINTENANCE03270000
032800* PROGRAM.                                                        03280000
032900******************************************************************03290000
033000 C500-CKPT-BY-TIME-OR-REQUEST.                                    03300000
033100                                                                  03310000
033200     MOVE 'N'                     TO DP000-CHECKPOINT-IND.        03320000
033300                                                                  03330000
033400     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03340000
033500     MOVE EP018-UPDT-REC          TO DP000-TRANS-REC.             03350003
033600     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03360000
033700     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03370000
033800     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03380000
033900                                                                  03390000
034000     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03400000
034100                                                                  03410000
034200     ADD +1 TO PA-WRITTEN.                                        03420000
034300                                                                  03430000
034400                                                                  03440000
034500******************************************************************03450000
034600* ISSUE A 'CLOSE' REQUEST TO THE TRANSACTION PREPARATION MODULE   03460000
034700******************************************************************03470000
034800 C600-ISSUE-CLOSE-REQUEST.                                        03480000
034900                                                                  03490000
035000     MOVE PC-TRAN-PREP-FUNC-CLOSE TO DP000-FUNC-CODE.             03500000
035100     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03510000
035200     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03520000
035300                                                                  03530000
035400     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03540000
035500                                                                  03550000
035600                                                                  03560000
035700******************************************************************03570000
035800* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03580000
035900******************************************************************03590000
036000 Z100-CALL-TRANS-PREP-MODULE.                                     03600000
036100                                                                  03610000
036200     PERFORM Z900-CALL-TRANS-PREP-MODULE.                         03620000
036300                                                                  03630000
036400     IF  DP000-GOOD-RET-CODE                                      03640000
036500         CONTINUE                                                 03650000
036600                                                                  03660000
036700     ELSE                                                         03670000
036800         MOVE 'Z100-CALL-TRANS-PREP-MODULE' TO PV-PARAGRAPH-NAME  03680000
036900         MOVE '** BAD CALL TO TRANS PREP MODULE **'               03690000
037000                                            TO PV-OPERATION-MSG   03700000
037100         MOVE DP000-RET-CODE                TO PV-RET-CODE        03710000
037200                                                                  03720000
037300         SET ABEND-4444-FORCED-ABEND TO TRUE                      03730000
037400                                                                  03740000
037500         PERFORM Z200-ABEND                                       03750000
037600     END-IF.                                                      03760000
037700                                                                  03770000
037800                                                                  03780000
037900******************************************************************03790000
038000* NON-DB2 ABEND                                                   03800000
038100******************************************************************03810000
038200 Z200-ABEND.                                                      03820000
038300                                                                  03830000
038400     PERFORM Z999-CONTROLS.                                       03840000
038500                                                                  03850000
038600     DISPLAY '                     '.                             03860000
038700     DISPLAY '** ABEND           **'.                             03870000
038800     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03880000
038900     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03890000
039000     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03900000
039100     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              03910000
039200                                                                  03920000
039300     CALL 'ILBOABN0' USING ABEND-CODE.                            03930000
039400                                                                  03940000
039500                                                                  03950000
039600******************************************************************03960000
039700* PREFORMS TASK TERMINATION PROCESSING                            03970000
039800******************************************************************03980000
039900 Z990-END-OF-JOB-ROUTINE.                                         03990000
040000                                                                  04000000
040100     CLOSE UPDATE-FILE.                                           04010000
040200                                                                  04020000
040300     PERFORM C600-ISSUE-CLOSE-REQUEST.                            04030000
040400                                                                  04040000
040500     PERFORM Z999-CONTROLS.                                       04050000
040600                                                                  04060000
040700                                                                  04070000
040800******************************************************************04080000
040900* DISPLAY CONTROLS FROM THE PROGRAM                               04090000
041000******************************************************************04100000
041100 Z999-CONTROLS.                                                   04110000
041200                                                                  04120000
041300     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04130000
041400                                                                  04140000
041500     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04150000
041600     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04160000
041700                                                                  04170000
041800     DISPLAY '                    '.                              04180000
041900     DISPLAY '**********************'.                            04190000
042000     DISPLAY '   EPKUT082 CONTROLS  '.                            04200000
042100     DISPLAY '**********************'.                            04210000
042200     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04220000
042300     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04230000
042400     DISPLAY 'END TIME  = ' ST-END-TIME.                          04240000
042500     DISPLAY '======================'.                            04250000
042600     DISPLAY 'RECORDS READ    = ' PA-READ.                        04260000
042700     DISPLAY '                  '.                                04270000
042800     DISPLAY 'RECORDS WRITTEN = ' PA-WRITTEN.                     04280000
042900     DISPLAY '                  '.                                04290000
043000                                                                  04300000
043100                                                                  04310000
043200******************************************************************04320000
043300* TRANSACTION PREPARATION MODULE CALL AND ERROR ROUTINES          04330000
043400******************************************************************04340000
043500     COPY DPPD000.                                                04350000
043600                                                                  04360000
043700                                                                  04370000
