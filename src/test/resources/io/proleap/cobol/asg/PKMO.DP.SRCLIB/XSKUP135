       IDENTIFICATION DIVISION.                                         00001001
                                                                        00002001
       PROGRAM-ID.      XSKUP135.                                       00003001
       AUTHOR.          CHERI PARMLEY.                                  00004001
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00005001
       DATE-WRITTEN.    07/01/11.                                       00006001
       DATE-COMPILED.                                                   00007001
                                                                        00008001
      ******************************************************************00009001
      *  MODULE TYPE: COBOL2 DB2 BATCH                                  00009101
      *                                                                 00009201
      *  DESCRIPTION: UPDATE TABLE XST_RTV_LOC_RLTNSHP                  00009301
      *               HOLDS THE ASSIGNED RTV LOCATION FOR A SPECIFIC    00009401
      *               DC.                                               00009501
      *                                                                 00009601
      *               FILE    DESCRIPTION                COPYBOOK       00009701
      *               -----   -------------------        ---------      00009801
      *               DB2     XST_RTV_LOC_RLTNSHP        XST00135       00009901
      *                                                                 00010001
      *               INP01   CONTROL-FILE               XSRD151        00011009
      *                                                                 00012001
      *========================== CHANGE LOG ===========================00013001
      *  AUTH       BY           DATE     DESCRIPTION                   00014015
      *=================================================================00015001
      * WR40189     C.PARMLEY  07-01-11   CREATE PROGRAM                00016015
      *                                                                 00017001
260107* CHG0260107  JIM HUNTER 08-19-21   ADD COPYBOOK DPWS991 TO MAKE  00017115
260107*                                   DPKUT901 CALL DYNAMIC.        00017215
      ******************************************************************00018001
                                                                        00019001
       ENVIRONMENT DIVISION.                                            00019101
       CONFIGURATION SECTION.                                           00019201
                                                                        00019301
       SOURCE-COMPUTER.        IBM-3090.                                00019401
       OBJECT-COMPUTER.        IBM-3090.                                00019501
                                                                        00019601
       INPUT-OUTPUT SECTION.                                            00019701
       FILE-CONTROL.                                                    00019801
                                                                        00019901
       DATA DIVISION.                                                   00022001
       FILE SECTION.                                                    00023001
                                                                        00024001
      ******************************************************************00030401
      *                       WORKING STORAGE                           00031001
      ******************************************************************00032001
       WORKING-STORAGE SECTION.                                         00033001
                                                                        00034001
       01  W-START                       PIC  X(40)                     00035001
           VALUE 'XSKUP135 - WORKING STORAGE BEGINS HERE'.              00036001
                                                                        00037001
                                                                        00038001
      ******************************************************************00039001
      *                         SWITCHES                                00039101
      ******************************************************************00039201
       01  PS-PROGRAM-SWITCHES.                                         00039301
           05  PS-EOF-SW                 PIC  X(01)  VALUE 'N'.         00039401
               88  END-OF-FILE                       VALUE 'Y'.         00039501
           05  PS-IS-UPDATE              PIC  X(01)  VALUE 'N'.         00039601
               88  UPDATE-REC                        VALUE 'Y'.         00039701
               88  NO-UPDATE-REC                     VALUE 'N'.         00039801
004800     05  PS-RESTART-REQUIRED-SW    PIC  X(01) VALUE 'N'.          00039911
004900         88  PS-RESTART-REQUIRED               VALUE 'Y'.         00040011
005000         88  PS-RESTART-NOT-REQUIRED           VALUE 'N'.         00040111
                                                                        00040201
      ******************************************************************00040301
      *                 PROGRAM ACCUMULATORS                            00040401
      ******************************************************************00040501
       01  PA-PROGRAM-ACCUM.                                            00040601
           05  PA-INSERT                 PIC  9(05)  VALUE 0.           00041001
           05  PA-UPDATE                 PIC  9(05)  VALUE 0.           00042001
           05  PA-READ                   PIC  9(11)  VALUE ZEROS.       00042110
           05  PA-CKPT                   PIC  9(11)  VALUE ZEROS.       00042210
                                                                        00043001
      ******************************************************************00043106
      *                 PROGRAM VARIABLES                               00043206
      ******************************************************************00043306
       01  PV-PROGRAM-VARIABLES.                                        00043406
           05  PV-SQL                     PIC +9(04).                   00043506
           05  PV-NBR                     PIC +9(04).                   00043606
           05  PV-PARAGRAPH-NAME          PIC  X(30)  VALUE SPACES.     00043706
           05  PV-TABLE-NAME              PIC  X(12)  VALUE SPACES.     00043806
           05  PV-OPERATION-MSG           PIC  X(60)  VALUE SPACES.     00043906
008600     05  PV-DEADLOCK-COUNTER        PIC  9(03)  VALUE ZERO.       00044111
009000     05  PV-RET-CODE                PIC  9(04)  VALUE ZEROS.      00044511
                                                                        00044606
      ******************************************************************00044701
      *                          CONSTANTS                              00045001
      ******************************************************************00046001
       01  PC-PROGRAM-CONSTANTS.                                        00047001
006300     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         00048109
006400                                                 COMP SYNC.       00048209
006500     05  PC-MAX-DEADLOCKS             PIC S9(04) VALUE +3         00048309
006600                                                 COMP SYNC.       00048409
006700                                                                  00048509
006800     05  PC-CKPT-JOB-NAME             PIC  X(08) VALUE 'XSK921  '.00048609
006900     05  PC-CKPT-PLAN-NAME            PIC  X(08) VALUE 'XSKUP135'.00048709
007000     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XSKUP135'.00048809
007100                                                                  00048909
007200     05  PC-TRAN-PRES-FUNC-CODES.                                 00049009
007300         10  PC-TRAN-PRES-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00049109
007400         10  PC-TRAN-PRES-FUNC-TRANS  PIC  X(05) VALUE 'TRANS'.   00049209
007500         10  PC-TRAN-PRES-FUNC-RSTRT  PIC  X(05) VALUE 'RSTRT'.   00049309
007600         10  PC-TRAN-PRES-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00049409
007700                                                                  00049509
007800     05  PC-MINUS-ONE                 PIC S9(01) VALUE -1.        00049609
007900     05  PC-SYSTEM                    PIC  X(08) VALUE 'SYSTEM  '.00049709
                                                                        00049801
                                                                        00049901
      ******************************************************************00059001
      *               SYSTEM TIME AND DATE VARIABLES                    00059101
      ******************************************************************00059201
       01  SYS-DATE-TIME.                                               00059301
           05  SYS-DATE                  PIC  X(08)  VALUE SPACES.      00059401
           05  SYS-TIME                  PIC  X(08)  VALUE SPACES.      00059501
                                                                        00059601
       01  ST-BEG-TIME.                                                 00059701
           05  ST-BEG-HR                 PIC  9(02)  VALUE ZEROS.       00059801
           05  FILLER                    PIC  X(01)  VALUE ':'.         00059901
           05  ST-BEG-MN                 PIC  9(02)  VALUE ZEROS.       00060001
                                                                        00061001
       01  ST-END-TIME.                                                 00062001
           05  ST-END-HR                 PIC  9(02)  VALUE ZEROS.       00063001
           05  FILLER                    PIC  X(01)  VALUE ':'.         00064001
           05  ST-END-MN                 PIC  9(02)  VALUE ZEROS.       00065001
                                                                        00066001
       01  SD-EDIT-DATE.                                                00067001
           05  SD-MONTH                  PIC  9(02)  VALUE ZEROS.       00068001
           05  FILLER                    PIC  X(01)  VALUE '-'.         00069001
           05  SD-DAY                    PIC  9(02)  VALUE ZEROS.       00069101
           05  FILLER                    PIC  X(01)  VALUE '-'.         00069201
           05  SD-CENT                   PIC  9(02)  VALUE ZEROS.       00069301
           05  SD-YEAR                   PIC  9(02)  VALUE ZEROS.       00069401
                                                                        00069501
      ******************************************************************00069601
      *                        ERROR HANDLING                           00069701
      ******************************************************************00069801
       01  ABEND-CODE                    PIC S9(4)   VALUE ZEROS        00069901
                                                     COMP SYNC.         00070001
           88  ABEND-4444-FORCED-ABEND               VALUE +4444.       00071001
012400     88  ABEND-4019-CAL-SUB-ERROR                VALUE +4019.     00071111
                                                                        00072001
012700******************************************************************00072109
012800*  LAYOUT FOR UNLOAD FILE RECORDS                                 00072209
012900******************************************************************00072309
013000     COPY XSRD151.                                                00072409
013100                                                                  00072509
      ******************************************************************00073001
      * VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         00074001
      ******************************************************************00075001
           COPY DPWS004.                                                00076001
                                                                        00077001
      ******************************************************************00078001
      * DB2 MESSAGE AREA                                                00079001
      ******************************************************************00079101
           COPY SQLCA2.                                                 00079201
                                                                        00079301
005400     EXEC SQL                                                     00080204
005500          INCLUDE SQLCA                                           00080304
005600     END-EXEC.                                                    00080404
                                                                        00081001
      *----------------------------------------------------------------*00089101
      * COBOL DECLARATION FOR DB2 XST_RTV_LOC_RLTNSHP                   00089201
      *----------------------------------------------------------------*00089301
           EXEC SQL                                                     00089401
             INCLUDE XST00135                                           00089501
           END-EXEC.                                                    00089601
                                                                        00089701
015700******************************************************************00089809
015800*  TRANSACTION PREPARATION MODULE COMMUNICATIONS AREA             00089909
015900******************************************************************00090009
260107     COPY DPWS991.                                                00090115
016000                                                                  00090215
016000     COPY DPLS001.                                                00090315
016100     05  WORK-STORAGE-PASSED.                                     00090415
                                                                        00090515
016200******************************************************************00090615
016300*PA - PROGRAM ACCUMULATORS                                        00090715
016400******************************************************************00090815
016500         10  PROGRAM-ACCUMULATORS.                                00090915
016600             15  PA-ROWS-INSERTED      PIC S9(11)       VALUE ZERO00091015
016700                                                        COMP-3.   00091115
016600             15  PA-ROWS-UPDATED       PIC S9(11)       VALUE ZERO00091215
016700                                                        COMP-3.   00091315
016800                                                                  00091409
016900 01  FILLER                          PIC X(4096)  VALUE SPACE.    00091509
                                                                        00091602
                                                                        00092001
       PROCEDURE DIVISION.                                              00095001
      ******************************************************************00096001
      * MAIN DRIVER                                                     00097001
      ******************************************************************00098001
                                                                        00099001
           PERFORM A1000-INITIALIZE.                                    00099101
                                                                        00099201
           PERFORM B1000-PROCESS                                        00099309
             UNTIL DP001-PREP-TRANS-EOF.                                00099409
                                                                        00099501
           PERFORM Z990-EOJ-ROUTINE.                                    00099710
                                                                        00099810
           GOBACK.                                                      00100001
                                                                        00100201
      ******************************************************************00100301
      * PERFORMS TASK INITIATION                                        00101001
      ******************************************************************00102001
       A1000-INITIALIZE.                                                00103001
                                                                        00104001
           MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 00109001
                                                                        00109101
           MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            00109201
           MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            00109301
                                                                        00109401
           MOVE SYS-DATE (1:2) TO SD-CENT.                              00109501
           MOVE SYS-DATE (3:2) TO SD-YEAR.                              00109601
           MOVE SYS-DATE (5:2) TO SD-MONTH.                             00109701
           MOVE SYS-DATE (7:2) TO SD-DAY.                               00109801
                                                                        00109901
           MOVE PC-TRAN-PRES-FUNC-OPEN TO DP001-FUNC-CODE.              00110009
                                                                        00110209
           PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      00110309
                                                                        00110409
      ******************************************************************00130001
      * PROCESS INFORMATION IN CONTROL CARD                             00131001
      ******************************************************************00132001
       B1000-PROCESS.                                                   00133001
                                                                        00134001
021300     SET PS-RESTART-NOT-REQUIRED TO TRUE.                         00134109
021400                                                                  00134209
           MOVE XS151-LOC-NBR     TO XST00135-LOC-NBR                   00134310
           MOVE XS151-XFER-TYP    TO XST00135-XFER-TYP-CDE              00134410
           MOVE XS151-BEG-DTE     TO XST00135-EFF-BEG-DTE               00134510
           MOVE XS151-END-DTE     TO XST00135-EFF-END-DTE               00134610
           MOVE XS151-RTV-LOC-NBR TO XST00135-RTV-LOC-NBR               00134710
                                                                        00134810
021500     PERFORM B2000-INSERT.                                        00134910
021600                                                                  00135009
021700*----------------------------------------------------------------*00135109
021800*  IF A RESTART IS REQUIRED, ISSUE A RESTART CALL RATHER THAN A  *00135209
021900*  TRANS CALL.  THIS WILL ALLOW PROCESSING TO RESUME WITH THE    *00135309
022000*  FIRST TRANSACTION AFTER THE LAST COMMIT.                      *00135409
022100*----------------------------------------------------------------*00135509
022200     IF  PS-RESTART-REQUIRED                                      00135609
022300         MOVE PC-TRAN-PRES-FUNC-RSTRT TO DP001-FUNC-CODE          00135709
022400     ELSE                                                         00135809
022500         MOVE PC-TRAN-PRES-FUNC-TRANS TO DP001-FUNC-CODE          00135909
022600     END-IF.                                                      00136009
022700                                                                  00136109
022800     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      00136209
022900                                                                  00136309
023000     ADD 1 TO PA-READ.                                            00136409
                                                                        00139601
      ******************************************************************00139701
      * INSERT DATA INTO XST_RTV_LOC_RLTNSHP                            00139801
      ******************************************************************00139901
       B2000-INSERT.                                                    00140001
                                                                        00140101
           EXEC SQL                                                     00141001
                INSERT INTO XST_RTV_LOC_RLTNSHP                         00142001
                       (LOC_NBR                                         00143001
                      , XFER_TYP_CDE                                    00144001
                      , EFF_BEG_DTE                                     00144101
                      , EFF_END_DTE                                     00144201
                      , RTV_LOC_NBR)                                    00145001
                                                                        00146001
                VALUES(:XST00135-LOC-NBR                                00147001
                     , :XST00135-XFER-TYP-CDE                           00148001
                     , :XST00135-EFF-BEG-DTE                            00149003
                     , :XST00135-EFF-END-DTE                            00149103
                     , :XST00135-RTV-LOC-NBR)                           00149201
           END-EXEC.                                                    00149301
                                                                        00149501
           SET NO-UPDATE-REC TO TRUE                                    00149601
                                                                        00149701
           EVALUATE TRUE                                                00149801
             WHEN SQLCODE = ZEROS                                       00149901
               ADD +1 TO PA-INSERT                                      00150001
                                                                        00150101
              WHEN SQLCODE = -803                                       00150208
                   SET UPDATE-REC TO TRUE                               00150301
                                                                        00150401
             WHEN OTHER                                                 00151001
               MOVE SQLCODE                    TO PV-NBR                00152001
               MOVE 'XST_RTV_LOC_RLTNSHP'      TO PV-TABLE-NAME         00153001
               MOVE 'B2000-INSERT            ' TO PV-PARAGRAPH-NAME     00154001
                                                                        00155001
               STRING 'INSERT ERROR - SQLCODE= '                        00156001
                       PV-NBR DELIMITED BY SIZE INTO                    00157001
                       PV-OPERATION-MSG                                 00158001
               END-STRING                                               00159001
               DISPLAY '********************************************'   00159101
               DISPLAY 'ERROR ON INSERT '                               00159201
               DISPLAY 'XST00135-LOC-NBR      = ' XST00135-LOC-NBR      00159310
               DISPLAY 'XST00135-XFER-TYP-CDE = ' XST00135-XFER-TYP-CDE 00159401
               DISPLAY 'XST00135-EFF-BEG-DTE  = ' XST00135-EFF-BEG-DTE  00159510
               DISPLAY 'XST00135-EFF-END-DTE  = ' XST00135-EFF-END-DTE  00159610
               DISPLAY 'XST00135-RTV-LOC-NBR  = ' XST00135-RTV-LOC-NBR  00159710
               DISPLAY '********************************************'   00159801
                                                                        00159901
               PERFORM Z100-ABEND                                       00160010
           END-EVALUATE.                                                00160101
                                                                        00160201
           IF UPDATE-REC                                                00160301
               PERFORM B2100-UPDATE                                     00160401
           END-IF.                                                      00160501
                                                                        00161001
      ******************************************************************00162001
      * UPDATE XST_RTV_LOC_RLTNSHP                                      00163001
      ******************************************************************00164001
       B2100-UPDATE.                                                    00165001
                                                                        00166001
           EXEC SQL                                                     00167001
                UPDATE XST_RTV_LOC_RLTNSHP                              00168001
                SET  LOC_NBR        = :XST00135-LOC-NBR                 00169001
                    ,XFER_TYP_CDE   = :XST00135-XFER-TYP-CDE            00169101
                    ,EFF_BEG_DTE    = :XST00135-EFF-BEG-DTE             00169201
                    ,EFF_END_DTE    = :XST00135-EFF-END-DTE             00169301
                    ,RTV_LOC_NBR    = :XST00135-RTV-LOC-NBR             00169403
                WHERE LOC_NBR      = :XST00135-LOC-NBR                  00169501
                  AND XFER_TYP_CDE = :XST00135-XFER-TYP-CDE             00169601
                  AND EFF_BEG_DTE  = :XST00135-EFF-BEG-DTE              00169701
           END-EXEC.                                                    00169801
                                                                        00169901
                                                                        00170001
           EVALUATE TRUE                                                00170101
             WHEN SQLCODE = ZEROS                                       00170201
               ADD +1 TO PA-UPDATE                                      00170301
                                                                        00170401
             WHEN OTHER                                                 00170501
               MOVE SQLCODE                    TO PV-NBR                00171001
               MOVE 'XST_RTV_LOC_RLTNSHP'      TO PV-TABLE-NAME         00172001
               MOVE 'B2100-UPDATE            ' TO PV-PARAGRAPH-NAME     00173001
                                                                        00174001
               STRING 'UPDATE ERROR - SQLCODE= '                        00175001
                       PV-NBR DELIMITED BY SIZE INTO                    00176001
                       PV-OPERATION-MSG                                 00177001
               END-STRING                                               00178001
               DISPLAY '********************************************'   00179001
               DISPLAY 'ERROR ON UPDATE '                               00179101
               DISPLAY 'XST00135-LOC-NBR      = ' XST00135-LOC-NBR      00179410
               DISPLAY 'XST00135-XFER-TYP-CDE = ' XST00135-XFER-TYP-CDE 00179501
               DISPLAY 'XST00135-EFF-BEG-DTE  = ' XST00135-EFF-BEG-DTE  00179610
               DISPLAY 'XST00135-EFF-END-DTE  = ' XST00135-EFF-END-DTE  00179710
               DISPLAY 'XST00135-RTV-LOC-NBR  = ' XST00135-RTV-LOC-NBR  00179810
               DISPLAY '********************************************'   00179901
                                                                        00180401
               PERFORM Z100-ABEND                                       00180510
           END-EVALUATE.                                                00180601
                                                                        00180701
                                                                        00180801
031400******************************************************************00180910
031500* BUILD THE COMMUNICATION AREA FOR A CALL TO THE TRANSACTION      00181010
031600* PRESENTATION MODULE                                             00181110
031700******************************************************************00181210
031800 X100-BUILD-COMM-AREA-TRAN-PRES.                                  00181310
031900                                                                  00181410
032000     MOVE LENGTH OF                                               00181510
032100          WORK-STORAGE-PASSED TO DP001-WORK-STRG-LENGTH.          00181610
032200     MOVE PC-CKPT-JOB-NAME    TO DP001-JOB-NAME.                  00181710
032300     MOVE PC-CKPT-PLAN-NAME   TO DP001-PLAN-NAME.                 00181810
032400                                                                  00182110
032500     PERFORM X200-CALL-TRANS-PRES-MODULE.                         00182210
032600                                                                  00182410
032700     MOVE DP001-TRANS-RECORD  TO XS151-RTV-REC.                   00182510
032800                                                                  00182610
032900     IF  DP001-CKPT-TAKEN                                         00182710
033000         ADD 1 TO PA-CKPT                                         00182810
033100                                                                  00182910
033200         INITIALIZE PV-DEADLOCK-COUNTER                           00183010
033300     END-IF.                                                      00183110
033400                                                                  00183210
033500                                                                  00183310
033600******************************************************************00183410
033700* VERIFY THE RETURN CODE ON THE CALLED MODULE                     00183510
033800******************************************************************00183610
033900 X200-CALL-TRANS-PRES-MODULE.                                     00183710
034000                                                                  00183910
034100     PERFORM Z900-CALL-TRANS-PRES-MODULE.                         00184010
034200                                                                  00184210
034300     IF  DP001-GOOD-RET-CODE                                      00184310
034400     OR  DP001-CKPT-TAKEN                                         00184410
034500     OR  DP001-RESTART                                            00184510
034600         CONTINUE                                                 00184610
034700                                                                  00184810
034800     ELSE                                                         00184910
034900         MOVE 'X200-CALL-TRANS-PRES-MODULE' TO PV-PARAGRAPH-NAME  00185010
035000         MOVE '** BAD CALL TO TRANS PREP MODULE **'               00185110
035100                                            TO PV-OPERATION-MSG   00185210
035200         MOVE DP001-RET-CODE                TO PV-RET-CODE        00185310
035300                                                                  00185410
035400         SET ABEND-4019-CAL-SUB-ERROR TO TRUE                     00185510
035500                                                                  00185610
035600         PERFORM Z100-ABEND                                       00185710
035700     END-IF.                                                      00185810
035800                                                                  00185910
035900                                                                  00186010
      ******************************************************************00199501
      * SQL ABEND                                                       00199610
      ******************************************************************00199701
       Z100-ABEND.                                                      00199810
                                                                        00199901
           PERFORM Z999-CONTROLS.                                       00200010
                                                                        00201001
           MOVE SQLCODE TO SQLCODE2.                                    00202001
           MOVE SQLERRD(3) TO SQLERRD3.                                 00203001
                                                                        00204001
           DISPLAY '                        '.                          00205001
           DISPLAY '** ABEND           ** = SQLABEND'.                  00206001
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          00207001
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        00208001
           DISPLAY '** TABLES AFFECTED ** = ' PV-TABLE-NAME.            00209001
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         00209101
           DISPLAY '** SQLCODE         ** = ' SQLCODE2.                 00209201
           DISPLAY '** ROWS PROCESSED  ** = ' SQLERRD3.                 00209301
           DISPLAY '** SQLERRM         ** = ' SQLERRM.                  00209401
           DISPLAY '** SQLERRMC        ** = ' SQLERRMC.                 00209501
                                                                        00209601
      ******************************************************************00209701
      *  THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   00209801
      *  MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        00209901
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     00210001
      *  FORMAT.                                                        00211001
      ******************************************************************00212001
                                                                        00213001
           COPY DPPD004.                                                00214001
                                                                        00215001
           SET ABEND-4444-FORCED-ABEND TO TRUE.                         00216001
                                                                        00217001
           CALL 'ILBOABN0' USING ABEND-CODE.                            00218001
                                                                        00219001
                                                                        00219101
040300******************************************************************00229710
040400* PREFORMS TASK TERMINATION PROCESSING                            00229810
040500******************************************************************00229910
040600 Z990-EOJ-ROUTINE.                                                00230010
040700                                                                  00240010
040800     MOVE PC-TRAN-PRES-FUNC-CLOSE TO DP001-FUNC-CODE.             00250010
040900                                                                  00260010
041000     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      00270010
041100                                                                  00280010
041200     PERFORM Z999-CONTROLS.                                       00290010
041300                                                                  00300010
041400                                                                  00310010
041500******************************************************************00320010
041600* DISPLAY CONTROLS FROM THE PROGRAM                               00330010
041700******************************************************************00340010
041800 Z999-CONTROLS.                                                   00350010
041900                                                                  00360010
042000     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 00370010
042100                                                                  00380010
042200     MOVE SYS-TIME (1:2) TO ST-END-HR.                            00390010
042300     MOVE SYS-TIME (3:2) TO ST-END-MN.                            00400010
042400                                                                  00410010
042500     DISPLAY '                    '.                              00420010
042600     DISPLAY '**********************'.                            00430010
042700     DISPLAY '   XSKUP135 CONTROLS  '.                            00440012
042800     DISPLAY '**********************'.                            00450010
042900     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         00460010
043000     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          00470010
043100     DISPLAY 'END TIME  = ' ST-END-TIME.                          00480010
043200     DISPLAY '======================'.                            00490010
043300     DISPLAY 'RECORDS READ   = ' PA-READ.                         00500010
043400     DISPLAY 'CHECKPOINTS    = ' PA-CKPT.                         00510010
043500     DISPLAY '                '.                                  00520010
043600     DISPLAY 'ROWS INSERTED  = ' PA-INSERT.                       00530010
043600     DISPLAY 'ROWS UPDATED   = ' PA-UPDATE.                       00540010
043700     DISPLAY '                '.                                  00560010
043800                                                                  00570010
043900******************************************************************00580010
044000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    00590010
044100* MENTS THAT ARE REQUIRED TO INVOKE THE TRANSACTION PRESENTATION  00600010
044200* MODULE (DPKUT901) OF THE DB2 CHECKPOINT RESTART SYSTEM.         00610010
044300******************************************************************00620010
044400     COPY DPPD001.                                                00630010
044500                                                                  00640010
044600                                                                  00650010
