000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRP007.                                00050000
000600 AUTHOR.                 PATRICK BURKE                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JULY, 2000.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100***************************************************************** 00110000
001200*                                                               * 00120000
001300*  THIS PROGRAM WILL CREATE THE PO/STORE UNIT ADJUSTMENTS       * 00130000
001400*  REPORT.                                                      * 00140000
001500***************************************************************** 00150000
001500*  CHANGE MADE: EXPANDED PO # FROM 7 TO 8 DIGITS                * 00151015
001500*         WHEN: 09/30/14                                        * 00151115
001500*           BY: CHERI PARMLEY - CHG# 0094517                    * 00152016
001600***************************************************************** 00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800***************************************************************** 00180000
001900                                                                  00190000
002000 CONFIGURATION SECTION.                                           00200000
002100                                                                  00210000
002200 SOURCE-COMPUTER.        IBM-3090.                                00220000
002300 OBJECT-COMPUTER.        IBM-3090.                                00230000
002400                                                                  00240000
002500 INPUT-OUTPUT SECTION.                                            00250000
002600                                                                  00260000
002700 FILE-CONTROL.                                                    00270000
002800*                                                                 00280000
002900     SELECT EXTRACT-FILE                                          00290000
003000         ASSIGN TO INP01.                                         00300000
003100                                                                  00310000
003200     SELECT EXTRACT-FILE2                                         00320000
003300         ASSIGN TO INP02.                                         00330000
003400                                                                  00340000
003500     SELECT UNIT-ADJUSTMENT-FILE                                  00350000
003600         ASSIGN TO RPT01.                                         00360000
003700*                                                                 00370000
003800***************************************************************** 00380000
003900 DATA DIVISION.                                                   00390000
004000***************************************************************** 00400000
004100*                                                                 00410000
004200 FILE SECTION.                                                    00420000
004300*                                                                 00430000
004400 FD  EXTRACT-FILE                                                 00440000
004500     LABEL RECORDS ARE STANDARD                                   00450000
004600     RECORDING MODE IS F                                          00460000
004700     BLOCK CONTAINS 0 RECORDS                                     00470000
004800     RECORD CONTAINS 200 CHARACTERS.                              00480000
004900 01  EXTRACT-RECORD                  PIC X(200).                  00490000
005000*                                                                 00500000
005100 FD  EXTRACT-FILE2                                                00510000
005200     LABEL RECORDS ARE STANDARD                                   00520000
005300     RECORDING MODE IS F                                          00530000
005400     BLOCK CONTAINS 0 RECORDS                                     00540000
005500     RECORD CONTAINS 200 CHARACTERS.                              00550000
005600 01  EXTRACT-RECORD2                 PIC X(200).                  00560000
005700                                                                  00570000
005800 FD  UNIT-ADJUSTMENT-FILE                                         00580000
005900     RECORDING MODE IS F                                          00590000
006000     BLOCK CONTAINS 0  RECORDS.                                   00600000
006100 01  UNIT-ADJUSTMENT-RECORD          PIC X(132).                  00610000
006200*                                                                 00620000
006300                                                                  00630000
006400 WORKING-STORAGE SECTION.                                         00640000
006500**************************************************************    00650000
006600* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00660000
006700**************************************************************    00670000
006800 01  CC-CONTROL-CARD.                                             00680000
006900     05  CC-PRINTER-ID                PIC  X(08).                 00690000
007000     05  CC-PRTR-CNTL-IND             PIC  X(01).                 00700000
007100     05  CC-TRACK-NBR                 PIC  9(01).                 00710000
007200     05  FILLER                       PIC  X(01).                 00720000
007300     05  CC-CUT-REPORT                PIC  X(01).                 00730000
007400         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     00740000
007500     05  CC-REQUESTOR-ID              PIC  X(08).                 00750000
007600     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 00760000
007700         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     00770000
007800     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 00780000
007900         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     00790000
008000     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 00800000
008100         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     00810000
008200     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 00820000
008300         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     00830000
008400     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 00840000
008500         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     00850000
008600     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 00860000
008700         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     00870000
008800     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 00880000
008900         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     00890000
009000     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 00900000
009100         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     00910000
009200     05  FILLER                       PIC  X(01).                 00920000
009300     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 00930000
009400         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     00940000
009500         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     00950000
009600*                                                                 00960000
009700 01  PROGRAM-SWITCHES.                                            00970000
009800     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00980000
009900         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00990000
010000     05  PS-END-OF-EXTRACT2-SW       PIC  X(01)    VALUE 'N'.     01000000
010100         88  PS-END-OF-EXTRACT2                    VALUE 'Y'.     01010000
010200     05  PS-ERROR-SW                 PIC  X(01)    VALUE 'N'.     01020000
010300         88  PS-ERROR                              VALUE 'Y'.     01030000
010400     05  PS-STR-WRITTEN-SW           PIC  X(01)    VALUE 'N'.     01040000
010500         88  PS-STR-WRITTEN                        VALUE 'Y'.     01050000
010600         88  PS-STR-NOT-WRITTEN                    VALUE 'N'.     01060000
010700     05  PS-PO-WRITTEN-SW            PIC  X(01)    VALUE 'N'.     01070000
010800         88  PS-PO-WRITTEN                         VALUE 'Y'.     01080000
010900         88  PS-PO-NOT-WRITTEN                     VALUE 'N'.     01090000
011000     05  PS-NEW-LINE-SW              PIC  X(01)    VALUE 'N'.     01100000
011100         88  PS-NEW-LINE                           VALUE 'Y'.     01110000
011200         88  PS-NOT-NEW-LINE                       VALUE 'N'.     01120000
011300     05  PS-NEW-STORE-SW             PIC  X(01)    VALUE 'N'.     01130000
011400         88  PS-NEW-STORE                          VALUE 'Y'.     01140000
011500         88  PS-NOT-NEW-STORE                      VALUE 'N'.     01150000
011600     05  PS-NEW-PO-RECEIVER-SW       PIC  X(01)    VALUE 'N'.     01160000
011700         88  PS-NEW-PO-RECEIVER                    VALUE 'Y'.     01170000
011800         88  PS-NOT-NEW-PO-RECEIVER                VALUE 'N'.     01180000
011900     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     01190000
012000         88  PS-STATUS-FOUND                       VALUE 'Y'.     01200000
012100         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     01210000
012200     05  PS-DETAIL-REC-WRITTEN-SW    PIC  X(01)    VALUE 'N'.     01220000
012300         88  PS-DETAIL-REC-WRITTEN                 VALUE 'Y'.     01230000
012400         88  PS-NO-DETAIL-REC-WRITTEN              VALUE 'N'.     01240000
012500     05  PS-PO-SEQUENCE-CHANGE-SW    PIC  X(01)    VALUE 'N'.     01250000
012600         88  PS-PO-SEQUENCE-SET                    VALUE 'N'.     01260000
012700         88  PS-PO-SEQUENCE-CHANGE                 VALUE 'Y'.     01270000
012800     05  PS-EOF-UID-CURSOR-IND       PIC  X(01)    VALUE 'N'.     01280000
012900         88  PS-EOF-UID-CURSOR                     VALUE 'Y'.     01290000
013000         88  PS-NOT-EOF-UID-CURSOR                 VALUE 'N'.     01300000
013100     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     01310000
013200         88  PS-ERROR-RECORD                       VALUE 'A'.     01320000
013300         88  PS-DETAIL-RECORD                      VALUE 'B'.     01330000
013400*                                                                 01340000
013500 01  PC-CONSTANTS.                                                01350000
013600     05  PC-1                        PIC S9(03)    VALUE +1       01360000
013700                                                   COMP-3.        01370000
013800     05  PC-2                        PIC S9(03)    VALUE +2       01380000
013900                                                   COMP-3.        01390000
014000     05  PC-3                        PIC S9(03)    VALUE +3       01400000
014100                                                   COMP-3.        01410000
014200     05  PC-7                        PIC S9(01)    VALUE +7.      01420000
014300     05  PC-11                       PIC S9(03)    VALUE +11      01430000
014400                                                   COMP-3.        01440000
014500     05  PC-13                       PIC S9(03)    VALUE +13      01450000
014600                                                   COMP-3.        01460000
014700     05  PC-60                       PIC S9(03)    VALUE +60      01470000
014800                                                   COMP-3.        01480000
014900     05  PC-NINE-9-9                 PIC S9(09)    COMP           01490000
015000                                        VALUE +999999999.         01500000
015100     05  PC-NEG-9S                       PIC S9(09)               01510000
015200                                        VALUE -999999999.         01520000
015300     05  PC-NINE-9-18                PIC S9(18)    COMP-3         01530000
015400                                        VALUE +999999999999999999.01540000
015500     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01550000
015600     05  PC-AST                      PIC  X(03)    VALUE '***'.   01560000
015700     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01570000
015800     05  PC-00                       PIC  X(02)    VALUE '00'.    01580000
015900     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01590000
016000     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01600000
016100     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01610000
016200     05  PC-A                        PIC  X(01)    VALUE 'A'.     01620000
016300     05  PC-B                        PIC  X(01)    VALUE 'B'.     01630000
016400     05  PC-N                        PIC  X(01)    VALUE 'N'.     01640000
016500     05  PC-I                        PIC  X(01)    VALUE 'I'.     01650000
016600     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   01660000
016700     05  PC-SUKRP007                 PIC  X(08)    VALUE          01670000
016800         'SUKRP007'.                                              01680000
016900     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01690000
017000     05  PC-MISDIRECTS               PIC  X(20)    VALUE          01700000
017100         'MISDIRECT'.                                             01710000
017200     05  PC-FREE-ASTRAY.                                          01720000
017300         10  FILLER                  PIC  X(16)    VALUE          01730000
017400         'FREE ASTRAY FOR '.                                      01740000
017500         10  FREE-ASTRAY-REC-SEQ     PIC  9(03).                  01750000
017600     05  PC-DUPLICATES               PIC  X(20)    VALUE          01760000
017700         'DUPLICATES '.                                           01770000
017800     05  PC-NOT-FOUND                PIC  X(20)    VALUE          01780000
017900         'NOT FOUNDS '.                                           01790000
018000     05  PC-NOT-SCANNED              PIC  X(20)    VALUE          01800000
018100         'NOT SCANNED'.                                           01810000
018200     05  PC-COMPANY-MISDIRECT        PIC  X(11)    VALUE          01820000
018300         'COMP MSDRCT'.                                           01830000
018400*                                                                 01840000
018500 01  DN-DB2-NULL-INDICATORS.                                      01850000
018600     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01860000
018700*                                                                 01870000
018800 01  PV-MISC-FIELDS.                                              01880000
018900     05  PV-DISPLAY-FIELD            PIC  9(10)    VALUE ZERO.    01890000
019000     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     01900000
019100                                                   COMP-3.        01910000
019200     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01920000
019300                                                   COMP-3.        01930000
019400     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01940000
019500                                                   COMP-3.        01950000
019600     05  PV-RECORD-COUNT             PIC S9(04)    VALUE ZERO     01960000
019700                                                   COMP SYNC.     01970000
019800     05  PV-DB2-COUNT                PIC S9(04)    VALUE ZERO     01980000
019900                                                   COMP SYNC.     01990000
020000     05  PV-DB2-COUNT2               PIC S9(04)    VALUE ZERO     02000000
020100                                                   COMP SYNC.     02010000
020200     05  PV-DIFFERENCE               PIC S9(04)    VALUE ZERO     02020000
020300                                                   COMP SYNC.     02030000
020400     05  PV-DOWNLOAD-CNT             PIC S9(04)    VALUE ZERO     02040000
020500                                                   COMP SYNC.     02050000
020600     05  PV-STATUS                   PIC  X(02).                  02060000
020700     05  PV-CURSOR-IND               PIC  X(01).                  02070000
020800     05  PV-TRIP-ID                  PIC  9(09)    VALUE ZERO.    02080000
020900     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     02090000
021000                                                   COMP SYNC.     02100000
021100     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  02110000
021200     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    02120000
021300******************************************************************02130000
021400*  REMOVED GROUP VARIABLE PV-SKU.                     WR # 21361 *02140000
021500******************************************************************02150000
022200******************************************************************02220000
022300*  CHANGES MADE FOR WR # 21361 ENDS HERE.                        *02230014
022400******************************************************************02240000
022500     05  PV-SHIPT-UNT-ID             PIC S9(18)    VALUE ZERO     02250000
022600                                                   COMP-3.        02260000
022700     05  PV-STORE-NBR-CHAR           PIC  X(03)    VALUE SPACES.  02270000
022800     05  PV-TODAYS-DATE.                                          02280000
022900         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    02290000
023000         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    02300000
023100         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    02310000
023200     05  PV-TODAYS-TIME.                                          02320000
023300         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    02330000
023400         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    02340000
023500         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    02350000
023600         10  FILLER                  PIC  9(02)    VALUE ZERO.    02360000
023700     05  PV-DB2-DATE.                                             02370000
023800         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    02380000
023900         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    02390000
024000         10  FILLER                  PIC  X(01)    VALUE ZERO.    02400000
024100         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02410000
024200         10  FILLER                  PIC  X(01)    VALUE ZERO.    02420000
024300         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02430000
024400     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 02440000
024500     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    02450000
024600         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 02460000
024700         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 02470000
024800         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 02480000
024900         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 02490000
025000     05  PV-OUT-SERIAL-SHIP-CODE.                                 02500000
025100         10  FILLER                   PIC  X(05)  VALUE '(00) '.  02510000
025200         10  PV-OUT-S-S-C-1           PIC  X(01).                 02520000
025300         10  FILLER                   PIC  X(01)  VALUE SPACES.   02530000
025400         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 02540000
025500         10  FILLER                   PIC  X(01)  VALUE SPACES.   02550000
025600         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02560000
025700         10  FILLER                   PIC  X(01)  VALUE SPACES.   02570000
025800         10  PV-OUT-S-S-C-18          PIC  X(01).                 02580000
025900     05  PV-HOLD-UID                  PIC  X(07)  VALUE SPACES.   02590000
026000     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)  VALUE SPACE.    02600000
026100                                                                  02610000
026200     05  PV-SHPD-QTY                  PIC S9(09)  VALUE ZERO.     02620000
026300     05  PV-SAVE-SHPD-QTY             PIC S9(09)  VALUE ZERO.     02630000
026400     05  PV-STR-NBR                   PIC  9(04)  VALUE ZERO.     02640000
026500     05  PV-SAVE-STR-NBR              PIC  9(04)  VALUE ZERO.     02650000
026600     05  PV-LINE-NBR                  PIC  9(09)  VALUE ZERO.     02660000
026700     05  PV-SAVE-LINE-NBR             PIC  9(09)  VALUE ZERO.     02670000
026800     05  PV-SAVE-PO                   PIC S9(09)  VALUE ZERO.     02680000
026900     05  PV-SAVE-RECEIVER             PIC  9(03)  VALUE ZERO.     02690000
027000     05  PV-PO-RECEIVER.                                          02700000
      *CLP 09/30/14                                                     02701015
027100         10  PV-PO-NBR                PIC  9(08)  VALUE ZERO.     02710015
027200         10  FILLER                   PIC  X(01)  VALUE '-'.      02720000
027300         10  PV-RECEIVER              PIC  9(03)  VALUE ZERO.     02730000
027400         10  PV-RECEIVER-X REDEFINES PV-RECEIVER                  02740000
027500                                      PIC  X(03).                 02750000
027600     05  PV-SAVE-PO-RECEIVER          PIC  X(14)  VALUE SPACES.   02760000
027700                                                                  02770000
027800 01  PV-TOTAL-FIELDS.                                             02780000
027900     05  PV-STORE-UNIT-TOT            PIC S9(09)  VALUE ZERO.     02790000
028000     05  PV-PO-RECEIVER-UNIT-TOT      PIC S9(09)  VALUE ZERO.     02800000
028100*                                                                 02810000
028200 01  PV-EXCEPTION-FIELDS.                                         02820000
028300     05  PV-SCANNED-COUNT             PIC S9(04)  COMP SYNC.      02830000
028400     05  PV-SCANNED-IND               PIC  X(01).                 02840000
028500     05  PV-DUP-SCAN-IND              PIC  X(01).                 02850000
028600     05  PV-NEVER-SCANNED-IND         PIC  X(01).                 02860000
028700     05  PV-MISDIRECT-IND             PIC  X(01).                 02870000
028800     05  PV-NOT-FOUND-IND             PIC  X(01).                 02880000
028900     05  PV-FREE-ASTRAY-IND           PIC  X(01).                 02890000
029000     05  PV-ANOTHER-TRAILER-IND       PIC  X(01).                 02900000
029100                                                                  02910000
029200     COPY DPWS024.                                                02920015
029300                                                                  02930000
029400     COPY SURD009.                                                02940015
029500                                                                  02950000
029600     COPY SURD001.                                                02960015
029700                                                                  02970000
029800***************************************************************   02980000
029900* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                 *   02990000
030000***************************************************************   03000000
030100     COPY DSWS004.                                                03010015
030200                                                                  03020000
030300 EJECT                                                            03030000
030400*                                                                 03040000
030500******************************************************************03050000
030600*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               03060000
030700******************************************************************03070000
030800     COPY DPWS132O.                                               03080015
030900*                                                                 03090000
031000*                                                                 03100000
031100 01  HEADING-LINES.                                               03110000
031200     05  HEADING-LINE-1.                                          03120000
031300         10  FILLER                  PIC  X(05)    VALUE SPACES.  03130000
031400         10  FILLER                  PIC  X(40)    VALUE          03140000
031500             '****************************************'.          03150000
031600         10  FILLER                  PIC  X(04)    VALUE SPACES.  03160000
031700         10  FILLER                  PIC  X(33)    VALUE          03170000
031800             'UCC-128 PO/STORE UNIT ADJUSTMENTS'.                 03180000
031900         10  FILLER                  PIC  X(50)    VALUE SPACES.  03190000
032000*                                                                 03200000
032100     05  HEADING-LINE-1A.                                         03210000
032200         10  FILLER                  PIC  X(05)    VALUE SPACES.  03220000
032300         10  FILLER                  PIC  X(03)    VALUE '*  '.   03230000
032400         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  03240000
032500         10  FILLER                  PIC  X(01)    VALUE '*'.     03250000
032600         10  FILLER                  PIC  X(87)    VALUE SPACES.  03260000
032700*                                                                 03270000
032800     05  HEADING-LINE-1B.                                         03280000
032900         10  FILLER                  PIC  X(05)    VALUE SPACES.  03290000
033000         10  FILLER                  PIC  X(40)    VALUE          03300000
033100             '****************************************'.          03310000
033200         10  FILLER                  PIC  X(87)    VALUE SPACES.  03320000
033300*                                                                 03330000
033400     05  HEADING-LINE-2.                                          03340000
033500         10  FILLER                  PIC  X(03)    VALUE SPACE.   03350000
033600         10  FILLER                  PIC  X(09)    VALUE          03360000
033700             'CARRIER: '.                                         03370000
033800         10  HL2-SCAC                PIC  X(04)    VALUE SPACES.  03380000
033900         10  FILLER                  PIC  X(03)    VALUE SPACE.   03390000
034000         10  FILLER                  PIC  X(09)    VALUE          03400000
034100             'TRAILER: '.                                         03410000
034200         10  HL2-TRAILER             PIC  X(10)    VALUE SPACES.  03420000
034300         10  FILLER                  PIC  X(04)    VALUE SPACE.   03430000
034400         10  FILLER                  PIC  X(09)    VALUE          03440000
034500             'TRIP ID: '.                                         03450000
034600         10  HL2-TRIP-ID             PIC  X(11)    VALUE SPACES.  03460000
034700         10  FILLER                  PIC  X(14)    VALUE SPACE.   03470000
034800         10  FILLER                  PIC  X(16)    VALUE          03480000
034900             'TRAILER STATUS: '.                                  03490000
035000         10  HL2-TRAILER-STAT        PIC  X(02)    VALUE SPACES.  03500000
035100         10  FILLER                  PIC  X(38)    VALUE SPACES.  03510000
035200*                                                                 03520000
035300     05  HEADING-LINE-3.                                          03530000
035400         10  FILLER                  PIC  X(03)    VALUE SPACES.  03540000
035500         10  FILLER                  PIC  X(16)    VALUE          03550000
035600             'ARRIVAL DATE:   '.                                  03560000
035700         10  HL3-ARRIVAL-DATE.                                    03570000
035800             15  HL3-ARRIVAL-DATE-MM                              03580000
035900                                     PIC  X(02)    VALUE SPACES.  03590000
036000             15  FILLER              PIC  X(01)    VALUE '/'.     03600000
036100             15  HL3-ARRIVAL-DATE-DD                              03610000
036200                                     PIC  X(02)    VALUE SPACES.  03620000
036300             15  FILLER              PIC  X(01)    VALUE '/'.     03630000
036400             15  HL3-ARRIVAL-DATE-CC                              03640000
036500                                     PIC  X(02)    VALUE SPACES.  03650000
036600             15  HL3-ARRIVAL-DATE-YY                              03660000
036700                                     PIC  X(02)    VALUE SPACES.  03670000
036800         10  FILLER                  PIC  X(11)    VALUE SPACES.  03680000
036900         10  FILLER                  PIC  X(23)    VALUE          03690000
037000             'BEGIN UNLOADING DATE:  '.                           03700000
037100         10  HL3-BEG-UNLOAD-DATE.                                 03710000
037200             15  HL3-BEG-UNLOAD-DATE-MM                           03720000
037300                                     PIC  X(02)    VALUE SPACES.  03730000
037400             15  FILLER              PIC  X(01)    VALUE '/'.     03740000
037500             15  HL3-BEG-UNLOAD-DATE-DD                           03750000
037600                                     PIC  X(02)    VALUE SPACES.  03760000
037700             15  FILLER              PIC  X(01)    VALUE '/'.     03770000
037800             15  HL3-BEG-UNLOAD-DATE-CC                           03780000
037900                                     PIC  X(02)    VALUE SPACES.  03790000
038000             15  HL3-BEG-UNLOAD-DATE-YY                           03800000
038100                                     PIC  X(02)    VALUE SPACES.  03810000
038200         10  FILLER                  PIC  X(03)    VALUE SPACES.  03820000
038300         10  FILLER                  PIC  X(15)    VALUE          03830000
038400             'UNLOADED DATE: '.                                   03840000
038500         10  HL3-UNLOADED-DATE.                                   03850000
038600             15  HL3-UNLOADED-DATE-MM                             03860000
038700                                     PIC  X(02)    VALUE SPACES.  03870000
038800             15  FILLER              PIC  X(01)    VALUE '/'.     03880000
038900             15  HL3-UNLOADED-DATE-DD                             03890000
039000                                     PIC  X(02)    VALUE SPACES.  03900000
039100             15  FILLER              PIC  X(01)    VALUE '/'.     03910000
039200             15  HL3-UNLOADED-DATE-CC                             03920000
039300                                     PIC  X(02)    VALUE SPACES.  03930000
039400             15  HL3-UNLOADED-DATE-YY                             03940000
039500                                     PIC  X(02)    VALUE SPACES.  03950000
039600         10  FILLER                  PIC  X(31)    VALUE SPACES.  03960000
039700*                                                                 03970000
039800     05  HEADING-LINE-3B.                                         03980000
039900          10  FILLER                 PIC  X(03)  VALUE SPACE.     03990000
040000          10  FILLER                 PIC  X(22)  VALUE            04000000
040100              'RECEIVING ASSOCIATES: '.                           04010000
040200          10  HL3B-USERID-TABLE.                                  04020000
040300              15 FILLER  OCCURS 12 TIMES                          04030000
040400                         INDEXED BY HL3B-UID-IDX.                 04040000
040500                 20 HL3B-USER-ID     PIC  X(07) VALUE SPACE.      04050000
040600                 20 HL3B-COMMA       PIC  X(01) VALUE SPACE.      04060000
040700                 20 FILLER           PIC  X(01) VALUE SPACE.      04070000
040800*                                                                 04080000
040900     05  HEADING-LINE-4.                                          04090000
041000         10  FILLER                  PIC  X(18)    VALUE SPACES.  04100000
041100         10  FILLER                  PIC  X(05)    VALUE          04110000
041200             'STORE'.                                             04120000
041300         10  FILLER                  PIC  X(12)    VALUE SPACES.  04130000
041400         10  FILLER                  PIC  X(04)    VALUE          04140000
041500             'LINE'.                                              04150000
041600         10  FILLER                  PIC  X(08)    VALUE SPACES.  04160000
041700         10  FILLER                  PIC  X(05)    VALUE          04170000
041800             'UNITS'.                                             04180000
041900         10  FILLER                  PIC  X(59)    VALUE SPACES.  04190000
042000*                                                                 04200000
042100     05  HEADING-LINE-5.                                          04210000
042200         10  FILLER                  PIC  X(03)    VALUE SPACES.  04220000
042300         10  FILLER                  PIC  X(11)    VALUE          04230000
042400             'PO/RECEIVER'.                                       04240000
042500         10  FILLER                  PIC  X(05)    VALUE SPACES.  04250000
042600         10  FILLER                  PIC  X(03)    VALUE          04260000
042700             'NBR'.                                               04270000
042800         10  FILLER                  PIC  X(13)    VALUE SPACES.  04280000
042900         10  FILLER                  PIC  X(03)    VALUE          04290000
043000             'NBR'.                                               04300000
043100         10  FILLER                  PIC  X(09)    VALUE SPACES.  04310000
043200         10  FILLER                  PIC  X(06)    VALUE          04320000
043300             'ADJUST'.                                            04330000
043400         10  FILLER                  PIC  X(06)    VALUE SPACES.  04340000
043500         10  FILLER                  PIC  X(14)    VALUE          04350000
043600             'EXCEPTION TYPE'.                                    04360000
043700         10  FILLER                  PIC  X(70)    VALUE SPACES.  04370000
043800*                                                                 04380000
043900 01  MISCELLANEOUS-LINES.                                         04390000
044000     05  END-OF-REPORT-LINE.                                      04400000
044100         10  FILLER                  PIC  X(44)    VALUE SPACES.  04410000
044200         10  FILLER                  PIC  X(45)    VALUE          04420000
044300             '*******   E N D   O F   R E P O R T   *******'.     04430000
044400         10  FILLER                  PIC  X(43)    VALUE SPACES.  04440000
044500*                                                                 04450000
044600     05  EMPTY-FILE-LINE.                                         04460000
044700         10  FILLER                  PIC  X(44)    VALUE SPACES.  04470000
044800         10  FILLER                  PIC  X(45)    VALUE          04480000
044900             '**** NO PO/STORE UNIT ADJUSTMENTS FOUND *****'.     04490000
045000         10  FILLER                  PIC  X(43)    VALUE SPACES.  04500000
045100*                                                                 04510000
045200 01  DETAIL-LINES.                                                04520000
045300     05  DETAIL-LINE1.                                            04530000
045400         10  FILLER               PIC  X(03)    VALUE SPACES.     04540000
      *CLP 09/30/14                                                     04541015
045500         10  DL1-PO-RECEIVER      PIC  X(12)    VALUE SPACES.     04550015
045600         10  FILLER               PIC  X(04)    VALUE SPACES.     04560015
045700         10  DL1-STR-NBR          PIC  X(04)    VALUE SPACES.     04570000
045800         10  FILLER               PIC  X(07)    VALUE SPACES.     04580000
045900         10  DL1-LINE-NBR         PIC  ZZZ,ZZ9  VALUE SPACES.     04590000
046000         10  FILLER               PIC  X(01)    VALUE SPACES.     04600000
046100         10  DL1-PREPK-IND        PIC  X(05)    VALUE SPACES.     04610000
046200         10  FILLER               PIC  X(01)    VALUE SPACES.     04620000
046300         10  DL1-UNITS-ADJUST     PIC  -,---,--9  VALUE ZERO.     04630000
046400         10  FILLER               PIC  X(06)    VALUE SPACES.     04640000
046500         10  DL1-EXCEPTION-TYPE   PIC  X(30)    VALUE SPACES.     04650000
046600         10  FILLER               PIC  X(60)    VALUE SPACES.     04660000
046700*                                                                 04670000
046800 01  TOTAL-LINES.                                                 04680000
046900     05  TOTAL-LINE1.                                             04690000
047000         10  FILLER                  PIC  X(08)    VALUE SPACES.  04700000
047100         10  FILLER                  PIC  X(06)    VALUE          04710000
047200             'STORE '.                                            04720000
047300         10  TL1-STR-NBR             PIC  9(04)    VALUE ZEROS.   04730000
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  04740000
047500         10  FILLER                  PIC  X(12)    VALUE          04750000
047600             'TOTAL UNITS '.                                      04760000
047700         10  FILLER                  PIC  X(12)    VALUE SPACES.  04770000
047800         10  TL1-UNITS-CNT          PIC  -,---,--9 VALUE ZEROS.   04780000
047900         10  FILLER                  PIC  X(80)    VALUE SPACES.  04790000
048000                                                                  04800000
048100     05  TOTAL-LINE3.                                             04810000
048200         10  FILLER                  PIC  X(08)    VALUE SPACES.  04820000
048300         10  FILLER                  PIC  X(24)    VALUE          04830000
048400             'PO/RECEIVER TOTAL UNITS '.                          04840000
048500         10  FILLER                  PIC  X(12)    VALUE SPACES.  04850000
048600         10  TL3-UNITS-CNT           PIC  -,---,--9  VALUE ZERO.  04860000
048700         10  FILLER                  PIC  X(60)    VALUE SPACES.  04870000
048800                                                                  04880000
048900 01  EL1-ERROR-LINE-1F.                                           04890000
049000     05  FILLER                      PIC  X(02)     VALUE SPACES. 04900000
049100     05  FILLER                      PIC  X(48)     VALUE         04910000
049200         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04920000
049300     05  FILLER                      PIC  X(49)     VALUE         04930000
049400         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     04940000
049500     05  FILLER                      PIC  X(33)     VALUE         04950000
049600         ' COMPLETED.                      '.                     04960000
049700                                                                  04970000
049800 01  EL1-ERROR-LINE-1P.                                           04980000
049900     05  FILLER                      PIC  X(02)     VALUE SPACES. 04990000
050000     05  FILLER                      PIC  X(48)     VALUE         05000000
050100         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05010000
050200     05  FILLER                      PIC  X(49)     VALUE         05020000
050300         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     05030000
050400     05  FILLER                      PIC  X(33)     VALUE         05040000
050500         'COMPLETED.                       '.                     05050000
050600                                                                  05060000
050700 01  EL2-ERROR-LINE-2F.                                           05070000
050800     05  FILLER                      PIC  X(02)     VALUE SPACES. 05080000
050900     05  FILLER                      PIC  X(36)     VALUE         05090000
051000         'NONE OF YOUR REPORTS WERE CREATED.  '.                  05100000
051100     05  FILLER                      PIC  X(36)     VALUE         05110000
051200         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  05120000
051300     05  FILLER                      PIC  X(58)     VALUE SPACES. 05130000
051400                                                                  05140000
051500 01  EL2-ERROR-LINE-2P.                                           05150000
051600     05  FILLER                      PIC  X(02)     VALUE SPACES. 05160000
051700     05  FILLER                      PIC  X(49)     VALUE         05170000
051800         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     05180000
051900     05  FILLER                      PIC  X(41)     VALUE         05190000
052000         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             05200000
052100     05  FILLER                      PIC  X(40)     VALUE         05210000
052200         'DETERMINE IF THEY NEED TO BE CREATED).  '.              05220000
052300                                                                  05230000
052400 01  EL3-ERROR-LINE-3.                                            05240000
052500     05  FILLER                      PIC  X(02)     VALUE SPACES. 05250000
052600     05  FILLER                      PIC  X(50)     VALUE         05260000
052700         'YOUR REQUEST WAS AS FOLLOWS:                      '.    05270000
052800     05  FILLER                      PIC  X(81)     VALUE SPACES. 05280000
052900                                                                  05290000
053000 01  EL4-ERROR-LINE-4.                                            05300000
053100     05  FILLER                      PIC  X(07)     VALUE SPACES. 05310000
053200     05  FILLER                      PIC  X(12)     VALUE         05320000
053300         'REQUESTOR:  '.                                          05330000
053400     05  EL4-REQUESTOR-ID            PIC  X(08)     VALUE SPACES. 05340000
053500     05  FILLER                      PIC  X(10)     VALUE SPACES. 05350000
053600     05  FILLER                      PIC  X(22)     VALUE         05360000
053700         'PRINTER DESTINATION:  '.                                05370000
053800     05  EL4-PRINTER-ID              PIC  X(08)     VALUE SPACES. 05380000
053900     05  FILLER                      PIC  X(65)     VALUE SPACES. 05390000
054000                                                                  05400000
054100                                                                  05410000
054200 01  EL5-ERROR-LINE-5.                                            05420000
054300     05  FILLER                      PIC  X(07)     VALUE SPACES. 05430000
054400     05  FILLER                      PIC  X(04)     VALUE SPACES. 05440000
054500     05  FILLER                      PIC  X(08)     VALUE         05450000
054600         'STATS   '.                                              05460000
054700     05  FILLER                      PIC  X(18)     VALUE         05470000
054800         'PO/STR UNT ADJ    '.                                    05480000
054900     05  FILLER                      PIC  X(17)     VALUE         05490000
055000         'CRTNS NOT RCVD   '.                                     05500000
055100     05  FILLER                      PIC  X(14)     VALUE         05510000
055200         'FREE ASTRAY   '.                                        05520000
055300     05  FILLER                      PIC  X(12)     VALUE         05530000
055400         'MISDIRECT   '.                                          05540000
055500     05  FILLER                      PIC  X(17)     VALUE         05550000
055600         'DUPLICATE SCAN   '.                                     05560000
055700     05  FILLER                      PIC  X(18)     VALUE         05570000
055800         'SCAN NOT FOUND    '.                                    05580000
055900     05  FILLER                      PIC  X(17)     VALUE         05590000
056000         'UNUSED LABELS    '.                                     05600000
056100                                                                  05610000
056200 01  EL6-ERROR-LINE-6.                                            05620000
056300     05  FILLER                      PIC  X(13)     VALUE SPACES. 05630000
056400     05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 05640000
056500     05  FILLER                      PIC  X(12)     VALUE SPACES. 05650000
056600     05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 05660000
056700     05  FILLER                      PIC  X(16)     VALUE SPACES. 05670000
056800     05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 05680000
056900     05  FILLER                      PIC  X(15)     VALUE SPACES. 05690000
057000     05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 05700000
057100     05  FILLER                      PIC  X(12)     VALUE SPACES. 05710000
057200     05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 05720000
057300     05  FILLER                      PIC  X(13)     VALUE SPACES. 05730000
057400     05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 05740000
057500     05  FILLER                      PIC  X(16)     VALUE SPACES. 05750000
057600     05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 05760000
057700     05  FILLER                      PIC  X(17)     VALUE SPACES. 05770000
057800     05  EL6-SUKRP023-IND            PIC  X(01)     VALUE SPACES. 05780000
057900     05  FILLER                      PIC  X(10)     VALUE SPACES. 05790000
058000                                                                  05800000
058100                                                                  05810000
058200***************************************************************** 05820000
058300*  COPY BOOK FOR SHIPMENT TABLE                                   05830000
058400***************************************************************** 05840000
058500     EXEC SQL                                                     05850000
058600          INCLUDE TSHIPMT                                         05860000
058700     END-EXEC.                                                    05870000
058800                                                                  05880000
058900***************************************************************** 05890000
059000*  COPY BOOK FOR SHIPMENT PO TABLE                                05900000
059100***************************************************************** 05910000
059200     EXEC SQL                                                     05920000
059300          INCLUDE TSHPTPO                                         05930000
059400     END-EXEC.                                                    05940000
059500                                                                  05950000
059600***************************************************************** 05960000
059700*  COPY BOOK FOR PURCHASE ORDER TABLE                             05970000
059800***************************************************************** 05980000
059900     EXEC SQL                                                     05990000
060000          INCLUDE TPURCHS                                         06000000
060100     END-EXEC.                                                    06010000
060200                                                                  06020000
060300***************************************************************** 06030000
060400*  COPY BOOK FOR EXTERNAL ENTITY TABLE                            06040000
060500***************************************************************** 06050000
060600     EXEC SQL                                                     06060000
060700          INCLUDE TEXTENT                                         06070000
060800     END-EXEC.                                                    06080000
060900                                                                  06090000
061000***************************************************************** 06100000
061100*  COPY BOOK FOR EXTERNAL ENTITY NAME TABLE                       06110000
061200***************************************************************** 06120000
061300     EXEC SQL                                                     06130000
061400          INCLUDE TENTNME                                         06140000
061500     END-EXEC.                                                    06150000
061600                                                                  06160000
061700***************************************************************** 06170000
061800*  COPY BOOK FOR THE TROUBLE REASON TABLE                         06180000
061900***************************************************************** 06190000
062000     EXEC SQL                                                     06200000
062100          INCLUDE TTRBRSN                                         06210000
062200     END-EXEC.                                                    06220000
062300                                                                  06230000
062400***************************************************************** 06240000
062500*  COPY BOOK FOR THE TROUBLE NOTIFICATION TABLE                   06250000
062600***************************************************************** 06260000
062700     EXEC SQL                                                     06270000
062800          INCLUDE TTRBNTF                                         06280000
062900     END-EXEC.                                                    06290000
063000                                                                  06300000
063100***************************************************************** 06310000
063200*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    06320000
063300***************************************************************** 06330000
063400     EXEC SQL                                                     06340000
063500          INCLUDE TSHUUPC                                         06350000
063600     END-EXEC.                                                    06360000
063700                                                                  06370000
063800***************************************************************** 06380000
063900*  COPY BOOK FOR PACKSLIP TABLE                                   06390000
064000***************************************************************** 06400000
064100     EXEC SQL                                                     06410000
064200          INCLUDE TPKSLIP                                         06420000
064300     END-EXEC.                                                    06430000
064400                                                                  06440000
064500***************************************************************** 06450000
064600*  COPY BOOK FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT ASSOC T06460000
064700***************************************************************** 06470000
064800     EXEC SQL                                                     06480000
064900          INCLUDE TINPKSU                                         06490000
065000     END-EXEC.                                                    06500000
065100                                                                  06510000
065200***************************************************************** 06520000
065300*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           06530000
065400***************************************************************** 06540000
065500     EXEC SQL                                                     06550000
065600          INCLUDE TSHUNLO                                         06560000
065700     END-EXEC.                                                    06570000
065800                                                                  06580000
065900***************************************************************** 06590000
066000*  COPY BOOK FOR SHIPMENT UNIT TABLE                              06600000
066100***************************************************************** 06610000
066200     EXEC SQL                                                     06620000
066300          INCLUDE TSHPUNT                                         06630000
066400     END-EXEC.                                                    06640000
066500                                                                  06650000
066600******************************************************************06660000
066700*  REMOVED REFERENCES OF DB2 TABLE TSK                WR # 21361 *06670000
066800******************************************************************06680000
067500******************************************************************06750000
067600*  REMOVED REFERENCES OF DB2 TABLE TUPCSKU            WR # 21361 *06760000
067700******************************************************************06770000
068500******************************************************************06850000
068600*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *06860014
068700******************************************************************06870000
068800***************************************************************** 06880000
068900*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           06890000
069000***************************************************************** 06900000
069100     EXEC SQL                                                     06910000
069200          INCLUDE TVHTRIP                                         06920000
069300     END-EXEC.                                                    06930000
069400                                                                  06940000
069500***************************************************************** 06950000
069600*  COPY BOOK FOR THE VEHICLE TABLE                                06960000
069700***************************************************************** 06970000
069800     EXEC SQL                                                     06980000
069900          INCLUDE TVEHICL                                         06990000
070000     END-EXEC.                                                    07000000
070100                                                                  07010000
070200***************************************************************** 07020000
070300*  COPY BOOK FOR TRIP STATUS TABLE                                07030000
070400***************************************************************** 07040000
070500     EXEC SQL                                                     07050000
070600          INCLUDE TTRIPST                                         07060000
070700     END-EXEC.                                                    07070000
070800                                                                  07080000
070900***************************************************************** 07090000
071000*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           07100000
071100***************************************************************** 07110000
071200     EXEC SQL                                                     07120000
071300          INCLUDE TTRSTYP                                         07130000
071400     END-EXEC.                                                    07140000
071500                                                                  07150000
071600***************************************************************** 07160000
071700*  COPY BOOK FOR THE RECEIVER TABLE                               07170000
071800***************************************************************** 07180000
071900     EXEC SQL                                                     07190000
072000          INCLUDE TRECEIV                                         07200000
072100     END-EXEC.                                                    07210000
072200                                                                  07220000
072300***************************************************************** 07230000
072400*  DB2 COMMUNICATION AREA                                         07240000
072500***************************************************************** 07250000
072600     EXEC SQL                                                     07260000
072700         INCLUDE SQLCA                                            07270000
072800     END-EXEC.                                                    07280000
072900                                                                  07290000
073000***************************************************************** 07300000
073100*  DB2 COMMUNICATION AREA2                                        07310000
073200***************************************************************** 07320000
073300     COPY SQLCA2.                                                 07330015
073400                                                                  07340000
073500                                                                  07350000
073600***************************************************************** 07360000
073700*  TRAILER-CSR                                                    07370000
073800***************************************************************** 07380000
073900     EXEC SQL                                                     07390000
074000       DECLARE TRAILER-CSR CURSOR FOR                             07400000
074100         SELECT DISTINCT                                          07410000
074200                'B'                                               07420000
074300              , C.PO_NBR                                          07430000
074400              , C.REC_SEQ_NBR                                     07440000
074500              , 0                                                 07450000
074600          FROM  TVHTRIP A                                         07460000
074700              , TSHIPMT B                                         07470000
074800              , TSHPTPO C                                         07480000
074900              , TRECEIV D                                         07490000
075000          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             07500000
075100            AND A.TRIP_ID           = B.TRIP_ID                   07510000
075200            AND C.SHIPT_ID          = B.SHIPT_ID                  07520000
075300            AND C.PO_NBR          = D.ORD_NBR                     07530000
075400            AND C.REC_SEQ_NBR     = D.REC_SEQ_NBR                 07540000
075500            AND D.VER_STATUS_CDE  = 'A'                           07550000
075600       UNION                                                      07560000
075700         SELECT DISTINCT                                          07570000
075800                'C'                                               07580000
075900              , B.PO_NBR                                          07590000
076000              , 0                                                 07600000
076100              , B.SEQ_NBR                                         07610000
076200          FROM  TSHUNLO A                                         07620000
076300              , TINPKSU B                                         07630000
076400          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             07640000
076500            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              07650000
076600            AND A.SCN_LOC_ID        = 'RECV'                      07660000
076700            AND A.ACTV_CDE          = 'A'                         07670000
076800            AND A.SHIPT_UNT_ID NOT IN                             07680000
076900             (SELECT E.SHIPT_UNT_ID                               07690000
077000              FROM  TVHTRIP A                                     07700000
077100                  , TSHIPMT B                                     07710000
077200                  , TSHPTPO C                                     07720000
077300                  , TPKSLIP D                                     07730000
077400                  , TINPKSU E                                     07740000
077500              WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID         07750000
077600                AND A.TRIP_ID           = B.TRIP_ID               07760000
077700                AND B.SHIPT_ID          = C.SHIPT_ID              07770000
077800                AND C.PO_NBR            = D.PO_NBR                07780000
077900                AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR           07790000
078000                AND D.PO_NBR            = E.PO_NBR                07800000
078100                AND D.SEQ_NBR           = E.SEQ_NBR)              07810000
078200       UNION                                                      07820000
078300         SELECT DISTINCT                                          07830000
078400                'A'                                               07840000
078500              , B.TRN_NBR                                         07850000
078600              , 0                                                 07860000
078700              , 0                                                 07870000
078800          FROM  TSHUNLO A                                         07880000
078900              , TSHUUPC B                                         07890000
079000          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             07900000
079100            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              07910000
079200            AND A.SCN_LOC_ID        = 'RECV'                      07920000
079300            AND A.ACTV_CDE          = 'A'                         07930000
079400            AND NOT EXISTS                                        07940000
079500             (SELECT C.SHIPT_UNT_ID                               07950000
079600              FROM TINPKSU C                                      07960000
079700              WHERE A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID)             07970000
079800       ORDER BY 2, 1                                              07980000
079900     END-EXEC.                                                    07990000
080000                                                                  08000000
080100***************************************************************** 08010000
080200*  ADDED UID_CURSOR 3/31/98  DENISE HAHN                          08020000
080300***************************************************************** 08030000
080400*  RECEIVING ASSOCIATE USERID CURSOR -- THIS CURSOR WILL RETRIEVE 08040000
080500*  THE USERIDS OF ALL THE ASSOCIATES THAT CHECKED-IN THIS TRAILER 08050000
080600***************************************************************** 08060000
080700     EXEC SQL                                                     08070000
080800         DECLARE UID_CURSOR CURSOR FOR                            08080000
080900             SELECT                                               08090000
081000                    DISTINCT A.CRE_USR_ID                         08100000
081100             FROM                                                 08110000
081200                    TSHUNLO A                                     08120000
081300             WHERE                                                08130000
081400                 A.TRIP_ID = :SU009-MANIFEST-NBR                  08140000
081500                 AND A.SCN_LOC_ID        = 'RECV'                 08150000
081600                 AND A.ACTV_CDE          = 'A'                    08160000
081700         ORDER BY 1                                               08170000
081800     END-EXEC.                                                    08180000
081900                                                                  08190000
082000*                                                                 08200000
082100 PROCEDURE DIVISION.                                              08210000
082200*                                                                 08220000
082300 0000-MAINLINE-PROCESSING.                                        08230000
082400******************************************************************08240000
082500*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 08250000
082600* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * 08260000
082700* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM    * 08270000
082800* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                    * 08280000
082900******************************************************************08290000
083000     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           08300000
083100     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   08310000
083200                                                                  08320000
083300     IF CC-PRINT-SUKRP007                                         08330000
083400         PERFORM 0100-INITIALIZATION                              08340000
083500             IF PS-ERROR                                          08350000
083600                IF CC-PRINT-SUKRP002                              08360000
083700                   OR CC-PRINT-SUKRP003                           08370000
083800                   OR CC-PRINT-SUKRP004                           08380000
083900                   OR CC-PRINT-SUKRP005                           08390000
084000                   OR CC-PRINT-SUKRP006                           08400000
084100                     CONTINUE                                     08410000
084200                ELSE                                              08420000
084300                    PERFORM 7000-WRITE-ERROR-REPORT               08430000
084400                END-IF                                            08440000
084500             ELSE                                                 08450000
084600                IF SU009-DETAIL-RECORD                            08460000
084700                    PERFORM 1000-PROCESS-EXTRACT-FILE             08470000
084800                ELSE                                              08480000
084900                    PERFORM 7100-WRITE-EMPTYFILE-REPORT           08490000
085000                END-IF                                            08500000
085100            END-IF.                                               08510000
085200                                                                  08520000
085300     IF CC-PRINT-SUKRP007                                         08530000
085400         CLOSE EXTRACT-FILE                                       08540000
085500               EXTRACT-FILE2                                      08550000
085600               UNIT-ADJUSTMENT-FILE                               08560000
085700     END-IF.                                                      08570000
085800                                                                  08580000
085900     GOBACK.                                                      08590000
086000*                                                                 08600000
086100*                                                                 08610000
086200 0100-INITIALIZATION.                                             08620000
086300******************************************************************08630000
086400**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               08640000
086500******************************************************************08650000
086600     ACCEPT PV-TODAYS-DATE                                        08660000
086700       FROM DATE.                                                 08670000
086800                                                                  08680000
086900     ACCEPT PV-TODAYS-TIME                                        08690000
087000       FROM TIME.                                                 08700000
087100                                                                  08710000
087200     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         08720000
087300     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             08730000
087400     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               08740000
087500     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              08750000
087600                                                                  08760000
087700     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              08770000
087800     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            08780000
087900     MOVE PC-SUKRP007            TO DP132O-PROGRAM-NAME.          08790000
088000                                                                  08800000
088100******************************************************************08810000
088200**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  08820000
088300******************************************************************08830000
088400     IF CC-PRINT-ENTIRE-TRIP                                      08840000
088500        STRING 'ENTIRE TRIP-REQUESTED BY '                        08850000
088600               CC-REQUESTOR-ID  DELIMITED BY SIZE                 08860000
088700               INTO HL1A-CC-IND-DESC                              08870000
088800     ELSE                                                         08880000
088900        STRING 'SELECTED PO''S REQUESTED BY '                     08890000
089000               CC-REQUESTOR-ID  DELIMITED BY SIZE                 08900000
089100               INTO HL1A-CC-IND-DESC.                             08910000
089200                                                                  08920000
089300     OPEN INPUT  EXTRACT-FILE                                     08930000
089400          INPUT  EXTRACT-FILE2                                    08940000
089500          OUTPUT UNIT-ADJUSTMENT-FILE.                            08950000
089600                                                                  08960000
089700     PERFORM 2600-READ-EXTRACT2                                   08970000
089800     IF SU001-ERROR-RECORD                                        08980000
089900          OR PS-END-OF-EXTRACT2                                   08990000
090000        SET PS-END-OF-EXTRACT2        TO TRUE                     09000000
090100        SET PS-ERROR                  TO TRUE                     09010000
090200     ELSE                                                         09020000
090300        MOVE SU001-MANIFEST-NBR       TO PV-TRIP-ID               09030000
090400                                                                  09040000
090500        PERFORM 2500-READ-EXTRACT                                 09050000
090600        IF NOT PS-END-OF-EXTRACT                                  09060000
090700                                                                  09070000
090800          MOVE SU009-MANIFEST-NBR     TO PV-TRIP-ID               09080000
090900                                         VHTRIP-TRIP-ID           09090000
091000                                         SHUNLO-TRIP-ID           09100000
091100                                         SHIPMT-TRIP-ID           09110000
091200                                                                  09120000
091300          SET PS-DETAIL-RECORD        TO TRUE                     09130000
091400                                                                  09140000
091500          PERFORM 1100-SELECT-TRAILER                             09150000
091600                                                                  09160000
091700*                                                                 09170000
091800          MOVE SU009-PO-NUMBER        TO PV-PO-NBR                09180000
091900          MOVE SU009-REC-SEQ-NBR      TO PV-RECEIVER              09190000
092000          MOVE PV-PO-RECEIVER         TO PV-SAVE-PO-RECEIVER      09200000
092100          MOVE SU009-STR-NBR          TO PV-STR-NBR               09210000
092200                                             PV-SAVE-STR-NBR      09220000
092300          MOVE SU009-LINE-NBR         TO PV-LINE-NBR              09230000
092400                                             PV-SAVE-LINE-NBR     09240000
092500          ADD SU009-SHPD-QTY          TO PV-STORE-UNIT-TOT        09250000
092600          MOVE SU009-SHPD-QTY         TO PV-SAVE-SHPD-QTY         09260000
092700                                             PV-SHPD-QTY          09270000
092800     END-IF.                                                      09280000
092900                                                                  09290000
093000     IF PV-TRIP-ID   NOT  = ZEROS                                 09300000
093100         PERFORM 1100-SELECT-TRAILER                              09310000
093200         PERFORM 0800-PREPARE-HEADINGS.                           09320000
093300                                                                  09330000
093400*                                                                 09340000
093500******************************************************************09350000
093600**  PREPARE HEADINGS.                                             09360000
093700******************************************************************09370000
093800 0800-PREPARE-HEADINGS.                                           09380000
093900*                                                                 09390000
094000          MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC                 09400000
094100          MOVE PV-TRIP-ID             TO HL2-TRIP-ID              09410000
094200          MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT         09420000
094300                                                                  09430000
094400          IF DN-VEH-NBR = -1                                      09440000
094500               MOVE SPACES             TO HL2-TRAILER             09450000
094600          ELSE                                                    09460000
094700                MOVE VHTRIP-VEH-NBR     TO HL2-TRAILER            09470000
094800          END-IF                                                  09480000
094900                                                                  09490000
095000     IF PS-DETAIL-RECORD                                          09500000
095100         PERFORM 1500-SELECT-RECEIVING-UIDS                       09510000
095200     END-IF.                                                      09520000
095300                                                                  09530000
095400     IF PS-DETAIL-RECORD                                          09540000
095500         MOVE PC-AR TO PV-STATUS                                  09550000
095600         SET PS-STATUS-NOT-FOUND TO TRUE                          09560000
095700         PERFORM 1200-SELECT-STATUS                               09570000
095800     END-IF.                                                      09580000
095900                                                                  09590000
096000     IF PS-DETAIL-RECORD                                          09600000
096100         IF PS-STATUS-FOUND                                       09610000
096200             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              09620000
096300             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           09630000
096400             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           09640000
096500             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           09650000
096600             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           09660000
096700         ELSE                                                     09670000
096800             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           09680000
096900             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           09690000
097000             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           09700000
097100             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           09710000
097200         END-IF                                                   09720000
097300         MOVE PC-UG    TO PV-STATUS                               09730000
097400         SET PS-STATUS-NOT-FOUND TO TRUE                          09740000
097500         PERFORM 1200-SELECT-STATUS                               09750000
097600     END-IF.                                                      09760000
097700                                                                  09770000
097800     IF PS-DETAIL-RECORD                                          09780000
097900         IF PS-STATUS-FOUND                                       09790000
098000             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              09800000
098100             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        09810000
098200             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        09820000
098300             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        09830000
098400             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        09840000
098500         ELSE                                                     09850000
098600             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        09860000
098700             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        09870000
098800             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        09880000
098900             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        09890000
099000         END-IF                                                   09900000
099100         MOVE PC-UN    TO PV-STATUS                               09910000
099200         SET PS-STATUS-NOT-FOUND TO TRUE                          09920000
099300         PERFORM 1200-SELECT-STATUS                               09930000
099400     END-IF.                                                      09940000
099500                                                                  09950000
099600     IF PS-DETAIL-RECORD                                          09960000
099700         IF PS-STATUS-FOUND                                       09970000
099800             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              09980000
099900             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          09990000
100000             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          10000000
100100             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          10010000
100200             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          10020000
100300         ELSE                                                     10030000
100400             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          10040000
100500             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          10050000
100600             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          10060000
100700             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          10070000
100800         END-IF                                                   10080000
100900                                                                  10090000
101000*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  10100000
101100         IF CC-PRTR-CNTL-IND = 'P'                                10110000
101200             MOVE CC-TRACK-NBR    TO DS004-PLC-LF-FORM-NBR        10120000
101300             MOVE DS004-PES-8LPI  TO DS004-PLC-LF-LPI             10130000
101400                                                                  10140000
101500             WRITE UNIT-ADJUSTMENT-RECORD                         10150000
101600               FROM DS004-PLC-LOAD-FORM                           10160000
101700                 AFTER ADVANCING 1 LINE                           10170000
101800         END-IF.                                                  10180000
101900                                                                  10190000
102000******************************************************************10200000
102100**  PERFORMS THE PROCESSING FOR THE PROGRAM.                      10210000
102200******************************************************************10220000
102300 1000-PROCESS-EXTRACT-FILE.                                       10230000
102400                                                                  10240000
102500* PROCESS FIRST RECORD                                            10250000
102600                                                                  10260000
102700         IF PS-DETAIL-RECORD                                      10270000
102800            PERFORM 8000-WRITE-REPORT-HEADERS                     10280000
102900            PERFORM 2200-GET-EXCEPTION-TYPE                       10290000
103000            PERFORM 2300-BUILD-DETAIL-LINE                        10300000
103100            PERFORM 8400-WRITE-DETAIL-LINE                        10310000
103200            PERFORM 2500-READ-EXTRACT                             10320000
103300            PERFORM 2000-PROCESS-SU                               10330000
103400         END-IF.                                                  10340000
103500                                                                  10350000
103600* PROCESS LAST RECORD                                             10360000
103700                                                                  10370000
103800         PERFORM 2130-PROCESS-STR                                 10380000
103900         PERFORM 2140-PROCESS-PO                                  10390000
104000*                                                                 10400000
104100         WRITE UNIT-ADJUSTMENT-RECORD                             10410000
104200           FROM END-OF-REPORT-LINE                                10420000
104300             AFTER ADVANCING 2 LINES.                             10430000
104400*                                                                 10440000
104500*    IF THIS IS A PRINTEK PRINTER 'AND' CONTROL CARD STATES TO    10450000
104600*    CUT AFTER PRINTING, SEND A CUT COMMAND                       10460000
104700*    ADDED 4/24/98 DENISE HAHN.                                   10470000
104800*                                                                 10480000
104900         IF  CC-PRTR-CNTL-IND = 'P'  AND                          10490000
105000             CC-CUT-REPORT-AT-END                                 10500000
105100                 WRITE UNIT-ADJUSTMENT-RECORD                     10510000
105200                   FROM DS004-PLC-CUT-FORM                        10520000
105300                     AFTER ADVANCING 1 LINE                       10530000
105400         END-IF.                                                  10540000
105500*                                                                 10550000
105600 1100-SELECT-TRAILER.                                             10560000
105700     MOVE '1100-SELECT-TRAILER '                                  10570000
105800                                 TO PV-ABEND-PARAGRAPH.           10580000
105900     EXEC SQL                                                     10590000
106000       SELECT A.OWNER_SCAC_ID                                     10600000
106100             ,A.VEH_NBR                                           10610000
106200             ,B.TRIP_STATUS_CDE                                   10620000
106300       INTO  :VHTRIP-OWNER-SCAC-ID                                10630000
106400            ,:VHTRIP-VEH-NBR :DN-VEH-NBR                          10640000
106500            ,:TRIPST-TRIP-STATUS-CDE                              10650000
106600       FROM   TVHTRIP A                                           10660000
106700             ,TTRIPST B                                           10670000
106800             ,TTRSTYP C                                           10680000
106900       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                10690000
107000         AND  B.TRIP_STATUS_CDE ^= 'DE'                           10700000
107100         AND  C.PRTY_CDE =                                        10710000
107200              (SELECT MAX(E.PRTY_CDE)                             10720000
107300                 FROM TTRIPST D                                   10730000
107400                     ,TTRSTYP E                                   10740000
107500                WHERE D.TRIP_ID         = A.TRIP_ID               10750000
107600                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      10760000
107700         AND  A.TRIP_ID         = B.TRIP_ID                       10770000
107800         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               10780000
107900     END-EXEC.                                                    10790000
108000                                                                  10800000
108100     EVALUATE TRUE                                                10810000
108200       WHEN SQLCODE = ZEROS                                       10820000
108300         CONTINUE                                                 10830000
108400       WHEN SQLCODE = +100                                        10840000
108500         MOVE SPACES TO VHTRIP-VEH-NBR                            10850000
108600                        VHTRIP-OWNER-SCAC-ID                      10860000
108700                        TRIPST-TRIP-STATUS-CDE                    10870000
108800       WHEN SQLCODE = -904                                        10880000
108900       WHEN SQLCODE = -911                                        10890000
109000       WHEN SQLCODE = -913                                        10900000
109100         SET PS-ERROR-RECORD TO TRUE                              10910000
109200         MOVE SPACES TO VHTRIP-VEH-NBR                            10920000
109300                        VHTRIP-OWNER-SCAC-ID                      10930000
109400                        TRIPST-TRIP-STATUS-CDE                    10940000
109500       WHEN OTHER                                                 10950000
109600         DISPLAY PV-ABEND-PARAGRAPH                               10960000
109700         PERFORM Z999-SQL-ERROR                                   10970000
109800     END-EVALUATE.                                                10980000
109900                                                                  10990000
110000 1200-SELECT-STATUS.                                              11000000
110100     MOVE '1200-SELECT-STATUS  '                                  11010000
110200                                 TO PV-ABEND-PARAGRAPH.           11020000
110300     EXEC SQL                                                     11030000
110400       SELECT STATUS_DTE                                          11040000
110500       INTO  :TRIPST-STATUS-DTE                                   11050000
110600       FROM   TTRIPST                                             11060000
110700       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                11070000
110800         AND  TRIP_STATUS_CDE    = :PV-STATUS                     11080000
110900     END-EXEC.                                                    11090000
111000                                                                  11100000
111100     EVALUATE TRUE                                                11110000
111200       WHEN SQLCODE = ZEROS                                       11120000
111300         SET PS-STATUS-FOUND TO TRUE                              11130000
111400       WHEN SQLCODE = +100                                        11140000
111500         SET PS-STATUS-NOT-FOUND TO TRUE                          11150000
111600       WHEN SQLCODE = -904                                        11160000
111700       WHEN SQLCODE = -911                                        11170000
111800       WHEN SQLCODE = -913                                        11180000
111900         SET PS-ERROR-RECORD TO TRUE                              11190000
112000       WHEN OTHER                                                 11200000
112100         DISPLAY PV-ABEND-PARAGRAPH                               11210000
112200         PERFORM Z999-SQL-ERROR                                   11220000
112300     END-EVALUATE.                                                11230000
112400                                                                  11240000
112500                                                                  11250000
112600 1500-SELECT-RECEIVING-UIDS.                                      11260000
112700******************************************************************11270000
112800* OPEN A CURSOR TO SELECT ALL THE USERIDS OF ALL THE RECEIVING    11280000
112900* ASSOCIATES WHO CHECKED-IN THIS TRAILER.                         11290000
113000******************************************************************11300000
113100                                                                  11310000
113200     INITIALIZE HL3B-USERID-TABLE                                 11320000
113300                PV-HOLD-UID.                                      11330000
113400     SET HL3B-UID-IDX TO +1.                                      11340000
113500     SET HL3B-UID-IDX DOWN BY +1.                                 11350000
113600                                                                  11360000
113700     PERFORM 1600-OPEN-UID-CURSOR.                                11370000
113800     IF PS-DETAIL-RECORD                                          11380000
113900         PERFORM 1700-FETCH-UID-CURSOR                            11390000
114000     END-IF.                                                      11400000
114100*                                                                 11410000
114200     PERFORM UNTIL PS-EOF-UID-CURSOR                              11420000
114300                OR PS-ERROR-RECORD                                11430000
114400         IF SHUNLO-CRE-USR-ID = PV-HOLD-UID                       11440000
114500             CONTINUE                                             11450000
114600         ELSE                                                     11460000
114700             IF HL3B-UID-IDX > 0                                  11470000
114800                 MOVE ','          TO HL3B-COMMA (HL3B-UID-IDX)   11480000
114900             END-IF                                               11490000
115000                                                                  11500000
115100             SET HL3B-UID-IDX UP BY +1                            11510000
115200             MOVE SHUNLO-CRE-USR-ID TO                            11520000
115300                             HL3B-USER-ID (HL3B-UID-IDX)          11530000
115400             MOVE SHUNLO-CRE-USR-ID TO PV-HOLD-UID                11540000
115500         END-IF                                                   11550000
115600         PERFORM 1700-FETCH-UID-CURSOR                            11560000
115700     END-PERFORM.                                                 11570000
115800                                                                  11580000
115900     IF PS-DETAIL-RECORD                                          11590000
116000         PERFORM 1800-CLOSE-UID-CURSOR                            11600000
116100     END-IF.                                                      11610000
116200                                                                  11620000
116300                                                                  11630000
116400 1600-OPEN-UID-CURSOR.                                            11640000
116500******************************************************************11650000
116600*  THIS PROCEDURE WILL OPEN THE UID CURSOR.                       11660000
116700******************************************************************11670000
116800                                                                  11680000
116900     IF  SU009-MANIFEST-NBR EQUAL ZEROS                           11690000
117000         IF  SU001-MANIFEST-NBR EQUAL ZEROS                       11700000
117100             MOVE -1 TO SU009-MANIFEST-NBR                        11710000
117200         ELSE                                                     11720000
117300             MOVE SU001-MANIFEST-NBR TO                           11730000
117400                  SU009-MANIFEST-NBR                              11740000
117500         END-IF                                                   11750000
117600     END-IF.                                                      11760000
117700                                                                  11770000
117800     EXEC SQL                                                     11780000
117900          OPEN UID_CURSOR                                         11790000
118000     END-EXEC.                                                    11800000
118100                                                                  11810000
118200     EVALUATE TRUE                                                11820000
118300         WHEN SQLCODE = ZERO                                      11830000
118400              SET PS-NOT-EOF-UID-CURSOR                           11840000
118500                               TO  TRUE                           11850000
118600         WHEN SQLCODE = -904                                      11860000
118700         WHEN SQLCODE = -911                                      11870000
118800         WHEN SQLCODE = -913                                      11880000
118900              SET PS-ERROR-RECORD TO TRUE                         11890000
119000         WHEN SQLWARN0 NOT EQUAL SPACE                            11900000
119100         WHEN SQLCODE NOT EQUAL ZERO                              11910000
119200              MOVE '1600-OPEN-UID-CURSOR'                         11920000
119300                               TO  PV-ABEND-PARAGRAPH             11930000
119400              MOVE 'OPEN UID_CURSOR'                              11940000
119500                               TO  PV-DB2-OPERATION-ATTEMPTED     11950000
119600              DISPLAY '** PARAGRAPH ** '                          11960000
119700                                   PV-ABEND-PARAGRAPH             11970000
119800              DISPLAY '** OPERATION ** '                          11980000
119900                                   PV-DB2-OPERATION-ATTEMPTED     11990000
120000              PERFORM Z999-SQL-ERROR                              12000000
120100     END-EVALUATE.                                                12010000
120200                                                                  12020000
120300                                                                  12030000
120400 1700-FETCH-UID-CURSOR.                                           12040000
120500******************************************************************12050000
120600*  THIS PROCEDURE WILL FETCH THE UID-CURSOR.                      12060000
120700******************************************************************12070000
120800                                                                  12080000
120900     EXEC SQL                                                     12090000
121000          FETCH UID_CURSOR                                        12100000
121100          INTO                                                    12110000
121200                 :SHUNLO-CRE-USR-ID                               12120000
121300     END-EXEC.                                                    12130000
121400                                                                  12140000
121500     EVALUATE TRUE                                                12150000
121600         WHEN SQLCODE = ZERO                                      12160000
121700              CONTINUE                                            12170000
121800                                                                  12180000
121900         WHEN SQLCODE = +100                                      12190000
122000              SET PS-EOF-UID-CURSOR                               12200000
122100                               TO  TRUE                           12210000
122200         WHEN SQLCODE = -904                                      12220000
122300         WHEN SQLCODE = -911                                      12230000
122400         WHEN SQLCODE = -913                                      12240000
122500              SET PS-ERROR-RECORD TO TRUE                         12250000
122600         WHEN SQLWARN0 NOT EQUAL SPACE                            12260000
122700         WHEN SQLCODE NOT EQUAL ZERO                              12270000
122800              MOVE '1700-FETCH-UID-CURSOR'                        12280000
122900                               TO  PV-ABEND-PARAGRAPH             12290000
123000              MOVE 'FETCH UID_CURSOR'                             12300000
123100                               TO  PV-DB2-OPERATION-ATTEMPTED     12310000
123200              DISPLAY '** PARAGRAPH ** '                          12320000
123300                                   PV-ABEND-PARAGRAPH             12330000
123400              DISPLAY '** OPERATION ** '                          12340000
123500                                   PV-DB2-OPERATION-ATTEMPTED     12350000
123600              PERFORM Z999-SQL-ERROR                              12360000
123700     END-EVALUATE.                                                12370000
123800                                                                  12380000
123900                                                                  12390000
124000 1800-CLOSE-UID-CURSOR.                                           12400000
124100******************************************************************12410000
124200*  THIS PROCEDURE WILL CLOSE THE UID_CURSOR.                      12420000
124300******************************************************************12430000
124400                                                                  12440000
124500     EXEC SQL                                                     12450000
124600         CLOSE UID_CURSOR                                         12460000
124700     END-EXEC.                                                    12470000
124800                                                                  12480000
124900     EVALUATE TRUE                                                12490000
125000         WHEN SQLCODE = -904                                      12500000
125100         WHEN SQLCODE = -911                                      12510000
125200         WHEN SQLCODE = -913                                      12520000
125300              SET PS-ERROR-RECORD TO TRUE                         12530000
125400         WHEN SQLWARN0 NOT EQUAL SPACE                            12540000
125500         WHEN SQLCODE NOT EQUAL ZERO                              12550000
125600              MOVE '1800-CLOSE-UID-CURSOR'                        12560000
125700                               TO  PV-ABEND-PARAGRAPH             12570000
125800              MOVE 'CLOSE UID_CURSOR'                             12580000
125900                               TO  PV-DB2-OPERATION-ATTEMPTED     12590000
126000              DISPLAY '** PARAGRAPH ** '                          12600000
126100                                   PV-ABEND-PARAGRAPH             12610000
126200              DISPLAY '** OPERATION ** '                          12620000
126300                                   PV-DB2-OPERATION-ATTEMPTED     12630000
126400              PERFORM Z999-SQL-ERROR                              12640000
126500     END-EVALUATE.                                                12650000
126600                                                                  12660000
126700                                                                  12670000
126800******************************************************************12680000
126900*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING         *12690000
127000******************************************************************12700000
127100 2000-PROCESS-SU.                                                 12710000
127200*                                                                 12720000
127300     PERFORM 2100-PROCESS-EXTRACT                                 12730000
127400         UNTIL PS-END-OF-EXTRACT                                  12740000
127500            OR PS-ERROR-RECORD.                                   12750000
127600*                                                                 12760000
127700******************************************************************12770000
127800 2100-PROCESS-EXTRACT.                                            12780000
127900******************************************************************12790000
128000*                                                                 12800000
128100     PERFORM 2400-CHECK-CONTROL-BREAK.                            12810000
128200*                                                                 12820000
128300       IF PS-NEW-PO-RECEIVER                                      12830000
128400           PERFORM 2130-PROCESS-STR                               12840000
128500           PERFORM 2140-PROCESS-PO                                12850000
128600           PERFORM 8000-WRITE-REPORT-HEADERS                      12860000
128700       ELSE                                                       12870000
128800           IF PS-NEW-STORE                                        12880000
128900              PERFORM 2130-PROCESS-STR                            12890000
129000           END-IF                                                 12900000
129100       END-IF.                                                    12910000
129200*                                                                 12920000
129300     PERFORM 2120-NEW-LINE.                                       12930000
129400     PERFORM 2110-SAVE-FIELDS.                                    12940000
129500     PERFORM 2500-READ-EXTRACT.                                   12950000
129600*                                                                 12960000
129700******************************************************************12970000
129800 2110-SAVE-FIELDS.                                                12980000
129900******************************************************************12990000
130000*                                                                 13000000
130100           MOVE PV-PO-RECEIVER         TO PV-SAVE-PO-RECEIVER.    13010000
130200           MOVE PV-STR-NBR             TO PV-SAVE-STR-NBR.        13020000
130300           MOVE PV-LINE-NBR            TO PV-SAVE-LINE-NBR.       13030000
130400           MOVE PV-SHPD-QTY            TO PV-SAVE-SHPD-QTY.       13040000
130500           ADD  PV-SAVE-SHPD-QTY       TO PV-STORE-UNIT-TOT.      13050000
130600*                                                                 13060000
130700******************************************************************13070000
130800 2120-NEW-LINE.                                                   13080000
130900******************************************************************13090000
131000*                                                                 13100000
131100             PERFORM 2200-GET-EXCEPTION-TYPE.                     13110000
131200             PERFORM 2300-BUILD-DETAIL-LINE.                      13120000
131300             PERFORM 8400-WRITE-DETAIL-LINE.                      13130000
131400*                                                                 13140000
131500******************************************************************13150000
131600 2130-PROCESS-STR.                                                13160000
131700******************************************************************13170000
131800*                                                                 13180000
131900                                                                  13190000
132000          MOVE PV-STORE-UNIT-TOT     TO TL1-UNITS-CNT             13200000
132100          ADD PV-STORE-UNIT-TOT      TO PV-PO-RECEIVER-UNIT-TOT   13210000
132200          MOVE  ZERO                 TO PV-STORE-UNIT-TOT         13220000
132300          MOVE PV-SAVE-STR-NBR       TO TL1-STR-NBR               13230000
132400          PERFORM 3000-PRINT-STORE-TOTALS.                        13240000
132500*                                                                 13250000
132600******************************************************************13260000
132700 2140-PROCESS-PO.                                                 13270000
132800******************************************************************13280000
132900*                                                                 13290000
133000        MOVE PV-PO-RECEIVER-UNIT-TOT TO TL3-UNITS-CNT             13300000
133100        MOVE ZERO               TO PV-PO-RECEIVER-UNIT-TOT        13310000
133200        PERFORM 3100-PRINT-PO-TOTALS.                             13320000
133300*                                                                 13330000
133400******************************************************************13340000
133500 2200-GET-EXCEPTION-TYPE.                                         13350000
133600******************************************************************13360000
133700*                                                                 13370000
133800     EVALUATE TRUE                                                13380000
133900     WHEN SU009-EXCEPTION-TYPE = '1'                              13390000
134000        MOVE 'NOT SCANNED'       TO DL1-EXCEPTION-TYPE            13400000
134100     WHEN SU009-EXCEPTION-TYPE = '2'                              13410000
134200        MOVE 'MISDIRECT'         TO DL1-EXCEPTION-TYPE            13420000
134300     WHEN SU009-EXCEPTION-TYPE = '3'                              13430000
134400        MOVE 'FREE ASTRAY'       TO DL1-EXCEPTION-TYPE            13440000
134500     END-EVALUATE.                                                13450000
134600*                                                                 13460000
134700******************************************************************13470000
134800 2300-BUILD-DETAIL-LINE.                                          13480000
134900******************************************************************13490000
135000*                                                                 13500000
135100     IF PS-PO-WRITTEN                                             13510000
135200         MOVE SPACES             TO DL1-PO-RECEIVER               13520000
135300     ELSE                                                         13530000
135400         MOVE PV-PO-RECEIVER     TO DL1-PO-RECEIVER.              13540000
135500*                                                                 13550000
135600     IF PS-STR-WRITTEN                                            13560000
135700         MOVE SPACES             TO DL1-STR-NBR                   13570000
135800     ELSE                                                         13580000
135900         MOVE PV-STR-NBR         TO DL1-STR-NBR.                  13590000
136000*                                                                 13600000
136100     MOVE SU009-LINE-NBR         TO DL1-LINE-NBR.                 13610000
136200*    MOVE SU009-PREPK-IND        TO DL1-PREPK-IND.                13620000
136300     IF SU009-PREPK-IND > SPACES                                  13630000
136400        MOVE 'PCKID'             TO DL1-PREPK-IND                 13640000
136500     ELSE                                                         13650000
136600        MOVE SPACES              TO DL1-PREPK-IND                 13660000
136700     END-IF.                                                      13670000
136800     MOVE SU009-SHPD-QTY         TO DL1-UNITS-ADJUST.             13680000
136900*                                                                 13690000
137000******************************************************************13700000
137100 2400-CHECK-CONTROL-BREAK.                                        13710000
137200******************************************************************13720000
137300*                                                                 13730000
137400     IF SU009-LINE-NBR    NOT  =  PV-SAVE-LINE-NBR                13740000
137500        SET PS-NEW-LINE         TO TRUE                           13750000
137600     END-IF.                                                      13760000
137700                                                                  13770000
137800     IF   SU009-STR-NBR     NOT  =  PV-SAVE-STR-NBR               13780000
137900        SET PS-NEW-STORE         TO TRUE                          13790000
138000        SET PS-STR-NOT-WRITTEN   TO TRUE                          13800000
138100     ELSE                                                         13810000
138200        SET PS-NOT-NEW-STORE     TO TRUE                          13820000
138300        SET PS-STR-WRITTEN       TO TRUE                          13830000
138400     END-IF.                                                      13840000
138500                                                                  13850000
138600     IF PV-PO-RECEIVER    NOT  = PV-SAVE-PO-RECEIVER              13860000
138700        SET PS-NEW-PO-RECEIVER   TO TRUE                          13870000
138800        SET PS-PO-NOT-WRITTEN    TO TRUE                          13880000
138900        SET PS-STR-NOT-WRITTEN   TO TRUE                          13890000
139000     ELSE                                                         13900000
139100        SET PS-NOT-NEW-PO-RECEIVER   TO TRUE                      13910000
139200        SET PS-PO-WRITTEN        TO TRUE                          13920000
139300     END-IF.                                                      13930000
139400*                                                                 13940000
139500******************************************************************13950000
139600 2500-READ-EXTRACT.                                               13960000
139700******************************************************************13970000
139800                                                                  13980000
139900     READ EXTRACT-FILE INTO SU009-EXTRACT-RECORD                  13990000
140000        AT END                                                    14000000
140100           SET PS-END-OF-EXTRACT TO TRUE                          14010000
140200        NOT AT END                                                14020000
140300           MOVE SU009-PO-NUMBER        TO PV-PO-NBR               14030000
140400           MOVE SU009-REC-SEQ-NBR      TO PV-RECEIVER             14040000
140500           MOVE SU009-STR-NBR          TO PV-STR-NBR              14050000
140600           MOVE SU009-LINE-NBR         TO PV-LINE-NBR             14060000
140700           MOVE SU009-SHPD-QTY         TO PV-SHPD-QTY             14070000
140800           ADD 1                       TO PV-RECORD-COUNT         14080000
140900      END-READ.                                                   14090000
141000*                                                                 14100000
141100******************************************************************14110000
141200 2600-READ-EXTRACT2.                                              14120000
141300******************************************************************14130000
141400*                                                                 14140000
141500     READ EXTRACT-FILE2 INTO SU001-EXTRACT-RECORD                 14150000
141600        AT END                                                    14160000
141700           SET PS-END-OF-EXTRACT2 TO TRUE.                        14170000
141800*                                                                 14180000
141900******************************************************************14190000
142000 3000-PRINT-STORE-TOTALS.                                         14200000
142100******************************************************************14210000
142200*                                                                 14220000
142300     IF  PV-LINE-CNT > PC-60                                      14230000
142400          PERFORM 8000-WRITE-REPORT-HEADERS                       14240000
142500     END-IF.                                                      14250000
142600                                                                  14260000
142700     WRITE UNIT-ADJUSTMENT-RECORD                                 14270000
142800       FROM TOTAL-LINE1                                           14280000
142900         AFTER ADVANCING 2 LINES.                                 14290000
143000                                                                  14300000
143100     ADD 2 TO PV-LINE-CNT.                                        14310000
143200*                                                                 14320000
143300******************************************************************14330000
143400 3100-PRINT-PO-TOTALS.                                            14340000
143500******************************************************************14350000
143600*                                                                 14360000
143700     IF  PV-LINE-CNT > PC-60                                      14370000
143800          PERFORM 8000-WRITE-REPORT-HEADERS                       14380000
143900     END-IF.                                                      14390000
144000                                                                  14400000
144100     WRITE UNIT-ADJUSTMENT-RECORD                                 14410000
144200       FROM TOTAL-LINE3                                           14420000
144300         AFTER ADVANCING 2 LINES.                                 14430000
144400                                                                  14440000
144500     ADD 2 TO PV-LINE-CNT.                                        14450000
144600*                                                                 14460000
144700******************************************************************14470000
144800*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *14480000
144900******************************************************************14490000
145000 7000-WRITE-ERROR-REPORT.                                         14500000
145100*                                                                 14510000
145200     PERFORM 8200-WRITE-TOP-LINE.                                 14520000
145300                                                                  14530000
145400     WRITE UNIT-ADJUSTMENT-RECORD                                 14540000
145500       FROM HEADING-LINE-1                                        14550000
145600         AFTER ADVANCING 1 LINE.                                  14560000
145700*                                                                 14570000
145800     WRITE UNIT-ADJUSTMENT-RECORD                                 14580000
145900       FROM HEADING-LINE-1A                                       14590000
146000         AFTER ADVANCING 1 LINE.                                  14600000
146100*                                                                 14610000
146200     WRITE UNIT-ADJUSTMENT-RECORD                                 14620000
146300       FROM HEADING-LINE-1B                                       14630000
146400         AFTER ADVANCING 1 LINE.                                  14640000
146500*                                                                 14650000
146600     WRITE UNIT-ADJUSTMENT-RECORD                                 14660000
146700       FROM HEADING-LINE-2                                        14670000
146800         AFTER ADVANCING 4 LINES.                                 14680000
146900*                                                                 14690000
147000     IF SU009-DETAIL-RECORD                                       14700000
147100         WRITE UNIT-ADJUSTMENT-RECORD                             14710000
147200           FROM EL1-ERROR-LINE-1P                                 14720000
147300             AFTER ADVANCING 3 LINES                              14730000
147400                                                                  14740000
147500         WRITE UNIT-ADJUSTMENT-RECORD                             14750000
147600           FROM EL2-ERROR-LINE-2P                                 14760000
147700             AFTER ADVANCING 2 LINES                              14770000
147800     ELSE                                                         14780000
147900         WRITE UNIT-ADJUSTMENT-RECORD                             14790000
148000           FROM EL1-ERROR-LINE-1F                                 14800000
148100             AFTER ADVANCING 3 LINES                              14810000
148200                                                                  14820000
148300         WRITE UNIT-ADJUSTMENT-RECORD                             14830000
148400           FROM EL2-ERROR-LINE-2F                                 14840000
148500             AFTER ADVANCING 2 LINES                              14850000
148600     END-IF.                                                      14860000
148700*                                                                 14870000
148800     WRITE UNIT-ADJUSTMENT-RECORD                                 14880000
148900       FROM EL3-ERROR-LINE-3                                      14890000
149000         AFTER ADVANCING 2 LINES.                                 14900000
149100*                                                                 14910000
149200     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     14920000
149300     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      14930000
149400     WRITE UNIT-ADJUSTMENT-RECORD                                 14940000
149500       FROM EL4-ERROR-LINE-4                                      14950000
149600         AFTER ADVANCING 3 LINES.                                 14960000
149700*                                                                 14970000
149800     WRITE UNIT-ADJUSTMENT-RECORD                                 14980000
149900       FROM EL5-ERROR-LINE-5                                      14990000
150000         AFTER ADVANCING 2 LINE.                                  15000000
150100*                                                                 15010000
150200     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              15020000
150300     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              15030000
150400     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              15040000
150500     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              15050000
150600     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              15060000
150700     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              15070000
150800     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              15080000
150900     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              15090000
151000     WRITE UNIT-ADJUSTMENT-RECORD                                 15100000
151100       FROM EL6-ERROR-LINE-6                                      15110000
151200         AFTER ADVANCING 1 LINE.                                  15120000
151300*                                                                 15130000
151400     WRITE UNIT-ADJUSTMENT-RECORD                                 15140000
151500       FROM END-OF-REPORT-LINE                                    15150000
151600         AFTER ADVANCING 6 LINES.                                 15160000
151700*                                                                 15170000
151800******************************************************************15180000
151900*  PRINT EMPTY FILE REPORT.                                       15190000
152000******************************************************************15200000
152100 7100-WRITE-EMPTYFILE-REPORT.                                     15210000
152200*                                                                 15220000
152300     PERFORM 8200-WRITE-TOP-LINE.                                 15230000
152400                                                                  15240000
152500     WRITE UNIT-ADJUSTMENT-RECORD                                 15250000
152600       FROM HEADING-LINE-1                                        15260000
152700         AFTER ADVANCING 1 LINE.                                  15270000
152800*                                                                 15280000
152900     WRITE UNIT-ADJUSTMENT-RECORD                                 15290000
153000       FROM HEADING-LINE-1A                                       15300000
153100         AFTER ADVANCING 1 LINE.                                  15310000
153200*                                                                 15320000
153300     WRITE UNIT-ADJUSTMENT-RECORD                                 15330000
153400       FROM HEADING-LINE-1B                                       15340000
153500         AFTER ADVANCING 1 LINE.                                  15350000
153600*                                                                 15360000
153700     WRITE UNIT-ADJUSTMENT-RECORD                                 15370000
153800       FROM HEADING-LINE-2                                        15380000
153900         AFTER ADVANCING 4 LINES.                                 15390000
154000*                                                                 15400000
154100     WRITE UNIT-ADJUSTMENT-RECORD                                 15410000
154200       FROM HEADING-LINE-3                                        15420000
154300         AFTER ADVANCING 2 LINES.                                 15430000
154400*                                                                 15440000
154500     WRITE UNIT-ADJUSTMENT-RECORD                                 15450000
154600       FROM HEADING-LINE-3B                                       15460000
154700         AFTER ADVANCING 2 LINES.                                 15470000
154800*                                                                 15480000
154900     WRITE UNIT-ADJUSTMENT-RECORD                                 15490000
155000       FROM EMPTY-FILE-LINE                                       15500000
155100         AFTER ADVANCING 4 LINES.                                 15510000
155200*                                                                 15520000
155300     WRITE UNIT-ADJUSTMENT-RECORD                                 15530000
155400       FROM END-OF-REPORT-LINE                                    15540000
155500         AFTER ADVANCING 6 LINES.                                 15550000
155600*                                                                 15560000
155700******************************************************************15570000
155800*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *15580000
155900*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *15590000
156000******************************************************************15600000
156100 8000-WRITE-REPORT-HEADERS.                                       15610000
156200*                                                                 15620000
156300     PERFORM 8200-WRITE-TOP-LINE.                                 15630000
156400*                                                                 15640000
156500     WRITE UNIT-ADJUSTMENT-RECORD                                 15650000
156600       FROM HEADING-LINE-1                                        15660000
156700         AFTER ADVANCING 1 LINE.                                  15670000
156800*                                                                 15680000
156900     WRITE UNIT-ADJUSTMENT-RECORD                                 15690000
157000       FROM HEADING-LINE-1A                                       15700000
157100         AFTER ADVANCING 1 LINE.                                  15710000
157200*                                                                 15720000
157300     WRITE UNIT-ADJUSTMENT-RECORD                                 15730000
157400       FROM HEADING-LINE-1B                                       15740000
157500         AFTER ADVANCING 1 LINE.                                  15750000
157600*                                                                 15760000
157700     WRITE UNIT-ADJUSTMENT-RECORD                                 15770000
157800       FROM HEADING-LINE-2                                        15780000
157900         AFTER ADVANCING 1 LINE.                                  15790000
158000*                                                                 15800000
158100     WRITE UNIT-ADJUSTMENT-RECORD                                 15810000
158200       FROM HEADING-LINE-3                                        15820000
158300         AFTER ADVANCING 2 LINES.                                 15830000
158400*                                                                 15840000
158500     WRITE UNIT-ADJUSTMENT-RECORD                                 15850000
158600       FROM HEADING-LINE-3B                                       15860000
158700         AFTER ADVANCING 2 LINES.                                 15870000
158800*                                                                 15880000
158900     WRITE UNIT-ADJUSTMENT-RECORD                                 15890000
159000       FROM HEADING-LINE-4                                        15900000
159100         AFTER ADVANCING 2 LINES.                                 15910000
159200*                                                                 15920000
159300     WRITE UNIT-ADJUSTMENT-RECORD                                 15930000
159400       FROM HEADING-LINE-5                                        15940000
159500         AFTER ADVANCING 1 LINE.                                  15950000
159600*                                                                 15960000
159700     MOVE PC-13           TO PV-LINE-CNT.                         15970000
159800     MOVE PC-2            TO PV-LINE-SUB.                         15980000
159900*                                                                 15990000
160000*                                                                 16000000
160100 8200-WRITE-TOP-LINE.                                             16010000
160200******************************************************************16020000
160300*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *16030000
160400*     NEEDED FOR AN ASN NUMBER.                                  *16040000
160500******************************************************************16050000
160600     ADD 1                        TO PV-PAGE-CNT.                 16060000
160700*                                                                 16070000
160800     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          16080000
160900*                                                                 16090000
161000     WRITE UNIT-ADJUSTMENT-RECORD                                 16100000
161100       FROM DP132O-STANDRD-HEADER-132-COLS                        16110000
161200         AFTER ADVANCING PAGE.                                    16120000
161300*                                                                 16130000
161400*                                                                 16140000
161500 8400-WRITE-DETAIL-LINE.                                          16150000
161600******************************************************************16160000
161700*     WRITES THE DETAIL LINE INFORMATION.                        *16170000
161800******************************************************************16180000
161900*                                                                 16190000
162000*CHECK FOR OVERFLOW.                                              16200000
162100     ADD +2 TO PV-LINE-CNT.                                       16210000
162200     IF PV-LINE-CNT > PC-60                                       16220000
162300         PERFORM 8000-WRITE-REPORT-HEADERS                        16230000
162400         MOVE PV-STR-NBR         TO DL1-STR-NBR                   16240000
162500         MOVE PV-PO-RECEIVER     TO DL1-PO-RECEIVER               16250000
162600     END-IF.                                                      16260000
162700*                                                                 16270000
162800     WRITE UNIT-ADJUSTMENT-RECORD                                 16280000
162900       FROM DETAIL-LINE1                                          16290000
163000         AFTER ADVANCING PV-LINE-SUB LINES.                       16300000
163100*                                                                 16310000
163200*                                                                 16320000
163300******************************************************************16330000
163400*     SQL WARNING OR ERROR PROCESSING                            *16340000
163500*                                                                *16350000
163600******************************************************************16360000
163700                                                                  16370000
163800*                                                                 16380000
163900 Z999-SQL-ERROR.                                                  16390000
164000*---------------                                                  16400000
164100                                                                  16410000
164200     MOVE SQLCODE    TO SQLCODE2.                                 16420000
164300     MOVE SQLERRD(3) TO SQLERRD3.                                 16430000
164400     DISPLAY '** ABEND **       ** = SQLERROR'.                   16440000
164500     DISPLAY '** PROGRAM        ** = SUKRP007'.                   16450000
164600     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  16460000
164700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  16470000
164800     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   16480000
164900     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  16490000
165000     EXEC SQL                                                     16500000
165100         COMMIT                                                   16510000
165200     END-EXEC.                                                    16520000
165300     MOVE +4013 TO PV-ABEND-CODE.                                 16530000
165400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         16540000
