000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400                                                                  00040003
000500 PROGRAM-ID.    VNKCS001.                                         00041003
000600 AUTHOR.        TIM SMITH.                                        00050000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000800 DATE-WRITTEN.  06-11-93.                                         00070000
000900*----------------------------------------------------------------*00080000
001000*    V001 - VENDOR CRITERIA SPECIFICATION                        *00090000
001100*                                                                *00100000
001200*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00110000
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00120000
001400*    DETAIL SCREEN.  THE DEPARTMENT NUMBER, INHOUSE AND DUNS     *00130000
001500*    NUMBER, IF ENTERED, MUST BE NUMERIC. ALL OTHER EDITS ARE    *00140000
001600*    DONE IN THE DESTINATION PROGRAMS WHEN THE 'GO-TO' TYPE      *00150000
001700*    FUNCTION IS USED.                                           *00160000
001800*----------------------------------------------------------------*00170000
001900*        CHANGE MADE:                                            *        
002000*                                                                *        
002100*            CHANGE COPYBOOK  'VNWS001'                          *        
002200*                                                                *        
002300*                REMOVE FIELDS 'VN001-RN-NUMBER' AND             *        
002400*                              'VN001-WPL-NUMBER AND             *        
002500*                              REPLACE WITH FILLER.              *        
002600*                                                                *        
002700*            CHANGE MAP       'VNKM001'                          *        
002800*                                                                *        
002900*                REMOVE FIELD  'ARNNBR' AND ALL ATTRIBUTE FIELDS *        
003000*                        (ALL DFHMDF REFERENCES FROM POSITION 15)*        
003100*                                                                *        
003200*                REMOVE FIELD  'AWPLNBR' AND ALL ATTRIBUTE FIELDS*        
003300*                        (ALL DFHMDF REFERENCES FROM POSITION 17)*        
003400*                                                                *        
003500*               MOVE MAP FIELD 'ASTATUS' AND ALL ATTRIBUTE FIELDS*        
003600*                         TO POSITION 15.                        *        
003700*                                                                *        
003800*            NSERT COMMENT LINES BETWEEN EACH NEW MAP LINE FILED.*        
003900*                                                                *        
004000*            CHANGE PROGRAM   'VNKCS001'.                        *        
004100*                                                                *        
004200*                CHANGE ALL ++INCLUDES TO COPY STATEMENTS.       *        
004300*                                                                *        
004400*                REMOVE ALL REFERENCES TO 'ARNNBR'AND ASSOCIATED *        
004500*                         ATTRIBUTES.                            *        
004600*                                                                *        
004700*                REMOVE ALL REFERENCES TO 'AWPLNBR' AND ASSOCIATE*        
004800*                         ATTRIBUTES.                            *        
004900*                                                                *        
005000*                REMOVE ALL REFERENCES TO 'ASC-RN-NUMBER'.       *        
005100*                                                                *        
005200*                REMOVE ALL REFERENCES TO 'ASC-WPL-NUMBER'.      *        
005300*                                                                *        
005400*                REMOVE ALL REFERENCES TO 'VN001-RN-NUMBER'.     *        
005500*                                                                *        
005600*                REMOVE ALL REFERENCES TO 'VN001-WPL-NUNMBER'.   *        
005700*                                                                *        
005800*        MADE BY: W. A. EHMKE                  WR # : 21278      *        
005900*                                                                *        
006000*                                                                *        
006010* 09/07/2021 GERMAN BANDA                    WR/IR #: CHG0261091          
006020*            - CHANGE CALL OF DPKUT100 TO                       *         
006030*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 *         
006040*              MAKING THE CALL DYNAMIC VS STATIC                *         
006050*                                                               *         
006010* 01/05/2023 JEAN KURK                       WR/IR #: CHG0277999          
006020*            - CHANGE CALL OF DPKCS030 TO DYNAMIC               *         
006050*                                                               *         
006100*----------------------------------------------------------------*00170000
006200                                                                  00180003
006300     EJECT                                                        00180103
006400                                                                  00180203
006500 ENVIRONMENT DIVISION.                                            00181003
006600                                                                  00180203
006700 DATA DIVISION.                                                   00190000
006800                                                                  00200000
006900 WORKING-STORAGE SECTION.                                         00210000
007000                                                                  00220000
007100 01  PC-PROGRAM-CONSTANTS.                                        00230000
007200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'VN001A  '. 00240000
007300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'VNKM001 '. 00250000
007400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'VNKCS001'. 00260000
007500     05  PC-TSYMSG-NUMBERS.                                       00270000
007600         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00280000
007700         10  PC-TSYMSG-00496       PIC  9(05)  VALUE  00496.      00290000
007800         10  PC-TSYMSG-00829       PIC  9(05)  VALUE  00829.      00300000
007900                                                                  00310000
008000 01  PS-PROGRAM-SWITCHES.                                         00320000
008100     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00330000
008200         88  PS-ERROR                          VALUE  'Y'.        00340000
008300         88  PS-NO-ERROR                       VALUE  'N'.        00350000
008400                                                                  00360000
008500     EJECT                                                        00361003
008600                                                                  00362003
008700*----------------------------------------------------------------*00370000
008800*    MAP LAYOUT                                                  *00380000
008900*----------------------------------------------------------------*00390000
009000     COPY VNKM001.                                                00400000
009100                                                                  00410000
009200     EJECT                                                        00411003
009300                                                                  00412003
009400*----------------------------------------------------------------*00420000
009500*    ABEND PROCESSING COPYBOOK.                                  *00430000
009600*----------------------------------------------------------------*00440000
009700                                                                  00441003
009800     COPY DPWS013.                                                00451003
009900                                                                  00460000
010000     EJECT                                                        00461003
010100                                                                  00462003
010200*----------------------------------------------------------------*00470000
010300*    ATTRIBUTE SETTINGS COPYBOOK.                                *00480000
010400*----------------------------------------------------------------*00490000
010500                                                                  00491003
010600     COPY DPWS015.                                                00501003
010700                                                                  00510000
010800     EJECT                                                        00511003
010900                                                                  00512003
011000*----------------------------------------------------------------*00520000
011100*    FUNCTION KEYS COPYBOOK                                      *00530000
011200*----------------------------------------------------------------*00540000
011300                                                                  00541003
011400     COPY DPWS016.                                                00551003
011500                                                                  00560000
011600     EJECT                                                        00561003
011700                                                                  00562003
011800******************************************************************00570000
011900** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00580000
012000** SUB-ROUTINE (DPKUT100).                                      **00590000
012100******************************************************************00600000
012200                                                                  00601003
012300     COPY DPWS010I.                                               00611003
012400                                                                  00620000
012500     EJECT                                                        00621003
012600                                                                  00622003
012700******************************************************************00630000
012800** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **00640000
012900** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **00650000
013000******************************************************************00660000
013100                                                                  00661003
013200     COPY DPWS030.                                                00671003
013200     COPY DPWS930.                                                00671003
013300                                                                  00680000
013400     EJECT                                                        00681003
013500                                                                  00682003
013600***************************************************************** 00690000
013700*    STANDARD COMMAREA.                                           00700000
013800***************************************************************** 00710000
013900                                                                  00711003
014000     COPY DPWS020.                                                00720103
014100                                                                  00721003
014200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                00730000
014300                                                                  00731003
014400***************************************************************** 00740000
014500*    INTER-APPLICATION COMMAREA.                                  00750000
014600***************************************************************** 00760000
014700                                                                  00761003
014800         10  INTER-APPL-COMM-AREA  PIC X(200).                    00770000
014900                                                                  00780000
015000     COPY VNWS001.                                                00791003
015100                                                                  00800000
015200***************************************************************** 00810000
015300*    SPECIFIC COMMMAREA FOR VNKCS001.                             00820000
015400***************************************************************** 00830000
015500                                                                  00831003
015600         10  ASC-SPECIFIC-COMMAREA.                               00840000
015700             15  ASC-VENDOR-NAME      PIC X(30).                  00850000
015800             15  ASC-DEPT-NUMBER      PIC X(03).                  00860000
015900             15  ASC-DEPT-NUMBER-N  REDEFINES ASC-DEPT-NUMBER     00870000
016000                                      PIC 9(03).                  00880000
016100             15  ASC-INHOUSE-NUMBER   PIC X(03).                  00890000
016200             15  ASC-INHOUSE-NUMBER-N REDEFINES ASC-INHOUSE-NUMBER00900000
016300                                      PIC 9(03).                  00910000
016400             15  ASC-VENDOR-TYPE      PIC X(01).                  00920000
016500             15  ASC-DUNS-NUMBER      PIC X(09).                  00930000
016600             15  ASC-DUNS-NUMBER-N REDEFINES ASC-DUNS-NUMBER      00940000
016700                                      PIC 9(09).                  00950000
016800             15  ASC-STATUS-CODE      PIC X(01).                  01020000
016900                                                                  01030000
017000                                                                  01030707
017100     EJECT                                                        01031003
017200                                                                  01032003
017300 LINKAGE SECTION.                                                 01040000
017400                                                                  01050000
017500 01  DFHCOMMAREA.                                                 01060000
017600     05  FILLER  OCCURS 1 TO 4072 TIMES                           01070000
017700                 DEPENDING ON EIBCALEN.                           01080000
017800         10  FILLER                   PIC X.                      01090000
017900                                                                  01100000
018000     EJECT                                                        01101003
018100                                                                  01102003
018200 PROCEDURE DIVISION.                                              01110000
018300                                                                  01111003
018400***************************************************************** 01120000
018500** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01130000
018600** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01140000
018700** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01150000
018800**                                                             ** 01160000
018900** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01170000
019000** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01180000
019100***************************************************************** 01190000
019200                                                                  01191003
019300 0000-MAIN-MODULE.                                                01200000
019400                                                                  01210000
019500     INITIALIZE DP030-CICS-API-FIELDS.                            01220000
019600                                                                  01221003
019700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01230000
019800                                                                  01221003
019900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01240000
020000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01250000
020100                                                                  01221003
020200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01260000
020300                                                                  01221003
020400     MOVE LENGTH OF VN001AI        TO DP030-MAP-LENGTH (1).       01270000
020500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01280000
020600                                                                  01281003
020700     PERFORM 0001-CALL-CICS-ARCH-API.                             01290000
020800                                                                  01300000
020900     PERFORM 1000-CONTROL-PROCESSING                              01310000
021000                                                                  01320000
021100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01330000
021200                                                                  01320000
021300     PERFORM 0001-CALL-CICS-ARCH-API.                             01340000
021400                                                                  01350000
021500     EJECT                                                        01351003
021600                                                                  01352003
021700 0001-CALL-CICS-ARCH-API.                                         01360000
021800                                                                  01370000
021900*    CALL 'DPKCS030' USING DFHEIBLK                               01380000
021900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      01380000
022000                           DFHCOMMAREA                            01390000
022100                           DP030-CICS-API-FIELDS                  01400000
022200                           DP020-STANDARD-COMMAREA                01410000
022300                           VN001AI.                               01420000
022400                                                                  01430000
022500     IF  DP030-RC-CALL-SUCCESSFUL                                 01440000
022600         CONTINUE                                                 01450000
022700     ELSE                                                         01460000
022800         SET DP013-NO-ROLLBACK                                    01470000
022900             DP013-XCTL-DISPLAY-RESTART                           01480000
023000             DP013-CICS-ABEND      TO TRUE                        01490000
023100         MOVE 'BEFORE 0000-MAIN-MODULE'                           01500000
023200                                   TO DP013-PARAGRAPH             01510000
023300*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX01520000
023400*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      01530000
023300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O01520000
023400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      01530000
023500         MOVE DP030-RETURN-CODE                                   01540000
023600                                   TO DP013-MESSAGE-TEXT (3)      01550000
023700         PERFORM DP013-0000-PROCESS-ABEND                         01560000
023800     END-IF.                                                      01570000
023900                                                                  01580000
024000     EJECT                                                        01581003
024100                                                                  01582003
024200*----------------------------------------------------------------*01590000
024300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *01600000
024400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *01610000
024500*----------------------------------------------------------------*01620000
024600                                                                  01621003
024700 1000-CONTROL-PROCESSING.                                         01630000
024800                                                                  01640000
024900     EVALUATE TRUE                                                01650000
025000         WHEN DP020-NEXT-ACT-INITIAL                              01660000
025100             INITIALIZE ASC-SPECIFIC-COMMAREA                     01670000
025200             PERFORM 4000-BUILD-INITIAL-PANEL                     01680000
025300                                                                  01690000
025400         WHEN DP020-NEXT-ACT-READ-MAP                             01700000
025500             PERFORM 2000-FKEY-PROCESSING                         01710000
025600                                                                  01720000
025700         WHEN DP020-NEXT-ACT-RETURN                               01730000
025800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 01740000
025900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   01750000
026000                                                                  01760000
026100         WHEN OTHER                                               01770000
026200             SET DP013-LOGIC-ABEND                                01780000
026300                 DP013-NO-ROLLBACK TO TRUE                        01790000
026400             MOVE '1000-CONTROL-PROCESSING'                       01800000
026500                                   TO  DP013-PARAGRAPH            01810000
026600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   01820000
026700                                   TO  DP013-MESSAGE-TEXT(1)      01830000
026800             MOVE DP020-NEXT-APPL-ACTIVITY                        01840000
026900                                   TO DP013-MESSAGE-TEXT(2)       01850000
027000             PERFORM DP013-0000-PROCESS-ABEND                     01860000
027100     END-EVALUATE.                                                01870000
027200                                                                  01880000
027300     EJECT                                                        01881003
027400                                                                  01882003
027500*----------------------------------------------------------------*01890000
027600* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*01900000
027700* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*01910000
027800* EDITS.                                                         *01920000
027900*----------------------------------------------------------------*01930000
028000                                                                  01931003
028100 2000-FKEY-PROCESSING.                                            01940000
028200                                                                  01950000
028300     EVALUATE TRUE                                                01960000
028400         WHEN DP020-SRC-AID = DP016-CLEAR                         01970000
028500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   01980000
028600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 01990000
028700                                                                  02000000
028800         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02010000
028900             INITIALIZE ASC-SPECIFIC-COMMAREA                     02020000
029000             PERFORM 4000-BUILD-INITIAL-PANEL                     02030000
029100             PERFORM 3200-RESET-ATTRIBUTES                        02040000
029200                                                                  02050000
029300         WHEN OTHER                                               02060000
029400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02070000
029500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02080000
029600             IF  PS-NO-ERROR                                      02090000
029700                 SET DP030-CONTINUE-GO TO TRUE                    02100000
029800                 PERFORM 2100-CHECK-FUNCTION-KEY                  02110000
029900             ELSE                                                 02120000
030000                 SET DP030-OVERRIDE-GO TO TRUE                    02130000
030100             END-IF                                               02140000
030200     END-EVALUATE.                                                02150000
030300                                                                  02160000
030400     EJECT                                                        02161003
030500                                                                  02162003
030600******************************************************************02170000
030700** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **02180000
030800** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **02190000
030900** FROM THE CICS ARCHITECTURE API.                              **02200000
031000******************************************************************02210000
031100                                                                  02211003
031200 2100-CHECK-FUNCTION-KEY.                                         02220000
031300                                                                  02230000
031400     EVALUATE TRUE                                                02240000
031500         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 02250000
031600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 02260000
031700                                                                  02270000
031800         WHEN DP020-SRC-AID = DP016-ENTER                         02280000
031900             CONTINUE                                             02290000
032000                                                                  02300000
032100         WHEN OTHER                                               02310000
032200             SET DP013-NO-ROLLBACK                                02320000
032300                 DP013-XCTL-DISPLAY-RESTART                       02330000
032400                 DP013-CICS-ABEND  TO TRUE                        02340000
032500             MOVE '2100-CHECK-FUNCTION-KEY'                       02350000
032600                                   TO DP013-PARAGRAPH             02360000
032700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      02370000
032800                                   TO DP013-MESSAGE-TEXT (1)      02380000
032900             PERFORM DP013-0000-PROCESS-ABEND                     02390000
033000     END-EVALUATE.                                                02400000
033100                                                                  02410000
033200     EJECT                                                        02411003
033300                                                                  02412003
033400******************************************************************02420000
033500** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **02430000
033600** INTER-APPLICATION COMMAREA.                                  **02440000
033700******************************************************************02450000
033800                                                                  02451003
033900 2110-PREPARE-INTER-APPL-COMM.                                    02460000
034000                                                                  02470000
034100     INITIALIZE VN001-INTER-APPL-COMMAREA.                        02480000
034200                                                                  02470000
034300     MOVE ASC-VENDOR-NAME    TO VN001-VENDOR-NAME.                02490000
034400     MOVE ASC-DEPT-NUMBER    TO VN001-DEPARTMENT-NUMBER.          02500000
034500     MOVE ASC-INHOUSE-NUMBER TO VN001-INHOUSE-NUMBER.             02510000
034600     MOVE ASC-VENDOR-TYPE    TO VN001-VENDOR-TYPE.                02520000
034700     MOVE ASC-DUNS-NUMBER    TO VN001-DUNS-NUMBER.                02530000
034800     MOVE ASC-STATUS-CODE    TO VN001-STATUS-CODE.                02560000
034900                                                                  02570000
035000     EJECT                                                        02571003
035100                                                                  02572003
035200*----------------------------------------------------------------*02580000
035300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*02590000
035400* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *02600000
035500* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *02610000
035600*----------------------------------------------------------------*02620000
035700                                                                  02621003
035800 2200-MOVE-SCREEN-TO-COMMAREA.                                    02630000
035900                                                                  02640000
036000     IF  AVNNAMEL > ZERO                                          02650000
036100         MOVE AVNNAMEI             TO ASC-VENDOR-NAME             02660000
036200     ELSE                                                         02670000
036300         IF  AVNNAMEF = DP015-ERASE-EOF                           02680000
036400             MOVE SPACE            TO ASC-VENDOR-NAME             02690000
036500         END-IF                                                   02700000
036600     END-IF.                                                      02710000
036700                                                                  02720000
036800     IF  ADPTNBRL > ZERO                                          02730000
036900         MOVE ADPTNBRI             TO ASC-DEPT-NUMBER             02740000
037000     ELSE                                                         02750000
037100         IF  ADPTNBRF = DP015-ERASE-EOF                           02760000
037200             MOVE SPACE            TO ASC-DEPT-NUMBER             02770000
037300         END-IF                                                   02780000
037400     END-IF.                                                      02790000
037500                                                                  02800000
037600     IF  AINHOUSL > ZERO                                          02810000
037700         MOVE AINHOUSI             TO ASC-INHOUSE-NUMBER          02820000
037800     ELSE                                                         02830000
037900         IF  AINHOUSF = DP015-ERASE-EOF                           02840000
038000             MOVE SPACE            TO ASC-INHOUSE-NUMBER          02850000
038100         END-IF                                                   02860000
038200     END-IF.                                                      02870000
038300                                                                  02880000
038400     IF  AVNDTYPL > ZERO                                          02890000
038500         MOVE AVNDTYPI             TO ASC-VENDOR-TYPE             02900000
038600     ELSE                                                         02910000
038700         IF  AVNDTYPF = DP015-ERASE-EOF                           02920000
038800             MOVE SPACE            TO ASC-VENDOR-TYPE             02930000
038900         END-IF                                                   02940000
039000     END-IF.                                                      02950000
039100                                                                  02960000
039200     IF  ADUNNBRL > ZERO                                          02970000
039300         MOVE ADUNNBRI             TO ASC-DUNS-NUMBER             02980000
039400     ELSE                                                         02990000
039500         IF  ADUNNBRF = DP015-ERASE-EOF                           03000000
039600             MOVE SPACE            TO ASC-DUNS-NUMBER             03010000
039700         END-IF                                                   03020000
039800     END-IF.                                                      03030000
039900                                                                  03200000
040000     IF  ASTATUSL > ZERO                                          03210000
040100         MOVE ASTATUSI             TO ASC-STATUS-CODE             03220000
040200     ELSE                                                         03230000
040300         IF  ASTATUSF = DP015-ERASE-EOF                           03240000
040400             MOVE SPACE            TO ASC-STATUS-CODE             03250000
040500         END-IF                                                   03260000
040600     END-IF.                                                      03270000
040700                                                                  03280000
040800     EJECT                                                        03281003
040900                                                                  03282003
041000*----------------------------------------------------------------*03290000
041100* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *03300000
041200* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *03310000
041300* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*03320000
041400* IN THE DESTINATION PROGRAM, NOT HERE.                          *03330000
041500*----------------------------------------------------------------*03340000
041600                                                                  03341003
041700 3000-EDIT-DATA-IN-COMMAREA.                                      03350000
041800                                                                  03360000
041900     PERFORM 3200-RESET-ATTRIBUTES.                               03370000
042000                                                                  03380000
042100     IF ASC-STATUS-CODE NOT = 'A' AND                             03390000
042200        ASC-STATUS-CODE NOT = 'I'                                 03400000
042300         SET PS-ERROR                                             03410000
042400             DP020-MSG-FATAL       TO TRUE                        03420000
042500         MOVE PC-TSYMSG-00496      TO DP020-MSG-NUMBER            03430000
042600         MOVE DP015-UNP-ALP-BRT-OFF                               03440000
042700                                   TO ASTATUSA                    03450000
042800         MOVE DP015-RED            TO ASTATUSC                    03460000
042900         MOVE DP015-REVERSE        TO ASTATUSH                    03470000
043000         MOVE -1                   TO ASTATUSL                    03480000
043100         SET DP030-SET-CURSOR-APPL-1                              03490000
043200                                   TO TRUE                        03500000
043300     ELSE                                                         03510000
043400         MOVE ASC-STATUS-CODE  TO ASTATUSO                        03520000
043500     END-IF.                                                      03530000
043600                                                                  03540000
043700                                                                  04020000
043800     IF  ASC-DUNS-NUMBER > SPACES                                 04030000
043900         MOVE ASC-DUNS-NUMBER      TO DP010I-UNEDITED-FIELD       04040000
044000         MOVE LENGTH OF ASC-DUNS-NUMBER                           04050000
044100                                   TO DP010I-MAXIMUM-DIGITS       04060000
044200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04070000
044300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04080000
044310         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
044320                         USING DP010I-NUMERIC-EDIT-AREA                   
044500         IF  DP010I-ERROR-DETECTED                                04100000
044600             SET PS-ERROR                                         04110000
044700                 DP020-MSG-FATAL   TO TRUE                        04120000
044800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            04130000
044900             MOVE DP015-UNP-ALP-BRT-OFF                           04140000
045000                                   TO ADUNNBRA                    04150000
045100             MOVE DP015-RED        TO ADUNNBRC                    04160000
045200             MOVE DP015-REVERSE    TO ADUNNBRH                    04170000
045300             MOVE -1               TO ADUNNBRL                    04180000
045400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04190000
045500         ELSE                                                     04200000
045600             MOVE DP010I-NUMERIC-FIELD                            04210000
045700                                   TO ASC-DUNS-NUMBER-N           04220000
045800             MOVE ASC-DUNS-NUMBER  TO ADUNNBRO                    04230000
045900         END-IF                                                   04240000
046000     END-IF.                                                      04250000
046100                                                                  04260000
046200     IF ASC-VENDOR-TYPE NOT = 'M' AND                             04270000
046300        ASC-VENDOR-TYPE NOT = 'E' AND                             04280000
046400        ASC-VENDOR-TYPE NOT = 'C' AND                             04290002
046500        ASC-VENDOR-TYPE NOT = 'F' AND                             04291002
046600        ASC-VENDOR-TYPE NOT = 'P'                                 04292002
046700         SET PS-ERROR                                             04300000
046800             DP020-MSG-FATAL       TO TRUE                        04310000
046900         MOVE PC-TSYMSG-00829      TO DP020-MSG-NUMBER            04320000
047000         MOVE DP015-UNP-ALP-BRT-OFF                               04330000
047100                                   TO AVNDTYPA                    04340000
047200         MOVE DP015-RED            TO AVNDTYPC                    04350000
047300         MOVE DP015-REVERSE        TO AVNDTYPH                    04360000
047400         MOVE -1                   TO AVNDTYPL                    04370000
047500         SET DP030-SET-CURSOR-APPL-1                              04380000
047600                                   TO TRUE                        04390000
047700     ELSE                                                         04400000
047800         MOVE ASC-VENDOR-TYPE  TO AVNDTYPO                        04410000
047900     END-IF.                                                      04420000
048000                                                                  04430000
048100     IF  ASC-INHOUSE-NUMBER > SPACES                              04440000
048200         MOVE ASC-INHOUSE-NUMBER   TO DP010I-UNEDITED-FIELD       04450000
048300         MOVE LENGTH OF ASC-INHOUSE-NUMBER                        04460000
048400                                   TO DP010I-MAXIMUM-DIGITS       04470000
048500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04480000
048600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04490000
048710         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
048720                         USING DP010I-NUMERIC-EDIT-AREA                   
048800         IF  DP010I-ERROR-DETECTED                                04510000
048900             SET PS-ERROR                                         04520000
049000                 DP020-MSG-FATAL   TO TRUE                        04530000
049100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            04540000
049200             MOVE DP015-UNP-ALP-BRT-OFF                           04550000
049300                                   TO AINHOUSA                    04560000
049400             MOVE DP015-RED        TO AINHOUSC                    04570000
049500             MOVE DP015-REVERSE    TO AINHOUSH                    04580000
049600             MOVE -1               TO AINHOUSL                    04590000
049700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04600000
049800         ELSE                                                     04610000
049900             MOVE DP010I-NUMERIC-FIELD                            04620000
050000                                   TO ASC-INHOUSE-NUMBER-N        04630000
050100             MOVE ASC-INHOUSE-NUMBER                              04640000
050200                                   TO AINHOUSO                    04650000
050300         END-IF                                                   04660000
050400     END-IF.                                                      04670000
050500                                                                  04680000
050600     IF  ASC-DEPT-NUMBER > SPACES                                 04690000
050700         MOVE ASC-DEPT-NUMBER      TO DP010I-UNEDITED-FIELD       04700000
050800         MOVE LENGTH OF ASC-DEPT-NUMBER                           04710000
050900                                   TO DP010I-MAXIMUM-DIGITS       04720000
051000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04730000
051100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04740000
051210         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
051220                         USING DP010I-NUMERIC-EDIT-AREA                   
051300         IF  DP010I-ERROR-DETECTED                                04760000
051400             SET PS-ERROR                                         04770000
051500                 DP020-MSG-FATAL   TO TRUE                        04780000
051600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            04790000
051700             MOVE DP015-UNP-ALP-BRT-OFF                           04800000
051800                                   TO ADPTNBRA                    04810000
051900             MOVE DP015-RED        TO ADPTNBRC                    04820000
052000             MOVE DP015-REVERSE    TO ADPTNBRH                    04830000
052100             MOVE -1               TO ADPTNBRL                    04840000
052200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04850000
052300         ELSE                                                     04860000
052400             MOVE DP010I-NUMERIC-FIELD                            04870000
052500                                   TO ASC-DEPT-NUMBER-N           04880000
052600             MOVE ASC-DEPT-NUMBER  TO ADPTNBRO                    04890000
052700         END-IF                                                   04900000
052800     END-IF.                                                      04910000
052900                                                                  04920000
053000     IF  PS-NO-ERROR                                              04930000
053100         MOVE -1                   TO AVNNAMEL                    04940000
053200         SET DP030-SET-CURSOR-APPL-1                              04950000
053300                                   TO TRUE                        04960000
053400     END-IF.                                                      04970000
053500                                                                  04980000
053600     EJECT                                                        04981003
053700                                                                  04982003
053800******************************************************************04990000
053900** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **05000000
054000** MAP.                                                         **05010000
054100******************************************************************05020000
054200                                                                  05021003
054300 3200-RESET-ATTRIBUTES.                                           05030000
054400                                                                  05040000
054500     MOVE DP015-UNP-ALP-NOR-OFF    TO AVNNAMEA                    05050000
054600                                      ADPTNBRA                    05060000
054700                                      AINHOUSA                    05070000
054800                                      AVNDTYPA                    05080000
054900                                      ADUNNBRA                    05090000
055000                                      ASTATUSA.                   05120000
055100                                                                  05121006
055200     MOVE DP015-GREEN              TO AVNNAMEC                    05130000
055300                                      ADPTNBRC                    05140000
055400                                      AINHOUSC                    05150000
055500                                      AVNDTYPC                    05160000
055600                                      ADUNNBRC                    05170000
055700                                      ASTATUSC.                   05200000
055800                                                                  05201006
055900     MOVE DP015-UNDERLINE          TO AVNNAMEH                    05210000
056000                                      ADPTNBRH                    05220000
056100                                      AINHOUSH                    05230000
056200                                      AVNDTYPH                    05240000
056300                                      ADUNNBRH                    05250000
056400                                      ASTATUSH.                   05280000
056500                                                                  05290000
056600     EJECT                                                        05291003
056700                                                                  05292003
056800*----------------------------------------------------------------*05300000
056900*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *05310000
057000*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *05320000
057100*  IT HERE.                                                      *05330000
057200*----------------------------------------------------------------*05340000
057300                                                                  05341003
057400 4000-BUILD-INITIAL-PANEL.                                        05350000
057500                                                                  05360000
057600     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       05370000
057700     MOVE -1                       TO AVNNAMEL.                   05380000
057800     MOVE 'M'                      TO AVNDTYPO                    05390000
057900                                      ASC-VENDOR-TYPE.            05400000
058000     MOVE 'A'                      TO ASTATUSO                    05410000
058100                                      ASC-STATUS-CODE.            05420000
058200                                                                  05430000
058300     EJECT                                                        05431003
058400                                                                  05432003
058500*----------------------------------------------------------------*05440000
058600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *05450000
058700*----------------------------------------------------------------*05460000
058800                                                                  05461003
058900 4400-MOVE-COMMAREA-TO-SCREEN.                                    05470000
059000                                                                  05480000
059100     MOVE ASC-DEPT-NUMBER          TO ADPTNBRO.                   05490000
059200     MOVE ASC-VENDOR-NAME          TO AVNNAMEO.                   05500000
059300     MOVE ASC-INHOUSE-NUMBER       TO AINHOUSO.                   05510000
059400     MOVE ASC-VENDOR-TYPE          TO AVNDTYPO.                   05520000
059500     MOVE ASC-DUNS-NUMBER          TO ADUNNBRO.                   05530000
059600     MOVE ASC-STATUS-CODE          TO ASTATUSO.                   05560000
059700                                                                  05570000
059800     EJECT                                                        05571003
059900                                                                  05572003
060000*----------------------------------------------------------------*05580000
060100*    ABEND PROCESSOR MODULE                                      *05590000
060200*----------------------------------------------------------------*05600000
060300                                                                  05601003
060400     COPY DPPD013.                                                05610103
060500                                                                  05611003
060600*                                                                 05620003
060700*----------------------------------------------------------------*05630003
