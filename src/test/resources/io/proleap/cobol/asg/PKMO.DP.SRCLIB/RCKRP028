000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.             RCKRP028.                                00040000
000500 AUTHOR.                 JOE LAROSA.                              00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            SEPTEMBER 1999.                          00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM CREATES A DAILY LISTING OF VERIFIED RECEIPTS    * 00100000
001100*  WITH RETAIL PRICE DIFFERENCES.                               * 00110000
001300*  REPORT WILL BREAK ON PO/RECEIVER, PRICE, STORE.              * 00130000
001500***************************************************************** 00150000
001600*  CHANGED 08/28/02 BY S.KALI RAJA                              * 00160000
001700*                                                               * 00170000
002101*  WR# 21361 IN THE PROGRAM, CHANGED THE STRUCTURE OF DL1-SKU-1 * 00210161
002102*            AND CHANGED THE FORMAT OF DETAIL-LINE1-1.SIMILARLY * 00210200
002103*            CHANGED THE FORMAT OF DETAIL-LINE1-2 AND CHANGED   * 00210300
002104*            THE STRUCTURE OF DL1-SKU-2.                        * 00210400
002105*                                                               * 00210500
002106***************************************************************** 00210600
002110*  CHANGED 01/12/00 BY JOE LAROSA                               * 00211000
002120*                                                               * 00212000
002130*   WR# ???? ADDED LOGIC TO INCORPORATE A SECOND INPUT CONTROL  * 00213000
002140*            CARD.  THIS CARD WILL DICTATE THE HEADINGS TO BE   * 00214000
002150*            DISPLAYED ON THE REPORT WHEN IT IS WRITTEN OUT.    * 00215000
002160*                                                               * 00216000
002200***************************************************************** 00220000
002210***************************************************************** 00221000
002220*  CHANGED 09/11/00 BY PATRICK BURKE                            * 00222000
002230*                                                               * 00223000
002240*   WR# ???? ADDED LOGIC TO SELECT DATE FOR REPORT HEADING FROM * 00224000
002250*            TABLE TCOCNTL. REMOVED READ OF SYSIN CONTROL CARD. * 00225000
002270*                                                               * 00227000
002280***************************************************************** 00228000
002300***************************************************************** 00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500***************************************************************** 00250000
002600                                                                  00260000
002700 CONFIGURATION SECTION.                                           00270000
002800                                                                  00280000
002900 SOURCE-COMPUTER.        IBM-3090.                                00290000
003000 OBJECT-COMPUTER.        IBM-3090.                                00300000
003100                                                                  00310000
003200 INPUT-OUTPUT SECTION.                                            00320000
003300                                                                  00330000
003400 FILE-CONTROL.                                                    00340000
003500                                                                  00350000
003600     SELECT PRC-DIFF-EXTRACT-FILE                                 00360000
003700         ASSIGN TO INP01.                                         00370000
003800                                                                  00380000
003900     SELECT SELECT-REPORT-FILE                                    00390000
004000         ASSIGN TO INP02.                                         00400000
004100                                                                  00410000
004200     SELECT DLY-PRC-DIFF-RPT-FILE                                 00420000
004300         ASSIGN TO RPT01.                                         00430000
004400                                                                  00440000
004500***************************************************************** 00450000
004600 DATA DIVISION.                                                   00460000
004700***************************************************************** 00470000
004800 FILE SECTION.                                                    00480000
004900                                                                  00490000
005000 FD  PRC-DIFF-EXTRACT-FILE                                        00500000
005100     RECORDING MODE IS F                                          00510000
005200     LABEL RECORDS ARE STANDARD                                   00520000
005300     BLOCK CONTAINS 0 RECORDS                                     00530000
005400     RECORD CONTAINS 140 CHARACTERS.                              00540000
005500 01  EXTRACT-INPUT-RECORD            PIC  X(140).                 00550000
005600                                                                  00560000
005700 FD  SELECT-REPORT-FILE                                           00570000
005800     RECORDING MODE IS F                                          00580000
005900     LABEL RECORDS ARE STANDARD                                   00590000
006000     BLOCK CONTAINS 0 RECORDS                                     00600000
006100     RECORD CONTAINS 80 CHARACTERS.                               00610000
006200 01  SELECT-REPORT-RECORD            PIC  X(80).                  00620000
006300                                                                  00630000
006400 FD  DLY-PRC-DIFF-RPT-FILE                                        00640000
006500     RECORDING MODE IS F                                          00650000
006600     BLOCK CONTAINS 0  RECORDS.                                   00660000
006700 01  DAILY-RPT-RECORD                PIC  X(132).                 00670000
006800                                                                  00680000
006900***************************************************************** 00690000
007000 WORKING-STORAGE SECTION.                                         00700000
007100                                                                  00710000
008100 01  CC-CONTROL-CARD-INPUT.                                       00810000
008200     05  CC-REPORT-NAME              PIC X(10).                   00820000
008300         88  CC-RCKRP028-1                     VALUE 'RCKRP028-1'.00830000
008400         88  CC-RCKRP028-2                     VALUE 'RCKRP028-2'.00840000
008500     05  FILLER                      PIC X(71) VALUE SPACE.       00850000
008600                                                                  00860000
008700 01  PROGRAM-SWITCHES.                                            00870000
008800     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00880000
008900         88  PS-END-OF-INPUT                   VALUE 'Y'.         00890000
009000         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00900000
009100     05  PS-SIDE-OF-REPORT-SW        PIC X(01) VALUE 'L'.         00910000
009200         88  PS-LOAD-LEFT-SIDE                 VALUE 'L'.         00920000
009300         88  PS-LOAD-RIGHT-SIDE                VALUE 'R'.         00930000
009400     05  PS-REPORT-CC-SW             PIC X(01) VALUE 'N'.         00940000
009500         88  PS-NO-REPORT-CC                   VALUE 'N'.         00950000
009600         88  PS-HAVE-REPORT-CC                 VALUE 'Y'.         00960000
009610     05  PS-COCNTL-FOUND-SW          PIC X(01) VALUE 'N'.         00961000
009620         88  PS-COCNTL-NOT-FOUND               VALUE 'N'.         00962000
009630         88  PS-COCNTL-FOUND                   VALUE 'Y'.         00963000
009700                                                                  00970000
009800 01  BF-BREAK-FIELDS.                                             00980000
009900     05  BF-STORE                    PIC 9(04).                   00990000
010000     05  BF-STORE-RETAIL             PIC S9(7)V99.                01000000
010100     05  BF-PO-RCVR-LN.                                           01010000
010200         10  BF-PO                   PIC 9(08) VALUE ZEROES.      01020000
010300         10  BF-RECEIVER             PIC 9(09) VALUE ZEROES.      01030000
010400         10  BF-LINE                 PIC 9(04) VALUE ZEROES.      01040000
010410     05  BF-SKU-NBR                  PIC X(10) VALUE SPACES.      01041000
010420     05  BF-SKU-STATUS               PIC X(15) VALUE SPACES.      01042000
010430     05  BF-PO-UNIT-RETAIL           PIC S9(07)V99 VALUE ZEROS.   01043000
010500                                                                  01050000
010600 01  PC-PROGRAM-CONSTANTS.                                        01060000
010700     05  PC-RCKRP028                 PIC X(08) VALUE              01070000
010800                                               'RCKRP028'.        01080000
010900     05  PC-REPORT-NBR-1             PIC X(02) VALUE '-1'.        01090000
011000     05  PC-REPORT-NBR-2             PIC X(02) VALUE '-2'.        01100000
011100                                                                  01110000
011200 01  PV-PROGRAM-VARIABLES.                                        01120000
011300     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       01130000
011400     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01140000
011500                                                   COMP-3.        01150000
011600     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01160000
011700                                                   COMP-3.        01170000
011800     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +63          01180000
011900                                                   COMP-3.        01190000
012000     05  PV-ACCUM-RTL-QTY            PIC S9(7) VALUE ZEROES.      01200000
012100     05  PV-ACCUM-LNE-QTY            PIC S9(7) VALUE ZEROES.      01210000
012110     05  PV-ABEND-PARAGRAPH          PIC X(30) VALUE SPACE.       01211000
012120     05  PV-ABEND-CODE               PIC S9(04) VALUE ZERO        01212000
012130                                                 COMP SYNC.       01213000
012200                                                                  01220000
012300     05  PV-TODAYS-DATE.                                          01230000
012400         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01240000
012500         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01250000
012600         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01260000
012700     05  PV-TODAYS-DATE-YYYY.                                     01270000
012800         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          01280000
012900         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        01290000
013000     05  PV-TODAYS-TIME.                                          01300000
013100         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01310000
013200         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01320000
013300         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01330000
013400         10  FILLER                  PIC 9(02) VALUE ZERO.        01340000
013500                                                                  01350000
013510     05  PV-FRMT-DTE.                                             01351000
013520         10  PV-FRMT-CY              PIC 9(04) VALUE ZERO.        01352000
013521         10  FILLER                  PIC X(01) VALUE '-'.         01352100
013530         10  PV-FRMT-MM              PIC 9(02) VALUE ZERO.        01353000
013531         10  FILLER                  PIC X(01) VALUE '-'.         01353100
013540         10  PV-FRMT-DD              PIC 9(02) VALUE ZERO.        01354000
013550*                                                                 01355000
013600******************************************************************01360000
013700*  COPY BOOK FOR EXTRACT INPUT RECORD.                            01370000
013800******************************************************************01380000
013900     COPY RCRD048.                                                01390000
014000                                                                  01400000
014001***************************************************************** 01400100
014002*    TCOCNTL TABLE                                                01400200
014003***************************************************************** 01400300
014004     EXEC SQL                                                     01400400
014005          INCLUDE TCOCNTL                                         01400500
014006     END-EXEC.                                                    01400600
014010*                                                                 01401000
014011***************************************************************** 01401100
014012*  DB2 COMMUNICATION AREA                                         01401200
014013***************************************************************** 01401300
014014     EXEC SQL                                                     01401400
014015         INCLUDE SQLCA                                            01401500
014016     END-EXEC.                                                    01401600
014017                                                                  01401700
014018***************************************************************** 01401800
014019*  DB2 COMMUNICATION AREA2                                        01401900
014020***************************************************************** 01402000
014021     COPY  SQLCA2.                                                01402100
014022*                                                                 01402200
014100******************************************************************01410000
014200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01420000
014300******************************************************************01430000
014400     COPY DPWS132.                                                01440000
014500                                                                  01450000
014600 01  HEADING-LINES.                                               01460000
014700     05  HEADING-LINE-1-1.                                        01470000
014800         10  FILLER                  PIC  X(02)    VALUE SPACES.  01480000
014900         10  FILLER                  PIC  X(24)    VALUE SPACES.  01490000
015000         10  FILLER                  PIC  X(47)    VALUE          01500000
015100             'DAILY LISTING OF VERIFIED RECEIPTS WITH RETAIL '.   01510000
015200         10  FILLER                  PIC  X(22)    VALUE          01520000
015300             'PRICE DIFFERENCES FOR '.                            01530000
015400         10  HL1-RPT-DATE-1.                                      01540000
015500             15  HL1-DATE-MM-1       PIC  X(02)    VALUE SPACES.  01550000
015600             15  FILLER              PIC  X(01)    VALUE '/'.     01560000
015700             15  HL1-DATE-DD-1       PIC  X(02)    VALUE SPACES.  01570000
015800             15  FILLER              PIC  X(01)    VALUE '/'.     01580000
015900             15  HL1-DATE-CY-1       PIC  X(04)    VALUE SPACES.  01590000
016100         10  FILLER                  PIC  X(27)    VALUE SPACES.  01610000
016200                                                                  01620000
016300     05  HEADING-LINE-1-2.                                        01630000
016400         10  FILLER                  PIC  X(02)    VALUE SPACES.  01640000
016500         10  FILLER                  PIC  X(19)    VALUE SPACES.  01650000
016600         10  FILLER                  PIC  X(45)    VALUE          01660000
016700             'DAILY LISTING OF CENTRAL STOCK DISTRIBUTIONS '.     01670000
016800         10  FILLER                  PIC  X(34)    VALUE          01680000
016900             'WITH RETAIL PRICE DIFFERENCES FOR '.                01690000
017000         10  HL1-RPT-DATE-2.                                      01700000
017100             15  HL1-DATE-MM-2       PIC  X(02)    VALUE SPACES.  01710000
017200             15  FILLER              PIC  X(01)    VALUE '/'.     01720000
017300             15  HL1-DATE-DD-2       PIC  X(02)    VALUE SPACES.  01730000
017400             15  FILLER              PIC  X(01)    VALUE '/'.     01740000
017500             15  HL1-DATE-CY-2       PIC  X(04)    VALUE SPACES.  01750000
017700         10  FILLER                  PIC  X(22)    VALUE SPACES.  01770000
017800                                                                  01780000
017810*----------------------------------------------------------------*01781000
017820*                                            ** WR # 21361.      *01782060
017830* CHANGED THE FORMAT OF HEADING-LINE-2-1,HEADING-LINE-2-2,       *01783000
017831* HEADING-LINE-3-1 AND HEADING-LINE-3-2.                         *01783100
017850*----------------------------------------------------------------*01785000
017900     05  HEADING-LINE-2-1.                                        01790000
018000         10  FILLER                  PIC  X(02)    VALUE SPACES.  01800000
018100         10  FILLER                  PIC  X(12)    VALUE SPACES.  01810000
018200         10  FILLER                  PIC  X(04)    VALUE SPACES.  01820000
018300         10  FILLER                  PIC  X(04)    VALUE SPACES.  01830000
018400         10  FILLER                  PIC  X(04)    VALUE SPACES.  01840000
018500         10  FILLER                  PIC  X(10)    VALUE SPACES.  01850000
018700         10  FILLER                  PIC  X(04)    VALUE SPACES.  01870000
018800         10  FILLER                  PIC  X(15)    VALUE SPACES.  01880000
018900         10  FILLER                  PIC  X(04)    VALUE SPACES.  01890000
019000         10  FILLER                  PIC  X(09)    VALUE          01900000
019100                                                    '    PO   '.  01910000
019200         10  FILLER                  PIC  X(64)    VALUE SPACES.  01920000
019300                                                                  01930000
019400     05  HEADING-LINE-2-2.                                        01940000
019500         10  FILLER                  PIC  X(02)    VALUE SPACES.  01950000
019600         10  FILLER                  PIC  X(12)    VALUE SPACES.  01960000
019700         10  FILLER                  PIC  X(04)    VALUE SPACES.  01970000
019800         10  FILLER                  PIC  X(04)    VALUE SPACES.  01980000
019900         10  FILLER                  PIC  X(04)    VALUE SPACES.  01990000
020000         10  FILLER                  PIC  X(10)    VALUE SPACES.  02000000
020200         10  FILLER                  PIC  X(04)    VALUE SPACES.  02020000
020300         10  FILLER                  PIC  X(15)    VALUE SPACES.  02030000
020400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02040000
020500         10  FILLER                  PIC  X(09)    VALUE          02050000
020600                                                    '   PULL  '.  02060000
020700         10  FILLER                  PIC  X(64)    VALUE SPACES.  02070000
020800                                                                  02080000
020900     05  HEADING-LINE-3-1.                                        02090000
021000         10  FILLER                  PIC  X(02)    VALUE SPACES.  02100000
021100         10  FILLER                  PIC  X(12)    VALUE          02110000
021200                                                 'PO/RECEIVER '.  02120000
021300         10  FILLER                  PIC  X(04)    VALUE SPACES.  02130000
021400         10  FILLER                  PIC  X(04)    VALUE 'LINE'.  02140000
021500         10  FILLER                  PIC  X(01)    VALUE SPACE.   02150000
021600         10  FILLER                  PIC  X(16)    VALUE          02160000
021700                                          'DPT CL   SKU    '.     02170000
021800         10  FILLER                  PIC  X(01)    VALUE SPACE.   02180000
021900         10  FILLER                  PIC  X(15)    VALUE          02190000
022000                                              'SKU STATUS     '.  02200000
022100         10  FILLER                  PIC  X(04)    VALUE SPACES.  02210000
022200         10  FILLER                  PIC  X(09)    VALUE          02220000
022300                                                    '  RETAIL '.  02230000
022400         10  FILLER                  PIC  X(64)    VALUE SPACES.  02240000
022500                                                                  02250000
022600     05  HEADING-LINE-3-2.                                        02260000
022700         10  FILLER                  PIC  X(02)    VALUE SPACES.  02270000
022800         10  FILLER                  PIC  X(12)    VALUE          02280000
022900                                                 'PULL NUMBER '.  02290000
023000         10  FILLER                  PIC  X(04)    VALUE SPACES.  02300000
023100         10  FILLER                  PIC  X(04)    VALUE 'LINE'.  02310000
023110         10  FILLER                  PIC  X(01)    VALUE SPACE.   02311000
023120         10  FILLER                  PIC  X(16)    VALUE          02312000
023130                                          'DPT CL   SKU    '.     02313000
023140         10  FILLER                  PIC  X(01)    VALUE SPACE.   02314000
023600         10  FILLER                  PIC  X(15)    VALUE          02360000
023700                                              'SKU STATUS     '.  02370000
023800         10  FILLER                  PIC  X(04)    VALUE SPACES.  02380000
023900         10  FILLER                  PIC  X(09)    VALUE          02390000
024000                                                    '  RETAIL '.  02400000
024100         10  FILLER                  PIC  X(64)    VALUE SPACES.  02410000
024110*----------------------------------------------------------------*02411000
024120* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02412060
024130*----------------------------------------------------------------*02413000
024200                                                                  02420000
024300     05  HEADING-LINE-4.                                          02430000
024400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02440000
024500         10  FILLER                  PIC  X(07)    VALUE SPACES.  02450000
024600         10  FILLER                  PIC  X(09)    VALUE          02460000
024700                                                    '  CURRENT'.  02470000
024800         10  FILLER                  PIC  X(03)    VALUE SPACES.  02480000
024900         10  FILLER                  PIC  X(06)    VALUE          02490000
025000                                                       ' STORE'.  02500000
025100         10  FILLER                  PIC  X(03)    VALUE SPACES.  02510000
025200         10  FILLER                  PIC  X(08)    VALUE          02520000
025300                                                     'QUANTITY'.  02530000
025400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02540000
025500         10  FILLER                  PIC  X(15)    VALUE SPACES.  02550000
025600         10  FILLER                  PIC  X(19)    VALUE SPACES.  02560000
025700         10  FILLER                  PIC  X(09)    VALUE          02570000
025800                                                    '  CURRENT'.  02580000
025900         10  FILLER                  PIC  X(03)    VALUE SPACES.  02590000
026000         10  FILLER                  PIC  X(06)    VALUE          02600000
026100                                                       ' STORE'.  02610000
026200         10  FILLER                  PIC  X(03)    VALUE SPACES.  02620000
026300         10  FILLER                  PIC  X(08)    VALUE          02630000
026400                                                     'QUANTITY'.  02640000
026500         10  FILLER                  PIC  X(03)    VALUE SPACES.  02650000
026600         10  FILLER                  PIC  X(15)    VALUE SPACES.  02660000
026700         10  FILLER                  PIC  X(10)    VALUE SPACES.  02670000
026800                                                                  02680000
026900     05  HEADING-LINE-5.                                          02690000
027000         10  FILLER                  PIC  X(02)    VALUE SPACES.  02700000
027100         10  FILLER                  PIC  X(07)    VALUE SPACES.  02710000
027200         10  FILLER                  PIC  X(09)    VALUE          02720000
027300                                                    '  RETAIL '.  02730000
027400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02740000
027500         10  FILLER                  PIC  X(06)    VALUE          02750000
027600                                                       'NUMBER'.  02760000
027700         10  FILLER                  PIC  X(03)    VALUE SPACES.  02770000
027800         10  FILLER                  PIC  X(08)    VALUE          02780000
027900                                                     'VERIFIED'.  02790000
028000         10  FILLER                  PIC  X(03)    VALUE SPACES.  02800000
028100         10  FILLER                  PIC  X(15)    VALUE          02810000
028200                                              'RETAIL STATUS  '.  02820000
028300         10  FILLER                  PIC  X(19)    VALUE SPACES.  02830000
028400         10  FILLER                  PIC  X(09)    VALUE          02840000
028500                                                    '  RETAIL '.  02850000
028600         10  FILLER                  PIC  X(03)    VALUE SPACES.  02860000
028700         10  FILLER                  PIC  X(06)    VALUE          02870000
028800                                                       'NUMBER'.  02880000
028900         10  FILLER                  PIC  X(03)    VALUE SPACES.  02890000
029000         10  FILLER                  PIC  X(08)    VALUE          02900000
029100                                                     'VERIFIED'.  02910000
029200         10  FILLER                  PIC  X(03)    VALUE SPACES.  02920000
029300         10  FILLER                  PIC  X(15)    VALUE          02930000
029400                                              'RETAIL STATUS  '.  02940000
029500         10  FILLER                  PIC  X(10)    VALUE SPACES.  02950000
029600                                                                  02960000
029700 01  DETAIL-LINES.                                                02970000
029710*----------------------------------------------------------------*02971000
029711*                                              ** WR # 21361     *02971160
029713* CHANGED THE FORMAT OF DETAIL-LINE1-1 AND CHANGED THE STRUCTURE *02971300
029714* OF DL1-SKU-1.                                                  *02971400
029715* CHANGED THE FORMAT OF DETAIL-LINE1-2 AND CHANGED THE STRUCTURE *02971500
029716* OF DL1-SKU-2.                                                  *02971600
029720*----------------------------------------------------------------*02972000
029800     05  DETAIL-LINE1-1.                                          02980000
029900         10  FILLER                  PIC  X(02)    VALUE SPACES.  02990000
030000         10  DL1-PO-1                PIC  9(08).                  03000000
030100         10  FILLER                  PIC  X(01)    VALUE '-'.     03010000
030200         10  DL1-REC-1               PIC  9(03).                  03020000
030300         10  FILLER                  PIC  X(04)    VALUE SPACES.  03030000
030400         10  DL1-LINE-1              PIC  9(04).                  03040000
030500         10  FILLER                  PIC  X(01)    VALUE SPACE.   03050000
030610         10  DL1-SKU-1.                                           03061000
030620             15 DL1-DEPT-1           PIC  X(03).                  03062000
030630             15 FILLER               PIC  X(01)    VALUE SPACE.   03063000
030640             15 DL1-CLASS-1          PIC  X(02).                  03064000
030650             15 FILLER               PIC  X(01)    VALUE SPACE.   03065000
030660             15 DL1-SKU-NBR-1        PIC  X(08).                  03066000
030700         10  FILLER                  PIC  X(02)    VALUE SPACES.  03070000
030800         10  DL1-SKU-STS-1           PIC  X(15).                  03080000
030900         10  FILLER                  PIC  X(04)    VALUE SPACES.  03090000
031000         10  DL1-PO-RETAIL-1         PIC  ZZ,ZZZ.99.              03100000
031100         10  FILLER                  PIC  X(64)    VALUE SPACES.  03110000
031200                                                                  03120000
031300     05  DETAIL-LINE1-2.                                          03130000
031400         10  FILLER                  PIC  X(03)    VALUE SPACES.  03140000
031500         10  DL1-PO-2                PIC  9(08).                  03150000
031600         10  FILLER                  PIC  X(03)    VALUE SPACES.  03160000
031700         10  FILLER                  PIC  X(04)    VALUE SPACES.  03170000
031800         10  DL1-LINE-2              PIC  9(04).                  03180000
031900         10  FILLER                  PIC  X(01)    VALUE SPACE.   03190000
032010         10  DL1-SKU-2.                                           03201000
032020             15 DL1-DEPT-2           PIC  X(03).                  03202000
032030             15 FILLER               PIC  X(01)   VALUE SPACE.    03203000
032040             15 DL1-CLASS-2          PIC  X(02).                  03204000
032050             15 FILLER               PIC  X(01)   VALUE SPACE.    03205000
032060             15 DL1-SKU-NBR-2        PIC  X(08).                  03206000
032100         10  FILLER                  PIC  X(02)    VALUE SPACES.  03210000
032200         10  DL1-SKU-STS-2           PIC  X(15).                  03220000
032300         10  FILLER                  PIC  X(04)    VALUE SPACES.  03230000
032400         10  DL1-PO-RETAIL-2         PIC  ZZ,ZZZ.99.              03240000
032500         10  FILLER                  PIC  X(64)    VALUE SPACES.  03250000
032510*----------------------------------------------------------------*03251000
032520* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *03252060
032530*----------------------------------------------------------------*03253000
032600                                                                  03260000
032700     05  DETAIL-LINE2.                                            03270000
032800         10  FILLER                  PIC  X(09)    VALUE SPACES.  03280000
032900         10  DL2-CURR-RETAIL1        PIC  ZZ,ZZZ.99.              03290000
033000         10  FILLER                  PIC  X(04)    VALUE SPACES.  03300000
033100         10  DL2-STORE-NBR1          PIC  X(04).                  03310000
033200         10  FILLER                  PIC  X(04)    VALUE SPACES.  03320000
033300         10  DL2-QTY1                PIC  ZZZ,ZZ9-.               03330000
033400         10  FILLER                  PIC  X(03)    VALUE SPACES.  03340000
033500         10  DL2-RETAIL-STS1         PIC  X(15).                  03350000
033600         10  FILLER                  PIC  X(19)    VALUE SPACES.  03360000
033700         10  DL2-CURR-RETAIL2-X      PIC  X(09).                  03370000
033800         10  FILLER REDEFINES DL2-CURR-RETAIL2-X.                 03380000
033900             15  DL2-CURR-RETAIL2    PIC  ZZ,ZZZ.99.              03390000
034000         10  FILLER                  PIC  X(04)    VALUE SPACES.  03400000
034100         10  DL2-STORE-NBR2          PIC  X(04).                  03410000
034200         10  FILLER                  PIC  X(04)    VALUE SPACES.  03420000
034300         10  DL2-QTY2                PIC  ZZZ,ZZZ-.               03430000
034400         10  FILLER                  PIC  X(03)    VALUE SPACES.  03440000
034500         10  DL2-RETAIL-STS2         PIC  X(15).                  03450000
034600         10  FILLER                  PIC  X(10)    VALUE SPACES.  03460000
034700                                                                  03470000
034800 01  TOTAL-LINES.                                                 03480000
034900     05  TOTAL-LINE1.                                             03490000
035000         10  FILLER                  PIC  X(06)    VALUE SPACES.  03500000
035100         10  FILLER                  PIC  X(24)    VALUE          03510000
035200             'RETAIL GROUP TOTAL QTY  '.                          03520000
035300         10  TL1-QTY                 PIC  ZZZ,ZZ9-.               03530000
035400         10  FILLER                  PIC  X(94)    VALUE SPACES.  03540000
035500                                                                  03550000
035600     05  TOTAL-LINE2.                                             03560000
035700         10  FILLER                  PIC  X(06)    VALUE SPACES.  03570000
035800         10  FILLER                  PIC  X(24)    VALUE          03580000
035900             'LINE TOTAL QTY          '.                          03590000
036000         10  TL2-QTY                 PIC  ZZZ,ZZ9-.               03600000
036100         10  FILLER                  PIC  X(94)    VALUE SPACES.  03610000
036200                                                                  03620000
036300 01  MISCELLANEOUS-LINES.                                         03630000
036400     05  BLANK-LINE.                                              03640000
036500         10  FILLER                  PIC  X(132)   VALUE SPACES.  03650000
036600     05  NO-DATA-LINE.                                            03660000
036700         10  FILLER                  PIC  X(42)    VALUE SPACES.  03670000
036800         10  FILLER                  PIC  X(47)    VALUE          03680000
036900             '**** NO INFORMATION EXISTS FOR THIS REPORT ****'.   03690000
037000         10  FILLER                  PIC  X(43)    VALUE SPACES.  03700000
037100     05  END-OF-REPORT-LINE.                                      03710000
037200         10  FILLER                  PIC  X(44)    VALUE          03720000
037300             '  ** END OF REPORT **                       '.      03730000
037400         10  FILLER                  PIC  X(44)    VALUE SPACES.  03740000
037500         10  FILLER                  PIC  X(44)    VALUE SPACES.  03750000
037600                                                                  03760000
037700/*****************************************************************03770000
037800******************************************************************03780000
037900 PROCEDURE DIVISION.                                              03790000
038000                                                                  03800000
038100******************************************************************03810000
038200**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03820000
038300******************************************************************03830000
038400 0000-MAINLINE-PROCESSING.                                        03840000
038500                                                                  03850000
038600     DISPLAY '**************************************'.            03860000
038700     DISPLAY '*        PROGRAM - RCKRP028          *'.            03870000
038800     DISPLAY '**************************************'.            03880000
038900     DISPLAY ' '.                                                 03890000
039000                                                                  03900000
039100*OPEN FILES.                                                      03910000
039200     OPEN INPUT  PRC-DIFF-EXTRACT-FILE                            03920000
039300                 SELECT-REPORT-FILE                               03930000
039400          OUTPUT DLY-PRC-DIFF-RPT-FILE.                           03940000
039500                                                                  03950000
039600*PREPARE REPORT.                                                  03960000
039700     PERFORM 1000-INITIALIZATION.                                 03970000
039800                                                                  03980000
039900*READ FIRST RECORD.                                               03990000
040000     SET PS-NOT-END-OF-INPUT TO TRUE.                             04000000
040100     READ PRC-DIFF-EXTRACT-FILE                                   04010000
040200       INTO RC048-PRICE-DIFFERENCES                               04020000
040300         AT END                                                   04030000
040400           SET PS-END-OF-INPUT TO TRUE.                           04040000
040500                                                                  04050000
040600*PROCESS INPUT FILE.                                              04060000
040700     IF PS-END-OF-INPUT                                           04070000
040800         WRITE DAILY-RPT-RECORD                                   04080000
040900           FROM NO-DATA-LINE                                      04090000
041000             AFTER ADVANCING 2 LINES                              04100000
041100     ELSE                                                         04110000
041200         INITIALIZE BF-BREAK-FIELDS                               04120000
041300         INITIALIZE DETAIL-LINE2                                  04130000
041400         SET PS-LOAD-LEFT-SIDE TO TRUE                            04140000
041500                                                                  04150000
041600         PERFORM 2000-PROCESS-INPUT                               04160000
041700             UNTIL PS-END-OF-INPUT                                04170000
041800                                                                  04180000
041900         IF PS-LOAD-RIGHT-SIDE                                    04190000
042000             WRITE DAILY-RPT-RECORD                               04200000
042100               FROM DETAIL-LINE2                                  04210000
042200                 AFTER ADVANCING 1 LINE                           04220000
042300         END-IF                                                   04230000
042400                                                                  04240000
042500         ADD +3 TO PV-LINE-COUNT                                  04250000
042600*        IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                     04260000
042700*            PERFORM 1500-PAGE-BREAK                              04270000
042800*            ADD +3 TO PV-LINE-COUNT                              04280000
042900*        END-IF                                                   04290000
043000                                                                  04300000
043100         MOVE PV-ACCUM-RTL-QTY TO TL1-QTY                         04310000
043200         WRITE DAILY-RPT-RECORD                                   04320000
043300           FROM TOTAL-LINE1                                       04330000
043400             AFTER ADVANCING 2 LINES                              04340000
043500                                                                  04350000
043600         MOVE PV-ACCUM-LNE-QTY TO TL2-QTY                         04360000
043700         WRITE DAILY-RPT-RECORD                                   04370000
043800           FROM TOTAL-LINE2                                       04380000
043900             AFTER ADVANCING 1 LINE                               04390000
044000     END-IF.                                                      04400000
044100                                                                  04410000
044200*FINISH REPORT.                                                   04420000
044300     WRITE DAILY-RPT-RECORD                                       04430000
044400       FROM END-OF-REPORT-LINE                                    04440000
044500         AFTER ADVANCING 2 LINES.                                 04450000
044600                                                                  04460000
044700*CLOSE FILES.                                                     04470000
044800     CLOSE PRC-DIFF-EXTRACT-FILE                                  04480000
044900           SELECT-REPORT-FILE                                     04490000
045000           DLY-PRC-DIFF-RPT-FILE.                                 04500000
045100                                                                  04510000
045200     GOBACK.                                                      04520000
045300                                                                  04530000
045400******************************************************************04540000
045500**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04550000
045600******************************************************************04560000
045700 1000-INITIALIZATION.                                             04570000
045800                                                                  04580000
045900     SET PS-HAVE-REPORT-CC TO TRUE.                               04590000
046000     READ SELECT-REPORT-FILE                                      04600000
046100       INTO CC-CONTROL-CARD-INPUT                                 04610000
046200         AT END                                                   04620000
046300           SET PS-NO-REPORT-CC TO TRUE.                           04630000
046400                                                                  04640000
046500     IF PS-NO-REPORT-CC                                           04650000
046600         DISPLAY '  *** ERROR *** ERROR *** ERROR ***'            04660000
046700         DISPLAY '  ** REPORT CONTROL CARD NOT FOUND'             04670000
046800         DISPLAY ' '                                              04680000
046900     ELSE                                                         04690000
047000         DISPLAY '  REPORT ID CONTROL CARD FOR THIS RUN IS: '     04700000
047100                 CC-CONTROL-CARD-INPUT                            04710000
047200     END-IF.                                                      04720000
047300                                                                  04730000
047400     ACCEPT PV-TODAYS-DATE   FROM DATE.                           04740000
047500     ACCEPT PV-TODAYS-TIME   FROM TIME.                           04750000
047600                                                                  04760000
047700     MOVE PV-TODAYS-DATE-MM    TO DP132-RUN-MONTH.                04770000
047800     MOVE PV-TODAYS-DATE-DD    TO DP132-RUN-DAY.                  04780000
047900     MOVE PV-TODAYS-DATE-YY    TO PV-TODAYS-DATE-Y2.              04790000
048000     MOVE PV-TODAYS-DATE-YYYY  TO DP132-RUN-YEAR.                 04800000
048100                                                                  04810000
048200     MOVE PV-TODAYS-TIME-HH    TO DP132-RUN-HOUR.                 04820000
048300     MOVE PV-TODAYS-TIME-MM    TO DP132-RUN-MINUTE.               04830000
048400                                                                  04840000
048500     MOVE PC-RCKRP028          TO DP132-PROGRAM-NAME.             04850000
048600     IF CC-RCKRP028-1                                             04860000
048700         MOVE PC-REPORT-NBR-1  TO DP132-REPORT-NUMBER             04870000
048800     ELSE                                                         04880000
048900         IF CC-RCKRP028-2                                         04890000
049000             MOVE PC-REPORT-NBR-2 TO DP132-REPORT-NUMBER          04900000
049100         END-IF                                                   04910000
049200     END-IF.                                                      04920000
049300                                                                  04930000
049400     MOVE +0 TO PV-PAGE-COUNT.                                    04940000
049500                                                                  04950000
049900     PERFORM 7000-SELECT-TCOCNTL.                                 04990000
050000     MOVE COCNTL-BTCH-PRC-DTE TO PV-FRMT-DTE.                     05000000
050010     MOVE PV-FRMT-MM TO HL1-DATE-MM-1                             05001000
050100                        HL1-DATE-MM-2.                            05010000
050200     MOVE PV-FRMT-DD TO HL1-DATE-DD-1                             05020000
050300                        HL1-DATE-DD-2.                            05030000
050400     MOVE PV-FRMT-CY TO HL1-DATE-CY-1                             05040000
050500                        HL1-DATE-CY-2.                            05050000
051300                                                                  05130000
051310     DISPLAY ' **** PV-FRMT-DTE = ' PV-FRMT-DTE.                  05131000
051320                                                                  05132000
051400     MOVE ZEROES     TO PV-ACCUM-RTL-QTY                          05140000
051500                        PV-ACCUM-LNE-QTY.                         05150000
051600                                                                  05160000
051700     PERFORM 1500-PAGE-BREAK.                                     05170000
051800                                                                  05180000
051900******************************************************************05190000
052000**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  05200000
052100**  PAGES (AS NEEDED).                                            05210000
052200******************************************************************05220000
052300 1500-PAGE-BREAK.                                                 05230000
052400                                                                  05240000
052500     ADD +1                  TO PV-PAGE-COUNT.                    05250000
052600     MOVE PV-PAGE-COUNT      TO DP132-PAGE-NUMBER.                05260000
052700                                                                  05270000
052800     WRITE DAILY-RPT-RECORD                                       05280000
052900       FROM DP132-STANDRD-HEADER-132-COLS                         05290000
053000         AFTER ADVANCING PAGE.                                    05300000
053100                                                                  05310000
053200     IF CC-RCKRP028-1                                             05320000
053300         WRITE DAILY-RPT-RECORD                                   05330000
053400           FROM HEADING-LINE-1-1                                  05340000
053500             AFTER ADVANCING 2 LINES                              05350000
053600                                                                  05360000
053700         WRITE DAILY-RPT-RECORD                                   05370000
053800           FROM HEADING-LINE-2-1                                  05380000
053900             AFTER ADVANCING 2 LINES                              05390000
054000                                                                  05400000
054100         WRITE DAILY-RPT-RECORD                                   05410000
054200           FROM HEADING-LINE-3-1                                  05420000
054300             AFTER ADVANCING 1 LINE                               05430000
054400     END-IF.                                                      05440000
054500     IF CC-RCKRP028-2                                             05450000
054600         WRITE DAILY-RPT-RECORD                                   05460000
054700           FROM HEADING-LINE-1-2                                  05470000
054800             AFTER ADVANCING 2 LINES                              05480000
054900                                                                  05490000
055000         WRITE DAILY-RPT-RECORD                                   05500000
055100           FROM HEADING-LINE-2-2                                  05510000
055200             AFTER ADVANCING 2 LINES                              05520000
055300                                                                  05530000
055400         WRITE DAILY-RPT-RECORD                                   05540000
055500           FROM HEADING-LINE-3-2                                  05550000
055600             AFTER ADVANCING 1 LINE                               05560000
055700     END-IF.                                                      05570000
055800                                                                  05580000
055900     MOVE +8   TO PV-LINE-COUNT.                                  05590000
056000                                                                  05600000
056100******************************************************************05610000
056200**  READ PRICE DIFFERENCES EXTRACT FILE.  WHEN STORE, STORE PRICE,05620000
056300**  OR PO/RECEIVER/LINE CHANGE, PRINT A DETAIL LINE.              05630000
056400******************************************************************05640000
056500 2000-PROCESS-INPUT.                                              05650000
056600                                                                  05660000
056700     IF (RC048-PO            NOT = BF-PO)                         05670000
056800       OR (RC048-REC-SEQ-NBR NOT = BF-RECEIVER)                   05680000
056900       OR (RC048-POLINENO    NOT = BF-LINE)                       05690000
057000***      DISPLAY ' ** RC048 FIELDS = '                            05700000
057100***          RC048-PO '/' RC048-REC-SEQ-NBR '/' RC048-POLINENO    05710000
057200***      DISPLAY ' ** SAVED FIELDS = '                            05720000
057300***          PF-PO '/' BF-RECEIVER '/' BF-LINE                    05730000
057400         PERFORM 2100-PRINT-BREAK-1                               05740000
057500         MOVE RC048-PO                TO BF-PO                    05750000
057600         MOVE RC048-REC-SEQ-NBR       TO BF-RECEIVER              05760000
057700         MOVE RC048-POLINENO          TO BF-LINE                  05770000
057800         MOVE RC048-STORE-UNIT-RETAIL TO BF-STORE-RETAIL          05780000
057900         MOVE RC048-STORE             TO BF-STORE                 05790000
058000         MOVE ZEROES                  TO PV-ACCUM-LNE-QTY         05800000
058100         MOVE ZEROES                  TO PV-ACCUM-RTL-QTY         05810000
058200         PERFORM 2150-LOAD-LEFT-SIDE                              05820000
058300     ELSE                                                         05830000
058400         IF (RC048-STORE-UNIT-RETAIL NOT = BF-STORE-RETAIL)       05840000
058500             PERFORM 2200-PRINT-BREAK-2                           05850000
058600             MOVE RC048-STORE-UNIT-RETAIL TO BF-STORE-RETAIL      05860000
058700             MOVE RC048-STORE             TO BF-STORE             05870000
058800             MOVE ZEROES                  TO PV-ACCUM-RTL-QTY     05880000
058900             PERFORM 2150-LOAD-LEFT-SIDE                          05890000
059000         ELSE                                                     05900000
059100             IF (RC048-STORE NOT = BF-STORE)                      05910000
059200                 MOVE RC048-STORE TO BF-STORE                     05920000
059300                 IF PS-LOAD-RIGHT-SIDE                            05930000
059400                     PERFORM 2160-LOAD-RIGHT-SIDE                 05940000
059500                     PERFORM 2300-PRINT-BREAK-3                   05950000
059600                 ELSE                                             05960000
059700                     PERFORM 2150-LOAD-LEFT-SIDE                  05970000
059800                 END-IF                                           05980000
059900             ELSE                                                 05990000
060000                 DISPLAY '*** UNWRITTEN RECORD = '                06000000
060100                          RC048-PRICE-DIFFERENCES                 06010000
060200             END-IF                                               06020000
060300         END-IF                                                   06030000
060400     END-IF.                                                      06040000
060500                                                                  06050000
060600     PERFORM 3000-READ-EXTRACT-FILE.                              06060000
060700                                                                  06070000
060800******************************************************************06080000
060900**  PRINT MAIN DETAIL LINE W/ ALL INFORMATION (MAJOR PRINT BREAK).06090000
061000******************************************************************06100000
061100 2100-PRINT-BREAK-1.                                              06110000
061200                                                                  06120000
061300*PRINT DETAIL LINE.                                               06130000
061400     PERFORM 2110-CHECK-PRINT-DETAIL.                             06140000
061500                                                                  06150000
061600*PRINT QUANTITY ACCUMULATED LINES.                                06160000
061700     PERFORM 2120-PRINT-BREAK-LINES.                              06170000
061800                                                                  06180000
061900*PRINT DETAIL LINE.                                               06190000
062000     PERFORM 2130-PRINT-DETAIL-LINE.                              06200000
062100                                                                  06210000
062200*PRINT SUB-HEADING LINES.                                         06220000
062300     PERFORM 2140-PRINT-SUB-HEADINGS.                             06230000
062400                                                                  06240000
062500******************************************************************06250000
062600 2110-CHECK-PRINT-DETAIL.                                         06260000
062700                                                                  06270000
062800     IF PS-LOAD-RIGHT-SIDE                                        06280000
062810         WRITE DAILY-RPT-RECORD                                   06281000
062820               FROM DETAIL-LINE2                                  06282000
062900         ADD +1 TO PV-LINE-COUNT                                  06290000
063000         IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                     06300000
063100             PERFORM 1500-PAGE-BREAK                              06310000
063101             WRITE DAILY-RPT-RECORD                               06310100
063102               FROM DETAIL-LINE1-1                                06310200
063103                 AFTER ADVANCING 1 LINE                           06310300
063104*RPK  ADDED THE CALL TO 2130- TO PRINT THE PO/RECEIVER/LINE LINE  06310400
063105*RPK  AT A PAGE BREAK WHERE PART OF THE PO/RECEIVER/LINE WAS      06310500
063106*RPK  PRINTED ON THE PREVIOUS PAGE                                06310600
063107*DMB  REMOVED THE CALL TO 2130- BECAUSE IT DIDN'T SOLVE THE       06310700
063108*DMB  PROBLEM.  MOVED THE WRITE OF DETAIL-LINE2 FROM DOWN BELOW   06310800
063109*DMB  TO BEFORE THE PAGE BREAK.  ADDED WRITE OF DETAIL-LINE1-1.   06310900
063110*            PERFORM 2130-PRINT-DETAIL-LINE                       06311000
063200*            PERFORM 2140-PRINT-SUB-HEADINGS                      06320000
063300             ADD +1 TO PV-LINE-COUNT                              06330000
063400         END-IF                                                   06340000
063500                                                                  06350000
063600*        WRITE DAILY-RPT-RECORD                                   06360000
063700*          FROM DETAIL-LINE2                                      06370000
063800*            AFTER ADVANCING 1 LINE                               06380000
063900                                                                  06390000
064000         INITIALIZE DETAIL-LINE2                                  06400000
064100         SET PS-LOAD-LEFT-SIDE TO TRUE                            06410000
064230     END-IF.                                                      06423000
064300                                                                  06430000
064400******************************************************************06440000
064500 2120-PRINT-BREAK-LINES.                                          06450000
064600                                                                  06460000
064700     IF BF-PO-RCVR-LN = ZEROES                                    06470000
064800         CONTINUE                                                 06480000
064900     ELSE                                                         06490000
065000         ADD +4 TO PV-LINE-COUNT                                  06500000
065100*        IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                     06510000
065200*            PERFORM 1500-PAGE-BREAK                              06520000
065300*            ADD +4 TO PV-LINE-COUNT                              06530000
065400*        END-IF                                                   06540000
065500                                                                  06550000
065600         MOVE PV-ACCUM-RTL-QTY TO TL1-QTY                         06560000
065700         WRITE DAILY-RPT-RECORD                                   06570000
065800           FROM TOTAL-LINE1                                       06580000
065900             AFTER ADVANCING 2 LINES                              06590000
066000                                                                  06600000
066100         MOVE PV-ACCUM-LNE-QTY TO TL2-QTY                         06610000
066200         WRITE DAILY-RPT-RECORD                                   06620000
066300           FROM TOTAL-LINE2                                       06630000
066400             AFTER ADVANCING 1 LINE                               06640000
066500                                                                  06650000
066600         WRITE DAILY-RPT-RECORD                                   06660000
066700           FROM BLANK-LINE                                        06670000
066800             AFTER ADVANCING 1 LINE                               06680000
066900     END-IF.                                                      06690000
067000                                                                  06700000
067100******************************************************************06710000
067110*----------------------------------------------------------------*06711000
067120*                                                 ** WR # 21361. *06712060
067121* DELETED CODE TO MOVE RC048-SKU-NBR TO DL1-SKU-1.               *06712100
067122* ADDED CODE TO MOVE VALUE OF RC048-DEPT TO DL1-DEPT-1 AND       *06712200
067124* TO MOVE VALUE OF RC048-CLASS TO DL1-CLASS-1 AND TO MOVE THE    *06712400
067125* VALUE OF RC048-SKU-NBR  TO DL1-SKU-NBR-1.                      *06712561
067127*                                                                *06712700
067128* DELETED CODE TO MOVE RC048-SKU-NBR TO DL1-SKU-2.               *06712800
067129* ADDED CODE TO MOVE VALUE OF RC048-DEPT TO DL1-DEPT-2 AND       *06712900
067130* TO MOVE VALUE OF RC048-CLASS TO DL1-CLASS-2 AND TO MOVE THE    *06713000
067131* VALUE OF RC048-SKU-NBR  TO DL1-SKU-NBR-2.                      *06713161
067140*----------------------------------------------------------------*06714000
067200 2130-PRINT-DETAIL-LINE.                                          06720000
067300                                                                  06730000
067400     IF CC-RCKRP028-1                                             06740000
068001         MOVE RC048-PO                TO DL1-PO-1                 06800100
068002         MOVE RC048-REC-SEQ-NBR       TO DL1-REC-1                06800200
068003         MOVE RC048-POLINENO          TO DL1-LINE-1               06800300
068005         MOVE RC048-DEPT              TO DL1-DEPT-1               06800500
068006         MOVE RC048-CLASS             TO DL1-CLASS-1              06800600
068009         MOVE RC048-SKU-NBR           TO DL1-SKU-NBR-1            06800961
068010         MOVE RC048-SKU-STATUS        TO DL1-SKU-STS-1            06801000
068020         MOVE RC048-PO-UNIT-RETAIL    TO DL1-PO-RETAIL-1          06802000
068100     END-IF.                                                      06810000
068200     IF CC-RCKRP028-2                                             06820000
068300         MOVE RC048-PO                TO DL1-PO-2                 06830000
068400         MOVE RC048-POLINENO          TO DL1-LINE-2               06840000
068510         MOVE RC048-DEPT              TO DL1-DEPT-2               06851000
068520         MOVE RC048-CLASS             TO DL1-CLASS-2              06852000
068530         MOVE RC048-SKU-NBR           TO DL1-SKU-NBR-2            06853061
068600         MOVE RC048-SKU-STATUS        TO DL1-SKU-STS-2            06860000
068700         MOVE RC048-PO-UNIT-RETAIL    TO DL1-PO-RETAIL-2          06870000
068800     END-IF.                                                      06880000
068810*----------------------------------------------------------------*06881000
068820* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *06882060
068830*----------------------------------------------------------------*06883000
068900                                                                  06890000
068910*RPK CHANGED ADD +2 TO PV-LINE-COUNT. TO ADD +7 TO PV-LINE-COUNT. 06891000
068920*RPK WANTED TO FORCE THE START OF A NEW LINE TO A NEW PAGE.       06892000
069000     ADD +7 TO PV-LINE-COUNT.                                     06900000
069100     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         06910000
069200         PERFORM 1500-PAGE-BREAK                                  06920000
069300         ADD +2 TO PV-LINE-COUNT                                  06930000
069301*RPK ADDED THE FOLLOWING ELSE SO THAT IF THE +6 DID NOT FORCE A   06930100
069302*RPK PAGE BREAK THAT WE SUBTRACT OUT 4 LINES SINCE WE ADDED 6     06930200
069303*RPK BECAUSE OF WORST CASE POSSIBILITY                            06930300
069310     ELSE                                                         06931000
069320         ADD -5 TO PV-LINE-COUNT                                  06932000
069400     END-IF.                                                      06940000
069500                                                                  06950000
069600     IF CC-RCKRP028-1                                             06960000
069700         WRITE DAILY-RPT-RECORD                                   06970000
069800           FROM DETAIL-LINE1-1                                    06980000
069900             AFTER ADVANCING 2 LINES                              06990000
070000     END-IF.                                                      07000000
070100     IF CC-RCKRP028-2                                             07010000
070200         WRITE DAILY-RPT-RECORD                                   07020000
070300           FROM DETAIL-LINE1-2                                    07030000
070400             AFTER ADVANCING 2 LINES                              07040000
070500     END-IF.                                                      07050000
070600                                                                  07060000
070700******************************************************************07070000
070800 2140-PRINT-SUB-HEADINGS.                                         07080000
070900                                                                  07090000
071000     ADD +4 TO PV-LINE-COUNT.                                     07100000
071100     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         07110000
071200         PERFORM 1500-PAGE-BREAK                                  07120000
071300         ADD +4 TO PV-LINE-COUNT                                  07130000
071400     END-IF.                                                      07140000
071500                                                                  07150000
071600     WRITE DAILY-RPT-RECORD                                       07160000
071700       FROM HEADING-LINE-4                                        07170000
071800         AFTER ADVANCING 2 LINES.                                 07180000
071900                                                                  07190000
072000     WRITE DAILY-RPT-RECORD                                       07200000
072100       FROM HEADING-LINE-5                                        07210000
072200         AFTER ADVANCING 1 LINE.                                  07220000
072300                                                                  07230000
072400     WRITE DAILY-RPT-RECORD                                       07240000
072500       FROM BLANK-LINE                                            07250000
072600         AFTER ADVANCING 1 LINE.                                  07260000
072700                                                                  07270000
072800******************************************************************07280000
072900** LOAD STORE INFORMATION INTO LEFT SIDE OF DETAIL LINE.          07290000
073000******************************************************************07300000
073100 2150-LOAD-LEFT-SIDE.                                             07310000
073200                                                                  07320000
073300     MOVE RC048-STORE-UNIT-RETAIL TO DL2-CURR-RETAIL1.            07330000
073400     MOVE RC048-STORE             TO DL2-STORE-NBR1.              07340000
073500     MOVE RC048-RETAIL-UNITS-MARK TO DL2-QTY1.                    07350000
073600     ADD  RC048-RETAIL-UNITS-MARK TO PV-ACCUM-RTL-QTY             07360000
073700                                     PV-ACCUM-LNE-QTY.            07370000
073800     MOVE RC048-RETAIL-STATUS     TO DL2-RETAIL-STS1.             07380000
073900                                                                  07390000
074000     SET PS-LOAD-RIGHT-SIDE TO TRUE.                              07400000
074100                                                                  07410000
074200******************************************************************07420000
074300** LOAD STORE INFORMATION INTO RIGHT SIDE OF DETAIL LINE.         07430000
074400******************************************************************07440000
074500 2160-LOAD-RIGHT-SIDE.                                            07450000
074600                                                                  07460000
074700     MOVE RC048-STORE-UNIT-RETAIL TO DL2-CURR-RETAIL2.            07470000
074800     MOVE RC048-STORE             TO DL2-STORE-NBR2.              07480000
074900     MOVE RC048-RETAIL-UNITS-MARK TO DL2-QTY2.                    07490000
075000     ADD  RC048-RETAIL-UNITS-MARK TO PV-ACCUM-RTL-QTY             07500000
075100                                     PV-ACCUM-LNE-QTY.            07510000
075200     MOVE RC048-RETAIL-STATUS     TO DL2-RETAIL-STS2.             07520000
075300                                                                  07530000
075400     SET PS-LOAD-LEFT-SIDE TO TRUE.                               07540000
075500                                                                  07550000
075600******************************************************************07560000
075700**  PRINT PARTIAL DETAIL LINE W/ PRICE & STORE INFO ONLY.         07570000
075800**  IF PAGE BREAK, THEN RE-PRINT MAJOR BREAK INFO.                07580000
075900******************************************************************07590000
076000 2200-PRINT-BREAK-2.                                              07600000
076100                                                                  07610000
076200*PRINT DETAIL LINE.                                               07620000
076300     IF PS-LOAD-RIGHT-SIDE                                        07630000
076400         ADD +1 TO PV-LINE-COUNT                                  07640000
076500         IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                     07650000
076600             PERFORM 1500-PAGE-BREAK                              07660000
076700             ADD +1 TO PV-LINE-COUNT                              07670000
076800         END-IF                                                   07680000
076900                                                                  07690000
077000         WRITE DAILY-RPT-RECORD                                   07700000
077100           FROM DETAIL-LINE2                                      07710000
077200             AFTER ADVANCING 1 LINE                               07720000
077300                                                                  07730000
077400         INITIALIZE DETAIL-LINE2                                  07740000
077500         SET PS-LOAD-LEFT-SIDE TO TRUE                            07750000
077600     END-IF.                                                      07760000
077700                                                                  07770000
077800*PRINT QUANTITY ACCUMULATED LINES.                                07780000
077900     ADD +3 TO PV-LINE-COUNT.                                     07790000
078000*    IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         07800000
078100*        PERFORM 1500-PAGE-BREAK                                  07810000
078200*        ADD +3 TO PV-LINE-COUNT                                  07820000
078300*    END-IF.                                                      07830000
078400                                                                  07840000
078500     MOVE PV-ACCUM-RTL-QTY TO TL1-QTY.                            07850000
078600     WRITE DAILY-RPT-RECORD                                       07860000
078700       FROM TOTAL-LINE1                                           07870000
078800         AFTER ADVANCING 2 LINES.                                 07880000
078900                                                                  07890000
079000     WRITE DAILY-RPT-RECORD                                       07900000
079100       FROM BLANK-LINE                                            07910000
079200         AFTER ADVANCING 1 LINE.                                  07920000
079300                                                                  07930000
079400*PRINT SUB-HEADING LINES.                                         07940000
079500     ADD +1 TO PV-LINE-COUNT.                                     07950000
079600     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         07960000
079700         PERFORM 1500-PAGE-BREAK                                  07970000
079800         PERFORM 2110-CHECK-PRINT-DETAIL                          07980000
079900         PERFORM 2120-PRINT-BREAK-LINES                           07990000
080000         PERFORM 2130-PRINT-DETAIL-LINE                           08000000
080100         PERFORM 2140-PRINT-SUB-HEADINGS                          08010000
080200     ELSE                                                         08020000
080300         WRITE DAILY-RPT-RECORD                                   08030000
080400           FROM BLANK-LINE                                        08040000
080500             AFTER ADVANCING 1 LINE                               08050000
080600     END-IF.                                                      08060000
080700                                                                  08070000
080800******************************************************************08080000
080900**  PRINT PARTIAL DETAIL LINE W/ PRICE & STORE INFO ONLY.         08090000
081000**  IF PAGE BREAK, THEN RE-PRINT MAJOR BREAK INFO.                08100000
081100******************************************************************08110000
081200 2300-PRINT-BREAK-3.                                              08120000
081300                                                                  08130000
081400     ADD +1 TO PV-LINE-COUNT.                                     08140000
081500                                                                  08150000
081600     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         08160000
081700         PERFORM 1500-PAGE-BREAK                                  08170000
081800*JPL     PERFORM 2110-CHECK-PRINT-DETAIL                          08180000
081900***      PERFORM 2120-PRINT-BREAK-LINES                           08190000
081910*RPK  UN-COMMENTED OUT THE 2130- BECAUSE WE WANT TO PRINT THE     08191000
081920*RPK  PO/RECEIVER/LINE DETAIL WHEN THERE IS A PAGE BREAK AND      08192000
081930*RPK  SOME OF THE STORES PRINTED ON THE PREVIOUS PAGE             08193000
082000         PERFORM 2130-PRINT-DETAIL-LINE                           08200000
082100         PERFORM 2140-PRINT-SUB-HEADINGS                          08210000
082200         ADD +1 TO PV-LINE-COUNT                                  08220000
082300     END-IF.                                                      08230000
082400                                                                  08240000
082500     WRITE DAILY-RPT-RECORD                                       08250000
082600       FROM DETAIL-LINE2                                          08260000
082700         AFTER ADVANCING 1 LINE.                                  08270000
082800                                                                  08280000
082900     INITIALIZE DETAIL-LINE2.                                     08290000
083000                                                                  08300000
083100     SET PS-LOAD-LEFT-SIDE TO TRUE.                               08310000
083200                                                                  08320000
083300******************************************************************08330000
083400*  READ A RECORD FROM THE PRICE DIFFERENCES EXTRACT FILE.        *08340000
083500******************************************************************08350000
083600 3000-READ-EXTRACT-FILE.                                          08360000
083700                                                                  08370000
083800     READ PRC-DIFF-EXTRACT-FILE                                   08380000
083900       INTO RC048-PRICE-DIFFERENCES                               08390000
084000         AT END                                                   08400000
084100           SET PS-END-OF-INPUT TO TRUE.                           08410000
084200                                                                  08420000
084203******************************************************************08420300
084204 7000-SELECT-TCOCNTL.                                             08420400
084205     MOVE '7000-SELECT-TCOCNTL'                                   08420500
084206                                 TO PV-ABEND-PARAGRAPH.           08420600
084207                                                                  08420700
084208     EXEC SQL                                                     08420800
084209        SELECT  A.BTCH_PRC_DTE                                    08420900
084211          INTO :COCNTL-BTCH-PRC-DTE                               08421100
084213          FROM  TCOCNTL A                                         08421300
084215          WHERE A.OPER_UNT_ID   =  90                             08421500
084219     END-EXEC.                                                    08421900
084220                                                                  08422000
084221     EVALUATE TRUE                                                08422100
084222       WHEN SQLCODE = ZEROS                                       08422200
084223         CONTINUE                                                 08422300
084230       WHEN OTHER                                                 08423000
084231         DISPLAY PV-ABEND-PARAGRAPH                               08423100
084233         PERFORM Z999-SQL-ERROR                                   08423300
084234     END-EVALUATE.                                                08423400
084240******************************************************************08424000
084241 Z999-SQL-ERROR.                                                  08424100
084242*------------                                                     08424200
084243                                                                  08424300
084244     MOVE SQLCODE    TO SQLCODE2.                                 08424400
084245     MOVE SQLERRD(3) TO SQLERRD3.                                 08424500
084246     DISPLAY '** ABEND **       ** = SQLERROR'.                   08424600
084247     DISPLAY '** PROGRAM        ** = RCKRP028'.                   08424700
084248     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  08424800
084249     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  08424900
084250     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   08425000
084251     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  08425100
084252     EXEC SQL                                                     08425200
084253         COMMIT                                                   08425300
084254     END-EXEC.                                                    08425400
084255     MOVE +4013 TO PV-ABEND-CODE.                                 08425500
084260     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08426000
084300******************************************************************08430000
084400******************************************************************08440000
