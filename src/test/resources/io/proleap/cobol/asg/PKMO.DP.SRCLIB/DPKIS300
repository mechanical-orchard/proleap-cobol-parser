000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             DPKIS300.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MAY 18, 1999.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM IS A CALLED SUBROUTINE THAT EXECUTES AN ISPF     *00120000
001300*  DIALOG TO ALLOW A USER TO REQUEST THE PRINTING OF A PRE-      *00130000
001400*  FORMATTED FILE (PRESUMABLY JUST BROWSED), BASED ON ENTERABLE  *00140000
001500*  FORMAT CRITERIA.  A POP-UP ISPF PANEL IS USED TO FACILITATE   *00150000
001600*  PRINT REQUEST PROCESS IN THE FOREGROUND OF THE CURRENT ISPF   *00160000
001700*  FUNCTION (PRESUMABLY THE BROWSE OF THE FILE TO BE PRINTED).   *00170000
001800*  ONE ISPF PANEL IS DIRECTLY USED:                              *00180000
001900*       CMNUPRT - INPUT - PRINT REQUEST SPECIFICATION            *00190000
002000*  THE POP-UP PANEL WILL REMAIN UNTIL AN END IS REQUESTED FROM   *00200000
002100*  THE PRINT REQUEST PANEL, OR A VALID PRINT REQUEST IS ENTERED. *00210000
002200*  IF A PRINT REQUEST IS SPECIFIED, THE PROGRAM WILL DYNAMICALLY *00220000
002300*  ALLOCATE A PRINT FILE BASED ON THE CRITERIA SPECIFIED, AND    *00230000
002400*  GENERATE THE PRINT FILE DETAIL USING THE PRE-FORMATTED DETAIL *00240000
002500*  LINES FROM THE SPECIFIED FILE.                                *00250000
002600*                                                                *00260000
002700*  THIS PROGRAM SHOULD BE ACCESSED VIA A DYNAMIC CALL, USING THE *00270000
002800*  STANDARD PROGRAM NAME VARIABLE IN THE PARAMETER LIST.  THE    *00280000
002900*  PARAMETER LIST FOR THIS PROGRAM IS DPWS300.  IF THERE IS AN   *00290000
003000*  ERROR IN THE PARAMETER LIST, AN ERROR WILL BE PRESENTED IN    *00300000
003100*  THE POP-UP WINDOW FOR THE DURATION OF TIME IT STAYS IN THE    *00310000
003200*  FOREGROUND, FORCING AN END TO BE REQUESTED TO REMOVE THE      *00320000
003300*  PANEL.  THE PARAMETER LIST ERROR WILL BE RETURNED TO THE      *00330000
003400*  CALLING PROGRAM FOR PRESENTATION IN THE NEXT PANEL DISPLAYED. *00340000
003500******************************************************************00350000
003600                                                                  00360000
003700******************************************************************00370000
003800 ENVIRONMENT DIVISION.                                            00380000
003900******************************************************************00390000
004000                                                                  00400000
004100 CONFIGURATION SECTION.                                           00410000
004200 SOURCE-COMPUTER.        IBM-3090.                                00420000
004300 OBJECT-COMPUTER.        IBM-3090.                                00430000
004400                                                                  00440000
004500 INPUT-OUTPUT SECTION.                                            00450000
004600                                                                  00460000
004700 FILE-CONTROL.                                                    00470000
004800                                                                  00480000
004900     SELECT PRINTABLE-FILE-80                                     00490000
005000         ASSIGN TO INPUT80.                                       00500000
005100                                                                  00510000
005200     SELECT PRINT-FILE-80                                         00520000
005300         ASSIGN TO PRINT80.                                       00530000
005400                                                                  00540000
005410     SELECT PRINTABLE-FILE-132                                    00541000
005420         ASSIGN TO INPUT132.                                      00542000
005430                                                                  00543000
005440     SELECT PRINT-FILE-132                                        00544000
005450         ASSIGN TO PRINT132.                                      00545000
005460                                                                  00546000
005500******************************************************************00550000
005600 DATA DIVISION.                                                   00560000
005700******************************************************************00570000
005800                                                                  00580000
005900 FILE SECTION.                                                    00590000
006000                                                                  00600000
006100 FD  PRINTABLE-FILE-80                                            00610000
006200     RECORDING MODE IS F                                          00620000
006300     LABEL RECORDS ARE STANDARD                                   00630000
006400     BLOCK CONTAINS 0 RECORDS                                     00640000
006500     RECORD CONTAINS 80 CHARACTERS                                00650000
006600     DATA RECORD IS PF-PRINTABLE-RECORD-80.                       00660000
006700                                                                  00670000
006800 01  PF-PRINTABLE-RECORD-80      PIC X(80).                       00680000
006900                                                                  00690000
007000 FD  PRINT-FILE-80                                                00700000
007100     RECORDING MODE IS F                                          00710000
007200     LABEL RECORDS ARE STANDARD                                   00720000
007300     BLOCK CONTAINS 0 RECORDS                                     00730000
007400     RECORD CONTAINS 80 CHARACTERS                                00740000
007500     DATA RECORD IS PF-PRINT-LINE-80.                             00750000
007600                                                                  00760000
007700 01  PF-PRINT-LINE-80            PIC X(80).                       00770000
007800                                                                  00780000
007810 FD  PRINTABLE-FILE-132                                           00781000
007820     RECORDING MODE IS F                                          00782000
007830     LABEL RECORDS ARE STANDARD                                   00783000
007840     BLOCK CONTAINS 0 RECORDS                                     00784000
007850     RECORD CONTAINS 132 CHARACTERS                               00785000
007860     DATA RECORD IS PF-PRINTABLE-RECORD-132.                      00786000
007870                                                                  00787000
007880 01  PF-PRINTABLE-RECORD-132     PIC X(132).                      00788000
007890                                                                  00789000
007891 FD  PRINT-FILE-132                                               00789100
007892     RECORDING MODE IS F                                          00789200
007893     LABEL RECORDS ARE STANDARD                                   00789300
007894     BLOCK CONTAINS 0 RECORDS                                     00789400
007895     RECORD CONTAINS 132 CHARACTERS                               00789500
007896     DATA RECORD IS PF-PRINT-LINE-132.                            00789600
007897                                                                  00789700
007898 01  PF-PRINT-LINE-132           PIC X(132).                      00789800
007899                                                                  00789900
007900 WORKING-STORAGE SECTION.                                         00790000
008000                                                                  00800000
008100*                                                                 00810000
008200*  PARAMETER LIST FOR THE ISPF PRINT REQUEST PANEL ROUTINE        00820000
008300*                                                                 00830000
008400     COPY DPWS300.                                                00840000
008500                                                                  00850000
008600*                                                                 00860000
008700*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              00870000
008800*                                                                 00880000
008900     COPY DPWS023.                                                00890000
008901                                                                  00890100
008902*                                                                 00890200
008903*  STANDARD REPORT HEADER FOR A 75 COLUMN REPORT                  00890300
008904*                                                                 00890400
008905                                                                  00890500
008906     COPY DPWS075.                                                00890600
008907                                                                  00890701
008908*                                                                 00890801
008909*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                 00890901
008910*                                                                 00891001
008911                                                                  00891101
008912     COPY DPWS132.                                                00891201
008913                                                                  00891301
008914 01  PS-PROGRAM-SWITCHES.                                         00891401
008915     05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          00891501
008916         88  PS-EDIT-ERROR                    VALUE 'Y'.          00891601
008920         88  PS-NO-EDIT-ERRORS                VALUE 'N'.          00892000
008930     05  PS-PARAMETER-LIST-ERROR-IND                              00893000
008940                                 PIC X(1)     VALUE 'N'.          00894000
008950         88  PS-PARAMETER-LIST-ERROR          VALUE 'Y'.          00895000
008960         88  PS-NO-PARAMETER-LIST-ERRORS      VALUE 'N'.          00896000
008970     05  PS-PRINTABLE-FILE-ALLOC-IND                              00897000
008980                                 PIC X(1)     VALUE 'N'.          00898000
008990         88  PS-PRINTABLE-FILE-ALLOC          VALUE 'Y'.          00899000
009000         88  PS-PRINTABLE-FILE-NOT-ALLOC      VALUE 'Y'.          00900000
009100     05  PS-END-OF-PRINTABLE-FILE-IND                             00910000
009200                                 PIC X(1)     VALUE 'N'.          00920000
009300         88  PS-END-OF-PRINTABLE-FILE         VALUE 'Y'.          00930000
009400         88  PS-NOT-END-OF-PRINTABLE-FILE     VALUE 'N'.          00940000
009500     05  PS-END-REQUESTED-IND    PIC X(1)     VALUE 'N'.          00950000
009600         88  PS-END-REQUESTED                 VALUE 'Y'.          00960000
009700         88  PS-END-NOT-REQUESTED             VALUE 'N'.          00970000
009800                                                                  00980000
009900 01  PC-PROGRAM-CONSTANTS.                                        00990000
010000     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'DPKIS300'.   01000000
010100     05  PC-PRINT-PANEL-ROW-OFFSET                                01010000
010200                                 PIC S9(9)    VALUE +5            01020000
010300                                              COMP SYNC.          01030000
010400     05  PC-PRINT-PANEL-COLUMN-OFFSET                             01040000
010500                                 PIC S9(9)    VALUE +5            01050000
010600                                              COMP SYNC.          01060000
010700     05  PC-PRINTABLE-FILE-80-DDNAME                              01070000
010800                                 PIC X(8)     VALUE 'INPUT80'.    01080000
010900     05  PC-PRINT-FILE-80-DDNAME PIC X(8)     VALUE 'PRINT80'.    01090000
010910     05  PC-PRINTABLE-FILE-132-DDNAME                             01091000
010920                                 PIC X(8)     VALUE 'INPUT132'.   01092000
010930     05  PC-PRINT-FILE-132-DDNAME                                 01093000
010940                                 PIC X(8)     VALUE 'PRINT132'.   01094000
011000     05  PC-MAXIMUM-HEADING-LINE-COUNT                            01100000
011100                                 PIC S9(4)    VALUE +25           01110000
011200                                              COMP SYNC.          01120000
011300                                                                  01130000
011400 01  PV-PROGRAM-VARIABLES.                                        01140000
011500     05  PV-WRITER-DEFINITION    PIC X(6)     VALUE SPACES.       01150000
011600         88  PV-WD-NO-WRITER                  VALUE SPACES.       01160000
011700         88  PV-WD-LANDSCAPE-DUPLEX           VALUE 'DSTD1'.      01170000
011800         88  PV-WD-LANDSCAPE-DUPLEX-UNDRLN    VALUE 'DSTDU'.      01180000
011900         88  PV-WD-LANDSCAPE-SIMPLEX          VALUE 'SSTD'.       01190000
012000         88  PV-WD-LANDSCAPE-SIMPLEX-UNDRLN   VALUE 'SSTDU'.      01200000
012100         88  PV-WD-PORTRAIT-DUPLEX            VALUE 'DLET'.       01210000
012200         88  PV-WD-PORTRAIT-DUPLEX-UNDRLN     VALUE 'DLETU'.      01220000
012300         88  PV-WD-PORTRAIT-SIMPLEX           VALUE 'SLET'.       01230000
012400         88  PV-WD-PORTRAIT-SIMPLEX-UNDRLN    VALUE 'SLETU'.      01240000
012500     05  PV-PARAMETER-LIST-ERROR-MSG                              01250000
012600                                 PIC X(58)    VALUE SPACES.       01260000
012700     05  PV-PAGE-NUMBER          PIC S9(4)    VALUE ZEROS         01270000
012800                                              COMP SYNC.          01280000
012900     05  PV-LINE-COUNT           PIC S9(4)    VALUE ZEROS         01290000
013000                                              COMP SYNC.          01300000
013100     05  PV-TOTAL-HEADING-LINE-COUNT                              01310000
013200                                 PIC S9(4)    VALUE ZEROS         01320000
013300                                              COMP SYNC.          01330000
013301     05  PV-PRINTABLE-RECORD     PIC X(132)   VALUE SPACES.       01330106
013302     05  PV-PRINT-LINE           PIC X(132)   VALUE SPACES.       01330206
013303     05  FILLER                  REDEFINES PV-PRINT-LINE.         01330307
013304         10  PV-PRINT-LINE-80    PIC X(80).                       01330408
013305         10  FILLER              PIC X(52).                       01330508
013306     05  PV-PRINT-LINE-132       REDEFINES PV-PRINT-LINE          01330607
013307                                 PIC X(132).                      01330707
013310     05  PV-PRINTABLE-FILE-DDNAME                                 01331000
013320                                 PIC X(8)     VALUE SPACES.       01332000
013330     05  PV-PRINT-FILE-DDNAME    PIC X(8)     VALUE SPACES.       01333000
013400     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             01340000
013500         10  FILLER              PIC X(13)    VALUE               01350000
013600             'DYNALC ERROR '.                                     01360000
013700         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        01370000
013800         10  FILLER              PIC X(2)     VALUE '; '.         01380000
013900         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       01390000
014000         10  FILLER              PIC X(5)     VALUE ' DD; '.      01400000
014100         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       01410000
014200                                                                  01420000
014210 01  HL-HEADING-LINE-TABLE.                                       01421000
014220     05  HL-HEADING-LINE         OCCURS 25 TIMES                  01422000
014230                                 INDEXED BY HL-INDEX              01423000
014240                                 PIC X(132).                      01424001
014250                                                                  01425000
014260***************************************************************   01426000
014270*  ISPF CONSTANTS                                                 01427000
014280***************************************************************   01428000
014290 01  IC-ISPF-CONSTANTS.                                           01429000
014300     05  IC-ISPF-SERVICE-LINK    PIC X(8)     VALUE 'ISPLINK'.    01430000
014400     05  IC-MISC-SERVICE-CONTROL                                  01440000
014500                                 PIC X(8)     VALUE 'CONTROL'.    01450000
014600     05  IC-DISPLAY-SERVICE-DISPLAY                               01460000
014700                                 PIC X(8)     VALUE 'DISPLAY'.    01470000
014800     05  IC-DISPLAY-SERVICE-ADDPOP                                01480000
014900                                 PIC X(8)     VALUE 'ADDPOP'.     01490000
015000     05  IC-DISPLAY-SERVICE-REMPOP                                01500000
015100                                 PIC X(8)     VALUE 'REMPOP'.     01510000
015200     05  IC-PDF-SERVICE-BROWSE   PIC X(8)     VALUE 'BROWSE'.     01520000
015300     05  IC-REFRESH-STATEMENT    PIC X(8)     VALUE 'REFRESH'.    01530000
015400*                                                                 01540000
015500*  DEFINE VARIABLES TO ISPF THROUGH THE FUNCTION POOL             01550000
015600*                                                                 01560000
015700     05  IC-VARIABLE-SERVICE-VDEFINE                              01570000
015800                                 PIC X(8)     VALUE 'VDEFINE'.    01580000
015900*                                                                 01590000
016000*  RETRIEVE VARIABLES FROM THE SHARED POOL OR PROFILE POOL        01600000
016100*                                                                 01610000
016200     05  IC-VARIABLE-SERVICE-VGET                                 01620000
016300                                 PIC X(8)     VALUE 'VGET'.       01630000
016400*                                                                 01640000
016500*  UPDATE VARIABLES IN THE SHARED POOL OR PROFILE POOL            01650000
016600*                                                                 01660000
016700     05  IC-VARIABLE-SERVICE-VPUT                                 01670000
016800                                 PIC X(8)     VALUE 'VPUT'.       01680000
016900*                                                                 01690000
017000     05  IC-FIELD-FORMAT-CHAR    PIC X(8)     VALUE 'CHAR'.       01700000
017100     05  IC-SHARED-VARIABLE-POOL PIC X(8)     VALUE 'SHARED'.     01710000
017200     05  IC-PROFILE-VARIABLE-POOL                                 01720000
017300                                 PIC X(8)     VALUE 'PROFILE'.    01730000
017400                                                                  01740000
017500 01  IV-ISPF-VARIABLES.                                           01750000
017600***************************************************************   01760000
017700*  CURSOR POSITIONING IS ACTIVATED ON THE DISPLAY OF THE PANEL.   01770000
017800*  THE FIELD NAME (SEE RELATED ISPF CONSTANTS) IS USED BY ISPF    01780000
017900*  TO SPECIFY CURSOR POSITIONING.                                 01790000
018000***************************************************************   01800000
018100     05  IV-CURSOR-POSITION      PIC X(8)     VALUE SPACE.        01810000
018200     05  IV-FIELD-LENGTH         PIC 9(8)     VALUE ZEROS         01820000
018300                                              COMP SYNC.          01830000
018400     05  IV-ERROR-MESSAGE-FORMAT PIC X(8)     VALUE SPACES.       01840000
018500         88  IV-EM-DYNAMIC-SHORT-LONG-MSG     VALUE 'CMN000  '.   01850000
018600                                                                  01860000
018700***************************************************************   01870000
018800*  NAMED CONSTANTS FOR ALL PANELS AND DIALOG VARIABLES.           01880000
018900***************************************************************   01890000
019000 01  IN-ISPF-NAMED-DIALOG-VARIABLES.                              01900000
019100***************************************************************   01910000
019200*  PANEL NAMES                                                    01920000
019300***************************************************************   01930000
019400     05  IN-PANEL-CMNUPRT        PIC X(8)     VALUE 'CMNUPRT'.    01940000
019500***************************************************************   01950000
019600*  DIALOG VARIABLES IN THE APPLICATION PROFILE POOL               01960000
019700***************************************************************   01970000
019800     05  IN-FIELD-LINES-PER-PAGE PIC X(8)     VALUE 'CMNFLPP'.    01980000
019900     05  IN-FIELD-OUTPUT-PRINTER PIC X(8)     VALUE 'CMNFPTR'.    01990000
020000     05  IN-FIELD-HP-LASER-JET-FONT                               02000000
020100                                 PIC X(8)     VALUE 'CMNFFNT'.    02010000
020200***************************************************************   02020000
020300*  CMNUPRT PANEL DIALOG VARIABLE NAMES                            02030000
020400***************************************************************   02040000
020500     05  IN-FIELD-CMNUPRTE       PIC X(8)     VALUE 'CMNUPRTE'.   02050000
020600     05  IN-FIELD-CMNUPRTI       PIC X(8)     VALUE 'CMNUPRTI'.   02060000
020700     05  IN-FIELD-CMNUPRTL       PIC X(8)     VALUE 'CMNUPRTL'.   02070000
020800     05  IN-FIELD-CMNUPRTC       PIC X(8)     VALUE 'CMNUPRTC'.   02080000
020900     05  IN-FIELD-CMNUPRTS       PIC X(8)     VALUE 'CMNUPRTS'.   02090000
021000     05  IN-FIELD-CMNUPRTD       PIC X(8)     VALUE 'CMNUPRTD'.   02100000
021100     05  IN-FIELD-CMNUPRTF       PIC X(8)     VALUE 'CMNUPRTF'.   02110000
021200     05  IN-FIELD-CMNUPRTU       PIC X(8)     VALUE 'CMNUPRTU'.   02120000
021300                                                                  02130000
021400 01  ID-ISPF-DIALOG-VARIABLES.                                    02140000
021500     05  ID-LINES-PER-PAGE       PIC X(2)     VALUE SPACES.       02150000
021600     05  ID-OUTPUT-PRINTER       PIC X(5)     VALUE SPACES.       02160000
021700     05  ID-HP-LASER-JET-FONT    PIC X(6)     VALUE SPACES.       02170000
021800     05  ID-CMNUPRT-VARIABLES.                                    02180000
021900         10  ID-CMNUPRT-CMNUPRTE PIC X(58)    VALUE SPACES.       02190000
022000         10  ID-CMNUPRT-CMNUPRTI PIC X(1)     VALUE SPACES.       02200000
022100             88  ID-CMNUPRT-CMNUPRTI-PRINT    VALUE 'Y'.          02210000
022200             88  ID-CMNUPRT-CMNUPRTI-NO-PRINT VALUE 'N'.          02220000
022300         10  ID-CMNUPRT-CMNUPRTL PIC X(2)     VALUE SPACES.       02230000
022400         10  ID-CMNUPRT-CMNUPRTL-N                                02240000
022500                                 REDEFINES ID-CMNUPRT-CMNUPRTL    02250000
022600                                 PIC 9(2).                        02260000
022700         10  ID-CMNUPRT-CMNUPRTC PIC X(2)     VALUE SPACES.       02270000
022800         10  ID-CMNUPRT-CMNUPRTC-N                                02280000
022900                                 REDEFINES ID-CMNUPRT-CMNUPRTC    02290000
023000                                 PIC 9(2).                        02300000
023100             88  ID-CMNUPRT-CMNUPRTC-1-COPY   VALUE 1.            02310000
023200         10  ID-CMNUPRT-CMNUPRTS PIC X(1)     VALUE SPACES.       02320000
023300             88  ID-CMNUPRT-CMNUPRTS-CLASS-A  VALUE 'A'.          02330000
023400         10  ID-CMNUPRT-CMNUPRTD PIC X(5)     VALUE SPACES.       02340000
023500             88  ID-CMNUPRT-CMNUPRTD-LOCAL    VALUE 'LOCAL'.      02350000
023600         10  FILLER              REDEFINES ID-CMNUPRT-CMNUPRTD.   02360000
023700             15  FILLER          PIC X(2).                        02370000
023800                 88  ID-CMNUPRT-CMNUPRTD-U4   VALUE 'U4'.         02380000
023900                 88  ID-CMNUPRT-CMNUPRTD-U6   VALUE 'U6'.         02390000
024000                 88  ID-CMNUPRT-CMNUPRTD-U7   VALUE 'U7'.         02400000
024100             15  FILLER          PIC X(3).                        02410000
024200         10  ID-CMNUPRT-CMNUPRTF PIC X(6)     VALUE SPACES.       02420000
024300             88  ID-CMNUPRT-CMNUPRTF-L-DUP    VALUE 'LSCPD'.      02430000
024400             88  ID-CMNUPRT-CMNUPRTF-L-DUP-UND                    02440000
024500                                              VALUE 'LSCPDU'.     02450000
024600             88  ID-CMNUPRT-CMNUPRTF-L-SIM    VALUE 'LSCPS'.      02460000
024700             88  ID-CMNUPRT-CMNUPRTF-L-SIM-UND                    02470000
024800                                              VALUE 'LSCPSU'.     02480000
024900             88  ID-CMNUPRT-CMNUPRTF-P-DUP    VALUE 'PTRTD'.      02490000
025000             88  ID-CMNUPRT-CMNUPRTF-P-DUP-UND                    02500000
025100                                              VALUE 'PTRTDU'.     02510000
025200             88  ID-CMNUPRT-CMNUPRTF-P-SIM    VALUE 'PTRTS'.      02520000
025300             88  ID-CMNUPRT-CMNUPRTF-P-SIM-UND                    02530000
025400                                              VALUE 'PTRTSU'.     02540000
025500         10  ID-CMNUPRT-CMNUPRTU PIC X(1)     VALUE SPACES.       02550000
025600             88  ID-CMNUPRT-CMNUPRTU-UPDATE   VALUE 'Y'.          02560000
025700             88  ID-CMNUPRT-CMNUPRTU-NO-UPDATE                    02570000
025800                                              VALUE 'N'.          02580000
025900                                                                  02590000
026000 LINKAGE SECTION.                                                 02600000
026100                                                                  02610000
026200 01  LS-ISPF-PRINT-PARMS         PIC X(225).                      02620000
026300                                                                  02630000
026400******************************************************************02640000
026500 PROCEDURE DIVISION USING LS-ISPF-PRINT-PARMS.                    02650000
026600******************************************************************02660000
026700                                                                  02670000
026800 0000-MAINLINE.                                                   02680000
026900                                                                  02690000
027000*                                                                 02700000
027100*  REFRESH ENTIRE SCREEN ON NEXT DISPLAY.  ALL SCREEN VARIABLES   02710000
027200*  SPECIFIED IN THE PANEL BODY WILL BE RETRIEVED PRIOR TO THE     02720000
027300*  REDISPLAY.                                                     02730000
027400*                                                                 02740000
027500     CALL IC-ISPF-SERVICE-LINK USING IC-MISC-SERVICE-CONTROL      02750000
027600                                     IC-DISPLAY-SERVICE-DISPLAY   02760000
027700                                     IC-REFRESH-STATEMENT.        02770000
027800                                                                  02780000
027900     MOVE LS-ISPF-PRINT-PARMS TO DP300-ISPF-PRINT-PARMS.          02790000
028000     PERFORM 1000-INITIALIZE.                                     02800000
028100                                                                  02810000
028200     MOVE IN-FIELD-CMNUPRTI TO IV-CURSOR-POSITION.                02820000
028300                                                                  02830000
028400     PERFORM 9000-ADD-PRINT-REQ-PANEL.                            02840000
028500     PERFORM 9100-DISPLAY-PRINT-REQ-PANEL.                        02850000
028600                                                                  02860000
028700     SET PS-EDIT-ERROR TO TRUE.                                   02870000
028800     PERFORM 2000-EDIT-PRINT-REQUEST                              02880000
028900         UNTIL ((RETURN-CODE NOT = ZERO)                          02890000
029000                 OR (PS-NO-EDIT-ERRORS)).                         02900000
029100                                                                  02910000
029200     IF RETURN-CODE NOT = ZEROS                                   02920000
029300         SET PS-END-REQUESTED TO TRUE                             02930000
029400     ELSE                                                         02940000
029500         SET PS-END-NOT-REQUESTED TO TRUE                         02950000
029600     END-IF.                                                      02960000
029700                                                                  02970000
029800     EVALUATE TRUE                                                02980000
029900         WHEN PS-END-REQUESTED                                    02990000
030000             SET DP300-RI-NO-PRINT-REQUESTED TO TRUE              03000000
030100             IF PS-PARAMETER-LIST-ERROR                           03010000
030200                 SET DP300-RI-ERROR TO TRUE                       03020000
030300                 MOVE PV-PARAMETER-LIST-ERROR-MSG TO              03030000
030310                           DP300-ERROR-MESSAGE                    03031000
030320             END-IF                                               03032000
030330         WHEN DP300-ERROR-MESSAGE NOT = SPACES                    03033000
030340             SET DP300-RI-ERROR TO TRUE                           03034000
030350         WHEN ID-CMNUPRT-CMNUPRTI-PRINT                           03035000
030360             PERFORM 9500-ALLOCATE-PRINTABLE-FILE                 03036000
030370             IF DP023-LASTRC = ZERO                               03037000
030380                 PERFORM 9700-ALLOCATE-PRINT-FILE                 03038000
030390                 IF DP023-LASTRC = ZERO                           03039000
030400                     PERFORM 4000-PRINT-RESULTS                   03040000
030500                 END-IF                                           03050000
030600             END-IF                                               03060000
030700             IF DP300-ERROR-MESSAGE NOT = SPACES                  03070000
030800                 SET DP300-RI-ERROR TO TRUE                       03080000
030900             ELSE                                                 03090000
031000                 SET DP300-RI-PRINT-REQUESTED TO TRUE             03100000
031100                 STRING 'PRINT COMPLETED ON '    DELIMITED BY SIZE03110000
031200                        ID-CMNUPRT-CMNUPRTD      DELIMITED BY SIZE03120000
031210                     INTO DP300-ERROR-MESSAGE                     03121000
031220             END-IF                                               03122000
031230         WHEN OTHER                                               03123000
031240             SET DP300-RI-NO-PRINT-REQUESTED TO TRUE              03124000
031250     END-EVALUATE.                                                03125000
031260     PERFORM 9200-REMOVE-PRINT-REQ-PANEL.                         03126000
031270                                                                  03127000
031280*                                                                 03128000
031290*  IF AN END WAS REQUESTED FROM THIS PANEL, RATHER THAN BY        03129000
031300*  COMPLETING THE PRINT REQUEST PANEL, DO NOT UPDATE THE          03130000
031400*  POOL VARIABLES WITH ANY CHANGES THAT WERE MADE LOCALLY.        03140000
031500*                                                                 03150000
031600                                                                  03160000
031700     IF ((PS-END-NOT-REQUESTED)                                   03170000
031800             AND (ID-CMNUPRT-CMNUPRTU-UPDATE))                    03180000
031900         MOVE ID-CMNUPRT-CMNUPRTL TO ID-LINES-PER-PAGE            03190000
032000         MOVE ID-CMNUPRT-CMNUPRTD TO ID-OUTPUT-PRINTER            03200000
032100         MOVE ID-CMNUPRT-CMNUPRTF TO ID-HP-LASER-JET-FONT         03210000
032200         PERFORM 1400-UPDATE-POOL-VARIABLES                       03220000
032300     END-IF.                                                      03230000
032400                                                                  03240000
032500     MOVE DP300-ISPF-PRINT-PARMS TO LS-ISPF-PRINT-PARMS.          03250000
032600                                                                  03260000
032700     GOBACK.                                                      03270000
032800                                                                  03280000
032900******************************************************************03290000
033000*  INITIALIZE FOR PROGRAM PROCESSING.  DEFINE VARIABLES TO ISPF  *03300000
033100*  THROUGH THE FUNCTION POOL FOR ALL SCREEN I/O NEEDS, AND       *03310000
033200*  SHARED OR PROFILE POOL RETRIEVAL (IF NOT DIRECTLY REFERENCED  *03320000
033300*  IN SCREEN I/O).  RETRIEVE THE CURRENT VALUES FOR ALL REQUIRED *03330000
033400*  SHARED OR PROFILE POOL VARIABLES.  SET UP THE INITIAL         *03340000
033500*  PRESENTATION OF THE PRINT REQUEST PANEL.  EDIT THE PARAMETER  *03350000
033600*  LIST PASSED TO THIS ROUTINE, AND FORMAT/PRESENT AN ERROR      *03360000
033700*  MESSAGE IF ANY ERRORS ARE DETECTED.                           *03370000
033800******************************************************************03380000
033900                                                                  03390000
034000 1000-INITIALIZE.                                                 03400000
034100     INITIALIZE DP300-OUTPUT-PARAMETERS.                          03410000
034200                                                                  03420000
034300*                                                                 03430000
034400*  DEFINE NON-DISPLAYED DIALOG VARIABLES TO ISPF THROUGH THE      03440000
034500*  FUNCTION POOL                                                  03450000
034600*                                                                 03460000
034700                                                                  03470000
034800*--------------------------------------------                     03480000
034900* LINES PER PAGE                                                  03490000
035000*--------------------------------------------                     03500000
035100     MOVE LENGTH OF ID-LINES-PER-PAGE TO IV-FIELD-LENGTH.         03510000
035200     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  03520000
035300                                     IN-FIELD-LINES-PER-PAGE      03530000
035400                                     ID-LINES-PER-PAGE            03540000
035500                                     IC-FIELD-FORMAT-CHAR         03550000
035600                                     IV-FIELD-LENGTH.             03560000
035700                                                                  03570000
035800*--------------------------------------------                     03580000
035900* OUTPUT PRINTER                                                  03590000
036000*--------------------------------------------                     03600000
036100     MOVE LENGTH OF ID-OUTPUT-PRINTER TO IV-FIELD-LENGTH.         03610000
036200     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  03620000
036300                                     IN-FIELD-OUTPUT-PRINTER      03630000
036400                                     ID-OUTPUT-PRINTER            03640000
036500                                     IC-FIELD-FORMAT-CHAR         03650000
036600                                     IV-FIELD-LENGTH.             03660000
036700                                                                  03670000
036800*--------------------------------------------                     03680000
036900* HP LASET JET FONT                                               03690000
037000*--------------------------------------------                     03700000
037100     MOVE LENGTH OF ID-HP-LASER-JET-FONT TO IV-FIELD-LENGTH.      03710000
037200     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  03720000
037300                                     IN-FIELD-HP-LASER-JET-FONT   03730000
037400                                     ID-HP-LASER-JET-FONT         03740000
037500                                     IC-FIELD-FORMAT-CHAR         03750000
037600                                     IV-FIELD-LENGTH.             03760000
037700                                                                  03770000
037800*                                                                 03780000
037900*  DEFINE DIALOG VARIABLES FOR LOCAL PANEL USAGE TO ISPF THROUGH  03790000
038000*  THE FUNCTION POOL                                              03800000
038100*                                                                 03810000
038200                                                                  03820000
038300     PERFORM 1100-DEFINE-CMNUPRT-VARIABLES.                       03830000
038400                                                                  03840000
038500     INITIALIZE ID-CMNUPRT-VARIABLES.                             03850000
038600                                                                  03860000
038700     PERFORM 1300-RETRIEVE-POOL-VARIABLES.                        03870000
038800                                                                  03880000
038900*                                                                 03890000
039000*  SET THE INITIAL VALUES FOR THE PANEL                           03900000
039100*                                                                 03910000
039200                                                                  03920000
039300     INITIALIZE ID-CMNUPRT-CMNUPRTE.                              03930000
039400     SET ID-CMNUPRT-CMNUPRTI-NO-PRINT TO TRUE.                    03940000
039500     MOVE ID-LINES-PER-PAGE TO ID-CMNUPRT-CMNUPRTL.               03950000
039600     SET ID-CMNUPRT-CMNUPRTC-1-COPY TO TRUE.                      03960000
039700     SET ID-CMNUPRT-CMNUPRTS-CLASS-A TO TRUE.                     03970000
039800     MOVE ID-OUTPUT-PRINTER TO ID-CMNUPRT-CMNUPRTD.               03980000
039900     MOVE ID-HP-LASER-JET-FONT TO ID-CMNUPRT-CMNUPRTF.            03990000
040000     SET ID-CMNUPRT-CMNUPRTU-UPDATE TO TRUE.                      04000000
040100                                                                  04010000
040200     PERFORM 1500-EDIT-PARAMETER-LIST.                            04020000
040300*1000-EXIT.                                                       04030000
040400                                                                  04040000
040500******************************************************************04050000
040600*  DEFINE THE CMNUPRT DIALOG VARIABLES TO ISPF THROUGH THE       *04060000
040700*  FUNCTION POOL.  CMNUPRT IS THE PRINT REQUEST PANEL.           *04070000
040800******************************************************************04080000
040900                                                                  04090000
041000 1100-DEFINE-CMNUPRT-VARIABLES.                                   04100000
041100*--------------------------------------------                     04110000
041200* ERROR MESSAGE                                                   04120000
041300*--------------------------------------------                     04130000
041400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTE TO IV-FIELD-LENGTH.       04140000
041500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04150000
041600                                     IN-FIELD-CMNUPRTE            04160000
041700                                     ID-CMNUPRT-CMNUPRTE          04170000
041800                                     IC-FIELD-FORMAT-CHAR         04180000
041900                                     IV-FIELD-LENGTH.             04190000
042000                                                                  04200000
042100*--------------------------------------------                     04210000
042200* PRINT OPTION - REQUEST PRINT (Y/N)                              04220000
042300*--------------------------------------------                     04230000
042400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTI TO IV-FIELD-LENGTH.       04240000
042500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04250000
042600                                     IN-FIELD-CMNUPRTI            04260000
042700                                     ID-CMNUPRT-CMNUPRTI          04270000
042800                                     IC-FIELD-FORMAT-CHAR         04280000
042900                                     IV-FIELD-LENGTH.             04290000
043000                                                                  04300000
043100*--------------------------------------------                     04310000
043200* NUMBER OF LINES PER PAGE REQUESTED                              04320000
043300*--------------------------------------------                     04330000
043400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTL TO IV-FIELD-LENGTH.       04340000
043500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04350000
043600                                     IN-FIELD-CMNUPRTL            04360000
043700                                     ID-CMNUPRT-CMNUPRTL          04370000
043800                                     IC-FIELD-FORMAT-CHAR         04380000
043900                                     IV-FIELD-LENGTH.             04390000
044000                                                                  04400000
044100*--------------------------------------------                     04410000
044200* NUMBER OF COPIES REQUESTED                                      04420000
044300*--------------------------------------------                     04430000
044400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTC TO IV-FIELD-LENGTH.       04440000
044500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04450000
044600                                     IN-FIELD-CMNUPRTC            04460000
044700                                     ID-CMNUPRT-CMNUPRTC          04470000
044800                                     IC-FIELD-FORMAT-CHAR         04480000
044900                                     IV-FIELD-LENGTH.             04490000
045000                                                                  04500000
045100*--------------------------------------------                     04510000
045200* OUTPUT CLASS                                                    04520000
045300*--------------------------------------------                     04530000
045400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTS TO IV-FIELD-LENGTH.       04540000
045500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04550000
045600                                     IN-FIELD-CMNUPRTS            04560000
045700                                     ID-CMNUPRT-CMNUPRTS          04570000
045800                                     IC-FIELD-FORMAT-CHAR         04580000
045900                                     IV-FIELD-LENGTH.             04590000
046000                                                                  04600000
046100*--------------------------------------------                     04610000
046200* OUTPUT PRINTER DESTINATION                                      04620000
046300*--------------------------------------------                     04630000
046400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTD TO IV-FIELD-LENGTH.       04640000
046500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04650000
046600                                     IN-FIELD-CMNUPRTD            04660000
046700                                     ID-CMNUPRT-CMNUPRTD          04670000
046800                                     IC-FIELD-FORMAT-CHAR         04680000
046900                                     IV-FIELD-LENGTH.             04690000
047000                                                                  04700000
047100*--------------------------------------------                     04710000
047200* HP LASER JET FONT                                               04720000
047300*--------------------------------------------                     04730000
047400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTF TO IV-FIELD-LENGTH.       04740000
047500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04750000
047600                                     IN-FIELD-CMNUPRTF            04760000
047700                                     ID-CMNUPRT-CMNUPRTF          04770000
047800                                     IC-FIELD-FORMAT-CHAR         04780000
047900                                     IV-FIELD-LENGTH.             04790000
048000                                                                  04800000
048100*--------------------------------------------                     04810000
048200* UPDATE PROFILE VARIABLES - (Y/N)                                04820000
048300*--------------------------------------------                     04830000
048400     MOVE LENGTH OF ID-CMNUPRT-CMNUPRTU TO IV-FIELD-LENGTH.       04840000
048500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04850000
048600                                     IN-FIELD-CMNUPRTU            04860000
048700                                     ID-CMNUPRT-CMNUPRTU          04870000
048800                                     IC-FIELD-FORMAT-CHAR         04880000
048900                                     IV-FIELD-LENGTH.             04890000
049000*1200-EXIT.                                                       04900000
049100                                                                  04910000
049200******************************************************************04920000
049300*  RETRIEVE VALUES FROM THE SHARED VARIABLE POOL OR APPLICATION  *04930000
049400*  PROFILE VARIABLE POOL AND PLACE THEM IN THE FUNCTION VARIABLE *04940000
049500*  POOL.                                                         *04950000
049600******************************************************************04960000
049700                                                                  04970000
049800 1300-RETRIEVE-POOL-VARIABLES.                                    04980000
049900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VGET     04990000
050000                                     IN-FIELD-LINES-PER-PAGE      05000000
050100                                     IC-PROFILE-VARIABLE-POOL.    05010000
050200                                                                  05020000
050300     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VGET     05030000
050400                                     IN-FIELD-OUTPUT-PRINTER      05040000
050500                                     IC-PROFILE-VARIABLE-POOL.    05050000
050600                                                                  05060000
050700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VGET     05070000
050800                                     IN-FIELD-HP-LASER-JET-FONT   05080000
050900                                     IC-PROFILE-VARIABLE-POOL.    05090000
051000*1300-EXIT.                                                       05100000
051100                                                                  05110000
051200******************************************************************05120000
051300*  UPDATE VALUES IN THE SHARED VARIABLE POOL OR APPLICATION      *05130000
051400*  PROFILE VARIABLE POOL USING THE VALUES IN THE FUNCTION        *05140000
051500*  VARIABLE POOL.                                                *05150000
051600******************************************************************05160000
051700                                                                  05170000
051800 1400-UPDATE-POOL-VARIABLES.                                      05180000
051900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VPUT     05190000
052000                                     IN-FIELD-LINES-PER-PAGE      05200000
052100                                     IC-PROFILE-VARIABLE-POOL.    05210000
052200                                                                  05220000
052300     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VPUT     05230000
052400                                     IN-FIELD-OUTPUT-PRINTER      05240000
052500                                     IC-PROFILE-VARIABLE-POOL.    05250000
052600                                                                  05260000
052700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VPUT     05270000
052800                                     IN-FIELD-HP-LASER-JET-FONT   05280000
052900                                     IC-PROFILE-VARIABLE-POOL.    05290000
053000*1400-EXIT.                                                       05300000
053100                                                                  05310000
053200******************************************************************05320000
053300*  EDIT THE PARAMETER LIST PASSED TO THIS ROUTINE.  IF ANY       *05330000
053400*  ERRORS ARE DETECTED, FORMAT AN ERROR MESSAGE.  THIS MESSAGE   *05340000
053500*  WILL BE PRESENTED ON ALL EDIT PASSES THROUGH THE PRINT        *05350000
053600*  REQUEST PANEL, AND WILL BE RETURNED TO THE CALLING PROGRAM.   *05360000
053700******************************************************************05370000
053800                                                                  05380000
053900 1500-EDIT-PARAMETER-LIST.                                        05390000
054000     SET PS-NO-PARAMETER-LIST-ERRORS TO TRUE.                     05400000
054100                                                                  05410000
054200     IF DP300-CALLING-PROGRAM-NAME = SPACES                       05420000
054300         IF PS-NO-PARAMETER-LIST-ERRORS                           05430000
054400             MOVE 'PARAMETER LIST ERROR - PROGRAM NAME REQUIRED'  05440000
054500                       TO PV-PARAMETER-LIST-ERROR-MSG             05450000
054600             SET PS-PARAMETER-LIST-ERROR TO TRUE                  05460000
054700         END-IF                                                   05470000
054800     END-IF.                                                      05480000
054900                                                                  05490000
055000     IF DP300-CALLING-REPORT-NUMBER = ZERO                        05500000
055100         IF PS-NO-PARAMETER-LIST-ERRORS                           05510000
055200             MOVE 'PARAMETER LIST ERROR - REPORT NUMBER REQUIRED' 05520000
055300                       TO PV-PARAMETER-LIST-ERROR-MSG             05530000
055400             SET PS-PARAMETER-LIST-ERROR TO TRUE                  05540000
055500         END-IF                                                   05550000
055600     END-IF.                                                      05560000
055700                                                                  05570000
055800*                                                                 05580000
055900*  DATASET EXISTENCE WILL BE CHECKED DURING THE ALLOCATION        05590000
056000*  PROCESS.                                                       05600000
056100*                                                                 05610000
056200                                                                  05620000
056300     IF DP300-FILE-DSNAME = SPACES                                05630000
056400         IF PS-NO-PARAMETER-LIST-ERRORS                           05640000
056500             MOVE 'PARAMETER LIST ERROR - DATASET NAME REQUIRED'  05650000
056600                       TO PV-PARAMETER-LIST-ERROR-MSG             05660000
056700             SET PS-PARAMETER-LIST-ERROR TO TRUE                  05670000
056800         END-IF                                                   05680000
056900     END-IF.                                                      05690000
057000                                                                  05700000
057100*                                                                 05710000
057200*  RECORD FORMAT ACCURACY WILL BE CHECKED DURING THE ALLOCATION   05720000
057300*  PROCESS, SINCE ONLY CERTAIN FORMATS ARE SUPPORTED BY THE       05730000
057400*  DYNALC ROUTINE.                                                05740000
057500*                                                                 05750000
057600                                                                  05760000
057700     IF DP300-FILE-RECFM = SPACES                                 05770000
057800         IF PS-NO-PARAMETER-LIST-ERRORS                           05780000
057900             MOVE 'PARAMETER LIST ERROR - RECORD FORMAT REQUIRED' 05790000
058000                       TO PV-PARAMETER-LIST-ERROR-MSG             05800000
058100             SET PS-PARAMETER-LIST-ERROR TO TRUE                  05810000
058200         END-IF                                                   05820000
058300     END-IF.                                                      05830000
058400                                                                  05840000
058410     EVALUATE TRUE                                                05841000
058500         WHEN DP300-FILE-LRECL = ZERO                             05850000
058600             IF PS-NO-PARAMETER-LIST-ERRORS                       05860000
058700                 MOVE 'PARAMETER LIST ERROR - RECORD LENGTH REQUIR05870001
058800-                          'ED' TO PV-PARAMETER-LIST-ERROR-MSG    05880001
058900                 SET PS-PARAMETER-LIST-ERROR TO TRUE              05890001
059000             END-IF                                               05900001
059010         WHEN DP300-FILE-LRECL > (LENGTH OF PV-PRINT-LINE)        05901007
059020             IF PS-NO-PARAMETER-LIST-ERRORS                       05902001
059030                 MOVE 'PARAMETER LIST ERROR - LRECL > THE MAXIMUM 05903001
059040-                          'SUPPORTED' TO                         05904001
059050                           PV-PARAMETER-LIST-ERROR-MSG            05905001
059060                 SET PS-PARAMETER-LIST-ERROR TO TRUE              05906001
059070             END-IF                                               05907001
059080         WHEN DP300-FL-80                                         05908001
059081             MOVE PC-PRINTABLE-FILE-80-DDNAME TO                  05908101
059082                       PV-PRINTABLE-FILE-DDNAME                   05908201
059083             MOVE PC-PRINT-FILE-80-DDNAME TO                      05908301
059084                       PV-PRINT-FILE-DDNAME                       05908401
059090         WHEN DP300-FL-132                                        05909001
059091             MOVE PC-PRINTABLE-FILE-132-DDNAME TO                 05909101
059092                       PV-PRINTABLE-FILE-DDNAME                   05909201
059093             MOVE PC-PRINT-FILE-132-DDNAME TO                     05909301
059094                       PV-PRINT-FILE-DDNAME                       05909401
059095         WHEN OTHER                                               05909501
059096             IF PS-NO-PARAMETER-LIST-ERRORS                       05909601
059097                 MOVE 'PARAMETER LIST ERROR - EXACT LRECL NOT SUPP05909701
059098-                      'ORTED' TO PV-PARAMETER-LIST-ERROR-MSG     05909801
059099                 SET PS-PARAMETER-LIST-ERROR TO TRUE              05909901
059100             END-IF                                               05910001
059200     END-EVALUATE.                                                05920001
060000                                                                  06000000
060100     IF ((NOT DP300-PT-PRINT-TITLE-LINE)                          06010000
060200             AND (NOT DP300-PT-DONT-PRINT-TITLE-LINE))            06020000
060300         IF PS-NO-PARAMETER-LIST-ERRORS                           06030000
060400             MOVE 'PARAMETER LIST ERROR - INVALID PRINT TITLE REQU06040000
060500-                      'EST' TO PV-PARAMETER-LIST-ERROR-MSG       06050000
060600             SET PS-PARAMETER-LIST-ERROR TO TRUE                  06060000
060700         END-IF                                                   06070000
060800     END-IF.                                                      06080000
060900                                                                  06090000
061000     IF ((NOT DP300-RH-REPEAT-HEADINGS)                           06100000
061100             AND (NOT DP300-RH-DONT-REPEAT-HEADINGS))             06110000
061200         IF PS-NO-PARAMETER-LIST-ERRORS                           06120000
061300             MOVE 'PARAMETER LIST ERROR - INVALID REPEAT HEADINGS 06130000
061400-                      'REQUEST' TO PV-PARAMETER-LIST-ERROR-MSG   06140000
061500             SET PS-PARAMETER-LIST-ERROR TO TRUE                  06150000
061600         END-IF                                                   06160000
061700     END-IF.                                                      06170000
061800                                                                  06180000
061900     IF ((DP300-HEADING-LINE-COUNT = ZERO)                        06190000
062000             AND (DP300-RH-REPEAT-HEADINGS))                      06200000
062100         IF PS-NO-PARAMETER-LIST-ERRORS                           06210000
062200             MOVE 'PARAMETER LIST ERROR - NO HEADING LINES; CANNOT06220000
062300-                      'REPEAT THEM' TO                           06230000
062400                       PV-PARAMETER-LIST-ERROR-MSG                06240000
062500             SET PS-PARAMETER-LIST-ERROR TO TRUE                  06250000
062600         END-IF                                                   06260000
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900     IF DP300-HEADING-LINE-COUNT > PC-MAXIMUM-HEADING-LINE-COUNT  06290000
063000         IF PS-NO-PARAMETER-LIST-ERRORS                           06300000
063100             MOVE 'PARAMETER LIST ERROR - HEADING LINE COUNT > MAX06310000
063200-                      ' SUPPORTED' TO                            06320000
063300                       PV-PARAMETER-LIST-ERROR-MSG                06330000
063400             SET PS-PARAMETER-LIST-ERROR TO TRUE                  06340000
063500         END-IF                                                   06350000
063600     END-IF.                                                      06360000
063700                                                                  06370000
063800     IF PS-NO-PARAMETER-LIST-ERRORS                               06380000
063900         IF DP300-PT-PRINT-TITLE-LINE                             06390000
064000             COMPUTE PV-TOTAL-HEADING-LINE-COUNT =                06400000
064100                       (DP300-HEADING-LINE-COUNT + 1)             06410000
064200         ELSE                                                     06420000
064300             MOVE DP300-HEADING-LINE-COUNT TO                     06430000
064400                       PV-TOTAL-HEADING-LINE-COUNT                06440000
064500         END-IF                                                   06450000
064600     END-IF.                                                      06460000
064700                                                                  06470000
064800     MOVE PV-PARAMETER-LIST-ERROR-MSG TO ID-CMNUPRT-CMNUPRTE.     06480000
064900*1500-EXIT.                                                       06490000
065000                                                                  06500000
065100******************************************************************06510000
065200*  PROCESS A PRINT REQUEST ENTERED ON THE CMNUPRT PANEL.  IF A   *06520000
065300*  PARAMETER LIST ERROR WAS DETECTED, IMMEDIATELY FLAG THAT      *06530000
065400*  ERROR.  EDIT THE FIELDS TO MAKE CERTAIN THAT A VALID AND      *06540000
065500*  COMPLETE PRINT REQUEST WAS SPECIFIED.  IF ANY ERRORS ARE      *06550000
065600*  DETECTED, REDISPLAY THE PRINT REQUEST SPECIFICATION PANEL     *06560000
065610*  WITH THE WITH THE APPROPRIATE ERROR MESSAGE AND CURSOR        *06561000
065620*  POSITION.                                                     *06562000
065630******************************************************************06563000
065640                                                                  06564000
065650 2000-EDIT-PRINT-REQUEST.                                         06565000
065660     SET PS-NO-EDIT-ERRORS TO TRUE.                               06566000
065670                                                                  06567000
065680*                                                                 06568000
065690*  STOP ANY REQUEST FROM PROCESSING IF AN INVALID PARAMETER LIST  06569000
065700*  WAS PASSED.  FORCE AN END TO BE REQUESTED TO EXIT THE PANEL.   06570000
065800*                                                                 06580000
065900                                                                  06590000
066000     IF PS-PARAMETER-LIST-ERROR                                   06600000
066100         MOVE PV-PARAMETER-LIST-ERROR-MSG TO                      06610000
066200                   ID-CMNUPRT-CMNUPRTE                            06620000
066300         SET PS-EDIT-ERROR TO TRUE                                06630000
066400     END-IF.                                                      06640000
066500                                                                  06650000
066600*                                                                 06660000
066700*  EDIT THE PRINT OPTION                                          06670000
066800*                                                                 06680000
066900                                                                  06690000
067000     IF ((NOT ID-CMNUPRT-CMNUPRTI-PRINT)                          06700000
067100             AND (NOT ID-CMNUPRT-CMNUPRTI-NO-PRINT))              06710000
067200         IF PS-NO-EDIT-ERRORS                                     06720000
067300             MOVE 'INVALID PRINT OPTION SPECIFIED' TO             06730000
067400                       ID-CMNUPRT-CMNUPRTE                        06740000
067500             SET PS-EDIT-ERROR TO TRUE                            06750000
067600             MOVE IN-FIELD-CMNUPRTI TO                            06760000
067700                       IV-CURSOR-POSITION                         06770000
067800         END-IF                                                   06780000
067900     END-IF.                                                      06790000
068000                                                                  06800000
068100*                                                                 06810000
068200*  EDIT THE NUMBER OF LINES PER PAGE REQUESTED                    06820000
068300*                                                                 06830000
068400                                                                  06840000
068500     IF ((ID-CMNUPRT-CMNUPRTL NOT NUMERIC)                        06850000
068600             OR (ID-CMNUPRT-CMNUPRTL-N NOT >                      06860000
068700                                    PV-TOTAL-HEADING-LINE-COUNT)) 06870000
068800         IF PS-NO-EDIT-ERRORS                                     06880000
068900             IF (ID-CMNUPRT-CMNUPRTL NOT NUMERIC)                 06890000
069000                 MOVE 'THE LINES PER PAGE MUST BE SPECIFIED AND NU06900000
069100-                          'MERIC' TO ID-CMNUPRT-CMNUPRTE         06910000
069200             ELSE                                                 06920000
069300                 MOVE 'THE LINES PER PAGE MUST BE > THE HEADINGS B06930000
069400-                          'EING PRINTED' TO ID-CMNUPRT-CMNUPRTE  06940000
069500             END-IF                                               06950000
069600             SET PS-EDIT-ERROR TO TRUE                            06960000
069700             MOVE IN-FIELD-CMNUPRTL TO                            06970000
069800                       IV-CURSOR-POSITION                         06980000
069900         END-IF                                                   06990000
070000     END-IF.                                                      07000000
070100                                                                  07010000
070200*                                                                 07020000
070300*  EDIT THE NUMBER OF COPIES REQUESTED                            07030000
070400*                                                                 07040000
070500                                                                  07050000
070600     IF ((ID-CMNUPRT-CMNUPRTC NOT NUMERIC)                        07060000
070700             OR (ID-CMNUPRT-CMNUPRTC-N NOT > ZEROS))              07070000
070800         IF PS-NO-EDIT-ERRORS                                     07080000
070900             IF (ID-CMNUPRT-CMNUPRTC NOT NUMERIC)                 07090000
071000                 MOVE 'THE NUMBER OF COPIES MUST BE SPECIFIED AND 07100000
071100-                          'NUMERIC' TO ID-CMNUPRT-CMNUPRTE       07110000
071200             ELSE                                                 07120000
071300                 MOVE 'THE NUMBER OF COPIES MUST BE GREATER THAN Z07130000
071400-                          'ERO' TO ID-CMNUPRT-CMNUPRTE           07140000
071500             END-IF                                               07150000
071600             SET PS-EDIT-ERROR TO TRUE                            07160000
071700             MOVE IN-FIELD-CMNUPRTC TO                            07170000
071800                       IV-CURSOR-POSITION                         07180000
071900         END-IF                                                   07190000
072000     END-IF.                                                      07200000
072100                                                                  07210000
072200*                                                                 07220000
072300*  EDIT THE OUTPUT CLASS                                          07230000
072400*                                                                 07240000
072500                                                                  07250000
072600     IF ID-CMNUPRT-CMNUPRTS = SPACES                              07260000
072700         IF PS-NO-EDIT-ERRORS                                     07270000
072800             MOVE 'AN OUTPUT CLASS MUST BE SPECIFIED' TO          07280000
072900                       ID-CMNUPRT-CMNUPRTE                        07290000
073000             SET PS-EDIT-ERROR TO TRUE                            07300000
073100             MOVE IN-FIELD-CMNUPRTS TO                            07310000
073200                       IV-CURSOR-POSITION                         07320000
073300         END-IF                                                   07330000
073400     END-IF.                                                      07340000
073500                                                                  07350000
073600*                                                                 07360000
073700*  EDIT THE OUTPUT PRINTER DESTINATION                            07370000
073800*                                                                 07380000
073900                                                                  07390000
074000     IF ID-CMNUPRT-CMNUPRTD = SPACES                              07400000
074100         IF PS-NO-EDIT-ERRORS                                     07410000
074200             MOVE 'AN OUTPUT PRINTER MUST BE SPECIFIED' TO        07420000
074300                       ID-CMNUPRT-CMNUPRTE                        07430000
074400             SET PS-EDIT-ERROR TO TRUE                            07440000
074500             MOVE IN-FIELD-CMNUPRTD TO                            07450000
074600                       IV-CURSOR-POSITION                         07460000
074700         END-IF                                                   07470000
074800     END-IF.                                                      07480000
074900                                                                  07490000
075000*                                                                 07500000
075100*  EDIT THE HP LASER JET FONT - THIS MATCHES THE EDITS AND        07510000
075200*  WRITER TRANSLATIONS DONE BY THE 4.H FORGROUND VPS PRINT        07520000
075300*  UTILITY PANEL, SINCE THE PROFILE VARIABLES USED ARE PRIMARILY  07530000
075400*  DEFINED FOR USE BY THAT PANEL.                                 07540000
075500*                                                                 07550000
075600                                                                  07560000
075700* INACTIVE UNTIL THE WRITER DEFINITIONS CAN BE SUPPORTED DURING   07570000
075800* ALLOCATION                                                      07580000
075900*                                                                 07590000
076000*    EVALUATE TRUE                                                07600000
076100*        WHEN ID-CMNUPRT-CMNUPRTF = SPACES                        07610000
076200*            IF ((ID-CMNUPRT-CMNUPRTD-U4)                         07620000
076300*                    OR (ID-CMNUPRT-CMNUPRTD-U6)                  07630000
076400*                    OR (ID-CMNUPRT-CMNUPRTD-U7))                 07640000
076500*                MOVE 'A FONT MUST BE SPECIFIED FOR THIS PRINTER' 07650000
076600*                          TO ID-CMNUPRT-CMNUPRTE                 07660000
076700*                SET PS-EDIT-ERROR TO TRUE                        07670000
076800*                MOVE IN-FIELD-CMNUPRTF TO                        07680000
076900*                          IV-CURSOR-POSITION                     07690000
077000*            END-IF                                               07700000
077100*        WHEN ID-CMNUPRT-CMNUPRTD-LOCAL                           07710000
077200*            SET PV-WD-NO-WRITER TO TRUE                          07720000
077300*        WHEN ID-CMNUPRT-CMNUPRTF-L-DUP                           07730000
077400*            SET PV-WD-LANDSCAPE-DUPLEX TO TRUE                   07740000
077500*        WHEN ID-CMNUPRT-CMNUPRTF-L-DUP-UND                       07750000
077600*            SET PV-WD-LANDSCAPE-DUPLEX-UNDRLN TO TRUE            07760000
077700*        WHEN ID-CMNUPRT-CMNUPRTF-L-SIM                           07770000
077800*            SET PV-WD-LANDSCAPE-SIMPLEX TO TRUE                  07780000
077900*        WHEN ID-CMNUPRT-CMNUPRTF-L-SIM-UND                       07790000
078000*            SET PV-WD-LANDSCAPE-SIMPLEX-UNDRLN TO TRUE           07800000
078100*        WHEN ID-CMNUPRT-CMNUPRTF-P-DUP                           07810000
078200*            SET PV-WD-PORTRAIT-DUPLEX TO TRUE                    07820000
078300*        WHEN ID-CMNUPRT-CMNUPRTF-P-DUP-UND                       07830000
078400*            SET PV-WD-PORTRAIT-DUPLEX-UNDRLN TO TRUE             07840000
078500*        WHEN ID-CMNUPRT-CMNUPRTF-P-SIM                           07850000
078600*            SET PV-WD-PORTRAIT-SIMPLEX TO TRUE                   07860000
078700*        WHEN ID-CMNUPRT-CMNUPRTF-P-SIM-UND                       07870000
078800*            SET PV-WD-PORTRAIT-SIMPLEX-UNDRLN TO TRUE            07880000
078900*        WHEN OTHER                                               07890000
079000*            MOVE 'AN INVALID FONT WAS SPECIFIED' TO              07900000
079100*                      ID-CMNUPRT-CMNUPRTE                        07910000
079200*            SET PS-EDIT-ERROR TO TRUE                            07920000
079300*            MOVE IN-FIELD-CMNUPRTF TO                            07930000
079400*                      IV-CURSOR-POSITION                         07940000
079500*    END-EVALUATE.                                                07950000
079600                                                                  07960000
079700*                                                                 07970000
079800*  EDIT THE UPDATE PROFILE VARIABLES OPTION                       07980000
079900*                                                                 07990000
080000                                                                  08000000
080100     IF ((NOT ID-CMNUPRT-CMNUPRTU-UPDATE)                         08010000
080200             AND (NOT ID-CMNUPRT-CMNUPRTU-NO-UPDATE))             08020000
080300         IF PS-NO-EDIT-ERRORS                                     08030000
080400             MOVE 'INVALID UPDATE PROFILE OPTION SPECIFIED' TO    08040000
080500                       ID-CMNUPRT-CMNUPRTE                        08050000
080600             SET PS-EDIT-ERROR TO TRUE                            08060000
080700             MOVE IN-FIELD-CMNUPRTU TO                            08070000
080800                       IV-CURSOR-POSITION                         08080000
080900         END-IF                                                   08090000
081000     END-IF.                                                      08100000
081100                                                                  08110000
081200     IF PS-EDIT-ERROR                                             08120000
081300         PERFORM 9100-DISPLAY-PRINT-REQ-PANEL                     08130000
081400     END-IF.                                                      08140000
081500*2000-EXIT.                                                       08150000
081600                                                                  08160000
081700******************************************************************08170000
081800*  BUILD A PRINT FILE USING THE PRE-FORMATTED DETAIL LINES.      *08180000
081900*  RETAIN ANY HEADING LINES, AS DEFINED BY THE PARAMETER LIST.   *08190000
082000*  WHEN THE LINES/PAGE EXCEEDS THE LIMIT SPECIFIED IN THE        *08200000
082100*  PARAMETER LIST, WRITE OUT A TITLE LINES (IF REQUESTED), AND   *08210000
082200*  REPEAT ALL HEADING LINES (IF REQUESTED) TO START A NEW PAGE.  *08220000
082300*  WRITE EACH RECORD FROM THE FILE TO BE PRINTED OUT TO THE      *08230000
082400*  PRINT FILE, WHICH IS ALLOCATED TO THE CORRECT PRINT           *08240000
082500*  DESTINATION.                                                  *08250000
082600******************************************************************08260000
082700                                                                  08270000
082800 4000-PRINT-RESULTS.                                              08280000
082810     IF DP300-FL-80                                               08281001
082900         OPEN INPUT  PRINTABLE-FILE-80                            08290001
083000              OUTPUT PRINT-FILE-80                                08300001
083010     ELSE                                                         08301001
083020         OPEN INPUT  PRINTABLE-FILE-132                           08302001
083030              OUTPUT PRINT-FILE-132                               08303001
083040     END-IF.                                                      08304001
083100                                                                  08310000
083200     SET PS-NOT-END-OF-PRINTABLE-FILE TO TRUE.                    08320000
083300     PERFORM 7000-READ-PRINTABLE-FILE.                            08330000
083400                                                                  08340000
083500     INITIALIZE HL-HEADING-LINE-TABLE.                            08350000
083510                                                                  08351000
083520     PERFORM                                                      08352000
083530             VARYING HL-INDEX FROM 1 BY 1                         08353000
083531             UNTIL ((PS-END-OF-PRINTABLE-FILE)                    08353100
083532                       OR (HL-INDEX > DP300-HEADING-LINE-COUNT))  08353200
083537         MOVE PV-PRINTABLE-RECORD TO                              08353707
083538                   HL-HEADING-LINE (HL-INDEX)                     08353807
083540         PERFORM 7000-READ-PRINTABLE-FILE                         08354001
083541     END-PERFORM.                                                 08354101
083542                                                                  08354201
083543     IF DP300-FL-80                                               08354307
083544         MOVE FUNCTION CURRENT-DATE (1:4) TO DP075-RUN-YEAR       08354407
083546         MOVE FUNCTION CURRENT-DATE (5:2) TO DP075-RUN-MONTH      08354607
083548         MOVE FUNCTION CURRENT-DATE (7:2) TO DP075-RUN-DAY        08354807
083550         MOVE FUNCTION CURRENT-DATE (9:2) TO DP075-RUN-HOUR       08355007
083552         MOVE FUNCTION CURRENT-DATE (11:2) TO DP075-RUN-MINUTE    08355207
083560         MOVE DP300-CALLING-PROGRAM-NAME TO DP075-PROGRAM-NAME    08356007
083570         MOVE DP300-CALLING-REPORT-NUMBER TO DP075-REPORT-NUMBER  08357007
083571     ELSE                                                         08357107
083572         MOVE FUNCTION CURRENT-DATE (1:4) TO DP132-RUN-YEAR       08357207
083573         MOVE FUNCTION CURRENT-DATE (5:2) TO DP132-RUN-MONTH      08357307
083574         MOVE FUNCTION CURRENT-DATE (7:2) TO DP132-RUN-DAY        08357407
083575         MOVE FUNCTION CURRENT-DATE (9:2) TO DP132-RUN-HOUR       08357507
083576         MOVE FUNCTION CURRENT-DATE (11:2) TO DP132-RUN-MINUTE    08357607
083577         MOVE DP300-CALLING-PROGRAM-NAME TO DP132-PROGRAM-NAME    08357707
083578         MOVE DP300-CALLING-REPORT-NUMBER TO DP132-REPORT-NUMBER  08357807
083579     END-IF.                                                      08357907
083580                                                                  08358000
083590     INITIALIZE PV-PAGE-NUMBER.                                   08359007
083600     MOVE ID-CMNUPRT-CMNUPRTL-N TO PV-LINE-COUNT.                 08360000
083610                                                                  08361000
083620     PERFORM                                                      08362000
083630             WITH TEST AFTER                                      08363000
083640             UNTIL PS-END-OF-PRINTABLE-FILE                       08364000
083650         IF (PV-LINE-COUNT NOT < ID-CMNUPRT-CMNUPRTL-N)           08365000
083660             ADD +1 TO PV-PAGE-NUMBER                             08366000
083670             IF DP300-PT-PRINT-TITLE-LINE                         08367000
083671                 IF DP300-FL-80                                   08367101
083680                     MOVE PV-PAGE-NUMBER TO DP075-PAGE-NUMBER     08368001
083690                     MOVE DP075-STANDARD-HEADER-75-COLS TO        08369001
083700                               PV-PRINT-LINE                      08370007
083710                 ELSE                                             08371001
083720                     MOVE PV-PAGE-NUMBER TO DP132-PAGE-NUMBER     08372001
083730                     MOVE DP132-STANDRD-HEADER-132-COLS TO        08373003
083740                               PV-PRINT-LINE                      08374008
083750                 END-IF                                           08375001
083800                 PERFORM 8100-WRITE-PRINT-LINE                    08380000
083810             END-IF                                               08381000
083820*                                                                 08382000
083830*  SINCE THE HEADING LINES ARE CAPTURED WITH INITIAL READS OF THE 08383000
083840*  PRINT FILE, THEY MUST BE PRINTED FROM THE CORE TABLE ON THE    08384000
083850*  FIRST PAGE OF THE PRINTED REPORT, REGARDLESS OF WHETHER OR NOT 08385000
083860*  THEY ARE REQUESTED TO BE REPEATED ON SUBSEQUENT PAGES.         08386000
083861*                                                                 08386100
083862             IF ((DP300-RH-REPEAT-HEADINGS)                       08386200
083863                     OR (PV-PAGE-NUMBER = 1))                     08386300
083864                 PERFORM                                          08386400
083865                         VARYING HL-INDEX FROM 1 BY 1             08386500
083866                         UNTIL HL-INDEX > DP300-HEADING-LINE-COUNT08386600
083871                     MOVE HL-HEADING-LINE (HL-INDEX) TO           08387107
083872                               PV-PRINT-LINE                      08387207
083874                     PERFORM 8100-WRITE-PRINT-LINE                08387401
083875                 END-PERFORM                                      08387501
083876             END-IF                                               08387601
083877         END-IF                                                   08387701
083879         MOVE PV-PRINTABLE-RECORD TO PV-PRINT-LINE                08387907
083885         PERFORM 8100-WRITE-PRINT-LINE                            08388501
083886*                                                                 08388601
083887*  THIS CHECK, IN CONJUNCTION WITH THE "WITH TEST AFTER" IS A     08388701
083888*  PRECAUTION IN THE CASE THAT A FILE WITH ONLY HEADER LINES, AND 08388801
083889*  NO DETAIL, IS PASSED TO THIS ROUTINE.                          08388901
083890*                                                                 08389001
083891         IF (NOT PS-END-OF-PRINTABLE-FILE)                        08389101
083900             PERFORM 7000-READ-PRINTABLE-FILE                     08390000
084000         END-IF                                                   08400000
084100     END-PERFORM.                                                 08410000
084200                                                                  08420000
084210     IF DP300-FL-80                                               08421001
084300         CLOSE PRINTABLE-FILE-80                                  08430001
084400               PRINT-FILE-80                                      08440001
084410     ELSE                                                         08441001
084420         CLOSE PRINTABLE-FILE-132                                 08442001
084430               PRINT-FILE-132                                     08443001
084440     END-IF.                                                      08444001
084500*4000-EXIT.                                                       08450000
084600                                                                  08460000
084700******************************************************************08470000
084800*  READ A PRINTABLE RECORD.                                      *08480000
084900******************************************************************08490000
085000                                                                  08500000
085100 7000-READ-PRINTABLE-FILE.                                        08510000
085110     IF DP300-FL-80                                               08511001
085200         READ PRINTABLE-FILE-80                                   08520001
085210             INTO PV-PRINTABLE-RECORD                             08521007
085300             AT END                                               08530001
085400                 SET PS-END-OF-PRINTABLE-FILE TO TRUE             08540001
085600         END-READ                                                 08560001
085610     ELSE                                                         08561001
085620         READ PRINTABLE-FILE-132                                  08562001
085621             INTO PV-PRINTABLE-RECORD                             08562107
085630             AT END                                               08563001
085640                 SET PS-END-OF-PRINTABLE-FILE TO TRUE             08564001
085660         END-READ                                                 08566001
085670     END-IF.                                                      08567005
085700*7000-EXIT.                                                       08570000
085800                                                                  08580000
085900******************************************************************08590000
086000*  WRITE A PRINT LINE.  ADVANCE TO A NEW PAGE IF THE LINES/PAGE  *08600000
086100*  COUNT FROM THE PARAMETER LIST HAS BEEN EXCEEDED.              *08610000
086200******************************************************************08620000
086300                                                                  08630000
086400 8100-WRITE-PRINT-LINE.                                           08640000
086410     IF (PV-LINE-COUNT NOT < ID-CMNUPRT-CMNUPRTL-N)               08641000
086411         IF DP300-FL-80                                           08641101
086420             WRITE PF-PRINT-LINE-80                               08642001
086421                 FROM PV-PRINT-LINE-80                            08642107
086430                 AFTER ADVANCING PAGE                             08643001
086431         ELSE                                                     08643101
086432             WRITE PF-PRINT-LINE-132                              08643201
086433                 FROM PV-PRINT-LINE-132                           08643307
086434                 AFTER ADVANCING PAGE                             08643401
086435         END-IF                                                   08643501
086440         MOVE +1 TO PV-LINE-COUNT                                 08644000
086450     ELSE                                                         08645000
086451         IF DP300-FL-80                                           08645101
086460             WRITE PF-PRINT-LINE-80                               08646001
086461                 FROM PV-PRINT-LINE-80                            08646107
086470                 AFTER ADVANCING 1 LINE                           08647001
086471         ELSE                                                     08647101
086472             WRITE PF-PRINT-LINE-132                              08647201
086473                 FROM PV-PRINT-LINE-132                           08647307
086474                 AFTER ADVANCING 1 LINE                           08647401
086475         END-IF                                                   08647501
086480         ADD +1 TO PV-LINE-COUNT                                  08648000
086490     END-IF.                                                      08649000
086500*8100-EXIT.                                                       08650000
086600                                                                  08660000
086700******************************************************************08670000
086800*  ESTABLISH THE PRINT REQUEST PANEL AS A POP-UP PANEL.          *08680000
086900******************************************************************08690000
087000                                                                  08700000
087100 9000-ADD-PRINT-REQ-PANEL.                                        08710000
087200     CALL IC-ISPF-SERVICE-LINK USING IC-DISPLAY-SERVICE-ADDPOP    08720000
087300                                     PC-PRINT-PANEL-ROW-OFFSET    08730000
087400                                     PC-PRINT-PANEL-COLUMN-OFFSET.08740000
087500*9000-EXIT.                                                       08750000
087600                                                                  08760000
087700******************************************************************08770000
087800*  DISPLAY THE PRINT REQUEST POP-UP PANEL.                       *08780000
087900******************************************************************08790000
088000                                                                  08800000
088100 9100-DISPLAY-PRINT-REQ-PANEL.                                    08810000
088200     IF IV-CURSOR-POSITION = SPACES                               08820000
088300         MOVE IN-FIELD-CMNUPRTI TO IV-CURSOR-POSITION             08830000
088400     END-IF.                                                      08840000
088500                                                                  08850000
088600     CALL IC-ISPF-SERVICE-LINK USING IC-DISPLAY-SERVICE-DISPLAY   08860000
088700                                     IN-PANEL-CMNUPRT             08870000
088800                                     IV-ERROR-MESSAGE-FORMAT      08880000
088900                                     IV-CURSOR-POSITION.          08890000
089000                                                                  08900000
089100     INITIALIZE IV-CURSOR-POSITION                                08910000
089200                ID-CMNUPRT-CMNUPRTE.                              08920000
089300*9100-EXIT.                                                       08930000
089400                                                                  08940000
089500******************************************************************08950000
089600*  REMOVE THE PRINT REQUEST POP-UP PANEL.                        *08960000
089700******************************************************************08970000
089800                                                                  08980000
089900 9200-REMOVE-PRINT-REQ-PANEL.                                     08990000
090000     CALL IC-ISPF-SERVICE-LINK USING IC-DISPLAY-SERVICE-REMPOP.   09000000
090100*9200-EXIT.                                                       09010000
090200                                                                  09020000
090300******************************************************************09030000
090400*  ALLOCATE THE FILE TO BE PRINTED USING THE DYNALC SUBROUTINE   *09040000
090500*  WITH A DISPOSITION OF SHARE.                                  *09050000
090600******************************************************************09060000
090700                                                                  09070000
090800 9500-ALLOCATE-PRINTABLE-FILE.                                    09080000
090900     INITIALIZE DP023-DYNALC-PARMS.                               09090000
091000     MOVE PV-PRINTABLE-FILE-DDNAME TO DP023-DDNAME.               09100001
091100     MOVE DP300-FILE-DSNAME TO DP023-DSNAME.                      09110000
091200     SET DP023-DISP-SHARE TO TRUE.                                09120000
091300     SET DP023-FREE-CLOSE-YES TO TRUE.                            09130000
091400     MOVE DP300-FILE-RECFM TO DP023-RECFM.                        09140000
091500     MOVE DP300-FILE-LRECL TO DP023-RECSZ.                        09150000
091600                                                                  09160000
091700     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     09170000
091800                                                                  09180000
091900     PERFORM DP023-0000-DYNALC.                                   09190000
092000                                                                  09200000
092100     IF DP023-LASTRC NOT = ZERO                                   09210000
092200         MOVE DP023-DDNAME TO PV-DR-DDNAME                        09220000
092300         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           09230000
092400         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          09240000
092500         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO DP300-ERROR-MESSAGE  09250000
092600     END-IF.                                                      09260000
092700*9500-EXIT.                                                       09270000
092800                                                                  09280000
092900******************************************************************09290000
093000*  ALLOCATE THE PRINT FILE USING THE DYNALC SUBROUTINE.          *09300000
093100******************************************************************09310000
093200                                                                  09320000
093300 9700-ALLOCATE-PRINT-FILE.                                        09330000
093400     INITIALIZE DP023-DYNALC-PARMS.                               09340000
093500                                                                  09350000
093600     MOVE PV-PRINT-FILE-DDNAME TO DP023-DDNAME.                   09360001
093700     INITIALIZE DP023-DSNAME.                                     09370000
093800     SET DP023-DISP-NEW TO TRUE.                                  09380000
093900     SET DP023-FREE-CLOSE-YES TO TRUE.                            09390000
094000     SET DP023-RECFM-FIXED-BLOCK-ARCH TO TRUE.                    09400000
094010     IF DP300-FL-80                                               09401002
094100         COMPUTE DP023-RECSZ =                                    09410002
094200                   ((LENGTH OF PF-PRINT-LINE-80) + 1)             09420004
094210     ELSE                                                         09421002
094220         COMPUTE DP023-RECSZ =                                    09422002
094230                   ((LENGTH OF PF-PRINT-LINE-132) + 1)            09423004
094240     END-IF.                                                      09424002
094300     INITIALIZE DP023-RECOUNT.                                    09430000
094400     MOVE ID-CMNUPRT-CMNUPRTS TO DP023-PRINT-CLASS.               09440000
094500     MOVE ID-CMNUPRT-CMNUPRTD TO DP023-PRINT-DEST.                09450000
094600     IF ID-CMNUPRT-CMNUPRTC NUMERIC                               09460000
094700         MOVE ID-CMNUPRT-CMNUPRTC-N TO DP023-PRINT-COPIES-N       09470000
094800     ELSE                                                         09480000
094900         MOVE 1 TO DP023-PRINT-COPIES-N                           09490000
095000     END-IF.                                                      09500000
095100                                                                  09510000
095200     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     09520000
095300                                                                  09530000
095400     PERFORM DP023-0000-DYNALC.                                   09540000
095500                                                                  09550000
095600     IF DP023-LASTRC NOT = ZERO                                   09560000
095700         MOVE DP023-DDNAME TO PV-DR-DDNAME                        09570000
095800         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           09580000
095900         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          09590000
096000         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO DP300-ERROR-MESSAGE  09600000
096100     END-IF.                                                      09610000
096200*9700-EXIT.                                                       09620000
096300                                                                  09630000
096400*                                                                 09640000
096500*  DYNAMIC ALLOCATION ROUTINE                                     09650000
096600*                                                                 09660000
096700     COPY DPPD023.                                                09670000
