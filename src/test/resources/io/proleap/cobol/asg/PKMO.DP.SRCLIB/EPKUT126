000100 IDENTIFICATION DIVISION.                                         00010013
000200 PROGRAM-ID.      EPKUT126.                                       00020013
000300 AUTHOR.          BOB KOLESAR (SAFENET CONSULTING).               00030013
000400 DATE-WRITTEN.    MARCH, 2003.                                    00040013
000500                                                                  00050013
000600*-----------------------------------------------------------      00060013
000700*            PROMOTIONS CORRECTION IDENTIFIER                     00070013
000800*-----------------------------------------------------------      00080013
000900*-----------------------------------------------------------      00090013
001000* HISTORY LOG:                                                    00100013
001100*-----------------------------------------------------------      00110013
001200* DATE:                                                           00120013
001300* WR/IR#:                                                         00130013
001400* PROGRAMMER:                                                     00140013
001500* DESCRIPTION:                                                    00150013
001600                                                                  00160013
001700*----------------------------------------------------------       00170013
001800 ENVIRONMENT DIVISION.                                            00180013
001900*----------------------------------------------------------       00190013
002000 CONFIGURATION SECTION.                                           00200013
002100 SOURCE-COMPUTER.        IBM-3090.                                00210013
002200 OBJECT-COMPUTER.        IBM-3090.                                00220013
002210                                                                  00221013
002220 INPUT-OUTPUT SECTION.                                            00222013
002230                                                                  00223013
002240 FILE-CONTROL.                                                    00224013
002250                                                                  00225013
002251     SELECT CONTROL-CARD-PGM-LAST-RUN-DTE                         00225113
002252       ASSIGN TO INP01.                                           00225213
002253     SELECT CONTROL-CARD-CURR-PRICG-DTE                           00225313
002254       ASSIGN TO INP02.                                           00225413
002255     SELECT CONTROL-CARD-FUTRE-CORR-DTE                           00225513
002256       ASSIGN TO INP03.                                           00225613
002257     SELECT CONTROL-CARD-CRIT-EFF-DTE                             00225713
002258       ASSIGN TO INP04.                                           00225813
002259     SELECT PROMO-NIGHT-FILE                                      00225913
002260       ASSIGN TO OUT01.                                           00226013
002261     SELECT PROMO-EMERGENCY-FILE                                  00226113
002262       ASSIGN TO OUT02.                                           00226213
002263                                                                  00226313
002264 DATA DIVISION.                                                   00226413
002265 FILE SECTION.                                                    00226513
002266                                                                  00226613
002267 FD  CONTROL-CARD-PGM-LAST-RUN-DTE                                00226713
002268     RECORDING MODE F                                             00226813
002269     BLOCK CONTAINS 0 RECORDS                                     00226913
002270     LABEL RECORDS ARE OMITTED                                    00227013
002271     DATA RECORD IS CNTRL-CARD-PGM-LAST-RUN-REC.                  00227113
002272 01  CNTRL-CARD-PGM-LAST-RUN-REC                   PIC  X(080).   00227213
002273                                                                  00227313
002274 FD  CONTROL-CARD-CURR-PRICG-DTE                                  00227413
002275     RECORDING MODE F                                             00227513
002276     BLOCK CONTAINS 0 RECORDS                                     00227613
002277     LABEL RECORDS ARE OMITTED                                    00227713
002278     DATA RECORD IS CNTRL-CARD-CURR-PRICG-DTE-REC.                00227813
002279 01  CNTRL-CARD-CURR-PRICG-DTE-REC                 PIC  X(080).   00227913
002280                                                                  00228013
002290 FD  CONTROL-CARD-FUTRE-CORR-DTE                                  00229013
002300     RECORDING MODE F                                             00230013
002400     BLOCK CONTAINS 0 RECORDS                                     00240013
002500     LABEL RECORDS ARE OMITTED                                    00250013
002600     DATA RECORD IS CNTRL-CARD-FUTRE-CORR-DTE-REC.                00260013
002700 01  CNTRL-CARD-FUTRE-CORR-DTE-REC                 PIC  X(080).   00270013
002800                                                                  00280013
002900 FD  CONTROL-CARD-CRIT-EFF-DTE                                    00290013
003000     RECORDING MODE F                                             00300013
003010     BLOCK CONTAINS 0 RECORDS                                     00301013
003020     LABEL RECORDS ARE OMITTED                                    00302013
003030     DATA RECORD IS CNTRL-CARD-CRIT-EFF-DTE-REC.                  00303013
003040 01  CNTRL-CARD-CRIT-EFF-DTE-REC                   PIC  X(080).   00304013
003050                                                                  00305013
003060 FD  PROMO-NIGHT-FILE                                             00306013
003070     RECORDING MODE F                                             00307013
003080     BLOCK CONTAINS 0 RECORDS                                     00308013
003090     LABEL RECORDS ARE OMITTED                                    00309013
003100     DATA RECORD IS PROMO-NIGHT-ID-RECORD.                        00310013
003101 01  PROMO-NIGHT-RECORD                            PIC  X(200).   00310114
003102                                                                  00310213
003103 FD  PROMO-EMERGENCY-FILE                                         00310313
003104     RECORDING MODE F                                             00310413
003105     BLOCK CONTAINS 0 RECORDS                                     00310513
003106     LABEL RECORDS ARE OMITTED                                    00310613
003110     DATA RECORD IS PROMO-EMERG-ID-RECORD.                        00310713
003120 01  PROMO-EMERGENCY-RECORD                        PIC  X(200).   00310814
003130                                                                  00310913
003140 WORKING-STORAGE SECTION.                                         00311013
003150*-----------------------------------------------------------      00312013
003160* PS - PROGRAM SWITCHES                                           00313013
003170*-----------------------------------------------------------      00314013
003180 01  PS-PROGRAM-SWITCHES.                                         00315013
003190     05  PS-RMS-PROMO-CSR-EOF-SW                   PIC  X(001).   00316013
003200       88  PS-RMS-PROMO-CSR-EOF                      VALUE 'Y'.   00317013
003300       88  PS-RMS-PROMO-CSR-NOT-EOF                  VALUE 'N'.   00318013
003400     05  PS-ADHOC-PROMO-CSR-EOF-SW                 PIC  X(001).   00319013
003500       88  PS-ADHOC-PROMO-CSR-EOF                    VALUE 'Y'.   00320013
003600       88  PS-ADHOC-PROMO-CSR-NOT-EOF                VALUE 'N'.   00330013
004000     05  PS-REC-FOUND-SW                           PIC  X(001).   00370013
004100       88  PS-REC-FOUND                              VALUE 'Y'.   00380013
004200       88  PS-NO-REC-FOUND                           VALUE 'N'.   00390013
004300     05  PS-WRITE-PROMO-SW                         PIC  X(001).   00400013
004400       88  PS-WRITE-PROMO                            VALUE 'Y'.   00410013
004500       88  PS-DONT-WRITE-PROMO                       VALUE 'N'.   00420013
004600     05  PS-FILE-STATUS                            PIC  X(002).   00430013
004700       88  PS-SUCCESSFUL-COMPLETION                  VALUE '00'.  00440013
004800       88  PS-END-OF-FILE                            VALUE '10'.  00450013
004900       88  PS-SUCCESSFUL-OPEN                        VALUE '97'.  00460013
005000     05  PS-END-OF-CNTL-CRD-SW                     PIC  X(001).   00470013
005100       88  PS-END-OF-CNTL-CRD-FILE                   VALUE 'Y'.   00480013
005200       88  PS-NOT-END-OF-CNTL-CRD-FILE               VALUE 'N'.   00490013
005300                                                                  00500013
005400*-----------------------------------------------------------      00510013
005500* PROGRAM CONSTANTS                                               00520013
005600*-----------------------------------------------------------      00530013
005700 01  PC-PROGRAM-CONSTANTS.                                        00540013
005800     05  PC-CURRENT-PROGRAM-NAME                   PIC  X(008)    00550013
005900       VALUE 'EPKUT126'.                                          00560013
006000     05  PC-PROMO-BUS-EVENT                        PIC  X(003)    00570013
006010       VALUE '020'.                                               00580013
006040     05  PC-RMS-PRC-SETUP-IND                      PIC  X(001)    00601013
006050       VALUE 'R'.                                                 00602013
006060     05  PC-ADHOC-PRC-SETUP-IND                    PIC  X(001)    00603013
006070       VALUE 'A'.                                                 00604013
006080     05  PC-ADHOC-STR-GRP-TYP-CDE                  PIC  X(005)    00605013
006090       VALUE '99999'.                                             00606013
006091     05  PC-ADHOC-STR-SPEC-CDE                     PIC  X(004)    00607013
006092       VALUE '5000'.                                              00608013
006095     05  PC-FILE-ACT-TYPE                          PIC  X(003)    00609213
006096       VALUE 'CHG'.                                               00609313
006097     05  PC-APPLY-NIGHTLY                          PIC  X(001)    00609413
006098       VALUE 'N'.                                                 00609513
006099     05  PC-APPLY-CORRECTION                       PIC  X(001)    00609613
006100       VALUE 'C'.                                                 00609713
006101     05  PC-PROMO-STAT-CDE                         PIC  X(001).   00609814
006102       88  PC-SCHEDULED-STATUS                       VALUE 'S'.   00609913
006103       88  PC-DELETE-STATUS                          VALUE 'D'.   00610013
006104       88  PC-CANCEL-STATUS                          VALUE 'C'.   00610113
006105     05  PC-ADD-STAT-CDE                           PIC  X(001)    00610213
006106       VALUE 'A'.                                                 00610313
006107     05  PC-DELETE-STAT-CDE                        PIC  X(001)    00610413
006108       VALUE 'D'.                                                 00610513
006109     05  PC-MDSE-INCL-IND                          PIC  X(001)    00610613
006110       VALUE 'I'.                                                 00610713
006120                                                                  00610813
006130*-----------------------------------------------------------      00610913
006140* PV- PROGRAM VARIABLES                                           00611013
006150*-----------------------------------------------------------      00612013
006160 01  PV-PROGRAM-VARAIBLES.                                        00613013
006170     05  PV-SQL-SUB                                PIC S9(004)    00614013
006180                                                     VALUE +0     00615013
006190                                                     COMP.        00616013
006200     05  PV-CURRENT-SYSTEM-TMST                    PIC  X(026)    00617013
006300                                                     VALUE SPACES.00618013
006500     05  PV-ACTL-STRT-TMST.                                       00619013
006600       10  PV-ACTL-STRT-TMST-DATE                  PIC  X(010)    00620013
006300                                                     VALUE SPACES.00630013
006900       10  FILLER                                  PIC  X(016)    00640013
006300                                                     VALUE SPACES.00650013
007200     05  PV-SOR-LAST-UPD-TMST                      PIC  X(026)    00660013
006300                                                     VALUE SPACES.00670013
008600     05  PV-EFF-STRT-TMST                          PIC  X(026)    00680013
006300                                                     VALUE SPACES.00690013
008630     05  PV-EFF-END-TMST                           PIC  X(026)    00700013
006300                                                     VALUE SPACES.00710013
008660     05  PV-EFF-END-NULL                           PIC S9(004)    00720013
008692                                                     VALUE ZEROS  00730013
008670                                                     COMP.        00740013
008680     05  PV-ABEND-CODE                             PIC  9999      00750013
008692                                                     VALUE ZEROS  00760013
008690                                                     COMP.        00770013
008693     05  PV-FUL-FILE-STR                           PIC  9(005)    00780013
008692                                                     VALUE ZEROS. 00790013
008696     05  EP111-CC-DATE-PLUS1                       PIC  X(010)    00800013
006300                                                     VALUE SPACES.00810013
008699     05  EP113-CC-CRNT-DTE-MINUS1                  PIC  X(010)    00820013
006300                                                     VALUE SPACES.00830013
008702                                                                  00840013
008710*----------------------------------------------------------       00850013
008800* FULL FILE EXTRACT OUTPUT FILE.                                  00860013
008900*----------------------------------------------------------       00870013
009000     COPY EPRD072.                                                00880013
009100                                                                  00890013
009200*----------------------------------------------------------       00900013
009300* EPCC111 CONTROL CARD LAYOUT                                     00910013
009400*----------------------------------------------------------       00920013
009500     COPY EPRD111.                                                00930013
009600                                                                  00940013
009700*----------------------------------------------------------       00950013
009800* EPCC113 CONTROL CARD LAYOUT                                     00960013
009900*----------------------------------------------------------       00970013
010000     COPY EPRD113.                                                00980013
010100                                                                  00990013
010200*----------------------------------------------------------       01000013
010300* EPCC121 CONTROL CARD LAYOUT                                     01010013
010400*----------------------------------------------------------       01020013
010500     COPY EPRD121.                                                01030013
010600                                                                  01040013
010700*----------------------------------------------------------       01050013
010800* EPCC128 CONTROL CARD LAYOUT                                     01060013
010810*----------------------------------------------------------       01070013
010820     COPY EPRD128.                                                01080013
010830                                                                  01081013
010900*----------------------------------------------------------       01082013
011000* DATE ROUTINE COPY MEMBERS                                       01083013
011100*----------------------------------------------------------       01084013
011200     COPY DPWS500.                                                01085013
011300                                                                  01086013
011400*-----------------------------------------------------------      01087013
011500* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         01088013
011600*-----------------------------------------------------------      01089013
011700     COPY DPWS004.                                                01090013
011800                                                                  01100013
011900*-----------------------------------------------------------      01110013
012000* DB2 ABEND COPYBOOK                                              01120013
012100*-----------------------------------------------------------      01130013
012200     COPY DPWS900.                                                01140013
012300                                                                  01150013
012400*-----------------------------------------------------------      01160013
012500* DB2 MESSAGE AREA                                                01170013
012600*-----------------------------------------------------------      01180013
012700     COPY SQLCA2.                                                 01190013
012800                                                                  01200013
012900*-----------------------------------------------------------      01210013
013000* PROGRAM COUNTERS                                                01220013
013100*-----------------------------------------------------------      01230013
013200 01  PC-PROGRAM-COUNTERS.                                         01240013
013210     05  PC-CNT-READ-RECS                          PIC  9(009)    01250013
013220                                                     VALUE 0.     01260013
013230     05  PC-CNT-NIGHT-RECS                         PIC  9(009)    01270013
013240                                                     VALUE 0.     01280013
013250     05  PC-CNT-EMERG-RECS                         PIC  9(009)    01290013
013260                                                     VALUE 0.     01300013
013270     05  PC-CNT-PROMO-RECS                         PIC  9(009)    01310013
013280                                                     VALUE 0.     01320013
013290     05  PC-CNT-RMS-RECS                           PIC  9(009)    01321013
013291                                                     VALUE 0.     01322013
013292     05  PC-CNT-ADHOC-RECS                         PIC  9(009)    01323013
013293                                                     VALUE 0.     01324013
013294     05  PC-CNT-DEVT-RECS                          PIC  9(009)    01325013
013295                                                     VALUE 0.     01326013
013296     05  PC-CNT-PMAP-RECS                          PIC  9(009)    01327013
013297                                                     VALUE 0.     01328013
013298     05  PC-CNT-ERROR-RECS                         PIC  9(009)    01329013
013299                                                     VALUE 0.     01329113
013300     05  PC-CNT-ALL-RECS                           PIC  9(009)    01329213
013301                                                     VALUE 0.     01329313
013302     05  PC-CNT-SPACES                             PIC  9(009)    01329413
013303                                                     VALUE 0.     01329513
013304     05  PC-CNT-POS                                PIC  9(009)    01329613
013305                                                     VALUE 0.     01329713
013308     05  PC-MAX-RETRIES                            PIC S9(004)    01330013
013309                                                     VALUE +5     01330113
013310                                                     COMP.        01330213
014070                                                                  01330313
014080*-----------------------------------------------------------      01330413
014090* ERROR HANDLING                                                  01330513
014100*-----------------------------------------------------------      01330613
014200 01  PV-MISC-ABEND-FIELDS.                                        01330713
014300     05  PV-PARAGRAPH-NAME                         PIC  X(030)    01330813
014400                                                     VALUE SPACE. 01330913
014500     05  PV-OPERATION-MSG-1                        PIC  X(040)    01331013
014600                                                     VALUE SPACE. 01332013
014700     05  PV-OPERATION-MSG-2                        PIC  X(040)    01333013
014800                                                     VALUE SPACE. 01334013
014900     05  PV-DB2-OPERATION                          PIC  X(030)    01335013
015000                                                     VALUE SPACE. 01336013
015100 01  ABEND-CODE                                    PIC S9(004)    01337013
015200                                                     VALUE ZEROS  01338013
015300                                                     COMP         01339013
015310                                                     SYNC.        01340013
015320   88  ABEND-4003-CTRL-CARD-ERROR                    VALUE +4003. 01350013
015330   88  ABEND-4013-DB2-ERROR                          VALUE +4013. 01360013
015340   88  ABEND-4019-CAL-SUB-ERROR                      VALUE +4019. 01370013
015350   88  ABEND-4020-MQ-ERROR                           VALUE +4020. 01380013
015360   88  ABEND-4444-FORCED-ABEND                       VALUE +4444. 01390013
015370   88  ABEND-4008                                    VALUE +4008. 01400013
015380                                                                  01410013
015400                                                                  01420013
015500*-----------------------------------------------------------      01430013
015600* DB2 COMMUNICATIONS AREA                                         01440013
015700*-----------------------------------------------------------      01450013
015800     EXEC SQL                                                     01460013
015900       INCLUDE SQLCA                                              01470013
016000     END-EXEC.                                                    01480013
016100                                                                  01490013
016200*-----------------------------------------------------------      01500013
016300* DB2 TABLE XST00026(XST_PROMO) - PROMOTIONS TABLE                01510013
016400*-----------------------------------------------------------      01520013
016500     EXEC SQL                                                     01530013
016600       INCLUDE XST00026                                           01540013
016700     END-EXEC.                                                    01550013
016800                                                                  01560013
016810*-----------------------------------------------------------      01570013
016820* DB2 TABLE XST00028(XST_MDSE_LNE_SELN) - MERCHANDISE TABLE       01580013
016830*-----------------------------------------------------------      01590013
016840     EXEC SQL                                                     01600013
016850       INCLUDE XST00028                                           01610013
016860     END-EXEC.                                                    01620013
016870                                                                  01630013
016900*-----------------------------------------------------------      01640013
017000* DB2 TABLE XST00029(XST_PROMO_STR_GP) - STORE ZONE PRICING       01650013
017100*                                               TABLE             01660013
017200*-----------------------------------------------------------      01670013
017300     EXEC SQL                                                     01680013
017400       INCLUDE XST00029                                           01690013
017500     END-EXEC.                                                    01700013
017600                                                                  01710013
018220*-----------------------------------------------------------      01790013
018230* DB2 TABLE XST00031(XST_PROMO_ADHC_RLT) ADHOC RELATION           01800013
018240*-----------------------------------------------------------      01810013
018250     EXEC SQL                                                     01820013
018260       INCLUDE XST00031                                           01821013
018270     END-EXEC.                                                    01822013
018300                                                                  01823013
019100*-----------------------------------------------------------      01840013
019200* PROMOTIONS CHANGE INTERFACE INCLUDE CURSOR. (RMS)               01850013
019300*-----------------------------------------------------------      01860013
019400     EXEC SQL                                                     01870013
019500       DECLARE PROMO-RMS CURSOR FOR                               01880013
019510         SELECT PROMO.STAT_CDE                                    01890013
019600               ,PROMO.LAST_UPD_TMST                               01900013
019800               ,PROMO.SOR_LAST_UPD_TMST                           01910013
019900               ,STRGP.PROMO_INTFC_ID                              01920013
020000               ,STRGP.MDSE_LNE_ID                                 01930013
020100               ,STRGP.STR_GP_TYP_CDE                              01940013
020200               ,STRGP.STR_GP_ID                                   01950013
020300               ,STRGP.STR_SELN_HIER_CDE                           01960013
020400               ,STRGP.ACTL_STRT_TMST                              01970013
020500               ,STRGP.ACTL_END_TMST                               01980013
020600               ,MDSSEL.PRICG_TYP_CDE                              01990013
020700         FROM XST_PROMO          PROMO                            02000013
020800             ,XST_PROMO_STR_GP   STRGP                            02010013
020900             ,XST_MDSE_LNE_SELN  MDSSEL                           02020013
021000         WHERE PROMO.PROMO_ID = MDSSEL.PROMO_ID                   02030013
                 AND PROMO.PROMO_ID=6119                                02040017
021200           AND MDSSEL.PROMO_INTFC_ID = STRGP.PROMO_INTFC_ID       02050013
021300           AND MDSSEL.MDSE_LNE_ID    = STRGP.MDSE_LNE_ID          02060013
021400           AND PROMO.STAT_CDE IN ('S')                            02070014
021500           AND STRGP.STAT_CDE  IN ('S')                           02080013
021600           AND (PROMO.LAST_UPD_TMST                               02090014
021700               BETWEEN :EP121-CC-PROMO-CUTOFF-TMST                02100013
021710                   AND :PV-CURRENT-SYSTEM-TMST)                   02110013
021720           AND ((:EP111-CC-CRNT-DTE                               02120013
021730               BETWEEN DATE(STRGP.ACTL_STRT_TMST)                 02130013
021740                   AND DATE(STRGP.ACTL_END_TMST))                 02140013
021750           OR  (DATE(STRGP.ACTL_STRT_TMST)                        02150013
021760               BETWEEN :EP111-CC-DATE-PLUS1                       02160013
021770                   AND :EP113-CC-CRNT-DTE-MINUS1))                02170013
021780         FOR FETCH ONLY                                           02171013
021790         WITH UR                                                  02172013
021800     END-EXEC.                                                    02173013
021801                                                                  02174013
021802*-----------------------------------------------------------      02175013
021803* PROMOTIONS CHANGE ID ADHOC CURSOR.                              02176014
021804*-----------------------------------------------------------      02177013
021805     EXEC SQL                                                     02178013
021806       DECLARE PROMO-ADHOC CURSOR FOR                             02179013
021807         SELECT PROMO.STAT_CDE                                    02180014
021808               ,PROMO.LAST_UPD_TMST                               02180114
021810               ,PROMO.SOR_LAST_UPD_TMST                           02180214
021811               ,ADHOC.PROMO_INTFC_ID                              02180313
021820               ,ADHOC.MDSE_LNE_ID                                 02180413
021830               ,ADHOC.ADHC_STR_GP_ID                              02180513
021840               ,ADHOC.STR_SELN_HIER_CDE                           02180613
021850               ,ADHOC.ACTL_STRT_TMST                              02180713
021860               ,ADHOC.ACTL_END_TMST                               02180813
021870               ,MDSSEL.PRICG_TYP_CDE                              02180913
021871        FROM XST_PROMO          PROMO                             02181015
021872            ,XST_PROMO_ADHC_RLT ADHOC                             02182013
021873            ,XST_MDSE_LNE_SELN  MDSSEL                            02183013
021874        WHERE PROMO.PROMO_ID = MDSSEL.PROMO_ID                    02184014
                AND PROMO.PROMO_ID=6119                                 02185017
021876          AND ADHOC.PROMO_INTFC_ID  = MDSSEL.PROMO_INTFC_ID       02186013
021877          AND ADHOC.MDSE_LNE_ID     = MDSSEL.MDSE_LNE_ID          02187013
021878          AND ADHOC.STAT_CDE  IN ('S')                            02187113
021879          AND PROMO.STAT_CDE IN ('S')                             02187214
021880          AND (PROMO.LAST_UPD_TMST                                02187314
021890              BETWEEN :EP121-CC-PROMO-CUTOFF-TMST                 02187413
021900                  AND :PV-CURRENT-SYSTEM-TMST)                    02187513
021910          AND ((:EP111-CC-CRNT-DTE                                02187613
021911              BETWEEN DATE(ADHOC.ACTL_STRT_TMST)                  02187713
021912                  AND DATE(ADHOC.ACTL_END_TMST))                  02187813
021913          OR  (DATE(ADHOC.ACTL_STRT_TMST)                         02187913
021914              BETWEEN :EP111-CC-DATE-PLUS1                        02188013
021915                  AND :EP113-CC-CRNT-DTE-MINUS1))                 02189013
021916        FOR FETCH ONLY                                            02190013
021917        WITH UR                                                   02191013
021918     END-EXEC.                                                    02191113
021919                                                                  02191213
021971 LINKAGE SECTION.                                                 02191313
021972                                                                  02191413
021973*----------------------------------------------------------       02191513
021974 PROCEDURE DIVISION.                                              02191613
021975*----------------------------------------------------------       02191713
021976 0000-MAINLINE.                                                   02191813
021977                                                                  02191913
021978     PERFORM 1000-INITIALIZATION.                                 02192013
021979                                                                  02193013
021980     PERFORM 2000-PROCESS-PROMOTIONS.                             02194014
021981                                                                  02195013
021982     PERFORM 9999-WRAPUP.                                         02196013
021983                                                                  02197013
021984     GOBACK.                                                      02198013
021985                                                                  02198113
021986*0000-EXIT.                                                       02198213
021987 EJECT.                                                           02198313
021988                                                                  02198413
021989*----------------------------------------------------------       02198513
021990* 1000-INITIALIZATION.                                            02198613
021991*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      02198713
021992*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      02198813
021993*     PARAMETERS IT MAY NEED TO USE TO READ THE PROMO             02198913
021994*     INTERFACE ID FILE.                                          02199013
021995*----------------------------------------------------------       02199113
022000 1000-INITIALIZATION.                                             02199213
022100                                                                  02199313
022200     OPEN INPUT  CONTROL-CARD-CURR-PRICG-DTE                      02199413
022300                 CONTROL-CARD-FUTRE-CORR-DTE                      02199513
022400                 CONTROL-CARD-PGM-LAST-RUN-DTE                    02199613
022500                 CONTROL-CARD-CRIT-EFF-DTE.                       02199713
022600     OPEN OUTPUT PROMO-NIGHT-FILE                                 02199813
022700                 PROMO-EMERGENCY-FILE.                            02199913
022800                                                                  02200013
023000     INITIALIZE EP072-PROMO-INTFC-RECORD.                         02210013
023100                                                                  02220013
023200     PERFORM 1010-GET-CURRENT-SYSTEM-TMST.                        02230013
023300     PERFORM 1020-READ-PGM-LAST-RUN-CARD.                         02240013
023400     PERFORM 1030-READ-CURR-PRICG-DTE-CARD.                       02250013
023500     PERFORM 1040-READ-FUTRE-CORR-DTE-CARD.                       02260013
023600     PERFORM 1050-READ-CRIT-EFF-DTE-CARD.                         02270013
023800     PERFORM 6100-DATE-ROUTINE.                                   02280013
023900                                                                  02290013
024000*1000-EXIT.                                                       02300013
024100 EJECT.                                                           02310013
024200                                                                  02320013
024300*----------------------------------------------------------       02330013
024400* 1010-GET-CURRENT-SYSTEM-TMST.                                   02340013
024500*     RETREIVE THE CURRENT SYSTEM TIMESTAMP. THIS WILL BE         02350013
024600*     USED WITHIN THE QUERIES TO IDENTIFY WHICH PROMO CHANGES     02360014
024700*     NEED TO BE INCLUDED. TMST ALSO WILL BE USED TO UPDATE       02370014
024800*     EPCC121 ON PROGRAM EXIT.                                    02380014
024900*----------------------------------------------------------       02390013
025000 1010-GET-CURRENT-SYSTEM-TMST.                                    02400013
025100        DISPLAY 'CHECK'.                                          02410020
025200     EXEC SQL                                                     02420013
025300       SET :PV-CURRENT-SYSTEM-TMST = CURRENT TIMESTAMP            02430013
025400     END-EXEC.                                                    02440013
025500                                                                  02450013
             DISPLAY 'DATE2' PV-CURRENT-SYSTEM-TMST.                    02451019
025600     IF SQLCODE NOT EQUAL ZERO                                    02460013
025700       MOVE 'GET CURRENT TIMESTAMP' TO PV-DB2-OPERATION           02470013
025800       MOVE '1010-GET-CURRENT-SYSTEM-TMST'                        02480013
025900                                     TO PV-PARAGRAPH-NAME         02490013
026000       PERFORM 9900-SQL-ABEND-ROUTINE                             02500013
026100     END-IF.                                                      02510013
026200                                                                  02520013
026300*1010-EXIT.                                                       02530013
026400 EJECT.                                                           02540013
026500                                                                  02550013
026600*----------------------------------------------------------       02560013
026700* 1020-READ-PGM-LAST-RUN-CARD.                                    02570013
026800*     READ CONTROL CARD EPCC121. THIS CONTROL CARD CONTAINS       02580013
026900*     THE TIMESTAMP FROM THE LAST RUN OF EPKUT126                 02590013
027000*----------------------------------------------------------       02600013
027100 1020-READ-PGM-LAST-RUN-CARD.                                     02610013
027200                                                                  02620013
027300     READ CONTROL-CARD-PGM-LAST-RUN-DTE                           02630013
027400                                    INTO EP121-CC-CONTROL-CARD    02640013
027500       AT END                                                     02650013
027600          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    02660013
027700                                                                  02670013
027800     IF PS-END-OF-CNTL-CRD-FILE                                   02680013
027900       DISPLAY ' '                                                02690013
028000       DISPLAY '** ABEND     **'                                  02700013
028100       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      02710013
028200       DISPLAY '** PARAGRAPH **  = 1020-READ-PGM-LAST-RUN-CARD'   02720013
028300       DISPLAY '** CONTROL FILE IS EMPTY  '                       02730013
028310       DISPLAY ' '                                                02740013
028320       MOVE +4002 TO ABEND-CODE                                   02750013
028330       CALL 'ILBOABN0' USING ABEND-CODE                           02760013
028340     ELSE                                                         02770013
028341       DISPLAY '** PROGRAM LAST RUN CONTROL CARD  **'             02780013
028342       DISPLAY '** EPCC121     **  =' EP121-CC-PROMO-CUTOFF-TMST  02790013
028343       DISPLAY ' '                                                02800013
028344     END-IF.                                                      02810013
028345                                                                  02820013
028346*1020-EXIT.                                                       02830013
028347 EJECT.                                                           02831013
028348                                                                  02832013
028349*----------------------------------------------------------       02833013
028350* 1030-READ-CURR-PRICG-DTE-CARD.                                  02834013
028351*     READ CONTROL CARD EPCC111. THIS CONTROL CARD CONTAINS       02835013
028352*     THE CURRENT PRICING DATE.                                   02835113
028353*----------------------------------------------------------       02835213
028354 1030-READ-CURR-PRICG-DTE-CARD.                                   02835313
028355                                                                  02835413
028356     READ CONTROL-CARD-CURR-PRICG-DTE                             02835513
028357                               INTO EP111-CC-CONTROL-CARD         02835613
028358       AT END                                                     02835713
028359          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    02835813
028360                                                                  02835913
028361     IF PS-END-OF-CNTL-CRD-FILE                                   02836013
028362       DISPLAY ' '                                                02836113
028363       DISPLAY '** ABEND     **'                                  02836213
028364       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      02836313
028365       DISPLAY '** PARAGRAPH **  = 1030-READ-CURR-PRICG-DTE-CARD' 02836413
028366       DISPLAY '** CONTROL FILE IS EMPTY  '                       02836513
028367       DISPLAY ' '                                                02836613
028368       MOVE +4002 TO ABEND-CODE                                   02836713
028369       CALL 'ILBOABN0' USING ABEND-CODE                           02836813
028370     ELSE                                                         02836913
028371       DISPLAY '** CURRENT PRICING DATE CONTROL CARD  **'         02837013
028372       DISPLAY '** EPCC111       **  = ' EP111-CC-CRNT-DTE        02837113
028373       DISPLAY ' '                                                02837213
028374     END-IF.                                                      02837313
028376                                                                  02837413
028377*1030-EXIT.                                                       02837513
028378 EJECT.                                                           02837613
028379                                                                  02837713
028380*----------------------------------------------------------       02837813
028381* 1040-READ-FUTRE-CORR-DTE-CARD.                                  02837913
028382*     READ CONTROL CARD EPCC113. THIS CONTROL CARD CONTAINS       02838013
028383*     THE NEXT FUTURE CORRECTIONS DATE                            02838113
028384*----------------------------------------------------------       02838213
028385 1040-READ-FUTRE-CORR-DTE-CARD.                                   02838313
028386                                                                  02838413
028387     READ CONTROL-CARD-FUTRE-CORR-DTE                             02838513
028388                               INTO EP113-CC-CONTROL-CARD         02838613
028389       AT END                                                     02838713
028390          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    02838813
028391                                                                  02838913
028392     IF PS-END-OF-CNTL-CRD-FILE                                   02839013
028393       DISPLAY ' '                                                02839113
028394       DISPLAY '** ABEND     **'                                  02839213
028395       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      02839313
028396       DISPLAY '** PARAGRAPH **  = 1040-READ-FUTRE-CORR-DTE-CARD' 02839413
028397       DISPLAY '** CONTROL FILE IS EMPTY  '                       02839513
028398       DISPLAY ' '                                                02839613
028399       MOVE +4002 TO ABEND-CODE                                   02839713
028400       CALL 'ILBOABN0' USING ABEND-CODE                           02839813
028401     ELSE                                                         02839913
028402       DISPLAY '** FUTURE CORRECTION DATE CONTROL CARD  **'       02840013
028403       DISPLAY '** EPCC113       **  = ' EP113-CC-CRNT-DTE        02840113
028404       DISPLAY ' '                                                02840213
028405     END-IF.                                                      02840313
028406                                                                  02840413
028407*1040-EXIT.                                                       02840513
028408 EJECT.                                                           02840613
028409                                                                  02840713
028410*----------------------------------------------------------       02840813
028411* 1050-READ-CRIT-EFF-DTE-CARD.                                    02840913
028412*     READ CONTROL CARD EPCC128  THIS CONTROL CARD CONTAINS       02841013
028413*     THE CRITICAL EFFECTIVE DATE, WHICH DETERMINES IF CHANGES    02841113
028414*     ARE EMERGENCY OR NIGHTLY.                                   02841213
028415*----------------------------------------------------------       02841313
028416 1050-READ-CRIT-EFF-DTE-CARD.                                     02841413
028417                                                                  02841513
028418     READ CONTROL-CARD-CRIT-EFF-DTE                               02841613
028419                               INTO EP128-CC-CONTROL-CARD         02841713
028420       AT END                                                     02841813
028421          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    02841913
028422                                                                  02842013
028423     IF PS-END-OF-CNTL-CRD-FILE                                   02842113
028424       DISPLAY ' '                                                02842213
028425       DISPLAY '** ABEND     **'                                  02842313
028426       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      02842413
028427       DISPLAY '** PARAGRAPH **  = 1050-READ-CRIT-EFF-DTE-CARD'   02842513
028428       DISPLAY '** CONTROL FILE IS EMPTY  '                       02842613
028429       DISPLAY ' '                                                02842713
028430       MOVE +4002 TO ABEND-CODE                                   02842813
028431       CALL 'ILBOABN0' USING ABEND-CODE                           02842913
028432     ELSE                                                         02843013
028433       DISPLAY '** CRITICAL EFFECTIVE DATE CONTROL CARD  **'      02843113
028434       DISPLAY '** EPCC128       **  = ' EP128-CC-CRITICAL-DTE    02843213
028435       DISPLAY ' '                                                02843313
028436     END-IF.                                                      02843413
028437                                                                  02843513
028438*1050-EXIT.                                                       02843613
028439 EJECT.                                                           02843713
028440                                                                  02843813
028441*----------------------------------------------------------       02843913
028442* 2000-PROCESS-PROMOTIONS.                                        02844013
028443*     MAIN PROCESSING AREA - EXECUTES RMS AND ADHOC QUERY         02844113
028444*     TO IDENTIFY PROMOTION CHANGES AND CREATES OUTPUT            02844213
028445*     FILES TO IDENTIFY WHICH STORE GROUP/PROMO INTERFACE I.D     02844313
028446*     COMBO'S NEED RECORDS CREATED FOR THE STORE SERVER.          02844413
028447*----------------------------------------------------------       02844513
028448 2000-PROCESS-PROMOTIONS.                                         02844613
028449                                                                  02844713
028450     PERFORM 2100-PROCESS-RMS-CURSOR.                             02844813
028451                                                                  02844913
028452     PERFORM 2200-PROCESS-ADHOC-CURSOR.                           02845013
028455                                                                  02845113
028456*2000-EXIT.                                                       02845213
028457 EJECT.                                                           02845313
028458                                                                  02845413
028459*----------------------------------------------------------       02845513
028460* 2100-PROCESS-RMS-CURSOR.                                        02845613
028461*     READ THE RECORD FROM THE PROMOTIONS TABLE AND               02845714
028462*     CREATE PROMO AND PMAP RECORDS BASED ON THE RECORD READ.     02845813
028463*----------------------------------------------------------       02845913
028464 2100-PROCESS-RMS-CURSOR.                                         02846013
                                                                        02846113
028465     PERFORM 2110-OPEN-RMS-PROMO-CSR.                             02846213
028466     PERFORM 2120-FETCH-RMS-PROMO-CSR                             02846313
028467       UNTIL PS-RMS-PROMO-CSR-EOF.                                02846413
028468     PERFORM 2130-CLOSE-RMS-PROMO-CSR.                            02846513
028469                                                                  02846613
028470*2100-EXIT.                                                       02846713
028471 EJECT.                                                           02846813
028472                                                                  02846913
028480*----------------------------------------------------------       02847013
028500* 2110-OPEN-RMS-PROMO-CSR.                                        02848013
028600*     OPEN THE PROMOTIONS CURSOR (RMS).                           02849013
028700*----------------------------------------------------------       02850013
028800 2110-OPEN-RMS-PROMO-CSR.                                         02860013
028900                                                                  02870013
029000     PERFORM                                                      02880013
029100         WITH TEST AFTER                                          02890013
029200         VARYING PV-SQL-SUB                                       02900013
029300         FROM 1 BY 1                                              02910013
029400         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 02920013
029500                   OR  SQLCODE = 0)                               02930013
029600                                                                  02940013
029700         EXEC SQL                                                 02950013
029800           OPEN PROMO-RMS                                         02960013
029900         END-EXEC                                                 02970013
030000                                                                  02980013
030100         EVALUATE TRUE                                            02990013
030200           WHEN SQLCODE = -904                                    03000013
030300           WHEN SQLCODE = -911                                    03010013
030400           WHEN SQLCODE = -913                                    03020013
030500             CONTINUE                                             03030013
030600           WHEN SQLCODE = 0                                       03040013
030700             SET PS-RMS-PROMO-CSR-NOT-EOF TO TRUE                 03050013
030800           WHEN SQLWARN0 NOT EQUAL SPACE                          03060013
030900           WHEN SQLCODE NOT EQUAL ZERO                            03070013
031000             MOVE '2110-OPEN-RMS-PROMO-CSR'                       03080014
031100                                   TO PV-PARAGRAPH-NAME           03090013
031200             MOVE 'ERROR ON OPEN OF PROMO RMS CURSOR'             03100014
031300                                   TO PV-DB2-OPERATION            03110013
031400             PERFORM 9900-SQL-ABEND-ROUTINE                       03120013
031500         END-EVALUATE                                             03130013
031600     END-PERFORM.                                                 03140013
031700                                                                  03150013
031800     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         03160013
031900       MOVE '2110-OPEN-RMS-PROMO-CSR'                             03170014
032000                             TO  PV-PARAGRAPH-NAME                03180013
032100       MOVE 'OPEN RETRIES EXCEEDED'                               03190013
032200                              TO  PV-DB2-OPERATION                03200013
032300       PERFORM 9900-SQL-ABEND-ROUTINE                             03210013
032400     END-IF.                                                      03220013
032500                                                                  03230013
032600*2110-EXIT.                                                       03240013
032700 EJECT.                                                           03250013
032800                                                                  03260013
032900*----------------------------------------------------------       03270013
033000* 2120-FETCH-RMS-PROMO-CSR.                                       03280014
033100*     FETCH THE PROMOTIONS ID CURSOR. (RMS)                       03290014
033200*----------------------------------------------------------       03300013
033300 2120-FETCH-RMS-PROMO-CSR.                                        03310014
033400                                                                  03320013
033500     PERFORM                                                      03330013
033600         WITH TEST AFTER                                          03340013
033700         VARYING PV-SQL-SUB                                       03350013
033800         FROM 1 BY 1                                              03360013
033900         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 03370013
034000                   OR  SQLCODE = 0                                03380013
034100                   OR  SQLCODE = +100)                            03390013
034200                                                                  03400013
034300         EXEC SQL                                                 03410013
034400           FETCH PROMO-RMS                                        03420013
034410           INTO  :XST00026-STAT-CDE                               03430014
034500                ,:XST00026-LAST-UPD-TMST                          03440014
034700                ,:XST00026-SOR-LAST-UPD-TMST                      03450014
034800                ,:XST00029-PROMO-INTFC-ID                         03460013
034900                ,:XST00029-MDSE-LNE-ID                            03470013
035000                ,:XST00029-STR-GP-TYP-CDE                         03480013
035100                ,:XST00029-STR-GP-ID                              03490013
035200                ,:XST00029-STR-SELN-HIER-CDE                      03500013
035300                ,:XST00029-ACTL-STRT-TMST                         03510013
035400                ,:XST00029-ACTL-END-TMST                          03520013
035500                ,:XST00028-PRICG-TYP-CDE                          03530013
035600         END-EXEC                                                 03540013
035700                                                                  03550013
035800         EVALUATE TRUE                                            03560013
035900           WHEN SQLCODE = -904                                    03570013
036000           WHEN SQLCODE = -911                                    03580013
036100           WHEN SQLCODE = -913                                    03590013
036200             CONTINUE                                             03600013
036300           WHEN SQLCODE = ZERO                                    03610013
036400             PERFORM 3000-FORMAT-RMS-OUTPUT                       03620013
036500             ADD 1 TO PC-CNT-RMS-RECS                             03630013
036600           WHEN SQLCODE = +100                                    03640013
036700             SET PS-RMS-PROMO-CSR-EOF TO TRUE                     03650013
036800           WHEN SQLWARN0 NOT EQUAL SPACE                          03660013
036900           WHEN SQLCODE NOT EQUAL ZERO                            03670013
037000             MOVE '2120-FETCH-RMS-PROMO-CSR'                      03680014
037100                                    TO PV-PARAGRAPH-NAME          03690013
037200             MOVE 'ERROR ON FETCHING PROMO RMS CURSOR'            03700014
037300                                    TO PV-DB2-OPERATION           03710013
037400             PERFORM 9900-SQL-ABEND-ROUTINE                       03720013
037500         END-EVALUATE                                             03730013
037600     END-PERFORM.                                                 03740013
037700                                                                  03750013
037800     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         03760013
037900       MOVE '2120-FETCH-RMS-PROMO-CSR'                            03770014
038000                               TO  PV-PARAGRAPH-NAME              03780013
038100       MOVE 'FETCH RETRIES EXCEEDED'                              03790013
038200                               TO  PV-DB2-OPERATION               03800013
038300       PERFORM 9900-SQL-ABEND-ROUTINE                             03810013
038400     END-IF.                                                      03820013
038500                                                                  03830013
038600*2120-EXIT.                                                       03840013
038700 EJECT.                                                           03850013
038800                                                                  03860013
038900*-----------------------------------------------------------      03870013
039000* 2130-CLOSE-RMS-PROMO-CSR.                                       03880014
039200*-----------------------------------------------------------      03900013
039300 2130-CLOSE-RMS-PROMO-CSR.                                        03910014
039400                                                                  03920013
039500     PERFORM                                                      03930013
039600         WITH TEST AFTER                                          03940013
039700         VARYING PV-SQL-SUB                                       03950013
039800         FROM 1 BY 1                                              03960013
039900         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 03970013
040000                   OR  SQLCODE = 0)                               03980013
040100                                                                  03990013
040200         EXEC SQL                                                 04000013
040300           CLOSE PROMO-RMS                                        04010013
040400         END-EXEC                                                 04020013
040500                                                                  04030013
040600         EVALUATE TRUE                                            04040013
040700           WHEN SQLCODE = -904                                    04050013
040800           WHEN SQLCODE = -911                                    04060013
040900           WHEN SQLCODE = -913                                    04070013
041000           WHEN SQLCODE = 0                                       04080013
041100             CONTINUE                                             04090013
041200           WHEN SQLWARN0 NOT EQUAL SPACE                          04100013
041300           WHEN SQLCODE NOT EQUAL ZERO                            04110013
041400             MOVE '2130-CLOSE-RMS-PROMO-CSR'                      04120014
041500                                       TO PV-PARAGRAPH-NAME       04130013
041600             MOVE 'ERROR ON CLOSE OF PROMO RMS CURSOR'            04140014
041700                                       TO PV-DB2-OPERATION        04150013
041800             PERFORM 9900-SQL-ABEND-ROUTINE                       04160013
041900         END-EVALUATE                                             04170013
042000     END-PERFORM.                                                 04180013
042100                                                                  04190013
042200     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         04200013
042300       MOVE '2130-CLOSE-RMS-PROMO-CSR'                            04210014
042400                               TO  PV-PARAGRAPH-NAME              04220013
042500       MOVE 'CLOSE RETRIES EXCEEDED'                              04230013
042600                               TO  PV-DB2-OPERATION               04240013
042700       PERFORM 9900-SQL-ABEND-ROUTINE                             04250013
042800     END-IF.                                                      04260013
042900                                                                  04270013
043000*2130-EXIT.                                                       04280013
043100 EJECT.                                                           04290013
043200                                                                  04300013
043300*----------------------------------------------------------       04310013
043400* 2200-PROCESS-ADHOC-CURSOR.                                      04320013
043500*     READ THE RECORD FROM THE PROMOTIONS TABLE AND               04330014
043600*     CREATE PROMO RECORDS BASED ON THE RECORD READ.              04340014
043700*----------------------------------------------------------       04350013
043800 2200-PROCESS-ADHOC-CURSOR.                                       04360013
                                                                        04370013
043900     PERFORM 2210-OPEN-ADHOC-PROMO-CSR.                           04380014
044000     PERFORM 2220-FETCH-ADHOC-PROMO-CSR                           04390014
044100       UNTIL PS-ADHOC-PROMO-CSR-EOF.                              04400014
044200     PERFORM 2230-CLOSE-ADHOC-PROMO-CSR.                          04410014
044300                                                                  04420014
044400*2200-EXIT.                                                       04430013
044500 EJECT.                                                           04440013
044600                                                                  04450013
044700*----------------------------------------------------------       04460013
044800* 2210-OPEN-ADHOC-PROMO-CSR.                                      04470014
044900*     OPEN THE PROMOTIONS ADHOC CURSOR.                           04480014
045000*----------------------------------------------------------       04490013
045100 2210-OPEN-ADHOC-PROMO-CSR.                                       04500014
045200                                                                  04510013
045300     PERFORM                                                      04520013
045400         WITH TEST AFTER                                          04530013
045500         VARYING PV-SQL-SUB                                       04540013
045600         FROM 1 BY 1                                              04550013
045700         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 04560013
045800                   OR  SQLCODE = 0)                               04570013
045900                                                                  04580013
046000         EXEC SQL                                                 04590013
046100           OPEN PROMO-ADHOC                                       04600013
046200         END-EXEC                                                 04610013
046300                                                                  04620013
046400         EVALUATE TRUE                                            04630013
046500           WHEN SQLCODE = -904                                    04640013
046600           WHEN SQLCODE = -911                                    04650013
046700           WHEN SQLCODE = -913                                    04660013
046800             CONTINUE                                             04670014
046900           WHEN SQLCODE = 0                                       04680013
047000             SET PS-ADHOC-PROMO-CSR-NOT-EOF TO TRUE               04690014
047100           WHEN SQLWARN0 NOT EQUAL SPACE                          04700013
047200           WHEN SQLCODE NOT EQUAL ZERO                            04710013
047300             MOVE '2210-OPEN-ADHOC-PROMO-CSR'                     04720014
047400                                     TO PV-PARAGRAPH-NAME         04730013
047500             MOVE 'ERROR ON OPEN OF PROMO ADHOC CURSOR'           04740014
047600                                     TO PV-DB2-OPERATION          04750013
047700             PERFORM 9900-SQL-ABEND-ROUTINE                       04760013
047800         END-EVALUATE                                             04770013
047900     END-PERFORM.                                                 04780013
048000                                                                  04790013
048100     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         04800013
048200       MOVE '2210-OPEN-ADHOC-PROMO-CSR'                           04810014
048300                             TO  PV-PARAGRAPH-NAME                04820013
048400       MOVE 'OPEN RETRIES EXCEEDED'                               04830013
048500                              TO  PV-DB2-OPERATION                04840013
048600       PERFORM 9900-SQL-ABEND-ROUTINE                             04850013
048700     END-IF.                                                      04860013
048800                                                                  04870013
048900*2210-EXIT.                                                       04880013
049000 EJECT.                                                           04890013
049100                                                                  04900013
049200*----------------------------------------------------------       04910013
049300* 2220-FETCH-ADHOC-PROMO-CSR.                                     04920016
049400*     FETCH THE PROMOTIONS ADHOC CURSOR.                          04930014
049500*----------------------------------------------------------       04940013
049600 2220-FETCH-ADHOC-PROMO-CSR.                                      04950016
049700                                                                  04960013
049800     PERFORM                                                      04970013
049900         WITH TEST AFTER                                          04980013
050000         VARYING PV-SQL-SUB                                       04990013
050100         FROM 1 BY 1                                              05000013
050200         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 05010013
050300                   OR  SQLCODE = 0                                05020013
050400                   OR  SQLCODE = +100)                            05030013
050500                                                                  05040013
050600         EXEC SQL                                                 05050013
050700           FETCH PROMO-ADHOC                                      05060013
050710            INTO  :XST00026-STAT-CDE                              05070014
050800                 ,:XST00026-LAST-UPD-TMST                         05080014
051000                 ,:XST00026-SOR-LAST-UPD-TMST                     05090014
051100                 ,:XST00031-PROMO-INTFC-ID                        05100013
051110                 ,:XST00031-MDSE-LNE-ID                           05110013
051120                 ,:XST00031-ADHC-STR-GP-ID                        05111013
051130                 ,:XST00031-STR-SELN-HIER-CDE                     05112013
051140                 ,:XST00031-ACTL-STRT-TMST                        05113013
051150                 ,:XST00031-ACTL-END-TMST                         05114013
051160                 ,:XST00028-PRICG-TYP-CDE                         05115013
051170         END-EXEC                                                 05116013
051180                                                                  05117013
051190         EVALUATE TRUE                                            05118013
051200           WHEN SQLCODE = -904                                    05119013
051300           WHEN SQLCODE = -911                                    05120013
051400           WHEN SQLCODE = -913                                    05130013
051500             CONTINUE                                             05140013
051600           WHEN SQLCODE = ZERO                                    05150013
051700             PERFORM 3100-FORMAT-ADHOC-OUTPUT                     05160013
051800             ADD 1 TO PC-CNT-ADHOC-RECS                           05170013
051810           WHEN SQLCODE = +100                                    05180013
051820             SET PS-ADHOC-PROMO-CSR-EOF TO TRUE                   05181014
051830           WHEN SQLWARN0 NOT EQUAL SPACE                          05182013
051840           WHEN SQLCODE NOT EQUAL ZERO                            05183013
051850             MOVE '2220-FETCH-ADHOC-PROMO-CSR'                    05184016
051860                                    TO PV-PARAGRAPH-NAME          05185013
051870             MOVE 'ERROR ON FETCHING PROMO ADHOC CURSOR'          05186014
051880                                    TO PV-DB2-OPERATION           05187013
051881             DISPLAY 'SQLCODE= ' SQLCODE                          05188013
051882             PERFORM 9900-SQL-ABEND-ROUTINE                       05188113
051883         END-EVALUATE                                             05188213
051884     END-PERFORM.                                                 05188313
051885                                                                  05188413
051886     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         05188513
051887       MOVE '2220-FETCH-ADHOC-PROMO-CSR'                          05188616
051888                              TO  PV-PARAGRAPH-NAME               05188713
051889       MOVE 'FETCH RETRIES EXCEEDED'                              05188813
051890                              TO  PV-DB2-OPERATION                05188913
051891       PERFORM 9900-SQL-ABEND-ROUTINE                             05189013
051892     END-IF.                                                      05189113
051893                                                                  05189213
051894*2220-EXIT.                                                       05189313
051895 EJECT.                                                           05189413
051896                                                                  05189513
051897*-----------------------------------------------------------      05189613
051898* 2230-CLOSE-ADHOC-PROMO-CSR.                                     05189716
051899*     CLOSE THE PROMOTIONS ADHOC CURSOR.                          05189814
051900*-----------------------------------------------------------      05189913
051901 2230-CLOSE-ADHOC-PROMO-CSR.                                      05190014
051902                                                                  05190113
051903     PERFORM                                                      05190213
051904         WITH TEST AFTER                                          05190313
051905         VARYING PV-SQL-SUB                                       05190413
051906         FROM 1 BY 1                                              05190513
051907         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 05190613
051908                   OR  SQLCODE = 0)                               05190713
051909                                                                  05190813
051910         EXEC SQL                                                 05190913
051911           CLOSE PROMO-ADHOC                                      05191013
051912         END-EXEC                                                 05191113
051913                                                                  05191213
051914         EVALUATE TRUE                                            05191313
051915           WHEN SQLCODE = -904                                    05191413
051916           WHEN SQLCODE = -911                                    05191513
051917           WHEN SQLCODE = -913                                    05191613
051918           WHEN SQLCODE = 0                                       05191713
051919             CONTINUE                                             05191813
051920           WHEN SQLWARN0 NOT EQUAL SPACE                          05191913
051921           WHEN SQLCODE NOT EQUAL ZERO                            05192013
051922             MOVE '2230-CLOSE-ADHOC-PROMO-CSR'                    05192116
051923                                     TO PV-PARAGRAPH-NAME         05192213
051924             MOVE 'ERROR ON CLOSE OF PROMOTION ADHOC CURSOR'      05192314
051925                                     TO PV-DB2-OPERATION          05192413
051926             PERFORM 9900-SQL-ABEND-ROUTINE                       05192513
051927         END-EVALUATE                                             05192613
051928     END-PERFORM.                                                 05192713
051929                                                                  05192813
051930     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         05192913
051931       MOVE '2230-CLOSE-ADHOC-PROMO-CSR'                          05193016
051932                               TO  PV-PARAGRAPH-NAME              05193113
051933       MOVE 'CLOSE RETRIES EXCEEDED'                              05193213
051934                               TO  PV-DB2-OPERATION               05193313
051935       PERFORM 9900-SQL-ABEND-ROUTINE                             05193413
051936     END-IF.                                                      05193513
051937                                                                  05193613
051938*2230-EXIT.                                                       05193713
051939 EJECT.                                                           05193813
051940                                                                  05193913
052106*-----------------------------------------------------------      05194013
052107* 3000-FORMAT-RMS-OUTPUT.                                         05195013
052108*     POPULATE COPYBOOK EPRD072.                                  05196013
052109*-----------------------------------------------------------      05197013
052110 3000-FORMAT-RMS-OUTPUT.                                          05198013
052111                                                                  05199013
052112     INITIALIZE EP072-PROMO-INTFC-RECORD.                         05200013
052113     MOVE PC-PROMO-BUS-EVENT                                      05210013
052114                             TO EP072-BUSINESS-EVENT-ID.          05211013
052115     MOVE PC-RMS-PRC-SETUP-IND                                    05211113
052116                             TO EP072-PRC-SETUP-IND.              05211213
052117     MOVE XST00029-STR-GP-TYP-CDE                                 05211313
052118                             TO EP072-SETUP-STR-GRP-TYP-CDE.      05211413
052119     MOVE XST00029-STR-GP-ID                                      05211513
052120                             TO EP072-SETUP-STR-GRP-ID.           05211613
052121     MOVE XST00029-STR-SELN-HIER-CDE                              05211713
052122                             TO EP072-STR-SELN-HIER-CDE.          05211813
052123     MOVE XST00029-STR-GP-TYP-CDE                                 05211913
052124                             TO EP072-DIST-STR-GRP-TYP-CDE.       05212013
052125     MOVE XST00029-STR-GP-ID                                      05212113
052126                             TO EP072-DIST-STR-GRP-ID.            05212213
052127     MOVE PC-FILE-ACT-TYPE   TO EP072-FILE-ACT-TYP.               05212313
052128                                                                  05212413
052129     MOVE XST00029-ACTL-STRT-TMST                                 05212513
052130                             TO PV-ACTL-STRT-TMST.                05212613
052131                                                                  05212713
052132     IF PV-ACTL-STRT-TMST-DATE > EP128-CC-CRITICAL-DTE            05212813
052133       AND PV-ACTL-STRT-TMST-DATE < EP113-CC-CRNT-DTE             05212913
052134         MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND               05213013
052135     ELSE                                                         05213113
052136       IF PV-ACTL-STRT-TMST-DATE <= EP128-CC-CRITICAL-DTE         05213213
052137         MOVE PC-APPLY-CORRECTION                                 05213313
052138                                  TO EP072-APPLY-IND              05213413
052139       END-IF                                                     05213513
052140     END-IF.                                                      05213613
052141                                                                  05213713
052142     MOVE XST00026-STAT-CDE  TO PC-PROMO-STAT-CDE                 05213814
052143                                                                  05213913
052144     IF PC-SCHEDULED-STATUS                                       05214013
052145       MOVE PC-ADD-STAT-CDE                                       05214113
052146                             TO EP072-RECORD-ACTION               05214213
052147     ELSE                                                         05214313
052148       IF PC-DELETE-STATUS OR PC-CANCEL-STATUS                    05214413
052149         MOVE PC-DELETE-STAT-CDE                                  05214513
052150                             TO EP072-RECORD-ACTION               05214613
             END-IF                                                     05214713
           END-IF.                                                      05214813
052151                                                                  05214913
052152     MOVE XST00029-PROMO-INTFC-ID                                 05215013
052153                             TO EP072-PROMO-INTFC-ID.             05215113
052154     MOVE XST00029-MDSE-LNE-ID                                    05215213
052155                             TO EP072-MERCH-LNE-ID.               05215313
052156     MOVE XST00028-PRICG-TYP-CDE                                  05215413
052157                             TO EP072-PRICG-TYP-CDE.              05215513
052158     MOVE PC-MDSE-INCL-IND                                        05215613
052159                             TO EP072-MDSE-INC-EXC-IND.           05215713
052160     MOVE XST00029-ACTL-STRT-TMST                                 05215813
052161                             TO EP072-STR-GRP-PROMO-STRT-TMST.    05215913
052162     MOVE XST00029-ACTL-END-TMST                                  05216013
052163                             TO EP072-STR-GRP-PROMO-END-TMST.     05216113
052164     MOVE XST00026-SOR-LAST-UPD-TMST                              05216214
052165                             TO EP072-SOR-LAST-UPD-TMST.          05216313
052166                                                                  05216413
052167     IF EP072-APPLY-NIGHTLY                                       05216513
052168       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      05216613
052169     ELSE                                                         05216713
052171       PERFORM 4100-WRITE-EMERG-APPLY-RECORD                      05216813
052134       MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND                 05216913
052170       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      05217013
052172     END-IF.                                                      05217113
052173                                                                  05217213
052174*3000-EXIT.                                                       05217313
052175 EJECT.                                                           05217413
052176*-----------------------------------------------------------      05217513
052177* 3100-FORMAT-ADHOC-OUTPUT.                                       05217613
052178*     POPULATE COPYBOOK EPRD072.                                  05217713
052179*-----------------------------------------------------------      05217813
052180 3100-FORMAT-ADHOC-OUTPUT.                                        05217913
052181                                                                  05218013
052182     INITIALIZE EP072-PROMO-INTFC-RECORD.                         05218113
052183     MOVE PC-PROMO-BUS-EVENT                                      05218213
052184                             TO EP072-BUSINESS-EVENT-ID.          05218313
052185     MOVE PC-ADHOC-PRC-SETUP-IND                                  05218413
052186                             TO EP072-PRC-SETUP-IND.              05218513
052187     MOVE PC-ADHOC-STR-GRP-TYP-CDE                                05218613
052188                             TO EP072-SETUP-STR-GRP-TYP-CDE.      05218713
052190     MOVE XST00031-ADHC-STR-GP-ID                                 05218813
052200                             TO EP072-SETUP-STR-GRP-ID.           05218913
052210     MOVE XST00031-STR-SELN-HIER-CDE                              05219013
052220                             TO EP072-STR-SELN-HIER-CDE.          05220013
052230     MOVE PC-ADHOC-STR-GRP-TYP-CDE                                05221013
052240                             TO EP072-DIST-STR-GRP-TYP-CDE.       05222013
052250     MOVE XST00031-ADHC-STR-GP-ID                                 05223013
052260                             TO EP072-DIST-STR-GRP-ID.            05224013
052270     MOVE PC-FILE-ACT-TYPE   TO EP072-FILE-ACT-TYP.               05225013
052280                                                                  05226013
052281     MOVE XST00031-ACTL-STRT-TMST                                 05227013
052282                             TO PV-ACTL-STRT-TMST.                05228013
052283                                                                  05228113
052284     IF PV-ACTL-STRT-TMST-DATE > EP128-CC-CRITICAL-DTE            05228213
052285       AND PV-ACTL-STRT-TMST-DATE < EP113-CC-CRNT-DTE             05228313
052286         MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND               05228413
052287     ELSE                                                         05228513
052288       IF PV-ACTL-STRT-TMST-DATE <= EP128-CC-CRITICAL-DTE         05228613
052289         MOVE PC-APPLY-CORRECTION                                 05228713
052290                                  TO EP072-APPLY-IND              05228813
052291       END-IF                                                     05228913
052292     END-IF.                                                      05229013
052302                                                                  05230013
052303     MOVE XST00026-STAT-CDE  TO PC-PROMO-STAT-CDE                 05230114
052304                                                                  05230213
052305     IF PC-SCHEDULED-STATUS                                       05230313
052306       MOVE PC-ADD-STAT-CDE                                       05230413
052307                             TO EP072-RECORD-ACTION               05230513
052308     ELSE                                                         05230613
052309       IF PC-DELETE-STATUS OR PC-CANCEL-STATUS                    05230713
052310         MOVE PC-DELETE-STAT-CDE                                  05230813
052311                             TO EP072-RECORD-ACTION               05230913
052291       END-IF                                                     05231013
052292     END-IF.                                                      05231113
052312                                                                  05231213
052313     MOVE XST00031-PROMO-INTFC-ID                                 05231313
052314                             TO EP072-PROMO-INTFC-ID.             05231413
052315     MOVE XST00031-MDSE-LNE-ID                                    05231513
052316                             TO EP072-MERCH-LNE-ID.               05231613
052317     MOVE XST00028-PRICG-TYP-CDE                                  05231713
052318                             TO EP072-PRICG-TYP-CDE.              05231813
052319     MOVE PC-MDSE-INCL-IND                                        05231913
052320                             TO EP072-MDSE-INC-EXC-IND.           05232013
052321     MOVE XST00031-ACTL-STRT-TMST                                 05232113
052322                             TO EP072-STR-GRP-PROMO-STRT-TMST.    05232213
052323     MOVE XST00031-ACTL-END-TMST                                  05232313
052324                             TO EP072-STR-GRP-PROMO-END-TMST.     05232413
052325     MOVE XST00026-SOR-LAST-UPD-TMST                              05232514
052326                             TO EP072-SOR-LAST-UPD-TMST.          05232613
052327                                                                  05232713
052328     IF EP072-APPLY-NIGHTLY                                       05232813
052329       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      05232913
052330     ELSE                                                         05233013
052171       PERFORM 4100-WRITE-EMERG-APPLY-RECORD                      05233113
052134       MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND                 05233213
052170       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      05233313
052333     END-IF.                                                      05233413
052340                                                                  05233513
052350*3100-EXIT.                                                       05233613
052360 EJECT.                                                           05233713
052370                                                                  05233813
052453*----------------------------------------------------------       05233913
052454* 4000-WRITE-NIGHT-APPLY-RECORD.                                  05234013
052460*     WRITES THE PROMO FULL FILE RECORD TO THE FULL FILE          05235013
052500*----------------------------------------------------------       05236013
052600 4000-WRITE-NIGHT-APPLY-RECORD.                                   05237013
052700                                                                  05238013
052710     WRITE PROMO-NIGHT-RECORD FROM EP072-PROMO-INTFC-RECORD.      05239013
052720                                                                  05240013
052730     ADD 1           TO PC-CNT-NIGHT-RECS                         05250013
052740                        PC-CNT-ALL-RECS.                          05260013
052760                                                                  05270013
052770*4000-EXIT.                                                       05271013
052780 EJECT.                                                           05272013
052790                                                                  05273013
052800*----------------------------------------------------------       05274013
052801* 4100-WRITE-EMERG-APPLY-RECORD.                                  05275013
052802*     WRITES THE PROMO FULL FILE RECORD TO THE FULL FILE          05276013
052803*----------------------------------------------------------       05277013
052804 4100-WRITE-EMERG-APPLY-RECORD.                                   05278013
052805                                                                  05279013
052806     WRITE PROMO-EMERGENCY-RECORD FROM EP072-PROMO-INTFC-RECORD.  05280013
052807                                                                  05280113
052808     ADD 1           TO PC-CNT-EMERG-RECS                         05280213
052809                        PC-CNT-ALL-RECS.                          05280313
052820*                                                                 05280413
052830*4100-EXIT.                                                       05280513
052840 EJECT.                                                           05280613
052850                                                                  05280713
052860*----------------------------------------------------------       05280813
052870* DATE ROUTINE TO SET UP THE PROCESS DATE IN                      05280913
052880* CCYYMMDD FORMAT.                                                05281013
052890*----------------------------------------------------------       05282013
052900 6100-DATE-ROUTINE.                                               05283013
053000                                                                  05284013
053100     INITIALIZE DPG51 DPG52 DPG53                                 05285013
053200                DPG54 DPG55 DPG56.                                05286013
053210                                                                  05287013
053220     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      05288013
053230     SET DPG51-INCREMENT-DATE       TO TRUE.                      05289013
053240     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      05290013
053241     MOVE 1                         TO DPG51-INCR-DECR-DAYS-9.    05300013
053242     MOVE EP111-CC-CRNT-DTE         TO DPG52-DB2-ISO-DATE-FMT.    05310013
053243                                                                  05320013
053244     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05321013
053245                                             DPG54 DPG55 DPG56.   05322013
053246                                                                  05323013
053247     IF DPG54-SEVERE-ERROR OR DPG54-DATE-INVALID                  05324013
053248       DISPLAY '** ABEND **'                                      05324113
053249       DISPLAY '** PROGRAM = EPKUT126'                            05324213
053250       DISPLAY 'DATE = ' EP111-CC-CRNT-DTE                        05324313
053251       DISPLAY DPG54-ERROR-MESSAGE                                05324413
053252       MOVE 4019 TO PV-ABEND-CODE                                 05324513
053253       CALL 'ILBOABN0' USING PV-ABEND-CODE                        05324613
           END-IF.                                                      05324713
053254                                                                  05324813
053255     MOVE DPG55-DB2-ISO-DATE-FMT     TO EP111-CC-DATE-PLUS1.      05324913
053256                                                                  05325013
053257     INITIALIZE DPG51 DPG52 DPG53                                 05325113
053258                DPG54 DPG55 DPG56.                                05325213
053259                                                                  05325313
053260     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      05325413
053261     SET DPG51-DECREMENT-DATE       TO TRUE.                      05325513
053262     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      05325613
053263     MOVE 1                         TO DPG51-INCR-DECR-DAYS-9.    05325713
053264     MOVE EP113-CC-CRNT-DTE         TO DPG52-DB2-ISO-DATE-FMT.    05325813
053265                                                                  05325913
053266     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05326013
053267                                             DPG54 DPG55 DPG56.   05326113
053268                                                                  05326213
053269     IF DPG54-SEVERE-ERROR OR DPG54-DATE-INVALID                  05326313
053270       DISPLAY '** ABEND **'                                      05326413
053271       DISPLAY '** PROGRAM = EPKUT126'                            05326513
053272       DISPLAY 'DATE = ' EP111-CC-CRNT-DTE                        05326613
053273       DISPLAY DPG54-ERROR-MESSAGE                                05326713
053274       MOVE 4019 TO PV-ABEND-CODE                                 05326813
053275       CALL 'ILBOABN0' USING PV-ABEND-CODE                        05326913
           END-IF.                                                      05327013
053276                                                                  05327113
053277     MOVE DPG55-DB2-ISO-DATE-FMT    TO EP113-CC-CRNT-DTE-MINUS1.  05327213
053278                                                                  05327313
053279*6100-EXIT.                                                       05327413
053280 EJECT.                                                           05327513
053281                                                                  05327613
055100*----------------------------------------------------------       05327713
055200* 9900-SQL-ABEND-ROUTINE.                                         05327813
055300*     SQL ABEND ROUTINE.                                          05327913
055400*----------------------------------------------------------       05328013
055500 9900-SQL-ABEND-ROUTINE.                                          05329013
055600                                                                  05330013
055700     DISPLAY '** ABEND     **'.                                   05340013
055800     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        05350013
055900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              05360013
056000     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               05370013
056100                                                                  05380013
056200     COPY DPPD004.                                                05390013
056300     SET ABEND-4013-DB2-ERROR TO TRUE.                            05400013
056400     CALL 'ILBOABN0' USING ABEND-CODE.                            05410013
056500                                                                  05420013
056600*9900-EXIT.                                                       05430013
056700 EJECT.                                                           05440013
056800                                                                  05450013
056900*----------------------------------------------------------       05460013
057000* 9999-WRAPUP.                                                    05470013
057100*     END OF PROGRAM ROUTINE.  CLOSES ALL FILES AND DISPLAYS      05480013
057200*     ANY DATA FROM THE PROGRAM.                                  05490013
057300*----------------------------------------------------------       05500013
057400 9999-WRAPUP.                                                     05510013
057500                                                                  05520013
058010     CLOSE CONTROL-CARD-PGM-LAST-RUN-DTE.                         05530013
058020     OPEN OUTPUT CONTROL-CARD-PGM-LAST-RUN-DTE.                   05540013
058030                                                                  05550013
058031     MOVE PV-CURRENT-SYSTEM-TMST TO EP121-CC-PROMO-CUTOFF-TMST    05560014
058032     WRITE CNTRL-CARD-PGM-LAST-RUN-REC                            05570013
058034                                   FROM EP121-CC-CONTROL-CARD.    05580014
058070                                                                  05590020
058070      DISPLAY 'DATE3' EP111-CC-CRNT-DTE                           05591019
058070      DISPLAY 'DATE4' EP111-CC-DATE-PLUS1                         05594019
058070      DISPLAY 'DATE5' EP113-CC-CRNT-DTE-MINUS1                    05595019
058080     CLOSE CONTROL-CARD-CURR-PRICG-DTE                            05600013
058090           CONTROL-CARD-FUTRE-CORR-DTE                            05610013
058091           CONTROL-CARD-PGM-LAST-RUN-DTE                          05620013
058092           CONTROL-CARD-CRIT-EFF-DTE                              05630013
058093           PROMO-NIGHT-FILE                                       05640013
058094           PROMO-EMERGENCY-FILE.                                  05650013
058095                                                                  05660013
058100     DISPLAY ' '.                                                 05670013
058200     DISPLAY '*********************************************'.     05680013
058300     DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            05690013
058400     DISPLAY '*********************************************'.     05700013
058700     DISPLAY 'NUMBER OF NIGHT RECS WRITTEN: ' PC-CNT-NIGHT-RECS.  05710013
058800     DISPLAY 'NUMBER OF EMERG. RECS WRITTEN: ' PC-CNT-EMERG-RECS. 05720013
058900     DISPLAY 'NUMBER OF RECS FROM RMS QUERY:' PC-CNT-RMS-RECS.    05730013
059000     DISPLAY 'NUMBER OF RECS FROM ADHC QUERY: ' PC-CNT-ADHOC-RECS.05740013
059100*    DISPLAY 'NUMBER OF RECS FROM DEVT QUERY: ' PC-CNT-DEVT-RECS. 05750013
059200     DISPLAY 'ALL RECS WRITTEN: ' PC-CNT-ALL-RECS.                05760013
059300     DISPLAY '*********************************************'.     05770013
059400                                                                  05780013
059500*9999-EXIT.                                                       05790013
059600 EJECT.                                                           05800013
059700                                                                  05810013
