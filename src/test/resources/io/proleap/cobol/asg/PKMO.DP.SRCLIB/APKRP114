000100 IDENTIFICATION DIVISION.                                         00010006
000200 PROGRAM-ID.     APKRP114.                                        00020006
000300 AUTHOR.         MARILYN WILKINSON.                               00030006
000400 DATE-WRITTEN.   08/27/1996.                                      00040006
000500 DATE-COMPILED.                                                   00050006
000600*************************************************************     00060006
000700*    COBOL 2                                                *     00070006
000800*                                                           *     00080006
000900*    MONTHLY UNJOURNALIZED RECEIPT ANALYSIS REPORT          *     00090006
001000*                                                           *     00100006
001100*   PROGRAM OVERVIEW:                                       *     00110006
001200*                                                           *     00120006
001300*     THIS PROGRAM CREATES THE MONTHLY UNJOURNALIZED RECPT  *     00130006
001400*   ANALYSIS REPORT FROM A REPORT FILE PRODUCED IN APKUT113 *     00140006
001500*   AND A DATE FILE PRODUCED IN APKUT106.                   *     00150006
001600*     THE REPORT WILL BE IN DATE, DEPARTMENT, VENDOR NAME   *     00160006
001700*   AND PURCHASE ORDER SEQUENCE.  A CONTROL BREAK WILL BE   *     00170006
001800*   DONE ON DATE.  GRAND TOTALS WILL ALSO BE ACCUMULATED.   *     00180006
001900*                                                           *     00190006
002000*   INPUT:                                                  *     00200006
002100*  1) UNJRNLZD-MNTHLY-RCPT-FILE           (APRD113)         *     00210015
002200*  2) UNJRNLZD-RECEIPT-DATE-FILE          (APRD108)         *     00220015
002300*                                                           *     00230015
002400*   OUTPUT:                                                 *     00240006
002500*  1) RPT01-FILE                          (DPWS150O)        *     00250015
002600*                                                           *     00260006
002700*************************************************************     00270006
002800*                                                           *     00280006
002900*   07/13/98 -  CHANGED THE CALL TO THE CALENDAR ROUTINE    *     00290006
003000*               TO INCLUDE THE SYSTEM DATE.  ALSO, INIT     *     00300006
003100*               THE CALENDAR VARS.                          *     00310006
003200*   PITS 207006  MADE BY CHRIS BOEHNLEIN                    *     00320006
003300*   07/29/98    CHANGE MADE: Y2K.                           *     00330006
003400*                                                           *     00340006
003500*   WR#: 6041    MADE BY CAROLYN GIFFORD                    *     00350006
003600*                                                           *     00360006
003700* 12/08/1999 JILL JUEL                   WR/IR #: WR6041    *     00370006
003800*            - MODIFIED THE CHECK ON THE DATE ROUTINE TO    *     00380006
003900*              CONFORM WITH Y2K STANDARDS BY ADDING         *     00390006
004000*              DPG54-WARNING-ERROR.                         *     00400006
004100*                                                           *     00410006
004200* 11/15/2002                                                *     00420010
004300*    CHANGE MADE: INCREASED THE SIZE OF THE REPORT FROM 132 *     00430009
004400*    TO 150 CHARCTERS WIDE.  THIS WILL ALLOW THE ADDITION OF*     00440009
004500*    THE OPEN TO BUY PERIOD ON THE REPORT.                  *     00450009
004600* MADE BY:  MIKE BESKE                          WR#: 24091  *     00460009
004700*                                                           *     00470011
004800* 01/02/2003                                                *     00480014
004900*    CHANGE MADE: ADDED CODE TO MOVE THE OPEN TO BUY PERIOD *     00490011
005000*    FROM THE INPUT DATASET TO THE REPORT.                  *     00500013
005100* MADE BY:  MIKE BESKE                          WR#: 22902  *     00510012
005200*                                                           *     00520015
005300* 02/04/2003                                                *     00530015
005400*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00540015
005500*    UPDATED THE FILES IN THE PROG COMMENT BLOCK.           *     00550015
005600*    INCREASED THE PO PRINT FIELD TO Z(9) AND ADJUSTED THE  *     00560015
005700*    PRINT HEADERS TO MATCH ACCORDINGLY.                    *     00570015
005800* MADE BY:  MIKE BESKE                          WR#: 23500  *     00580015
005900*************************************************************     00590006
006000/                                                                 00600006
006100 ENVIRONMENT DIVISION.                                            00610006
006200 CONFIGURATION SECTION.                                           00620006
006300 INPUT-OUTPUT SECTION.                                            00630006
006400 FILE-CONTROL.                                                    00640006
006500                                                                  00650006
006600     SELECT UNJRNLZD-MNTHLY-RCPT-FILE   ASSIGN TO UT-S-INP01.     00660006
006700     SELECT UNJRNLZD-RECEIPT-DATE-FILE  ASSIGN TO UT-S-INP02.     00670006
006800     SELECT RPT01-FILE                  ASSIGN TO UT-S-RPT01.     00680006
006900                                                                  00690006
007000 DATA DIVISION.                                                   00700006
007100 FILE SECTION.                                                    00710006
007200 FD  UNJRNLZD-MNTHLY-RCPT-FILE                                    00720006
007300     RECORDING MODE IS F                                          00730006
007400     LABEL RECORDS ARE STANDARD                                   00740006
007500     BLOCK CONTAINS 0 RECORDS                                     00750006
007600     DATA RECORD IS UNJRNLZD-MNTHLY-RCPT-RECORD.                  00760006
007700 01  UNJRNLZD-MNTHLY-RCPT-RECORD PIC X(99).                       00770006
007800                                                                  00780006
007900 FD  UNJRNLZD-RECEIPT-DATE-FILE                                   00790006
008000     RECORDING MODE IS F                                          00800006
008100     LABEL RECORDS ARE STANDARD                                   00810006
008200     BLOCK CONTAINS 0 RECORDS                                     00820006
008300     DATA RECORD IS UNJRNLZD-RECEIPT-DATE-RECORD.                 00830006
008400 01  UNJRNLZD-RECEIPT-DATE-RECORD PIC X(41).                      00840006
008500                                                                  00850006
008600 FD  RPT01-FILE                                                   00860006
008700     RECORDING MODE IS F                                          00870006
008800     LABEL RECORDS ARE STANDARD                                   00880006
008900     BLOCK CONTAINS 0 RECORDS                                     00890006
009000     DATA RECORD IS RPT01-RECORD.                                 00900006
009100 01  RPT01-RECORD                PIC  X(150).                     00910007
009200                                                                  00920006
009300 EJECT                                                            00930006
009400 WORKING-STORAGE SECTION.                                         00940006
009500                                                                  00950006
009600 01  PROGRAM-WORKAREA.                                            00960006
009700     05  FILLER                  PIC  X(30)           VALUE       00970006
009800         '** BEGINING OF APKRP114 W/S **'.                        00980006
009900                                                                  00990006
010000     05  PV-CURRENT-PARAGRAPH    PIC  X(30)       VALUE SPACE.    01000006
010100     05  PV-PROGRAM-NAME         PIC  X(08)       VALUE           01010006
010200         'APKRP114'.                                              01020006
010300                                                                  01030006
010400 01  PV-CURRENT-DATE.                                             01040006
010500     05  PV-CURRENT-YEAR         PIC  9(02).                      01050006
010600     05  PV-CURRENT-MONTH        PIC  9(02).                      01060006
010700     05  PV-CURRENT-DAY          PIC  9(02).                      01070006
010800                                                                  01080006
010900 01  PV-CURRENT-TIME.                                             01090006
011000     05  PV-CURRENT-HOUR         PIC  9(02).                      01100006
011100     05  PV-CURRENT-MINUTE       PIC  9(02).                      01110006
011200     05  FILLER                  PIC  9(02)       VALUE 00.       01120006
011300                                                                  01130006
011400 01  PV-PREV-UNJ-DATE            PIC  X(06)       VALUE SPACES.   01140006
011500 01  PV-AREA-10                  PIC  X(10)       VALUE SPACES.   01150006
011600                                                                  01160006
011700 01  PV-MONTH-TOTAL-AREA.                                         01170006
011800     05  PV-MTH-PO-COST          PIC S9(09)V99 COMP-3 VALUE +0.   01180006
011900     05  PV-MTH-VERFYD-COST      PIC S9(09)V99 COMP-3 VALUE +0.   01190006
012000     05  PV-MTH-VERFYD-EXC-COST  PIC S9(09)V99 COMP-3 VALUE +0.   01200006
012100     05  PV-MTH-UNJRNL-NIR-COST  PIC S9(09)V99 COMP-3 VALUE +0.   01210006
012200     05  PV-MTH-UNJRNL-RCVR-COST PIC S9(09)V99 COMP-3 VALUE +0.   01220006
012300                                                                  01230006
012400 01  PV-GRAND-TOTAL-AREA.                                         01240006
012500     05  PV-GRD-PO-COST          PIC S9(11)V99 COMP-3 VALUE +0.   01250006
012600     05  PV-GRD-VERFYD-COST      PIC S9(11)V99 COMP-3 VALUE +0.   01260006
012700     05  PV-GRD-VERFYD-EXC-COST  PIC S9(11)V99 COMP-3 VALUE +0.   01270006
012800     05  PV-GRD-UNJRNL-NIR-COST  PIC S9(11)V99 COMP-3 VALUE +0.   01280006
012900     05  PV-GRD-UNJRNL-RCVR-COST PIC S9(11)V99 COMP-3 VALUE +0.   01290006
013000                                                                  01300006
013100 01  PRINT-FIELDS.                                                01310006
013200     05  PR-MAX-LINES            PIC S9(05)   COMP-3  VALUE +64.  01320006
013300     05  PR-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +99.  01330006
013400     05  PR-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01340006
013500     05  PR-DETAIL-CC            PIC S9(01)   COMP-3  VALUE +0.   01350006
013600     05  PR-CC                   PIC S9(01)   COMP-3  VALUE +0.   01360006
013700                                                                  01370006
013800     05  PR-LINE                 PIC  X(150)  VALUE SPACES.       01380007
013900                                                                  01390006
014000 01  PROGRAM-SWITCHES-SUBSCRIPTS.                                 01400006
014100     05  PS-END-OF-RECEIPT-RECS-SW                                01410006
014200                                 PIC  X(01)   VALUE 'N'.          01420006
014300         88  END-OF-RECEIPT-RECS              VALUE 'Y'.          01430006
014400                                                                  01440006
014500 01  PR-END-DATE.                                                 01450006
014600     05  PR-END-MONTH            PIC  9(02)   VALUE ZERO.         01460006
014700     05  FILLER                  PIC  X(01)   VALUE '/'.          01470006
014800     05  PR-END-DAY              PIC  9(02)   VALUE ZERO.         01480006
014900     05  FILLER                  PIC  X(01)   VALUE '/'.          01490006
015000     05  PR-END-YEAR             PIC  9(04)   VALUE ZERO.         01500006
015100                                                                  01510006
015200 01  PR-START-DATE.                                               01520006
015300     05  PR-START-MONTH          PIC  9(02)   VALUE ZERO.         01530006
015400     05  FILLER                  PIC  X(01)   VALUE '/'.          01540006
015500     05  PR-START-DAY            PIC  9(02)   VALUE ZERO.         01550006
015600     05  FILLER                  PIC  X(01)   VALUE '/'.          01560006
015700     05  PR-START-YEAR           PIC  9(04)   VALUE ZERO.         01570006
015800                                                                  01580006
015900 01  PV-END-DATE.                                                 01590006
016000     05  PV-END-YEAR             PIC  9(04)   VALUE ZERO.         01600006
016100     05  FILLER                  PIC  X(01)   VALUE '-'.          01610006
016200     05  PV-END-MONTH            PIC  9(02)   VALUE ZERO.         01620006
016300     05  FILLER                  PIC  X(01)   VALUE '-'.          01630006
016400     05  PV-END-DAY              PIC  9(02)   VALUE ZERO.         01640006
016500                                                                  01650006
016600 01  PV-START-DATE.                                               01660006
016700     05  PV-START-YEAR           PIC  9(04)   VALUE ZERO.         01670006
016800     05  FILLER                  PIC  X(01)   VALUE '-'.          01680006
016900     05  PV-START-MONTH          PIC  9(02)   VALUE ZERO.         01690006
017000     05  FILLER                  PIC  X(01)   VALUE '-'.          01700006
017100     05  PV-START-DAY            PIC  9(02)   VALUE ZERO.         01710006
017200                                                                  01720006
017300 EJECT                                                            01730006
017400*  INPUT RECORD AREA                                              01740006
017500                                                                  01750006
017600     COPY APRD113.                                                01760006
017700                                                                  01770006
017800 EJECT                                                            01780006
017900*  UNJOURNALIZED RECEIPT DATE FILE                                01790006
018000     COPY APRD108.                                                01800006
018100                                                                  01810006
018200 EJECT                                                            01820006
018300*  PRINT AREA                                                     01830006
018400                                                                  01840006
018500     COPY DPWS150O.                                               01850007
018600                                                                  01860006
018700 01  HDR-LINE2.                                                   01870006
018800     05  FILLER                  PIC  X(49)   VALUE SPACES.       01880007
018900     05  HL2-TITLE               PIC  X(52)   VALUE               01890006
019000         '    MONTHLY UNJOURNALIZED RECEIPT ANALYSIS REPORT   '.  01900006
019100     05  FILLER                  PIC  X(49)   VALUE SPACES.       01910007
019200                                                                  01920006
019300 01  HDR-LINE3.                                                   01930006
019400     05  FILLER                  PIC  X(59)   VALUE SPACES.       01940007
019500     05  FILLER                  PIC  X(07)   VALUE 'DATES: '.    01950006
019600     05  HL3-START-DATE          PIC  X(10)   VALUE SPACES.       01960006
019700     05  FILLER                  PIC  X(06)   VALUE ' THRU '.     01970006
019800     05  HL3-END-DATE            PIC  X(10)   VALUE SPACES.       01980006
019900     05  FILLER                  PIC  X(58)   VALUE SPACES.       01990007
020000                                                                  02000006
020100 01  HDR-LINE4.                                                   02010006
020200     05  FILLER                  PIC  X(16)   VALUE               02020006
020300         'MONTH AND YEAR: '.                                      02030006
020400     05  HL4-MONTH               PIC  X(02)   VALUE SPACES.       02040006
020500     05  FILLER                  PIC  X(01)   VALUE '/'.          02050006
020600     05  HL4-YEAR                PIC  X(04)   VALUE SPACES.       02060006
020700     05  FILLER                  PIC X(127)   VALUE SPACES.       02070007
020800                                                                  02080006
020900 01  HDR-LINE4A.                                                  02090006
021000     05  FILLER                  PIC  X(33)    VALUE SPACES.      02100006
021100     05  FILLER                  PIC  X(06)    VALUE 'VENDOR'.    02110006
021200     05  FILLER                  PIC  X(12)    VALUE SPACES.      02120006
021300     05  FILLER                  PIC  X(02)    VALUE 'PO'.        02130006
021400     05  FILLER                  PIC  X(40)    VALUE SPACES.      02140015
021500     05  FILLER                  PIC  X(40)    VALUE              02150006
021600         'VERIFIED    UNJOURNALIZED  UNJOURNALIZED'.              02160006
021700     05  FILLER                  PIC  X(16)    VALUE              02170015
021800         '  OPEN TO       '.                                      02180015
021900                                                                  02190006
022000 01  HDR-LINE5.                                                   02200006
022100     05  FILLER                  PIC  X(11)    VALUE              02210006
022200         'VENDOR NAME'.                                           02220006
022300     05  FILLER                  PIC  X(22)    VALUE SPACES.      02230006
022400     05  FILLER                  PIC  X(38)    VALUE              02240015
022500         'NUMBER    DEPT    NUMBER       PO COST'.                02250015
022600     05  FILLER                  PIC  X(04)    VALUE SPACES.      02260006
022700     05  FILLER                  PIC  X(39)    VALUE              02270006
022800         'VERIFIED COST    EXCEPTN AMT        NIR'.               02280006
022900     05  FILLER                  PIC  X(09)    VALUE SPACES.      02290006
023000     05  FILLER                  PIC  X(11)    VALUE              02300006
023100         'RECEIVERS  '.                                           02310006
023200     05  FILLER                  PIC  X(16)    VALUE              02320015
023300         '  BUY DT        '.                                      02330015
023400                                                                  02340006
023500 01  HDR-LINE6.                                                   02350006
023600     05  FILLER                  PIC  X(49)    VALUE              02360006
023700         '------------------------------  ---------  ----  '.     02370006
023800     05  FILLER                  PIC  X(43)    VALUE              02380015
023900         '--------- -------------- --------------  --'.           02390015
024000     05  FILLER                  PIC  X(42)    VALUE              02400006
024100         '------------ -------------- --------------'.            02410006
024200     05  FILLER                  PIC  X(16)    VALUE              02420015
024300         '  ------        '.                                      02430015
024400                                                                  02440006
024500 01  DETAIL-LINE                 PIC  X(150)   VALUE SPACES.      02450007
024600                                                                  02460006
024700 01  PO-DETAIL-LINE              REDEFINES  DETAIL-LINE.          02470006
024800     05  PDL-VENDOR-NAME         PIC  X(30).                      02480006
024900     05  FILLER                  PIC  X(02).                      02490006
025000     05  PDL-VENDOR-NUMBER       PIC  X(09).                      02500006
025100     05  FILLER                  PIC  X(03).                      02510006
025200     05  PDL-DEPARTMENT          PIC  X(03).                      02520006
025300     05  FILLER                  PIC  X(02).                      02530006
025400     05  PDL-PO-NBR              PIC  Z(09).                      02540017
025500     05  FILLER                  PIC  X(01).                      02550006
025600     05  PDL-PO-COST             PIC  ZZZ,ZZZ,ZZ9.99.             02560006
025700     05  FILLER                  PIC  X(01).                      02570006
025800     05  PDL-VERIFIED-COST       PIC  ZZZ,ZZZ,ZZ9.99.             02580006
025900     05  FILLER                  PIC  X(01).                      02590006
026000     05  PDL-VER-EXCEPT-AMT      PIC  ZZZ,ZZZ,ZZ9.99-.            02600006
026100     05  FILLER                  PIC  X(01).                      02610006
026200     05  PDL-UNJRNLZD-NIR        PIC  ZZZ,ZZZ,ZZ9.99.             02620006
026300     05  FILLER                  PIC  X(01).                      02630006
026400     05  PDL-UNJRNLZD-RECEIVERS  PIC  ZZZ,ZZZ,ZZ9.99.             02640006
026500     05  FILLER                  PIC  X(02).                      02650007
026600     05  PDL-OTB-PER-NBR         PIC  X(06).                      02660007
026700     05  FILLER                  PIC  X(08).                      02670015
026800                                                                  02680006
026900 01  PO-MONTH-TOTAL-LINE.                                         02690006
027000     05  FILLER                  PIC  X(11)  VALUE                02700006
027100         'TOTALS FOR '.                                           02710006
027200     05  PML-MONTH-ABBR3         PIC  X(03)  VALUE SPACES.        02720006
027300     05  FILLER                  PIC  X(01)  VALUE SPACES.        02730006
027400     05  PML-YEAR                PIC  X(04)  VALUE SPACES.        02740006
027500     05  FILLER                  PIC  X(40)  VALUE SPACES.        02750019
027600     05  PML-PO-COST             PIC  ZZZ,ZZZ,ZZ9.99.             02760006
027700     05  FILLER                  PIC  X(01)  VALUE SPACES.        02770006
027800     05  PML-VERIFIED-COST       PIC  ZZZ,ZZZ,ZZ9.99.             02780006
027900     05  FILLER                  PIC  X(01)  VALUE SPACES.        02790006
028000     05  PML-VER-EXCEPT-AMT      PIC  ZZZ,ZZZ,ZZ9.99-.            02800006
028100     05  FILLER                  PIC  X(01)  VALUE SPACES.        02810006
028200     05  PML-UNJRNLZD-NIR        PIC  ZZZ,ZZZ,ZZ9.99.             02820006
028300     05  FILLER                  PIC  X(01)  VALUE SPACES.        02830006
028400     05  PML-UNJRNLZD-RECEIVERS  PIC  ZZZ,ZZZ,ZZ9.99.             02840006
028500     05  FILLER                  PIC  X(18).                      02850007
028600                                                                  02860006
028700 01  PO-GRAND-TOTAL-LINE1.                                        02870006
028800     05  FILLER                  PIC  X(16)  VALUE                02880006
028900         'GRAND TOTALS:   '.                                      02890006
029000     05  FILLER                  PIC  X(40)  VALUE SPACES.        02900018
029100     05  PGL-PO-COST             PIC  ZZ,ZZZ,ZZZ,ZZ9.99.          02910006
029200     05  FILLER                  PIC  X(13)  VALUE SPACES.        02920006
029300     05  PGL-VER-EXCEPT-AMT      PIC  ZZ,ZZZ,ZZZ,ZZ9.99-.         02930006
029400     05  FILLER                  PIC  X(13)  VALUE SPACES.        02940006
029500     05  PGL-UNJRNLZD-RECEIVERS  PIC  ZZ,ZZZ,ZZZ,ZZ9.99.          02950006
029600     05  FILLER                  PIC  X(18).                      02960007
029700                                                                  02970006
029800 01  PO-GRAND-TOTAL-LINE2.                                        02980006
029900     05  FILLER                  PIC  X(71)  VALUE SPACES.        02990018
030000     05  PGL-VERIFIED-COST       PIC  ZZ,ZZZ,ZZZ,ZZ9.99.          03000006
030100     05  FILLER                  PIC  X(14)  VALUE SPACES.        03010006
030200     05  PGL-UNJRNLZD-NIR        PIC  ZZ,ZZZ,ZZZ,ZZ9.99.          03020006
030300     05  FILLER                  PIC  X(15)  VALUE SPACES.        03030006
030400     05  FILLER                  PIC  X(18).                      03040007
030500                                                                  03050006
030600 01  EOR-END-OF-REPORT.                                           03060006
030700     05  FILLER                  PIC  X(62)  VALUE SPACES.        03070007
030800     05  FILLER                  PIC  X(26)  VALUE                03080007
030900         '*****  END OF REPORT *****'.                            03090007
031000     05  FILLER                  PIC  X(62)  VALUE SPACES.        03100007
031100                                                                  03110006
031200 EJECT                                                            03120006
031300*  ABEND AREA                                                     03130006
031400                                                                  03140006
031500 01  ABEND-CODE                  PIC S9(04)  COMP  VALUE ZERO.    03150006
031600     88  AC-MISSING-DATE-REC                 VALUE +4001.         03160006
031700                                                                  03170006
031800 01  ABEND-AREAS.                                                 03180006
031900     05  AA-ABEND-LIT            PIC  X(40)  VALUE                03190006
032000             '*****       ABEND'.                                 03200006
032100     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                03210006
032200             '*****   PROGRAM: '.                                 03220006
032300     05  AA-PARAGRAPH-LIT        PIC  X(40)  VALUE                03230006
032400             '***** PARAGRAPH: '.                                 03240006
032500     05  AA-ABEND-OPERATION      PIC  X(50)  VALUE SPACES.        03250006
032600     05  AA-MESSAGE-LINE.                                         03260006
032700         10  FILLER              PIC  X(06)  VALUE '*****'.       03270006
032800         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        03280006
032900                                                                  03290006
033000     EJECT                                                        03300006
033100*** GREGORIAN/JULIAN DATE CONVERSION                              03310006
033200     COPY DPWS500.                                                03320006
033300                                                                  03330006
033400 01  FILLER                      PIC  X(25)  VALUE                03340006
033500     '** END OF APKRP114 W/S **'.                                 03350006
033600                                                                  03360006
033700 EJECT                                                            03370006
033800 PROCEDURE DIVISION.                                              03380006
033900                                                                  03390006
034000***************************************************************** 03400006
034100*  MAIN PARAGRAPH                                                 03410006
034200***************************************************************** 03420006
034300 0000-MAIN.                                                       03430006
034400                                                                  03440006
034500     MOVE '0000-MAIN'            TO   PV-CURRENT-PARAGRAPH.       03450006
034600                                                                  03460006
034700     PERFORM 1000-BEGIN-PROGRAM.                                  03470006
034800                                                                  03480006
034900     PERFORM 2000-PROCESS-INPUT                                   03490006
035000         UNTIL END-OF-RECEIPT-RECS.                               03500006
035100                                                                  03510006
035200     PERFORM 3000-END-PROGRAM.                                    03520006
035300                                                                  03530006
035400     GOBACK.                                                      03540006
035500                                                                  03550006
035600 EJECT                                                            03560006
035700***************************************************************** 03570006
035800*  BEGIN PROGRAM STUFF                                            03580006
035900*                                                                 03590006
036000*  CALLED FROM 0000-MAIN                                          03600006
036100***************************************************************** 03610006
036200 1000-BEGIN-PROGRAM.                                              03620006
036300                                                                  03630006
036400     MOVE '1000-BEGIN-PROGRAM'   TO   PV-CURRENT-PARAGRAPH.       03640006
036500                                                                  03650006
036600     OPEN INPUT  UNJRNLZD-MNTHLY-RCPT-FILE                        03660006
036700          INPUT  UNJRNLZD-RECEIPT-DATE-FILE                       03670006
036800          OUTPUT RPT01-FILE.                                      03680006
036900                                                                  03690006
037000     ACCEPT PV-CURRENT-DATE      FROM DATE.                       03700006
037100     MOVE PV-CURRENT-MONTH       TO   DP150O-RUN-MONTH.           03710008
037200     MOVE PV-CURRENT-DAY         TO   DP150O-RUN-DAY.             03720008
037300     MOVE PV-CURRENT-YEAR        TO   DP150O-RUN-YEAR.            03730008
037400                                                                  03740006
037500     ACCEPT PV-CURRENT-TIME      FROM TIME.                       03750006
037600     MOVE PV-CURRENT-HOUR        TO   DP150O-RUN-HOUR.            03760008
037700     MOVE PV-CURRENT-MINUTE      TO   DP150O-RUN-MINUTE.          03770008
037800                                                                  03780006
037900     MOVE PV-PROGRAM-NAME        TO   DP150O-PROGRAM-NAME.        03790008
038000     MOVE 1                      TO   DP150O-REPORT-NUMBER.       03800008
038100                                                                  03810006
038200     PERFORM 8100-READ-RECEIPT-DATE-FILE.                         03820006
038300                                                                  03830006
038400     MOVE AP108-START-DATE       TO   PV-START-DATE.              03840006
038500     MOVE PV-START-YEAR          TO   PR-START-YEAR.              03850006
038600     MOVE PV-START-MONTH         TO   PR-START-MONTH.             03860006
038700     MOVE PV-START-DAY           TO   PR-START-DAY.               03870006
038800     MOVE PR-START-DATE          TO   HL3-START-DATE.             03880006
038900                                                                  03890006
039000     MOVE AP108-END-DATE         TO   PV-END-DATE.                03900006
039100     MOVE PV-END-YEAR            TO   PR-END-YEAR.                03910006
039200     MOVE PV-END-MONTH           TO   PR-END-MONTH.               03920006
039300     MOVE PV-END-DAY             TO   PR-END-DAY.                 03930006
039400     MOVE PR-END-DATE            TO   HL3-END-DATE.               03940006
039500                                                                  03950006
039600     MOVE SPACE                  TO   DETAIL-LINE.                03960006
039700                                                                  03970006
039800     PERFORM 8000-READ-RECEIPT-DATA-FILE.                         03980006
039900     IF NOT END-OF-RECEIPT-RECS                                   03990006
040000        MOVE AP113-UNJ-DATE TO PV-PREV-UNJ-DATE                   04000006
040100        MOVE AP113-CCYY     TO HL4-YEAR                           04010006
040200        MOVE AP113-MM       TO HL4-MONTH                          04020006
040300        PERFORM 9500-CALL-DATE-ROUTINE                            04030006
040400     END-IF.                                                      04040006
040500                                                                  04050006
040600 EJECT                                                            04060006
040700***************************************************************** 04070006
040800*  MAIN PROGRAM LOOP, ENSURES WE WILL GET THE REPORT PRINTED      04080006
040900*  EVEN IF NO INPUT.                                              04090006
041000*                                                                 04100006
041100*  CALLED FROM 0000-MAIN                                          04110006
041200***************************************************************** 04120006
041300 2000-PROCESS-INPUT.                                              04130006
041400                                                                  04140006
041500     MOVE '2000-PROCESS-INPUT'   TO   PV-CURRENT-PARAGRAPH.       04150006
041600                                                                  04160006
041700*  PROCESS INPUT RECORD                                           04170006
041800                                                                  04180006
041900     IF AP113-UNJ-DATE NOT = PV-PREV-UNJ-DATE                     04190006
042000        PERFORM 2100-MONTHLY-TOTALS                               04200006
042100        MOVE AP113-UNJ-DATE       TO  PV-PREV-UNJ-DATE            04210006
042200        MOVE AP113-CCYY           TO  HL4-YEAR                    04220006
042300        MOVE AP113-MM             TO  HL4-MONTH                   04230006
042400        PERFORM 9500-CALL-DATE-ROUTINE                            04240006
042500        MOVE ZEROS                TO  PV-MTH-PO-COST              04250006
042600                                      PV-MTH-VERFYD-COST          04260006
042700                                      PV-MTH-VERFYD-EXC-COST      04270006
042800                                      PV-MTH-UNJRNL-NIR-COST      04280006
042900                                      PV-MTH-UNJRNL-RCVR-COST     04290006
043000        PERFORM 9200-WRITE-HEADING                                04300006
043100     END-IF.                                                      04310006
043200                                                                  04320006
043300     MOVE AP113-VENDOR-NAME       TO  PDL-VENDOR-NAME.            04330006
043400     MOVE AP113-VENDOR-NUMBER     TO  PDL-VENDOR-NUMBER.          04340006
043500     MOVE AP113-DEPT              TO  PDL-DEPARTMENT.             04350006
043600     MOVE AP113-PO-NBR            TO  PDL-PO-NBR.                 04360015
043700     MOVE AP113-PO-COST           TO  PDL-PO-COST.                04370006
043800     MOVE AP113-VERIFIED-COST     TO  PDL-VERIFIED-COST.          04380006
043900     MOVE AP113-VER-EXCEPTION-AMT TO  PDL-VER-EXCEPT-AMT.         04390006
044000     MOVE AP113-UNJRNLZD-NIR      TO  PDL-UNJRNLZD-NIR.           04400006
044100     MOVE AP113-UNJRNLZD-RECEIVER TO  PDL-UNJRNLZD-RECEIVERS.     04410006
044200     MOVE AP113-OTB-PER-NBR       TO  PDL-OTB-PER-NBR.            04420011
044300                                                                  04430011
044400     ADD  AP113-PO-COST           TO PV-MTH-PO-COST.              04440011
044500     ADD  AP113-VERIFIED-COST     TO PV-MTH-VERFYD-COST.          04450011
044600     ADD  AP113-VER-EXCEPTION-AMT TO PV-MTH-VERFYD-EXC-COST.      04460011
044700     ADD  AP113-UNJRNLZD-NIR      TO PV-MTH-UNJRNL-NIR-COST.      04470011
044800     ADD  AP113-UNJRNLZD-RECEIVER TO PV-MTH-UNJRNL-RCVR-COST.     04480011
044900                                                                  04490011
045000*  WRITE REPORT & CLEAR DETAIL                                    04500011
045100                                                                  04510011
045200     PERFORM 9100-WRITE-DETAIL.                                   04520011
045300                                                                  04530011
045400     MOVE SPACE                  TO   DETAIL-LINE.                04540011
045500     MOVE 1                      TO   PR-DETAIL-CC.               04550011
045600                                                                  04560011
045700     PERFORM 8000-READ-RECEIPT-DATA-FILE.                         04570011
045800                                                                  04580011
045900 2100-MONTHLY-TOTALS.                                             04590011
046000                                                                  04600011
046100*  WRITE MONTH TOTAL LINE                                         04610011
046200                                                                  04620011
046300     MOVE PV-MTH-PO-COST          TO  PML-PO-COST.                04630011
046400     MOVE PV-MTH-VERFYD-COST      TO  PML-VERIFIED-COST.          04640011
046500     MOVE PV-MTH-VERFYD-EXC-COST  TO  PML-VER-EXCEPT-AMT.         04650011
046600     MOVE PV-MTH-UNJRNL-NIR-COST  TO  PML-UNJRNLZD-NIR.           04660011
046700     MOVE PV-MTH-UNJRNL-RCVR-COST TO  PML-UNJRNLZD-RECEIVERS.     04670011
046800                                                                  04680011
046900     MOVE SPACE                  TO   DETAIL-LINE.                04690011
047000     MOVE PO-MONTH-TOTAL-LINE    TO   DETAIL-LINE.                04700011
047100     MOVE 2                      TO   PR-DETAIL-CC.               04710011
047200     PERFORM    9400-WRITE-TOTAL.                                 04720011
047300                                                                  04730011
047400     MOVE SPACE                  TO   DETAIL-LINE.                04740011
047500     MOVE 1                      TO   PR-DETAIL-CC.               04750011
047600     PERFORM    9100-WRITE-DETAIL.                                04760011
047700                                                                  04770011
047800     ADD  PV-MTH-PO-COST          TO PV-GRD-PO-COST.              04780011
047900     ADD  PV-MTH-VERFYD-COST      TO PV-GRD-VERFYD-COST.          04790011
048000     ADD  PV-MTH-VERFYD-EXC-COST  TO PV-GRD-VERFYD-EXC-COST.      04800011
048100     ADD  PV-MTH-UNJRNL-NIR-COST  TO PV-GRD-UNJRNL-NIR-COST.      04810011
048200     ADD  PV-MTH-UNJRNL-RCVR-COST TO PV-GRD-UNJRNL-RCVR-COST.     04820011
048300                                                                  04830011
048400 EJECT                                                            04840011
048500***************************************************************** 04850011
048600*                                                                 04860011
048700*  CALLED FROM 0000-MAIN                                          04870011
048800***************************************************************** 04880011
048900 3000-END-PROGRAM.                                                04890011
049000                                                                  04900011
049100     MOVE '3000-END-PROGRAM'     TO   PV-CURRENT-PARAGRAPH.       04910011
049200                                                                  04920011
049300     PERFORM 9300-WRITE-END-OF-RPT.                               04930011
049400                                                                  04940011
049500     CLOSE       UNJRNLZD-MNTHLY-RCPT-FILE                        04950011
049600                 UNJRNLZD-RECEIPT-DATE-FILE                       04960011
049700                 RPT01-FILE.                                      04970011
049800                                                                  04980011
049900 EJECT                                                            04990011
050000***************************************************************** 05000011
050100*  THIS ROUTINE READS THE REPORT DATA FILE FROM APKUT107          05010011
050200*                                                                 05020011
050300*  CALLED FROM 1000-BEGIN-PROGRAM                                 05030011
050400*  CALLED FROM 2000-PROCESS-INPUT                                 05040011
050500***************************************************************** 05050011
050600 8000-READ-RECEIPT-DATA-FILE.                                     05060011
050700                                                                  05070011
050800     MOVE '8000-READ-RECEIPT-DATA-FILE'                           05080011
050900                                 TO   PV-CURRENT-PARAGRAPH.       05090011
051000                                                                  05100011
051100     READ UNJRNLZD-MNTHLY-RCPT-FILE INTO AP113-RECORD             05110011
051200         AT END                                                   05120011
051300             SET END-OF-RECEIPT-RECS TO TRUE.                     05130011
051400                                                                  05140011
051500 EJECT                                                            05150011
051600***************************************************************** 05160011
051700*  THIS ROUTINE READS THE REPORT DATE FILE FROM APKUT106          05170011
051800*                                                                 05180011
051900*  CALLED FROM 1000-BEGIN-PROGRAM                                 05190011
052000***************************************************************** 05200011
052100 8100-READ-RECEIPT-DATE-FILE.                                     05210011
052200                                                                  05220011
052300     MOVE '8100-READ-RECEIPT-DATE-FILE'                           05230011
052400                                 TO   PV-CURRENT-PARAGRAPH.       05240011
052500                                                                  05250011
052600     READ UNJRNLZD-RECEIPT-DATE-FILE INTO AP108-RECORD            05260011
052700         AT END                                                   05270011
052800             MOVE 'EMPTY UNJOURNALIZED RECEIPT DATES FILE'        05280011
052900                                         TO AA-MESSAGE            05290011
053000             SET AC-MISSING-DATE-REC     TO TRUE                  05300011
053100             PERFORM 9999-ABEND.                                  05310011
053200                                                                  05320011
053300 EJECT                                                            05330011
053400***************************************************************** 05340011
053500*  THIS IS THE ACTUAL WRITE TO THE REPORT FILE.  IT USES PR-CC    05350011
053600*  TO DETERMINE THE HORIZONTAL SPACING.                           05360011
053700***************************************************************** 05370011
053800 9000-WRITE-REPORT.                                               05380011
053900                                                                  05390011
054000     MOVE '9000-WRITE-REPORT'    TO   PV-CURRENT-PARAGRAPH.       05400011
054100                                                                  05410011
054200     IF PR-CC = 0                                                 05420011
054300         MOVE 1                  TO   PR-CC                       05430011
054400         WRITE RPT01-RECORD FROM PR-LINE                          05440011
054500             AFTER ADVANCING PAGE                                 05450011
054600     ELSE                                                         05460011
054700         WRITE RPT01-RECORD FROM PR-LINE                          05470011
054800             AFTER ADVANCING PR-CC                                05480011
054900     END-IF.                                                      05490011
055000                                                                  05500011
055100*  BUMP LINE COUNT                                                05510011
055200                                                                  05520011
055300     ADD PR-CC                   TO   PR-LINE-COUNT.              05530011
055400                                                                  05540011
055500 EJECT                                                            05550011
055600***************************************************************** 05560011
055700*  REPORT DETAIL FOR EACH OF THE REPORTS.  THIS ROUTINE CHECKS    05570011
055800*  FOR PAGE OVERFLOW AND PERFORMS A HEADING ROUTINE IF NECESSARY  05580011
055900*                                                                 05590011
056000***************************************************************** 05600011
056100 9100-WRITE-DETAIL.                                               05610011
056200                                                                  05620011
056300     MOVE '9100-WRITE-DETAIL'    TO   PV-CURRENT-PARAGRAPH.       05630011
056400                                                                  05640011
056500*  CHECK FOR PAGE OVERFLOW.                                       05650011
056600*                                                                 05660011
056700*  WE WANT TO DISPLAY VENDOR & PO ONCE PER PAGE, AT A PO BREAK OR 05670011
056800*  AT A PAGE BREAK                                                05680011
056900                                                                  05690011
057000     IF (PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES             05700011
057100         PERFORM 9200-WRITE-HEADING                               05710011
057200         MOVE 1                  TO   PR-DETAIL-CC                05720011
057300     END-IF.                                                      05730011
057400                                                                  05740011
057500*  MOVE TO PRINT AREA & WRITE REPORT LINE                         05750011
057600                                                                  05760011
057700     MOVE PR-DETAIL-CC           TO   PR-CC.                      05770011
057800     MOVE DETAIL-LINE            TO   PR-LINE.                    05780011
057900     PERFORM 9000-WRITE-REPORT.                                   05790011
058000                                                                  05800011
058100 EJECT                                                            05810011
058200***************************************************************** 05820011
058300*  REPORT AND COLUMN HEADINGS FOR EACH OF THE FOUR REPORTS        05830011
058400*                                                                 05840011
058500*  CALLED FROM 9100-WRITE-DETAIL                                  05850011
058600***************************************************************** 05860011
058700 9200-WRITE-HEADING.                                              05870011
058800                                                                  05880011
058900     MOVE '9200-WRITE-HEADING'   TO   PV-CURRENT-PARAGRAPH.       05890011
059000                                                                  05900011
059100*  BUMP PAGE COUNT                                                05910011
059200                                                                  05920011
059300     ADD 1                       TO   PR-PAGE-COUNT.              05930011
059400     MOVE PR-PAGE-COUNT          TO   DP150O-PAGE-NUMBER.         05940011
059500                                                                  05950011
059600*  CLEAR LINE COUNT                                               05960011
059700                                                                  05970011
059800     MOVE 0                      TO   PR-LINE-COUNT.              05980011
059900                                                                  05990011
060000*  HEADING LINE 1 (STANDARD)                                      06000011
060100                                                                  06010011
060200     MOVE 0                      TO   PR-CC.                      06020011
060300     MOVE DP150O-STANDRD-HEADER-150-COLS                          06030011
060400                                 TO   PR-LINE.                    06040011
060500     PERFORM 9000-WRITE-REPORT.                                   06050011
060600                                                                  06060011
060700*  HEADING LINE 2 (REPORT TITLE)                                  06070011
060800                                                                  06080011
060900     MOVE 1                      TO   PR-CC.                      06090011
061000     MOVE HDR-LINE2              TO   PR-LINE.                    06100011
061100     PERFORM 9000-WRITE-REPORT.                                   06110011
061200                                                                  06120011
061300*  HEADING LINE 3 (REPORT DATES)                                  06130011
061400                                                                  06140011
061500     MOVE 1                      TO   PR-CC.                      06150011
061600     MOVE HDR-LINE3              TO   PR-LINE.                    06160011
061700     PERFORM 9000-WRITE-REPORT.                                   06170011
061800                                                                  06180011
061900*  HEADING LINE 4 (MONTH/YEAR)                                    06190011
062000                                                                  06200011
062100     MOVE 1                      TO   PR-CC.                      06210011
062200     MOVE HDR-LINE4              TO   PR-LINE.                    06220011
062300     PERFORM 9000-WRITE-REPORT.                                   06230011
062400                                                                  06240011
062500*  HEADING LINE 4A- 6 (DETAIL LINES HEADING)                      06250011
062600                                                                  06260011
062700     MOVE 2                      TO   PR-CC.                      06270011
062800     MOVE HDR-LINE4A             TO   PR-LINE.                    06280011
062900     PERFORM 9000-WRITE-REPORT.                                   06290011
063000                                                                  06300011
063100     MOVE 1                      TO   PR-CC.                      06310011
063200     MOVE HDR-LINE5              TO   PR-LINE.                    06320011
063300     PERFORM 9000-WRITE-REPORT.                                   06330011
063400                                                                  06340011
063500     MOVE 1                      TO   PR-CC.                      06350011
063600     MOVE HDR-LINE6              TO   PR-LINE.                    06360011
063700     PERFORM 9000-WRITE-REPORT.                                   06370011
063800                                                                  06380011
063900 EJECT                                                            06390011
064000***************************************************************** 06400011
064100*  END OF REPORT LINES FOR THE REPORT                             06410011
064200*                                                                 06420011
064300*  CALLED FROM 3000-END-PROGRAM                                   06430011
064400***************************************************************** 06440011
064500 9300-WRITE-END-OF-RPT.                                           06450011
064600                                                                  06460011
064700     MOVE '9300-WRITE-END-OF-RPT' TO PV-CURRENT-PARAGRAPH.        06470011
064800                                                                  06480011
064900*  WRITE MONTHLY TOTAL LINE                                       06490011
065000                                                                  06500011
065100     PERFORM 2100-MONTHLY-TOTALS.                                 06510011
065200                                                                  06520011
065300*  WRITE GRAND TOTAL LINES                                        06530011
065400                                                                  06540011
065500     MOVE PV-GRD-PO-COST          TO  PGL-PO-COST.                06550011
065600     MOVE PV-GRD-VERFYD-COST      TO  PGL-VERIFIED-COST.          06560011
065700     MOVE PV-GRD-VERFYD-EXC-COST  TO  PGL-VER-EXCEPT-AMT.         06570011
065800     MOVE PV-GRD-UNJRNL-NIR-COST  TO  PGL-UNJRNLZD-NIR.           06580011
065900     MOVE PV-GRD-UNJRNL-RCVR-COST TO  PGL-UNJRNLZD-RECEIVERS.     06590011
066000                                                                  06600011
066100     MOVE SPACE                  TO   DETAIL-LINE.                06610011
066200     MOVE PO-GRAND-TOTAL-LINE1   TO   DETAIL-LINE.                06620011
066300     MOVE 2                      TO   PR-DETAIL-CC.               06630011
066400     PERFORM    9400-WRITE-TOTAL.                                 06640011
066500                                                                  06650011
066600     MOVE SPACE                  TO   DETAIL-LINE.                06660011
066700     MOVE PO-GRAND-TOTAL-LINE2   TO   DETAIL-LINE.                06670011
066800     MOVE 1                      TO   PR-DETAIL-CC.               06680011
066900     PERFORM    9100-WRITE-DETAIL.                                06690011
067000                                                                  06700011
067100*  DO HEADING IF NOT DONE YET                                     06710011
067200                                                                  06720011
067300     IF (PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES             06730011
067400         PERFORM 9200-WRITE-HEADING                               06740011
067500     END-IF.                                                      06750011
067600                                                                  06760011
067700*  END OF REPORT LITERAL                                          06770011
067800                                                                  06780011
067900     MOVE 2                      TO   PR-CC.                      06790011
068000     MOVE EOR-END-OF-REPORT      TO   PR-LINE.                    06800011
068100     PERFORM 9000-WRITE-REPORT.                                   06810011
068200                                                                  06820011
068300 EJECT                                                            06830011
068400***************************************************************** 06840011
068500*  REPORT TOTAL LINES.                     THIS ROUTINE CHECKS    06850011
068600*  FOR PAGE OVERFLOW AND PERFORMS A HEADING ROUTINE IF NECESSARY  06860011
068700*                                                                 06870011
068800***************************************************************** 06880011
068900 9400-WRITE-TOTAL.                                                06890011
069000                                                                  06900011
069100     MOVE '9400-WRITE-TOTAL' TO PV-CURRENT-PARAGRAPH.             06910011
069200                                                                  06920011
069300*  CHECK FOR PAGE OVERFLOW.                                       06930011
069400*                                                                 06940011
069500*  WE WANT TO DISPLAY VENDOR & PO ONCE PER PAGE, AT A PO BREAK OR 06950011
069600*  AT A PAGE BREAK                                                06960011
069700                                                                  06970011
069800     IF (PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES             06980011
069900         PERFORM 9200-WRITE-HEADING                               06990011
070000         MOVE 2                  TO   PR-DETAIL-CC                07000011
070100     END-IF.                                                      07010011
070200                                                                  07020011
070300*  MOVE TO PRINT AREA & WRITE REPORT LINE                         07030011
070400                                                                  07040011
070500     MOVE PR-DETAIL-CC           TO   PR-CC.                      07050011
070600     MOVE DETAIL-LINE            TO   PR-LINE.                    07060011
070700     PERFORM 9000-WRITE-REPORT.                                   07070011
070800                                                                  07080011
070900 9500-CALL-DATE-ROUTINE.                                          07090011
071000                                                                  07100011
071100     INITIALIZE DPG51                                             07110011
071200                DPG52                                             07120011
071300                DPG53                                             07130011
071400                DPG54                                             07140011
071500                DPG55                                             07150011
071600                DPG56.                                            07160011
071700                                                                  07170011
071800     MOVE SPACES                     TO PML-MONTH-ABBR3           07180011
071900                                        PML-YEAR.                 07190011
072000                                                                  07200011
072100     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     07210011
072200     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     07220011
072300**   SET DPG52-LK-DTE-MONTH          TO TRUE.                     07230011
072400     SET DPG52-LK-DTE-ISO            TO TRUE.                     07240011
072500**   MOVE HL4-MONTH                  TO PV-AREA-10.               07250011
072600**   MOVE PV-CURRENT-DATE            TO DPG51-SYSTEM-DATE         07260011
072700**   MOVE PV-AREA-10                 TO DPG52-LK-DATE-INPUT       07270011
072800     MOVE AP113-UNJ-DATE (1:6)       TO DPG52-LK-DATE-INPUT (1:6) 07280011
072900     MOVE '01'                       TO DPG52-LK-DATE-INPUT (7:2) 07290011
073000     CALL  DP500-KOHLS-CALENDAR-ROUTINE USING                     07300011
073100                                     DPG51 DPG52 DPG53            07310011
073200                                     DPG54 DPG55 DPG56            07320011
073300     IF (DPG54-SEVERE-ERROR OR                                    07330011
073400         DPG54-WARNING-ERROR)                                     07340011
073500        DISPLAY 'LK-DATE         ' DPG52-LK-DATE-INPUT            07350011
073600        DISPLAY 'INCR-DECR-DAYS  ' DPG51-INCR-DECR-DAYS-9         07360011
073700        DISPLAY 'CALENDAR-TYPE   ' DPG54-CALENDAR-TYPE-IND        07370011
073800        DISPLAY 'DATE-VALID      ' DPG54-DATE-VALID-IND           07380011
073900        DISPLAY 'CMPR-DATE-VALID ' DPG54-CMPR-DATE-VALID-IND      07390011
074000        DISPLAY 'INCR-DECR-IND   ' DPG54-INCR-DECR-IND            07400011
074100        DISPLAY 'ERROR-IND       ' DPG54-ERROR-IND                07410011
074200        DISPLAY                    DPG54-ERROR-MESSAGE            07420011
074300                                                                  07430011
074400        MOVE '9500-CALL-DATE'     TO AA-PARAGRAPH-LIT             07440011
074500        MOVE 'UNSUCCESSFUL CALL TO DATE ROUTINE           '       07450011
074600            TO AA-MESSAGE                                         07460011
074700        PERFORM 9999-ABEND                                        07470011
074800     ELSE                                                         07480011
074900         MOVE DPG55-ALPHA-MONTH-ABBR3 TO PML-MONTH-ABBR3          07490011
075000         MOVE HL4-YEAR                TO PML-YEAR                 07500011
075100     END-IF.                                                      07510011
075200                                                                  07520011
075300 EJECT                                                            07530011
075400***************************************************************** 07540011
075500*  ABEND ROUTINE                                                  07550011
075600***************************************************************** 07560011
075700 9999-ABEND.                                                      07570011
075800                                                                  07580011
075900     DISPLAY '*** PROGRAM   = ' PV-PROGRAM-NAME.                  07590011
076000     DISPLAY '*** PARAGRAPH = ' PV-CURRENT-PARAGRAPH.             07600011
076100     DISPLAY '*** MESSAGE   = ' AA-MESSAGE-LINE.                  07610011
076200                                                                  07620011
076300     CALL 'ILBOABN0'            USING ABEND-CODE.                 07630011
076400                                                                  07640011
